import{O as d,Y as p}from"./index-Dm1R2z7R.js";function a(l,c=""){const i=[];for(const[s,o]of Object.entries(l)){const r=d(),e=[c,s].filter(Boolean).join("/"),n="file"in o&&"contents"in o.file?o.file:void 0,t={id:r,isSelectable:!0,content:typeof(n==null?void 0:n.contents)=="string"?n.contents:void 0,file:e,name:s,children:[]};"directory"in o&&(t.children=a(o.directory,e)),i.push(t)}return i}function h(l){const c=l.trim().split(`
`),i={};return c.forEach(s=>{const{file:o,content:r}=JSON.parse(s),e=o.split("/");let n=i;for(let t=0;t<e.length;t++){const f=e[t];t===e.length-1?n[f]={file:{contents:r}}:(n[f]||(n[f]={directory:{}}),n=n[f].directory)}}),i}function y(l){const c=[];function i(s,o=[]){for(const[r,e]of Object.entries(s))if("file"in e){const n=[...o,r].join("/");if("contents"in e.file){const t=e.file.contents;c.push(JSON.stringify({file:n,content:t}))}}else"directory"in e&&i(e.directory,[...o,r])}return i(l),c.join(`
`)}function u(l,c){return p(`[UpdateCodeContainerFile] Changes ${c.map(i=>`${i.type||"create_or_update"}:${i.path}`).join(", ")}`),c.forEach(({path:i,content:s,type:o="create_or_update"})=>{const r=i.replace(/^\.\//,"").split("/");let e=l;for(let n=0;n<r.length;n++){const t=r[n];if(n===r.length-1)o==="delete"?t in e&&"file"in e[t]?delete e[t]:console.warn(`Path "${i}" is not a file or does not exist.`):t in e&&"file"in e[t]?e[t].file.contents=s:e[t]={file:{contents:s}};else if(t in e&&"directory"in e[t])e=e[t].directory;else if(o==="delete"){console.warn(`Path "${i}" does not exist.`);break}else e[t]={directory:{}},e=e[t].directory}}),l}export{h as a,a as c,y as p,u};
