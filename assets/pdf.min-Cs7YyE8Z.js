const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bx2nXGjt.js","assets/index-CjWtXLQl.css"])))=>i.map(i=>d[i]);
var Rm=Object.defineProperty;var Qd=ut=>{throw TypeError(ut)};var Im=(ut,pt,V)=>pt in ut?Rm(ut,pt,{enumerable:!0,configurable:!0,writable:!0,value:V}):ut[pt]=V;var Y=(ut,pt,V)=>Im(ut,typeof pt!="symbol"?pt+"":pt,V),Ql=(ut,pt,V)=>pt.has(ut)||Qd("Cannot "+V);var a=(ut,pt,V)=>(Ql(ut,pt,"read from private field"),V?V.call(ut):pt.get(ut)),A=(ut,pt,V)=>pt.has(ut)?Qd("Cannot add the same private member more than once"):pt instanceof WeakSet?pt.add(ut):pt.set(ut,V),m=(ut,pt,V,W)=>(Ql(ut,pt,"write to private field"),W?W.call(ut,V):pt.set(ut,V),V),v=(ut,pt,V)=>(Ql(ut,pt,"access private method"),V);var re=(ut,pt,V,W)=>({set _(Ht){m(ut,pt,Ht,V)},get _(){return a(ut,pt,W)}});import{a1 as Xr,a6 as Yr,W as Jd,__tla as Pm}from"./index-Bx2nXGjt.js";import{F as Zd,__tla as Lm}from"./routes-CxSHUws9.js";import{__tla as Dm}from"./copy-B6PT0_iH.js";import{__tla as Fm}from"./createLucideIcon-CzYJSyR5.js";import{__tla as Om}from"./refresh-ccw-CugNfc47.js";import{__tla as Nm}from"./volume-2-BwHhMevv.js";let tu,eu,su,iu,nu,ru,au,ou,hu,lu,cu,du,uu,pu,gu,fu,mu,vu,bu,Au,yu,wu,xu,_u,Su,Eu,Cu,Tu,ku,Mu,Ru,Iu,Pu,Lu,Du,Fu,Ou,Nu,Bu,Hu,ju,zu,$u,Bm=Promise.all([(()=>{try{return Pm}catch{}})(),(()=>{try{return Lm}catch{}})(),(()=>{try{return Dm}catch{}})(),(()=>{try{return Fm}catch{}})(),(()=>{try{return Om}catch{}})(),(()=>{try{return Nm}catch{}})()]).then(async()=>{var xs,Ih,Jl,fa,ii,$i,Ne,Ui,ma,va,ph,Uu,se,Gu,Vu,Ph,Wu,Zl,ba,Gi,Vi,ni,qu,Xu,Yu,gh,Yn,Aa,Kt,Kn,Lh,jt,ri,ya,zt,fh,Ku,Qn,me,Lt,Vt,Jn,Ss,Zn,Be,ai,tr,Wi,Je,He,qi,wa,xa,er,_a,Ze,oi,sr,hi,ts,vh,li,Sa,ci,Xi,Ea,Ca,$t,ct,Es,Yi,Ta,ka,di,es,Cs,Ma,ke,L,Dh,tc,Qu,Ju,Fh,Zu,tp,ep,ec,sp,sc,ic,ip,ae,Pi,np,rp,nc,ap,Po,rc,Ut,ss,je,nr,is,ve,rr,ns,le,Ts,Ki,rs,ui,ze,Lo,Oh,Qi,$e,_t,ar,Ji,Wt,Zi,pi,Ra,tn,gi,Ia,en,ks,as,or,hr,Me,Pa,bh,tt,ac,La,oc,hc,op,hp,lc,cc,dc,lp,uc,cp,dp,up,pc,Do,sn,nn,Gt,Ah,pp,Da,lr,Fa,fi,gc,fc,Oa,Na,cr,Re,gp,fp,mp,Nh,rn,Ba,Ha,ja,za,dr,mi,dt,ur,pr,$a,mc,qd,vi,ce,Ua,Ga,an,Ms,Va,Wa,on,gr,fr,bi,mr,qa,vr,hn,Xa,Ya,ln,cn,Ka,Ai,br,Rs,vp,bp,vc,be,Bh,bc,Ap,yp,dn,un,os,Is,Qt,wh,pn,B,te,Kr,Qr,Hh,Jr,wp,Ac,Zr,Fo,Oo,yc,No,Xd,xh,yi,Ps,Ie,ta,jh,Ls,Sh,Eh,gn,fn,Ar,zh,yr,$h,Ds,hs,wr,xr,ls,mn,Bo,Ue,Qa,wc,wi,xi,vn,An,_r,Sr,Ja,xc,Ae,$n,xp,_p,Er,Ch,Th,Cr,yn,Ct,Fs,Tr,Za,to,kr,Os,Ge,Ns,eo,Bs,so,wn,xn,gt,Uh,_c,Sp,Ep,Cp,Tp,Gh,Vh,Sc,io,no,ro,ao,oo,ho,lo,Ec,co,_n,Sn,uo,En,kp,Cc,Ve,ye,po,Cn,we,Rt,Mp,Rp,Ip,Wh,Hs,qh,Xh,Pp,Tc,Lp,xe,We,Mr,Rr,cs,et,Tn,kn,go,fo,Ir,Pr,_i,mo,kh,Mh,Ft,Ho,Dp,Fp,Op,Np,Bp,Hp,Lr,Mn,zs,vo,_e,bo,kt,de,jo,zo,jp,Ao,Si,qe,ne,zp,Yh,$p,Up,kc,yo,Dr,Xe,Rn,Fr,Ot,wo,Or,xo,_o,Ei,Ye,Nr,So,ft,Mc,Rc,Ic,Un,Gp,Li,Br,Eo,$s,In,Hr,Pe,Co,To,Pn,Ke,Jt,pe,jr,Us,Nt,zr,Le,ko,Q,Pc,Kh,Vp,Wp,qp,Lc,Gn,De,ea,Xp,Qh,$o,Yp,Kp,Qp,Jp,Zp,Ln,Dn,ds,Gs,Fe,Fn,On,Nn,Vs,$r,Bn,Hn,Ci,P,tg,eg,sg,ig,Dc,ng,Fc,rg,ag,og,hg,lg,Vn,Oc,Nc,Bc,Jh,Zh,sa,Hc,tl,Ws,cg,jc,dg,ug,zc,el,Uo,Et,qt,Ti,qs,ki,Ur,us,Xs,ps,Se,Gr,st,Go,Vo,sl,$c,pg,il,Uc,nl,gg,fg,jn,Vr,gs,Mi,Ys,Ee,Ri,Wr,qr,Zt,Ks,G,Ii,Xt,mg,Gc,Vc,Wc,rl,fs,Ro,It,Qs,Io,qc,zn,Xc,vg;var ut={9306:(d,e,t)=>{var s=t(4901),i=t(6823),n=TypeError;d.exports=function(r){if(s(r))return r;throw new n(i(r)+" is not a function")}},3506:(d,e,t)=>{var s=t(3925),i=String,n=TypeError;d.exports=function(r){if(s(r))return r;throw new n("Can't set "+i(r)+" as a prototype")}},7080:(d,e,t)=>{var s=t(4402).has;d.exports=function(i){return s(i),i}},679:(d,e,t)=>{var s=t(1625),i=TypeError;d.exports=function(n,r){if(s(r,n))return n;throw new i("Incorrect invocation")}},8551:(d,e,t)=>{var s=t(34),i=String,n=TypeError;d.exports=function(r){if(s(r))return r;throw new n(i(r)+" is not an object")}},7811:d=>{d.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},7394:(d,e,t)=>{var s=t(4576),i=t(6706),n=t(2195),r=s.ArrayBuffer,o=s.TypeError;d.exports=r&&i(r.prototype,"byteLength","get")||function(h){if(n(h)!=="ArrayBuffer")throw new o("ArrayBuffer expected");return h.byteLength}},3238:(d,e,t)=>{var s=t(4576),i=t(7476),n=t(7394),r=s.ArrayBuffer,o=r&&r.prototype,h=o&&i(o.slice);d.exports=function(l){if(n(l)!==0||!h)return!1;try{return h(l,0,0),!1}catch{return!0}}},5169:(d,e,t)=>{var s=t(3238),i=TypeError;d.exports=function(n){if(s(n))throw new i("ArrayBuffer is detached");return n}},5636:(d,e,t)=>{var s=t(4576),i=t(9504),n=t(6706),r=t(7696),o=t(5169),h=t(7394),l=t(4483),c=t(1548),p=s.structuredClone,u=s.ArrayBuffer,g=s.DataView,f=Math.min,b=u.prototype,w=g.prototype,y=i(b.slice),x=n(b,"resizable","get"),_=n(b,"maxByteLength","get"),E=i(w.getInt8),C=i(w.setInt8);d.exports=(c||l)&&function(S,T,M){var R,O=h(S),N=T===void 0?O:r(T),Z=!x||!x(S);if(o(S),c&&(S=p(S,{transfer:[S]}),O===N&&(M||Z)))return S;if(O>=N&&(!M||Z))R=y(S,0,N);else{var $=M&&!Z&&_?{maxByteLength:_(S)}:void 0;R=new u(N,$);for(var j=new g(S),it=new g(R),ot=f(N,O),mt=0;mt<ot;mt++)C(it,mt,E(j,mt))}return c||l(S),R}},4644:(d,e,t)=>{var s,i,n,r=t(7811),o=t(3724),h=t(4576),l=t(4901),c=t(34),p=t(9297),u=t(6955),g=t(6823),f=t(6699),b=t(6840),w=t(2106),y=t(1625),x=t(2787),_=t(2967),E=t(8227),C=t(3392),S=t(1181),T=S.enforce,M=S.get,R=h.Int8Array,O=R&&R.prototype,N=h.Uint8ClampedArray,Z=N&&N.prototype,$=R&&x(R),j=O&&x(O),it=Object.prototype,ot=h.TypeError,mt=E("toStringTag"),H=C("TYPED_ARRAY_TAG"),q="TypedArrayConstructor",Mt=r&&!!_&&u(h.opera)!=="Opera",ge=!1,vt={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},F={BigInt64Array:8,BigUint64Array:8},I=function(D){var U=x(D);if(c(U)){var rt=M(U);return rt&&p(rt,q)?rt[q]:I(U)}},k=function(D){if(!c(D))return!1;var U=u(D);return p(vt,U)||p(F,U)};for(s in vt)(n=(i=h[s])&&i.prototype)?T(n)[q]=i:Mt=!1;for(s in F)(n=(i=h[s])&&i.prototype)&&(T(n)[q]=i);if((!Mt||!l($)||$===Function.prototype)&&($=function(){throw new ot("Incorrect invocation")},Mt))for(s in vt)h[s]&&_(h[s],$);if((!Mt||!j||j===it)&&(j=$.prototype,Mt))for(s in vt)h[s]&&_(h[s].prototype,j);if(Mt&&x(Z)!==j&&_(Z,j),o&&!p(j,mt)){ge=!0,w(j,mt,{configurable:!0,get:function(){return c(this)?this[H]:void 0}});for(s in vt)h[s]&&f(h[s],H,s)}d.exports={NATIVE_ARRAY_BUFFER_VIEWS:Mt,TYPED_ARRAY_TAG:ge&&H,aTypedArray:function(D){if(k(D))return D;throw new ot("Target is not a typed array")},aTypedArrayConstructor:function(D){if(l(D)&&(!_||y($,D)))return D;throw new ot(g(D)+" is not a typed array constructor")},exportTypedArrayMethod:function(D,U,rt,Bt){if(o){if(rt)for(var bt in vt){var ms=h[bt];if(ms&&p(ms.prototype,D))try{delete ms.prototype[D]}catch{try{ms.prototype[D]=U}catch{}}}j[D]&&!rt||b(j,D,rt?U:Mt&&O[D]||U,Bt)}},exportTypedArrayStaticMethod:function(D,U,rt){var Bt,bt;if(o){if(_){if(rt){for(Bt in vt)if((bt=h[Bt])&&p(bt,D))try{delete bt[D]}catch{}}if($[D]&&!rt)return;try{return b($,D,rt?U:Mt&&$[D]||U)}catch{}}for(Bt in vt)!(bt=h[Bt])||bt[D]&&!rt||b(bt,D,U)}},getTypedArrayConstructor:I,isView:function(D){if(!c(D))return!1;var U=u(D);return U==="DataView"||p(vt,U)||p(F,U)},isTypedArray:k,TypedArray:$,TypedArrayPrototype:j}},5370:(d,e,t)=>{var s=t(6198);d.exports=function(i,n,r){for(var o=0,h=arguments.length>2?r:s(n),l=new i(h);h>o;)l[o]=n[o++];return l}},9617:(d,e,t)=>{var s=t(5397),i=t(5610),n=t(6198),r=function(o){return function(h,l,c){var p=s(h),u=n(p);if(u===0)return!o&&-1;var g,f=i(c,u);if(o&&l!=l){for(;u>f;)if((g=p[f++])!=g)return!0}else for(;u>f;f++)if((o||f in p)&&p[f]===l)return o||f||0;return!o&&-1}};d.exports={includes:r(!0),indexOf:r(!1)}},4527:(d,e,t)=>{var s=t(3724),i=t(4376),n=TypeError,r=Object.getOwnPropertyDescriptor,o=s&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(h){return h instanceof TypeError}}();d.exports=o?function(h,l){if(i(h)&&!r(h,"length").writable)throw new n("Cannot set read only .length");return h.length=l}:function(h,l){return h.length=l}},7628:(d,e,t)=>{var s=t(6198);d.exports=function(i,n){for(var r=s(i),o=new n(r),h=0;h<r;h++)o[h]=i[r-h-1];return o}},9928:(d,e,t)=>{var s=t(6198),i=t(1291),n=RangeError;d.exports=function(r,o,h,l){var c=s(r),p=i(h),u=p<0?c+p:p;if(u>=c||u<0)throw new n("Incorrect index");for(var g=new o(c),f=0;f<c;f++)g[f]=f===u?l:r[f];return g}},6319:(d,e,t)=>{var s=t(8551),i=t(9539);d.exports=function(n,r,o,h){try{return h?r(s(o)[0],o[1]):r(o)}catch(l){i(n,"throw",l)}}},2195:(d,e,t)=>{var s=t(9504),i=s({}.toString),n=s("".slice);d.exports=function(r){return n(i(r),8,-1)}},6955:(d,e,t)=>{var s=t(2140),i=t(4901),n=t(2195),r=t(8227)("toStringTag"),o=Object,h=n(function(){return arguments}())==="Arguments";d.exports=s?n:function(l){var c,p,u;return l===void 0?"Undefined":l===null?"Null":typeof(p=function(g,f){try{return g[f]}catch{}}(c=o(l),r))=="string"?p:h?n(c):(u=n(c))==="Object"&&i(c.callee)?"Arguments":u}},7740:(d,e,t)=>{var s=t(9297),i=t(5031),n=t(7347),r=t(4913);d.exports=function(o,h,l){for(var c=i(h),p=r.f,u=n.f,g=0;g<c.length;g++){var f=c[g];s(o,f)||l&&s(l,f)||p(o,f,u(h,f))}}},2211:(d,e,t)=>{var s=t(9039);d.exports=!s(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})},2529:d=>{d.exports=function(e,t){return{value:e,done:t}}},6699:(d,e,t)=>{var s=t(3724),i=t(4913),n=t(6980);d.exports=s?function(r,o,h){return i.f(r,o,n(1,h))}:function(r,o,h){return r[o]=h,r}},6980:d=>{d.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},4659:(d,e,t)=>{var s=t(3724),i=t(4913),n=t(6980);d.exports=function(r,o,h){s?i.f(r,o,n(0,h)):r[o]=h}},2106:(d,e,t)=>{var s=t(283),i=t(4913);d.exports=function(n,r,o){return o.get&&s(o.get,r,{getter:!0}),o.set&&s(o.set,r,{setter:!0}),i.f(n,r,o)}},6840:(d,e,t)=>{var s=t(4901),i=t(4913),n=t(283),r=t(9433);d.exports=function(o,h,l,c){c||(c={});var p=c.enumerable,u=c.name!==void 0?c.name:h;if(s(l)&&n(l,u,c),c.global)p?o[h]=l:r(h,l);else{try{c.unsafe?o[h]&&(p=!0):delete o[h]}catch{}p?o[h]=l:i.f(o,h,{value:l,enumerable:!1,configurable:!c.nonConfigurable,writable:!c.nonWritable})}return o}},6279:(d,e,t)=>{var s=t(6840);d.exports=function(i,n,r){for(var o in n)s(i,o,n[o],r);return i}},9433:(d,e,t)=>{var s=t(4576),i=Object.defineProperty;d.exports=function(n,r){try{i(s,n,{value:r,configurable:!0,writable:!0})}catch{s[n]=r}return r}},3724:(d,e,t)=>{var s=t(9039);d.exports=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},4483:(d,e,t)=>{var s,i,n,r,o=t(4576),h=t(9429),l=t(1548),c=o.structuredClone,p=o.ArrayBuffer,u=o.MessageChannel,g=!1;if(l)g=function(f){c(f,{transfer:[f]})};else if(p)try{u||(s=h("worker_threads"))&&(u=s.MessageChannel),u&&(i=new u,n=new p(2),r=function(f){i.port1.postMessage(null,[f])},n.byteLength===2&&(r(n),n.byteLength===0&&(g=r)))}catch{}d.exports=g},4055:(d,e,t)=>{var s=t(4576),i=t(34),n=s.document,r=i(n)&&i(n.createElement);d.exports=function(o){return r?n.createElement(o):{}}},6837:d=>{var e=TypeError;d.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},5002:d=>{d.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},8727:d=>{d.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6193:(d,e,t)=>{var s=t(4215);d.exports=s==="NODE"},2839:(d,e,t)=>{var s=t(4576).navigator,i=s&&s.userAgent;d.exports=i?String(i):""},9519:(d,e,t)=>{var s,i,n=t(4576),r=t(2839),o=n.process,h=n.Deno,l=o&&o.versions||h&&h.version,c=l&&l.v8;c&&(i=(s=c.split("."))[0]>0&&s[0]<4?1:+(s[0]+s[1])),!i&&r&&(!(s=r.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=r.match(/Chrome\/(\d+)/))&&(i=+s[1]),d.exports=i},4215:(d,e,t)=>{var s=t(4576),i=t(2839),n=t(2195),r=function(o){return i.slice(0,o.length)===o};d.exports=r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":s.Bun&&typeof Bun.version=="string"?"BUN":s.Deno&&typeof Deno.version=="object"?"DENO":n(s.process)==="process"?"NODE":s.window&&s.document?"BROWSER":"REST"},8574:(d,e,t)=>{var s=t(9504),i=Error,n=s("".replace),r=String(new i("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,h=o.test(r);d.exports=function(l,c){if(h&&typeof l=="string"&&!i.prepareStackTrace)for(;c--;)l=n(l,o,"");return l}},6518:(d,e,t)=>{var s=t(4576),i=t(7347).f,n=t(6699),r=t(6840),o=t(9433),h=t(7740),l=t(2796);d.exports=function(c,p){var u,g,f,b,w,y=c.target,x=c.global,_=c.stat;if(u=x?s:_?s[y]||o(y,{}):s[y]&&s[y].prototype)for(g in p){if(b=p[g],f=c.dontCallGetSet?(w=i(u,g))&&w.value:u[g],!l(x?g:y+(_?".":"#")+g,c.forced)&&f!==void 0){if(typeof b==typeof f)continue;h(b,f)}(c.sham||f&&f.sham)&&n(b,"sham",!0),r(u,g,b,c)}}},9039:d=>{d.exports=function(e){try{return!!e()}catch{return!0}}},6080:(d,e,t)=>{var s=t(7476),i=t(9306),n=t(616),r=s(s.bind);d.exports=function(o,h){return i(o),h===void 0?o:n?r(o,h):function(){return o.apply(h,arguments)}}},616:(d,e,t)=>{var s=t(9039);d.exports=!s(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")})},9565:(d,e,t)=>{var s=t(616),i=Function.prototype.call;d.exports=s?i.bind(i):function(){return i.apply(i,arguments)}},350:(d,e,t)=>{var s=t(3724),i=t(9297),n=Function.prototype,r=s&&Object.getOwnPropertyDescriptor,o=i(n,"name"),h=o&&(function(){}).name==="something",l=o&&(!s||s&&r(n,"name").configurable);d.exports={EXISTS:o,PROPER:h,CONFIGURABLE:l}},6706:(d,e,t)=>{var s=t(9504),i=t(9306);d.exports=function(n,r,o){try{return s(i(Object.getOwnPropertyDescriptor(n,r)[o]))}catch{}}},7476:(d,e,t)=>{var s=t(2195),i=t(9504);d.exports=function(n){if(s(n)==="Function")return i(n)}},9504:(d,e,t)=>{var s=t(616),i=Function.prototype,n=i.call,r=s&&i.bind.bind(n,n);d.exports=s?r:function(o){return function(){return n.apply(o,arguments)}}},9429:(d,e,t)=>{var s=t(4576),i=t(6193);d.exports=function(n){if(i){try{return s.process.getBuiltinModule(n)}catch{}try{return Function('return require("'+n+'")')()}catch{}}}},7751:(d,e,t)=>{var s=t(4576),i=t(4901);d.exports=function(n,r){return arguments.length<2?(o=s[n],i(o)?o:void 0):s[n]&&s[n][r];var o}},1767:d=>{d.exports=function(e){return{iterator:e,next:e.next,done:!1}}},8646:(d,e,t)=>{var s=t(9565),i=t(8551),n=t(1767),r=t(851);d.exports=function(o,h){h&&typeof o=="string"||i(o);var l=r(o);return n(i(l!==void 0?s(l,o):o))}},851:(d,e,t)=>{var s=t(6955),i=t(5966),n=t(4117),r=t(6269),o=t(8227)("iterator");d.exports=function(h){if(!n(h))return i(h,o)||i(h,"@@iterator")||r[s(h)]}},81:(d,e,t)=>{var s=t(9565),i=t(9306),n=t(8551),r=t(6823),o=t(851),h=TypeError;d.exports=function(l,c){var p=arguments.length<2?o(l):c;if(i(p))return n(s(p,l));throw new h(r(l)+" is not iterable")}},5966:(d,e,t)=>{var s=t(9306),i=t(4117);d.exports=function(n,r){var o=n[r];return i(o)?void 0:s(o)}},3789:(d,e,t)=>{var s=t(9306),i=t(8551),n=t(9565),r=t(1291),o=t(1767),h="Invalid size",l=RangeError,c=TypeError,p=Math.max,u=function(g,f){this.set=g,this.size=p(f,0),this.has=s(g.has),this.keys=s(g.keys)};u.prototype={getIterator:function(){return o(i(n(this.keys,this.set)))},includes:function(g){return n(this.has,this.set,g)}},d.exports=function(g){i(g);var f=+g.size;if(f!=f)throw new c(h);var b=r(f);if(b<0)throw new l(h);return new u(g,b)}},4576:function(d){var e=function(t){return t&&t.Math===Math&&t};d.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof Zd=="object"&&Zd)||e(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},9297:(d,e,t)=>{var s=t(9504),i=t(8981),n=s({}.hasOwnProperty);d.exports=Object.hasOwn||function(r,o){return n(i(r),o)}},421:d=>{d.exports={}},397:(d,e,t)=>{var s=t(7751);d.exports=s("document","documentElement")},5917:(d,e,t)=>{var s=t(3724),i=t(9039),n=t(4055);d.exports=!s&&!i(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7})},7055:(d,e,t)=>{var s=t(9504),i=t(9039),n=t(2195),r=Object,o=s("".split);d.exports=i(function(){return!r("z").propertyIsEnumerable(0)})?function(h){return n(h)==="String"?o(h,""):r(h)}:r},3167:(d,e,t)=>{var s=t(4901),i=t(34),n=t(2967);d.exports=function(r,o,h){var l,c;return n&&s(l=o.constructor)&&l!==h&&i(c=l.prototype)&&c!==h.prototype&&n(r,c),r}},3706:(d,e,t)=>{var s=t(9504),i=t(4901),n=t(7629),r=s(Function.toString);i(n.inspectSource)||(n.inspectSource=function(o){return r(o)}),d.exports=n.inspectSource},1181:(d,e,t)=>{var s,i,n,r=t(8622),o=t(4576),h=t(34),l=t(6699),c=t(9297),p=t(7629),u=t(6119),g=t(421),f="Object already initialized",b=o.TypeError,w=o.WeakMap;if(r||p.state){var y=p.state||(p.state=new w);y.get=y.get,y.has=y.has,y.set=y.set,s=function(_,E){if(y.has(_))throw new b(f);return E.facade=_,y.set(_,E),E},i=function(_){return y.get(_)||{}},n=function(_){return y.has(_)}}else{var x=u("state");g[x]=!0,s=function(_,E){if(c(_,x))throw new b(f);return E.facade=_,l(_,x,E),E},i=function(_){return c(_,x)?_[x]:{}},n=function(_){return c(_,x)}}d.exports={set:s,get:i,has:n,enforce:function(_){return n(_)?i(_):s(_,{})},getterFor:function(_){return function(E){var C;if(!h(E)||(C=i(E)).type!==_)throw new b("Incompatible receiver, "+_+" required");return C}}}},4209:(d,e,t)=>{var s=t(8227),i=t(6269),n=s("iterator"),r=Array.prototype;d.exports=function(o){return o!==void 0&&(i.Array===o||r[n]===o)}},4376:(d,e,t)=>{var s=t(2195);d.exports=Array.isArray||function(i){return s(i)==="Array"}},1108:(d,e,t)=>{var s=t(6955);d.exports=function(i){var n=s(i);return n==="BigInt64Array"||n==="BigUint64Array"}},4901:d=>{var e=typeof document=="object"&&document.all;d.exports=e===void 0&&e!==void 0?function(t){return typeof t=="function"||t===e}:function(t){return typeof t=="function"}},2796:(d,e,t)=>{var s=t(9039),i=t(4901),n=/#|\.prototype\./,r=function(p,u){var g=h[o(p)];return g===c||g!==l&&(i(u)?s(u):!!u)},o=r.normalize=function(p){return String(p).replace(n,".").toLowerCase()},h=r.data={},l=r.NATIVE="N",c=r.POLYFILL="P";d.exports=r},4117:d=>{d.exports=function(e){return e==null}},34:(d,e,t)=>{var s=t(4901);d.exports=function(i){return typeof i=="object"?i!==null:s(i)}},3925:(d,e,t)=>{var s=t(34);d.exports=function(i){return s(i)||i===null}},6395:d=>{d.exports=!1},757:(d,e,t)=>{var s=t(7751),i=t(4901),n=t(1625),r=t(7040),o=Object;d.exports=r?function(h){return typeof h=="symbol"}:function(h){var l=s("Symbol");return i(l)&&n(l.prototype,o(h))}},507:(d,e,t)=>{var s=t(9565);d.exports=function(i,n,r){for(var o,h,l=r?i:i.iterator,c=i.next;!(o=s(c,l)).done;)if((h=n(o.value))!==void 0)return h}},2652:(d,e,t)=>{var s=t(6080),i=t(9565),n=t(8551),r=t(6823),o=t(4209),h=t(6198),l=t(1625),c=t(81),p=t(851),u=t(9539),g=TypeError,f=function(w,y){this.stopped=w,this.result=y},b=f.prototype;d.exports=function(w,y,x){var _,E,C,S,T,M,R,O=x&&x.that,N=!(!x||!x.AS_ENTRIES),Z=!(!x||!x.IS_RECORD),$=!(!x||!x.IS_ITERATOR),j=!(!x||!x.INTERRUPTED),it=s(y,O),ot=function(H){return _&&u(_,"normal",H),new f(!0,H)},mt=function(H){return N?(n(H),j?it(H[0],H[1],ot):it(H[0],H[1])):j?it(H,ot):it(H)};if(Z)_=w.iterator;else if($)_=w;else{if(!(E=p(w)))throw new g(r(w)+" is not iterable");if(o(E)){for(C=0,S=h(w);S>C;C++)if((T=mt(w[C]))&&l(b,T))return T;return new f(!1)}_=c(w,E)}for(M=Z?w.next:_.next;!(R=i(M,_)).done;){try{T=mt(R.value)}catch(H){u(_,"throw",H)}if(typeof T=="object"&&T&&l(b,T))return T}return new f(!1)}},9539:(d,e,t)=>{var s=t(9565),i=t(8551),n=t(5966);d.exports=function(r,o,h){var l,c;i(r);try{if(!(l=n(r,"return"))){if(o==="throw")throw h;return h}l=s(l,r)}catch(p){c=!0,l=p}if(o==="throw")throw h;if(c)throw l;return i(l),h}},9462:(d,e,t)=>{var s=t(9565),i=t(2360),n=t(6699),r=t(6279),o=t(8227),h=t(1181),l=t(5966),c=t(7657).IteratorPrototype,p=t(2529),u=t(9539),g=o("toStringTag"),f="IteratorHelper",b="WrapForValidIterator",w=h.set,y=function(E){var C=h.getterFor(E?b:f);return r(i(c),{next:function(){var S=C(this);if(E)return S.nextHandler();try{var T=S.done?void 0:S.nextHandler();return p(T,S.done)}catch(M){throw S.done=!0,M}},return:function(){var S=C(this),T=S.iterator;if(S.done=!0,E){var M=l(T,"return");return M?s(M,T):p(void 0,!0)}if(S.inner)try{u(S.inner.iterator,"normal")}catch(R){return u(T,"throw",R)}return u(T,"normal"),p(void 0,!0)}})},x=y(!0),_=y(!1);n(_,g,"Iterator Helper"),d.exports=function(E,C){var S=function(T,M){M?(M.iterator=T.iterator,M.next=T.next):M=T,M.type=C?b:f,M.nextHandler=E,M.counter=0,M.done=!1,w(this,M)};return S.prototype=C?x:_,S}},713:(d,e,t)=>{var s=t(9565),i=t(9306),n=t(8551),r=t(1767),o=t(9462),h=t(6319),l=o(function(){var c=this.iterator,p=n(s(this.next,c));if(!(this.done=!!p.done))return h(c,this.mapper,[p.value,this.counter++],!0)});d.exports=function(c){return n(this),i(c),new l(r(this),{mapper:c})}},7657:(d,e,t)=>{var s,i,n,r=t(9039),o=t(4901),h=t(34),l=t(2360),c=t(2787),p=t(6840),u=t(8227),g=t(6395),f=u("iterator"),b=!1;[].keys&&("next"in(n=[].keys())?(i=c(c(n)))!==Object.prototype&&(s=i):b=!0),!h(s)||r(function(){var w={};return s[f].call(w)!==w})?s={}:g&&(s=l(s)),o(s[f])||p(s,f,function(){return this}),d.exports={IteratorPrototype:s,BUGGY_SAFARI_ITERATORS:b}},6269:d=>{d.exports={}},6198:(d,e,t)=>{var s=t(8014);d.exports=function(i){return s(i.length)}},283:(d,e,t)=>{var s=t(9504),i=t(9039),n=t(4901),r=t(9297),o=t(3724),h=t(350).CONFIGURABLE,l=t(3706),c=t(1181),p=c.enforce,u=c.get,g=String,f=Object.defineProperty,b=s("".slice),w=s("".replace),y=s([].join),x=o&&!i(function(){return f(function(){},"length",{value:8}).length!==8}),_=String(String).split("String"),E=d.exports=function(C,S,T){b(g(S),0,7)==="Symbol("&&(S="["+w(g(S),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),T&&T.getter&&(S="get "+S),T&&T.setter&&(S="set "+S),(!r(C,"name")||h&&C.name!==S)&&(o?f(C,"name",{value:S,configurable:!0}):C.name=S),x&&T&&r(T,"arity")&&C.length!==T.arity&&f(C,"length",{value:T.arity});try{T&&r(T,"constructor")&&T.constructor?o&&f(C,"prototype",{writable:!1}):C.prototype&&(C.prototype=void 0)}catch{}var M=p(C);return r(M,"source")||(M.source=y(_,typeof S=="string"?S:"")),C};Function.prototype.toString=E(function(){return n(this)&&u(this).source||l(this)},"toString")},741:d=>{var e=Math.ceil,t=Math.floor;d.exports=Math.trunc||function(s){var i=+s;return(i>0?t:e)(i)}},6043:(d,e,t)=>{var s=t(9306),i=TypeError,n=function(r){var o,h;this.promise=new r(function(l,c){if(o!==void 0||h!==void 0)throw new i("Bad Promise constructor");o=l,h=c}),this.resolve=s(o),this.reject=s(h)};d.exports.f=function(r){return new n(r)}},2603:(d,e,t)=>{var s=t(655);d.exports=function(i,n){return i===void 0?arguments.length<2?"":n:s(i)}},4149:d=>{var e=RangeError;d.exports=function(t){if(t==t)return t;throw new e("NaN is not allowed")}},2360:(d,e,t)=>{var s,i=t(8551),n=t(6801),r=t(8727),o=t(421),h=t(397),l=t(4055),c=t(6119),p="prototype",u="script",g=c("IE_PROTO"),f=function(){},b=function(x){return"<"+u+">"+x+"</"+u+">"},w=function(x){x.write(b("")),x.close();var _=x.parentWindow.Object;return x=null,_},y=function(){try{s=new ActiveXObject("htmlfile")}catch{}y=typeof document<"u"?document.domain&&s?w(s):function(){var _,E=l("iframe"),C="java"+u+":";return E.style.display="none",h.appendChild(E),E.src=String(C),(_=E.contentWindow.document).open(),_.write(b("document.F=Object")),_.close(),_.F}():w(s);for(var x=r.length;x--;)delete y[p][r[x]];return y()};o[g]=!0,d.exports=Object.create||function(x,_){var E;return x!==null?(f[p]=i(x),E=new f,f[p]=null,E[g]=x):E=y(),_===void 0?E:n.f(E,_)}},6801:(d,e,t)=>{var s=t(3724),i=t(8686),n=t(4913),r=t(8551),o=t(5397),h=t(1072);e.f=s&&!i?Object.defineProperties:function(l,c){r(l);for(var p,u=o(c),g=h(c),f=g.length,b=0;f>b;)n.f(l,p=g[b++],u[p]);return l}},4913:(d,e,t)=>{var s=t(3724),i=t(5917),n=t(8686),r=t(8551),o=t(6969),h=TypeError,l=Object.defineProperty,c=Object.getOwnPropertyDescriptor,p="enumerable",u="configurable",g="writable";e.f=s?n?function(f,b,w){if(r(f),b=o(b),r(w),typeof f=="function"&&b==="prototype"&&"value"in w&&g in w&&!w[g]){var y=c(f,b);y&&y[g]&&(f[b]=w.value,w={configurable:u in w?w[u]:y[u],enumerable:p in w?w[p]:y[p],writable:!1})}return l(f,b,w)}:l:function(f,b,w){if(r(f),b=o(b),r(w),i)try{return l(f,b,w)}catch{}if("get"in w||"set"in w)throw new h("Accessors not supported");return"value"in w&&(f[b]=w.value),f}},7347:(d,e,t)=>{var s=t(3724),i=t(9565),n=t(8773),r=t(6980),o=t(5397),h=t(6969),l=t(9297),c=t(5917),p=Object.getOwnPropertyDescriptor;e.f=s?p:function(u,g){if(u=o(u),g=h(g),c)try{return p(u,g)}catch{}if(l(u,g))return r(!i(n.f,u,g),u[g])}},8480:(d,e,t)=>{var s=t(1828),i=t(8727).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(n){return s(n,i)}},3717:(d,e)=>{e.f=Object.getOwnPropertySymbols},2787:(d,e,t)=>{var s=t(9297),i=t(4901),n=t(8981),r=t(6119),o=t(2211),h=r("IE_PROTO"),l=Object,c=l.prototype;d.exports=o?l.getPrototypeOf:function(p){var u=n(p);if(s(u,h))return u[h];var g=u.constructor;return i(g)&&u instanceof g?g.prototype:u instanceof l?c:null}},1625:(d,e,t)=>{var s=t(9504);d.exports=s({}.isPrototypeOf)},1828:(d,e,t)=>{var s=t(9504),i=t(9297),n=t(5397),r=t(9617).indexOf,o=t(421),h=s([].push);d.exports=function(l,c){var p,u=n(l),g=0,f=[];for(p in u)!i(o,p)&&i(u,p)&&h(f,p);for(;c.length>g;)i(u,p=c[g++])&&(~r(f,p)||h(f,p));return f}},1072:(d,e,t)=>{var s=t(1828),i=t(8727);d.exports=Object.keys||function(n){return s(n,i)}},8773:(d,e)=>{var t={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,i=s&&!t.call({1:2},1);e.f=i?function(n){var r=s(this,n);return!!r&&r.enumerable}:t},2967:(d,e,t)=>{var s=t(6706),i=t(34),n=t(7750),r=t(3506);d.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var o,h=!1,l={};try{(o=s(Object.prototype,"__proto__","set"))(l,[]),h=l instanceof Array}catch{}return function(c,p){return n(c),r(p),i(c)&&(h?o(c,p):c.__proto__=p),c}}():void 0)},4270:(d,e,t)=>{var s=t(9565),i=t(4901),n=t(34),r=TypeError;d.exports=function(o,h){var l,c;if(h==="string"&&i(l=o.toString)&&!n(c=s(l,o))||i(l=o.valueOf)&&!n(c=s(l,o))||h!=="string"&&i(l=o.toString)&&!n(c=s(l,o)))return c;throw new r("Can't convert object to primitive value")}},5031:(d,e,t)=>{var s=t(7751),i=t(9504),n=t(8480),r=t(3717),o=t(8551),h=i([].concat);d.exports=s("Reflect","ownKeys")||function(l){var c=n.f(o(l)),p=r.f;return p?h(c,p(l)):c}},8235:(d,e,t)=>{var s=t(9504),i=t(9297),n=SyntaxError,r=parseInt,o=String.fromCharCode,h=s("".charAt),l=s("".slice),c=s(/./.exec),p={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},u=/^[\da-f]{4}$/i,g=/^[\u0000-\u001F]$/;d.exports=function(f,b){for(var w=!0,y="";b<f.length;){var x=h(f,b);if(x==="\\"){var _=l(f,b,b+2);if(i(p,_))y+=p[_],b+=2;else{if(_!=="\\u")throw new n('Unknown escape sequence: "'+_+'"');var E=l(f,b+=2,b+4);if(!c(u,E))throw new n("Bad Unicode escape at: "+b);y+=o(r(E,16)),b+=4}}else{if(x==='"'){w=!1,b++;break}if(c(g,x))throw new n("Bad control character in string literal at: "+b);y+=x,b++}}if(w)throw new n("Unterminated string at: "+b);return{value:y,end:b}}},7750:(d,e,t)=>{var s=t(4117),i=TypeError;d.exports=function(n){if(s(n))throw new i("Can't call method on "+n);return n}},9286:(d,e,t)=>{var s=t(4402),i=t(8469),n=s.Set,r=s.add;d.exports=function(o){var h=new n;return i(o,function(l){r(h,l)}),h}},3440:(d,e,t)=>{var s=t(7080),i=t(4402),n=t(9286),r=t(5170),o=t(3789),h=t(8469),l=t(507),c=i.has,p=i.remove;d.exports=function(u){var g=s(this),f=o(u),b=n(g);return r(g)<=f.size?h(g,function(w){f.includes(w)&&p(b,w)}):l(f.getIterator(),function(w){c(g,w)&&p(b,w)}),b}},4402:(d,e,t)=>{var s=t(9504),i=Set.prototype;d.exports={Set,add:s(i.add),has:s(i.has),remove:s(i.delete),proto:i}},8750:(d,e,t)=>{var s=t(7080),i=t(4402),n=t(5170),r=t(3789),o=t(8469),h=t(507),l=i.Set,c=i.add,p=i.has;d.exports=function(u){var g=s(this),f=r(u),b=new l;return n(g)>f.size?h(f.getIterator(),function(w){p(g,w)&&c(b,w)}):o(g,function(w){f.includes(w)&&c(b,w)}),b}},4449:(d,e,t)=>{var s=t(7080),i=t(4402).has,n=t(5170),r=t(3789),o=t(8469),h=t(507),l=t(9539);d.exports=function(c){var p=s(this),u=r(c);if(n(p)<=u.size)return o(p,function(f){if(u.includes(f))return!1},!0)!==!1;var g=u.getIterator();return h(g,function(f){if(i(p,f))return l(g,"normal",!1)})!==!1}},3838:(d,e,t)=>{var s=t(7080),i=t(5170),n=t(8469),r=t(3789);d.exports=function(o){var h=s(this),l=r(o);return!(i(h)>l.size)&&n(h,function(c){if(!l.includes(c))return!1},!0)!==!1}},8527:(d,e,t)=>{var s=t(7080),i=t(4402).has,n=t(5170),r=t(3789),o=t(507),h=t(9539);d.exports=function(l){var c=s(this),p=r(l);if(n(c)<p.size)return!1;var u=p.getIterator();return o(u,function(g){if(!i(c,g))return h(u,"normal",!1)})!==!1}},8469:(d,e,t)=>{var s=t(9504),i=t(507),n=t(4402),r=n.Set,o=n.proto,h=s(o.forEach),l=s(o.keys),c=l(new r).next;d.exports=function(p,u,g){return g?i({iterator:l(p),next:c},u):h(p,u)}},4916:(d,e,t)=>{var s=t(7751),i=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};d.exports=function(n){var r=s("Set");try{new r()[n](i(0));try{return new r()[n](i(-1)),!1}catch{return!0}}catch{return!1}}},5170:(d,e,t)=>{var s=t(6706),i=t(4402);d.exports=s(i.proto,"size","get")||function(n){return n.size}},3650:(d,e,t)=>{var s=t(7080),i=t(4402),n=t(9286),r=t(3789),o=t(507),h=i.add,l=i.has,c=i.remove;d.exports=function(p){var u=s(this),g=r(p).getIterator(),f=n(u);return o(g,function(b){l(u,b)?c(f,b):h(f,b)}),f}},4204:(d,e,t)=>{var s=t(7080),i=t(4402).add,n=t(9286),r=t(3789),o=t(507);d.exports=function(h){var l=s(this),c=r(h).getIterator(),p=n(l);return o(c,function(u){i(p,u)}),p}},6119:(d,e,t)=>{var s=t(5745),i=t(3392),n=s("keys");d.exports=function(r){return n[r]||(n[r]=i(r))}},7629:(d,e,t)=>{var s=t(6395),i=t(4576),n=t(9433),r="__core-js_shared__",o=d.exports=i[r]||n(r,{});(o.versions||(o.versions=[])).push({version:"3.38.1",mode:s?"pure":"global",copyright:"\xA9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"})},5745:(d,e,t)=>{var s=t(7629);d.exports=function(i,n){return s[i]||(s[i]=n||{})}},1548:(d,e,t)=>{var s=t(4576),i=t(9039),n=t(9519),r=t(4215),o=s.structuredClone;d.exports=!!o&&!i(function(){if(r==="DENO"&&n>92||r==="NODE"&&n>94||r==="BROWSER"&&n>97)return!1;var h=new ArrayBuffer(8),l=o(h,{transfer:[h]});return h.byteLength!==0||l.byteLength!==8})},4495:(d,e,t)=>{var s=t(9519),i=t(9039),n=t(4576).String;d.exports=!!Object.getOwnPropertySymbols&&!i(function(){var r=Symbol("symbol detection");return!n(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&s&&s<41})},5610:(d,e,t)=>{var s=t(1291),i=Math.max,n=Math.min;d.exports=function(r,o){var h=s(r);return h<0?i(h+o,0):n(h,o)}},5854:(d,e,t)=>{var s=t(2777),i=TypeError;d.exports=function(n){var r=s(n,"number");if(typeof r=="number")throw new i("Can't convert number to bigint");return BigInt(r)}},7696:(d,e,t)=>{var s=t(1291),i=t(8014),n=RangeError;d.exports=function(r){if(r===void 0)return 0;var o=s(r),h=i(o);if(o!==h)throw new n("Wrong length or index");return h}},5397:(d,e,t)=>{var s=t(7055),i=t(7750);d.exports=function(n){return s(i(n))}},1291:(d,e,t)=>{var s=t(741);d.exports=function(i){var n=+i;return n!=n||n===0?0:s(n)}},8014:(d,e,t)=>{var s=t(1291),i=Math.min;d.exports=function(n){var r=s(n);return r>0?i(r,9007199254740991):0}},8981:(d,e,t)=>{var s=t(7750),i=Object;d.exports=function(n){return i(s(n))}},9590:(d,e,t)=>{var s=t(1291),i=RangeError;d.exports=function(n){var r=s(n);if(r<0)throw new i("The argument can't be less than 0");return r}},2777:(d,e,t)=>{var s=t(9565),i=t(34),n=t(757),r=t(5966),o=t(4270),h=t(8227),l=TypeError,c=h("toPrimitive");d.exports=function(p,u){if(!i(p)||n(p))return p;var g,f=r(p,c);if(f){if(u===void 0&&(u="default"),g=s(f,p,u),!i(g)||n(g))return g;throw new l("Can't convert object to primitive value")}return u===void 0&&(u="number"),o(p,u)}},6969:(d,e,t)=>{var s=t(2777),i=t(757);d.exports=function(n){var r=s(n,"string");return i(r)?r:r+""}},2140:(d,e,t)=>{var s={};s[t(8227)("toStringTag")]="z",d.exports=String(s)==="[object z]"},655:(d,e,t)=>{var s=t(6955),i=String;d.exports=function(n){if(s(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return i(n)}},6823:d=>{var e=String;d.exports=function(t){try{return e(t)}catch{return"Object"}}},3392:(d,e,t)=>{var s=t(9504),i=0,n=Math.random(),r=s(1 .toString);d.exports=function(o){return"Symbol("+(o===void 0?"":o)+")_"+r(++i+n,36)}},7040:(d,e,t)=>{var s=t(4495);d.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},8686:(d,e,t)=>{var s=t(3724),i=t(9039);d.exports=s&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},2812:d=>{var e=TypeError;d.exports=function(t,s){if(t<s)throw new e("Not enough arguments");return t}},8622:(d,e,t)=>{var s=t(4576),i=t(4901),n=s.WeakMap;d.exports=i(n)&&/native code/.test(String(n))},8227:(d,e,t)=>{var s=t(4576),i=t(5745),n=t(9297),r=t(3392),o=t(4495),h=t(7040),l=s.Symbol,c=i("wks"),p=h?l.for||l:l&&l.withoutSetter||r;d.exports=function(u){return n(c,u)||(c[u]=o&&n(l,u)?l[u]:p("Symbol."+u)),c[u]}},6573:(d,e,t)=>{var s=t(3724),i=t(2106),n=t(3238),r=ArrayBuffer.prototype;s&&!("detached"in r)&&i(r,"detached",{configurable:!0,get:function(){return n(this)}})},7936:(d,e,t)=>{var s=t(6518),i=t(5636);i&&s({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return i(this,arguments.length?arguments[0]:void 0,!1)}})},8100:(d,e,t)=>{var s=t(6518),i=t(5636);i&&s({target:"ArrayBuffer",proto:!0},{transfer:function(){return i(this,arguments.length?arguments[0]:void 0,!0)}})},4114:(d,e,t)=>{var s=t(6518),i=t(8981),n=t(6198),r=t(4527),o=t(6837);s({target:"Array",proto:!0,arity:1,forced:t(9039)(function(){return[].push.call({length:4294967296},1)!==4294967297})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(h){return h instanceof TypeError}}()},{push:function(h){var l=i(this),c=n(l),p=arguments.length;o(c+p);for(var u=0;u<p;u++)l[c]=arguments[u],c++;return r(l,c),c}})},4628:(d,e,t)=>{var s=t(6518),i=t(6043);s({target:"Promise",stat:!0},{withResolvers:function(){var n=i.f(this);return{promise:n.promise,resolve:n.resolve,reject:n.reject}}})},7642:(d,e,t)=>{var s=t(6518),i=t(3440);s({target:"Set",proto:!0,real:!0,forced:!t(4916)("difference")},{difference:i})},8004:(d,e,t)=>{var s=t(6518),i=t(9039),n=t(8750);s({target:"Set",proto:!0,real:!0,forced:!t(4916)("intersection")||i(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"})},{intersection:n})},3853:(d,e,t)=>{var s=t(6518),i=t(4449);s({target:"Set",proto:!0,real:!0,forced:!t(4916)("isDisjointFrom")},{isDisjointFrom:i})},5876:(d,e,t)=>{var s=t(6518),i=t(3838);s({target:"Set",proto:!0,real:!0,forced:!t(4916)("isSubsetOf")},{isSubsetOf:i})},2475:(d,e,t)=>{var s=t(6518),i=t(8527);s({target:"Set",proto:!0,real:!0,forced:!t(4916)("isSupersetOf")},{isSupersetOf:i})},5024:(d,e,t)=>{var s=t(6518),i=t(3650);s({target:"Set",proto:!0,real:!0,forced:!t(4916)("symmetricDifference")},{symmetricDifference:i})},1698:(d,e,t)=>{var s=t(6518),i=t(4204);s({target:"Set",proto:!0,real:!0,forced:!t(4916)("union")},{union:i})},7467:(d,e,t)=>{var s=t(7628),i=t(4644),n=i.aTypedArray,r=i.exportTypedArrayMethod,o=i.getTypedArrayConstructor;r("toReversed",function(){return s(n(this),o(this))})},4732:(d,e,t)=>{var s=t(4644),i=t(9504),n=t(9306),r=t(5370),o=s.aTypedArray,h=s.getTypedArrayConstructor,l=s.exportTypedArrayMethod,c=i(s.TypedArrayPrototype.sort);l("toSorted",function(p){p!==void 0&&n(p);var u=o(this),g=r(h(u),u);return c(g,p)})},9577:(d,e,t)=>{var s=t(9928),i=t(4644),n=t(1108),r=t(1291),o=t(5854),h=i.aTypedArray,l=i.getTypedArrayConstructor,c=i.exportTypedArrayMethod,p=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(u){return u===8}}();c("with",function(u,g){var f=h(this),b=r(u),w=n(f)?o(g):+g;return s(f,l(f),b,w)},!p)},8992:(d,e,t)=>{var s=t(6518),i=t(4576),n=t(679),r=t(8551),o=t(4901),h=t(2787),l=t(2106),c=t(4659),p=t(9039),u=t(9297),g=t(8227),f=t(7657).IteratorPrototype,b=t(3724),w=t(6395),y="constructor",x="Iterator",_=g("toStringTag"),E=TypeError,C=i[x],S=w||!o(C)||C.prototype!==f||!p(function(){C({})}),T=function(){if(n(this,f),h(this)===f)throw new E("Abstract class Iterator not directly constructable")},M=function(R,O){b?l(f,R,{configurable:!0,get:function(){return O},set:function(N){if(r(this),this===f)throw new E("You can't redefine this property");u(this,R)?this[R]=N:c(this,R,N)}}):f[R]=O};u(f,_)||M(_,x),!S&&u(f,y)&&f[y]!==Object||M(y,T),T.prototype=f,s({global:!0,constructor:!0,forced:S},{Iterator:T})},4743:(d,e,t)=>{var s=t(6518),i=t(9565),n=t(8551),r=t(1767),o=t(4149),h=t(9590),l=t(9462),c=t(6395),p=l(function(){for(var u,g=this.iterator,f=this.next;this.remaining;)if(this.remaining--,u=n(i(f,g)),this.done=!!u.done)return;if(u=n(i(f,g)),!(this.done=!!u.done))return u.value});s({target:"Iterator",proto:!0,real:!0,forced:c},{drop:function(u){n(this);var g=h(o(+u));return new p(r(this),{remaining:g})}})},3215:(d,e,t)=>{var s=t(6518),i=t(2652),n=t(9306),r=t(8551),o=t(1767);s({target:"Iterator",proto:!0,real:!0},{every:function(h){r(this),n(h);var l=o(this),c=0;return!i(l,function(p,u){if(!h(p,c++))return u()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},4520:(d,e,t)=>{var s=t(6518),i=t(9565),n=t(9306),r=t(8551),o=t(1767),h=t(9462),l=t(6319),c=t(6395),p=h(function(){for(var u,g,f=this.iterator,b=this.predicate,w=this.next;;){if(u=r(i(w,f)),this.done=!!u.done)return;if(g=u.value,l(f,b,[g,this.counter++],!0))return g}});s({target:"Iterator",proto:!0,real:!0,forced:c},{filter:function(u){return r(this),n(u),new p(o(this),{predicate:u})}})},670:(d,e,t)=>{var s=t(6518),i=t(9565),n=t(9306),r=t(8551),o=t(1767),h=t(8646),l=t(9462),c=t(9539),p=t(6395),u=l(function(){for(var g,f,b=this.iterator,w=this.mapper;;){if(f=this.inner)try{if(!(g=r(i(f.next,f.iterator))).done)return g.value;this.inner=null}catch(y){c(b,"throw",y)}if(g=r(i(this.next,b)),this.done=!!g.done)return;try{this.inner=h(w(g.value,this.counter++),!1)}catch(y){c(b,"throw",y)}}});s({target:"Iterator",proto:!0,real:!0,forced:p},{flatMap:function(g){return r(this),n(g),new u(o(this),{mapper:g,inner:null})}})},1454:(d,e,t)=>{var s=t(6518),i=t(713);s({target:"Iterator",proto:!0,real:!0,forced:t(6395)},{map:i})},7550:(d,e,t)=>{var s=t(6518),i=t(2652),n=t(9306),r=t(8551),o=t(1767);s({target:"Iterator",proto:!0,real:!0},{some:function(h){r(this),n(h);var l=o(this),c=0;return i(l,function(p,u){if(h(p,c++))return u()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},8335:(d,e,t)=>{var s=t(6518),i=t(3724),n=t(4576),r=t(7751),o=t(9504),h=t(9565),l=t(4901),c=t(34),p=t(4376),u=t(9297),g=t(655),f=t(6198),b=t(4659),w=t(9039),y=t(8235),x=t(4495),_=n.JSON,E=n.Number,C=n.SyntaxError,S=_&&_.parse,T=r("Object","keys"),M=Object.getOwnPropertyDescriptor,R=o("".charAt),O=o("".slice),N=o(/./.exec),Z=o([].push),$=/^\d$/,j=/^[1-9]$/,it=/^[\d-]$/,ot=/^[\t\n\r ]$/,mt=function(F,I,k,D){var U,rt,Bt,bt,ms,vs=F[I],Yd=D&&vs===D.value,Mm=Yd&&typeof D.source=="string"?{source:D.source}:{};if(c(vs)){var Kd=p(vs),Rh=Yd?D.nodes:Kd?[]:{};if(Kd)for(U=Rh.length,Bt=f(vs),bt=0;bt<Bt;bt++)H(vs,bt,mt(vs,""+bt,k,bt<U?Rh[bt]:void 0));else for(rt=T(vs),Bt=f(rt),bt=0;bt<Bt;bt++)ms=rt[bt],H(vs,ms,mt(vs,ms,k,u(Rh,ms)?Rh[ms]:void 0))}return h(k,F,I,vs,Mm)},H=function(F,I,k){if(i){var D=M(F,I);if(D&&!D.configurable)return}k===void 0?delete F[I]:b(F,I,k)},q=function(F,I,k,D){this.value=F,this.end=I,this.source=k,this.nodes=D},Mt=function(F,I){this.source=F,this.index=I};Mt.prototype={fork:function(F){return new Mt(this.source,F)},parse:function(){var F=this.source,I=this.skip(ot,this.index),k=this.fork(I),D=R(F,I);if(N(it,D))return k.number();switch(D){case"{":return k.object();case"[":return k.array();case'"':return k.string();case"t":return k.keyword(!0);case"f":return k.keyword(!1);case"n":return k.keyword(null)}throw new C('Unexpected character: "'+D+'" at: '+I)},node:function(F,I,k,D,U){return new q(I,D,F?null:O(this.source,k,D),U)},object:function(){for(var F=this.source,I=this.index+1,k=!1,D={},U={};I<F.length;){if(I=this.until(['"',"}"],I),R(F,I)==="}"&&!k){I++;break}var rt=this.fork(I).string(),Bt=rt.value;I=rt.end,I=this.until([":"],I)+1,I=this.skip(ot,I),rt=this.fork(I).parse(),b(U,Bt,rt),b(D,Bt,rt.value),I=this.until([",","}"],rt.end);var bt=R(F,I);if(bt===",")k=!0,I++;else if(bt==="}"){I++;break}}return this.node(1,D,this.index,I,U)},array:function(){for(var F=this.source,I=this.index+1,k=!1,D=[],U=[];I<F.length;){if(I=this.skip(ot,I),R(F,I)==="]"&&!k){I++;break}var rt=this.fork(I).parse();if(Z(U,rt),Z(D,rt.value),I=this.until([",","]"],rt.end),R(F,I)===",")k=!0,I++;else if(R(F,I)==="]"){I++;break}}return this.node(1,D,this.index,I,U)},string:function(){var F=this.index,I=y(this.source,this.index+1);return this.node(0,I.value,F,I.end)},number:function(){var F=this.source,I=this.index,k=I;if(R(F,k)==="-"&&k++,R(F,k)==="0")k++;else{if(!N(j,R(F,k)))throw new C("Failed to parse number at: "+k);k=this.skip($,k+1)}if(R(F,k)==="."&&(k=this.skip($,k+1)),(R(F,k)==="e"||R(F,k)==="E")&&(k++,R(F,k)!=="+"&&R(F,k)!=="-"||k++,k===(k=this.skip($,k))))throw new C("Failed to parse number's exponent value at: "+k);return this.node(0,E(O(F,I,k)),I,k)},keyword:function(F){var I=""+F,k=this.index,D=k+I.length;if(O(this.source,k,D)!==I)throw new C("Failed to parse value at: "+k);return this.node(0,F,k,D)},skip:function(F,I){for(var k=this.source;I<k.length&&N(F,R(k,I));I++);return I},until:function(F,I){I=this.skip(ot,I);for(var k=R(this.source,I),D=0;D<F.length;D++)if(F[D]===k)return I;throw new C('Unexpected character: "'+k+'" at: '+I)}};var ge=w(function(){var F,I="9007199254740993";return S(I,function(k,D,U){F=U.source}),F!==I}),vt=x&&!w(function(){return 1/S("-0 	")!=-1/0});s({target:"JSON",stat:!0,forced:ge},{parse:function(F,I){return vt&&!l(I)?S(F):function(k,D){k=g(k);var U=new Mt(k,0),rt=U.parse(),Bt=rt.value,bt=U.skip(ot,rt.end);if(bt<k.length)throw new C('Unexpected extra character: "'+R(k,bt)+'" after the parsed data at: '+bt);return l(D)?mt({"":Bt},"",D,rt):Bt}(F,I)}})},4979:(d,e,t)=>{var s=t(6518),i=t(4576),n=t(7751),r=t(6980),o=t(4913).f,h=t(9297),l=t(679),c=t(3167),p=t(2603),u=t(5002),g=t(8574),f=t(3724),b=t(6395),w="DOMException",y=n("Error"),x=n(w),_=function(){l(this,E);var it=arguments.length,ot=p(it<1?void 0:arguments[0]),mt=p(it<2?void 0:arguments[1],"Error"),H=new x(ot,mt),q=new y(ot);return q.name=w,o(H,"stack",r(1,g(q.stack,1))),c(H,this,_),H},E=_.prototype=x.prototype,C="stack"in new y(w),S="stack"in new x(1,2),T=x&&f&&Object.getOwnPropertyDescriptor(i,w),M=!(!T||T.writable&&T.configurable),R=C&&!M&&!S;s({global:!0,constructor:!0,forced:b||R},{DOMException:R?_:x});var O=n(w),N=O.prototype;if(N.constructor!==O){b||o(N,"constructor",r(1,O));for(var Z in u)if(h(u,Z)){var $=u[Z],j=$.s;h(O,j)||o(O,j,r(6,$.c))}}},4603:(d,e,t)=>{var s=t(6840),i=t(9504),n=t(655),r=t(2812),o=URLSearchParams,h=o.prototype,l=i(h.append),c=i(h.delete),p=i(h.forEach),u=i([].push),g=new o("a=1&a=2&b=3");g.delete("a",1),g.delete("b",void 0),g+""!="a=2"&&s(h,"delete",function(f){var b=arguments.length,w=b<2?void 0:arguments[1];if(b&&w===void 0)return c(this,f);var y=[];p(this,function(R,O){u(y,{key:O,value:R})}),r(b,1);for(var x,_=n(f),E=n(w),C=0,S=0,T=!1,M=y.length;C<M;)x=y[C++],T||x.key===_?(T=!0,c(this,x.key)):S++;for(;S<M;)(x=y[S++]).key===_&&x.value===E||l(this,x.key,x.value)},{enumerable:!0,unsafe:!0})},7566:(d,e,t)=>{var s=t(6840),i=t(9504),n=t(655),r=t(2812),o=URLSearchParams,h=o.prototype,l=i(h.getAll),c=i(h.has),p=new o("a=1");!p.has("a",2)&&p.has("a",void 0)||s(h,"has",function(u){var g=arguments.length,f=g<2?void 0:arguments[1];if(g&&f===void 0)return c(this,u);var b=l(this,u);r(g,1);for(var w=n(f),y=0;y<b.length;)if(b[y++]===w)return!0;return!1},{enumerable:!0,unsafe:!0})},8721:(d,e,t)=>{var s=t(3724),i=t(9504),n=t(2106),r=URLSearchParams.prototype,o=i(r.forEach);s&&!("size"in r)&&n(r,"size",{get:function(){var h=0;return o(this,function(){h++}),h},configurable:!0,enumerable:!0})}},pt={};function V(d){var e=pt[d];if(e!==void 0)return e.exports;var t=pt[d]={exports:{}};return ut[d].call(t.exports,t,t.exports,V),t.exports}V.d=(d,e)=>{for(var t in e)V.o(e,t)&&!V.o(d,t)&&Object.defineProperty(d,t,{enumerable:!0,get:e[t]})},V.o=(d,e)=>Object.prototype.hasOwnProperty.call(d,e);var W=globalThis.pdfjsLib={};V.d(W,{AbortException:()=>Fi,AnnotationEditorLayer:()=>Wl,AnnotationEditorParamsType:()=>X,AnnotationEditorType:()=>J,AnnotationEditorUIManager:()=>Ni,AnnotationLayer:()=>Cm,AnnotationMode:()=>Js,ColorPicker:()=>dh,DOMSVGFactory:()=>Hl,DrawLayer:()=>ql,FeatureTest:()=>ee,GlobalWorkerOptions:()=>ys,ImageKind:()=>Xo,InvalidPDFException:()=>Jc,MissingPDFException:()=>Di,OPS:()=>Oe,OutputScale:()=>yl,PDFDataRangeTransport:()=>Ld,PDFDateString:()=>bl,PDFWorker:()=>Xn,PasswordResponses:()=>Yg,PermissionFlag:()=>Sg,PixelsPerInch:()=>ti,RenderingCancelledException:()=>ml,TextLayer:()=>da,UnexpectedResponseException:()=>Jo,Util:()=>z,VerbosityLevel:()=>Yo,XfaLayer:()=>Nd,build:()=>om,createValidAbsoluteUrl:()=>Jg,fetchData:()=>th,getDocument:()=>tm,getFilenameFromUrl:()=>df,getPdfFilenameFromUrl:()=>uf,getXfaPageViewport:()=>pf,isDataScheme:()=>eh,isPdfFile:()=>vl,noContextMenu:()=>Ce,normalizeUnicode:()=>tf,setLayerDimensions:()=>Oi,shadow:()=>nt,version:()=>am}),V(4114),V(6573),V(8100),V(7936),V(7467),V(4732),V(9577),V(4979),V(4603),V(7566),V(8721);const Ht=!(typeof Xr!="object"||Xr+""!="[object process]"||Xr.versions.nw||Xr.versions.electron&&Xr.type&&Xr.type!=="browser"),Yc=[1,0,0,1,0,0],al=[.001,0,0,.001,0,0],ol=1.35,bg=1,hl=2,Wo=4,Ag=16,yg=32,wg=64,xg=128,_g=256,Js={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},J={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},X={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},Sg={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},qo=0,ll=1,ia=2,Eg=3,Kc=3,Cg=4,Xo={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Tg=1,kg=2,Mg=3,Rg=4,Ig=5,Pg=6,Lg=7,Dg=8,Fg=9,Og=10,Ng=11,Bg=12,Hg=13,jg=14,zg=15,Qc=16,$g=17,Ug=20,Gg=1,Vg=2,Wg=3,qg=4,Xg=5,Yo={ERRORS:0,WARNINGS:1,INFOS:5},Oe={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Yg={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ko=Yo.WARNINGS;function Kg(d){Number.isInteger(d)&&(Ko=d)}function Qg(){return Ko}function Qo(d){Ko>=Yo.INFOS&&console.log(`Info: ${d}`)}function K(d){Ko>=Yo.WARNINGS&&console.log(`Warning: ${d}`)}function yt(d){throw new Error(d)}function Pt(d,e){d||yt(e)}function Jg(d,e=null,t=null){var s;if(!d)return null;try{if(t&&typeof d=="string"&&(t.addDefaultProtocol&&d.startsWith("www.")&&((s=d.match(/\./g))==null?void 0:s.length)>=2&&(d=`http://${d}`),t.tryConvertEncoding))try{d=function(n){return decodeURIComponent(escape(n))}(d)}catch{}const i=e?new URL(d,e):new URL(d);if(function(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i))return i}catch{}return null}function nt(d,e,t,s=!1){return Object.defineProperty(d,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Zs=function(){function d(e,t){this.message=e,this.name=t}return d.prototype=new Error,d.constructor=d,d}();class cl extends Zs{constructor(e,t){super(e,"PasswordException"),this.code=t}}class dl extends Zs{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Jc extends Zs{constructor(e){super(e,"InvalidPDFException")}}class Di extends Zs{constructor(e){super(e,"MissingPDFException")}}class Jo extends Zs{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class Zg extends Zs{constructor(e){super(e,"FormatError")}}class Fi extends Zs{constructor(e){super(e,"AbortException")}}function Zc(d){typeof d=="object"&&(d==null?void 0:d.length)!==void 0||yt("Invalid argument for bytesToString");const e=d.length,t=8192;if(e<t)return String.fromCharCode.apply(null,d);const s=[];for(let i=0;i<e;i+=t){const n=Math.min(i+t,e),r=d.subarray(i,n);s.push(String.fromCharCode.apply(null,r))}return s.join("")}function Zo(d){typeof d!="string"&&yt("Invalid argument for stringToBytes");const e=d.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=255&d.charCodeAt(s);return t}function ul(d){const e=Object.create(null);for(const[t,s]of d)e[t]=s;return e}class ee{static get isLittleEndian(){return nt(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,new Uint32Array(e.buffer,0,1)[0]===1}())}static get isEvalSupported(){return nt(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return nt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?nt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):nt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return nt(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const pl=Array.from(Array(256).keys(),d=>d.toString(16).padStart(2,"0"));class z{static makeHexColor(e,t,s){return`#${pl[e]}${pl[t]}${pl[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),n=this.applyTransform([e[0],e[3]],t),r=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],n[0],r[0]),Math.min(s[1],i[1],n[1],r[1]),Math.max(s[0],i[0],n[0],r[0]),Math.max(s[1],i[1],n[1],r[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],n=e[2]*t[0]+e[3]*t[2],r=e[2]*t[1]+e[3]*t[3],o=(s+r)/2,h=Math.sqrt((s+r)**2-4*(s*r-n*i))/2,l=o+h||1,c=o-h||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const n=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),r=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return n>r?null:[s,n,i,r]}static bezierBoundingBox(e,t,s,i,n,r,o,h,l){return l?(l[0]=Math.min(l[0],e,o),l[1]=Math.min(l[1],t,h),l[2]=Math.max(l[2],e,o),l[3]=Math.max(l[3],t,h)):l=[Math.min(e,o),Math.min(t,h),Math.max(e,o),Math.max(t,h)],v(this,xs,Jl).call(this,e,s,n,o,t,i,r,h,3*(3*(s-n)-e+o),6*(e-2*s+n),3*(s-e),l),v(this,xs,Jl).call(this,e,s,n,o,t,i,r,h,3*(3*(i-r)-t+h),6*(t-2*i+r),3*(i-t),l),l}}xs=new WeakSet,Ih=function(e,t,s,i,n,r,o,h,l,c){if(l<=0||l>=1)return;const p=1-l,u=l*l,g=u*l,f=p*(p*(p*e+3*l*t)+3*u*s)+g*i,b=p*(p*(p*n+3*l*r)+3*u*o)+g*h;c[0]=Math.min(c[0],f),c[1]=Math.min(c[1],b),c[2]=Math.max(c[2],f),c[3]=Math.max(c[3],b)},Jl=function(e,t,s,i,n,r,o,h,l,c,p,u){if(Math.abs(l)<1e-12){Math.abs(c)>=1e-12&&v(this,xs,Ih).call(this,e,t,s,i,n,r,o,h,-p/c,u);return}const g=c**2-4*p*l;if(g<0)return;const f=Math.sqrt(g),b=2*l;v(this,xs,Ih).call(this,e,t,s,i,n,r,o,h,(-c+f)/b,u),v(this,xs,Ih).call(this,e,t,s,i,n,r,o,h,(-c-f)/b,u)},A(z,xs);let gl=null,td=null;function tf(d){return gl||(gl=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,td=new Map([["\uFB05","\u017Ft"]])),d.replaceAll(gl,(e,t,s)=>t?t.normalize("NFKC"):td.get(s))}const fl="pdfjs_internal_id_",ef=0,sf=1,nf=2,rf=3,af=4,of=5,hf=6,lf=7,cf=8;V(4628),V(7642),V(8004),V(3853),V(5876),V(2475),V(5024),V(1698),V(1454),V(8992),V(4743),V(3215),V(7550),V(8335);const bs="http://www.w3.org/2000/svg",zi=class zi{};Y(zi,"CSS",96),Y(zi,"PDF",72),Y(zi,"PDF_TO_CSS_UNITS",zi.CSS/zi.PDF);let ti=zi;async function th(d,e="text"){if(ra(d,document.baseURI)){const t=await fetch(d);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",d,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE)if(i.status!==200&&i.status!==0)s(new Error(i.statusText));else{switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText)}},i.send(null)})}class na{constructor({viewBox:e,scale:t,rotation:s,offsetX:i=0,offsetY:n=0,dontFlip:r=!1}){this.viewBox=e,this.scale=t,this.rotation=s,this.offsetX=i,this.offsetY=n;const o=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let l,c,p,u,g,f,b,w;switch((s%=360)<0&&(s+=360),s){case 180:l=-1,c=0,p=0,u=1;break;case 90:l=0,c=1,p=1,u=0;break;case 270:l=0,c=-1,p=-1,u=0;break;case 0:l=1,c=0,p=0,u=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}r&&(p=-p,u=-u),l===0?(g=Math.abs(h-e[1])*t+i,f=Math.abs(o-e[0])*t+n,b=(e[3]-e[1])*t,w=(e[2]-e[0])*t):(g=Math.abs(o-e[0])*t+i,f=Math.abs(h-e[1])*t+n,b=(e[2]-e[0])*t,w=(e[3]-e[1])*t),this.transform=[l*t,c*t,p*t,u*t,g-l*t*o-p*t*h,f-c*t*o-u*t*h],this.width=b,this.height=w}get rawDims(){const{viewBox:e}=this;return nt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:n=!1}={}){return new na({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:n})}convertToViewportPoint(e,t){return z.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=z.applyTransform([e[0],e[1]],this.transform),s=z.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return z.applyInverseTransform([e,t],this.transform)}}class ml extends Zs{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function eh(d){const e=d.length;let t=0;for(;t<e&&d[t].trim()==="";)t++;return d.substring(t,t+5).toLowerCase()==="data:"}function vl(d){return typeof d=="string"&&/\.pdf$/i.test(d)}function df(d){return[d]=d.split(/[#?]/,1),d.substring(d.lastIndexOf("/")+1)}function uf(d,e="document.pdf"){if(typeof d!="string")return e;if(eh(d))return K('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(d);let i=t.exec(s[1])||t.exec(s[2])||t.exec(s[3]);if(i&&(i=i[0],i.includes("%")))try{i=t.exec(decodeURIComponent(i))[0]}catch{}return i||e}class ed{constructor(){Y(this,"started",Object.create(null));Y(this,"times",[])}time(e){e in this.started&&K(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||K(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:n}of this.times)e.push(`${s.padEnd(t)} ${n-i}ms
`);return e.join("")}}function ra(d,e){try{const{protocol:t}=e?new URL(d,e):new URL(d);return t==="http:"||t==="https:"}catch{return!1}}function Ce(d){d.preventDefault()}function sd(d){console.log("Deprecated API usage: "+d)}class bl{static toDateObject(e){if(!e||typeof e!="string")return null;a(this,fa)||m(this,fa,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=a(this,fa).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let n=parseInt(t[3],10);n=n>=1&&n<=31?n:1;let r=parseInt(t[4],10);r=r>=0&&r<=23?r:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let p=parseInt(t[9],10)||0;return p=p>=0&&p<=59?p:0,l==="-"?(r+=c,o+=p):l==="+"&&(r-=c,o-=p),new Date(Date.UTC(s,i,n,r,o,h))}}fa=new WeakMap,A(bl,fa);function pf(d,{scale:e=1,rotation:t=0}){const{width:s,height:i}=d.attributes.style,n=[0,0,parseInt(s),parseInt(i)];return new na({viewBox:n,scale:e,rotation:t})}function Al(d){if(d.startsWith("#")){const e=parseInt(d.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}return d.startsWith("rgb(")?d.slice(4,-1).split(",").map(e=>parseInt(e)):d.startsWith("rgba(")?d.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(K(`Not a valid color format: "${d}"`),[0,0,0])}function xt(d){const{a:e,b:t,c:s,d:i,e:n,f:r}=d.getTransform();return[e,t,s,i,n,r]}function As(d){const{a:e,b:t,c:s,d:i,e:n,f:r}=d.getTransform().invertSelf();return[e,t,s,i,n,r]}function Oi(d,e,t=!1,s=!0){if(e instanceof na){const{pageWidth:i,pageHeight:n}=e.rawDims,{style:r}=d,o=ee.isCSSRoundSupported,h=`var(--scale-factor) * ${i}px`,l=`var(--scale-factor) * ${n}px`,c=o?`round(down, ${h}, var(--scale-round-x, 1px))`:`calc(${h})`,p=o?`round(down, ${l}, var(--scale-round-y, 1px))`:`calc(${l})`;t&&e.rotation%180!=0?(r.width=p,r.height=c):(r.width=c,r.height=p)}s&&d.setAttribute("data-main-rotation",e.rotation)}class yl{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}const _s=class _s{constructor(e){A(this,se);A(this,ii,null);A(this,$i,null);A(this,Ne);A(this,Ui,null);A(this,ma,null);m(this,Ne,e),a(_s,va)||m(_s,va,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=m(this,ii,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=a(this,Ne)._uiManager._signal;e.addEventListener("contextmenu",Ce,{signal:t}),e.addEventListener("pointerdown",v(_s,ph,Uu),{signal:t});const s=m(this,Ui,document.createElement("div"));s.className="buttons",e.append(s);const i=a(this,Ne).toolbarPosition;if(i){const{style:n}=e,r=a(this,Ne)._uiManager.direction==="ltr"?1-i[0]:i[0];n.insetInlineEnd=100*r+"%",n.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return v(this,se,Wu).call(this),e}get div(){return a(this,ii)}hide(){var e;a(this,ii).classList.add("hidden"),(e=a(this,$i))==null||e.hideDropdown()}show(){var e;a(this,ii).classList.remove("hidden"),(e=a(this,ma))==null||e.shown()}async addAltText(e){const t=await e.render();v(this,se,Ph).call(this,t),a(this,Ui).prepend(t,a(this,se,Zl)),m(this,ma,e)}addColorPicker(e){m(this,$i,e);const t=e.renderButton();v(this,se,Ph).call(this,t),a(this,Ui).prepend(t,a(this,se,Zl))}remove(){var e;a(this,ii).remove(),(e=a(this,$i))==null||e.destroy(),m(this,$i,null)}};ii=new WeakMap,$i=new WeakMap,Ne=new WeakMap,Ui=new WeakMap,ma=new WeakMap,va=new WeakMap,ph=new WeakSet,Uu=function(e){e.stopPropagation()},se=new WeakSet,Gu=function(e){a(this,Ne)._focusEventsAllowed=!1,e.preventDefault(),e.stopPropagation()},Vu=function(e){a(this,Ne)._focusEventsAllowed=!0,e.preventDefault(),e.stopPropagation()},Ph=function(e){const t=a(this,Ne)._uiManager._signal;e.addEventListener("focusin",v(this,se,Gu).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",v(this,se,Vu).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ce,{signal:t})},Wu=function(){const{editorType:e,_uiManager:t}=a(this,Ne),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",a(_s,va)[e]),v(this,se,Ph).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),a(this,Ui).append(s)},Zl=function(){const e=document.createElement("div");return e.className="divider",e},A(_s,ph),A(_s,va,null);let wl=_s;class gf{constructor(e){A(this,ni);A(this,ba,null);A(this,Gi,null);A(this,Vi);m(this,Vi,e)}show(e,t,s){const[i,n]=v(this,ni,Xu).call(this,t,s),{style:r}=a(this,Gi)||m(this,Gi,v(this,ni,qu).call(this));e.append(a(this,Gi)),r.insetInlineEnd=100*i+"%",r.top=`calc(${100*n}% + var(--editor-toolbar-vert-offset))`}hide(){a(this,Gi).remove()}}ba=new WeakMap,Gi=new WeakMap,Vi=new WeakMap,ni=new WeakSet,qu=function(){const e=m(this,Gi,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Ce,{signal:a(this,Vi)._signal});const t=m(this,ba,document.createElement("div"));return t.className="buttons",e.append(t),v(this,ni,Yu).call(this),e},Xu=function(e,t){let s=0,i=0;for(const n of e){const r=n.y+n.height;if(r<s)continue;const o=n.x+(t?n.width:0);r>s?(i=o,s=r):t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,s]},Yu=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=a(this,Vi)._signal;e.addEventListener("contextmenu",Ce,{signal:s}),e.addEventListener("click",()=>{a(this,Vi).highlightSelection("floating_button")},{signal:s}),a(this,ba).append(e)};function sh(d,e,t){for(const s of t)e.addEventListener(s,d[s].bind(d))}class ff{constructor(){A(this,gh,0)}get id(){return"pdfjs_internal_editor_"+re(this,gh)._++}}gh=new WeakMap;const Xl=class Xl{constructor(){A(this,Kn);A(this,Yn,function(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const e=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(e);else for(let t=0;t<32;t++)e[t]=Math.floor(255*Math.random());return Zc(e)}());A(this,Aa,0);A(this,Kt,null)}static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',nt(this,"_isSVGFittingCanvas",t.decode().then(()=>(e.drawImage(t,0,0,1,1,0,0,1,3),new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0]===0)))}async getFromFile(e){const{lastModified:t,name:s,size:i,type:n}=e;return v(this,Kn,Lh).call(this,`${t}_${s}_${i}_${n}`,e)}async getFromUrl(e){return v(this,Kn,Lh).call(this,e,e)}async getFromBlob(e,t){const s=await t;return v(this,Kn,Lh).call(this,e,s)}async getFromId(e){a(this,Kt)||m(this,Kt,new Map);const t=a(this,Kt).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){a(this,Kt)||m(this,Kt,new Map);let s=a(this,Kt).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${a(this,Yn)}_${re(this,Aa)._++}`,refCounter:1,isSvg:!1},a(this,Kt).set(e,s),a(this,Kt).set(s.id,s),s}getSvgUrl(e){const t=a(this,Kt).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;a(this,Kt)||m(this,Kt,new Map);const t=a(this,Kt).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const n=new OffscreenCanvas(s.width,s.height);n.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=n.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${a(this,Yn)}_`)}};Yn=new WeakMap,Aa=new WeakMap,Kt=new WeakMap,Kn=new WeakSet,Lh=async function(e,t){a(this,Kt)||m(this,Kt,new Map);let s=a(this,Kt).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${a(this,Yn)}_${re(this,Aa)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await th(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const n=Xl._isSVGFittingCanvas,r=new FileReader,o=new Image,h=new Promise((l,c)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,l()},r.onload=async()=>{const p=s.svgUrl=r.result;o.src=await n?`${p}#svgView(preserveAspectRatio(none))`:p},o.onerror=r.onerror=c});r.readAsDataURL(i),await h}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){console.error(i),s=null}return a(this,Kt).set(e,s),s&&a(this,Kt).set(s.id,s),s};let xl=Xl;class mf{constructor(e=128){A(this,jt,[]);A(this,ri,!1);A(this,ya);A(this,zt,-1);m(this,ya,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:n=NaN,overwriteIfSameType:r=!1,keepUndo:o=!1}){if(i&&e(),a(this,ri))return;const h={cmd:e,undo:t,post:s,type:n};if(a(this,zt)===-1){a(this,jt).length>0&&(a(this,jt).length=0),m(this,zt,0),a(this,jt).push(h);return}if(r&&a(this,jt)[a(this,zt)].type===n){o&&(h.undo=a(this,jt)[a(this,zt)].undo),a(this,jt)[a(this,zt)]=h;return}const l=a(this,zt)+1;l===a(this,ya)?a(this,jt).splice(0,1):(m(this,zt,l),l<a(this,jt).length&&a(this,jt).splice(l)),a(this,jt).push(h)}undo(){if(a(this,zt)===-1)return;m(this,ri,!0);const{undo:e,post:t}=a(this,jt)[a(this,zt)];e(),t==null||t(),m(this,ri,!1),m(this,zt,a(this,zt)-1)}redo(){if(a(this,zt)<a(this,jt).length-1){m(this,zt,a(this,zt)+1),m(this,ri,!0);const{cmd:e,post:t}=a(this,jt)[a(this,zt)];e(),t==null||t(),m(this,ri,!1)}}hasSomethingToUndo(){return a(this,zt)!==-1}hasSomethingToRedo(){return a(this,zt)<a(this,jt).length-1}destroy(){m(this,jt,null)}}jt=new WeakMap,ri=new WeakMap,ya=new WeakMap,zt=new WeakMap;class aa{constructor(e){A(this,fh);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=ee.platform;for(const[s,i,n={}]of e)for(const r of s){const o=r.startsWith("mac+");t&&o?(this.callbacks.set(r.slice(4),{callback:i,options:n}),this.allKeys.add(r.split("+").at(-1))):!t&&!o&&(this.callbacks.set(r,{callback:i,options:n}),this.allKeys.add(r.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(v(this,fh,Ku).call(this,t));if(!s)return;const{callback:i,options:{bubbles:n=!1,args:r=[],checker:o=null}}=s;(!o||o(e,t))&&(i.bind(e,...r,t)(),n||(t.stopPropagation(),t.preventDefault()))}}fh=new WeakSet,Ku=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const mh=class mh{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return function(t){const s=document.createElement("span");s.style.visibility="hidden",document.body.append(s);for(const i of t.keys()){s.style.color=i;const n=window.getComputedStyle(s).color;t.set(i,Al(n))}s.remove()}(e),nt(this,"_colors",e)}convert(e){const t=Al(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((n,r)=>n===t[r]))return mh._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?z.makeHexColor(...t):e}};Y(mh,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let _l=mh;const ir=class ir{constructor(e,t,s,i,n,r,o,h,l,c,p){A(this,L);A(this,Qn,new AbortController);A(this,me,null);A(this,Lt,new Map);A(this,Vt,new Map);A(this,Jn,null);A(this,Ss,null);A(this,Zn,null);A(this,Be,new mf);A(this,ai,null);A(this,tr,0);A(this,Wi,new Set);A(this,Je,null);A(this,He,null);A(this,qi,new Set);A(this,wa,!1);A(this,xa,!1);A(this,er,!1);A(this,_a,null);A(this,Ze,null);A(this,oi,null);A(this,sr,null);A(this,hi,!1);A(this,ts,null);A(this,vh,new ff);A(this,li,!1);A(this,Sa,!1);A(this,ci,null);A(this,Xi,null);A(this,Ea,null);A(this,Ca,null);A(this,$t,J.NONE);A(this,ct,new Set);A(this,Es,null);A(this,Yi,null);A(this,Ta,null);A(this,ka,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});A(this,di,[0,0]);A(this,es,null);A(this,Cs,null);A(this,Ma,null);A(this,ke,null);const u=this._signal=a(this,Qn).signal;m(this,Cs,e),m(this,Ma,t),m(this,Jn,s),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:u}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:u}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:u}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:u}),i._on("setpreference",this.onSetPreference.bind(this),{signal:u}),i._on("switchannotationeditorparams",g=>this.updateParams(g.type,g.value),{signal:u}),v(this,L,Zu).call(this),v(this,L,ip).call(this),v(this,L,ec).call(this),m(this,Ss,n.annotationStorage),m(this,_a,n.filterFactory),m(this,Yi,r),m(this,sr,o||null),m(this,wa,h),m(this,xa,l),m(this,er,c),m(this,Ca,p||null),this.viewParameters={realScale:ti.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const e=ir.prototype,t=r=>a(r,Cs).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&r.hasSomethingToControl(),s=(r,{target:o})=>{if(o instanceof HTMLInputElement){const{type:h}=o;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,n=this.TRANSLATE_BIG;return nt(this,"_keyboardManager",new aa([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(r,{target:o})=>!(o instanceof HTMLButtonElement)&&a(r,Cs).contains(o)&&!r.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(r,{target:o})=>!(o instanceof HTMLButtonElement)&&a(r,Cs).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}]]))}destroy(){var e,t,s,i;(e=a(this,ke))==null||e.resolve(),m(this,ke,null),(t=a(this,Qn))==null||t.abort(),m(this,Qn,null),this._signal=null;for(const n of a(this,Vt).values())n.destroy();a(this,Vt).clear(),a(this,Lt).clear(),a(this,qi).clear(),m(this,me,null),a(this,ct).clear(),a(this,Be).destroy(),(s=a(this,Jn))==null||s.destroy(),(i=a(this,ts))==null||i.hide(),m(this,ts,null),a(this,Ze)&&(clearTimeout(a(this,Ze)),m(this,Ze,null)),a(this,es)&&(clearTimeout(a(this,es)),m(this,es,null))}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return a(this,Ca)}get useNewAltTextFlow(){return a(this,xa)}get useNewAltTextWhenAddingImage(){return a(this,er)}get hcmFilter(){return nt(this,"hcmFilter",a(this,Yi)?a(this,_a).addHCMFilter(a(this,Yi).foreground,a(this,Yi).background):"none")}get direction(){return nt(this,"direction",getComputedStyle(a(this,Cs)).direction)}get highlightColors(){return nt(this,"highlightColors",a(this,sr)?new Map(a(this,sr).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return nt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setMainHighlightColorPicker(e){m(this,Ea,e)}editAltText(e,t=!1){var s;(s=a(this,Jn))==null||s.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){e==="enableNewAltTextWhenAddingImage"&&m(this,er,t)}onPageChanging({pageNumber:e}){m(this,tr,e-1)}focusMainContainer(){a(this,Cs).focus()}findParent(e,t){for(const s of a(this,Vt).values()){const{x:i,y:n,width:r,height:o}=s.div.getBoundingClientRect();if(e>=i&&e<=i+r&&t>=n&&t<=n+o)return s}return null}disableUserSelect(e=!1){a(this,Ma).classList.toggle("noUserSelect",e)}addShouldRescale(e){a(this,qi).add(e)}removeShouldRescale(e){a(this,qi).delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*ti.PDF_TO_CSS_UNITS;for(const t of a(this,qi))t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:n,focusOffset:r}=t,o=t.toString(),h=v(this,L,Dh).call(this,t).closest(".textLayer"),l=this.getSelectionBoxes(h);if(!l)return;t.empty();const c=v(this,L,tc).call(this,h),p=a(this,$t)===J.NONE,u=()=>{c==null||c.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:l,anchorNode:s,anchorOffset:i,focusNode:n,focusOffset:r,text:o}),p&&this.showAllEditors("highlight",!0,!0)};p?this.switchToMode(J.HIGHLIGHT,u):u()}addToAnnotationStorage(e){e.isEmpty()||!a(this,Ss)||a(this,Ss).has(e.id)||a(this,Ss).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,a(this,hi)&&(m(this,hi,!1),v(this,L,Fh).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of a(this,ct))if(t.div.contains(e)){m(this,Xi,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!a(this,Xi))return;const[e,t]=a(this,Xi);m(this,Xi,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){v(this,L,ec).call(this),v(this,L,sc).call(this)}removeEditListeners(){v(this,L,sp).call(this),v(this,L,ic).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of a(this,He))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of a(this,He))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=a(this,me))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of a(this,ct)){const n=i.serialize(!0);n&&t.push(n)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const n of t.items)for(const r of a(this,He))if(r.isHandlingMimeForPasting(n.type)){r.paste(n,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(n){K(`paste: "${n.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const n=[];for(const h of s){const l=await i.deserialize(h);if(!l)return;n.push(l)}const r=()=>{for(const h of n)v(this,L,nc).call(this,h);v(this,L,rc).call(this,n)},o=()=>{for(const h of n)h.remove()};this.addCommands({cmd:r,undo:o,mustExec:!0})}catch(n){K(`paste: "${n.message}".`)}}keydown(e){this.isShiftKeyDown||e.key!=="Shift"||(this.isShiftKeyDown=!0),a(this,$t)===J.NONE||this.isEditorHandlingKeyboard||ir._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,a(this,hi)&&(m(this,hi,!1),v(this,L,Fh).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu")}}setEditingState(e){e?(v(this,L,tp).call(this),v(this,L,sc).call(this),v(this,L,ae).call(this,{isEditing:a(this,$t)!==J.NONE,isEmpty:v(this,L,Po).call(this),hasSomethingToUndo:a(this,Be).hasSomethingToUndo(),hasSomethingToRedo:a(this,Be).hasSomethingToRedo(),hasSelectedEditor:!1})):(v(this,L,ep).call(this),v(this,L,ic).call(this),v(this,L,ae).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!a(this,He)){m(this,He,e);for(const t of a(this,He))v(this,L,Pi).call(this,t.defaultPropertiesToUpdate)}}getId(){return a(this,vh).id}get currentLayer(){return a(this,Vt).get(a(this,tr))}getLayer(e){return a(this,Vt).get(e)}get currentPageIndex(){return a(this,tr)}addLayer(e){a(this,Vt).set(e.pageIndex,e),a(this,li)?e.enable():e.disable()}removeLayer(e){a(this,Vt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){if(a(this,$t)!==e){if(a(this,ke)&&(await a(this,ke).promise,!a(this,ke)))return;if(m(this,ke,Promise.withResolvers()),m(this,$t,e),e!==J.NONE){this.setEditingState(!0),await v(this,L,np).call(this),this.unselectAll();for(const i of a(this,Vt).values())i.updateMode(e);if(t){for(const i of a(this,Lt).values())i.annotationElementId===t?(this.setSelected(i),i.enterInEditMode()):i.unselect();a(this,ke).resolve()}else s&&this.addNewEditorFromKeyboard(),a(this,ke).resolve()}else this.setEditingState(!1),v(this,L,rp).call(this),a(this,ke).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==a(this,$t)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var s;if(a(this,He)){switch(e){case X.CREATE:this.currentLayer.addNewEditor();return;case X.HIGHLIGHT_DEFAULT_COLOR:(s=a(this,Ea))==null||s.updateColor(t);break;case X.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(a(this,Ta)||m(this,Ta,new Map)).set(e,t),this.showAllEditors("highlight",t)}for(const i of a(this,ct))i.updateParams(e,t);for(const i of a(this,He))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var i;for(const n of a(this,Lt).values())n.editorType===e&&n.show(t);(((i=a(this,Ta))==null?void 0:i.get(X.HIGHLIGHT_SHOW_ALL))??!0)!==t&&v(this,L,Pi).call(this,[[X.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(a(this,Sa)!==e){m(this,Sa,e);for(const t of a(this,Vt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of a(this,Lt).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return a(this,Lt).get(e)}addEditor(e){a(this,Lt).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(a(this,Ze)&&clearTimeout(a(this,Ze)),m(this,Ze,setTimeout(()=>{this.focusMainContainer(),m(this,Ze,null)},0))),a(this,Lt).delete(e.id),this.unselect(e),e.annotationElementId&&a(this,Wi).has(e.annotationElementId)||((t=a(this,Ss))==null||t.remove(e.id))}addDeletedAnnotationElement(e){a(this,Wi).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return a(this,Wi).has(e)}removeDeletedAnnotationElement(e){a(this,Wi).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){a(this,me)!==e&&(m(this,me,e),e&&v(this,L,Pi).call(this,e.propertiesToUpdate))}updateUI(e){a(this,L,ap)===e&&v(this,L,Pi).call(this,e.propertiesToUpdate)}toggleSelected(e){a(this,ct).has(e)?(a(this,ct).delete(e),e.unselect(),v(this,L,ae).call(this,{hasSelectedEditor:this.hasSelection})):(a(this,ct).add(e),e.select(),v(this,L,Pi).call(this,e.propertiesToUpdate),v(this,L,ae).call(this,{hasSelectedEditor:!0}))}setSelected(e){for(const t of a(this,ct))t!==e&&t.unselect();a(this,ct).clear(),a(this,ct).add(e),e.select(),v(this,L,Pi).call(this,e.propertiesToUpdate),v(this,L,ae).call(this,{hasSelectedEditor:!0})}isSelected(e){return a(this,ct).has(e)}get firstSelectedEditor(){return a(this,ct).values().next().value}unselect(e){e.unselect(),a(this,ct).delete(e),v(this,L,ae).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return a(this,ct).size!==0}get isEnterHandled(){return a(this,ct).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){a(this,Be).undo(),v(this,L,ae).call(this,{hasSomethingToUndo:a(this,Be).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:v(this,L,Po).call(this)})}redo(){a(this,Be).redo(),v(this,L,ae).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:a(this,Be).hasSomethingToRedo(),isEmpty:v(this,L,Po).call(this)})}addCommands(e){a(this,Be).add(e),v(this,L,ae).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:v(this,L,Po).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...a(this,ct)];this.addCommands({cmd:()=>{for(const t of e)t.remove()},undo:()=>{for(const t of e)v(this,L,nc).call(this,t)},mustExec:!0})}commitOrRemove(){var e;(e=a(this,me))==null||e.commitOrRemove()}hasSomethingToControl(){return a(this,me)||this.hasSelection}selectAll(){for(const e of a(this,ct))e.commit();v(this,L,rc).call(this,a(this,Lt).values())}unselectAll(){if(!(a(this,me)&&(a(this,me).commitOrRemove(),a(this,$t)!==J.NONE))&&this.hasSelection){for(const e of a(this,ct))e.unselect();a(this,ct).clear(),v(this,L,ae).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;a(this,di)[0]+=e,a(this,di)[1]+=t;const[i,n]=a(this,di),r=[...a(this,ct)];a(this,es)&&clearTimeout(a(this,es)),m(this,es,setTimeout(()=>{m(this,es,null),a(this,di)[0]=a(this,di)[1]=0,this.addCommands({cmd:()=>{for(const o of r)a(this,Lt).has(o.id)&&o.translateInPage(i,n)},undo:()=>{for(const o of r)a(this,Lt).has(o.id)&&o.translateInPage(-i,-n)},mustExec:!1})},1e3));for(const o of r)o.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,Je,new Map);for(const e of a(this,ct))a(this,Je).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!a(this,Je))return!1;this.disableUserSelect(!1);const e=a(this,Je);m(this,Je,null);let t=!1;for(const[{x:i,y:n,pageIndex:r},o]of e)o.newX=i,o.newY=n,o.newPageIndex=r,t||(t=i!==o.savedX||n!==o.savedY||r!==o.savedPageIndex);if(!t)return!1;const s=(i,n,r,o)=>{if(a(this,Lt).has(i.id)){const h=a(this,Vt).get(o);h?i._setParentAndPosition(h,n,r):(i.pageIndex=o,i.x=n,i.y=r)}};return this.addCommands({cmd:()=>{for(const[i,{newX:n,newY:r,newPageIndex:o}]of e)s(i,n,r,o)},undo:()=>{for(const[i,{savedX:n,savedY:r,savedPageIndex:o}]of e)s(i,n,r,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(a(this,Je))for(const s of a(this,Je).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||a(this,ct).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return a(this,me)===e}getActive(){return a(this,me)}getMode(){return a(this,$t)}get imageManager(){return nt(this,"imageManager",new xl)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let l=0,c=t.rangeCount;l<c;l++)if(!e.contains(t.getRangeAt(l).commonAncestorContainer))return null;const{x:s,y:i,width:n,height:r}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(l,c,p,u)=>({x:(c-i)/r,y:1-(l+p-s)/n,width:u/r,height:p/n});break;case"180":o=(l,c,p,u)=>({x:1-(l+p-s)/n,y:1-(c+u-i)/r,width:p/n,height:u/r});break;case"270":o=(l,c,p,u)=>({x:1-(c+u-i)/r,y:(l-s)/n,width:u/r,height:p/n});break;default:o=(l,c,p,u)=>({x:(l-s)/n,y:(c-i)/r,width:p/n,height:u/r})}const h=[];for(let l=0,c=t.rangeCount;l<c;l++){const p=t.getRangeAt(l);if(!p.collapsed)for(const{x:u,y:g,width:f,height:b}of p.getClientRects())f!==0&&b!==0&&h.push(o(u,g,f,b))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(a(this,Zn)||m(this,Zn,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=a(this,Zn))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=a(this,Zn))==null?void 0:i.get(e.data.id);if(!t)return;const s=a(this,Ss).getRawValue(t);s&&(a(this,$t)!==J.NONE||s.hasBeenModified)&&s.renderAnnotationElement(e)}};Qn=new WeakMap,me=new WeakMap,Lt=new WeakMap,Vt=new WeakMap,Jn=new WeakMap,Ss=new WeakMap,Zn=new WeakMap,Be=new WeakMap,ai=new WeakMap,tr=new WeakMap,Wi=new WeakMap,Je=new WeakMap,He=new WeakMap,qi=new WeakMap,wa=new WeakMap,xa=new WeakMap,er=new WeakMap,_a=new WeakMap,Ze=new WeakMap,oi=new WeakMap,sr=new WeakMap,hi=new WeakMap,ts=new WeakMap,vh=new WeakMap,li=new WeakMap,Sa=new WeakMap,ci=new WeakMap,Xi=new WeakMap,Ea=new WeakMap,Ca=new WeakMap,$t=new WeakMap,ct=new WeakMap,Es=new WeakMap,Yi=new WeakMap,Ta=new WeakMap,ka=new WeakMap,di=new WeakMap,es=new WeakMap,Cs=new WeakMap,Ma=new WeakMap,ke=new WeakMap,L=new WeakSet,Dh=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},tc=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of a(this,Vt).values())if(s.hasTextLayer(e))return s;return null},Qu=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const t=v(this,L,Dh).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(t);s&&(a(this,ts)||m(this,ts,new gf(this)),a(this,ts).show(t,s,this.direction==="ltr"))},Ju=function(){var i,n,r;const e=document.getSelection();if(!e||e.isCollapsed){a(this,Es)&&((i=a(this,ts))==null||i.hide(),m(this,Es,null),v(this,L,ae).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===a(this,Es))return;const s=v(this,L,Dh).call(this,e).closest(".textLayer");if(s){if((n=a(this,ts))==null||n.hide(),m(this,Es,t),v(this,L,ae).call(this,{hasSelectedText:!0}),(a(this,$t)===J.HIGHLIGHT||a(this,$t)===J.NONE)&&(a(this,$t)===J.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,hi,this.isShiftKeyDown),!this.isShiftKeyDown)){const o=a(this,$t)===J.HIGHLIGHT?v(this,L,tc).call(this,s):null;o==null||o.toggleDrawing();const h=new AbortController,l=this.combinedSignal(h),c=p=>{(p.type!=="pointerup"||p.button===0)&&(h.abort(),o==null||o.toggleDrawing(!0),p.type==="pointerup"&&v(this,L,Fh).call(this,"main_toolbar"))};window.addEventListener("pointerup",c,{signal:l}),window.addEventListener("blur",c,{signal:l})}}else a(this,Es)&&((r=a(this,ts))==null||r.hide(),m(this,Es,null),v(this,L,ae).call(this,{hasSelectedText:!1}))},Fh=function(e=""){a(this,$t)===J.HIGHLIGHT?this.highlightSelection(e):a(this,wa)&&v(this,L,Qu).call(this)},Zu=function(){document.addEventListener("selectionchange",v(this,L,Ju).bind(this),{signal:this._signal})},tp=function(){if(a(this,oi))return;m(this,oi,new AbortController);const e=this.combinedSignal(a(this,oi));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},ep=function(){var e;(e=a(this,oi))==null||e.abort(),m(this,oi,null)},ec=function(){if(a(this,ci))return;m(this,ci,new AbortController);const e=this.combinedSignal(a(this,ci));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},sp=function(){var e;(e=a(this,ci))==null||e.abort(),m(this,ci,null)},sc=function(){if(a(this,ai))return;m(this,ai,new AbortController);const e=this.combinedSignal(a(this,ai));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},ic=function(){var e;(e=a(this,ai))==null||e.abort(),m(this,ai,null)},ip=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},ae=function(e){Object.entries(e).some(([t,s])=>a(this,ka)[t]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(a(this,ka),e)}),a(this,$t)===J.HIGHLIGHT&&e.hasSelectedEditor===!1&&v(this,L,Pi).call(this,[[X.HIGHLIGHT_FREE,!0]]))},Pi=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},np=async function(){if(!a(this,li)){m(this,li,!0);const e=[];for(const t of a(this,Vt).values())e.push(t.enable());await Promise.all(e);for(const t of a(this,Lt).values())t.enable()}},rp=function(){if(this.unselectAll(),a(this,li)){m(this,li,!1);for(const e of a(this,Vt).values())e.disable();for(const e of a(this,Lt).values())e.disable()}},nc=function(e){const t=a(this,Vt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},ap=function(){let e=null;for(e of a(this,ct));return e},Po=function(){if(a(this,Lt).size===0)return!0;if(a(this,Lt).size===1)for(const e of a(this,Lt).values())return e.isEmpty();return!1},rc=function(e){for(const t of a(this,ct))t.unselect();a(this,ct).clear();for(const t of e)t.isEmpty()||(a(this,ct).add(t),t.select());v(this,L,ae).call(this,{hasSelectedEditor:this.hasSelection})},Y(ir,"TRANSLATE_SMALL",1),Y(ir,"TRANSLATE_BIG",10);let Ni=ir;const ie=class ie{constructor(e){A(this,ze);A(this,Ut,null);A(this,ss,!1);A(this,je,null);A(this,nr,null);A(this,is,null);A(this,ve,null);A(this,rr,!1);A(this,ns,null);A(this,le,null);A(this,Ts,null);A(this,Ki,null);A(this,rs,!1);m(this,le,e),m(this,rs,e._uiManager.useNewAltTextFlow),a(ie,ui)||m(ie,ui,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){ie._l10n??(ie._l10n=e)}async render(){const e=m(this,je,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=m(this,nr,document.createElement("span"));e.append(t),a(this,rs)?(e.classList.add("new"),e.setAttribute("data-l10n-id",a(ie,ui).missing),t.setAttribute("data-l10n-id",a(ie,ui)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=a(this,le)._uiManager._signal;e.addEventListener("contextmenu",Ce,{signal:s}),e.addEventListener("pointerdown",n=>n.stopPropagation(),{signal:s});const i=n=>{n.preventDefault(),a(this,le)._uiManager.editAltText(a(this,le)),a(this,rs)&&a(this,le)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:a(this,ze,Lo)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",n=>{n.target===e&&n.key==="Enter"&&(m(this,rr,!0),i(n))},{signal:s}),await v(this,ze,Oh).call(this),e}finish(){a(this,je)&&(a(this,je).focus({focusVisible:a(this,rr)}),m(this,rr,!1))}isEmpty(){return a(this,rs)?a(this,Ut)===null:!a(this,Ut)&&!a(this,ss)}hasData(){return a(this,rs)?a(this,Ut)!==null||!!a(this,Ts):this.isEmpty()}get guessedText(){return a(this,Ts)}async setGuessedText(e){a(this,Ut)===null&&(m(this,Ts,e),m(this,Ki,await ie._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),v(this,ze,Oh).call(this))}toggleAltTextBadge(e=!1){var t;if(a(this,rs)&&!a(this,Ut)){if(!a(this,ns)){const s=m(this,ns,document.createElement("div"));s.className="noAltTextBadge",a(this,le).div.append(s)}a(this,ns).classList.toggle("hidden",!e)}else(t=a(this,ns))==null||t.remove(),m(this,ns,null)}serialize(e){let t=a(this,Ut);return e||a(this,Ts)!==t||(t=a(this,Ki)),{altText:t,decorative:a(this,ss),guessedText:a(this,Ts),textWithDisclaimer:a(this,Ki)}}get data(){return{altText:a(this,Ut),decorative:a(this,ss)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:n=!1}){s&&(m(this,Ts,s),m(this,Ki,i)),(a(this,Ut)!==e||a(this,ss)!==t)&&(n||(m(this,Ut,e),m(this,ss,t)),v(this,ze,Oh).call(this))}toggle(e=!1){a(this,je)&&(!e&&a(this,ve)&&(clearTimeout(a(this,ve)),m(this,ve,null)),a(this,je).disabled=!e)}shown(){a(this,le)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:a(this,ze,Lo)}})}destroy(){var e,t;(e=a(this,je))==null||e.remove(),m(this,je,null),m(this,nr,null),m(this,is,null),(t=a(this,ns))==null||t.remove(),m(this,ns,null)}};Ut=new WeakMap,ss=new WeakMap,je=new WeakMap,nr=new WeakMap,is=new WeakMap,ve=new WeakMap,rr=new WeakMap,ns=new WeakMap,le=new WeakMap,Ts=new WeakMap,Ki=new WeakMap,rs=new WeakMap,ui=new WeakMap,ze=new WeakSet,Lo=function(){return(a(this,Ut)?"added":a(this,Ut)===null&&this.guessedText&&"review")||"missing"},Oh=async function(){var s,i,n,r;const e=a(this,je);if(!e)return;if(a(this,rs)){if(e.classList.toggle("done",!!a(this,Ut)),e.setAttribute("data-l10n-id",a(ie,ui)[a(this,ze,Lo)]),(s=a(this,nr))==null||s.setAttribute("data-l10n-id",a(ie,ui)[`${a(this,ze,Lo)}-label`]),!a(this,Ut)){(i=a(this,is))==null||i.remove();return}}else{if(!a(this,Ut)&&!a(this,ss)){e.classList.remove("done"),(n=a(this,is))==null||n.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=a(this,is);if(!t){m(this,is,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${a(this,le).id}`;const o=100,h=a(this,le)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(a(this,ve)),m(this,ve,null)},{once:!0}),e.addEventListener("mouseenter",()=>{m(this,ve,setTimeout(()=>{m(this,ve,null),a(this,is).classList.add("show"),a(this,le)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:h}),e.addEventListener("mouseleave",()=>{var l;a(this,ve)&&(clearTimeout(a(this,ve)),m(this,ve,null)),(l=a(this,is))==null||l.classList.remove("show")},{signal:h})}a(this,ss)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=a(this,Ut)),t.parentNode||e.append(t),(r=a(this,le).getImageForAltText())==null||r.setAttribute("aria-describedby",t.id)},A(ie,ui,null),Y(ie,"_l10n",null);let ih=ie;const ht=class ht{constructor(e){A(this,tt);A(this,Qi,null);A(this,$e,null);A(this,_t,null);A(this,ar,!1);A(this,Ji,!1);A(this,Wt,null);A(this,Zi,null);A(this,pi,null);A(this,Ra,"");A(this,tn,!1);A(this,gi,null);A(this,Ia,!1);A(this,en,!1);A(this,ks,!1);A(this,as,null);A(this,or,0);A(this,hr,0);A(this,Me,null);Y(this,"_editToolbar",null);Y(this,"_initialOptions",Object.create(null));Y(this,"_initialData",null);Y(this,"_isVisible",!0);Y(this,"_uiManager",null);Y(this,"_focusEventsAllowed",!0);A(this,Pa,!1);A(this,bh,ht._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:n,pageY:r}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[n,r];const[o,h]=this.parentDimensions;this.x=e.x/o,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ht.prototype._resizeWithKeyboard,t=Ni.TRANSLATE_SMALL,s=Ni.TRANSLATE_BIG;return nt(this,"_resizerKeyboardManager",new aa([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],ht.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return nt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new vf({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ht._l10n??(ht._l10n=e),ht._l10nResizer||(ht._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ht._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ht._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){yt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return a(this,Pa)}set _isDraggable(e){var t;m(this,Pa,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=a(this,bh)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):v(this,tt,Do).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(a(this,tn)?m(this,tn,!1):this.parent.setSelected(this))}focusout(e){var t,s;!this._focusEventsAllowed||!this.isAttachedToDOM||(t=e.relatedTarget)!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[n,r]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/n,this.y=(t+i)/r,this.fixAndSetPosition()}translate(e,t){v(this,tt,ac).call(this,this.parentDimensions,e,t)}translateInPage(e,t){a(this,gi)||m(this,gi,[this.x,this.y]),v(this,tt,ac).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){a(this,gi)||m(this,gi,[this.x,this.y]);const[s,i]=this.parentDimensions;if(this.x+=e/s,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:l,y:c}=this.div.getBoundingClientRect();this.parent.findNewParent(this,l,c)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:n,y:r}=this;const[o,h]=this.getBaseTranslation();n+=o,r+=h,this.div.style.left=`${(100*n).toFixed(2)}%`,this.div.style.top=`${(100*r).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!a(this,gi)&&(a(this,gi)[0]!==this.x||a(this,gi)[1]!==this.y)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=ht,i=s/e,n=s/t;switch(this.rotation){case 90:return[-i,n];case 180:return[i,n];case 270:return[i,-n];default:return[-i,-n]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const[t,s]=this.pageDimensions;let{x:i,y:n,width:r,height:o}=this;if(r*=t,o*=s,i*=t,n*=s,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(t-r,i)),n=Math.max(0,Math.min(s-o,n));break;case 90:i=Math.max(0,Math.min(t-o,i)),n=Math.min(s,Math.max(r,n));break;case 180:i=Math.min(t,Math.max(r,i)),n=Math.min(s,Math.max(o,n));break;case 270:i=Math.min(t,Math.max(o,i)),n=Math.max(0,Math.min(s-r,n))}this.x=i/=t,this.y=n/=s;const[h,l]=this.getBaseTranslation();i+=h,n+=l;const{style:c}=this.div;c.left=`${(100*i).toFixed(2)}%`,c.top=`${(100*n).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return v(s=ht,La,oc).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return v(s=ht,La,oc).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions;this.div.style.width=`${(100*e/s).toFixed(2)}%`,a(this,Ji)||(this.div.style.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),n=!a(this,Ji)&&t.endsWith("%");if(i&&n)return;const[r,o]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/r).toFixed(2)}%`),a(this,Ji)||n||(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var e;(e=a(this,_t))==null||e.finish()}async addEditToolbar(){return this._editToolbar||a(this,en)?this._editToolbar:(this._editToolbar=new wl(this),this.div.append(this._editToolbar.render()),a(this,_t)&&await this._editToolbar.addAltText(a(this,_t)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=a(this,_t))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){a(this,_t)||(ih.initialize(ht._l10n),m(this,_t,new ih(this)),a(this,Qi)&&(a(this,_t).data=a(this,Qi),m(this,Qi,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=a(this,_t))==null?void 0:e.data}set altTextData(e){a(this,_t)&&(a(this,_t).data=e)}get guessedAltText(){var e;return(e=a(this,_t))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=a(this,_t))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=a(this,_t))==null?void 0:t.serialize(e)}hasAltText(){return!!a(this,_t)&&!a(this,_t).isEmpty()}hasAltTextData(){var e;return((e=a(this,_t))==null?void 0:e.hasData())??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=a(this,ar)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),v(this,tt,uc).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!=0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),sh(this,this.div,["pointerdown"]),this.div}pointerdown(e){const{isMac:t}=ee.platform;e.button!==0||e.ctrlKey&&t?e.preventDefault():(m(this,tn,!0),this._isDraggable?v(this,tt,lp).call(this,e):v(this,tt,dc).call(this,e))}get isSelected(){return this._uiManager.isSelected(this)}moveInDOM(){a(this,as)&&clearTimeout(a(this,as)),m(this,as,setTimeout(()=>{var e;m(this,as,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition()}getRect(e,t,s=this.rotation){const i=this.parentScale,[n,r]=this.pageDimensions,[o,h]=this.pageTranslation,l=e/i,c=t/i,p=this.x*n,u=this.y*r,g=this.width*n,f=this.height*r;switch(s){case 0:return[p+l+o,r-u-c-f+h,p+l+g+o,r-u-c+h];case 90:return[p+c+o,r-u+l+h,p+c+f+o,r-u+l+g+h];case 180:return[p-l-g+o,r-u+c+h,p-l+o,r-u+c+f+h];case 270:return[p-c-f+o,r-u-l-g+h,p-c+o,r-u-l+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,n,r]=e,o=n-s,h=r-i;switch(this.rotation){case 0:return[s,t-r,o,h];case 90:return[s,t-i,h,o];case 180:return[n,t-i,o,h];case 270:return[n,t-r,h,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){m(this,en,!0)}disableEditMode(){m(this,en,!1)}isInEditMode(){return a(this,en)}shouldGetKeyboardEvents(){return a(this,ks)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){v(this,tt,uc).call(this)}rotate(e){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){yt("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,m(i,Qi,e.accessibilityData);const[n,r]=i.pageDimensions,[o,h,l,c]=i.getRectInCurrentCoords(e.rect,r);return i.x=o/n,i.y=h/r,i.width=l/n,i.height=c/r,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e;if((e=a(this,pi))==null||e.abort(),m(this,pi,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),a(this,as)&&(clearTimeout(a(this,as)),m(this,as,null)),v(this,tt,Do).call(this),this.removeEditToolbar(),a(this,Me)){for(const t of a(this,Me).values())clearTimeout(t);m(this,Me,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(v(this,tt,op).call(this),a(this,Wt).classList.remove("hidden"),sh(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),m(this,Zi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=a(this,Wt).children;if(!a(this,$e)){m(this,$e,Array.from(t));const r=v(this,tt,cp).bind(this),o=v(this,tt,dp).bind(this),h=this._uiManager._signal;for(const l of a(this,$e)){const c=l.getAttribute("data-resizer-name");l.setAttribute("role","spinbutton"),l.addEventListener("keydown",r,{signal:h}),l.addEventListener("blur",o,{signal:h}),l.addEventListener("focus",v(this,tt,up).bind(this,c),{signal:h}),l.setAttribute("data-l10n-id",ht._l10nResizer[c])}}const s=a(this,$e)[0];let i=0;for(const r of t){if(r===s)break;i++}const n=(360-this.rotation+this.parentRotation)%360/90*(a(this,$e).length/4);if(n!==i){if(n<i)for(let o=0;o<i-n;o++)a(this,Wt).append(a(this,Wt).firstChild);else if(n>i)for(let o=0;o<n-i;o++)a(this,Wt).firstChild.before(a(this,Wt).lastChild);let r=0;for(const o of t){const h=a(this,$e)[r++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",ht._l10nResizer[h])}}v(this,tt,pc).call(this,0),m(this,ks,!0),a(this,Wt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){a(this,ks)&&v(this,tt,cc).call(this,a(this,Ra),{movementX:e,movementY:t})}_stopResizingWithKeyboard(){v(this,tt,Do).call(this),this.div.focus()}select(){var e,t,s;this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),this._editToolbar?((t=this._editToolbar)==null||t.show(),(s=a(this,_t))==null||s.toggleAltTextBadge(!1)):this.addEditToolbar().then(()=>{var i,n;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((n=this._editToolbar)==null||n.show())})}unselect(){var e,t,s,i,n;(e=a(this,Wt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(n=a(this,_t))==null||n.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return a(this,Ia)}set isEditing(e){m(this,Ia,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){m(this,Ji,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){a(this,Me)||m(this,Me,new Map);const{action:s}=e;let i=a(this,Me).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),a(this,Me).delete(s),a(this,Me).size===0&&m(this,Me,null)},ht._telemetryTimeout),a(this,Me).set(s,i)}else e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),m(this,ar,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,ar,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(t){if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}}else t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Qi=new WeakMap,$e=new WeakMap,_t=new WeakMap,ar=new WeakMap,Ji=new WeakMap,Wt=new WeakMap,Zi=new WeakMap,pi=new WeakMap,Ra=new WeakMap,tn=new WeakMap,gi=new WeakMap,Ia=new WeakMap,en=new WeakMap,ks=new WeakMap,as=new WeakMap,or=new WeakMap,hr=new WeakMap,Me=new WeakMap,Pa=new WeakMap,bh=new WeakMap,tt=new WeakSet,ac=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this.fixAndSetPosition()},La=new WeakSet,oc=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},hc=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},op=function(){if(a(this,Wt))return;m(this,Wt,document.createElement("div")),a(this,Wt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");a(this,Wt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",v(this,tt,hp).bind(this,s),{signal:t}),i.addEventListener("contextmenu",Ce,{signal:t}),i.tabIndex=-1}this.div.prepend(a(this,Wt))},hp=function(e,t){var f;t.preventDefault();const{isMac:s}=ee.platform;if(t.button!==0||t.ctrlKey&&s)return;(f=a(this,_t))==null||f.toggle(!1);const i=this._isDraggable;this._isDraggable=!1;const n=new AbortController,r=this._uiManager.combinedSignal(n);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",v(this,tt,cc).bind(this,e),{passive:!0,capture:!0,signal:r}),window.addEventListener("contextmenu",Ce,{signal:r});const o=this.x,h=this.y,l=this.width,c=this.height,p=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const g=()=>{var b;n.abort(),this.parent.togglePointerEvents(!0),(b=a(this,_t))==null||b.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=p,this.div.style.cursor=u,v(this,tt,lc).call(this,o,h,l,c)};window.addEventListener("pointerup",g,{signal:r}),window.addEventListener("blur",g,{signal:r})},lc=function(e,t,s,i){const n=this.x,r=this.y,o=this.width,h=this.height;n===e&&r===t&&o===s&&h===i||this.addCommands({cmd:()=>{this.width=o,this.height=h,this.x=n,this.y=r;const[l,c]=this.parentDimensions;this.setDims(l*o,c*h),this.fixAndSetPosition()},undo:()=>{this.width=s,this.height=i,this.x=e,this.y=t;const[l,c]=this.parentDimensions;this.setDims(l*s,c*i),this.fixAndSetPosition()},mustExec:!0})},cc=function(e,t){const[s,i]=this.parentDimensions,n=this.x,r=this.y,o=this.width,h=this.height,l=ht.MIN_SIZE/s,c=ht.MIN_SIZE/i,p=H=>Math.round(1e4*H)/1e4,u=v(this,tt,hc).call(this,this.rotation),g=(H,q)=>[u[0]*H+u[2]*q,u[1]*H+u[3]*q],f=v(this,tt,hc).call(this,360-this.rotation);let b,w,y=!1,x=!1;switch(e){case"topLeft":y=!0,b=(H,q)=>[0,0],w=(H,q)=>[H,q];break;case"topMiddle":b=(H,q)=>[H/2,0],w=(H,q)=>[H/2,q];break;case"topRight":y=!0,b=(H,q)=>[H,0],w=(H,q)=>[0,q];break;case"middleRight":x=!0,b=(H,q)=>[H,q/2],w=(H,q)=>[0,q/2];break;case"bottomRight":y=!0,b=(H,q)=>[H,q],w=(H,q)=>[0,0];break;case"bottomMiddle":b=(H,q)=>[H/2,q],w=(H,q)=>[H/2,0];break;case"bottomLeft":y=!0,b=(H,q)=>[0,q],w=(H,q)=>[H,0];break;case"middleLeft":x=!0,b=(H,q)=>[0,q/2],w=(H,q)=>[H,q/2]}const _=b(o,h),E=w(o,h);let C=g(...E);const S=p(n+C[0]),T=p(r+C[1]);let M=1,R=1,[O,N]=this.screenToPageTranslation(t.movementX,t.movementY);[O,N]=(Z=O/s,$=N/i,[f[0]*Z+f[2]*$,f[1]*Z+f[3]*$]);var Z,$;if(y){const H=Math.hypot(o,h);M=R=Math.max(Math.min(Math.hypot(E[0]-_[0]-O,E[1]-_[1]-N)/H,1/o,1/h),l/o,c/h)}else x?M=Math.max(l,Math.min(1,Math.abs(E[0]-_[0]-O)))/o:R=Math.max(c,Math.min(1,Math.abs(E[1]-_[1]-N)))/h;const j=p(o*M),it=p(h*R);C=g(...w(j,it));const ot=S-C[0],mt=T-C[1];this.width=j,this.height=it,this.x=ot,this.y=mt,this.setDims(s*j,i*it),this.fixAndSetPosition()},dc=function(e){const{isMac:t}=ee.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},lp=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();const s=new AbortController,i=this._uiManager.combinedSignal(s);if(t){this.div.classList.add("moving"),m(this,or,e.clientX),m(this,hr,e.clientY);const r=o=>{const{clientX:h,clientY:l}=o,[c,p]=this.screenToPageTranslation(h-a(this,or),l-a(this,hr));m(this,or,h),m(this,hr,l),this._uiManager.dragSelectedEditors(c,p)};window.addEventListener("pointermove",r,{passive:!0,capture:!0,signal:i})}const n=()=>{s.abort(),t&&this.div.classList.remove("moving"),m(this,tn,!1),this._uiManager.endDragSession()||v(this,tt,dc).call(this,e)};window.addEventListener("pointerup",n,{signal:i}),window.addEventListener("blur",n,{signal:i})},uc=function(){if(a(this,pi)||!this.div)return;m(this,pi,new AbortController);const e=this._uiManager.combinedSignal(a(this,pi));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},cp=function(e){ht._resizerKeyboardManager.exec(this,e)},dp=function(e){var t;a(this,ks)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==a(this,Wt)&&v(this,tt,Do).call(this)},up=function(e){m(this,Ra,a(this,ks)?e:"")},pc=function(e){if(a(this,$e))for(const t of a(this,$e))t.tabIndex=e},Do=function(){if(m(this,ks,!1),v(this,tt,pc).call(this,-1),a(this,Zi)){const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=a(this,Zi);v(this,tt,lc).call(this,e,t,s,i),m(this,Zi,null)}},A(ht,La),Y(ht,"_l10n",null),Y(ht,"_l10nResizer",null),Y(ht,"_borderLineWidth",-1),Y(ht,"_colorManager",new _l),Y(ht,"_zIndex",1),Y(ht,"_telemetryTimeout",1e3);let lt=ht;class vf extends lt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const id=3285377520,Te=4294901760,ei=65535;class nd{constructor(e){this.h1=e?4294967295&e:id,this.h2=e?4294967295&e:id}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(2*e.length),s=0;for(let b=0,w=e.length;b<w;b++){const y=e.charCodeAt(b);y<=255?t[s++]=y:(t[s++]=y>>>8,t[s++]=255&y)}}else{if(!ArrayBuffer.isView(e))throw new Error("Invalid data format, must be a string or TypedArray.");t=e.slice(),s=t.byteLength}const i=s>>2,n=s-4*i,r=new Uint32Array(t.buffer,0,i);let o=0,h=0,l=this.h1,c=this.h2;const p=3432918353,u=461845907,g=11601,f=13715;for(let b=0;b<i;b++)1&b?(o=r[b],o=o*p&Te|o*g&ei,o=o<<15|o>>>17,o=o*u&Te|o*f&ei,l^=o,l=l<<13|l>>>19,l=5*l+3864292196):(h=r[b],h=h*p&Te|h*g&ei,h=h<<15|h>>>17,h=h*u&Te|h*f&ei,c^=h,c=c<<13|c>>>19,c=5*c+3864292196);switch(o=0,n){case 3:o^=t[4*i+2]<<16;case 2:o^=t[4*i+1]<<8;case 1:o^=t[4*i],o=o*p&Te|o*g&ei,o=o<<15|o>>>17,o=o*u&Te|o*f&ei,1&i?l^=o:c^=o}this.h1=l,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&Te|36045*e&ei,t=4283543511*t&Te|(2950163797*(t<<16|e>>>16)&Te)>>>16,e^=t>>>1,e=444984403*e&Te|60499*e&ei,t=3301882366*t&Te|(3120437893*(t<<16|e>>>16)&Te)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Sl=Object.freeze({map:null,hash:"",transfer:void 0});class El{constructor(){A(this,Ah);A(this,sn,!1);A(this,nn,null);A(this,Gt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=a(this,Gt).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return a(this,Gt).get(e)}remove(e){if(a(this,Gt).delete(e),a(this,Gt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of a(this,Gt).values())if(t instanceof lt)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=a(this,Gt).get(e);let i=!1;if(s!==void 0)for(const[n,r]of Object.entries(t))s[n]!==r&&(i=!0,s[n]=r);else i=!0,a(this,Gt).set(e,t);i&&v(this,Ah,pp).call(this),t instanceof lt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return a(this,Gt).has(e)}getAll(){return a(this,Gt).size>0?ul(a(this,Gt)):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return a(this,Gt).size}resetModified(){a(this,sn)&&(m(this,sn,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new rd(this)}get serializable(){if(a(this,Gt).size===0)return Sl;const e=new Map,t=new nd,s=[],i=Object.create(null);let n=!1;for(const[r,o]of a(this,Gt)){const h=o instanceof lt?o.serialize(!1,i):o;h&&(e.set(r,h),t.update(`${r}:${JSON.stringify(h)}`),n||(n=!!h.bitmap))}if(n)for(const r of e.values())r.bitmap&&s.push(r.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Sl}get editorStats(){let e=null;const t=new Map;for(const s of a(this,Gt).values()){if(!(s instanceof lt))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:n}=i;t.has(n)||t.set(n,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const r=e[n]||(e[n]=new Map);for(const[o,h]of Object.entries(i)){if(o==="type")continue;let l=r.get(o);l||(l=new Map,r.set(o,l));const c=l.get(h)??0;l.set(h,c+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){m(this,nn,null)}get modifiedIds(){if(a(this,nn))return a(this,nn);const e=[];for(const t of a(this,Gt).values())t instanceof lt&&t.annotationElementId&&t.serialize()&&e.push(t.annotationElementId);return m(this,nn,{ids:new Set(e),hash:e.join(",")})}}sn=new WeakMap,nn=new WeakMap,Gt=new WeakMap,Ah=new WeakSet,pp=function(){a(this,sn)||(m(this,sn,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class rd extends El{constructor(t){super();A(this,Da);const{map:s,hash:i,transfer:n}=t.serializable,r=structuredClone(s,n?{transfer:n}:null);m(this,Da,{map:r,hash:i,transfer:n})}get print(){yt("Should not call PrintAnnotationStorage.print")}get serializable(){return a(this,Da)}get modifiedIds(){return nt(this,"modifiedIds",{ids:new Set,hash:""})}}Da=new WeakMap;class bf{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){A(this,lr,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),a(this,lr).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(e&&!a(this,lr).has(e.loadedName))if(Pt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:n}=e,r=new FontFace(s,i,n);this.addNativeFontFace(r);try{await r.load(),a(this,lr).add(s),t==null||t(e)}catch{K(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(r)}}else yt("Not implemented: loadSystemFont without the Font Loading API.")}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw K(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var e;return nt(this,"isFontLoadingAPISupported",!!((e=this._document)!=null&&e.fonts))}get isSyncFontLoadingSupported(){let e=!1;return(Ht||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),nt(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){const{loadingRequests:t}=this,s={done:!1,complete:function(){for(Pt(!s.done,"completeRequest() cannot be called twice."),s.done=!0;t.length>0&&t[0].done;){const i=t.shift();setTimeout(i.callback,0)}},callback:e};return t.push(s),s}get _loadTestFont(){return nt(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t){function s(w,y){return w.charCodeAt(y)<<24|w.charCodeAt(y+1)<<16|w.charCodeAt(y+2)<<8|255&w.charCodeAt(y+3)}function i(w,y,x,_){return w.substring(0,y)+_+w.substring(y+x)}let n,r;const o=this._document.createElement("canvas");o.width=1,o.height=1;const h=o.getContext("2d");let l=0;const c=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=i(p,976,c.length,c);const u=1482184792;let g=s(p,16);for(n=0,r=c.length-3;n<r;n+=4)g=g-u+s(c,n)|0;n<c.length&&(g=g-u+s(c+"XXX",n)|0),p=i(p,16,4,function(w){return String.fromCharCode(w>>24&255,w>>16&255,w>>8&255,255&w)}(g));const f=`@font-face {font-family:"${c}";src:${`url(data:font/opentype;base64,${btoa(p)});`}}`;this.insertRule(f);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const w of[e.loadedName,c]){const y=this._document.createElement("span");y.textContent="Hi",y.style.fontFamily=w,b.append(y)}this._document.body.append(b),function w(y,x){if(++l>30){K("Load test font never loaded."),x();return}h.font="30px "+y,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0?x():setTimeout(w.bind(null,y,x))}(c,()=>{b.remove(),t.complete()})}}lr=new WeakMap;class Af{constructor(e,{disableFontFace:t=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this.disableFontFace=t===!0,this._inspectFont=s}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(this.cssFontInfo){const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}else e=new FontFace(this.loadedName,this.data,{});return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${function(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(Zc(i))}(this.data)});`;let t;if(this.cssFontInfo){let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}else t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let s;try{s=e.get(this.loadedName+"_path_"+t)}catch(n){K(`getPathGenerator - ignoring character: "${n}".`)}if(!Array.isArray(s)||s.length===0)return this.compiledGlyphs[t]=function(n,r){};const i=[];for(let n=0,r=s.length;n<r;)switch(s[n++]){case ef:{const[o,h,l,c,p,u]=s.slice(n,n+6);i.push(g=>g.bezierCurveTo(o,h,l,c,p,u)),n+=6}break;case sf:{const[o,h]=s.slice(n,n+2);i.push(l=>l.moveTo(o,h)),n+=2}break;case nf:{const[o,h]=s.slice(n,n+2);i.push(l=>l.lineTo(o,h)),n+=2}break;case rf:{const[o,h,l,c]=s.slice(n,n+4);i.push(p=>p.quadraticCurveTo(o,h,l,c)),n+=4}break;case af:i.push(o=>o.restore());break;case of:i.push(o=>o.save());break;case hf:Pt(i.length===2,"Scale command is only valid at the third position.");break;case lf:{const[o,h,l,c,p,u]=s.slice(n,n+6);i.push(g=>g.transform(o,h,l,c,p,u)),n+=6}break;case cf:{const[o,h]=s.slice(n,n+2);i.push(l=>l.translate(o,h)),n+=2}}return this.compiledGlyphs[t]=function(n,r){i[0](n),i[1](n),n.scale(r,-r);for(let o=2,h=i.length;o<h;o++)i[o](n)}}}class ad{constructor({enableHWA:e=!1}){A(this,Fa,!1);m(this,Fa,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!a(this,Fa)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){yt("Abstract method `_createCanvas` called.")}}Fa=new WeakMap;class od{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){yt("Abstract method `_fetch` called.")}}class hd extends od{async _fetch(e){const t=await th(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Zo(t)}}V(4520);class ld{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,n){return"none"}destroy(e=!1){}}class cd{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){yt("Abstract method `_fetch` called.")}}class dd extends cd{async _fetch(e){const t=await th(e,"arraybuffer");return new Uint8Array(t)}}if(Ht){var Cl=Promise.withResolvers(),oa=null;(async()=>{const d=await Yr(()=>import("./index-Bx2nXGjt.js").then(async r=>(await r.__tla,r)).then(r=>r.aL),__vite__mapDeps([0,1])),e=await Yr(()=>import("./index-Bx2nXGjt.js").then(async r=>(await r.__tla,r)).then(r=>r.aL),__vite__mapDeps([0,1])),t=await Yr(()=>import("./index-Bx2nXGjt.js").then(async r=>(await r.__tla,r)).then(r=>r.aL),__vite__mapDeps([0,1])),s=await Yr(()=>import("./index-Bx2nXGjt.js").then(async r=>(await r.__tla,r)).then(r=>r.aL),__vite__mapDeps([0,1]));let i,n;try{i=await Yr(()=>import("./index-Bx2nXGjt.js").then(async r=>(await r.__tla,r)).then(r=>r.aL),__vite__mapDeps([0,1]))}catch{}try{n=await Yr(()=>import("./index-B9fWrEk-.js"),[])}catch{}return new Map(Object.entries({fs:d,http:e,https:t,url:s,canvas:i,path2d:n}))})().then(d=>{var e,t,s,i;if(oa=d,Cl.resolve(),!globalThis.DOMMatrix){const n=(e=d.get("canvas"))==null?void 0:e.DOMMatrix;n?globalThis.DOMMatrix=n:K("Cannot polyfill `DOMMatrix`, rendering may be broken.")}if(!globalThis.Path2D){const n=(t=d.get("canvas"))==null?void 0:t.CanvasRenderingContext2D,r=(s=d.get("path2d"))==null?void 0:s.applyPath2DToCanvasRenderingContext,o=(i=d.get("path2d"))==null?void 0:i.Path2D;if(n&&r&&o){try{r(n)}catch(h){K(`applyPath2DToCanvasRenderingContext: "${h}".`)}globalThis.Path2D=o}else K("Cannot polyfill `Path2D`, rendering may be broken.")}},d=>{K(`loadPackages: ${d}`),oa=new Map,Cl.resolve()})}class si{static get promise(){return Cl.promise}static get(e){return oa==null?void 0:oa.get(e)}}async function ud(d){const e=si.get("fs"),t=await e.promises.readFile(d);return new Uint8Array(t)}const Bi="Fill",Tl="Stroke",ha="Shading";function kl(d,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),d.clip(i)}class Ml{getPattern(){yt("Abstract method `getPattern` called.")}}class yf extends Ml{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let n;if(i===Tl||i===Bi){const r=t.current.getClippedPathBoundingBox(i,xt(e))||[0,0,0,0],o=Math.ceil(r[2]-r[0])||1,h=Math.ceil(r[3]-r[1])||1,l=t.cachedCanvases.getCanvas("pattern",o,h),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-r[0],-r[1]),s=z.transform(s,[1,0,0,1,r[0],r[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),kl(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),n=e.createPattern(l.canvas,"no-repeat");const p=new DOMMatrix(s);n.setTransform(p)}else kl(e,this._bbox),n=this._createGradient(e);return n}}function Rl(d,e,t,s,i,n,r,o){const h=e.coords,l=e.colors,c=d.data,p=4*d.width;let u;h[t+1]>h[s+1]&&(u=t,t=s,s=u,u=n,n=r,r=u),h[s+1]>h[i+1]&&(u=s,s=i,i=u,u=r,r=o,o=u),h[t+1]>h[s+1]&&(u=t,t=s,s=u,u=n,n=r,r=u);const g=(h[t]+e.offsetX)*e.scaleX,f=(h[t+1]+e.offsetY)*e.scaleY,b=(h[s]+e.offsetX)*e.scaleX,w=(h[s+1]+e.offsetY)*e.scaleY,y=(h[i]+e.offsetX)*e.scaleX,x=(h[i+1]+e.offsetY)*e.scaleY;if(f>=x)return;const _=l[n],E=l[n+1],C=l[n+2],S=l[r],T=l[r+1],M=l[r+2],R=l[o],O=l[o+1],N=l[o+2],Z=Math.round(f),$=Math.round(x);let j,it,ot,mt,H,q,Mt,ge;for(let vt=Z;vt<=$;vt++){if(vt<w){const U=vt<f?0:(f-vt)/(f-w);j=g-(g-b)*U,it=_-(_-S)*U,ot=E-(E-T)*U,mt=C-(C-M)*U}else{let U;U=vt>x?1:w===x?0:(w-vt)/(w-x),j=b-(b-y)*U,it=S-(S-R)*U,ot=T-(T-O)*U,mt=M-(M-N)*U}let F;F=vt<f?0:vt>x?1:(f-vt)/(f-x),H=g-(g-y)*F,q=_-(_-R)*F,Mt=E-(E-O)*F,ge=C-(C-N)*F;const I=Math.round(Math.min(j,H)),k=Math.round(Math.max(j,H));let D=p*vt+4*I;for(let U=I;U<=k;U++)F=(j-U)/(j-H),F<0?F=0:F>1&&(F=1),c[D++]=it-(it-q)*F|0,c[D++]=ot-(ot-Mt)*F|0,c[D++]=mt-(mt-ge)*F|0,c[D++]=255}}function wf(d,e,t){const s=e.coords,i=e.colors;let n,r;switch(e.type){case"lattice":const o=e.verticesPerRow,h=Math.floor(s.length/o)-1,l=o-1;for(n=0;n<h;n++){let c=n*o;for(let p=0;p<l;p++,c++)Rl(d,t,s[c],s[c+1],s[c+o],i[c],i[c+1],i[c+o]),Rl(d,t,s[c+o+1],s[c+1],s[c+o],i[c+o+1],i[c+1],i[c+o])}break;case"triangles":for(n=0,r=s.length;n<r;n+=3)Rl(d,t,s[n],s[n+1],s[n+2],i[n],i[n+1],i[n+2]);break;default:throw new Error("illegal figure")}}class xf extends Ml{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const i=Math.floor(this._bounds[0]),n=Math.floor(this._bounds[1]),r=Math.ceil(this._bounds[2])-i,o=Math.ceil(this._bounds[3])-n,h=Math.min(Math.ceil(Math.abs(r*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(o*e[1]*1.1)),3e3),c=r/h,p=o/l,u={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-n,scaleX:1/c,scaleY:1/p},g=h+4,f=l+4,b=s.getCanvas("mesh",g,f),w=b.context,y=w.createImageData(h,l);if(t){const x=y.data;for(let _=0,E=x.length;_<E;_+=4)x[_]=t[0],x[_+1]=t[1],x[_+2]=t[2],x[_+3]=255}for(const x of this._figures)wf(y,x,u);return w.putImageData(y,2,2),{canvas:b.canvas,offsetX:i-2*c,offsetY:n-2*p,scaleX:c,scaleY:p}}getPattern(e,t,s,i){kl(e,this._bbox);let n;if(i===ha)n=z.singularValueDecompose2dScale(xt(e));else if(n=z.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=z.singularValueDecompose2dScale(this.matrix);n=[n[0]*o[0],n[1]*o[1]]}const r=this._createMeshCanvas(n,i===ha?null:this._background,t.cachedCanvases);return i!==ha&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(r.offsetX,r.offsetY),e.scale(r.scaleX,r.scaleY),e.createPattern(r.canvas,"no-repeat")}}class _f extends Ml{getPattern(){return"hotpink"}}const Sf=1,Ef=2,yh=class yh{constructor(e,t,s,i,n){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=n}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:n,color:r,canvasGraphicsFactory:o}=this;let{xstep:h,ystep:l}=this;h=Math.abs(h),l=Math.abs(l),Qo("TilingType: "+n);const c=t[0],p=t[1],u=t[2],g=t[3],f=u-c,b=g-p,w=z.singularValueDecompose2dScale(this.matrix),y=z.singularValueDecompose2dScale(this.baseTransform),x=w[0]*y[0],_=w[1]*y[1];let E=f,C=b,S=!1,T=!1;const M=Math.ceil(h*x),R=Math.ceil(l*_);M>=Math.ceil(f*x)?E=h:S=!0,R>=Math.ceil(b*_)?C=l:T=!0;const O=this.getSizeAndScale(E,this.ctx.canvas.width,x),N=this.getSizeAndScale(C,this.ctx.canvas.height,_),Z=e.cachedCanvases.getCanvas("pattern",O.size,N.size),$=Z.context,j=o.createCanvasGraphics($);if(j.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(j,i,r),$.translate(-O.scale*c,-N.scale*p),j.transform(O.scale,0,0,N.scale,0,0),$.save(),this.clipBbox(j,c,p,u,g),j.baseTransform=xt(j.ctx),j.executeOperatorList(s),j.endDrawing(),$.restore(),S||T){const it=Z.canvas;S&&(E=h),T&&(C=l);const ot=this.getSizeAndScale(E,this.ctx.canvas.width,x),mt=this.getSizeAndScale(C,this.ctx.canvas.height,_),H=ot.size,q=mt.size,Mt=e.cachedCanvases.getCanvas("pattern-workaround",H,q),ge=Mt.context,vt=S?Math.floor(f/h):0,F=T?Math.floor(b/l):0;for(let I=0;I<=vt;I++)for(let k=0;k<=F;k++)ge.drawImage(it,H*I,q*k,H,q,0,0,H,q);return{canvas:Mt.canvas,scaleX:ot.scale,scaleY:mt.scale,offsetX:c,offsetY:p}}return{canvas:Z.canvas,scaleX:O.scale,scaleY:N.scale,offsetX:c,offsetY:p}}getSizeAndScale(e,t,s){const i=Math.max(yh.MAX_PATTERN_SIZE,t);let n=Math.ceil(e*s);return n>=i?n=i:s=n/e,{scale:s,size:n}}clipBbox(e,t,s,i,n){const r=i-t,o=n-s;e.ctx.rect(t,s,r,o),e.current.updateRectMinMax(xt(e.ctx),[t,s,i,n]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,n=e.current;switch(t){case Sf:const r=this.ctx;i.fillStyle=r.fillStyle,i.strokeStyle=r.strokeStyle,n.fillColor=r.fillStyle,n.strokeColor=r.strokeStyle;break;case Ef:const o=z.makeHexColor(s[0],s[1],s[2]);i.fillStyle=o,i.strokeStyle=o,n.fillColor=o,n.strokeColor=o;break;default:throw new Zg(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,i){let n=s;i!==ha&&(n=z.transform(n,t.baseTransform),this.matrix&&(n=z.transform(n,this.matrix)));const r=this.createPatternCanvas(t);let o=new DOMMatrix(n);o=o.translate(r.offsetX,r.offsetY),o=o.scale(1/r.scaleX,1/r.scaleY);const h=e.createPattern(r.canvas,"repeat");return h.setTransform(o),h}};Y(yh,"MAX_PATTERN_SIZE",3e3);let Il=yh;function Cf({src:d,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:n=4294967295,inverseDecode:r=!1}){const o=ee.isLittleEndian?4278190080:255,[h,l]=r?[n,o]:[o,n],c=s>>3,p=7&s,u=d.length;t=new Uint32Array(t.buffer);let g=0;for(let f=0;f<i;f++){for(const w=e+c;e<w;e++){const y=e<u?d[e]:255;t[g++]=128&y?l:h,t[g++]=64&y?l:h,t[g++]=32&y?l:h,t[g++]=16&y?l:h,t[g++]=8&y?l:h,t[g++]=4&y?l:h,t[g++]=2&y?l:h,t[g++]=1&y?l:h}if(p===0)continue;const b=e<u?d[e++]:255;for(let w=0;w<p;w++)t[g++]=b&1<<7-w?l:h}return{srcPos:e,destPos:g}}const oe=16;class Tf{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function nh(d,e,t,s,i,n,r,o,h,l){const[c,p,u,g,f,b]=xt(d);if(p===0&&u===0){const w=r*c+f,y=Math.round(w),x=o*g+b,_=Math.round(x),E=(r+h)*c+f,C=Math.abs(Math.round(E)-y)||1,S=(o+l)*g+b,T=Math.abs(Math.round(S)-_)||1;return d.setTransform(Math.sign(c),0,0,Math.sign(g),y,_),d.drawImage(e,t,s,i,n,0,0,C,T),d.setTransform(c,p,u,g,f,b),[C,T]}if(c===0&&g===0){const w=o*u+f,y=Math.round(w),x=r*p+b,_=Math.round(x),E=(o+l)*u+f,C=Math.abs(Math.round(E)-y)||1,S=(r+h)*p+b,T=Math.abs(Math.round(S)-_)||1;return d.setTransform(0,Math.sign(p),Math.sign(u),0,y,_),d.drawImage(e,t,s,i,n,0,0,T,C),d.setTransform(c,p,u,g,f,b),[T,C]}return d.drawImage(e,t,s,i,n,r,o,h,l),[Math.hypot(c,p)*h,Math.hypot(u,g)*l]}class pd{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Yc,this.textMatrixScale=1,this.fontMatrix=al,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=qo,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=z.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=z.applyTransform(t,e),i=z.applyTransform(t.slice(2),e),n=z.applyTransform([t[0],t[3]],e),r=z.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],i[0],n[0],r[0]),this.minY=Math.min(this.minY,s[1],i[1],n[1],r[1]),this.maxX=Math.max(this.maxX,s[0],i[0],n[0],r[0]),this.maxY=Math.max(this.maxY,s[1],i[1],n[1],r[1])}updateScalingPathMinMax(e,t){z.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,n,r,o,h,l,c){const p=z.bezierBoundingBox(t,s,i,n,r,o,h,l,c);c||this.updateRectMinMax(e,p)}getPathBoundingBox(e=Bi,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Tl){t||yt("Stroke bounding box must include transform.");const i=z.singularValueDecompose2dScale(t),n=i[0]*this.lineWidth/2,r=i[1]*this.lineWidth/2;s[0]-=n,s[1]-=r,s[2]+=n,s[3]+=r}return s}updateClipFromPath(){const e=z.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Bi,t=null){return z.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function gd(d,e){if(typeof ImageData<"u"&&e instanceof ImageData){d.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%oe,n=(t-i)/oe,r=i===0?n:n+1,o=d.createImageData(s,oe);let h,l=0;const c=e.data,p=o.data;let u,g,f,b;if(e.kind===Xo.GRAYSCALE_1BPP){const w=c.byteLength,y=new Uint32Array(p.buffer,0,p.byteLength>>2),x=y.length,_=s+7>>3,E=4294967295,C=ee.isLittleEndian?4278190080:255;for(u=0;u<r;u++){for(f=u<n?oe:i,h=0,g=0;g<f;g++){const S=w-l;let T=0;const M=S>_?s:8*S-7,R=-8&M;let O=0,N=0;for(;T<R;T+=8)N=c[l++],y[h++]=128&N?E:C,y[h++]=64&N?E:C,y[h++]=32&N?E:C,y[h++]=16&N?E:C,y[h++]=8&N?E:C,y[h++]=4&N?E:C,y[h++]=2&N?E:C,y[h++]=1&N?E:C;for(;T<M;T++)O===0&&(N=c[l++],O=128),y[h++]=N&O?E:C,O>>=1}for(;h<x;)y[h++]=0;d.putImageData(o,0,u*oe)}}else if(e.kind===Xo.RGBA_32BPP){for(g=0,b=s*oe*4,u=0;u<n;u++)p.set(c.subarray(l,l+b)),l+=b,d.putImageData(o,0,g),g+=oe;u<r&&(b=s*i*4,p.set(c.subarray(l,l+b)),d.putImageData(o,0,g))}else{if(e.kind!==Xo.RGB_24BPP)throw new Error(`bad image kind: ${e.kind}`);for(f=oe,b=s*f,u=0;u<r;u++){for(u>=n&&(f=i,b=s*f),h=0,g=b;g--;)p[h++]=c[l++],p[h++]=c[l++],p[h++]=c[l++],p[h++]=255;d.putImageData(o,0,u*oe)}}}function fd(d,e){if(e.bitmap){d.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%oe,n=(t-i)/oe,r=i===0?n:n+1,o=d.createImageData(s,oe);let h=0;const l=e.data,c=o.data;for(let p=0;p<r;p++){const u=p<n?oe:i;({srcPos:h}=Cf({src:l,srcPos:h,dest:c,width:s,height:u,nonBlackColor:0})),d.putImageData(o,0,p*oe)}}function la(d,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)d[s]!==void 0&&(e[s]=d[s]);d.setLineDash!==void 0&&(e.setLineDash(d.getLineDash()),e.lineDashOffset=d.lineDashOffset)}function rh(d){if(d.strokeStyle=d.fillStyle="#000000",d.fillRule="nonzero",d.globalAlpha=1,d.lineWidth=1,d.lineCap="butt",d.lineJoin="miter",d.miterLimit=10,d.globalCompositeOperation="source-over",d.font="10px sans-serif",d.setLineDash!==void 0&&(d.setLineDash([]),d.lineDashOffset=0),!Ht){const{filter:e}=d;e!=="none"&&e!==""&&(d.filter="none")}}function md(d,e){if(e)return!0;const t=z.singularValueDecompose2dScale(d);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*ti.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const kf=["butt","round","square"],Mf=["miter","round","bevel"],Rf={},vd={},Yl=class Yl{constructor(e,t,s,i,n,{optionalContentConfig:r,markedContentStack:o=null},h,l){A(this,fi);this.ctx=e,this.current=new pd(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=r,this.cachedCanvases=new Tf(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const n=this.ctx.canvas.width,r=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,n,r),this.ctx.fillStyle=o,s){const h=this.cachedCanvases.getCanvas("transparent",n,r);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...xt(this.compositeCtx))}this.ctx.save(),rh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=xt(this.ctx)}executeOperatorList(e,t,s,i){const n=e.argsArray,r=e.fnArray;let o=t||0;const h=n.length;if(h===o)return o;const l=h-o>10&&typeof s=="function",c=l?Date.now()+15:0;let p=0;const u=this.commonObjs,g=this.objs;let f;for(;;){if(i!==void 0&&o===i.nextBreakPoint)return i.breakIt(o,s),o;if(f=r[o],f!==Oe.dependency)this[f].apply(this,n[o]);else for(const b of n[o]){const w=b.startsWith("g_")?u:g;if(!w.has(b))return w.get(b,s),o}if(o++,o===h)return o;if(l&&++p>10){if(Date.now()>c)return s(),o;p=0}}}endDrawing(){v(this,fi,gc).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),v(this,fi,fc).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let n,r,o=Math.max(Math.hypot(t[0],t[1]),1),h=Math.max(Math.hypot(t[2],t[3]),1),l=s,c=i,p="prescale1";for(;o>2&&l>1||h>2&&c>1;){let u=l,g=c;o>2&&l>1&&(u=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),o/=l/u),h>2&&c>1&&(g=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,h/=c/g),n=this.cachedCanvases.getCanvas(p,u,g),r=n.context,r.clearRect(0,0,u,g),r.drawImage(e,0,0,l,c,0,0,u,g),e=n.canvas,l=u,c=g,p=p==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,n=this.current.fillColor,r=this.current.patternFill,o=xt(t);let h,l,c,p;if((e.bitmap||e.data)&&e.count>1){const M=e.bitmap||e.data.buffer;l=JSON.stringify(r?o:[o.slice(0,4),n]),h=this._cachedBitmapsMap.get(M),h||(h=new Map,this._cachedBitmapsMap.set(M,h));const R=h.get(l);if(R&&!r)return{canvas:R,offsetX:Math.round(Math.min(o[0],o[2])+o[4]),offsetY:Math.round(Math.min(o[1],o[3])+o[5])};c=R}c||(p=this.cachedCanvases.getCanvas("maskCanvas",s,i),fd(p.context,e));let u=z.transform(o,[1/s,0,0,-1/i,0,0]);u=z.transform(u,[1,0,0,1,0,-i]);const[g,f,b,w]=z.getAxialAlignedBoundingBox([0,0,s,i],u),y=Math.round(b-g)||1,x=Math.round(w-f)||1,_=this.cachedCanvases.getCanvas("fillCanvas",y,x),E=_.context,C=g,S=f;E.translate(-C,-S),E.transform(...u),c||(c=this._scaleImage(p.canvas,As(E)),c=c.img,h&&r&&h.set(l,c)),E.imageSmoothingEnabled=md(xt(E),e.interpolate),nh(E,c,0,0,c.width,c.height,0,0,s,i),E.globalCompositeOperation="source-in";const T=z.transform(As(E),[1,0,0,1,-C,-S]);return E.fillStyle=r?n.getPattern(t,this,T,Bi):n,E.fillRect(0,0,s,i),h&&!r&&(this.cachedCanvases.delete("fillCanvas"),h.set(l,_.canvas)),{canvas:_.canvas,offsetX:Math.round(C),offsetY:Math.round(S)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=kf[e]}setLineJoin(e){this.ctx.lineJoin=Mf[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const n=this.ctx;n.setTransform(...xt(this.suspendedCtx)),la(this.suspendedCtx,n),function(r,o){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){o.save(),this.__originalSave()},r.restore=function(){o.restore(),this.__originalRestore()},r.translate=function(h,l){o.translate(h,l),this.__originalTranslate(h,l)},r.scale=function(h,l){o.scale(h,l),this.__originalScale(h,l)},r.transform=function(h,l,c,p,u,g){o.transform(h,l,c,p,u,g),this.__originalTransform(h,l,c,p,u,g)},r.setTransform=function(h,l,c,p,u,g){o.setTransform(h,l,c,p,u,g),this.__originalSetTransform(h,l,c,p,u,g)},r.resetTransform=function(){o.resetTransform(),this.__originalResetTransform()},r.rotate=function(h){o.rotate(h),this.__originalRotate(h)},r.clip=function(h){o.clip(h),this.__originalClip(h)},r.moveTo=function(h,l){o.moveTo(h,l),this.__originalMoveTo(h,l)},r.lineTo=function(h,l){o.lineTo(h,l),this.__originalLineTo(h,l)},r.bezierCurveTo=function(h,l,c,p,u,g){o.bezierCurveTo(h,l,c,p,u,g),this.__originalBezierCurveTo(h,l,c,p,u,g)},r.rect=function(h,l,c,p){o.rect(h,l,c,p),this.__originalRect(h,l,c,p)},r.closePath=function(){o.closePath(),this.__originalClosePath()},r.beginPath=function(){o.beginPath(),this.__originalBeginPath()}}(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),la(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const n=i[0],r=i[1],o=i[2]-n,h=i[3]-r;o!==0&&h!==0&&(this.genericComposeSMask(t.context,s,o,h,t.subtype,t.backdrop,t.transferMap,n,r,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,n,r,o,h,l,c,p){let u=e.canvas,g=h-c,f=l-p;if(r){const w=z.makeHexColor(...r);if(g<0||f<0||g+s>u.width||f+i>u.height){const y=this.cachedCanvases.getCanvas("maskExtension",s,i),x=y.context;x.drawImage(u,-g,-f),x.globalCompositeOperation="destination-atop",x.fillStyle=w,x.fillRect(0,0,s,i),x.globalCompositeOperation="source-over",u=y.canvas,g=f=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(g,f,s,i),e.clip(y),e.globalCompositeOperation="destination-atop",e.fillStyle=w,e.fillRect(g,f,s,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),n==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):n==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const b=new Path2D;b.rect(h,l,s,i),t.clip(b),t.globalCompositeOperation="destination-in",t.drawImage(u,g,f,s,i,h,l,s,i),t.restore()}save(){this.inSMaskMode?(la(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),la(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,n,r){this.ctx.transform(e,t,s,i,n,r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const i=this.ctx,n=this.current;let r,o,h=n.x,l=n.y;const c=xt(i),p=c[0]===0&&c[3]===0||c[1]===0&&c[2]===0,u=p?s.slice(0):null;for(let g=0,f=0,b=e.length;g<b;g++)switch(0|e[g]){case Oe.rectangle:h=t[f++],l=t[f++];const w=t[f++],y=t[f++],x=h+w,_=l+y;i.moveTo(h,l),w===0||y===0?i.lineTo(x,_):(i.lineTo(x,l),i.lineTo(x,_),i.lineTo(h,_)),p||n.updateRectMinMax(c,[h,l,x,_]),i.closePath();break;case Oe.moveTo:h=t[f++],l=t[f++],i.moveTo(h,l),p||n.updatePathMinMax(c,h,l);break;case Oe.lineTo:h=t[f++],l=t[f++],i.lineTo(h,l),p||n.updatePathMinMax(c,h,l);break;case Oe.curveTo:r=h,o=l,h=t[f+4],l=t[f+5],i.bezierCurveTo(t[f],t[f+1],t[f+2],t[f+3],h,l),n.updateCurvePathMinMax(c,r,o,t[f],t[f+1],t[f+2],t[f+3],h,l,u),f+=6;break;case Oe.curveTo2:r=h,o=l,i.bezierCurveTo(h,l,t[f],t[f+1],t[f+2],t[f+3]),n.updateCurvePathMinMax(c,r,o,h,l,t[f],t[f+1],t[f+2],t[f+3],u),h=t[f+2],l=t[f+3],f+=4;break;case Oe.curveTo3:r=h,o=l,h=t[f+2],l=t[f+3],i.bezierCurveTo(t[f],t[f+1],h,l,h,l),n.updateCurvePathMinMax(c,r,o,t[f],t[f+1],h,l,h,l,u),f+=4;break;case Oe.closePath:i.closePath()}p&&n.updateScalingPathMinMax(c,u),n.setCurrentPoint(h,l)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(t.save(),t.strokeStyle=s.getPattern(t,this,As(t),Tl),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor;let i=!1;this.current.patternFill&&(t.save(),t.fillStyle=s.getPattern(t,this,As(t),Bi),i=!0);const n=this.current.getClippedPathBoundingBox();this.contentVisible&&n!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),i&&t.restore(),e&&this.consumePath(n)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Rf}eoClip(){this.pendingClip=vd}beginText(){this.current.textMatrix=Yc,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e!==void 0){t.save(),t.beginPath();for(const s of e)t.setTransform(...s.transform),t.translate(s.x,s.y),s.addToPath(t,s.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var c;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||al,i.fontMatrix[0]!==0&&i.fontMatrix[3]!==0||K("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const n=s.loadedName||"sans-serif",r=((c=s.systemFontInfo)==null?void 0:c.css)||`"${n}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const h=s.italic?"italic":"normal";let l=t;t<16?l=16:t>100&&(l=100),this.current.fontSizeScale=t/l,this.ctx.font=`${h} ${o} ${l}px ${r}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,n,r){this.current.textMatrix=[e,t,s,i,n,r],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i){const n=this.ctx,r=this.current,o=r.font,h=r.textRenderingMode,l=r.fontSize/r.fontSizeScale,c=h&Kc,p=!!(h&Cg),u=r.patternFill&&!o.missingFile;let g;(o.disableFontFace||p||u)&&(g=o.getPathGenerator(this.commonObjs,e)),o.disableFontFace||u?(n.save(),n.translate(t,s),n.beginPath(),g(n,l),i&&n.setTransform(...i),c!==qo&&c!==ia||n.fill(),c!==ll&&c!==ia||n.stroke(),n.restore()):(c!==qo&&c!==ia||n.fillText(e,t,s),c!==ll&&c!==ia||n.strokeText(e,t,s)),p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:xt(n),x:t,y:s,fontSize:l,addToPath:g})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return nt(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const n=this.ctx,r=t.fontSizeScale,o=t.charSpacing,h=t.wordSpacing,l=t.fontDirection,c=t.textHScale*l,p=e.length,u=s.vertical,g=u?1:-1,f=s.defaultVMetrics,b=i*t.fontMatrix[0],w=t.textRenderingMode===qo&&!s.disableFontFace&&!t.patternFill;n.save(),n.transform(...t.textMatrix),n.translate(t.x,t.y+t.textRise),l>0?n.scale(c,-1):n.scale(c,1);let y;if(t.patternFill){n.save();const S=t.fillColor.getPattern(n,this,As(n),Bi);y=xt(n),n.restore(),n.fillStyle=S}let x=t.lineWidth;const _=t.textMatrixScale;if(_===0||x===0){const S=t.textRenderingMode&Kc;S!==ll&&S!==ia||(x=this.getSinglePixelWidth())}else x/=_;if(r!==1&&(n.scale(r,r),x/=r),n.lineWidth=x,s.isInvalidPDFjsFont){const S=[];let T=0;for(const M of e)S.push(M.unicode),T+=M.width;n.fillText(S.join(""),0,0),t.x+=T*b*c,n.restore(),this.compose();return}let E,C=0;for(E=0;E<p;++E){const S=e[E];if(typeof S=="number"){C+=g*S*i/1e3;continue}let T=!1;const M=(S.isSpace?h:0)+o,R=S.fontChar,O=S.accent;let N,Z,$=S.width;if(u){const j=S.vmetric||f,it=-(S.vmetric?j[1]:.5*$)*b,ot=j[2]*b;$=j?-j[0]:$,N=it/r,Z=(C+ot)/r}else N=C/r,Z=0;if(s.remeasure&&$>0){const j=1e3*n.measureText(R).width/i*r;if($<j&&this.isFontSubpixelAAEnabled){const it=$/j;T=!0,n.save(),n.scale(it,1),N/=it}else $!==j&&(N+=($-j)/2e3*i/r)}if(this.contentVisible&&(S.isInFont||s.missingFile)){if(w&&!O)n.fillText(R,N,Z);else if(this.paintChar(R,N,Z,y),O){const j=N+i*O.offset.x/r,it=Z-i*O.offset.y/r;this.paintChar(O.fontChar,j,it,y)}}C+=u?$*b-M*l:$*b+M*l,T&&n.restore()}u?t.y-=C:t.x+=C*c,n.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,n=s.fontSize,r=s.fontDirection,o=i.vertical?1:-1,h=s.charSpacing,l=s.wordSpacing,c=s.textHScale*r,p=s.fontMatrix||al,u=e.length;let g,f,b,w;if(s.textRenderingMode!==Eg&&n!==0){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(c,r),g=0;g<u;++g){if(f=e[g],typeof f=="number"){w=o*f*n/1e3,this.ctx.translate(w,0),s.x+=w*c;continue}const y=(f.isSpace?l:0)+h,x=i.charProcOperatorList[f.operatorListId];if(!x){K(`Type3 character "${f.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=f,this.save(),t.scale(n,n),t.transform(...p),this.executeOperatorList(x),this.restore()),b=z.applyTransform([f.width,0],p)[0]*n+y,t.translate(b,0),s.x+=b*c}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,n,r){this.ctx.rect(s,i,n-s,r-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],i=this.baseTransform||xt(this.ctx),n={createCanvasGraphics:r=>new Yl(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Il(e,s,this.ctx,n,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=z.makeHexColor(e,t,s)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=z.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=function(i){switch(i[0]){case"RadialAxial":return new yf(i);case"Mesh":return new xf(i);case"Dummy":return new _f}throw new Error(`Unknown IR type: ${i[0]}`)}(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,As(t),ha);const i=As(t);if(i){const{width:n,height:r}=t.canvas,[o,h,l,c]=z.getAxialAlignedBoundingBox([0,0,n,r],i);this.ctx.fillRect(o,h,l-o,c-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){yt("Should not call beginInlineImage")}beginImageData(){yt("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=xt(this.ctx),t)){const s=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],s,i),this.current.updateRectMinMax(xt(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Qo("TODO: Support non-isolated groups."),e.knockout&&K("Knockout groups not supported.");const s=xt(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=z.getAxialAlignedBoundingBox(e.bbox,xt(t));const n=[0,0,t.canvas.width,t.canvas.height];i=z.intersect(i,n)||[0,0,0,0];const r=Math.floor(i[0]),o=Math.floor(i[1]),h=Math.max(Math.ceil(i[2])-r,1),l=Math.max(Math.ceil(i[3])-o,1);this.current.startNewPathAndClipBox([0,0,h,l]);let c="groupAt"+this.groupLevel;e.smask&&(c+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(c,h,l),u=p.context;u.translate(-r,-o),u.transform(...s),e.smask?this.smaskStack.push({canvas:p.canvas,context:u,offsetX:r,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(r,o),t.save()),la(t,u),this.ctx=u,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=xt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const n=z.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,s,i,n){if(v(this,fi,gc).call(this),rh(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const r=t[2]-t[0],o=t[3]-t[1];if(n&&this.annotationCanvasMap){(s=s.slice())[4]-=t[0],s[5]-=t[1],(t=t.slice())[0]=t[1]=0,t[2]=r,t[3]=o;const[h,l]=z.singularValueDecompose2dScale(xt(this.ctx)),{viewportScale:c}=this,p=Math.ceil(r*this.outputScaleX*c),u=Math.ceil(o*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(p,u);const{canvas:g,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(e,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(h,0,0,-l,0,o*l),rh(this.ctx)}else rh(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],r,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new pd(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),v(this,fi,fc).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;(e=this.getObject(e.data,e)).count=t;const s=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=function(o){const{width:h,height:l}=o;if(h>1e3||l>1e3)return null;const c=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),p=h+1;let u,g,f,b=new Uint8Array(p*(l+1));const w=h+7&-8;let y=new Uint8Array(w*l),x=0;for(const S of o.data){let T=128;for(;T>0;)y[x++]=S&T?0:255,T>>=1}let _=0;for(x=0,y[x]!==0&&(b[0]=1,++_),g=1;g<h;g++)y[x]!==y[x+1]&&(b[g]=y[x]?2:1,++_),x++;for(y[x]!==0&&(b[g]=2,++_),u=1;u<l;u++){x=u*w,f=u*p,y[x-w]!==y[x]&&(b[f]=y[x]?1:8,++_);let S=(y[x]?4:0)+(y[x-w]?8:0);for(g=1;g<h;g++)S=(S>>2)+(y[x+1]?4:0)+(y[x-w+1]?8:0),c[S]&&(b[f+g]=c[S],++_),x++;if(y[x-w]!==y[x]&&(b[f+g]=y[x]?2:4,++_),_>1e3)return null}for(x=w*(l-1),f=u*p,y[x]!==0&&(b[f]=8,++_),g=1;g<h;g++)y[x]!==y[x+1]&&(b[f+g]=y[x]?4:8,++_),x++;if(y[x]!==0&&(b[f+g]=4,++_),_>1e3)return null;const E=new Int32Array([0,p,-1,0,-p,0,0,0,1]),C=new Path2D;for(u=0;_&&u<=l;u++){let S=u*p;const T=S+h;for(;S<T&&!b[S];)S++;if(S===T)continue;C.moveTo(S%p,u);const M=S;let R=b[S];do{const O=E[R];do S+=O;while(!b[S]);const N=b[S];N!==5&&N!==10?(R=N,b[S]=0):(R=N&51*R>>4,b[S]&=R>>2|R<<2),C.lineTo(S%p,S/p|0),b[S]||--_}while(M!==S);--u}return y=null,b=null,function(S){S.save(),S.scale(1/h,-1/l),S.translate(0,-l),S.fill(C),S.beginPath(),S.restore()}}(e)),i.compiled)){i.compiled(s);return}const n=this._createMaskCanvas(e),r=n.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,n.offsetX,n.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,n,r){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const h=xt(o);o.transform(t,s,i,n,0,0);const l=this._createMaskCanvas(e);o.setTransform(1,0,0,1,l.offsetX-h[4],l.offsetY-h[5]);for(let c=0,p=r.length;c<p;c+=2){const u=z.transform(h,[t,s,i,n,r[c],r[c+1]]),[g,f]=z.applyTransform([0,0],u);o.drawImage(l.canvas,g,f)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const n of e){const{data:r,width:o,height:h,transform:l}=n,c=this.cachedCanvases.getCanvas("maskCanvas",o,h),p=c.context;p.save(),fd(p,this.getObject(r,n)),p.globalCompositeOperation="source-in",p.fillStyle=i?s.getPattern(p,this,As(t),Bi):s,p.fillRect(0,0,o,h),p.restore(),t.save(),t.transform(...l),t.scale(1,-1),nh(t,c.canvas,0,0,o,h,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);t?this.paintInlineImageXObject(t):K("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const n=this.getObject(e);if(!n){K("Dependent image isn't ready yet");return}const r=n.width,o=n.height,h=[];for(let l=0,c=i.length;l<c;l+=2)h.push({transform:[t,0,0,s,i[l],i[l+1]],x:0,y:0,w:r,h:o});this.paintInlineImageXObjectGroup(n,h)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,n=this.cachedCanvases.getCanvas("inlineImage",s,i),r=n.context;return r.filter=this.current.transferMaps,r.drawImage(t,0,0),r.filter="none",n.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;if(this.save(),!Ht){const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none")}i.scale(1/t,-1/s);let n;if(e.bitmap)n=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)n=e;else{const o=this.cachedCanvases.getCanvas("inlineImage",t,s).context;gd(o,e),n=this.applyTransferMapsToCanvas(o)}const r=this._scaleImage(n,As(i));i.imageSmoothingEnabled=md(xt(i),e.interpolate),nh(i,r.img,0,0,r.paintWidth,r.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const n=e.width,r=e.height,o=this.cachedCanvases.getCanvas("inlineImage",n,r).context;gd(o,e),i=this.applyTransferMapsToCanvas(o)}for(const n of t)s.save(),s.transform(...n.transform),s.scale(1,-1),nh(s,i,n.x,n.y,n.w,n.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===vd?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=xt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:n}=this.ctx.getTransform();let r,o;if(s===0&&i===0){const h=Math.abs(t),l=Math.abs(n);if(h===l)if(e===0)r=o=1/h;else{const c=h*e;r=o=c<1?1/c:1}else if(e===0)r=1/h,o=1/l;else{const c=h*e,p=l*e;r=c<1?1/c:1,o=p<1?1/p:1}}else{const h=Math.abs(t*n-s*i),l=Math.hypot(t,s),c=Math.hypot(i,n);if(e===0)r=c/h,o=l/h;else{const p=e*h;r=c>p?c/p:1,o=l>p?l/p:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[i,n]=this.getScaleForStroking();if(t.lineWidth=s||1,i===1&&n===1){t.stroke();return}const r=t.getLineDash();if(e&&t.save(),t.scale(i,n),r.length>0){const o=Math.max(i,n);t.setLineDash(r.map(h=>h/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};fi=new WeakSet,gc=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},fc=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}};let Wn=Yl;for(const d in Oe)Wn.prototype[d]!==void 0&&(Wn.prototype[Oe[d]]=Wn.prototype[d]);class ys{static get workerPort(){return a(this,Oa)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");m(this,Oa,e)}static get workerSrc(){return a(this,Na)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");m(this,Na,e)}}Oa=new WeakMap,Na=new WeakMap,A(ys,Oa,null),A(ys,Na,"");const bd=1,Ad=2,yd=1,Pl=2,wd=3,xd=4,_d=5,Sd=6,ah=7,Ll=8;function fe(d){switch(d instanceof Error||typeof d=="object"&&d!==null||yt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),d.name){case"AbortException":return new Fi(d.message);case"MissingPDFException":return new Di(d.message);case"PasswordException":return new cl(d.message,d.code);case"UnexpectedResponseException":return new Jo(d.message,d.status);case"UnknownErrorException":return new dl(d.message,d.details);default:return new dl(d.message,d.toString())}}class ca{constructor(e,t,s){A(this,Re);A(this,cr,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",v(this,Re,gp).bind(this),{signal:a(this,cr).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,n=Promise.withResolvers();this.callbackCapabilities[i]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(r){n.reject(r)}return n.promise}sendWithStream(e,t,s,i){const n=this.streamId++,r=this.sourceName,o=this.targetName,h=this.comObj;return new ReadableStream({start:l=>{const c=Promise.withResolvers();return this.streamControllers[n]={controller:l,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:r,targetName:o,action:e,streamId:n,data:t,desiredSize:l.desiredSize},i),c.promise},pull:l=>{const c=Promise.withResolvers();return this.streamControllers[n].pullCall=c,h.postMessage({sourceName:r,targetName:o,stream:Sd,streamId:n,desiredSize:l.desiredSize}),c.promise},cancel:l=>{Pt(l instanceof Error,"cancel must have a valid reason");const c=Promise.withResolvers();return this.streamControllers[n].cancelCall=c,this.streamControllers[n].isClosed=!0,h.postMessage({sourceName:r,targetName:o,stream:yd,streamId:n,reason:fe(l)}),c.promise}},s)}destroy(){var e;(e=a(this,cr))==null||e.abort(),m(this,cr,null)}}cr=new WeakMap,Re=new WeakSet,gp=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){v(this,Re,mp).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===bd)i.resolve(e.data);else{if(e.callback!==Ad)throw new Error("Unexpected callback case");i.reject(fe(e.reason))}return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,n=this.comObj;new Promise(function(r){r(t(e.data))}).then(function(r){n.postMessage({sourceName:s,targetName:i,callback:bd,callbackId:e.callbackId,data:r})},function(r){n.postMessage({sourceName:s,targetName:i,callback:Ad,callbackId:e.callbackId,reason:fe(r)})})}else e.streamId?v(this,Re,fp).call(this,e):t(e.data)},fp=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,n=this.comObj,r=this,o=this.actionHandler[e.action],h={enqueue(l,c=1,p){if(this.isCancelled)return;const u=this.desiredSize;this.desiredSize-=c,u>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),n.postMessage({sourceName:s,targetName:i,stream:xd,streamId:t,chunk:l},p)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:s,targetName:i,stream:wd,streamId:t}),delete r.streamSinks[t])},error(l){Pt(l instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:s,targetName:i,stream:_d,streamId:t,reason:fe(l)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,new Promise(function(l){l(o(e.data,h))}).then(function(){n.postMessage({sourceName:s,targetName:i,stream:Ll,streamId:t,success:!0})},function(l){n.postMessage({sourceName:s,targetName:i,stream:Ll,streamId:t,reason:fe(l)})})},mp=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,n=this.comObj,r=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Ll:e.success?r.startCall.resolve():r.startCall.reject(fe(e.reason));break;case ah:e.success?r.pullCall.resolve():r.pullCall.reject(fe(e.reason));break;case Sd:if(!o){n.postMessage({sourceName:s,targetName:i,stream:ah,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,new Promise(function(h){var l;h((l=o.onPull)==null?void 0:l.call(o))}).then(function(){n.postMessage({sourceName:s,targetName:i,stream:ah,streamId:t,success:!0})},function(h){n.postMessage({sourceName:s,targetName:i,stream:ah,streamId:t,reason:fe(h)})});break;case xd:if(Pt(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(e.chunk);break;case wd:if(Pt(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),v(this,Re,Nh).call(this,r,t);break;case _d:Pt(r,"error should have stream controller"),r.controller.error(fe(e.reason)),v(this,Re,Nh).call(this,r,t);break;case Pl:e.success?r.cancelCall.resolve():r.cancelCall.reject(fe(e.reason)),v(this,Re,Nh).call(this,r,t);break;case yd:if(!o)break;new Promise(function(h){var l;h((l=o.onCancel)==null?void 0:l.call(o,fe(e.reason)))}).then(function(){n.postMessage({sourceName:s,targetName:i,stream:Pl,streamId:t,success:!0})},function(h){n.postMessage({sourceName:s,targetName:i,stream:Pl,streamId:t,reason:fe(h)})}),o.sinkCapability.reject(fe(e.reason)),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Nh=async function(e,t){var s,i,n;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(n=e.cancelCall)==null?void 0:n.promise]),delete this.streamControllers[t]};class If{constructor({parsedData:e,rawData:t}){A(this,rn);A(this,Ba);m(this,rn,e),m(this,Ba,t)}getRaw(){return a(this,Ba)}get(e){return a(this,rn).get(e)??null}getAll(){return ul(a(this,rn))}has(e){return a(this,rn).has(e)}}rn=new WeakMap,Ba=new WeakMap;const qn=Symbol("INTERNAL");class Pf{constructor(e,{name:t,intent:s,usage:i,rbGroups:n}){A(this,Ha,!1);A(this,ja,!1);A(this,za,!1);A(this,dr,!0);m(this,Ha,!!(e&hl)),m(this,ja,!!(e&Wo)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=n}get visible(){if(a(this,za))return a(this,dr);if(!a(this,dr))return!1;const{print:e,view:t}=this.usage;return a(this,Ha)?(t==null?void 0:t.viewState)!=="OFF":!a(this,ja)||(e==null?void 0:e.printState)!=="OFF"}_setVisible(e,t,s=!1){e!==qn&&yt("Internal method `_setVisible` called."),m(this,za,s),m(this,dr,t)}}Ha=new WeakMap,ja=new WeakMap,za=new WeakMap,dr=new WeakMap;class Lf{constructor(e,t=hl){A(this,$a);A(this,mi,null);A(this,dt,new Map);A(this,ur,null);A(this,pr,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,m(this,pr,e.order);for(const s of e.groups)a(this,dt).set(s.id,new Pf(t,s));if(e.baseState==="OFF")for(const s of a(this,dt).values())s._setVisible(qn,!1);for(const s of e.on)a(this,dt).get(s)._setVisible(qn,!0);for(const s of e.off)a(this,dt).get(s)._setVisible(qn,!1);m(this,ur,this.getHash())}}isVisible(e){if(a(this,dt).size===0)return!0;if(!e)return Qo("Optional content group not defined."),!0;if(e.type==="OCG")return a(this,dt).has(e.id)?a(this,dt).get(e.id).visible:(K(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return v(this,$a,mc).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!a(this,dt).has(t))return K(`Optional content group not found: ${t}`),!0;if(a(this,dt).get(t).visible)return!0}return!1}if(e.policy==="AllOn"){for(const t of e.ids){if(!a(this,dt).has(t))return K(`Optional content group not found: ${t}`),!0;if(!a(this,dt).get(t).visible)return!1}return!0}if(e.policy==="AnyOff"){for(const t of e.ids){if(!a(this,dt).has(t))return K(`Optional content group not found: ${t}`),!0;if(!a(this,dt).get(t).visible)return!0}return!1}if(e.policy==="AllOff"){for(const t of e.ids){if(!a(this,dt).has(t))return K(`Optional content group not found: ${t}`),!0;if(a(this,dt).get(t).visible)return!1}return!0}return K(`Unknown optional content policy ${e.policy}.`),!0}return K(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var n;const i=a(this,dt).get(e);if(i){if(s&&t&&i.rbGroups.length)for(const r of i.rbGroups)for(const o of r)o!==e&&((n=a(this,dt).get(o))==null||n._setVisible(qn,!1,!0));i._setVisible(qn,!!t,!0),m(this,mi,null)}else K(`Optional content group not found: ${e}`)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const n=a(this,dt).get(i);if(n)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!n.visible,t)}}m(this,mi,null)}get hasInitialVisibility(){return a(this,ur)===null||this.getHash()===a(this,ur)}getOrder(){return a(this,dt).size?a(this,pr)?a(this,pr).slice():[...a(this,dt).keys()]:null}getGroups(){return a(this,dt).size>0?ul(a(this,dt)):null}getGroup(e){return a(this,dt).get(e)||null}getHash(){if(a(this,mi)!==null)return a(this,mi);const e=new nd;for(const[t,s]of a(this,dt))e.update(`${t}:${s.visible}`);return m(this,mi,e.hexdigest())}}mi=new WeakMap,dt=new WeakMap,ur=new WeakMap,pr=new WeakMap,$a=new WeakSet,mc=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const n=e[i];let r;if(Array.isArray(n))r=v(this,$a,mc).call(this,n);else{if(!a(this,dt).has(n))return K(`Optional content group not found: ${n}`),!0;r=a(this,dt).get(n).visible}switch(s){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return s==="And"};class Df{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Pt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:n,progressiveDone:r,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=o,(n==null?void 0:n.length)>0){const h=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,l)=>{this._onReceiveData({begin:h,chunk:l})}),e.addProgressListener((h,l)=>{this._onProgress({loaded:h,total:l})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;e===void 0?this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s):Pt(this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(s),!0)}),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,n;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(n=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||n.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Pt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Ff(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Of(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class Ff{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=vl(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Of{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Dl(d,e){const t=new Headers;if(!d||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function Fl({responseHeaders:d,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},n=parseInt(d.get("Content-Length"),10);return!Number.isInteger(n)||(i.suggestedLength=n,n<=2*t)||s||!e||d.get("Accept-Ranges")!=="bytes"||(d.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function Ol(d){const e=d.get("Content-Disposition");if(e){let t=function(s){let i=!0,n=r("filename\\*","i").exec(s);if(n){n=n[1];let u=l(n);return u=unescape(u),u=c(u),u=p(u),h(u)}if(n=function(u){const g=[];let f;const b=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=b.exec(u))!==null;){let[,y,x,_]=f;if(y=parseInt(y,10),y in g){if(y===0)break}else g[y]=[x,_]}const w=[];for(let y=0;y<g.length&&y in g;++y){let[x,_]=g[y];_=l(_),x&&(_=unescape(_),y===0&&(_=c(_))),w.push(_)}return w.join("")}(s),n)return h(p(n));if(n=r("filename","i").exec(s),n){n=n[1];let u=l(n);return u=p(u),h(u)}function r(u,g){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function o(u,g){if(u){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const f=new TextDecoder(u,{fatal:!0}),b=Zo(g);g=f.decode(b),i=!1}catch{}}return g}function h(u){return i&&/[\x80-\xff]/.test(u)&&(u=o("utf-8",u),i&&(u=o("iso-8859-1",u))),u}function l(u){if(u.startsWith('"')){const g=u.slice(1).split('\\"');for(let f=0;f<g.length;++f){const b=g[f].indexOf('"');b!==-1&&(g[f]=g[f].slice(0,b),g.length=f+1),g[f]=g[f].replaceAll(/\\(.)/g,"$1")}u=g.join('"')}return u}function c(u){const g=u.indexOf("'");return g===-1?u:o(u.slice(0,g),u.slice(g+1).replace(/^[^']*'/,""))}function p(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,f,b,w){if(b==="q"||b==="Q")return o(f,w=(w=w.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(y,x){return String.fromCharCode(parseInt(x,16))}));try{w=atob(w)}catch{}return o(f,w)})}return""}(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(vl(t))return t}return null}function oh(d,e){return d===404||d===0&&e.startsWith("file:")?new Di('Missing PDF "'+e+'".'):new Jo(`Unexpected server response (${d}) while retrieving PDF "${e}".`,d)}function Ed(d){return d===200||d===206}function Cd(d,e,t){return{method:"GET",headers:d,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Td(d){return d instanceof Uint8Array?d.buffer:d instanceof ArrayBuffer?d:(K(`getArrayBuffer - unexpected data format: ${d}`),new Uint8Array(d).buffer)}class kd{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Dl(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Pt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Nf(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Bf(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class Nf{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,Cd(s,this._withCredentials,this._abortController)).then(n=>{if(!Ed(n.status))throw oh(n.status,i);this._reader=n.body.getReader(),this._headersCapability.resolve();const r=n.headers,{allowRangeRequests:o,suggestedLength:h}=Fl({responseHeaders:r,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=h||this._contentLength,this._filename=Ol(r),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Fi("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Td(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class Bf{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const n=new Headers(e.headers);n.append("Range",`bytes=${t}-${s-1}`);const r=i.url;fetch(r,Cd(n,this._withCredentials,this._abortController)).then(o=>{if(!Ed(o.status))throw oh(o.status,r);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:Td(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class Hf{constructor({url:e,httpHeaders:t,withCredentials:s}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Dl(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,s){const i={begin:e,end:t};for(const n in s)i[n]=s[n];return this.request(i)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[n,r]of this.headers)t.setRequestHeader(n,r);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=206):i.expectedStatus=200,t.responseType="arraybuffer",e.onError&&(t.onerror=function(n){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){var o,h,l;const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){(o=s.onError)==null||o.call(s,i.status);return}const n=i.status||200;if(!(n===200&&s.expectedStatus===206)&&n!==s.expectedStatus){(h=s.onError)==null||h.call(s,i.status);return}const r=function(c){const p=c.response;return typeof p!="string"?p:Zo(p).buffer}(i);if(n===206){const c=i.getResponseHeader("Content-Range"),p=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);s.onDone({begin:parseInt(p[1],10),chunk:r})}else r?s.onDone({begin:0,chunk:r}):(l=s.onError)==null||l.call(s,i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class jf{constructor(e){this._source=e,this._manager=new Hf(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Pt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new zf(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new $f(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class zf{constructor(e,t){this._manager=e;const s={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(s),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e),s=new Headers(t.getAllResponseHeaders().trim().split(/[\r\n]+/).map(r=>{const[o,...h]=r.split(": ");return[o,h.join(": ")]})),{allowRangeRequests:i,suggestedLength:n}=Fl({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=n||this._contentLength,this._filename=Ol(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=oh(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class $f{constructor(e,t,s){this._manager=e;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,s,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=oh(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||((t=this.onProgress)==null||t.call(this,{loaded:e.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Uf=/^[a-z][a-z0-9\-+.]+:/i;function Md(d,e,t){return d.protocol==="http:"?si.get("http").request(d,{headers:e},t):si.get("https").request(d,{headers:e},t)}class Gf{constructor(e){this.source=e,this.url=function(t){if(Uf.test(t))return new URL(t);const s=si.get("url");return new URL(s.pathToFileURL(t))}(e.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=Dl(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Pt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new qf(this):new Vf(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=this.isFsUrl?new Xf(this,e,t):new Wf(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class Rd{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Fi("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Id{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class Vf extends Rd{constructor(e){super(e);const t=Object.fromEntries(e.headers);this._request=Md(this._url,t,s=>{if(s.statusCode===404){const o=new Di(`Missing PDF "${this._url}".`);this._storedError=o,this._headersCapability.reject(o);return}this._headersCapability.resolve(),this._setReadableStream(s);const i=new Headers(this._readableStream.headers),{allowRangeRequests:n,suggestedLength:r}=Fl({responseHeaders:i,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=r||this._contentLength,this._filename=Ol(i)}),this._request.on("error",s=>{this._storedError=s,this._headersCapability.reject(s)}),this._request.end()}}class Wf extends Id{constructor(e,t,s){super(e);const i=Object.fromEntries(e.headers);i.Range=`bytes=${t}-${s-1}`,this._request=Md(this._url,i,n=>{if(n.statusCode!==404)this._setReadableStream(n);else{const r=new Di(`Missing PDF "${this._url}".`);this._storedError=r}}),this._request.on("error",n=>{this._storedError=n}),this._request.end()}}class qf extends Rd{constructor(e){super(e);const t=si.get("fs");t.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(t.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new Di(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}}class Xf extends Id{constructor(e,t,s){super(e);const i=si.get("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:s-1}))}}const he=30,Dt=class Dt{constructor({textContentSource:e,container:t,viewport:s}){A(this,Rs);A(this,vi,Promise.withResolvers());A(this,ce,null);A(this,Ua,!1);A(this,Ga,!!((qd=globalThis.FontInspector)!=null&&qd.enabled));A(this,an,null);A(this,Ms,null);A(this,Va,0);A(this,Wa,0);A(this,on,null);A(this,gr,null);A(this,fr,0);A(this,bi,0);A(this,mr,Object.create(null));A(this,qa,[]);A(this,vr,null);A(this,hn,[]);A(this,Xa,new WeakMap);A(this,Ya,null);var h;if(e instanceof ReadableStream)m(this,vr,e);else{if(typeof e!="object")throw new Error('No "textContentSource" parameter specified.');m(this,vr,new ReadableStream({start(l){l.enqueue(e),l.close()}}))}m(this,ce,m(this,gr,t)),m(this,bi,s.scale*(globalThis.devicePixelRatio||1)),m(this,fr,s.rotation),m(this,Ms,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:n,pageX:r,pageY:o}=s.rawDims;m(this,Ya,[1,0,0,-1,-r,o+n]),m(this,Wa,i),m(this,Va,n),v(h=Dt,be,Ap).call(h),Oi(t,s),a(this,vi).promise.finally(()=>{a(Dt,br).delete(this),m(this,Ms,null),m(this,mr,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=ee.platform;return nt(this,"fontFamilyMap",new Map([["sans-serif",(e&&t?"Calibri, ":"")+"sans-serif"],["monospace",(e&&t?"Lucida Console, ":"")+"monospace"]]))}render(){const e=()=>{a(this,on).read().then(({value:t,done:s})=>{s?a(this,vi).resolve():(a(this,an)??m(this,an,t.lang),Object.assign(a(this,mr),t.styles),v(this,Rs,vp).call(this,t.items),e())},a(this,vi).reject)};return m(this,on,a(this,vr).getReader()),a(Dt,br).add(this),e(),a(this,vi).promise}update({viewport:e,onBefore:t=null}){var n;const s=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==a(this,fr)&&(t==null||t(),m(this,fr,i),Oi(a(this,gr),{rotation:i})),s!==a(this,bi)){t==null||t(),m(this,bi,s);const r={div:null,properties:null,ctx:v(n=Dt,be,Bh).call(n,a(this,an))};for(const o of a(this,hn))r.properties=a(this,Xa).get(o),r.div=o,v(this,Rs,vc).call(this,r)}}cancel(){var t;const e=new Fi("TextLayer task cancelled.");(t=a(this,on))==null||t.cancel(e).catch(()=>{}),m(this,on,null),a(this,vi).reject(e)}get textDivs(){return a(this,hn)}get textContentItemsStr(){return a(this,qa)}static cleanup(){if(!(a(this,br).size>0)){a(this,ln).clear();for(const{canvas:e}of a(this,cn).values())e.remove();a(this,cn).clear()}}};vi=new WeakMap,ce=new WeakMap,Ua=new WeakMap,Ga=new WeakMap,an=new WeakMap,Ms=new WeakMap,Va=new WeakMap,Wa=new WeakMap,on=new WeakMap,gr=new WeakMap,fr=new WeakMap,bi=new WeakMap,mr=new WeakMap,qa=new WeakMap,vr=new WeakMap,hn=new WeakMap,Xa=new WeakMap,Ya=new WeakMap,ln=new WeakMap,cn=new WeakMap,Ka=new WeakMap,Ai=new WeakMap,br=new WeakMap,Rs=new WeakSet,vp=function(e){var i,n;if(a(this,Ua))return;(n=a(this,Ms)).ctx??(n.ctx=v(i=Dt,be,Bh).call(i,a(this,an)));const t=a(this,hn),s=a(this,qa);for(const r of e){if(t.length>1e5){K("Ignoring additional textDivs for performance reasons."),m(this,Ua,!0);return}if(r.str!==void 0)s.push(r.str),v(this,Rs,bp).call(this,r);else if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const o=a(this,ce);m(this,ce,document.createElement("span")),a(this,ce).classList.add("markedContent"),r.id!==null&&a(this,ce).setAttribute("id",`${r.id}`),o.append(a(this,ce))}else r.type==="endMarkedContent"&&m(this,ce,a(this,ce).parentNode)}},bp=function(e){var b;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};a(this,hn).push(t);const i=z.transform(a(this,Ya),e.transform);let n=Math.atan2(i[1],i[0]);const r=a(this,mr)[e.fontName];r.vertical&&(n+=Math.PI/2);let o=a(this,Ga)&&r.fontSubstitution||r.fontFamily;o=Dt.fontFamilyMap.get(o)||o;const h=Math.hypot(i[2],i[3]),l=h*v(b=Dt,be,yp).call(b,o,a(this,an));let c,p;n===0?(c=i[4],p=i[5]-l):(c=i[4]+l*Math.sin(n),p=i[5]-l*Math.cos(n));const u="calc(var(--scale-factor)*",g=t.style;a(this,ce)===a(this,gr)?(g.left=`${(100*c/a(this,Wa)).toFixed(2)}%`,g.top=`${(100*p/a(this,Va)).toFixed(2)}%`):(g.left=`${u}${c.toFixed(2)}px)`,g.top=`${u}${p.toFixed(2)}px)`),g.fontSize=`${u}${(a(Dt,Ai)*h).toFixed(2)}px)`,g.fontFamily=o,s.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,a(this,Ga)&&(t.dataset.fontName=r.fontSubstitutionLoadedName||e.fontName),n!==0&&(s.angle=n*(180/Math.PI));let f=!1;if(e.str.length>1)f=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),y=Math.abs(e.transform[3]);w!==y&&Math.max(w,y)/Math.min(w,y)>1.5&&(f=!0)}if(f&&(s.canvasWidth=r.vertical?e.height:e.width),a(this,Xa).set(t,s),a(this,Ms).div=t,a(this,Ms).properties=s,v(this,Rs,vc).call(this,a(this,Ms)),s.hasText&&a(this,ce).append(t),s.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),a(this,ce).append(w)}},vc=function(e){var o;const{div:t,properties:s,ctx:i}=e,{style:n}=t;let r="";if(a(Dt,Ai)>1&&(r=`scale(${1/a(Dt,Ai)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:h}=n,{canvasWidth:l,fontSize:c}=s;v(o=Dt,be,bc).call(o,i,c*a(this,bi),h);const{width:p}=i.measureText(t.textContent);p>0&&(r=`scaleX(${l*a(this,bi)/p}) ${r}`)}s.angle!==0&&(r=`rotate(${s.angle}deg) ${r}`),r.length>0&&(n.transform=r)},be=new WeakSet,Bh=function(e=null){let t=a(this,cn).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),a(this,cn).set(e,t),a(this,Ka).set(t,{size:0,family:""})}return t},bc=function(e,t,s){const i=a(this,Ka).get(e);(t!==i.size||s!==i.family)&&(e.font=`${t}px ${s}`,i.size=t,i.family=s)},Ap=function(){if(a(this,Ai)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),m(this,Ai,e.getBoundingClientRect().height),e.remove()},yp=function(e,t){const s=a(this,ln).get(e);if(s)return s;const i=v(this,be,Bh).call(this,t);i.canvas.width=i.canvas.height=he,v(this,be,bc).call(this,i,he,e);const n=i.measureText("");let r=n.fontBoundingBoxAscent,o=Math.abs(n.fontBoundingBoxDescent);if(r){const c=r/(r+o);return a(this,ln).set(e,c),i.canvas.width=i.canvas.height=0,c}i.strokeStyle="red",i.clearRect(0,0,he,he),i.strokeText("g",0,0);let h=i.getImageData(0,0,he,he).data;o=0;for(let c=h.length-1-3;c>=0;c-=4)if(h[c]>0){o=Math.ceil(c/4/he);break}i.clearRect(0,0,he,he),i.strokeText("A",0,he),h=i.getImageData(0,0,he,he).data,r=0;for(let c=0,p=h.length;c<p;c+=4)if(h[c]>0){r=he-Math.floor(c/4/he);break}i.canvas.width=i.canvas.height=0;const l=r?r/(r+o):.8;return a(this,ln).set(e,l),l},A(Dt,be),A(Dt,ln,new Map),A(Dt,cn,new Map),A(Dt,Ka,new WeakMap),A(Dt,Ai,null),A(Dt,br,new Set);let da=Dt;class ua{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};return function i(n){var h;if(!n)return;let r=null;const o=n.name;if(o==="#text")r=n.value;else{if(!ua.shouldBuildText(o))return;(h=n==null?void 0:n.attributes)!=null&&h.textContent?r=n.attributes.textContent:n.value&&(r=n.value)}if(r!==null&&t.push({str:r}),n.children)for(const l of n.children)i(l)}(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const Yf=65536,Kf=Ht?class extends ad{_createCanvas(d,e){return si.get("canvas").createCanvas(d,e)}}:class extends ad{constructor({ownerDocument:d=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=d}_createCanvas(d,e){const t=this._document.createElement("canvas");return t.width=d,t.height=e,t}},Qf=Ht?class extends od{async _fetch(d){return ud(d)}}:hd,Jf=Ht?class extends ld{}:(Xd=class extends ld{constructor({docId:e,ownerDocument:t=globalThis.document}){super();A(this,B);A(this,dn);A(this,un);A(this,os);A(this,Is);A(this,Qt);A(this,wh);A(this,pn,0);m(this,Is,e),m(this,Qt,t)}addFilter(e){if(!e)return"none";let t=a(this,B,te).get(e);if(t)return t;const[s,i,n]=v(this,B,Hh).call(this,e),r=e.length===1?s:`${s}${i}${n}`;if(t=a(this,B,te).get(r),t)return a(this,B,te).set(e,t),t;const o=`g_${a(this,Is)}_transfer_map_${re(this,pn)._++}`,h=v(this,B,Jr).call(this,o);a(this,B,te).set(e,h),a(this,B,te).set(r,h);const l=v(this,B,Zr).call(this,o);return v(this,B,Oo).call(this,s,i,n,l),h}addHCMFilter(e,t){var g;const s=`${e}-${t}`,i="base";let n=a(this,B,Kr).get(i);if((n==null?void 0:n.key)===s||(n?((g=n.filter)==null||g.remove(),n.key=s,n.url="none",n.filter=null):(n={key:s,url:"none",filter:null},a(this,B,Kr).set(i,n)),!e||!t))return n.url;const r=v(this,B,No).call(this,e);e=z.makeHexColor(...r);const o=v(this,B,No).call(this,t);if(t=z.makeHexColor(...o),a(this,B,Qr).style.color="",e==="#000000"&&t==="#ffffff"||e===t)return n.url;const h=new Array(256);for(let f=0;f<=255;f++){const b=f/255;h[f]=b<=.03928?b/12.92:((b+.055)/1.055)**2.4}const l=h.join(","),c=`g_${a(this,Is)}_hcm_filter`,p=n.filter=v(this,B,Zr).call(this,c);v(this,B,Oo).call(this,l,l,l,p),v(this,B,Ac).call(this,p);const u=(f,b)=>{const w=r[f]/255,y=o[f]/255,x=new Array(b+1);for(let _=0;_<=b;_++)x[_]=w+_/b*(y-w);return x.join(",")};return v(this,B,Oo).call(this,u(0,5),u(1,5),u(2,5),p),n.url=v(this,B,Jr).call(this,c),n.url}addAlphaFilter(e){let t=a(this,B,te).get(e);if(t)return t;const[s]=v(this,B,Hh).call(this,[e]),i=`alpha_${s}`;if(t=a(this,B,te).get(i),t)return a(this,B,te).set(e,t),t;const n=`g_${a(this,Is)}_alpha_map_${re(this,pn)._++}`,r=v(this,B,Jr).call(this,n);a(this,B,te).set(e,r),a(this,B,te).set(i,r);const o=v(this,B,Zr).call(this,n);return v(this,B,yc).call(this,s,o),r}addLuminosityFilter(e){let t,s,i=a(this,B,te).get(e||"luminosity");if(i)return i;if(e?([t]=v(this,B,Hh).call(this,[e]),s=`luminosity_${t}`):s="luminosity",i=a(this,B,te).get(s),i)return a(this,B,te).set(e,i),i;const n=`g_${a(this,Is)}_luminosity_map_${re(this,pn)._++}`,r=v(this,B,Jr).call(this,n);a(this,B,te).set(e,r),a(this,B,te).set(s,r);const o=v(this,B,Zr).call(this,n);return v(this,B,wp).call(this,o),e&&v(this,B,yc).call(this,t,o),r}addHighlightHCMFilter(e,t,s,i,n){var y;const r=`${t}-${s}-${i}-${n}`;let o=a(this,B,Kr).get(e);if((o==null?void 0:o.key)===r||(o?((y=o.filter)==null||y.remove(),o.key=r,o.url="none",o.filter=null):(o={key:r,url:"none",filter:null},a(this,B,Kr).set(e,o)),!t||!s))return o.url;const[h,l]=[t,s].map(v(this,B,No).bind(this));let c=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),p=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),[u,g]=[i,n].map(v(this,B,No).bind(this));p<c&&([c,p,u,g]=[p,c,g,u]),a(this,B,Qr).style.color="";const f=(x,_,E)=>{const C=new Array(256),S=(p-c)/E,T=x/255,M=(_-x)/(255*E);let R=0;for(let O=0;O<=E;O++){const N=Math.round(c+O*S),Z=T+O*M;for(let $=R;$<=N;$++)C[$]=Z;R=N+1}for(let O=R;O<256;O++)C[O]=C[R-1];return C.join(",")},b=`g_${a(this,Is)}_hcm_${e}_filter`,w=o.filter=v(this,B,Zr).call(this,b);return v(this,B,Ac).call(this,w),v(this,B,Oo).call(this,f(u[0],g[0],5),f(u[1],g[1],5),f(u[2],g[2],5),w),o.url=v(this,B,Jr).call(this,b),o.url}destroy(e=!1){(!e||a(this,B,Kr).size===0)&&(a(this,os)&&(a(this,os).parentNode.parentNode.remove(),m(this,os,null)),a(this,un)&&(a(this,un).clear(),m(this,un,null)),m(this,pn,0))}},dn=new WeakMap,un=new WeakMap,os=new WeakMap,Is=new WeakMap,Qt=new WeakMap,wh=new WeakMap,pn=new WeakMap,B=new WeakSet,te=function(){return a(this,un)||m(this,un,new Map)},Kr=function(){return a(this,wh)||m(this,wh,new Map)},Qr=function(){if(!a(this,os)){const e=a(this,Qt).createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const s=a(this,Qt).createElementNS(bs,"svg");s.setAttribute("width",0),s.setAttribute("height",0),m(this,os,a(this,Qt).createElementNS(bs,"defs")),e.append(s),s.append(a(this,os)),a(this,Qt).body.append(e)}return a(this,os)},Hh=function(e){if(e.length===1){const h=e[0],l=new Array(256);for(let p=0;p<256;p++)l[p]=h[p]/255;const c=l.join(",");return[c,c,c]}const[t,s,i]=e,n=new Array(256),r=new Array(256),o=new Array(256);for(let h=0;h<256;h++)n[h]=t[h]/255,r[h]=s[h]/255,o[h]=i[h]/255;return[n.join(","),r.join(","),o.join(",")]},Jr=function(e){if(a(this,dn)===void 0){m(this,dn,"");const t=a(this,Qt).URL;t!==a(this,Qt).baseURI&&(eh(t)?K('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,dn,t.split("#",1)[0]))}return`url(${a(this,dn)}#${e})`},wp=function(e){const t=a(this,Qt).createElementNS(bs,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)},Ac=function(e){const t=a(this,Qt).createElementNS(bs,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)},Zr=function(e){const t=a(this,Qt).createElementNS(bs,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),a(this,B,Qr).append(t),t},Fo=function(e,t,s){const i=a(this,Qt).createElementNS(bs,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",s),e.append(i)},Oo=function(e,t,s,i){const n=a(this,Qt).createElementNS(bs,"feComponentTransfer");i.append(n),v(this,B,Fo).call(this,n,"feFuncR",e),v(this,B,Fo).call(this,n,"feFuncG",t),v(this,B,Fo).call(this,n,"feFuncB",s)},yc=function(e,t){const s=a(this,Qt).createElementNS(bs,"feComponentTransfer");t.append(s),v(this,B,Fo).call(this,s,"feFuncA",e)},No=function(e){return a(this,B,Qr).style.color=e,Al(getComputedStyle(a(this,B,Qr)).getPropertyValue("color"))},Xd),Zf=Ht?class extends cd{async _fetch(d){return ud(d)}}:dd;function tm(d={}){typeof d=="string"||d instanceof URL?d={url:d}:(d instanceof ArrayBuffer||ArrayBuffer.isView(d))&&(d={data:d});const e=new Nl,{docId:t}=e,s=d.url?function(k){if(k instanceof URL)return k.href;try{return new URL(k,window.location).href}catch{if(Ht&&typeof k=="string")return k}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(d.url):null,i=d.data?function(k){if(Ht&&typeof Jd<"u"&&k instanceof Jd)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(k instanceof Uint8Array&&k.byteLength===k.buffer.byteLength)return k;if(typeof k=="string")return Zo(k);if(k instanceof ArrayBuffer||ArrayBuffer.isView(k)||typeof k=="object"&&!isNaN(k==null?void 0:k.length))return new Uint8Array(k);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(d.data):null,n=d.httpHeaders||null,r=d.withCredentials===!0,o=d.password??null,h=d.range instanceof Ld?d.range:null,l=Number.isInteger(d.rangeChunkSize)&&d.rangeChunkSize>0?d.rangeChunkSize:Yf;let c=d.worker instanceof Xn?d.worker:null;const p=d.verbosity,u=typeof d.docBaseUrl!="string"||eh(d.docBaseUrl)?null:d.docBaseUrl,g=typeof d.cMapUrl=="string"?d.cMapUrl:null,f=d.cMapPacked!==!1,b=d.CMapReaderFactory||Qf,w=typeof d.standardFontDataUrl=="string"?d.standardFontDataUrl:null,y=d.StandardFontDataFactory||Zf,x=d.stopAtErrors!==!0,_=Number.isInteger(d.maxImageSize)&&d.maxImageSize>-1?d.maxImageSize:-1,E=d.isEvalSupported!==!1,C=typeof d.isOffscreenCanvasSupported=="boolean"?d.isOffscreenCanvasSupported:!Ht,S=typeof d.isChrome=="boolean"?d.isChrome:!ee.platform.isFirefox&&typeof window<"u"&&!!(window!=null&&window.chrome),T=Number.isInteger(d.canvasMaxAreaInBytes)?d.canvasMaxAreaInBytes:-1,M=typeof d.disableFontFace=="boolean"?d.disableFontFace:Ht,R=d.fontExtraProperties===!0,O=d.enableXfa===!0,N=d.ownerDocument||globalThis.document,Z=d.disableRange===!0,$=d.disableStream===!0,j=d.disableAutoFetch===!0,it=d.pdfBug===!0,ot=d.CanvasFactory||Kf,mt=d.FilterFactory||Jf,H=d.enableHWA===!0,q=h?h.length:d.length??NaN,Mt=typeof d.useSystemFonts=="boolean"?d.useSystemFonts:!Ht&&!M,ge=typeof d.useWorkerFetch=="boolean"?d.useWorkerFetch:b===hd&&y===dd&&g&&w&&ra(g,document.baseURI)&&ra(w,document.baseURI);d.canvasFactory&&sd("`canvasFactory`-instance option, please use `CanvasFactory` instead."),d.filterFactory&&sd("`filterFactory`-instance option, please use `FilterFactory` instead."),Kg(p);const vt={canvasFactory:new ot({ownerDocument:N,enableHWA:H}),filterFactory:new mt({docId:t,ownerDocument:N}),cMapReaderFactory:ge?null:new b({baseUrl:g,isCompressed:f}),standardFontDataFactory:ge?null:new y({baseUrl:w})};if(!c){const k={verbosity:p,port:ys.workerPort};c=k.port?Xn.fromPort(k):new Xn(k),e._worker=c}const F={docId:t,apiVersion:"4.8.69",data:i,password:o,disableAutoFetch:j,rangeChunkSize:l,length:q,docBaseUrl:u,enableXfa:O,evaluatorOptions:{maxImageSize:_,disableFontFace:M,ignoreErrors:x,isEvalSupported:E,isOffscreenCanvasSupported:C,isChrome:S,canvasMaxAreaInBytes:T,fontExtraProperties:R,useSystemFonts:Mt,cMapUrl:ge?g:null,standardFontDataUrl:ge?w:null}},I={disableFontFace:M,fontExtraProperties:R,ownerDocument:N,pdfBug:it,styleElement:null,loadingParams:{disableAutoFetch:j,enableXfa:O}};return c.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const k=c.messageHandler.sendWithPromise("GetDocRequest",F,i?[i.buffer]:null);let D;if(h)D=new Df(h,{disableRange:Z,disableStream:$});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");let U;Ht?U=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&ra(s)?kd:Gf:U=ra(s)?kd:jf,D=new U({url:s,length:q,httpHeaders:n,withCredentials:r,rangeChunkSize:l,disableRange:Z,disableStream:$})}return k.then(U=>{if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const rt=new ca(t,U,c.port),Bt=new nm(rt,e,D,I,vt);e._transport=Bt,rt.send("Ready",null)})}).catch(e._capability.reject),e}function Pd(d){return typeof d=="object"&&Number.isInteger(d==null?void 0:d.num)&&d.num>=0&&Number.isInteger(d==null?void 0:d.gen)&&d.gen>=0}const _h=class _h{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId="d"+re(_h,xh)._++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,i}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};xh=new WeakMap,A(_h,xh,0);let Nl=_h;class Ld{constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){yt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class em{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return nt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class sm{constructor(e,t,s,i=!1){A(this,Ie);A(this,yi,null);A(this,Ps,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new ed:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new Dd,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:n=!1}={}){return new na({viewBox:this.view,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:n})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return nt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=Js.ENABLE,transform:n=null,background:r=null,optionalContentConfigPromise:o=null,annotationCanvasMap:h=null,pageColors:l=null,printAnnotationStorage:c=null,isEditing:p=!1}){var E,C;(E=this._stats)==null||E.time("Overall");const u=this._transport.getRenderingIntent(s,i,c,p),{renderingIntent:g,cacheKey:f}=u;m(this,Ps,!1),v(this,Ie,jh).call(this),o||(o=this._transport.getOptionalContentConfig(g));let b=this._intentStates.get(f);b||(b=Object.create(null),this._intentStates.set(f,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const w=!!(g&Wo);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(u));const y=S=>{var T;b.renderTasks.delete(x),(this._maybeCleanupAfterRender||w)&&m(this,Ps,!0),v(this,Ie,ta).call(this,!w),S?(x.capability.reject(S),this._abortOperatorList({intentState:b,reason:S instanceof Error?S:new Error(S)})):x.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(T=globalThis.Stats)!=null&&T.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},x=new Bl({callback:y,params:{canvasContext:e,viewport:t,transform:n,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:l});(b.renderTasks||(b.renderTasks=new Set)).add(x);const _=x.task;return Promise.all([b.displayReadyCapability.promise,o]).then(([S,T])=>{var M;if(this.destroyed)y();else{if((M=this._stats)==null||M.time("Rendering"),!(T.renderingIntent&g))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");x.initializeGraphics({transparency:S,optionalContentConfig:T}),x.operatorListChanged()}}).catch(y),_}getOperatorList({intent:e="display",annotationMode:t=Js.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var h;const n=this._transport.getRenderingIntent(e,t,s,i,!0);let r,o=this._intentStates.get(n.cacheKey);return o||(o=Object.create(null),this._intentStates.set(n.cacheKey,o)),o.opListReadCapability||(r=Object.create(null),r.operatorListChanged=function(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(r))},o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(r),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(n)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size:s=>s.items.length})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>ua.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){const n=t.getReader(),r={items:[],styles:Object.create(null),lang:null};(function o(){n.read().then(function({value:h,done:l}){l?s(r):(r.lang??(r.lang=h.lang),Object.assign(r.styles,h.styles),r.items.push(...h.items),o())},i)})()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),m(this,Ps,!1),v(this,Ie,jh).call(this),Promise.all(e)}cleanup(e=!1){m(this,Ps,!0);const t=v(this,Ie,ta).call(this,!1);return e&&t&&this._stats&&(this._stats=new ed),t}_startRenderPage(e,t){var i,n;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(n=s.displayReadyCapability)==null||n.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&v(this,Ie,ta).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:n,transfer:r}=s,o=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:n,modifiedIds:i},r).getReader(),h=this._intentStates.get(t);h.streamReader=o;const l=()=>{o.read().then(({value:c,done:p})=>{p?h.streamReader=null:this._transport.destroyed||(this._renderPageChunk(c,h),l())},c=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const p of h.renderTasks)p.operatorListChanged();v(this,Ie,ta).call(this,!0)}if(h.displayReadyCapability)h.displayReadyCapability.reject(c);else{if(!h.opListReadCapability)throw c;h.opListReadCapability.reject(c)}}})};l()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof ml){let i=100;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Fi(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,n]of this._intentStates)if(n===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}yi=new WeakMap,Ps=new WeakMap,Ie=new WeakSet,ta=function(e=!1){if(v(this,Ie,jh).call(this),!a(this,Ps)||this.destroyed)return!1;if(e)return m(this,yi,setTimeout(()=>{m(this,yi,null),v(this,Ie,ta).call(this,!1)},5e3)),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,Ps,!1),!0},jh=function(){a(this,yi)&&(clearTimeout(a(this,yi)),m(this,yi,null))};class im{constructor(){A(this,Ls,new Map);A(this,Sh,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};a(this,Sh).then(()=>{for(const[i]of a(this,Ls))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:n}=s;if(n.aborted){K("LoopbackPort - cannot use an `aborted` signal.");return}const r=()=>this.removeEventListener(e,t);i=()=>n.removeEventListener("abort",r),n.addEventListener("abort",r)}a(this,Ls).set(t,i)}removeEventListener(e,t){var s;(s=a(this,Ls).get(t))==null||s(),a(this,Ls).delete(t)}terminate(){for(const[,e]of a(this,Ls))e==null||e();a(this,Ls).clear()}}Ls=new WeakMap,Sh=new WeakMap;const wt=class wt{constructor({name:e=null,port:t=null,verbosity:s=Qg()}={}){A(this,Ar);var i;if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=a(wt,fn))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(a(wt,fn)||m(wt,fn,new WeakMap)).set(t,this),this._initializeFromPort(t)}else this._initialize()}get promise(){return Ht?Promise.all([si.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new ca("main","worker",e),this._messageHandler.on("ready",function(){}),v(this,Ar,zh).call(this)}_initialize(){if(a(wt,gn)||a(wt,yr,$h)){this._setupFakeWorker();return}let{workerSrc:e}=wt;try{wt._isSameOrigin(window.location.href,e)||(e=wt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new ca("main","worker",t),i=()=>{n.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},n=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:n.signal}),s.on("test",o=>{n.abort(),!this.destroyed&&o?(this._messageHandler=s,this._port=t,this._webWorker=t,v(this,Ar,zh).call(this)):i()}),s.on("ready",o=>{if(n.abort(),this.destroyed)i();else try{r()}catch{this._setupFakeWorker()}});const r=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};r();return}catch{Qo("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){a(wt,gn)||(K("Setting up fake worker."),m(wt,gn,!0)),wt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new im;this._port=t;const s="fake"+re(wt,Eh)._++,i=new ca(s+"_worker",s,t);e.setup(i,t),this._messageHandler=new ca(s,s+"_worker",t),v(this,Ar,zh).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(e=a(wt,fn))==null||e.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){var s;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(s=a(this,fn))==null?void 0:s.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new wt(e)}static get workerSrc(){if(ys.workerSrc)return ys.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return nt(this,"_setupFakeWorkerGlobal",(async()=>a(this,yr,$h)?a(this,yr,$h):(await import(this.workerSrc).then(async e=>(await e.__tla,e))).WorkerMessageHandler)())}};Eh=new WeakMap,gn=new WeakMap,fn=new WeakMap,Ar=new WeakSet,zh=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},yr=new WeakSet,$h=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},A(wt,yr),A(wt,Eh,0),A(wt,gn,!1),A(wt,fn),Ht&&(m(wt,gn,!0),ys.workerSrc||(ys.workerSrc="./pdf.worker.mjs")),wt._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const i=new URL(t,s);return s.origin===i.origin},wt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let Xn=wt;class nm{constructor(e,t,s,i,n){A(this,mn);A(this,Ds,new Map);A(this,hs,new Map);A(this,wr,new Map);A(this,xr,new Map);A(this,ls,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Dd,this.fontLoader=new bf({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return nt(this,"annotationStorage",new El)}getRenderingIntent(e,t=Js.ENABLE,s=null,i=!1,n=!1){let r=hl,o=Sl;switch(e){case"any":r=bg;break;case"display":break;case"print":r=Wo;break;default:K(`getRenderingIntent - invalid intent: ${e}`)}const h=r&Wo&&s instanceof rd?s:this.annotationStorage;switch(t){case Js.DISABLE:r+=wg;break;case Js.ENABLE:break;case Js.ENABLE_FORMS:r+=Ag;break;case Js.ENABLE_STORAGE:r+=yg,o=h.serializable;break;default:K(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(r+=xg),n&&(r+=_g);const{ids:l,hash:c}=h.modifiedIds;return{renderingIntent:r,cacheKey:[r,o.hash,c].join("_"),annotationStorageSerializable:o,modifiedIds:l}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=a(this,ls))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of a(this,hs).values())e.push(i._destroy());a(this,hs).clear(),a(this,wr).clear(),a(this,xr).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i;this.commonObjs.clear(),this.fontLoader.clear(),a(this,Ds).clear(),this.filterFactory.destroy(),da.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Fi("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Pt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=n=>{this._lastProgress={loaded:n.loaded,total:n.total}},i.onPull=()=>{this._fullReader.read().then(function({value:n,done:r}){r?i.close():(Pt(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(n),1,[n]))}).catch(n=>{i.error(n)})},i.onCancel=n=>{this._fullReader.cancel(n),i.ready.catch(r=>{if(!this.destroyed)throw r})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:n,contentLength:r}=this._fullReader;return(!i||!n)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=h=>{var l;(l=t.onProgress)==null||l.call(t,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:i,isRangeSupported:n,contentLength:r}}),e.on("GetRangeReader",(s,i)=>{Pt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(s.begin,s.end);n?(i.onPull=()=>{n.read().then(function({value:r,done:o}){o?i.close():(Pt(r instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r]))}).catch(r=>{i.error(r)})},i.onCancel=r=>{n.cancel(r),i.ready.catch(o=>{if(!this.destroyed)throw o})}):i.close()}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new em(s,this))}),e.on("DocException",function(s){let i;switch(s.name){case"PasswordException":i=new cl(s.message,s.code);break;case"InvalidPDFException":i=new Jc(s.message);break;case"MissingPDFException":i=new Di(s.message);break;case"UnexpectedResponseException":i=new Jo(s.message,s.status);break;case"UnknownErrorException":i=new dl(s.message,s.details);break;default:yt("DocException - expected a valid Error.")}t._capability.reject(i)}),e.on("PasswordRequest",s=>{if(m(this,ls,Promise.withResolvers()),t.onPassword){const i=n=>{n instanceof Error?a(this,ls).reject(n):a(this,ls).resolve({password:n})};try{t.onPassword(i,s.code)}catch(n){a(this,ls).reject(n)}}else a(this,ls).reject(new cl(s.message,s.code));return a(this,ls).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{this.destroyed||a(this,hs).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,n])=>{var r;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":const{disableFontFace:o,fontExtraProperties:h,pdfBug:l}=this._params;if("error"in n){const g=n.error;K(`Error during font loading: ${g}`),this.commonObjs.resolve(s,g);break}const c=l&&((r=globalThis.FontInspector)!=null&&r.enabled)?(g,f)=>globalThis.FontInspector.fontAdded(g,f):null,p=new Af(n,{disableFontFace:o,inspectFont:c});this.fontLoader.bind(p).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!h&&p.data&&(p.data=null),this.commonObjs.resolve(s,p)});break;case"CopyLocalImage":const{imageRef:u}=n;Pt(u,"The imageRef must be defined.");for(const g of a(this,hs).values())for(const[,f]of g.objs)if((f==null?void 0:f.ref)===u)return f.dataLen?(this.commonObjs.resolve(s,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,n);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,n,r])=>{var h;if(this.destroyed)return;const o=a(this,hs).get(i);if(!o.objs.has(s))if(o._intentStates.size!==0)switch(n){case"Image":o.objs.resolve(s,r),(r==null?void 0:r.dataLen)>1e7&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(s,r);break;default:throw new Error(`Got unknown object type ${n}`)}else(h=r==null?void 0:r.bitmap)==null||h.close()}),e.on("DocProgress",s=>{var i;this.destroyed||((i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total}))}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&K("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=a(this,wr).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&a(this,xr).set(n.refStr,e);const r=new sm(t,n,this,this._params.pdfBug);return a(this,hs).set(t,r),r});return a(this,wr).set(t,i),i}getPageIndex(e){return Pd(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return v(this,mn,Bo).call(this,"GetFieldObjects")}hasJSActions(){return v(this,mn,Bo).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return v(this,mn,Bo).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return v(this,mn,Bo).call(this,"GetOptionalContentConfig").then(t=>new Lf(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=a(this,Ds).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var n,r;return{info:i[0],metadata:i[1]?new If(i[1]):null,contentDispositionFilename:((n=this._fullReader)==null?void 0:n.filename)??null,contentLength:((r=this._fullReader)==null?void 0:r.contentLength)??null}});return a(this,Ds).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of a(this,hs).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),a(this,Ds).clear(),this.filterFactory.destroy(!0),da.cleanup()}}cachedPageNumber(e){if(!Pd(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return a(this,xr).get(t)??null}}Ds=new WeakMap,hs=new WeakMap,wr=new WeakMap,xr=new WeakMap,ls=new WeakMap,mn=new WeakSet,Bo=function(e,t=null){const s=a(this,Ds).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return a(this,Ds).set(e,i),i};const hh=Symbol("INITIAL_DATA");class Dd{constructor(){A(this,Qa);A(this,Ue,Object.create(null))}get(e,t=null){if(t){const i=v(this,Qa,wc).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=a(this,Ue)[e];if(!s||s.data===hh)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=a(this,Ue)[e];return!!t&&t.data!==hh}resolve(e,t=null){const s=v(this,Qa,wc).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in a(this,Ue)){const{data:s}=a(this,Ue)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}m(this,Ue,Object.create(null))}*[Symbol.iterator](){for(const e in a(this,Ue)){const{data:t}=a(this,Ue)[e];t!==hh&&(yield[e,t])}}}Ue=new WeakMap,Qa=new WeakSet,wc=function(e){var t;return(t=a(this,Ue))[e]||(t[e]={...Promise.withResolvers(),data:hh})};class rm{constructor(e){A(this,wi,null);m(this,wi,e),this.onContinue=null}get promise(){return a(this,wi).capability.promise}cancel(e=0){a(this,wi).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=a(this,wi).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=a(this,wi);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}wi=new WeakMap;const bn=class bn{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:n,operatorList:r,pageIndex:o,canvasFactory:h,filterFactory:l,useRequestAnimationFrame:c=!1,pdfBug:p=!1,pageColors:u=null}){A(this,xi,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=o,this.canvasFactory=h,this.filterFactory=l,this._pdfBug=p,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=c===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new rm(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,h;if(this.cancelled)return;if(this._canvas){if(a(bn,vn).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");a(bn,vn).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:n,background:r}=this.params;this.gfx=new Wn(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:n,viewport:i,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(h=this.graphicsReadyCallback)==null||h.call(this)}cancel(e=null,t=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),a(this,xi)&&(window.cancelAnimationFrame(a(this,xi)),m(this,xi,null)),a(bn,vn).delete(this._canvas),this.callback(e||new ml(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;this.graphicsReady?((e=this.stepper)==null||e.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,xi,window.requestAnimationFrame(()=>{m(this,xi,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),a(bn,vn).delete(this._canvas),this.callback())))}};xi=new WeakMap,vn=new WeakMap,A(bn,vn,new WeakSet);let Bl=bn;const am="4.8.69",om="3634dab10";V(670);function Fd(d){return Math.floor(255*Math.max(0,Math.min(1,d))).toString(16).padStart(2,"0")}function pa(d){return Math.max(0,Math.min(255,255*d))}class Od{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return[e=pa(e),e,e]}static G_HTML([e]){const t=Fd(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(pa)}static RGB_HTML(e){return`#${e.map(Fd).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[pa(1-Math.min(1,e+i)),pa(1-Math.min(1,s+i)),pa(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,n=1-t,r=1-s;return["CMYK",i,n,r,Math.min(i,n,r)]}}class hm{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){yt("Abstract method `_createSVG` called.")}}class Hl extends hm{_createSVG(e){return document.createElementNS(bs,e)}}class Nd{static setupStorage(e,t,s,i,n){const r=i.getValue(t,{value:null});switch(s.name){case"textarea":if(r.value!==null&&(e.textContent=r.value),n==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(r.value===s.attributes.xfaOn?e.setAttribute("checked",!0):r.value===s.attributes.xfaOff&&e.removeAttribute("checked"),n==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(r.value!==null&&e.setAttribute("value",r.value),n==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(r.value!==null){e.setAttribute("value",r.value);for(const o of s.children)o.attributes.value===r.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const h=o.target.options,l=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(t,{value:l})})}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:n}){const{attributes:r}=t,o=e instanceof HTMLAnchorElement;r.type==="radio"&&(r.name=`${r.name}-${i}`);for(const[h,l]of Object.entries(r))if(l!=null)switch(h){case"class":l.length&&e.setAttribute(h,l.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",l);break;case"style":Object.assign(e.style,l);break;case"textContent":e.textContent=l;break;default:(!o||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,l)}o&&n.addLinkAttributes(e,r.href,r.newWindow),s&&r.dataId&&this.setupStorage(e,r.dataId,t,s)}static render(e){var p,u;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,n=e.intent||"display",r=document.createElement(i.name);i.attributes&&this.setAttributes({html:r,element:i,intent:n,linkService:s});const o=n!=="richText",h=e.div;if(h.append(r),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=g}o&&h.setAttribute("class","xfaLayer xfaFont");const l=[];if(i.children.length===0){if(i.value){const g=document.createTextNode(i.value);r.append(g),o&&ua.shouldBuildText(i.name)&&l.push(g)}return{textDivs:l}}const c=[[i,-1,r]];for(;c.length>0;){const[g,f,b]=c.at(-1);if(f+1===g.children.length){c.pop();continue}const w=g.children[++c.at(-1)[1]];if(w===null)continue;const{name:y}=w;if(y==="#text"){const _=document.createTextNode(w.value);l.push(_),b.append(_);continue}const x=(p=w==null?void 0:w.attributes)!=null&&p.xmlns?document.createElementNS(w.attributes.xmlns,y):document.createElement(y);if(b.append(x),w.attributes&&this.setAttributes({html:x,element:w,storage:t,intent:n,linkService:s}),((u=w.children)==null?void 0:u.length)>0)c.push([w,-1,x]);else if(w.value){const _=document.createTextNode(w.value);o&&ua.shouldBuildText(y)&&l.push(_),x.append(_)}}for(const g of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:l}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const ga=1e3,Hi=new WeakSet;function ws(d){return{width:d[2]-d[0],height:d[3]-d[1]}}class lm{static create(e){switch(e.data.annotationType){case kg:return new Bd(e);case Tg:return new cm(e);case Ug:switch(e.data.fieldType){case"Tx":return new dm(e);case"Btn":return e.data.radioButton?new Hd(e):e.data.checkBox?new pm(e):new gm(e);case"Ch":return new fm(e);case"Sig":return new um(e)}return new ji(e);case Qc:return new jl(e);case Mg:return new jd(e);case Rg:return new vm(e);case Ig:return new bm(e);case Pg:return new Am(e);case Dg:return new zd(e);case jg:return new wm(e);case zg:return new zl(e);case Lg:return new ym(e);case Fg:return new $d(e);case Og:return new xm(e);case Ng:return new _m(e);case Bg:return new Sm(e);case Hg:return new Ud(e);case $g:return new Em(e);default:return new Tt(e)}}}const Kl=class Kl{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){A(this,Ja);A(this,An,null);A(this,_r,!1);A(this,Sr,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Kl._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;a(this,An)||m(this,An,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&v(this,Ja,xc).call(this,t),(s=a(this,Sr))==null||s.popup.updateEdited(e)}resetEdited(){var e;a(this,An)&&(v(this,Ja,xc).call(this,a(this,An).rect),(e=a(this,Sr))==null||e.popup.resetEdited(),m(this,An,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,n=document.createElement("section");n.setAttribute("data-annotation-id",t.id),this instanceof ji||(n.tabIndex=ga);const{style:r}=n;if(r.zIndex=this.parent.zIndex++,t.alternativeText&&(n.title=t.alternativeText),t.noRotate&&n.classList.add("norotate"),!t.rect||this instanceof jl){const{rotation:b}=t;return t.hasOwnCanvas||b===0||this.setRotation(b,n),n}const{width:o,height:h}=ws(t.rect);if(!e&&t.borderStyle.width>0){r.borderWidth=`${t.borderStyle.width}px`;const b=t.borderStyle.horizontalCornerRadius,w=t.borderStyle.verticalCornerRadius;if(b>0||w>0){const x=`calc(${b}px * var(--scale-factor)) / calc(${w}px * var(--scale-factor))`;r.borderRadius=x}else if(this instanceof Hd){const x=`calc(${o}px * var(--scale-factor)) / calc(${h}px * var(--scale-factor))`;r.borderRadius=x}switch(t.borderStyle.style){case Gg:r.borderStyle="solid";break;case Vg:r.borderStyle="dashed";break;case Wg:K("Unimplemented border style: beveled");break;case qg:K("Unimplemented border style: inset");break;case Xg:r.borderBottomStyle="solid"}const y=t.borderColor||null;y?(m(this,_r,!0),r.borderColor=z.makeHexColor(0|y[0],0|y[1],0|y[2])):r.borderWidth=0}const l=z.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:c,pageHeight:p,pageX:u,pageY:g}=i.rawDims;r.left=100*(l[0]-u)/c+"%",r.top=100*(l[1]-g)/p+"%";const{rotation:f}=t;return t.hasOwnCanvas||f===0?(r.width=100*o/c+"%",r.height=100*h/p+"%"):this.setRotation(f,n),n}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims,{width:n,height:r}=ws(this.data.rect);let o,h;e%180==0?(o=100*n/s,h=100*r/i):(o=100*r/s,h=100*n/i),t.style.width=`${o}%`,t.style.height=`${h}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const n=i.detail[t],r=n[0],o=n.slice(1);i.target.style[s]=Od[`${r}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:Od[`${r}_rgb`](o)})};return nt(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2==1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){var i;const s=this._commonActions;for(const n of Object.keys(t.detail))(i=e[n]||s[n])==null||i(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,n]of Object.entries(t)){const r=s[i];r&&(r({detail:{[i]:n},target:e}),delete t[i])}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,n]=this.data.rect.map(b=>Math.fround(b));if(e.length===8){const[b,w,y,x]=e.subarray(2,6);if(i===b&&n===w&&t===y&&s===x)return}const{style:r}=this.container;let o;if(a(this,_r)){const{borderColor:b,borderWidth:w}=r;r.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const h=i-t,l=n-s,{svgFactory:c}=this,p=c.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0);const u=c.createElement("defs");p.append(u);const g=c.createElement("clipPath"),f=`clippath_${this.data.id}`;g.setAttribute("id",f),g.setAttribute("clipPathUnits","objectBoundingBox"),u.append(g);for(let b=2,w=e.length;b<w;b+=8){const y=e[b],x=e[b+1],_=e[b+2],E=e[b+3],C=c.createElement("rect"),S=(_-t)/h,T=(n-x)/l,M=(y-_)/h,R=(x-E)/l;C.setAttribute("x",S),C.setAttribute("y",T),C.setAttribute("width",M),C.setAttribute("height",R),g.append(C),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${S}" y="${T}" width="${M}" height="${R}"/>`)}a(this,_r)&&(o.push("</g></svg>')"),r.backgroundImage=o.join("")),this.container.append(p),this.container.style.clipPath=`url(#${f})`}_createPopup(){const{data:e}=this,t=m(this,Sr,new jl({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){yt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:n,id:r,exportValues:o}of i){if(n===-1||r===t)continue;const h=typeof o=="string"?o:null,l=document.querySelector(`[data-element-id="${r}"]`);!l||Hi.has(l)?s.push({id:r,exportValue:h,domElement:l}):K(`_getElementsByName - element not allowed: ${r}`)}return s}for(const i of document.getElementsByName(e)){const{exportValue:n}=i,r=i.getAttribute("data-element-id");r!==t&&Hi.has(i)&&s.push({id:r,exportValue:n,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};An=new WeakMap,_r=new WeakMap,Sr=new WeakMap,Ja=new WeakSet,xc=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:n,pageHeight:r,pageX:o,pageY:h}}}}=this;s==null||s.splice(0,4,...e);const{width:l,height:c}=ws(e);t.left=100*(e[0]-o)/n+"%",t.top=100*(r-e[3]+h)/r+"%",i===0?(t.width=100*l/n+"%",t.height=100*c/r+"%"):this.setRotation(i)};let Tt=Kl;class Bd extends Tt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});A(this,Ae);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let n=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),n=!0):t.action?(this._bindNamedAction(i,t.action),n=!0):t.attachment?(v(this,Ae,xp).call(this,i,t.attachment,t.attachmentDest),n=!0):t.setOCGState?(v(this,Ae,_p).call(this,i,t.setOCGState),n=!0):t.dest?(this._bindLink(i,t.dest),n=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),n=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(i,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&v(this,Ae,$n).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),v(this,Ae,$n).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(s.actions)){const r=i.get(n);r&&(t[r]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:n}}),!1})}t.onclick||(t.onclick=()=>!1),v(this,Ae,$n).call(this)}_bindResetFormAction(t,s){const i=t.onclick;i||(t.href=this.linkService.getAnchorUrl("")),v(this,Ae,$n).call(this),this._fieldObjects?t.onclick=()=>{var p;i==null||i();const{fields:n,refs:r,include:o}=s,h=[];if(n.length!==0||r.length!==0){const u=new Set(r);for(const g of n){const f=this._fieldObjects[g]||[];for(const{id:b}of f)u.add(b)}for(const g of Object.values(this._fieldObjects))for(const f of g)u.has(f.id)===o&&h.push(f)}else for(const u of Object.values(this._fieldObjects))h.push(...u);const l=this.annotationStorage,c=[];for(const u of h){const{id:g}=u;switch(c.push(g),u.type){case"text":{const b=u.defaultValue||"";l.setValue(g,{value:b});break}case"checkbox":case"radiobutton":{const b=u.defaultValue===u.exportValues;l.setValue(g,{value:b});break}case"combobox":case"listbox":{const b=u.defaultValue||"";l.setValue(g,{value:b});break}default:continue}const f=document.querySelector(`[data-element-id="${g}"]`);f&&(Hi.has(f)?f.dispatchEvent(new Event("resetform")):K(`_bindResetFormAction - element not allowed: ${g}`))}return this.enableScripting&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}})),!1}:(K('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1))}}Ae=new WeakSet,$n=function(){this.container.setAttribute("data-internal-link","")},xp=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var n;return(n=this.downloadManager)==null||n.openOrDownloadData(s.content,s.filename,i),!1},v(this,Ae,$n).call(this)},_p=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),v(this,Ae,$n).call(this)};class cm extends Tt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class ji extends Tt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return ee.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,n){s.includes("mouse")?e.addEventListener(s,r=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:n(r),shift:r.shiftKey,modifier:this._getKeyModifier(r)}})}):e.addEventListener(s,r=>{var o;if(s==="blur"){if(!t.focused||!r.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}n&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:n(r)}}))})}_setEventListeners(e,t,s,i){var n,r,o;for(const[h,l]of s)(l==="Action"||(n=this.data.actions)!=null&&n[l])&&(l!=="Focus"&&l!=="Blur"||t||(t={focused:!1}),this._setEventListener(e,t,h,l,i),l!=="Focus"||(r=this.data.actions)!=null&&r.Blur?l!=="Blur"||(o=this.data.actions)!=null&&o.Focus||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":z.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||9,n=e.style;let r;const o=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-2),l=h/(Math.round(h/(ol*i))||1);r=Math.min(i,o(l/ol))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-2);r=Math.min(i,o(h/ol))}n.fontSize=`calc(${r}px * var(--scale-factor))`,n.color=z.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(n.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class dm extends ji{constructor(e){super(e,{isRenderable:e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,s,i){const n=this.annotationStorage;for(const r of this._getElementsByName(e.name,e.id))r.domElement&&(r.domElement[t]=s),n.setValue(r.id,{[i]:s})}render(){var i,n;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let o=r.value||"";const h=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;h&&o.length>h&&(o=o.slice(0,h));let l=r.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const c={userValue:o,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=l??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",l??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Hi.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=ga,this._setRequired(s,this.data.required),h&&(s.maxLength=h),s.addEventListener("input",u=>{e.setValue(t,{value:u.target.value}),this.setPropertyOnSiblings(s,"value",u.target.value,"value"),c.formattedValue=null}),s.addEventListener("resetform",u=>{const g=this.data.defaultFieldValue??"";s.value=c.userValue=g,c.formattedValue=null});let p=u=>{const{formattedValue:g}=c;g!=null&&(u.target.value=g),u.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",g=>{var b;if(c.focused)return;const{target:f}=g;c.userValue&&(f.value=c.userValue),c.lastCommittedValue=f.value,c.commitKey=1,(b=this.data.actions)!=null&&b.Focus||(c.focused=!0)}),s.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const f={value(b){c.userValue=b.detail.value??"",e.setValue(t,{value:c.userValue.toString()}),b.target.value=c.userValue},formattedValue(b){const{formattedValue:w}=b.detail;c.formattedValue=w,w!=null&&b.target!==document.activeElement&&(b.target.value=w),e.setValue(t,{formattedValue:w})},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var _;const{charLimit:w}=b.detail,{target:y}=b;if(w===0){y.removeAttribute("maxLength");return}y.setAttribute("maxLength",w);let x=c.userValue;x&&!(x.length<=w)&&(x=x.slice(0,w),y.value=c.userValue=x,e.setValue(t,{value:x}),(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:1,selStart:y.selectionStart,selEnd:y.selectionEnd}}))}};this._dispatchEventFromSandbox(f,g)}),s.addEventListener("keydown",g=>{var w;c.commitKey=1;let f=-1;if(g.key==="Escape"?f=0:g.key!=="Enter"||this.data.multiLine?g.key==="Tab"&&(c.commitKey=3):f=2,f===-1)return;const{value:b}=g.target;c.lastCommittedValue!==b&&(c.lastCommittedValue=b,c.userValue=b,(w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:f,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const u=p;p=null,s.addEventListener("blur",g=>{var b,w;if(!c.focused||!g.relatedTarget)return;(b=this.data.actions)!=null&&b.Blur||(c.focused=!1);const{value:f}=g.target;c.userValue=f,c.lastCommittedValue!==f&&((w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:c.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),u(g)}),(n=this.data.actions)!=null&&n.Keystroke&&s.addEventListener("beforeinput",g=>{var C;c.lastCommittedValue=null;const{data:f,target:b}=g,{value:w,selectionStart:y,selectionEnd:x}=b;let _=y,E=x;switch(g.inputType){case"deleteWordBackward":{const S=w.substring(0,y).match(/\w*[^\w]*$/);S&&(_-=S[0].length);break}case"deleteWordForward":{const S=w.substring(y).match(/^[^\w]*\w*/);S&&(E+=S[0].length);break}case"deleteContentBackward":y===x&&(_-=1);break;case"deleteContentForward":y===x&&(E+=1)}g.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,change:f||"",willCommit:!1,selStart:_,selEnd:E}})}),this._setEventListeners(s,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(p&&s.addEventListener("blur",p),this.data.comb){const u=(this.data.rect[2]-this.data.rect[0])/h;s.classList.add("comb"),s.style.letterSpacing=`calc(${u}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class um extends ji{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class pm extends ji{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const n=document.createElement("input");return Hi.add(n),n.setAttribute("data-element-id",s),n.disabled=t.readOnly,this._setRequired(n,this.data.required),n.type="checkbox",n.name=t.fieldName,i&&n.setAttribute("checked",!0),n.setAttribute("exportValue",t.exportValue),n.tabIndex=ga,n.addEventListener("change",r=>{const{name:o,checked:h}=r.target;for(const l of this._getElementsByName(o,s)){const c=h&&l.exportValue===t.exportValue;l.domElement&&(l.domElement.checked=c),e.setValue(l.id,{value:c})}e.setValue(s,{value:h})}),n.addEventListener("resetform",r=>{const o=t.defaultFieldValue||"Off";r.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(n.addEventListener("updatefromsandbox",r=>{const o={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(o,r)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],r=>r.target.checked)),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Hd extends ji{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const r of this._getElementsByName(t.fieldName,s))e.setValue(r.id,{value:!1});const n=document.createElement("input");if(Hi.add(n),n.setAttribute("data-element-id",s),n.disabled=t.readOnly,this._setRequired(n,this.data.required),n.type="radio",n.name=t.fieldName,i&&n.setAttribute("checked",!0),n.tabIndex=ga,n.addEventListener("change",r=>{const{name:o,checked:h}=r.target;for(const l of this._getElementsByName(o,s))e.setValue(l.id,{value:!1});e.setValue(s,{value:h})}),n.addEventListener("resetform",r=>{const o=t.defaultFieldValue;r.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const r=t.buttonValue;n.addEventListener("updatefromsandbox",o=>{const h={value:l=>{const c=r===l.detail.value;for(const p of this._getElementsByName(l.target.name)){const u=c&&p.id===s;p.domElement&&(p.domElement.checked=u),e.setValue(p.id,{value:u})}}};this._dispatchEventFromSandbox(h,o)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class gm extends Bd{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class fm extends ji{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Hi.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=ga;let n=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",c=>{const p=this.data.defaultFieldValue;for(const u of i.options)u.selected=u.value===p});for(const c of this.data.options){const p=document.createElement("option");p.textContent=c.displayValue,p.value=c.exportValue,s.value.includes(c.exportValue)&&(p.setAttribute("selected",!0),n=!1),i.append(p)}let r=null;if(n){const c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),i.prepend(c),r=()=>{c.remove(),i.removeEventListener("input",r),r=null},i.addEventListener("input",r)}const o=c=>{const p=c?"value":"textContent",{options:u,multiple:g}=i;return g?Array.prototype.filter.call(u,f=>f.selected).map(f=>f[p]):u.selectedIndex===-1?null:u[u.selectedIndex][p]};let h=o(!1);const l=c=>{const p=c.target.options;return Array.prototype.map.call(p,u=>({displayValue:u.textContent,exportValue:u.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",c=>{const p={value(u){r==null||r();const g=u.detail.value,f=new Set(Array.isArray(g)?g:[g]);for(const b of i.options)b.selected=f.has(b.value);e.setValue(t,{value:o(!0)}),h=o(!1)},multipleSelection(u){i.multiple=!0},remove(u){const g=i.options,f=u.detail.remove;g[f].selected=!1,i.remove(f),g.length>0&&Array.prototype.findIndex.call(g,b=>b.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:o(!0),items:l(u)}),h=o(!1)},clear(u){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),h=o(!1)},insert(u){const{index:g,displayValue:f,exportValue:b}=u.detail.insert,w=i.children[g],y=document.createElement("option");y.textContent=f,y.value=b,w?w.before(y):i.append(y),e.setValue(t,{value:o(!0),items:l(u)}),h=o(!1)},items(u){const{items:g}=u.detail;for(;i.length!==0;)i.remove(0);for(const f of g){const{displayValue:b,exportValue:w}=f,y=document.createElement("option");y.textContent=b,y.value=w,i.append(y)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:l(u)}),h=o(!1)},indices(u){const g=new Set(u.detail.indices);for(const f of u.target.options)f.selected=g.has(f.index);e.setValue(t,{value:o(!0)}),h=o(!1)},editable(u){u.target.disabled=!u.detail.editable}};this._dispatchEventFromSandbox(p,c)}),i.addEventListener("input",c=>{var g;const p=o(!0),u=o(!1);e.setValue(t,{value:p}),c.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:u,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):i.addEventListener("input",function(c){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class jl extends Tt{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Tt._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new mm({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${fl}${s}`).join(",")),this.container}}class mm{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:n,contentsObj:r,richText:o,parent:h,rect:l,parentRect:c,open:p}){A(this,gt);A(this,Er,v(this,gt,Cp).bind(this));A(this,Ch,v(this,gt,Sc).bind(this));A(this,Th,v(this,gt,Vh).bind(this));A(this,Cr,v(this,gt,Gh).bind(this));A(this,yn,null);A(this,Ct,null);A(this,Fs,null);A(this,Tr,null);A(this,Za,null);A(this,to,null);A(this,kr,null);A(this,Os,!1);A(this,Ge,null);A(this,Ns,null);A(this,eo,null);A(this,Bs,null);A(this,so,null);A(this,wn,null);A(this,xn,!1);var u;m(this,Ct,e),m(this,so,i),m(this,Fs,r),m(this,Bs,o),m(this,to,h),m(this,yn,t),m(this,eo,l),m(this,kr,c),m(this,Za,s),m(this,Tr,bl.toDateObject(n)),this.trigger=s.flatMap(g=>g.getElementsToTriggerPopup());for(const g of this.trigger)g.addEventListener("click",a(this,Cr)),g.addEventListener("mouseenter",a(this,Th)),g.addEventListener("mouseleave",a(this,Ch)),g.classList.add("popupTriggerArea");for(const g of s)(u=g.container)==null||u.addEventListener("keydown",a(this,Er));a(this,Ct).hidden=!0,p&&v(this,gt,Gh).call(this)}render(){if(a(this,Ge))return;const e=m(this,Ge,document.createElement("div"));if(e.className="popup",a(this,yn)){const n=e.style.outlineColor=z.makeHexColor(...a(this,yn));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`:e.style.backgroundColor=z.makeHexColor(...a(this,yn).map(r=>Math.floor(.7*(255-r)+r)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=a(this,so),e.append(t),a(this,Tr)){const n=document.createElement("span");n.classList.add("popupDate"),n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:a(this,Tr).valueOf()})),t.append(n)}const i=a(this,gt,Uh);if(i)Nd.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const n=this._formatContents(a(this,Fs));e.append(n)}a(this,Ct).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let n=0,r=i.length;n<r;++n){const o=i[n];s.append(document.createTextNode(o)),n<r-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;a(this,wn)||m(this,wn,{contentsObj:a(this,Fs),richText:a(this,Bs)}),e&&m(this,Ns,null),t&&(m(this,Bs,v(this,gt,Ep).call(this,t)),m(this,Fs,null)),(s=a(this,Ge))==null||s.remove(),m(this,Ge,null)}resetEdited(){var e;a(this,wn)&&({contentsObj:re(this,Fs)._,richText:re(this,Bs)._}=a(this,wn),m(this,wn,null),(e=a(this,Ge))==null||e.remove(),m(this,Ge,null),m(this,Ns,null))}forceHide(){m(this,xn,this.isVisible),a(this,xn)&&(a(this,Ct).hidden=!0)}maybeShow(){a(this,xn)&&(a(this,Ge)||v(this,gt,Vh).call(this),m(this,xn,!1),a(this,Ct).hidden=!1)}get isVisible(){return a(this,Ct).hidden===!1}}Er=new WeakMap,Ch=new WeakMap,Th=new WeakMap,Cr=new WeakMap,yn=new WeakMap,Ct=new WeakMap,Fs=new WeakMap,Tr=new WeakMap,Za=new WeakMap,to=new WeakMap,kr=new WeakMap,Os=new WeakMap,Ge=new WeakMap,Ns=new WeakMap,eo=new WeakMap,Bs=new WeakMap,so=new WeakMap,wn=new WeakMap,xn=new WeakMap,gt=new WeakSet,Uh=function(){const e=a(this,Bs),t=a(this,Fs);return!(e!=null&&e.str)||t!=null&&t.str&&t.str!==e.str?null:a(this,Bs).html||null},_c=function(){var e,t,s;return((s=(t=(e=a(this,gt,Uh))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},Sp=function(){var e,t,s;return((s=(t=(e=a(this,gt,Uh))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},Ep=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:a(this,gt,Sp),fontSize:a(this,gt,_c)?`calc(${a(this,gt,_c)}px * var(--scale-factor))`:""}};for(const n of e.split(`
`))t.push({name:"span",value:n,attributes:i});return s},Cp=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&a(this,Os))&&v(this,gt,Gh).call(this)},Tp=function(){if(a(this,Ns)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:n}}}=a(this,to);let r=!!a(this,kr),o=r?a(this,kr):a(this,eo);for(const g of a(this,Za))if(!o||z.intersect(g.data.rect,o)!==null){o=g.data.rect,r=!0;break}const h=z.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),l=r?o[2]-o[0]+5:0,c=h[0]+l,p=h[1];m(this,Ns,[100*(c-i)/t,100*(p-n)/s]);const{style:u}=a(this,Ct);u.left=`${a(this,Ns)[0]}%`,u.top=`${a(this,Ns)[1]}%`},Gh=function(){m(this,Os,!a(this,Os)),a(this,Os)?(v(this,gt,Vh).call(this),a(this,Ct).addEventListener("click",a(this,Cr)),a(this,Ct).addEventListener("keydown",a(this,Er))):(v(this,gt,Sc).call(this),a(this,Ct).removeEventListener("click",a(this,Cr)),a(this,Ct).removeEventListener("keydown",a(this,Er)))},Vh=function(){a(this,Ge)||this.render(),this.isVisible?a(this,Os)&&a(this,Ct).classList.add("focused"):(v(this,gt,Tp).call(this),a(this,Ct).hidden=!1,a(this,Ct).style.zIndex=parseInt(a(this,Ct).style.zIndex)+1e3)},Sc=function(){a(this,Ct).classList.remove("focused"),!a(this,Os)&&this.isVisible&&(a(this,Ct).hidden=!0,a(this,Ct).style.zIndex=parseInt(a(this,Ct).style.zIndex)-1e3)};class jd extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=J.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class vm extends Tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,io,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:i}=ws(t.rect),n=this.svgFactory.create(s,i,!0),r=m(this,io,this.svgFactory.createElement("svg:line"));return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,io)}addHighlightArea(){this.container.classList.add("highlightArea")}}io=new WeakMap;class bm extends Tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,no,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:i}=ws(t.rect),n=this.svgFactory.create(s,i,!0),r=t.borderStyle.width,o=m(this,no,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",r/2),o.setAttribute("y",r/2),o.setAttribute("width",s-r),o.setAttribute("height",i-r),o.setAttribute("stroke-width",r||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,no)}addHighlightArea(){this.container.classList.add("highlightArea")}}no=new WeakMap;class Am extends Tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,ro,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:i}=ws(t.rect),n=this.svgFactory.create(s,i,!0),r=t.borderStyle.width,o=m(this,ro,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",i/2),o.setAttribute("rx",s/2-r/2),o.setAttribute("ry",i/2-r/2),o.setAttribute("stroke-width",r||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,ro)}addHighlightArea(){this.container.classList.add("highlightArea")}}ro=new WeakMap;class zd extends Tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,ao,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:n}}=this;if(!s)return this.container;const{width:r,height:o}=ws(t),h=this.svgFactory.create(r,o,!0);let l=[];for(let p=0,u=s.length;p<u;p+=2){const g=s[p]-t[0],f=t[3]-s[p+1];l.push(`${g},${f}`)}l=l.join(" ");const c=m(this,ao,this.svgFactory.createElement(this.svgElementName));return c.setAttribute("points",l),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),h.append(c),this.container.append(h),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,ao)}addHighlightArea(){this.container.classList.add("highlightArea")}}ao=new WeakMap;class ym extends zd{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class wm extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class zl extends Tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,oo,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?J.HIGHLIGHT:J.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,inkLists:s,borderStyle:i,popupRef:n}}=this,{width:r,height:o}=ws(t),h=this.svgFactory.create(r,o,!0);for(const l of s){let c=[];for(let u=0,g=l.length;u<g;u+=2){const f=l[u]-t[0],b=t[3]-l[u+1];c.push(`${f},${b}`)}c=c.join(" ");const p=this.svgFactory.createElement(this.svgElementName);a(this,oo).push(p),p.setAttribute("points",c),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),h.append(p)}return!n&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return a(this,oo)}addHighlightArea(){this.container.classList.add("highlightArea")}}oo=new WeakMap;class $d extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=J.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class xm extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class _m extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Sm extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Ud extends Tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=J.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Em extends Tt{constructor(t){var i;super(t,{isRenderable:!0});A(this,lo);A(this,ho,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(100*s.fillAlpha)}%);`)),i.addEventListener("dblclick",v(this,lo,Ec).bind(this)),m(this,ho,i);const{isMac:n}=ee.platform;return t.addEventListener("keydown",r=>{r.key==="Enter"&&(n?r.metaKey:r.ctrlKey)&&v(this,lo,Ec).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return a(this,ho)}addHighlightArea(){this.container.classList.add("highlightArea")}}ho=new WeakMap,lo=new WeakSet,Ec=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};class Cm{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:n,viewport:r,structTreeLayer:o}){A(this,En);A(this,co,null);A(this,_n,null);A(this,Sn,new Map);A(this,uo,null);this.div=e,m(this,co,t),m(this,_n,s),m(this,uo,o||null),this.page=n,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return a(this,Sn).size>0}async render(e){var r;const{annotations:t}=e,s=this.div;Oi(s,this.viewport);const i=new Map,n={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Hl,annotationStorage:e.annotationStorage||new El,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const h=o.annotationType===Qc;if(h){const p=i.get(o.id);if(!p)continue;n.elements=p}else{const{width:p,height:u}=ws(o.rect);if(p<=0||u<=0)continue}n.data=o;const l=lm.create(n);if(!l.isRenderable)continue;if(!h&&o.popupRef){const p=i.get(o.popupRef);p?p.push(l):i.set(o.popupRef,[l])}const c=l.render();o.hidden&&(c.style.visibility="hidden"),await v(this,En,kp).call(this,c,o.id),l._isEditable&&(a(this,Sn).set(l.data.id,l),(r=this._annotationEditorUIManager)==null||r.renderAnnotationElement(l))}v(this,En,Cc).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Oi(t,{rotation:e.rotation}),v(this,En,Cc).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(a(this,Sn).values())}getEditableAnnotation(e){return a(this,Sn).get(e)}}co=new WeakMap,_n=new WeakMap,Sn=new WeakMap,uo=new WeakMap,En=new WeakSet,kp=async function(e,t){var r,o;const s=e.firstChild||e,i=s.id=`${fl}${t}`,n=await((r=a(this,uo))==null?void 0:r.getAriaAttributes(i));if(n)for(const[h,l]of n)s.setAttribute(h,l);this.div.append(e),(o=a(this,co))==null||o.moveElementInDOM(this.div,e,s,!1)},Cc=function(){if(!a(this,_n))return;const e=this.div;for(const[t,s]of a(this,_n)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:n}=i;n?n.nodeName==="CANVAS"?n.replaceWith(s):n.classList.contains("annotationContent")?n.after(s):n.before(s):i.append(s)}a(this,_n).clear()};const lh=/\r\n?|\n/g,At=class At extends lt{constructor(t){super({...t,name:"freeTextEditor"});A(this,Rt);A(this,Ve);A(this,ye,"");A(this,po,`${this.id}-editor`);A(this,Cn,null);A(this,we);m(this,Ve,t.color||At._defaultColor||lt._defaultLineColor),m(this,we,t.fontSize||At._defaultFontSize)}static get _keyboardManager(){const t=At.prototype,s=r=>r.isEmpty(),i=Ni.TRANSLATE_SMALL,n=Ni.TRANSLATE_BIG;return nt(this,"_keyboardManager",new aa([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[n,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,n],checker:s}]]))}static initialize(t,s){lt.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case X.FREETEXT_SIZE:At._defaultFontSize=s;break;case X.FREETEXT_COLOR:At._defaultColor=s}}updateParams(t,s){switch(t){case X.FREETEXT_SIZE:v(this,Rt,Mp).call(this,s);break;case X.FREETEXT_COLOR:v(this,Rt,Rp).call(this,s)}}static get defaultPropertiesToUpdate(){return[[X.FREETEXT_SIZE,At._defaultFontSize],[X.FREETEXT_COLOR,At._defaultColor||lt._defaultLineColor]]}get propertiesToUpdate(){return[[X.FREETEXT_SIZE,a(this,we)],[X.FREETEXT_COLOR,a(this,Ve)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-At._internalPadding*t,-(At._internalPadding+a(this,we))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(J.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,Cn,new AbortController);const t=this._uiManager.combinedSignal(a(this,Cn));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",a(this,po)),this._isDraggable=!0,(t=a(this,Cn))==null||t.abort(),m(this,Cn,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var t;this.width||(this.enableEditMode(),this.editorDiv.focus(),(t=this._initialOptions)!=null&&t.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=a(this,ye),s=m(this,ye,v(this,Rt,Ip).call(this).trimEnd());if(t===s)return;const i=n=>{m(this,ye,n),n?(v(this,Rt,Xh).call(this),this._uiManager.rebuild(this),v(this,Rt,Wh).call(this)):this.remove()};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),v(this,Rt,Wh).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){At._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",a(this,po)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${a(this,we)}px * var(--scale-factor))`,i.color=a(this,Ve),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),sh(this,this.div,["dblclick","keydown"]),this.width){const[n,r]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[h,l]=this.getInitialTranslation();[h,l]=this.pageTranslationToScreen(h,l);const[c,p]=this.pageDimensions,[u,g]=this.pageTranslation;let f,b;switch(this.rotation){case 0:f=t+(o[0]-u)/c,b=s+this.height-(o[1]-g)/p;break;case 90:f=t+(o[0]-u)/c,b=s-(o[1]-g)/p,[h,l]=[l,-h];break;case 180:f=t-this.width+(o[0]-u)/c,b=s-(o[1]-g)/p,[h,l]=[-h,-l];break;case 270:f=t+(o[0]-u-this.height*p)/c,b=s+(o[1]-g-this.width*c)/p,[h,l]=[-l,h]}this.setAt(f*n,b*r,h,l)}else this.setAt(t*n,s*r,this.width*n,this.height*r);v(this,Rt,Xh).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var f,b,w;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const n=v(f=At,Hs,Tc).call(f,s.getData("text")||"").replaceAll(lh,`
`);if(!n)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const o=r.getRangeAt(0);if(!n.includes(`
`)){o.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:h,startOffset:l}=o,c=[],p=[];if(h.nodeType===Node.TEXT_NODE){const y=h.parentElement;if(p.push(h.nodeValue.slice(l).replaceAll(lh,"")),y!==this.editorDiv){let x=c;for(const _ of this.editorDiv.childNodes)_!==y?x.push(v(b=At,Hs,qh).call(b,_)):x=p}c.push(h.nodeValue.slice(0,l).replaceAll(lh,""))}else if(h===this.editorDiv){let y=c,x=0;for(const _ of this.editorDiv.childNodes)x++===l&&(y=p),y.push(v(w=At,Hs,qh).call(w,_))}m(this,ye,`${c.join(`
`)}${n}${p.join(`
`)}`),v(this,Rt,Xh).call(this);const u=new Range;let g=c.reduce((y,x)=>y+x.length,0);for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const x=y.nodeValue.length;if(g<=x){u.setStart(y,g),u.setEnd(y,g);break}g-=x}r.removeAllRanges(),r.addRange(u)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var o;let n=null;if(t instanceof jd){const{data:{defaultAppearanceData:{fontSize:h,fontColor:l},rect:c,rotation:p,id:u,popupRef:g},textContent:f,textPosition:b,parent:{page:{pageNumber:w}}}=t;if(!f||f.length===0)return null;n=t={annotationType:J.FREETEXT,color:Array.from(l),fontSize:h,value:f.join(`
`),position:b,pageIndex:w-1,rect:c.slice(0),rotation:p,id:u,deleted:!1,popupRef:g}}const r=await super.deserialize(t,s,i);return m(r,we,t.fontSize),m(r,Ve,z.makeHexColor(...t.color)),m(r,ye,v(o=At,Hs,Tc).call(o,t.value)),r.annotationElementId=t.id||null,r._initialData=n,r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=At._internalPadding*this.parentScale,i=this.getRect(s,s),n=lt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:a(this,Ve)),r={annotationType:J.FREETEXT,color:n,fontSize:a(this,we),value:v(this,Rt,Pp).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?r:this.annotationElementId&&!v(this,Rt,Lp).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${a(this,we)}px * var(--scale-factor))`,i.color=a(this,Ve),s.replaceChildren();for(const r of a(this,ye).split(`
`)){const o=document.createElement("div");o.append(r?document.createTextNode(r):document.createElement("br")),s.append(o)}const n=At._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(n,n),popupContent:a(this,ye)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Ve=new WeakMap,ye=new WeakMap,po=new WeakMap,Cn=new WeakMap,we=new WeakMap,Rt=new WeakSet,Mp=function(t){const s=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--scale-factor))`,this.translate(0,-(n-a(this,we))*this.parentScale),m(this,we,n),v(this,Rt,Wh).call(this)},i=a(this,we);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:X.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Rp=function(t){const s=n=>{m(this,Ve,this.editorDiv.style.color=n)},i=a(this,Ve);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:X.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ip=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const n of this.editorDiv.childNodes)((s==null?void 0:s.nodeType)!==Node.TEXT_NODE||n.nodeName!=="BR")&&(t.push(v(i=At,Hs,qh).call(i,n)),s=n);return t.join(`
`)},Wh=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:n,div:r}=this,o=r.style.display,h=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",n.div.append(this.div),i=r.getBoundingClientRect(),r.remove(),r.style.display=o,r.classList.toggle("hidden",h)}this.rotation%180==this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},Hs=new WeakSet,qh=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(lh,"")},Xh=function(){if(this.editorDiv.replaceChildren(),a(this,ye))for(const t of a(this,ye).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},Pp=function(){return a(this,ye).replaceAll("\xA0"," ")},Tc=function(t){return t.replaceAll(" ","\xA0")},Lp=function(t){const{value:s,fontSize:i,color:n,pageIndex:r}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((o,h)=>o!==n[h])||t.pageIndex!==r},A(At,Hs),Y(At,"_freeTextDefaultContent",""),Y(At,"_internalPadding",0),Y(At,"_defaultColor",null),Y(At,"_defaultFontSize",10),Y(At,"_type","freetext"),Y(At,"_editorType",J.FREETEXT);let $l=At;class Gd{toSVGPath(){yt("Abstract method `toSVGPath` must be implemented.")}get box(){yt("Abstract getter `box` must be implemented.")}serialize(e,t){yt("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){yt("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){yt("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}}const js=class js{constructor({x:e,y:t},s,i,n,r,o=0){A(this,Ft);A(this,xe);A(this,We,[]);A(this,Mr);A(this,Rr);A(this,cs,[]);A(this,et,new Float64Array(18));A(this,Tn);A(this,kn);A(this,go);A(this,fo);A(this,Ir);A(this,Pr);A(this,_i,[]);m(this,xe,s),m(this,Pr,n*i),m(this,Rr,r),a(this,et).set([NaN,NaN,NaN,NaN,e,t],6),m(this,Mr,o),m(this,fo,a(js,mo)*i),m(this,go,a(js,Mh)*i),m(this,Ir,i),a(this,_i).push(e,t)}isEmpty(){return isNaN(a(this,et)[8])}add({x:e,y:t}){var T;m(this,Tn,e),m(this,kn,t);const[s,i,n,r]=a(this,xe);let[o,h,l,c]=a(this,et).subarray(8,12);const p=e-l,u=t-c,g=Math.hypot(p,u);if(g<a(this,go))return!1;const f=g-a(this,fo),b=f/g,w=b*p,y=b*u;let x=o,_=h;o=l,h=c,l+=w,c+=y,(T=a(this,_i))==null||T.push(e,t);const E=w/f,C=-y/f*a(this,Pr),S=E*a(this,Pr);return a(this,et).set(a(this,et).subarray(2,8),0),a(this,et).set([l+C,c+S],4),a(this,et).set(a(this,et).subarray(14,18),12),a(this,et).set([l-C,c-S],16),isNaN(a(this,et)[6])?(a(this,cs).length===0&&(a(this,et).set([o+C,h+S],2),a(this,cs).push(NaN,NaN,NaN,NaN,(o+C-s)/n,(h+S-i)/r),a(this,et).set([o-C,h-S],14),a(this,We).push(NaN,NaN,NaN,NaN,(o-C-s)/n,(h-S-i)/r)),a(this,et).set([x,_,o,h,l,c],6),!this.isEmpty()):(a(this,et).set([x,_,o,h,l,c],6),Math.abs(Math.atan2(_-h,x-o)-Math.atan2(y,w))<Math.PI/2?([o,h,l,c]=a(this,et).subarray(2,6),a(this,cs).push(NaN,NaN,NaN,NaN,((o+l)/2-s)/n,((h+c)/2-i)/r),[o,h,x,_]=a(this,et).subarray(14,18),a(this,We).push(NaN,NaN,NaN,NaN,((x+o)/2-s)/n,((_+h)/2-i)/r),!0):([x,_,o,h,l,c]=a(this,et).subarray(0,6),a(this,cs).push(((x+5*o)/6-s)/n,((_+5*h)/6-i)/r,((5*o+l)/6-s)/n,((5*h+c)/6-i)/r,((o+l)/2-s)/n,((h+c)/2-i)/r),[l,c,o,h,x,_]=a(this,et).subarray(12,18),a(this,We).push(((x+5*o)/6-s)/n,((_+5*h)/6-i)/r,((5*o+l)/6-s)/n,((5*h+c)/6-i)/r,((o+l)/2-s)/n,((h+c)/2-i)/r),!0))}toSVGPath(){if(this.isEmpty())return"";const e=a(this,cs),t=a(this,We);if(isNaN(a(this,et)[6])&&!this.isEmpty())return v(this,Ft,Dp).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);v(this,Ft,Op).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return v(this,Ft,Fp).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,n,r){return new Vd(e,t,s,i,n,r)}getOutlines(){var p;const e=a(this,cs),t=a(this,We),s=a(this,et),[i,n,r,o]=a(this,xe),h=new Float64Array((((p=a(this,_i))==null?void 0:p.length)??0)+2);for(let u=0,g=h.length-2;u<g;u+=2)h[u]=(a(this,_i)[u]-i)/r,h[u+1]=(a(this,_i)[u+1]-n)/o;if(h[h.length-2]=(a(this,Tn)-i)/r,h[h.length-1]=(a(this,kn)-n)/o,isNaN(s[6])&&!this.isEmpty())return v(this,Ft,Np).call(this,h);const l=new Float64Array(a(this,cs).length+24+a(this,We).length);let c=e.length;for(let u=0;u<c;u+=2)isNaN(e[u])?l[u]=l[u+1]=NaN:(l[u]=e[u],l[u+1]=e[u+1]);c=v(this,Ft,Hp).call(this,l,c);for(let u=t.length-6;u>=6;u-=6)for(let g=0;g<6;g+=2)isNaN(t[u+g])?(l[c]=l[c+1]=NaN,c+=2):(l[c]=t[u+g],l[c+1]=t[u+g+1],c+=2);return v(this,Ft,Bp).call(this,l,c),this.newFreeDrawOutline(l,h,a(this,xe),a(this,Ir),a(this,Mr),a(this,Rr))}};xe=new WeakMap,We=new WeakMap,Mr=new WeakMap,Rr=new WeakMap,cs=new WeakMap,et=new WeakMap,Tn=new WeakMap,kn=new WeakMap,go=new WeakMap,fo=new WeakMap,Ir=new WeakMap,Pr=new WeakMap,_i=new WeakMap,mo=new WeakMap,kh=new WeakMap,Mh=new WeakMap,Ft=new WeakSet,Ho=function(){const e=a(this,et).subarray(4,6),t=a(this,et).subarray(16,18),[s,i,n,r]=a(this,xe);return[(a(this,Tn)+(e[0]-t[0])/2-s)/n,(a(this,kn)+(e[1]-t[1])/2-i)/r,(a(this,Tn)+(t[0]-e[0])/2-s)/n,(a(this,kn)+(t[1]-e[1])/2-i)/r]},Dp=function(){const[e,t,s,i]=a(this,xe),[n,r,o,h]=v(this,Ft,Ho).call(this);return`M${(a(this,et)[2]-e)/s} ${(a(this,et)[3]-t)/i} L${(a(this,et)[4]-e)/s} ${(a(this,et)[5]-t)/i} L${n} ${r} L${o} ${h} L${(a(this,et)[16]-e)/s} ${(a(this,et)[17]-t)/i} L${(a(this,et)[14]-e)/s} ${(a(this,et)[15]-t)/i} Z`},Fp=function(e){const t=a(this,We);e.push(`L${t[4]} ${t[5]} Z`)},Op=function(e){const[t,s,i,n]=a(this,xe),r=a(this,et).subarray(4,6),o=a(this,et).subarray(16,18),[h,l,c,p]=v(this,Ft,Ho).call(this);e.push(`L${(r[0]-t)/i} ${(r[1]-s)/n} L${h} ${l} L${c} ${p} L${(o[0]-t)/i} ${(o[1]-s)/n}`)},Np=function(e){const t=a(this,et),[s,i,n,r]=a(this,xe),[o,h,l,c]=v(this,Ft,Ho).call(this),p=new Float64Array(36);return p.set([NaN,NaN,NaN,NaN,(t[2]-s)/n,(t[3]-i)/r,NaN,NaN,NaN,NaN,(t[4]-s)/n,(t[5]-i)/r,NaN,NaN,NaN,NaN,o,h,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(t[16]-s)/n,(t[17]-i)/r,NaN,NaN,NaN,NaN,(t[14]-s)/n,(t[15]-i)/r],0),this.newFreeDrawOutline(p,e,a(this,xe),a(this,Ir),a(this,Mr),a(this,Rr))},Bp=function(e,t){const s=a(this,We);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+6},Hp=function(e,t){const s=a(this,et).subarray(4,6),i=a(this,et).subarray(16,18),[n,r,o,h]=a(this,xe),[l,c,p,u]=v(this,Ft,Ho).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-n)/o,(s[1]-r)/h,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,p,u,NaN,NaN,NaN,NaN,(i[0]-n)/o,(i[1]-r)/h],t),t+24},A(js,mo,8),A(js,kh,2),A(js,Mh,a(js,mo)+a(js,kh));let ch=js;class Vd extends Gd{constructor(t,s,i,n,r,o){super();A(this,de);A(this,Lr);A(this,Mn,null);A(this,zs);A(this,vo);A(this,_e);A(this,bo);A(this,kt);m(this,kt,t),m(this,_e,s),m(this,Lr,i),m(this,bo,n),m(this,zs,r),m(this,vo,o),v(this,de,jp).call(this,o);const{x:h,y:l,width:c,height:p}=a(this,Mn);for(let u=0,g=t.length;u<g;u+=2)t[u]=(t[u]-h)/c,t[u+1]=(t[u+1]-l)/p;for(let u=0,g=s.length;u<g;u+=2)s[u]=(s[u]-h)/c,s[u+1]=(s[u+1]-l)/p}toSVGPath(){const t=[`M${a(this,kt)[4]} ${a(this,kt)[5]}`];for(let s=6,i=a(this,kt).length;s<i;s+=6)isNaN(a(this,kt)[s])?t.push(`L${a(this,kt)[s+4]} ${a(this,kt)[s+5]}`):t.push(`C${a(this,kt)[s]} ${a(this,kt)[s+1]} ${a(this,kt)[s+2]} ${a(this,kt)[s+3]} ${a(this,kt)[s+4]} ${a(this,kt)[s+5]}`);return t.push("Z"),t.join(" ")}serialize([t,s,i,n],r){const o=i-t,h=n-s;let l,c;switch(r){case 0:l=v(this,de,jo).call(this,a(this,kt),t,n,o,-h),c=v(this,de,jo).call(this,a(this,_e),t,n,o,-h);break;case 90:l=v(this,de,zo).call(this,a(this,kt),t,s,o,h),c=v(this,de,zo).call(this,a(this,_e),t,s,o,h);break;case 180:l=v(this,de,jo).call(this,a(this,kt),i,s,-o,h),c=v(this,de,jo).call(this,a(this,_e),i,s,-o,h);break;case 270:l=v(this,de,zo).call(this,a(this,kt),i,n,-o,-h),c=v(this,de,zo).call(this,a(this,_e),i,n,-o,-h)}return{outline:Array.from(l),points:[Array.from(c)]}}get box(){return a(this,Mn)}newOutliner(t,s,i,n,r,o=0){return new ch(t,s,i,n,r,o)}getNewOutline(t,s){const{x:i,y:n,width:r,height:o}=a(this,Mn),[h,l,c,p]=a(this,Lr),u=r*c,g=o*p,f=i*c+h,b=n*p+l,w=this.newOutliner({x:a(this,_e)[0]*u+f,y:a(this,_e)[1]*g+b},a(this,Lr),a(this,bo),t,a(this,vo),s??a(this,zs));for(let y=2;y<a(this,_e).length;y+=2)w.add({x:a(this,_e)[y]*u+f,y:a(this,_e)[y+1]*g+b});return w.getOutlines()}get mustRemoveSelfIntersections(){return!0}}Lr=new WeakMap,Mn=new WeakMap,zs=new WeakMap,vo=new WeakMap,_e=new WeakMap,bo=new WeakMap,kt=new WeakMap,de=new WeakSet,jo=function(t,s,i,n,r){const o=new Float64Array(t.length);for(let h=0,l=t.length;h<l;h+=2)o[h]=s+t[h]*n,o[h+1]=i+t[h+1]*r;return o},zo=function(t,s,i,n,r){const o=new Float64Array(t.length);for(let h=0,l=t.length;h<l;h+=2)o[h]=s+t[h+1]*n,o[h+1]=i+t[h]*r;return o},jp=function(t){const s=a(this,kt);let i=s[4],n=s[5],r=i,o=n,h=i,l=n,c=i,p=n;const u=t?Math.max:Math.min;for(let y=6,x=s.length;y<x;y+=6){if(isNaN(s[y]))r=Math.min(r,s[y+4]),o=Math.min(o,s[y+5]),h=Math.max(h,s[y+4]),l=Math.max(l,s[y+5]),p<s[y+5]?(c=s[y+4],p=s[y+5]):p===s[y+5]&&(c=u(c,s[y+4]));else{const _=z.bezierBoundingBox(i,n,...s.slice(y,y+6));r=Math.min(r,_[0]),o=Math.min(o,_[1]),h=Math.max(h,_[2]),l=Math.max(l,_[3]),p<_[3]?(c=_[2],p=_[3]):p===_[3]&&(c=u(c,_[2]))}i=s[y+4],n=s[y+5]}const g=r-a(this,zs),f=o-a(this,zs),b=h-r+2*a(this,zs),w=l-o+2*a(this,zs);m(this,Mn,{x:g,y:f,width:b,height:w,lastPoint:[c,p]})};class Wd{constructor(e,t=0,s=0,i=!0){A(this,ne);A(this,Ao);A(this,Si,[]);A(this,qe,[]);let n=1/0,r=-1/0,o=1/0,h=-1/0;const l=10**-4;for(const{x:w,y,width:x,height:_}of e){const E=Math.floor((w-t)/l)*l,C=Math.ceil((w+x+t)/l)*l,S=Math.floor((y-t)/l)*l,T=Math.ceil((y+_+t)/l)*l,M=[E,S,T,!0],R=[C,S,T,!1];a(this,Si).push(M,R),n=Math.min(n,E),r=Math.max(r,C),o=Math.min(o,S),h=Math.max(h,T)}const c=r-n+2*s,p=h-o+2*s,u=n-s,g=o-s,f=a(this,Si).at(i?-1:-2),b=[f[0],f[2]];for(const w of a(this,Si)){const[y,x,_]=w;w[0]=(y-u)/c,w[1]=(x-g)/p,w[2]=(_-g)/p}m(this,Ao,{x:u,y:g,width:c,height:p,lastPoint:b})}getOutlines(){a(this,Si).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of a(this,Si))t[3]?(e.push(...v(this,ne,kc).call(this,t)),v(this,ne,$p).call(this,t)):(v(this,ne,Up).call(this,t),e.push(...v(this,ne,kc).call(this,t)));return v(this,ne,zp).call(this,e)}}Ao=new WeakMap,Si=new WeakMap,qe=new WeakMap,ne=new WeakSet,zp=function(e){const t=[],s=new Set;for(const r of e){const[o,h,l]=r;t.push([o,h,r],[o,l,r])}t.sort((r,o)=>r[1]-o[1]||r[0]-o[0]);for(let r=0,o=t.length;r<o;r+=2){const h=t[r][2],l=t[r+1][2];h.push(l),l.push(h),s.add(h),s.add(l)}const i=[];let n;for(;s.size>0;){const r=s.values().next().value;let[o,h,l,c,p]=r;s.delete(r);let u=o,g=h;for(n=[o,l],i.push(n);;){let f;if(s.has(c))f=c;else{if(!s.has(p))break;f=p}s.delete(f),[o,h,l,c,p]=f,u!==o&&(n.push(u,g,o,g===h?h:l),u=o),g=g===h?l:h}n.push(u,g)}return new Tm(i,a(this,Ao))},Yh=function(e){const t=a(this,qe);let s=0,i=t.length-1;for(;s<=i;){const n=s+i>>1,r=t[n][0];if(r===e)return n;r<e?s=n+1:i=n-1}return i+1},$p=function([,e,t]){const s=v(this,ne,Yh).call(this,e);a(this,qe).splice(s,0,[e,t])},Up=function([,e,t]){const s=v(this,ne,Yh).call(this,e);for(let i=s;i<a(this,qe).length;i++){const[n,r]=a(this,qe)[i];if(n!==e)break;if(n===e&&r===t){a(this,qe).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[n,r]=a(this,qe)[i];if(n!==e)break;if(n===e&&r===t){a(this,qe).splice(i,1);return}}},kc=function(e){const[t,s,i]=e,n=[[t,s,i]],r=v(this,ne,Yh).call(this,i);for(let o=0;o<r;o++){const[h,l]=a(this,qe)[o];for(let c=0,p=n.length;c<p;c++){const[,u,g]=n[c];if(!(l<=u||g<=h))if(u>=h)if(g>l)n[c][1]=l;else{if(p===1)return[];n.splice(c,1),c--,p--}else n[c][2]=h,g>l&&n.push([t,l,g])}}return n};class Tm extends Gd{constructor(t,s){super();A(this,yo);A(this,Dr);m(this,Dr,t),m(this,yo,s)}toSVGPath(){const t=[];for(const s of a(this,Dr)){let[i,n]=s;t.push(`M${i} ${n}`);for(let r=2;r<s.length;r+=2){const o=s[r],h=s[r+1];o===i?(t.push(`V${h}`),n=h):h===n&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,s,i,n],r){const o=[],h=i-t,l=n-s;for(const c of a(this,Dr)){const p=new Array(c.length);for(let u=0;u<c.length;u+=2)p[u]=t+c[u]*h,p[u+1]=n-c[u+1]*l;o.push(p)}return o}get box(){return a(this,yo)}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}}yo=new WeakMap,Dr=new WeakMap;class Ul extends ch{newFreeDrawOutline(e,t,s,i,n,r){return new km(e,t,s,i,n,r)}get classNamesForDrawing(){return["highlight","free"]}}class km extends Vd{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(e,t,s,i,n,r=0){return new Ul(e,t,s,i,n,r)}}const ue=class ue{constructor({editor:e=null,uiManager:t=null}){A(this,ft);A(this,Xe,null);A(this,Rn,null);A(this,Fr);A(this,Ot,null);A(this,wo,!1);A(this,Or,!1);A(this,xo,null);A(this,_o);A(this,Ei,null);A(this,Ye,null);A(this,Nr);var s;e?(m(this,Or,!1),m(this,Nr,X.HIGHLIGHT_COLOR),m(this,xo,e)):(m(this,Or,!0),m(this,Nr,X.HIGHLIGHT_DEFAULT_COLOR)),m(this,Ye,(e==null?void 0:e._uiManager)||t),m(this,_o,a(this,Ye)._eventBus),m(this,Fr,(e==null?void 0:e.color)||((s=a(this,Ye))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),a(ue,So)||m(ue,So,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return nt(this,"_keyboardManager",new aa([[["Escape","mac+Escape"],ue.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ue.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ue.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ue.prototype._moveToPrevious],[["Home","mac+Home"],ue.prototype._moveToBeginning],[["End","mac+End"],ue.prototype._moveToEnd]]))}renderButton(){const e=m(this,Xe,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=a(this,Ye)._signal;e.addEventListener("click",v(this,ft,Un).bind(this),{signal:t}),e.addEventListener("keydown",v(this,ft,Ic).bind(this),{signal:t});const s=m(this,Rn,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=a(this,Fr),e.append(s),e}renderMainDropdown(){const e=m(this,Ot,v(this,ft,Mc).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===a(this,Xe)){v(this,ft,Un).call(this,e);return}const t=e.target.getAttribute("data-color");t&&v(this,ft,Rc).call(this,t,e)}_moveToNext(e){var t,s;a(this,ft,Li)?e.target!==a(this,Xe)?(t=e.target.nextSibling)==null||t.focus():(s=a(this,Ot).firstChild)==null||s.focus():v(this,ft,Un).call(this,e)}_moveToPrevious(e){var t,s;e.target!==((t=a(this,Ot))==null?void 0:t.firstChild)&&e.target!==a(this,Xe)?(a(this,ft,Li)||v(this,ft,Un).call(this,e),(s=e.target.previousSibling)==null||s.focus()):a(this,ft,Li)&&this._hideDropdownFromKeyboard()}_moveToBeginning(e){var t;a(this,ft,Li)?(t=a(this,Ot).firstChild)==null||t.focus():v(this,ft,Un).call(this,e)}_moveToEnd(e){var t;a(this,ft,Li)?(t=a(this,Ot).lastChild)==null||t.focus():v(this,ft,Un).call(this,e)}hideDropdown(){var e,t;(e=a(this,Ot))==null||e.classList.add("hidden"),(t=a(this,Ei))==null||t.abort(),m(this,Ei,null)}_hideDropdownFromKeyboard(){var e;a(this,Or)||(a(this,ft,Li)?(this.hideDropdown(),a(this,Xe).focus({preventScroll:!0,focusVisible:a(this,wo)})):(e=a(this,xo))==null||e.unselect())}updateColor(e){if(a(this,Rn)&&(a(this,Rn).style.backgroundColor=e),!a(this,Ot))return;const t=a(this,Ye).highlightColors.values();for(const s of a(this,Ot).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=a(this,Xe))==null||e.remove(),m(this,Xe,null),m(this,Rn,null),(t=a(this,Ot))==null||t.remove(),m(this,Ot,null)}};Xe=new WeakMap,Rn=new WeakMap,Fr=new WeakMap,Ot=new WeakMap,wo=new WeakMap,Or=new WeakMap,xo=new WeakMap,_o=new WeakMap,Ei=new WeakMap,Ye=new WeakMap,Nr=new WeakMap,So=new WeakMap,ft=new WeakSet,Mc=function(){const e=document.createElement("div"),t=a(this,Ye)._signal;e.addEventListener("contextmenu",Ce,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of a(this,Ye).highlightColors){const n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",i),n.title=s,n.setAttribute("data-l10n-id",a(ue,So)[s]);const r=document.createElement("span");n.append(r),r.className="swatch",r.style.backgroundColor=i,n.setAttribute("aria-selected",i===a(this,Fr)),n.addEventListener("click",v(this,ft,Rc).bind(this,i),{signal:t}),e.append(n)}return e.addEventListener("keydown",v(this,ft,Ic).bind(this),{signal:t}),e},Rc=function(e,t){t.stopPropagation(),a(this,_o).dispatch("switchannotationeditorparams",{source:this,type:a(this,Nr),value:e})},Ic=function(e){ue._keyboardManager.exec(this,e)},Un=function(e){if(a(this,ft,Li)){this.hideDropdown();return}if(m(this,wo,e.detail===0),a(this,Ei)||(m(this,Ei,new AbortController),window.addEventListener("pointerdown",v(this,ft,Gp).bind(this),{signal:a(this,Ye).combinedSignal(a(this,Ei))})),a(this,Ot)){a(this,Ot).classList.remove("hidden");return}const t=m(this,Ot,v(this,ft,Mc).call(this));a(this,Xe).append(t)},Gp=function(e){var t;(t=a(this,Ot))!=null&&t.contains(e.target)||this.hideDropdown()},Li=function(){return a(this,Ot)&&!a(this,Ot).classList.contains("hidden")},A(ue,So,null);let dh=ue;const at=class at extends lt{constructor(t){super({...t,name:"highlightEditor"});A(this,Q);A(this,Br,null);A(this,Eo,0);A(this,$s);A(this,In,null);A(this,Hr,null);A(this,Pe,null);A(this,Co,null);A(this,To,0);A(this,Pn,null);A(this,Ke,null);A(this,Jt,null);A(this,pe,!1);A(this,jr,null);A(this,Us);A(this,Nt,null);A(this,zr,"");A(this,Le);A(this,ko,"");this.color=t.color||at._defaultColor,m(this,Le,t.thickness||at._defaultThickness),m(this,Us,t.opacity||at._defaultOpacity),m(this,$s,t.boxes||null),m(this,ko,t.methodOfCreation||""),m(this,zr,t.text||""),this._isDraggable=!1,t.highlightId>-1?(m(this,pe,!0),v(this,Q,Kh).call(this,t),v(this,Q,Gn).call(this)):a(this,$s)&&(m(this,Br,t.anchorNode),m(this,Eo,t.anchorOffset),m(this,Co,t.focusNode),m(this,To,t.focusOffset),v(this,Q,Pc).call(this),v(this,Q,Gn).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=at.prototype;return nt(this,"_keyboardManager",new aa([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:a(this,pe)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:a(this,Le),methodOfCreation:a(this,ko)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;lt.initialize(t,s),at._defaultColor||(at._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case X.HIGHLIGHT_DEFAULT_COLOR:at._defaultColor=s;break;case X.HIGHLIGHT_THICKNESS:at._defaultThickness=s}}translateInPage(t,s){}get toolbarPosition(){return a(this,jr)}updateParams(t,s){switch(t){case X.HIGHLIGHT_COLOR:v(this,Q,Vp).call(this,s);break;case X.HIGHLIGHT_THICKNESS:v(this,Q,Wp).call(this,s)}}static get defaultPropertiesToUpdate(){return[[X.HIGHLIGHT_DEFAULT_COLOR,at._defaultColor],[X.HIGHLIGHT_THICKNESS,at._defaultThickness]]}get propertiesToUpdate(){return[[X.HIGHLIGHT_COLOR,this.color||at._defaultColor],[X.HIGHLIGHT_THICKNESS,a(this,Le)||at._defaultThickness],[X.HIGHLIGHT_FREE,a(this,pe)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(m(this,Hr,new dh({editor:this})),t.addColorPicker(a(this,Hr))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(v(this,Q,$o).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,v(this,Q,$o).call(this))}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){v(this,Q,Lc).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(v(this,Q,Gn).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?v(this,Q,Lc).call(this):t&&(v(this,Q,Gn).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var n,r,o;const{drawLayer:s}=this.parent;let i;a(this,pe)?(t=(t-this.rotation+360)%360,i=v(n=at,De,ea).call(n,a(this,Ke).box,t)):i=v(r=at,De,ea).call(r,this,t),s.rotate(a(this,Jt),t),s.rotate(a(this,Nt),t),s.updateBox(a(this,Jt),i),s.updateBox(a(this,Nt),v(o=at,De,ea).call(o,a(this,Pe).box,t))}render(){if(this.div)return this.div;const t=super.render();a(this,zr)&&(t.setAttribute("aria-label",a(this,zr)),t.setAttribute("role","mark")),a(this,pe)?t.classList.add("free"):this.div.addEventListener("keydown",v(this,Q,Xp).bind(this),{signal:this._uiManager._signal});const s=m(this,Pn,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=a(this,In);const[i,n]=this.parentDimensions;return this.setDims(this.width*i,this.height*n),sh(this,a(this,Pn),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent.drawLayer.addClass(a(this,Nt),"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(a(this,Nt),"hovered")}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:v(this,Q,Qh).call(this,!0);break;case 1:case 3:v(this,Q,Qh).call(this,!1)}}select(){var t,s;super.select(),a(this,Nt)&&((t=this.parent)==null||t.drawLayer.removeClass(a(this,Nt),"hovered"),(s=this.parent)==null||s.drawLayer.addClass(a(this,Nt),"selected"))}unselect(){var t;super.unselect(),a(this,Nt)&&((t=this.parent)==null||t.drawLayer.removeClass(a(this,Nt),"selected"),a(this,pe)||v(this,Q,Qh).call(this,!1))}get _mustFixPosition(){return!a(this,pe)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.show(a(this,Jt),t),this.parent.drawLayer.show(a(this,Nt),t))}static startHighlighting(t,s,{target:i,x:n,y:r}){const{x:o,y:h,width:l,height:c}=i.getBoundingClientRect(),p=new AbortController,u=t.combinedSignal(p),g=f=>{p.abort(),v(this,De,Jp).call(this,t,f)};window.addEventListener("blur",g,{signal:u}),window.addEventListener("pointerup",g,{signal:u}),window.addEventListener("pointerdown",f=>{f.preventDefault(),f.stopPropagation()},{capture:!0,passive:!1,signal:u}),window.addEventListener("contextmenu",Ce,{signal:u}),i.addEventListener("pointermove",v(this,De,Qp).bind(this,t),{signal:u}),this._freeHighlight=new Ul({x:n,y:r},[o,h,l,c],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static async deserialize(t,s,i){var b,w,y,x;let n=null;if(t instanceof $d){const{data:{quadPoints:_,rect:E,rotation:C,id:S,color:T,opacity:M,popupRef:R},parent:{page:{pageNumber:O}}}=t;n=t={annotationType:J.HIGHLIGHT,color:Array.from(T),opacity:M,quadPoints:_,boxes:null,pageIndex:O-1,rect:E.slice(0),rotation:C,id:S,deleted:!1,popupRef:R}}else if(t instanceof zl){const{data:{inkLists:_,rect:E,rotation:C,id:S,color:T,borderStyle:{rawWidth:M},popupRef:R},parent:{page:{pageNumber:O}}}=t;n=t={annotationType:J.HIGHLIGHT,color:Array.from(T),thickness:M,inkLists:_,boxes:null,pageIndex:O-1,rect:E.slice(0),rotation:C,id:S,deleted:!1,popupRef:R}}const{color:r,quadPoints:o,inkLists:h,opacity:l}=t,c=await super.deserialize(t,s,i);c.color=z.makeHexColor(...r),m(c,Us,l||1),h&&m(c,Le,t.thickness),c.annotationElementId=t.id||null,c._initialData=n;const[p,u]=c.pageDimensions,[g,f]=c.pageTranslation;if(o){const _=m(c,$s,[]);for(let E=0;E<o.length;E+=8)_.push({x:(o[E]-g)/p,y:1-(o[E+1]-f)/u,width:(o[E+2]-o[E])/p,height:(o[E+1]-o[E+5])/u});v(b=c,Q,Pc).call(b),v(w=c,Q,Gn).call(w),c.rotate(c.rotation)}else if(h){m(c,pe,!0);const _=h[0],E={x:_[0]-g,y:u-(_[1]-f)},C=new Ul(E,[0,0,p,u],1,a(c,Le)/2,!0,.001);for(let M=0,R=_.length;M<R;M+=2)E.x=_[M]-g,E.y=u-(_[M+1]-f),C.add(E);const{id:S,clipPathId:T}=s.drawLayer.draw(C,c.color,c._defaultOpacity,!0);v(y=c,Q,Kh).call(y,{highlightOutlines:C.getOutlines(),highlightId:S,clipPathId:T}),v(x=c,Q,Gn).call(x)}return c}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=lt._colorManager.convert(this.color),n={annotationType:J.HIGHLIGHT,color:i,opacity:a(this,Us),thickness:a(this,Le),quadPoints:v(this,Q,Yp).call(this),outlines:v(this,Q,Kp).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:v(this,Q,$o).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!v(this,Q,Zp).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Br=new WeakMap,Eo=new WeakMap,$s=new WeakMap,In=new WeakMap,Hr=new WeakMap,Pe=new WeakMap,Co=new WeakMap,To=new WeakMap,Pn=new WeakMap,Ke=new WeakMap,Jt=new WeakMap,pe=new WeakMap,jr=new WeakMap,Us=new WeakMap,Nt=new WeakMap,zr=new WeakMap,Le=new WeakMap,ko=new WeakMap,Q=new WeakSet,Pc=function(){const t=new Wd(a(this,$s),.001);m(this,Ke,t.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=a(this,Ke).box;const s=new Wd(a(this,$s),.0025,.001,this._uiManager.direction==="ltr");m(this,Pe,s.getOutlines());const{lastPoint:i}=a(this,Pe).box;m(this,jr,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Kh=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var c,p;if(m(this,Ke,t),m(this,Pe,t.getNewOutline(a(this,Le)/2+1.5,.0025)),s>=0)m(this,Jt,s),m(this,In,i),this.parent.drawLayer.finalizeLine(s,t),m(this,Nt,this.parent.drawLayer.drawOutline(a(this,Pe)));else if(this.parent){const u=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(a(this,Jt),t),this.parent.drawLayer.updateBox(a(this,Jt),v(c=at,De,ea).call(c,a(this,Ke).box,(u-this.rotation+360)%360)),this.parent.drawLayer.updateLine(a(this,Nt),a(this,Pe)),this.parent.drawLayer.updateBox(a(this,Nt),v(p=at,De,ea).call(p,a(this,Pe).box,u))}const{x:n,y:r,width:o,height:h}=t.box;switch(this.rotation){case 0:this.x=n,this.y=r,this.width=o,this.height=h;break;case 90:{const[u,g]=this.parentDimensions;this.x=r,this.y=1-n,this.width=o*g/u,this.height=h*u/g;break}case 180:this.x=1-n,this.y=1-r,this.width=o,this.height=h;break;case 270:{const[u,g]=this.parentDimensions;this.x=1-r,this.y=n,this.width=o*g/u,this.height=h*u/g;break}}const{lastPoint:l}=a(this,Pe).box;m(this,jr,[(l[0]-n)/o,(l[1]-r)/h])},Vp=function(t){const s=(r,o)=>{var h,l,c;this.color=r,(h=this.parent)==null||h.drawLayer.changeColor(a(this,Jt),r),(l=a(this,Hr))==null||l.updateColor(r),m(this,Us,o),(c=this.parent)==null||c.drawLayer.changeOpacity(a(this,Jt),o)},i=this.color,n=a(this,Us);this.addCommands({cmd:s.bind(this,t,at._defaultOpacity),undo:s.bind(this,i,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:X.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},Wp=function(t){const s=a(this,Le),i=n=>{m(this,Le,n),v(this,Q,qp).call(this,n)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:X.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},qp=function(t){if(!a(this,pe))return;v(this,Q,Kh).call(this,{highlightOutlines:a(this,Ke).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},Lc=function(){a(this,Jt)!==null&&this.parent&&(this.parent.drawLayer.remove(a(this,Jt)),m(this,Jt,null),this.parent.drawLayer.remove(a(this,Nt)),m(this,Nt,null))},Gn=function(t=this.parent){a(this,Jt)===null&&({id:re(this,Jt)._,clipPathId:re(this,In)._}=t.drawLayer.draw(a(this,Ke),this.color,a(this,Us)),m(this,Nt,t.drawLayer.drawOutline(a(this,Pe))),a(this,Pn)&&(a(this,Pn).style.clipPath=a(this,In)))},De=new WeakSet,ea=function({x:t,y:s,width:i,height:n},r){switch(r){case 90:return{x:1-s-n,y:t,width:n,height:i};case 180:return{x:1-t-i,y:1-s-n,width:i,height:n};case 270:return{x:s,y:1-t-i,width:n,height:i}}return{x:t,y:s,width:i,height:n}},Xp=function(t){at._keyboardManager.exec(this,t)},Qh=function(t){if(!a(this,Br))return;const s=window.getSelection();t?s.setPosition(a(this,Br),a(this,Eo)):s.setPosition(a(this,Co),a(this,To))},$o=function(){return a(this,pe)?this.rotation:0},Yp=function(){if(a(this,pe))return null;const[t,s]=this.pageDimensions,[i,n]=this.pageTranslation,r=a(this,$s),o=new Float32Array(8*r.length);let h=0;for(const{x:l,y:c,width:p,height:u}of r){const g=l*t+i,f=(1-c-u)*s+n;o[h]=o[h+4]=g,o[h+1]=o[h+3]=f,o[h+2]=o[h+6]=g+p*t,o[h+5]=o[h+7]=f+u*s,h+=8}return o},Kp=function(t){return a(this,Ke).serialize(t,v(this,Q,$o).call(this))},Qp=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},Jp=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Zp=function(t){const{color:s}=this._initialData;return t.color.some((i,n)=>i!==s[n])},A(at,De),Y(at,"_defaultColor",null),Y(at,"_defaultOpacity",1),Y(at,"_defaultThickness",12),Y(at,"_type","highlight"),Y(at,"_editorType",J.HIGHLIGHT),Y(at,"_freeHighlightId",-1),Y(at,"_freeHighlight",null),Y(at,"_freeHighlightClipId","");let uh=at;const St=class St extends lt{constructor(t){super({...t,name:"inkEditor"});A(this,P);A(this,Ln,0);A(this,Dn,0);A(this,ds,null);A(this,Gs,new Path2D);A(this,Fe,!1);A(this,Fn,null);A(this,On,!1);A(this,Nn,!1);A(this,Vs,null);A(this,$r,null);A(this,Bn,0);A(this,Hn,0);A(this,Ci,null);this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t,s){lt.initialize(t,s)}static updateDefaultParams(t,s){switch(t){case X.INK_THICKNESS:St._defaultThickness=s;break;case X.INK_COLOR:St._defaultColor=s;break;case X.INK_OPACITY:St._defaultOpacity=s/100}}updateParams(t,s){switch(t){case X.INK_THICKNESS:v(this,P,tg).call(this,s);break;case X.INK_COLOR:v(this,P,eg).call(this,s);break;case X.INK_OPACITY:v(this,P,sg).call(this,s)}}static get defaultPropertiesToUpdate(){return[[X.INK_THICKNESS,St._defaultThickness],[X.INK_COLOR,St._defaultColor||lt._defaultLineColor],[X.INK_OPACITY,Math.round(100*St._defaultOpacity)]]}get propertiesToUpdate(){return[[X.INK_THICKNESS,this.thickness||St._defaultThickness],[X.INK_COLOR,this.color||St._defaultColor||lt._defaultLineColor],[X.INK_OPACITY,Math.round(100*(this.opacity??St._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(v(this,P,Jh).call(this),v(this,P,Zh).call(this)),this.isAttachedToDOM||(this.parent.add(this),v(this,P,sa).call(this)),v(this,P,Uo).call(this)))}remove(){var t;this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,a(this,ds)&&(clearTimeout(a(this,ds)),m(this,ds,null)),(t=a(this,Vs))==null||t.disconnect(),m(this,Vs,null),super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,s]=this.parentDimensions,i=this.width*t,n=this.height*s;this.setDimensions(i,n)}enableEditMode(){!a(this,Fe)&&this.canvas!==null&&(super.enableEditMode(),this._isDraggable=!1,v(this,P,Oc).call(this))}disableEditMode(){this.isInEditMode()&&this.canvas!==null&&(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),v(this,P,Nc).call(this))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){a(this,Fe)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),m(this,Fe,!0),this.div.classList.add("disabled"),v(this,P,Uo).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){t.button===0&&this.isInEditMode()&&!a(this,Fe)&&(this.setInForeground(),t.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),v(this,P,ng).call(this,t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),v(this,P,Fc).call(this,t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),v(this,P,Bc).call(this,t)}canvasPointerleave(t){v(this,P,Bc).call(this,t)}get isResizable(){return!this.isEmpty()&&a(this,Fe)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[i,n,r,o]=v(this,P,ig).call(this);if(this.setAt(i,n,0,0),this.setDims(r,o),v(this,P,Jh).call(this),this.width){const[h,l]=this.parentDimensions;this.setAspectRatio(this.width*h,this.height*l),this.setAt(t*h,s*l,this.width*h,this.height*l),m(this,Nn,!0),v(this,P,sa).call(this),this.setDims(this.width*h,this.height*l),v(this,P,Vn).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return v(this,P,Zh).call(this),this.div}setDimensions(t,s){const i=Math.round(t),n=Math.round(s);if(a(this,Bn)===i&&a(this,Hn)===n)return;m(this,Bn,i),m(this,Hn,n),this.canvas.style.visibility="hidden";const[r,o]=this.parentDimensions;this.width=t/r,this.height=s/o,this.fixAndSetPosition(),a(this,Fe)&&v(this,P,Hc).call(this,t,s),v(this,P,sa).call(this),v(this,P,Vn).call(this),this.canvas.style.visibility="visible",this.fixDims()}static async deserialize(t,s,i){var w,y,x;if(t instanceof zl)return null;const n=await super.deserialize(t,s,i);n.thickness=t.thickness,n.color=z.makeHexColor(...t.color),n.opacity=t.opacity;const[r,o]=n.pageDimensions,h=n.width*r,l=n.height*o,c=n.parentScale,p=t.thickness/2;m(n,Fe,!0),m(n,Bn,Math.round(h)),m(n,Hn,Math.round(l));const{paths:u,rect:g,rotation:f}=t;for(let{bezier:_}of u){_=v(w=St,Ws,dg).call(w,_,g,f);const E=[];n.paths.push(E);let C=c*(_[0]-p),S=c*(_[1]-p);for(let M=2,R=_.length;M<R;M+=6){const O=c*(_[M]-p),N=c*(_[M+1]-p),Z=c*(_[M+2]-p),$=c*(_[M+3]-p),j=c*(_[M+4]-p),it=c*(_[M+5]-p);E.push([[C,S],[O,N],[Z,$],[j,it]]),C=j,S=it}const T=v(this,Ws,cg).call(this,E);n.bezierPath2D.push(T)}const b=v(y=n,P,zc).call(y);return m(n,Dn,Math.max(lt.MIN_SIZE,b[2]-b[0])),m(n,Ln,Math.max(lt.MIN_SIZE,b[3]-b[1])),v(x=n,P,Hc).call(x,h,l),n}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),s=lt._colorManager.convert(this.ctx.strokeStyle);return{annotationType:J.INK,color:s,thickness:this.thickness,opacity:this.opacity,paths:v(this,P,ug).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};Ln=new WeakMap,Dn=new WeakMap,ds=new WeakMap,Gs=new WeakMap,Fe=new WeakMap,Fn=new WeakMap,On=new WeakMap,Nn=new WeakMap,Vs=new WeakMap,$r=new WeakMap,Bn=new WeakMap,Hn=new WeakMap,Ci=new WeakMap,P=new WeakSet,tg=function(t){const s=n=>{this.thickness=n,v(this,P,Uo).call(this)},i=this.thickness;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:X.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},eg=function(t){const s=n=>{this.color=n,v(this,P,Vn).call(this)},i=this.color;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:X.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},sg=function(t){const s=n=>{this.opacity=n,v(this,P,Vn).call(this)};t/=100;const i=this.opacity;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:X.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},ig=function(){const{parentRotation:t,parentDimensions:[s,i]}=this;switch(t){case 90:return[0,i,i,s];case 180:return[s,i,s,i];case 270:return[s,0,i,s];default:return[0,0,s,i]}},Dc=function(){const{ctx:t,color:s,opacity:i,thickness:n,parentScale:r,scaleFactor:o}=this;t.lineWidth=n*r/o,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${s}${function(h){return Math.round(Math.min(255,Math.max(1,255*h))).toString(16).padStart(2,"0")}(i)}`},ng=function(t,s){this.canvas.addEventListener("contextmenu",Ce,{signal:this._uiManager._signal}),v(this,P,Nc).call(this),m(this,Fn,new AbortController);const i=this._uiManager.combinedSignal(a(this,Fn));this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:i}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:i}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:i}),this.isEditing=!0,a(this,Nn)||(m(this,Nn,!0),v(this,P,sa).call(this),this.thickness||(this.thickness=St._defaultThickness),this.color||(this.color=St._defaultColor||lt._defaultLineColor),this.opacity??(this.opacity=St._defaultOpacity)),this.currentPath.push([t,s]),m(this,On,!1),v(this,P,Dc).call(this),m(this,Ci,()=>{v(this,P,og).call(this),a(this,Ci)&&window.requestAnimationFrame(a(this,Ci))}),window.requestAnimationFrame(a(this,Ci))},Fc=function(t,s){const[i,n]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===i&&s===n)return;const r=this.currentPath;let o=a(this,Gs);r.push([t,s]),m(this,On,!0),r.length<=2?(o.moveTo(...r[0]),o.lineTo(t,s)):(r.length===3&&(m(this,Gs,o=new Path2D),o.moveTo(...r[0])),v(this,P,hg).call(this,o,...r.at(-3),...r.at(-2),t,s))},rg=function(){if(this.currentPath.length===0)return;const t=this.currentPath.at(-1);a(this,Gs).lineTo(...t)},ag=function(t,s){m(this,Ci,null),t=Math.min(Math.max(t,0),this.canvas.width),s=Math.min(Math.max(s,0),this.canvas.height),v(this,P,Fc).call(this,t,s),v(this,P,rg).call(this);let i;if(this.currentPath.length!==1)i=v(this,P,lg).call(this);else{const o=[t,s];i=[[o,o.slice(),o.slice(),o]]}const n=a(this,Gs),r=this.currentPath;this.currentPath=[],m(this,Gs,new Path2D),this.addCommands({cmd:()=>{this.allRawPaths.push(r),this.paths.push(i),this.bezierPath2D.push(n),this._uiManager.rebuild(this)},undo:()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(v(this,P,Jh).call(this),v(this,P,Zh).call(this)),v(this,P,Uo).call(this))},mustExec:!0})},og=function(){if(!a(this,On))return;m(this,On,!1),Math.ceil(this.thickness*this.parentScale);const t=this.currentPath.slice(-3),s=t.map(r=>r[0]),i=t.map(r=>r[1]),{ctx:n}=(Math.min(...s),Math.max(...s),Math.min(...i),Math.max(...i),this);n.save(),n.clearRect(0,0,this.canvas.width,this.canvas.height);for(const r of this.bezierPath2D)n.stroke(r);n.stroke(a(this,Gs)),n.restore()},hg=function(t,s,i,n,r,o,h){const l=(s+n)/2,c=(i+r)/2,p=(n+o)/2,u=(r+h)/2;t.bezierCurveTo(l+2*(n-l)/3,c+2*(r-c)/3,p+2*(n-p)/3,u+2*(r-u)/3,p,u)},lg=function(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const s=[];let i,[n,r]=t[0];for(i=1;i<t.length-2;i++){const[g,f]=t[i],[b,w]=t[i+1],y=(g+b)/2,x=(f+w)/2,_=[n+2*(g-n)/3,r+2*(f-r)/3],E=[y+2*(g-y)/3,x+2*(f-x)/3];s.push([[n,r],_,E,[y,x]]),[n,r]=[y,x]}const[o,h]=t[i],[l,c]=t[i+1],p=[n+2*(o-n)/3,r+2*(h-r)/3],u=[l+2*(o-l)/3,c+2*(h-c)/3];return s.push([[n,r],p,u,[l,c]]),s},Vn=function(){if(this.isEmpty()){v(this,P,tl).call(this);return}v(this,P,Dc).call(this);const{canvas:t,ctx:s}=this;s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,t.width,t.height),v(this,P,tl).call(this);for(const i of this.bezierPath2D)s.stroke(i)},Oc=function(){if(a(this,$r))return;m(this,$r,new AbortController);const t=this._uiManager.combinedSignal(a(this,$r));this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:t})},Nc=function(){var t;(t=this.pointerdownAC)==null||t.abort(),this.pointerdownAC=null},Bc=function(t){var s;(s=a(this,Fn))==null||s.abort(),m(this,Fn,null),v(this,P,Oc).call(this),a(this,ds)&&clearTimeout(a(this,ds)),m(this,ds,setTimeout(()=>{m(this,ds,null),this.canvas.removeEventListener("contextmenu",Ce)},10)),v(this,P,ag).call(this,t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Jh=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Zh=function(){m(this,Vs,new ResizeObserver(t=>{const s=t[0].contentRect;s.width&&s.height&&this.setDimensions(s.width,s.height)})),a(this,Vs).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var t;(t=a(this,Vs))==null||t.disconnect(),m(this,Vs,null)},{once:!0})},sa=function(){if(!a(this,Nn))return;const[t,s]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*s),v(this,P,tl).call(this)},Hc=function(t,s){const i=v(this,P,el).call(this),n=(t-i)/a(this,Dn),r=(s-i)/a(this,Ln);this.scaleFactor=Math.min(n,r)},tl=function(){const t=v(this,P,el).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)},Ws=new WeakSet,cg=function(t){const s=new Path2D;for(let i=0,n=t.length;i<n;i++){const[r,o,h,l]=t[i];i===0&&s.moveTo(...r),s.bezierCurveTo(o[0],o[1],h[0],h[1],l[0],l[1])}return s},jc=function(t,s,i){const[n,r,o,h]=s;switch(i){case 0:for(let l=0,c=t.length;l<c;l+=2)t[l]+=n,t[l+1]=h-t[l+1];break;case 90:for(let l=0,c=t.length;l<c;l+=2){const p=t[l];t[l]=t[l+1]+n,t[l+1]=p+r}break;case 180:for(let l=0,c=t.length;l<c;l+=2)t[l]=o-t[l],t[l+1]+=r;break;case 270:for(let l=0,c=t.length;l<c;l+=2){const p=t[l];t[l]=o-t[l+1],t[l+1]=h-p}break;default:throw new Error("Invalid rotation")}return t},dg=function(t,s,i){const[n,r,o,h]=s;switch(i){case 0:for(let l=0,c=t.length;l<c;l+=2)t[l]-=n,t[l+1]=h-t[l+1];break;case 90:for(let l=0,c=t.length;l<c;l+=2){const p=t[l];t[l]=t[l+1]-r,t[l+1]=p-n}break;case 180:for(let l=0,c=t.length;l<c;l+=2)t[l]=o-t[l],t[l+1]-=r;break;case 270:for(let l=0,c=t.length;l<c;l+=2){const p=t[l];t[l]=h-t[l+1],t[l+1]=o-p}break;default:throw new Error("Invalid rotation")}return t},ug=function(t,s,i,n){var c,p;const r=[],o=this.thickness/2,h=t*s+o,l=t*i+o;for(const u of this.paths){const g=[],f=[];for(let b=0,w=u.length;b<w;b++){const[y,x,_,E]=u[b];if(y[0]===E[0]&&y[1]===E[1]&&w===1){const $=t*y[0]+h,j=t*y[1]+l;g.push($,j),f.push($,j);break}const C=t*y[0]+h,S=t*y[1]+l,T=t*x[0]+h,M=t*x[1]+l,R=t*_[0]+h,O=t*_[1]+l,N=t*E[0]+h,Z=t*E[1]+l;b===0&&(g.push(C,S),f.push(C,S)),g.push(T,M,R,O,N,Z),f.push(T,M),b===w-1&&f.push(N,Z)}r.push({bezier:v(c=St,Ws,jc).call(c,g,n,this.rotation),points:v(p=St,Ws,jc).call(p,f,n,this.rotation)})}return r},zc=function(){let t=1/0,s=-1/0,i=1/0,n=-1/0;for(const r of this.paths)for(const[o,h,l,c]of r){const p=z.bezierBoundingBox(...o,...h,...l,...c);t=Math.min(t,p[0]),i=Math.min(i,p[1]),s=Math.max(s,p[2]),n=Math.max(n,p[3])}return[t,i,s,n]},el=function(){return a(this,Fe)?Math.ceil(this.thickness*this.parentScale):0},Uo=function(t=!1){if(this.isEmpty())return;if(!a(this,Fe)){v(this,P,Vn).call(this);return}const s=v(this,P,zc).call(this),i=v(this,P,el).call(this);m(this,Dn,Math.max(lt.MIN_SIZE,s[2]-s[0])),m(this,Ln,Math.max(lt.MIN_SIZE,s[3]-s[1]));const n=Math.ceil(i+a(this,Dn)*this.scaleFactor),r=Math.ceil(i+a(this,Ln)*this.scaleFactor),[o,h]=this.parentDimensions;this.width=n/o,this.height=r/h,this.setAspectRatio(n,r);const l=this.translationX,c=this.translationY;this.translationX=-s[0],this.translationY=-s[1],v(this,P,sa).call(this),v(this,P,Vn).call(this),m(this,Bn,n),m(this,Hn,r),this.setDims(n,r);const p=t?i/this.scaleFactor/2:0;this.translate(l-this.translationX-p,c-this.translationY-p)},A(St,Ws),Y(St,"_defaultColor",null),Y(St,"_defaultOpacity",1),Y(St,"_defaultThickness",1),Y(St,"_type","ink"),Y(St,"_editorType",J.INK);let Gl=St;const Mo=class Mo extends lt{constructor(t){super({...t,name:"stampEditor"});A(this,st);A(this,Et,null);A(this,qt,null);A(this,Ti,null);A(this,qs,null);A(this,ki,null);A(this,Ur,"");A(this,us,null);A(this,Xs,null);A(this,ps,null);A(this,Se,!1);A(this,Gr,!1);m(this,qs,t.bitmapUrl),m(this,ki,t.bitmapFile)}static initialize(t,s){lt.initialize(t,s)}static get supportedTypes(){return nt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return nt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(J.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:r,height:o}=t||this.copyCanvas(null,null,!0).imageData,h=await i.guess({name:"altText",request:{data:n,width:r,height:o,channels:n.length/(r*o)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const l=h.output;return await this.setGuessedAltText(l),s&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l}remove(){var t,s;a(this,qt)&&(m(this,Et,null),this._uiManager.imageManager.deleteId(a(this,qt)),(t=a(this,us))==null||t.remove(),m(this,us,null),(s=a(this,Xs))==null||s.disconnect(),m(this,Xs,null),a(this,ps)&&(clearTimeout(a(this,ps)),m(this,ps,null))),super.remove()}rebuild(){this.parent?(super.rebuild(),this.div!==null&&(a(this,qt)&&a(this,us)===null&&v(this,st,sl).call(this),this.isAttachedToDOM||this.parent.add(this))):a(this,qt)&&v(this,st,sl).call(this)}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(a(this,Ti)||a(this,Et)||a(this,qs)||a(this,ki)||a(this,qt))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),a(this,Et)?v(this,st,$c).call(this):v(this,st,sl).call(this),this.width&&!this.annotationElementId){const[i,n]=this.parentDimensions;this.setAt(t*i,s*n,this.width*i,this.height*n)}return this.div}copyCanvas(t,s,i=!1){var g;t||(t=224);const{width:n,height:r}=a(this,Et),o=new yl;let h=a(this,Et),l=n,c=r,p=null;if(s){if(n>s||r>s){const M=Math.min(s/n,s/r);l=Math.floor(n*M),c=Math.floor(r*M)}p=document.createElement("canvas");const f=p.width=Math.ceil(l*o.sx),b=p.height=Math.ceil(c*o.sy);a(this,Se)||(h=v(this,st,il).call(this,f,b));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let y="white",x="#cfcfd8";this._uiManager.hcmFilter!=="none"?x="black":(g=window.matchMedia)!=null&&g.call(window,"(prefers-color-scheme: dark)").matches&&(y="#8f8f9d",x="#42414d");const _=15,E=_*o.sx,C=_*o.sy,S=new OffscreenCanvas(2*E,2*C),T=S.getContext("2d");T.fillStyle=y,T.fillRect(0,0,2*E,2*C),T.fillStyle=x,T.fillRect(0,0,E,C),T.fillRect(E,C,E,C),w.fillStyle=w.createPattern(S,"repeat"),w.fillRect(0,0,f,b),w.drawImage(h,0,0,h.width,h.height,0,0,f,b)}let u=null;if(i){let f,b;if(o.symmetric&&h.width<t&&h.height<t)f=h.width,b=h.height;else if(h=a(this,Et),n>t||r>t){const y=Math.min(t/n,t/r);f=Math.floor(n*y),b=Math.floor(r*y),a(this,Se)||(h=v(this,st,il).call(this,f,b))}const w=new OffscreenCanvas(f,b).getContext("2d",{willReadFrequently:!0});w.drawImage(h,0,0,h.width,h.height,0,0,f,b),u={width:f,height:b,data:w.getImageData(0,0,f,b).data}}return{canvas:p,width:l,height:c,imageData:u}}getImageForAltText(){return a(this,us)}static async deserialize(t,s,i){var b;let n=null;if(t instanceof Ud){const{data:{rect:w,rotation:y,id:x,structParent:_,popupRef:E},container:C,parent:{page:{pageNumber:S}}}=t,T=C.querySelector("canvas"),M=i.imageManager.getFromCanvas(C.id,T);T.remove();const R=((b=await s._structTree.getAriaAttributes(`${fl}${x}`))==null?void 0:b.get("aria-label"))||"";n=t={annotationType:J.STAMP,bitmapId:M.id,bitmap:M.bitmap,pageIndex:S-1,rect:w.slice(0),rotation:y,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:R},isSvg:!1,structParent:_,popupRef:E}}const r=await super.deserialize(t,s,i),{rect:o,bitmap:h,bitmapUrl:l,bitmapId:c,isSvg:p,accessibilityData:u}=t;c&&i.imageManager.isValidId(c)?(m(r,qt,c),h&&m(r,Et,h)):m(r,qs,l),m(r,Se,p);const[g,f]=r.pageDimensions;return r.width=(o[2]-o[0])/g,r.height=(o[3]-o[1])/f,r.annotationElementId=t.id||null,u&&(r.altTextData=u),r._initialData=n,m(r,Gr,!!n),r}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:J.STAMP,bitmapId:a(this,qt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:a(this,Se),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=v(this,st,nl).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:n,altText:r}=this.serializeAltText(!1);if(!n&&r&&(i.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const h=v(this,st,fg).call(this,i);if(h.isSame)return null;h.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const o=a(this,Se)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(s.stamps.has(a(this,qt))){if(a(this,Se)){const h=s.stamps.get(a(this,qt));o>h.area&&(h.area=o,h.serialized.bitmap.close(),h.serialized.bitmap=v(this,st,nl).call(this,!1))}}else s.stamps.set(a(this,qt),{area:o,serialized:i}),i.bitmap=v(this,st,nl).call(this,!1);return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Et=new WeakMap,qt=new WeakMap,Ti=new WeakMap,qs=new WeakMap,ki=new WeakMap,Ur=new WeakMap,us=new WeakMap,Xs=new WeakMap,ps=new WeakMap,Se=new WeakMap,Gr=new WeakMap,st=new WeakSet,Go=function(t,s=!1){t?(m(this,Et,t.bitmap),s||(m(this,qt,t.id),m(this,Se,t.isSvg)),t.file&&m(this,Ur,t.file.name),v(this,st,$c).call(this)):this.remove()},Vo=function(){if(m(this,Ti,null),this._uiManager.enableWaiting(!1),a(this,us))if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&a(this,Et))this._editToolbar.hide(),this._uiManager.editAltText(this,!0);else{if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&a(this,Et)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},sl=function(){if(a(this,qt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(a(this,qt)).then(i=>v(this,st,Go).call(this,i,!0)).finally(()=>v(this,st,Vo).call(this));return}if(a(this,qs)){const i=a(this,qs);m(this,qs,null),this._uiManager.enableWaiting(!0),m(this,Ti,this._uiManager.imageManager.getFromUrl(i).then(n=>v(this,st,Go).call(this,n)).finally(()=>v(this,st,Vo).call(this)));return}if(a(this,ki)){const i=a(this,ki);m(this,ki,null),this._uiManager.enableWaiting(!0),m(this,Ti,this._uiManager.imageManager.getFromFile(i).then(n=>v(this,st,Go).call(this,n)).finally(()=>v(this,st,Vo).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Mo.supportedTypesStr;const s=this._uiManager._signal;m(this,Ti,new Promise(i=>{t.addEventListener("change",async()=>{if(t.files&&t.files.length!==0){this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),v(this,st,Go).call(this,n)}else this.remove();i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>v(this,st,Vo).call(this))),t.click()},$c=function(){const{div:t}=this;let{width:s,height:i}=a(this,Et);const[n,r]=this.pageDimensions,o=.75;if(this.width)s=this.width*n,i=this.height*r;else if(s>o*n||i>o*r){const p=Math.min(o*n/s,o*r/i);s*=p,i*=p}const[h,l]=this.parentDimensions;this.setDims(s*h/n,i*l/r),this._uiManager.enableWaiting(!1);const c=m(this,us,document.createElement("canvas"));c.setAttribute("role","img"),this.addContainer(c),this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(t.hidden=!1),v(this,st,Uc).call(this,s,i),v(this,st,gg).call(this),a(this,Gr)||(this.parent.addUndoableEditor(this),m(this,Gr,!0)),this._reportTelemetry({action:"inserted_image"}),a(this,Ur)&&c.setAttribute("aria-label",a(this,Ur))},pg=function(t,s){var r;const[i,n]=this.parentDimensions;this.width=t/i,this.height=s/n,(r=this._initialOptions)!=null&&r.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,a(this,ps)!==null&&clearTimeout(a(this,ps)),m(this,ps,setTimeout(()=>{m(this,ps,null),v(this,st,Uc).call(this,t,s)},200))},il=function(t,s){const{width:i,height:n}=a(this,Et);let r=i,o=n,h=a(this,Et);for(;r>2*t||o>2*s;){const l=r,c=o;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const p=new OffscreenCanvas(r,o);p.getContext("2d").drawImage(h,0,0,l,c,0,0,r,o),h=p.transferToImageBitmap()}return h},Uc=function(t,s){const i=new yl,n=Math.ceil(t*i.sx),r=Math.ceil(s*i.sy),o=a(this,us);if(!o||o.width===n&&o.height===r)return;o.width=n,o.height=r;const h=a(this,Se)?a(this,Et):v(this,st,il).call(this,n,r),l=o.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(h,0,0,h.width,h.height,0,0,n,r)},nl=function(t){if(t){if(a(this,Se)){const i=this._uiManager.imageManager.getSvgUrl(a(this,qt));if(i)return i}const s=document.createElement("canvas");return{width:s.width,height:s.height}=a(this,Et),s.getContext("2d").drawImage(a(this,Et),0,0),s.toDataURL()}if(a(this,Se)){const[s,i]=this.pageDimensions,n=Math.round(this.width*s*ti.PDF_TO_CSS_UNITS),r=Math.round(this.height*i*ti.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(n,r);return o.getContext("2d").drawImage(a(this,Et),0,0,a(this,Et).width,a(this,Et).height,0,0,n,r),o.transferToImageBitmap()}return structuredClone(a(this,Et))},gg=function(){this._uiManager._signal&&(m(this,Xs,new ResizeObserver(t=>{const s=t[0].contentRect;s.width&&s.height&&v(this,st,pg).call(this,s.width,s.height)})),a(this,Xs).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var t;(t=a(this,Xs))==null||t.disconnect(),m(this,Xs,null)},{once:!0}))},fg=function(t){var l;const{rect:s,pageIndex:i,accessibilityData:{altText:n}}=this._initialData,r=t.rect.every((c,p)=>Math.abs(c-s[p])<1),o=t.pageIndex===i,h=(((l=t.accessibilityData)==null?void 0:l.alt)||"")===n;return{isSame:r&&o&&h,isSameAltText:h}},Y(Mo,"_type","stamp"),Y(Mo,"_editorType",J.STAMP);let Vl=Mo;const Qe=class Qe{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:n,annotationLayer:r,drawLayer:o,textLayer:h,viewport:l,l10n:c}){A(this,Xt);A(this,jn);A(this,Vr,!1);A(this,gs,null);A(this,Mi,null);A(this,Ys,null);A(this,Ee,new Map);A(this,Ri,!1);A(this,Wr,!1);A(this,qr,!1);A(this,Zt,null);A(this,Ks,null);A(this,G);const p=[...a(Qe,Ii).values()];if(!Qe._initialized){Qe._initialized=!0;for(const u of p)u.initialize(c,e)}e.registerEditorTypes(p),m(this,G,e),this.pageIndex=t,this.div=s,m(this,jn,n),m(this,gs,r),this.viewport=l,m(this,Zt,h),this.drawLayer=o,this._structTree=i,a(this,G).addLayer(this)}get isEmpty(){return a(this,Ee).size===0}get isInvisible(){return this.isEmpty&&a(this,G).getMode()===J.NONE}updateToolbar(e){a(this,G).updateToolbar(e)}updateMode(e=a(this,G).getMode()){switch(v(this,Xt,rl).call(this),e){case J.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case J.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case J.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of a(Qe,Ii).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=a(this,Zt))==null?void 0:t.div)}addInkEditorIfNeeded(e){if(a(this,G).getMode()===J.INK){if(!e){for(const t of a(this,Ee).values())if(t.isEmpty()){t.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(e){a(this,G).setEditingState(e)}addCommands(e){a(this,G).addCommands(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=a(this,gs))==null||t.div.classList.toggle("disabled",!e)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of a(this,Ee).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(a(this,G).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!a(this,gs))return;const t=a(this,gs).getEditableAnnotations();for(const s of t){if(s.hide(),a(this,G).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}}disable(){var i;m(this,qr,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const n of a(this,Ee).values())n.disableEditing(),n.annotationElementId&&(n.serialize()===null?(t.set(n.annotationElementId,n),(i=this.getEditableAnnotation(n.annotationElementId))==null||i.show(),n.remove()):e.set(n.annotationElementId,n));if(a(this,gs)){const n=a(this,gs).getEditableAnnotations();for(const r of n){const{id:o}=r.data;if(a(this,G).isDeletedAnnotationElement(o))continue;let h=t.get(o);h?(h.resetAnnotationElement(r),h.show(!1),r.show()):(h=e.get(o),h&&(a(this,G).addChangedExistingAnnotation(h),h.renderAnnotationElement(r)&&h.show(!1)),r.show())}}v(this,Xt,rl).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const n of a(Qe,Ii).values())s.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),m(this,qr,!1)}getEditableAnnotation(e){var t;return((t=a(this,gs))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){a(this,G).getActive()!==e&&a(this,G).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,((e=a(this,Zt))==null?void 0:e.div)&&!a(this,Ks)){m(this,Ks,new AbortController);const t=a(this,G).combinedSignal(a(this,Ks));a(this,Zt).div.addEventListener("pointerdown",v(this,Xt,mg).bind(this),{signal:t}),a(this,Zt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=a(this,Zt))!=null&&e.div&&a(this,Ks)&&(a(this,Ks).abort(),m(this,Ks,null),a(this,Zt).div.classList.remove("highlighting"))}enableClick(){if(a(this,Mi))return;m(this,Mi,new AbortController);const e=a(this,G).combinedSignal(a(this,Mi));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:e})}disableClick(){var e;(e=a(this,Mi))==null||e.abort(),m(this,Mi,null)}attach(e){a(this,Ee).set(e.id,e);const{annotationElementId:t}=e;t&&a(this,G).isDeletedAnnotationElement(t)&&a(this,G).removeDeletedAnnotationElement(e)}detach(e){var t;a(this,Ee).delete(e.id),(t=a(this,jn))==null||t.removePointerInTextLayer(e.contentDiv),!a(this,qr)&&e.annotationElementId&&a(this,G).addDeletedAnnotationElement(e)}remove(e){this.detach(e),a(this,G).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1,a(this,Wr)||this.addInkEditorIfNeeded(!1)}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(a(this,G).addDeletedAnnotationElement(e.annotationElementId),lt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(e.parent!==this||!e.isAttachedToDOM){if(this.changeParent(e),a(this,G).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),a(this,G).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!a(this,Ys)&&(e._focusEventsAllowed=!1,m(this,Ys,setTimeout(()=>{m(this,Ys,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:a(this,G)._signal}),t.focus())},0))),e._structTreeParentId=(s=a(this,jn))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getNextId(){return a(this,G).getId()}combinedSignal(e){return a(this,G).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=a(this,Xt,Gc))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){a(this,G).updateToolbar(e),a(this,G).updateMode(e);const{offsetX:s,offsetY:i}=v(this,Xt,Wc).call(this),n=this.getNextId(),r=v(this,Xt,Vc).call(this,{parent:this,id:n,x:s,y:i,uiManager:a(this,G),isCentered:!0,...t});r&&this.add(r)}async deserialize(e){var t;return await((t=a(Qe,Ii).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,a(this,G)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),n=v(this,Xt,Vc).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:a(this,G),isCentered:t,...s});return n&&this.add(n),n}addNewEditor(){this.createAndAddNewEditor(v(this,Xt,Wc).call(this),!0)}setSelected(e){a(this,G).setSelected(e)}toggleSelected(e){a(this,G).toggleSelected(e)}unselect(e){a(this,G).unselect(e)}pointerup(e){const{isMac:t}=ee.platform;!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&a(this,Ri)&&(m(this,Ri,!1),a(this,Vr)?a(this,G).getMode()!==J.STAMP?this.createAndAddNewEditor(e,!1):a(this,G).unselectAll():m(this,Vr,!0))}pointerdown(e){if(a(this,G).getMode()===J.HIGHLIGHT&&this.enableTextSelection(),a(this,Ri)){m(this,Ri,!1);return}const{isMac:t}=ee.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;m(this,Ri,!0);const s=a(this,G).getActive();m(this,Vr,!s||s.isEmpty())}findNewParent(e,t,s){const i=a(this,G).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}destroy(){var e,t;((e=a(this,G).getActive())==null?void 0:e.parent)===this&&(a(this,G).commitOrRemove(),a(this,G).setActiveEditor(null)),a(this,Ys)&&(clearTimeout(a(this,Ys)),m(this,Ys,null));for(const s of a(this,Ee).values())(t=a(this,jn))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,a(this,Ee).clear(),a(this,G).removeLayer(this)}render({viewport:e}){this.viewport=e,Oi(this.div,e);for(const t of a(this,G).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){a(this,G).commitOrRemove(),v(this,Xt,rl).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Oi(this.div,{rotation:s}),t!==s)for(const i of a(this,Ee).values())i.rotate(s);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return a(this,G).viewParameters.realScale}};jn=new WeakMap,Vr=new WeakMap,gs=new WeakMap,Mi=new WeakMap,Ys=new WeakMap,Ee=new WeakMap,Ri=new WeakMap,Wr=new WeakMap,qr=new WeakMap,Zt=new WeakMap,Ks=new WeakMap,G=new WeakMap,Ii=new WeakMap,Xt=new WeakSet,mg=function(e){a(this,G).unselectAll();const{target:t}=e;if(t===a(this,Zt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&a(this,Zt).div.contains(t)){const{isMac:s}=ee.platform;if(e.button!==0||e.ctrlKey&&s)return;a(this,G).showAllEditors("highlight",!0,!0),a(this,Zt).div.classList.add("free"),this.toggleDrawing(),uh.startHighlighting(this,a(this,G).direction==="ltr",{target:a(this,Zt).div,x:e.x,y:e.y}),a(this,Zt).div.addEventListener("pointerup",()=>{a(this,Zt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:a(this,G)._signal}),e.preventDefault()}},Gc=function(){return a(Qe,Ii).get(a(this,G).getMode())},Vc=function(e){const t=a(this,Xt,Gc);return t?new t.prototype.constructor(e):null},Wc=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),n=Math.max(0,e),r=Math.max(0,t),o=(n+Math.min(window.innerWidth,e+s))/2-e,h=(r+Math.min(window.innerHeight,t+i))/2-t,[l,c]=this.viewport.rotation%180==0?[o,h]:[h,o];return{offsetX:l,offsetY:c}},rl=function(){m(this,Wr,!0);for(const e of a(this,Ee).values())e.isEmpty()&&e.remove();m(this,Wr,!1)},Y(Qe,"_initialized",!1),A(Qe,Ii,new Map([$l,Gl,Vl,uh].map(e=>[e._editorType,e])));let Wl=Qe;const Yt=class Yt{constructor({pageIndex:e}){A(this,zn);A(this,fs,null);A(this,Ro,0);A(this,It,new Map);A(this,Qs,new Map);this.pageIndex=e}setParent(e){if(a(this,fs)){if(a(this,fs)!==e){if(a(this,It).size>0)for(const t of a(this,It).values())t.remove(),e.append(t);m(this,fs,e)}}else m(this,fs,e)}static get _svgFactory(){return nt(this,"_svgFactory",new Hl)}draw(e,t,s,i=!1){const n=re(this,Ro)._++,r=v(this,zn,Xc).call(this,e.box);r.classList.add(...e.classNamesForDrawing);const o=Yt._svgFactory.createElement("defs");r.append(o);const h=Yt._svgFactory.createElement("path");o.append(h);const l=`path_p${this.pageIndex}_${n}`;h.setAttribute("id",l),h.setAttribute("d",e.toSVGPath()),i&&a(this,Qs).set(n,h);const c=v(this,zn,vg).call(this,o,l),p=Yt._svgFactory.createElement("use");return r.append(p),r.setAttribute("fill",t),r.setAttribute("fill-opacity",s),p.setAttribute("href",`#${l}`),a(this,It).set(n,r),{id:n,clipPathId:`url(#${c})`}}drawOutline(e){const t=re(this,Ro)._++,s=v(this,zn,Xc).call(this,e.box);s.classList.add(...e.classNamesForOutlining);const i=Yt._svgFactory.createElement("defs");s.append(i);const n=Yt._svgFactory.createElement("path");i.append(n);const r=`path_p${this.pageIndex}_${t}`;n.setAttribute("id",r),n.setAttribute("d",e.toSVGPath()),n.setAttribute("vector-effect","non-scaling-stroke");let o;if(e.mustRemoveSelfIntersections){const c=Yt._svgFactory.createElement("mask");i.append(c),o=`mask_p${this.pageIndex}_${t}`,c.setAttribute("id",o),c.setAttribute("maskUnits","objectBoundingBox");const p=Yt._svgFactory.createElement("rect");c.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const u=Yt._svgFactory.createElement("use");c.append(u),u.setAttribute("href",`#${r}`),u.setAttribute("stroke","none"),u.setAttribute("fill","black"),u.setAttribute("fill-rule","nonzero"),u.classList.add("mask")}const h=Yt._svgFactory.createElement("use");s.append(h),h.setAttribute("href",`#${r}`),o&&h.setAttribute("mask",`url(#${o})`);const l=h.cloneNode();return s.append(l),h.classList.add("mainOutline"),l.classList.add("secondaryOutline"),a(this,It).set(t,s),t}finalizeLine(e,t){const s=a(this,Qs).get(e);a(this,Qs).delete(e),this.updateBox(e,t.box),s.setAttribute("d",t.toSVGPath())}updateLine(e,t){a(this,It).get(e).firstChild.firstChild.setAttribute("d",t.toSVGPath())}updatePath(e,t){a(this,Qs).get(e).setAttribute("d",t.toSVGPath())}updateBox(e,t){var s;v(s=Yt,Io,qc).call(s,a(this,It).get(e),t)}show(e,t){a(this,It).get(e).classList.toggle("hidden",!t)}rotate(e,t){a(this,It).get(e).setAttribute("data-main-rotation",t)}changeColor(e,t){a(this,It).get(e).setAttribute("fill",t)}changeOpacity(e,t){a(this,It).get(e).setAttribute("fill-opacity",t)}addClass(e,t){a(this,It).get(e).classList.add(t)}removeClass(e,t){a(this,It).get(e).classList.remove(t)}getSVGRoot(e){return a(this,It).get(e)}remove(e){a(this,Qs).delete(e),a(this,fs)!==null&&(a(this,It).get(e).remove(),a(this,It).delete(e))}destroy(){m(this,fs,null);for(const e of a(this,It).values())e.remove();a(this,It).clear(),a(this,Qs).clear()}};fs=new WeakMap,Ro=new WeakMap,It=new WeakMap,Qs=new WeakMap,Io=new WeakSet,qc=function(e,{x:t=0,y:s=0,width:i=1,height:n=1}={}){const{style:r}=e;r.top=100*s+"%",r.left=100*t+"%",r.width=100*i+"%",r.height=100*n+"%"},zn=new WeakSet,Xc=function(e){var s;const t=Yt._svgFactory.create(1,1,!0);return a(this,fs).append(t),t.setAttribute("aria-hidden",!0),v(s=Yt,Io,qc).call(s,t,e),t},vg=function(e,t){const s=Yt._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const n=Yt._svgFactory.createElement("use");return s.append(n),n.setAttribute("href",`#${t}`),n.classList.add("clip"),i},A(Yt,Io);let ql=Yt;tu=W.AbortException,eu=W.AnnotationEditorLayer,su=W.AnnotationEditorParamsType,iu=W.AnnotationEditorType,nu=W.AnnotationEditorUIManager,ru=W.AnnotationLayer,au=W.AnnotationMode,ou=W.ColorPicker,hu=W.DOMSVGFactory,lu=W.DrawLayer,cu=W.FeatureTest,du=W.GlobalWorkerOptions,uu=W.ImageKind,pu=W.InvalidPDFException,gu=W.MissingPDFException,fu=W.OPS,mu=W.OutputScale,vu=W.PDFDataRangeTransport,bu=W.PDFDateString,Au=W.PDFWorker,yu=W.PasswordResponses,wu=W.PermissionFlag,xu=W.PixelsPerInch,_u=W.RenderingCancelledException,Su=W.TextLayer,Eu=W.UnexpectedResponseException,Cu=W.Util,Tu=W.VerbosityLevel,ku=W.XfaLayer,Mu=W.build,Ru=W.createValidAbsoluteUrl,Iu=W.fetchData,Pu=W.getDocument,Lu=W.getFilenameFromUrl,Du=W.getPdfFilenameFromUrl,Fu=W.getXfaPageViewport,Ou=W.isDataScheme,Nu=W.isPdfFile,Bu=W.noContextMenu,Hu=W.normalizeUnicode,ju=W.setLayerDimensions,zu=W.shadow,$u=W.version});export{tu as AbortException,eu as AnnotationEditorLayer,su as AnnotationEditorParamsType,iu as AnnotationEditorType,nu as AnnotationEditorUIManager,ru as AnnotationLayer,au as AnnotationMode,ou as ColorPicker,hu as DOMSVGFactory,lu as DrawLayer,cu as FeatureTest,du as GlobalWorkerOptions,uu as ImageKind,pu as InvalidPDFException,gu as MissingPDFException,fu as OPS,mu as OutputScale,vu as PDFDataRangeTransport,bu as PDFDateString,Au as PDFWorker,yu as PasswordResponses,wu as PermissionFlag,xu as PixelsPerInch,_u as RenderingCancelledException,Su as TextLayer,Eu as UnexpectedResponseException,Cu as Util,Tu as VerbosityLevel,ku as XfaLayer,Bm as __tla,Mu as build,Ru as createValidAbsoluteUrl,Iu as fetchData,Pu as getDocument,Lu as getFilenameFromUrl,Du as getPdfFilenameFromUrl,Fu as getXfaPageViewport,Ou as isDataScheme,Nu as isPdfFile,Bu as noContextMenu,Hu as normalizeUnicode,ju as setLayerDimensions,zu as shadow,$u as version};
