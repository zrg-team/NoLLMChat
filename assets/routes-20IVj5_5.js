const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/few_shot-D4kyqN5P.js","assets/index-BInN6O2M.js","assets/index-DbmpG02v.css","assets/dot-PqYHPLBe.js","assets/createLucideIcon-DXmj8ffa.js","assets/index-C4ZCpUfV.js","assets/pdf-DIU9JUyD.js","assets/pdf.min-CapCbGu3.js","assets/pdf.worker.min-DTwv-ugy.js","assets/index-BvUKr9zq.js","assets/objectWithoutPropertiesLoose-BjXSgPXB.js","assets/index-BqeDeBrk.js","assets/index-Cr8Tc6mT.css","assets/index-V6CS-75v.js","assets/use-prevent-pitch-zoom-BrEU6fQJ.js","assets/index-yWcVXzLD.js","assets/link-CFboNLxz.js","assets/trash-2-WvtMB-9d.js","assets/text-CjUV6306.js","assets/external-link-Dg4zP70l.js","assets/unlink-DlLxoEuz.js","assets/index-I_wwFMO5.js","assets/list-CLAw2Jqh.js","assets/list-ordered-4H_AtvyX.js","assets/list-todo-iaxb4bvP.js","assets/indent-increase-D0pE8XyI.js","assets/pilcrow-zmn25gc8.js","assets/heading-1-BR0K96Y9.js","assets/heading-2-BDQZKFjc.js","assets/heading-3-ClLGDF6u.js","assets/table-n41rTxfy.js","assets/file-code-DvqxLBXT.js","assets/quote-Bo7BnQ_v.js","assets/minus-BdkHbeCH.js","assets/square-W7hYP6YI.js","assets/chevron-right-CdCx99bd.js","assets/image-DWCh18tm.js","assets/table-of-contents-CIfs2Yh0.js","assets/columns-3-C8jmUQ99.js","assets/link-2-B1CumsyB.js","assets/calendar-BRTc43Uj.js","assets/plus-RUh5ochU.js","assets/wrap-text-CktTWHFN.js","assets/pen-Db1C8neG.js","assets/eye-BcOf-tPS.js","assets/indent-decrease-DFlG6y7V.js","assets/pointer-BUMuMRWo.js","assets/wand-sparkles-BecxnlSb.js","assets/bold-B2Wy5gPX.js","assets/italic-msxAN3bs.js","assets/underline-uQ33i5Gg.js","assets/strikethrough-C-U0jAj5.js","assets/code-xml-PVGSfVno.js","assets/baseline-D_B8_8gZ.js","assets/paint-bucket-BytTkgXD.js","assets/arrow-up-to-line-D3pApU3c.js","assets/index-BCYu3EnN.css","assets/index-D0mkdqkZ.js","assets/check-C5IvDee7.js","assets/circle-D952gVQJ.js","assets/index-BZvn4dEG.js","assets/index-HSnfLTSA.css","assets/CodeContainerApp-DMgoiVss.js","assets/DocumentViewer-C77eLLXN.js"])))=>i.map(i=>d[i]);
import{r as g,M as bN,j as h,u as Sg,P as oAe,a as wN,L as iAe,m as sAe,c as cAe,f as tK,i as lAe,b as xN,d as nK,e as uAe,g as dAe,_ as rK,h as aK,k as Cl,l as Eg,n as Ua,o as Bo,p as Nl,q as tn,R as pAe,s as er,t as Sn,v as Ae,w as ge,x as Mr,y as wt,z as Z,A as qa,S as zo,B as tr,D as Og,C as fAe,E as Cg,F as de,G as oK,H as hAe,I as Pe,J as Ap,K as Ye,N as Vo,O as Ha,Q as Xt,T as Qt,U as ue,V as Tp,W as iK,X as mAe,Y as yAe,Z as sK,$ as Ml,a0 as Pl,a1 as pa,a2 as ot,a3 as cK,a4 as U,a5 as kl,a6 as gAe,a7 as vAe,a8 as Ka,a9 as oe,aa as bAe,ab as Oi,ac as Ip,ad as Rp,ae as At,af as Pr,ag as wAe,ah as xAe,ai as _Ae,aj as jAe,ak as Dp,al as lK,am as SAe,an as EAe,ao as uK,ap as _N,aq as OAe,ar as CAe,as as dK,at as jN,au as NAe,av as pK,aw as MAe,ax as Ng,ay as PAe,az as kAe,aA as AAe,aB as fa,aC as fK,aD as TAe,aE as SN,aF as me,aG as Ci,aH as hK,aI as Wo,aJ as mK,aK as IAe,aL as yK,aM as RAe,aN as DAe,aO as LAe,aP as js,aQ as Mg,aR as Lp,aS as $Ae,aT as kr,aU as Pg,aV as FAe,aW as BAe,aX as EN,aY as Al,aZ as gK,a_ as zAe,a$ as VAe,b0 as WAe,b1 as UAe,b2 as qAe,b3 as Tl,b4 as HAe,b5 as KAe,b6 as vK,b7 as ZAe,b8 as XAe,b9 as QAe,ba as GAe,bb as bK,bc as ON,bd as xt,be as JAe,bf as CN,bg as YAe,bh as e2e,bi as t2e,__tla as n2e}from"./index-BInN6O2M.js";import wK,{__tla as r2e}from"./dot-PqYHPLBe.js";let Pt,NN,kg,MN,PN,Il,Ag,Rl,Ni,$p,Fp,Tg,kN,AN,Ss,TN,IN,RN,DN,Ig,LN,$N,Es,FN,BN,zN,VN,Rg,Dg,Lg,Dl,Ll,Mi,Pi,Bp,xK,$l,Os,Cs,_K,jK,$g,WN,UN,qN,SK,Fg,HN,Bg,KN,Za,EK,Uo,Fl,Bl,zg,Vg,Wg,Ug,qg,Hg,Kg,Zg,ZN,XN,zp,Xg,QN,Qg,GN,JN,OK,YN,Gg,CK,eM,tM,nM,Jg,rM,NK,Yg,ev,tv,aM,nv,rv,av,ov,iv,sv,oM,iM,zl,cv,lv,uv,dv,pv,fv,hv,Vp,mn,mv,sM,cM,Ns,qo,MK,Wp,yv,gv,Vl,Wl,PK,lM,nt,Ms,vv,bv,Vn,De,An,Tn,wv,xv,uM,dM,_v,jv,ut,pM,Sv,Ev,fM,hM,Ar,Ov,mM,yM,Ps,Tr,Cv,Nv,gM,ha,vM,Mv,Pv,bM,wM,xM,kv,In,Ul,Av,ql,ks,_M,a2e=Promise.all([(()=>{try{return n2e}catch{}})(),(()=>{try{return r2e}catch{}})()]).then(async()=>{class AK extends g.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function TK({children:e,isPresent:t}){const n=g.useId(),r=g.useRef(null),a=g.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=g.useContext(bN);return g.useInsertionEffect(()=>{const{width:i,height:s,top:c,left:l}=a.current;if(t||!r.current||!i||!s)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return o&&(u.nonce=o),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${c}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),h.jsx(AK,{isPresent:t,childRef:r,sizeRef:a,children:g.cloneElement(e,{ref:r})})}const IK=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:o,mode:i})=>{const s=Sg(RK),c=g.useId(),l=g.useCallback(d=>{s.set(d,!0);for(const p of s.values())if(!p)return;r&&r()},[s,r]),u=g.useMemo(()=>({id:c,initial:t,isPresent:n,custom:a,onExitComplete:l,register:d=>(s.set(d,!1),()=>s.delete(d))}),o?[Math.random(),l]:[n,l]);return g.useMemo(()=>{s.forEach((d,p)=>s.set(p,!1))},[n]),g.useEffect(()=>{!n&&!s.size&&r&&r()},[n]),i==="popLayout"&&(e=h.jsx(TK,{isPresent:n,children:e})),h.jsx(oAe.Provider,{value:u,children:e})};function RK(){return new Map}const Up=e=>e.key||"";function SM(e){const t=[];return g.Children.forEach(e,n=>{g.isValidElement(n)&&t.push(n)}),t}const DK=({children:e,exitBeforeEnter:t,custom:n,initial:r=!0,onExitComplete:a,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const s=g.useMemo(()=>SM(e),[e]),c=s.map(Up),l=g.useRef(!0),u=g.useRef(s),d=Sg(()=>new Map),[p,f]=g.useState(s),[y,m]=g.useState(s);wN(()=>{l.current=!1,u.current=s;for(let w=0;w<y.length;w++){const _=Up(y[w]);c.includes(_)?d.delete(_):d.get(_)!==!0&&d.set(_,!1)}},[y,c.length,c.join("-")]);const v=[];if(s!==p){let w=[...s];for(let _=0;_<y.length;_++){const x=y[_],j=Up(x);c.includes(j)||(w.splice(_,0,x),v.push(x))}i==="wait"&&v.length&&(w=v),m(SM(w)),f(s);return}const{forceRender:b}=g.useContext(iAe);return h.jsx(h.Fragment,{children:y.map(w=>{const _=Up(w),x=s===y||c.includes(_),j=()=>{if(d.has(_))d.set(_,!0);else return;let S=!0;d.forEach(E=>{E||(S=!1)}),S&&(b==null||b(),m(u.current),a&&a())};return h.jsx(IK,{isPresent:x,initial:!l.current||r?void 0:!1,custom:x?void 0:n,presenceAffectsLayout:o,mode:i,onExitComplete:x?void 0:j,children:w},_)})})};function Tv(e){const t=Sg(()=>sAe(e)),{isStatic:n}=g.useContext(bN);if(n){const[,r]=g.useState(e);g.useEffect(()=>t.on("change",r),[])}return t}function EM(e,t){const n=Tv(t()),r=()=>n.set(t());return r(),wN(()=>{const a=()=>tK.preRender(r,!1,!0),o=e.map(i=>i.on("change",a));return()=>{o.forEach(i=>i()),cAe(r)}}),n}const LK=e=>e&&typeof e=="object"&&e.mix,$K=e=>LK(e)?e.mix:void 0;function FK(...e){const t=!Array.isArray(e[0]),n=t?0:-1,r=e[0+n],a=e[1+n],o=e[2+n],i=e[3+n],s=lAe(a,o,{mixer:$K(o[0]),...i});return t?s(r):s}function BK(e){xN.current=[],e();const t=EM(xN.current,e);return xN.current=void 0,t}function OM(e,t,n,r){if(typeof e=="function")return BK(e);const a=typeof t=="function"?t:FK(t,n,r);return Array.isArray(e)?CM(e,a):CM([e],([o])=>a(o))}function CM(e,t){const n=Sg(()=>[]);return EM(e,()=>{n.length=0;const r=e.length;for(let a=0;a<r;a++)n[a]=e[a].get();return t(n)})}function NM(e){return typeof e=="number"?e:parseFloat(e)}function zK(e,t={}){const{isStatic:n}=g.useContext(bN),r=g.useRef(null),a=Tv(nK(e)?NM(e.get()):e),o=g.useRef(a.get()),i=g.useRef(()=>{}),s=()=>{const l=r.current;l&&l.time===0&&l.sample(uAe.delta),c(),r.current=dAe({keyframes:[a.get(),o.current],velocity:a.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:i.current})},c=()=>{r.current&&r.current.stop()};return g.useInsertionEffect(()=>a.attach((l,u)=>n?u(l):(o.current=l,i.current=u,tK.update(s),a.get()),c),[JSON.stringify(t)]),wN(()=>{if(nK(e))return e.on("change",l=>a.set(NM(l)))},[a]),a}var Qe=(e=>(e.Started="started",e.Downloading="downloading",e.Downloaded="downloaded",e.Loading="loading",e.Loaded="loaded",e))(Qe||{}),Hl=(e=>(e.LLM="LLM",e.embedding="embedding",e.VLM="VLM",e))(Hl||{}),ln=(e=>(e.WebLLM="WebLLM",e.OpenAI="OpenAI",e))(ln||{}),Ir=(e=>(e.Started="started",e.Inprogress="inprogress",e.Success="success",e.Failed="failed",e))(Ir||{}),nr=(e=>(e.Human="human",e.User="user",e.AI="ai",e.System="system",e.Assistant="assistant",e.Tool="tool",e.FewShotExample="few_shot_example",e))(nr||{}),qp=(e=>(e.Started="started",e.Inprogress="inprogress",e.Done="done",e))(qp||{}),rr=(e=>(e.Chat="chat",e.FewShotExample="few_shot_example",e))(rr||{}),As=(e=>(e.VECTOR_DATABASE_RETREIVER="VECTOR_DATABASE_RETREIVER",e))(As||{});function MM(e,t,n,r,a){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=rK(t),i=rK(e),s=!1,c=i.length-1;c>=0;c--){var l=i[c],u=e[l];if(aK(t,l)&&!(t[l]===void 0&&u!==void 0&&Array.isArray(t)===!1)){var d=t[l];typeof u=="object"&&u!=null&&typeof d=="object"&&d!=null&&Array.isArray(u)===Array.isArray(d)?MM(u,d,n,r+"/"+Cl(l),a):u!==d&&(a&&n.push({op:"test",path:r+"/"+Cl(l),value:Eg(u)}),n.push({op:"replace",path:r+"/"+Cl(l),value:Eg(d)}))}else Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+Cl(l),value:Eg(u)}),n.push({op:"remove",path:r+"/"+Cl(l)}),s=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&o.length==i.length))for(var c=0;c<o.length;c++){var l=o[c];!aK(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+Cl(l),value:Eg(t[l])})}}}function VK(e,t,n=!1){var r=[];return MM(e,t,r,"",n),r}let PM,kM;PM=async(e,t)=>{let n="",r="",a;const o=[];await e;for await(const i of e)i&&(Array.isArray(i)?(o.push(...i.map(s=>s.content)),o!=null&&o.length&&(r=o.join(""),t==null||t({chunk:i,content:r}))):(n=typeof i=="object"&&"content"in i?`${i.content}`:`${i}`,t==null||t({chunk:i,content:n})),a=i);return{lastChunk:a,content:n}},kM=()=>{const e=Ua(a=>a.toolsCallingStream),t=Ua(a=>a.structuredStream),n=Ua(a=>a.stream),r=Ua(a=>a.getCurrentModelInfo);return{stream:g.useCallback(async(a,o)=>{var f;const{tools:i,schemas:s,onMessageUpdate:c,onMessageFinish:l}=o||{};let u;if(!await r())throw new Error("Model is not found");if(s!=null&&s.length?(s&&(s==null?void 0:s.length)>1&&Bo("Multiple schemas are not supported. Only the first schema will be used."),u=t(((f=s==null?void 0:s[0])==null?void 0:f.schema_items)||[],a)):i!=null&&i.length?u=e(i,a):u=n(a),!u)throw new Error("Stream is not supported");const{lastChunk:d,content:p}=await PM(u,c);return l==null||l({content:p,lastChunk:d}),{lastChunk:d,content:p}},[r,n,t,e])}},Ag=globalThis||void 0||self;var Kl={},AM;function WK(){if(AM)return Kl;AM=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.parse=i,Kl.serialize=l;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const p=function(){};return p.prototype=Object.create(null),p})();function i(p,f){const y=new o,m=p.length;if(m<2)return y;const v=(f==null?void 0:f.decode)||u;let b=0;do{const w=p.indexOf("=",b);if(w===-1)break;const _=p.indexOf(";",b),x=_===-1?m:_;if(w>x){b=p.lastIndexOf(";",w-1)+1;continue}const j=s(p,b,w),S=c(p,w,j),E=p.slice(j,S);if(y[E]===void 0){let O=s(p,w+1,x),N=c(p,x,O);const M=v(p.slice(O,N));y[E]=M}b=x+1}while(b<m);return y}function s(p,f,y){do{const m=p.charCodeAt(f);if(m!==32&&m!==9)return f}while(++f<y);return y}function c(p,f,y){for(;f>y;){const m=p.charCodeAt(--f);if(m!==32&&m!==9)return f+1}return y}function l(p,f,y){const m=(y==null?void 0:y.encode)||encodeURIComponent;if(!e.test(p))throw new TypeError(`argument name is invalid: ${p}`);const v=m(f);if(!t.test(v))throw new TypeError(`argument val is invalid: ${f}`);let b=p+"="+v;if(!y)return b;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);b+="; Max-Age="+y.maxAge}if(y.domain){if(!n.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);b+="; Domain="+y.domain}if(y.path){if(!r.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);b+="; Path="+y.path}if(y.expires){if(!d(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);b+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(b+="; HttpOnly"),y.secure&&(b+="; Secure"),y.partitioned&&(b+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return b}function u(p){if(p.indexOf("%")===-1)return p;try{return decodeURIComponent(p)}catch{return p}}function d(p){return a.call(p)==="[object Date]"}return Kl}WK();var TM="popstate";function UK(e={}){function t(r,a){let{pathname:o,search:i,hash:s}=r.location;return Ts("",{pathname:o,search:i,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Xa(a)}return RM(t,n,null,e)}function qK(e={}){function t(a,o){let{pathname:i="/",search:s="",hash:c=""}=Qa(a.location.hash.substring(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),Ts("",{pathname:i,search:s,hash:c},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(a,o){let i=a.document.querySelector("base"),s="";if(i&&i.getAttribute("href")){let c=a.location.href,l=c.indexOf("#");s=l===-1?c:c.slice(0,l)}return s+"#"+(typeof o=="string"?o:Xa(o))}function r(a,o){nn(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return RM(t,n,r,e)}function Xe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function nn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function HK(){return Math.random().toString(36).substring(2,10)}function IM(e,t){return{usr:e.state,key:e.key,idx:t}}function Ts(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Qa(t):t,state:n,key:t&&t.key||r||HK()}}function Xa({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Qa(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function RM(e,t,n,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,i=a.history,s="POP",c=null,l=u();l==null&&(l=0,i.replaceState({...i.state,idx:l},""));function u(){return(i.state||{idx:null}).idx}function d(){s="POP";let v=u(),b=v==null?null:v-l;l=v,c&&c({action:s,location:m.location,delta:b})}function p(v,b){s="PUSH";let w=Ts(m.location,v,b);n&&n(w,v),l=u()+1;let _=IM(w,l),x=m.createHref(w);try{i.pushState(_,"",x)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(x)}o&&c&&c({action:s,location:m.location,delta:1})}function f(v,b){s="REPLACE";let w=Ts(m.location,v,b);n&&n(w,v),l=u();let _=IM(w,l),x=m.createHref(w);i.replaceState(_,"",x),o&&c&&c({action:s,location:m.location,delta:0})}function y(v){let b=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof v=="string"?v:Xa(v);return w=w.replace(/ $/,"%20"),Xe(b,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,b)}let m={get action(){return s},get location(){return e(a,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(TM,d),c=v,()=>{a.removeEventListener(TM,d),c=null}},createHref(v){return t(a,v)},createURL:y,encodeLocation(v){let b=y(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:f,go(v){return i.go(v)}};return m}var KK=new Set(["lazy","caseSensitive","path","id","index","children"]);function ZK(e){return e.index===!0}function Hp(e,t,n=[],r={}){return e.map((a,o)=>{let i=[...n,String(o)],s=typeof a.id=="string"?a.id:i.join("-");if(Xe(a.index!==!0||!a.children,"Cannot specify children on an index route"),Xe(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),ZK(a)){let c={...a,...t(a),id:s};return r[s]=c,c}else{let c={...a,...t(a),id:s,children:void 0};return r[s]=c,a.children&&(c.children=Hp(a.children,t,i,r)),c}})}function Ho(e,t,n="/"){return Kp(e,t,n,!1)}function Kp(e,t,n,r){let a=typeof t=="string"?Qa(t):t,o=Rr(a.pathname||"/",n);if(o==null)return null;let i=DM(e);QK(i);let s=null;for(let c=0;s==null&&c<i.length;++c){let l=sZ(o);s=oZ(i[c],l,r)}return s}function XK(e,t){let{route:n,pathname:r,params:a}=e;return{id:n.id,pathname:r,params:a,data:t[n.id],handle:n.handle}}function DM(e,t=[],n=[],r=""){let a=(o,i,s)=>{let c={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(Xe(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let l=ma([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(Xe(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),DM(o.children,t,u,l)),!(o.path==null&&!o.index)&&t.push({path:l,score:rZ(l,o.index),routesMeta:u})};return e.forEach((o,i)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))a(o,i);else for(let c of LM(o.path))a(o,i,c)}),t}function LM(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let i=LM(r.join("/")),s=[];return s.push(...i.map(c=>c===""?o:[o,c].join("/"))),a&&s.push(...i),s.map(c=>e.startsWith("/")&&c===""?"/":c)}function QK(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:aZ(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var GK=/^:[\w-]+$/,JK=3,YK=2,eZ=1,tZ=10,nZ=-2,$M=e=>e==="*";function rZ(e,t){let n=e.split("/"),r=n.length;return n.some($M)&&(r+=nZ),t&&(r+=YK),n.filter(a=>!$M(a)).reduce((a,o)=>a+(GK.test(o)?JK:o===""?eZ:tZ),r)}function aZ(e,t){return e.length===t.length&&e.slice(0,-1).every((n,r)=>n===t[r])?e[e.length-1]-t[t.length-1]:0}function oZ(e,t,n=!1){let{routesMeta:r}=e,a={},o="/",i=[];for(let s=0;s<r.length;++s){let c=r[s],l=s===r.length-1,u=o==="/"?t:t.slice(o.length)||"/",d=Zp({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),p=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=Zp({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:ma([o,d.pathname]),pathnameBase:uZ(ma([o,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(o=ma([o,d.pathnameBase]))}return i}function Zp(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=iZ(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((c,{paramName:l,isOptional:u},d)=>{if(l==="*"){let f=s[d]||"";i=o.slice(0,o.length-f.length).replace(/(.)\/+$/,"$1")}const p=s[d];return u&&!p?c[l]=void 0:c[l]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:i,pattern:e}}function iZ(e,t=!1,n=!0){nn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,i,s)=>(r.push({paramName:i,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function sZ(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return nn(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Rr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function cZ(e,t="/"){let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?Qa(e):e;return{pathname:n?n.startsWith("/")?n:lZ(n,t):t,search:dZ(r),hash:pZ(a)}}function lZ(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Iv(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function FM(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Xp(e){let t=FM(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function Qp(e,t,n,r=!1){let a;typeof e=="string"?a=Qa(e):(a={...e},Xe(!a.pathname||!a.pathname.includes("?"),Iv("?","pathname","search",a)),Xe(!a.pathname||!a.pathname.includes("#"),Iv("#","pathname","hash",a)),Xe(!a.search||!a.search.includes("#"),Iv("#","search","hash",a)));let o=e===""||a.pathname==="",i=o?"/":a.pathname,s;if(i==null)s=n;else{let d=t.length-1;if(!r&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),d-=1;a.pathname=p.join("/")}s=d>=0?t[d]:"/"}let c=cZ(a,s),l=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}var ma=e=>e.join("/").replace(/\/\/+/g,"/"),uZ=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),dZ=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,pZ=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Gp=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function Jp(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var BM=["POST","PUT","PATCH","DELETE"],fZ=new Set(BM),hZ=["GET",...BM],mZ=new Set(hZ),yZ=new Set([301,302,303,307,308]),gZ=new Set([307,308]),Rv={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},vZ={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Zl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Dv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bZ=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),zM="remix-router-transitions",VM=Symbol("ResetLoaderData");function WM(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";Xe(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.mapRouteProperties||bZ,a={},o=Hp(e.routes,r,void 0,a),i,s=e.basename||"/",c=e.dataStrategy||SZ,l=e.patchRoutesOnNavigation,u={...e.future},d=null,p=new Set,f=null,y=null,m=null,v=e.hydrationData!=null,b=Ho(o,e.history.location,s),w=null;if(b==null&&!l){let W=yr(404,{pathname:e.history.location.pathname}),{matches:ee,route:ae}=tP(o);b=ee,w={[ae.id]:W}}b&&!e.hydrationData&&Oe(b,o,e.history.location.pathname).active&&(b=null);let _;if(b)if(b.some(W=>W.route.lazy))_=!1;else if(!b.some(W=>W.route.loader))_=!0;else{let W=e.hydrationData?e.hydrationData.loaderData:null,ee=e.hydrationData?e.hydrationData.errors:null;if(ee){let ae=b.findIndex(pe=>ee[pe.route.id]!==void 0);_=b.slice(0,ae+1).every(pe=>!$v(pe.route,W,ee))}else _=b.every(ae=>!$v(ae.route,W,ee))}else{_=!1,b=[];let W=Oe(null,o,e.history.location.pathname);W.active&&W.matches&&(b=W.matches)}let x,j={historyAction:e.history.action,location:e.history.location,matches:b,initialized:_,navigation:Rv,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||w,fetchers:new Map,blockers:new Map},S="POP",E=!1,O,N=!1,M=new Map,P=null,I=!1,k=!1,C=new Set,T=new Map,A=0,R=-1,L=new Map,D=new Set,B=new Map,F=new Map,$=new Set,V=new Map,Q,X=null;function H(){if(d=e.history.listen(({action:W,location:ee,delta:ae})=>{if(Q){Q(),Q=void 0;return}nn(V.size===0||ae!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let pe=Wt({currentLocation:j.location,nextLocation:ee,historyAction:W});if(pe&&ae!=null){let Ne=new Promise(Re=>{Q=Re});e.history.go(ae*-1),Te(pe,{state:"blocked",location:ee,proceed(){Te(pe,{state:"proceeding",proceed:void 0,reset:void 0,location:ee}),Ne.then(()=>e.history.go(ae))},reset(){let Re=new Map(j.blockers);Re.set(pe,Zl),q({blockers:Re})}});return}return se(W,ee)}),n){RZ(t,M);let W=()=>DZ(t,M);t.addEventListener("pagehide",W),P=()=>t.removeEventListener("pagehide",W)}return j.initialized||se("POP",j.location,{initialHydration:!0}),x}function J(){d&&d(),P&&P(),p.clear(),O&&O.abort(),j.fetchers.forEach((W,ee)=>Qn(ee)),j.blockers.forEach((W,ee)=>he(ee))}function K(W){return p.add(W),()=>p.delete(W)}function q(W,ee={}){j={...j,...W};let ae=[],pe=[];j.fetchers.forEach((Ne,Re)=>{Ne.state==="idle"&&($.has(Re)?ae.push(Re):pe.push(Re))}),[...p].forEach(Ne=>Ne(j,{deletedFetchers:ae,viewTransitionOpts:ee.viewTransitionOpts,flushSync:ee.flushSync===!0})),ae.forEach(Ne=>Qn(Ne)),pe.forEach(Ne=>j.fetchers.delete(Ne))}function G(W,ee,{flushSync:ae}={}){var we,ze;let pe=j.actionData!=null&&j.navigation.formMethod!=null&&Dr(j.navigation.formMethod)&&j.navigation.state==="loading"&&((we=W.state)==null?void 0:we._isRedirect)!==!0,Ne;ee.actionData?Object.keys(ee.actionData).length>0?Ne=ee.actionData:Ne=null:pe?Ne=j.actionData:Ne=null;let Re=ee.loaderData?YM(j.loaderData,ee.loaderData,ee.matches||[],ee.errors):j.loaderData,Be=j.blockers;Be.size>0&&(Be=new Map(Be),Be.forEach((Je,kt)=>Be.set(kt,Zl)));let Me=E===!0||j.navigation.formMethod!=null&&Dr(j.navigation.formMethod)&&((ze=W.state)==null?void 0:ze._isRedirect)!==!0;i&&(o=i,i=void 0),I||S==="POP"||(S==="PUSH"?e.history.push(W,W.state):S==="REPLACE"&&e.history.replace(W,W.state));let ke;if(S==="POP"){let Je=M.get(j.location.pathname);Je&&Je.has(W.pathname)?ke={currentLocation:j.location,nextLocation:W}:M.has(W.pathname)&&(ke={currentLocation:W,nextLocation:j.location})}else if(N){let Je=M.get(j.location.pathname);Je?Je.add(W.pathname):(Je=new Set([W.pathname]),M.set(j.location.pathname,Je)),ke={currentLocation:j.location,nextLocation:W}}q({...ee,actionData:Ne,loaderData:Re,historyAction:S,location:W,initialized:!0,navigation:Rv,revalidation:"idle",restoreScrollPosition:Ee(W,ee.matches||j.matches),preventScrollReset:Me,blockers:Be},{viewTransitionOpts:ke,flushSync:ae===!0}),S="POP",E=!1,N=!1,I=!1,k=!1,X==null||X.resolve(),X=null}async function ne(W,ee){if(typeof W=="number"){e.history.go(W);return}let ae=Lv(j.location,j.matches,s,W,ee==null?void 0:ee.fromRouteId,ee==null?void 0:ee.relative),{path:pe,submission:Ne,error:Re}=UM(!1,ae,ee),Be=j.location,Me=Ts(j.location,pe,ee&&ee.state);Me={...Me,...e.history.encodeLocation(Me)};let ke=ee&&ee.replace!=null?ee.replace:void 0,we="PUSH";ke===!0?we="REPLACE":ke===!1||Ne!=null&&Dr(Ne.formMethod)&&Ne.formAction===j.location.pathname+j.location.search&&(we="REPLACE");let ze=ee&&"preventScrollReset"in ee?ee.preventScrollReset===!0:void 0,Je=(ee&&ee.flushSync)===!0,kt=Wt({currentLocation:Be,nextLocation:Me,historyAction:we});if(kt){Te(kt,{state:"blocked",location:Me,proceed(){Te(kt,{state:"proceeding",proceed:void 0,reset:void 0,location:Me}),ne(W,ee)},reset(){let Lt=new Map(j.blockers);Lt.set(kt,Zl),q({blockers:Lt})}});return}await se(we,Me,{submission:Ne,pendingError:Re,preventScrollReset:ze,replace:ee&&ee.replace,enableViewTransition:ee&&ee.viewTransition,flushSync:Je})}function z(){X||(X=LZ()),st(),q({revalidation:"loading"});let W=X.promise;return j.navigation.state==="submitting"?W:j.navigation.state==="idle"?(se(j.historyAction,j.location,{startUninterruptedRevalidation:!0}),W):(se(S||j.historyAction,j.navigation.location,{overrideNavigation:j.navigation,enableViewTransition:N===!0}),W)}async function se(W,ee,ae){O&&O.abort(),O=null,S=W,I=(ae&&ae.startUninterruptedRevalidation)===!0,_e(j.location,j.matches),E=(ae&&ae.preventScrollReset)===!0,N=(ae&&ae.enableViewTransition)===!0;let pe=i||o,Ne=ae&&ae.overrideNavigation,Re=Ho(pe,ee,s),Be=(ae&&ae.flushSync)===!0,Me=Oe(Re,pe,ee.pathname);if(Me.active&&Me.matches&&(Re=Me.matches),!Re){let{error:at,notFoundMatches:Jn,route:Kt}=Dt(ee.pathname);G(ee,{matches:Jn,loaderData:{},errors:{[Kt.id]:at}},{flushSync:Be});return}if(j.initialized&&!k&&PZ(j.location,ee)&&!(ae&&ae.submission&&Dr(ae.submission.formMethod))){G(ee,{matches:Re},{flushSync:Be});return}O=new AbortController;let ke=Is(e.history,ee,O.signal,ae&&ae.submission),we;if(ae&&ae.pendingError)we=[ki(Re).route.id,{type:"error",error:ae.pendingError}];else if(ae&&ae.submission&&Dr(ae.submission.formMethod)){let at=await re(ke,ee,ae.submission,Re,Me.active,{replace:ae.replace,flushSync:Be});if(at.shortCircuited)return;if(at.pendingActionResult){let[Jn,Kt]=at.pendingActionResult;if(ar(Kt)&&Jp(Kt.error)&&Kt.error.status===404){O=null,G(ee,{matches:at.matches,loaderData:{},errors:{[Jn]:Kt.error}});return}}Re=at.matches||Re,we=at.pendingActionResult,Ne=zv(ee,ae.submission),Be=!1,Me.active=!1,ke=Is(e.history,ke.url,ke.signal)}let{shortCircuited:ze,matches:Je,loaderData:kt,errors:Lt}=await le(ke,ee,Re,Me.active,Ne,ae&&ae.submission,ae&&ae.fetcherSubmission,ae&&ae.replace,ae&&ae.initialHydration===!0,Be,we);ze||(O=null,G(ee,{matches:Je||Re,...eP(we),loaderData:kt,errors:Lt}))}async function re(W,ee,ae,pe,Ne,Re={}){st();let Be=TZ(ee,ae);if(q({navigation:Be},{flushSync:Re.flushSync===!0}),Ne){let we=await We(pe,ee.pathname,W.signal);if(we.type==="aborted")return{shortCircuited:!0};if(we.type==="error"){let ze=ki(we.partialMatches).route.id;return{matches:we.partialMatches,pendingActionResult:[ze,{type:"error",error:we.error}]}}else if(we.matches)pe=we.matches;else{let{notFoundMatches:ze,error:Je,route:kt}=Dt(ee.pathname);return{matches:ze,pendingActionResult:[kt.id,{type:"error",error:Je}]}}}let Me,ke=Xl(pe,ee);if(!ke.route.action&&!ke.route.lazy)Me={type:"error",error:yr(405,{method:W.method,pathname:ee.pathname,routeId:ke.route.id})};else if(Me=(await qe("action",j,W,[ke],pe,null))[ke.route.id],W.signal.aborted)return{shortCircuited:!0};if(Ai(Me)){let we;return Re&&Re.replace!=null?we=Re.replace:we=QM(Me.response.headers.get("Location"),new URL(W.url),s)===j.location.pathname+j.location.search,await Ue(W,Me,!0,{submission:ae,replace:we}),{shortCircuited:!0}}if(ar(Me)){let we=ki(pe,ke.route.id);return(Re&&Re.replace)!==!0&&(S="PUSH"),{matches:pe,pendingActionResult:[we.route.id,Me]}}return{matches:pe,pendingActionResult:[ke.route.id,Me]}}async function le(W,ee,ae,pe,Ne,Re,Be,Me,ke,we,ze){let Je=Ne||zv(ee,Re),kt=Re||Be||oP(Je),Lt=!I&&!ke;if(pe){if(Lt){let Yn=je(ze);q({navigation:Je,...Yn!==void 0?{actionData:Yn}:{}},{flushSync:we})}let ft=await We(ae,ee.pathname,W.signal);if(ft.type==="aborted")return{shortCircuited:!0};if(ft.type==="error"){let Yn=ki(ft.partialMatches).route.id;return{matches:ft.partialMatches,loaderData:{},errors:{[Yn]:ft.error}}}else if(ft.matches)ae=ft.matches;else{let{error:Yn,notFoundMatches:_s,route:zt}=Dt(ee.pathname);return{matches:_s,loaderData:{},errors:{[zt.id]:Yn}}}}let at=i||o,[Jn,Kt]=HM(e.history,j,ae,kt,ee,ke===!0,k,C,$,B,D,at,s,ze);if(R=++A,Jn.length===0&&Kt.length===0){let ft=Y();return G(ee,{matches:ae,loaderData:{},errors:ze&&ar(ze[1])?{[ze[0]]:ze[1].error}:null,...eP(ze),...ft?{fetchers:new Map(j.fetchers)}:{}},{flushSync:we}),{shortCircuited:!0}}if(Lt){let ft={};if(!pe){ft.navigation=Je;let Yn=je(ze);Yn!==void 0&&(ft.actionData=Yn)}Kt.length>0&&(ft.fetchers=Le(Kt)),q(ft,{flushSync:we})}Kt.forEach(ft=>{Gn(ft.key),ft.controller&&T.set(ft.key,ft.controller)});let xs=()=>Kt.forEach(ft=>Gn(ft.key));O&&O.signal.addEventListener("abort",xs);let{loaderResults:da,fetcherResults:Ei}=await Mt(j,ae,Jn,Kt,W);if(W.signal.aborted)return{shortCircuited:!0};O&&O.signal.removeEventListener("abort",xs),Kt.forEach(ft=>T.delete(ft.key));let Wa=Yp(da);if(Wa)return await Ue(W,Wa.result,!0,{replace:Me}),{shortCircuited:!0};if(Wa=Yp(Ei),Wa)return D.add(Wa.key),await Ue(W,Wa.result,!0,{replace:Me}),{shortCircuited:!0};let{loaderData:kp,errors:Nr}=JM(j,ae,da,ze,Kt,Ei);ke&&j.errors&&(Nr={...j.errors,...Nr});let Sl=Y(),El=te(R),Ol=Sl||El||Kt.length>0;return{matches:ae,loaderData:kp,errors:Nr,...Ol?{fetchers:new Map(j.fetchers)}:{}}}function je(W){if(W&&!ar(W[1]))return{[W[0]]:W[1].data};if(j.actionData)return Object.keys(j.actionData).length===0?null:j.actionData}function Le(W){return W.forEach(ee=>{let ae=j.fetchers.get(ee.key),pe=Ql(void 0,ae?ae.data:void 0);j.fetchers.set(ee.key,pe)}),new Map(j.fetchers)}async function $e(W,ee,ae,pe){Gn(W);let Ne=(pe&&pe.flushSync)===!0,Re=i||o,Be=Lv(j.location,j.matches,s,ae,ee,pe==null?void 0:pe.relative),Me=Ho(Re,Be,s),ke=Oe(Me,Re,Be);if(ke.active&&ke.matches&&(Me=ke.matches),!Me){bt(W,ee,yr(404,{pathname:Be}),{flushSync:Ne});return}let{path:we,submission:ze,error:Je}=UM(!0,Be,pe);if(Je){bt(W,ee,Je,{flushSync:Ne});return}let kt=Xl(Me,we),Lt=(pe&&pe.preventScrollReset)===!0;if(ze&&Dr(ze.formMethod)){await Se(W,ee,we,kt,Me,ke.active,Ne,Lt,ze);return}B.set(W,{routeId:ee,path:we}),await Ve(W,ee,we,kt,Me,ke.active,Ne,Lt,ze)}async function Se(W,ee,ae,pe,Ne,Re,Be,Me,ke){st(),B.delete(W);function we(zt){if(!zt.route.action&&!zt.route.lazy){let Fo=yr(405,{method:ke.formMethod,pathname:ae,routeId:ee});return bt(W,ee,Fo,{flushSync:Be}),!0}return!1}if(!Re&&we(pe))return;let ze=j.fetchers.get(W);rt(W,IZ(ke,ze),{flushSync:Be});let Je=new AbortController,kt=Is(e.history,ae,Je.signal,ke);if(Re){let zt=await We(Ne,ae,kt.signal);if(zt.type==="aborted")return;if(zt.type==="error"){bt(W,ee,zt.error,{flushSync:Be});return}else if(zt.matches){if(Ne=zt.matches,pe=Xl(Ne,ae),we(pe))return}else{bt(W,ee,yr(404,{pathname:ae}),{flushSync:Be});return}}T.set(W,Je);let Lt=A,at=(await qe("action",j,kt,[pe],Ne,W))[pe.route.id];if(kt.signal.aborted){T.get(W)===Je&&T.delete(W);return}if($.has(W)){if(Ai(at)||ar(at)){rt(W,Ko(void 0));return}}else{if(Ai(at))if(T.delete(W),R>Lt){rt(W,Ko(void 0));return}else return D.add(W),rt(W,Ql(ke)),Ue(kt,at,!1,{fetcherSubmission:ke,preventScrollReset:Me});if(ar(at)){bt(W,ee,at.error);return}}let Jn=j.navigation.location||j.location,Kt=Is(e.history,Jn,Je.signal),xs=i||o,da=j.navigation.state!=="idle"?Ho(xs,j.navigation.location,s):j.matches;Xe(da,"Didn't find any matches after fetcher action");let Ei=++A;L.set(W,Ei);let Wa=Ql(ke,at.data);j.fetchers.set(W,Wa);let[kp,Nr]=HM(e.history,j,da,ke,Jn,!1,k,C,$,B,D,xs,s,[pe.route.id,at]);Nr.filter(zt=>zt.key!==W).forEach(zt=>{let Fo=zt.key,jg=j.fetchers.get(Fo),gN=Ql(void 0,jg?jg.data:void 0);j.fetchers.set(Fo,gN),Gn(Fo),zt.controller&&T.set(Fo,zt.controller)}),q({fetchers:new Map(j.fetchers)});let Sl=()=>Nr.forEach(zt=>Gn(zt.key));Je.signal.addEventListener("abort",Sl);let{loaderResults:El,fetcherResults:Ol}=await Mt(j,da,kp,Nr,Kt);if(Je.signal.aborted)return;Je.signal.removeEventListener("abort",Sl),L.delete(W),T.delete(W),Nr.forEach(zt=>T.delete(zt.key));let ft=Yp(El);if(ft)return Ue(Kt,ft.result,!1,{preventScrollReset:Me});if(ft=Yp(Ol),ft)return D.add(ft.key),Ue(Kt,ft.result,!1,{preventScrollReset:Me});let{loaderData:Yn,errors:_s}=JM(j,da,El,void 0,Nr,Ol);if(j.fetchers.has(W)){let zt=Ko(at.data);j.fetchers.set(W,zt)}te(Ei),j.navigation.state==="loading"&&Ei>R?(Xe(S,"Expected pending action"),O&&O.abort(),G(j.navigation.location,{matches:da,loaderData:Yn,errors:_s,fetchers:new Map(j.fetchers)})):(q({errors:_s,loaderData:YM(j.loaderData,Yn,da,_s),fetchers:new Map(j.fetchers)}),k=!1)}async function Ve(W,ee,ae,pe,Ne,Re,Be,Me,ke){let we=j.fetchers.get(W);rt(W,Ql(ke,we?we.data:void 0),{flushSync:Be});let ze=new AbortController,Je=Is(e.history,ae,ze.signal);if(Re){let at=await We(Ne,ae,Je.signal);if(at.type==="aborted")return;if(at.type==="error"){bt(W,ee,at.error,{flushSync:Be});return}else if(at.matches)Ne=at.matches,pe=Xl(Ne,ae);else{bt(W,ee,yr(404,{pathname:ae}),{flushSync:Be});return}}T.set(W,ze);let kt=A,Lt=(await qe("loader",j,Je,[pe],Ne,W))[pe.route.id];if(T.get(W)===ze&&T.delete(W),!Je.signal.aborted){if($.has(W)){rt(W,Ko(void 0));return}if(Ai(Lt))if(R>kt){rt(W,Ko(void 0));return}else{D.add(W),await Ue(Je,Lt,!1,{preventScrollReset:Me});return}if(ar(Lt)){bt(W,ee,Lt.error);return}rt(W,Ko(Lt.data))}}async function Ue(W,ee,ae,{submission:pe,fetcherSubmission:Ne,preventScrollReset:Re,replace:Be}={}){ee.response.headers.has("X-Remix-Revalidate")&&(k=!0);let Me=ee.response.headers.get("Location");Xe(Me,"Expected a Location header on the redirect Response"),Me=QM(Me,new URL(W.url),s);let ke=Ts(j.location,Me,{_isRedirect:!0});if(n){let at=!1;if(ee.response.headers.has("X-Remix-Reload-Document"))at=!0;else if(Dv.test(Me)){const Jn=e.history.createURL(Me);at=Jn.origin!==t.location.origin||Rr(Jn.pathname,s)==null}if(at){Be?t.location.replace(Me):t.location.assign(Me);return}}O=null;let we=Be===!0||ee.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:ze,formAction:Je,formEncType:kt}=j.navigation;!pe&&!Ne&&ze&&Je&&kt&&(pe=oP(j.navigation));let Lt=pe||Ne;if(gZ.has(ee.response.status)&&Lt&&Dr(Lt.formMethod))await se(we,ke,{submission:{...Lt,formAction:Me},preventScrollReset:Re||E,enableViewTransition:ae?N:void 0});else{let at=zv(ke,pe);await se(we,ke,{overrideNavigation:at,fetcherSubmission:Ne,preventScrollReset:Re||E,enableViewTransition:ae?N:void 0})}}async function qe(W,ee,ae,pe,Ne,Re){let Be,Me={};try{Be=await EZ(c,W,ee,ae,pe,Ne,Re,a,r)}catch(ke){return pe.forEach(we=>{Me[we.route.id]={type:"error",error:ke}}),Me}for(let[ke,we]of Object.entries(Be))if(kZ(we)){let ze=we.result;Me[ke]={type:"redirect",response:NZ(ze,ae,ke,Ne,s)}}else Me[ke]=await CZ(we);return Me}async function Mt(W,ee,ae,pe,Ne){let Re=qe("loader",W,Ne,ae,ee,null),Be=Promise.all(pe.map(async we=>{if(we.matches&&we.match&&we.controller){let ze=(await qe("loader",W,Is(e.history,we.path,we.controller.signal),[we.match],we.matches,we.key))[we.match.route.id];return{[we.key]:ze}}else return Promise.resolve({[we.key]:{type:"error",error:yr(404,{pathname:we.path})}})})),Me=await Re,ke=(await Be).reduce((we,ze)=>Object.assign(we,ze),{});return{loaderResults:Me,fetcherResults:ke}}function st(){k=!0,B.forEach((W,ee)=>{T.has(ee)&&C.add(ee),Gn(ee)})}function rt(W,ee,ae={}){j.fetchers.set(W,ee),q({fetchers:new Map(j.fetchers)},{flushSync:(ae&&ae.flushSync)===!0})}function bt(W,ee,ae,pe={}){let Ne=ki(j.matches,ee);Qn(W),q({errors:{[Ne.route.id]:ae},fetchers:new Map(j.fetchers)},{flushSync:(pe&&pe.flushSync)===!0})}function Ht(W){return F.set(W,(F.get(W)||0)+1),$.has(W)&&$.delete(W),j.fetchers.get(W)||vZ}function Qn(W){let ee=j.fetchers.get(W);T.has(W)&&!(ee&&ee.state==="loading"&&L.has(W))&&Gn(W),B.delete(W),L.delete(W),D.delete(W),$.delete(W),C.delete(W),j.fetchers.delete(W)}function za(W){let ee=(F.get(W)||0)-1;ee<=0?(F.delete(W),$.add(W)):F.set(W,ee),q({fetchers:new Map(j.fetchers)})}function Gn(W){let ee=T.get(W);ee&&(ee.abort(),T.delete(W))}function Va(W){for(let ee of W){let ae=Ht(ee),pe=Ko(ae.data);j.fetchers.set(ee,pe)}}function Y(){let W=[],ee=!1;for(let ae of D){let pe=j.fetchers.get(ae);Xe(pe,`Expected fetcher: ${ae}`),pe.state==="loading"&&(D.delete(ae),W.push(ae),ee=!0)}return Va(W),ee}function te(W){let ee=[];for(let[ae,pe]of L)if(pe<W){let Ne=j.fetchers.get(ae);Xe(Ne,`Expected fetcher: ${ae}`),Ne.state==="loading"&&(Gn(ae),L.delete(ae),ee.push(ae))}return Va(ee),ee.length>0}function ce(W,ee){let ae=j.blockers.get(W)||Zl;return V.get(W)!==ee&&V.set(W,ee),ae}function he(W){j.blockers.delete(W),V.delete(W)}function Te(W,ee){let ae=j.blockers.get(W)||Zl;Xe(ae.state==="unblocked"&&ee.state==="blocked"||ae.state==="blocked"&&ee.state==="blocked"||ae.state==="blocked"&&ee.state==="proceeding"||ae.state==="blocked"&&ee.state==="unblocked"||ae.state==="proceeding"&&ee.state==="unblocked",`Invalid blocker state transition: ${ae.state} -> ${ee.state}`);let pe=new Map(j.blockers);pe.set(W,ee),q({blockers:pe})}function Wt({currentLocation:W,nextLocation:ee,historyAction:ae}){if(V.size===0)return;V.size>1&&nn(!1,"A router only supports one blocker at a time");let pe=Array.from(V.entries()),[Ne,Re]=pe[pe.length-1],Be=j.blockers.get(Ne);if(!(Be&&Be.state==="proceeding")&&Re({currentLocation:W,nextLocation:ee,historyAction:ae}))return Ne}function Dt(W){let ee=yr(404,{pathname:W}),ae=i||o,{matches:pe,route:Ne}=tP(ae);return{notFoundMatches:pe,route:Ne,error:ee}}function Ke(W,ee,ae){if(f=W,m=ee,y=ae||null,!v&&j.navigation===Rv){v=!0;let pe=Ee(j.location,j.matches);pe!=null&&q({restoreScrollPosition:pe})}return()=>{f=null,m=null,y=null}}function be(W,ee){return y&&y(W,ee.map(ae=>XK(ae,j.loaderData)))||W.key}function _e(W,ee){if(f&&m){let ae=be(W,ee);f[ae]=m()}}function Ee(W,ee){if(f){let ae=be(W,ee),pe=f[ae];if(typeof pe=="number")return pe}return null}function Oe(W,ee,ae){if(l)if(W){if(Object.keys(W[0].params).length>0)return{active:!0,matches:Kp(ee,ae,s,!0)}}else return{active:!0,matches:Kp(ee,ae,s,!0)||[]};return{active:!1,matches:null}}async function We(W,ee,ae){if(!l)return{type:"success",matches:W};let pe=W;for(;;){let Ne=i==null,Re=i||o,Be=a;try{await l({path:ee,matches:pe,patch:(we,ze)=>{ae.aborted||ZM(we,ze,Re,Be,r)}})}catch(we){return{type:"error",error:we,partialMatches:pe}}finally{Ne&&!ae.aborted&&(o=[...o])}if(ae.aborted)return{type:"aborted"};let Me=Ho(Re,ee,s);if(Me)return{type:"success",matches:Me};let ke=Kp(Re,ee,s,!0);if(!ke||pe.length===ke.length&&pe.every((we,ze)=>we.route.id===ke[ze].route.id))return{type:"success",matches:null};pe=ke}}function St(W){a={},i=Hp(W,r,void 0,a)}function Bt(W,ee){let ae=i==null;ZM(W,ee,i||o,a,r),ae&&(o=[...o],q({}))}return x={get basename(){return s},get future(){return u},get state(){return j},get routes(){return o},get window(){return t},initialize:H,subscribe:K,enableScrollRestoration:Ke,navigate:ne,fetch:$e,revalidate:z,createHref:W=>e.history.createHref(W),encodeLocation:W=>e.history.encodeLocation(W),getFetcher:Ht,deleteFetcher:za,dispose:J,getBlocker:ce,deleteBlocker:he,patchRoutes:Bt,_internalFetchControllers:T,_internalSetRoutes:St},x}function wZ(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function Lv(e,t,n,r,a,o){let i,s;if(a){i=[];for(let l of t)if(i.push(l),l.route.id===a){s=l;break}}else i=t,s=t[t.length-1];let c=Qp(r||".",Xp(i),Rr(e.pathname,n)||e.pathname,o==="path");if(r==null&&(c.search=e.search,c.hash=e.hash),(r==null||r===""||r===".")&&s){let l=Bv(c.search);if(s.route.index&&!l)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&l){let u=new URLSearchParams(c.search),d=u.getAll("index");u.delete("index"),d.filter(f=>f).forEach(f=>u.append("index",f));let p=u.toString();c.search=p?`?${p}`:""}}return n!=="/"&&(c.pathname=c.pathname==="/"?n:ma([n,c.pathname])),Xa(c)}function UM(e,t,n){if(!n||!wZ(n))return{path:t};if(n.formMethod&&!AZ(n.formMethod))return{path:t,error:yr(405,{method:n.formMethod})};let r=()=>({path:t,error:yr(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),o=nP(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Dr(a))return r();let u=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((d,[p,f])=>`${d}${p}=${f}
`,""):String(n.body);return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:u}}}else if(n.formEncType==="application/json"){if(!Dr(a))return r();try{let u=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:u,text:void 0}}}catch{return r()}}}Xe(typeof FormData=="function","FormData is not available in this environment");let i,s;if(n.formData)i=Fv(n.formData),s=n.formData;else if(n.body instanceof FormData)i=Fv(n.body),s=n.body;else if(n.body instanceof URLSearchParams)i=n.body,s=GM(i);else if(n.body==null)i=new URLSearchParams,s=new FormData;else try{i=new URLSearchParams(n.body),s=GM(i)}catch{return r()}let c={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:s,json:void 0,text:void 0};if(Dr(c.formMethod))return{path:t,submission:c};let l=Qa(t);return e&&l.search&&Bv(l.search)&&i.append("index",""),l.search=`?${i}`,{path:Xa(l),submission:c}}function qM(e,t,n=!1){let r=e.findIndex(a=>a.route.id===t);return r>=0?e.slice(0,n?r+1:r):e}function HM(e,t,n,r,a,o,i,s,c,l,u,d,p,f){let y=f?ar(f[1])?f[1].error:f[1].data:void 0,m=e.createURL(t.location),v=e.createURL(a),b=n;o&&t.errors?b=qM(n,Object.keys(t.errors)[0],!0):f&&ar(f[1])&&(b=qM(n,f[0]));let w=f?f[1].statusCode:void 0,_=w&&w>=400,x=b.filter((S,E)=>{let{route:O}=S;if(O.lazy)return!0;if(O.loader==null)return!1;if(o)return $v(O,t.loaderData,t.errors);if(xZ(t.loaderData,t.matches[E],S))return!0;let N=t.matches[E],M=S;return KM(S,{currentUrl:m,currentParams:N.params,nextUrl:v,nextParams:M.params,...r,actionResult:y,actionStatus:w,defaultShouldRevalidate:_?!1:i||m.pathname+m.search===v.pathname+v.search||m.search!==v.search||_Z(N,M)})}),j=[];return l.forEach((S,E)=>{if(o||!n.some(I=>I.route.id===S.routeId)||c.has(E))return;let O=Ho(d,S.path,p);if(!O){j.push({key:E,routeId:S.routeId,path:S.path,matches:null,match:null,controller:null});return}let N=t.fetchers.get(E),M=Xl(O,S.path),P=!1;u.has(E)?P=!1:s.has(E)?(s.delete(E),P=!0):N&&N.state!=="idle"&&N.data===void 0?P=i:P=KM(M,{currentUrl:m,currentParams:t.matches[t.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params,...r,actionResult:y,actionStatus:w,defaultShouldRevalidate:_?!1:i}),P&&j.push({key:E,routeId:S.routeId,path:S.path,matches:O,match:M,controller:new AbortController})}),[x,j]}function $v(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&t[e.id]!==void 0,a=n!=null&&n[e.id]!==void 0;return!r&&a?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!a}function xZ(e,t,n){let r=!t||n.route.id!==t.route.id,a=!e.hasOwnProperty(n.route.id);return r||a}function _Z(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function KM(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function ZM(e,t,n,r,a){let o;if(e){let c=r[e];Xe(c,`No route found to patch children into: routeId = ${e}`),c.children||(c.children=[]),o=c.children}else o=n;let i=t.filter(c=>!o.some(l=>XM(c,l))),s=Hp(i,a,[e||"_","patch",String((o==null?void 0:o.length)||"0")],r);o.push(...s)}function XM(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var a;return(a=t.children)==null?void 0:a.some(o=>XM(n,o))}):!1}async function jZ(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let a=n[e.id];Xe(a,"No route found in manifest");let o={};for(let i in r){let s=a[i]!==void 0&&i!=="hasErrorBoundary";nn(!s,`Route "${a.id}" has a static property "${i}" defined but its lazy function is also returning a value for this property. The lazy route property "${i}" will be ignored.`),!s&&!KK.has(i)&&(o[i]=r[i])}Object.assign(a,o),Object.assign(a,{...t(a),lazy:void 0})}async function SZ({matches:e}){let t=e.filter(n=>n.shouldLoad);return(await Promise.all(t.map(n=>n.resolve()))).reduce((n,r,a)=>Object.assign(n,{[t[a].route.id]:r}),{})}async function EZ(e,t,n,r,a,o,i,s,c,l){let u=o.map(f=>f.route.lazy?jZ(f.route,c,s):void 0),d=o.map((f,y)=>{let m=u[y],v=a.some(b=>b.route.id===f.route.id);return{...f,shouldLoad:v,resolve:async b=>(b&&r.method==="GET"&&(f.route.lazy||f.route.loader)&&(v=!0),v?OZ(t,r,f,m,b,l):Promise.resolve({type:"data",result:void 0}))}}),p=await e({matches:d,request:r,params:o[0].params,fetcherKey:i,context:l});try{await Promise.all(u)}catch{}return p}async function OZ(e,t,n,r,a,o){let i,s,c=l=>{let u,d=new Promise((y,m)=>u=m);s=()=>u(),t.signal.addEventListener("abort",s);let p=y=>typeof l!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${e}" [routeId: ${n.route.id}]`)):l({request:t,params:n.params,context:o},...y!==void 0?[y]:[]),f=(async()=>{try{return{type:"data",result:await(a?a(y=>p(y)):p())}}catch(y){return{type:"error",result:y}}})();return Promise.race([f,d])};try{let l=n.route[e];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(p=>{u=p}),r]);if(u!==void 0)throw u;i=d}else if(await r,l=n.route[e],l)i=await c(l);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw yr(405,{method:t.method,pathname:d,routeId:n.route.id})}else return{type:"data",result:void 0};else if(l)i=await c(l);else{let u=new URL(t.url),d=u.pathname+u.search;throw yr(404,{pathname:d})}}catch(l){return{type:"error",result:l}}finally{s&&t.signal.removeEventListener("abort",s)}return i}async function CZ(e){var r,a,o,i;let{result:t,type:n}=e;if(aP(t)){let s;try{let c=t.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?t.body==null?s=null:s=await t.json():s=await t.text()}catch(c){return{type:"error",error:c}}return n==="error"?{type:"error",error:new Gp(t.status,t.statusText,s),statusCode:t.status,headers:t.headers}:{type:"data",data:s,statusCode:t.status,headers:t.headers}}if(n==="error"){if(rP(t)){if(t.data instanceof Error)return{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status};t=new Gp(((a=t.init)==null?void 0:a.status)||500,void 0,t.data)}return{type:"error",error:t,statusCode:Jp(t)?t.status:void 0}}return rP(t)?{type:"data",data:t.data,statusCode:(o=t.init)==null?void 0:o.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function NZ(e,t,n,r,a){let o=e.headers.get("Location");if(Xe(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!Dv.test(o)){let i=r.slice(0,r.findIndex(s=>s.route.id===n)+1);o=Lv(new URL(t.url),i,a,o),e.headers.set("Location",o)}return e}function QM(e,t,n){if(Dv.test(e)){let r=e,a=r.startsWith("//")?new URL(t.protocol+r):new URL(r),o=Rr(a.pathname,n)!=null;if(a.origin===t.origin&&o)return a.pathname+a.search+a.hash}return e}function Is(e,t,n,r){let a=e.createURL(nP(t)).toString(),o={signal:n};if(r&&Dr(r.formMethod)){let{formMethod:i,formEncType:s}=r;o.method=i.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=Fv(r.formData):o.body=r.formData}return new Request(a,o)}function Fv(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function GM(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function MZ(e,t,n,r=!1,a=!1){let o={},i=null,s,c=!1,l={},u=n&&ar(n[1])?n[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let p=d.route.id,f=t[p];if(Xe(!Ai(f),"Cannot handle redirect results in processLoaderData"),ar(f)){let y=f.error;if(u!==void 0&&(y=u,u=void 0),i=i||{},a)i[p]=y;else{let m=ki(e,p);i[m.route.id]==null&&(i[m.route.id]=y)}r||(o[p]=VM),c||(c=!0,s=Jp(f.error)?f.error.status:500),f.headers&&(l[p]=f.headers)}else o[p]=f.data,f.statusCode&&f.statusCode!==200&&!c&&(s=f.statusCode),f.headers&&(l[p]=f.headers)}),u!==void 0&&n&&(i={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:i,statusCode:s||200,loaderHeaders:l}}function JM(e,t,n,r,a,o){let{loaderData:i,errors:s}=MZ(t,n,r);return a.forEach(c=>{let{key:l,match:u,controller:d}=c,p=o[l];if(Xe(p,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(ar(p)){let f=ki(e.matches,u==null?void 0:u.route.id);s&&s[f.route.id]||(s={...s,[f.route.id]:p.error}),e.fetchers.delete(l)}else if(Ai(p))Xe(!1,"Unhandled fetcher revalidation redirect");else{let f=Ko(p.data);e.fetchers.set(l,f)}}),{loaderData:i,errors:s}}function YM(e,t,n,r){let a=Object.entries(t).filter(([,o])=>o!==VM).reduce((o,[i,s])=>(o[i]=s,o),{});for(let o of n){let i=o.route.id;if(!t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&o.route.loader&&(a[i]=e[i]),r&&r.hasOwnProperty(i))break}return a}function eP(e){return e?ar(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function ki(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function tP(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function yr(e,{pathname:t,routeId:n,method:r,type:a,message:o}={}){let i="Unknown Server Error",s="Unknown @remix-run/router error";return e===400?(i="Bad Request",r&&t&&n?s=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:a==="invalid-body"&&(s="Unable to encode submission body")):e===403?(i="Forbidden",s=`Route "${n}" does not match URL "${t}"`):e===404?(i="Not Found",s=`No route matches URL "${t}"`):e===405&&(i="Method Not Allowed",r&&t&&n?s=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new Gp(e||500,i,new Error(s),!0)}function Yp(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,a]=t[n];if(Ai(a))return{key:r,result:a}}}function nP(e){let t=typeof e=="string"?Qa(e):e;return Xa({...t,hash:""})}function PZ(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function kZ(e){return aP(e.result)&&yZ.has(e.result.status)}function ar(e){return e.type==="error"}function Ai(e){return(e&&e.type)==="redirect"}function rP(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function aP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function AZ(e){return mZ.has(e.toUpperCase())}function Dr(e){return fZ.has(e.toUpperCase())}function Bv(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function Xl(e,t){let n=typeof t=="string"?Qa(t).search:t.search;if(e[e.length-1].route.index&&Bv(n||""))return e[e.length-1];let r=FM(e);return r[r.length-1]}function oP(e){let{formMethod:t,formAction:n,formEncType:r,text:a,formData:o,json:i}=e;if(!(!t||!n||!r)){if(a!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:a};if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:i,text:void 0}}}function zv(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function TZ(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Ql(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function IZ(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Ko(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function RZ(e,t){try{let n=e.sessionStorage.getItem(zM);if(n){let r=JSON.parse(n);for(let[a,o]of Object.entries(r||{}))o&&Array.isArray(o)&&t.set(a,new Set(o||[]))}}catch{}}function DZ(e,t){if(t.size>0){let n={};for(let[r,a]of t)n[r]=[...a];try{e.sessionStorage.setItem(zM,JSON.stringify(n))}catch(r){nn(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function LZ(){let e,t,n=new Promise((r,a)=>{e=async o=>{r(o);try{await n}catch{}},t=async o=>{a(o);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var Ti=g.createContext(null);Ti.displayName="DataRouter";var Gl=g.createContext(null);Gl.displayName="DataRouterState";var Vv=g.createContext({isTransitioning:!1});Vv.displayName="ViewTransition";var iP=g.createContext(new Map);iP.displayName="Fetchers";var $Z=g.createContext(null);$Z.displayName="Await";var Lr=g.createContext(null);Lr.displayName="Navigation";var ef=g.createContext(null);ef.displayName="Location";var gr=g.createContext({outlet:null,matches:[],isDataRoute:!1});gr.displayName="Route";var Wv=g.createContext(null);Wv.displayName="RouteError";function FZ(e,{relative:t}={}){Xe(Rs(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=g.useContext(Lr),{hash:a,pathname:o,search:i}=Jl(e,{relative:t}),s=o;return n!=="/"&&(s=o==="/"?n:ma([n,o])),r.createHref({pathname:s,search:i,hash:a})}function Rs(){return g.useContext(ef)!=null}function ya(){return Xe(Rs(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(ef).location}var sP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function cP(e){g.useContext(Lr).static||g.useLayoutEffect(e)}function Ii(){let{isDataRoute:e}=g.useContext(gr);return e?YZ():BZ()}function BZ(){Xe(Rs(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(Ti),{basename:t,navigator:n}=g.useContext(Lr),{matches:r}=g.useContext(gr),{pathname:a}=ya(),o=JSON.stringify(Xp(r)),i=g.useRef(!1);return cP(()=>{i.current=!0}),g.useCallback((s,c={})=>{if(nn(i.current,sP),!i.current)return;if(typeof s=="number"){n.go(s);return}let l=Qp(s,JSON.parse(o),a,c.relative==="path");e==null&&t!=="/"&&(l.pathname=l.pathname==="/"?t:ma([t,l.pathname])),(c.replace?n.replace:n.push)(l,c.state,c)},[t,n,o,a,e])}var zZ=g.createContext(null);function VZ(e){let t=g.useContext(gr).outlet;return t&&g.createElement(zZ.Provider,{value:e},t)}function lP(){let{matches:e}=g.useContext(gr),t=e[e.length-1];return t?t.params:{}}function Jl(e,{relative:t}={}){let{matches:n}=g.useContext(gr),{pathname:r}=ya(),a=JSON.stringify(Xp(n));return g.useMemo(()=>Qp(e,JSON.parse(a),r,t==="path"),[e,a,r,t])}function WZ(e,t,n,r){Xe(Rs(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(Lr),{matches:o}=g.useContext(gr),i=o[o.length-1],s=i?i.params:{},c=i?i.pathname:"/",l=i?i.pathnameBase:"/",u=i&&i.route;{let v=u&&u.path||"";pP(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=ya(),p;p=d;let f=p.pathname||"/",y=f;if(l!=="/"){let v=l.replace(/^\//,"").split("/");y="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=Ho(e,{pathname:y});return nn(u||m!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),nn(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),ZZ(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},s,v.params),pathname:ma([l,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:ma([l,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r)}function UZ(){let e=uP(),t=Jp(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=g.createElement(g.Fragment,null,g.createElement("p",null,"\u{1F4BF} Hey developer \u{1F44B}"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:o},"ErrorBoundary")," or"," ",g.createElement("code",{style:o},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),n?g.createElement("pre",{style:a},n):null,i)}var qZ=g.createElement(UZ,null),HZ=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?g.createElement(gr.Provider,{value:this.props.routeContext},g.createElement(Wv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function KZ({routeContext:e,match:t,children:n}){let r=g.useContext(Ti);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(gr.Provider,{value:e},n)}function ZZ(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,o=n==null?void 0:n.errors;if(o!=null){let c=a.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id])!==void 0);Xe(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let i=!1,s=-1;if(n)for(let c=0;c<a.length;c++){let l=a[c];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(s=c),l.route.id){let{loaderData:u,errors:d}=n,p=l.route.loader&&!u.hasOwnProperty(l.route.id)&&(!d||d[l.route.id]===void 0);if(l.route.lazy||p){i=!0,s>=0?a=a.slice(0,s+1):a=[a[0]];break}}}return a.reduceRight((c,l,u)=>{let d,p=!1,f=null,y=null;n&&(d=o&&l.route.id?o[l.route.id]:void 0,f=l.route.errorElement||qZ,i&&(s<0&&u===0?(pP("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,y=null):s===u&&(p=!0,y=l.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,u+1)),v=()=>{let b;return d?b=f:p?b=y:l.route.Component?b=g.createElement(l.route.Component,null):l.route.element?b=l.route.element:b=c,g.createElement(KZ,{match:l,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:b})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?g.createElement(HZ,{location:n.location,revalidation:n.revalidation,component:f,error:d,children:v(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):v()},null)}function Uv(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function XZ(e){let t=g.useContext(Ti);return Xe(t,Uv(e)),t}function QZ(e){let t=g.useContext(Gl);return Xe(t,Uv(e)),t}function GZ(e){let t=g.useContext(gr);return Xe(t,Uv(e)),t}function qv(e){let t=GZ(e),n=t.matches[t.matches.length-1];return Xe(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function JZ(){return qv("useRouteId")}function uP(){var r;let e=g.useContext(Wv),t=QZ("useRouteError"),n=qv("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function YZ(){let{router:e}=XZ("useNavigate"),t=qv("useNavigate"),n=g.useRef(!1);return cP(()=>{n.current=!0}),g.useCallback(async(r,a={})=>{nn(n.current,sP),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...a}))},[e,t])}var dP={};function pP(e,t,n){!t&&!dP[e]&&(dP[e]=!0,nn(!1,n))}var fP={};function hP(e,t){!e&&!fP[t]&&(fP[t]=!0,console.warn(t))}function mP(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&nn(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:g.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&nn(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:g.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&nn(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:g.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var eX=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function tX({router:e,flushSync:t}){let[n,r]=g.useState(e.state),[a,o]=g.useState(),[i,s]=g.useState({isTransitioning:!1}),[c,l]=g.useState(),[u,d]=g.useState(),[p,f]=g.useState(),y=g.useRef(new Map),m=g.useCallback((_,{deletedFetchers:x,flushSync:j,viewTransitionOpts:S})=>{x.forEach(O=>y.current.delete(O)),_.fetchers.forEach((O,N)=>{O.data!==void 0&&y.current.set(N,O.data)}),hP(j===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let E=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(hP(S==null||E,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!S||!E){t&&j?t(()=>r(_)):g.startTransition(()=>r(_));return}if(t&&j){t(()=>{u&&(c&&c.resolve(),u.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:S.currentLocation,nextLocation:S.nextLocation})});let O=e.window.document.startViewTransition(()=>{t(()=>r(_))});O.finished.finally(()=>{t(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})})}),t(()=>d(O));return}u?(c&&c.resolve(),u.skipTransition(),f({state:_,currentLocation:S.currentLocation,nextLocation:S.nextLocation})):(o(_),s({isTransitioning:!0,flushSync:!1,currentLocation:S.currentLocation,nextLocation:S.nextLocation}))},[e.window,t,u,c]);g.useLayoutEffect(()=>e.subscribe(m),[e,m]),g.useEffect(()=>{i.isTransitioning&&!i.flushSync&&l(new eX)},[i]),g.useEffect(()=>{if(c&&a&&e.window){let _=a,x=c.promise,j=e.window.document.startViewTransition(async()=>{g.startTransition(()=>r(_)),await x});j.finished.finally(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})}),d(j)}},[a,c,e.window]),g.useEffect(()=>{c&&a&&n.location.key===a.location.key&&c.resolve()},[c,u,n.location,a]),g.useEffect(()=>{!i.isTransitioning&&p&&(o(p.state),s({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),f(void 0))},[i.isTransitioning,p]);let v=g.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:_=>e.navigate(_),push:(_,x,j)=>e.navigate(_,{state:x,preventScrollReset:j==null?void 0:j.preventScrollReset}),replace:(_,x,j)=>e.navigate(_,{replace:!0,state:x,preventScrollReset:j==null?void 0:j.preventScrollReset})}),[e]),b=e.basename||"/",w=g.useMemo(()=>({router:e,navigator:v,static:!1,basename:b}),[e,v,b]);return g.createElement(g.Fragment,null,g.createElement(Ti.Provider,{value:w},g.createElement(Gl.Provider,{value:n},g.createElement(iP.Provider,{value:y.current},g.createElement(Vv.Provider,{value:i},g.createElement(iX,{basename:b,location:n.location,navigationType:n.historyAction,navigator:v},g.createElement(nX,{routes:e.routes,future:e.future,state:n})))))),null)}var nX=g.memo(rX);function rX({routes:e,future:t,state:n}){return WZ(e,void 0,n,t)}function aX({to:e,replace:t,state:n,relative:r}){Xe(Rs(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(Lr);nn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=g.useContext(gr),{pathname:i}=ya(),s=Ii(),c=Qp(e,Xp(o),i,r==="path"),l=JSON.stringify(c);return g.useEffect(()=>{s(JSON.parse(l),{replace:t,state:n,relative:r})},[s,l,r,t,n]),null}function oX(e){return VZ(e.context)}function Zo(e){Xe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function iX({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:a,static:o=!1}){Xe(!Rs(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),s=g.useMemo(()=>({basename:i,navigator:a,static:o,future:{}}),[i,a,o]);typeof n=="string"&&(n=Qa(n));let{pathname:c="/",search:l="",hash:u="",state:d=null,key:p="default"}=n,f=g.useMemo(()=>{let y=Rr(c,i);return y==null?null:{location:{pathname:y,search:l,hash:u,state:d,key:p},navigationType:r}},[i,c,l,u,d,p,r]);return nn(f!=null,`<Router basename="${i}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:g.createElement(Lr.Provider,{value:s},g.createElement(ef.Provider,{children:t,value:f}))}function Hv(e,t=[]){let n=[];return g.Children.forEach(e,(r,a)=>{if(!g.isValidElement(r))return;let o=[...t,a];if(r.type===g.Fragment){n.push.apply(n,Hv(r.props.children,o));return}Xe(r.type===Zo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xe(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=Hv(r.props.children,o)),n.push(i)}),n}var sX=Hv,tf="get",nf="application/x-www-form-urlencoded";function rf(e){return e!=null&&typeof e.tagName=="string"}function cX(e){return rf(e)&&e.tagName.toLowerCase()==="button"}function lX(e){return rf(e)&&e.tagName.toLowerCase()==="form"}function uX(e){return rf(e)&&e.tagName.toLowerCase()==="input"}function dX(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function pX(e,t){return e.button===0&&(!t||t==="_self")&&!dX(e)}var af=null;function fX(){if(af===null)try{new FormData(document.createElement("form"),0),af=!1}catch{af=!0}return af}var hX=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kv(e){return e!=null&&!hX.has(e)?(nn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${nf}"`),null):e}function mX(e,t){let n,r,a,o,i;if(lX(e)){let s=e.getAttribute("action");r=s?Rr(s,t):null,n=e.getAttribute("method")||tf,a=Kv(e.getAttribute("enctype"))||nf,o=new FormData(e)}else if(cX(e)||uX(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||s.getAttribute("action");if(r=c?Rr(c,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||tf,a=Kv(e.getAttribute("formenctype"))||Kv(s.getAttribute("enctype"))||nf,o=new FormData(s,e),!fX()){let{name:l,type:u,value:d}=e;if(u==="image"){let p=l?`${l}.`:"";o.append(`${p}x`,"0"),o.append(`${p}y`,"0")}else l&&o.append(l,d)}}else{if(rf(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=tf,r=null,a=nf,i=e}return o&&a==="text/plain"&&(i=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:i}}function Zv(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function yX(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module).then(async r=>(await r.__tla,r));return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function gX(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function vX(e,t,n){let r=await Promise.all(e.map(async a=>{let o=t.routes[a.route.id];if(o){let i=await yX(o,n);return i.links?i.links():[]}return[]}));return _X(r.flat(1).filter(gX).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function yP(e,t,n,r,a,o){let i=(c,l)=>n[l]?c.route.id!==n[l].route.id:!0,s=(c,l)=>{var u;return n[l].pathname!==c.pathname||((u=n[l].route.path)==null?void 0:u.endsWith("*"))&&n[l].params["*"]!==c.params["*"]};return o==="assets"?t.filter((c,l)=>i(c,l)||s(c,l)):o==="data"?t.filter((c,l)=>{var d;let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(i(c,l)||s(c,l))return!0;if(c.route.shouldRevalidate){let p=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function bX(e,t){return wX(e.map(n=>{let r=t.routes[n.route.id];if(!r)return[];let a=[r.module];return r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function wX(e){return[...new Set(e)]}function xX(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function _X(e,t){let n=new Set;return new Set(t),e.reduce((r,a)=>{let o=JSON.stringify(xX(a));return n.has(o)||(n.add(o),r.push({key:o,link:a})),r},[])}function jX(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function SX(){let e=g.useContext(Ti);return Zv(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function EX(){let e=g.useContext(Gl);return Zv(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Xv=g.createContext(void 0);Xv.displayName="FrameworkContext";function gP(){let e=g.useContext(Xv);return Zv(e,"You must render this element inside a <HydratedRouter> element"),e}function OX(e,t){let n=g.useContext(Xv),[r,a]=g.useState(!1),[o,i]=g.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=t,p=g.useRef(null);g.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let m=b=>{b.forEach(w=>{i(w.isIntersecting)})},v=new IntersectionObserver(m,{threshold:.5});return p.current&&v.observe(p.current),()=>{v.disconnect()}}},[e]),g.useEffect(()=>{if(r){let m=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(m)}}},[r]);let f=()=>{a(!0)},y=()=>{a(!1),i(!1)};return n?e!=="intent"?[o,p,{}]:[o,p,{onFocus:Yl(s,f),onBlur:Yl(c,y),onMouseEnter:Yl(l,f),onMouseLeave:Yl(u,y),onTouchStart:Yl(d,f)}]:[!1,p,{}]}function Yl(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function CX({page:e,...t}){let{router:n}=SX(),r=g.useMemo(()=>Ho(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?g.createElement(MX,{page:e,matches:r,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function NX(e){let{manifest:t,routeModules:n}=gP(),[r,a]=g.useState([]);return g.useEffect(()=>{let o=!1;return vX(e,t,n).then(i=>{o||a(i)}),()=>{o=!0}},[e,t,n]),r}function MX({page:e,matches:t,...n}){let r=ya(),{manifest:a,routeModules:o}=gP(),{loaderData:i,matches:s}=EX(),c=g.useMemo(()=>yP(e,t,s,a,r,"data"),[e,t,s,a,r]),l=g.useMemo(()=>yP(e,t,s,a,r,"assets"),[e,t,s,a,r]),u=g.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let f=new Set,y=!1;if(t.forEach(v=>{var w;let b=a.routes[v.route.id];!b||!b.hasLoader||(!c.some(_=>_.route.id===v.route.id)&&v.route.id in i&&((w=o[v.route.id])!=null&&w.shouldRevalidate)||b.hasClientLoader?y=!0:f.add(v.route.id))}),f.size===0)return[];let m=jX(e);return y&&f.size>0&&m.searchParams.set("_routes",t.filter(v=>f.has(v.route.id)).map(v=>v.route.id).join(",")),[m.pathname+m.search]},[i,r,a,c,t,e,o]),d=g.useMemo(()=>bX(l,a),[l,a]),p=NX(l);return g.createElement(g.Fragment,null,u.map(f=>g.createElement("link",{key:f,rel:"prefetch",as:"fetch",href:f,...n})),d.map(f=>g.createElement("link",{key:f,rel:"modulepreload",href:f,...n})),p.map(({key:f,link:y})=>g.createElement("link",{key:f,...y})))}function PX(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var vP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{vP&&(window.__reactRouterVersion="7.0.2")}catch{}function bP(e,t){return WM({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:UK({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||wP(),routes:e,mapRouteProperties:mP,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function kX(e,t){return WM({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:qK({window:t==null?void 0:t.window}),hydrationData:wP(),routes:e,mapRouteProperties:mP,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function wP(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:AX(e.errors)}),e}function AX(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,a]of t)if(a&&a.__type==="RouteErrorResponse")n[r]=new Gp(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let o=window[a.__subType];if(typeof o=="function")try{let i=new o(a.message);i.stack="",n[r]=i}catch{}}if(n[r]==null){let o=new Error(a.message);o.stack="",n[r]=o}}else n[r]=a;return n}var xP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Qv=g.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:a,replace:o,state:i,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},p){let{basename:f}=g.useContext(Lr),y=typeof c=="string"&&xP.test(c),m,v=!1;if(typeof c=="string"&&y&&(m=c,vP))try{let O=new URL(window.location.href),N=c.startsWith("//")?new URL(O.protocol+c):new URL(c),M=Rr(N.pathname,f);N.origin===O.origin&&M!=null?c=M+N.search+N.hash:v=!0}catch{nn(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=FZ(c,{relative:r}),[w,_,x]=OX(n,d),j=DX(c,{replace:o,state:i,target:s,preventScrollReset:l,relative:r,viewTransition:u});function S(O){e&&e(O),O.defaultPrevented||j(O)}let E=g.createElement("a",{...d,...x,href:m||b,onClick:v||a?e:S,ref:PX(p,_),target:s,"data-discover":!y&&t==="render"?"true":void 0});return w&&!y?g.createElement(g.Fragment,null,E,g.createElement(CX,{page:b})):E});Qv.displayName="Link";var TX=g.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:a,to:o,viewTransition:i,children:s,...c},l){let u=Jl(o,{relative:c.relative}),d=ya(),p=g.useContext(Gl),{navigator:f,basename:y}=g.useContext(Lr),m=p!=null&&zX(u)&&i===!0,v=f.encodeLocation?f.encodeLocation(u).pathname:u.pathname,b=d.pathname,w=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&y&&(w=Rr(w,y)||w);const _=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let x=b===v||!r&&b.startsWith(v)&&b.charAt(_)==="/",j=w!=null&&(w===v||!r&&w.startsWith(v)&&w.charAt(v.length)==="/"),S={isActive:x,isPending:j,isTransitioning:m},E=x?e:void 0,O;typeof n=="function"?O=n(S):O=[n,x?"active":null,j?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let N=typeof a=="function"?a(S):a;return g.createElement(Qv,{...c,"aria-current":E,className:O,ref:l,style:N,to:o,viewTransition:i},typeof s=="function"?s(S):s)});TX.displayName="NavLink";var IX=g.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:a,state:o,method:i=tf,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...p},f)=>{let y=FX(),m=BX(s,{relative:l}),v=i.toLowerCase()==="get"?"get":"post",b=typeof s=="string"&&xP.test(s),w=_=>{if(c&&c(_),_.defaultPrevented)return;_.preventDefault();let x=_.nativeEvent.submitter,j=(x==null?void 0:x.getAttribute("formmethod"))||i;y(x||_.currentTarget,{fetcherKey:t,method:j,navigate:n,replace:a,state:o,relative:l,preventScrollReset:u,viewTransition:d})};return g.createElement("form",{ref:f,method:v,action:m,onSubmit:r?c:w,...p,"data-discover":!b&&e==="render"?"true":void 0})});IX.displayName="Form";function RX(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _P(e){let t=g.useContext(Ti);return Xe(t,RX(e)),t}function DX(e,{target:t,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:i}={}){let s=Ii(),c=ya(),l=Jl(e,{relative:o});return g.useCallback(u=>{if(pX(u,t)){u.preventDefault();let d=n!==void 0?n:Xa(c)===Xa(l);s(e,{replace:d,state:r,preventScrollReset:a,relative:o,viewTransition:i})}},[c,s,l,n,r,t,e,a,o,i])}var LX=0,$X=()=>`__${String(++LX)}__`;function FX(){let{router:e}=_P("useSubmit"),{basename:t}=g.useContext(Lr),n=JZ();return g.useCallback(async(r,a={})=>{let{action:o,method:i,encType:s,formData:c,body:l}=mX(r,t);if(a.navigate===!1){let u=a.fetcherKey||$X();await e.fetch(u,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}function BX(e,{relative:t}={}){let{basename:n}=g.useContext(Lr),r=g.useContext(gr);Xe(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...Jl(e||".",{relative:t})},i=ya();if(e==null){o.search=i.search;let s=new URLSearchParams(o.search),c=s.getAll("index");if(c.some(l=>l==="")){s.delete("index"),c.filter(u=>u).forEach(u=>s.append("index",u));let l=s.toString();o.search=l?`?${l}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:ma([n,o.pathname])),Xa(o)}function zX(e,t={}){let n=g.useContext(Vv);Xe(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=_P("useViewTransitionState"),a=Jl(e,{relative:t.relative});if(!n.isTransitioning)return!1;let o=Rr(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=Rr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Zp(a.pathname,i)!=null||Zp(a.pathname,o)!=null}new TextEncoder;function VX(e){return g.createElement(tX,{flushSync:Nl.flushSync,...e})}var WX=pAe.useId||(()=>{}),UX=0;Pt=function(e){const[t,n]=g.useState(WX());return tn(()=>{e||n(r=>r??String(UX++))},[e]),e||(t?`radix-${t}`:"")};var Gv="Collapsible",[qX,jP]=er(Gv),[HX,Jv]=qX(Gv),SP=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:o,onOpenChange:i,...s}=e,[c=!1,l]=Sn({prop:r,defaultProp:a,onChange:i});return h.jsx(HX,{scope:n,disabled:o,contentId:Pt(),open:c,onOpenToggle:g.useCallback(()=>l(u=>!u),[l]),children:h.jsx(Ae.div,{"data-state":n0(c),"data-disabled":o?"":void 0,...s,ref:t})})});SP.displayName=Gv;var EP="CollapsibleTrigger",Yv=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=Jv(EP,n);return h.jsx(Ae.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":n0(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:ge(e.onClick,a.onOpenToggle)})});Yv.displayName=EP;var e0="CollapsibleContent",t0=g.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Jv(e0,e.__scopeCollapsible);return h.jsx(Mr,{present:n||a.open,children:({present:o})=>h.jsx(KX,{...r,ref:t,present:o})})});t0.displayName=e0;var KX=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...o}=e,i=Jv(e0,n),[s,c]=g.useState(r),l=g.useRef(null),u=wt(t,l),d=g.useRef(0),p=d.current,f=g.useRef(0),y=f.current,m=i.open||s,v=g.useRef(m),b=g.useRef();return g.useEffect(()=>{const w=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(w)},[]),tn(()=>{const w=l.current;if(w){b.current=b.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const _=w.getBoundingClientRect();d.current=_.height,f.current=_.width,v.current||(w.style.transitionDuration=b.current.transitionDuration,w.style.animationName=b.current.animationName),c(r)}},[i.open,r]),h.jsx(Ae.div,{"data-state":n0(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!m,...o,ref:u,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...e.style},children:m&&a})});function n0(e){return e?"open":"closed"}var OP=SP,ZX=Yv,XX=t0;const QX=OP,GX=Yv,JX=t0,r0=768;function YX(){const[e,t]=g.useState(void 0);return g.useEffect(()=>{const n=window.matchMedia(`(max-width: ${r0-1}px)`),r=()=>{t(window.innerWidth<r0)};return n.addEventListener("change",r),t(window.innerWidth<r0),()=>n.removeEventListener("change",r)},[]),!!e}let eu;eu=qa("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ut=g.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...a},o)=>{const i=r?zo:"button";return h.jsx(i,{className:Z(eu({variant:t,size:n,className:e})),ref:o,...a})}),ut.displayName="Button";const En=g.forwardRef(({className:e,type:t,...n},r)=>h.jsx("input",{type:t,className:Z("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));En.displayName="Input";var eQ="Separator",CP="horizontal",tQ=["horizontal","vertical"],NP=g.forwardRef((e,t)=>{const{decorative:n,orientation:r=CP,...a}=e,o=nQ(r)?r:CP,i=n?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return h.jsx(Ae.div,{"data-orientation":o,...i,...a,ref:t})});NP.displayName=eQ;function nQ(e){return tQ.includes(e)}Gg=NP,Ms=g.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},a)=>h.jsx(Gg,{ref:a,decorative:n,orientation:t,className:Z("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r})),Ms.displayName=Gg.displayName;var a0="focusScope.autoFocusOnMount",o0="focusScope.autoFocusOnUnmount",MP={bubbles:!1,cancelable:!0},rQ="FocusScope",of=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=tr(a),u=tr(o),d=g.useRef(null),p=wt(t,m=>c(m)),f=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let m=function(_){if(f.paused||!s)return;const x=_.target;s.contains(x)?d.current=x:Xo(d.current,{select:!0})},v=function(_){if(f.paused||!s)return;const x=_.relatedTarget;x!==null&&(s.contains(x)||Xo(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const x of _)x.removedNodes.length>0&&Xo(s)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,f.paused]),g.useEffect(()=>{if(s){AP.add(f);const m=document.activeElement;if(!s.contains(m)){const v=new CustomEvent(a0,MP);s.addEventListener(a0,l),s.dispatchEvent(v),v.defaultPrevented||(aQ(lQ(PP(s)),{select:!0}),document.activeElement===m&&Xo(s))}return()=>{s.removeEventListener(a0,l),setTimeout(()=>{const v=new CustomEvent(o0,MP);s.addEventListener(o0,u),s.dispatchEvent(v),v.defaultPrevented||Xo(m??document.body,{select:!0}),s.removeEventListener(o0,u),AP.remove(f)},0)}}},[s,l,u,f]);const y=g.useCallback(m=>{if(!n&&!r||f.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,b=document.activeElement;if(v&&b){const w=m.currentTarget,[_,x]=oQ(w);_&&x?!m.shiftKey&&b===x?(m.preventDefault(),n&&Xo(_,{select:!0})):m.shiftKey&&b===_&&(m.preventDefault(),n&&Xo(x,{select:!0})):b===w&&m.preventDefault()}},[n,r,f.paused]);return h.jsx(Ae.div,{tabIndex:-1,...i,ref:p,onKeyDown:y})});of.displayName=rQ;function aQ(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Xo(r,{select:t}),document.activeElement!==n)return}function oQ(e){const t=PP(e),n=kP(t,e),r=kP(t.reverse(),e);return[n,r]}function PP(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function kP(e,t){for(const n of e)if(!iQ(n,{upTo:t}))return n}function iQ(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function sQ(e){return e instanceof HTMLInputElement&&"select"in e}function Xo(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&sQ(e)&&t&&e.select()}}var AP=cQ();function cQ(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=TP(e,t),e.unshift(t)},remove(t){var n;e=TP(e,t),(n=e[0])==null||n.resume()}}}function TP(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function lQ(e){return e.filter(t=>t.tagName!=="A")}var i0=0;Wl=function(){g.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??IP()),document.body.insertAdjacentElement("beforeend",e[1]??IP()),i0++,()=>{i0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),i0--}},[])};function IP(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}mn=function(){return mn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},mn.apply(this,arguments)},Vp=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},yv=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};var sf="right-scroll-bar-position",cf="width-before-scroll-bar",uQ="with-scroll-bars-hidden",dQ="--removed-body-scroll-bar-size";function s0(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function pQ(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var fQ=typeof window<"u"?g.useLayoutEffect:g.useEffect,RP=new WeakMap;function hQ(e,t){var n=pQ(null,function(r){return e.forEach(function(a){return s0(a,r)})});return fQ(function(){var r=RP.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||s0(s,null)}),o.forEach(function(s){a.has(s)||s0(s,i)})}RP.set(n,e)},[e]),n}function mQ(e){return e}function yQ(e,t){t===void 0&&(t=mQ);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var i=t(o,r);return n.push(i),function(){n=n.filter(function(s){return s!==i})}},assignSyncMedium:function(o){for(r=!0;n.length;){var i=n;n=[],i.forEach(o)}n={push:function(s){return o(s)},filter:function(){return n}}},assignMedium:function(o){r=!0;var i=[];if(n.length){var s=n;n=[],s.forEach(o),i=n}var c=function(){var u=i;i=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){i.push(u),l()},filter:function(u){return i=i.filter(u),n}}}};return a}hv=function(e){e===void 0&&(e={});var t=yQ(null);return t.options=mn({async:!0,ssr:!1},e),t};var DP=function(e){var t=e.sideCar,n=Vp(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,mn({},n))};DP.isSideCarExport=!0,gv=function(e,t){return e.useMedium(t),DP};var LP=hv(),c0=function(){},lf=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:c0,onWheelCapture:c0,onTouchMoveCapture:c0}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,p=e.sideCar,f=e.noIsolation,y=e.inert,m=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,_=Vp(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=p,j=hQ([n,t]),S=mn(mn({},_),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:LP,removeScrollBar:l,shards:d,noIsolation:f,inert:y,setCallbacks:o,allowPinchZoom:!!m,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),mn(mn({},S),{ref:j})):g.createElement(b,mn({},S,{className:c,ref:j}),s))});lf.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},lf.classNames={fullWidth:cf,zeroRight:sf},mv=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function gQ(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=mv();return t&&e.setAttribute("nonce",t),e}function vQ(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function bQ(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}let $P,FP,BP,uf,zP,VP,WP,Ri,UP,l0,qP,HP,df;if($P=function(){var e=0,t=null;return{add:function(n){e==0&&(t=gQ())&&(vQ(t,n),bQ(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},FP=function(){var e=$P();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Wp=function(){var e=FP(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},BP={left:0,top:0,right:0,gap:0},uf=function(e){return parseInt(e||"",10)||0},zP=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[uf(n),uf(r),uf(a)]},VP=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return BP;var t=zP(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},WP=Wp(),Ri="data-scroll-locked",UP=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(uQ,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Ri,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(sf,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(cf,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(sf," .").concat(sf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(cf," .").concat(cf,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ri,`] {
    `).concat(dQ,": ").concat(s,`px;
  }
`)},l0=function(){var e=parseInt(document.body.getAttribute(Ri)||"0",10);return isFinite(e)?e:0},qP=function(){g.useEffect(function(){return document.body.setAttribute(Ri,(l0()+1).toString()),function(){var e=l0()-1;e<=0?document.body.removeAttribute(Ri):document.body.setAttribute(Ri,e.toString())}},[])},HP=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;qP();var o=g.useMemo(function(){return VP(a)},[a]);return g.createElement(WP,{styles:UP(o,!t,a,n?"":"!important")})},df=!1,typeof window<"u")try{var pf=Object.defineProperty({},"passive",{get:function(){return df=!0,!0}});window.addEventListener("test",pf,pf),window.removeEventListener("test",pf,pf)}catch{df=!1}var Ds=df?{passive:!1}:!1,wQ=function(e){return e.tagName==="TEXTAREA"},KP=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!wQ(e)&&n[t]==="visible")},xQ=function(e){return KP(e,"overflowY")},_Q=function(e){return KP(e,"overflowX")},ZP=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=XP(e,r);if(a){var o=QP(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},jQ=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},SQ=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},XP=function(e,t){return e==="v"?xQ(t):_Q(t)},QP=function(e,t){return e==="v"?jQ(t):SQ(t)},EQ=function(e,t){return e==="h"&&t==="rtl"?-1:1},OQ=function(e,t,n,r,a){var o=EQ(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,p=0;do{var f=QP(e,s),y=f[0],m=f[1],v=f[2],b=m-v-o*y;(y||b)&&XP(e,s)&&(d+=b,p+=y),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(p)<1||!a))&&(l=!0),l},ff=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},GP=function(e){return[e.deltaX,e.deltaY]},JP=function(e){return e&&"current"in e?e.current:e},CQ=function(e,t){return e[0]===t[0]&&e[1]===t[1]},NQ=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},MQ=0,Ls=[];function PQ(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(MQ++)[0],o=g.useState(Wp)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=yv([e.lockRef.current],(e.shards||[]).map(JP),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var b=ff(m),w=n.current,_="deltaX"in m?m.deltaX:w[0]-b[0],x="deltaY"in m?m.deltaY:w[1]-b[1],j,S=m.target,E=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in m&&E==="h"&&S.type==="range")return!1;var O=ZP(E,S);if(!O)return!0;if(O?j=E:(j=E==="v"?"h":"v",O=ZP(E,S)),!O)return!1;if(!r.current&&"changedTouches"in m&&(_||x)&&(r.current=j),!j)return!0;var N=r.current||j;return OQ(N,v,m,N==="h"?_:x,!0)},[]),c=g.useCallback(function(m){var v=m;if(!(!Ls.length||Ls[Ls.length-1]!==o)){var b="deltaY"in v?GP(v):ff(v),w=t.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&CQ(j.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(JP).filter(Boolean).filter(function(j){return j.contains(v.target)}),x=_.length>0?s(v,_[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(m,v,b,w){var _={name:m,delta:v,target:b,should:w,shadowParent:kQ(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(x){return x!==_})},1)},[]),u=g.useCallback(function(m){n.current=ff(m),r.current=void 0},[]),d=g.useCallback(function(m){l(m.type,GP(m),m.target,s(m,e.lockRef.current))},[]),p=g.useCallback(function(m){l(m.type,ff(m),m.target,s(m,e.lockRef.current))},[]);g.useEffect(function(){return Ls.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:p}),document.addEventListener("wheel",c,Ds),document.addEventListener("touchmove",c,Ds),document.addEventListener("touchstart",u,Ds),function(){Ls=Ls.filter(function(m){return m!==o}),document.removeEventListener("wheel",c,Ds),document.removeEventListener("touchmove",c,Ds),document.removeEventListener("touchstart",u,Ds)}},[]);var f=e.removeScrollBar,y=e.inert;return g.createElement(g.Fragment,null,y?g.createElement(o,{styles:NQ(a)}):null,f?g.createElement(HP,{gapMode:e.gapMode}):null)}function kQ(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const AQ=gv(LP,PQ);var hf=g.forwardRef(function(e,t){return g.createElement(lf,mn({},e,{ref:t,sideCar:AQ}))});hf.classNames=lf.classNames;let YP,Di,tu,nu,mf,u0,ek,tk,yf,d0,p0,nk,vr,f0;YP=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Di=new WeakMap,tu=new WeakMap,nu={},mf=0,u0=function(e){return e&&(e.host||u0(e.parentNode))},ek=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=u0(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},tk=function(e,t,n,r){var a=ek(t,Array.isArray(e)?e:[e]);nu[n]||(nu[n]=new WeakMap);var o=nu[n],i=[],s=new Set,c=new Set(a),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};a.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(p){if(s.has(p))u(p);else try{var f=p.getAttribute(r),y=f!==null&&f!=="false",m=(Di.get(p)||0)+1,v=(o.get(p)||0)+1;Di.set(p,m),o.set(p,v),i.push(p),m===1&&y&&tu.set(p,!0),v===1&&p.setAttribute(n,"true"),y||p.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",p,b)}})};return u(t),s.clear(),mf++,function(){i.forEach(function(d){var p=Di.get(d)-1,f=o.get(d)-1;Di.set(d,p),o.set(d,f),p||(tu.has(d)||d.removeAttribute(r),tu.delete(d)),f||d.removeAttribute(n)}),mf--,mf||(Di=new WeakMap,Di=new WeakMap,tu=new WeakMap,nu={})}},Vl=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=YP(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),tk(r,a,n,"aria-hidden")):function(){return null}},yf="Dialog",[d0,p0]=er(yf),[nk,vr]=d0(yf),f0=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!0}=e,s=g.useRef(null),c=g.useRef(null),[l=!1,u]=Sn({prop:r,defaultProp:a,onChange:o});return h.jsx(nk,{scope:t,triggerRef:s,contentRef:c,contentId:Pt(),titleId:Pt(),descriptionId:Pt(),open:l,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:i,children:n})},f0.displayName=yf;var rk="DialogTrigger",ak=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(rk,n),o=wt(t,a.triggerRef);return h.jsx(Ae.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":y0(a.open),...r,ref:o,onClick:ge(e.onClick,a.onOpenToggle)})});ak.displayName=rk;var h0="DialogPortal",[TQ,ok]=d0(h0,{forceMount:void 0}),ik=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,o=vr(h0,t);return h.jsx(TQ,{scope:t,forceMount:n,children:g.Children.map(r,i=>h.jsx(Mr,{present:n||o.open,children:h.jsx(Cg,{asChild:!0,container:a,children:i})}))})};ik.displayName=h0;var gf="DialogOverlay",sk=g.forwardRef((e,t)=>{const n=ok(gf,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=vr(gf,e.__scopeDialog);return o.modal?h.jsx(Mr,{present:r||o.open,children:h.jsx(IQ,{...a,ref:t})}):null});sk.displayName=gf;var IQ=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(gf,n);return h.jsx(hf,{as:zo,allowPinchZoom:!0,shards:[a.contentRef],children:h.jsx(Ae.div,{"data-state":y0(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Li="DialogContent",ck=g.forwardRef((e,t)=>{const n=ok(Li,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=vr(Li,e.__scopeDialog);return h.jsx(Mr,{present:r||o.open,children:o.modal?h.jsx(RQ,{...a,ref:t}):h.jsx(DQ,{...a,ref:t})})});ck.displayName=Li;var RQ=g.forwardRef((e,t)=>{const n=vr(Li,e.__scopeDialog),r=g.useRef(null),a=wt(t,n.contentRef,r);return g.useEffect(()=>{const o=r.current;if(o)return Vl(o)},[]),h.jsx(lk,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(e.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ge(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,s=i.button===0&&i.ctrlKey===!0;(i.button===2||s)&&o.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault())})}),DQ=g.forwardRef((e,t)=>{const n=vr(Li,e.__scopeDialog),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(lk,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),lk=g.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,...i}=e,s=vr(Li,n),c=g.useRef(null),l=wt(t,c);return Wl(),h.jsxs(h.Fragment,{children:[h.jsx(of,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(Og,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":y0(s.open),...i,ref:l,onDismiss:()=>s.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(yk,{titleId:s.titleId}),h.jsx(vk,{contentRef:c,descriptionId:s.descriptionId})]})]})}),m0="DialogTitle",uk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(m0,n);return h.jsx(Ae.h2,{id:a.titleId,...r,ref:t})});uk.displayName=m0;var dk="DialogDescription",pk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(dk,n);return h.jsx(Ae.p,{id:a.descriptionId,...r,ref:t})});pk.displayName=dk;var fk="DialogClose",hk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(fk,n);return h.jsx(Ae.button,{type:"button",...r,ref:t,onClick:ge(e.onClick,()=>a.onOpenChange(!1))})});hk.displayName=fk;function y0(e){return e?"open":"closed"}let g0,mk,v0,yk,gk,vk,bk;g0="DialogTitleWarning",[mk,v0]=fAe(g0,{contentName:Li,titleName:m0,docsSlug:"dialog"}),yk=({titleId:e})=>{const t=v0(g0),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return g.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},gk="DialogDescriptionWarning",vk=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${v0(gk).contentName}}.`;return g.useEffect(()=>{var a;const r=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},Dl=f0,bk=ak,Ll=ik,Mi=sk,Pi=ck,Os=uk,Cs=pk,$l=hk;const LQ=Dl,$Q=Ll,wk=g.forwardRef(({className:e,...t},n)=>h.jsx(Mi,{className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));wk.displayName=Mi.displayName;const FQ=qa("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),xk=g.forwardRef(({side:e="right",className:t,children:n,...r},a)=>h.jsxs($Q,{children:[h.jsx(wk,{}),h.jsxs(Pi,{ref:a,className:Z(FQ({side:e}),t),...r,children:[n,h.jsxs($l,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[h.jsx(de,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));xk.displayName=Pi.displayName;const BQ=g.forwardRef(({className:e,...t},n)=>h.jsx(Os,{ref:n,className:Z("text-lg font-semibold text-foreground",e),...t}));BQ.displayName=Os.displayName;const zQ=g.forwardRef(({className:e,...t},n)=>h.jsx(Cs,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));zQ.displayName=Cs.displayName;function _k({className:e,...t}){return h.jsx("div",{className:Z("animate-pulse rounded-md bg-muted",e),...t})}const VQ=["top","right","bottom","left"],ga=Math.min,or=Math.max,vf=Math.round,bf=Math.floor,Qo=e=>({x:e,y:e}),WQ={left:"right",right:"left",bottom:"top",top:"bottom"},UQ={start:"end",end:"start"};function b0(e,t,n){return or(e,ga(t,n))}function Ga(e,t){return typeof e=="function"?e(t):e}function Ja(e){return e.split("-")[0]}function $s(e){return e.split("-")[1]}function w0(e){return e==="x"?"y":"x"}function x0(e){return e==="y"?"height":"width"}function Go(e){return["top","bottom"].includes(Ja(e))?"y":"x"}function _0(e){return w0(Go(e))}function qQ(e,t,n){n===void 0&&(n=!1);const r=$s(e),a=_0(e),o=x0(a);let i=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=wf(i)),[i,wf(i)]}function HQ(e){const t=wf(e);return[j0(e),t,j0(t)]}function j0(e){return e.replace(/start|end/g,t=>UQ[t])}function KQ(e,t,n){const r=["left","right"],a=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?o:i;default:return[]}}function ZQ(e,t,n,r){const a=$s(e);let o=KQ(Ja(e),n==="start",r);return a&&(o=o.map(i=>i+"-"+a),t&&(o=o.concat(o.map(j0)))),o}function wf(e){return e.replace(/left|right|bottom|top/g,t=>WQ[t])}function XQ(e){return{top:0,right:0,bottom:0,left:0,...e}}function jk(e){return typeof e!="number"?XQ(e):{top:e,right:e,bottom:e,left:e}}function xf(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function Sk(e,t,n){let{reference:r,floating:a}=e;const o=Go(t),i=_0(t),s=x0(i),c=Ja(t),l=o==="y",u=r.x+r.width/2-a.width/2,d=r.y+r.height/2-a.height/2,p=r[s]/2-a[s]/2;let f;switch(c){case"top":f={x:u,y:r.y-a.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-a.width,y:d};break;default:f={x:r.x,y:r.y}}switch($s(t)){case"start":f[i]-=p*(n&&l?-1:1);break;case"end":f[i]+=p*(n&&l?-1:1);break}return f}const QQ=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:i}=n,s=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let l=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:d}=Sk(l,r,c),p=r,f={},y=0;for(let m=0;m<s.length;m++){const{name:v,fn:b}=s[m],{x:w,y:_,data:x,reset:j}=await b({x:u,y:d,initialPlacement:r,placement:p,strategy:a,middlewareData:f,rects:l,platform:i,elements:{reference:e,floating:t}});u=w??u,d=_??d,f={...f,[v]:{...f[v],...x}},j&&y<=50&&(y++,typeof j=="object"&&(j.placement&&(p=j.placement),j.rects&&(l=j.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):j.rects),{x:u,y:d}=Sk(l,p,c)),m=-1)}return{x:u,y:d,placement:p,strategy:a,middlewareData:f}};async function ru(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:o,rects:i,elements:s,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:f=0}=Ga(t,e),y=jk(f),m=s[p?d==="floating"?"reference":"floating":d],v=xf(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(m)))==null||n?m:m.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),b=d==="floating"?{x:r,y:a,width:i.floating.width,height:i.floating.height}:i.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),_=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},x=xf(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:w,strategy:c}):b);return{top:(v.top-x.top+y.top)/_.y,bottom:(x.bottom-v.bottom+y.bottom)/_.y,left:(v.left-x.left+y.left)/_.x,right:(x.right-v.right+y.right)/_.x}}const GQ=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:o,platform:i,elements:s,middlewareData:c}=t,{element:l,padding:u=0}=Ga(e,t)||{};if(l==null)return{};const d=jk(u),p={x:n,y:r},f=_0(a),y=x0(f),m=await i.getDimensions(l),v=f==="y",b=v?"top":"left",w=v?"bottom":"right",_=v?"clientHeight":"clientWidth",x=o.reference[y]+o.reference[f]-p[f]-o.floating[y],j=p[f]-o.reference[f],S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l));let E=S?S[_]:0;(!E||!await(i.isElement==null?void 0:i.isElement(S)))&&(E=s.floating[_]||o.floating[y]);const O=x/2-j/2,N=E/2-m[y]/2-1,M=ga(d[b],N),P=ga(d[w],N),I=M,k=E-m[y]-P,C=E/2-m[y]/2+O,T=b0(I,C,k),A=!c.arrow&&$s(a)!=null&&C!==T&&o.reference[y]/2-(C<I?M:P)-m[y]/2<0,R=A?C<I?C-I:C-k:0;return{[f]:p[f]+R,data:{[f]:T,centerOffset:C-T-R,...A&&{alignmentOffset:R}},reset:A}}}),JQ=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:i,initialPlacement:s,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:m=!0,...v}=Ga(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const b=Ja(a),w=Go(s),_=Ja(s)===s,x=await(c.isRTL==null?void 0:c.isRTL(l.floating)),j=p||(_||!m?[wf(s)]:HQ(s)),S=y!=="none";!p&&S&&j.push(...ZQ(s,m,y,x));const E=[s,...j],O=await ru(t,v),N=[];let M=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&N.push(O[b]),d){const C=qQ(a,i,x);N.push(O[C[0]],O[C[1]])}if(M=[...M,{placement:a,overflows:N}],!N.every(C=>C<=0)){var P,I;const C=(((P=o.flip)==null?void 0:P.index)||0)+1,T=E[C];if(T)return{data:{index:C,overflows:M},reset:{placement:T}};let A=(I=M.filter(R=>R.overflows[0]<=0).sort((R,L)=>R.overflows[1]-L.overflows[1])[0])==null?void 0:I.placement;if(!A)switch(f){case"bestFit":{var k;const R=(k=M.filter(L=>{if(S){const D=Go(L.placement);return D===w||D==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(D=>D>0).reduce((D,B)=>D+B,0)]).sort((L,D)=>L[1]-D[1])[0])==null?void 0:k[0];R&&(A=R);break}case"initialPlacement":A=s;break}if(a!==A)return{reset:{placement:A}}}return{}}}};function Ek(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Ok(e){return VQ.some(t=>e[t]>=0)}const YQ=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=Ga(e,t);switch(r){case"referenceHidden":{const o=await ru(t,{...a,elementContext:"reference"}),i=Ek(o,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Ok(i)}}}case"escaped":{const o=await ru(t,{...a,altBoundary:!0}),i=Ek(o,n.floating);return{data:{escapedOffsets:i,escaped:Ok(i)}}}default:return{}}}}};async function eG(e,t){const{placement:n,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),i=Ja(n),s=$s(n),c=Go(n)==="y",l=["left","top"].includes(i)?-1:1,u=o&&c?-1:1,d=Ga(t,e);let{mainAxis:p,crossAxis:f,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof y=="number"&&(f=s==="end"?y*-1:y),c?{x:f*u,y:p*l}:{x:p*l,y:f*u}}const tG=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:o,placement:i,middlewareData:s}=t,c=await eG(t,e);return i===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:a+c.x,y:o+c.y,data:{...c,placement:i}}}}},nG=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:s={fn:v=>{let{x:b,y:w}=v;return{x:b,y:w}}},...c}=Ga(e,t),l={x:n,y:r},u=await ru(t,c),d=Go(Ja(a)),p=w0(d);let f=l[p],y=l[d];if(o){const v=p==="y"?"top":"left",b=p==="y"?"bottom":"right",w=f+u[v],_=f-u[b];f=b0(w,f,_)}if(i){const v=d==="y"?"top":"left",b=d==="y"?"bottom":"right",w=y+u[v],_=y-u[b];y=b0(w,y,_)}const m=s.fn({...t,[p]:f,[d]:y});return{...m,data:{x:m.x-n,y:m.y-r}}}}},rG=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:o,middlewareData:i}=t,{offset:s=0,mainAxis:c=!0,crossAxis:l=!0}=Ga(e,t),u={x:n,y:r},d=Go(a),p=w0(d);let f=u[p],y=u[d];const m=Ga(s,t),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(c){const _=p==="y"?"height":"width",x=o.reference[p]-o.floating[_]+v.mainAxis,j=o.reference[p]+o.reference[_]-v.mainAxis;f<x?f=x:f>j&&(f=j)}if(l){var b,w;const _=p==="y"?"width":"height",x=["top","left"].includes(Ja(a)),j=o.reference[d]-o.floating[_]+(x&&((b=i.offset)==null?void 0:b[d])||0)+(x?0:v.crossAxis),S=o.reference[d]+o.reference[_]+(x?0:((w=i.offset)==null?void 0:w[d])||0)-(x?v.crossAxis:0);y<j?y=j:y>S&&(y=S)}return{[p]:f,[d]:y}}}},aG=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:a,elements:o}=t,{apply:i=()=>{},...s}=Ga(e,t),c=await ru(t,s),l=Ja(n),u=$s(n),d=Go(n)==="y",{width:p,height:f}=r.floating;let y,m;l==="top"||l==="bottom"?(y=l,m=u===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(m=l,y=u==="end"?"top":"bottom");const v=f-c.top-c.bottom,b=p-c.left-c.right,w=ga(f-c[y],v),_=ga(p-c[m],b),x=!t.middlewareData.shift;let j=w,S=_;if(d?S=u||x?ga(_,b):b:j=u||x?ga(w,v):v,x&&!u){const O=or(c.left,0),N=or(c.right,0),M=or(c.top,0),P=or(c.bottom,0);d?S=p-2*(O!==0||N!==0?O+N:or(c.left,c.right)):j=f-2*(M!==0||P!==0?M+P:or(c.top,c.bottom))}await i({...t,availableWidth:S,availableHeight:j});const E=await a.getDimensions(o.floating);return p!==E.width||f!==E.height?{reset:{rects:!0}}:{}}}};function Fs(e){return Ck(e)?(e.nodeName||"").toLowerCase():"#document"}function ir(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ya(e){var t;return(t=(Ck(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Ck(e){return e instanceof Node||e instanceof ir(e).Node}function $r(e){return e instanceof Element||e instanceof ir(e).Element}function va(e){return e instanceof HTMLElement||e instanceof ir(e).HTMLElement}function Nk(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ir(e).ShadowRoot}function au(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Fr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function oG(e){return["table","td","th"].includes(Fs(e))}function _f(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function S0(e){const t=E0(),n=$r(e)?Fr(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function iG(e){let t=Jo(e);for(;va(t)&&!Bs(t);){if(S0(t))return t;if(_f(t))return null;t=Jo(t)}return null}function E0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Bs(e){return["html","body","#document"].includes(Fs(e))}function Fr(e){return ir(e).getComputedStyle(e)}function jf(e){return $r(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Jo(e){if(Fs(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Nk(e)&&e.host||Ya(e);return Nk(t)?t.host:t}function Mk(e){const t=Jo(e);return Bs(t)?e.ownerDocument?e.ownerDocument.body:e.body:va(t)&&au(t)?t:Mk(t)}function ou(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=Mk(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),i=ir(a);if(o){const s=O0(i);return t.concat(i,i.visualViewport||[],au(a)?a:[],s&&n?ou(s):[])}return t.concat(a,ou(a,[],n))}function O0(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Pk(e){const t=Fr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=va(e),o=a?e.offsetWidth:n,i=a?e.offsetHeight:r,s=vf(n)!==o||vf(r)!==i;return s&&(n=o,r=i),{width:n,height:r,$:s}}function C0(e){return $r(e)?e:e.contextElement}function zs(e){const t=C0(e);if(!va(t))return Qo(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=Pk(t);let i=(o?vf(n.width):n.width)/r,s=(o?vf(n.height):n.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const sG=Qo(0);function kk(e){const t=ir(e);return!E0()||!t.visualViewport?sG:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function cG(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ir(e)?!1:t}function $i(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=C0(e);let i=Qo(1);t&&(r?$r(r)&&(i=zs(r)):i=zs(e));const s=cG(o,n,r)?kk(o):Qo(0);let c=(a.left+s.x)/i.x,l=(a.top+s.y)/i.y,u=a.width/i.x,d=a.height/i.y;if(o){const p=ir(o),f=r&&$r(r)?ir(r):r;let y=p,m=O0(y);for(;m&&r&&f!==y;){const v=zs(m),b=m.getBoundingClientRect(),w=Fr(m),_=b.left+(m.clientLeft+parseFloat(w.paddingLeft))*v.x,x=b.top+(m.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,l*=v.y,u*=v.x,d*=v.y,c+=_,l+=x,y=ir(m),m=O0(y)}}return xf({width:u,height:d,x:c,y:l})}function lG(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const o=a==="fixed",i=Ya(r),s=t?_f(t.floating):!1;if(r===i||s&&o)return n;let c={scrollLeft:0,scrollTop:0},l=Qo(1);const u=Qo(0),d=va(r);if((d||!d&&!o)&&((Fs(r)!=="body"||au(i))&&(c=jf(r)),va(r))){const p=$i(r);l=zs(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function uG(e){return Array.from(e.getClientRects())}function Ak(e){return $i(Ya(e)).left+jf(e).scrollLeft}function dG(e){const t=Ya(e),n=jf(e),r=e.ownerDocument.body,a=or(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=or(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+Ak(e);const s=-n.scrollTop;return Fr(r).direction==="rtl"&&(i+=or(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:i,y:s}}function pG(e,t){const n=ir(e),r=Ya(e),a=n.visualViewport;let o=r.clientWidth,i=r.clientHeight,s=0,c=0;if(a){o=a.width,i=a.height;const l=E0();(!l||l&&t==="fixed")&&(s=a.offsetLeft,c=a.offsetTop)}return{width:o,height:i,x:s,y:c}}function fG(e,t){const n=$i(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,o=va(e)?zs(e):Qo(1),i=e.clientWidth*o.x,s=e.clientHeight*o.y,c=a*o.x,l=r*o.y;return{width:i,height:s,x:c,y:l}}function Tk(e,t,n){let r;if(t==="viewport")r=pG(e,n);else if(t==="document")r=dG(Ya(e));else if($r(t))r=fG(t,n);else{const a=kk(e);r={...t,x:t.x-a.x,y:t.y-a.y}}return xf(r)}function Ik(e,t){const n=Jo(e);return n===t||!$r(n)||Bs(n)?!1:Fr(n).position==="fixed"||Ik(n,t)}function hG(e,t){const n=t.get(e);if(n)return n;let r=ou(e,[],!1).filter(s=>$r(s)&&Fs(s)!=="body"),a=null;const o=Fr(e).position==="fixed";let i=o?Jo(e):e;for(;$r(i)&&!Bs(i);){const s=Fr(i),c=S0(i);!c&&s.position==="fixed"&&(a=null),(o?!c&&!a:!c&&s.position==="static"&&a&&["absolute","fixed"].includes(a.position)||au(i)&&!c&&Ik(e,i))?r=r.filter(l=>l!==i):a=s,i=Jo(i)}return t.set(e,r),r}function mG(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const o=[...n==="clippingAncestors"?_f(t)?[]:hG(t,this._c):[].concat(n),r],i=o[0],s=o.reduce((c,l)=>{const u=Tk(t,l,a);return c.top=or(u.top,c.top),c.right=ga(u.right,c.right),c.bottom=ga(u.bottom,c.bottom),c.left=or(u.left,c.left),c},Tk(t,i,a));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function yG(e){const{width:t,height:n}=Pk(e);return{width:t,height:n}}function gG(e,t,n){const r=va(t),a=Ya(t),o=n==="fixed",i=$i(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const c=Qo(0);if(r||!r&&!o)if((Fs(t)!=="body"||au(a))&&(s=jf(t)),r){const d=$i(t,!0,o,t);c.x=d.x+t.clientLeft,c.y=d.y+t.clientTop}else a&&(c.x=Ak(a));const l=i.left+s.scrollLeft-c.x,u=i.top+s.scrollTop-c.y;return{x:l,y:u,width:i.width,height:i.height}}function N0(e){return Fr(e).position==="static"}function Rk(e,t){return!va(e)||Fr(e).position==="fixed"?null:t?t(e):e.offsetParent}function Dk(e,t){const n=ir(e);if(_f(e))return n;if(!va(e)){let a=Jo(e);for(;a&&!Bs(a);){if($r(a)&&!N0(a))return a;a=Jo(a)}return n}let r=Rk(e,t);for(;r&&oG(r)&&N0(r);)r=Rk(r,t);return r&&Bs(r)&&N0(r)&&!S0(r)?n:r||iG(e)||n}const vG=async function(e){const t=this.getOffsetParent||Dk,n=this.getDimensions,r=await n(e.floating);return{reference:gG(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function bG(e){return Fr(e).direction==="rtl"}const wG={convertOffsetParentRelativeRectToViewportRelativeRect:lG,getDocumentElement:Ya,getClippingRect:mG,getOffsetParent:Dk,getElementRects:vG,getClientRects:uG,getDimensions:yG,getScale:zs,isElement:$r,isRTL:bG};function xG(e,t){let n=null,r;const a=Ya(e);function o(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),o();const{left:l,top:u,width:d,height:p}=e.getBoundingClientRect();if(s||t(),!d||!p)return;const f=bf(u),y=bf(a.clientWidth-(l+d)),m=bf(a.clientHeight-(u+p)),v=bf(l),b={rootMargin:-f+"px "+-y+"px "+-m+"px "+-v+"px",threshold:or(0,ga(1,c))||1};let w=!0;function _(x){const j=x[0].intersectionRatio;if(j!==c){if(!w)return i();j?i(!1,j):r=setTimeout(()=>{i(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(_,{...b,root:a.ownerDocument})}catch{n=new IntersectionObserver(_,b)}n.observe(e)}return i(!0),o}Rg=function(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=C0(e),u=a||o?[...l?ou(l):[],...ou(t)]:[];u.forEach(b=>{a&&b.addEventListener("scroll",n,{passive:!0}),o&&b.addEventListener("resize",n)});const d=l&&s?xG(l,n):null;let p=-1,f=null;i&&(f=new ResizeObserver(b=>{let[w]=b;w&&w.target===l&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var _;(_=f)==null||_.observe(t)})),n()}),l&&!c&&f.observe(l),f.observe(t));let y,m=c?$i(e):null;c&&v();function v(){const b=$i(e);m&&(b.x!==m.x||b.y!==m.y||b.width!==m.width||b.height!==m.height)&&n(),m=b,y=requestAnimationFrame(v)}return n(),()=>{var b;u.forEach(w=>{a&&w.removeEventListener("scroll",n),o&&w.removeEventListener("resize",n)}),d==null||d(),(b=f)==null||b.disconnect(),f=null,c&&cancelAnimationFrame(y)}};let Lk;BN=tG,eM=nG,zN=JQ,nM=aG,Lk=YQ,Jg=GQ,tM=rG,VN=(e,t,n)=>{const r=new Map,a={platform:wG,...n},o={...a.platform,_c:r};return QQ(e,t,{...a,platform:o})};var Sf=typeof document<"u"?g.useLayoutEffect:g.useEffect;function Ef(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Ef(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Ef(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function $k(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Fk(e,t){const n=$k(e);return Math.round(t*n)/n}function Bk(e){const t=g.useRef(e);return Sf(()=>{t.current=e}),t}Xg=function(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:i}={},transform:s=!0,whileElementsMounted:c,open:l}=e,[u,d]=g.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,f]=g.useState(r);Ef(p,r)||f(r);const[y,m]=g.useState(null),[v,b]=g.useState(null),w=g.useCallback(R=>{R!==S.current&&(S.current=R,m(R))},[]),_=g.useCallback(R=>{R!==E.current&&(E.current=R,b(R))},[]),x=o||y,j=i||v,S=g.useRef(null),E=g.useRef(null),O=g.useRef(u),N=c!=null,M=Bk(c),P=Bk(a),I=g.useCallback(()=>{if(!S.current||!E.current)return;const R={placement:t,strategy:n,middleware:p};P.current&&(R.platform=P.current),VN(S.current,E.current,R).then(L=>{const D={...L,isPositioned:!0};k.current&&!Ef(O.current,D)&&(O.current=D,Nl.flushSync(()=>{d(D)}))})},[p,t,n,P]);Sf(()=>{l===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,d(R=>({...R,isPositioned:!1})))},[l]);const k=g.useRef(!1);Sf(()=>(k.current=!0,()=>{k.current=!1}),[]),Sf(()=>{if(x&&(S.current=x),j&&(E.current=j),x&&j){if(M.current)return M.current(x,j,I);I()}},[x,j,I,M,N]);const C=g.useMemo(()=>({reference:S,floating:E,setReference:w,setFloating:_}),[w,_]),T=g.useMemo(()=>({reference:x,floating:j}),[x,j]),A=g.useMemo(()=>{const R={position:n,left:0,top:0};if(!T.floating)return R;const L=Fk(T.floating,u.x),D=Fk(T.floating,u.y);return s?{...R,transform:"translate("+L+"px, "+D+"px)",...$k(T.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:L,top:D}},[n,s,T.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:I,refs:C,elements:T,floatingStyles:A}),[u,I,C,T,A])};let zk;zk=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Jg({element:r.current,padding:a}).fn(n):{}:r?Jg({element:r,padding:a}).fn(n):{}}}},Lg=(e,t)=>({...BN(e),options:[e,t]}),cv=(e,t)=>({...eM(e),options:[e,t]}),lv=(e,t)=>({...tM(e),options:[e,t]}),uv=(e,t)=>({...zN(e),options:[e,t]}),dv=(e,t)=>({...nM(e),options:[e,t]}),fv=(e,t)=>({...Lk(e),options:[e,t]}),pv=(e,t)=>({...zk(e),options:[e,t]});var _G="Arrow",Vk=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Ae.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});Vk.displayName=_G;var jG=Vk;function SG(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:p,children:f,...y}=d,m=(p==null?void 0:p[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:f})}function u(d,p){const f=(p==null?void 0:p[e][c])||s,y=g.useContext(f);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,EG(a,...t)]}function EG(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}zp=function(e){const[t,n]=g.useState(void 0);return tn(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let i,s;if("borderBoxSize"in o){const c=o.borderBoxSize,l=Array.isArray(c)?c[0]:c;i=l.inlineSize,s=l.blockSize}else i=e.offsetWidth,s=e.offsetHeight;n({width:i,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t};var M0="Popper",[Wk,Vs]=SG(M0),[OG,Uk]=Wk(M0),qk=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(OG,{scope:t,anchor:r,onAnchorChange:a,children:n})};qk.displayName=M0;var Hk="PopperAnchor",Kk=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=Uk(Hk,n),i=g.useRef(null),s=wt(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Ae.div,{...a,ref:s})});Kk.displayName=Hk;var P0="PopperContent",[CG,NG]=Wk(P0),Zk=g.forwardRef((e,t)=>{var J,K,q,G,ne,z;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:y,...m}=e,v=Uk(P0,n),[b,w]=g.useState(null),_=wt(t,se=>w(se)),[x,j]=g.useState(null),S=zp(x),E=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,N=r+(o!=="center"?"-"+o:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(l)?l:[l],I=P.length>0,k={padding:M,boundary:P.filter(PG),altBoundary:I},{refs:C,floatingStyles:T,placement:A,isPositioned:R,middlewareData:L}=Xg({strategy:"fixed",placement:N,whileElementsMounted:(...se)=>Rg(...se,{animationFrame:f==="always"}),elements:{reference:v.anchor},middleware:[Lg({mainAxis:a+O,alignmentAxis:i}),c&&cv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?lv():void 0,...k}),c&&uv({...k}),dv({...k,apply:({elements:se,rects:re,availableWidth:le,availableHeight:je})=>{const{width:Le,height:$e}=re.reference,Se=se.floating.style;Se.setProperty("--radix-popper-available-width",`${le}px`),Se.setProperty("--radix-popper-available-height",`${je}px`),Se.setProperty("--radix-popper-anchor-width",`${Le}px`),Se.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&pv({element:x,padding:s}),kG({arrowWidth:E,arrowHeight:O}),p&&fv({strategy:"referenceHidden",...k})]}),[D,B]=Gk(A),F=tr(y);tn(()=>{R&&(F==null||F())},[R,F]);const $=(J=L.arrow)==null?void 0:J.x,V=(K=L.arrow)==null?void 0:K.y,Q=((q=L.arrow)==null?void 0:q.centerOffset)!==0,[X,H]=g.useState();return tn(()=>{b&&H(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:R?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:X,"--radix-popper-transform-origin":[(G=L.transformOrigin)==null?void 0:G.x,(ne=L.transformOrigin)==null?void 0:ne.y].join(" "),...((z=L.hide)==null?void 0:z.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(CG,{scope:n,placedSide:D,onArrowChange:j,arrowX:$,arrowY:V,shouldHideArrow:Q,children:h.jsx(Ae.div,{"data-side":D,"data-align":B,...m,ref:_,style:{...m.style,animation:R?void 0:"none"}})})})});Zk.displayName=P0;var Xk="PopperArrow",MG={top:"bottom",right:"left",bottom:"top",left:"right"},Qk=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=NG(Xk,n),o=MG[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(jG,{...r,ref:t,style:{...r.style,display:"block"}})})});Qk.displayName=Xk;function PG(e){return e!==null}var kG=e=>({name:"transformOrigin",options:e,fn(t){var m,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((m=a.arrow)==null?void 0:m.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=Gk(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,p=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let f="",y="";return c==="bottom"?(f=o?u:`${d}px`,y=`${-s}px`):c==="top"?(f=o?u:`${d}px`,y=`${r.floating.height+s}px`):c==="right"?(f=`${-s}px`,y=o?u:`${p}px`):c==="left"&&(f=`${r.floating.width+s}px`,y=o?u:`${p}px`),{data:{x:f,y}}}});function Gk(e){const[t,n="center"]=e.split("-");return[t,n]}var Of=qk,k0=Kk,A0=Zk,T0=Qk,[Cf,o2e]=er("Tooltip",[Vs]),Nf=Vs(),Jk="TooltipProvider",AG=700,I0="tooltip.open",[TG,R0]=Cf(Jk),Yk=e=>{const{__scopeTooltip:t,delayDuration:n=AG,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:o}=e,[i,s]=g.useState(!0),c=g.useRef(!1),l=g.useRef(0);return g.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),h.jsx(TG,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:g.useCallback(u=>{c.current=u},[]),disableHoverableContent:a,children:o})};Yk.displayName=Jk;var Mf="Tooltip",[IG,iu]=Cf(Mf),eA=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a=!1,onOpenChange:o,disableHoverableContent:i,delayDuration:s}=e,c=R0(Mf,e.__scopeTooltip),l=Nf(t),[u,d]=g.useState(null),p=Pt(),f=g.useRef(0),y=i??c.disableHoverableContent,m=s??c.delayDuration,v=g.useRef(!1),[b=!1,w]=Sn({prop:r,defaultProp:a,onChange:E=>{E?(c.onOpen(),document.dispatchEvent(new CustomEvent(I0))):c.onClose(),o==null||o(E)}}),_=g.useMemo(()=>b?v.current?"delayed-open":"instant-open":"closed",[b]),x=g.useCallback(()=>{window.clearTimeout(f.current),f.current=0,v.current=!1,w(!0)},[w]),j=g.useCallback(()=>{window.clearTimeout(f.current),f.current=0,w(!1)},[w]),S=g.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{v.current=!0,w(!0),f.current=0},m)},[m,w]);return g.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),h.jsx(Of,{...l,children:h.jsx(IG,{scope:t,contentId:p,open:b,stateAttribute:_,trigger:u,onTriggerChange:d,onTriggerEnter:g.useCallback(()=>{c.isOpenDelayed?S():x()},[c.isOpenDelayed,S,x]),onTriggerLeave:g.useCallback(()=>{y?j():(window.clearTimeout(f.current),f.current=0)},[j,y]),onOpen:x,onClose:j,disableHoverableContent:y,children:n})})};eA.displayName=Mf;var D0="TooltipTrigger",tA=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=iu(D0,n),o=R0(D0,n),i=Nf(n),s=g.useRef(null),c=wt(t,s,a.onTriggerChange),l=g.useRef(!1),u=g.useRef(!1),d=g.useCallback(()=>l.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),h.jsx(k0,{asChild:!0,...i,children:h.jsx(Ae.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:c,onPointerMove:ge(e.onPointerMove,p=>{p.pointerType!=="touch"&&!u.current&&!o.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:ge(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:ge(e.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ge(e.onFocus,()=>{l.current||a.onOpen()}),onBlur:ge(e.onBlur,a.onClose),onClick:ge(e.onClick,a.onClose)})})});tA.displayName=D0;var L0="TooltipPortal",[RG,DG]=Cf(L0,{forceMount:void 0}),nA=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:a}=e,o=iu(L0,t);return h.jsx(RG,{scope:t,forceMount:n,children:h.jsx(Mr,{present:n||o.open,children:h.jsx(Cg,{asChild:!0,container:a,children:r})})})};nA.displayName=L0;var Ws="TooltipContent",rA=g.forwardRef((e,t)=>{const n=DG(Ws,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...o}=e,i=iu(Ws,e.__scopeTooltip);return h.jsx(Mr,{present:r||i.open,children:i.disableHoverableContent?h.jsx(aA,{side:a,...o,ref:t}):h.jsx(LG,{side:a,...o,ref:t})})}),LG=g.forwardRef((e,t)=>{const n=iu(Ws,e.__scopeTooltip),r=R0(Ws,e.__scopeTooltip),a=g.useRef(null),o=wt(t,a),[i,s]=g.useState(null),{trigger:c,onClose:l}=n,u=a.current,{onPointerInTransitChange:d}=r,p=g.useCallback(()=>{s(null),d(!1)},[d]),f=g.useCallback((y,m)=>{const v=y.currentTarget,b={x:y.clientX,y:y.clientY},w=zG(b,v.getBoundingClientRect()),_=VG(b,w),x=WG(m.getBoundingClientRect()),j=qG([..._,...x]);s(j),d(!0)},[d]);return g.useEffect(()=>()=>p(),[p]),g.useEffect(()=>{if(c&&u){const y=v=>f(v,u),m=v=>f(v,c);return c.addEventListener("pointerleave",y),u.addEventListener("pointerleave",m),()=>{c.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",m)}}},[c,u,f,p]),g.useEffect(()=>{if(i){const y=m=>{const v=m.target,b={x:m.clientX,y:m.clientY},w=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),_=!UG(b,i);w?p():_&&(p(),l())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[c,u,i,l,p]),h.jsx(aA,{...e,ref:o})}),[$G,FG]=Cf(Mf,{isInside:!1}),aA=g.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:o,onPointerDownOutside:i,...s}=e,c=iu(Ws,n),l=Nf(n),{onClose:u}=c;return g.useEffect(()=>(document.addEventListener(I0,u),()=>document.removeEventListener(I0,u)),[u]),g.useEffect(()=>{if(c.trigger){const d=p=>{var f;(f=p.target)!=null&&f.contains(c.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[c.trigger,u]),h.jsx(Og,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:h.jsxs(A0,{"data-state":c.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[h.jsx(oK,{children:r}),h.jsx($G,{scope:n,isInside:!0,children:h.jsx(hAe,{id:c.contentId,role:"tooltip",children:a||r})})]})})});rA.displayName=Ws;var oA="TooltipArrow",BG=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=Nf(n);return FG(oA,n).isInside?null:h.jsx(T0,{...a,...r,ref:t})});BG.displayName=oA;function zG(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(n,r,a,o)){case o:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function VG(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function WG(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function UG(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function qG(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),HG(t)}function HG(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const o=n[n.length-1],i=n[n.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}WN=Yk,UN=eA,qN=tA,SK=nA,Fg=rA;const su=WN,ba=UN,wa=qN,Br=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(Fg,{ref:r,sideOffset:t,className:Z("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));Br.displayName=Fg.displayName;const KG="sidebar:state",ZG=60*60*24*7,XG="16rem",QG="18rem",GG="3rem",JG="b",iA=g.createContext(null);function cu(){const e=g.useContext(iA);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const $0=g.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:a,children:o,...i},s)=>{const c=YX(),[l,u]=g.useState(!1),[d,p]=g.useState(e),f=t??d,y=g.useCallback(w=>{const _=typeof w=="function"?w(f):w;n?n(_):p(_),document.cookie=`${KG}=${_}; path=/; max-age=${ZG}`},[n,f]),m=g.useCallback(()=>c?u(w=>!w):y(w=>!w),[c,y,u]);g.useEffect(()=>{const w=_=>{_.key===JG&&(_.metaKey||_.ctrlKey)&&(_.preventDefault(),m())};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[m]);const v=f?"expanded":"collapsed",b=g.useMemo(()=>({state:v,open:f,setOpen:y,isMobile:c,openMobile:l,setOpenMobile:u,toggleSidebar:m}),[v,f,y,c,l,u,m]);return h.jsx(iA.Provider,{value:b,children:h.jsx(su,{delayDuration:0,children:h.jsx("div",{style:{"--sidebar-width":XG,"--sidebar-width-icon":GG,...a},className:Z("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:s,...i,children:o})})})});$0.displayName="SidebarProvider";const F0=g.forwardRef(({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:r,children:a,...o},i)=>{const{isMobile:s,state:c,openMobile:l,setOpenMobile:u}=cu();return n==="none"?h.jsx("div",{className:Z("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:i,...o,children:a}):s?h.jsx(LQ,{open:l,onOpenChange:u,...o,children:h.jsx(xk,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":QG},side:e,children:h.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):h.jsxs("div",{ref:i,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?n:"","data-variant":t,"data-side":e,children:[h.jsx("div",{className:Z("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),h.jsx("div",{className:Z("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...o,children:h.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});F0.displayName="Sidebar";const sA=g.forwardRef(({className:e,onClick:t,...n},r)=>{const{toggleSidebar:a}=cu();return h.jsx(ut,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Z("h-7 w-7",e),onClick:o=>{t==null||t(o),a()},...n,children:h.jsx(de,{size:32,name:"panel-left"})})});sA.displayName="SidebarTrigger";const cA=g.forwardRef(({className:e,...t},n)=>{const{toggleSidebar:r}=cu();return h.jsx("button",{ref:n,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:Z("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});cA.displayName="SidebarRail";const B0=g.forwardRef(({className:e,...t},n)=>h.jsx("main",{ref:n,className:Z("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));B0.displayName="SidebarInset";const YG=g.forwardRef(({className:e,...t},n)=>h.jsx(En,{ref:n,"data-sidebar":"input",className:Z("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));YG.displayName="SidebarInput";const eJ=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"header",className:Z("flex flex-col gap-2 p-2",e),...t}));eJ.displayName="SidebarHeader";const lA=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"footer",className:Z("flex flex-col gap-2 p-2",e),...t}));lA.displayName="SidebarFooter";const tJ=g.forwardRef(({className:e,...t},n)=>h.jsx(Ms,{ref:n,"data-sidebar":"separator",className:Z("mx-2 w-auto bg-sidebar-border",e),...t}));tJ.displayName="SidebarSeparator";const z0=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"content",className:Z("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));z0.displayName="SidebarContent";const lu=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group",className:Z("relative flex w-full min-w-0 flex-col p-2",e),...t}));lu.displayName="SidebarGroup";const uu=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?zo:"div";return h.jsx(a,{ref:r,"data-sidebar":"group-label",className:Z("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...n})});uu.displayName="SidebarGroupLabel";const nJ=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?zo:"button";return h.jsx(a,{ref:r,"data-sidebar":"group-action",className:Z("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...n})});nJ.displayName="SidebarGroupAction";const rJ=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group-content",className:Z("w-full text-sm",e),...t}));rJ.displayName="SidebarGroupContent";const Us=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu",className:Z("flex w-full min-w-0 flex-col gap-1",e),...t}));Us.displayName="SidebarMenu";const eo=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,"data-sidebar":"menu-item",className:Z("group/menu-item relative",e),...t}));eo.displayName="SidebarMenuItem";const aJ=qa("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),to=g.forwardRef(({asChild:e=!1,isActive:t=!1,variant:n="default",size:r="default",tooltip:a,className:o,...i},s)=>{const c=e?zo:"button",{isMobile:l,state:u}=cu(),d=h.jsx(c,{ref:s,"data-sidebar":"menu-button","data-size":r,"data-active":t,className:Z(aJ({variant:n,size:r}),o),...i});return a?(typeof a=="string"&&(a={children:a}),h.jsxs(ba,{children:[h.jsx(wa,{asChild:!0,children:d}),h.jsx(Br,{side:"right",align:"center",hidden:u!=="collapsed"||l,...a})]})):d});to.displayName="SidebarMenuButton";const oJ=g.forwardRef(({className:e,asChild:t=!1,showOnHover:n=!1,...r},a)=>{const o=t?zo:"button";return h.jsx(o,{ref:a,"data-sidebar":"menu-action",className:Z("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})});oJ.displayName="SidebarMenuAction";const iJ=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"menu-badge",className:Z("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));iJ.displayName="SidebarMenuBadge";const sJ=g.forwardRef(({className:e,showIcon:t=!1,...n},r)=>{const a=g.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return h.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:Z("rounded-md h-8 flex gap-2 px-2 items-center",e),...n,children:[t&&h.jsx(_k,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),h.jsx(_k,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});sJ.displayName="SidebarMenuSkeleton";const uA=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu-sub",className:Z("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));uA.displayName="SidebarMenuSub";const dA=g.forwardRef(({...e},t)=>h.jsx("li",{ref:t,...e}));dA.displayName="SidebarMenuSubItem";const pA=g.forwardRef(({asChild:e=!1,size:t="md",isActive:n,className:r,...a},o)=>{const i=e?zo:"a";return h.jsx(i,{ref:o,"data-sidebar":"menu-sub-button","data-size":t,"data-active":n,className:Z("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...a})});pA.displayName="SidebarMenuSubButton";const cJ="hash",Pf={application:"/application/:applicationId?",whiteboard:"/whiteboard/:sessionId?",document:"/document/:documentId?"},yn=(e,t)=>{let n=Pf[e];return t?n=Object.keys(t||{}).reduce((r,a)=>r.replace(`:${a}`,(t==null?void 0:t[a])||""),n):n=n.replace(/\/:[^/]+/g,""),n!=null&&n.endsWith("?")?n.slice(0,-1):n},lJ=()=>{{const[,e]=window.location.hash.split("?");return new URLSearchParams(`?${e}`)}};function uJ({items:e}){const{t}=Pe("documents");return h.jsxs(lu,{children:[h.jsx(uu,{children:h.jsx("div",{className:"text-sm",children:t("title")})}),h.jsx(Us,{children:e.map(n=>{var r;return h.jsx(QX,{asChild:!0,defaultOpen:n.isActive,className:"group/collapsible",children:h.jsxs(eo,{children:[h.jsx(GX,{asChild:!0,children:h.jsxs(to,{className:"cursor-pointer",tooltip:t(n.title),children:[n.icon,h.jsx("span",{children:t(n.title)}),h.jsx(de,{name:"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),h.jsx(JX,{children:h.jsx(uA,{children:(r=n.items)==null?void 0:r.map(a=>h.jsx(dA,{className:"cursor-pointer",children:h.jsx(pA,{asChild:!0,children:h.jsx(Qv,{to:yn("document",{documentId:a.id}),children:h.jsx("span",{children:t(a.title)})})})},t(a.title)))})})]})},n.title)})})]})}const dJ=g.memo(({text:e,colors:t={first:"#9E7AFF",second:"#FE8BBB"},className:n,sparklesCount:r=10,...a})=>{const[o,i]=g.useState([]);return g.useEffect(()=>{const s=()=>{const d=`${Math.random()*100}%`,p=`${Math.random()*100}%`,f=Math.random()>.5?t.first:t.second,y=Math.random()*2,m=Math.random()*1+.3,v=Math.random()*10+5;return{id:`${d}-${p}-${Date.now()}`,x:d,y:p,color:f,delay:y,scale:m,lifespan:v}},c=()=>{const d=Array.from({length:r},s);i(d)},l=()=>{i(d=>d.map(p=>p.lifespan<=0?s():{...p,lifespan:p.lifespan-.1}))};c();const u=setInterval(l,100);return()=>clearInterval(u)},[t.first,t.second]),h.jsx("div",{className:Z("text-6xl font-bold",n),...a,style:{"--sparkles-first-color":`${t.first}`,"--sparkles-second-color":`${t.second}`},children:h.jsxs("span",{className:"relative inline-block",children:[o.map(s=>h.jsx(pJ,{...s},s.id)),h.jsx("strong",{children:e})]})})},(e,t)=>e.text===t.text),pJ=({id:e,x:t,y:n,color:r,delay:a,scale:o})=>h.jsx(Ap.svg,{className:"pointer-events-none absolute z-20",initial:{opacity:0,left:t,top:n},animate:{opacity:[0,1,0],scale:[0,o,0],rotate:[75,120,150]},transition:{duration:.8,repeat:1/0,delay:a},width:"21",height:"21",viewBox:"0 0 21 21",children:h.jsx("path",{d:"M9.82531 0.843845C10.0553 0.215178 10.9446 0.215178 11.1746 0.843845L11.8618 2.72026C12.4006 4.19229 12.3916 6.39157 13.5 7.5C14.6084 8.60843 16.8077 8.59935 18.2797 9.13822L20.1561 9.82534C20.7858 10.0553 20.7858 10.9447 20.1561 11.1747L18.2797 11.8618C16.8077 12.4007 14.6084 12.3916 13.5 13.5C12.3916 14.6084 12.4006 16.8077 11.8618 18.2798L11.1746 20.1562C10.9446 20.7858 10.0553 20.7858 9.82531 20.1562L9.13819 18.2798C8.59932 16.8077 8.60843 14.6084 7.5 13.5C6.39157 12.3916 4.19225 12.4007 2.72023 11.8618L0.843814 11.1747C0.215148 10.9447 0.215148 10.0553 0.843814 9.82534L2.72023 9.13822C4.19225 8.59935 6.39157 8.60843 7.5 7.5C8.60843 6.39157 8.59932 4.19229 9.13819 2.72026L9.82531 0.843845Z",fill:r})},e);function fJ({className:e,onClick:t}){const{t:n}=Pe("sidebar");return h.jsxs(to,{className:Z(e,"tw-w-full"),onClick:t,children:[h.jsx(de,{name:"frame"}),h.jsx(dJ,{text:n("new_session"),className:"text-sm",sparklesCount:3})]})}const hJ=()=>{const[e,t]=g.useState(!1),n=Ye(i=>i.setCurrentSession),r=Ye(i=>i.createSession),a=Vo(i=>i.setSelectedSessionId),o=g.useCallback(async i=>{try{t(!0);const s=await r(i);n(s),a(s.id)}finally{t(!1)}},[r,n,a]);return{loading:e,createSession:o}},Yo=Dl,mJ=Ll,fA=g.forwardRef(({className:e,...t},n)=>h.jsx(Mi,{ref:n,className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));fA.displayName=Mi.displayName;const no=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(mJ,{children:[h.jsx(fA,{}),h.jsxs(Pi,{ref:r,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,h.jsxs($l,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(de,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));no.displayName=Pi.displayName;const ro=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});ro.displayName="DialogHeader";const du=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});du.displayName="DialogFooter";const ao=g.forwardRef(({className:e,...t},n)=>h.jsx(Os,{ref:n,className:Z("text-lg font-semibold leading-none tracking-tight",e),...t}));ao.displayName=Os.displayName;const pu=g.forwardRef(({className:e,...t},n)=>h.jsx(Cs,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));pu.displayName=Cs.displayName;var yJ="Label",hA=g.forwardRef((e,t)=>h.jsx(Ae.label,{...e,ref:t,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=e.onMouseDown)==null||r.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));hA.displayName=yJ;var mA=hA;let yA;yA=qa("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),nt=g.forwardRef(({className:e,...t},n)=>h.jsx(mA,{ref:n,className:Z(yA(),e),...t})),nt.displayName=mA.displayName;const gJ=Ha(()=>{const e=Xt(),{t}=Pe("dialogs"),[n,r]=g.useState(""),{toast:a}=Qt(),{loading:o,createSession:i}=hJ(),s=l=>{r(l.target.value)},c=async()=>{try{await i({name:n}),r(""),e.hide()}catch{a({variant:"destructive",description:t("create_session.errors.create_failed")})}};return h.jsx(Yo,{open:e.visible,onOpenChange:e.hide,children:h.jsxs(no,{className:"sm:max-w-[425px]",children:[h.jsxs(ro,{children:[h.jsx(ao,{children:t("create_session.title")}),h.jsx(pu,{children:t("create_session.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{className:"mb-2",htmlFor:"name",children:t("create_session.name")}),h.jsx(En,{onChange:s,id:"name",value:n,placeholder:t("create_session.name_placeholder")})]})}),h.jsx(du,{children:h.jsx(ut,{onClick:c,disabled:o||!n,type:"submit",children:t("create_session.create")})})]})})}),vJ=()=>{const[e,t]=g.useState(!1),n=Ye(a=>a.deleteSession),r=g.useCallback(async a=>{try{t(!0),await n(a),await Promise.all([ue("FlowEdge").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>ue("FlowEdge").delete(i.id)))),ue("FlowNode").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>ue("FlowNode").delete(i.id))))])}finally{t(!1)}},[n]);return{loading:e,deleteSession:r}};var gA="AlertDialog",[bJ,i2e]=er(gA,[p0]),oo=p0(),vA=e=>{const{__scopeAlertDialog:t,...n}=e,r=oo(t);return h.jsx(Dl,{...r,...n,modal:!0})};vA.displayName=gA;var wJ="AlertDialogTrigger",xJ=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=oo(n);return h.jsx(bk,{...a,...r,ref:t})});xJ.displayName=wJ;var _J="AlertDialogPortal",bA=e=>{const{__scopeAlertDialog:t,...n}=e,r=oo(t);return h.jsx(Ll,{...r,...n})};bA.displayName=_J;var jJ="AlertDialogOverlay",wA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=oo(n);return h.jsx(Mi,{...a,...r,ref:t})});wA.displayName=jJ;var qs="AlertDialogContent",[SJ,EJ]=bJ(qs),xA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,o=oo(n),i=g.useRef(null),s=wt(t,i),c=g.useRef(null);return h.jsx(mk,{contentName:qs,titleName:_A,docsSlug:"alert-dialog",children:h.jsx(SJ,{scope:n,cancelRef:c,children:h.jsxs(Pi,{role:"alertdialog",...o,...a,ref:s,onOpenAutoFocus:ge(a.onOpenAutoFocus,l=>{var u;l.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[h.jsx(oK,{children:r}),h.jsx(MA,{contentRef:i})]})})})});xA.displayName=qs;var _A="AlertDialogTitle",jA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=oo(n);return h.jsx(Os,{...a,...r,ref:t})});jA.displayName=_A;var SA="AlertDialogDescription",EA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=oo(n);return h.jsx(Cs,{...a,...r,ref:t})});EA.displayName=SA;var OJ="AlertDialogAction",OA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=oo(n);return h.jsx($l,{...a,...r,ref:t})});OA.displayName=OJ;var CA="AlertDialogCancel",NA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=EJ(CA,n),o=oo(n),i=wt(t,a);return h.jsx($l,{...o,...r,ref:i})});NA.displayName=CA;let MA;MA=({contentRef:e})=>{const t=`\`${qs}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${qs}\` by passing a \`${SA}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${qs}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return g.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},XN=vA,ZN=bA,Wg=wA,Ug=xA,Kg=OA,Zg=NA,qg=jA,Hg=EA;const PA=XN,CJ=ZN,kA=g.forwardRef(({className:e,...t},n)=>h.jsx(Wg,{className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));kA.displayName=Wg.displayName;const V0=g.forwardRef(({className:e,...t},n)=>h.jsxs(CJ,{children:[h.jsx(kA,{}),h.jsx(Ug,{ref:n,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));V0.displayName=Ug.displayName;const W0=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col space-y-2 text-center sm:text-left",e),...t});W0.displayName="AlertDialogHeader";const U0=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});U0.displayName="AlertDialogFooter";const q0=g.forwardRef(({className:e,...t},n)=>h.jsx(qg,{ref:n,className:Z("text-lg font-semibold",e),...t}));q0.displayName=qg.displayName;const H0=g.forwardRef(({className:e,...t},n)=>h.jsx(Hg,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));H0.displayName=Hg.displayName;const K0=g.forwardRef(({className:e,...t},n)=>h.jsx(Kg,{ref:n,className:Z(eu(),e),...t}));K0.displayName=Kg.displayName;const Z0=g.forwardRef(({className:e,...t},n)=>h.jsx(Zg,{ref:n,className:Z(eu({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Z0.displayName=Zg.displayName;const AA=Ha(({id:e})=>{const{t}=Pe("dialogs"),n=Xt(),{toast:r}=Qt(),{deleteSession:a,loading:o}=vJ(),i=async()=>{try{await a(e),n.hide()}catch{r({variant:"destructive",description:t("delete_session.errors.delete_failed")})}};return h.jsx(PA,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(V0,{children:[h.jsxs(W0,{children:[h.jsx(q0,{children:t("delete_session.title")}),h.jsx(H0,{children:t("delete_session.description")})]}),h.jsxs(U0,{children:[h.jsx(Z0,{onClick:n.hide,children:t("delete_session.cancel")}),h.jsx(K0,{disabled:o,onClick:i,children:t("delete_session.delete")})]})]})})});function NJ({sessions:e,currentSession:t,setCurrentSession:n}){const{t:r}=Pe("sidebar"),a=Ii(),o=Xt(gJ),i=Xt(AA),s=g.useCallback(()=>{o.show({})},[o]),c=g.useCallback((u,d)=>{u.preventDefault(),u.stopPropagation(),i.show({id:d})},[i]),l=u=>{n(u),a(yn("whiteboard",{sessionId:u.id}))};return h.jsxs(lu,{className:"group-data-[collapsible=icon]:hidden",children:[h.jsx(uu,{children:h.jsx("div",{className:"text-sm",children:r("sessions")})}),h.jsxs(Us,{children:[h.jsx(eo,{children:h.jsx(fJ,{onClick:s,className:"w-full"})}),e.map(u=>h.jsx(eo,{className:"cursor-pointer",children:h.jsx(to,{asChild:!0,onClick:()=>l(u),children:h.jsxs("div",{className:"flex flex-row justify-between items-center",children:[h.jsxs("div",{className:"flex gap-2",children:[(t==null?void 0:t.id)===u.id?h.jsx(de,{size:16,color:"green",name:"check"}):h.jsx(de,{size:16,name:"chevron-right"}),h.jsx("span",{children:u.name})]}),h.jsx(de,{onClick:d=>c(d,u.id),size:16,name:"trash-2",className:"!z-50"})]})})},u.id)),e!=null&&e.length?h.jsx(eo,{children:h.jsxs(to,{className:"text-sidebar-foreground/70",children:[h.jsx(de,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}var MJ=g.createContext(void 0);Uo=function(e){const t=g.useContext(MJ);return e||t||"ltr"};function PJ(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:p,children:f,...y}=d,m=(p==null?void 0:p[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:f})}function u(d,p){const f=(p==null?void 0:p[e][c])||s,y=g.useContext(f);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,kJ(a,...t)]}function kJ(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}let kf,TA,fu,Af,X0,IA,RA,DA,LA,Q0;kf="rovingFocusGroup.onEntryFocus",TA={bubbles:!1,cancelable:!0},fu="RovingFocusGroup",[Af,X0,IA]=Tp(fu),[RA,Za]=PJ(fu,[IA]),[DA,LA]=RA(fu),Q0=g.forwardRef((e,t)=>h.jsx(Af.Provider,{scope:e.__scopeRovingFocusGroup,children:h.jsx(Af.Slot,{scope:e.__scopeRovingFocusGroup,children:h.jsx(AJ,{...e,ref:t})})})),Q0.displayName=fu;var AJ=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=e,p=g.useRef(null),f=wt(t,p),y=Uo(o),[m=null,v]=Sn({prop:i,defaultProp:s,onChange:c}),[b,w]=g.useState(!1),_=tr(l),x=X0(n),j=g.useRef(!1),[S,E]=g.useState(0);return g.useEffect(()=>{const O=p.current;if(O)return O.addEventListener(kf,_),()=>O.removeEventListener(kf,_)},[_]),h.jsx(DA,{scope:n,orientation:r,dir:y,loop:a,currentTabStopId:m,onItemFocus:g.useCallback(O=>v(O),[v]),onItemShiftTab:g.useCallback(()=>w(!0),[]),onFocusableItemAdd:g.useCallback(()=>E(O=>O+1),[]),onFocusableItemRemove:g.useCallback(()=>E(O=>O-1),[]),children:h.jsx(Ae.div,{tabIndex:b||S===0?-1:0,"data-orientation":r,...d,ref:f,style:{outline:"none",...e.style},onMouseDown:ge(e.onMouseDown,()=>{j.current=!0}),onFocus:ge(e.onFocus,O=>{const N=!j.current;if(O.target===O.currentTarget&&N&&!b){const M=new CustomEvent(kf,TA);if(O.currentTarget.dispatchEvent(M),!M.defaultPrevented){const P=x().filter(T=>T.focusable),I=P.find(T=>T.active),k=P.find(T=>T.id===m),C=[I,k,...P].filter(Boolean).map(T=>T.ref.current);BA(C,u)}}j.current=!1}),onBlur:ge(e.onBlur,()=>w(!1))})})}),$A="RovingFocusGroupItem",FA=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,...i}=e,s=Pt(),c=o||s,l=LA($A,n),u=l.currentTabStopId===c,d=X0(n),{onFocusableItemAdd:p,onFocusableItemRemove:f}=l;return g.useEffect(()=>{if(r)return p(),()=>f()},[r,p,f]),h.jsx(Af.ItemSlot,{scope:n,id:c,focusable:r,active:a,children:h.jsx(Ae.span,{tabIndex:u?0:-1,"data-orientation":l.orientation,...i,ref:t,onMouseDown:ge(e.onMouseDown,y=>{r?l.onItemFocus(c):y.preventDefault()}),onFocus:ge(e.onFocus,()=>l.onItemFocus(c)),onKeyDown:ge(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){l.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const m=RJ(y,l.orientation,l.dir);if(m!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let v=d().filter(b=>b.focusable).map(b=>b.ref.current);if(m==="last")v.reverse();else if(m==="prev"||m==="next"){m==="prev"&&v.reverse();const b=v.indexOf(y.currentTarget);v=l.loop?DJ(v,b+1):v.slice(b+1)}setTimeout(()=>BA(v))}})})})});FA.displayName=$A;var TJ={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function IJ(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function RJ(e,t,n){const r=IJ(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return TJ[r]}function BA(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function DJ(e,t){return e.map((n,r)=>e[(t+r)%e.length])}let Tf,zA,G0,VA,WA,UA,Hs,Ks,qA,HA,ei,If,Zs,J0,Y0,io,KA,Xs,eb;Fl=Q0,Bl=FA,Tf=["Enter"," "],zA=["ArrowDown","PageUp","Home"],G0=["ArrowUp","PageDown","End"],VA=[...zA,...G0],WA={ltr:[...Tf,"ArrowRight"],rtl:[...Tf,"ArrowLeft"]},UA={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Hs="Menu",[Ks,qA,HA]=Tp(Hs),[ei,If]=er(Hs,[HA,Vs,Za]),Zs=Vs(),J0=Za(),[Y0,io]=ei(Hs),[KA,Xs]=ei(Hs),eb=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:o,modal:i=!0}=e,s=Zs(t),[c,l]=g.useState(null),u=g.useRef(!1),d=tr(o),p=Uo(a);return g.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),h.jsx(Of,{...s,children:h.jsx(Y0,{scope:t,open:n,onOpenChange:d,content:c,onContentChange:l,children:h.jsx(KA,{scope:t,onClose:g.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:p,modal:i,children:r})})})},eb.displayName=Hs;var LJ="MenuAnchor",tb=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=Zs(n);return h.jsx(k0,{...a,...r,ref:t})});tb.displayName=LJ;var nb="MenuPortal",[$J,ZA]=ei(nb,{forceMount:void 0}),XA=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,o=io(nb,t);return h.jsx($J,{scope:t,forceMount:n,children:h.jsx(Mr,{present:n||o.open,children:h.jsx(Cg,{asChild:!0,container:a,children:r})})})};XA.displayName=nb;var br="MenuContent",[FJ,rb]=ei(br),QA=g.forwardRef((e,t)=>{const n=ZA(br,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=io(br,e.__scopeMenu),i=Xs(br,e.__scopeMenu);return h.jsx(Ks.Provider,{scope:e.__scopeMenu,children:h.jsx(Mr,{present:r||o.open,children:h.jsx(Ks.Slot,{scope:e.__scopeMenu,children:i.modal?h.jsx(BJ,{...a,ref:t}):h.jsx(zJ,{...a,ref:t})})})})}),BJ=g.forwardRef((e,t)=>{const n=io(br,e.__scopeMenu),r=g.useRef(null),a=wt(t,r);return g.useEffect(()=>{const o=r.current;if(o)return Vl(o)},[]),h.jsx(ab,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),zJ=g.forwardRef((e,t)=>{const n=io(br,e.__scopeMenu);return h.jsx(ab,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),ab=g.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:p,onDismiss:f,disableOutsideScroll:y,...m}=e,v=io(br,n),b=Xs(br,n),w=Zs(n),_=J0(n),x=qA(n),[j,S]=g.useState(null),E=g.useRef(null),O=wt(t,E,v.onContentChange),N=g.useRef(0),M=g.useRef(""),P=g.useRef(0),I=g.useRef(null),k=g.useRef("right"),C=g.useRef(0),T=y?hf:g.Fragment,A=y?{as:zo,allowPinchZoom:!0}:void 0,R=D=>{var J,K;const B=M.current+D,F=x().filter(q=>!q.disabled),$=document.activeElement,V=(J=F.find(q=>q.ref.current===$))==null?void 0:J.textValue,Q=F.map(q=>q.textValue),X=YJ(Q,B,V),H=(K=F.find(q=>q.textValue===X))==null?void 0:K.ref.current;(function q(G){M.current=G,window.clearTimeout(N.current),G!==""&&(N.current=window.setTimeout(()=>q(""),1e3))})(B),H&&setTimeout(()=>H.focus())};g.useEffect(()=>()=>window.clearTimeout(N.current),[]),Wl();const L=g.useCallback(D=>{var B,F;return k.current===((B=I.current)==null?void 0:B.side)&&tY(D,(F=I.current)==null?void 0:F.area)},[]);return h.jsx(FJ,{scope:n,searchRef:M,onItemEnter:g.useCallback(D=>{L(D)&&D.preventDefault()},[L]),onItemLeave:g.useCallback(D=>{var B;L(D)||((B=E.current)==null||B.focus(),S(null))},[L]),onTriggerLeave:g.useCallback(D=>{L(D)&&D.preventDefault()},[L]),pointerGraceTimerRef:P,onPointerGraceIntentChange:g.useCallback(D=>{I.current=D},[]),children:h.jsx(T,{...A,children:h.jsx(of,{asChild:!0,trapped:a,onMountAutoFocus:ge(o,D=>{var B;D.preventDefault(),(B=E.current)==null||B.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:h.jsx(Og,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:p,onDismiss:f,children:h.jsx(Fl,{asChild:!0,..._,dir:b.dir,orientation:"vertical",loop:r,currentTabStopId:j,onCurrentTabStopIdChange:S,onEntryFocus:ge(c,D=>{b.isUsingKeyboardRef.current||D.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(A0,{role:"menu","aria-orientation":"vertical","data-state":h2(v.open),"data-radix-menu-content":"",dir:b.dir,...w,...m,ref:O,style:{outline:"none",...m.style},onKeyDown:ge(m.onKeyDown,D=>{const B=D.target.closest("[data-radix-menu-content]")===D.currentTarget,F=D.ctrlKey||D.altKey||D.metaKey,$=D.key.length===1;B&&(D.key==="Tab"&&D.preventDefault(),!F&&$&&R(D.key));const V=E.current;if(D.target!==V||!VA.includes(D.key))return;D.preventDefault();const Q=x().filter(X=>!X.disabled).map(X=>X.ref.current);G0.includes(D.key)&&Q.reverse(),GJ(Q)}),onBlur:ge(e.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(N.current),M.current="")}),onPointerMove:ge(e.onPointerMove,mu(D=>{const B=D.target,F=C.current!==D.clientX;if(D.currentTarget.contains(B)&&F){const $=D.clientX>C.current?"right":"left";k.current=$,C.current=D.clientX}}))})})})})})})});QA.displayName=br;var VJ="MenuGroup",ob=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{role:"group",...r,ref:t})});ob.displayName=VJ;var WJ="MenuLabel",GA=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{...r,ref:t})});GA.displayName=WJ;var Rf="MenuItem",JA="menu.itemSelect",Df=g.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,o=g.useRef(null),i=Xs(Rf,e.__scopeMenu),s=rb(Rf,e.__scopeMenu),c=wt(t,o),l=g.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const p=new CustomEvent(JA,{bubbles:!0,cancelable:!0});d.addEventListener(JA,f=>r==null?void 0:r(f),{once:!0}),mAe(d,p),p.defaultPrevented?l.current=!1:i.onClose()}};return h.jsx(YA,{...a,ref:c,disabled:n,onClick:ge(e.onClick,u),onPointerDown:d=>{var p;(p=e.onPointerDown)==null||p.call(e,d),l.current=!0},onPointerUp:ge(e.onPointerUp,d=>{var p;l.current||((p=d.currentTarget)==null||p.click())}),onKeyDown:ge(e.onKeyDown,d=>{const p=s.searchRef.current!=="";n||p&&d.key===" "||Tf.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});Df.displayName=Rf;var YA=g.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...o}=e,i=rb(Rf,n),s=J0(n),c=g.useRef(null),l=wt(t,c),[u,d]=g.useState(!1),[p,f]=g.useState("");return g.useEffect(()=>{const y=c.current;y&&f((y.textContent??"").trim())},[o.children]),h.jsx(Ks.ItemSlot,{scope:n,disabled:r,textValue:a??p,children:h.jsx(Bl,{asChild:!0,...s,focusable:!r,children:h.jsx(Ae.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:l,onPointerMove:ge(e.onPointerMove,mu(y=>{r?i.onItemLeave(y):(i.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ge(e.onPointerLeave,mu(y=>i.onItemLeave(y))),onFocus:ge(e.onFocus,()=>d(!0)),onBlur:ge(e.onBlur,()=>d(!1))})})})}),UJ="MenuCheckboxItem",e2=g.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return h.jsx(o2,{scope:e.__scopeMenu,checked:n,children:h.jsx(Df,{role:"menuitemcheckbox","aria-checked":Lf(n)?"mixed":n,...a,ref:t,"data-state":cb(n),onSelect:ge(a.onSelect,()=>r==null?void 0:r(Lf(n)?!0:!n),{checkForDefaultPrevented:!1})})})});e2.displayName=UJ;var t2="MenuRadioGroup",[qJ,HJ]=ei(t2,{value:void 0,onValueChange:()=>{}}),n2=g.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,o=tr(r);return h.jsx(qJ,{scope:e.__scopeMenu,value:n,onValueChange:o,children:h.jsx(ob,{...a,ref:t})})});n2.displayName=t2;var r2="MenuRadioItem",a2=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=HJ(r2,e.__scopeMenu),o=n===a.value;return h.jsx(o2,{scope:e.__scopeMenu,checked:o,children:h.jsx(Df,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":cb(o),onSelect:ge(r.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,n)},{checkForDefaultPrevented:!1})})})});a2.displayName=r2;var ib="MenuItemIndicator",[o2,KJ]=ei(ib,{checked:!1}),i2=g.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,o=KJ(ib,n);return h.jsx(Mr,{present:r||Lf(o.checked)||o.checked===!0,children:h.jsx(Ae.span,{...a,ref:t,"data-state":cb(o.checked)})})});i2.displayName=ib;var ZJ="MenuSeparator",s2=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});s2.displayName=ZJ;var XJ="MenuArrow",c2=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=Zs(n);return h.jsx(T0,{...a,...r,ref:t})});c2.displayName=XJ;var sb="MenuSub",[QJ,l2]=ei(sb),u2=e=>{const{__scopeMenu:t,children:n,open:r=!1,onOpenChange:a}=e,o=io(sb,t),i=Zs(t),[s,c]=g.useState(null),[l,u]=g.useState(null),d=tr(a);return g.useEffect(()=>(o.open===!1&&d(!1),()=>d(!1)),[o.open,d]),h.jsx(Of,{...i,children:h.jsx(Y0,{scope:t,open:r,onOpenChange:d,content:l,onContentChange:u,children:h.jsx(QJ,{scope:t,contentId:Pt(),triggerId:Pt(),trigger:s,onTriggerChange:c,children:n})})})};u2.displayName=sb;var hu="MenuSubTrigger",d2=g.forwardRef((e,t)=>{const n=io(hu,e.__scopeMenu),r=Xs(hu,e.__scopeMenu),a=l2(hu,e.__scopeMenu),o=rb(hu,e.__scopeMenu),i=g.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:c}=o,l={__scopeMenu:e.__scopeMenu},u=g.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return g.useEffect(()=>u,[u]),g.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),c(null)}},[s,c]),h.jsx(tb,{asChild:!0,...l,children:h.jsx(YA,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":h2(n.open),...e,ref:iK(t,a.onTriggerChange),onClick:d=>{var p;(p=e.onClick)==null||p.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ge(e.onPointerMove,mu(d=>{o.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ge(e.onPointerLeave,mu(d=>{var f,y;u();const p=(f=n.content)==null?void 0:f.getBoundingClientRect();if(p){const m=(y=n.content)==null?void 0:y.dataset.side,v=m==="right",b=v?-5:5,w=p[v?"left":"right"],_=p[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+b,y:d.clientY},{x:w,y:p.top},{x:_,y:p.top},{x:_,y:p.bottom},{x:w,y:p.bottom}],side:m}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:ge(e.onKeyDown,d=>{var f;const p=o.searchRef.current!=="";e.disabled||p&&d.key===" "||WA[r.dir].includes(d.key)&&(n.onOpenChange(!0),(f=n.content)==null||f.focus(),d.preventDefault())})})})});d2.displayName=hu;var p2="MenuSubContent",f2=g.forwardRef((e,t)=>{const n=ZA(br,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=io(br,e.__scopeMenu),i=Xs(br,e.__scopeMenu),s=l2(p2,e.__scopeMenu),c=g.useRef(null),l=wt(t,c);return h.jsx(Ks.Provider,{scope:e.__scopeMenu,children:h.jsx(Mr,{present:r||o.open,children:h.jsx(Ks.Slot,{scope:e.__scopeMenu,children:h.jsx(ab,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:l,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;i.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ge(e.onFocusOutside,u=>{u.target!==s.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:ge(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:ge(e.onKeyDown,u=>{var f;const d=u.currentTarget.contains(u.target),p=UA[i.dir].includes(u.key);d&&p&&(o.onOpenChange(!1),(f=s.trigger)==null||f.focus(),u.preventDefault())})})})})})});f2.displayName=p2;function h2(e){return e?"open":"closed"}function Lf(e){return e==="indeterminate"}function cb(e){return Lf(e)?"indeterminate":e?"checked":"unchecked"}function GJ(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function JJ(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function YJ(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=JJ(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function eY(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function tY(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return eY(n,t)}function mu(e){return t=>t.pointerType==="mouse"?e(t):void 0}var m2=eb,y2=tb,g2=XA,v2=QA,b2=ob,w2=GA,x2=Df,_2=e2,j2=n2,S2=a2,E2=i2,O2=s2,C2=c2,nY=u2,N2=d2,M2=f2,lb="DropdownMenu",[rY,s2e]=er(lb,[If]),On=If(),[aY,P2]=rY(lb),k2=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:o,onOpenChange:i,modal:s=!0}=e,c=On(t),l=g.useRef(null),[u=!1,d]=Sn({prop:a,defaultProp:o,onChange:i});return h.jsx(aY,{scope:t,triggerId:Pt(),triggerRef:l,contentId:Pt(),open:u,onOpenChange:d,onOpenToggle:g.useCallback(()=>d(p=>!p),[d]),modal:s,children:h.jsx(m2,{...c,open:u,onOpenChange:d,dir:r,modal:s,children:n})})};k2.displayName=lb;var A2="DropdownMenuTrigger",T2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,o=P2(A2,n),i=On(n);return h.jsx(y2,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:iK(t,o.triggerRef),onPointerDown:ge(e.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(o.onOpenToggle(),o.open||s.preventDefault())}),onKeyDown:ge(e.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&o.onOpenToggle(),s.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});T2.displayName=A2;var oY="DropdownMenuPortal",I2=e=>{const{__scopeDropdownMenu:t,...n}=e,r=On(t);return h.jsx(g2,{...r,...n})};I2.displayName=oY;var R2="DropdownMenuContent",D2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=P2(R2,n),o=On(n),i=g.useRef(!1);return h.jsx(v2,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...r,ref:t,onCloseAutoFocus:ge(e.onCloseAutoFocus,s=>{var c;i.current||((c=a.triggerRef.current)==null||c.focus()),i.current=!1,s.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,s=>{const c=s.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!a.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});D2.displayName=R2;var iY="DropdownMenuGroup",L2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(b2,{...a,...r,ref:t})});L2.displayName=iY;var sY="DropdownMenuLabel",$2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(w2,{...a,...r,ref:t})});$2.displayName=sY;var cY="DropdownMenuItem",F2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(x2,{...a,...r,ref:t})});F2.displayName=cY;var lY="DropdownMenuCheckboxItem",B2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(_2,{...a,...r,ref:t})});B2.displayName=lY;var uY="DropdownMenuRadioGroup",z2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(j2,{...a,...r,ref:t})});z2.displayName=uY;var dY="DropdownMenuRadioItem",V2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(S2,{...a,...r,ref:t})});V2.displayName=dY;var pY="DropdownMenuItemIndicator",W2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(E2,{...a,...r,ref:t})});W2.displayName=pY;var fY="DropdownMenuSeparator",U2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(O2,{...a,...r,ref:t})});U2.displayName=fY;var hY="DropdownMenuArrow",mY=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(C2,{...a,...r,ref:t})});mY.displayName=hY;var yY=e=>{const{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:a,defaultOpen:o}=e,i=On(t),[s=!1,c]=Sn({prop:r,defaultProp:o,onChange:a});return h.jsx(nY,{...i,open:s,onOpenChange:c,children:n})},gY="DropdownMenuSubTrigger",q2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(N2,{...a,...r,ref:t})});q2.displayName=gY;var vY="DropdownMenuSubContent",H2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(M2,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});H2.displayName=vY,oM=k2,iM=T2,aM=I2,Yg=D2,rM=L2,iv=$2,nv=F2,rv=B2,NK=z2,ov=V2,av=W2,sv=U2,jK=yY,ev=q2,tv=H2;const bY=oM,wY=iM,xY=rM,_Y=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(ev,{ref:a,className:Z("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r,children:[n,h.jsx(de,{name:"chevron-right",className:"ml-auto"})]}));_Y.displayName=ev.displayName;const jY=g.forwardRef(({className:e,...t},n)=>h.jsx(tv,{ref:n,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));jY.displayName=tv.displayName;const K2=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(aM,{children:h.jsx(Yg,{ref:r,sideOffset:t,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));K2.displayName=Yg.displayName;const Z2=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(nv,{ref:r,className:Z("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n}));Z2.displayName=nv.displayName;const SY=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(rv,{ref:a,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(av,{children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}),t]}));SY.displayName=rv.displayName;const EY=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(ov,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(av,{children:h.jsx(de,{name:"circle",className:"h-4 w-4"})})}),t]}));EY.displayName=ov.displayName;const OY=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(iv,{ref:r,className:Z("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));OY.displayName=iv.displayName;const CY=g.forwardRef(({className:e,...t},n)=>h.jsx(sv,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));CY.displayName=sv.displayName;function NY(){const{t:e}=Pe("sidebar"),{isMobile:t}=cu();return h.jsx(Us,{children:h.jsx(eo,{children:h.jsxs(bY,{children:[h.jsx(wY,{asChild:!0,children:h.jsxs(to,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[h.jsx("div",{children:h.jsx(de,{name:"settings",size:28,className:"pr-2"})}),h.jsx(de,{name:"chevrons-up-down",className:"ml-auto size-4"})]})}),h.jsx(K2,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:t?"bottom":"right",align:"end",sideOffset:4,children:h.jsx(xY,{children:h.jsxs(Z2,{children:[h.jsx(de,{name:"sparkles"}),e("contact")]})})})]})})})}function MY({applications:e,currentSession:t,setCurrentSession:n}){const{t:r}=Pe("sidebar"),a=Ii(),o=Xt(AA),i=g.useCallback((l,u)=>{l.preventDefault(),l.stopPropagation(),o.show({id:u})},[o]),s=l=>{n(l),a(yn("application",{applicationId:l.id}))},c=l=>{switch(l.main_source_type){case"Thread":return h.jsx(de,{className:"inline-flex items-center ml-2",name:"message-circle-more",size:14});default:return null}};return h.jsxs(lu,{className:"group-data-[collapsible=icon]:hidden pt-0",children:[h.jsx(uu,{children:h.jsx("div",{className:"text-sm",children:r("applications")})}),h.jsxs(Us,{children:[e==null?void 0:e.map(l=>h.jsx(eo,{className:"cursor-pointer",children:h.jsx(to,{asChild:!0,onClick:()=>s(l),children:h.jsxs("div",{className:"flex flex-row justify-between items-center !h-auto",children:[h.jsxs("div",{className:"flex gap-2",children:[(t==null?void 0:t.id)===l.id?h.jsx(de,{size:16,color:"green",name:"check"}):h.jsx(de,{size:16,name:"chevron-right"}),h.jsxs("span",{children:[l.name,c(l)]})]}),h.jsx(de,{onClick:u=>i(u,l.id),size:16,className:"!z-50",name:"trash-2"})]})})},l.id)),e?h.jsx(eo,{children:h.jsxs(to,{className:"text-sidebar-foreground/70",children:[h.jsx(de,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}const PY={navMain:[{title:"playground.title",icon:h.jsx(de,{name:"square-terminal"}),isActive:!0,items:[{title:"playground.nodes",id:"nodes"},{title:"playground.connections",id:"connections"}]},{title:"model.title",url:"#",icon:h.jsx(de,{name:"bot"}),items:[{title:"model.llm",id:"llm"},{title:"model.embedding",id:"embedding"}]},{title:"tutorial.title",icon:h.jsx(de,{name:"book-open"}),items:[{title:"tutorial.get_started",id:"get-started"},{title:"tutorial.simple_workflow",id:"simple-workflow"},{title:"tutorial.ai_structured_output",id:"ai-structured-output"},{title:"tutorial.standalone_chat_application",id:"chat-application"},{title:"tutorial.standalone_editor_application",id:"editor-application"},{title:"tutorial.tool_calling",id:"tool-calling"},{title:"tutorial.vector_database",id:"vector-database"}]},{title:"application.title",icon:h.jsx(de,{name:"settings-2"}),items:[{title:"application.chat",id:"chat"},{title:"application.editor",id:"editor"},{title:"application.vslite",id:"vslite"}]}]};function kY({sessions:e,applications:t,currentSession:n,setCurrentSession:r,...a}){return h.jsxs(F0,{collapsible:"icon",...a,children:[h.jsx("div",{className:"h-1"}),h.jsxs(z0,{children:[h.jsx(NJ,{sessions:e||[],currentSession:n,setCurrentSession:r}),h.jsx(MY,{applications:t||[],currentSession:n,setCurrentSession:r}),h.jsx(uJ,{items:PY.navMain})]}),h.jsx(lA,{children:h.jsx(NY,{})}),h.jsx(cA,{})]})}Vn=g.memo(e=>{const{loading:t,...n}=e;return h.jsx(ut,{...n,disabled:e.disabled||t,children:t?h.jsx(de,{name:"loader-circle",className:"animate-spin"}):e.children})});function AY({className:e,onProcess:t=async()=>(await new Promise(a=>setTimeout(a,2e3)),Math.random()>.5),processDuration:n=2e3,...r}){const[a,o]=g.useState(!1),[i,s]=g.useState(null),[c,l]=g.useState(!1),[,u]=g.useState(0);g.useEffect(()=>{if(a){const p=Date.now(),f=setInterval(()=>{const y=(Date.now()-p)/n*100;y>=100?(clearInterval(f),u(100)):u(y)},10);return()=>clearInterval(f)}},[a,n]);async function d(){if(a)return;o(!0),s(null),u(0),await new Promise(f=>setTimeout(f,n));const p=t?await t():!0;s(p),o(!1),l(!0),setTimeout(()=>{s(null),u(0),l(!1)},2e3)}return h.jsx(ut,{className:Z("relative group","transition-all duration-300",a&&"cursor-wait",e),variant:"ghost",onClick:d,disabled:a,...r,children:h.jsx("div",{className:Z("w-full flex items-center justify-center gap-2",c&&"animate-[scale_300ms_ease-in-out]"),children:i===null?h.jsx(h.Fragment,{children:h.jsx(de,{name:"forward",className:Z("w-4 h-4 transition-transform duration-200","group-hover:scale-110",a&&"animate-bounce")})}):i?h.jsx(h.Fragment,{children:h.jsx(de,{name:"check",className:"w-4 h-4 text-green-500"})}):h.jsx(h.Fragment,{children:h.jsx(de,{name:"x",className:"w-4 h-4 text-red-500"})})})})}const xa="NOLLM",TY="0123456789abcdef",IY=[8,4,4,4,12];function yu(){return IY.map(e=>yAe(TY,e)()).join("-")}const RY=()=>{const e=Ye(t=>t.currentSession);return{exportSession:g.useCallback(async()=>{if(!(e!=null&&e.id))return;const t={},n={},r=Object.keys(sK).filter(c=>c!=="Session");await Promise.all(r.map(c=>ue(c).find({where:{session_id:e.id}}).then(l=>{l.map(u=>{n[u.id]=u.id}),t[c]=l}))),Object.keys(n).forEach(c=>{n[c]=`[ID_${yu()}]`});let a=JSON.stringify({[xa]:{key:e.id,session:Object.entries(e).reduce((c,[l,u])=>((typeof u!="object"||u===null)&&(c[l]=u),u===void 0&&(c[l]=null),c),{}),ids:Object.keys(n)},...t});Object.keys(n).forEach(c=>{a=a.replace(new RegExp(c,"g"),n[c])}),a=a.replace(new RegExp(e.id,"g"),"[SESSION_ID]");const o=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=`${e.name}_${new Date}.json`,s.click()},[e])}},DY=()=>{const[e,t]=g.useState(!1),n=Ii(),r=g.useCallback((o,{idMap:i,newSessionId:s,replaceItem:c})=>{const l=o;return{...Object.keys(l).reduce((u,d)=>(l[d]&&typeof l[d]=="string"&&i[l[d]]?u[d]=i[l[d]]:d==="session_id"&&s?u[d]=s:u[d]=l[d],u),{}),...c||{}}},[]),a=g.useCallback(async o=>{try{t(!0);const i=Object.keys(sK).filter(d=>d!==xa);if(!Object.keys(o[xa]).length||typeof o[xa]!="object")throw new Error("Missing Metadata");if(!("session"in o[xa])||!o[xa].session)throw new Error("Missing Session Metadata");const s=o[xa].session;if(!("ids"in o[xa]))throw new Error("Missing Session ID");const c=o[xa].ids.reduce((d,p)=>(d[p]=yu(),d),{}),l=Object.keys(o).filter(d=>d!==xa);if(!l.every(d=>i.includes(d)))throw new Error("Invalid JSON keys");if(!l.every(d=>Array.isArray(o[d])))throw new Error("Invalid JSON values");l.forEach(d=>{o[d].forEach(p=>{if("session_id"in p&&p.session_id!=="[SESSION_ID]")throw new Error("Invalid JSON values")})});const u=await ue("Session").save(r(s,{idMap:c,newSessionId:"",replaceItem:{id:void 0}}));if(!u)throw new Error("Failed to import session");await Promise.all(i.map(d=>{const p=o[d];if(!p||!p.length)return Promise.resolve();const f=p.map(y=>r(y,{idMap:c,newSessionId:u.id}));return ue(d).save(f)})),u.type===Ml.Whiteboard?n(yn("whiteboard",{sessionId:u.id})):u.type===Ml.StandaloneApp&&n(yn("application",{applicationId:u.id}))}finally{t(!1)}},[n,r]);return{loading:e,importSession:a}};function LY(){const{t:e}=Pe("tooltips"),t=ya(),n=Vo(p=>p.setTheme),r=Vo(p=>p.theme),{exportSession:a}=RY(),{loading:o,importSession:i}=DY(),s=g.useRef(null),c=g.useCallback(()=>{n(r==="dark"?"light":"dark")},[r,n]),l=g.useCallback(async()=>{try{return await a(),!0}catch(p){return Pl(p),!1}},[a]),u=g.useCallback(async p=>{var f;try{const y=(f=p.target.files)==null?void 0:f[0];if(!y)return;const m=await new Promise((v,b)=>{const w=new FileReader;w.onload=_=>{var x;try{const j=(x=_.target)==null?void 0:x.result;v(JSON.parse(j))}catch(j){b(j)}},w.onerror=_=>{b(_)},w.readAsText(y)});await i(m)}catch(y){return Pl(y),!1}},[i]),d=g.useMemo(()=>{if(t.pathname.includes(yn("whiteboard")))return e("whiteboard");if(t.pathname.includes(yn("application")))return e("apllication")},[t.pathname,e]);return h.jsxs("header",{className:"flex h-14 shrink-0 items-center gap-2 transition-[width,height] ease-linear justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2 px-4",children:[h.jsx(sA,{}),h.jsx(nt,{children:d})]}),h.jsx("div",{className:"flex items-center pl-4 pr-2",children:h.jsxs(su,{children:[h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsxs(Vn,{loading:o,variant:"ghost",onClick:()=>{var p;return(p=s.current)==null?void 0:p.click()},children:[h.jsx(de,{size:18,name:"import"}),h.jsx("input",{ref:s,type:"file",accept:".json",onChange:u,className:"hidden"},`${Date.now()}`)]})}),h.jsx(Br,{children:h.jsx("p",{children:e("import")})})]}),h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(AY,{onProcess:l})}),h.jsx(Br,{children:h.jsx("p",{children:e("export")})})]}),h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(ut,{disabled:o,onClick:c,variant:"ghost",children:h.jsx(de,{size:18,name:r==="dark"?"moon":"sun"})})}),h.jsx(Br,{children:h.jsx("p",{children:e("theme")})})]}),h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(ut,{variant:"link",children:h.jsx("a",{referrerPolicy:"no-referrer",target:"_blank",href:"https://github.com/zrg-team/NoLLMChat",children:h.jsx(de,{size:18,name:"github"})})})}),h.jsx(Br,{children:h.jsx("p",{children:"https://github.com/zrg-team/NoLLMChat"})})]})]})})]})}function X2({requiredSession:e}){const t=lP(),n=Ii(),r=ya(),a=g.useRef(r),o=Ye(l=>l.currentSession),i=Ye(l=>l.sessions),s=Ye(l=>l.applications),c=Ye(l=>l.setCurrentSession);return a.current=r,g.useEffect(()=>{!(o!=null&&o.id)||!e||(r.pathname.includes(yn("whiteboard"))?t.sessionId?t.sessionId&&t.sessionId!==(o==null?void 0:o.id)&&c(t.sessionId):n(yn("whiteboard",{sessionId:o==null?void 0:o.id})):r.pathname.includes(yn("application"))&&(t.applicationId?t.applicationId&&t.applicationId!==(o==null?void 0:o.id)&&c(t.applicationId):n(yn("application",{applicationId:o==null?void 0:o.id}))))},[o==null?void 0:o.id,r.pathname,n,t.applicationId,t.sessionId,e,c]),g.useEffect(()=>{e&&c(t.sessionId||t.applicationId).then(l=>{!l||lJ().has("flow")&&l.type===Ml.StandaloneApp||(l.type===Ml.StandaloneApp&&a.current.pathname.includes(yn("whiteboard").replace("/",""))?n(yn("application",{applicationId:l.id})):l.type===Ml.Whiteboard&&a.current.pathname.includes(yn("application").replace("/",""))&&n(yn("whiteboard",{sessionId:l.id})))})},[n,t.applicationId,t.sessionId,e,c]),h.jsxs($0,{defaultOpen:!1,children:[h.jsx(kY,{sessions:i,applications:s,currentSession:o,setCurrentSession:c}),h.jsxs(B0,{className:"max-h-screen overflow-hidden",children:[h.jsx(LY,{}),h.jsx(Ms,{className:"shrink-0"}),h.jsx("div",{className:"flex flex-1 flex-col p-0 m-0 overflow-y-auto",children:h.jsx(oX,{})})]})]})}const Q2=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx("div",{className:Z("flex flex-col w-full h-full p-4 gap-6 overflow-y-auto",e),ref:r,...n,children:t}));Q2.displayName="ChatMessageList";var G2="vercel.ai.error",$Y=Symbol.for(G2),J2,FY=class kK extends Error{constructor({name:t,message:n,cause:r}){super(n),this[J2]=!0,this.name=t,this.cause=r}static isInstance(t){return kK.hasMarker(t,G2)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};J2=$Y;var Qs=FY;function Y2(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var eT="AI_InvalidArgumentError",tT=`vercel.ai.error.${eT}`,BY=Symbol.for(tT),nT,zY=class extends Qs{constructor({message:e,cause:t,argument:n}){super({name:eT,message:e,cause:t}),this[nT]=!0,this.argument=n}static isInstance(e){return Qs.hasMarker(e,tT)}};nT=BY;var rT="AI_JSONParseError",aT=`vercel.ai.error.${rT}`,VY=Symbol.for(aT),oT,iT=class extends Qs{constructor({text:e,cause:t}){super({name:rT,message:`JSON parsing failed: Text: ${e}.
Error message: ${Y2(t)}`,cause:t}),this[oT]=!0,this.text=e}static isInstance(e){return Qs.hasMarker(e,aT)}};oT=VY;var sT="AI_TypeValidationError",cT=`vercel.ai.error.${sT}`,WY=Symbol.for(cT),lT,UY=class jM extends Qs{constructor({value:t,cause:n}){super({name:sT,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${Y2(n)}`,cause:n}),this[lT]=!0,this.value=t}static isInstance(t){return Qs.hasMarker(t,cT)}static wrap({value:t,cause:n}){return jM.isInstance(n)&&n.value===t?n:new jM({value:t,cause:n})}};lT=WY;var uT=UY;let qY=(e,t=21)=>(n=t)=>{let r="",a=n;for(;a--;)r+=e[Math.random()*e.length|0];return r};var Fi={exports:{}},dT;function HY(){if(dT)return Fi.exports;dT=1;const e=typeof pa<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(s,c,l){l==null&&c!==null&&typeof c=="object"&&(l=c,c=void 0),e&&pa.isBuffer(s)&&(s=s.toString()),s&&s.charCodeAt(0)===65279&&(s=s.slice(1));const u=JSON.parse(s,c);if(u===null||typeof u!="object")return u;const d=l&&l.protoAction||"error",p=l&&l.constructorAction||"error";if(d==="ignore"&&p==="ignore")return u;if(d!=="ignore"&&p!=="ignore"){if(t.test(s)===!1&&n.test(s)===!1)return u}else if(d!=="ignore"&&p==="ignore"){if(t.test(s)===!1)return u}else if(n.test(s)===!1)return u;return a(u,{protoAction:d,constructorAction:p,safe:l&&l.safe})}function a(s,{protoAction:c="error",constructorAction:l="error",safe:u}={}){let d=[s];for(;d.length;){const p=d;d=[];for(const f of p){if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(f,"__proto__")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete f.__proto__}if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(f,"constructor")&&Object.prototype.hasOwnProperty.call(f.constructor,"prototype")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete f.constructor}for(const y in f){const m=f[y];m&&typeof m=="object"&&d.push(m)}}}return s}function o(s,c,l){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,l)}finally{Error.stackTraceLimit=u}}function i(s,c){const l=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=l}}return Fi.exports=o,Fi.exports.default=o,Fi.exports.parse=o,Fi.exports.safeParse=i,Fi.exports.scan=a,Fi.exports}var KY=HY();const ZY=ot(KY);var XY=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=qY(n,t);if(e==null)return a;if(n.includes(r))throw new zY({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return o=>`${e}${r}${a(o)}`},pT=XY(),ub=Symbol.for("vercel.ai.validator");function QY(e){return{[ub]:!0,validate:e}}function GY(e){return typeof e=="object"&&e!==null&&ub in e&&e[ub]===!0&&"validate"in e}function JY(e){return GY(e)?e:YY(e)}function YY(e){return QY(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function eee({value:e,schema:t}){const n=JY(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:uT.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:uT.wrap({value:e,cause:r})}}}function fT({text:e,schema:t}){try{const n=ZY.parse(e);return t==null?{success:!0,value:n}:eee({value:n,schema:t})}catch(n){return{success:!1,error:iT.isInstance(n)?n:new iT({text:e,cause:n})}}}var $f={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Ff={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Bf={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},zf={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Vf={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},tee=[$f,Ff,Bf,zf,Vf];$f.code+"",Ff.code+"",Bf.code+"",zf.code+"",Vf.code+"",$f.name+"",$f.code,Ff.name+"",Ff.code,Bf.name+"",Bf.code,zf.name+"",zf.code,Vf.name+"",Vf.code,tee.map(e=>e.code);function nee(e){const t=["ROOT"];let n=-1,r=null;function a(c,l,u){switch(c){case'"':{n=l,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=l,r=l,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=l,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=l,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function o(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=l,t.pop();break}}}function i(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}}}for(let c=0;c<e.length;c++){const l=e[c];switch(t[t.length-1]){case"ROOT":a(l,c,"FINISH");break;case"INSIDE_OBJECT_START":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=c,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(l){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{a(l,c,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{o(l,c);break}case"INSIDE_STRING":{switch(l){case'"':{t.pop(),n=c;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=c}break}case"INSIDE_ARRAY_START":{switch(l){case"]":{n=c,t.pop();break}default:{n=c,a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}default:{n=c;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=c;break}case"INSIDE_NUMBER":{switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const u=e.substring(r,c+1);!"false".startsWith(u)&&!"true".startsWith(u)&&!"null".startsWith(u)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?o(l,c):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c)):n=c;break}}}let s=e.slice(0,n+1);for(let c=t.length-1;c>=0;c--)switch(t[c]){case"INSIDE_STRING":{s+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{s+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{s+="]";break}case"INSIDE_LITERAL":{const l=e.substring(r,e.length);"true".startsWith(l)?s+="true".slice(l.length):"false".startsWith(l)?s+="false".slice(l.length):"null".startsWith(l)&&(s+="null".slice(l.length))}}return s}function ree(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=fT({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=fT({text:nee(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var gu={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},vu={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},bu={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},wu={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},xu={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},_u={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},ju={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},Su={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Eu={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Ou={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},aee=[gu,vu,bu,wu,xu,_u,ju,Su,Eu,Ou],oee={[gu.code]:gu,[vu.code]:vu,[bu.code]:bu,[wu.code]:wu,[xu.code]:xu,[_u.code]:_u,[ju.code]:ju,[Su.code]:Su,[Eu.code]:Eu,[Ou.code]:Ou};gu.name+"",gu.code,vu.name+"",vu.code,bu.name+"",bu.code,wu.name+"",wu.code,xu.name+"",xu.code,_u.name+"",_u.code,ju.name+"",ju.code,Su.name+"",Su.code,Eu.name+"",Eu.code,Ou.name+"",Ou.code;var iee=aee.map(e=>e.code),see=e=>{const t=e.indexOf(":");if(t===-1)throw new Error("Failed to parse stream string. No separator found.");const n=e.slice(0,t);if(!iee.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const r=n,a=e.slice(t+1),o=JSON.parse(a);return oee[r].parse(o)},cee=10;function lee(e,t){const n=new Uint8Array(t);let r=0;for(const a of e)n.set(a,r),r+=a.length;return e.length=0,n}async function uee({stream:e,onTextPart:t,onDataPart:n,onErrorPart:r,onToolCallStreamingStartPart:a,onToolCallDeltaPart:o,onToolCallPart:i,onToolResultPart:s,onMessageAnnotationsPart:c,onFinishMessagePart:l,onFinishStepPart:u}){const d=e.getReader(),p=new TextDecoder,f=[];let y=0;for(;;){const{value:m}=await d.read();if(m&&(f.push(m),y+=m.length,m[m.length-1]!==cee))continue;if(f.length===0)break;const v=lee(f,y);y=0;const b=p.decode(v,{stream:!0}).split(`
`).filter(w=>w!=="").map(see);for(const{type:w,value:_}of b)switch(w){case"text":await(t==null?void 0:t(_));break;case"data":await(n==null?void 0:n(_));break;case"error":await(r==null?void 0:r(_));break;case"message_annotations":await(c==null?void 0:c(_));break;case"tool_call_streaming_start":await(a==null?void 0:a(_));break;case"tool_call_delta":await(o==null?void 0:o(_));break;case"tool_call":await(i==null?void 0:i(_));break;case"tool_result":await(s==null?void 0:s(_));break;case"finish_message":await(l==null?void 0:l(_));break;case"finish_step":await(u==null?void 0:u(_));break;default:{const x=w;throw new Error(`Unknown stream part type: ${x}`)}}}}function dee({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}async function pee({stream:e,update:t,onToolCall:n,onFinish:r,generateId:a=pT,getCurrentDate:o=()=>new Date}){const i=o();let s,c=!0;const l=[],u=[];let d;const p={};let f={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},y="unknown";function m(){const b=[...u];if(s==null){t(l,b);return}d!=null&&d.length&&(s.annotations=d);const w={...JSON.parse(JSON.stringify(s)),revisionId:a()};t([...l,w],b)}function v(){return(c||s==null)&&(s!=null&&l.push(s),c=!1,s={id:a(),role:"assistant",content:"",createdAt:i}),s}await uee({stream:e,onTextPart(b){const w=v();s={...w,content:w.content+b},m()},onToolCallStreamingStartPart(b){const w=v();w.toolInvocations==null&&(w.toolInvocations=[]),p[b.toolCallId]={text:"",toolName:b.toolName,index:w.toolInvocations.length},w.toolInvocations.push({state:"partial-call",toolCallId:b.toolCallId,toolName:b.toolName,args:void 0}),m()},onToolCallDeltaPart(b){const w=v(),_=p[b.toolCallId];_.text+=b.argsTextDelta;const{value:x}=ree(_.text);w.toolInvocations[_.index]={state:"partial-call",toolCallId:b.toolCallId,toolName:_.toolName,args:x},m()},async onToolCallPart(b){const w=v();if(p[b.toolCallId]!=null?w.toolInvocations[p[b.toolCallId].index]={state:"call",...b}:(w.toolInvocations==null&&(w.toolInvocations=[]),w.toolInvocations.push({state:"call",...b})),n){const _=await n({toolCall:b});_!=null&&(w.toolInvocations[w.toolInvocations.length-1]={state:"result",...b,result:_})}m()},onToolResultPart(b){const w=v().toolInvocations;if(w==null)throw new Error("tool_result must be preceded by a tool_call");const _=w.findIndex(x=>x.toolCallId===b.toolCallId);if(_===-1)throw new Error("tool_result must be preceded by a tool_call with the same toolCallId");w[_]={...w[_],state:"result",...b},m()},onDataPart(b){u.push(...b),m()},onMessageAnnotationsPart(b){d==null?d=[...b]:d.push(...b),m()},onFinishStepPart(b){c=!b.isContinued},onFinishMessagePart(b){y=b.finishReason,b.usage!=null&&(f=dee(b.usage))},onErrorPart(b){throw new Error(b)}}),r==null||r({message:s,finishReason:y,usage:f})}async function fee({stream:e,onTextPart:t}){const n=e.pipeThrough(new TextDecoderStream).getReader();for(;;){const{done:r,value:a}=await n.read();if(r)break;await t(a)}}var hee=()=>fetch;async function mee({api:e,body:t,streamProtocol:n="data",credentials:r,headers:a,abortController:o,restoreMessagesOnFailure:i,onResponse:s,onUpdate:c,onFinish:l,onToolCall:u,generateId:d,fetch:p=hee()}){var f,y;const m=await p(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",...a},signal:(f=o==null?void 0:o())==null?void 0:f.signal,credentials:r}).catch(v=>{throw i(),v});if(s)try{await s(m)}catch(v){throw v}if(!m.ok)throw i(),new Error((y=await m.text())!=null?y:"Failed to fetch the chat response.");if(!m.body)throw new Error("The response body is empty.");switch(n){case"text":{const v={id:d(),createdAt:new Date,role:"assistant",content:""};await fee({stream:m.body,onTextPart:b=>{v.content+=b,c([{...v}],[])}}),l==null||l(v,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"});return}case"data":{await pee({stream:m.body,update:c,onToolCall:u,onFinish({message:v,finishReason:b,usage:w}){l&&v!=null&&l(v,{usage:w,finishReason:b})},generateId:d});return}default:{const v=n;throw new Error(`Unknown stream protocol: ${v}`)}}}var hT={exports:{}},db={},mT;function yee(){if(mT)return db;mT=1;var e=cK();function t(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,a=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function s(d,p){var f=p(),y=r({inst:{value:f,getSnapshot:p}}),m=y[0].inst,v=y[1];return o(function(){m.value=f,m.getSnapshot=p,c(m)&&v({inst:m})},[d,f,p]),a(function(){return c(m)&&v({inst:m}),d(function(){c(m)&&v({inst:m})})},[d]),i(f),f}function c(d){var p=d.getSnapshot;d=d.value;try{var f=p();return!n(d,f)}catch{return!0}}function l(d,p){return p()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:s;return db.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,db}var yT;function gT(){return yT||(yT=1,hT.exports=yee()),hT.exports}Bp=gT();let so,Rn,Wf,ct,zr,co,vT,Cu;CK=ot(Bp),so=()=>{},Rn=so(),Wf=Object,ct=e=>e===Rn,zr=e=>typeof e=="function",co=(e,t)=>({...e,...t}),vT=e=>zr(e.then),Cu=new WeakMap;let gee=0;const Nu=e=>{const t=typeof e,n=e&&e.constructor,r=n==Date;let a,o;if(Wf(e)===e&&!r&&n!=RegExp){if(a=Cu.get(e),a)return a;if(a=++gee+"~",Cu.set(e,a),n==Array){for(a="@",o=0;o<e.length;o++)a+=Nu(e[o])+",";Cu.set(e,a)}if(n==Wf){a="#";const i=Wf.keys(e).sort();for(;!ct(o=i.pop());)ct(e[o])||(a+=o+":"+Nu(e[o])+",");Cu.set(e,a)}}else a=r?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return a},lo=new WeakMap,pb={},Uf={},fb="undefined",qf=typeof window!=fb,hb=typeof document!=fb,vee=()=>qf&&typeof window.requestAnimationFrame!=fb,bT=(e,t)=>{const n=lo.get(e);return[()=>!ct(t)&&e.get(t)||pb,r=>{if(!ct(t)){const a=e.get(t);t in Uf||(Uf[t]=a),n[5](t,co(a,r),a||pb)}},n[6],()=>!ct(t)&&t in Uf?Uf[t]:!ct(t)&&e.get(t)||pb]};let mb=!0;const bee=()=>mb,[yb,gb]=qf&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[so,so],wee=()=>{const e=hb&&document.visibilityState;return ct(e)||e!=="hidden"},xee=e=>(hb&&document.addEventListener("visibilitychange",e),yb("focus",e),()=>{hb&&document.removeEventListener("visibilitychange",e),gb("focus",e)}),_ee=e=>{const t=()=>{mb=!0,e()},n=()=>{mb=!1};return yb("online",t),yb("offline",n),()=>{gb("online",t),gb("offline",n)}},jee={isOnline:bee,isVisible:wee},See={initFocus:xee,initReconnect:_ee},wT=!U.useId,Mu=!qf||"Deno"in window,Eee=e=>vee()?window.requestAnimationFrame(e):setTimeout(e,1),vb=Mu?g.useEffect:g.useLayoutEffect,bb=typeof navigator<"u"&&navigator.connection,xT=!Mu&&bb&&(["slow-2g","2g"].includes(bb.effectiveType)||bb.saveData),wb=e=>{if(zr(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?Nu(e):"",[e,t]};let Oee=0;const xb=()=>++Oee,_T=0,jT=1,ST=2;var Pu={__proto__:null,ERROR_REVALIDATE_EVENT:3,FOCUS_EVENT:_T,MUTATE_EVENT:ST,RECONNECT_EVENT:jT};async function ET(...e){const[t,n,r,a]=e,o=co({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let i=o.populateCache;const s=o.rollbackOnError;let c=o.optimisticData;const l=p=>typeof s=="function"?s(p):s!==!1,u=o.throwOnError;if(zr(n)){const p=n,f=[],y=t.keys();for(const m of y)!/^\$(inf|sub)\$/.test(m)&&p(t.get(m)._k)&&f.push(m);return Promise.all(f.map(d))}return d(n);async function d(p){const[f]=wb(p);if(!f)return;const[y,m]=bT(t,f),[v,b,w,_]=lo.get(t),x=()=>{const k=v[f];return(zr(o.revalidate)?o.revalidate(y().data,p):o.revalidate!==!1)&&(delete w[f],delete _[f],k&&k[0])?k[0](ST).then(()=>y().data):y().data};if(e.length<3)return x();let j=r,S;const E=xb();b[f]=[E,0];const O=!ct(c),N=y(),M=N.data,P=N._c,I=ct(P)?M:P;if(O&&(c=zr(c)?c(I,M):c,m({data:c,_c:I})),zr(j))try{j=j(I)}catch(k){S=k}if(j&&vT(j))if(j=await j.catch(k=>{S=k}),E!==b[f][0]){if(S)throw S;return j}else S&&O&&l(S)&&(i=!0,m({data:I,_c:Rn}));if(i&&!S)if(zr(i)){const k=i(j,I);m({data:k,error:Rn,_c:Rn})}else m({data:j,error:Rn,_c:Rn});if(b[f][1]=xb(),Promise.resolve(x()).then(()=>{m({_c:Rn})}),S){if(u)throw S;return}return j}}const OT=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},Cee=(e,t)=>{if(!lo.has(e)){const n=co(See,t),r={},a=ET.bind(Rn,e);let o=so;const i={},s=(u,d)=>{const p=i[u]||[];return i[u]=p,p.push(d),()=>p.splice(p.indexOf(d),1)},c=(u,d,p)=>{e.set(u,d);const f=i[u];if(f)for(const y of f)y(d,p)},l=()=>{if(!lo.has(e)&&(lo.set(e,[r,{},{},{},a,c,s]),!Mu)){const u=n.initFocus(setTimeout.bind(Rn,OT.bind(Rn,r,_T))),d=n.initReconnect(setTimeout.bind(Rn,OT.bind(Rn,r,jT)));o=()=>{u&&u(),d&&d(),lo.delete(e)}}};return l(),[e,a,l,o]}return[e,lo.get(e)[4]]},Nee=(e,t,n,r,a)=>{const o=n.errorRetryCount,i=a.retryCount,s=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!ct(o)&&i>o||setTimeout(r,s,a)},Mee=(e,t)=>Nu(e)==Nu(t),[CT,Pee]=Cee(new Map),kee=co({onLoadingSlow:so,onSuccess:so,onError:so,onErrorRetry:Nee,onDiscarded:so,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:xT?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:xT?5e3:3e3,compare:Mee,isPaused:()=>!1,cache:CT,mutate:Pee,fallback:{}},jee),Aee=(e,t)=>{const n=co(e,t);if(t){const{use:r,fallback:a}=e,{use:o,fallback:i}=t;r&&o&&(n.use=r.concat(o)),a&&i&&(n.fallback=co(a,i))}return n},Tee=g.createContext({}),Iee="$inf$",NT=qf&&window.__SWR_DEVTOOLS_USE__,Ree=NT?window.__SWR_DEVTOOLS_USE__:[],Dee=()=>{NT&&(window.__SWR_DEVTOOLS_REACT__=U)},Lee=e=>zr(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],$ee=()=>co(kee,g.useContext(Tee)),Fee=e=>(t,n,r)=>e(t,n&&((...a)=>{const[o]=wb(t),[,,,i]=lo.get(CT);if(o.startsWith(Iee))return n(...a);const s=i[o];return ct(s)?n(...a):(delete i[o],s)}),r),Bee=Ree.concat(Fee),zee=e=>function(...t){const n=$ee(),[r,a,o]=Lee(t),i=Aee(n,o);let s=e;const{use:c}=i,l=(c||[]).concat(Bee);for(let u=l.length;u--;)s=l[u](s);return s(r,a||i.fetcher||null,i)},Vee=(e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const a=r.indexOf(n);a>=0&&(r[a]=r[r.length-1],r.pop())}};Dee();const MT=U.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e)}),_b={dedupe:!0},Wee=(e,t,n)=>{const{cache:r,compare:a,suspense:o,fallbackData:i,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:l,refreshWhenHidden:u,refreshWhenOffline:d,keepPreviousData:p}=n,[f,y,m,v]=lo.get(r),[b,w]=wb(e),_=g.useRef(!1),x=g.useRef(!1),j=g.useRef(b),S=g.useRef(t),E=g.useRef(n),O=()=>E.current,N=()=>O().isVisible()&&O().isOnline(),[M,P,I,k]=bT(r,b),C=g.useRef({}).current,T=ct(i)?n.fallback[b]:i,A=(z,se)=>{for(const re in C){const le=re;if(le==="data"){if(!a(z[le],se[le])&&(!ct(z[le])||!a(X,se[le])))return!1}else if(se[le]!==z[le])return!1}return!0},R=g.useMemo(()=>{const z=!b||!t?!1:ct(s)?O().isPaused()||o?!1:ct(c)?!0:c:s,se=Se=>{const Ve=co(Se);return delete Ve._k,z?{isValidating:!0,isLoading:!0,...Ve}:Ve},re=M(),le=k(),je=se(re),Le=re===le?je:se(le);let $e=je;return[()=>{const Se=se(M());return A(Se,$e)?($e.data=Se.data,$e.isLoading=Se.isLoading,$e.isValidating=Se.isValidating,$e.error=Se.error,$e):($e=Se,Se)},()=>Le]},[r,b]),L=Bp.useSyncExternalStore(g.useCallback(z=>I(b,(se,re)=>{A(re,se)||z()}),[r,b]),R[0],R[1]),D=!_.current,B=f[b]&&f[b].length>0,F=L.data,$=ct(F)?T:F,V=L.error,Q=g.useRef($),X=p?ct(F)?Q.current:F:$,H=B&&!ct(V)?!1:D&&!ct(s)?s:O().isPaused()?!1:o?ct($)?!1:c:ct($)||c,J=!!(b&&t&&D&&H),K=ct(L.isValidating)?J:L.isValidating,q=ct(L.isLoading)?J:L.isLoading,G=g.useCallback(async z=>{const se=S.current;if(!b||!se||x.current||O().isPaused())return!1;let re,le,je=!0;const Le=z||{},$e=!m[b]||!Le.dedupe,Se=()=>wT?!x.current&&b===j.current&&_.current:b===j.current,Ve={isValidating:!1,isLoading:!1},Ue=()=>{P(Ve)},qe=()=>{const st=m[b];st&&st[1]===le&&delete m[b]},Mt={isValidating:!0};ct(M().data)&&(Mt.isLoading=!0);try{if($e&&(P(Mt),n.loadingTimeout&&ct(M().data)&&setTimeout(()=>{je&&Se()&&O().onLoadingSlow(b,n)},n.loadingTimeout),m[b]=[se(w),xb()]),[re,le]=m[b],re=await re,$e&&setTimeout(qe,n.dedupingInterval),!m[b]||m[b][1]!==le)return $e&&Se()&&O().onDiscarded(b),!1;Ve.error=Rn;const st=y[b];if(!ct(st)&&(le<=st[0]||le<=st[1]||st[1]===0))return Ue(),$e&&Se()&&O().onDiscarded(b),!1;const rt=M().data;Ve.data=a(rt,re)?rt:re,$e&&Se()&&O().onSuccess(re,b,n)}catch(st){qe();const rt=O(),{shouldRetryOnError:bt}=rt;rt.isPaused()||(Ve.error=st,$e&&Se()&&(rt.onError(st,b,rt),(bt===!0||zr(bt)&&bt(st))&&(!O().revalidateOnFocus||!O().revalidateOnReconnect||N())&&rt.onErrorRetry(st,b,rt,Ht=>{const Qn=f[b];Qn&&Qn[0]&&Qn[0](Pu.ERROR_REVALIDATE_EVENT,Ht)},{retryCount:(Le.retryCount||0)+1,dedupe:!0})))}return je=!1,Ue(),!0},[b,r]),ne=g.useCallback((...z)=>ET(r,j.current,...z),[]);if(vb(()=>{S.current=t,E.current=n,ct(F)||(Q.current=F)}),vb(()=>{if(!b)return;const z=G.bind(Rn,_b);let se=0;const re=Vee(b,f,(le,je={})=>{if(le==Pu.FOCUS_EVENT){const Le=Date.now();O().revalidateOnFocus&&Le>se&&N()&&(se=Le+O().focusThrottleInterval,z())}else if(le==Pu.RECONNECT_EVENT)O().revalidateOnReconnect&&N()&&z();else{if(le==Pu.MUTATE_EVENT)return G();if(le==Pu.ERROR_REVALIDATE_EVENT)return G(je)}});return x.current=!1,j.current=b,_.current=!0,P({_k:w}),H&&(ct($)||Mu?z():Eee(z)),()=>{x.current=!0,re()}},[b]),vb(()=>{let z;function se(){const le=zr(l)?l(M().data):l;le&&z!==-1&&(z=setTimeout(re,le))}function re(){!M().error&&(u||O().isVisible())&&(d||O().isOnline())?G(_b).then(se):se()}return se(),()=>{z&&(clearTimeout(z),z=-1)}},[l,u,d,b]),g.useDebugValue(X),o&&ct($)&&b){if(!wT&&Mu)throw new Error("Fallback data is required when using suspense in SSR.");S.current=t,E.current=n,x.current=!1;const z=v[b];if(!ct(z)){const se=ne(z);MT(se)}if(ct(V)){const se=G(_b);ct(X)||(se.status="fulfilled",se.value=!0),MT(se)}else throw V}return{mutate:ne,get data(){return C.data=!0,X},get error(){return C.error=!0,V},get isValidating(){return C.isValidating=!0,K},get isLoading(){return C.isLoading=!0,q}}},Hf=zee(Wee);var jb,PT;function Uee(){if(PT)return jb;PT=1;function e(t,n){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let r,a=0;return function(...o){clearTimeout(r);const i=Date.now(),s=i-a,c=n-s;c<=0?(a=i,t.apply(this,o)):r=setTimeout(()=>{a=Date.now(),t.apply(this,o)},c)}}return jb=e,jb}var qee=Uee();const Hee=ot(qee);function kT(e,t){return t!=null?Hee(e,t):e}var Kee=async(e,t,n,r,a,o,i,s,c,l,u,d,p,f,y,m,v)=>{var b;const w=i.current;n(t.messages,!1);const _=f?t.messages:t.messages.map(({role:j,content:S,experimental_attachments:E,data:O,annotations:N,toolInvocations:M})=>({role:j,content:S,...E!==void 0&&{experimental_attachments:E},...O!==void 0&&{data:O},...N!==void 0&&{annotations:N},...M!==void 0&&{toolInvocations:M}})),x=a.current;return await mee({api:e,body:(b=y==null?void 0:y({messages:t.messages,requestData:t.data,requestBody:t.body}))!=null?b:{messages:_,data:t.data,...o.current.body,...t.body},streamProtocol:l,credentials:o.current.credentials,headers:{...o.current.headers,...t.headers},abortController:()=>s.current,restoreMessagesOnFailure(){v||n(w,!1)},onResponse:d,onUpdate(j,S){n([...t.messages,...j],!1),S!=null&&S.length&&r([...x??[],...S],!1)},onToolCall:p,onFinish:u,generateId:c,fetch:m})};function Zee({api:e="/api/chat",id:t,initialMessages:n,initialInput:r="",sendExtraMessageFields:a,onToolCall:o,experimental_prepareRequestBody:i,maxSteps:s=1,streamProtocol:c="data",onResponse:l,onFinish:u,onError:d,credentials:p,headers:f,body:y,generateId:m=pT,fetch:v,keepLastMessageOnError:b=!0,experimental_throttle:w}={}){const _=g.useId(),x=t??_,j=typeof e=="string"?[e,x]:x,[S]=g.useState([]),{data:E,mutate:O}=Hf([j,"messages"],null,{fallbackData:n??S}),N=g.useRef(E||[]);g.useEffect(()=>{N.current=E||[]},[E]);const{data:M,mutate:P}=Hf([j,"streamData"],null),I=g.useRef(M);g.useEffect(()=>{I.current=M},[M]);const{data:k=!1,mutate:C}=Hf([j,"loading"],null),{data:T=void 0,mutate:A}=Hf([j,"error"],null),R=g.useRef(null),L=g.useRef({credentials:p,headers:f,body:y});g.useEffect(()=>{L.current={credentials:p,headers:f,body:y}},[p,f,y]);const D=g.useCallback(async K=>{const q=N.current.length;try{C(!0),A(void 0);const z=new AbortController;R.current=z,await Kee(e,K,kT(O,w),kT(P,w),I,L,N,R,m,c,u,l,o,a,i,v,b),R.current=null}catch(z){if(z.name==="AbortError")return R.current=null,null;d&&z instanceof Error&&d(z),A(z)}finally{C(!1)}const G=N.current,ne=G[G.length-1];G.length>q&&ne!=null&&s>1&&AT(ne)&&Xee(G)<s&&await D({messages:G})},[O,C,e,L,l,u,d,A,P,I,c,a,i,o,s,N,R,m,v,b,w]),B=g.useCallback(async(K,{data:q,headers:G,body:ne,experimental_attachments:z}={})=>{var se,re;K.id||(K.id=m());const le=await TT(z),je=N.current.concat({...K,id:(se=K.id)!=null?se:m(),createdAt:(re=K.createdAt)!=null?re:new Date,experimental_attachments:le.length>0?le:void 0});return D({messages:je,headers:G,body:ne,data:q})},[D,m]),F=g.useCallback(async({data:K,headers:q,body:G}={})=>{const ne=N.current;if(ne.length===0)return null;const z=ne[ne.length-1];return D({messages:z.role==="assistant"?ne.slice(0,-1):ne,headers:q,body:G,data:K})},[D]),$=g.useCallback(()=>{R.current&&(R.current.abort(),R.current=null)},[]),V=g.useCallback(K=>{typeof K=="function"&&(K=K(N.current)),O(K,!1),N.current=K},[O]),Q=g.useCallback(K=>{typeof K=="function"&&(K=K(I.current)),P(K,!1),I.current=K},[P]),[X,H]=g.useState(r),J=g.useCallback(async(K,q={},G)=>{var ne;if((ne=K==null?void 0:K.preventDefault)==null||ne.call(K),!X&&!q.allowEmptySubmit)return;G&&(L.current={...L.current,...G});const z=await TT(q.experimental_attachments),se={messages:!X&&!z.length&&q.allowEmptySubmit?N.current:N.current.concat({id:m(),createdAt:new Date,role:"user",content:X,experimental_attachments:z.length>0?z:void 0}),headers:q.headers,body:q.body,data:q.data};D(se),H("")},[X,m,D]);return{messages:E||[],setMessages:V,data:M,setData:Q,error:T,append:B,reload:F,stop:$,input:X,setInput:H,handleInputChange:K=>{H(K.target.value)},handleSubmit:J,isLoading:k,addToolResult:({toolCallId:K,result:q})=>{const G=N.current.map((z,se,re)=>se===re.length-1&&z.role==="assistant"&&z.toolInvocations?{...z,toolInvocations:z.toolInvocations.map(le=>le.toolCallId===K?{...le,result:q,state:"result"}:le)}:z);O(G,!1);const ne=G[G.length-1];AT(ne)&&D({messages:G})}}}function AT(e){return e.role==="assistant"&&e.toolInvocations&&e.toolInvocations.length>0&&e.toolInvocations.every(t=>"result"in t)}function Xee(e){let t=0;for(let n=e.length-1;n>=0&&e[n].role==="assistant";n--)t++;return t}async function TT(e){if(e==null)return[];if(e instanceof FileList)return Promise.all(Array.from(e).map(async t=>{const{name:n,type:r}=t,a=await new Promise((o,i)=>{const s=new FileReader;s.onload=c=>{var l;o((l=c.target)==null?void 0:l.result)},s.onerror=c=>i(c),s.readAsDataURL(t)});return{name:n,contentType:r,url:a}}));if(Array.isArray(e))return e;throw new Error("Invalid attachments type")}HN=Zee;const uo=g.forwardRef(({className:e,...t},n)=>h.jsx("textarea",{className:Z("flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));uo.displayName="Textarea";function Qee({minHeight:e,maxHeight:t}){const n=g.useRef(null),r=g.useCallback(a=>{const o=n.current;if(!o)return;if(a){o.style.height=`${e}px`;return}o.style.height=`${e}px`;const i=Math.max(e,Math.min(o.scrollHeight,t??Number.POSITIVE_INFINITY));o.style.height=`${i}px`},[e,t]);return g.useEffect(()=>{const a=n.current;a&&(a.style.height=`${e}px`)},[e]),g.useEffect(()=>{const a=()=>r();return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[r]),{textareaRef:n,adjustHeight:r}}const Gee=48,IT=164;bv=function({onSubmit:e,disabled:t,enableTool:n,enableFile:r,placeholder:a,minHeight:o,maxHeight:i,className:s,height:c,onChange:l,value:u}){const[d,p]=g.useState(!1),[f,y]=g.useState(""),{textareaRef:m,adjustHeight:v}=Qee({minHeight:o||Gee,maxHeight:i||IT}),[b,w]=g.useState(!0),_=g.useCallback(async j=>{try{p(!0),await e(f,j)&&y("")}finally{p(!1)}},[f,e]),x=g.useMemo(()=>({maxHeight:`${i||IT}px`,...c?{height:`${c}px`}:{}}),[i,c]);return h.jsx("div",{className:Z("w-full py-4 max-w-xl",s),children:h.jsx("div",{className:"relative w-full mx-auto",children:h.jsxs("div",{className:"relative flex flex-col",children:[h.jsx("div",{className:"overflow-y-auto",style:x,children:h.jsx(uo,{id:"ai-input-04",value:(l?u:f)||"",disabled:t||d,placeholder:a,className:"w-full rounded-xl rounded-b-none px-4 py-3 bg-black/5 dark:bg-white/5 border-none dark:text-white placeholder:text-black/70 dark:placeholder:text-white/70 resize-none focus-visible:ring-0 leading-[1.2]",ref:m,onKeyDown:j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),_(j))},onChange:j=>{l||y(j.target.value),v(),l==null||l(j)}})}),h.jsxs("div",{className:"h-12 bg-black/5 dark:bg-white/5 rounded-b-xl",children:[h.jsxs("div",{className:"absolute left-3 bottom-3 flex items-center gap-2",children:[r?h.jsxs("label",{className:"cursor-pointer rounded-lg p-2 bg-black/5 dark:bg-white/5",children:[h.jsx("input",{type:"file",className:"hidden"}),h.jsx(de,{name:"paperclip",className:"w-4 h-4 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white transition-colors"})]}):void 0,n?h.jsxs("button",{type:"button",onClick:()=>{w(!b)},className:Z("rounded-full transition-all flex items-center gap-2 px-1.5 py-1 border h-8",b?"bg-sky-500/15 border-sky-400 text-sky-500":"bg-black/5 dark:bg-white/5 border-transparent text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:[h.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:h.jsx(Ap.div,{animate:{rotate:b?180:0,scale:b?1.1:1},whileHover:{rotate:b?180:15,scale:1.1,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:h.jsx(de,{name:"globe",className:Z("w-4 h-4",b?"text-sky-500":"text-inherit")})})}),h.jsx(DK,{children:b&&h.jsx(Ap.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-sm overflow-hidden whitespace-nowrap text-sky-500 flex-shrink-0",children:"Search"})})]}):void 0]}),h.jsx("div",{className:"absolute right-3 bottom-3",children:h.jsx("button",{type:"button",disabled:t||d,onClick:j=>{_(j)},className:Z("rounded-lg p-2",l&&u||f?"bg-sky-500/15 text-sky-500":"bg-black/5 dark:bg-white/5 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:h.jsx(de,{name:"send",className:"w-4 h-4"})})})]})]})})})};var Sb,RT;function Jee(){if(RT)return Sb;RT=1;function e(){this.__data__=[],this.size=0}return Sb=e,Sb}var Eb,DT;Rl=function(){if(DT)return Eb;DT=1;function e(t,n){return t===n||t!==t&&n!==n}return Eb=e,Eb};var Ob,LT;function Kf(){if(LT)return Ob;LT=1;var e=Rl();function t(n,r){for(var a=n.length;a--;)if(e(n[a][0],r))return a;return-1}return Ob=t,Ob}var Cb,$T;function Yee(){if($T)return Cb;$T=1;var e=Kf(),t=Array.prototype,n=t.splice;function r(a){var o=this.__data__,i=e(o,a);if(i<0)return!1;var s=o.length-1;return i==s?o.pop():n.call(o,i,1),--this.size,!0}return Cb=r,Cb}var Nb,FT;function ete(){if(FT)return Nb;FT=1;var e=Kf();function t(n){var r=this.__data__,a=e(r,n);return a<0?void 0:r[a][1]}return Nb=t,Nb}var Mb,BT;function tte(){if(BT)return Mb;BT=1;var e=Kf();function t(n){return e(this.__data__,n)>-1}return Mb=t,Mb}var Pb,zT;function nte(){if(zT)return Pb;zT=1;var e=Kf();function t(n,r){var a=this.__data__,o=e(a,n);return o<0?(++this.size,a.push([n,r])):a[o][1]=r,this}return Pb=t,Pb}var kb,VT;function Zf(){if(VT)return kb;VT=1;var e=Jee(),t=Yee(),n=ete(),r=tte(),a=nte();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,kb=o,kb}var Ab,WT;function rte(){if(WT)return Ab;WT=1;var e=Zf();function t(){this.__data__=new e,this.size=0}return Ab=t,Ab}var Tb,UT;function ate(){if(UT)return Tb;UT=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return Tb=e,Tb}var Ib,qT;function ote(){if(qT)return Ib;qT=1;function e(t){return this.__data__.get(t)}return Ib=e,Ib}var Rb,HT;function ite(){if(HT)return Rb;HT=1;function e(t){return this.__data__.has(t)}return Rb=e,Rb}var Db,KT;function ZT(){if(KT)return Db;KT=1;var e=typeof kl=="object"&&kl&&kl.Object===Object&&kl;return Db=e,Db}var Lb,XT;Ar=function(){if(XT)return Lb;XT=1;var e=ZT(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return Lb=n,Lb};var $b,QT;Ps=function(){if(QT)return $b;QT=1;var e=Ar(),t=e.Symbol;return $b=t,$b};var Fb,GT;function ste(){if(GT)return Fb;GT=1;var e=Ps(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,a=e?e.toStringTag:void 0;function o(i){var s=n.call(i,a),c=i[a];try{i[a]=void 0;var l=!0}catch{}var u=r.call(i);return l&&(s?i[a]=c:delete i[a]),u}return Fb=o,Fb}var Bb,JT;function cte(){if(JT)return Bb;JT=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return Bb=n,Bb}var zb,YT;function po(){if(YT)return zb;YT=1;var e=Ps(),t=ste(),n=cte(),r="[object Null]",a="[object Undefined]",o=e?e.toStringTag:void 0;function i(s){return s==null?s===void 0?a:r:o&&o in Object(s)?t(s):n(s)}return zb=i,zb}var Vb,eI;Tr=function(){if(eI)return Vb;eI=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Vb=e,Vb};var Wb,tI;Fp=function(){if(tI)return Wb;tI=1;var e=po(),t=Tr(),n="[object AsyncFunction]",r="[object Function]",a="[object GeneratorFunction]",o="[object Proxy]";function i(s){if(!t(s))return!1;var c=e(s);return c==r||c==a||c==n||c==o}return Wb=i,Wb};var Ub,nI;function lte(){if(nI)return Ub;nI=1;var e=Ar(),t=e["__core-js_shared__"];return Ub=t,Ub}var qb,rI;function ute(){if(rI)return qb;rI=1;var e=lte(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return qb=n,qb}var Hb,aI;function oI(){if(aI)return Hb;aI=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return Hb=n,Hb}var Kb,iI;function dte(){if(iI)return Kb;iI=1;var e=Fp(),t=ute(),n=Tr(),r=oI(),a=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,i=Function.prototype,s=Object.prototype,c=i.toString,l=s.hasOwnProperty,u=RegExp("^"+c.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(p){if(!n(p)||t(p))return!1;var f=e(p)?u:o;return f.test(r(p))}return Kb=d,Kb}var Zb,sI;function pte(){if(sI)return Zb;sI=1;function e(t,n){return t==null?void 0:t[n]}return Zb=e,Zb}var Xb,cI;function Bi(){if(cI)return Xb;cI=1;var e=dte(),t=pte();function n(r,a){var o=t(r,a);return e(o)?o:void 0}return Xb=n,Xb}var Qb,lI;function Gb(){if(lI)return Qb;lI=1;var e=Bi(),t=Ar(),n=e(t,"Map");return Qb=n,Qb}var Jb,uI;function Xf(){if(uI)return Jb;uI=1;var e=Bi(),t=e(Object,"create");return Jb=t,Jb}var Yb,dI;function fte(){if(dI)return Yb;dI=1;var e=Xf();function t(){this.__data__=e?e(null):{},this.size=0}return Yb=t,Yb}var ew,pI;function hte(){if(pI)return ew;pI=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return ew=e,ew}var tw,fI;function mte(){if(fI)return tw;fI=1;var e=Xf(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function a(o){var i=this.__data__;if(e){var s=i[o];return s===t?void 0:s}return r.call(i,o)?i[o]:void 0}return tw=a,tw}var nw,hI;function yte(){if(hI)return nw;hI=1;var e=Xf(),t=Object.prototype,n=t.hasOwnProperty;function r(a){var o=this.__data__;return e?o[a]!==void 0:n.call(o,a)}return nw=r,nw}var rw,mI;function gte(){if(mI)return rw;mI=1;var e=Xf(),t="__lodash_hash_undefined__";function n(r,a){var o=this.__data__;return this.size+=this.has(r)?0:1,o[r]=e&&a===void 0?t:a,this}return rw=n,rw}var aw,yI;function vte(){if(yI)return aw;yI=1;var e=fte(),t=hte(),n=mte(),r=yte(),a=gte();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,aw=o,aw}var ow,gI;function bte(){if(gI)return ow;gI=1;var e=vte(),t=Zf(),n=Gb();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return ow=r,ow}var iw,vI;function wte(){if(vI)return iw;vI=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return iw=e,iw}var sw,bI;function Qf(){if(bI)return sw;bI=1;var e=wte();function t(n,r){var a=n.__data__;return e(r)?a[typeof r=="string"?"string":"hash"]:a.map}return sw=t,sw}var cw,wI;function xte(){if(wI)return cw;wI=1;var e=Qf();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return cw=t,cw}var lw,xI;function _te(){if(xI)return lw;xI=1;var e=Qf();function t(n){return e(this,n).get(n)}return lw=t,lw}var uw,_I;function jte(){if(_I)return uw;_I=1;var e=Qf();function t(n){return e(this,n).has(n)}return uw=t,uw}var dw,jI;function Ste(){if(jI)return dw;jI=1;var e=Qf();function t(n,r){var a=e(this,n),o=a.size;return a.set(n,r),this.size+=a.size==o?0:1,this}return dw=t,dw}var pw,SI;function fw(){if(SI)return pw;SI=1;var e=bte(),t=xte(),n=_te(),r=jte(),a=Ste();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,pw=o,pw}var hw,EI;function Ete(){if(EI)return hw;EI=1;var e=Zf(),t=Gb(),n=fw(),r=200;function a(o,i){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<r-1)return c.push([o,i]),this.size=++s.size,this;s=this.__data__=new n(c)}return s.set(o,i),this.size=s.size,this}return hw=a,hw}var mw,OI;Pv=function(){if(OI)return mw;OI=1;var e=Zf(),t=rte(),n=ate(),r=ote(),a=ite(),o=Ete();function i(s){var c=this.__data__=new e(s);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=a,i.prototype.set=o,mw=i,mw};var yw,CI;function Ote(){if(CI)return yw;CI=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return yw=t,yw}var gw,NI;function Cte(){if(NI)return gw;NI=1;function e(t){return this.__data__.has(t)}return gw=e,gw}var vw,MI;function PI(){if(MI)return vw;MI=1;var e=fw(),t=Ote(),n=Cte();function r(a){var o=-1,i=a==null?0:a.length;for(this.__data__=new e;++o<i;)this.add(a[o])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,vw=r,vw}var bw,kI;function AI(){if(kI)return bw;kI=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(n(t[r],r,t))return!0;return!1}return bw=e,bw}var ww,TI;function II(){if(TI)return ww;TI=1;function e(t,n){return t.has(n)}return ww=e,ww}var xw,RI;function DI(){if(RI)return xw;RI=1;var e=PI(),t=AI(),n=II(),r=1,a=2;function o(i,s,c,l,u,d){var p=c&r,f=i.length,y=s.length;if(f!=y&&!(p&&y>f))return!1;var m=d.get(i),v=d.get(s);if(m&&v)return m==s&&v==i;var b=-1,w=!0,_=c&a?new e:void 0;for(d.set(i,s),d.set(s,i);++b<f;){var x=i[b],j=s[b];if(l)var S=p?l(j,x,b,s,i,d):l(x,j,b,i,s,d);if(S!==void 0){if(S)continue;w=!1;break}if(_){if(!t(s,function(E,O){if(!n(_,O)&&(x===E||u(x,E,c,l,d)))return _.push(O)})){w=!1;break}}else if(!(x===j||u(x,j,c,l,d))){w=!1;break}}return d.delete(i),d.delete(s),w}return xw=o,xw}var _w,LI;yM=function(){if(LI)return _w;LI=1;var e=Ar(),t=e.Uint8Array;return _w=t,_w};var jw,$I;function Nte(){if($I)return jw;$I=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a,o){r[++n]=[o,a]}),r}return jw=e,jw}var Sw,FI;function Ew(){if(FI)return Sw;FI=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a){r[++n]=a}),r}return Sw=e,Sw}var Ow,BI;function Mte(){if(BI)return Ow;BI=1;var e=Ps(),t=yM(),n=Rl(),r=DI(),a=Nte(),o=Ew(),i=1,s=2,c="[object Boolean]",l="[object Date]",u="[object Error]",d="[object Map]",p="[object Number]",f="[object RegExp]",y="[object Set]",m="[object String]",v="[object Symbol]",b="[object ArrayBuffer]",w="[object DataView]",_=e?e.prototype:void 0,x=_?_.valueOf:void 0;function j(S,E,O,N,M,P,I){switch(O){case w:if(S.byteLength!=E.byteLength||S.byteOffset!=E.byteOffset)return!1;S=S.buffer,E=E.buffer;case b:return!(S.byteLength!=E.byteLength||!P(new t(S),new t(E)));case c:case l:case p:return n(+S,+E);case u:return S.name==E.name&&S.message==E.message;case f:case m:return S==E+"";case d:var k=a;case y:var C=N&i;if(k||(k=o),S.size!=E.size&&!C)return!1;var T=I.get(S);if(T)return T==E;N|=s,I.set(S,E);var A=r(k(S),k(E),N,M,P,I);return I.delete(S),A;case v:if(x)return x.call(S)==x.call(E)}return!1}return Ow=j,Ow}var Cw,zI;function Nw(){if(zI)return Cw;zI=1;function e(t,n){for(var r=-1,a=n.length,o=t.length;++r<a;)t[o+r]=n[r];return t}return Cw=e,Cw}var Mw,VI;In=function(){if(VI)return Mw;VI=1;var e=Array.isArray;return Mw=e,Mw};var Pw,WI;function UI(){if(WI)return Pw;WI=1;var e=Nw(),t=In();function n(r,a,o){var i=a(r);return t(r)?i:e(i,o(r))}return Pw=n,Pw}var kw,qI;function Pte(){if(qI)return kw;qI=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=0,i=[];++r<a;){var s=t[r];n(s,r,t)&&(i[o++]=s)}return i}return kw=e,kw}var Aw,HI;function KI(){if(HI)return Aw;HI=1;function e(){return[]}return Aw=e,Aw}var Tw,ZI;Ov=function(){if(ZI)return Tw;ZI=1;var e=Pte(),t=KI(),n=Object.prototype,r=n.propertyIsEnumerable,a=Object.getOwnPropertySymbols,o=a?function(i){return i==null?[]:(i=Object(i),e(a(i),function(s){return r.call(i,s)}))}:t;return Tw=o,Tw};var Iw,XI;function kte(){if(XI)return Iw;XI=1;function e(t,n){for(var r=-1,a=Array(t);++r<t;)a[r]=n(r);return a}return Iw=e,Iw}var Rw,QI;ha=function(){if(QI)return Rw;QI=1;function e(t){return t!=null&&typeof t=="object"}return Rw=e,Rw};var Dw,GI;function Ate(){if(GI)return Dw;GI=1;var e=po(),t=ha(),n="[object Arguments]";function r(a){return t(a)&&e(a)==n}return Dw=r,Dw}var Lw,JI;$p=function(){if(JI)return Lw;JI=1;var e=Ate(),t=ha(),n=Object.prototype,r=n.hasOwnProperty,a=n.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(i){return t(i)&&r.call(i,"callee")&&!a.call(i,"callee")};return Lw=o,Lw};var Gf={exports:{}},$w,YI;function Tte(){if(YI)return $w;YI=1;function e(){return!1}return $w=e,$w}Gf.exports;var eR;kv=function(){return eR||(eR=1,function(e,t){var n=Ar(),r=Tte(),a=t&&!t.nodeType&&t,o=a&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===a,s=i?n.Buffer:void 0,c=s?s.isBuffer:void 0,l=c||r;e.exports=l}(Gf,Gf.exports)),Gf.exports};var Fw,tR;function Jf(){if(tR)return Fw;tR=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,a){var o=typeof r;return a=a??e,!!a&&(o=="number"||o!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<a}return Fw=n,Fw}var Bw,nR;function zw(){if(nR)return Bw;nR=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return Bw=t,Bw}var Vw,rR;function Ite(){if(rR)return Vw;rR=1;var e=po(),t=zw(),n=ha(),r="[object Arguments]",a="[object Array]",o="[object Boolean]",i="[object Date]",s="[object Error]",c="[object Function]",l="[object Map]",u="[object Number]",d="[object Object]",p="[object RegExp]",f="[object Set]",y="[object String]",m="[object WeakMap]",v="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",j="[object Int16Array]",S="[object Int32Array]",E="[object Uint8Array]",O="[object Uint8ClampedArray]",N="[object Uint16Array]",M="[object Uint32Array]",P={};P[w]=P[_]=P[x]=P[j]=P[S]=P[E]=P[O]=P[N]=P[M]=!0,P[r]=P[a]=P[v]=P[o]=P[b]=P[i]=P[s]=P[c]=P[l]=P[u]=P[d]=P[p]=P[f]=P[y]=P[m]=!1;function I(k){return n(k)&&t(k.length)&&!!P[e(k)]}return Vw=I,Vw}var Ww,aR;Mv=function(){if(aR)return Ww;aR=1;function e(t){return function(n){return t(n)}}return Ww=e,Ww};var Yf={exports:{}};Yf.exports;var oR;vM=function(){return oR||(oR=1,function(e,t){var n=ZT(),r=t&&!t.nodeType&&t,a=r&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===r,i=o&&n.process,s=function(){try{var c=a&&a.require&&a.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=s}(Yf,Yf.exports)),Yf.exports};var Uw,iR;Tg=function(){if(iR)return Uw;iR=1;var e=Ite(),t=Mv(),n=vM(),r=n&&n.isTypedArray,a=r?t(r):e;return Uw=a,Uw};var qw,sR;function cR(){if(sR)return qw;sR=1;var e=kte(),t=$p(),n=In(),r=kv(),a=Jf(),o=Tg(),i=Object.prototype,s=i.hasOwnProperty;function c(l,u){var d=n(l),p=!d&&t(l),f=!d&&!p&&r(l),y=!d&&!p&&!f&&o(l),m=d||p||f||y,v=m?e(l.length,String):[],b=v.length;for(var w in l)(u||s.call(l,w))&&!(m&&(w=="length"||f&&(w=="offset"||w=="parent")||y&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||a(w,b)))&&v.push(w);return v}return qw=c,qw}var Hw,lR;Nv=function(){if(lR)return Hw;lR=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,a=typeof r=="function"&&r.prototype||e;return n===a}return Hw=t,Hw};var Kw,uR;function dR(){if(uR)return Kw;uR=1;function e(t,n){return function(r){return t(n(r))}}return Kw=e,Kw}var Zw,pR;function Rte(){if(pR)return Zw;pR=1;var e=dR(),t=e(Object.keys,Object);return Zw=t,Zw}var Xw,fR;function Dte(){if(fR)return Xw;fR=1;var e=Nv(),t=Rte(),n=Object.prototype,r=n.hasOwnProperty;function a(o){if(!e(o))return t(o);var i=[];for(var s in Object(o))r.call(o,s)&&s!="constructor"&&i.push(s);return i}return Xw=a,Xw}var Qw,hR;Ni=function(){if(hR)return Qw;hR=1;var e=Fp(),t=zw();function n(r){return r!=null&&t(r.length)&&!e(r)}return Qw=n,Qw};var Gw,mR;zl=function(){if(mR)return Gw;mR=1;var e=cR(),t=Dte(),n=Ni();function r(a){return n(a)?e(a):t(a)}return Gw=r,Gw};var Jw,yR;bM=function(){if(yR)return Jw;yR=1;var e=UI(),t=Ov(),n=zl();function r(a){return e(a,n,t)}return Jw=r,Jw};var Yw,gR;function Lte(){if(gR)return Yw;gR=1;var e=bM(),t=1,n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s,c,l,u){var d=s&t,p=e(o),f=p.length,y=e(i),m=y.length;if(f!=m&&!d)return!1;for(var v=f;v--;){var b=p[v];if(!(d?b in i:r.call(i,b)))return!1}var w=u.get(o),_=u.get(i);if(w&&_)return w==i&&_==o;var x=!0;u.set(o,i),u.set(i,o);for(var j=d;++v<f;){b=p[v];var S=o[b],E=i[b];if(c)var O=d?c(E,S,b,i,o,u):c(S,E,b,o,i,u);if(!(O===void 0?S===E||l(S,E,s,c,u):O)){x=!1;break}j||(j=b=="constructor")}if(x&&!j){var N=o.constructor,M=i.constructor;N!=M&&"constructor"in o&&"constructor"in i&&!(typeof N=="function"&&N instanceof N&&typeof M=="function"&&M instanceof M)&&(x=!1)}return u.delete(o),u.delete(i),x}return Yw=a,Yw}var ex,vR;function $te(){if(vR)return ex;vR=1;var e=Bi(),t=Ar(),n=e(t,"DataView");return ex=n,ex}var tx,bR;function Fte(){if(bR)return tx;bR=1;var e=Bi(),t=Ar(),n=e(t,"Promise");return tx=n,tx}var nx,wR;function xR(){if(wR)return nx;wR=1;var e=Bi(),t=Ar(),n=e(t,"Set");return nx=n,nx}var rx,_R;function Bte(){if(_R)return rx;_R=1;var e=Bi(),t=Ar(),n=e(t,"WeakMap");return rx=n,rx}var ax,jR;gM=function(){if(jR)return ax;jR=1;var e=$te(),t=Gb(),n=Fte(),r=xR(),a=Bte(),o=po(),i=oI(),s="[object Map]",c="[object Object]",l="[object Promise]",u="[object Set]",d="[object WeakMap]",p="[object DataView]",f=i(e),y=i(t),m=i(n),v=i(r),b=i(a),w=o;return(e&&w(new e(new ArrayBuffer(1)))!=p||t&&w(new t)!=s||n&&w(n.resolve())!=l||r&&w(new r)!=u||a&&w(new a)!=d)&&(w=function(_){var x=o(_),j=x==c?_.constructor:void 0,S=j?i(j):"";if(S)switch(S){case f:return p;case y:return s;case m:return l;case v:return u;case b:return d}return x}),ax=w,ax};var ox,SR;function zte(){if(SR)return ox;SR=1;var e=Pv(),t=DI(),n=Mte(),r=Lte(),a=gM(),o=In(),i=kv(),s=Tg(),c=1,l="[object Arguments]",u="[object Array]",d="[object Object]",p=Object.prototype,f=p.hasOwnProperty;function y(m,v,b,w,_,x){var j=o(m),S=o(v),E=j?u:a(m),O=S?u:a(v);E=E==l?d:E,O=O==l?d:O;var N=E==d,M=O==d,P=E==O;if(P&&i(m)){if(!i(v))return!1;j=!0,N=!1}if(P&&!N)return x||(x=new e),j||s(m)?t(m,v,b,w,_,x):n(m,v,E,b,w,_,x);if(!(b&c)){var I=N&&f.call(m,"__wrapped__"),k=M&&f.call(v,"__wrapped__");if(I||k){var C=I?m.value():m,T=k?v.value():v;return x||(x=new e),_(C,T,b,w,x)}}return P?(x||(x=new e),r(m,v,b,w,_,x)):!1}return ox=y,ox}var ix,ER;function sx(){if(ER)return ix;ER=1;var e=zte(),t=ha();function n(r,a,o,i,s){return r===a?!0:r==null||a==null||!t(r)&&!t(a)?r!==r&&a!==a:e(r,a,o,i,n,s)}return ix=n,ix}var cx,OR;function Vte(){if(OR)return cx;OR=1;var e=Pv(),t=sx(),n=1,r=2;function a(o,i,s,c){var l=s.length,u=l,d=!c;if(o==null)return!u;for(o=Object(o);l--;){var p=s[l];if(d&&p[2]?p[1]!==o[p[0]]:!(p[0]in o))return!1}for(;++l<u;){p=s[l];var f=p[0],y=o[f],m=p[1];if(d&&p[2]){if(y===void 0&&!(f in o))return!1}else{var v=new e;if(c)var b=c(y,m,f,o,i,v);if(!(b===void 0?t(m,y,n|r,c,v):b))return!1}}return!0}return cx=a,cx}var lx,CR;function NR(){if(CR)return lx;CR=1;var e=Tr();function t(n){return n===n&&!e(n)}return lx=t,lx}var ux,MR;function Wte(){if(MR)return ux;MR=1;var e=NR(),t=zl();function n(r){for(var a=t(r),o=a.length;o--;){var i=a[o],s=r[i];a[o]=[i,s,e(s)]}return a}return ux=n,ux}var dx,PR;function kR(){if(PR)return dx;PR=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return dx=e,dx}var px,AR;function Ute(){if(AR)return px;AR=1;var e=Vte(),t=Wte(),n=kR();function r(a){var o=t(a);return o.length==1&&o[0][2]?n(o[0][0],o[0][1]):function(i){return i===a||e(i,a,o)}}return px=r,px}var fx,TR;function Gs(){if(TR)return fx;TR=1;var e=po(),t=ha(),n="[object Symbol]";function r(a){return typeof a=="symbol"||t(a)&&e(a)==n}return fx=r,fx}var hx,IR;function mx(){if(IR)return hx;IR=1;var e=In(),t=Gs(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function a(o,i){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:r.test(o)||!n.test(o)||i!=null&&o in Object(i)}return hx=a,hx}var yx,RR;function DR(){if(RR)return yx;RR=1;var e=fw(),t="Expected a function";function n(r,a){if(typeof r!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var o=function(){var i=arguments,s=a?a.apply(this,i):i[0],c=o.cache;if(c.has(s))return c.get(s);var l=r.apply(this,i);return o.cache=c.set(s,l)||c,l};return o.cache=new(n.Cache||e),o}return n.Cache=e,yx=n,yx}var gx,LR;function qte(){if(LR)return gx;LR=1;var e=DR(),t=500;function n(r){var a=e(r,function(i){return o.size===t&&o.clear(),i}),o=a.cache;return a}return gx=n,gx}var vx,$R;function Hte(){if($R)return vx;$R=1;var e=qte(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(a){var o=[];return a.charCodeAt(0)===46&&o.push(""),a.replace(t,function(i,s,c,l){o.push(c?l.replace(n,"$1"):s||i)}),o});return vx=r,vx}var bx,FR;Il=function(){if(FR)return bx;FR=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=Array(a);++r<a;)o[r]=n(t[r],r,t);return o}return bx=e,bx};var wx,BR;function Kte(){if(BR)return wx;BR=1;var e=Ps(),t=Il(),n=In(),r=Gs(),a=1/0,o=e?e.prototype:void 0,i=o?o.toString:void 0;function s(c){if(typeof c=="string")return c;if(n(c))return t(c,s)+"";if(r(c))return i?i.call(c):"";var l=c+"";return l=="0"&&1/c==-a?"-0":l}return wx=s,wx}var xx,zR;function VR(){if(zR)return xx;zR=1;var e=Kte();function t(n){return n==null?"":e(n)}return xx=t,xx}var _x,WR;ql=function(){if(WR)return _x;WR=1;var e=In(),t=mx(),n=Hte(),r=VR();function a(o,i){return e(o)?o:t(o,i)?[o]:n(r(o))}return _x=a,_x};var jx,UR;ks=function(){if(UR)return jx;UR=1;var e=Gs(),t=1/0;function n(r){if(typeof r=="string"||e(r))return r;var a=r+"";return a=="0"&&1/r==-t?"-0":a}return jx=n,jx};var Sx,qR;Ul=function(){if(qR)return Sx;qR=1;var e=ql(),t=ks();function n(r,a){a=e(a,r);for(var o=0,i=a.length;r!=null&&o<i;)r=r[t(a[o++])];return o&&o==i?r:void 0}return Sx=n,Sx};var Ex,HR;function KR(){if(HR)return Ex;HR=1;var e=Ul();function t(n,r,a){var o=n==null?void 0:e(n,r);return o===void 0?a:o}return Ex=t,Ex}var Ox,ZR;function Zte(){if(ZR)return Ox;ZR=1;function e(t,n){return t!=null&&n in Object(t)}return Ox=e,Ox}var Cx,XR;function Xte(){if(XR)return Cx;XR=1;var e=ql(),t=$p(),n=In(),r=Jf(),a=zw(),o=ks();function i(s,c,l){c=e(c,s);for(var u=-1,d=c.length,p=!1;++u<d;){var f=o(c[u]);if(!(p=s!=null&&l(s,f)))break;s=s[f]}return p||++u!=d?p:(d=s==null?0:s.length,!!d&&a(d)&&r(f,d)&&(n(s)||t(s)))}return Cx=i,Cx}var Nx,QR;$N=function(){if(QR)return Nx;QR=1;var e=Zte(),t=Xte();function n(r,a){return r!=null&&t(r,a,e)}return Nx=n,Nx};var Mx,GR;function Qte(){if(GR)return Mx;GR=1;var e=sx(),t=KR(),n=$N(),r=mx(),a=NR(),o=kR(),i=ks(),s=1,c=2;function l(u,d){return r(u)&&a(d)?o(i(u),d):function(p){var f=t(p,u);return f===void 0&&f===d?n(p,u):e(d,f,s|c)}}return Mx=l,Mx}var Px,JR;function Js(){if(JR)return Px;JR=1;function e(t){return t}return Px=e,Px}var kx,YR;function Gte(){if(YR)return kx;YR=1;function e(t){return function(n){return n==null?void 0:n[t]}}return kx=e,kx}var Ax,eD;function Jte(){if(eD)return Ax;eD=1;var e=Ul();function t(n){return function(r){return e(r,n)}}return Ax=t,Ax}var Tx,tD;function Yte(){if(tD)return Tx;tD=1;var e=Gte(),t=Jte(),n=mx(),r=ks();function a(o){return n(o)?e(r(o)):t(o)}return Tx=a,Tx}var Ix,nD;function _a(){if(nD)return Ix;nD=1;var e=Ute(),t=Qte(),n=Js(),r=In(),a=Yte();function o(i){return typeof i=="function"?i:i==null?n:typeof i=="object"?r(i)?t(i[0],i[1]):e(i):a(i)}return Ix=o,Ix}var Rx,rD;function ene(){if(rD)return Rx;rD=1;var e="Expected a function";function t(n){if(typeof n!="function")throw new TypeError(e);return function(){var r=arguments;switch(r.length){case 0:return!n.call(this);case 1:return!n.call(this,r[0]);case 2:return!n.call(this,r[0],r[1]);case 3:return!n.call(this,r[0],r[1],r[2])}return!n.apply(this,r)}}return Rx=t,Rx}var Dx,aD;function oD(){if(aD)return Dx;aD=1;var e=Bi(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return Dx=t,Dx}var Lx,iD;Dg=function(){if(iD)return Lx;iD=1;var e=oD();function t(n,r,a){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[r]=a}return Lx=t,Lx};var $x,sD;wM=function(){if(sD)return $x;sD=1;var e=Dg(),t=Rl(),n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s){var c=o[i];(!(r.call(o,i)&&t(c,s))||s===void 0&&!(i in o))&&e(o,i,s)}return $x=a,$x};var Fx,cD;function tne(){if(cD)return Fx;cD=1;var e=wM(),t=ql(),n=Jf(),r=Tr(),a=ks();function o(i,s,c,l){if(!r(i))return i;s=t(s,i);for(var u=-1,d=s.length,p=d-1,f=i;f!=null&&++u<d;){var y=a(s[u]),m=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return i;if(u!=p){var v=f[y];m=l?l(v,y,f):void 0,m===void 0&&(m=r(v)?v:n(s[u+1])?[]:{})}e(f,y,m),f=f[y]}return i}return Fx=o,Fx}var Bx,lD;LN=function(){if(lD)return Bx;lD=1;var e=Ul(),t=tne(),n=ql();function r(a,o,i){for(var s=-1,c=o.length,l={};++s<c;){var u=o[s],d=e(a,u);i(d,u)&&t(l,n(u,a),d)}return l}return Bx=r,Bx};var zx,uD;Cv=function(){if(uD)return zx;uD=1;var e=dR(),t=e(Object.getPrototypeOf,Object);return zx=t,zx};var Vx,dD;mM=function(){if(dD)return Vx;dD=1;var e=Nw(),t=Cv(),n=Ov(),r=KI(),a=Object.getOwnPropertySymbols,o=a?function(i){for(var s=[];i;)e(s,n(i)),i=t(i);return s}:r;return Vx=o,Vx};var Wx,pD;function nne(){if(pD)return Wx;pD=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return Wx=e,Wx}var Ux,fD;function rne(){if(fD)return Ux;fD=1;var e=Tr(),t=Nv(),n=nne(),r=Object.prototype,a=r.hasOwnProperty;function o(i){if(!e(i))return n(i);var s=t(i),c=[];for(var l in i)l=="constructor"&&(s||!a.call(i,l))||c.push(l);return c}return Ux=o,Ux}var qx,hD;hM=function(){if(hD)return qx;hD=1;var e=cR(),t=rne(),n=Ni();function r(a){return n(a)?e(a,!0):t(a)}return qx=r,qx};var Hx,mD;xM=function(){if(mD)return Hx;mD=1;var e=UI(),t=mM(),n=hM();function r(a){return e(a,n,t)}return Hx=r,Hx};var Kx,yD;function ane(){if(yD)return Kx;yD=1;var e=Il(),t=_a(),n=LN(),r=xM();function a(o,i){if(o==null)return{};var s=e(r(o),function(c){return[c]});return i=t(i),n(o,s,function(c,l){return i(c,l[0])})}return Kx=a,Kx}var Zx,gD;function one(){if(gD)return Zx;gD=1;var e=_a(),t=ene(),n=ane();function r(a,o){return n(a,t(e(o)))}return Zx=r,Zx}var ine=one();const ku=ot(ine);var Xx,vD;function sne(){if(vD)return Xx;vD=1;function e(t){return t===void 0}return Xx=e,Xx}var cne=sne();const Au=ot(cne);function Gt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=Gt(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var lne={value:()=>{}};function eh(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new th(n)}function th(e){this._=e}function une(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}th.prototype=eh.prototype={constructor:th,on:function(e,t){var n=this._,r=une(e+"",n),a,o=-1,i=r.length;if(arguments.length<2){for(;++o<i;)if((a=(e=r[o]).type)&&(a=dne(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<i;)if(a=(e=r[o]).type)n[a]=bD(n[a],e.name,t);else if(t==null)for(a in n)n[a]=bD(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new th(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,o;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,a=o.length;r<a;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,o=r.length;a<o;++a)r[a].value.apply(t,n)}};function dne(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function bD(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=lne,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Qx="http://www.w3.org/1999/xhtml";const wD={svg:"http://www.w3.org/2000/svg",xhtml:Qx,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nh(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),wD.hasOwnProperty(t)?{space:wD[t],local:e}:e}function pne(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Qx&&t.documentElement.namespaceURI===Qx?t.createElement(e):t.createElementNS(n,e)}}function fne(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function xD(e){var t=nh(e);return(t.local?fne:pne)(t)}function hne(){}function Gx(e){return e==null?hne:function(){return this.querySelector(e)}}function mne(e){typeof e!="function"&&(e=Gx(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=new Array(i),c,l,u=0;u<i;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),s[u]=l);return new sr(r,this._parents)}function yne(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function gne(){return[]}function _D(e){return e==null?gne:function(){return this.querySelectorAll(e)}}function vne(e){return function(){return yne(e.apply(this,arguments))}}function bne(e){typeof e=="function"?e=vne(e):e=_D(e);for(var t=this._groups,n=t.length,r=[],a=[],o=0;o<n;++o)for(var i=t[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),a.push(c));return new sr(r,a)}function jD(e){return function(){return this.matches(e)}}function SD(e){return function(t){return t.matches(e)}}var wne=Array.prototype.find;function xne(e){return function(){return wne.call(this.children,e)}}function _ne(){return this.firstElementChild}function jne(e){return this.select(e==null?_ne:xne(typeof e=="function"?e:SD(e)))}var Sne=Array.prototype.filter;function Ene(){return Array.from(this.children)}function One(e){return function(){return Sne.call(this.children,e)}}function Cne(e){return this.selectAll(e==null?Ene:One(typeof e=="function"?e:SD(e)))}function Nne(e){typeof e!="function"&&(e=jD(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new sr(r,this._parents)}function ED(e){return new Array(e.length)}function Mne(){return new sr(this._enter||this._groups.map(ED),this._parents)}function rh(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}rh.prototype={constructor:rh,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Pne(e){return function(){return e}}function kne(e,t,n,r,a,o){for(var i=0,s,c=t.length,l=o.length;i<l;++i)(s=t[i])?(s.__data__=o[i],r[i]=s):n[i]=new rh(e,o[i]);for(;i<c;++i)(s=t[i])&&(a[i]=s)}function Ane(e,t,n,r,a,o,i){var s,c,l=new Map,u=t.length,d=o.length,p=new Array(u),f;for(s=0;s<u;++s)(c=t[s])&&(p[s]=f=i.call(c,c.__data__,s,t)+"",l.has(f)?a[s]=c:l.set(f,c));for(s=0;s<d;++s)f=i.call(e,o[s],s,o)+"",(c=l.get(f))?(r[s]=c,c.__data__=o[s],l.delete(f)):n[s]=new rh(e,o[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(p[s])===c&&(a[s]=c)}function Tne(e){return e.__data__}function Ine(e,t){if(!arguments.length)return Array.from(this,Tne);var n=t?Ane:kne,r=this._parents,a=this._groups;typeof e!="function"&&(e=Pne(e));for(var o=a.length,i=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],d=a[l],p=d.length,f=Rne(e.call(u,u&&u.__data__,l,r)),y=f.length,m=s[l]=new Array(y),v=i[l]=new Array(y),b=c[l]=new Array(p);n(u,d,m,v,b,f,t);for(var w=0,_=0,x,j;w<y;++w)if(x=m[w]){for(w>=_&&(_=w+1);!(j=v[_])&&++_<y;);x._next=j||null}}return i=new sr(i,r),i._enter=s,i._exit=c,i}function Rne(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Dne(){return new sr(this._exit||this._groups.map(ED),this._parents)}function Lne(e,t,n){var r=this.enter(),a=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?o.remove():n(o),r&&a?r.merge(a).order():a}function $ne(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,o=r.length,i=Math.min(a,o),s=new Array(a),c=0;c<i;++c)for(var l=n[c],u=r[c],d=l.length,p=s[c]=new Array(d),f,y=0;y<d;++y)(f=l[y]||u[y])&&(p[y]=f);for(;c<a;++c)s[c]=n[c];return new sr(s,this._parents)}function Fne(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,o=r[a],i;--a>=0;)(i=r[a])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function Bne(e){e||(e=zne);function t(d,p){return d&&p?e(d.__data__,p.__data__):!d-!p}for(var n=this._groups,r=n.length,a=new Array(r),o=0;o<r;++o){for(var i=n[o],s=i.length,c=a[o]=new Array(s),l,u=0;u<s;++u)(l=i[u])&&(c[u]=l);c.sort(t)}return new sr(a,this._parents).order()}function zne(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Vne(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Wne(){return Array.from(this)}function Une(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length;a<o;++a){var i=r[a];if(i)return i}return null}function qne(){let e=0;for(const t of this)++e;return e}function Hne(){return!this.node()}function Kne(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],o=0,i=a.length,s;o<i;++o)(s=a[o])&&e.call(s,s.__data__,o,a);return this}function Zne(e){return function(){this.removeAttribute(e)}}function Xne(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Qne(e,t){return function(){this.setAttribute(e,t)}}function Gne(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Jne(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Yne(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ere(e,t){var n=nh(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Xne:Zne:typeof t=="function"?n.local?Yne:Jne:n.local?Gne:Qne)(n,t))}function OD(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function tre(e){return function(){this.style.removeProperty(e)}}function nre(e,t,n){return function(){this.style.setProperty(e,t,n)}}function rre(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function are(e,t,n){return arguments.length>1?this.each((t==null?tre:typeof t=="function"?rre:nre)(e,t,n??"")):Ys(this.node(),e)}function Ys(e,t){return e.style.getPropertyValue(t)||OD(e).getComputedStyle(e,null).getPropertyValue(t)}function ore(e){return function(){delete this[e]}}function ire(e,t){return function(){this[e]=t}}function sre(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function cre(e,t){return arguments.length>1?this.each((t==null?ore:typeof t=="function"?sre:ire)(e,t)):this.node()[e]}function CD(e){return e.trim().split(/^|\s+/)}function Jx(e){return e.classList||new ND(e)}function ND(e){this._node=e,this._names=CD(e.getAttribute("class")||"")}ND.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function MD(e,t){for(var n=Jx(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function PD(e,t){for(var n=Jx(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function lre(e){return function(){MD(this,e)}}function ure(e){return function(){PD(this,e)}}function dre(e,t){return function(){(t.apply(this,arguments)?MD:PD)(this,e)}}function pre(e,t){var n=CD(e+"");if(arguments.length<2){for(var r=Jx(this.node()),a=-1,o=n.length;++a<o;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?dre:t?lre:ure)(n,t))}function fre(){this.textContent=""}function hre(e){return function(){this.textContent=e}}function mre(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function yre(e){return arguments.length?this.each(e==null?fre:(typeof e=="function"?mre:hre)(e)):this.node().textContent}function gre(){this.innerHTML=""}function vre(e){return function(){this.innerHTML=e}}function bre(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function wre(e){return arguments.length?this.each(e==null?gre:(typeof e=="function"?bre:vre)(e)):this.node().innerHTML}function xre(){this.nextSibling&&this.parentNode.appendChild(this)}function _re(){return this.each(xre)}function jre(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Sre(){return this.each(jre)}function Ere(e){var t=typeof e=="function"?e:xD(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Ore(){return null}function Cre(e,t){var n=typeof e=="function"?e:xD(e),r=t==null?Ore:typeof t=="function"?t:Gx(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Nre(){var e=this.parentNode;e&&e.removeChild(this)}function Mre(){return this.each(Nre)}function Pre(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function kre(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Are(e){return this.select(e?kre:Pre)}function Tre(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Ire(e){return function(t){e.call(this,t,this.__data__)}}function Rre(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Dre(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,o;n<a;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function Lre(e,t,n){return function(){var r=this.__on,a,o=Ire(t);if(r){for(var i=0,s=r.length;i<s;++i)if((a=r[i]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=o,a.options=n),a.value=t;return}}this.addEventListener(e.type,o,n),a={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(a):this.__on=[a]}}function $re(e,t,n){var r=Rre(e+""),a,o=r.length,i;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(a=0,u=s[c];a<o;++a)if((i=r[a]).type===u.type&&i.name===u.name)return u.value}return}for(s=t?Lre:Dre,a=0;a<o;++a)this.each(s(r[a],t,n));return this}function kD(e,t,n){var r=OD(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function Fre(e,t){return function(){return kD(this,e,t)}}function Bre(e,t){return function(){return kD(this,e,t.apply(this,arguments))}}function zre(e,t){return this.each((typeof t=="function"?Bre:Fre)(e,t))}function*Vre(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length,i;a<o;++a)(i=r[a])&&(yield i)}var AD=[null];function sr(e,t){this._groups=e,this._parents=t}function Tu(){return new sr([[document.documentElement]],AD)}function Wre(){return this}sr.prototype=Tu.prototype={constructor:sr,select:mne,selectAll:bne,selectChild:jne,selectChildren:Cne,filter:Nne,data:Ine,enter:Mne,exit:Dne,join:Lne,merge:$ne,selection:Wre,order:Fne,sort:Bne,call:Vne,nodes:Wne,node:Une,size:qne,empty:Hne,each:Kne,attr:ere,style:are,property:cre,classed:pre,text:yre,html:wre,raise:_re,lower:Sre,append:Ere,insert:Cre,remove:Mre,clone:Are,datum:Tre,on:$re,dispatch:zre,[Symbol.iterator]:Vre};function cr(e){return typeof e=="string"?new sr([[document.querySelector(e)]],[document.documentElement]):new sr([[e]],AD)}function Ure(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Vr(e,t){if(e=Ure(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const qre={passive:!1},Iu={capture:!0,passive:!1};function Yx(e){e.stopImmediatePropagation()}function ec(e){e.preventDefault(),e.stopImmediatePropagation()}function TD(e){var t=e.document.documentElement,n=cr(e).on("dragstart.drag",ec,Iu);"onselectstart"in t?n.on("selectstart.drag",ec,Iu):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ID(e,t){var n=e.document.documentElement,r=cr(e).on("dragstart.drag",null);t&&(r.on("click.drag",ec,Iu),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const ah=e=>()=>e;function e1(e,{sourceEvent:t,subject:n,target:r,identifier:a,active:o,x:i,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}e1.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Hre(e){return!e.ctrlKey&&!e.button}function Kre(){return this.parentNode}function Zre(e,t){return t??{x:e.x,y:e.y}}function Xre(){return navigator.maxTouchPoints||"ontouchstart"in this}function RD(){var e=Hre,t=Kre,n=Zre,r=Xre,a={},o=eh("start","drag","end"),i=0,s,c,l,u,d=0;function p(x){x.on("mousedown.drag",f).filter(r).on("touchstart.drag",v).on("touchmove.drag",b,qre).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(x,j){if(!(u||!e.call(this,x,j))){var S=_(this,t.call(this,x,j),x,j,"mouse");S&&(cr(x.view).on("mousemove.drag",y,Iu).on("mouseup.drag",m,Iu),TD(x.view),Yx(x),l=!1,s=x.clientX,c=x.clientY,S("start",x))}}function y(x){if(ec(x),!l){var j=x.clientX-s,S=x.clientY-c;l=j*j+S*S>d}a.mouse("drag",x)}function m(x){cr(x.view).on("mousemove.drag mouseup.drag",null),ID(x.view,l),ec(x),a.mouse("end",x)}function v(x,j){if(e.call(this,x,j)){var S=x.changedTouches,E=t.call(this,x,j),O=S.length,N,M;for(N=0;N<O;++N)(M=_(this,E,x,j,S[N].identifier,S[N]))&&(Yx(x),M("start",x,S[N]))}}function b(x){var j=x.changedTouches,S=j.length,E,O;for(E=0;E<S;++E)(O=a[j[E].identifier])&&(ec(x),O("drag",x,j[E]))}function w(x){var j=x.changedTouches,S=j.length,E,O;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),E=0;E<S;++E)(O=a[j[E].identifier])&&(Yx(x),O("end",x,j[E]))}function _(x,j,S,E,O,N){var M=o.copy(),P=Vr(N||S,j),I,k,C;if((C=n.call(x,new e1("beforestart",{sourceEvent:S,target:p,identifier:O,active:i,x:P[0],y:P[1],dx:0,dy:0,dispatch:M}),E))!=null)return I=C.x-P[0]||0,k=C.y-P[1]||0,function T(A,R,L){var D=P,B;switch(A){case"start":a[O]=T,B=i++;break;case"end":delete a[O],--i;case"drag":P=Vr(L||R,j),B=i;break}M.call(A,x,new e1(A,{sourceEvent:R,subject:C,target:p,identifier:O,active:B,x:P[0]+I,y:P[1]+k,dx:P[0]-D[0],dy:P[1]-D[1],dispatch:M}),E)}}return p.filter=function(x){return arguments.length?(e=typeof x=="function"?x:ah(!!x),p):e},p.container=function(x){return arguments.length?(t=typeof x=="function"?x:ah(x),p):t},p.subject=function(x){return arguments.length?(n=typeof x=="function"?x:ah(x),p):n},p.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:ah(!!x),p):r},p.on=function(){var x=o.on.apply(o,arguments);return x===o?p:x},p.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,p):Math.sqrt(d)},p}function t1(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function DD(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ru(){}var Du=.7,oh=1/Du,tc="\\s*([+-]?\\d+)\\s*",Lu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ja="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Qre=/^#([0-9a-f]{3,8})$/,Gre=new RegExp(`^rgb\\(${tc},${tc},${tc}\\)$`),Jre=new RegExp(`^rgb\\(${ja},${ja},${ja}\\)$`),Yre=new RegExp(`^rgba\\(${tc},${tc},${tc},${Lu}\\)$`),eae=new RegExp(`^rgba\\(${ja},${ja},${ja},${Lu}\\)$`),tae=new RegExp(`^hsl\\(${Lu},${ja},${ja}\\)$`),nae=new RegExp(`^hsla\\(${Lu},${ja},${ja},${Lu}\\)$`),LD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};t1(Ru,zi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:$D,formatHex:$D,formatHex8:rae,formatHsl:aae,formatRgb:FD,toString:FD});function $D(){return this.rgb().formatHex()}function rae(){return this.rgb().formatHex8()}function aae(){return UD(this).formatHsl()}function FD(){return this.rgb().formatRgb()}function zi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Qre.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?BD(t):n===3?new Wn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ih(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ih(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Gre.exec(e))?new Wn(t[1],t[2],t[3],1):(t=Jre.exec(e))?new Wn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Yre.exec(e))?ih(t[1],t[2],t[3],t[4]):(t=eae.exec(e))?ih(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=tae.exec(e))?WD(t[1],t[2]/100,t[3]/100,1):(t=nae.exec(e))?WD(t[1],t[2]/100,t[3]/100,t[4]):LD.hasOwnProperty(e)?BD(LD[e]):e==="transparent"?new Wn(NaN,NaN,NaN,0):null}function BD(e){return new Wn(e>>16&255,e>>8&255,e&255,1)}function ih(e,t,n,r){return r<=0&&(e=t=n=NaN),new Wn(e,t,n,r)}function oae(e){return e instanceof Ru||(e=zi(e)),e?(e=e.rgb(),new Wn(e.r,e.g,e.b,e.opacity)):new Wn}function n1(e,t,n,r){return arguments.length===1?oae(e):new Wn(e,t,n,r??1)}function Wn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}t1(Wn,n1,DD(Ru,{brighter(e){return e=e==null?oh:Math.pow(oh,e),new Wn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Du:Math.pow(Du,e),new Wn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Wn(Vi(this.r),Vi(this.g),Vi(this.b),sh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zD,formatHex:zD,formatHex8:iae,formatRgb:VD,toString:VD}));function zD(){return`#${Wi(this.r)}${Wi(this.g)}${Wi(this.b)}`}function iae(){return`#${Wi(this.r)}${Wi(this.g)}${Wi(this.b)}${Wi((isNaN(this.opacity)?1:this.opacity)*255)}`}function VD(){const e=sh(this.opacity);return`${e===1?"rgb(":"rgba("}${Vi(this.r)}, ${Vi(this.g)}, ${Vi(this.b)}${e===1?")":`, ${e})`}`}function sh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Vi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wi(e){return e=Vi(e),(e<16?"0":"")+e.toString(16)}function WD(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Wr(e,t,n,r)}function UD(e){if(e instanceof Wr)return new Wr(e.h,e.s,e.l,e.opacity);if(e instanceof Ru||(e=zi(e)),!e)return new Wr;if(e instanceof Wr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,s=o-a,c=(o+a)/2;return s?(t===o?i=(n-r)/s+(n<r)*6:n===o?i=(r-t)/s+2:i=(t-n)/s+4,s/=c<.5?o+a:2-o-a,i*=60):s=c>0&&c<1?0:i,new Wr(i,s,c,e.opacity)}function sae(e,t,n,r){return arguments.length===1?UD(e):new Wr(e,t,n,r??1)}function Wr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}t1(Wr,sae,DD(Ru,{brighter(e){return e=e==null?oh:Math.pow(oh,e),new Wr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Du:Math.pow(Du,e),new Wr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Wn(r1(e>=240?e-240:e+120,a,r),r1(e,a,r),r1(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new Wr(qD(this.h),ch(this.s),ch(this.l),sh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=sh(this.opacity);return`${e===1?"hsl(":"hsla("}${qD(this.h)}, ${ch(this.s)*100}%, ${ch(this.l)*100}%${e===1?")":`, ${e})`}`}}));function qD(e){return e=(e||0)%360,e<0?e+360:e}function ch(e){return Math.max(0,Math.min(1,e||0))}function r1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const a1=e=>()=>e;function cae(e,t){return function(n){return e+n*t}}function lae(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function uae(e){return(e=+e)==1?HD:function(t,n){return n-t?lae(t,n,e):a1(isNaN(t)?n:t)}}function HD(e,t){var n=t-e;return n?cae(e,n):a1(isNaN(e)?t:e)}const lh=function e(t){var n=uae(t);function r(a,o){var i=n((a=n1(a)).r,(o=n1(o)).r),s=n(a.g,o.g),c=n(a.b,o.b),l=HD(a.opacity,o.opacity);return function(u){return a.r=i(u),a.g=s(u),a.b=c(u),a.opacity=l(u),a+""}}return r.gamma=e,r}(1);function dae(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(o){for(a=0;a<n;++a)r[a]=e[a]*(1-o)+t[a]*o;return r}}function pae(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function fae(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),o=new Array(n),i;for(i=0;i<r;++i)a[i]=nc(e[i],t[i]);for(;i<n;++i)o[i]=t[i];return function(s){for(i=0;i<r;++i)o[i]=a[i](s);return o}}function hae(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ur(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function mae(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=nc(e[a],t[a]):r[a]=t[a];return function(o){for(a in n)r[a]=n[a](o);return r}}var o1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,i1=new RegExp(o1.source,"g");function yae(e){return function(){return e}}function gae(e){return function(t){return e(t)+""}}function KD(e,t){var n=o1.lastIndex=i1.lastIndex=0,r,a,o,i=-1,s=[],c=[];for(e=e+"",t=t+"";(r=o1.exec(e))&&(a=i1.exec(t));)(o=a.index)>n&&(o=t.slice(n,o),s[i]?s[i]+=o:s[++i]=o),(r=r[0])===(a=a[0])?s[i]?s[i]+=a:s[++i]=a:(s[++i]=null,c.push({i,x:Ur(r,a)})),n=i1.lastIndex;return n<t.length&&(o=t.slice(n),s[i]?s[i]+=o:s[++i]=o),s.length<2?c[0]?gae(c[0].x):yae(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)s[(d=c[u]).i]=d.x(l);return s.join("")})}function nc(e,t){var n=typeof t,r;return t==null||n==="boolean"?a1(t):(n==="number"?Ur:n==="string"?(r=zi(t))?(t=r,lh):KD:t instanceof zi?lh:t instanceof Date?hae:pae(t)?dae:Array.isArray(t)?fae:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?mae:Ur)(e,t)}function s1(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var ZD=180/Math.PI,XD={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function QD(e,t,n,r,a,o){var i,s,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:a,translateY:o,rotate:Math.atan2(t,e)*ZD,skewX:Math.atan(c)*ZD,scaleX:i,scaleY:s}}var uh;function vae(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?XD:QD(t.a,t.b,t.c,t.d,t.e,t.f)}function bae(e){return e==null||(uh||(uh=document.createElementNS("http://www.w3.org/2000/svg","g")),uh.setAttribute("transform",e),!(e=uh.transform.baseVal.consolidate()))?XD:(e=e.matrix,QD(e.a,e.b,e.c,e.d,e.e,e.f))}function GD(e,t,n,r){function a(l){return l.length?l.pop()+" ":""}function o(l,u,d,p,f,y){if(l!==d||u!==p){var m=f.push("translate(",null,t,null,n);y.push({i:m-4,x:Ur(l,d)},{i:m-2,x:Ur(u,p)})}else(d||p)&&f.push("translate("+d+t+p+n)}function i(l,u,d,p){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),p.push({i:d.push(a(d)+"rotate(",null,r)-2,x:Ur(l,u)})):u&&d.push(a(d)+"rotate("+u+r)}function s(l,u,d,p){l!==u?p.push({i:d.push(a(d)+"skewX(",null,r)-2,x:Ur(l,u)}):u&&d.push(a(d)+"skewX("+u+r)}function c(l,u,d,p,f,y){if(l!==d||u!==p){var m=f.push(a(f)+"scale(",null,",",null,")");y.push({i:m-4,x:Ur(l,d)},{i:m-2,x:Ur(u,p)})}else(d!==1||p!==1)&&f.push(a(f)+"scale("+d+","+p+")")}return function(l,u){var d=[],p=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,d,p),i(l.rotate,u.rotate,d,p),s(l.skewX,u.skewX,d,p),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,p),l=u=null,function(f){for(var y=-1,m=p.length,v;++y<m;)d[(v=p[y]).i]=v.x(f);return d.join("")}}}var wae=GD(vae,"px, ","px)","deg)"),xae=GD(bae,", ",")",")"),_ae=1e-12;function JD(e){return((e=Math.exp(e))+1/e)/2}function jae(e){return((e=Math.exp(e))-1/e)/2}function Sae(e){return((e=Math.exp(2*e))-1)/(e+1)}const Eae=function e(t,n,r){function a(o,i){var s=o[0],c=o[1],l=o[2],u=i[0],d=i[1],p=i[2],f=u-s,y=d-c,m=f*f+y*y,v,b;if(m<_ae)b=Math.log(p/l)/t,v=function(E){return[s+E*f,c+E*y,l*Math.exp(t*E*b)]};else{var w=Math.sqrt(m),_=(p*p-l*l+r*m)/(2*l*n*w),x=(p*p-l*l-r*m)/(2*p*n*w),j=Math.log(Math.sqrt(_*_+1)-_),S=Math.log(Math.sqrt(x*x+1)-x);b=(S-j)/t,v=function(E){var O=E*b,N=JD(j),M=l/(n*w)*(N*Sae(t*O+j)-jae(j));return[s+M*f,c+M*y,l*N/JD(t*O+j)]}}return v.duration=b*1e3*t/Math.SQRT2,v}return a.rho=function(o){var i=Math.max(.001,+o),s=i*i,c=s*s;return e(i,s,c)},a}(Math.SQRT2,2,4);function Oae(e,t){t===void 0&&(t=e,e=nc);for(var n=0,r=t.length-1,a=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(a,a=t[++n]);return function(i){var s=Math.max(0,Math.min(r-1,Math.floor(i*=r)));return o[s](i-s)}}var rc=0,$u=0,Fu=0,YD=1e3,dh,Bu,ph=0,Ui=0,fh=0,zu=typeof performance=="object"&&performance.now?performance:Date,e3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function c1(){return Ui||(e3(Cae),Ui=zu.now()+fh)}function Cae(){Ui=0}function hh(){this._call=this._time=this._next=null}hh.prototype=t3.prototype={constructor:hh,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?c1():+n)+(t==null?0:+t),!this._next&&Bu!==this&&(Bu?Bu._next=this:dh=this,Bu=this),this._call=e,this._time=n,l1()},stop:function(){this._call&&(this._call=null,this._time=1/0,l1())}};function t3(e,t,n){var r=new hh;return r.restart(e,t,n),r}function Nae(){c1(),++rc;for(var e=dh,t;e;)(t=Ui-e._time)>=0&&e._call.call(void 0,t),e=e._next;--rc}function n3(){Ui=(ph=zu.now())+fh,rc=$u=0;try{Nae()}finally{rc=0,Pae(),Ui=0}}function Mae(){var e=zu.now(),t=e-ph;t>YD&&(fh-=t,ph=e)}function Pae(){for(var e,t=dh,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:dh=n);Bu=e,l1(r)}function l1(e){if(!rc){$u&&($u=clearTimeout($u));var t=e-Ui;t>24?(e<1/0&&($u=setTimeout(n3,e-zu.now()-fh)),Fu&&(Fu=clearInterval(Fu))):(Fu||(ph=zu.now(),Fu=setInterval(Mae,YD)),rc=1,e3(n3))}}function r3(e,t,n){var r=new hh;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var kae=eh("start","end","cancel","interrupt"),Aae=[],a3=0,o3=1,u1=2,mh=3,i3=4,d1=5,yh=6;function gh(e,t,n,r,a,o){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;Tae(e,n,{name:t,index:r,group:a,on:kae,tween:Aae,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:a3})}function p1(e,t){var n=qr(e,t);if(n.state>a3)throw new Error("too late; already scheduled");return n}function Sa(e,t){var n=qr(e,t);if(n.state>mh)throw new Error("too late; already running");return n}function qr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Tae(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=t3(o,0,n.time);function o(l){n.state=o3,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var u,d,p,f;if(n.state!==o3)return c();for(u in r)if(f=r[u],f.name===n.name){if(f.state===mh)return r3(i);f.state===i3?(f.state=yh,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete r[u]):+u<t&&(f.state=yh,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete r[u])}if(r3(function(){n.state===mh&&(n.state=i3,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=u1,n.on.call("start",e,e.__data__,n.index,n.group),n.state===u1){for(n.state=mh,a=new Array(p=n.tween.length),u=0,d=-1;u<p;++u)(f=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(a[++d]=f);a.length=d+1}}function s(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=d1,1),d=-1,p=a.length;++d<p;)a[d].call(e,u);n.state===d1&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=yh,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function vh(e,t){var n=e.__transition,r,a,o=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){o=!1;continue}a=r.state>u1&&r.state<d1,r.state=yh,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}o&&delete e.__transition}}function Iae(e){return this.each(function(){vh(this,e)})}function Rae(e,t){var n,r;return function(){var a=Sa(this,e),o=a.tween;if(o!==n){r=n=o;for(var i=0,s=r.length;i<s;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}a.tween=r}}function Dae(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var o=Sa(this,e),i=o.tween;if(i!==r){a=(r=i).slice();for(var s={name:t,value:n},c=0,l=a.length;c<l;++c)if(a[c].name===t){a[c]=s;break}c===l&&a.push(s)}o.tween=a}}function Lae(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=qr(this.node(),n).tween,a=0,o=r.length,i;a<o;++a)if((i=r[a]).name===e)return i.value;return null}return this.each((t==null?Rae:Dae)(n,e,t))}function f1(e,t,n){var r=e._id;return e.each(function(){var a=Sa(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return qr(a,r).value[t]}}function s3(e,t){var n;return(typeof t=="number"?Ur:t instanceof zi?lh:(n=zi(t))?(t=n,lh):KD)(e,t)}function $ae(e){return function(){this.removeAttribute(e)}}function Fae(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Bae(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttribute(e);return i===a?null:i===r?o:o=t(r=i,n)}}function zae(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===r?o:o=t(r=i,n)}}function Vae(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function Wae(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function Uae(e,t){var n=nh(e),r=n==="transform"?xae:s3;return this.attrTween(e,typeof t=="function"?(n.local?Wae:Vae)(n,r,f1(this,"attr."+e,t)):t==null?(n.local?Fae:$ae)(n):(n.local?zae:Bae)(n,r,t))}function qae(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Hae(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Kae(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Hae(e,o)),n}return a._value=t,a}function Zae(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&qae(e,o)),n}return a._value=t,a}function Xae(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=nh(e);return this.tween(n,(r.local?Kae:Zae)(r,t))}function Qae(e,t){return function(){p1(this,e).delay=+t.apply(this,arguments)}}function Gae(e,t){return t=+t,function(){p1(this,e).delay=t}}function Jae(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Qae:Gae)(t,e)):qr(this.node(),t).delay}function Yae(e,t){return function(){Sa(this,e).duration=+t.apply(this,arguments)}}function eoe(e,t){return t=+t,function(){Sa(this,e).duration=t}}function toe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Yae:eoe)(t,e)):qr(this.node(),t).duration}function noe(e,t){if(typeof t!="function")throw new Error;return function(){Sa(this,e).ease=t}}function roe(e){var t=this._id;return arguments.length?this.each(noe(t,e)):qr(this.node(),t).ease}function aoe(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Sa(this,e).ease=n}}function ooe(e){if(typeof e!="function")throw new Error;return this.each(aoe(this._id,e))}function ioe(e){typeof e!="function"&&(e=jD(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new fo(r,this._parents,this._name,this._id)}function soe(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,o=Math.min(r,a),i=new Array(r),s=0;s<o;++s)for(var c=t[s],l=n[s],u=c.length,d=i[s]=new Array(u),p,f=0;f<u;++f)(p=c[f]||l[f])&&(d[f]=p);for(;s<r;++s)i[s]=t[s];return new fo(i,this._parents,this._name,this._id)}function coe(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function loe(e,t,n){var r,a,o=coe(t)?p1:Sa;return function(){var i=o(this,e),s=i.on;s!==r&&(a=(r=s).copy()).on(t,n),i.on=a}}function uoe(e,t){var n=this._id;return arguments.length<2?qr(this.node(),n).on.on(e):this.each(loe(n,e,t))}function doe(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function poe(){return this.on("end.remove",doe(this._id))}function foe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Gx(e));for(var r=this._groups,a=r.length,o=new Array(a),i=0;i<a;++i)for(var s=r[i],c=s.length,l=o[i]=new Array(c),u,d,p=0;p<c;++p)(u=s[p])&&(d=e.call(u,u.__data__,p,s))&&("__data__"in u&&(d.__data__=u.__data__),l[p]=d,gh(l[p],t,n,p,l,qr(u,n)));return new fo(o,this._parents,t,n)}function hoe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=_D(e));for(var r=this._groups,a=r.length,o=[],i=[],s=0;s<a;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var p=e.call(u,u.__data__,d,c),f,y=qr(u,n),m=0,v=p.length;m<v;++m)(f=p[m])&&gh(f,t,n,m,p,y);o.push(p),i.push(u)}return new fo(o,i,t,n)}var moe=Tu.prototype.constructor;function yoe(){return new moe(this._groups,this._parents)}function goe(e,t){var n,r,a;return function(){var o=Ys(this,e),i=(this.style.removeProperty(e),Ys(this,e));return o===i?null:o===n&&i===r?a:a=t(n=o,r=i)}}function c3(e){return function(){this.style.removeProperty(e)}}function voe(e,t,n){var r,a=n+"",o;return function(){var i=Ys(this,e);return i===a?null:i===r?o:o=t(r=i,n)}}function boe(e,t,n){var r,a,o;return function(){var i=Ys(this,e),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),Ys(this,e))),i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s))}}function woe(e,t){var n,r,a,o="style."+t,i="end."+o,s;return function(){var c=Sa(this,e),l=c.on,u=c.value[o]==null?s||(s=c3(t)):void 0;(l!==n||a!==u)&&(r=(n=l).copy()).on(i,a=u),c.on=r}}function xoe(e,t,n){var r=(e+="")=="transform"?wae:s3;return t==null?this.styleTween(e,goe(e,r)).on("end.style."+e,c3(e)):typeof t=="function"?this.styleTween(e,boe(e,r,f1(this,"style."+e,t))).each(woe(this._id,e)):this.styleTween(e,voe(e,r,t),n).on("end.style."+e,null)}function _oe(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function joe(e,t,n){var r,a;function o(){var i=t.apply(this,arguments);return i!==a&&(r=(a=i)&&_oe(e,i,n)),r}return o._value=t,o}function Soe(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,joe(e,t,n??""))}function Eoe(e){return function(){this.textContent=e}}function Ooe(e){return function(){var t=e(this);this.textContent=t??""}}function Coe(e){return this.tween("text",typeof e=="function"?Ooe(f1(this,"text",e)):Eoe(e==null?"":e+""))}function Noe(e){return function(t){this.textContent=e.call(this,t)}}function Moe(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&Noe(a)),t}return r._value=e,r}function Poe(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Moe(e))}function koe(){for(var e=this._name,t=this._id,n=l3(),r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)if(c=i[l]){var u=qr(c,t);gh(c,e,n,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new fo(r,this._parents,e,n)}function Aoe(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(o,i){var s={value:i},c={value:function(){--a===0&&o()}};n.each(function(){var l=Sa(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),l.on=t}),a===0&&o()})}var Toe=0;function fo(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function l3(){return++Toe}var ho=Tu.prototype;fo.prototype={constructor:fo,select:foe,selectAll:hoe,selectChild:ho.selectChild,selectChildren:ho.selectChildren,filter:ioe,merge:soe,selection:yoe,transition:koe,call:ho.call,nodes:ho.nodes,node:ho.node,size:ho.size,empty:ho.empty,each:ho.each,on:uoe,attr:Uae,attrTween:Xae,style:xoe,styleTween:Soe,text:Coe,textTween:Poe,remove:poe,tween:Lae,delay:Jae,duration:toe,ease:roe,easeVarying:ooe,end:Aoe,[Symbol.iterator]:ho[Symbol.iterator]};function Ioe(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Roe={time:null,delay:0,duration:250,ease:Ioe};function Doe(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Loe(e){var t,n;e instanceof fo?(t=e._id,e=e._name):(t=l3(),(n=Roe).time=c1(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&gh(c,e,t,l,i,n||Doe(c,t));return new fo(r,this._parents,e,t)}Tu.prototype.interrupt=Iae,Tu.prototype.transition=Loe;const bh=e=>()=>e;function $oe(e,{sourceEvent:t,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function mo(e,t,n){this.k=e,this.x=t,this.y=n}mo.prototype={constructor:mo,scale:function(e){return e===1?this:new mo(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new mo(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var wh=new mo(1,0,0);u3.prototype=mo.prototype;function u3(e){for(;!e.__zoom;)if(!(e=e.parentNode))return wh;return e.__zoom}function h1(e){e.stopImmediatePropagation()}function Vu(e){e.preventDefault(),e.stopImmediatePropagation()}function Foe(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Boe(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function d3(){return this.__zoom||wh}function zoe(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Voe(){return navigator.maxTouchPoints||"ontouchstart"in this}function Woe(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function p3(){var e=Foe,t=Boe,n=Woe,r=zoe,a=Voe,o=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,c=Eae,l=eh("start","zoom","end"),u,d,p,f=500,y=150,m=0,v=10;function b(C){C.property("__zoom",d3).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",N).on("dblclick.zoom",M).filter(a).on("touchstart.zoom",P).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(C,T,A,R){var L=C.selection?C.selection():C;L.property("__zoom",d3),C!==L?j(C,T,A,R):L.interrupt().each(function(){S(this,arguments).event(R).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},b.scaleBy=function(C,T,A,R){b.scaleTo(C,function(){var L=this.__zoom.k,D=typeof T=="function"?T.apply(this,arguments):T;return L*D},A,R)},b.scaleTo=function(C,T,A,R){b.transform(C,function(){var L=t.apply(this,arguments),D=this.__zoom,B=A==null?x(L):typeof A=="function"?A.apply(this,arguments):A,F=D.invert(B),$=typeof T=="function"?T.apply(this,arguments):T;return n(_(w(D,$),B,F),L,i)},A,R)},b.translateBy=function(C,T,A,R){b.transform(C,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),i)},null,R)},b.translateTo=function(C,T,A,R,L){b.transform(C,function(){var D=t.apply(this,arguments),B=this.__zoom,F=R==null?x(D):typeof R=="function"?R.apply(this,arguments):R;return n(wh.translate(F[0],F[1]).scale(B.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof A=="function"?-A.apply(this,arguments):-A),D,i)},R,L)};function w(C,T){return T=Math.max(o[0],Math.min(o[1],T)),T===C.k?C:new mo(T,C.x,C.y)}function _(C,T,A){var R=T[0]-A[0]*C.k,L=T[1]-A[1]*C.k;return R===C.x&&L===C.y?C:new mo(C.k,R,L)}function x(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function j(C,T,A,R){C.on("start.zoom",function(){S(this,arguments).event(R).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(R).end()}).tween("zoom",function(){var L=this,D=arguments,B=S(L,D).event(R),F=t.apply(L,D),$=A==null?x(F):typeof A=="function"?A.apply(L,D):A,V=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),Q=L.__zoom,X=typeof T=="function"?T.apply(L,D):T,H=c(Q.invert($).concat(V/Q.k),X.invert($).concat(V/X.k));return function(J){if(J===1)J=X;else{var K=H(J),q=V/K[2];J=new mo(q,$[0]-K[0]*q,$[1]-K[1]*q)}B.zoom(null,J)}})}function S(C,T,A){return!A&&C.__zooming||new E(C,T)}function E(C,T){this.that=C,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,T),this.taps=0}E.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,T){return this.mouse&&C!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var T=cr(this.that).datum();l.call(C,this.that,new $oe(C,{sourceEvent:this.sourceEvent,target:b,type:C,transform:this.that.__zoom,dispatch:l}),T)}};function O(C,...T){if(!e.apply(this,arguments))return;var A=S(this,T).event(C),R=this.__zoom,L=Math.max(o[0],Math.min(o[1],R.k*Math.pow(2,r.apply(this,arguments)))),D=Vr(C);if(A.wheel)(A.mouse[0][0]!==D[0]||A.mouse[0][1]!==D[1])&&(A.mouse[1]=R.invert(A.mouse[0]=D)),clearTimeout(A.wheel);else{if(R.k===L)return;A.mouse=[D,R.invert(D)],vh(this),A.start()}Vu(C),A.wheel=setTimeout(B,y),A.zoom("mouse",n(_(w(R,L),A.mouse[0],A.mouse[1]),A.extent,i));function B(){A.wheel=null,A.end()}}function N(C,...T){if(p||!e.apply(this,arguments))return;var A=C.currentTarget,R=S(this,T,!0).event(C),L=cr(C.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",V,!0),D=Vr(C,A),B=C.clientX,F=C.clientY;TD(C.view),h1(C),R.mouse=[D,this.__zoom.invert(D)],vh(this),R.start();function $(Q){if(Vu(Q),!R.moved){var X=Q.clientX-B,H=Q.clientY-F;R.moved=X*X+H*H>m}R.event(Q).zoom("mouse",n(_(R.that.__zoom,R.mouse[0]=Vr(Q,A),R.mouse[1]),R.extent,i))}function V(Q){L.on("mousemove.zoom mouseup.zoom",null),ID(Q.view,R.moved),Vu(Q),R.event(Q).end()}}function M(C,...T){if(e.apply(this,arguments)){var A=this.__zoom,R=Vr(C.changedTouches?C.changedTouches[0]:C,this),L=A.invert(R),D=A.k*(C.shiftKey?.5:2),B=n(_(w(A,D),R,L),t.apply(this,T),i);Vu(C),s>0?cr(this).transition().duration(s).call(j,B,R,C):cr(this).call(b.transform,B,R,C)}}function P(C,...T){if(e.apply(this,arguments)){var A=C.touches,R=A.length,L=S(this,T,C.changedTouches.length===R).event(C),D,B,F,$;for(h1(C),B=0;B<R;++B)F=A[B],$=Vr(F,this),$=[$,this.__zoom.invert($),F.identifier],L.touch0?!L.touch1&&L.touch0[2]!==$[2]&&(L.touch1=$,L.taps=0):(L.touch0=$,D=!0,L.taps=1+!!u);u&&(u=clearTimeout(u)),D&&(L.taps<2&&(d=$[0],u=setTimeout(function(){u=null},f)),vh(this),L.start())}}function I(C,...T){if(this.__zooming){var A=S(this,T).event(C),R=C.changedTouches,L=R.length,D,B,F,$;for(Vu(C),D=0;D<L;++D)B=R[D],F=Vr(B,this),A.touch0&&A.touch0[2]===B.identifier?A.touch0[0]=F:A.touch1&&A.touch1[2]===B.identifier&&(A.touch1[0]=F);if(B=A.that.__zoom,A.touch1){var V=A.touch0[0],Q=A.touch0[1],X=A.touch1[0],H=A.touch1[1],J=(J=X[0]-V[0])*J+(J=X[1]-V[1])*J,K=(K=H[0]-Q[0])*K+(K=H[1]-Q[1])*K;B=w(B,Math.sqrt(J/K)),F=[(V[0]+X[0])/2,(V[1]+X[1])/2],$=[(Q[0]+H[0])/2,(Q[1]+H[1])/2]}else if(A.touch0)F=A.touch0[0],$=A.touch0[1];else return;A.zoom("touch",n(_(B,F,$),A.extent,i))}}function k(C,...T){if(this.__zooming){var A=S(this,T).event(C),R=C.changedTouches,L=R.length,D,B;for(h1(C),p&&clearTimeout(p),p=setTimeout(function(){p=null},f),D=0;D<L;++D)B=R[D],A.touch0&&A.touch0[2]===B.identifier?delete A.touch0:A.touch1&&A.touch1[2]===B.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(B=Vr(B,this),Math.hypot(d[0]-B[0],d[1]-B[1])<v)){var F=cr(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return b.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:bh(+C),b):r},b.filter=function(C){return arguments.length?(e=typeof C=="function"?C:bh(!!C),b):e},b.touchable=function(C){return arguments.length?(a=typeof C=="function"?C:bh(!!C),b):a},b.extent=function(C){return arguments.length?(t=typeof C=="function"?C:bh([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),b):t},b.scaleExtent=function(C){return arguments.length?(o[0]=+C[0],o[1]=+C[1],b):[o[0],o[1]]},b.translateExtent=function(C){return arguments.length?(i[0][0]=+C[0][0],i[1][0]=+C[1][0],i[0][1]=+C[0][1],i[1][1]=+C[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(C){return arguments.length?(n=C,b):n},b.duration=function(C){return arguments.length?(s=+C,b):s},b.interpolate=function(C){return arguments.length?(c=C,b):c},b.on=function(){var C=l.on.apply(l,arguments);return C===l?b:C},b.clickDistance=function(C){return arguments.length?(m=(C=+C)*C,b):Math.sqrt(m)},b.tapDistance=function(C){return arguments.length?(v=+C,b):v},b}const yo={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},Wu=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],f3=["Enter"," ","Escape"];var ac;(function(e){e.Strict="strict",e.Loose="loose"})(ac||(ac={}));var ti;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ti||(ti={}));var Uu;(function(e){e.Partial="partial",e.Full="full"})(Uu||(Uu={}));const h3={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var ni;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ni||(ni={}));var xh;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(xh||(xh={}));var fe;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(fe||(fe={}));const m3={[fe.Left]:fe.Right,[fe.Right]:fe.Left,[fe.Top]:fe.Bottom,[fe.Bottom]:fe.Top};function Uoe(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function y3(e,t,n){if(!n)return;const r=[];e.forEach((a,o)=>{t!=null&&t.has(o)||r.push(a)}),r.length&&n(r)}function g3(e){return e===null?null:e?"valid":"invalid"}const v3=e=>"id"in e&&"source"in e&&"target"in e,qoe=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),m1=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),qu=(e,t=[0,0])=>{const{width:n,height:r}=go(e),a=e.origin??t,o=n*a[0],i=r*a[1];return{x:e.position.x-o,y:e.position.y-i}},Hoe=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,a)=>{const o=typeof a=="string";let i=!t.nodeLookup&&!o?a:void 0;t.nodeLookup&&(i=o?t.nodeLookup.get(a):m1(a)?a:t.nodeLookup.get(a.id));const s=i?Sh(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return _h(r,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return jh(n)},Hu=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const a=Sh(r);n=_h(n,a)}}),jh(n)},b3=(e,t,[n,r,a]=[0,0,1],o=!1,i=!1)=>{const s={...Zu(t,[n,r,a]),width:t.width/a,height:t.height/a},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:p=!1}=l;if(i&&!d||p)continue;const f=u.width??l.width??l.initialWidth??null,y=u.height??l.height??l.initialHeight??null,m=Ku(s,ic(l)),v=(f??0)*(y??0),b=o&&m>0;(!l.internals.handleBounds||b||m>=v||l.dragging)&&c.push(l)}return c},Koe=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function y1(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&(t!=null&&t.includeHiddenNodes||!a.hidden)&&(!r||r.has(a.id))&&n.set(a.id,a)}),n}async function g1({nodes:e,width:t,height:n,panZoom:r,minZoom:a,maxZoom:o},i){if(e.size===0)return Promise.resolve(!1);const s=Hu(e),c=b1(s,t,n,(i==null?void 0:i.minZoom)??a,(i==null?void 0:i.maxZoom)??o,(i==null?void 0:i.padding)??.1);return await r.setViewport(c,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function w3({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:a,onError:o}){const i=n.get(e),s=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=s?s.internals.positionAbsolute:{x:0,y:0},u=i.origin??r;let d=a;if(i.extent==="parent"&&!i.expandParent)if(!s)o==null||o("005",yo.error005());else{const f=s.measured.width,y=s.measured.height;f&&y&&(d=[[c,l],[c+f,l+y]])}else s&&sc(i.extent)&&(d=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const p=sc(d)?qi(t,d,i.measured):t;return{position:{x:p.x-c+i.measured.width*u[0],y:p.y-l+i.measured.height*u[1]},positionAbsolute:p}}async function Zoe({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:a}){const o=new Set(e.map(d=>d.id)),i=[];for(const d of n){if(d.deletable===!1)continue;const p=o.has(d.id),f=!p&&d.parentId&&i.find(y=>y.id===d.parentId);(p||f)&&i.push(d)}const s=new Set(t.map(d=>d.id)),c=r.filter(d=>d.deletable!==!1),l=Koe(i,c);for(const d of c)s.has(d.id)&&!l.find(p=>p.id===d.id)&&l.push(d);if(!a)return{edges:l,nodes:i};const u=await a({nodes:i,edges:l});return typeof u=="boolean"?u?{edges:l,nodes:i}:{edges:[],nodes:[]}:u}const oc=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),qi=(e={x:0,y:0},t,n)=>({x:oc(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:oc(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function x3(e,t,n){const{width:r,height:a}=go(n),{x:o,y:i}=n.internals.positionAbsolute;return qi(e,[[o,i],[o+r,i+a]],t)}const _3=(e,t,n)=>e<t?oc(Math.abs(e-t),1,t)/t:e>n?-oc(Math.abs(e-n),1,t)/t:0,j3=(e,t,n=15,r=40)=>{const a=_3(e.x,r,t.width-r)*n,o=_3(e.y,r,t.height-r)*n;return[a,o]},_h=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),v1=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),jh=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),ic=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=m1(e)?e.internals.positionAbsolute:qu(e,t);return{x:n,y:r,width:((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0,height:((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0}},Sh=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=m1(e)?e.internals.positionAbsolute:qu(e,t);return{x:n,y:r,x2:n+(((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0),y2:r+(((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0)}},S3=(e,t)=>jh(_h(v1(e),v1(t))),Ku=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},E3=e=>Hr(e.width)&&Hr(e.height)&&Hr(e.x)&&Hr(e.y),Hr=e=>!isNaN(e)&&isFinite(e),Xoe=(e,t)=>{},Eh=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Zu=({x:e,y:t},[n,r,a],o=!1,i=[1,1])=>{const s={x:(e-n)/a,y:(t-r)/a};return o?Eh(s,i):s},O3=({x:e,y:t},[n,r,a])=>({x:e*a+n,y:t*a+r}),b1=(e,t,n,r,a,o)=>{const i=t/(e.width*(1+o)),s=n/(e.height*(1+o)),c=Math.min(i,s),l=oc(c,r,a),u=e.x+e.width/2,d=e.y+e.height/2,p=t/2-u*l,f=n/2-d*l;return{x:p,y:f,zoom:l}},Oh=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function sc(e){return e!==void 0&&e!=="parent"}function go(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function C3(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function N3(e,t={width:0,height:0},n,r,a){const o={...e},i=r.get(n);if(i){const s=i.origin||a;o.x+=i.internals.positionAbsolute.x-(t.width??0)*s[0],o.y+=i.internals.positionAbsolute.y-(t.height??0)*s[1]}return o}function Xu(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:a}){const{x:o,y:i}=vo(e),s=Zu({x:o-((a==null?void 0:a.left)??0),y:i-((a==null?void 0:a.top)??0)},r),{x:c,y:l}=n?Eh(s,t):s;return{xSnapped:c,ySnapped:l,...s}}const Ch=e=>({width:e.offsetWidth,height:e.offsetHeight}),M3=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Qoe=["INPUT","SELECT","TEXTAREA"];function w1(e){var n,r;const t=((r=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:r[0])||e.target;return Qoe.includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}const P3=e=>"clientX"in e,vo=(e,t)=>{var o,i;const n=P3(e),r=n?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,a=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:a-((t==null?void 0:t.top)??0)}},k3=(e,t,n,r,a)=>{const o=t.querySelectorAll(`.${e}`);return!o||!o.length?null:Array.from(o).map(i=>{const s=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:a,position:i.getAttribute("data-handlepos"),x:(s.left-n.left)/r,y:(s.top-n.top)/r,...Ch(i)}})};function A3({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:a,sourceControlY:o,targetControlX:i,targetControlY:s}){const c=e*.125+a*.375+i*.375+n*.125,l=t*.125+o*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function Nh(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function T3({pos:e,x1:t,y1:n,x2:r,y2:a,c:o}){switch(e){case fe.Left:return[t-Nh(t-r,o),n];case fe.Right:return[t+Nh(r-t,o),n];case fe.Top:return[t,n-Nh(n-a,o)];case fe.Bottom:return[t,n+Nh(a-n,o)]}}function I3({sourceX:e,sourceY:t,sourcePosition:n=fe.Bottom,targetX:r,targetY:a,targetPosition:o=fe.Top,curvature:i=.25}){const[s,c]=T3({pos:n,x1:e,y1:t,x2:r,y2:a,c:i}),[l,u]=T3({pos:o,x1:r,y1:a,x2:e,y2:t,c:i}),[d,p,f,y]=A3({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${a}`,d,p,f,y]}function R3({sourceX:e,sourceY:t,targetX:n,targetY:r}){const a=Math.abs(n-e)/2,o=n<e?n+a:n-a,i=Math.abs(r-t)/2,s=r<t?r+i:r-i;return[o,s,a,i]}function Goe({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:a=!1}){if(!a)return r;const o=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(o?i:0)}function Joe({sourceNode:e,targetNode:t,width:n,height:r,transform:a}){const o=_h(Sh(e),Sh(t));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const i={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:r/a[2]};return Ku(i,jh(o))>0}const Yoe=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,eie=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),D3=(e,t)=>{if(!e.source||!e.target)return t;let n;return v3(e)?n={...e}:n={...e,id:Yoe(e)},eie(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function L3({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[a,o,i,s]=R3({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,a,o,i,s]}const $3={[fe.Left]:{x:-1,y:0},[fe.Right]:{x:1,y:0},[fe.Top]:{x:0,y:-1},[fe.Bottom]:{x:0,y:1}},tie=({source:e,sourcePosition:t=fe.Bottom,target:n})=>t===fe.Left||t===fe.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},F3=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function nie({source:e,sourcePosition:t=fe.Bottom,target:n,targetPosition:r=fe.Top,center:a,offset:o}){const i=$3[t],s=$3[r],c={x:e.x+i.x*o,y:e.y+i.y*o},l={x:n.x+s.x*o,y:n.y+s.y*o},u=tie({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",p=u[d];let f=[],y,m;const v={x:0,y:0},b={x:0,y:0},[w,_,x,j]=R3({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[d]*s[d]===-1){y=a.x??w,m=a.y??_;const S=[{x:y,y:c.y},{x:y,y:l.y}],E=[{x:c.x,y:m},{x:l.x,y:m}];i[d]===p?f=d==="x"?S:E:f=d==="x"?E:S}else{const S=[{x:c.x,y:l.y}],E=[{x:l.x,y:c.y}];if(d==="x"?f=i.x===p?E:S:f=i.y===p?S:E,t===r){const I=Math.abs(e[d]-n[d]);if(I<=o){const k=Math.min(o-1,o-I);i[d]===p?v[d]=(c[d]>e[d]?-1:1)*k:b[d]=(l[d]>n[d]?-1:1)*k}}if(t!==r){const I=d==="x"?"y":"x",k=i[d]===s[I],C=c[I]>l[I],T=c[I]<l[I];(i[d]===1&&(!k&&C||k&&T)||i[d]!==1&&(!k&&T||k&&C))&&(f=d==="x"?S:E)}const O={x:c.x+v.x,y:c.y+v.y},N={x:l.x+b.x,y:l.y+b.y},M=Math.max(Math.abs(O.x-f[0].x),Math.abs(N.x-f[0].x)),P=Math.max(Math.abs(O.y-f[0].y),Math.abs(N.y-f[0].y));M>=P?(y=(O.x+N.x)/2,m=f[0].y):(y=f[0].x,m=(O.y+N.y)/2)}return[[e,{x:c.x+v.x,y:c.y+v.y},...f,{x:l.x+b.x,y:l.y+b.y},n],y,m,x,j]}function rie(e,t,n,r){const a=Math.min(F3(e,t)/2,F3(t,n)/2,r),{x:o,y:i}=t;if(e.x===o&&o===n.x||e.y===i&&i===n.y)return`L${o} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${o+a*l},${i}Q ${o},${i} ${o},${i+a*u}`}const s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${o},${i+a*c}Q ${o},${i} ${o+a*s},${i}`}function x1({sourceX:e,sourceY:t,sourcePosition:n=fe.Bottom,targetX:r,targetY:a,targetPosition:o=fe.Top,borderRadius:i=5,centerX:s,centerY:c,offset:l=20}){const[u,d,p,f,y]=nie({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:a},targetPosition:o,center:{x:s,y:c},offset:l});return[u.reduce((m,v,b)=>{let w="";return b>0&&b<u.length-1?w=rie(u[b-1],v,u[b+1],i):w=`${b===0?"M":"L"}${v.x} ${v.y}`,m+=w,m},""),d,p,f,y]}function B3(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function aie(e){var d;const{sourceNode:t,targetNode:n}=e;if(!B3(t)||!B3(n))return null;const r=t.internals.handleBounds||z3(t.handles),a=n.internals.handleBounds||z3(n.handles),o=V3((r==null?void 0:r.source)??[],e.sourceHandle),i=V3(e.connectionMode===ac.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),e.targetHandle);if(!o||!i)return(d=e.onError)==null||d.call(e,"008",yo.error008(o?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=(o==null?void 0:o.position)||fe.Bottom,c=(i==null?void 0:i.position)||fe.Top,l=Qu(t,o,s),u=Qu(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:s,targetPosition:c}}function z3(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Qu(e,t,n=fe.Left,r=!1){const a=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,o=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:s}=t??go(e);if(r)return{x:a+i/2,y:o+s/2};switch((t==null?void 0:t.position)??n){case fe.Top:return{x:a+i/2,y:o};case fe.Right:return{x:a+i,y:o+s/2};case fe.Bottom:return{x:a+i/2,y:o+s};case fe.Left:return{x:a,y:o+s/2}}}function V3(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function _1(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function oie(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:a}){const o=new Set;return e.reduce((i,s)=>([s.markerStart||r,s.markerEnd||a].forEach(c=>{if(c&&typeof c=="object"){const l=_1(c,t);o.has(l)||(i.push({id:l,color:c.color||n,...c}),o.add(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))}const j1={nodeOrigin:[0,0],nodeExtent:Wu,elevateNodesOnSelect:!0,defaults:{}},iie={...j1,checkEquality:!0};function S1(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function sie(e,t,n){const r=S1(j1,n);for(const a of e.values())if(a.parentId)O1(a,e,t,r);else{const o=qu(a,r.nodeOrigin),i=sc(a.extent)?a.extent:r.nodeExtent,s=qi(o,i,go(a));a.internals.positionAbsolute=s}}function E1(e,t,n,r){var s,c;const a=S1(iie,r),o=new Map(t),i=a!=null&&a.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let u=o.get(l.id);if(a.checkEquality&&l===(u==null?void 0:u.internals.userNode))t.set(l.id,u);else{const d=qu(l,a.nodeOrigin),p=sc(l.extent)?l.extent:a.nodeExtent,f=qi(d,p,go(l));u={...a.defaults,...l,measured:{width:(s=l.measured)==null?void 0:s.width,height:(c=l.measured)==null?void 0:c.height},internals:{positionAbsolute:f,handleBounds:l.measured?u==null?void 0:u.internals.handleBounds:void 0,z:W3(l,i),userNode:l}},t.set(l.id,u)}l.parentId&&O1(u,t,n,r)}}function cie(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function O1(e,t,n,r){const{elevateNodesOnSelect:a,nodeOrigin:o,nodeExtent:i}=S1(j1,r),s=e.parentId,c=t.get(s);if(!c){console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}cie(e,n);const l=a?1e3:0,{x:u,y:d,z:p}=lie(e,c,o,i,l),{positionAbsolute:f}=e.internals,y=u!==f.x||d!==f.y;(y||p!==e.internals.z)&&(e.internals={...e.internals,positionAbsolute:y?{x:u,y:d}:f,z:p})}function W3(e,t){return(Hr(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function lie(e,t,n,r,a){const{x:o,y:i}=t.internals.positionAbsolute,s=go(e),c=qu(e,n),l=sc(e.extent)?qi(c,e.extent,s):c;let u=qi({x:o+l.x,y:i+l.y},r,s);e.extent==="parent"&&(u=x3(u,s,t));const d=W3(e,a),p=t.internals.z??0;return{x:u.x,y:u.y,z:p>d?p:d}}function C1(e,t,n,r=[0,0]){var i;const a=[],o=new Map;for(const s of e){const c=t.get(s.parentId);if(!c)continue;const l=((i=o.get(s.parentId))==null?void 0:i.expandedRect)??ic(c),u=S3(l,s.rect);o.set(s.parentId,{expandedRect:u,parent:c})}return o.size>0&&o.forEach(({expandedRect:s,parent:c},l)=>{var _;const u=c.internals.positionAbsolute,d=go(c),p=c.origin??r,f=s.x<u.x?Math.round(Math.abs(u.x-s.x)):0,y=s.y<u.y?Math.round(Math.abs(u.y-s.y)):0,m=Math.max(d.width,Math.round(s.width)),v=Math.max(d.height,Math.round(s.height)),b=(m-d.width)*p[0],w=(v-d.height)*p[1];(f>0||y>0||b||w)&&(a.push({id:l,type:"position",position:{x:c.position.x-f+b,y:c.position.y-y+w}}),(_=n.get(l))==null||_.forEach(x=>{e.some(j=>j.id===x.id)||a.push({id:x.id,type:"position",position:{x:x.position.x+f,y:x.position.y+y}})})),(d.width<s.width||d.height<s.height||f||y)&&a.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:m+(f?p[0]*f-b:0),height:v+(y?p[1]*y-w:0)}})}),a}function uie(e,t,n,r,a,o){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let s=!1;if(!i)return{changes:[],updatedInternals:s};const c=[],l=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const p of e.values()){const f=t.get(p.id);if(f)if(f.hidden)f.internals={...f.internals,handleBounds:void 0},s=!0;else{const y=Ch(p.nodeElement),m=f.measured.width!==y.width||f.measured.height!==y.height;if(y.width&&y.height&&(m||!f.internals.handleBounds||p.force)){const v=p.nodeElement.getBoundingClientRect(),b=sc(f.extent)?f.extent:o;let{positionAbsolute:w}=f.internals;f.parentId&&f.extent==="parent"?w=x3(w,y,t.get(f.parentId)):b&&(w=qi(w,b,y)),f.measured=y,f.internals={...f.internals,positionAbsolute:w,handleBounds:{source:k3("source",p.nodeElement,v,u,f.id),target:k3("target",p.nodeElement,v,u,f.id)}},f.parentId&&O1(f,t,n,{nodeOrigin:a}),s=!0,m&&(c.push({id:f.id,type:"dimensions",dimensions:y}),f.expandParent&&f.parentId&&d.push({id:f.id,parentId:f.parentId,rect:ic(f,a)}))}}}if(d.length>0){const p=C1(d,t,n,a);c.push(...p)}return{changes:c,updatedInternals:s}}async function die({delta:e,panZoom:t,transform:n,translateExtent:r,width:a,height:o}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[a,o]],r),s=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(s)}function U3(e,t,n){e.clear(),t.clear();for(const r of n){const{source:a,target:o,sourceHandle:i=null,targetHandle:s=null}=r,c=`${a}-source-${i}`,l=`${o}-target-${s}`,u=e.get(c)||new Map,d=e.get(l)||new Map,p={edgeId:r.id,source:a,target:o,sourceHandle:i,targetHandle:s};t.set(r.id,r),e.set(c,u.set(`${o}-${s}`,p)),e.set(l,d.set(`${a}-${i}`,p))}}function q3(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:q3(n,t):!1}function H3(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n)return!1;r=r.parentElement}while(r);return!1}function pie(e,t,n,r){const a=new Map;for(const[o,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!q3(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const s=e.get(o);s&&a.set(o,{id:o,position:s.position||{x:0,y:0},distance:{x:n.x-s.internals.positionAbsolute.x,y:n.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return a}function N1({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,s,c;const a=[];for(const[l,u]of t){const d=(i=n.get(l))==null?void 0:i.internals.userNode;d&&a.push({...d,position:u.position,dragging:r})}if(!e)return[a[0],a];const o=(s=n.get(e))==null?void 0:s.internals.userNode;return[o?{...o,position:((c=t.get(e))==null?void 0:c.position)||o.position,dragging:r}:a[0],a]}function fie({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:a}){let o={x:null,y:null},i=0,s=new Map,c=!1,l={x:0,y:0},u=null,d=!1,p=null,f=!1;function y({noDragClassName:v,handleSelector:b,domNode:w,isSelectable:_,nodeId:x,nodeClickDistance:j=0}){p=cr(w);function S({x:M,y:P},I){const{nodeLookup:k,nodeExtent:C,snapGrid:T,snapToGrid:A,nodeOrigin:R,onNodeDrag:L,onSelectionDrag:D,onError:B,updateNodePositions:F}=t();o={x:M,y:P};let $=!1,V={x:0,y:0,x2:0,y2:0};if(s.size>1&&C){const Q=Hu(s);V=v1(Q)}for(const[Q,X]of s){if(!k.has(Q))continue;let H={x:M-X.distance.x,y:P-X.distance.y};A&&(H=Eh(H,T));let J=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(s.size>1&&C&&!X.extent){const{positionAbsolute:G}=X.internals,ne=G.x-V.x+C[0][0],z=G.x+X.measured.width-V.x2+C[1][0],se=G.y-V.y+C[0][1],re=G.y+X.measured.height-V.y2+C[1][1];J=[[ne,se],[z,re]]}const{position:K,positionAbsolute:q}=w3({nodeId:Q,nextPosition:H,nodeLookup:k,nodeExtent:J,nodeOrigin:R,onError:B});$=$||X.position.x!==K.x||X.position.y!==K.y,X.position=K,X.internals.positionAbsolute=q}if($&&(F(s,!0),I&&(r||L||!x&&D))){const[Q,X]=N1({nodeId:x,dragItems:s,nodeLookup:k});r==null||r(I,s,Q,X),L==null||L(I,Q,X),x||(D==null||D(I,X))}}async function E(){if(!u)return;const{transform:M,panBy:P,autoPanSpeed:I}=t(),[k,C]=j3(l,u,I);(k!==0||C!==0)&&(o.x=(o.x??0)-k/M[2],o.y=(o.y??0)-C/M[2],await P({x:k,y:C})&&S(o,null)),i=requestAnimationFrame(E)}function O(M){var $;const{nodeLookup:P,multiSelectionActive:I,nodesDraggable:k,transform:C,snapGrid:T,snapToGrid:A,selectNodesOnDrag:R,onNodeDragStart:L,onSelectionDragStart:D,unselectNodesAndEdges:B}=t();d=!0,(!R||!_)&&!I&&x&&(($=P.get(x))!=null&&$.selected||B()),_&&R&&x&&(e==null||e(x));const F=Xu(M.sourceEvent,{transform:C,snapGrid:T,snapToGrid:A,containerBounds:u});if(o=F,s=pie(P,k,F,x),s.size>0&&(n||L||!x&&D)){const[V,Q]=N1({nodeId:x,dragItems:s,nodeLookup:P});n==null||n(M.sourceEvent,s,V,Q),L==null||L(M.sourceEvent,V,Q),x||(D==null||D(M.sourceEvent,Q))}}const N=RD().clickDistance(j).on("start",M=>{const{domNode:P,nodeDragThreshold:I,transform:k,snapGrid:C,snapToGrid:T}=t();u=(P==null?void 0:P.getBoundingClientRect())||null,f=!1,I===0&&O(M),o=Xu(M.sourceEvent,{transform:k,snapGrid:C,snapToGrid:T,containerBounds:u}),l=vo(M.sourceEvent,u)}).on("drag",M=>{const{autoPanOnNodeDrag:P,transform:I,snapGrid:k,snapToGrid:C,nodeDragThreshold:T,nodeLookup:A}=t(),R=Xu(M.sourceEvent,{transform:I,snapGrid:k,snapToGrid:C,containerBounds:u});if((M.sourceEvent.type==="touchmove"&&M.sourceEvent.touches.length>1||x&&!A.has(x))&&(f=!0),!f){if(!c&&P&&d&&(c=!0,E()),!d){const L=R.xSnapped-(o.x??0),D=R.ySnapped-(o.y??0);Math.sqrt(L*L+D*D)>T&&O(M)}(o.x!==R.xSnapped||o.y!==R.ySnapped)&&s&&d&&(l=vo(M.sourceEvent,u),S(R,M.sourceEvent))}}).on("end",M=>{if(!(!d||f)&&(c=!1,d=!1,cancelAnimationFrame(i),s.size>0)){const{nodeLookup:P,updateNodePositions:I,onNodeDragStop:k,onSelectionDragStop:C}=t();if(I(s,!1),a||k||!x&&C){const[T,A]=N1({nodeId:x,dragItems:s,nodeLookup:P,dragging:!1});a==null||a(M.sourceEvent,s,T,A),k==null||k(M.sourceEvent,T,A),x||(C==null||C(M.sourceEvent,A))}}}).filter(M=>{const P=M.target;return!M.button&&(!v||!H3(P,`.${v}`,w))&&(!b||H3(P,b,w))});p.call(N)}function m(){p==null||p.on(".drag",null)}return{update:y,destroy:m}}function hie(e,t,n){const r=[],a={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const o of t.values())Ku(a,ic(o))>0&&r.push(o);return r}const mie=250;function yie(e,t,n,r){var s,c;let a=[],o=1/0;const i=hie(e,n,t+mie);for(const l of i){const u=[...((s=l.internals.handleBounds)==null?void 0:s.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:p,y:f}=Qu(l,d,d.position,!0),y=Math.sqrt(Math.pow(p-e.x,2)+Math.pow(f-e.y,2));y>t||(y<o?(a=[{...d,x:p,y:f}],o=y):y===o&&a.push({...d,x:p,y:f}))}}if(!a.length)return null;if(a.length>1){const l=r.type==="source"?"target":"source";return a.find(u=>u.type===l)??a[0]}return a[0]}function K3(e,t,n,r,a,o=!1){var l,u,d;const i=r.get(e);if(!i)return null;const s=a==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((d=i.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?s==null?void 0:s.find(p=>p.id===n):s==null?void 0:s[0])??null;return c&&o?{...c,...Qu(i,c,c.position,!0)}:c}function Z3(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function gie(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const X3=()=>!0;function vie(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:a,edgeUpdaterType:o,isTarget:i,domNode:s,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:p,cancelConnection:f,onConnectStart:y,onConnect:m,onConnectEnd:v,isValidConnection:b=X3,onReconnectEnd:w,updateConnection:_,getTransform:x,getFromHandle:j,autoPanSpeed:S}){const E=M3(e.target);let O=0,N;const{x:M,y:P}=vo(e),I=E==null?void 0:E.elementFromPoint(M,P),k=Z3(o,I),C=s==null?void 0:s.getBoundingClientRect();if(!C||!k)return;const T=K3(a,k,r,c,t);if(!T)return;let A=vo(e,C),R=!1,L=null,D=!1,B=null;function F(){if(!u||!C)return;const[K,q]=j3(A,C,S);p({x:K,y:q}),O=requestAnimationFrame(F)}const $={...T,nodeId:a,type:k,position:T.position},V=c.get(a),Q={inProgress:!0,isValid:null,from:Qu(V,$,fe.Left,!0),fromHandle:$,fromPosition:$.position,fromNode:V,to:A,toHandle:null,toPosition:m3[$.position],toNode:null};_(Q);let X=Q;y==null||y(e,{nodeId:a,handleId:r,handleType:k});function H(K){if(!j()||!$){J(K);return}const q=x();A=vo(K,C),N=yie(Zu(A,q,!1,[1,1]),n,c,$),R||(F(),R=!0);const G=Q3(K,{handle:N,connectionMode:t,fromNodeId:a,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:E,lib:l,flowId:d,nodeLookup:c});B=G.handleDomNode,L=G.connection,D=gie(!!N,G.isValid);const ne={...X,isValid:D,to:N&&D?O3({x:N.x,y:N.y},q):A,toHandle:G.toHandle,toPosition:D&&G.toHandle?G.toHandle.position:m3[$.position],toNode:G.toHandle?c.get(G.toHandle.nodeId):null};D&&N&&X.toHandle&&ne.toHandle&&X.toHandle.type===ne.toHandle.type&&X.toHandle.nodeId===ne.toHandle.nodeId&&X.toHandle.id===ne.toHandle.id&&X.to.x===ne.to.x&&X.to.y===ne.to.y||(_(ne),X=ne)}function J(K){(N||B)&&L&&D&&(m==null||m(L));const{inProgress:q,...G}=X,ne={...G,toPosition:X.toHandle?X.toPosition:null};v==null||v(K,ne),o&&(w==null||w(K,ne)),f(),cancelAnimationFrame(O),R=!1,D=!1,L=null,B=null,E.removeEventListener("mousemove",H),E.removeEventListener("mouseup",J),E.removeEventListener("touchmove",H),E.removeEventListener("touchend",J)}E.addEventListener("mousemove",H),E.addEventListener("mouseup",J),E.addEventListener("touchmove",H),E.addEventListener("touchend",J)}function Q3(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:a,fromType:o,doc:i,lib:s,flowId:c,isValidConnection:l=X3,nodeLookup:u}){const d=o==="target",p=t?i.querySelector(`.${s}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:f,y}=vo(e),m=i.elementFromPoint(f,y),v=m!=null&&m.classList.contains(`${s}-flow__handle`)?m:p,b={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=Z3(void 0,v),_=v.getAttribute("data-nodeid"),x=v.getAttribute("data-handleid"),j=v.classList.contains("connectable"),S=v.classList.contains("connectableend");if(!_||!w)return b;const E={source:d?_:r,sourceHandle:d?x:a,target:d?r:_,targetHandle:d?a:x};b.connection=E;const O=j&&S&&(n===ac.Strict?d&&w==="source"||!d&&w==="target":_!==r||x!==a);b.isValid=O&&l(E),b.toHandle=K3(_,w,x,u,n,!1)}return b}const M1={onPointerDown:vie,isValid:Q3};function bie({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const a=cr(e);function o({translateExtent:s,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:p=!0,inversePan:f=!1}){const y=_=>{const x=n();if(_.sourceEvent.type!=="wheel"||!t)return;const j=-_.sourceEvent.deltaY*(_.sourceEvent.deltaMode===1?.05:_.sourceEvent.deltaMode?1:.002)*u,S=x[2]*Math.pow(2,j);t.scaleTo(S)};let m=[0,0];const v=_=>{(_.sourceEvent.type==="mousedown"||_.sourceEvent.type==="touchstart")&&(m=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY])},b=_=>{const x=n();if(_.sourceEvent.type!=="mousemove"&&_.sourceEvent.type!=="touchmove"||!t)return;const j=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY],S=[j[0]-m[0],j[1]-m[1]];m=j;const E=r()*Math.max(x[2],Math.log(x[2]))*(f?-1:1),O={x:x[0]-S[0]*E,y:x[1]-S[1]*E},N=[[0,0],[c,l]];t.setViewportConstrained({x:O.x,y:O.y,zoom:x[2]},N,s)},w=p3().on("start",v).on("zoom",d?b:null).on("zoom.wheel",p?y:null);a.call(w,{})}function i(){a.on("zoom",null)}return{update:o,destroy:i,pointer:Vr}}const wie=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Mh=e=>({x:e.x,y:e.y,zoom:e.k}),P1=({x:e,y:t,zoom:n})=>wh.translate(e,t).scale(n),cc=(e,t)=>e.target.closest(`.${t}`),G3=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),k1=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},J3=e=>{const t=e.ctrlKey&&Oh()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function xie({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:o,zoomOnPinch:i,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(cc(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&i){const v=Vr(u),b=J3(u),w=d*Math.pow(2,b);r.scaleTo(n,w,v,u);return}const p=u.deltaMode===1?20:1;let f=a===ti.Vertical?0:u.deltaX*p,y=a===ti.Horizontal?0:u.deltaY*p;!Oh()&&u.shiftKey&&a!==ti.Vertical&&(f=u.deltaY*p,y=0),r.translateBy(n,-(f/d)*o,-(y/d)*o,{internal:!0});const m=Mh(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s==null||s(u,m)),e.isPanScrolling&&(c==null||c(u,m),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,m),e.isPanScrolling=!1},150))}}function _ie({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,a){if(!t&&r.type==="wheel"&&!r.ctrlKey||cc(r,e))return null;r.preventDefault(),n.call(this,r,a)}}function jie({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var o,i,s;if((o=r.sourceEvent)!=null&&o.internal)return;const a=Mh(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=a,((s=r.sourceEvent)==null?void 0:s.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,a))}}function Sie({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:a}){return o=>{var i,s;e.usedRightMouseButton=!!(n&&G3(t,e.mouseButton??0)),(i=o.sourceEvent)!=null&&i.sync||r([o.transform.x,o.transform.y,o.transform.k]),a&&!((s=o.sourceEvent)!=null&&s.internal)&&(a==null||a(o.sourceEvent,Mh(o.transform)))}}function Eie({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:a,onPaneContextMenu:o}){return i=>{var s;if(!((s=i.sourceEvent)!=null&&s.internal)&&(e.isZoomingOrPanning=!1,o&&G3(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&o(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),a&&wie(e.prevViewport,i.transform))){const c=Mh(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a==null||a(i.sourceEvent,c)},n?150:0)}}}function Oie({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:a,zoomOnDoubleClick:o,userSelectionActive:i,noWheelClassName:s,noPanClassName:c,lib:l}){return u=>{var y;const d=e||t,p=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(cc(u,`${l}-flow__node`)||cc(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!a&&!o&&!n||i||cc(u,s)&&u.type==="wheel"||cc(u,c)&&(u.type!=="wheel"||a&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((y=u.touches)==null?void 0:y.length)>1)return u.preventDefault(),!1;if(!d&&!a&&!p&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const f=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&f}}function Cie({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:a,viewport:o,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),p=p3().clickDistance(!Hr(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(a),f=cr(e).call(p);_({x:o.x,y:o.y,zoom:oc(o.zoom,t,n)},[[0,0],[d.width,d.height]],a);const y=f.on("wheel.zoom"),m=f.on("dblclick.zoom");p.wheelDelta(J3);function v(I,k){return f?new Promise(C=>{p==null||p.transform(k1(f,k==null?void 0:k.duration,()=>C(!0)),I)}):Promise.resolve(!1)}function b({noWheelClassName:I,noPanClassName:k,onPaneContextMenu:C,userSelectionActive:T,panOnScroll:A,panOnDrag:R,panOnScrollMode:L,panOnScrollSpeed:D,preventScrolling:B,zoomOnPinch:F,zoomOnScroll:$,zoomOnDoubleClick:V,zoomActivationKeyPressed:Q,lib:X,onTransformChange:H}){T&&!u.isZoomingOrPanning&&w();const J=A&&!Q&&!T?xie({zoomPanValues:u,noWheelClassName:I,d3Selection:f,d3Zoom:p,panOnScrollMode:L,panOnScrollSpeed:D,zoomOnPinch:F,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:c}):_ie({noWheelClassName:I,preventScrolling:B,d3ZoomHandler:y});if(f.on("wheel.zoom",J,{passive:!1}),!T){const q=jie({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:s});p.on("start",q);const G=Sie({zoomPanValues:u,panOnDrag:R,onPaneContextMenu:!!C,onPanZoom:i,onTransformChange:H});p.on("zoom",G);const ne=Eie({zoomPanValues:u,panOnDrag:R,panOnScroll:A,onPaneContextMenu:C,onPanZoomEnd:c,onDraggingChange:l});p.on("end",ne)}const K=Oie({zoomActivationKeyPressed:Q,panOnDrag:R,zoomOnScroll:$,panOnScroll:A,zoomOnDoubleClick:V,zoomOnPinch:F,userSelectionActive:T,noPanClassName:k,noWheelClassName:I,lib:X});p.filter(K),V?f.on("dblclick.zoom",m):f.on("dblclick.zoom",null)}function w(){p.on("zoom",null)}async function _(I,k,C){const T=P1(I),A=p==null?void 0:p.constrain()(T,k,C);return A&&await v(A),new Promise(R=>R(A))}async function x(I,k){const C=P1(I);return await v(C,k),new Promise(T=>T(C))}function j(I){if(f){const k=P1(I),C=f.property("__zoom");(C.k!==I.zoom||C.x!==I.x||C.y!==I.y)&&(p==null||p.transform(f,k,null,{sync:!0}))}}function S(){const I=f?u3(f.node()):{x:0,y:0,k:1};return{x:I.x,y:I.y,zoom:I.k}}function E(I,k){return f?new Promise(C=>{p==null||p.scaleTo(k1(f,k==null?void 0:k.duration,()=>C(!0)),I)}):Promise.resolve(!1)}function O(I,k){return f?new Promise(C=>{p==null||p.scaleBy(k1(f,k==null?void 0:k.duration,()=>C(!0)),I)}):Promise.resolve(!1)}function N(I){p==null||p.scaleExtent(I)}function M(I){p==null||p.translateExtent(I)}function P(I){const k=!Hr(I)||I<0?0:I;p==null||p.clickDistance(k)}return{update:b,destroy:w,setViewport:x,setViewportConstrained:_,getViewport:S,scaleTo:E,scaleBy:O,setScaleExtent:N,setTranslateExtent:M,syncViewport:j,setClickDistance:P}}var lc;(function(e){e.Line="line",e.Handle="handle"})(lc||(lc={}));const Nie=["top-left","top-right","bottom-left","bottom-right"],Mie=["top","right","bottom","left"];function Pie({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:a,affectsY:o}){const i=e-t,s=n-r,c=[i>0?1:i<0?-1:0,s>0?1:s<0?-1:0];return i&&a&&(c[0]=c[0]*-1),s&&o&&(c[1]=c[1]*-1),c}function kie(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:a}}function ri(e,t){return Math.max(0,t-e)}function ai(e,t){return Math.max(0,e-t)}function Ph(e,t,n){return Math.max(0,t-e,e-n)}function Y3(e,t){return e?!t:t}function Aie(e,t,n,r,a,o,i,s){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,p=u&&d,{xSnapped:f,ySnapped:y}=n,{minWidth:m,maxWidth:v,minHeight:b,maxHeight:w}=r,{x:_,y:x,width:j,height:S,aspectRatio:E}=e;let O=Math.floor(u?f-e.pointerX:0),N=Math.floor(d?y-e.pointerY:0);const M=j+(c?-O:O),P=S+(l?-N:N),I=-o[0]*j,k=-o[1]*S;let C=Ph(M,m,v),T=Ph(P,b,w);if(i){let L=0,D=0;c&&O<0?L=ri(_+O+I,i[0][0]):!c&&O>0&&(L=ai(_+M+I,i[1][0])),l&&N<0?D=ri(x+N+k,i[0][1]):!l&&N>0&&(D=ai(x+P+k,i[1][1])),C=Math.max(C,L),T=Math.max(T,D)}if(s){let L=0,D=0;c&&O>0?L=ai(_+O,s[0][0]):!c&&O<0&&(L=ri(_+M,s[1][0])),l&&N>0?D=ai(x+N,s[0][1]):!l&&N<0&&(D=ri(x+P,s[1][1])),C=Math.max(C,L),T=Math.max(T,D)}if(a){if(u){const L=Ph(M/E,b,w)*E;if(C=Math.max(C,L),i){let D=0;!c&&!l||c&&!l&&p?D=ai(x+k+M/E,i[1][1])*E:D=ri(x+k+(c?O:-O)/E,i[0][1])*E,C=Math.max(C,D)}if(s){let D=0;!c&&!l||c&&!l&&p?D=ri(x+M/E,s[1][1])*E:D=ai(x+(c?O:-O)/E,s[0][1])*E,C=Math.max(C,D)}}if(d){const L=Ph(P*E,m,v)/E;if(T=Math.max(T,L),i){let D=0;!c&&!l||l&&!c&&p?D=ai(_+P*E+I,i[1][0])/E:D=ri(_+(l?N:-N)*E+I,i[0][0])/E,T=Math.max(T,D)}if(s){let D=0;!c&&!l||l&&!c&&p?D=ri(_+P*E,s[1][0])/E:D=ai(_+(l?N:-N)*E,s[0][0])/E,T=Math.max(T,D)}}}N=N+(N<0?T:-T),O=O+(O<0?C:-C),a&&(p?M>P*E?N=(Y3(c,l)?-O:O)/E:O=(Y3(c,l)?-N:N)*E:u?(N=O/E,l=c):(O=N*E,c=l));const A=c?_+O:_,R=l?x+N:x;return{width:j+(c?-O:O),height:S+(l?-N:N),x:o[0]*O*(c?-1:1)+A,y:o[1]*N*(l?-1:1)+R}}const e5={width:0,height:0,x:0,y:0},Tie={...e5,pointerX:0,pointerY:0,aspectRatio:1};function Iie(e){return[[0,0],[e.measured.width,e.measured.height]]}function Rie(e,t,n){const r=t.position.x+e.position.x,a=t.position.y+e.position.y,o=e.measured.width??0,i=e.measured.height??0,s=n[0]*o,c=n[1]*i;return[[r-s,a-c],[r+o-s,a+i-c]]}function Die({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:a}){const o=cr(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:u,onResizeStart:d,onResize:p,onResizeEnd:f,shouldResize:y}){let m={...e5},v={...Tie};const b=kie(c);let w,_=null,x=[],j,S,E;const O=RD().on("start",N=>{const{nodeLookup:M,transform:P,snapGrid:I,snapToGrid:k,nodeOrigin:C,paneDomNode:T}=n();if(w=M.get(t),!w)return;_=(T==null?void 0:T.getBoundingClientRect())??null;const{xSnapped:A,ySnapped:R}=Xu(N.sourceEvent,{transform:P,snapGrid:I,snapToGrid:k,containerBounds:_});m={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},v={...m,pointerX:A,pointerY:R,aspectRatio:m.width/m.height},j=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(j=M.get(w.parentId),S=j&&w.extent==="parent"?Iie(j):void 0),x=[],E=void 0;for(const[L,D]of M)if(D.parentId===t&&(x.push({id:L,position:{...D.position},extent:D.extent}),D.extent==="parent"||D.expandParent)){const B=Rie(D,w,D.origin??C);E?E=[[Math.min(B[0][0],E[0][0]),Math.min(B[0][1],E[0][1])],[Math.max(B[1][0],E[1][0]),Math.max(B[1][1],E[1][1])]]:E=B}d==null||d(N,{...m})}).on("drag",N=>{const{transform:M,snapGrid:P,snapToGrid:I,nodeOrigin:k}=n(),C=Xu(N.sourceEvent,{transform:M,snapGrid:P,snapToGrid:I,containerBounds:_}),T=[];if(!w)return;const{x:A,y:R,width:L,height:D}=m,B={},F=w.origin??k,{width:$,height:V,x:Q,y:X}=Aie(v,b,C,l,u,F,S,E),H=$!==L,J=V!==D,K=Q!==A&&H,q=X!==R&&J;if(!K&&!q&&!H&&!J)return;if((K||q||F[0]===1||F[1]===1)&&(B.x=K?Q:m.x,B.y=q?X:m.y,m.x=B.x,m.y=B.y,x.length>0)){const z=Q-A,se=X-R;for(const re of x)re.position={x:re.position.x-z+F[0]*($-L),y:re.position.y-se+F[1]*(V-D)},T.push(re)}if((H||J)&&(B.width=H?$:m.width,B.height=J?V:m.height,m.width=B.width,m.height=B.height),j&&w.expandParent){const z=F[0]*(B.width??0);B.x&&B.x<z&&(m.x=z,v.x=v.x-(B.x-z));const se=F[1]*(B.height??0);B.y&&B.y<se&&(m.y=se,v.y=v.y-(B.y-se))}const G=Pie({width:m.width,prevWidth:L,height:m.height,prevHeight:D,affectsX:b.affectsX,affectsY:b.affectsY}),ne={...m,direction:G};(y==null?void 0:y(N,ne))!==!1&&(p==null||p(N,ne),r(B,T))}).on("end",N=>{f==null||f(N,{...m}),a==null||a()});o.call(O)}function s(){o.on(".drag",null)}return{update:i,destroy:s}}var t5={exports:{}},A1={},n5;function Lie(){if(n5)return A1;n5=1;var e=cK(),t=gT();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:n,a=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return A1.useSyncExternalStoreWithSelector=function(l,u,d,p,f){var y=o(null);if(y.current===null){var m={hasValue:!1,value:null};y.current=m}else m=y.current;y=s(function(){function b(S){if(!w){if(w=!0,_=S,S=p(S),f!==void 0&&m.hasValue){var E=m.value;if(f(E,S))return x=E}return x=S}if(E=x,r(_,S))return E;var O=p(S);return f!==void 0&&f(E,O)?E:(_=S,x=O)}var w=!1,_,x,j=d===void 0?null:d;return[function(){return b(u())},j===null?void 0:function(){return b(j())}]},[u,d,p,f]);var v=a(l,y[0],y[1]);return i(function(){m.hasValue=!0,m.value=v},[v]),c(v),v},A1}var r5;function $ie(){return r5||(r5=1,t5.exports=Lie()),t5.exports}var Fie=$ie();let a5,T1,o5,i5,s5,c5;RN=ot(Fie),a5={BASE_URL:"/NoLLMChat/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_URL:"/NoLLMChat/",VITE_ROUTE_MODE:"hash"},T1=e=>{let t;const n=new Set,r=(s,c)=>{const l=typeof s=="function"?s(t):s;if(!Object.is(l,t)){const u=t;t=c??(typeof l!="object"||l===null)?l:Object.assign({},t,l),n.forEach(d=>d(t,u))}},a=()=>t,o={setState:r,getState:a,getInitialState:()=>i,subscribe:s=>(n.add(s),()=>n.delete(s)),destroy:()=>{(a5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},i=t=e(r,a,o);return o},o5=e=>e?T1(e):T1,{useDebugValue:i5}=U,{useSyncExternalStoreWithSelector:s5}=RN,c5=e=>e;function l5(e,t=c5,n){const r=s5(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return i5(r),r}const u5=(e,t)=>{const n=o5(e),r=(a,o=t)=>l5(n,a,o);return Object.assign(r,n),r},Bie=(e,t)=>e?u5(e,t):u5;function $t(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const kh=g.createContext(null),zie=kh.Provider,d5=yo.error001();function Ge(e,t){const n=g.useContext(kh);if(n===null)throw new Error(d5);return l5(n,e,t)}function Tt(){const e=g.useContext(kh);if(e===null)throw new Error(d5);return g.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const p5={display:"none"},Vie={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},f5="react-flow__node-desc",h5="react-flow__edge-desc",Wie="react-flow__aria-live",Uie=e=>e.ariaLiveMessage;function qie({rfId:e}){const t=Ge(Uie);return h.jsx("div",{id:`${Wie}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Vie,children:t})}function Hie({rfId:e,disableKeyboardA11y:t}){return h.jsxs(h.Fragment,{children:[h.jsxs("div",{id:`${f5}-${e}`,style:p5,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),h.jsx("div",{id:`${h5}-${e}`,style:p5,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&h.jsx(qie,{rfId:e})]})}const Kie=e=>e.userSelectionActive?"none":"all";function uc({position:e="top-left",children:t,className:n,style:r,...a}){const o=Ge(Kie),i=`${e}`.split("-");return h.jsx("div",{className:Gt(["react-flow__panel",n,...i]),style:{...r,pointerEvents:o},...a,children:t})}function Zie({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:h.jsx(uc,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:h.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Xie=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Ah=e=>e.id;function Qie(e,t){return $t(e.selectedNodes.map(Ah),t.selectedNodes.map(Ah))&&$t(e.selectedEdges.map(Ah),t.selectedEdges.map(Ah))}function Gie({onSelectionChange:e}){const t=Tt(),{selectedNodes:n,selectedEdges:r}=Ge(Xie,Qie);return g.useEffect(()=>{const a={nodes:n,edges:r};e==null||e(a),t.getState().onSelectionChangeHandlers.forEach(o=>o(a))},[n,r,e]),null}const Jie=e=>!!e.onSelectionChangeHandlers;function Yie({onSelectionChange:e}){const t=Ge(Jie);return e||t?h.jsx(Gie,{onSelectionChange:e}):null}const m5=[0,0],ese={x:0,y:0,zoom:1},tse=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],y5=[...tse,"rfId"],nse=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),g5={translateExtent:Wu,nodeOrigin:m5,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function rse(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:a,setTranslateExtent:o,setNodeExtent:i,reset:s,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=Ge(nse,$t),u=Tt();g.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=g5,s()}),[]);const d=g.useRef(g5);return g.useEffect(()=>{for(const p of y5){const f=e[p],y=d.current[p];f!==y&&(typeof e[p]>"u"||(p==="nodes"?t(f):p==="edges"?n(f):p==="minZoom"?r(f):p==="maxZoom"?a(f):p==="translateExtent"?o(f):p==="nodeExtent"?i(f):p==="paneClickDistance"?l(f):p==="fitView"?u.setState({fitViewOnInit:f}):p==="fitViewOptions"?u.setState({fitViewOnInitOptions:f}):u.setState({[p]:f})))}d.current=e},y5.map(p=>e[p])),null}function v5(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function ase(e){var r;const[t,n]=g.useState(e==="system"?null:e);return g.useEffect(()=>{if(e!=="system"){n(e);return}const a=v5(),o=()=>n(a!=null&&a.matches?"dark":"light");return o(),a==null||a.addEventListener("change",o),()=>{a==null||a.removeEventListener("change",o)}},[e]),t!==null?t:(r=v5())!=null&&r.matches?"dark":"light"}const b5=typeof document<"u"?document:null;function Gu(e=null,t={target:b5,actInsideInputWithModifier:!0}){const[n,r]=g.useState(!1),a=g.useRef(!1),o=g.useRef(new Set([])),[i,s]=g.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),l=c.reduce((u,d)=>u.concat(...d),[]);return[c,l]}return[[],[]]},[e]);return g.useEffect(()=>{const c=(t==null?void 0:t.target)||b5;if(e!==null){const l=p=>{if(a.current=p.ctrlKey||p.metaKey||p.shiftKey,(!a.current||a.current&&!t.actInsideInputWithModifier)&&w1(p))return!1;const f=x5(p.code,s);o.current.add(p[f]),w5(i,o.current,!1)&&(p.preventDefault(),r(!0))},u=p=>{if((!a.current||a.current&&!t.actInsideInputWithModifier)&&w1(p))return!1;const f=x5(p.code,s);w5(i,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(p[f]),p.key==="Meta"&&o.current.clear(),a.current=!1},d=()=>{o.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function w5(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(a=>t.has(a)))}function x5(e,t){return t.includes(e)?"code":"key"}const ose=()=>{const e=Tt();return g.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,a,o],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??a,zoom:t.zoom??o},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:a,panZoom:o,domNode:i}=e.getState();if(!o||!i)return Promise.resolve(!1);const s=y1(n,t),{width:c,height:l}=Ch(i);return g1({nodes:s,width:c,height:l,minZoom:r,maxZoom:a,panZoom:o},t)},setCenter:async(t,n,r)=>{const{width:a,height:o,maxZoom:i,panZoom:s}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,l=a/2-t*c,u=o/2-n*c;return s?(await s.setViewport({x:l,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:a,minZoom:o,maxZoom:i,panZoom:s}=e.getState(),c=b1(t,r,a,o,i,(n==null?void 0:n.padding)??.1);return s?(await s.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:r,snapGrid:a,domNode:o}=e.getState();if(!o)return t;const{x:i,y:s}=o.getBoundingClientRect(),c={x:t.x-i,y:t.y-s};return Zu(c,r,n.snapToGrid,a)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:a,y:o}=r.getBoundingClientRect(),i=O3(t,n);return{x:i.x+a,y:i.y+o}}}),[])};function _5(e,t){const n=[],r=new Map,a=[];for(const o of e)if(o.type==="add"){a.push(o);continue}else if(o.type==="remove"||o.type==="replace")r.set(o.id,[o]);else{const i=r.get(o.id);i?i.push(o):r.set(o.id,[o])}for(const o of t){const i=r.get(o.id);if(!i){n.push(o);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const s={...o};for(const c of i)ise(c,s);n.push(s)}return a.length&&a.forEach(o=>{o.index!==void 0?n.splice(o.index,0,{...o.item}):n.push({...o.item})}),n}function ise(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Hi(e,t){return _5(e,t)}function Ju(e,t){return _5(e,t)}function Ki(e,t){return{id:e,type:"select",selected:t}}function dc(e,t=new Set,n=!1){const r=[];for(const[a,o]of e){const i=t.has(a);!(o.selected===void 0&&!i)&&o.selected!==i&&(n&&(o.selected=i),r.push(Ki(o.id,i)))}return r}function j5({items:e=[],lookup:t}){var a;const n=[],r=new Map(e.map(o=>[o.id,o]));for(const[o,i]of e.entries()){const s=t.get(i.id),c=((a=s==null?void 0:s.internals)==null?void 0:a.userNode)??s;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:o})}for(const[o]of t)r.get(o)===void 0&&n.push({id:o,type:"remove"});return n}function S5(e){return{id:e.id,type:"remove"}}const E5=e=>qoe(e),sse=e=>v3(e);function O5(e){return g.forwardRef(e)}const cse=typeof window<"u"?g.useLayoutEffect:g.useEffect;function C5(e){const[t,n]=g.useState(BigInt(0)),[r]=g.useState(()=>lse(()=>n(a=>a+BigInt(1))));return cse(()=>{const a=r.get();a.length&&(e(a),r.reset())},[t]),r}function lse(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const N5=g.createContext(null);function use({children:e}){const t=Tt(),n=g.useCallback(s=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:p}=t.getState();let f=c;for(const y of s)f=typeof y=="function"?y(f):y;u?l(f):d&&d(j5({items:f,lookup:p}))},[]),r=C5(n),a=g.useCallback(s=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:p}=t.getState();let f=c;for(const y of s)f=typeof y=="function"?y(f):y;u?l(f):d&&d(j5({items:f,lookup:p}))},[]),o=C5(a),i=g.useMemo(()=>({nodeQueue:r,edgeQueue:o}),[]);return h.jsx(N5.Provider,{value:i,children:e})}function dse(){const e=g.useContext(N5);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const pse=e=>!!e.panZoom;function lr(){const e=ose(),t=Tt(),n=dse(),r=Ge(pse),a=g.useMemo(()=>{const o=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},s=d=>{n.edgeQueue.push(d)},c=d=>{var b,w;const{nodeLookup:p,nodeOrigin:f}=t.getState(),y=E5(d)?d:p.get(d.id),m=y.parentId?N3(y.position,y.measured,y.parentId,p,f):y.position,v={id:y.id,position:m,width:((b=y.measured)==null?void 0:b.width)??y.width,height:((w=y.measured)==null?void 0:w.height)??y.height,data:y.data};return ic(v)},l=(d,p,f={replace:!1})=>{i(y=>y.map(m=>{if(m.id===d){const v=typeof p=="function"?p(m):p;return f.replace&&E5(v)?v:{...m,...v}}return m}))},u=(d,p,f={replace:!1})=>{s(y=>y.map(m=>{if(m.id===d){const v=typeof p=="function"?p(m):p;return f.replace&&sse(v)?v:{...m,...v}}return m}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var p;return(p=o(d))==null?void 0:p.internals.userNode},getInternalNode:o,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(p=>({...p}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:s,addNodes:d=>{const p=Array.isArray(d)?d:[d];n.nodeQueue.push(f=>[...f,...p])},addEdges:d=>{const p=Array.isArray(d)?d:[d];n.edgeQueue.push(f=>[...f,...p])},toObject:()=>{const{nodes:d=[],edges:p=[],transform:f}=t.getState(),[y,m,v]=f;return{nodes:d.map(b=>({...b})),edges:p.map(b=>({...b})),viewport:{x:y,y:m,zoom:v}}},deleteElements:async({nodes:d=[],edges:p=[]})=>{const{nodes:f,edges:y,onNodesDelete:m,onEdgesDelete:v,triggerNodeChanges:b,triggerEdgeChanges:w,onDelete:_,onBeforeDelete:x}=t.getState(),{nodes:j,edges:S}=await Zoe({nodesToRemove:d,edgesToRemove:p,nodes:f,edges:y,onBeforeDelete:x}),E=S.length>0,O=j.length>0;if(E){const N=S.map(S5);v==null||v(S),w(N)}if(O){const N=j.map(S5);m==null||m(j),b(N)}return(O||E)&&(_==null||_({nodes:j,edges:S})),{deletedNodes:j,deletedEdges:S}},getIntersectingNodes:(d,p=!0,f)=>{const y=E3(d),m=y?d:c(d),v=f!==void 0;return m?(f||t.getState().nodes).filter(b=>{const w=t.getState().nodeLookup.get(b.id);if(w&&!y&&(b.id===d.id||!w.internals.positionAbsolute))return!1;const _=ic(v?b:w),x=Ku(_,m);return p&&x>0||x>=m.width*m.height}):[]},isNodeIntersecting:(d,p,f=!0)=>{const y=E3(d)?d:c(d);if(!y)return!1;const m=Ku(y,p);return f&&m>0||m>=y.width*y.height},updateNode:l,updateNodeData:(d,p,f={replace:!1})=>{l(d,y=>{const m=typeof p=="function"?p(y):p;return f.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},f)},updateEdge:u,updateEdgeData:(d,p,f={replace:!1})=>{u(d,y=>{const m=typeof p=="function"?p(y):p;return f.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},f)},getNodesBounds:d=>{const{nodeLookup:p,nodeOrigin:f}=t.getState();return Hoe(d,{nodeLookup:p,nodeOrigin:f})},getHandleConnections:({type:d,id:p,nodeId:f})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${f}-${d}-${p??null}`))==null?void 0:y.values())??[])}}},[]);return g.useMemo(()=>({...a,...e,viewportInitialized:r}),[r])}const M5=e=>e.selected,fse={actInsideInputWithModifier:!1},hse=typeof window<"u"?window:void 0;function mse({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=Tt(),{deleteElements:r}=lr(),a=Gu(e,fse),o=Gu(t,{target:hse});g.useEffect(()=>{if(a){const{edges:i,nodes:s}=n.getState();r({nodes:s.filter(M5),edges:i.filter(M5)}),n.setState({nodesSelectionActive:!1})}},[a]),g.useEffect(()=>{n.setState({multiSelectionActive:o})},[o])}function yse(e){const t=Tt();g.useEffect(()=>{const n=()=>{var a,o;if(!e.current)return!1;const r=Ch(e.current);(r.height===0||r.width===0)&&((o=(a=t.getState()).onError)==null||o.call(a,"004",yo.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const Th={position:"absolute",width:"100%",height:"100%",top:0,left:0},gse=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function vse({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:a=.5,panOnScrollMode:o=ti.Free,zoomOnDoubleClick:i=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:p,preventScrolling:f=!0,children:y,noWheelClassName:m,noPanClassName:v,onViewportChange:b,isControlledViewport:w,paneClickDistance:_}){const x=Tt(),j=g.useRef(null),{userSelectionActive:S,lib:E}=Ge(gse,$t),O=Gu(p),N=g.useRef();yse(j);const M=g.useCallback(P=>{b==null||b({x:P[0],y:P[1],zoom:P[2]}),w||x.setState({transform:P})},[b,w]);return g.useEffect(()=>{if(j.current){N.current=Cie({domNode:j.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:_,onDraggingChange:C=>x.setState({paneDragging:C}),onPanZoomStart:(C,T)=>{const{onViewportChangeStart:A,onMoveStart:R}=x.getState();R==null||R(C,T),A==null||A(T)},onPanZoom:(C,T)=>{const{onViewportChange:A,onMove:R}=x.getState();R==null||R(C,T),A==null||A(T)},onPanZoomEnd:(C,T)=>{const{onViewportChangeEnd:A,onMoveEnd:R}=x.getState();R==null||R(C,T),A==null||A(T)}});const{x:P,y:I,zoom:k}=N.current.getViewport();return x.setState({panZoom:N.current,transform:[P,I,k],domNode:j.current.closest(".react-flow")}),()=>{var C;(C=N.current)==null||C.destroy()}}},[]),g.useEffect(()=>{var P;(P=N.current)==null||P.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:a,panOnScrollMode:o,zoomOnDoubleClick:i,panOnDrag:s,zoomActivationKeyPressed:O,preventScrolling:f,noPanClassName:v,userSelectionActive:S,noWheelClassName:m,lib:E,onTransformChange:M})},[e,t,n,r,a,o,i,s,O,f,v,S,m,E,M]),h.jsx("div",{className:"react-flow__renderer",ref:j,style:Th,children:y})}const bse=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function wse(){const{userSelectionActive:e,userSelectionRect:t}=Ge(bse,$t);return e&&t?h.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const I1=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},xse=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function _se({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Uu.Full,panOnDrag:r,selectionOnDrag:a,onSelectionStart:o,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:p,children:f}){const y=g.useRef(null),m=Tt(),v=g.useRef(0),b=g.useRef(0),w=g.useRef(),_=g.useRef(new Map),{userSelectionActive:x,elementsSelectable:j,dragging:S}=Ge(xse,$t),E=j&&(e||x),O=g.useRef(!1),N=g.useRef(!1),M=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,b.current=0},P=L=>{if(O.current){O.current=!1;return}s==null||s(L),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},I=L=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){L.preventDefault();return}c==null||c(L)},k=l?L=>l(L):void 0,C=L=>{var Q,X,H,J;const{resetSelectedElements:D,domNode:B,edgeLookup:F}=m.getState();if(w.current=B==null?void 0:B.getBoundingClientRect(),!j||!e||L.button!==0||L.target!==y.current||!w.current)return;(X=(Q=L.target)==null?void 0:Q.setPointerCapture)==null||X.call(Q,L.pointerId),N.current=!0,O.current=!1,_.current=new Map;for(const[K,q]of F)_.current.set(q.source,((H=_.current.get(q.source))==null?void 0:H.add(K))||new Set([K])),_.current.set(q.target,((J=_.current.get(q.target))==null?void 0:J.add(K))||new Set([K]));const{x:$,y:V}=vo(L.nativeEvent,w.current);D(),m.setState({userSelectionRect:{width:0,height:0,startX:$,startY:V,x:$,y:V}}),o==null||o(L)},T=L=>{const{userSelectionRect:D,edgeLookup:B,transform:F,nodeLookup:$,triggerNodeChanges:V,triggerEdgeChanges:Q}=m.getState();if(!w.current||!D)return;O.current=!0;const{x:X,y:H}=vo(L.nativeEvent,w.current),{startX:J,startY:K}=D,q={startX:J,startY:K,x:X<J?X:J,y:H<K?H:K,width:Math.abs(X-J),height:Math.abs(H-K)},G=b3($,q,F,n===Uu.Partial,!0),ne=new Set,z=new Set;for(const se of G){z.add(se.id);const re=_.current.get(se.id);if(re)for(const le of re)ne.add(le)}if(v.current!==z.size){v.current=z.size;const se=dc($,z,!0);V(se)}if(b.current!==ne.size){b.current=ne.size;const se=dc(B,ne);Q(se)}m.setState({userSelectionRect:q,userSelectionActive:!0,nodesSelectionActive:!1})},A=L=>{var B,F;if(L.button!==0||!N.current)return;(F=(B=L.target)==null?void 0:B.releasePointerCapture)==null||F.call(B,L.pointerId);const{userSelectionRect:D}=m.getState();!x&&D&&L.target===y.current&&(P==null||P(L)),v.current>0&&m.setState({nodesSelectionActive:!0}),M(),i==null||i(L),(t||a)&&(O.current=!1),N.current=!1},R=r===!0||Array.isArray(r)&&r.includes(0);return h.jsxs("div",{className:Gt(["react-flow__pane",{draggable:R,dragging:S,selection:e}]),onClick:E?void 0:I1(P,y),onContextMenu:I1(I,y),onWheel:I1(k,y),onPointerEnter:E?void 0:u,onPointerDown:E?C:d,onPointerMove:E?T:d,onPointerUp:E?A:void 0,onPointerLeave:p,ref:y,style:Th,children:[f,h.jsx(wse,{})]})}function R1({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:a,unselectNodesAndEdges:o,multiSelectionActive:i,nodeLookup:s,onError:c}=t.getState(),l=s.get(e);if(!l){c==null||c("012",yo.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(o({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):a([e])}function P5({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:a,isSelectable:o,nodeClickDistance:i}){const s=Tt(),[c,l]=g.useState(!1),u=g.useRef();return g.useEffect(()=>{u.current=fie({getStoreItems:()=>s.getState(),onNodeMouseDown:d=>{R1({id:d,store:s,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),g.useEffect(()=>{var d,p;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(p=u.current)==null||p.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:o,nodeId:a,nodeClickDistance:i}),()=>{var f;(f=u.current)==null||f.destroy()}},[n,r,t,o,e,a]),c}const jse=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function k5(){const e=Tt();return g.useCallback(t=>{const{nodeExtent:n,snapToGrid:r,snapGrid:a,nodesDraggable:o,onError:i,updateNodePositions:s,nodeLookup:c,nodeOrigin:l}=e.getState(),u=new Map,d=jse(o),p=r?a[0]:5,f=r?a[1]:5,y=t.direction.x*p*t.factor,m=t.direction.y*f*t.factor;for(const[,v]of c){if(!d(v))continue;let b={x:v.internals.positionAbsolute.x+y,y:v.internals.positionAbsolute.y+m};r&&(b=Eh(b,a));const{position:w,positionAbsolute:_}=w3({nodeId:v.id,nextPosition:b,nodeLookup:c,nodeExtent:n,nodeOrigin:l,onError:i});v.position=w,v.internals.positionAbsolute=_,u.set(v.id,v)}s(u)},[])}const D1=g.createContext(null),Sse=D1.Provider;D1.Consumer;const L1=()=>g.useContext(D1),Ese=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Ose=(e,t,n)=>r=>{const{connectionClickStartHandle:a,connectionMode:o,connection:i}=r,{fromHandle:s,toHandle:c,isValid:l}=i,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,connectingTo:u,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,isPossibleEndHandle:o===ac.Strict?(s==null?void 0:s.type)!==n:e!==(s==null?void 0:s.nodeId)||t!==(s==null?void 0:s.id),connectionInProcess:!!s,valid:u&&l}};function Cse({type:e="source",position:t=fe.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:a=!0,isConnectableEnd:o=!0,id:i,onConnect:s,children:c,className:l,onMouseDown:u,onTouchStart:d,...p},f){var C,T;const y=i||null,m=e==="target",v=Tt(),b=L1(),{connectOnClick:w,noPanClassName:_,rfId:x}=Ge(Ese,$t),{connectingFrom:j,connectingTo:S,clickConnecting:E,isPossibleEndHandle:O,connectionInProcess:N,valid:M}=Ge(Ose(b,y,e),$t);b||((T=(C=v.getState()).onError)==null||T.call(C,"010",yo.error010()));const P=A=>{const{defaultEdgeOptions:R,onConnect:L,hasDefaultEdges:D}=v.getState(),B={...R,...A};if(D){const{edges:F,setEdges:$}=v.getState();$(D3(B,F))}L==null||L(B),s==null||s(B)},I=A=>{if(!b)return;const R=P3(A.nativeEvent);if(a&&(R&&A.button===0||!R)){const L=v.getState();M1.onPointerDown(A.nativeEvent,{autoPanOnConnect:L.autoPanOnConnect,connectionMode:L.connectionMode,connectionRadius:L.connectionRadius,domNode:L.domNode,nodeLookup:L.nodeLookup,lib:L.lib,isTarget:m,handleId:y,nodeId:b,flowId:L.rfId,panBy:L.panBy,cancelConnection:L.cancelConnection,onConnectStart:L.onConnectStart,onConnectEnd:L.onConnectEnd,updateConnection:L.updateConnection,onConnect:P,isValidConnection:n||L.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:L.autoPanSpeed})}R?u==null||u(A):d==null||d(A)},k=A=>{const{onClickConnectStart:R,onClickConnectEnd:L,connectionClickStartHandle:D,connectionMode:B,isValidConnection:F,lib:$,rfId:V,nodeLookup:Q,connection:X}=v.getState();if(!b||!D&&!a)return;if(!D){R==null||R(A.nativeEvent,{nodeId:b,handleId:y,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:b,type:e,id:y}});return}const H=M3(A.target),J=n||F,{connection:K,isValid:q}=M1.isValid(A.nativeEvent,{handle:{nodeId:b,id:y,type:e},connectionMode:B,fromNodeId:D.nodeId,fromHandleId:D.id||null,fromType:D.type,isValidConnection:J,flowId:V,doc:H,lib:$,nodeLookup:Q});q&&K&&P(K);const G=structuredClone(X);delete G.inProgress,G.toPosition=G.toHandle?G.toHandle.position:null,L==null||L(A,G),v.setState({connectionClickStartHandle:null})};return h.jsx("div",{"data-handleid":y,"data-nodeid":b,"data-handlepos":t,"data-id":`${x}-${b}-${y}-${e}`,className:Gt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",_,l,{source:!m,target:m,connectable:r,connectablestart:a,connectableend:o,clickconnecting:E,connectingfrom:j,connectingto:S,valid:M,connectionindicator:r&&(!N||O)&&(N?o:a)}]),onMouseDown:I,onTouchStart:I,onClick:w?k:void 0,ref:f,...p,children:c})}const Yu=g.memo(O5(Cse));function Nse({data:e,isConnectable:t,sourcePosition:n=fe.Bottom}){return h.jsxs(h.Fragment,{children:[e==null?void 0:e.label,h.jsx(Yu,{type:"source",position:n,isConnectable:t})]})}function Mse({data:e,isConnectable:t,targetPosition:n=fe.Top,sourcePosition:r=fe.Bottom}){return h.jsxs(h.Fragment,{children:[h.jsx(Yu,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,h.jsx(Yu,{type:"source",position:r,isConnectable:t})]})}function Pse(){return null}function kse({data:e,isConnectable:t,targetPosition:n=fe.Top}){return h.jsxs(h.Fragment,{children:[h.jsx(Yu,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Ih={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},A5={input:Nse,default:Mse,output:kse,group:Pse};function Ase(e){var t,n,r,a;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((a=e.style)==null?void 0:a.height)}}const Tse=e=>{const{width:t,height:n,x:r,y:a}=Hu(e.nodeLookup,{filter:o=>!!o.selected});return{width:Hr(t)?t:null,height:Hr(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`}};function Ise({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Tt(),{width:a,height:o,transformString:i,userSelectionActive:s}=Ge(Tse,$t),c=k5(),l=g.useRef(null);if(g.useEffect(()=>{var p;n||((p=l.current)==null||p.focus({preventScroll:!0}))},[n]),P5({nodeRef:l}),s||!a||!o)return null;const u=e?p=>{const f=r.getState().nodes.filter(y=>y.selected);e(p,f)}:void 0,d=p=>{Object.prototype.hasOwnProperty.call(Ih,p.key)&&c({direction:Ih[p.key],factor:p.shiftKey?4:1})};return h.jsx("div",{className:Gt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:h.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:a,height:o}})})}const T5=typeof window<"u"?window:void 0,Rse=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function I5({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:p,onSelectionEnd:f,multiSelectionKeyCode:y,panActivationKeyCode:m,zoomActivationKeyCode:v,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:_,panOnScroll:x,panOnScrollSpeed:j,panOnScrollMode:S,zoomOnDoubleClick:E,panOnDrag:O,defaultViewport:N,translateExtent:M,minZoom:P,maxZoom:I,preventScrolling:k,onSelectionContextMenu:C,noWheelClassName:T,noPanClassName:A,disableKeyboardA11y:R,onViewportChange:L,isControlledViewport:D}){const{nodesSelectionActive:B,userSelectionActive:F}=Ge(Rse),$=Gu(l,{target:T5}),V=Gu(m,{target:T5}),Q=V||O,X=V||x,H=u&&Q!==!0,J=$||F||H;return mse({deleteKeyCode:c,multiSelectionKeyCode:y}),h.jsx(vse,{onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:_,panOnScroll:X,panOnScrollSpeed:j,panOnScrollMode:S,zoomOnDoubleClick:E,panOnDrag:!$&&Q,defaultViewport:N,translateExtent:M,minZoom:P,maxZoom:I,zoomActivationKeyCode:v,preventScrolling:k,noWheelClassName:T,noPanClassName:A,onViewportChange:L,isControlledViewport:D,paneClickDistance:s,children:h.jsxs(_se,{onSelectionStart:p,onSelectionEnd:f,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,panOnDrag:Q,isSelecting:!!J,selectionMode:d,selectionKeyPressed:$,selectionOnDrag:H,children:[e,B&&h.jsx(Ise,{onSelectionContextMenu:C,noPanClassName:A,disableKeyboardA11y:R})]})})}I5.displayName="FlowRenderer";const Dse=g.memo(I5),Lse=e=>t=>e?b3(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function $se(e){return Ge(g.useCallback(Lse(e),[e]),$t)}const Fse=e=>e.updateNodeInternals;function Bse(){const e=Ge(Fse),[t]=g.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(a=>{const o=a.target.getAttribute("data-id");r.set(o,{id:o,nodeElement:a.target,force:!0})}),e(r)}));return g.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function zse({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const a=Tt(),o=g.useRef(null),i=g.useRef(null),s=g.useRef(e.sourcePosition),c=g.useRef(e.targetPosition),l=g.useRef(t),u=n&&!!e.internals.handleBounds;return g.useEffect(()=>{o.current&&!e.hidden&&(!u||i.current!==o.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(o.current),i.current=o.current)},[u,e.hidden]),g.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),g.useEffect(()=>{if(o.current){const d=l.current!==t,p=s.current!==e.sourcePosition,f=c.current!==e.targetPosition;(d||p||f)&&(l.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:o.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),o}function Vse({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:a,onContextMenu:o,onDoubleClick:i,nodesDraggable:s,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:p,noPanClassName:f,disableKeyboardA11y:y,rfId:m,nodeTypes:v,nodeExtent:b,nodeClickDistance:w,onError:_}){const{node:x,internals:j,isParent:S}=Ge(K=>{const q=K.nodeLookup.get(e),G=K.parentLookup.has(e);return{node:q,internals:q.internals,isParent:G}},$t);let E=x.type||"default",O=(v==null?void 0:v[E])||A5[E];O===void 0&&(_==null||_("003",yo.error003(E)),E="default",O=A5.default);const N=!!(x.draggable||s&&typeof x.draggable>"u"),M=!!(x.selectable||c&&typeof x.selectable>"u"),P=!!(x.connectable||l&&typeof x.connectable>"u"),I=!!(x.focusable||u&&typeof x.focusable>"u"),k=Tt(),C=C3(x),T=zse({node:x,nodeType:E,hasDimensions:C,resizeObserver:d}),A=P5({nodeRef:T,disabled:x.hidden||!N,noDragClassName:p,handleSelector:x.dragHandle,nodeId:e,isSelectable:M,nodeClickDistance:w}),R=k5();if(x.hidden)return null;const L=go(x),D=Ase(x),B=M||N||t||n||r||a,F=n?K=>n(K,{...j.userNode}):void 0,$=r?K=>r(K,{...j.userNode}):void 0,V=a?K=>a(K,{...j.userNode}):void 0,Q=o?K=>o(K,{...j.userNode}):void 0,X=i?K=>i(K,{...j.userNode}):void 0,H=K=>{const{selectNodesOnDrag:q,nodeDragThreshold:G}=k.getState();M&&(!q||!N||G>0)&&R1({id:e,store:k,nodeRef:T}),t&&t(K,{...j.userNode})},J=K=>{if(!(w1(K.nativeEvent)||y))if(f3.includes(K.key)&&M){const q=K.key==="Escape";R1({id:e,store:k,unselect:q,nodeRef:T})}else N&&x.selected&&Object.prototype.hasOwnProperty.call(Ih,K.key)&&(k.setState({ariaLiveMessage:`Moved selected node ${K.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~j.positionAbsolute.x}, y: ${~~j.positionAbsolute.y}`}),R({direction:Ih[K.key],factor:K.shiftKey?4:1}))};return h.jsx("div",{className:Gt(["react-flow__node",`react-flow__node-${E}`,{[f]:N},x.className,{selected:x.selected,selectable:M,parent:S,draggable:N,dragging:A}]),ref:T,style:{zIndex:j.z,transform:`translate(${j.positionAbsolute.x}px,${j.positionAbsolute.y}px)`,pointerEvents:B?"all":"none",visibility:C?"visible":"hidden",...x.style,...D},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:F,onMouseMove:$,onMouseLeave:V,onContextMenu:Q,onClick:H,onDoubleClick:X,onKeyDown:I?J:void 0,tabIndex:I?0:void 0,role:I?"button":void 0,"aria-describedby":y?void 0:`${f5}-${m}`,"aria-label":x.ariaLabel,children:h.jsx(Sse,{value:e,children:h.jsx(O,{id:e,data:x.data,type:E,positionAbsoluteX:j.positionAbsolute.x,positionAbsoluteY:j.positionAbsolute.y,selected:x.selected,selectable:M,draggable:N,deletable:x.deletable??!0,isConnectable:P,sourcePosition:x.sourcePosition,targetPosition:x.targetPosition,dragging:A,dragHandle:x.dragHandle,zIndex:j.z,parentId:x.parentId,...L})})})}const Wse=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function R5(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,onError:o}=Ge(Wse,$t),i=$se(e.onlyRenderVisibleElements),s=Bse();return h.jsx("div",{className:"react-flow__nodes",style:Th,children:i.map(c=>h.jsx(Vse,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:o},c))})}R5.displayName="NodeRenderer";const Use=g.memo(R5);function qse(e){return Ge(g.useCallback(t=>{if(!e)return t.edges.map(r=>r.id);const n=[];if(t.width&&t.height)for(const r of t.edges){const a=t.nodeLookup.get(r.source),o=t.nodeLookup.get(r.target);a&&o&&Joe({sourceNode:a,targetNode:o,width:t.width,height:t.height,transform:t.transform})&&n.push(r.id)}return n},[e]),$t)}const Hse=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Kse=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),D5={[xh.Arrow]:Hse,[xh.ArrowClosed]:Kse};function Zse(e){const t=Tt();return g.useMemo(()=>{var n,r;return Object.prototype.hasOwnProperty.call(D5,e)?D5[e]:((r=(n=t.getState()).onError)==null||r.call(n,"009",yo.error009(e)),null)},[e])}const Xse=({id:e,type:t,color:n,width:r=12.5,height:a=12.5,markerUnits:o="strokeWidth",strokeWidth:i,orient:s="auto-start-reverse"})=>{const c=Zse(t);return c?h.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:h.jsx(c,{color:n,strokeWidth:i})}):null},L5=({defaultColor:e,rfId:t})=>{const n=Ge(o=>o.edges),r=Ge(o=>o.defaultEdgeOptions),a=g.useMemo(()=>oie(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return a.length?h.jsx("svg",{className:"react-flow__marker",children:h.jsx("defs",{children:a.map(o=>h.jsx(Xse,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})}):null};L5.displayName="MarkerDefinitions";var Qse=g.memo(L5);function $5({x:e,y:t,label:n,labelStyle:r={},labelShowBg:a=!0,labelBgStyle:o={},labelBgPadding:i=[2,4],labelBgBorderRadius:s=2,children:c,className:l,...u}){const[d,p]=g.useState({x:1,y:0,width:0,height:0}),f=Gt(["react-flow__edge-textwrapper",l]),y=g.useRef(null);return g.useEffect(()=>{if(y.current){const m=y.current.getBBox();p({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),typeof n>"u"||!n?null:h.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:f,visibility:d.width?"visible":"hidden",...u,children:[a&&h.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),h.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:y,style:r,children:n}),c]})}$5.displayName="EdgeText";const Gse=g.memo($5);function Rh({id:e,path:t,labelX:n,labelY:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:p,className:f,interactionWidth:y=20}){return h.jsxs(h.Fragment,{children:[h.jsx("path",{id:e,style:u,d:t,fill:"none",className:Gt(["react-flow__edge-path",f]),markerEnd:d,markerStart:p}),y&&h.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:y,className:"react-flow__edge-interaction"}),a&&Hr(n)&&Hr(r)?h.jsx(Gse,{x:n,y:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l}):null]})}function F5({pos:e,x1:t,y1:n,x2:r,y2:a}){return e===fe.Left||e===fe.Right?[.5*(t+r),n]:[t,.5*(n+a)]}function B5({sourceX:e,sourceY:t,sourcePosition:n=fe.Bottom,targetX:r,targetY:a,targetPosition:o=fe.Top}){const[i,s]=F5({pos:n,x1:e,y1:t,x2:r,y2:a}),[c,l]=F5({pos:o,x1:r,y1:a,x2:e,y2:t}),[u,d,p,f]=A3({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:i,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${s} ${c},${l} ${r},${a}`,u,d,p,f]}function z5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=fe.Bottom,targetPosition:s=fe.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:v,interactionWidth:b})=>{const[w,_,x]=B5({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s}),j=e.isInternal?void 0:t;return h.jsx(Rh,{id:j,path:w,labelX:_,labelY:x,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:v,interactionWidth:b})})}const Jse=z5({isInternal:!1}),V5=z5({isInternal:!0});Jse.displayName="SimpleBezierEdge",V5.displayName="SimpleBezierEdgeInternal";function W5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,sourcePosition:f=fe.Bottom,targetPosition:y=fe.Top,markerEnd:m,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[_,x,j]=x1({sourceX:n,sourceY:r,sourcePosition:f,targetX:a,targetY:o,targetPosition:y,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset}),S=e.isInternal?void 0:t;return h.jsx(Rh,{id:S,path:_,labelX:x,labelY:j,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:m,markerStart:v,interactionWidth:w})})}const U5=W5({isInternal:!1}),q5=W5({isInternal:!0});U5.displayName="SmoothStepEdge",q5.displayName="SmoothStepEdgeInternal";function H5(e){return g.memo(({id:t,...n})=>{var a;const r=e.isInternal?void 0:t;return h.jsx(U5,{...n,id:r,pathOptions:g.useMemo(()=>{var o;return{borderRadius:0,offset:(o=n.pathOptions)==null?void 0:o.offset}},[(a=n.pathOptions)==null?void 0:a.offset])})})}const Yse=H5({isInternal:!1}),K5=H5({isInternal:!0});Yse.displayName="StepEdge",K5.displayName="StepEdgeInternal";function Z5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:y,interactionWidth:m})=>{const[v,b,w]=L3({sourceX:n,sourceY:r,targetX:a,targetY:o}),_=e.isInternal?void 0:t;return h.jsx(Rh,{id:_,path:v,labelX:b,labelY:w,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:y,interactionWidth:m})})}const ece=Z5({isInternal:!1}),X5=Z5({isInternal:!0});ece.displayName="StraightEdge",X5.displayName="StraightEdgeInternal";function Q5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=fe.Bottom,targetPosition:s=fe.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[_,x,j]=I3({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s,curvature:b==null?void 0:b.curvature}),S=e.isInternal?void 0:t;return h.jsx(Rh,{id:S,path:_,labelX:x,labelY:j,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:v,interactionWidth:w})})}const tce=Q5({isInternal:!1}),G5=Q5({isInternal:!0});tce.displayName="BezierEdge",G5.displayName="BezierEdgeInternal";const J5={default:G5,straight:X5,step:K5,smoothstep:q5,simplebezier:V5},Y5={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},nce=(e,t,n)=>n===fe.Left?e-t:n===fe.Right?e+t:e,rce=(e,t,n)=>n===fe.Top?e-t:n===fe.Bottom?e+t:e,e4="react-flow__edgeupdater";function t4({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:a,onMouseEnter:o,onMouseOut:i,type:s}){return h.jsx("circle",{onMouseDown:a,onMouseEnter:o,onMouseOut:i,className:Gt([e4,`${e4}-${s}`]),cx:nce(t,r,e),cy:rce(n,r,e),r,stroke:"transparent",fill:"transparent"})}function ace({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:a,targetX:o,targetY:i,sourcePosition:s,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:p,setUpdateHover:f}){const y=Tt(),m=(x,j)=>{if(x.button!==0)return;const{autoPanOnConnect:S,domNode:E,isValidConnection:O,connectionMode:N,connectionRadius:M,lib:P,onConnectStart:I,onConnectEnd:k,cancelConnection:C,nodeLookup:T,rfId:A,panBy:R,updateConnection:L}=y.getState(),D=j.type==="target";p(!0),u==null||u(x,n,j.type);const B=($,V)=>{p(!1),d==null||d($,n,j.type,V)},F=$=>l==null?void 0:l(n,$);M1.onPointerDown(x.nativeEvent,{autoPanOnConnect:S,connectionMode:N,connectionRadius:M,domNode:E,handleId:j.id,nodeId:j.nodeId,nodeLookup:T,isTarget:D,edgeUpdaterType:j.type,lib:P,flowId:A,cancelConnection:C,panBy:R,isValidConnection:O,onConnect:F,onConnectStart:I,onConnectEnd:k,onReconnectEnd:B,updateConnection:L,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle})},v=x=>m(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=x=>m(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>f(!0),_=()=>f(!1);return h.jsxs(h.Fragment,{children:[(e===!0||e==="source")&&h.jsx(t4,{position:s,centerX:r,centerY:a,radius:t,onMouseDown:v,onMouseEnter:w,onMouseOut:_,type:"source"}),(e===!0||e==="target")&&h.jsx(t4,{position:c,centerX:o,centerY:i,radius:t,onMouseDown:b,onMouseEnter:w,onMouseOut:_,type:"target"})]})}function oce({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:a,onDoubleClick:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:p,onReconnectEnd:f,rfId:y,edgeTypes:m,noPanClassName:v,onError:b,disableKeyboardA11y:w}){let _=Ge(z=>z.edgeLookup.get(e));const x=Ge(z=>z.defaultEdgeOptions);_=x?{...x,..._}:_;let j=_.type||"default",S=(m==null?void 0:m[j])||J5[j];S===void 0&&(b==null||b("011",yo.error011(j)),j="default",S=J5.default);const E=!!(_.focusable||t&&typeof _.focusable>"u"),O=typeof d<"u"&&(_.reconnectable||n&&typeof _.reconnectable>"u"),N=!!(_.selectable||r&&typeof _.selectable>"u"),M=g.useRef(null),[P,I]=g.useState(!1),[k,C]=g.useState(!1),T=Tt(),{zIndex:A,sourceX:R,sourceY:L,targetX:D,targetY:B,sourcePosition:F,targetPosition:$}=Ge(g.useCallback(z=>{const se=z.nodeLookup.get(_.source),re=z.nodeLookup.get(_.target);if(!se||!re)return{zIndex:_.zIndex,...Y5};const le=aie({id:e,sourceNode:se,targetNode:re,sourceHandle:_.sourceHandle||null,targetHandle:_.targetHandle||null,connectionMode:z.connectionMode,onError:b});return{zIndex:Goe({selected:_.selected,zIndex:_.zIndex,sourceNode:se,targetNode:re,elevateOnSelect:z.elevateEdgesOnSelect}),...le||Y5}},[_.source,_.target,_.sourceHandle,_.targetHandle,_.selected,_.zIndex]),$t),V=g.useMemo(()=>_.markerStart?`url('#${_1(_.markerStart,y)}')`:void 0,[_.markerStart,y]),Q=g.useMemo(()=>_.markerEnd?`url('#${_1(_.markerEnd,y)}')`:void 0,[_.markerEnd,y]);if(_.hidden||R===null||L===null||D===null||B===null)return null;const X=z=>{var je;const{addSelectedEdges:se,unselectNodesAndEdges:re,multiSelectionActive:le}=T.getState();N&&(T.setState({nodesSelectionActive:!1}),_.selected&&le?(re({nodes:[],edges:[_]}),(je=M.current)==null||je.blur()):se([e])),a&&a(z,_)},H=o?z=>{o(z,{..._})}:void 0,J=i?z=>{i(z,{..._})}:void 0,K=s?z=>{s(z,{..._})}:void 0,q=c?z=>{c(z,{..._})}:void 0,G=l?z=>{l(z,{..._})}:void 0,ne=z=>{var se;if(!w&&f3.includes(z.key)&&N){const{unselectNodesAndEdges:re,addSelectedEdges:le}=T.getState();z.key==="Escape"?((se=M.current)==null||se.blur(),re({edges:[_]})):le([e])}};return h.jsx("svg",{style:{zIndex:A},children:h.jsxs("g",{className:Gt(["react-flow__edge",`react-flow__edge-${j}`,_.className,v,{selected:_.selected,animated:_.animated,inactive:!N&&!a,updating:P,selectable:N}]),onClick:X,onDoubleClick:H,onContextMenu:J,onMouseEnter:K,onMouseMove:q,onMouseLeave:G,onKeyDown:E?ne:void 0,tabIndex:E?0:void 0,role:E?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":_.ariaLabel===null?void 0:_.ariaLabel||`Edge from ${_.source} to ${_.target}`,"aria-describedby":E?`${h5}-${y}`:void 0,ref:M,children:[!k&&h.jsx(S,{id:e,source:_.source,target:_.target,type:_.type,selected:_.selected,animated:_.animated,selectable:N,deletable:_.deletable??!0,label:_.label,labelStyle:_.labelStyle,labelShowBg:_.labelShowBg,labelBgStyle:_.labelBgStyle,labelBgPadding:_.labelBgPadding,labelBgBorderRadius:_.labelBgBorderRadius,sourceX:R,sourceY:L,targetX:D,targetY:B,sourcePosition:F,targetPosition:$,data:_.data,style:_.style,sourceHandleId:_.sourceHandle,targetHandleId:_.targetHandle,markerStart:V,markerEnd:Q,pathOptions:"pathOptions"in _?_.pathOptions:void 0,interactionWidth:_.interactionWidth}),O&&h.jsx(ace,{edge:_,isReconnectable:O,reconnectRadius:u,onReconnect:d,onReconnectStart:p,onReconnectEnd:f,sourceX:R,sourceY:L,targetX:D,targetY:B,sourcePosition:F,targetPosition:$,setUpdateHover:I,setReconnecting:C})]})})}const ice=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function n4({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:a,onReconnect:o,onEdgeContextMenu:i,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:p,onReconnectStart:f,onReconnectEnd:y,disableKeyboardA11y:m}){const{edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,onError:_}=Ge(ice,$t),x=qse(t);return h.jsxs("div",{className:"react-flow__edges",children:[h.jsx(Qse,{defaultColor:e,rfId:n}),x.map(j=>h.jsx(oce,{id:j,edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,noPanClassName:a,onReconnect:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:p,onReconnectStart:f,onReconnectEnd:y,rfId:n,onError:_,edgeTypes:r,disableKeyboardA11y:m},j))]})}n4.displayName="EdgeRenderer";const sce=g.memo(n4),cce=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function lce({children:e}){const t=Ge(cce);return h.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function uce(e){const t=lr(),n=g.useRef(!1);g.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const dce=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function pce(e){const t=Ge(dce),n=Tt();return g.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function fce(e){return e.connection.inProgress?{...e.connection,to:Zu(e.connection.to,e.transform)}:{...e.connection}}function hce(e){return fce}function mce(e){const t=hce();return Ge(t,$t)}const yce=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function gce({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:a,width:o,height:i,isValid:s,inProgress:c}=Ge(yce,$t);return o&&a&&c?h.jsx("svg",{style:e,width:o,height:i,className:"react-flow__connectionline react-flow__container",children:h.jsx("g",{className:Gt(["react-flow__connection",g3(s)]),children:h.jsx(r4,{style:t,type:n,CustomComponent:r,isValid:s})})}):null}const r4=({style:e,type:t=ni.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:a,from:o,fromNode:i,fromHandle:s,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:p}=mce();if(!a)return;if(n)return h.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:s,fromX:o.x,fromY:o.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:p,connectionStatus:g3(r),toNode:u,toHandle:d});let f="";const y={sourceX:o.x,sourceY:o.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:p};switch(t){case ni.Bezier:[f]=I3(y);break;case ni.SimpleBezier:[f]=B5(y);break;case ni.Step:[f]=x1({...y,borderRadius:0});break;case ni.SmoothStep:[f]=x1(y);break;default:[f]=L3(y)}return h.jsx("path",{d:f,fill:"none",className:"react-flow__connection-path",style:e})};r4.displayName="ConnectionLine";const vce={};function a4(e=vce){g.useRef(e),Tt(),g.useEffect(()=>{},[e])}function bce(){Tt(),g.useRef(!1),g.useEffect(()=>{},[])}function o4({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:o,onEdgeDoubleClick:i,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:p,onSelectionEnd:f,connectionLineType:y,connectionLineStyle:m,connectionLineComponent:v,connectionLineContainerStyle:b,selectionKeyCode:w,selectionOnDrag:_,selectionMode:x,multiSelectionKeyCode:j,panActivationKeyCode:S,zoomActivationKeyCode:E,deleteKeyCode:O,onlyRenderVisibleElements:N,elementsSelectable:M,defaultViewport:P,translateExtent:I,minZoom:k,maxZoom:C,preventScrolling:T,defaultMarkerColor:A,zoomOnScroll:R,zoomOnPinch:L,panOnScroll:D,panOnScrollSpeed:B,panOnScrollMode:F,zoomOnDoubleClick:$,panOnDrag:V,onPaneClick:Q,onPaneMouseEnter:X,onPaneMouseMove:H,onPaneMouseLeave:J,onPaneScroll:K,onPaneContextMenu:q,paneClickDistance:G,nodeClickDistance:ne,onEdgeContextMenu:z,onEdgeMouseEnter:se,onEdgeMouseMove:re,onEdgeMouseLeave:le,reconnectRadius:je,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Se,noDragClassName:Ve,noWheelClassName:Ue,noPanClassName:qe,disableKeyboardA11y:Mt,nodeExtent:st,rfId:rt,viewport:bt,onViewportChange:Ht}){return a4(e),a4(t),bce(),uce(n),pce(bt),h.jsx(Dse,{onPaneClick:Q,onPaneMouseEnter:X,onPaneMouseMove:H,onPaneMouseLeave:J,onPaneContextMenu:q,onPaneScroll:K,paneClickDistance:G,deleteKeyCode:O,selectionKeyCode:w,selectionOnDrag:_,selectionMode:x,onSelectionStart:p,onSelectionEnd:f,multiSelectionKeyCode:j,panActivationKeyCode:S,zoomActivationKeyCode:E,elementsSelectable:M,zoomOnScroll:R,zoomOnPinch:L,zoomOnDoubleClick:$,panOnScroll:D,panOnScrollSpeed:B,panOnScrollMode:F,panOnDrag:V,defaultViewport:P,translateExtent:I,minZoom:k,maxZoom:C,onSelectionContextMenu:d,preventScrolling:T,noDragClassName:Ve,noWheelClassName:Ue,noPanClassName:qe,disableKeyboardA11y:Mt,onViewportChange:Ht,isControlledViewport:!!bt,children:h.jsxs(lce,{children:[h.jsx(sce,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:i,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Se,onlyRenderVisibleElements:N,onEdgeContextMenu:z,onEdgeMouseEnter:se,onEdgeMouseMove:re,onEdgeMouseLeave:le,reconnectRadius:je,defaultMarkerColor:A,noPanClassName:qe,disableKeyboardA11y:Mt,rfId:rt}),h.jsx(gce,{style:m,type:y,component:v,containerStyle:b}),h.jsx("div",{className:"react-flow__edgelabel-renderer"}),h.jsx(Use,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:ne,onlyRenderVisibleElements:N,noPanClassName:qe,noDragClassName:Ve,disableKeyboardA11y:Mt,nodeExtent:st,rfId:rt}),h.jsx("div",{className:"react-flow__viewport-portal"})]})})}o4.displayName="GraphView";const wce=g.memo(o4),i4=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}={})=>{const l=new Map,u=new Map,d=new Map,p=new Map,f=r??t??[],y=n??e??[],m=s??[0,0],v=c??Wu;U3(d,p,f),E1(y,l,u,{nodeOrigin:m,nodeExtent:v,elevateNodesOnSelect:!1});let b=[0,0,1];if(i&&a&&o){const w=Hu(l,{filter:S=>!!((S.width||S.initialWidth)&&(S.height||S.initialHeight))}),{x:_,y:x,zoom:j}=b1(w,a,o,.5,2,.1);b=[_,x,j]}return{rfId:"1",width:0,height:0,transform:b,nodes:y,nodeLookup:l,parentLookup:u,edges:f,edgeLookup:p,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:Wu,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:ac.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:m,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...h3},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Xoe,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},xce=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c})=>Bie((l,u)=>({...i4({nodes:e,edges:t,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:d=>{const{nodeLookup:p,parentLookup:f,nodeOrigin:y,elevateNodesOnSelect:m}=u();E1(d,p,f,{nodeOrigin:y,nodeExtent:c,elevateNodesOnSelect:m,checkEquality:!0}),l({nodes:d})},setEdges:d=>{const{connectionLookup:p,edgeLookup:f}=u();U3(p,f,d),l({edges:d})},setDefaultNodesAndEdges:(d,p)=>{if(d){const{setNodes:f}=u();f(d),l({hasDefaultNodes:!0})}if(p){const{setEdges:f}=u();f(p),l({hasDefaultEdges:!0})}},updateNodeInternals:(d,p={triggerFitView:!0})=>{const{triggerNodeChanges:f,nodeLookup:y,parentLookup:m,fitViewOnInit:v,fitViewDone:b,fitViewOnInitOptions:w,domNode:_,nodeOrigin:x,nodeExtent:j,debug:S,fitViewSync:E}=u(),{changes:O,updatedInternals:N}=uie(d,y,m,_,x,j);if(N){if(sie(y,m,{nodeOrigin:x,nodeExtent:j}),p.triggerFitView){let M=b;!b&&v&&(M=E({...w,nodes:w==null?void 0:w.nodes})),l({fitViewDone:M})}else l({});(O==null?void 0:O.length)>0&&(S&&console.log("React Flow: trigger node changes",O),f==null||f(O))}},updateNodePositions:(d,p=!1)=>{const f=[],y=[];for(const[m,v]of d){const b={id:m,type:"position",position:v.position,dragging:p};v!=null&&v.expandParent&&(v!=null&&v.parentId)&&b.position&&(f.push({id:m,parentId:v.parentId,rect:{...v.internals.positionAbsolute,width:v.measured.width,height:v.measured.height}}),b.position.x=Math.max(0,b.position.x),b.position.y=Math.max(0,b.position.y)),y.push(b)}if(f.length>0){const{nodeLookup:m,parentLookup:v,nodeOrigin:b}=u(),w=C1(f,m,v,b);y.push(...w)}u().triggerNodeChanges(y)},triggerNodeChanges:d=>{const{onNodesChange:p,setNodes:f,nodes:y,hasDefaultNodes:m,debug:v}=u();if(d!=null&&d.length){if(m){const b=Hi(d,y);f(b)}v&&console.log("React Flow: trigger node changes",d),p==null||p(d)}},triggerEdgeChanges:d=>{const{onEdgesChange:p,setEdges:f,edges:y,hasDefaultEdges:m,debug:v}=u();if(d!=null&&d.length){if(m){const b=Ju(d,y);f(b)}v&&console.log("React Flow: trigger edge changes",d),p==null||p(d)}},addSelectedNodes:d=>{const{multiSelectionActive:p,edgeLookup:f,nodeLookup:y,triggerNodeChanges:m,triggerEdgeChanges:v}=u();if(p){const b=d.map(w=>Ki(w,!0));m(b);return}m(dc(y,new Set([...d]),!0)),v(dc(f))},addSelectedEdges:d=>{const{multiSelectionActive:p,edgeLookup:f,nodeLookup:y,triggerNodeChanges:m,triggerEdgeChanges:v}=u();if(p){const b=d.map(w=>Ki(w,!0));v(b);return}v(dc(f,new Set([...d]))),m(dc(y,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:p}={})=>{const{edges:f,nodes:y,nodeLookup:m,triggerNodeChanges:v,triggerEdgeChanges:b}=u(),w=d||y,_=p||f,x=w.map(S=>{const E=m.get(S.id);return E&&(E.selected=!1),Ki(S.id,!1)}),j=_.map(S=>Ki(S.id,!1));v(x),b(j)},setMinZoom:d=>{const{panZoom:p,maxZoom:f}=u();p==null||p.setScaleExtent([d,f]),l({minZoom:d})},setMaxZoom:d=>{const{panZoom:p,minZoom:f}=u();p==null||p.setScaleExtent([f,d]),l({maxZoom:d})},setTranslateExtent:d=>{var p;(p=u().panZoom)==null||p.setTranslateExtent(d),l({translateExtent:d})},setPaneClickDistance:d=>{var p;(p=u().panZoom)==null||p.setClickDistance(d)},resetSelectedElements:()=>{const{edges:d,nodes:p,triggerNodeChanges:f,triggerEdgeChanges:y}=u(),m=p.reduce((b,w)=>w.selected?[...b,Ki(w.id,!1)]:b,[]),v=d.reduce((b,w)=>w.selected?[...b,Ki(w.id,!1)]:b,[]);f(m),y(v)},setNodeExtent:d=>{const{nodes:p,nodeLookup:f,parentLookup:y,nodeOrigin:m,elevateNodesOnSelect:v,nodeExtent:b}=u();d[0][0]===b[0][0]&&d[0][1]===b[0][1]&&d[1][0]===b[1][0]&&d[1][1]===b[1][1]||(E1(p,f,y,{nodeOrigin:m,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!1}),l({nodeExtent:d}))},panBy:d=>{const{transform:p,width:f,height:y,panZoom:m,translateExtent:v}=u();return die({delta:d,panZoom:m,transform:p,translateExtent:v,width:f,height:y})},fitView:d=>{const{panZoom:p,width:f,height:y,minZoom:m,maxZoom:v,nodeLookup:b}=u();if(!p)return Promise.resolve(!1);const w=y1(b,d);return g1({nodes:w,width:f,height:y,panZoom:p,minZoom:m,maxZoom:v},d)},fitViewSync:d=>{const{panZoom:p,width:f,height:y,minZoom:m,maxZoom:v,nodeLookup:b}=u();if(!p)return!1;const w=y1(b,d);return g1({nodes:w,width:f,height:y,panZoom:p,minZoom:m,maxZoom:v},d),w.size>0},cancelConnection:()=>{l({connection:{...h3}})},updateConnection:d=>{l({connection:d})},reset:()=>l({...i4()})}),Object.is);function _ce({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:a,initialHeight:o,fitView:i,nodeOrigin:s,nodeExtent:c,children:l}){const[u]=g.useState(()=>xce({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}));return h.jsx(zie,{value:u,children:h.jsx(use,{children:l})})}function jce({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:o,height:i,fitView:s,nodeOrigin:c,nodeExtent:l}){return g.useContext(kh)?h.jsx(h.Fragment,{children:e}):h.jsx(_ce,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:o,initialHeight:i,fitView:s,nodeOrigin:c,nodeExtent:l,children:e})}const Sce={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Ece({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:a,nodeTypes:o,edgeTypes:i,onNodeClick:s,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:p,onConnect:f,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:x,onNodeContextMenu:j,onNodeDoubleClick:S,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:N,onNodesDelete:M,onEdgesDelete:P,onDelete:I,onSelectionChange:k,onSelectionDragStart:C,onSelectionDrag:T,onSelectionDragStop:A,onSelectionContextMenu:R,onSelectionStart:L,onSelectionEnd:D,onBeforeDelete:B,connectionMode:F,connectionLineType:$=ni.Bezier,connectionLineStyle:V,connectionLineComponent:Q,connectionLineContainerStyle:X,deleteKeyCode:H="Backspace",selectionKeyCode:J="Shift",selectionOnDrag:K=!1,selectionMode:q=Uu.Full,panActivationKeyCode:G="Space",multiSelectionKeyCode:ne=Oh()?"Meta":"Control",zoomActivationKeyCode:z=Oh()?"Meta":"Control",snapToGrid:se,snapGrid:re,onlyRenderVisibleElements:le=!1,selectNodesOnDrag:je,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Se,nodeOrigin:Ve=m5,edgesFocusable:Ue,edgesReconnectable:qe,elementsSelectable:Mt=!0,defaultViewport:st=ese,minZoom:rt=.5,maxZoom:bt=2,translateExtent:Ht=Wu,preventScrolling:Qn=!0,nodeExtent:za,defaultMarkerColor:Gn="#b1b1b7",zoomOnScroll:Va=!0,zoomOnPinch:Y=!0,panOnScroll:te=!1,panOnScrollSpeed:ce=.5,panOnScrollMode:he=ti.Free,zoomOnDoubleClick:Te=!0,panOnDrag:Wt=!0,onPaneClick:Dt,onPaneMouseEnter:Ke,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Ee,onPaneContextMenu:Oe,paneClickDistance:We=0,nodeClickDistance:St=0,children:Bt,onReconnect:W,onReconnectStart:ee,onReconnectEnd:ae,onEdgeContextMenu:pe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:Re,onEdgeMouseMove:Be,onEdgeMouseLeave:Me,reconnectRadius:ke=10,onNodesChange:we,onEdgesChange:ze,noDragClassName:Je="nodrag",noWheelClassName:kt="nowheel",noPanClassName:Lt="nopan",fitView:at,fitViewOptions:Jn,connectOnClick:Kt,attributionPosition:xs,proOptions:da,defaultEdgeOptions:Ei,elevateNodesOnSelect:Wa,elevateEdgesOnSelect:kp,disableKeyboardA11y:Nr=!1,autoPanOnConnect:Sl,autoPanOnNodeDrag:El,autoPanSpeed:Ol,connectionRadius:ft,isValidConnection:Yn,onError:_s,style:zt,id:Fo,nodeDragThreshold:jg,viewport:gN,onViewportChange:Gke,width:Jke,height:Yke,colorMode:eAe="light",debug:tAe,...nAe},rAe){const vN=Fo||"1",aAe=ase(eAe);return h.jsx("div",{...nAe,style:{...zt,...Sce},ref:rAe,className:Gt(["react-flow",a,aAe]),"data-testid":"rf__wrapper",id:Fo,children:h.jsxs(jce,{nodes:e,edges:t,width:Jke,height:Yke,fitView:at,nodeOrigin:Ve,nodeExtent:za,children:[h.jsx(wce,{onInit:l,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:x,onNodeContextMenu:j,onNodeDoubleClick:S,nodeTypes:o,edgeTypes:i,connectionLineType:$,connectionLineStyle:V,connectionLineComponent:Q,connectionLineContainerStyle:X,selectionKeyCode:J,selectionOnDrag:K,selectionMode:q,deleteKeyCode:H,multiSelectionKeyCode:ne,panActivationKeyCode:G,zoomActivationKeyCode:z,onlyRenderVisibleElements:le,defaultViewport:st,translateExtent:Ht,minZoom:rt,maxZoom:bt,preventScrolling:Qn,zoomOnScroll:Va,zoomOnPinch:Y,zoomOnDoubleClick:Te,panOnScroll:te,panOnScrollSpeed:ce,panOnScrollMode:he,panOnDrag:Wt,onPaneClick:Dt,onPaneMouseEnter:Ke,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Ee,onPaneContextMenu:Oe,paneClickDistance:We,nodeClickDistance:St,onSelectionContextMenu:R,onSelectionStart:L,onSelectionEnd:D,onReconnect:W,onReconnectStart:ee,onReconnectEnd:ae,onEdgeContextMenu:pe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:Re,onEdgeMouseMove:Be,onEdgeMouseLeave:Me,reconnectRadius:ke,defaultMarkerColor:Gn,noDragClassName:Je,noWheelClassName:kt,noPanClassName:Lt,rfId:vN,disableKeyboardA11y:Nr,nodeExtent:za,viewport:gN,onViewportChange:Gke}),h.jsx(rse,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:f,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Se,edgesFocusable:Ue,edgesReconnectable:qe,elementsSelectable:Mt,elevateNodesOnSelect:Wa,elevateEdgesOnSelect:kp,minZoom:rt,maxZoom:bt,nodeExtent:za,onNodesChange:we,onEdgesChange:ze,snapToGrid:se,snapGrid:re,connectionMode:F,translateExtent:Ht,connectOnClick:Kt,defaultEdgeOptions:Ei,fitView:at,fitViewOptions:Jn,onNodesDelete:M,onEdgesDelete:P,onDelete:I,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:N,onSelectionDrag:T,onSelectionDragStart:C,onSelectionDragStop:A,onMove:u,onMoveStart:d,onMoveEnd:p,noPanClassName:Lt,nodeOrigin:Ve,rfId:vN,autoPanOnConnect:Sl,autoPanOnNodeDrag:El,autoPanSpeed:Ol,onError:_s,connectionRadius:ft,isValidConnection:Yn,selectNodesOnDrag:je,nodeDragThreshold:jg,onBeforeDelete:B,paneClickDistance:We,debug:tAe}),h.jsx(Yie,{onSelectionChange:k}),Bt,h.jsx(Zie,{proOptions:da,position:xs}),h.jsx(Hie,{rfId:vN,disableKeyboardA11y:Nr})]})})}var Oce=O5(Ece);const Cce=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__viewport-portal")};function Nce({children:e}){const t=Ge(Cce);return t?Nl.createPortal(e,t):null}const Mce=e=>e.nodes;function Pce(){return Ge(Mce,$t)}function Dh({type:e,id:t=null,nodeId:n,onConnect:r,onDisconnect:a}){const o=L1(),i=n??o,s=g.useRef(null),c=Ge(l=>l.connectionLookup.get(`${i}-${e}-${t}`),Uoe);return g.useEffect(()=>{if(s.current&&s.current!==c){const l=c??new Map;y3(s.current,l,a),y3(l,s.current,r)}s.current=c??new Map},[c,r,a]),g.useMemo(()=>Array.from((c==null?void 0:c.values())??[]),[c])}Tn=function(e){return Ge(g.useCallback(t=>t.nodeLookup.get(e),[e]),$t)};function kce({dimensions:e,lineWidth:t,variant:n,className:r}){return h.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:Gt(["react-flow__background-pattern",n,r])})}function Ace({radius:e,className:t}){return h.jsx("circle",{cx:e,cy:e,r:e,className:Gt(["react-flow__background-pattern","dots",t])})}var bo;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(bo||(bo={}));const Tce={[bo.Dots]:1,[bo.Lines]:1,[bo.Cross]:6},Ice=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function s4({id:e,variant:t=bo.Dots,gap:n=20,size:r,lineWidth:a=1,offset:o=0,color:i,bgColor:s,style:c,className:l,patternClassName:u}){const d=g.useRef(null),{transform:p,patternId:f}=Ge(Ice,$t),y=r||Tce[t],m=t===bo.Dots,v=t===bo.Cross,b=Array.isArray(n)?n:[n,n],w=[b[0]*p[2]||1,b[1]*p[2]||1],_=y*p[2],x=Array.isArray(o)?o:[o,o],j=v?[_,_]:w,S=[x[0]*p[2]||1+j[0]/2,x[1]*p[2]||1+j[1]/2],E=`${f}${e||""}`;return h.jsxs("svg",{className:Gt(["react-flow__background",l]),style:{...c,...Th,"--xy-background-color-props":s,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[h.jsx("pattern",{id:E,x:p[0]%w[0],y:p[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`,children:m?h.jsx(Ace,{radius:_/2,className:u}):h.jsx(kce,{dimensions:j,lineWidth:a,variant:t,className:u})}),h.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E})`})]})}s4.displayName="Background";const Rce=g.memo(s4);function Dce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:h.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Lce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:h.jsx("path",{d:"M0 0h32v4.2H0z"})})}function $ce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:h.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Fce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Bce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Lh({children:e,className:t,...n}){return h.jsx("button",{type:"button",className:Gt(["react-flow__controls-button",t]),...n,children:e})}const zce=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function c4({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:a,onZoomIn:o,onZoomOut:i,onFitView:s,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:p="vertical","aria-label":f="React Flow controls"}){const y=Tt(),{isInteractive:m,minZoomReached:v,maxZoomReached:b}=Ge(zce,$t),{zoomIn:w,zoomOut:_,fitView:x}=lr(),j=()=>{w(),o==null||o()},S=()=>{_(),i==null||i()},E=()=>{x(a),s==null||s()},O=()=>{y.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c==null||c(!m)},N=p==="horizontal"?"horizontal":"vertical";return h.jsxs(uc,{className:Gt(["react-flow__controls",N,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":f,children:[t&&h.jsxs(h.Fragment,{children:[h.jsx(Lh,{onClick:j,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b,children:h.jsx(Dce,{})}),h.jsx(Lh,{onClick:S,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:h.jsx(Lce,{})})]}),n&&h.jsx(Lh,{className:"react-flow__controls-fitview",onClick:E,title:"fit view","aria-label":"fit view",children:h.jsx($ce,{})}),r&&h.jsx(Lh,{className:"react-flow__controls-interactive",onClick:O,title:"toggle interactivity","aria-label":"toggle interactivity",children:m?h.jsx(Bce,{}):h.jsx(Fce,{})}),u]})}c4.displayName="Controls";const Vce=g.memo(c4);function Wce({id:e,x:t,y:n,width:r,height:a,style:o,color:i,strokeColor:s,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:p,onClick:f}){const{background:y,backgroundColor:m}=o||{},v=i||y||m;return h.jsx("rect",{className:Gt(["react-flow__minimap-node",{selected:p},l]),x:t,y:n,rx:u,ry:u,width:r,height:a,style:{fill:v,stroke:s,strokeWidth:c},shapeRendering:d,onClick:f?b=>f(b,e):void 0})}const Uce=g.memo(Wce),qce=e=>e.nodes.map(t=>t.id),$1=e=>e instanceof Function?e:()=>e;function Hce({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:a,nodeComponent:o=Uce,onClick:i}){const s=Ge(qce,$t),c=$1(t),l=$1(e),u=$1(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return h.jsx(h.Fragment,{children:s.map(p=>h.jsx(Zce,{id:p,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:a,NodeComponent:o,onClick:i,shapeRendering:d},p))})}function Kce({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:a,nodeStrokeWidth:o,shapeRendering:i,NodeComponent:s,onClick:c}){const{node:l,x:u,y:d,width:p,height:f}=Ge(y=>{const m=y.nodeLookup.get(e),{x:v,y:b}=m.internals.positionAbsolute,{width:w,height:_}=go(m);return{node:m,x:v,y:b,width:w,height:_}},$t);return!l||l.hidden||!C3(l)?null:h.jsx(s,{x:u,y:d,width:p,height:f,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:a,strokeColor:n(l),strokeWidth:o,shapeRendering:i,onClick:c,id:l.id})}const Zce=g.memo(Kce);var Xce=g.memo(Hce);const Qce=200,Gce=150,Jce=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?S3(Hu(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Yce="react-flow__minimap-desc";function l4({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:a="",nodeBorderRadius:o=5,nodeStrokeWidth:i,nodeComponent:s,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:p="bottom-right",onClick:f,onNodeClick:y,pannable:m=!1,zoomable:v=!1,ariaLabel:b="React Flow mini map",inversePan:w,zoomStep:_=10,offsetScale:x=5}){const j=Tt(),S=g.useRef(null),{boundingRect:E,viewBB:O,rfId:N,panZoom:M,translateExtent:P,flowWidth:I,flowHeight:k}=Ge(Jce,$t),C=(e==null?void 0:e.width)??Qce,T=(e==null?void 0:e.height)??Gce,A=E.width/C,R=E.height/T,L=Math.max(A,R),D=L*C,B=L*T,F=x*L,$=E.x-(D-E.width)/2-F,V=E.y-(B-E.height)/2-F,Q=D+F*2,X=B+F*2,H=`${Yce}-${N}`,J=g.useRef(0),K=g.useRef();J.current=L,g.useEffect(()=>{if(S.current&&M)return K.current=bie({domNode:S.current,panZoom:M,getTransform:()=>j.getState().transform,getViewScale:()=>J.current}),()=>{var ne;(ne=K.current)==null||ne.destroy()}},[M]),g.useEffect(()=>{var ne;(ne=K.current)==null||ne.update({translateExtent:P,width:I,height:k,inversePan:w,pannable:m,zoomStep:_,zoomable:v})},[m,v,w,_,P,I,k]);const q=f?ne=>{var re;const[z,se]=((re=K.current)==null?void 0:re.pointer(ne))||[0,0];f(ne,{x:z,y:se})}:void 0,G=y?g.useCallback((ne,z)=>{const se=j.getState().nodeLookup.get(z);y(ne,se)},[]):void 0;return h.jsx(uc,{position:p,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*L:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:Gt(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:h.jsxs("svg",{width:C,height:T,viewBox:`${$} ${V} ${Q} ${X}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":H,ref:S,onClick:q,children:[b&&h.jsx("title",{id:H,children:b}),h.jsx(Xce,{onClick:G,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:o,nodeClassName:a,nodeStrokeWidth:i,nodeComponent:s}),h.jsx("path",{className:"react-flow__minimap-mask",d:`M${$-F},${V-F}h${Q+F*2}v${X+F*2}h${-Q-F*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}l4.displayName="MiniMap";const ele=g.memo(l4);function tle({nodeId:e,position:t,variant:n=lc.Handle,className:r,style:a={},children:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:p,onResizeStart:f,onResize:y,onResizeEnd:m}){const v=L1(),b=typeof e=="string"?e:v,w=Tt(),_=g.useRef(null),x=n===lc.Line?"right":"bottom-right",j=t??x,S=g.useRef(null);g.useEffect(()=>{if(!(!_.current||!b))return S.current||(S.current=Die({domNode:_.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:M,transform:P,snapGrid:I,snapToGrid:k,nodeOrigin:C,domNode:T}=w.getState();return{nodeLookup:M,transform:P,snapGrid:I,snapToGrid:k,nodeOrigin:C,paneDomNode:T}},onChange:(M,P)=>{const{triggerNodeChanges:I,nodeLookup:k,parentLookup:C,nodeOrigin:T}=w.getState(),A=[],R={x:M.x,y:M.y},L=k.get(b);if(L&&L.expandParent&&L.parentId){const D=L.origin??T,B=M.width??L.measured.width,F=M.height??L.measured.height,$={id:L.id,parentId:L.parentId,rect:{width:B,height:F,...N3({x:M.x??L.position.x,y:M.y??L.position.y},{width:B,height:F},L.parentId,k,D)}},V=C1([$],k,C,T);A.push(...V),R.x=M.x?Math.max(D[0]*B,M.x):void 0,R.y=M.y?Math.max(D[1]*F,M.y):void 0}if(R.x!==void 0&&R.y!==void 0){const D={id:b,type:"position",position:{...R}};A.push(D)}if(M.width!==void 0&&M.height!==void 0){const D={id:b,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:M.width,height:M.height}};A.push(D)}for(const D of P){const B={...D,type:"position"};A.push(B)}I(A)},onEnd:()=>{const M={id:b,type:"dimensions",resizing:!1};w.getState().triggerNodeChanges([M])}})),S.current.update({controlPosition:j,boundaries:{minWidth:s,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,onResizeStart:f,onResize:y,onResizeEnd:m,shouldResize:p}),()=>{var M;(M=S.current)==null||M.destroy()}},[j,s,c,l,u,d,f,y,m,p]);const E=j.split("-"),O=n===lc.Line?"borderColor":"backgroundColor",N=i?{...a,[O]:i}:a;return h.jsx("div",{className:Gt(["react-flow__resize-control","nodrag",...E,n,r]),ref:_,style:N,children:o})}const u4=g.memo(tle);function nle({nodeId:e,isVisible:t=!0,handleClassName:n,handleStyle:r,lineClassName:a,lineStyle:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:p,onResizeStart:f,onResize:y,onResizeEnd:m}){return t?h.jsxs(h.Fragment,{children:[Mie.map(v=>h.jsx(u4,{className:a,style:o,nodeId:e,position:v,variant:lc.Line,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:f,keepAspectRatio:d,shouldResize:p,onResize:y,onResizeEnd:m},v)),Nie.map(v=>h.jsx(u4,{className:n,style:r,nodeId:e,position:v,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:f,keepAspectRatio:d,shouldResize:p,onResize:y,onResizeEnd:m},v))]}):null}var F1,d4;function rle(){if(d4)return F1;d4=1;var e=function(b){return t(b)&&!n(b)};function t(b){return!!b&&typeof b=="object"}function n(b){var w=Object.prototype.toString.call(b);return w==="[object RegExp]"||w==="[object Date]"||o(b)}var r=typeof Symbol=="function"&&Symbol.for,a=r?Symbol.for("react.element"):60103;function o(b){return b.$$typeof===a}function i(b){return Array.isArray(b)?[]:{}}function s(b,w){return w.clone!==!1&&w.isMergeableObject(b)?m(i(b),b,w):b}function c(b,w,_){return b.concat(w).map(function(x){return s(x,_)})}function l(b,w){if(!w.customMerge)return m;var _=w.customMerge(b);return typeof _=="function"?_:m}function u(b){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(b).filter(function(w){return Object.propertyIsEnumerable.call(b,w)}):[]}function d(b){return Object.keys(b).concat(u(b))}function p(b,w){try{return w in b}catch{return!1}}function f(b,w){return p(b,w)&&!(Object.hasOwnProperty.call(b,w)&&Object.propertyIsEnumerable.call(b,w))}function y(b,w,_){var x={};return _.isMergeableObject(b)&&d(b).forEach(function(j){x[j]=s(b[j],_)}),d(w).forEach(function(j){f(b,j)||(p(b,j)&&_.isMergeableObject(w[j])?x[j]=l(j,_)(b[j],w[j],_):x[j]=s(w[j],_))}),x}function m(b,w,_){_=_||{},_.arrayMerge=_.arrayMerge||c,_.isMergeableObject=_.isMergeableObject||e,_.cloneUnlessOtherwiseSpecified=s;var x=Array.isArray(w),j=Array.isArray(b),S=x===j;return S?x?_.arrayMerge(b,w,_):y(b,w,_):s(w,_)}m.all=function(b,w){if(!Array.isArray(b))throw new Error("first argument should be an array");return b.reduce(function(_,x){return m(_,x,w)},{})};var v=m;return F1=v,F1}var ale=rle();const $h=ot(ale);var p4={},f4;function ole(){if(f4)return p4;f4=1;var e;return function(t){(function(n){var r=typeof globalThis=="object"?globalThis:typeof kl=="object"?kl:typeof self=="object"?self:typeof this=="object"?this:c(),a=o(t);typeof r.Reflect<"u"&&(a=o(r.Reflect,a)),n(a,r),typeof r.Reflect>"u"&&(r.Reflect=t);function o(l,u){return function(d,p){Object.defineProperty(l,d,{configurable:!0,writable:!0,value:p}),u&&u(d,p)}}function i(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function c(){return i()||s()}})(function(n,r){var a=Object.prototype.hasOwnProperty,o=typeof Symbol=="function",i=o&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=o&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,u=!c&&!l,d={create:c?function(){return Va(Object.create(null))}:l?function(){return Va({__proto__:null})}:function(){return Va({})},has:u?function(Y,te){return a.call(Y,te)}:function(Y,te){return te in Y},get:u?function(Y,te){return a.call(Y,te)?Y[te]:void 0}:function(Y,te){return Y[te]}},p=Object.getPrototypeOf(Function),f=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Qn(),y=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:za(),m=typeof WeakMap=="function"?WeakMap:Gn(),v=o?Symbol.for("@reflect-metadata:registry"):void 0,b=st(),w=rt(b);function _(Y,te,ce,he){if(V(ce)){if(!z(Y))throw new TypeError;if(!re(te))throw new TypeError;return k(Y,te)}else{if(!z(Y))throw new TypeError;if(!H(te))throw new TypeError;if(!H(he)&&!V(he)&&!Q(he))throw new TypeError;return Q(he)&&(he=void 0),ce=ne(ce),C(Y,te,ce,he)}}n("decorate",_);function x(Y,te){function ce(he,Te){if(!H(he))throw new TypeError;if(!V(Te)&&!le(Te))throw new TypeError;D(Y,te,he,Te)}return ce}n("metadata",x);function j(Y,te,ce,he){if(!H(ce))throw new TypeError;return V(he)||(he=ne(he)),D(Y,te,ce,he)}n("defineMetadata",j);function S(Y,te,ce){if(!H(te))throw new TypeError;return V(ce)||(ce=ne(ce)),T(Y,te,ce)}n("hasMetadata",S);function E(Y,te,ce){if(!H(te))throw new TypeError;return V(ce)||(ce=ne(ce)),A(Y,te,ce)}n("hasOwnMetadata",E);function O(Y,te,ce){if(!H(te))throw new TypeError;return V(ce)||(ce=ne(ce)),R(Y,te,ce)}n("getMetadata",O);function N(Y,te,ce){if(!H(te))throw new TypeError;return V(ce)||(ce=ne(ce)),L(Y,te,ce)}n("getOwnMetadata",N);function M(Y,te){if(!H(Y))throw new TypeError;return V(te)||(te=ne(te)),B(Y,te)}n("getMetadataKeys",M);function P(Y,te){if(!H(Y))throw new TypeError;return V(te)||(te=ne(te)),F(Y,te)}n("getOwnMetadataKeys",P);function I(Y,te,ce){if(!H(te))throw new TypeError;if(V(ce)||(ce=ne(ce)),!H(te))throw new TypeError;V(ce)||(ce=ne(ce));var he=Ht(te,ce,!1);return V(he)?!1:he.OrdinaryDeleteMetadata(Y,te,ce)}n("deleteMetadata",I);function k(Y,te){for(var ce=Y.length-1;ce>=0;--ce){var he=Y[ce],Te=he(te);if(!V(Te)&&!Q(Te)){if(!re(Te))throw new TypeError;te=Te}}return te}function C(Y,te,ce,he){for(var Te=Y.length-1;Te>=0;--Te){var Wt=Y[Te],Dt=Wt(te,ce,he);if(!V(Dt)&&!Q(Dt)){if(!H(Dt))throw new TypeError;he=Dt}}return he}function T(Y,te,ce){var he=A(Y,te,ce);if(he)return!0;var Te=qe(te);return Q(Te)?!1:T(Y,Te,ce)}function A(Y,te,ce){var he=Ht(te,ce,!1);return V(he)?!1:q(he.OrdinaryHasOwnMetadata(Y,te,ce))}function R(Y,te,ce){var he=A(Y,te,ce);if(he)return L(Y,te,ce);var Te=qe(te);if(!Q(Te))return R(Y,Te,ce)}function L(Y,te,ce){var he=Ht(te,ce,!1);if(!V(he))return he.OrdinaryGetOwnMetadata(Y,te,ce)}function D(Y,te,ce,he){var Te=Ht(ce,he,!0);Te.OrdinaryDefineOwnMetadata(Y,te,ce,he)}function B(Y,te){var ce=F(Y,te),he=qe(Y);if(he===null)return ce;var Te=B(he,te);if(Te.length<=0)return ce;if(ce.length<=0)return Te;for(var Wt=new y,Dt=[],Ke=0,be=ce;Ke<be.length;Ke++){var _e=be[Ke],Ee=Wt.has(_e);Ee||(Wt.add(_e),Dt.push(_e))}for(var Oe=0,We=Te;Oe<We.length;Oe++){var _e=We[Oe],Ee=Wt.has(_e);Ee||(Wt.add(_e),Dt.push(_e))}return Dt}function F(Y,te){var ce=Ht(Y,te,!1);return ce?ce.OrdinaryOwnMetadataKeys(Y,te):[]}function $(Y){if(Y===null)return 1;switch(typeof Y){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Y===null?1:6;default:return 6}}function V(Y){return Y===void 0}function Q(Y){return Y===null}function X(Y){return typeof Y=="symbol"}function H(Y){return typeof Y=="object"?Y!==null:typeof Y=="function"}function J(Y,te){switch($(Y)){case 0:return Y;case 1:return Y;case 2:return Y;case 3:return Y;case 4:return Y;case 5:return Y}var ce="string",he=Le(Y,i);if(he!==void 0){var Te=he.call(Y,ce);if(H(Te))throw new TypeError;return Te}return K(Y)}function K(Y,te){var ce,he;{var Te=Y.toString;if(se(Te)){var he=Te.call(Y);if(!H(he))return he}var ce=Y.valueOf;if(se(ce)){var he=ce.call(Y);if(!H(he))return he}}throw new TypeError}function q(Y){return!!Y}function G(Y){return""+Y}function ne(Y){var te=J(Y);return X(te)?te:G(te)}function z(Y){return Array.isArray?Array.isArray(Y):Y instanceof Object?Y instanceof Array:Object.prototype.toString.call(Y)==="[object Array]"}function se(Y){return typeof Y=="function"}function re(Y){return typeof Y=="function"}function le(Y){switch($(Y)){case 3:return!0;case 4:return!0;default:return!1}}function je(Y,te){return Y===te||Y!==Y&&te!==te}function Le(Y,te){var ce=Y[te];if(ce!=null){if(!se(ce))throw new TypeError;return ce}}function $e(Y){var te=Le(Y,s);if(!se(te))throw new TypeError;var ce=te.call(Y);if(!H(ce))throw new TypeError;return ce}function Se(Y){return Y.value}function Ve(Y){var te=Y.next();return te.done?!1:te}function Ue(Y){var te=Y.return;te&&te.call(Y)}function qe(Y){var te=Object.getPrototypeOf(Y);if(typeof Y!="function"||Y===p||te!==p)return te;var ce=Y.prototype,he=ce&&Object.getPrototypeOf(ce);if(he==null||he===Object.prototype)return te;var Te=he.constructor;return typeof Te!="function"||Te===Y?te:Te}function Mt(){var Y;!V(v)&&typeof r.Reflect<"u"&&!(v in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(Y=bt(r.Reflect));var te,ce,he,Te=new m,Wt={registerProvider:Dt,getProvider:be,setProvider:Ee};return Wt;function Dt(Oe){if(!Object.isExtensible(Wt))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Y===Oe:break;case V(te):te=Oe;break;case te===Oe:break;case V(ce):ce=Oe;break;case ce===Oe:break;default:he===void 0&&(he=new y),he.add(Oe);break}}function Ke(Oe,We){if(!V(te)){if(te.isProviderFor(Oe,We))return te;if(!V(ce)){if(ce.isProviderFor(Oe,We))return te;if(!V(he))for(var St=$e(he);;){var Bt=Ve(St);if(!Bt)return;var W=Se(Bt);if(W.isProviderFor(Oe,We))return Ue(St),W}}}if(!V(Y)&&Y.isProviderFor(Oe,We))return Y}function be(Oe,We){var St=Te.get(Oe),Bt;return V(St)||(Bt=St.get(We)),V(Bt)&&(Bt=Ke(Oe,We),V(Bt)||(V(St)&&(St=new f,Te.set(Oe,St)),St.set(We,Bt))),Bt}function _e(Oe){if(V(Oe))throw new TypeError;return te===Oe||ce===Oe||!V(he)&&he.has(Oe)}function Ee(Oe,We,St){if(!_e(St))throw new Error("Metadata provider not registered.");var Bt=be(Oe,We);if(Bt!==St){if(!V(Bt))return!1;var W=Te.get(Oe);V(W)&&(W=new f,Te.set(Oe,W)),W.set(We,St)}return!0}}function st(){var Y;return!V(v)&&H(r.Reflect)&&Object.isExtensible(r.Reflect)&&(Y=r.Reflect[v]),V(Y)&&(Y=Mt()),!V(v)&&H(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,v,{enumerable:!1,configurable:!1,writable:!1,value:Y}),Y}function rt(Y){var te=new m,ce={isProviderFor:function(_e,Ee){var Oe=te.get(_e);return V(Oe)?!1:Oe.has(Ee)},OrdinaryDefineOwnMetadata:Dt,OrdinaryHasOwnMetadata:Te,OrdinaryGetOwnMetadata:Wt,OrdinaryOwnMetadataKeys:Ke,OrdinaryDeleteMetadata:be};return b.registerProvider(ce),ce;function he(_e,Ee,Oe){var We=te.get(_e),St=!1;if(V(We)){if(!Oe)return;We=new f,te.set(_e,We),St=!0}var Bt=We.get(Ee);if(V(Bt)){if(!Oe)return;if(Bt=new f,We.set(Ee,Bt),!Y.setProvider(_e,Ee,ce))throw We.delete(Ee),St&&te.delete(_e),new Error("Wrong provider for target.")}return Bt}function Te(_e,Ee,Oe){var We=he(Ee,Oe,!1);return V(We)?!1:q(We.has(_e))}function Wt(_e,Ee,Oe){var We=he(Ee,Oe,!1);if(!V(We))return We.get(_e)}function Dt(_e,Ee,Oe,We){var St=he(Oe,We,!0);St.set(_e,Ee)}function Ke(_e,Ee){var Oe=[],We=he(_e,Ee,!1);if(V(We))return Oe;for(var St=We.keys(),Bt=$e(St),W=0;;){var ee=Ve(Bt);if(!ee)return Oe.length=W,Oe;var ae=Se(ee);try{Oe[W]=ae}catch(pe){try{Ue(Bt)}finally{throw pe}}W++}}function be(_e,Ee,Oe){var We=he(Ee,Oe,!1);if(V(We)||!We.delete(_e))return!1;if(We.size===0){var St=te.get(Ee);V(St)||(St.delete(Oe),St.size===0&&te.delete(St))}return!0}}function bt(Y){var te=Y.defineMetadata,ce=Y.hasOwnMetadata,he=Y.getOwnMetadata,Te=Y.getOwnMetadataKeys,Wt=Y.deleteMetadata,Dt=new m,Ke={isProviderFor:function(be,_e){var Ee=Dt.get(be);return!V(Ee)&&Ee.has(_e)?!0:Te(be,_e).length?(V(Ee)&&(Ee=new y,Dt.set(be,Ee)),Ee.add(_e),!0):!1},OrdinaryDefineOwnMetadata:te,OrdinaryHasOwnMetadata:ce,OrdinaryGetOwnMetadata:he,OrdinaryOwnMetadataKeys:Te,OrdinaryDeleteMetadata:Wt};return Ke}function Ht(Y,te,ce){var he=b.getProvider(Y,te);if(!V(he))return he;if(ce){if(b.setProvider(Y,te,w))return w;throw new Error("Illegal state.")}}function Qn(){var Y={},te=[],ce=function(){function Ke(be,_e,Ee){this._index=0,this._keys=be,this._values=_e,this._selector=Ee}return Ke.prototype["@@iterator"]=function(){return this},Ke.prototype[s]=function(){return this},Ke.prototype.next=function(){var be=this._index;if(be>=0&&be<this._keys.length){var _e=this._selector(this._keys[be],this._values[be]);return be+1>=this._keys.length?(this._index=-1,this._keys=te,this._values=te):this._index++,{value:_e,done:!1}}return{value:void 0,done:!0}},Ke.prototype.throw=function(be){throw this._index>=0&&(this._index=-1,this._keys=te,this._values=te),be},Ke.prototype.return=function(be){return this._index>=0&&(this._index=-1,this._keys=te,this._values=te),{value:be,done:!0}},Ke}(),he=function(){function Ke(){this._keys=[],this._values=[],this._cacheKey=Y,this._cacheIndex=-2}return Object.defineProperty(Ke.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Ke.prototype.has=function(be){return this._find(be,!1)>=0},Ke.prototype.get=function(be){var _e=this._find(be,!1);return _e>=0?this._values[_e]:void 0},Ke.prototype.set=function(be,_e){var Ee=this._find(be,!0);return this._values[Ee]=_e,this},Ke.prototype.delete=function(be){var _e=this._find(be,!1);if(_e>=0){for(var Ee=this._keys.length,Oe=_e+1;Oe<Ee;Oe++)this._keys[Oe-1]=this._keys[Oe],this._values[Oe-1]=this._values[Oe];return this._keys.length--,this._values.length--,je(be,this._cacheKey)&&(this._cacheKey=Y,this._cacheIndex=-2),!0}return!1},Ke.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Y,this._cacheIndex=-2},Ke.prototype.keys=function(){return new ce(this._keys,this._values,Te)},Ke.prototype.values=function(){return new ce(this._keys,this._values,Wt)},Ke.prototype.entries=function(){return new ce(this._keys,this._values,Dt)},Ke.prototype["@@iterator"]=function(){return this.entries()},Ke.prototype[s]=function(){return this.entries()},Ke.prototype._find=function(be,_e){if(!je(this._cacheKey,be)){this._cacheIndex=-1;for(var Ee=0;Ee<this._keys.length;Ee++)if(je(this._keys[Ee],be)){this._cacheIndex=Ee;break}}return this._cacheIndex<0&&_e&&(this._cacheIndex=this._keys.length,this._keys.push(be),this._values.push(void 0)),this._cacheIndex},Ke}();return he;function Te(Ke,be){return Ke}function Wt(Ke,be){return be}function Dt(Ke,be){return[Ke,be]}}function za(){var Y=function(){function te(){this._map=new f}return Object.defineProperty(te.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),te.prototype.has=function(ce){return this._map.has(ce)},te.prototype.add=function(ce){return this._map.set(ce,ce),this},te.prototype.delete=function(ce){return this._map.delete(ce)},te.prototype.clear=function(){this._map.clear()},te.prototype.keys=function(){return this._map.keys()},te.prototype.values=function(){return this._map.keys()},te.prototype.entries=function(){return this._map.entries()},te.prototype["@@iterator"]=function(){return this.keys()},te.prototype[s]=function(){return this.keys()},te}();return Y}function Gn(){var Y=16,te=d.create(),ce=he();return function(){function be(){this._key=he()}return be.prototype.has=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?d.has(Ee,this._key):!1},be.prototype.get=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?d.get(Ee,this._key):void 0},be.prototype.set=function(_e,Ee){var Oe=Te(_e,!0);return Oe[this._key]=Ee,this},be.prototype.delete=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?delete Ee[this._key]:!1},be.prototype.clear=function(){this._key=he()},be}();function he(){var be;do be="@@WeakMap@@"+Ke();while(d.has(te,be));return te[be]=!0,be}function Te(be,_e){if(!a.call(be,ce)){if(!_e)return;Object.defineProperty(be,ce,{value:d.create()})}return be[ce]}function Wt(be,_e){for(var Ee=0;Ee<_e;++Ee)be[Ee]=Math.random()*255|0;return be}function Dt(be){if(typeof Uint8Array=="function"){var _e=new Uint8Array(be);return typeof crypto<"u"?crypto.getRandomValues(_e):typeof msCrypto<"u"?msCrypto.getRandomValues(_e):Wt(_e,be),_e}return Wt(new Array(be),be)}function Ke(){var be=Dt(Y);be[6]=be[6]&79|64,be[8]=be[8]&191|128;for(var _e="",Ee=0;Ee<Y;++Ee){var Oe=be[Ee];(Ee===4||Ee===6||Ee===8)&&(_e+="-"),Oe<16&&(_e+="0"),_e+=Oe.toString(16).toLowerCase()}return _e}}function Va(Y){return Y.__=void 0,delete Y.__,Y}})}(e||(e={})),p4}ole(),typeof window<"u"&&(window.Buffer=gAe),typeof Ag<"u"&&typeof require<"u"&&(Ag.Buffer=require("buffer/").Buffer);class Jt{static isObject(t){return t!==null&&typeof t=="object"}static isObjectWithName(t){return t!==null&&typeof t=="object"&&t.name!==void 0}static assign(t,...n){for(const r of n)for(const a of Object.getOwnPropertyNames(r))t[a]=r[a]}static mixedListToArray(t){return t!==null&&typeof t=="object"?Object.keys(t).map(n=>t[n]):t}}class xe extends Error{get name(){return this.constructor.name}constructor(t){super(t),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class pc extends xe{constructor(){super("Locking not supported on given driver.")}}class B1 extends xe{constructor(){super('Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')}}class Ct{static isMssqlParameter(t){return this.check(t,"MssqlParameter")}static isEntityMetadata(t){return this.check(t,"EntityMetadata")}static isColumnMetadata(t){return this.check(t,"ColumnMetadata")}static isSelectQueryBuilder(t){return this.check(t,"SelectQueryBuilder")}static isInsertQueryBuilder(t){return this.check(t,"InsertQueryBuilder")}static isDeleteQueryBuilder(t){return this.check(t,"DeleteQueryBuilder")}static isUpdateQueryBuilder(t){return this.check(t,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(t){return this.check(t,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(t){return this.check(t,"RelationQueryBuilder")}static isBrackets(t){return this.check(t,"Brackets")||this.check(t,"NotBrackets")}static isNotBrackets(t){return this.check(t,"NotBrackets")}static isSubject(t){return this.check(t,"Subject")}static isRdbmsSchemaBuilder(t){return this.check(t,"RdbmsSchemaBuilder")}static isMongoEntityManager(t){return this.check(t,"MongoEntityManager")}static isSqljsEntityManager(t){return this.check(t,"SqljsEntityManager")}static isEntitySchema(t){return this.check(t,"EntitySchema")}static isBaseEntityConstructor(t){return typeof t=="function"&&typeof t.hasId=="function"&&typeof t.save=="function"&&typeof t.useDataSource=="function"}static isFindOperator(t){return this.check(t,"FindOperator")||this.check(t,"EqualOperator")}static isEqualOperator(t){return this.check(t,"EqualOperator")}static isQuery(t){return this.check(t,"Query")}static isTable(t){return this.check(t,"Table")}static isTableCheck(t){return this.check(t,"TableCheck")}static isTableColumn(t){return this.check(t,"TableColumn")}static isTableExclusion(t){return this.check(t,"TableExclusion")}static isTableForeignKey(t){return this.check(t,"TableForeignKey")}static isTableIndex(t){return this.check(t,"TableIndex")}static isTableUnique(t){return this.check(t,"TableUnique")}static isView(t){return this.check(t,"View")}static isDataSource(t){return this.check(t,"DataSource")}static check(t,n){return typeof t=="object"&&t!==null&&t["@instanceof"]===Symbol.for(n)}}class ile extends xe{constructor(t,n){super(),this.entityClass=t,this.criteria=n,this.message=`Could not find any entity of type "${this.stringifyTarget(t)}" matching: ${this.stringifyCriteria(n)}`}stringifyTarget(t){return Ct.isEntitySchema(t)?t.options.name:typeof t=="function"||Jt.isObject(t)&&"name"in t?t.name:t}stringifyCriteria(t){try{return JSON.stringify(t,null,4)}catch{}return""+t}}class h4 extends xe{constructor(t,n,r){super(`The optimistic lock on entity ${t} failed, version ${n} was expected, but is actually ${r}.`)}}class m4 extends xe{constructor(){super("Your database does not support LIMIT on UPDATE statements.")}}class sle extends xe{constructor(t){super(`Entity "${t.name}" does not have delete date columns.`)}}class Fh extends xe{constructor(){super("OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL or MariaDB databases.")}}class Ea extends xe{constructor(t,n){super(t),Object.setPrototypeOf(this,Ea.prototype),this.message=`Property "${t}" was not found in "${n.targetName}". Make sure your query is correct.`}}class cle extends xe{constructor(t){super(`Entity ${t} does not have version or update date columns.`)}}class lle extends xe{constructor(){super('Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')}}class ed extends xe{constructor(){super("The optimistic lock can be used only with getOne() method.")}}class ule extends xe{constructor(t){super(),t.length===1?this.message=`Relation "${t[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${t.map(n=>`"${n}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class dle extends xe{constructor(){super("An open transaction is required for pessimistic lock.")}}class ple extends xe{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class y4{constructor(t){Jt.assign(this,t||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(t){this._metadata=t}get metadata(){if(!this._metadata)throw new xe(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class Oa{static isAliasProperty(t){if(typeof t!="string"||t.indexOf(".")===-1)return!1;const[n,r]=t.split(".");return!(!n||!r||t.indexOf("(")!==-1||t.indexOf(")")!==-1)}}var z1={exports:{}},V1={exports:{}},g4;function fc(){return g4||(g4=1,typeof Object.create=="function"?V1.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:V1.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),V1.exports}var W1={exports:{}},v4;function Zi(){return v4||(v4=1,function(e,t){var n=vAe(),r=n.Buffer;function a(i,s){for(var c in i)s[c]=i[c]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o);function o(i,s,c){return r(i,s,c)}o.prototype=Object.create(r.prototype),a(r,o),o.from=function(i,s,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return r(i,s,c)},o.alloc=function(i,s,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var l=r(i);return s!==void 0?typeof c=="string"?l.fill(s,c):l.fill(s):l.fill(0),l},o.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r(i)},o.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(i)}}(W1,W1.exports)),W1.exports}var U1,b4;function hc(){if(b4)return U1;b4=1;var e=Zi().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var a=this._block,o=this._blockSize,i=n.length,s=this._len,c=0;c<i;){for(var l=s%o,u=Math.min(i-c,o-l),d=0;d<u;d++)a[l+d]=n[c+d];s+=u,c+=u,s%o===0&&this._update(a)}return this._len+=i,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var o=(a&4294967295)>>>0,i=(a-o)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(o,this._blockSize-4)}this._update(this._block);var s=this._hash();return n?s.toString(n):s},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},U1=t,U1}var q1,w4;function fle(){if(w4)return q1;w4=1;var e=fc(),t=hc(),n=Zi().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(l){return l<<5|l>>>27}function s(l){return l<<30|l>>>2}function c(l,u,d,p){return l===0?u&d|~u&p:l===2?u&d|u&p|d&p:u^d^p}return o.prototype._update=function(l){for(var u=this._w,d=this._a|0,p=this._b|0,f=this._c|0,y=this._d|0,m=this._e|0,v=0;v<16;++v)u[v]=l.readInt32BE(v*4);for(;v<80;++v)u[v]=u[v-3]^u[v-8]^u[v-14]^u[v-16];for(var b=0;b<80;++b){var w=~~(b/20),_=i(d)+c(w,p,f,y)+m+u[b]+r[w]|0;m=y,y=f,f=s(p),p=d,d=_}this._a=d+this._a|0,this._b=p+this._b|0,this._c=f+this._c|0,this._d=y+this._d|0,this._e=m+this._e|0},o.prototype._hash=function(){var l=n.allocUnsafe(20);return l.writeInt32BE(this._a|0,0),l.writeInt32BE(this._b|0,4),l.writeInt32BE(this._c|0,8),l.writeInt32BE(this._d|0,12),l.writeInt32BE(this._e|0,16),l},q1=o,q1}var H1,x4;function hle(){if(x4)return H1;x4=1;var e=fc(),t=hc(),n=Zi().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(u){return u<<1|u>>>31}function s(u){return u<<5|u>>>27}function c(u){return u<<30|u>>>2}function l(u,d,p,f){return u===0?d&p|~d&f:u===2?d&p|d&f|p&f:d^p^f}return o.prototype._update=function(u){for(var d=this._w,p=this._a|0,f=this._b|0,y=this._c|0,m=this._d|0,v=this._e|0,b=0;b<16;++b)d[b]=u.readInt32BE(b*4);for(;b<80;++b)d[b]=i(d[b-3]^d[b-8]^d[b-14]^d[b-16]);for(var w=0;w<80;++w){var _=~~(w/20),x=s(p)+l(_,f,y,m)+v+d[w]+r[_]|0;v=m,m=y,y=c(f),f=p,p=x}this._a=p+this._a|0,this._b=f+this._b|0,this._c=y+this._c|0,this._d=m+this._d|0,this._e=v+this._e|0},o.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},H1=o,H1}var K1,_4;function j4(){if(_4)return K1;_4=1;var e=fc(),t=hc(),n=Zi().Buffer,r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function i(p,f,y){return y^p&(f^y)}function s(p,f,y){return p&f|y&(p|f)}function c(p){return(p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10)}function l(p){return(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7)}function u(p){return(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3}function d(p){return(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10}return o.prototype._update=function(p){for(var f=this._w,y=this._a|0,m=this._b|0,v=this._c|0,b=this._d|0,w=this._e|0,_=this._f|0,x=this._g|0,j=this._h|0,S=0;S<16;++S)f[S]=p.readInt32BE(S*4);for(;S<64;++S)f[S]=d(f[S-2])+f[S-7]+u(f[S-15])+f[S-16]|0;for(var E=0;E<64;++E){var O=j+l(w)+i(w,_,x)+r[E]+f[E]|0,N=c(y)+s(y,m,v)|0;j=x,x=_,_=w,w=b+O|0,b=v,v=m,m=y,y=O+N|0}this._a=y+this._a|0,this._b=m+this._b|0,this._c=v+this._c|0,this._d=b+this._d|0,this._e=w+this._e|0,this._f=_+this._f|0,this._g=x+this._g|0,this._h=j+this._h|0},o.prototype._hash=function(){var p=n.allocUnsafe(32);return p.writeInt32BE(this._a,0),p.writeInt32BE(this._b,4),p.writeInt32BE(this._c,8),p.writeInt32BE(this._d,12),p.writeInt32BE(this._e,16),p.writeInt32BE(this._f,20),p.writeInt32BE(this._g,24),p.writeInt32BE(this._h,28),p},K1=o,K1}var Z1,S4;function mle(){if(S4)return Z1;S4=1;var e=fc(),t=j4(),n=hc(),r=Zi().Buffer,a=new Array(64);function o(){this.init(),this._w=a,n.call(this,64,56)}return e(o,t),o.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(28);return i.writeInt32BE(this._a,0),i.writeInt32BE(this._b,4),i.writeInt32BE(this._c,8),i.writeInt32BE(this._d,12),i.writeInt32BE(this._e,16),i.writeInt32BE(this._f,20),i.writeInt32BE(this._g,24),i},Z1=o,Z1}var X1,E4;function O4(){if(E4)return X1;E4=1;var e=fc(),t=hc(),n=Zi().Buffer,r=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function o(){this.init(),this._w=a,t.call(this,128,112)}e(o,t),o.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function i(m,v,b){return b^m&(v^b)}function s(m,v,b){return m&v|b&(m|v)}function c(m,v){return(m>>>28|v<<4)^(v>>>2|m<<30)^(v>>>7|m<<25)}function l(m,v){return(m>>>14|v<<18)^(m>>>18|v<<14)^(v>>>9|m<<23)}function u(m,v){return(m>>>1|v<<31)^(m>>>8|v<<24)^m>>>7}function d(m,v){return(m>>>1|v<<31)^(m>>>8|v<<24)^(m>>>7|v<<25)}function p(m,v){return(m>>>19|v<<13)^(v>>>29|m<<3)^m>>>6}function f(m,v){return(m>>>19|v<<13)^(v>>>29|m<<3)^(m>>>6|v<<26)}function y(m,v){return m>>>0<v>>>0?1:0}return o.prototype._update=function(m){for(var v=this._w,b=this._ah|0,w=this._bh|0,_=this._ch|0,x=this._dh|0,j=this._eh|0,S=this._fh|0,E=this._gh|0,O=this._hh|0,N=this._al|0,M=this._bl|0,P=this._cl|0,I=this._dl|0,k=this._el|0,C=this._fl|0,T=this._gl|0,A=this._hl|0,R=0;R<32;R+=2)v[R]=m.readInt32BE(R*4),v[R+1]=m.readInt32BE(R*4+4);for(;R<160;R+=2){var L=v[R-30],D=v[R-15*2+1],B=u(L,D),F=d(D,L);L=v[R-2*2],D=v[R-2*2+1];var $=p(L,D),V=f(D,L),Q=v[R-7*2],X=v[R-7*2+1],H=v[R-16*2],J=v[R-16*2+1],K=F+X|0,q=B+Q+y(K,F)|0;K=K+V|0,q=q+$+y(K,V)|0,K=K+J|0,q=q+H+y(K,J)|0,v[R]=q,v[R+1]=K}for(var G=0;G<160;G+=2){q=v[G],K=v[G+1];var ne=s(b,w,_),z=s(N,M,P),se=c(b,N),re=c(N,b),le=l(j,k),je=l(k,j),Le=r[G],$e=r[G+1],Se=i(j,S,E),Ve=i(k,C,T),Ue=A+je|0,qe=O+le+y(Ue,A)|0;Ue=Ue+Ve|0,qe=qe+Se+y(Ue,Ve)|0,Ue=Ue+$e|0,qe=qe+Le+y(Ue,$e)|0,Ue=Ue+K|0,qe=qe+q+y(Ue,K)|0;var Mt=re+z|0,st=se+ne+y(Mt,re)|0;O=E,A=T,E=S,T=C,S=j,C=k,k=I+Ue|0,j=x+qe+y(k,I)|0,x=_,I=P,_=w,P=M,w=b,M=N,N=Ue+Mt|0,b=qe+st+y(N,Ue)|0}this._al=this._al+N|0,this._bl=this._bl+M|0,this._cl=this._cl+P|0,this._dl=this._dl+I|0,this._el=this._el+k|0,this._fl=this._fl+C|0,this._gl=this._gl+T|0,this._hl=this._hl+A|0,this._ah=this._ah+b+y(this._al,N)|0,this._bh=this._bh+w+y(this._bl,M)|0,this._ch=this._ch+_+y(this._cl,P)|0,this._dh=this._dh+x+y(this._dl,I)|0,this._eh=this._eh+j+y(this._el,k)|0,this._fh=this._fh+S+y(this._fl,C)|0,this._gh=this._gh+E+y(this._gl,T)|0,this._hh=this._hh+O+y(this._hl,A)|0},o.prototype._hash=function(){var m=n.allocUnsafe(64);function v(b,w,_){m.writeInt32BE(b,_),m.writeInt32BE(w,_+4)}return v(this._ah,this._al,0),v(this._bh,this._bl,8),v(this._ch,this._cl,16),v(this._dh,this._dl,24),v(this._eh,this._el,32),v(this._fh,this._fl,40),v(this._gh,this._gl,48),v(this._hh,this._hl,56),m},X1=o,X1}var Q1,C4;function yle(){if(C4)return Q1;C4=1;var e=fc(),t=O4(),n=hc(),r=Zi().Buffer,a=new Array(160);function o(){this.init(),this._w=a,n.call(this,128,112)}return e(o,t),o.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(48);function s(c,l,u){i.writeInt32BE(c,u),i.writeInt32BE(l,u+4)}return s(this._ah,this._al,0),s(this._bh,this._bl,8),s(this._ch,this._cl,16),s(this._dh,this._dl,24),s(this._eh,this._el,32),s(this._fh,this._fl,40),i},Q1=o,Q1}var N4;function gle(){if(N4)return z1.exports;N4=1;var e=z1.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n};return e.sha=fle(),e.sha1=hle(),e.sha224=mle(),e.sha256=j4(),e.sha384=yle(),e.sha512=O4(),z1.exports}var vle=gle();const ble=ot(vle);function wle(e,t={}){const{segmentLength:n=4,separator:r="__",termLength:a=2}=t;return e.split(r).reduce((o,i)=>{const s=i.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),c=s.length>1?a:n,l=s.map(u=>u.substr(0,c)).join("");return o.push(l),o},[]).join(r)}function xle(e,t={}){const n=ble("sha1");n.update(e,"utf8");const r=n.digest("hex");return t.length?r.slice(0,t.length):r}class _le{static isGreaterOrEqual(t,n){const r=M4(t),a=M4(n);return r[0]>a[0]||r[0]===a[0]&&r[1]>a[1]||r[0]===a[0]&&r[1]===a[1]&&r[2]>=a[2]}}function M4(e=""){const t=[0,0,0];return e.split(".").forEach((n,r)=>t[r]=parseInt(n,10)),t}class ve{static isSQLiteFamily(t){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(t.options.type)}static isMySQLFamily(t){return["mysql","mariadb"].includes(t.options.type)}static isReleaseVersionOrGreater(t,n){return t.version!=null&&_le.isGreaterOrEqual(t.version,n)}static isPostgresFamily(t){return["postgres","aurora-postgres","cockroachdb"].includes(t.options.type)}static buildDriverOptions(t,n){if(t.url){const r=this.parseConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildMongoDBDriverOptions(t,n){if(t.url){const r=this.parseMongoDBConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildAlias({maxAliasLength:t},n,...r){const a=n&&n.joiner?n.joiner:"_";let o=r.length===1?r[0]:r.join(a);if(t&&t>0&&o.length>t){if(n&&n.shorten===!0){const i=wle(o);if(i.length<t)return i}return xle(o,{length:t})}return o}static buildColumnAlias({maxAliasLength:t},n,...r){return typeof n=="string"?(r.unshift(n),n={shorten:!1,joiner:"_"}):n=Object.assign({shorten:!1,joiner:"_"},n),this.buildAlias({maxAliasLength:t},n,...r)}static parseConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0;s&&s.indexOf("?")!==-1&&(s=s.substr(0,s.indexOf("?")));const c=i.lastIndexOf("@"),l=i.substr(0,c),u=i.substr(c+1);let d=l,p="";const f=l.indexOf(":");f!==-1&&(d=l.substr(0,f),p=l.substr(f+1));const[y,m]=u.split(":");return{type:n,host:y,username:decodeURIComponent(d),password:decodeURIComponent(p),port:m?parseInt(m):void 0,database:s||void 0}}static parseMongoDBConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0,c="",l,u,d,p,f={};if(s&&s.indexOf("?")!==-1){c=s.substr(s.indexOf("?")+1,s.length);const j=c.split("&");let S,E;j.forEach(O=>{S=O.split("=")[0],E=O.split("=")[1],f[S]=E}),p=f.replicaSet,s=s.substr(0,s.indexOf("?"))}const y=i.lastIndexOf("@"),m=i.substr(0,y),v=i.substr(y+1);let b=m,w="";const _=m.indexOf(":");_!==-1&&(b=m.substr(0,_),w=m.substr(_+1)),p?d=v:[l,u]=v.split(":");let x={type:n,host:l,hostReplicaSet:d,username:decodeURIComponent(b),password:decodeURIComponent(w),port:u?parseInt(u):void 0,database:s||void 0};for(const[j,S]of Object.entries(f))x[j]=S;return x}}class P4{constructor(t,n,r){this.connection=t,this.queryExpressionMap=n,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,r&&Jt.assign(this,r)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){let t=()=>{for(const n of this.queryExpressionMap.selects)if(n.selection===this.alias.name||this.metadata&&this.metadata.columns.find(r=>n.selection===this.alias.name+"."+r.propertyPath))return!0;return!1};this.isSelectedCache=t(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(Oa.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(Oa.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let t=()=>{if(!Oa.isAliasProperty(this.entityOrProperty))return;const n=this.queryExpressionMap.findAliasByName(this.parentAlias);let r=n.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(r||n.metadata.parentEntityMetadata&&(r=n.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),r))return r;throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=t.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new xe("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new xe("Junction property is not defined.");const t=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?ve.buildAlias(this.connection.driver,void 0,t,this.alias.name):ve.buildAlias(this.connection.driver,void 0,this.alias.name,t)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class G1{constructor(t,n){this.queryExpressionMap=t,this.disableMixedMap=!1,Jt.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");const t=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return t}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class J1{constructor(t,n){this.expressionMap=t,Jt.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rc"}get relation(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const[t,n]=this.relationName.split("."),r=this.expressionMap.findAliasByName(t).metadata.findRelationWithPropertyPath(n);if(!r)throw new xe(`Relation with property path ${n} in entity was not found.`);return r}get metadata(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const t=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(t).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}class Y1{constructor(t){var n;this.connection=t,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],t.options.relationLoadStrategy&&(this.relationLoadStrategy=t.options.relationLoadStrategy),this.timeTravel=((n=t.options)==null?void 0:n.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const t=this.mainAlias.metadata.orderBy||{};return Object.keys(t).reduce((n,r)=>(n[this.mainAlias.name+"."+r]=t[r],n),{})}return this.orderBys}setMainAlias(t){return this.mainAlias=t,t}createAlias(t){let n=t.name;!n&&t.tablePath&&(n=t.tablePath),!n&&typeof t.target=="function"&&(n=t.target.name),!n&&typeof t.target=="string"&&(n=t.target);const r=new y4;return r.type=t.type,n&&(r.name=n),t.metadata&&(r.metadata=t.metadata),t.target&&!r.hasMetadata&&(r.metadata=this.connection.getMetadata(t.target)),t.tablePath&&(r.tablePath=t.tablePath),t.subQuery&&(r.subQuery=t.subQuery),this.aliases.push(r),r}findAliasByName(t){const n=this.aliases.find(r=>r.name===t);if(!n)throw new xe(`"${t}" alias was not found. Maybe you forgot to join it?`);return n}findColumnByAliasExpression(t){const[n,r]=t.split(".");return this.findAliasByName(n).metadata.findColumnWithPropertyName(r)}get relationMetadata(){if(!this.mainAlias)throw new xe("Entity to work with is not specified!");const t=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return t}clone(){const t=new Y1(this.connection);return t.queryType=this.queryType,t.selects=this.selects.map(n=>n),t.maxExecutionTime=this.maxExecutionTime,t.selectDistinct=this.selectDistinct,t.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(n=>t.aliases.push(new y4(n))),t.relationLoadStrategy=this.relationLoadStrategy,t.mainAlias=this.mainAlias,t.valuesSet=this.valuesSet,t.returning=this.returning,t.onConflict=this.onConflict,t.onIgnore=this.onIgnore,t.onUpdate=this.onUpdate,t.joinAttributes=this.joinAttributes.map(n=>new P4(this.connection,this,n)),t.relationIdAttributes=this.relationIdAttributes.map(n=>new G1(this,n)),t.relationCountAttributes=this.relationCountAttributes.map(n=>new J1(this,n)),t.wheres=this.wheres.map(n=>({...n})),t.havings=this.havings.map(n=>({...n})),t.orderBys=Object.assign({},this.orderBys),t.groupBys=this.groupBys.map(n=>n),t.limit=this.limit,t.offset=this.offset,t.skip=this.skip,t.take=this.take,t.lockMode=this.lockMode,t.onLocked=this.onLocked,t.lockVersion=this.lockVersion,t.lockTables=this.lockTables,t.withDeleted=this.withDeleted,t.parameters=Object.assign({},this.parameters),t.disableEscaping=this.disableEscaping,t.enableRelationIdValues=this.enableRelationIdValues,t.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,t.subQuery=this.subQuery,t.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,t.cache=this.cache,t.cacheId=this.cacheId,t.cacheDuration=this.cacheDuration,t.relationPropertyPath=this.relationPropertyPath,t.of=this.of,t.insertColumns=this.insertColumns,t.whereEntities=this.whereEntities,t.updateEntity=this.updateEntity,t.callListeners=this.callListeners,t.useTransaction=this.useTransaction,t.timeTravel=this.timeTravel,t.nativeParameters=Object.assign({},this.nativeParameters),t.comment=this.comment,t.commonTableExpressions=this.commonTableExpressions.map(n=>({alias:n.alias,queryBuilder:typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.clone(),options:n.options})),t}}class k4{constructor(t){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=t}}class e_{static transformFrom(t,n){return Array.isArray(t)?t.slice().reverse().reduce((r,a)=>a.from(r),n):t.from(n)}static transformTo(t,n){return Array.isArray(t)?t.reduce((r,a)=>a.to(r),n):t.to(n)}}class td{constructor(t,n,r=!0,a=!1,o,i){this["@instanceof"]=Symbol.for("FindOperator"),this._type=t,this._value=n,this._useParameter=r,this._multipleParameters=a,this._getSql=o,this._objectLiteralParameters=i}get useParameter(){return Ct.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return Ct.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return Ct.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return Ct.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(Ct.isFindOperator(this._value))return this._value}get getSql(){return Ct.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(t){this._value instanceof td?this._value.transformValue(t):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(n=>t&&e_.transformTo(t,n)):e_.transformTo(t,this._value)}}function Ca(e){return new td("in",e,!0,!0)}const jle=/[.*+\-?^${}()|[\]\\]/g,Sle=e=>e.replace(jle,"\\$&");class Ut{constructor(t,n){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,Ct.isDataSource(t)?(this.connection=t,this.queryRunner=n,this.expressionMap=new Y1(this.connection)):(this.connection=t.connection,this.queryRunner=t.queryRunner,this.expressionMap=t.expressionMap.clone())}static registerQueryBuilderClass(t,n){Ut.queryBuilderRegistry[t]=n}get alias(){if(!this.expressionMap.mainAlias)throw new xe("Main alias is not set");return this.expressionMap.mainAlias.name}select(t,n){return this.expressionMap.queryType="select",Array.isArray(t)?this.expressionMap.selects=t.map(r=>({selection:r})):t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]),Ct.isSelectQueryBuilder(this)?this:Ut.queryBuilderRegistry.SelectQueryBuilder(this)}insert(){return this.expressionMap.queryType="insert",Ct.isInsertQueryBuilder(this)?this:Ut.queryBuilderRegistry.InsertQueryBuilder(this)}update(t,n){const r=n||t;if(t=Ct.isEntitySchema(t)?t.options.name:t,typeof t=="function"||typeof t=="string"){const a=this.createFromAlias(t);this.expressionMap.setMainAlias(a)}return this.expressionMap.queryType="update",this.expressionMap.valuesSet=r,Ct.isUpdateQueryBuilder(this)?this:Ut.queryBuilderRegistry.UpdateQueryBuilder(this)}delete(){return this.expressionMap.queryType="delete",Ct.isDeleteQueryBuilder(this)?this:Ut.queryBuilderRegistry.DeleteQueryBuilder(this)}softDelete(){return this.expressionMap.queryType="soft-delete",Ct.isSoftDeleteQueryBuilder(this)?this:Ut.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}restore(){return this.expressionMap.queryType="restore",Ct.isSoftDeleteQueryBuilder(this)?this:Ut.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}relation(t,n){const r=arguments.length===2?t:void 0,a=arguments.length===2?n:t;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=a,r){const o=this.createFromAlias(r);this.expressionMap.setMainAlias(o)}return Ct.isRelationQueryBuilder(this)?this:Ut.queryBuilderRegistry.RelationQueryBuilder(this)}hasRelation(t,n){const r=this.connection.getMetadata(t);return(Array.isArray(n)?n:[n]).every(a=>!!r.findRelationWithPropertyPath(a))}hasParameter(t){var n;return((n=this.parentQueryBuilder)==null?void 0:n.hasParameter(t))||t in this.expressionMap.parameters}setParameter(t,n){if(typeof n=="function")throw new xe(`Function parameter isn't supported in the parameters. Please check "${t}" parameter.`);if(!t.match(/^([A-Za-z0-9_.]+)$/))throw new xe("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(t,n),this.expressionMap.parameters[t]=n,this}setParameters(t){for(const[n,r]of Object.entries(t))this.setParameter(n,r);return this}createParameter(t){let n;do n=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(n));return this.setParameter(n,t),`:${n}`}setNativeParameters(t){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(t),Object.keys(t).forEach(n=>{this.expressionMap.nativeParameters[n]=t[n]}),this}getParameters(){const t=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const n=this.expressionMap.mainAlias.metadata;if(n.discriminatorColumn&&n.parentEntityMetadata){const r=n.childEntityMetadatas.filter(a=>a.discriminatorColumn).map(a=>a.discriminatorValue);r.push(n.discriminatorValue),t.discriminatorColumnValues=r}}return t}printSql(){const[t,n]=this.getQueryAndParameters();return this.connection.logger.logQuery(t,n),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const t=this.getQuery(),n=this.getParameters();return this.connection.driver.escapeQueryWithParameters(t,n,this.expressionMap.nativeParameters)}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();try{return await r.query(t,n)}finally{r!==this.queryRunner&&await r.release()}}createQueryBuilder(t){return new this.constructor(this.connection,t??this.queryRunner)}clone(){return new this.constructor(this)}comment(t){return this.expressionMap.comment=t,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(t){return this.expressionMap.disableEscaping?this.connection.driver.escape(t):t}setQueryRunner(t){return this.queryRunner=t,this}callListeners(t){return this.expressionMap.callListeners=t,this}useTransaction(t){return this.expressionMap.useTransaction=t,this}addCommonTableExpression(t,n,r){return this.expressionMap.commonTableExpressions.push({queryBuilder:t,alias:n,options:r||{}}),this}getTableName(t){return t.split(".").map(n=>n===""?n:this.escape(n)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new xe('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(t,n){if(this.connection.hasMetadata(t)){const r=this.connection.getMetadata(t);return this.expressionMap.createAlias({type:"from",name:n,metadata:this.connection.getMetadata(t),tablePath:r.tablePath})}else{if(typeof t=="string"){const o=t.substr(0,1)==="("&&t.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:n,tablePath:o?void 0:t,subQuery:o?t:void 0})}const r=t(this.subQuery());this.setParameters(r.getParameters());const a=r.getQuery();return this.expressionMap.createAlias({type:"from",name:n,subQuery:a})}}replacePropertyNames(t){return t}replacePropertyNamesForTheWholeQuery(t){const n={};for(const o of this.expressionMap.aliases){if(!o.hasMetadata)continue;const i=this.expressionMap.aliasNamePrefixingEnabled&&o.name?`${o.name}.`:"";n[i]||(n[i]={});for(const s of o.metadata.relations)s.joinColumns.length>0&&(n[i][s.propertyPath]=s.joinColumns[0].databaseName);for(const s of o.metadata.relations){const c=[...s.joinColumns,...s.inverseJoinColumns];for(const l of c){const u=`${s.propertyPath}.${l.referencedColumn.propertyPath}`;n[i][u]=l.databaseName}}for(const s of o.metadata.columns)n[i][s.databaseName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyPath]=s.databaseName}const r=Object.keys(n),a=r.map(o=>Sle(o)).join("|");return r.length>0&&(t=t.replace(new RegExp(`([ =(]|^.{0})${a?"("+a+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...o)=>{let i,s,c;if(a){if(i=o[0],s=o[1],c=o[3],n[o[2]][c])return`${s}${this.escape(o[2].substring(0,o[2].length-1))}.${this.escape(n[o[2]][c])}`}else if(i=o[0],s=o[1],c=o[2],n[""][c])return`${s}${this.escape(n[""][c])}`;return i})),t}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace(/\*\//g,"")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const t=[],n=this.createWhereClausesExpression(this.expressionMap.wheres);if(n.length>0&&n!=="1=1"&&t.push(this.replacePropertyNames(n)),this.expressionMap.mainAlias.hasMetadata){const a=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&a.deleteDateColumn){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.deleteDateColumn.propertyName:a.deleteDateColumn.propertyName,i=`${this.replacePropertyNames(o)} IS NULL`;t.push(i)}if(a.discriminatorColumn&&a.parentEntityMetadata){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.discriminatorColumn.databaseName:a.discriminatorColumn.databaseName,i=`${this.replacePropertyNames(o)} IN (:...discriminatorColumnValues)`;t.push(i)}}if(this.expressionMap.extraAppendedAndWhereCondition){const a=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);t.push(a)}let r="";return r+=this.createTimeTravelQuery(),t.length?t.length===1?r+=` WHERE ${t[0]}`:r+=` WHERE ( ${t.join(" ) AND ( ")} )`:r+="",r}createReturningExpression(t){const n=this.getReturningColumns(),r=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&r.isReturningSqlSupported(t)&&n.push(...this.expressionMap.extraReturningColumns.filter(a=>n.indexOf(a)===-1)),n.length){let a=n.map(o=>{const i=this.escape(o.databaseName);return r.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+i:this.escape(this.getMainTableName())+"."+i:i}).join(", ");return r.options.type==="oracle"&&(a+=" INTO "+n.map(o=>this.createParameter({type:r.columnTypeToNativeParameter(o.type),dir:r.oracle.BIND_OUT})).join(", ")),r.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(a+=" INTO @OutputTable"),a}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const t=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(n=>{this.expressionMap.mainAlias.hasMetadata&&t.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n))}),t}createWhereClausesExpression(t){return t.map((n,r)=>{const a=this.createWhereConditionExpression(n.condition);switch(n.type){case"and":return(r>0?"AND ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`;case"or":return(r>0?"OR ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`}return a}).join(" ").trim()}createWhereConditionExpression(t,n=!1){if(typeof t=="string")return t;if(Array.isArray(t))return t.length===0?"1=1":t.length===1&&!n?this.createWhereClausesExpression(t):"("+this.createWhereClausesExpression(t)+")";const{driver:r}=this.connection;switch(t.operator){case"lessThan":return`${t.parameters[0]} < ${t.parameters[1]}`;case"lessThanOrEqual":return`${t.parameters[0]} <= ${t.parameters[1]}`;case"arrayContains":return`${t.parameters[0]} @> ${t.parameters[1]}`;case"jsonContains":return`${t.parameters[0]} ::jsonb @> ${t.parameters[1]}`;case"arrayContainedBy":return`${t.parameters[0]} <@ ${t.parameters[1]}`;case"arrayOverlap":return`${t.parameters[0]} && ${t.parameters[1]}`;case"moreThan":return`${t.parameters[0]} > ${t.parameters[1]}`;case"moreThanOrEqual":return`${t.parameters[0]} >= ${t.parameters[1]}`;case"notEqual":return`${t.parameters[0]} != ${t.parameters[1]}`;case"equal":return`${t.parameters[0]} = ${t.parameters[1]}`;case"ilike":return r.options.type==="postgres"||r.options.type==="cockroachdb"?`${t.parameters[0]} ILIKE ${t.parameters[1]}`:`UPPER(${t.parameters[0]}) LIKE UPPER(${t.parameters[1]})`;case"like":return`${t.parameters[0]} LIKE ${t.parameters[1]}`;case"between":return`${t.parameters[0]} BETWEEN ${t.parameters[1]} AND ${t.parameters[2]}`;case"in":return t.parameters.length<=1?"0=1":`${t.parameters[0]} IN (${t.parameters.slice(1).join(", ")})`;case"any":return r.options.type==="cockroachdb"?`${t.parameters[0]}::STRING = ANY(${t.parameters[1]}::STRING[])`:`${t.parameters[0]} = ANY(${t.parameters[1]})`;case"isNull":return`${t.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(t.condition)})`;case"brackets":return`${this.createWhereConditionExpression(t.condition,!0)}`;case"and":return"("+t.parameters.join(" AND ")+")";case"or":return"("+t.parameters.join(" OR ")+")"}throw new TypeError(`Unsupported FindOperator ${td.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const t=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(n=>{const r=typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.getQuery();if(typeof n.queryBuilder!="string"){if(n.queryBuilder.hasCommonTableExpressions())throw new xe(`Nested CTEs aren't supported (CTE: ${n.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!Ct.isSelectQueryBuilder(n.queryBuilder))throw new xe(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${n.alias})`);this.setParameters(n.queryBuilder.getParameters())}let a=this.escape(n.alias);if(n.options.columnNames){const s=n.options.columnNames.map(c=>this.escape(c));if(Ct.isSelectQueryBuilder(n.queryBuilder)&&n.queryBuilder.expressionMap.selects.length&&n.options.columnNames.length!==n.queryBuilder.expressionMap.selects.length)throw new xe(`cte.options.columnNames length (${n.options.columnNames.length}) doesn't match subquery select list length ${n.queryBuilder.expressionMap.selects.length} (CTE: ${n.alias})`);a+=`(${s.join(", ")})`}const o=n.options.recursive&&t?"RECURSIVE":"";let i="";return this.connection.driver.cteCapabilities.materializedHint&&n.options.materialized!==void 0&&(i=n.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[o,a,"AS",i,`(${r})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(t){const n=this.expressionMap.mainAlias.metadata,r=(Array.isArray(t)?t:[t]).map(a=>n.ensureEntityIdMap(a));if(!n.hasMultiplePrimaryKeys){const a=n.primaryColumns[0];if(!a.transformer&&!a.relationMetadata&&!a.embeddedMetadata)return{[a.propertyName]:Ca(r.map(o=>a.getEntityValue(o,!1)))}}return new k4(a=>{for(const o of r)a.orWhere(new k4(i=>i.where(o)))})}getExistsCondition(t){const n=t.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${n.getQuery()})`,n.getParameters()]}findColumnsForPropertyPath(t){let n=this.expressionMap.mainAlias;const r=[],a=t.split(".");for(;a.length>1;){const s=a[0];if(!(n!=null&&n.hasMetadata))break;if(n.metadata.hasEmbeddedWithPropertyPath(s)){a.unshift(`${a.shift()}.${a.shift()}`);continue}if(n.metadata.hasRelationWithPropertyPath(s)){const c=this.expressionMap.joinAttributes.find(l=>l.relationPropertyPath===s);if(!(c!=null&&c.alias)){const l=r.length>0?`${r.join(".")}.${s}`:s;throw new Error(`Cannot find alias for relation at ${l}`)}n=c.alias,r.push(...s.split(".")),a.shift();continue}break}if(!n)throw new Error(`Cannot find alias for property ${t}`);const o=a.join("."),i=n.metadata.findColumnsWithPropertyPath(o);if(!i.length)throw new Ea(t,n.metadata);return[n,r,i]}createPropertyPath(t,n,r=""){const a=[];for(const o of Object.keys(n)){const i=r?`${r}.${o}`:o;if(n[o]===null||typeof n[o]!="object"||Ct.isFindOperator(n[o])){a.push(i);continue}if(t.hasEmbeddedWithPropertyPath(i)){const s=this.createPropertyPath(t,n[o],i);a.push(...s);continue}if(t.hasRelationWithPropertyPath(i)){const s=t.findRelationWithPropertyPath(i);if(s.relationType==="one-to-one"||s.relationType==="many-to-one"){const u=s.joinColumns.map(d=>d.referencedColumn).filter(d=>!!d);if(u.length>0&&u.every(d=>d.getEntityValue(n[o],!1))){a.push(i);continue}}if(s.relationType==="one-to-many"||s.relationType==="many-to-many")throw new Error(`Cannot query across ${s.relationType} for property ${i}`);const c=s.inverseEntityMetadata.primaryColumns;if(c.length>0&&c.every(u=>u.getEntityValue(n[o],!1))){const u=c.map(d=>`${i}.${d.propertyPath}`);a.push(...u);continue}const l=this.createPropertyPath(s.inverseEntityMetadata,n[o]).map(u=>`${i}.${u}`);a.push(...l);continue}a.push(i)}return a}*getPredicates(t){if(this.expressionMap.mainAlias.hasMetadata){const n=this.createPropertyPath(this.expressionMap.mainAlias.metadata,t);for(const r of n){const[a,o,i]=this.findColumnsForPropertyPath(r);for(const s of i){let c=t;for(const d of o){if(!c||!(d in c)){c={};break}c=c[d]}const l=this.expressionMap.aliasNamePrefixingEnabled?`${a.name}.${s.propertyPath}`:s.propertyPath,u=s.getEntityValue(c,!0);yield[l,u]}}}else for(const n of Object.keys(t)){const r=t[n];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${n}`:n,r]}}getWherePredicateCondition(t,n){if(Ct.isFindOperator(n)){let r=[];if(n.useParameter)if(n.objectLiteralParameters)this.setParameters(n.objectLiteralParameters);else if(n.multipleParameters)for(const a of n.value)r.push(this.createParameter(a));else r.push(this.createParameter(n.value));if(n.type==="raw")return n.getSql?n.getSql(t):{operator:"equal",parameters:[t,n.value]};if(n.type==="not")return n.child?{operator:n.type,condition:this.getWherePredicateCondition(t,n.child)}:{operator:"notEqual",parameters:[t,...r]};if(n.type==="and"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else if(n.type==="or"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else return{operator:n.type,parameters:[t,...r]}}else return{operator:"equal",parameters:[t,this.createParameter(n)]}}getWhereCondition(t){if(typeof t=="string")return t;if(Ct.isBrackets(t)){const a=this.createQueryBuilder();return a.parentQueryBuilder=this,a.expressionMap.mainAlias=this.expressionMap.mainAlias,a.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,a.expressionMap.parameters=this.expressionMap.parameters,a.expressionMap.nativeParameters=this.expressionMap.nativeParameters,a.expressionMap.wheres=[],t.whereFactory(a),{operator:Ct.isNotBrackets(t)?"not":"brackets",condition:a.expressionMap.wheres}}if(typeof t=="function")return t(this);const n=Array.isArray(t)?t:[t],r=[];for(const a of n){const o=[];for(const[i,s]of this.getPredicates(a))o.push({type:"and",condition:this.getWherePredicateCondition(i,s)});r.push({type:"or",condition:o})}return r.length===1?r[0].condition:r}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}Ut.queryBuilderRegistry={};class Ele{static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class Ole extends Ut{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("DeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createDeleteExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("BeforeRemove",this.expressionMap.mainAlias.metadata);const o=await r.query(t,n,!0),i=Ele.from(o);return this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("AfterRemove",this.expressionMap.mainAlias.metadata),a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}finally{r!==this.queryRunner&&await r.release()}}from(t,n){t=Ct.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("delete"))throw new Fh;return this.expressionMap.returning=t,this}createDeleteExpression(){const t=this.getTableName(this.getMainTableName()),n=this.createWhereExpression(),r=this.createReturningExpression("delete");return r===""?`DELETE FROM ${t}${n}`:this.connection.driver.options.type==="mssql"?`DELETE FROM ${t} OUTPUT ${r}${n}`:`DELETE FROM ${t}${n} RETURNING ${r}`}}let Bh;const Cle=new Uint8Array(16);function Nle(){if(!Bh&&(Bh=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Bh))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Bh(Cle)}const gn=[];for(let e=0;e<256;++e)gn.push((e+256).toString(16).slice(1));function Mle(e,t=0){return gn[e[t+0]]+gn[e[t+1]]+gn[e[t+2]]+gn[e[t+3]]+"-"+gn[e[t+4]]+gn[e[t+5]]+"-"+gn[e[t+6]]+gn[e[t+7]]+"-"+gn[e[t+8]]+gn[e[t+9]]+"-"+gn[e[t+10]]+gn[e[t+11]]+gn[e[t+12]]+gn[e[t+13]]+gn[e[t+14]]+gn[e[t+15]]}const Ple=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),A4={randomUUID:Ple};function kle(e,t,n){if(A4.randomUUID&&!t&&!e)return A4.randomUUID();e=e||{};const r=e.random||(e.rng||Nle)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Mle(r)}class T4{constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}class I4{constructor(){this.identifiers=[],this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.raw,n}}class t_{constructor(t,n){this.queryRunner=t,this.expressionMap=n}async update(t,n){const r=this.expressionMap.mainAlias.metadata;await Promise.all(n.map(async(a,o)=>{if(this.queryRunner.connection.driver.isReturningSqlSupported("update")){this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((c,l,u)=>(c[this.expressionMap.extraReturningColumns[u].databaseName]=l[0],c),{}));const i=Array.isArray(t.raw)?t.raw[o]:t.raw,s=this.queryRunner.connection.driver.createGeneratedMap(r,i);s&&(this.queryRunner.manager.merge(r.target,a,s),t.generatedMaps.push(s))}else{const i=this.expressionMap.extraReturningColumns;if(i.length>0){const s=this.expressionMap.mainAlias.metadata.getEntityIdMap(a);if(!s)throw new xe("Cannot update entity because entity id is not set in the entity.");const c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(i.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).withDeleted().setOption("create-pojo").getOne();c&&(this.queryRunner.manager.merge(r.target,a,c),t.generatedMaps.push(c))}}}))}async insert(t,n){const r=this.expressionMap.mainAlias.metadata;let a=r.getInsertionReturningColumns();const o=this.queryRunner.connection.driver.isReturningSqlSupported("insert");a=a.filter(s=>s.isGenerated?o===!0:!0);const i=n.map((s,c)=>{this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((d,p,f)=>(d[this.expressionMap.extraReturningColumns[f].databaseName]=p[0],d),{}));const l=Array.isArray(t.raw)?t.raw[c]:t.raw,u=this.queryRunner.connection.driver.createGeneratedMap(r,l,c,n.length)||{};return c in this.expressionMap.locallyGenerated&&this.queryRunner.manager.merge(r.target,u,this.expressionMap.locallyGenerated[c]),this.queryRunner.manager.merge(r.target,s,u),u});if(a.length>0&&!this.queryRunner.connection.driver.isReturningSqlSupported("insert")){const s=n.map(l=>{const u=r.getEntityIdMap(l);if(!u)throw new xe("Cannot update entity because entity id is not set in the entity.");return u}),c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(a.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).setOption("create-pojo").getMany();n.forEach((l,u)=>{this.queryRunner.manager.merge(r.target,i[u],c[u]),this.queryRunner.manager.merge(r.target,l,c[u])})}n.forEach((s,c)=>{const l=r.getEntityIdMap(s);t.identifiers.push(l),t.generatedMaps.push(i[c])})}getUpdationReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion)}getSoftDeletionReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion||t.isDeleteDate)}}class Ale extends Ut{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("InsertQueryBuilder")}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createInsertExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.getValueSets();if(t.length===0)return new I4;const n=this.obtainQueryRunner();let r=!1;try{if(this.expressionMap.useTransaction===!0&&n.isTransactionActive===!1&&(await n.startTransaction(),r=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const f=new T4;t.forEach(y=>{n.broadcaster.broadcastBeforeInsertEvent(f,this.expressionMap.mainAlias.metadata,y)}),await f.wait()}let a=null,o=null;const i=new t_(n,this.expressionMap),s=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const f of this.expressionMap.returning)s.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(f));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&(t.length>1&&this.connection.driver.options.type==="oracle"||(this.expressionMap.extraReturningColumns=this.expressionMap.mainAlias.metadata.getInsertionReturningColumns()),s.push(...this.expressionMap.extraReturningColumns.filter(f=>!s.includes(f)))),s.length>0&&this.connection.driver.options.type==="mssql"&&(a=this.connection.driver.buildTableVariableDeclaration("@OutputTable",s),o="SELECT * FROM @OutputTable");const[c,l]=this.getQueryAndParameters(),u=[a,c,o].filter(f=>f!=null).join(`;

`),d=await n.query(u,l,!0),p=I4.from(d);if(this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&await i.insert(p,t),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const f=new T4;t.forEach(y=>{n.broadcaster.broadcastAfterInsertEvent(f,this.expressionMap.mainAlias.metadata,y)}),await f.wait()}return r&&await n.commitTransaction(),p}catch(a){if(r)try{await n.rollbackTransaction()}catch{}throw a}finally{n!==this.queryRunner&&await n.release()}}into(t,n){t=Ct.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t);return this.expressionMap.setMainAlias(r),this.expressionMap.insertColumns=n||[],this}values(t){return this.expressionMap.valuesSet=t,this}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("insert"))throw new Fh;return this.expressionMap.returning=t,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}onConflict(t){return this.expressionMap.onConflict=t,this}orIgnore(t=!0){return this.expressionMap.onIgnore=!!t,this}orUpdate(t,n,r){return Array.isArray(t)?(this.expressionMap.onUpdate={overwrite:t,conflict:n,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,indexPredicate:r==null?void 0:r.indexPredicate,upsertType:r==null?void 0:r.upsertType},this):(this.expressionMap.onUpdate={conflict:t==null?void 0:t.conflict_target,columns:t==null?void 0:t.columns,overwrite:t==null?void 0:t.overwrite,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,upsertType:r==null?void 0:r.upsertType},this)}createInsertExpression(){var i,s;const t=this.getTableName(this.getMainTableName()),n=this.createValuesExpression(),r=this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1?null:this.createReturningExpression("insert"),a=this.createColumnNamesExpression();let o="INSERT ";if(((i=this.expressionMap.onUpdate)==null?void 0:i.upsertType)==="primary-key"&&(o="UPSERT "),(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+=`${this.expressionMap.onIgnore?" IGNORE ":""}`),o+=`INTO ${t}`,this.alias!==this.getMainTableName()&&ve.isPostgresFamily(this.connection.driver)&&(o+=` AS "${this.alias}"`),a?o+=`(${a})`:!n&&(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+="()"),r&&this.connection.driver.options.type==="mssql"&&(o+=` OUTPUT ${r}`),n?(this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="sap")&&this.getValueSets().length>1?o+=` ${n}`:o+=` VALUES ${n}`:ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"?o+=" VALUES ()":o+=" DEFAULT VALUES",((s=this.expressionMap.onUpdate)==null?void 0:s.upsertType)!=="primary-key"){if(this.connection.driver.supportedUpsertTypes.includes("on-conflict-do-update")){if(this.expressionMap.onIgnore)o+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)o+=` ON CONFLICT ${this.expressionMap.onConflict} `;else if(this.expressionMap.onUpdate){const{overwrite:c,columns:l,conflict:u,skipUpdateIfNoValuesChanged:d,indexPredicate:p}=this.expressionMap.onUpdate;let f="ON CONFLICT";if(Array.isArray(u)){if(f+=` ( ${u.map(m=>this.escape(m)).join(", ")} )`,p&&!ve.isPostgresFamily(this.connection.driver))throw new xe("indexPredicate option is not supported by the current database driver");p&&ve.isPostgresFamily(this.connection.driver)&&(f+=` WHERE ( ${p} )`)}else u&&(f+=` ON CONSTRAINT ${this.escape(u)}`);const y=[];Array.isArray(c)?y.push(...c.map(m=>`${this.escape(m)} = EXCLUDED.${this.escape(m)}`)):l&&y.push(...l.map(m=>`${this.escape(m)} = :${m}`)),y.length>0&&(o+=` ${f} DO UPDATE SET `,y.push(...this.expressionMap.mainAlias.metadata.columns.filter(m=>m.isUpdateDate&&!(c!=null&&c.includes(m.databaseName))&&!(this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")).map(m=>`${this.escape(m.databaseName)} = DEFAULT`)),o+=y.join(", "),o+=" "),Array.isArray(c)&&d&&ve.isPostgresFamily(this.connection.driver)&&(o+=" WHERE (",o+=c.map(m=>`${t}.${this.escape(m)} IS DISTINCT FROM EXCLUDED.${this.escape(m)}`).join(" OR "),o+=") ")}}else if(this.connection.driver.supportedUpsertTypes.includes("on-duplicate-key-update")){if(this.expressionMap.onUpdate){const{overwrite:c,columns:l}=this.expressionMap.onUpdate;Array.isArray(c)?(o+=" ON DUPLICATE KEY UPDATE ",o+=c.map(u=>`${this.escape(u)} = VALUES(${this.escape(u)})`).join(", "),o+=" "):Array.isArray(l)&&(o+=" ON DUPLICATE KEY UPDATE ",o+=l.map(u=>`${this.escape(u)} = :${u}`).join(", "),o+=" ")}}else if(this.expressionMap.onUpdate)throw new xe("onUpdate is not supported by the current database driver")}return r&&(ve.isPostgresFamily(this.connection.driver)||this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="cockroachdb"||ve.isMySQLFamily(this.connection.driver))&&(o+=` RETURNING ${r}`),this.connection.driver.options.type==="mssql"&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter(c=>this.expressionMap.insertColumns.length>0?this.expressionMap.insertColumns.indexOf(c.propertyPath)!==-1:c.isInsert).some(c=>this.isOverridingAutoIncrementBehavior(c))&&(o=`SET IDENTITY_INSERT ${t} ON; ${o}; SET IDENTITY_INSERT ${t} OFF`),o}getInsertedColumns(){return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter(t=>this.expressionMap.insertColumns.length?this.expressionMap.insertColumns.indexOf(t.propertyPath)!==-1:!(!t.isInsert||t.isGenerated&&t.generationStrategy==="increment"&&this.connection.driver.options.type!=="spanner"&&this.connection.driver.options.type!=="oracle"&&!ve.isSQLiteFamily(this.connection.driver)&&!ve.isMySQLFamily(this.connection.driver)&&this.connection.driver.options.type!=="aurora-mysql"&&!(this.connection.driver.options.type==="mssql"&&this.isOverridingAutoIncrementBehavior(t)))):[]}createColumnNamesExpression(){const t=this.getInsertedColumns();if(t.length>0)return t.map(n=>this.escape(n.databaseName)).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){const n=this.getValueSets();if(n.length===1)return Object.keys(n[0]).map(r=>this.escape(r)).join(", ")}return this.expressionMap.insertColumns.map(n=>this.escape(n)).join(", ")}createValuesExpression(){const t=this.getValueSets(),n=this.getInsertedColumns();if(n.length>0){let r="";return t.forEach((a,o)=>{n.forEach((i,s)=>{s===0&&(this.connection.driver.options.type==="oracle"&&t.length>1||this.connection.driver.options.type==="sap"&&t.length>1?r+=" SELECT ":r+="(");let c=i.getEntityValue(a);if(typeof c!="function"&&(c=this.connection.driver.preparePersistentValue(c,i)),i.isVersion&&c===void 0)r+="1";else if(i.isDiscriminator)r+=this.createParameter(this.expressionMap.mainAlias.metadata.discriminatorValue);else if(i.isGenerated&&i.generationStrategy==="uuid"&&!this.connection.driver.isUUIDGenerationSupported()&&c===void 0)c=kle(),r+=this.createParameter(c),o in this.expressionMap.locallyGenerated||(this.expressionMap.locallyGenerated[o]={}),i.setEntityValue(this.expressionMap.locallyGenerated[o],c);else if(c===void 0)this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?i.default!==void 0&&i.default!==null?r+=this.connection.driver.normalizeDefault(i):r+="NULL":r+="DEFAULT";else if(c===null&&this.connection.driver.options.type==="spanner")r+="NULL";else if(typeof c=="function")r+=c();else{this.connection.driver.options.type==="mssql"&&(c=this.connection.driver.parametrizeValue(i,c));const l=this.createParameter(c);if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1){const u=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";i.srid!=null?r+=`${u}(${l}, ${i.srid})`:r+=`${u}(${l})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?i.srid!=null?r+=`ST_SetSRID(ST_GeomFromGeoJSON(${l}), ${i.srid})::${i.type}`:r+=`ST_GeomFromGeoJSON(${l})::${i.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?r+=i.type+"::STGeomFromText("+l+", "+(i.srid||"0")+")":r+=l}s===n.length-1?o===t.length-1?this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy ":r+=")":this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL UNION ALL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy UNION ALL ":r+="), ":r+=", "})}),r==="()"?"":r}else{let r="";return t.forEach((a,o)=>{Object.keys(a).forEach((i,s)=>{s===0&&(r+="(");const c=a[i];typeof c=="function"?r+=c():c===void 0?this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?r+="NULL":r+="DEFAULT":c===null&&this.connection.driver.options.type==="spanner"||(r+=this.createParameter(c)),s===Object.keys(a).length-1?o===t.length-1?r+=")":r+="), ":r+=", "})}),r==="()"?"":r}}getValueSets(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(Jt.isObject(this.expressionMap.valuesSet))return[this.expressionMap.valuesSet];throw new lle}isOverridingAutoIncrementBehavior(t){return t.isPrimary&&t.isGenerated&&t.generationStrategy==="increment"&&this.getValueSets().some(n=>t.getEntityValue(n)!==void 0&&t.getEntityValue(n)!==null)}}class R4{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async update(t){const n=this.expressionMap.relationMetadata;if(n.isManyToOne||n.isOneToOneOwner){const r=n.joinColumns.reduce((a,o)=>{const i=Jt.isObject(t)?o.referencedColumn.getEntityValue(t):t;return o.setEntityValue(a,i),a},{});if(!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length)return;await this.queryBuilder.createQueryBuilder().update(n.entityMetadata.target).set(r).whereInIds(this.expressionMap.of).execute()}else if((n.isOneToOneNotOwner||n.isOneToMany)&&t===null){const r={};n.inverseRelation.joinColumns.forEach(c=>{r[c.propertyName]=null});const a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o={},i=[];a.forEach((c,l)=>{n.inverseRelation.joinColumns.map((u,d)=>{const p="joinColumn_"+l+"_"+d;o[p]=Jt.isObject(c)?u.referencedColumn.getEntityValue(c):c,i.push(`${u.propertyPath} = :${p}`)})});const s=i.map(c=>"("+c+")").join(" OR ");if(!s)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(r).where(s).setParameters(o).execute()}else if(n.isOneToOneNotOwner||n.isOneToMany){if(Array.isArray(this.expressionMap.of))throw new xe("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");const r=this.expressionMap.of,a=n.inverseRelation.joinColumns.reduce((o,i)=>{const s=Jt.isObject(r)?i.referencedColumn.getEntityValue(r):r;return i.setEntityValue(o,s),o},{});if(!t||Array.isArray(t)&&!t.length)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(a).whereInIds(t).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c=[];if(i.forEach(l=>{s.forEach(u=>{const d={};r.ownerColumns.forEach(p=>{d[p.databaseName]=Jt.isObject(l)?p.referencedColumn.getEntityValue(l):l}),r.inverseColumns.forEach(p=>{d[p.databaseName]=Jt.isObject(u)?p.referencedColumn.getEntityValue(u):u}),c.push(d)})}),!c.length)return;this.queryBuilder.connection.driver.options.type==="oracle"||this.queryBuilder.connection.driver.options.type==="sap"?await Promise.all(c.map(l=>this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(l).execute())):await this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(c).execute()}}}class Tle{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async remove(t){const n=this.expressionMap.relationMetadata;if(n.isOneToMany){const r=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],a=Array.isArray(t)?t:[t],o={};n.inverseRelation.joinColumns.forEach(l=>{o[l.propertyName]=null});const i={},s=[];r.forEach((l,u)=>{s.push(...a.map((d,p)=>[...n.inverseRelation.joinColumns.map((f,y)=>{const m="joinColumn_"+u+"_"+p+"_"+y;return i[m]=Jt.isObject(l)?f.referencedColumn.getEntityValue(l):l,`${f.propertyPath} = :${m}`}),...n.inverseRelation.entityMetadata.primaryColumns.map((f,y)=>{const m="primaryColumn_"+p+"_"+p+"_"+y;return i[m]=Jt.isObject(d)?f.getEntityValue(d):d,`${f.propertyPath} = :${m}`})].join(" AND ")))});const c=s.map(l=>"("+l+")").join(" OR ");if(!c)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(o).where(c).setParameters(i).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c={},l=[];i.forEach((d,p)=>{l.push(...s.map((f,y)=>[...r.ownerColumns.map((m,v)=>{const b="firstValue_"+p+"_"+y+"_"+v;return c[b]=Jt.isObject(d)?m.referencedColumn.getEntityValue(d):d,`${m.databaseName} = :${b}`}),...r.inverseColumns.map((m,v)=>{const b="secondValue_"+p+"_"+y+"_"+v;return c[b]=Jt.isObject(f)?m.referencedColumn.getEntityValue(f):f,`${m.databaseName} = :${b}`})].join(" AND ")))});const u=l.map(d=>"("+d+")").join(" OR ");await this.queryBuilder.createQueryBuilder().delete().from(r.tableName).where(u).setParameters(c).execute()}}}class Ile extends Ut{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("RelationQueryBuilder")}getQuery(){return""}of(t){return this.expressionMap.of=t,this}async set(t){const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToMany||n.isOneToMany)throw new xe(`Set operation is only supported for many-to-one and one-to-one relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .add() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!Jt.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new R4(this,this.expressionMap).update(t)}async add(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!Jt.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new R4(this,this.expressionMap).update(t)}async remove(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set(null) method instead.`);return new Tle(this,this.expressionMap).remove(t)}async addAndRemove(t,n){await this.remove(n),await this.add(t)}async loadOne(){return this.loadMany().then(t=>t[0])}async loadMany(){let t=this.expressionMap.of;if(!Jt.isObject(t)){const n=this.expressionMap.mainAlias.metadata;if(n.hasMultiplePrimaryKeys)throw new xe("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");t=n.primaryColumns[0].createValueMap(t)}return this.connection.relationLoader.load(this.expressionMap.relationMetadata,t,this.queryRunner)}}class vn{static chunk(t,n){return Array.from(Array(Math.ceil(t.length/n)),(r,a)=>t.slice(a*n,a*n+n))}static splitClassesAndStrings(t){return[t.filter(n=>typeof n!="string"),t.filter(n=>typeof n=="string")]}static groupBy(t,n){return t.reduce((r,a)=>{const o=n(a);let i=r.find(s=>s.id===o);return i||(i={id:o,items:[]},r.push(i)),i.items.push(a),r},[])}static uniq(t,n){return t.reduce((r,a)=>{let o=!1;if(typeof n=="function"){const i=n(a);o=!!r.find(s=>n(s)===i)}else typeof n=="string"?o=!!r.find(i=>i[n]===a[n]):o=r.indexOf(a)!==-1;return o||r.push(a),r},[])}static isPlainObject(t){return t==null?!1:!t.constructor||t.constructor===Object}static mergeArrayKey(t,n,r,a){if(a.has(r)){t[n]=a.get(r);return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){t[n]=r;return}t[n]||(t[n]=Array.isArray(r)?[]:{}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static mergeObjectKey(t,n,r,a){if(a.has(r)){Object.assign(t,{[n]:a.get(r)});return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){Object.assign(t,{[n]:r});return}t[n]||Object.assign(t,{[n]:Array.isArray(r)?[]:{}}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static merge(t,n,r=new Map){if(this.isPlainObject(t)&&this.isPlainObject(n))for(const a of Object.keys(n))a!=="__proto__"&&this.mergeObjectKey(t,a,n[a],r);if(Array.isArray(t)&&Array.isArray(n))for(let a=0;a<n.length;a++)this.mergeArrayKey(t,a,n[a],r)}static mergeDeep(t,...n){if(!n.length)return t;for(const r of n)vn.merge(t,r);return t}static deepCompare(...t){let n,r,a,o;if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(a=[],o=[],!this.compare2Objects(a,o,arguments[0],arguments[n]))return!1;return!0}static deepValue(t,n){const r=n.split(".");for(let a=0,o=r.length;a<o;a++)t=t[r[a]];return t}static replaceEmptyObjectsWithBooleans(t){for(let n in t)t[n]&&typeof t[n]=="object"&&(Object.keys(t[n]).length===0?t[n]=!0:this.replaceEmptyObjectsWithBooleans(t[n]))}static propertyPathsToTruthyObject(t){let n={};for(let r of t){const a=r.split(".");if(!a.length)continue;(!n[a[0]]||n[a[0]]===!0)&&(n[a[0]]={});let o=n[a[0]];for(let[i,s]of a.entries())i!==0&&(o[s]?o=o[s]:i===a.length-1?(o[s]={},o=null):(o[s]={},o=o[s]))}return this.replaceEmptyObjectsWithBooleans(n),n}static compareIds(t,n){return t==null||n===void 0||n===null?!1:(typeof t.id=="string"&&typeof n.id=="string"||typeof t.id=="number"&&typeof n.id=="number")&&Object.keys(t).length===1&&Object.keys(n).length===1?t.id===n.id:vn.deepCompare(t,n)}static toBoolean(t){return typeof t=="boolean"?t:typeof t=="string"?t==="true"||t==="1":typeof t=="number"?t>0:!1}static zipObject(t,n){return t.reduce((r,a,o)=>(r[a]=n[o],r),{})}static isArraysEqual(t,n){return t.length!==n.length?!1:t.every(r=>n.indexOf(r)!==-1)}static areMutuallyExclusive(...t){return!t.some(n=>{const r=t.filter(a=>a!==n);return n.some(a=>r.some(o=>o.includes(a)))})}static parseSqlCheckExpression(t,n){const r=t.match(new RegExp(`"${n}" varchar CHECK\\s*\\(\\s*"${n}"\\s+IN\\s*`));if(r&&r.index){const a=t.substring(r.index+r[0].length);let o="",i="";const s=[];for(let c=0;c<a.length;c++){const l=a[c];switch(l){case",":o==""?(s.push(i),i=""):i+=l;break;case"'":o==l?a[c+1]===l?(i+=l,c+=1):o="":o=l;break;case")":if(o=="")return s.push(i),s;i+=l;break;default:o!=""&&(i+=l)}}}}static compare2Objects(t,n,r,a){let o;if(Number.isNaN(r)&&Number.isNaN(a)||r===a)return!0;if(r===null||a===null||r===void 0||a===void 0)return!1;if((typeof r.equals=="function"||typeof r.equals=="function")&&r.equals(a))return!0;if(typeof r=="function"&&typeof a=="function"||r instanceof Date&&a instanceof Date||r instanceof RegExp&&a instanceof RegExp||typeof r=="string"&&typeof a=="string"||typeof r=="number"&&typeof a=="number")return r.toString()===a.toString();if(!(typeof r=="object"&&typeof a=="object")||Object.prototype.isPrototypeOf.call(r,a)||Object.prototype.isPrototypeOf.call(a,r)||r.constructor!==a.constructor||r.prototype!==a.prototype||t.indexOf(r)>-1||n.indexOf(a)>-1)return!1;for(o in a)if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;for(o in r){if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;switch(typeof r[o]){case"object":case"function":if(t.push(r),n.push(a),!this.compare2Objects(t,n,r[o],a[o]))return!1;t.pop(),n.pop();break;default:if(r[o]!==a[o])return!1;break}}return!0}}class Rle{constructor(t,n,r,a,o){this.expressionMap=t,this.driver=n,this.rawRelationIdResults=r,this.rawRelationCountResults=a,this.queryRunner=o}transform(t,n){const r=this.group(t,n),a=[];return r.forEach(o=>{const i=this.transformRawResultsGroup(o,n);i!==void 0&&!Object.values(i).every(s=>s===null)&&a.push(i)}),a}group(t,n){const r=new Map,a=[];return n.metadata.tableType==="view"?a.push(...n.metadata.columns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))):a.push(...n.metadata.primaryColumns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))),t.forEach(o=>{const i=a.map(c=>{const l=o[c];return pa.isBuffer(l)?l.toString("hex"):Jt.isObject(l)?JSON.stringify(l):l}).join("_"),s=r.get(i);s?s.push(o):r.set(i,[o])}),r}transformRawResultsGroup(t,n){let r=n.metadata;if(r.discriminatorColumn){const l=t.map(d=>d[ve.buildAlias(this.driver,void 0,n.name,n.metadata.discriminatorColumn.databaseName)]),u=r.childEntityMetadatas.find(d=>typeof l.find(p=>p===d.discriminatorValue)<"u");u&&(r=u)}let a=r.create(this.queryRunner,{fromDeserializer:!0,pojo:this.expressionMap.options.indexOf("create-pojo")!==-1});const o=this.transformColumns(t,n,a,r),i=this.transformJoins(t,a,n,r),s=this.transformRelationIds(t,n,a,r),c=this.transformRelationCounts(t,n,a);if(o||r.primaryColumns.filter(l=>l.isVirtual===!1).length===0&&(i||s||c))return a}transformColumns(t,n,r,a){let o=!1;return a.columns.forEach(i=>{if(a.childEntityMetadatas.length>0&&a.childEntityMetadatas.findIndex(c=>c.target===i.target)!==-1)return;const s=t[0][ve.buildAlias(this.driver,void 0,n.name,i.databaseName)];s===void 0||i.isVirtual||this.expressionMap.selects.find(c=>c.selection===n.name||c.selection===n.name+"."+i.propertyPath)&&(i.setEntityValue(r,this.driver.prepareHydratedValue(s,i)),s!==null&&(o=!0))}),o}transformJoins(t,n,r,a){let o=!1;return this.expressionMap.joinAttributes.forEach(i=>{if(!i.metadata||!i.isSelected||i.relation&&!a.relations.find(c=>c===i.relation))return;if(i.mapToProperty){if(i.mapToPropertyParentAlias!==r.name)return}else if(!i.relation||i.parentAlias!==r.name||i.relationPropertyPath!==i.relation.propertyPath)return;let s=this.transform(t,i.alias);s=i.isMany?s:s[0],s=!i.isMany&&s===void 0?null:s,s!==void 0&&(i.mapToPropertyPropertyName?n[i.mapToPropertyPropertyName]=s:i.relation.setEntityValue(n,s),o=!0)}),o}transformRelationIds(t,n,r,a){let o=!1;return this.rawRelationIdResults.forEach((i,s)=>{if(i.relationIdAttribute.parentAlias!==n.name)return;const c=i.relationIdAttribute.relation,l=this.createValueMapFromJoinColumns(c,i.relationIdAttribute.parentAlias,t);if(l==null)return;this.prepareDataForTransformRelationIds();const u=this.hashEntityIds(c,l),d=this.relationIdMaps[s][u]||[],p=i.relationIdAttribute.mapToPropertyPropertyPath.split("."),f=(y,m,v)=>{const b=y.shift();if(b&&y.length===0)return m[b]=v,m;if(b&&y.length>0)f(y,m[b],v);else return m};c.isOneToOne||c.isManyToOne?d[0]!==void 0&&(f(p,r,d[0]),o=!0):(f(p,r,d),o=o||d.length>0)}),o}transformRelationCounts(t,n,r){let a=!1;return this.rawRelationCountResults.filter(o=>o.relationCountAttribute.parentAlias===n.name).forEach(o=>{const i=o.relationCountAttribute.relation;let s;i.isOneToMany?s=i.inverseRelation.joinColumns[0].referencedColumn.databaseName:s=i.isOwning?i.joinColumns[0].referencedColumn.databaseName:i.inverseRelation.joinColumns[0].referencedColumn.databaseName;const c=t[0][ve.buildAlias(this.driver,void 0,n.name,s)];c!=null&&(r[o.relationCountAttribute.mapToPropertyPropertyName]=0,o.results.filter(l=>l.parentId===c).forEach(l=>{r[o.relationCountAttribute.mapToPropertyPropertyName]=parseInt(l.cnt),a=!0}))}),a}createValueMapFromJoinColumns(t,n,r){let a;return t.isManyToOne||t.isOneToOneOwner?a=t.entityMetadata.primaryColumns.map(o=>o):t.isOneToMany||t.isOneToOneNotOwner?a=t.inverseRelation.joinColumns.map(o=>o):t.isOwning?a=t.joinColumns.map(o=>o):a=t.inverseRelation.inverseJoinColumns.map(o=>o),a.reduce((o,i)=>(r.forEach(s=>{t.isManyToOne||t.isOneToOneOwner?o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.databaseName)],i):o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.referencedColumn.databaseName)],i.referencedColumn)}),o),{})}extractEntityPrimaryIds(t,n){let r;return t.isManyToOne||t.isOneToOneOwner?r=t.entityMetadata.primaryColumns.map(a=>a):t.isOneToMany||t.isOneToOneNotOwner?r=t.inverseRelation.joinColumns.map(a=>a):t.isOwning?r=t.joinColumns.map(a=>a):r=t.inverseRelation.inverseJoinColumns.map(a=>a),r.reduce((a,o)=>(a[o.databaseName]=n[o.databaseName],a),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(t=>{const n=t.relationIdAttribute.relation;let r;return n.isManyToOne||n.isOneToOneOwner?r=n.joinColumns:n.isOneToMany||n.isOneToOneNotOwner?r=n.inverseEntityMetadata.primaryColumns:n.isOwning?r=n.inverseJoinColumns:r=n.inverseRelation.joinColumns,t.results.reduce((a,o)=>{let i=r.reduce((s,c)=>{let l=o[c.databaseName];return n.isOneToMany||n.isOneToOneNotOwner?(c.isVirtual&&c.referencedColumn&&c.referencedColumn.propertyName!==c.propertyName&&(l=c.referencedColumn.createValueMap(l)),vn.mergeDeep(s,c.createValueMap(l))):(!c.isPrimary&&c.referencedColumn.referencedColumn&&(l=c.referencedColumn.referencedColumn.createValueMap(l)),vn.mergeDeep(s,c.referencedColumn.createValueMap(l)))},{});if(r.length===1&&!t.relationIdAttribute.disableMixedMap&&(n.isOneToMany||n.isOneToOneNotOwner?i=r[0].getEntityValue(i):i=r[0].referencedColumn.getEntityValue(i)),i!==void 0){const s=this.hashEntityIds(n,o);a[s]?a[s].push(i):a[s]=[i]}return a},{})}))}hashEntityIds(t,n){const r=this.extractEntityPrimaryIds(t,n);return JSON.stringify(r)}}let Dle=class{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}async load(e){const t=this.relationIdAttributes.map(async n=>{if(n.relation.isManyToOne||n.relation.isOneToOneOwner){if(n.queryBuilderFactory)throw new xe("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const r={},a=e.map(o=>{const i={},s=[];n.relation.joinColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l.referencedColumn);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),n.relation.entityMetadata.primaryColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),s.sort();const c=s.join("::");return r[c]?null:(r[c]=!0,i)}).filter(o=>o);return{relationIdAttribute:n,results:a}}else if(n.relation.isOneToMany||n.relation.isOneToOneNotOwner){const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.joinColumns,o=r.inverseEntityMetadata.target,i=r.inverseEntityMetadata.tableName,s=n.alias||i,c={},l={},u=e.map((f,y)=>{const m=[],v={},b=a.map(_=>{const x=_.databaseName+y,j=f[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,_.referencedColumn.databaseName)],S=`${s}:${_.propertyPath}:${j}`;return m.indexOf(S)!==-1?"":(m.push(S),v[x]=j,s+"."+_.propertyPath+" = :"+x)}).filter(_=>_).join(" AND ");m.sort();const w=m.join("::");return c[w]?"":(c[w]=!0,Object.assign(l,v),b)}).filter(f=>f).map(f=>"("+f+")").join(" OR ");if(!u)return{relationIdAttribute:n,results:[]};const d=this.connection.createQueryBuilder(this.queryRunner);vn.uniq([...a,...r.inverseRelation.entityMetadata.primaryColumns],f=>f.propertyPath).forEach(f=>{d.addSelect(s+"."+f.propertyPath,f.databaseName)}),d.from(o,s).where("("+u+")").setParameters(l),n.queryBuilderFactory&&n.queryBuilderFactory(d);const p=await d.getRawMany();return p.forEach(f=>{a.forEach(y=>{f[y.databaseName]=this.connection.driver.prepareHydratedValue(f[y.databaseName],y.referencedColumn)}),r.inverseRelation.entityMetadata.primaryColumns.forEach(y=>{f[y.databaseName]=this.connection.driver.prepareHydratedValue(f[y.databaseName],y)})}),{relationIdAttribute:n,results:p}}else{const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.inverseJoinColumns,o=r.isOwning?r.inverseJoinColumns:r.inverseRelation.joinColumns,i=n.junctionAlias,s=n.joinInverseSideMetadata.tableName,c=n.alias||s,l=r.isOwning?r.junctionEntityMetadata.tableName:r.inverseRelation.junctionEntityMetadata.tableName,u=e.map(w=>a.reduce((_,x)=>(_[x.propertyPath]=w[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,x.referencedColumn.databaseName)],_),{}));if(u.length===0)return{relationIdAttribute:n,results:[]};const d={},p={},f=u.map((w,_)=>{const x=[],j={},S=Object.keys(w).map(O=>{const N=O+_,M=w[O],P=`${i}:${O}:${M}`;return x.indexOf(P)!==-1?"":(x.push(P),j[N]=M,i+"."+O+" = :"+N)}).filter(O=>O).join(" AND ");x.sort();const E=x.join("::");return p[E]?"":(p[E]=!0,Object.assign(d,j),S)}).filter(w=>w),y=o.map(w=>i+"."+w.propertyPath+" = "+c+"."+w.referencedColumn.propertyPath).join(" AND "),m=f.map(w=>"("+w+" AND "+y+")").join(" OR "),v=this.connection.createQueryBuilder(this.queryRunner);o.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),a.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),v.from(s,c).innerJoin(l,i,m).setParameters(d),n.queryBuilderFactory&&n.queryBuilderFactory(v);const b=await v.getRawMany();return b.forEach(w=>{[...a,...o].forEach(_=>{w[_.databaseName]=this.connection.driver.prepareHydratedValue(w[_.databaseName],_.referencedColumn)})}),{relationIdAttribute:n,results:b}}});return Promise.all(t)}};class Lle{constructor(t,n){this.connection=t,this.queryRunner=n}load(t,n,r){const a=Array.isArray(n)?n:[n],o=Array.isArray(r)?r:r?[r]:void 0;return t.isManyToMany?this.loadForManyToMany(t,a,o):t.isManyToOne||t.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(t,a,o):this.loadForOneToManyAndOneToOneNotOwner(t,a,o)}async loadManyToManyRelationIdsAndGroup(t,n,r,a){const o=t.isManyToMany||t.isOneToMany,i=Array.isArray(n)?n:[n];if(!r&&(r=await this.connection.relationLoader.load(t,n,this.queryRunner,a),!r.length))return i.map(d=>({entity:d,related:o?[]:void 0}));const s=await this.load(t,n,r),c=Array.isArray(r)?r:[r];let l=[],u=[];return t.isManyToManyOwner?(l=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn)):t.isManyToManyNotOwner?(l=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn)):t.isManyToOne||t.isOneToOneOwner?(l=t.joinColumns.map(d=>d.referencedColumn),u=t.entityMetadata.primaryColumns):(t.isOneToMany||t.isOneToOneNotOwner)&&(l=t.inverseRelation.entityMetadata.primaryColumns,u=t.inverseRelation.joinColumns.map(d=>d.referencedColumn)),i.map(d=>{const p={entity:d,related:o?[]:void 0},f=s.filter(y=>u.every(m=>m.compareEntityValue(d,y[m.entityMetadata.name+"_"+m.propertyAliasName])));return f.length&&c.forEach(y=>{f.forEach(m=>{l.every(v=>v.compareEntityValue(y,m[ve.buildAlias(this.connection.driver,void 0,v.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+v.propertyPath.replace(".","_"))]))&&(o?p.related.push(y):p.related=y)})}),p})}loadForManyToMany(t,n,r){const a=t.junctionEntityMetadata,o=a.name,i=t.isOwning?a.ownerColumns:a.inverseColumns,s=t.isOwning?a.inverseColumns:a.ownerColumns,c=this.connection.createQueryBuilder(this.queryRunner);i.forEach(p=>{const f=ve.buildAlias(this.connection.driver,void 0,p.referencedColumn.entityMetadata.name+"_"+p.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+p.propertyPath,f)}),s.forEach(p=>{const f=ve.buildAlias(this.connection.driver,void 0,p.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+p.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+p.propertyPath,f)});let l="";if(i.length===1){const p=n.map(f=>i[0].referencedColumn.getEntityValue(f));p.every(f=>typeof f=="number")?l=`${o}.${i[0].propertyPath} IN (${p.join(", ")})`:(c.setParameter("values1",p),l=o+"."+i[0].propertyPath+" IN (:...values1)")}else l="("+n.map((p,f)=>i.map(y=>{const m="entity1_"+f+"_"+y.propertyName;return c.setParameter(m,y.referencedColumn.getEntityValue(p)),o+"."+y.propertyPath+" = :"+m}).join(" AND ")).map(p=>"("+p+")").join(" OR ")+")";let u="";if(r)if(s.length===1){const p=r.map(f=>s[0].referencedColumn.getEntityValue(f));p.every(f=>typeof f=="number")?u=`${o}.${s[0].propertyPath} IN (${p.join(", ")})`:(c.setParameter("values2",p),u=o+"."+s[0].propertyPath+" IN (:...values2)")}else u="("+r.map((p,f)=>s.map(y=>{const m="entity2_"+f+"_"+y.propertyName;return c.setParameter(m,y.referencedColumn.getEntityValue(p)),o+"."+y.propertyPath+" = :"+m}).join(" AND ")).map(p=>"("+p+")").join(" OR ")+")";const d=[l,u].filter(p=>p.length>0).join(" AND ");return c.from(a.target,o).where(d).getRawMany()}loadForManyToOneAndOneToOneOwner(t,n,r){const a=t.entityMetadata.targetName,o=t.joinColumns.every(c=>!!t.entityMetadata.nonVirtualColumns.find(l=>l===c));if(r&&o){let c=[];if(n.forEach(l=>{let u={};t.entityMetadata.primaryColumns.forEach(d=>{const p=d.entityMetadata.name+"_"+d.propertyPath.replace(".","_");u[p]=d.getEntityValue(l)}),r.forEach(d=>{t.joinColumns.forEach(p=>{const f=p.getEntityValue(l),y=p.referencedColumn.getEntityValue(d);if(!(f===void 0||y===void 0)&&f===y){const m=p.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+p.referencedColumn.propertyPath.replace(".","_");u[m]=y}})}),Object.keys(u).length===t.entityMetadata.primaryColumns.length+t.joinColumns.length&&c.push(u)}),c.length===n.length)return Promise.resolve(c)}const i=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.entityMetadata.name+"_"+c.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)}),t.joinColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+c.referencedColumn.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)});let s="";if(t.entityMetadata.primaryColumns.length===1){const c=n.map(l=>t.entityMetadata.primaryColumns[0].getEntityValue(l));c.every(l=>typeof l=="number")?s=`${a}.${t.entityMetadata.primaryColumns[0].propertyPath} IN (${c.join(", ")})`:(i.setParameter("values",c),s=a+"."+t.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else s=n.map((c,l)=>t.entityMetadata.primaryColumns.map((u,d)=>{const p="entity"+l+"_"+d;return i.setParameter(p,u.getEntityValue(c)),a+"."+u.propertyPath+" = :"+p}).join(" AND ")).map(c=>"("+c+")").join(" OR ");return i.from(t.entityMetadata.target,a).where(s).getRawMany()}loadForOneToManyAndOneToOneNotOwner(t,n,r){if(t=t.inverseRelation,t.entityMetadata.primaryColumns.length===t.joinColumns.length&&t.entityMetadata.primaryColumns.every(s=>t.joinColumns.indexOf(s)!==-1))return Promise.resolve(n.map(s=>{const c={};return t.joinColumns.forEach(function(l){const u=l.referencedColumn.getEntityValue(s),d=l.referencedColumn.entityMetadata.name+"_"+l.referencedColumn.propertyPath.replace(".","_"),p=l.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+l.propertyPath.replace(".","_");c[d]=u,c[p]=u}),c}));const a=t.entityMetadata.targetName,o=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+s.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)}),t.joinColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.referencedColumn.entityMetadata.name+"_"+s.referencedColumn.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)});let i="";if(t.joinColumns.length===1){const s=n.map(c=>t.joinColumns[0].referencedColumn.getEntityValue(c));s.every(c=>typeof c=="number")?i=`${a}.${t.joinColumns[0].propertyPath} IN (${s.join(", ")})`:(o.setParameter("values",s),i=a+"."+t.joinColumns[0].propertyPath+" IN (:...values)")}else i=n.map((s,c)=>t.joinColumns.map((l,u)=>{const d="entity"+c+"_"+u;return o.setParameter(d,l.referencedColumn.getEntityValue(s)),a+"."+l.propertyPath+" = :"+d}).join(" AND ")).map(s=>"("+s+")").join(" OR ");return o.from(t.entityMetadata.target,a).where(i).getRawMany()}}class $le{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationIdAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationIds.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationIdAttributes.push(r)})})}metadataToAttribute(t,n){return new G1(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class Fle{constructor(t,n,r){this.connection=t,this.queryRunner=n,this.relationCountAttributes=r}async load(t){const n=(a,o,i)=>i.indexOf(a)===o,r=this.relationCountAttributes.map(async a=>{if(a.relation.isOneToMany){const o=a.relation,i=o.inverseRelation,s=i.joinColumns[0].referencedColumn.propertyName,c=o.inverseEntityMetadata.target,l=o.inverseEntityMetadata.tableName,u=a.alias||l,d=i.propertyName;let p=t.map(y=>y[a.parentAlias+"_"+s]).filter(y=>!!y);if(p=p.filter(n),p.length===0)return{relationCountAttribute:a,results:[]};const f=this.connection.createQueryBuilder(this.queryRunner);return f.select(u+"."+d,"parentId").addSelect("COUNT(*)","cnt").from(c,u).where(u+"."+d+" IN (:...ids)").addGroupBy(u+"."+d).setParameter("ids",p),a.queryBuilderFactory&&a.queryBuilderFactory(f),{relationCountAttribute:a,results:await f.getRawMany()}}else{let o,i,s,c;a.relation.isOwning?(o=a.relation.joinColumns[0].referencedColumn.databaseName,i=a.relation.inverseJoinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[0],c=a.relation.junctionEntityMetadata.columns[1]):(o=a.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,i=a.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[1],c=a.relation.junctionEntityMetadata.columns[0]);let l=t.map(v=>v[a.parentAlias+"_"+o]).filter(v=>!!v);if(l=l.filter(n),l.length===0)return{relationCountAttribute:a,results:[]};const u=a.junctionAlias,d=a.joinInverseSideMetadata.tableName,p=a.alias||d,f=a.relation.junctionEntityMetadata.tableName,y=u+"."+s.propertyName+" IN ("+l.map(v=>isNaN(v)?"'"+v+"'":v)+") AND "+u+"."+c.propertyName+" = "+p+"."+i,m=this.connection.createQueryBuilder(this.queryRunner);return m.select(u+"."+s.propertyName,"parentId").addSelect("COUNT("+m.escape(p)+"."+m.escape(i)+")","cnt").from(d,p).innerJoin(f,u,y).addGroupBy(u+"."+s.propertyName),a.queryBuilderFactory&&a.queryBuilderFactory(m),{relationCountAttribute:a,results:await m.getRawMany()}}});return Promise.all(r)}}class Ble{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationCountAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationCounts.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationCountAttributes.push(r)})})}metadataToAttribute(t,n){return new J1(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class n_{static isFindOneOptions(t){const n=t;return n&&(Array.isArray(n.select)||Array.isArray(n.relations)||typeof n.select=="object"||typeof n.relations=="object"||typeof n.where=="object"||typeof n.join=="object"||typeof n.order=="object"||typeof n.cache=="object"||typeof n.cache=="boolean"||typeof n.cache=="number"||typeof n.comment=="string"||typeof n.lock=="object"||typeof n.loadRelationIds=="object"||typeof n.loadRelationIds=="boolean"||typeof n.loadEagerRelations=="boolean"||typeof n.withDeleted=="boolean"||typeof n.relationLoadStrategy=="string"||typeof n.transaction=="boolean")}static isFindManyOptions(t){const n=t;return n&&(this.isFindOneOptions(n)||typeof n.skip=="number"||typeof n.take=="number"||typeof n.skip=="string"||typeof n.take=="string")}static extractFindManyOptionsAlias(t){if(this.isFindManyOptions(t)&&t.join)return t.join.alias}static applyOptionsToTreeQueryBuilder(t,n){if(n!=null&&n.relations){const r=[...n.relations];if(n_.applyRelationsRecursively(t,r,t.expressionMap.mainAlias.name,t.expressionMap.mainAlias.metadata,""),r.length>0)throw new ule(r)}return t}static applyRelationsRecursively(t,n,r,a,o){let i=[];if(o){const s=new RegExp("^"+o.replace(".","\\.")+"\\.");i=n.filter(c=>c.match(s)).map(c=>a.findRelationWithPropertyPath(c.replace(s,""))).filter(c=>c)}else i=n.map(s=>a.findRelationWithPropertyPath(s)).filter(s=>s);i.forEach(s=>{let c=ve.buildAlias(t.connection.driver,{joiner:"__"},r,s.propertyPath);const l=r+"."+s.propertyPath;t.expressionMap.relationLoadStrategy==="query"?t.concatRelationMetadata(s):t.leftJoinAndSelect(l,c),n.splice(n.indexOf(o?o+"."+s.propertyPath:s.propertyPath),1);let u,d;if(t.expressionMap.relationLoadStrategy==="query")u=s.inverseEntityMetadata,d=c;else{const p=t.expressionMap.joinAttributes.find(f=>f.entityOrProperty===l);u=p.metadata,d=p.alias.name}if(!d||!u)throw new Ea(s.propertyPath,a);if(this.applyRelationsRecursively(t,n,d,u,o?o+"."+s.propertyPath:s.propertyPath),t.expressionMap.relationLoadStrategy==="join"){const p=a.relations.find(f=>f.propertyName===s.propertyPath);p&&this.joinEagerRelations(t,c,p.inverseEntityMetadata)}})}static joinEagerRelations(t,n,r){r.eagerRelations.forEach(a=>{let o=ve.buildAlias(t.connection.driver,{joiner:"__"},n,a.propertyName),i=!0;for(const l of t.expressionMap.joinAttributes)if(!(l.condition!==void 0||l.mapToProperty!==void 0||l.isMappingMany!==void 0||l.direction!=="LEFT"||l.entityOrProperty!==`${n}.${a.propertyPath}`)){i=!1,o=l.alias.name;break}const s=!!t.expressionMap.joinAttributes.find(l=>l.alias.name===o);i&&!s&&t.leftJoin(n+"."+a.propertyPath,o);let c=!0;for(const l of t.expressionMap.selects)if(!(l.aliasName!==void 0||l.virtual!==void 0||l.selection!==o)){c=!1;break}c&&t.addSelect(o),this.joinEagerRelations(t,o,a.inverseEntityMetadata)})}}class r_ extends Ut{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createSelectExpression(),t+=this.createJoinExpression(),t+=this.createWhereExpression(),t+=this.createGroupByExpression(),t+=this.createHavingExpression(),t+=this.createOrderByExpression(),t+=this.createLimitOffsetExpression(),t+=this.createLockExpression(),t=t.trim(),this.expressionMap.subQuery&&(t="("+t+")"),this.replacePropertyNamesForTheWholeQuery(t)}setFindOptions(t){return this.findOptions=t,this.applyFindOptions(),this}subQuery(){const t=this.createQueryBuilder();return t.expressionMap.subQuery=!0,t.parentQueryBuilder=this,t}select(t,n){if(this.expressionMap.queryType="select",Array.isArray(t))this.expressionMap.selects=t.map(r=>({selection:r}));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]);return this}addSelect(t,n){if(!t)return this;if(Array.isArray(t))this.expressionMap.selects=this.expressionMap.selects.concat(t.map(r=>({selection:r})));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&this.expressionMap.selects.push({selection:t,aliasName:n});return this}maxExecutionTime(t){return this.expressionMap.maxExecutionTime=t,this}distinct(t=!0){return this.expressionMap.selectDistinct=t,this}distinctOn(t){return this.expressionMap.selectDistinctOn=t,this}fromDummy(){return this.from(this.connection.driver.dummyTableName??"(SELECT 1 AS dummy_column)","dummy_table")}from(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}addFrom(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this}innerJoin(t,n,r,a){return this.join("INNER",t,n,r,a),this}leftJoin(t,n,r,a){return this.join("LEFT",t,n,r,a),this}innerJoinAndSelect(t,n,r,a){return this.addSelect(n),this.innerJoin(t,n,r,a),this}leftJoinAndSelect(t,n,r,a){return this.addSelect(n),this.leftJoin(t,n,r,a),this}innerJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!0),this}innerJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!1,i),this}leftJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!0),this}leftJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!1,i),this}loadRelationIdAndMap(t,n,r,a){const o=new G1(this.expressionMap);return o.mapToProperty=t,o.relationName=n,typeof r=="string"&&(o.alias=r),typeof r=="object"&&r.disableMixedMap&&(o.disableMixedMap=!0),o.queryBuilderFactory=a,this.expressionMap.relationIdAttributes.push(o),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(t,n,r,a){const o=new J1(this.expressionMap);return o.mapToProperty=t,o.relationName=n,o.alias=r,o.queryBuilderFactory=a,this.expressionMap.relationCountAttributes.push(o),this.expressionMap.createAlias({type:"other",name:o.junctionAlias}),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadAllRelationIds(t){return this.expressionMap.mainAlias.metadata.relations.forEach(n=>{t!==void 0&&t.relations!==void 0&&t.relations.indexOf(n.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+n.propertyPath,this.expressionMap.mainAlias.name+"."+n.propertyPath,t)}),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereExists(t){return this.where(...this.getExistsCondition(t))}andWhereExists(t){return this.andWhere(...this.getExistsCondition(t))}orWhereExists(t){return this.orWhere(...this.getExistsCondition(t))}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}having(t,n){return this.expressionMap.havings.push({type:"simple",condition:t}),n&&this.setParameters(n),this}andHaving(t,n){return this.expressionMap.havings.push({type:"and",condition:t}),n&&this.setParameters(n),this}orHaving(t,n){return this.expressionMap.havings.push({type:"or",condition:t}),n&&this.setParameters(n),this}groupBy(t){return t?this.expressionMap.groupBys=[t]:this.expressionMap.groupBys=[],this}addGroupBy(t){return this.expressionMap.groupBys.push(t),this}timeTravelQuery(t){return this.connection.driver.options.type==="cockroachdb"&&(t===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=t),this}orderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){if(this.expressionMap.limit=this.normalizeNumber(t),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new xe('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(t){if(this.expressionMap.offset=this.normalizeNumber(t),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new xe('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(t){if(this.expressionMap.take=this.normalizeNumber(t),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new xe('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(t){if(this.expressionMap.skip=this.normalizeNumber(t),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new xe('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(t){return this.expressionMap.useIndex=t,this}setLock(t,n,r){return this.expressionMap.lockMode=t,this.expressionMap.lockVersion=n,this.expressionMap.lockTables=r,this}setOnLocked(t){return this.expressionMap.onLocked=t,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if(this.expressionMap.lockMode==="optimistic")throw new ed;this.expressionMap.queryEntity=!1;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0);const r=await this.loadRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getRawAndEntities(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getOne(){const t=(await this.getRawAndEntities()).entities[0];if(t&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const n=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const r=n.updateDateColumn.getEntityValue(t);if(r.getTime()!==this.expressionMap.lockVersion.getTime())throw new h4(n.name,this.expressionMap.lockVersion,r)}else{const r=n.versionColumn.getEntityValue(t);if(r!==this.expressionMap.lockVersion)throw new h4(n.name,this.expressionMap.lockVersion,r)}}return t===void 0?null:t}async getOneOrFail(){const t=await this.getOne();if(!t)throw new ile(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return t}async getMany(){if(this.expressionMap.lockMode==="optimistic")throw new ed;return(await this.getRawAndEntities()).entities}async getCount(){if(this.expressionMap.lockMode==="optimistic")throw new ed;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeCountQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getExists(){if(this.expressionMap.lockMode==="optimistic")throw new ed;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeExistsQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getManyAndCount(){if(this.expressionMap.lockMode==="optimistic")throw new ed;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);this.expressionMap.queryEntity=!1;const a=this.expressionMap.cacheId;this.expressionMap.cacheId=a&&`${a}-count`;const o=await this.executeCountQuery(t),i=[r.entities,o];return n&&await t.commitTransaction(),i}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async stream(){this.expressionMap.queryEntity=!1;const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0);const o=()=>{if(r!==this.queryRunner)return r.release()},i=r.stream(t,n,o,o);return a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}}cache(t,n){return typeof t=="boolean"?this.expressionMap.cache=t:typeof t=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=t):(typeof t=="string"||typeof t=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=t),n&&(this.expressionMap.cacheDuration=n),this}setOption(t){return this.expressionMap.options.push(t),this}join(t,n,r,a,o,i,s,c){o&&this.setParameters(o);const l=new P4(this.connection,this.expressionMap);l.direction=t,l.mapAsEntity=c,l.mapToProperty=i,l.isMappingMany=s,l.entityOrProperty=n,l.condition=a,this.expressionMap.joinAttributes.push(l);const u=l.metadata;if(u){if(u.deleteDateColumn&&!this.expressionMap.withDeleted){const d=`${r}.${u.deleteDateColumn.propertyName} IS NULL`;l.condition=l.condition?` ${l.condition} AND ${d}`:`${d}`}l.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:u}),l.relation&&l.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:l.junctionAlias,metadata:l.relation.junctionEntityMetadata})}else{let d="";if(typeof n=="function"){const f=n(this.subQuery());this.setParameters(f.getParameters()),d=f.getQuery()}else d=n;const p=typeof n=="function"||n.substr(0,1)==="("&&n.substr(-1)===")";l.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:p===!1?n:void 0,subQuery:p===!0?d:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new xe("Cannot build query because main alias is not set (call qb#from method)");const t=[],n=[];if(this.expressionMap.mainAlias.hasMetadata){const s=this.expressionMap.mainAlias.metadata;t.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,s)),n.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,s))}this.expressionMap.joinAttributes.forEach(s=>{if(s.metadata)t.push(...this.buildEscapedEntityColumnSelects(s.alias.name,s.metadata)),n.push(...this.findEntityColumnSelects(s.alias.name,s.metadata));else if(this.expressionMap.selects.some(c=>c.selection===s.alias.name)){t.push({selection:this.escape(s.alias.name)+".*"});const c=this.expressionMap.selects.find(l=>l.selection===s.alias.name);n.push(c)}}),this.expressionMap.selects.filter(s=>n.indexOf(s)===-1).forEach(s=>t.push({selection:this.replacePropertyNames(s.selection),aliasName:s.aliasName})),t.length===0&&t.push({selection:"*"});let r="";this.expressionMap.useIndex&&ve.isMySQLFamily(this.connection.driver)&&(r=` USE INDEX (${this.expressionMap.useIndex})`);const a=this.expressionMap.aliases.filter(s=>s.type==="from"&&(s.tablePath||s.subQuery)).map(s=>s.subQuery?s.subQuery+" "+this.escape(s.name):this.getTableName(s.tablePath)+" "+this.escape(s.name)),o=this.createSelectDistinctExpression(),i=t.map(s=>s.selection+(s.aliasName?" AS "+this.escape(s.aliasName):"")).join(", ");return o+i+" FROM "+a.join(", ")+this.createTableLockExpression()+r}createSelectDistinctExpression(){const{selectDistinct:t,selectDistinctOn:n,maxExecutionTime:r}=this.expressionMap,{driver:a}=this.connection;let o="SELECT ";return r>0&&ve.isMySQLFamily(a)&&(o+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),ve.isPostgresFamily(a)&&n.length>0?o=`SELECT DISTINCT ON (${n.map(i=>this.replacePropertyNames(i)).join(", ")}) `:t&&(o="SELECT DISTINCT "),o}createJoinExpression(){return this.expressionMap.joinAttributes.map(t=>{const n=t.relation,r=t.tablePath,a=t.alias.name;let o=t.condition?" AND ("+t.condition+")":"";const i=t.parentAlias;if(!i||!n){const s=t.alias.subQuery?t.alias.subQuery:this.getTableName(r);return" "+t.direction+" JOIN "+s+" "+this.escape(a)+this.createTableLockExpression()+(t.condition?" ON "+this.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){const s=n.joinColumns.map(c=>a+"."+c.referencedColumn.propertyPath+"="+i+"."+n.propertyPath+"."+c.referencedColumn.propertyPath).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else if(n.isOneToMany||n.isOneToOneNotOwner){const s=n.inverseRelation.joinColumns.map(c=>(n.inverseEntityMetadata.tableType==="entity-child"&&n.inverseEntityMetadata.discriminatorColumn&&(o+=" AND "+a+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),a+"."+n.inverseRelation.propertyPath+"."+c.referencedColumn.propertyPath+"="+i+"."+c.referencedColumn.propertyPath)).join(" AND ");if(!s)throw new xe(`Relation ${n.entityMetadata.name}.${n.propertyName} does not have join columns.`);return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else{const s=n.junctionEntityMetadata.tablePath,c=t.junctionAlias;let l="",u="";return n.isOwning?(l=n.joinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseJoinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND ")):(l=n.inverseRelation.inverseJoinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseRelation.joinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND "))," "+t.direction+" JOIN "+this.getTableName(s)+" "+this.escape(c)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l)+" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(u+o)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const t=this.expressionMap.allOrderBys;return Object.keys(t).length===0?"":" ORDER BY "+Object.keys(t).map(n=>{const r=typeof t[n]=="string"?t[n]:t[n].order+" "+t[n].nulls,a=this.expressionMap.selects.find(o=>o.selection===n);if(a&&!a.aliasName&&n.indexOf(".")!==-1){const o=n.split("."),i=o[0],s=o.slice(1).join("."),c=this.expressionMap.aliases.find(l=>l.name===i);if(c){const l=c.metadata.findColumnWithPropertyPath(s);if(l){const u=ve.buildAlias(this.connection.driver,void 0,i,l.databaseName);return this.escape(u)+" "+r}}}return this.replacePropertyNames(n)+" "+r}).join(", ")}createLimitOffsetExpression(){let t=this.expressionMap.offset,n=this.expressionMap.limit;if(!t&&!n&&this.expressionMap.joinAttributes.length===0&&(t=this.expressionMap.skip,n=this.expressionMap.take),this.connection.driver.options.type==="mssql"){let r="";if((n||t)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(r=" ORDER BY (SELECT NULL)"),n&&t)return r+" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return r+" OFFSET 0 ROWS FETCH NEXT "+n+" ROWS ONLY";if(t)return r+" OFFSET "+t+" ROWS"}else if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)throw new ple}else if(ve.isSQLiteFamily(this.connection.driver)){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" LIMIT -1 OFFSET "+t}else if(this.connection.driver.options.type==="oracle"){if(n&&t)return" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return" FETCH NEXT "+n+" ROWS ONLY";if(t)return" OFFSET "+t+" ROWS"}else{if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" OFFSET "+t}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const t=this.connection.driver;let n="";if(this.expressionMap.lockTables){if(!(ve.isPostgresFamily(t)||t.options.type==="cockroachdb"))throw new xe("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new xe("lockTables cannot be an empty array");n=" OF "+this.expressionMap.lockTables.join(", ")}let r="";switch(this.expressionMap.onLocked==="nowait"?r=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(r=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(t.options.type==="mysql"||t.options.type==="aurora-mysql")return ve.isReleaseVersionOrGreater(t,"8.0.0")?" FOR SHARE"+n+r:" LOCK IN SHARE MODE";if(t.options.type==="mariadb")return" LOCK IN SHARE MODE";if(ve.isPostgresFamily(t))return" FOR SHARE"+n+r;if(t.options.type==="oracle")return" FOR UPDATE";if(t.options.type==="mssql")return"";throw new pc;case"pessimistic_write":if(ve.isMySQLFamily(t)||t.options.type==="aurora-mysql"||t.options.type==="oracle")return" FOR UPDATE"+r;if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+r;if(t.options.type==="mssql")return"";throw new pc;case"pessimistic_partial_write":if(ve.isPostgresFamily(t))return" FOR UPDATE"+n+" SKIP LOCKED";if(ve.isMySQLFamily(t))return" FOR UPDATE SKIP LOCKED";throw new pc;case"pessimistic_write_or_fail":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+" NOWAIT";if(ve.isMySQLFamily(t))return" FOR UPDATE NOWAIT";throw new pc;case"for_no_key_update":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+n+r;throw new pc;case"for_key_share":if(ve.isPostgresFamily(t))return" FOR KEY SHARE"+n+r;throw new pc;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const t=this.expressionMap.havings.map((n,r)=>{switch(n.type){case"and":return(r>0?"AND ":"")+this.replacePropertyNames(n.condition);case"or":return(r>0?"OR ":"")+this.replacePropertyNames(n.condition);default:return this.replacePropertyNames(n.condition)}}).join(" ");return t.length?" HAVING "+t:""}buildEscapedEntityColumnSelects(t,n){const r=this.expressionMap.selects.some(l=>l.selection===t),a=[];if(r&&a.push(...n.columns.filter(l=>l.isSelect===!0)),a.push(...n.columns.filter(l=>this.expressionMap.selects.some(u=>u.selection===t+"."+l.propertyPath))),a.length===0)return[];const o=this.expressionMap.queryEntity?n.primaryColumns.filter(l=>a.indexOf(l)===-1):[],i=[...a,...o],s=[],c=this.escape(t);return i.forEach(l=>{let u=c+"."+this.escape(l.databaseName);l.isVirtualProperty&&l.query&&(u=`(${l.query(c)})`),this.connection.driver.spatialTypes.indexOf(l.type)!==-1&&((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(u=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${u})`),ve.isPostgresFamily(this.connection.driver)&&(l.precision?u=`ST_AsGeoJSON(${u}, ${l.precision})::json`:u=`ST_AsGeoJSON(${u})::json`),this.connection.driver.options.type==="mssql"&&(u=`${u}.ToString()`));const d=this.expressionMap.selects.filter(p=>p.selection===t+"."+l.propertyPath);if(d.length)d.forEach(p=>{s.push({selection:u,aliasName:p.aliasName?p.aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:p.virtual})});else{if(l.isVirtualProperty)return;s.push({selection:u,aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:r})}}),s}findEntityColumnSelects(t,n){const r=this.expressionMap.selects.find(a=>a.selection===t);return r?[r]:this.expressionMap.selects.filter(a=>n.columns.some(o=>a.selection===t+"."+o.propertyPath))}computeCountExpression(){const t=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(t);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||ve.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+"))";if(ve.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const a=n.map(o=>`${r}.${this.escape(o.databaseName)}`).join(", '|;|', ");return n.length===1?`COUNT(DISTINCT(${a}))`:`COUNT(DISTINCT(CONCAT(${a})))`}return this.connection.driver.options.type==="spanner"?n.length===1?`COUNT(DISTINCT(${r}.${this.escape(n[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${n.map(a=>`CAST(${r}.${this.escape(a.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(" || '|;|' || ")+"))"}async executeCountQuery(t){const n=this.computeCountExpression(),r=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(n,"cnt").setOption("disable-global-order").loadRawResults(t);return!r||!r[0]||!r[0].cnt?0:parseInt(r[0].cnt)}async executeExistsQuery(t){return(await this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(t)).length>0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const t=Array.isArray(this.findOptions.select)?vn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(t,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const t=Array.isArray(this.findOptions.relations)?vn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(t=>{t.select&&!t.selection?t.type==="inner"?this.innerJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):t.type==="inner"?this.innerJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(t=>{this.leftJoin(this.findOptions.join.leftJoin[t],t)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(t=>{this.innerJoin(this.findOptions.join.innerJoin[t],t)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(t=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[t],t)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(t=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[t],t)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const t=this.findOptions.lock.tables?this.findOptions.lock.tables.map(n=>{const r=this.expressionMap.aliases.find(a=>a.metadata.tableNameWithoutPrefix===n);if(!r)throw new xe(`"${n}" is not part of this query`);return this.escape(r.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,t),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&n_.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(t){this.relationMetadatas.push(t)}async executeEntitiesAndRawResults(t){if(!this.expressionMap.mainAlias)throw new xe('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!t.isTransactionActive)throw new dle;if(this.expressionMap.lockMode==="optimistic"){const i=this.expressionMap.mainAlias.metadata;if(!i.versionColumn&&!i.updateDateColumn)throw new cle(i.name)}const n=new Dle(this.connection,t,this.expressionMap.relationIdAttributes),r=new Fle(this.connection,t,this.expressionMap.relationCountAttributes);new $le(this.expressionMap).transform(),new Ble(this.expressionMap).transform();let a=[],o=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[i,s]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),c=this.expressionMap.mainAlias.metadata,l=this.expressionMap.mainAlias.name,u=c.primaryColumns.map(f=>{const y=this.escape("distinctAlias"),m=this.escape(ve.buildAlias(this.connection.driver,void 0,l,f.databaseName));s[m]||(s[m]="ASC");const v=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,f.databaseName);return`${y}.${m} AS ${this.escape(v)}`}),d=this.clone(),p=d.expressionMap.timeTravel;if(a=await new r_(this.connection,t).select(`DISTINCT ${u.join(", ")}`).addSelect(i).from(`(${d.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(p).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(s).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),a.length>0){let f="";const y={};if(c.hasMultiplePrimaryKeys)f=a.map((m,v)=>c.primaryColumns.map(b=>{const w=`orm_distinct_ids_${v}_${b.databaseName}`,_=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,b.databaseName);return y[w]=m[_],`${l}.${b.propertyPath}=:${w}`}).join(" AND ")).join(" OR ");else{const m=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,c.primaryColumns[0].databaseName),v=a.map(b=>b[m]);v.every(b=>typeof b=="number")?f=`${l}.${c.primaryColumns[0].propertyPath} IN (${v.join(", ")})`:(y.orm_distinct_ids=v,f=l+"."+c.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}a=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:f}).setParameters(y).loadRawResults(t)}}else a=await this.loadRawResults(t);if(a.length>0){const i=await n.load(a),s=await r.load(a);o=new Rle(this.expressionMap,this.connection.driver,i,s,this.queryRunner).transform(a,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,o)}if(this.expressionMap.relationLoadStrategy==="query"){const i=new Lle(this.connection,t);await Promise.all(this.relationMetadatas.map(async s=>{const c=s.inverseEntityMetadata.target,l=s.inverseEntityMetadata.targetName,u=Array.isArray(this.findOptions.select)?vn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,d=Array.isArray(this.findOptions.relations)?vn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,p=this.createQueryBuilder(t).select(l).from(c,l).setFindOptions({select:u?vn.deepValue(u,s.propertyPath):void 0,order:this.findOptions.order?vn.deepValue(this.findOptions.order,s.propertyPath):void 0,relations:d?vn.deepValue(d,s.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(o.length>0){const f=await i.loadManyToManyRelationIdsAndGroup(s,o,void 0,p);o.forEach(y=>{const m=f.find(v=>v.entity===y);if(m){const v=m.related===void 0?null:m.related;s.setEntityValue(y,v)}})}}))}return{raw:a,entities:o}}createOrderByCombinedWithSelectExpression(t){const n=this.expressionMap.allOrderBys,r=Object.keys(n).map(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);return this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))}else return this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?this.escape(t)+"."+this.escape(o):""}).join(", "),a={};return Object.keys(n).forEach(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);a[this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))]=n[o]}else this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?a[this.escape(t)+"."+this.escape(o)]=n[o]:a[o]=n[o]}),[r,a]}async loadRawResults(t){const[n,r]=this.getQueryAndParameters(),a=n+" -- PARAMETERS: "+JSON.stringify(r,(u,d)=>typeof d=="bigint"?d.toString():d),o=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let i;const s=o.alwaysEnabled&&this.expressionMap.cache!==!1||this.expressionMap.cache===!0;let c=!1;if(this.connection.queryResultCache&&s)try{if(i=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:a,duration:this.expressionMap.cacheDuration||o.duration||1e3},t),i&&!this.connection.queryResultCache.isExpired(i))return JSON.parse(i.result)}catch(u){if(!o.ignoreErrors)throw u;c=!0}const l=await t.query(n,r,!0);if(!c&&this.connection.queryResultCache&&s)try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:a,time:new Date().getTime(),duration:this.expressionMap.cacheDuration||o.duration||1e3,result:JSON.stringify(l.records)},i,t)}catch(u){if(!o.ignoreErrors)throw u}return l.records}mergeExpressionMap(t){return Jt.assign(this.expressionMap,t),this}normalizeNumber(t){return typeof t=="number"||t===void 0||t===null?t:Number(t)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner(this.connection.defaultReplicationModeForReads())}buildSelect(t,n,r,a){for(let o in t){if(t[o]===void 0||t[o]===!1)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Ea(i,n);s?this.selects.push(r+"."+i):c&&this.buildSelect(t[o],n,r,i)}}buildRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Ea(c,r);if(l)this.buildRelations(s,typeof n=="object"?vn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(u):(this.joins.push({type:"left",select:!0,selection:n&&typeof n[i]=="object"?n[i]:void 0,alias:d,parentAlias:a,relationMetadata:u}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d))),typeof s=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(s,typeof n=="object"?vn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildEagerRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Ea(c,r);if(l)this.buildEagerRelations(s,typeof n=="object"?vn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&u.inverseEntityMetadata.eagerRelations.forEach(p=>{let f=d+"_"+p.propertyPath.replace(".","_");f=ve.buildAlias(this.connection.driver,{joiner:"__"},d,f),this.joins.find(y=>y.alias===f)||this.joins.push({type:"left",select:!0,alias:f,parentAlias:d,selection:void 0,relationMetadata:p}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d)}),typeof s=="object"&&this.buildEagerRelations(s,typeof n=="object"?vn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildOrder(t,n,r,a){for(let o in t){if(t[o]===void 0)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Ea(i,n);if(s){let u=typeof t[o]=="object"?t[o].direction:t[o];u=u==="DESC"||u==="desc"||u===-1?"DESC":"ASC";let d=typeof t[o]=="object"?t[o].nulls:void 0;d=(d==null?void 0:d.toLowerCase())==="first"?"NULLS FIRST":(d==null?void 0:d.toLowerCase())==="last"?"NULLS LAST":void 0;let p=`${r}.${i}`;this.addOrderBy(p,u,d)}else if(c)this.buildOrder(t[o],n,r,i);else if(l){let u=r+"_"+i.replace(".","_");u=ve.buildAlias(this.connection.driver,{joiner:"__"},r,u),this.joins.find(d=>d.alias===u)||this.joins.push({type:"left",select:!1,alias:u,parentAlias:r,selection:void 0,relationMetadata:l}),this.buildOrder(t[o],l.inverseEntityMetadata,u)}}}buildWhere(t,n,r,a){let o="";if(Array.isArray(t))t.length&&(o=t.map(i=>this.buildWhere(i,n,r,a)).filter(i=>!!i).map(i=>"("+i+")").join(" OR "));else{let i=[];for(let s in t){if(t[s]===void 0||t[s]===null)continue;const c=a?a+"."+s:s,l=n.findColumnWithPropertyPathStrict(c),u=n.findEmbeddedWithPropertyPath(c),d=n.findRelationWithPropertyPath(c);if(!u&&!l&&!d)throw new Ea(c,n);if(l){let p=`${r}.${c}`;l.isVirtualProperty&&l.query&&(p=`(${l.query(r)})`);let f=t[s];Ct.isEqualOperator(t[s])&&(f=t[s].value),l.transformer&&(f instanceof td?f.transformValue(l.transformer):f=e_.transformTo(l.transformer,f)),i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(p,f)))}else if(u){const p=this.buildWhere(t[s],n,r,c);p&&i.push(p)}else if(d){if(typeof t[s]=="object"&&Object.keys(t[s]).every(p=>t[s][p]===void 0))continue;if(Ct.isFindOperator(t[s]))if(t[s].type==="moreThan"||t[s].type==="lessThan"||t[s].type==="moreThanOrEqual"||t[s].type==="lessThanOrEqual"){let p="";t[s].type==="moreThan"?p=">":t[s].type==="lessThan"?p="<":t[s].type==="moreThanOrEqual"?p=">=":t[s].type==="lessThanOrEqual"&&(p="<=");const f=this.subQuery();if(d.isManyToManyOwner)f.select("COUNT(*)").from(d.joinTableName,d.joinTableName).where(d.joinColumns.map(y=>`${d.joinTableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else if(d.isManyToManyNotOwner)f.select("COUNT(*)").from(d.inverseRelation.joinTableName,d.inverseRelation.joinTableName).where(d.inverseRelation.inverseJoinColumns.map(y=>`${d.inverseRelation.joinTableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else if(d.isOneToMany)f.select("COUNT(*)").from(d.inverseEntityMetadata.target,d.inverseEntityMetadata.tableName).where(d.inverseRelation.joinColumns.map(y=>`${d.inverseEntityMetadata.tableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(f.getSql()+" "+p+" "+parseInt(t[s].value))}else if(d.isManyToOne||d.isOneToOne&&d.isOneToOneOwner){const p=`${r}.${c}`;i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(p,t[s])))}else throw new Error("This relation isn't supported by given find operator");else{let p=r+"_"+d.propertyPath.replace(".","_");p=ve.buildAlias(this.connection.driver,{joiner:"__"},r,p),this.joins.find(y=>y.alias===p)||this.joins.push({type:"left",select:!1,selection:void 0,alias:p,parentAlias:r,relationMetadata:d});const f=this.buildWhere(t[s],d.inverseEntityMetadata,p);f&&i.push(f)}}}o=i.length?"("+i.join(") AND (")+")":i.join(" AND ")}return o.length?"("+o+")":o}}class D4{constructor(){this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class zle extends Ut{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("SoftDeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createUpdateExpression();return t+=this.createCteExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("BeforeSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("BeforeRecover",this.expressionMap.mainAlias.metadata));const r=new t_(t,this.expressionMap);this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=r.getSoftDeletionReturningColumns());const[a,o]=this.getQueryAndParameters(),i=await t.query(a,o,!0),s=D4.from(i);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await r.update(s,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("AfterSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("AfterRecover",this.expressionMap.mainAlias.metadata)),n&&await t.commitTransaction(),s}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}from(t,n){t=Ct.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new Fh;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!t)throw new xe(`Cannot get entity metadata for the given alias "${this.expressionMap.mainAlias}"`);if(!t.deleteDateColumn)throw new sle(t);const n=[];switch(this.expressionMap.queryType){case"soft-delete":n.push(this.escape(t.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":n.push(this.escape(t.deleteDateColumn.databaseName)+" = NULL");break;default:throw new xe('The queryType must be "soft-delete" or "restore"')}if(t.versionColumn&&n.push(this.escape(t.versionColumn.databaseName)+" = "+this.escape(t.versionColumn.databaseName)+" + 1"),t.updateDateColumn&&n.push(this.escape(t.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),n.length<=0)throw new B1;const r=this.createWhereExpression(),a=this.createReturningExpression("update");return a===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")} OUTPUT ${a}${r}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r} RETURNING ${a}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver))return" LIMIT "+t;throw new m4}return""}}class Vle extends Ut{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("UpdateQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createUpdateExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("BeforeUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet);let r=null,a=null;const o=new t_(t,this.expressionMap),i=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const p of this.expressionMap.returning)i.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(p));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=o.getUpdationReturningColumns(),i.push(...this.expressionMap.extraReturningColumns.filter(p=>!i.includes(p)))),i.length>0&&this.connection.driver.options.type==="mssql"&&(r=this.connection.driver.buildTableVariableDeclaration("@OutputTable",i),a="SELECT * FROM @OutputTable");const[s,c]=this.getQueryAndParameters(),l=[r,s,a],u=await t.query(l.filter(p=>p!=null).join(`;

`),c,!0),d=D4.from(u);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await o.update(d,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("AfterUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),n&&await t.commitTransaction(),d}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}set(t){return this.expressionMap.valuesSet=t,this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new Fh;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.getValueSet(),n=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,r={};for(let c in t)t[c]!==void 0&&(r[c]=t[c]);const a=[],o=[];if(n?(this.createPropertyPath(n,r).forEach(c=>{const l=n.findColumnsWithPropertyPath(c);if(l.length<=0)throw new Ea(c,n);l.forEach(u=>{if(!u.isUpdate||o.includes(u))return;o.push(u);let d=u.getEntityValue(r);if(u.referencedColumn&&typeof d=="object"&&!(d instanceof Date)&&d!==null&&!pa.isBuffer(d)?d=u.referencedColumn.getEntityValue(d):typeof d!="function"&&(d=this.connection.driver.preparePersistentValue(d,u)),typeof d=="function")a.push(this.escape(u.databaseName)+" = "+d());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&d===null)a.push(this.escape(u.databaseName)+" = NULL");else{this.connection.driver.options.type==="mssql"&&(d=this.connection.driver.parametrizeValue(u,d));const p=this.createParameter(d);let f=null;if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1){const y=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";u.srid!=null?f=`${y}(${p}, ${u.srid})`:f=`${y}(${p})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?u.srid!=null?f=`ST_SetSRID(ST_GeomFromGeoJSON(${p}), ${u.srid})::${u.type}`:f=`ST_GeomFromGeoJSON(${p})::${u.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?f=u.type+"::STGeomFromText("+p+", "+(u.srid||"0")+")":f=p;a.push(this.escape(u.databaseName)+" = "+f)}})}),(a.length>0||Object.keys(r).length===0)&&(n.versionColumn&&o.indexOf(n.versionColumn)===-1&&a.push(this.escape(n.versionColumn.databaseName)+" = "+this.escape(n.versionColumn.databaseName)+" + 1"),n.updateDateColumn&&o.indexOf(n.updateDateColumn)===-1&&a.push(this.escape(n.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"))):Object.keys(r).map(c=>{let l=r[c];if(typeof l=="function")a.push(this.escape(c)+" = "+l());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&l===null)a.push(this.escape(c)+" = NULL");else{const u=this.createParameter(l);a.push(this.escape(c)+" = "+u)}}),a.length<=0)throw new B1;const i=this.createWhereExpression(),s=this.createReturningExpression("update");return s===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")} OUTPUT ${s}${i}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i} RETURNING ${s}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")return" LIMIT "+t;throw new m4}return""}getValueSet(){if(typeof this.expressionMap.valuesSet=="object")return this.expressionMap.valuesSet;throw new B1}}function Wle(){Ut.registerQueryBuilderClass("DeleteQueryBuilder",e=>new Ole(e)),Ut.registerQueryBuilderClass("InsertQueryBuilder",e=>new Ale(e)),Ut.registerQueryBuilderClass("RelationQueryBuilder",e=>new Ile(e)),Ut.registerQueryBuilderClass("SelectQueryBuilder",e=>new r_(e)),Ut.registerQueryBuilderClass("SoftDeleteQueryBuilder",e=>new zle(e)),Ut.registerQueryBuilderClass("UpdateQueryBuilder",e=>new Vle(e))}var L4;(function(e){e.VIEW="VIEW",e.MATERIALIZED_VIEW="MATERIALIZED_VIEW",e.GENERATED_COLUMN="GENERATED_COLUMN"})(L4||(L4={}));var a_={exports:{}},o_,$4;function Ule(){if($4)return o_;$4=1;var e=1e3,t=e*60,n=t*60,r=n*24,a=r*7,o=r*365.25;o_=function(u,d){d=d||{};var p=typeof u;if(p==="string"&&u.length>0)return i(u);if(p==="number"&&isFinite(u))return d.long?c(u):s(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function i(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var p=parseFloat(d[1]),f=(d[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return p*o;case"weeks":case"week":case"w":return p*a;case"days":case"day":case"d":return p*r;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*t;case"seconds":case"second":case"secs":case"sec":case"s":return p*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function s(u){var d=Math.abs(u);return d>=r?Math.round(u/r)+"d":d>=n?Math.round(u/n)+"h":d>=t?Math.round(u/t)+"m":d>=e?Math.round(u/e)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=r?l(u,d,r,"day"):d>=n?l(u,d,n,"hour"):d>=t?l(u,d,t,"minute"):d>=e?l(u,d,e,"second"):u+" ms"}function l(u,d,p,f){var y=d>=p*1.5;return Math.round(u/p)+" "+f+(y?"s":"")}return o_}var i_,F4;function qle(){if(F4)return i_;F4=1;function e(t){r.debug=r,r.default=r,r.coerce=l,r.disable=i,r.enable=o,r.enabled=s,r.humanize=Ule(),r.destroy=u,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function n(d){let p=0;for(let f=0;f<d.length;f++)p=(p<<5)-p+d.charCodeAt(f),p|=0;return r.colors[Math.abs(p)%r.colors.length]}r.selectColor=n;function r(d){let p,f=null,y,m;function v(...b){if(!v.enabled)return;const w=v,_=Number(new Date),x=_-(p||_);w.diff=x,w.prev=p,w.curr=_,p=_,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let j=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(S,E)=>{if(S==="%%")return"%";j++;const O=r.formatters[E];if(typeof O=="function"){const N=b[j];S=O.call(w,N),b.splice(j,1),j--}return S}),r.formatArgs.call(w,b),(w.log||r.log).apply(w,b)}return v.namespace=d,v.useColors=r.useColors(),v.color=r.selectColor(d),v.extend=a,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(y!==r.namespaces&&(y=r.namespaces,m=r.enabled(d)),m),set:b=>{f=b}}),typeof r.init=="function"&&r.init(v),v}function a(d,p){const f=r(this.namespace+(typeof p>"u"?":":p)+d);return f.log=this.log,f}function o(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let p;const f=(typeof d=="string"?d:"").split(/[\s,]+/),y=f.length;for(p=0;p<y;p++)f[p]&&(d=f[p].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...r.names.map(c),...r.skips.map(c).map(p=>"-"+p)].join(",");return r.enable(""),d}function s(d){if(d[d.length-1]==="*")return!0;let p,f;for(p=0,f=r.skips.length;p<f;p++)if(r.skips[p].test(d))return!1;for(p=0,f=r.names.length;p<f;p++)if(r.names[p].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return i_=e,i_}var B4;function Hle(){return B4||(B4=1,function(e,t){var n={};t.formatArgs=a,t.save=o,t.load=i,t.useColors=r,t.storage=s(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,p=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(d++,f==="%c"&&(p=d))}),l.splice(p,0,u)}t.log=console.debug||console.log||(()=>{});function o(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function i(){let l;try{l=t.storage.getItem("debug")}catch{}return!l&&typeof Ka<"u"&&"env"in Ka&&(l=n.DEBUG),l}function s(){try{return localStorage}catch{}}e.exports=qle()(t);const{formatters:c}=e.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(a_,a_.exports)),a_.exports}Hle(),Wle();const z4=(e,t)=>({id:e.id,type:e.node_type,position:{x:e.x||0,y:e.y||0},width:e.width||void 0,height:e.height||void 0,data:{loading:!1,flowNode:e,...t}}),Kle=e=>({id:e.id,target:e.target,source:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),V4=e=>({id:e.id,source:e.source,target:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),Zle=e=>e.filter(t=>"edgeId"in t?`${t.edgeId}`.startsWith("xy-edge__"):!1),s_=(e,t,n)=>{const r=[];return{changes:e.map(a=>{var c;const o=t.find(l=>a.id===l.id);o||r.push(a.id);const i=(c=n==null?void 0:n[a.source_type])==null?void 0:c.find(l=>(l==null?void 0:l.id)===a.source_id),s=z4(a,{...o==null?void 0:o.data,entity:i});return{type:o?"replace":"add",id:a.id,item:o?$h({...o||{},data:void 0},ku(s,Au)):s}}),newIds:[]}},c_=(e,t)=>{const n=[],r=[],a=e.map(o=>{const i=t.find(s=>o.source===s.source&&o.target===s.target);return!i||i.id!==o.id?(i&&r.push(i.id),{type:"add",item:V4(o)}):(n.push(o.id),{type:"replace",item:V4(o)})});return t.forEach(o=>{n.includes(o.id)||r.push(o.id)}),{changes:a,updatedIds:n,deletedIds:r}},l_={width:440,height:360},zh={width:380,height:650},nd={[oe.Toolbox]:"toolbox",[oe.SessionInfo]:"session-info",[oe.DefaultEmbeddingModel]:"default-embedding-model",[oe.ApplicationBar]:"application-bar"},Xle={id:nd[oe.Toolbox],type:oe.Toolbox,position:{x:10+zh.width+20,y:10},measured:l_,data:{}},Qle={id:nd[oe.SessionInfo],type:oe.SessionInfo,position:{x:10,y:10},measured:zh,data:{}},Gle={id:nd[oe.DefaultEmbeddingModel],type:oe.DefaultEmbeddingModel,position:{x:10+zh.width+l_.width+40,y:10},data:{model:bAe}},Jle={id:nd[oe.ApplicationBar],type:oe.ApplicationBar,position:{x:10+zh.width+l_.width+40,y:80},data:{}},Yle=[Xle,Qle,Gle,Jle],eue=[oe.Toolbox,oe.SessionInfo,oe.ApplicationBar,oe.EditorApp,oe.CodeContainerApp],W4={flowNodes:[],flowEdges:[],ready:!0,flowEdgeLoading:!1,flowNodeLoading:!1,syncedNodes:[],syncedEdges:[],syncNodeQueue:[],syncEdgeQueue:[],edges:[],nodes:Yle},Vh=async e=>{const t=await ue("FlowNode").find(e),n=t.reduce((a,o)=>{var i;return a[o.source_type]||(a[o.source_type]=[]),(i=a[o.source_type])==null||i.push(o),a},{}),r={};return await Promise.all(Object.entries(n).map(async([a,o])=>{const i=a;r[i]=await ue(i).find({where:{id:Ca(o.map(s=>s.source_id))}})})),{flowNodes:t,entityGroups:n,flowNodeDatas:r}},tue=(e,t)=>({reset:()=>{e(W4)},setNodes:n=>{if(typeof n=="function"){e({nodes:n(t().nodes)});return}e({nodes:n})},setEdges:n=>{if(typeof n=="function"){e({edges:n(t().edges)});return}e({edges:n})},updateNodes:n=>{const r=t().nodes;e({nodes:Hi(n,r)})},updateEdges:n=>{const r=t().edges;e({edges:Ju(n,r)})},addConnectionToEdges:n=>{const r=t().edges;e({edges:D3(n,r)})},flowNodesToNodes:(n,r={})=>{const a=t().nodes,{changes:o}=s_(n,a,r);e({nodes:Hi(o,a)})},flowEdgesToEdges:n=>{const r=t().edges,{changes:a,updatedIds:o,deletedIds:i}=c_(n,r);r.forEach(s=>{o.includes(s.id)||i.push(s.id)}),i.forEach(s=>{a.push({type:"remove",id:s})}),e({edges:Ju(a,r)})},getNodes:n=>t().nodes.filter(r=>n.includes(r.id)),removeSyncNodeQueue:n=>{const{syncNodeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncNodeQueue:r})},removeSyncEdgeQueue:n=>{const{syncEdgeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncEdgeQueue:r})},pushSyncNodeQueue:(n,r)=>{const{syncNodeQueue:a}=t();e({syncNodeQueue:[...a,{query:r,timestamp:Date.now(),syncType:n}]})},pushSyncEdgeQueue:()=>{const{syncEdgeQueue:n}=t();e({syncEdgeQueue:[...n,{timestamp:Date.now()}]})},findFlowNodesWithSource:async(n,r)=>{try{e({flowNodeLoading:!0});const{flowNodes:a,flowNodeDatas:o}=await Vh(n);if(r!=null&&r.clean)e({flowNodes:a,nodes:a.map(i=>{var c;const s=(c=o==null?void 0:o[i.source_type])==null?void 0:c.find(l=>l.id===i.source_id);return z4(i,{data:s})})});else{const i=t().flowNodes,s=a.map(u=>u.id),c=t().nodes,{changes:l}=s_(a,c,o);e({flowNodes:[...i.filter(u=>!s.includes(u.id)),...a],nodes:Hi(l,c)})}return a}finally{e({flowNodeLoading:!1})}},findFlowEdges:async(n,r)=>{try{e({flowEdgeLoading:!0});const a=await ue("FlowEdge").find(n),o=t().flowEdges,i=a.map(s=>s.id);if(r!=null&&r.clean)e({flowEdges:a,edges:a.map(s=>Kle(s))});else{const s=t().edges,{changes:c}=c_(a,s);e({flowEdges:[...o.filter(l=>!i.includes(l.id)),...a],edges:Ju(c,s)})}return a}finally{e({flowEdgeLoading:!1})}},deleteFlowNode:async n=>{try{if(!n.id&&!n.source_type&&!n.source_id)throw new Error("Missing flow node indentify");const r=await ue("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}});if(r){await ue("FlowNode").delete(r.id);const a=t().flowNodes;r.source_type&&r.source_id&&await ue(r.source_type).delete(r.source_id).catch(i=>{Bo("Failed to delete source entity",r.source_type,r.source_id,i)});const o=t().nodes;e({flowNodes:a.filter(i=>i.id!==r.id),nodes:Hi([{type:"remove",id:r.id}],o)})}}catch(r){Bo("Failed to delete flow node",r)}},deleteFlowEdge:async n=>{try{if(!n.id&&!n.source&&!n.target)throw new Error("Missing flow edge indentify");const r=await ue("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}});if(r){await ue("FlowEdge").delete(r.id);const a=t().flowEdges;e({flowEdges:a.filter(o=>o.id!==r.id)})}}catch(r){Bo("Failed to delete flow edge",r)}},updateFlowNode:async(n,r)=>{var a;try{if(!((a=Ye.getState().currentSession)!=null&&a.id))throw new Error("Session not found");if(!n.id)throw new Error("Missing flow node indentify");await ue("FlowNode").update(n.id,n);const o=t().flowNodes.map(i=>i.id===n.id?{...i,...n}:i);e({flowNodes:r!=null&&r.silent?o:[...o]})}catch(o){Bo("Failed to create or update flow node",o,n)}},createOrUpdateFlowNode:async(n,r)=>{var a;try{const o=Ye.getState().currentSession;if(!(o!=null&&o.id))throw new Error("Session not found");if(!n.id&&(!n.source_type||!n.source_id))throw new Error("Missing flow node indentify");let i,s=n!=null&&n.id?t().flowNodes.find(f=>f.id===n.id):void 0;if(!s&&(n.id||n.source_type&&n.source_id)&&(s=await ue("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}})),s)i=$h(s,ku(n,Au)),r!=null&&r.lazy?ue("FlowNode").update(s.id,i):await ue("FlowNode").update(s.id,i);else if(n.source_id&&n.source_type)i={...n,source_id:`${n.source_id}`,source_type:`${n.source_type}`,node_type:n.node_type||"NEW_MESSAGE",session_id:n.session_id||(o==null?void 0:o.id)},r!=null&&r.lazy?(i.id=Oi(),ue("FlowNode").save(i)):i=await ue("FlowNode").save(i);else throw new Error("Missing source id and type");let c;const l=t().nodes.find(f=>f.id===i.id);i.source_type&&!l?c=await ue(i.source_type).findOne({where:{id:n.source_id}}):i.source_type&&l&&(c=(a=l==null?void 0:l.data)==null?void 0:a.entity);const u=t().flowNodes,d=t().nodes,{changes:p}=s_([i],d,{[i.source_type]:[c]});return e({flowNodes:[...u.filter(f=>f.id!==i.id),i],nodes:Hi(p,d)}),i}catch(o){Bo("Failed to create or update flow node",o,n)}},createOrUpdateFlowEdge:async(n,r)=>{try{const a=Ye.getState().currentSession;if(!(a!=null&&a.id))throw new Error("Session not found");if(!n.id&&(!n.source||!n.target))throw new Error("Missing flow node indentify");let o,i=n!=null&&n.id?t().flowEdges.find(l=>l.id===n.id):void 0;if(i&&(n.id||n.source&&n.target)&&(i=await ue("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}})),i)o=$h(i,ku(n,Au)),r!=null&&r.lazy?ue("FlowEdge").update(i.id,o):await ue("FlowEdge").update(i.id,o);else if(n.source&&n.target)o={...n,source:`${n.source}`,target:`${n.target}`,session_id:n.session_id||(a==null?void 0:a.id)},r!=null&&r.lazy?(o.id=Oi(),ue("FlowEdge").save(o)):o=await ue("FlowEdge").save(o);else throw new Error("Missing source and target");const s=t().flowEdges,c=t().edges;return e({flowEdges:[...s.filter(l=>l.id!==o.id),o],edges:Ju(c_([o],c).changes,c)}),o}catch(a){Bo("Failed to create or update flow node",a)}}}),Wh=()=>{const e=Ua(t=>t.loadModel);return{loadModel:g.useCallback(async(t,...n)=>{switch(t){case ln.WebLLM:return e(...n);default:return}},[e])}};var nue=Object.defineProperty,rue=Object.defineProperties,aue=Object.getOwnPropertyDescriptors,Uh=Object.getOwnPropertySymbols,U4=Object.prototype.hasOwnProperty,q4=Object.prototype.propertyIsEnumerable,H4=(e,t,n)=>t in e?nue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,oue=(e,t)=>{for(var n in t||(t={}))U4.call(t,n)&&H4(e,n,t[n]);if(Uh)for(var n of Uh(t))q4.call(t,n)&&H4(e,n,t[n]);return e},iue=(e,t)=>rue(e,aue(t)),sue=(e,t)=>{var n={};for(var r in e)U4.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Uh)for(var r of Uh(e))t.indexOf(r)<0&&q4.call(e,r)&&(n[r]=e[r]);return n};function cue(e){let t=setTimeout(e,0),n=setTimeout(e,10),r=setTimeout(e,50);return[t,n,r]}function lue(e){let t=g.useRef();return g.useEffect(()=>{t.current=e}),t.current}var uue=18,K4=40,due=`${K4}px`,pue=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function fue({containerRef:e,inputRef:t,pushPasswordManagerStrategy:n,isFocused:r}){let[a,o]=g.useState(!1),[i,s]=g.useState(!1),[c,l]=g.useState(!1),u=g.useMemo(()=>n==="none"?!1:(n==="increase-width"||n==="experimental-no-flickering")&&a&&i,[a,i,n]),d=g.useCallback(()=>{let p=e.current,f=t.current;if(!p||!f||c||n==="none")return;let y=p,m=y.getBoundingClientRect().left+y.offsetWidth,v=y.getBoundingClientRect().top+y.offsetHeight/2,b=m-uue,w=v;document.querySelectorAll(pue).length===0&&document.elementFromPoint(b,w)===p||(o(!0),l(!0))},[e,t,c,n]);return g.useEffect(()=>{let p=e.current;if(!p||n==="none")return;function f(){let m=window.innerWidth-p.getBoundingClientRect().right;s(m>=K4)}f();let y=setInterval(f,1e3);return()=>{clearInterval(y)}},[e,n]),g.useEffect(()=>{let p=r||document.activeElement===t.current;if(n==="none"||!p)return;let f=setTimeout(d,0),y=setTimeout(d,2e3),m=setTimeout(d,5e3),v=setTimeout(()=>{l(!0)},6e3);return()=>{clearTimeout(f),clearTimeout(y),clearTimeout(m),clearTimeout(v)}},[t,r,n,d]),{hasPWMBadge:a,willPushPWMBadge:u,PWM_BADGE_SPACE_WIDTH:due}}var Z4=g.createContext({}),X4=g.forwardRef((e,t)=>{var n=e,{value:r,onChange:a,maxLength:o,textAlign:i="left",pattern:s,placeholder:c,inputMode:l="numeric",onComplete:u,pushPasswordManagerStrategy:d="increase-width",pasteTransformer:p,containerClassName:f,noScriptCSSFallback:y=hue,render:m,children:v}=n,b=sue(n,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),w,_,x,j,S;let[E,O]=g.useState(typeof b.defaultValue=="string"?b.defaultValue:""),N=r??E,M=lue(N),P=g.useCallback(re=>{a==null||a(re),O(re)},[a]),I=g.useMemo(()=>s?typeof s=="string"?new RegExp(s):s:null,[s]),k=g.useRef(null),C=g.useRef(null),T=g.useRef({value:N,onChange:P,isIOS:typeof window<"u"&&((_=(w=window==null?void 0:window.CSS)==null?void 0:w.supports)==null?void 0:_.call(w,"-webkit-touch-callout","none"))}),A=g.useRef({prev:[(x=k.current)==null?void 0:x.selectionStart,(j=k.current)==null?void 0:j.selectionEnd,(S=k.current)==null?void 0:S.selectionDirection]});g.useImperativeHandle(t,()=>k.current,[]),g.useEffect(()=>{let re=k.current,le=C.current;if(!re||!le)return;T.current.value!==re.value&&T.current.onChange(re.value),A.current.prev=[re.selectionStart,re.selectionEnd,re.selectionDirection];function je(){if(document.activeElement!==re){$(null),Q(null);return}let Se=re.selectionStart,Ve=re.selectionEnd,Ue=re.selectionDirection,qe=re.maxLength,Mt=re.value,st=A.current.prev,rt=-1,bt=-1,Ht;if(Mt.length!==0&&Se!==null&&Ve!==null){let Va=Se===Ve,Y=Se===Mt.length&&Mt.length<qe;if(Va&&!Y){let te=Se;if(te===0)rt=0,bt=1,Ht="forward";else if(te===qe)rt=te-1,bt=te,Ht="backward";else if(qe>1&&Mt.length>1){let ce=0;if(st[0]!==null&&st[1]!==null){Ht=te<st[1]?"backward":"forward";let he=st[0]===st[1]&&st[0]<qe;Ht==="backward"&&!he&&(ce=-1)}rt=ce+te,bt=ce+te+1}}rt!==-1&&bt!==-1&&rt!==bt&&k.current.setSelectionRange(rt,bt,Ht)}let Qn=rt!==-1?rt:Se,za=bt!==-1?bt:Ve,Gn=Ht??Ue;$(Qn),Q(za),A.current.prev=[Qn,za,Gn]}if(document.addEventListener("selectionchange",je,{capture:!0}),je(),document.activeElement===re&&B(!0),!document.getElementById("input-otp-style")){let Se=document.createElement("style");if(Se.id="input-otp-style",document.head.appendChild(Se),Se.sheet){let Ve="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";rd(Se.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),rd(Se.sheet,`[data-input-otp]:autofill { ${Ve} }`),rd(Se.sheet,`[data-input-otp]:-webkit-autofill { ${Ve} }`),rd(Se.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),rd(Se.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let Le=()=>{le&&le.style.setProperty("--root-height",`${re.clientHeight}px`)};Le();let $e=new ResizeObserver(Le);return $e.observe(re),()=>{document.removeEventListener("selectionchange",je,{capture:!0}),$e.disconnect()}},[]);let[R,L]=g.useState(!1),[D,B]=g.useState(!1),[F,$]=g.useState(null),[V,Q]=g.useState(null);g.useEffect(()=>{cue(()=>{var re,le,je,Le;(re=k.current)==null||re.dispatchEvent(new Event("input"));let $e=(le=k.current)==null?void 0:le.selectionStart,Se=(je=k.current)==null?void 0:je.selectionEnd,Ve=(Le=k.current)==null?void 0:Le.selectionDirection;$e!==null&&Se!==null&&($($e),Q(Se),A.current.prev=[$e,Se,Ve])})},[N,D]),g.useEffect(()=>{M!==void 0&&N!==M&&M.length<o&&N.length===o&&(u==null||u(N))},[o,u,M,N]);let X=fue({containerRef:C,inputRef:k,pushPasswordManagerStrategy:d,isFocused:D}),H=g.useCallback(re=>{let le=re.currentTarget.value.slice(0,o);if(le.length>0&&I&&!I.test(le)){re.preventDefault();return}typeof M=="string"&&le.length<M.length&&document.dispatchEvent(new Event("selectionchange")),P(le)},[o,P,M,I]),J=g.useCallback(()=>{var re;if(k.current){let le=Math.min(k.current.value.length,o-1),je=k.current.value.length;(re=k.current)==null||re.setSelectionRange(le,je),$(le),Q(je)}B(!0)},[o]),K=g.useCallback(re=>{var le,je;let Le=k.current;if(!p&&(!T.current.isIOS||!re.clipboardData||!Le))return;let $e=re.clipboardData.getData("text/plain"),Se=p?p($e):$e;re.preventDefault();let Ve=(le=k.current)==null?void 0:le.selectionStart,Ue=(je=k.current)==null?void 0:je.selectionEnd,qe=(Ve!==Ue?N.slice(0,Ve)+Se+N.slice(Ue):N.slice(0,Ve)+Se+N.slice(Ve)).slice(0,o);if(qe.length>0&&I&&!I.test(qe))return;Le.value=qe,P(qe);let Mt=Math.min(qe.length,o-1),st=qe.length;Le.setSelectionRange(Mt,st),$(Mt),Q(st)},[o,P,I,N]),q=g.useMemo(()=>({position:"relative",cursor:b.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[b.disabled]),G=g.useMemo(()=>({position:"absolute",inset:0,width:X.willPushPWMBadge?`calc(100% + ${X.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:X.willPushPWMBadge?`inset(0 ${X.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:i,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[X.PWM_BADGE_SPACE_WIDTH,X.willPushPWMBadge,i]),ne=g.useMemo(()=>g.createElement("input",iue(oue({autoComplete:b.autoComplete||"one-time-code"},b),{"data-input-otp":!0,"data-input-otp-placeholder-shown":N.length===0||void 0,"data-input-otp-mss":F,"data-input-otp-mse":V,inputMode:l,pattern:I==null?void 0:I.source,"aria-placeholder":c,style:G,maxLength:o,value:N,ref:k,onPaste:re=>{var le;K(re),(le=b.onPaste)==null||le.call(b,re)},onChange:H,onMouseOver:re=>{var le;L(!0),(le=b.onMouseOver)==null||le.call(b,re)},onMouseLeave:re=>{var le;L(!1),(le=b.onMouseLeave)==null||le.call(b,re)},onFocus:re=>{var le;J(),(le=b.onFocus)==null||le.call(b,re)},onBlur:re=>{var le;B(!1),(le=b.onBlur)==null||le.call(b,re)}})),[H,J,K,l,G,o,V,F,b,I==null?void 0:I.source,N]),z=g.useMemo(()=>({slots:Array.from({length:o}).map((re,le)=>{var je;let Le=D&&F!==null&&V!==null&&(F===V&&le===F||le>=F&&le<V),$e=N[le]!==void 0?N[le]:null,Se=N[0]!==void 0?null:(je=c==null?void 0:c[le])!=null?je:null;return{char:$e,placeholderChar:Se,isActive:Le,hasFakeCaret:Le&&$e===null}}),isFocused:D,isHovering:!b.disabled&&R}),[D,R,o,V,F,b.disabled,N]),se=g.useMemo(()=>m?m(z):g.createElement(Z4.Provider,{value:z},v),[v,z,m]);return g.createElement(g.Fragment,null,y!==null&&g.createElement("noscript",null,g.createElement("style",null,y)),g.createElement("div",{ref:C,"data-input-otp-container":!0,style:q,className:f},se,g.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},ne)))});X4.displayName="Input";function rd(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var hue=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const u_=g.forwardRef(({className:e,containerClassName:t,...n},r)=>h.jsx(X4,{ref:r,containerClassName:Z("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:Z("disabled:cursor-not-allowed",e),...n}));u_.displayName="InputOTP";const ad=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex items-center",e),...t}));ad.displayName="InputOTPGroup";const ur=g.forwardRef(({index:e,className:t,hidden:n,...r},a)=>{const o=g.useContext(Z4),{char:i,hasFakeCaret:s,isActive:c}=o.slots[e];return h.jsxs("div",{ref:a,className:Z("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",c&&"z-10 ring-2 ring-ring ring-offset-background",t),...r,children:[n&&i?h.jsx(wK,{}):i,s&&h.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});ur.displayName="InputOTPSlot";const d_=g.forwardRef(({...e},t)=>h.jsx("div",{ref:t,role:"separator",...e,children:h.jsx(wK,{})}));d_.displayName="InputOTPSeparator";const od=Ha(({onConfirm:e,onCancel:t})=>{const n=Xt(),{t:r}=Pe("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{e(a),o("")},c=()=>{t(),n.hide(),o("")};return h.jsx(Yo,{open:n.visible,onOpenChange:c,children:h.jsxs(no,{className:"w-[330px]",children:[h.jsxs(ro,{children:[h.jsx(ao,{children:r("session_passkey.title")}),h.jsx(pu,{children:r("session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(u_,{onChange:i,maxLength:6,children:[h.jsxs(ad,{children:[h.jsx(ur,{index:0,hidden:!0}),h.jsx(ur,{index:1,hidden:!0}),h.jsx(ur,{index:2,hidden:!0})]}),h.jsx(d_,{}),h.jsxs(ad,{children:[h.jsx(ur,{index:3,hidden:!0}),h.jsx(ur,{index:4,hidden:!0}),h.jsx(ur,{index:5,hidden:!0})]})]})}),h.jsx(du,{children:h.jsx(ut,{onClick:s,type:"submit",children:r("session_passkey.confirm")})})]})})}),id=e=>{const t=e.match(/.{1,2}/g);if(!t)throw new Error("Invalid hexString");return Uint8Array.from(t.map(n=>parseInt(n,16))).buffer},Q4=e=>new TextEncoder().encode(e).buffer,mue=async e=>{const t=Q4(e);return await crypto.subtle.digest("SHA-256",t)},p_=e=>[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join(""),yue=async()=>{const e=crypto.getRandomValues(new Uint8Array(32));return p_(e)},f_=async e=>{const t=await mue(e);return p_(t)},G4=async e=>(await f_(e)).substring(0,32),J4=async(e,t)=>{const n=await f_(t),r=await G4(t),a=Q4(e),o=await gue(a,n,r);return p_(o)},h_=async(e,t)=>{const n=await f_(t),r=await G4(t),a=id(e),o=await vue(a,n,r);return new TextDecoder().decode(o)},gue=async(e,t,n)=>{const r=id(n),a=id(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.encrypt({name:"AES-CBC",iv:r},o,e)},vue=async(e,t,n)=>{const r=id(n),a=id(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.decrypt({name:"AES-CBC",iv:r},o,e)},Y4=async(e,t)=>{const n={};return await Promise.all(Object.entries(e||{}).map(async([r,a])=>{const o=await J4(a,t);n[r]=o})),n},qh=async(e,t)=>{let n;if(await new Promise((r,a)=>{t.show({onConfirm:async o=>{try{n=await h_(e,o),await Ip.set("passphrase",n),r(!0)}catch(i){a(i)}finally{t.hide()}},onCancel:()=>{a()}})}),!n)throw new Error("Passphrase is required");return n},mc=e=>{const t=Xt(e),n=g.useRef(t);return n.current=t,{modal:t,modalRef:n}},bue=()=>{var E,O;const[e,t]=g.useState(),[n,r]=g.useState(),[a,o]=g.useState(),[i,s]=g.useState([]),[c,l]=g.useState(),u=g.useRef(),d=g.useRef({}),p=Ye(N=>N.currentSession),{loadModel:f}=Wh(),{modalRef:y}=mc(od),m=g.useCallback(async N=>{var P;if(!p)return;const M=await ue("JSONData").findOne({where:{id:N.source_id,session_id:p==null?void 0:p.id}});M&&((P=u.current)==null||P.call(u,M.data?M.data:[]),l({node:N,enity:M}))},[p]),v=g.useCallback(async N=>{var A;const M=(N==null?void 0:N.sessionId)||(p==null?void 0:p.id),P=(N==null?void 0:N.threadNode)||(n==null?void 0:n.threadNode),I=(N==null?void 0:N.prompts)||(e==null?void 0:e.prompts);if(!M||!(P!=null&&P.id))return;const k=I==null?void 0:I.map(R=>{if(R.type!=="few_shot_example")switch(R.role){case"ai":case"assistant":case"tool":return{id:R.id,content:R.content,role:"assistant"};case"system":return{id:R.id,content:R.content,role:"system"};default:return{id:R.id,content:R.content,role:"user"}}}).filter(Boolean),C=await ue("JSONData").save({headers:"item",session_id:M,json:"",data:k});if(!C)return;const T=await ue("FlowNode").save({session_id:M,source_id:C.id,source_type:"JSONData",node_type:"JSON_DATA",x:0,y:0});if(T)return await ue("FlowEdge").save({session_id:M,source:P.id,target:T.id}),(A=u.current)==null||A.call(u,k),l({node:T,enity:C}),{jsonData:C,jsonDataNode:T}},[e==null?void 0:e.prompts,p==null?void 0:p.id,n==null?void 0:n.threadNode]),b=g.useCallback(async(N,M)=>{if(!p)return;const P=await ue("FlowEdge").findOne({where:{session_id:p.id,source:N.id},order:{id:"DESC"}});if(P){const I=await ue("FlowNode").findOne({where:{id:P.target,session_id:p.id}});if(!I)return;await m(I)}else if(!await v({sessionId:p.id,threadNode:N,prompts:M||[]}))return},[v,p,m]),w=g.useCallback(async N=>{if(N!=null&&N.length&&(p!=null&&p.id)){const M=(await Promise.all(N.map(async P=>ue("FlowEdge").find({where:{target:P.source.id}}).then(I=>Vh({where:{session_id:p.id,id:Ca(I.map(k=>k.source))}}).then(k=>({...k,...P})))))).map(P=>{var A,R,L,D;const I=P.flowNodes.find(B=>B.source_type==="Prompt"),k=P.flowNodes.find(B=>B.source_type==="VectorDatabase");if(!k||!I)return;const C=(R=(A=P.flowNodeDatas)==null?void 0:A.Prompt)==null?void 0:R.find(B=>B.id===I.source_id),T=(D=(L=P.flowNodeDatas)==null?void 0:L.VectorDatabase)==null?void 0:D.find(B=>B.id===k.source_id);return{promptNode:I,vectorDatabaseNode:k,placeholderNode:P.source,placeholderEntity:P.entity,promptEntity:C,vectorDatabaseEntity:T}}).filter(Boolean);s(M)}},[p==null?void 0:p.id]),_=g.useCallback(async()=>{try{if(d.current.handling=p==null?void 0:p.id,!(p!=null&&p.id)||!(p!=null&&p.main_source_id)||(p==null?void 0:p.main_source_type)!=="Thread")return;const[N,M]=await Promise.all([ue("Thread").findOne({where:{id:p.main_source_id,session_id:p.id}}),ue("FlowNode").findOne({where:{id:p.main_node_id}})]);if(!N||!M)return;const P=await ue("FlowEdge").find({where:{session_id:p.id,target:M.id}}),{flowNodes:I,flowNodeDatas:k}=await Vh({where:{session_id:p.id,id:Ca(P.map(F=>F.source))}}),C=(await ue("FlowEdge").find({where:{session_id:p.id}})).filter(F=>F.target===M.id).map(F=>{var V;const $=I.find(Q=>Q.id===F.source);return{connection:F,source:$,entity:(V=k==null?void 0:k[$.source_type])==null?void 0:V.find(Q=>Q.id===$.source_id)}}),T=C.find(F=>F.source.source_type==="LLM"),A=C.filter(F=>F.source.source_type==="Prompt"),R=C.find(F=>F.source.source_type==="Schema"),L=T==null?void 0:T.entity;if(!L)return;p.passphrase&&await qh(p.passphrase,y.current);const D=C.filter(F=>F.source.source_type==="FlowNodePlaceholder");await w(D),await b(M,(A==null?void 0:A.map(F=>F.entity))||[]),o({llm:L,status:L.status||Qe.Started,progress:""}),r({thread:N,threadNode:M});const B=R==null?void 0:R.entity;if(B){const F=await ue("SchemaItem").find({where:{schema_id:B.id}});B.schema_items=F||[]}t({prompts:(A==null?void 0:A.map(F=>F.entity))||[],schema:B}),d.current.handled=p.id}finally{d.current.handling=void 0}},[p==null?void 0:p.id,p==null?void 0:p.main_node_id,p==null?void 0:p.main_source_id,p==null?void 0:p.main_source_type,p==null?void 0:p.passphrase,w,b,y]),x=g.useCallback(async()=>{var N;if((N=a==null?void 0:a.llm)!=null&&N.name)try{o(M=>M&&{...M,status:Qe.Loading}),await f(a.llm.provider,a==null?void 0:a.llm.name,M=>{o(P=>P&&{...P,progress:M.text})}),o(M=>M&&{...M,status:Qe.Loaded,progress:""})}catch{o(M=>M&&{...M,status:Qe.Started,progress:""})}},[(E=a==null?void 0:a.llm)==null?void 0:E.name,(O=a==null?void 0:a.llm)==null?void 0:O.provider,f]),j=g.useCallback(N=>(u.current=N,()=>{u.current=void 0}),[]),S=g.useCallback(async N=>{!(c!=null&&c.node)||!(c!=null&&c.enity)||await ue("JSONData").save({...c.enity,data:N})},[c==null?void 0:c.enity,c==null?void 0:c.node]);return g.useEffect(()=>{d.current.handling||(d==null?void 0:d.current.handled)===(p==null?void 0:p.id)||_()},[p==null?void 0:p.id,_]),{...e,loadLLM:x,threadInfo:n,mainLLMInfo:a,retriverInfo:i,currentDataNode:c,updateMessagesData:S,addNewDataNode:v,selectDataNode:m,onThreadMessagesLoaded:j}};class wue extends Rp{get lc_attributes(){return{partialVariables:void 0}}constructor(t){super(t),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:n}=t;if(n.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,t)}async mergePartialAndUserVariables(t){const n=this.partialVariables??{},r={};for(const[a,o]of Object.entries(n))typeof o=="string"?r[a]=o:r[a]=await o();return{...r,...t}}async invoke(t,n){return this._callWithConfig(r=>this.formatPromptValue(r),t,{...n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(t){switch(t._type){case"prompt":{const{PromptTemplate:n}=await At(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>dL);return{PromptTemplate:r}},[]);return n.deserialize(t)}case void 0:{const{PromptTemplate:n}=await At(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>dL);return{PromptTemplate:r}},void 0);return n.deserialize({...t,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:n}=await At(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot-D4kyqN5P.js").then(async a=>(await a.__tla,a));return{FewShotPromptTemplate:r}},__vite__mapDeps([0,1,2,3,4]));return n.deserialize(t)}default:throw new Error(`Invalid prompt type in config: ${t._type}`)}}}class eL extends wAe{}class tL extends eL{static lc_name(){return"StringPromptValue"}constructor(t){super({value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=t}toString(){return this.value}toChatMessages(){return[new Pr(this.value)]}}class xue extends eL{static lc_name(){return"ChatPromptValue"}constructor(t){Array.isArray(t)&&(t={messages:t}),super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=t.messages}toString(){return xAe(this.messages)}toChatMessages(){return this.messages}}sM=class extends wue{async formatPromptValue(e){const t=await this.format(e);return new tL(t)}};var _ue=Object.prototype.toString,yc=Array.isArray||function(e){return _ue.call(e)==="[object Array]"};function m_(e){return typeof e=="function"}function jue(e){return yc(e)?"array":typeof e}function y_(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function nL(e,t){return e!=null&&typeof e=="object"&&t in e}function Sue(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var Eue=RegExp.prototype.test;function Oue(e,t){return Eue.call(e,t)}var Cue=/\S/;function Nue(e){return!Oue(Cue,e)}var Mue={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Pue(e){return String(e).replace(/[&<>"'`=\/]/g,function(t){return Mue[t]})}var kue=/\s*/,Aue=/\s+/,rL=/\s*=/,Tue=/\s*\}/,Iue=/#|\^|\/|>|\{|&|=|!/;function Rue(e,t){if(!e)return[];var n=!1,r=[],a=[],o=[],i=!1,s=!1,c="",l=0;function u(){if(i&&!s)for(;o.length;)delete a[o.pop()];else o=[];i=!1,s=!1}var d,p,f;function y(O){if(typeof O=="string"&&(O=O.split(Aue,2)),!yc(O)||O.length!==2)throw new Error("Invalid tags: "+O);d=new RegExp(y_(O[0])+"\\s*"),p=new RegExp("\\s*"+y_(O[1])),f=new RegExp("\\s*"+y_("}"+O[1]))}y(t||Un.tags);for(var m=new sd(e),v,b,w,_,x,j;!m.eos();){if(v=m.pos,w=m.scanUntil(d),w)for(var S=0,E=w.length;S<E;++S)_=w.charAt(S),Nue(_)?(o.push(a.length),c+=_):(s=!0,n=!0,c+=" "),a.push(["text",_,v,v+1]),v+=1,_===`
`&&(u(),c="",l=0,n=!1);if(!m.scan(d))break;if(i=!0,b=m.scan(Iue)||"name",m.scan(kue),b==="="?(w=m.scanUntil(rL),m.scan(rL),m.scanUntil(p)):b==="{"?(w=m.scanUntil(f),m.scan(Tue),m.scanUntil(p),b="&"):w=m.scanUntil(p),!m.scan(p))throw new Error("Unclosed tag at "+m.pos);if(b==">"?x=[b,w,v,m.pos,c,l,n]:x=[b,w,v,m.pos],l++,a.push(x),b==="#"||b==="^")r.push(x);else if(b==="/"){if(j=r.pop(),!j)throw new Error('Unopened section "'+w+'" at '+v);if(j[1]!==w)throw new Error('Unclosed section "'+j[1]+'" at '+v)}else b==="name"||b==="{"||b==="&"?s=!0:b==="="&&y(w)}if(u(),j=r.pop(),j)throw new Error('Unclosed section "'+j[1]+'" at '+m.pos);return Lue(Due(a))}function Due(e){for(var t=[],n,r,a=0,o=e.length;a<o;++a)n=e[a],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function Lue(e){for(var t=[],n=t,r=[],a,o,i=0,s=e.length;i<s;++i)switch(a=e[i],a[0]){case"#":case"^":n.push(a),r.push(a),n=a[4]=[];break;case"/":o=r.pop(),o[5]=a[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(a)}return t}function sd(e){this.string=e,this.tail=e,this.pos=0}sd.prototype.eos=function(){return this.tail===""},sd.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},sd.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n};function gc(e,t){this.view=e,this.cache={".":this.view},this.parent=t}gc.prototype.push=function(e){return new gc(e,this)},gc.prototype.lookup=function(e){var t=this.cache,n;if(t.hasOwnProperty(e))n=t[e];else{for(var r=this,a,o,i,s=!1;r;){if(e.indexOf(".")>0)for(a=r.view,o=e.split("."),i=0;a!=null&&i<o.length;)i===o.length-1&&(s=nL(a,o[i])||Sue(a,o[i])),a=a[o[i++]];else a=r.view[e],s=nL(r.view,e);if(s){n=a;break}r=r.parent}t[e]=n}return m_(n)&&(n=n.call(this.view)),n};function Dn(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Dn.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()},Dn.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||Un.tags).join(":"),a=typeof n<"u",o=a?n.get(r):void 0;return o==null&&(o=Rue(e,t),a&&n.set(r,o)),o},Dn.prototype.render=function(e,t,n,r){var a=this.getConfigTags(r),o=this.parse(e,a),i=t instanceof gc?t:new gc(t,void 0);return this.renderTokens(o,i,n,e,r)},Dn.prototype.renderTokens=function(e,t,n,r,a){for(var o="",i,s,c,l=0,u=e.length;l<u;++l)c=void 0,i=e[l],s=i[0],s==="#"?c=this.renderSection(i,t,n,r,a):s==="^"?c=this.renderInverted(i,t,n,r,a):s===">"?c=this.renderPartial(i,t,n,a):s==="&"?c=this.unescapedValue(i,t):s==="name"?c=this.escapedValue(i,t,a):s==="text"&&(c=this.rawValue(i)),c!==void 0&&(o+=c);return o},Dn.prototype.renderSection=function(e,t,n,r,a){var o=this,i="",s=t.lookup(e[1]);function c(d){return o.render(d,t,n,a)}if(s){if(yc(s))for(var l=0,u=s.length;l<u;++l)i+=this.renderTokens(e[4],t.push(s[l]),n,r,a);else if(typeof s=="object"||typeof s=="string"||typeof s=="number")i+=this.renderTokens(e[4],t.push(s),n,r,a);else if(m_(s)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");s=s.call(t.view,r.slice(e[3],e[5]),c),s!=null&&(i+=s)}else i+=this.renderTokens(e[4],t,n,r,a);return i}},Dn.prototype.renderInverted=function(e,t,n,r,a){var o=t.lookup(e[1]);if(!o||yc(o)&&o.length===0)return this.renderTokens(e[4],t,n,r,a)},Dn.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),a=e.split(`
`),o=0;o<a.length;o++)a[o].length&&(o>0||!n)&&(a[o]=r+a[o]);return a.join(`
`)},Dn.prototype.renderPartial=function(e,t,n,r){if(n){var a=this.getConfigTags(r),o=m_(n)?n(e[1]):n[e[1]];if(o!=null){var i=e[6],s=e[5],c=e[4],l=o;s==0&&c&&(l=this.indentPartial(o,c,i));var u=this.parse(l,a);return this.renderTokens(u,t,n,l,r)}}},Dn.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(n!=null)return n},Dn.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||Un.escape,a=t.lookup(e[1]);if(a!=null)return typeof a=="number"&&r===Un.escape?String(a):r(a)},Dn.prototype.rawValue=function(e){return e[1]},Dn.prototype.getConfigTags=function(e){return yc(e)?e:e&&typeof e=="object"?e.tags:void 0},Dn.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!yc(e))return e.escape};var Un={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){cd.templateCache=e},get templateCache(){return cd.templateCache}},cd=new Dn;Un.clearCache=function(){return cd.clearCache()},Un.parse=function(e,t){return cd.parse(e,t)},Un.render=function(e,t,n,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+jue(e)+'" was given as the first argument for mustache#render(template, view, partials)');return cd.render(e,t,n,r)},Un.escape=Pue,Un.Scanner=sd,Un.Context=gc,Un.Writer=Dn;function aL(){Un.escape=e=>e}let g_,oL,iL,sL,cL,Hh,lL,uL;g_=e=>{const t=e.split(""),n=[],r=(o,i)=>{for(let s=i;s<t.length;s+=1)if(o.includes(t[s]))return s;return-1};let a=0;for(;a<t.length;)if(t[a]==="{"&&a+1<t.length&&t[a+1]==="{")n.push({type:"literal",text:"{"}),a+=2;else if(t[a]==="}"&&a+1<t.length&&t[a+1]==="}")n.push({type:"literal",text:"}"}),a+=2;else if(t[a]==="{"){const o=r("}",a);if(o<0)throw new Error("Unclosed '{' in template.");n.push({type:"variable",name:t.slice(a+1,o).join("")}),a=o+1}else{if(t[a]==="}")throw new Error("Single '}' in template.");{const o=r("{}",a),i=(o<0?t.slice(a):t.slice(a,o)).join("");n.push({type:"literal",text:i}),a=o<0?t.length:o}}return n},oL=e=>e.map(t=>t[0]==="name"?{type:"variable",name:t[1].includes(".")?t[1].split(".")[0]:t[1]}:["#","&","^",">"].includes(t[0])?{type:"variable",name:t[1]}:{type:"literal",text:t[1]}),iL=e=>{aL();const t=Un.parse(e);return oL(t)},sL=(e,t)=>g_(e).reduce((n,r)=>{if(r.type==="variable"){if(r.name in t)return n+t[r.name];throw new Error(`(f-string) Missing value for input ${r.name}`)}return n+r.text},""),cL=(e,t)=>(aL(),Un.render(e,t)),Hh={"f-string":sL,mustache:cL},lL={"f-string":g_,mustache:iL},Ns=(e,t,n)=>Hh[t](e,n),uL=(e,t)=>lL[t](e),cM=(e,t,n)=>{if(!(t in Hh)){const r=Object.keys(Hh);throw new Error(`Invalid template format. Got \`${t}\`;
                         should be one of ${r}`)}try{const r=n.reduce((a,o)=>(a[o]="foo",a),{});Array.isArray(e)?e.forEach(a=>{if(a.type==="text")Ns(a.text,t,r);else if(a.type==="image_url")if(typeof a.image_url=="string")Ns(a.image_url,t,r);else{const o=a.image_url.url;Ns(o,t,r)}else throw new Error(`Invalid message template received. ${JSON.stringify(a,null,2)}`)}):Ns(e,t,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}},qo=class extends sM{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),cM(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return Ns(this.template,this.templateFormat,t)}static fromExamples(e,t,n,r=`

`,a=""){const o=[a,...e,t].join(r);return new qo({inputVariables:n,template:o})}static fromTemplate(e,t){const{templateFormat:n="f-string",...r}=t??{},a=new Set;return uL(e,n).forEach(o=>{o.type==="variable"&&a.add(o.name)}),new qo({inputVariables:[...a],templateFormat:n,template:e,...r})}async partial(e){const t=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new qo(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new qo({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}};const dL=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:qo},Symbol.toStringTag,{value:"Module"})),v_="RFC3986",b_={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},$ue="RFC1738",Fue=Array.isArray,Na=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),w_=1024,Bue=(e,t,n,r,a)=>{if(e.length===0)return e;let o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(s){return"%26%23"+parseInt(s.slice(2),16)+"%3B"});let i="";for(let s=0;s<o.length;s+=w_){const c=o.length>=w_?o.slice(s,s+w_):o,l=[];for(let u=0;u<c.length;++u){let d=c.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||a===$ue&&(d===40||d===41)){l[l.length]=c.charAt(u);continue}if(d<128){l[l.length]=Na[d];continue}if(d<2048){l[l.length]=Na[192|d>>6]+Na[128|d&63];continue}if(d<55296||d>=57344){l[l.length]=Na[224|d>>12]+Na[128|d>>6&63]+Na[128|d&63];continue}u+=1,d=65536+((d&1023)<<10|c.charCodeAt(u)&1023),l[l.length]=Na[240|d>>18]+Na[128|d>>12&63]+Na[128|d>>6&63]+Na[128|d&63]}i+=l.join("")}return i};function zue(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function pL(e,t){if(Fue(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const Vue=Object.prototype.hasOwnProperty,fL={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},Ma=Array.isArray,Wue=Array.prototype.push,hL=function(e,t){Wue.apply(e,Ma(t)?t:[t])},Uue=Date.prototype.toISOString,rn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Bue,encodeValuesOnly:!1,format:v_,formatter:b_[v_],indices:!1,serializeDate(e){return Uue.call(e)},skipNulls:!1,strictNullHandling:!1};function que(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const x_={};function mL(e,t,n,r,a,o,i,s,c,l,u,d,p,f,y,m,v,b){let w=e,_=b,x=0,j=!1;for(;(_=_.get(x_))!==void 0&&!j;){const M=_.get(e);if(x+=1,typeof M<"u"){if(M===x)throw new RangeError("Cyclic object value");j=!0}typeof _.get(x_)>"u"&&(x=0)}if(typeof l=="function"?w=l(t,w):w instanceof Date?w=p==null?void 0:p(w):n==="comma"&&Ma(w)&&(w=pL(w,function(M){return M instanceof Date?p==null?void 0:p(M):M})),w===null){if(o)return c&&!m?c(t,rn.encoder,v,"key",f):t;w=""}if(que(w)||zue(w)){if(c){const M=m?t:c(t,rn.encoder,v,"key",f);return[(y==null?void 0:y(M))+"="+(y==null?void 0:y(c(w,rn.encoder,v,"value",f)))]}return[(y==null?void 0:y(t))+"="+(y==null?void 0:y(String(w)))]}const S=[];if(typeof w>"u")return S;let E;if(n==="comma"&&Ma(w))m&&c&&(w=pL(w,c)),E=[{value:w.length>0?w.join(",")||null:void 0}];else if(Ma(l))E=l;else{const M=Object.keys(w);E=u?M.sort(u):M}const O=s?String(t).replace(/\./g,"%2E"):String(t),N=r&&Ma(w)&&w.length===1?O+"[]":O;if(a&&Ma(w)&&w.length===0)return N+"[]";for(let M=0;M<E.length;++M){const P=E[M],I=typeof P=="object"&&typeof P.value<"u"?P.value:w[P];if(i&&I===null)continue;const k=d&&s?P.replace(/\./g,"%2E"):P,C=Ma(w)?typeof n=="function"?n(N,k):N:N+(d?"."+k:"["+k+"]");b.set(e,x);const T=new WeakMap;T.set(x_,b),hL(S,mL(I,C,n,r,a,o,i,s,n==="comma"&&m&&Ma(w)?null:c,l,u,d,p,f,y,m,v,T))}return S}function Hue(e=rn){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||rn.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=v_;if(typeof e.format<"u"){if(!Vue.call(b_,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=b_[n];let a=rn.filter;(typeof e.filter=="function"||Ma(e.filter))&&(a=e.filter);let o;if(e.arrayFormat&&e.arrayFormat in fL?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=rn.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:rn.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:rn.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:rn.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:rn.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?rn.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:rn.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:rn.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:rn.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:rn.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:rn.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:rn.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:rn.strictNullHandling}}function Kue(e,t={}){let n=e;const r=Hue(t);let a,o;typeof r.filter=="function"?(o=r.filter,n=o("",n)):Ma(r.filter)&&(o=r.filter,a=o);const i=[];if(typeof n!="object"||n===null)return"";const s=fL[r.arrayFormat],c=s==="comma"&&r.commaRoundTrip;a||(a=Object.keys(n)),r.sort&&a.sort(r.sort);const l=new WeakMap;for(let p=0;p<a.length;++p){const f=a[p];r.skipNulls&&n[f]===null||hL(i,mL(n[f],f,s,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const u=i.join(r.delimiter);let d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const vc="4.78.1";let yL=!1,ld,gL,vL,__,bL,wL,xL,_L,jL;function Zue(e,t={auto:!1}){if(yL)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(ld)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${ld}'\``);yL=t.auto,ld=e.kind,gL=e.fetch,vL=e.FormData,__=e.File,bL=e.ReadableStream,wL=e.getMultipartRequestOptions,xL=e.getDefaultAgent,_L=e.fileFromPath,jL=e.isFsReadStream}class Xue{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function Que({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new Xue(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}ld||Zue(Que(),{auto:!0});class et extends Error{}class bn extends et{constructor(t,n,r,a){super(`${bn.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=n;const o=n;this.code=o==null?void 0:o.code,this.param=o==null?void 0:o.param,this.type=o==null?void 0:o.type}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t||!a)return new Kh({message:r,cause:O_(n)});const o=n==null?void 0:n.error;return t===400?new SL(t,o,r,a):t===401?new EL(t,o,r,a):t===403?new OL(t,o,r,a):t===404?new CL(t,o,r,a):t===409?new NL(t,o,r,a):t===422?new ML(t,o,r,a):t===429?new PL(t,o,r,a):t>=500?new kL(t,o,r,a):new bn(t,o,r,a)}}class wr extends bn{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Kh extends bn{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class Zh extends Kh{constructor({message:t}={}){super({message:t??"Request timed out."})}}class SL extends bn{}class EL extends bn{}class OL extends bn{}class CL extends bn{}class NL extends bn{}class ML extends bn{}class PL extends bn{}class kL extends bn{}class AL extends et{constructor(){super("Could not parse response content as the length limit was reached")}}class TL extends et{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Xi{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=Xi.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(Xi.NEWLINE_REGEXP);return r&&a.pop(),a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof pa<"u"){if(t instanceof pa)return t.toString();if(t instanceof Uint8Array)return pa.from(t).toString();throw new et(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new et(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new et("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}Xi.NEWLINE_CHARS=new Set([`
`,"\r"]),Xi.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Pa{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const i of Gue(t,n))if(!o){if(i.data.startsWith("[DONE]")){o=!0;continue}if(i.event===null){let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(s&&s.error)throw new bn(void 0,s.error,void 0,void 0);yield s}else{let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new bn(void 0,s.error,s.message,void 0);yield{event:i.event,data:s}}}o=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{o||n.abort()}}return new Pa(a,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new Xi,s=IL(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new Pa(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new Pa(()=>a(t),this.controller),new Pa(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new bL({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}}async function*Gue(e,t){if(!e.body)throw t.abort(),new et("Attempted to iterate over a response with no body");const n=new ede,r=new Xi,a=IL(e.body);for await(const o of Jue(a))for(const i of r.decode(o)){const s=n.decode(i);s&&(yield s)}for(const o of r.flush()){const i=n.decode(o);i&&(yield i)}}async function*Jue(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let a=new Uint8Array(t.length+r.length);a.set(t),a.set(r,t.length),t=a;let o;for(;(o=Yue(t))!==-1;)yield t.slice(0,o),t=t.slice(o)}t.length>0&&(yield t)}function Yue(e){for(let t=0;t<e.length-2;t++){if(e[t]===10&&e[t+1]===10||e[t]===13&&e[t+1]===13)return t+2;if(e[t]===13&&e[t+1]===10&&t+3<e.length&&e[t+2]===13&&e[t+3]===10)return t+4}return-1}class ede{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,r,a]=tde(t,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function tde(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function IL(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const RL=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",DL=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Xh(e),Xh=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",nde=e=>DL(e)||RL(e)||jL(e);async function LL(e,t,n){var a;if(e=await e,DL(e))return e;if(RL(e)){const o=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=Xh(o)?[await o.arrayBuffer()]:[o];return new __(i,t,n)}const r=await rde(e);if(t||(t=ode(e)??"unknown_file"),!(n!=null&&n.type)){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new __(r,t,n)}async function rde(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Xh(e))t.push(await e.arrayBuffer());else if(ide(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${ade(e)}`);return t}function ade(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function ode(e){var t;return j_(e.name)||j_(e.filename)||((t=j_(e.path))==null?void 0:t.split(/[\\/]/).pop())}const j_=e=>{if(typeof e=="string")return e;if(typeof pa<"u"&&e instanceof pa)return String(e)},ide=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",$L=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",bc=async e=>{const t=await sde(e.body);return wL(t,e)},sde=async e=>{const t=new vL;return await Promise.all(Object.entries(e||{}).map(([n,r])=>S_(t,n,r))),t},S_=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(nde(n)){const r=await LL(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>S_(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>S_(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var wc={},cde=function(e,t,n,r,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n},lde=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Qh;async function FL(e){const{response:t}=e;if(e.options.stream)return xc("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Pa.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return xc("response",t.status,t.url,t.headers,a),BL(a,t)}const r=await t.text();return xc("response",t.status,t.url,t.headers,r),r}function BL(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class Gh extends Promise{constructor(t,n=FL){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new Gh(this.responsePromise,async n=>BL(t(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class ude{constructor({baseURL:t,maxRetries:n=2,timeout:r=6e5,httpAgent:a,fetch:o}){this.baseURL=t,this.maxRetries=E_("maxRetries",n),this.timeout=E_("timeout",r),this.httpAgent=a,this.fetch=o??gL}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...yde(),...this.authHeaders(t)}}validateHeaders(t,n){}defaultIdempotencyKey(){return`stainless-node-retry-${wde()}`}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,r){return this.request(Promise.resolve(r).then(async a=>{const o=a&&Xh(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:t,path:n,...a,body:o}}))}getAPIList(t,n,r){return this.requestAPIList(n,{method:"get",path:t,...r})}calculateContentLength(t){if(typeof t=="string"){if(typeof pa<"u")return pa.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t,{retryCount:n=0}={}){var y;const{method:r,path:a,query:o,headers:i={}}=t,s=ArrayBuffer.isView(t.body)||t.__binaryRequest&&typeof t.body=="string"?t.body:$L(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,c=this.calculateContentLength(s),l=this.buildURL(a,o);"timeout"in t&&E_("timeout",t.timeout);const u=t.timeout??this.timeout,d=t.httpAgent??this.httpAgent??xL(l),p=u+1e3;typeof((y=d==null?void 0:d.options)==null?void 0:y.timeout)=="number"&&p>(d.options.timeout??0)&&(d.options.timeout=p),this.idempotencyHeader&&r!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=t.idempotencyKey);const f=this.buildHeaders({options:t,headers:i,contentLength:c,retryCount:n});return{req:{method:r,...s&&{body:s},headers:f,...d&&{agent:d},signal:t.signal??null},url:l,timeout:u}}buildHeaders({options:t,headers:n,contentLength:r,retryCount:a}){const o={};r&&(o["content-length"]=r);const i=this.defaultHeaders(t);return KL(o,i),KL(o,n),$L(t.body)&&ld!=="node"&&delete o["content-type"],ZL(i,"x-stainless-retry-count")===void 0&&ZL(n,"x-stainless-retry-count")===void 0&&(o["x-stainless-retry-count"]=String(a)),this.validateHeaders(o,n),o}async prepareOptions(t){}async prepareRequest(t,{url:n,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(n=>[...n])):{...t}:{}}makeStatusError(t,n,r,a){return bn.generate(t,n,r,a)}request(t,n=null){return new Gh(this.makeRequest(t,n))}async makeRequest(t,n){var d,p;const r=await t,a=r.maxRetries??this.maxRetries;n==null&&(n=a),await this.prepareOptions(r);const{req:o,url:i,timeout:s}=this.buildRequest(r,{retryCount:a-n});if(await this.prepareRequest(o,{url:i,options:r}),xc("request",i,r,o.headers),(d=r.signal)==null?void 0:d.aborted)throw new wr;const c=new AbortController,l=await this.fetchWithTimeout(i,o,s,c).catch(O_);if(l instanceof Error){if((p=r.signal)!=null&&p.aborted)throw new wr;if(n)return this.retryRequest(r,n);throw l.name==="AbortError"?new Zh:new Kh({cause:l})}const u=pde(l.headers);if(!l.ok){if(n&&this.shouldRetry(l)){const v=`retrying, ${n} attempts remaining`;return xc(`response (error; ${v})`,l.status,i,u),this.retryRequest(r,n,u)}const f=await l.text().catch(v=>O_(v).message),y=gde(f),m=y?void 0:f;throw xc(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,u,m),this.makeStatusError(l.status,y,m,u)}return{response:l,options:r,controller:c}}requestAPIList(t,n){const r=this.makeRequest(n,null);return new dde(this,r,t)}buildURL(t,n){const r=bde(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return qL(a)||(n={...a,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(t){return Object.entries(t).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new et(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,n,r,a){const{signal:o,...i}=n||{};o&&o.addEventListener("abort",()=>a.abort());const s=setTimeout(()=>a.abort(),r),c={signal:a.signal,...i};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,t,c).finally(()=>{clearTimeout(s)})}shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,r){let a;const o=r==null?void 0:r["retry-after-ms"];if(o){const s=parseFloat(o);Number.isNaN(s)||(a=s)}const i=r==null?void 0:r["retry-after"];if(i&&!a){const s=parseFloat(i);Number.isNaN(s)?a=Date.parse(i)-Date.now():a=s*1e3}if(!(a&&0<=a&&a<60*1e3)){const s=t.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,s)}return await ud(a),this.makeRequest(t,n-1)}calculateDefaultRetryTimeoutMillis(t,n){const r=n-t,a=Math.min(.5*Math.pow(2,r),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${vc}`}}class zL{constructor(t,n,r,a){Qh.set(this,void 0),cde(this,Qh,t),this.options=a,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new et("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in t&&typeof n.query=="object")n.query={...n.query,...t.params};else if("url"in t){const r=[...Object.entries(n.query||{}),...t.url.searchParams.entries()];for(const[a,o]of r)t.url.searchParams.set(a,o);n.query=void 0,n.path=t.url.toString()}return await lde(this,Qh,"f").requestAPIList(this.constructor,n)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(Qh=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}class dde extends Gh{constructor(t,n,r){super(n,async a=>new r(t,a.response,await FL(a),a.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}const pde=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),fde={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},qn=e=>typeof e=="object"&&e!==null&&!qL(e)&&Object.keys(e).every(t=>HL(fde,t)),hde=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":WL(Deno.build.os),"X-Stainless-Arch":VL(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":Ka.version};if(Object.prototype.toString.call(typeof Ka<"u"?Ka:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":WL(Ka.platform),"X-Stainless-Arch":VL(Ka.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":Ka.version};const e=mde();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function mde(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const VL=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",WL=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let UL;const yde=()=>UL??(UL=hde()),gde=e=>{try{return JSON.parse(e)}catch{return}},vde=/^[a-z][a-z0-9+.-]*:/i,bde=e=>vde.test(e),ud=e=>new Promise(t=>setTimeout(t,e)),E_=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new et(`${e} must be an integer`);if(t<0)throw new et(`${e} must be a positive integer`);return t},O_=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},Jh=e=>{var t,n,r,a;if(typeof Ka<"u")return((t=wc==null?void 0:wc[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function qL(e){if(!e)return!0;for(const t in e)return!1;return!0}function HL(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function KL(e,t){for(const n in t){if(!HL(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function xc(e,...t){typeof Ka<"u"&&(wc==null?void 0:wc.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${e}`,...t)}const wde=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),xde=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",_de=e=>typeof(e==null?void 0:e.get)=="function",ZL=(e,t)=>{var r;const n=t.toLowerCase();if(_de(e)){const a=((r=t[0])==null?void 0:r.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(o,i,s)=>i+s.toUpperCase());for(const o of[t,n,t.toUpperCase(),a]){const i=e.get(o);if(i)return i}}for(const[a,o]of Object.entries(e))if(a.toLowerCase()===n)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${t} header, using the first entry.`),o[0]):o};function C_(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class jde extends zL{constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Kr extends zL{constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const n=Object.fromEntries(t.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const t=this.getPaginatedItems();if(!t.length)return null;const n=(r=t[t.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class ht{constructor(t){this._client=t}}let XL=class extends ht{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},N_=class extends ht{constructor(){super(...arguments),this.completions=new XL(this._client)}};N_.Completions=XL;class QL extends ht{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class GL extends ht{create(t,n){return this._client.post("/audio/transcriptions",bc({body:t,...n}))}}class JL extends ht{create(t,n){return this._client.post("/audio/translations",bc({body:t,...n}))}}class dd extends ht{constructor(){super(...arguments),this.transcriptions=new GL(this._client),this.translations=new JL(this._client),this.speech=new QL(this._client)}}dd.Transcriptions=GL,dd.Translations=JL,dd.Speech=QL;class M_ extends ht{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(`/batches/${t}`,n)}list(t={},n){return qn(t)?this.list({},t):this._client.getAPIList("/batches",P_,{query:t,...n})}cancel(t,n){return this._client.post(`/batches/${t}/cancel`,n)}}class P_ extends Kr{}M_.BatchesPage=P_;class k_ extends ht{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/assistants/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return qn(t)?this.list({},t):this._client.getAPIList("/assistants",A_,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class A_ extends Kr{}k_.AssistantsPage=A_;function YL(e){return typeof e.parse=="function"}const _c=e=>(e==null?void 0:e.role)==="assistant",e6=e=>(e==null?void 0:e.role)==="function",t6=e=>(e==null?void 0:e.role)==="tool";var Zr=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Vt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},T_,Yh,em,pd,fd,tm,hd,wo,md,nm,rm,jc,n6;class r6{constructor(){T_.add(this),this.controller=new AbortController,Yh.set(this,void 0),em.set(this,()=>{}),pd.set(this,()=>{}),fd.set(this,void 0),tm.set(this,()=>{}),hd.set(this,()=>{}),wo.set(this,{}),md.set(this,!1),nm.set(this,!1),rm.set(this,!1),jc.set(this,!1),Zr(this,Yh,new Promise((t,n)=>{Zr(this,em,t,"f"),Zr(this,pd,n,"f")}),"f"),Zr(this,fd,new Promise((t,n)=>{Zr(this,tm,t,"f"),Zr(this,hd,n,"f")}),"f"),Vt(this,Yh,"f").catch(()=>{}),Vt(this,fd,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},Vt(this,T_,"m",n6).bind(this))},0)}_connected(){this.ended||(Vt(this,em,"f").call(this),this._emit("connect"))}get ended(){return Vt(this,md,"f")}get errored(){return Vt(this,nm,"f")}get aborted(){return Vt(this,rm,"f")}abort(){this.controller.abort()}on(t,n){return(Vt(this,wo,"f")[t]||(Vt(this,wo,"f")[t]=[])).push({listener:n}),this}off(t,n){const r=Vt(this,wo,"f")[t];if(!r)return this;const a=r.findIndex(o=>o.listener===n);return a>=0&&r.splice(a,1),this}once(t,n){return(Vt(this,wo,"f")[t]||(Vt(this,wo,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,r)=>{Zr(this,jc,!0,"f"),t!=="error"&&this.once("error",r),this.once(t,n)})}async done(){Zr(this,jc,!0,"f"),await Vt(this,fd,"f")}_emit(t,...n){if(Vt(this,md,"f"))return;t==="end"&&(Zr(this,md,!0,"f"),Vt(this,tm,"f").call(this));const r=Vt(this,wo,"f")[t];if(r&&(Vt(this,wo,"f")[t]=r.filter(a=>!a.once),r.forEach(({listener:a})=>a(...n))),t==="abort"){const a=n[0];!Vt(this,jc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Vt(this,pd,"f").call(this,a),Vt(this,hd,"f").call(this,a),this._emit("end");return}if(t==="error"){const a=n[0];!Vt(this,jc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Vt(this,pd,"f").call(this,a),Vt(this,hd,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Yh=new WeakMap,em=new WeakMap,pd=new WeakMap,fd=new WeakMap,tm=new WeakMap,hd=new WeakMap,wo=new WeakMap,md=new WeakMap,nm=new WeakMap,rm=new WeakMap,jc=new WeakMap,T_=new WeakSet,n6=function(e){if(Zr(this,nm,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new wr),e instanceof wr)return Zr(this,rm,!0,"f"),this._emit("abort",e);if(e instanceof et)return this._emit("error",e);if(e instanceof Error){const t=new et(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new et(String(e)))};function Sde(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function a6(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function Ede(e,{parser:t,callback:n}){const r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function yd(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function Ode(e,t){return!t||!o6(t)?{...e,choices:e.choices.map(n=>({...n,message:{...n.message,parsed:null,tool_calls:n.message.tool_calls??[]}}))}:I_(e,t)}function I_(e,t){const n=e.choices.map(r=>{var a;if(r.finish_reason==="length")throw new AL;if(r.finish_reason==="content_filter")throw new TL;return{...r,message:{...r.message,tool_calls:((a=r.message.tool_calls)==null?void 0:a.map(o=>Nde(t,o)))??[],parsed:r.message.content&&!r.message.refusal?Cde(t,r.message.content):null}}});return{...e,choices:n}}function Cde(e,t){var n,r;return((n=e.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=e.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function Nde(e,t){var r;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:yd(n)?n.$parseRaw(t.function.arguments):n!=null&&n.function.strict?JSON.parse(t.function.arguments):null}}}function Mde(e,t){var r;if(!e)return!1;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return yd(n)||(n==null?void 0:n.function.strict)||!1}function o6(e){var t;return a6(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(n=>yd(n)||n.type==="function"&&n.function.strict===!0))??!1}function Pde(e){for(const t of e??[]){if(t.type!=="function")throw new et(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new et(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Hn=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Cn,R_,am,D_,L_,$_,i6,F_;const s6=10;class c6 extends r6{constructor(){super(...arguments),Cn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var r;this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=(r=t.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),(e6(t)||t6(t))&&t.content)this._emit("functionCallResult",t.content);else if(_c(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(_c(t)&&t.tool_calls)for(const r of t.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new et("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),Hn(this,Cn,"m",R_).call(this)}async finalMessage(){return await this.done(),Hn(this,Cn,"m",am).call(this)}async finalFunctionCall(){return await this.done(),Hn(this,Cn,"m",D_).call(this)}async finalFunctionCallResult(){return await this.done(),Hn(this,Cn,"m",L_).call(this)}async totalUsage(){return await this.done(),Hn(this,Cn,"m",$_).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=Hn(this,Cn,"m",am).call(this);n&&this._emit("finalMessage",n);const r=Hn(this,Cn,"m",R_).call(this);r&&this._emit("finalContent",r);const a=Hn(this,Cn,"m",D_).call(this);a&&this._emit("finalFunctionCall",a);const o=Hn(this,Cn,"m",L_).call(this);o!=null&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",Hn(this,Cn,"m",$_).call(this))}async _createChatCompletion(t,n,r){const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Hn(this,Cn,"m",i6).call(this,n);const o=await t.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(I_(o,n))}async _runChatCompletion(t,n,r){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(t,n,r)}async _runFunctions(t,n,r){var p;const a="function",{function_call:o="auto",stream:i,...s}=n,c=typeof o!="string"&&(o==null?void 0:o.name),{maxChatCompletions:l=s6}=r||{},u={};for(const f of n.functions)u[f.name||f.function.name]=f;const d=n.functions.map(f=>({name:f.name||f.function.name,parameters:f.parameters,description:f.description}));for(const f of n.messages)this._addMessage(f,!1);for(let f=0;f<l;++f){const y=(p=(await this._createChatCompletion(t,{...s,function_call:o,functions:d,messages:[...this.messages]},r)).choices[0])==null?void 0:p.message;if(!y)throw new et("missing message in ChatCompletion response");if(!y.function_call)return;const{name:m,arguments:v}=y.function_call,b=u[m];if(b){if(c&&c!==m){const j=`Invalid function_call: ${JSON.stringify(m)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,name:m,content:j});continue}}else{const j=`Invalid function_call: ${JSON.stringify(m)}. Available options are: ${d.map(S=>JSON.stringify(S.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:m,content:j});continue}let w;try{w=YL(b)?await b.parse(v):v}catch(j){this._addMessage({role:a,name:m,content:j instanceof Error?j.message:String(j)});continue}const _=await b.function(w,this),x=Hn(this,Cn,"m",F_).call(this,_);if(this._addMessage({role:a,name:m,content:x}),c)return}}async _runTools(t,n,r){var f,y,m;const a="tool",{tool_choice:o="auto",stream:i,...s}=n,c=typeof o!="string"&&((f=o==null?void 0:o.function)==null?void 0:f.name),{maxChatCompletions:l=s6}=r||{},u=n.tools.map(v=>{if(yd(v)){if(!v.$callback)throw new et("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),d={};for(const v of u)v.type==="function"&&(d[v.function.name||v.function.function.name]=v.function);const p="tools"in n?u.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<l;++v){const b=(y=(await this._createChatCompletion(t,{...s,tool_choice:o,tools:p,messages:[...this.messages]},r)).choices[0])==null?void 0:y.message;if(!b)throw new et("missing message in ChatCompletion response");if(!((m=b.tool_calls)!=null&&m.length))return;for(const w of b.tool_calls){if(w.type!=="function")continue;const _=w.id,{name:x,arguments:j}=w.function,S=d[x];if(S){if(c&&c!==x){const M=`Invalid tool_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:_,content:M});continue}}else{const M=`Invalid tool_call: ${JSON.stringify(x)}. Available options are: ${Object.keys(d).map(P=>JSON.stringify(P)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:_,content:M});continue}let E;try{E=YL(S)?await S.parse(j):j}catch(M){const P=M instanceof Error?M.message:String(M);this._addMessage({role:a,tool_call_id:_,content:P});continue}const O=await S.function(E,this),N=Hn(this,Cn,"m",F_).call(this,O);if(this._addMessage({role:a,tool_call_id:_,content:N}),c)return}}}}Cn=new WeakSet,R_=function(){return Hn(this,Cn,"m",am).call(this).content??null},am=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(_c(t)){const{function_call:n,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new et("stream ended without producing a ChatCompletionMessage with role=assistant")},D_=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(_c(r)&&(r!=null&&r.function_call))return r.function_call;if(_c(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},L_=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(e6(t)&&t.content!=null||t6(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},$_=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},i6=function(e){if(e.n!=null&&e.n>1)throw new et("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},F_=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class gd extends c6{static runFunctions(t,n,r){const a=new gd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new gd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}_addMessage(t,n=!0){super._addMessage(t,n),_c(t)&&t.content&&this._emit("content",t.content)}}const l6=1,u6=2,d6=4,p6=8,f6=16,h6=32,m6=64,y6=128,g6=256,v6=y6|g6,b6=f6|h6|v6|m6,w6=l6|u6|b6,x6=d6|p6,kde=w6|x6,un={STR:l6,NUM:u6,ARR:d6,OBJ:p6,NULL:f6,BOOL:h6,NAN:m6,INFINITY:y6,MINUS_INFINITY:g6,INF:v6,SPECIAL:b6,ATOM:w6,COLLECTION:x6,ALL:kde};class Ade extends Error{}class Tde extends Error{}function Ide(e,t=un.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return Rde(e.trim(),t)}const Rde=(e,t)=>{const n=e.length;let r=0;const a=p=>{throw new Ade(`${p} at position ${r}`)},o=p=>{throw new Tde(`${p} at position ${r}`)},i=()=>(d(),r>=n&&a("Unexpected end of input"),e[r]==='"'?s():e[r]==="{"?c():e[r]==="["?l():e.substring(r,r+4)==="null"||un.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):e.substring(r,r+4)==="true"||un.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):e.substring(r,r+5)==="false"||un.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):e.substring(r,r+8)==="Infinity"||un.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):e.substring(r,r+9)==="-Infinity"||un.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):e.substring(r,r+3)==="NaN"||un.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),s=()=>{const p=r;let f=!1;for(r++;r<n&&(e[r]!=='"'||f&&e[r-1]==="\\");)f=e[r]==="\\"?!f:!1,r++;if(e.charAt(r)=='"')try{return JSON.parse(e.substring(p,++r-Number(f)))}catch(y){o(String(y))}else if(un.STR&t)try{return JSON.parse(e.substring(p,r-Number(f))+'"')}catch{return JSON.parse(e.substring(p,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{r++,d();const p={};try{for(;e[r]!=="}";){if(d(),r>=n&&un.OBJ&t)return p;const f=s();d(),r++;try{const y=i();Object.defineProperty(p,f,{value:y,writable:!0,enumerable:!0,configurable:!0})}catch(y){if(un.OBJ&t)return p;throw y}d(),e[r]===","&&r++}}catch{if(un.OBJ&t)return p;a("Expected '}' at end of object")}return r++,p},l=()=>{r++;const p=[];try{for(;e[r]!=="]";)p.push(i()),d(),e[r]===","&&r++}catch{if(un.ARR&t)return p;a("Expected ']' at end of array")}return r++,p},u=()=>{if(r===0){e==="-"&&un.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(f){if(un.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}o(String(f))}}const p=r;for(e[r]==="-"&&r++;e[r]&&!",]}".includes(e[r]);)r++;r==n&&!(un.NUM&t)&&a("Unterminated number literal");try{return JSON.parse(e.substring(p,r))}catch{e.substring(p,r)==="-"&&un.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e.substring(p,e.lastIndexOf("e")))}catch(f){o(String(f))}}},d=()=>{for(;r<n&&` 
\r	`.includes(e[r]);)r++};return i()},_6=e=>Ide(e,un.ALL^un.NUM);var Sc=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Et=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},an,xo,Ec,oi,B_,om,z_,V_,W_,im,U_,j6;class vd extends c6{constructor(t){super(),an.add(this),xo.set(this,void 0),Ec.set(this,void 0),oi.set(this,void 0),Sc(this,xo,t,"f"),Sc(this,Ec,[],"f")}get currentChatCompletionSnapshot(){return Et(this,oi,"f")}static fromReadableStream(t){const n=new vd(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,r){const a=new vd(n);return a._run(()=>a._runChatCompletion(t,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(t,n,r){var i;super._createChatCompletion;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Et(this,an,"m",B_).call(this);const o=await t.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const s of o)Et(this,an,"m",z_).call(this,s);if((i=o.controller.signal)!=null&&i.aborted)throw new wr;return this._addChatCompletion(Et(this,an,"m",im).call(this))}async _fromReadableStream(t,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Et(this,an,"m",B_).call(this),this._connected();const a=Pa.fromReadableStream(t,this.controller);let o;for await(const s of a)o&&o!==s.id&&this._addChatCompletion(Et(this,an,"m",im).call(this)),Et(this,an,"m",z_).call(this,s),o=s.id;if((i=a.controller.signal)!=null&&i.aborted)throw new wr;return this._addChatCompletion(Et(this,an,"m",im).call(this))}[(xo=new WeakMap,Ec=new WeakMap,oi=new WeakMap,an=new WeakSet,B_=function(){this.ended||Sc(this,oi,void 0,"f")},om=function(t){let n=Et(this,Ec,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Et(this,Ec,"f")[t.index]=n,n)},z_=function(t){var r,a,o,i,s,c,l,u,d,p,f,y,m,v,b;if(this.ended)return;const n=Et(this,an,"m",j6).call(this,t);this._emit("chunk",t,n);for(const w of t.choices){const _=n.choices[w.index];w.delta.content!=null&&((r=_.message)==null?void 0:r.role)==="assistant"&&((a=_.message)!=null&&a.content)&&(this._emit("content",w.delta.content,_.message.content),this._emit("content.delta",{delta:w.delta.content,snapshot:_.message.content,parsed:_.message.parsed})),w.delta.refusal!=null&&((o=_.message)==null?void 0:o.role)==="assistant"&&((i=_.message)!=null&&i.refusal)&&this._emit("refusal.delta",{delta:w.delta.refusal,snapshot:_.message.refusal}),((s=w.logprobs)==null?void 0:s.content)!=null&&((c=_.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(l=w.logprobs)==null?void 0:l.content,snapshot:((u=_.logprobs)==null?void 0:u.content)??[]}),((d=w.logprobs)==null?void 0:d.refusal)!=null&&((p=_.message)==null?void 0:p.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(f=w.logprobs)==null?void 0:f.refusal,snapshot:((y=_.logprobs)==null?void 0:y.refusal)??[]});const x=Et(this,an,"m",om).call(this,_);_.finish_reason&&(Et(this,an,"m",W_).call(this,_),x.current_tool_call_index!=null&&Et(this,an,"m",V_).call(this,_,x.current_tool_call_index));for(const j of w.delta.tool_calls??[])x.current_tool_call_index!==j.index&&(Et(this,an,"m",W_).call(this,_),x.current_tool_call_index!=null&&Et(this,an,"m",V_).call(this,_,x.current_tool_call_index)),x.current_tool_call_index=j.index;for(const j of w.delta.tool_calls??[]){const S=(m=_.message.tool_calls)==null?void 0:m[j.index];S!=null&&S.type&&((S==null?void 0:S.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=S.function)==null?void 0:v.name,index:j.index,arguments:S.function.arguments,parsed_arguments:S.function.parsed_arguments,arguments_delta:((b=j.function)==null?void 0:b.arguments)??""}):S==null||S.type)}}},V_=function(t,n){var a,o,i;if(Et(this,an,"m",om).call(this,t).done_tool_calls.has(n))return;const r=(a=t.message.tool_calls)==null?void 0:a[n];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const s=(i=(o=Et(this,xo,"f"))==null?void 0:o.tools)==null?void 0:i.find(c=>c.type==="function"&&c.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:n,arguments:r.function.arguments,parsed_arguments:yd(s)?s.$parseRaw(r.function.arguments):s!=null&&s.function.strict?JSON.parse(r.function.arguments):null})}else r.type},W_=function(t){var r,a;const n=Et(this,an,"m",om).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const o=Et(this,an,"m",U_).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},im=function(){if(this.ended)throw new et("stream has ended, this shouldn't happen");const t=Et(this,oi,"f");if(!t)throw new et("request ended without sending any chunks");return Sc(this,oi,void 0,"f"),Sc(this,Ec,[],"f"),Dde(t,Et(this,xo,"f"))},U_=function(){var n;const t=(n=Et(this,xo,"f"))==null?void 0:n.response_format;return a6(t)?t:null},j6=function(t){var n,r,a,o;let i=Et(this,oi,"f");const{choices:s,...c}=t;i?Object.assign(i,c):i=Sc(this,oi,{...c,choices:[]},"f");for(const{delta:l,finish_reason:u,index:d,logprobs:p=null,...f}of t.choices){let y=i.choices[d];if(y||(y=i.choices[d]={finish_reason:u,index:d,message:{},logprobs:p,...f}),p)if(!y.logprobs)y.logprobs=Object.assign({},p);else{const{content:j,refusal:S,...E}=p;Object.assign(y.logprobs,E),j&&((n=y.logprobs).content??(n.content=[]),y.logprobs.content.push(...j)),S&&((r=y.logprobs).refusal??(r.refusal=[]),y.logprobs.refusal.push(...S))}if(u&&(y.finish_reason=u,Et(this,xo,"f")&&o6(Et(this,xo,"f")))){if(u==="length")throw new AL;if(u==="content_filter")throw new TL}if(Object.assign(y,f),!l)continue;const{content:m,refusal:v,function_call:b,role:w,tool_calls:_,...x}=l;if(Object.assign(y.message,x),v&&(y.message.refusal=(y.message.refusal||"")+v),w&&(y.message.role=w),b&&(y.message.function_call?(b.name&&(y.message.function_call.name=b.name),b.arguments&&((a=y.message.function_call).arguments??(a.arguments=""),y.message.function_call.arguments+=b.arguments)):y.message.function_call=b),m&&(y.message.content=(y.message.content||"")+m,!y.message.refusal&&Et(this,an,"m",U_).call(this)&&(y.message.parsed=_6(y.message.content))),_){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:j,id:S,type:E,function:O,...N}of _){const M=(o=y.message.tool_calls)[j]??(o[j]={});Object.assign(M,N),S&&(M.id=S),E&&(M.type=E),O&&(M.function??(M.function={name:O.name??"",arguments:""})),O!=null&&O.name&&(M.function.name=O.name),O!=null&&O.arguments&&(M.function.arguments+=O.arguments,Mde(Et(this,xo,"f"),M)&&(M.function.parsed_arguments=_6(M.function.arguments)))}}}return i},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("chunk",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Pa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Dde(e,t){const{id:n,choices:r,created:a,model:o,system_fingerprint:i,...s}=e,c={...s,id:n,choices:r.map(({message:l,finish_reason:u,index:d,logprobs:p,...f})=>{if(!u)throw new et(`missing finish_reason for choice ${d}`);const{content:y=null,function_call:m,tool_calls:v,...b}=l,w=l.role;if(!w)throw new et(`missing role for choice ${d}`);if(m){const{arguments:_,name:x}=m;if(_==null)throw new et(`missing function_call.arguments for choice ${d}`);if(!x)throw new et(`missing function_call.name for choice ${d}`);return{...f,message:{content:y,function_call:{arguments:_,name:x},role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:p}}return v?{...f,index:d,finish_reason:u,logprobs:p,message:{...b,role:w,content:y,refusal:l.refusal??null,tool_calls:v.map((_,x)=>{const{function:j,type:S,id:E,...O}=_,{arguments:N,name:M,...P}=j||{};if(E==null)throw new et(`missing choices[${d}].tool_calls[${x}].id
${sm(e)}`);if(S==null)throw new et(`missing choices[${d}].tool_calls[${x}].type
${sm(e)}`);if(M==null)throw new et(`missing choices[${d}].tool_calls[${x}].function.name
${sm(e)}`);if(N==null)throw new et(`missing choices[${d}].tool_calls[${x}].function.arguments
${sm(e)}`);return{...O,id:E,type:S,function:{...P,name:M,arguments:N}}})}}:{...f,message:{...b,content:y,role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:p}}),created:a,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Ode(c,t)}function sm(e){return JSON.stringify(e)}class Oc extends vd{static fromReadableStream(t){const n=new Oc(null);return n._run(()=>n._fromReadableStream(t)),n}static runFunctions(t,n,r){const a=new Oc(null),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new Oc(n),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}}let S6=class extends ht{parse(e,t){return Pde(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>I_(n,e))}runFunctions(e,t){return e.stream?Oc.runFunctions(this._client,e,t):gd.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Oc.runTools(this._client,e,t):gd.runTools(this._client,e,t)}stream(e,t){return vd.createChatCompletion(this._client,e,t)}};class q_ extends ht{constructor(){super(...arguments),this.completions=new S6(this._client)}}(function(e){e.Completions=S6})(q_||(q_={}));class E6 extends ht{create(t,n){return this._client.post("/realtime/sessions",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class H_ extends ht{constructor(){super(...arguments),this.sessions=new E6(this._client)}}H_.Sessions=E6;var Ie=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},dr=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},wn,K_,ka,cm,Xr,Qi,Cc,Gi,lm,pr,um,dm,bd,wd,xd,O6,C6,N6,M6,P6,k6,A6;class Qr extends r6{constructor(){super(...arguments),wn.add(this),K_.set(this,[]),ka.set(this,{}),cm.set(this,{}),Xr.set(this,void 0),Qi.set(this,void 0),Cc.set(this,void 0),Gi.set(this,void 0),lm.set(this,void 0),pr.set(this,void 0),um.set(this,void 0),dm.set(this,void 0),bd.set(this,void 0)}[(K_=new WeakMap,ka=new WeakMap,cm=new WeakMap,Xr=new WeakMap,Qi=new WeakMap,Cc=new WeakMap,Gi=new WeakMap,lm=new WeakMap,pr=new WeakMap,um=new WeakMap,dm=new WeakMap,bd=new WeakMap,wn=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("event",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new Qr;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Pa.fromReadableStream(t,this.controller);for await(const i of a)Ie(this,wn,"m",wd).call(this,i);if((o=a.controller.signal)!=null&&o.aborted)throw new wr;return this._addRun(Ie(this,wn,"m",xd).call(this))}toReadableStream(){return new Pa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,r,a,o){const i=new Qr;return i._run(()=>i._runToolAssistantStream(t,n,r,a,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(t,n,r,a,o){var l;const i=o==null?void 0:o.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...a,stream:!0},c=await t.submitToolOutputs(n,r,s,{...o,signal:this.controller.signal});this._connected();for await(const u of c)Ie(this,wn,"m",wd).call(this,u);if((l=c.controller.signal)!=null&&l.aborted)throw new wr;return this._addRun(Ie(this,wn,"m",xd).call(this))}static createThreadAssistantStream(t,n,r){const a=new Qr;return a._run(()=>a._threadAssistantStream(t,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(t,n,r,a){const o=new Qr;return o._run(()=>o._runAssistantStream(t,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return Ie(this,um,"f")}currentRun(){return Ie(this,dm,"f")}currentMessageSnapshot(){return Ie(this,Xr,"f")}currentRunStepSnapshot(){return Ie(this,bd,"f")}async finalRunSteps(){return await this.done(),Object.values(Ie(this,ka,"f"))}async finalMessages(){return await this.done(),Object.values(Ie(this,cm,"f"))}async finalRun(){if(await this.done(),!Ie(this,Qi,"f"))throw Error("Final run was not received.");return Ie(this,Qi,"f")}async _createThreadAssistantStream(t,n,r){var s;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},i=await t.createAndRun(o,{...r,signal:this.controller.signal});this._connected();for await(const c of i)Ie(this,wn,"m",wd).call(this,c);if((s=i.controller.signal)!=null&&s.aborted)throw new wr;return this._addRun(Ie(this,wn,"m",xd).call(this))}async _createAssistantStream(t,n,r,a){var c;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},s=await t.create(n,i,{...a,signal:this.controller.signal});this._connected();for await(const l of s)Ie(this,wn,"m",wd).call(this,l);if((c=s.controller.signal)!=null&&c.aborted)throw new wr;return this._addRun(Ie(this,wn,"m",xd).call(this))}static accumulateDelta(t,n){for(const[r,a]of Object.entries(n)){if(!t.hasOwnProperty(r)){t[r]=a;continue}let o=t[r];if(o==null){t[r]=a;continue}if(r==="index"||r==="type"){t[r]=a;continue}if(typeof o=="string"&&typeof a=="string")o+=a;else if(typeof o=="number"&&typeof a=="number")o+=a;else if(C_(o)&&C_(a))o=this.accumulateDelta(o,a);else if(Array.isArray(o)&&Array.isArray(a)){if(o.every(i=>typeof i=="string"||typeof i=="number")){o.push(...a);continue}for(const i of a){if(!C_(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const s=i.index;if(s==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof s!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const c=o[s];c==null?o.push(i):o[s]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${o}`);t[r]=o}return t}_addRun(t){return t}async _threadAssistantStream(t,n,r){return await this._createThreadAssistantStream(n,t,r)}async _runAssistantStream(t,n,r,a){return await this._createAssistantStream(n,t,r,a)}async _runToolAssistantStream(t,n,r,a,o){return await this._createToolAssistantStream(r,t,n,a,o)}}wd=function(e){if(!this.ended)switch(dr(this,um,e,"f"),Ie(this,wn,"m",N6).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Ie(this,wn,"m",A6).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ie(this,wn,"m",C6).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Ie(this,wn,"m",O6).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},xd=function(){if(this.ended)throw new et("stream has ended, this shouldn't happen");if(!Ie(this,Qi,"f"))throw Error("Final run has not been received");return Ie(this,Qi,"f")},O6=function(e){const[t,n]=Ie(this,wn,"m",P6).call(this,e,Ie(this,Xr,"f"));dr(this,Xr,t,"f"),Ie(this,cm,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,o=t.content[r.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=Ie(this,Cc,"f")){if(Ie(this,Gi,"f"))switch(Ie(this,Gi,"f").type){case"text":this._emit("textDone",Ie(this,Gi,"f").text,Ie(this,Xr,"f"));break;case"image_file":this._emit("imageFileDone",Ie(this,Gi,"f").image_file,Ie(this,Xr,"f"));break}dr(this,Cc,r.index,"f")}dr(this,Gi,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Ie(this,Cc,"f")!==void 0){const r=e.data.content[Ie(this,Cc,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,Ie(this,Xr,"f"));break;case"text":this._emit("textDone",r.text,Ie(this,Xr,"f"));break}}Ie(this,Xr,"f")&&this._emit("messageDone",e.data),dr(this,Xr,void 0,"f")}},C6=function(e){const t=Ie(this,wn,"m",M6).call(this,e);switch(dr(this,bd,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const r of n.step_details.tool_calls)r.index==Ie(this,lm,"f")?this._emit("toolCallDelta",r,t.step_details.tool_calls[r.index]):(Ie(this,pr,"f")&&this._emit("toolCallDone",Ie(this,pr,"f")),dr(this,lm,r.index,"f"),dr(this,pr,t.step_details.tool_calls[r.index],"f"),Ie(this,pr,"f")&&this._emit("toolCallCreated",Ie(this,pr,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":dr(this,bd,void 0,"f"),e.data.step_details.type=="tool_calls"&&Ie(this,pr,"f")&&(this._emit("toolCallDone",Ie(this,pr,"f")),dr(this,pr,void 0,"f")),this._emit("runStepDone",e.data,t);break}},N6=function(e){Ie(this,K_,"f").push(e),this._emit("event",e)},M6=function(e){switch(e.event){case"thread.run.step.created":return Ie(this,ka,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Ie(this,ka,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=Qr.accumulateDelta(t,n.delta);Ie(this,ka,"f")[e.data.id]=r}return Ie(this,ka,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Ie(this,ka,"f")[e.data.id]=e.data;break}if(Ie(this,ka,"f")[e.data.id])return Ie(this,ka,"f")[e.data.id];throw new Error("No snapshot available")},P6=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let o=t.content[a.index];t.content[a.index]=Ie(this,wn,"m",k6).call(this,a,o)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},k6=function(e,t){return Qr.accumulateDelta(t,e)},A6=function(e){switch(dr(this,dm,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":dr(this,Qi,e.data,"f"),Ie(this,pr,"f")&&(this._emit("toolCallDone",Ie(this,pr,"f")),dr(this,pr,void 0,"f"));break}};class Z_ extends ht{create(t,n,r){return this._client.post(`/threads/${t}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/messages/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return qn(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/messages`,X_,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n,r){return this._client.delete(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class X_ extends Kr{}Z_.MessagesPage=X_;class Q_ extends ht{retrieve(t,n,r,a={},o){return qn(a)?this.retrieve(t,n,r,{},a):this._client.get(`/threads/${t}/runs/${n}/steps/${r}`,{query:a,...o,headers:{"OpenAI-Beta":"assistants=v2",...o==null?void 0:o.headers}})}list(t,n,r={},a){return qn(r)?this.list(t,n,{},r):this._client.getAPIList(`/threads/${t}/runs/${n}/steps`,G_,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class G_ extends Kr{}Q_.RunStepsPage=G_;class _d extends ht{constructor(){super(...arguments),this.steps=new Q_(this._client)}create(t,n,r){const{include:a,...o}=n;return this._client.post(`/threads/${t}/runs`,{query:{include:a},body:o,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(t,n,r){return this._client.get(`/threads/${t}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return qn(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/runs`,J_,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/threads/${t}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n,r);return await this.poll(t,a.id,r)}createAndStream(t,n,r){return Qr.createAssistantStream(t,this._client.beta.threads.runs,n,r)}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:{...r==null?void 0:r.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await ud(s);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,n,r){return Qr.createAssistantStream(t,this._client.beta.threads.runs,n,r)}submitToolOutputs(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}/submit_tool_outputs`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(t,n,r,a){const o=await this.submitToolOutputs(t,n,r,a);return await this.poll(t,o.id,a)}submitToolOutputsStream(t,n,r,a){return Qr.createToolAssistantStream(t,n,this._client.beta.threads.runs,r,a)}}class J_ extends Kr{}_d.RunsPage=J_,_d.Steps=Q_,_d.RunStepsPage=G_;class Nc extends ht{constructor(){super(...arguments),this.runs=new _d(this._client),this.messages=new Z_(this._client)}create(t={},n){return qn(t)?this.create({},t):this._client.post("/threads",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/threads/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n){return this._client.delete(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}async createAndRunPoll(t,n){const r=await this.createAndRun(t,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(t,n){return Qr.createThreadAssistantStream(t,this._client.beta.threads,n)}}Nc.Runs=_d,Nc.RunsPage=J_,Nc.Messages=Z_,Nc.MessagesPage=X_;const Lde=async e=>{const t=await Promise.allSettled(e),n=t.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const a of t)a.status==="fulfilled"&&r.push(a.value);return r};let Y_=class extends ht{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return qn(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,pm,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for((n==null?void 0:n.pollIntervalMs)&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),o=a.data;switch(o.status){case"in_progress":let i=5e3;if(n!=null&&n.pollIntervalMs)i=n.pollIntervalMs;else{const s=a.response.headers.get("openai-poll-after-ms");if(s){const c=parseInt(s);isNaN(c)||(i=c)}}await ud(i);break;case"failed":case"completed":return o}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}};class pm extends Kr{}Y_.VectorStoreFilesPage=pm;class T6 extends ht{create(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/vector_stores/${t}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n);return await this.poll(t,a.id,r)}listFiles(t,n,r={},a){return qn(r)?this.listFiles(t,n,{},r):this._client.getAPIList(`/vector_stores/${t}/file_batches/${n}/files`,pm,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:a}).withResponse();switch(o.status){case"in_progress":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await ud(s);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:n,fileIds:r=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=(a==null?void 0:a.maxConcurrency)??5,i=Math.min(o,n.length),s=this._client,c=n.values(),l=[...r];async function u(p){for(let f of p){const y=await s.files.create({file:f,purpose:"assistants"},a);l.push(y.id)}}const d=Array(i).fill(c).map(u);return await Lde(d),await this.createAndPoll(t,{file_ids:l})}}class Mc extends ht{constructor(){super(...arguments),this.files=new Y_(this._client),this.fileBatches=new T6(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/vector_stores/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return qn(t)?this.list({},t):this._client.getAPIList("/vector_stores",ej,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class ej extends Kr{}Mc.VectorStoresPage=ej,Mc.Files=Y_,Mc.VectorStoreFilesPage=pm,Mc.FileBatches=T6;class ii extends ht{constructor(){super(...arguments),this.realtime=new H_(this._client),this.vectorStores=new Mc(this._client),this.chat=new q_(this._client),this.assistants=new k_(this._client),this.threads=new Nc(this._client)}}ii.Realtime=H_,ii.VectorStores=Mc,ii.VectorStoresPage=ej,ii.Assistants=k_,ii.AssistantsPage=A_,ii.Threads=Nc;class I6 extends ht{create(t,n){return this._client.post("/completions",{body:t,...n,stream:t.stream??!1})}}class R6 extends ht{create(t,n){return this._client.post("/embeddings",{body:t,...n})}}class tj extends ht{create(t,n){return this._client.post("/files",bc({body:t,...n}))}retrieve(t,n){return this._client.get(`/files/${t}`,n)}list(t={},n){return qn(t)?this.list({},t):this._client.getAPIList("/files",nj,{query:t,...n})}del(t,n){return this._client.delete(`/files/${t}`,n)}content(t,n){return this._client.get(`/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(t,n){return this._client.get(`/files/${t}/content`,n)}async waitForProcessing(t,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),o=Date.now();let i=await this.retrieve(t);for(;!i.status||!a.has(i.status);)if(await ud(n),i=await this.retrieve(t),Date.now()-o>r)throw new Zh({message:`Giving up on waiting for file ${t} to finish processing after ${r} milliseconds.`});return i}}class nj extends Kr{}tj.FileObjectsPage=nj;class rj extends ht{list(t,n={},r){return qn(n)?this.list(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,aj,{query:n,...r})}}class aj extends Kr{}rj.FineTuningJobCheckpointsPage=aj;class Pc extends ht{constructor(){super(...arguments),this.checkpoints=new rj(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(`/fine_tuning/jobs/${t}`,n)}list(t={},n){return qn(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",oj,{query:t,...n})}cancel(t,n){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},r){return qn(n)?this.listEvents(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,ij,{query:n,...r})}}class oj extends Kr{}class ij extends Kr{}Pc.FineTuningJobsPage=oj,Pc.FineTuningJobEventsPage=ij,Pc.Checkpoints=rj,Pc.FineTuningJobCheckpointsPage=aj;class jd extends ht{constructor(){super(...arguments),this.jobs=new Pc(this._client)}}jd.Jobs=Pc,jd.FineTuningJobsPage=oj,jd.FineTuningJobEventsPage=ij;class D6 extends ht{createVariation(t,n){return this._client.post("/images/variations",bc({body:t,...n}))}edit(t,n){return this._client.post("/images/edits",bc({body:t,...n}))}generate(t,n){return this._client.post("/images/generations",{body:t,...n})}}class sj extends ht{retrieve(t,n){return this._client.get(`/models/${t}`,n)}list(t){return this._client.getAPIList("/models",cj,t)}del(t,n){return this._client.delete(`/models/${t}`,n)}}class cj extends jde{}sj.ModelsPage=cj;class L6 extends ht{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class $6 extends ht{create(t,n,r){return this._client.post(`/uploads/${t}/parts`,bc({body:n,...r}))}}class lj extends ht{constructor(){super(...arguments),this.parts=new $6(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(`/uploads/${t}/cancel`,n)}complete(t,n,r){return this._client.post(`/uploads/${t}/complete`,{body:n,...r})}}lj.Parts=$6;var F6;let it=class extends ude{constructor({baseURL:e=Jh("OPENAI_BASE_URL"),apiKey:t=Jh("OPENAI_API_KEY"),organization:n=Jh("OPENAI_ORG_ID")??null,project:r=Jh("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new et("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&xde())throw new et(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new I6(this),this.chat=new N_(this),this.embeddings=new R6(this),this.files=new tj(this),this.images=new D6(this),this.audio=new dd(this),this.moderations=new L6(this),this.models=new sj(this),this.fineTuning=new jd(this),this.beta=new ii(this),this.batches=new M_(this),this.uploads=new lj(this),this._options=o,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Kue(e,{arrayFormat:"brackets"})}};F6=it,it.OpenAI=F6,it.DEFAULT_TIMEOUT=6e5,it.OpenAIError=et,it.APIError=bn,it.APIConnectionError=Kh,it.APIConnectionTimeoutError=Zh,it.APIUserAbortError=wr,it.NotFoundError=CL,it.ConflictError=NL,it.RateLimitError=PL,it.BadRequestError=SL,it.AuthenticationError=EL,it.InternalServerError=kL,it.PermissionDeniedError=OL,it.UnprocessableEntityError=ML,it.toFile=LL,it.fileFromPath=_L,it.Completions=I6,it.Chat=N_,it.Embeddings=R6,it.Files=tj,it.FileObjectsPage=nj,it.Images=D6,it.Audio=dd,it.Moderations=L6,it.Models=sj,it.ModelsPage=cj,it.FineTuning=jd,it.Beta=ii,it.Batches=M_,it.BatchesPage=P_,it.Uploads=lj;var $de=typeof window=="object"?window:{},Ze="0123456789abcdef".split(""),Fde=[-2147483648,8388608,32768,128],Gr=[24,16,8,0],dn=[];function Jr(e){e?(dn[0]=dn[16]=dn[1]=dn[2]=dn[3]=dn[4]=dn[5]=dn[6]=dn[7]=dn[8]=dn[9]=dn[10]=dn[11]=dn[12]=dn[13]=dn[14]=dn[15]=0,this.blocks=dn):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Jr.prototype.update=function(e){if(!this.finalized){var t=typeof e!="string";t&&e.constructor===$de.ArrayBuffer&&(e=new Uint8Array(e));for(var n,r=0,a,o=e.length||0,i=this.blocks;r<o;){if(this.hashed&&(this.hashed=!1,i[0]=this.block,i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),t)for(a=this.start;r<o&&a<64;++r)i[a>>2]|=e[r]<<Gr[a++&3];else for(a=this.start;r<o&&a<64;++r)n=e.charCodeAt(r),n<128?i[a>>2]|=n<<Gr[a++&3]:n<2048?(i[a>>2]|=(192|n>>6)<<Gr[a++&3],i[a>>2]|=(128|n&63)<<Gr[a++&3]):n<55296||n>=57344?(i[a>>2]|=(224|n>>12)<<Gr[a++&3],i[a>>2]|=(128|n>>6&63)<<Gr[a++&3],i[a>>2]|=(128|n&63)<<Gr[a++&3]):(n=65536+((n&1023)<<10|e.charCodeAt(++r)&1023),i[a>>2]|=(240|n>>18)<<Gr[a++&3],i[a>>2]|=(128|n>>12&63)<<Gr[a++&3],i[a>>2]|=(128|n>>6&63)<<Gr[a++&3],i[a>>2]|=(128|n&63)<<Gr[a++&3]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=i[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Jr.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=Fde[t&3],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Jr.prototype.hash=function(){var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4,o,i,s,c=this.blocks;for(i=16;i<80;++i)s=c[i-3]^c[i-8]^c[i-14]^c[i-16],c[i]=s<<1|s>>>31;for(i=0;i<20;i+=5)o=t&n|~t&r,s=e<<5|e>>>27,a=s+o+a+1518500249+c[i]<<0,t=t<<30|t>>>2,o=e&t|~e&n,s=a<<5|a>>>27,r=s+o+r+1518500249+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|~a&t,s=r<<5|r>>>27,n=s+o+n+1518500249+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|~r&e,s=n<<5|n>>>27,t=s+o+t+1518500249+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|~n&a,s=t<<5|t>>>27,e=s+o+e+1518500249+c[i+4]<<0,n=n<<30|n>>>2;for(;i<40;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a+1859775393+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r+1859775393+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n+1859775393+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t+1859775393+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e+1859775393+c[i+4]<<0,n=n<<30|n>>>2;for(;i<60;i+=5)o=t&n|t&r|n&r,s=e<<5|e>>>27,a=s+o+a-1894007588+c[i]<<0,t=t<<30|t>>>2,o=e&t|e&n|t&n,s=a<<5|a>>>27,r=s+o+r-1894007588+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|a&t|e&t,s=r<<5|r>>>27,n=s+o+n-1894007588+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|r&e|a&e,s=n<<5|n>>>27,t=s+o+t-1894007588+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|n&a|r&a,s=t<<5|t>>>27,e=s+o+e-1894007588+c[i+4]<<0,n=n<<30|n>>>2;for(;i<80;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a-899497514+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r-899497514+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n-899497514+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t-899497514+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e-899497514+c[i+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+a<<0},Jr.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return Ze[e>>28&15]+Ze[e>>24&15]+Ze[e>>20&15]+Ze[e>>16&15]+Ze[e>>12&15]+Ze[e>>8&15]+Ze[e>>4&15]+Ze[e&15]+Ze[t>>28&15]+Ze[t>>24&15]+Ze[t>>20&15]+Ze[t>>16&15]+Ze[t>>12&15]+Ze[t>>8&15]+Ze[t>>4&15]+Ze[t&15]+Ze[n>>28&15]+Ze[n>>24&15]+Ze[n>>20&15]+Ze[n>>16&15]+Ze[n>>12&15]+Ze[n>>8&15]+Ze[n>>4&15]+Ze[n&15]+Ze[r>>28&15]+Ze[r>>24&15]+Ze[r>>20&15]+Ze[r>>16&15]+Ze[r>>12&15]+Ze[r>>8&15]+Ze[r>>4&15]+Ze[r&15]+Ze[a>>28&15]+Ze[a>>24&15]+Ze[a>>20&15]+Ze[a>>16&15]+Ze[a>>12&15]+Ze[a>>8&15]+Ze[a>>4&15]+Ze[a&15]},Jr.prototype.toString=Jr.prototype.hex,Jr.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,a>>24&255,a>>16&255,a>>8&255,a&255]},Jr.prototype.array=Jr.prototype.digest,Jr.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};const Bde=e=>new Jr(!0).update(e).hex(),B6=(...e)=>Bde(e.join("_"));class zde{}const Vde=new Map;class uj extends zde{constructor(t){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=t??new Map}lookup(t,n){return Promise.resolve(this.cache.get(B6(t,n))??null)}async update(t,n,r){this.cache.set(B6(t,n),r)}static global(){return new uj(Vde)}}const Wde=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e;function Ude(e){return typeof e!="object"||!e?!1:!!("type"in e&&e.type==="function"&&"function"in e&&typeof e.function=="object"&&e.function&&"name"in e.function&&"parameters"in e.function)}const qde=()=>!1;class Hde extends Rp{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(t){super(t),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=t.verbose??qde(),this.callbacks=t.callbacks,this.tags=t.tags??[],this.metadata=t.metadata??{}}}class Kde extends Hde{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:t,callbackManager:n,...r}){super({callbacks:t??n,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r.cache=="object"?this.cache=r.cache:r.cache?this.cache=uj.global():this.cache=void 0,this.caller=new _Ae(r??{})}async getNumTokens(t){if(typeof t!="string")return 0;let n=Math.ceil(t.length/4);if(!this._encoding)try{this._encoding=await jAe("modelName"in this?Wde(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{n=this._encoding.encode(t).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return n}static _convertInputToPromptValue(t){return typeof t=="string"?new tL(t):Array.isArray(t)?new xue(t.map(Dp)):t}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:t,...n}){const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([a,o])=>o!==void 0).map(([a,o])=>`${a}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(t){throw new Error("Use .toJSON() instead")}}class fm extends Rp{static lc_name(){return"RunnablePassthrough"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t&&(this.func=t.func)}async invoke(t,n){const r=lK(n);return this.func&&await this.func(t,r),this._callWithConfig(a=>Promise.resolve(a),t,r)}async*transform(t,n){const r=lK(n);let a,o=!0;for await(const i of this._transformStreamWithConfig(t,s=>s,r))if(yield i,o)if(a===void 0)a=i;else try{a=uK(a,i)}catch{a=void 0,o=!1}this.func&&a!==void 0&&await this.func(a,r)}static assign(t){return new SAe(new EAe({steps:t}))}}function z6(e){return typeof(e==null?void 0:e.parse)=="function"}class si extends Kde{constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(t){const[n,r]=super._separateRunnableConfigFromCallOptions(t);return r.signal=n.signal,[n,r]}async invoke(t,n){const r=si._convertInputToPromptValue(t);return(await this.generatePrompt([r],n,n==null?void 0:n.callbacks)).generations[0][0].message}async*_streamResponseChunks(t,n,r){throw new Error("Not implemented.")}async*_streamIterator(t,n){var r;if(this._streamResponseChunks===si.prototype._streamResponseChunks)yield this.invoke(t,n);else{const a=si._convertInputToPromptValue(t).toChatMessages(),[o,i]=this._separateRunnableConfigFromCallOptionsCompat(n),s={...o.metadata,...this.getLsParams(i)},c=await _N.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),[a],o.runId,void 0,l,void 0,void 0,o.runName));let d;try{for await(const p of this._streamResponseChunks(a,i,u==null?void 0:u[0])){if(p.message.id==null){const f=(r=u==null?void 0:u.at(0))==null?void 0:r.runId;f!=null&&p.message._updateId(`run-${f}`)}p.message.response_metadata={...p.generationInfo,...p.message.response_metadata},yield p.message,d?d=d.concat(p):d=p}}catch(p){throw await Promise.all((u??[]).map(f=>f==null?void 0:f.handleLLMError(p))),p}await Promise.all((u??[]).map(p=>p==null?void 0:p.handleLLMEnd({generations:[[d]]})))}}getLsParams(t){return{ls_model_type:"chat",ls_stop:t.stop}}async _generateUncached(t,n,r){var p,f;const a=t.map(y=>y.map(Dp)),o={...r.metadata,...this.getLsParams(n)},i=await _N.configure(r.callbacks,this.callbacks,r.tags,this.tags,o,this.metadata,{verbose:this.verbose}),s={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:1},c=await(i==null?void 0:i.handleChatModelStart(this.toJSON(),a,r.runId,void 0,s,void 0,void 0,r.runName)),l=[],u=[];if(c!=null&&c[0].handlers.find(y=>OAe(y)||CAe(y))&&a.length===1&&this._streamResponseChunks!==si.prototype._streamResponseChunks)try{const y=await this._streamResponseChunks(a[0],n,c==null?void 0:c[0]);let m;for await(const v of y){if(v.message.id==null){const b=(p=c==null?void 0:c.at(0))==null?void 0:p.runId;b!=null&&v.message._updateId(`run-${b}`)}m===void 0?m=v:m=uK(m,v)}if(m===void 0)throw new Error("Received empty response from chat model call.");l.push([m]),await(c==null?void 0:c[0].handleLLMEnd({generations:l,llmOutput:{}}))}catch(y){throw await(c==null?void 0:c[0].handleLLMError(y)),y}else{const y=await Promise.allSettled(a.map((m,v)=>this._generate(m,{...n,promptIndex:v},c==null?void 0:c[v])));await Promise.all(y.map(async(m,v)=>{var b,w,_;if(m.status==="fulfilled"){const x=m.value;for(const j of x.generations){if(j.message.id==null){const S=(b=c==null?void 0:c.at(0))==null?void 0:b.runId;S!=null&&j.message._updateId(`run-${S}`)}j.message.response_metadata={...j.generationInfo,...j.message.response_metadata}}return x.generations.length===1&&(x.generations[0].message.response_metadata={...x.llmOutput,...x.generations[0].message.response_metadata}),l[v]=x.generations,u[v]=x.llmOutput,(w=c==null?void 0:c[v])==null?void 0:w.handleLLMEnd({generations:[x.generations],llmOutput:x.llmOutput})}else return await((_=c==null?void 0:c[v])==null?void 0:_.handleLLMError(m.reason)),Promise.reject(m.reason)}))}const d={generations:l,llmOutput:u.length?(f=this._combineLLMOutput)==null?void 0:f.call(this,...u):void 0};return Object.defineProperty(d,dK,{value:c?{runIds:c==null?void 0:c.map(y=>y.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:t,cache:n,llmStringKey:r,parsedOptions:a,handledOptions:o}){const i=t.map(m=>m.map(Dp)),s={...o.metadata,...this.getLsParams(a)},c=await _N.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1,cached:!0},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),i,o.runId,void 0,l,void 0,void 0,o.runName)),d=[],p=(await Promise.allSettled(i.map(async(m,v)=>{const b=si._convertInputToPromptValue(m).toString(),w=await n.lookup(b,r);return w==null&&d.push(v),w}))).map((m,v)=>({result:m,runManager:u==null?void 0:u[v]})).filter(({result:m})=>m.status==="fulfilled"&&m.value!=null||m.status==="rejected"),f=[];await Promise.all(p.map(async({result:m,runManager:v},b)=>{if(m.status==="fulfilled"){const w=m.value;return f[b]=w,w.length&&await(v==null?void 0:v.handleLLMNewToken(w[0].text)),v==null?void 0:v.handleLLMEnd({generations:[w]})}else return await(v==null?void 0:v.handleLLMError(m.reason)),Promise.reject(m.reason)}));const y={generations:f,missingPromptIndices:d};return Object.defineProperty(y,dK,{value:u?{runIds:u==null?void 0:u.map(m=>m.runId)}:void 0,configurable:!0}),y}async generate(t,n,r){let a;Array.isArray(n)?a={stop:n}:a=n;const o=t.map(f=>f.map(Dp)),[i,s]=this._separateRunnableConfigFromCallOptionsCompat(a);if(i.callbacks=i.callbacks??r,!this.cache)return this._generateUncached(o,s,i);const{cache:c}=this,l=this._getSerializedCacheKeyParametersForCall(s),{generations:u,missingPromptIndices:d}=await this._generateCached({messages:o,cache:c,llmStringKey:l,parsedOptions:s,handledOptions:i});let p={};if(d.length>0){const f=await this._generateUncached(d.map(y=>o[y]),s,i);await Promise.all(f.generations.map(async(y,m)=>{const v=d[m];u[v]=y;const b=si._convertInputToPromptValue(o[v]).toString();return c.update(b,l,y)})),p=f.llmOutput??{}}return{generations:u,llmOutput:p}}invocationParams(t){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(t,n,r){const a=t.map(o=>o.toChatMessages());return this.generate(a,n,r)}async call(t,n,r){return(await this.generate([t.map(Dp)],n,r)).generations[0][0].message}async callPrompt(t,n,r){const a=t.toChatMessages();return this.call(a,n,r)}async predictMessages(t,n,r){return this.call(t,n,r)}async predict(t,n,r){const a=new Pr(t),o=await this.call([a],n,r);if(typeof o.content!="string")throw new Error("Cannot use predict when output is not a string.");return o.content}withStructuredOutput(t,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');const r=t,a=n==null?void 0:n.name,o=r.description??"A function available to call.",i=n==null?void 0:n.method,s=n==null?void 0:n.includeRaw;if(i==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let c=a??"extract",l;z6(r)?l=[{type:"function",function:{name:c,description:o,parameters:jN(r)}}]:("name"in r&&(c=r.name),l=[{type:"function",function:{name:c,description:o,parameters:r}}]);const u=this.bindTools(l),d=NAe.from(m=>{if(!m.tool_calls||m.tool_calls.length===0)throw new Error("No tool calls found in the response.");const v=m.tool_calls.find(b=>b.name===c);if(!v)throw new Error(`No tool call found with name ${c}.`);return v.args});if(!s)return u.pipe(d).withConfig({runName:"StructuredOutput"});const p=fm.assign({parsed:(m,v)=>d.invoke(m.raw,v)}),f=fm.assign({parsed:()=>null}),y=p.withFallbacks({fallbacks:[f]});return pK.from([{raw:u},y]).withConfig({runName:"StructuredOutputRunnable"})}}class Zde extends Rp{parseResultWithPrompt(t,n,r){return this.parseResult(t,r)}_baseMessageToString(t){return typeof t.content=="string"?t.content:this._baseMessageContentToString(t.content)}_baseMessageContentToString(t){return JSON.stringify(t)}async invoke(t,n){return typeof t=="string"?this._callWithConfig(async(r,a)=>this.parseResult([{text:r}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"}):this._callWithConfig(async(r,a)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"})}}class V6 extends Zde{parseResult(t,n){return this.parse(t[0].text,n)}async parseWithPrompt(t,n,r){return this.parse(t,r)}_type(){throw new Error("_type not implemented")}}class dj extends Error{constructor(t,n,r,a=!1){if(super(t),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=r,this.sendToLLM=a,a&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}function pj(e,t){const n=typeof e;if(n!==typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;const r=e.length;if(r!==t.length)return!1;for(let a=0;a<r;a++)if(!pj(e[a],t[a]))return!1;return!0}if(n==="object"){if(!e||!t)return e===t;const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(const o of r)if(!pj(e[o],t[o]))return!1;return!0}return e===t}class Xde extends V6{async*_transform(t){for await(const n of t)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:this._baseMessageToString(n)}])}async*transform(t,n){yield*this._transformStreamWithConfig(t,this._transform.bind(this),{...n,runType:"parser"})}}class W6 extends Xde{constructor(t){super(t),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(t==null?void 0:t.diff)??this.diff}async*_transform(t){let n,r;for await(const a of t){if(typeof a!="string"&&typeof a.content!="string")throw new Error("Cannot handle non-string output.");let o;if(MAe(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new Ng({message:a,text:a.content})}else if(PAe(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new Ng({message:kAe(a),text:a.content})}else o=new AAe({text:a});r===void 0?r=o:r=r.concat(o);const i=await this.parsePartialResult([r]);i!=null&&!pj(i,n)&&(this.diff?yield this._diff(n,i):yield i,n=i)}}getFormatInstructions(){return""}}class U6 extends V6{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(t){super(t),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(t){return new this(t)}static fromNamesAndDescriptions(t){const n=fa.object(Object.fromEntries(Object.entries(t).map(([r,a])=>[r,fa.string().describe(a)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(jN(this.schema))}
\`\`\`
`}async parse(t){try{const n=(t.includes("```")?t.trim().split(/```(?:json)?/)[1]:t.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(r,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(n){throw new dj(`Failed to parse. Text: "${t}". Error: ${n}`,t)}}}class q6 extends W6{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(t,n){if(n)return t?VK(t,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(t){return fK(t[0].text)}async parse(t){return fK(t,JSON.parse)}getFormatInstructions(){return""}}function H6(e,t){if(e.function===void 0)return;let n;if(t!=null&&t.partial)try{n=TAe(e.function.arguments??"{}")}catch{return}else try{n=JSON.parse(e.function.arguments)}catch(a){throw new dj([`Function "${e.function.name}" arguments:`,"",e.function.arguments,"","are not valid JSON.",`Error: ${a.message}`].join(`
`))}const r={name:e.function.name,args:n,type:"tool_call"};return t!=null&&t.returnId&&(r.id=e.id),r}function Qde(e){if(e.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}}function Gde(e,t){var n,r;return{name:(n=e.function)==null?void 0:n.name,args:(r=e.function)==null?void 0:r.arguments,id:e.id,error:t,type:"invalid_tool_call"}}class Jde extends W6{static lc_name(){return"JsonOutputToolsParser"}constructor(t){super(t),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(t==null?void 0:t.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(t){return await this.parsePartialResult(t,!1)}async parsePartialResult(t,n=!0){var i;const r=t[0].message;let a;if(SN(r)&&((i=r.tool_calls)!=null&&i.length)?a=r.tool_calls.map(s=>{const{id:c,...l}=s;return this.returnId?{id:c,...l}:l}):r.additional_kwargs.tool_calls!==void 0&&(a=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(s=>H6(s,{returnId:this.returnId,partial:n}))),!a)return[];const o=[];for(const s of a)if(s!==void 0){const c={type:s.name,args:s.args,id:s.id};o.push(c)}return o}}class K6 extends Jde{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=t.keyName,this.returnSingle=t.returnSingle??this.returnSingle,this.zodSchema=t.zodSchema}async _validateResult(t){if(this.zodSchema===void 0)return t;const n=await this.zodSchema.safeParseAsync(t);if(n.success)return n.data;throw new dj(`Failed to parse. Text: "${JSON.stringify(t,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(t,null,2))}async parsePartialResult(t){const n=(await super.parsePartialResult(t)).filter(a=>a.type===this.keyName);let r=n;if(n.length)return this.returnId||(r=n.map(a=>a.args)),this.returnSingle?r[0]:r}async parseResult(t){const n=(await super.parsePartialResult(t,!1)).filter(a=>a.type===this.keyName);let r=n;return n.length?(this.returnId||(r=n.map(a=>a.args)),this.returnSingle?this._validateResult(r[0]):await Promise.all(r.map(a=>this._validateResult(a)))):void 0}}const Yde=Symbol("Let zodToJsonSchema decide on which parser to use"),epe={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},tpe=e=>({...epe,...e}),npe=e=>{const t=tpe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function Z6(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function _t(e,t,n,r,a){e[t]=n,Z6(e,t,r,a)}function rpe(){return{}}function ape(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==me.ZodAny&&(n.items=mt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&_t(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&_t(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(_t(n,"minItems",e.exactLength.value,e.exactLength.message,t),_t(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function ope(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?_t(n,"minimum",r.value,r.message,t):_t(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),_t(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?_t(n,"maximum",r.value,r.message,t):_t(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),_t(n,"maximum",r.value,r.message,t));break;case"multipleOf":_t(n,"multipleOf",r.value,r.message,t);break}return n}function ipe(){return{type:"boolean"}}function spe(e,t){return mt(e.type._def,t)}const cpe=(e,t)=>mt(e.innerType._def,t);function X6(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>X6(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return lpe(e,t)}}const lpe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":_t(n,"minimum",r.value,r.message,t);break;case"max":_t(n,"maximum",r.value,r.message,t);break}return n};function upe(e,t){return{...mt(e.innerType._def,t),default:e.defaultValue()}}function dpe(e,t){return t.effectStrategy==="input"?mt(e.schema._def,t):{}}function ppe(e){return{type:"string",enum:e.values}}const fpe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function hpe(e,t){const n=[mt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),mt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(fpe(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function mpe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let fj;const Ji={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(fj===void 0&&(fj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),fj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function Q6(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?ype(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":_t(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":_t(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":Yr(n,"email",a.message,t);break;case"format:idn-email":Yr(n,"idn-email",a.message,t);break;case"pattern:zod":ea(n,Ji.email,a.message,t);break}break;case"url":Yr(n,"uri",a.message,t);break;case"uuid":Yr(n,"uuid",a.message,t);break;case"regex":ea(n,a.regex,a.message,t);break;case"cuid":ea(n,Ji.cuid,a.message,t);break;case"cuid2":ea(n,Ji.cuid2,a.message,t);break;case"startsWith":ea(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":ea(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":Yr(n,"date-time",a.message,t);break;case"date":Yr(n,"date",a.message,t);break;case"time":Yr(n,"time",a.message,t);break;case"duration":Yr(n,"duration",a.message,t);break;case"length":_t(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),_t(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{ea(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&Yr(n,"ipv4",a.message,t),a.version!=="v4"&&Yr(n,"ipv6",a.message,t);break}case"emoji":ea(n,Ji.emoji,a.message,t);break;case"ulid":{ea(n,Ji.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{Yr(n,"binary",a.message,t);break}case"contentEncoding:base64":{_t(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{ea(n,Ji.base64,a.message,t);break}}break}case"nanoid":ea(n,Ji.nanoid,a.message,t)}return n}const ype=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),Yr=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):_t(e,"format",t,n,r)},ea=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:G6(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):_t(e,"pattern",G6(t,r),n,r)},G6=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function J6(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===me.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===me.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(Q6(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===me.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function gpe(e,t){if(t.mapStrategy==="record")return J6(e,t);const n=mt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function vpe(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function bpe(){return{not:{}}}function wpe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const hm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function xpe(e,t){if(t.target==="openApi3")return Y6(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in hm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=hm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return Y6(e,t)}const Y6=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>mt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function _pe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:hm[e.innerType._def.typeName],nullable:!0}:{type:[hm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=mt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=mt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function jpe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",Z6(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?_t(n,"minimum",r.value,r.message,t):_t(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),_t(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?_t(n,"maximum",r.value,r.message,t):_t(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),_t(n,"maximum",r.value,r.message,t));break;case"multipleOf":_t(n,"multipleOf",r.value,r.message,t);break}return n}function Spe(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":mt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":mt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Epe(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=mt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Spe(e,t)};return n.required.length||delete n.required,n}const Ope=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return mt(e.innerType._def,t);const n=mt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Cpe=(e,t)=>{if(t.pipeStrategy==="input")return mt(e.in._def,t);if(t.pipeStrategy==="output")return mt(e.out._def,t);const n=mt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=mt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Npe(e,t){return mt(e.type._def,t)}function Mpe(e,t){const n={type:"array",uniqueItems:!0,items:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&_t(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&_t(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Ppe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>mt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:mt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>mt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function kpe(){return{not:{}}}function Ape(){return{}}const Tpe=(e,t)=>mt(e.innerType._def,t);function mt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==Yde)return s}if(r&&!n){const s=Ipe(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=Dpe(e,e.typeName,t);return o&&Lpe(e,t,o),a.jsonSchema=o,o}const Ipe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Rpe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Rpe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Dpe=(e,t,n)=>{switch(t){case me.ZodString:return Q6(e,n);case me.ZodNumber:return jpe(e,n);case me.ZodObject:return Epe(e,n);case me.ZodBigInt:return ope(e,n);case me.ZodBoolean:return ipe();case me.ZodDate:return X6(e,n);case me.ZodUndefined:return kpe();case me.ZodNull:return wpe(n);case me.ZodArray:return ape(e,n);case me.ZodUnion:case me.ZodDiscriminatedUnion:return xpe(e,n);case me.ZodIntersection:return hpe(e,n);case me.ZodTuple:return Ppe(e,n);case me.ZodRecord:return J6(e,n);case me.ZodLiteral:return mpe(e,n);case me.ZodEnum:return ppe(e);case me.ZodNativeEnum:return vpe(e);case me.ZodNullable:return _pe(e,n);case me.ZodOptional:return Ope(e,n);case me.ZodMap:return gpe(e,n);case me.ZodSet:return Mpe(e,n);case me.ZodLazy:return mt(e.getter()._def,n);case me.ZodPromise:return Npe(e,n);case me.ZodNaN:case me.ZodNever:return bpe();case me.ZodEffects:return dpe(e,n);case me.ZodAny:return rpe();case me.ZodUnknown:return Ape();case me.ZodDefault:return upe(e,n);case me.ZodBranded:return spe(e,n);case me.ZodReadonly:return Tpe(e,n);case me.ZodCatch:return cpe(e,n);case me.ZodPipeline:return Cpe(e,n);case me.ZodFunction:case me.ZodVoid:case me.ZodSymbol:return;default:return(r=>{})()}},Lpe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),$pe=(e,t)=>{const n=npe(t),r=void 0,a=t==null?void 0:t.name,o=mt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},Fpe=Symbol("Let zodToJsonSchema decide on which parser to use"),e8={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Bpe=e=>typeof e=="string"?{...e8,basePath:["#"],definitions:{},name:e}:{...e8,basePath:["#"],definitions:{},...e},hj=e=>"_def"in e?e._def:e;function zpe(e){if(!e)return!0;for(const t in e)return!1;return!0}const Vpe=e=>{const t=Bpe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[hj(a),{def:hj(a),path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function t8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function jt(e,t,n,r,a){e[t]=n,t8(e,t,r,a)}function Wpe(){return{}}function Upe(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==me.ZodAny&&(n.items=dt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&jt(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&jt(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(jt(n,"minItems",e.exactLength.value,e.exactLength.message,t),jt(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function qpe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?jt(n,"minimum",r.value,r.message,t):jt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),jt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?jt(n,"maximum",r.value,r.message,t):jt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),jt(n,"maximum",r.value,r.message,t));break;case"multipleOf":jt(n,"multipleOf",r.value,r.message,t);break}return n}function Hpe(){return{type:"boolean"}}function Kpe(e,t){return dt(e.type._def,t)}const Zpe=(e,t)=>dt(e.innerType._def,t);function n8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>n8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Xpe(e,t)}}const Xpe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":jt(n,"minimum",r.value,r.message,t);break;case"max":jt(n,"maximum",r.value,r.message,t);break}return n};function Qpe(e,t){return{...dt(e.innerType._def,t),default:e.defaultValue()}}function Gpe(e,t,n){return t.effectStrategy==="input"?dt(e.schema._def,t,n):{}}function Jpe(e){return{type:"string",enum:[...e.values]}}const Ype=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function efe(e,t){const n=[dt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),dt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(Ype(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function tfe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let mj;const Yi={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(mj===void 0&&(mj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),mj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function r8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?nfe(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":jt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":jt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ta(n,"email",a.message,t);break;case"format:idn-email":ta(n,"idn-email",a.message,t);break;case"pattern:zod":na(n,Yi.email,a.message,t);break}break;case"url":ta(n,"uri",a.message,t);break;case"uuid":ta(n,"uuid",a.message,t);break;case"regex":na(n,a.regex,a.message,t);break;case"cuid":na(n,Yi.cuid,a.message,t);break;case"cuid2":na(n,Yi.cuid2,a.message,t);break;case"startsWith":na(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":na(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":ta(n,"date-time",a.message,t);break;case"date":ta(n,"date",a.message,t);break;case"time":ta(n,"time",a.message,t);break;case"duration":ta(n,"duration",a.message,t);break;case"length":jt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),jt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{na(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&ta(n,"ipv4",a.message,t),a.version!=="v4"&&ta(n,"ipv6",a.message,t);break}case"emoji":na(n,Yi.emoji,a.message,t);break;case"ulid":{na(n,Yi.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ta(n,"binary",a.message,t);break}case"contentEncoding:base64":{jt(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{na(n,Yi.base64,a.message,t);break}}break}case"nanoid":na(n,Yi.nanoid,a.message,t)}return n}const nfe=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),ta=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):jt(e,"format",t,n,r)},na=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:a8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):jt(e,"pattern",a8(t,r),n,r)},a8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function o8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===me.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===me.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(r8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===me.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function rfe(e,t){if(t.mapStrategy==="record")return o8(e,t);const n=dt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function afe(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function ofe(){return{not:{}}}function ife(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const mm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function sfe(e,t){if(t.target==="openApi3")return i8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in mm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=mm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return i8(e,t)}const i8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>dt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function cfe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"||t.nullableStrategy==="property"?{type:mm[e.innerType._def.typeName],nullable:!0}:{type:[mm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=dt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=dt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function lfe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",t8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?jt(n,"minimum",r.value,r.message,t):jt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),jt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?jt(n,"maximum",r.value,r.message,t):jt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),jt(n,"maximum",r.value,r.message,t));break;case"multipleOf":jt(n,"multipleOf",r.value,r.message,t);break}return n}function ufe(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":dt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":dt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function dfe(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=dt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()&&!t.openaiStrictMode?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:ufe(e,t)};return n.required.length||delete n.required,n}const pfe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return dt(e.innerType._def,t);const n=dt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},ffe=(e,t)=>{if(t.pipeStrategy==="input")return dt(e.in._def,t);if(t.pipeStrategy==="output")return dt(e.out._def,t);const n=dt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=dt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function hfe(e,t){return dt(e.type._def,t)}function mfe(e,t){const n={type:"array",uniqueItems:!0,items:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&jt(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&jt(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function yfe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>dt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:dt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>dt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function gfe(){return{not:{}}}function vfe(){return{}}const bfe=(e,t)=>dt(e.innerType._def,t);function dt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==Fpe)return s}if(r&&!n){const s=wfe(r,t);if(s!==void 0)return"$ref"in s&&t.seenRefs.add(s.$ref),s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=_fe(e,e.typeName,t,n);return o&&jfe(e,t,o),a.jsonSchema=o,o}const wfe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":const n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&t.nameStrategy==="duplicate-ref"&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:xfe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,a)=>t.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},xfe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},_fe=(e,t,n,r)=>{switch(t){case me.ZodString:return r8(e,n);case me.ZodNumber:return lfe(e,n);case me.ZodObject:return dfe(e,n);case me.ZodBigInt:return qpe(e,n);case me.ZodBoolean:return Hpe();case me.ZodDate:return n8(e,n);case me.ZodUndefined:return gfe();case me.ZodNull:return ife(n);case me.ZodArray:return Upe(e,n);case me.ZodUnion:case me.ZodDiscriminatedUnion:return sfe(e,n);case me.ZodIntersection:return efe(e,n);case me.ZodTuple:return yfe(e,n);case me.ZodRecord:return o8(e,n);case me.ZodLiteral:return tfe(e,n);case me.ZodEnum:return Jpe(e);case me.ZodNativeEnum:return afe(e);case me.ZodNullable:return cfe(e,n);case me.ZodOptional:return pfe(e,n);case me.ZodMap:return rfe(e,n);case me.ZodSet:return mfe(e,n);case me.ZodLazy:return dt(e.getter()._def,n);case me.ZodPromise:return hfe(e,n);case me.ZodNaN:case me.ZodNever:return ofe();case me.ZodEffects:return Gpe(e,n,r);case me.ZodAny:return Wpe();case me.ZodUnknown:return vfe();case me.ZodDefault:return Qpe(e,n);case me.ZodBranded:return Kpe(e,n);case me.ZodReadonly:return bfe(e,n);case me.ZodCatch:return Zpe(e,n);case me.ZodPipeline:return ffe(e,n);case me.ZodFunction:case me.ZodVoid:case me.ZodSymbol:return;default:return(a=>{})()}},jfe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),Sfe=(e,t)=>{const n=Vpe(t),r=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,a=dt(e._def,r===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},o=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;o!==void 0&&(a.title=o);const i=(()=>{if(zpe(n.definitions))return;const c={},l=new Set;for(let u=0;u<500;u++){const d=Object.entries(n.definitions).filter(([p])=>!l.has(p));if(d.length===0)break;for(const[p,f]of d)c[p]=dt(hj(f),{...n,currentPath:[...n.basePath,n.definitionPath,p]},!0)??{},l.add(p)}return c})(),s=r===void 0?i?{...a,[n.definitionPath]:i}:a:n.nameStrategy==="duplicate-ref"?{...a,...i||n.seenRefs.size?{[n.definitionPath]:{...i,...n.seenRefs.size?{[r]:a}:void 0}}:void 0}:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...i,[r]:a}};return n.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s};function s8(e,t){return Sfe(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function Efe(e,t,n){return Sde({type:"json_schema",json_schema:{...n,name:t,strict:!0,schema:s8(e,{name:t})}},r=>e.parse(JSON.parse(r)))}function Ofe(e){return Ede({type:"function",function:{name:e.name,parameters:s8(e.parameters,{name:e.name}),strict:!0,...e.description?{description:e.description}:void 0}},{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})}function Cfe(e){const{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:a,baseURL:o,azureADTokenProvider:i,azureOpenAIEndpoint:s}=e;if((r||i)&&a&&t)return`${a}/${t}`;if((r||i)&&s&&t)return`${s}/openai/deployments/${t}`;if(r||i){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${t}`}return o}function Nfe(e,t){const n=typeof t=="number"?void 0:t;return{name:e.name,description:e.description,parameters:jN(e.schema),...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}}function Mfe(e){return e!==void 0&&Array.isArray(e.lc_namespace)}function Pfe(e){return e!==void 0&&Rp.isRunnable(e)&&"lc_name"in e.constructor&&typeof e.constructor.lc_name=="function"&&e.constructor.lc_name()==="RunnableToolLike"}function kfe(e){return!!e&&typeof e=="object"&&"name"in e&&"schema"in e&&z6(e.schema)}function Afe(e){return kfe(e)||Pfe(e)||Mfe(e)}function ym(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/
`,e}function c8(e){let t;return e.constructor.name===Zh.name?(t=new Error(e.message),t.name="TimeoutError"):e.constructor.name===wr.name?(t=new Error(e.message),t.name="AbortError"):e.status===400&&e.message.includes("tool_calls")?t=ym(e,"INVALID_TOOL_RESULTS"):e.status===401?t=ym(e,"MODEL_AUTHENTICATION"):e.status===429?t=ym(e,"MODEL_RATE_LIMIT"):e.status===404?t=ym(e,"MODEL_NOT_FOUND"):t=e,t}function Tfe(e){if(e)return e==="any"||e==="required"?"required":e==="auto"?"auto":e==="none"?"none":typeof e=="string"?{type:"function",function:{name:e}}:e}function Ife(e){return e.anyOf!==void 0&&Array.isArray(e.anyOf)}function Rfe(e){const t=["namespace functions {",""];for(const n of e)n.description&&t.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(t.push(`type ${n.name} = (_: {`),t.push(l8(n.parameters,0)),t.push("}) => any;")):t.push(`type ${n.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join(`
`)}function l8(e,t){var r;const n=[];for(const[a,o]of Object.entries(e.properties??{}))o.description&&t<2&&n.push(`// ${o.description}`),(r=e.required)!=null&&r.includes(a)?n.push(`${a}: ${gm(o,t)},`):n.push(`${a}?: ${gm(o,t)},`);return n.map(a=>" ".repeat(t)+a).join(`
`)}function gm(e,t){if(Ife(e))return e.anyOf.map(n=>gm(n,t)).join(" | ");switch(e.type){case"string":return e.enum?e.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",l8(e,t+2),"}"].join(`
`);case"array":return e.items?`${gm(e.items,t)}[]`:"any[]";default:return""}}function Dfe(e,t){let n;if(Afe(e)){const r=Ofe({name:e.name,parameters:e.schema,description:e.description});r.function.parameters?n={type:r.type,function:{name:r.function.name,description:r.function.description,parameters:r.function.parameters,...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}}:n={type:"function",function:Nfe(e,t)}}else n=e;return(t==null?void 0:t.strict)!==void 0&&(n.function.strict=t.strict),n}function Lfe(e){return e.role!=="system"&&e.role!=="developer"&&e.role!=="assistant"&&e.role!=="user"&&e.role!=="function"&&e.role!=="tool"&&console.warn(`Unknown message role: ${e.role}`),e.role}function u8(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!mK.isInstance(e))throw new Error("Invalid generic chat message");return Lfe(e)}default:throw new Error(`Unknown message type: ${t}`)}}function $fe(e,t,n){const r=e.tool_calls;switch(e.role){case"assistant":{const a=[],o=[];for(const c of r??[])try{a.push(H6(c,{returnId:!0}))}catch(l){o.push(Gde(c,l.message))}const i={function_call:e.function_call,tool_calls:r};n!==void 0&&(i.__raw_response=t);const s={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(i.audio=e.audio),new Wo({content:e.content||"",tool_calls:a,invalid_tool_calls:o,additional_kwargs:i,response_metadata:s,id:t.id})}default:return new mK(e.content||"",e.role??"unknown")}}function Ffe(e,t,n,r){var c,l;const a=e.role??n,o=e.content??"";let i;e.function_call?i={function_call:e.function_call}:e.tool_calls?i={tool_calls:e.tool_calls}:i={},r&&(i.__raw_response=t),e.audio&&(i.audio={...e.audio,index:t.choices[0].index});const s={usage:{...t.usage}};if(a==="user")return new IAe({content:o,response_metadata:s});if(a==="assistant"){const u=[];if(Array.isArray(e.tool_calls))for(const d of e.tool_calls)u.push({name:(c=d.function)==null?void 0:c.name,args:(l=d.function)==null?void 0:l.arguments,id:d.id,index:d.index,type:"tool_call_chunk"});return new hK({content:o,tool_call_chunks:u,additional_kwargs:i,id:t.id,response_metadata:s})}else return a==="system"?new yK({content:o,response_metadata:s}):a==="developer"?new yK({content:o,response_metadata:s,additional_kwargs:{__openai_role__:"developer"}}):a==="function"?new RAe({content:o,additional_kwargs:i,name:e.name,response_metadata:s}):a==="tool"?new DAe({content:o,additional_kwargs:i,tool_call_id:e.tool_call_id,response_metadata:s}):new LAe({content:o,role:a,response_metadata:s})}function d8(e,t){return e.flatMap(n=>{var o;let r=u8(n);r==="system"&&(t!=null&&t.startsWith("o1"))&&(r="developer");const a={role:r,content:n.content};if(n.name!=null&&(a.name=n.name),n.additional_kwargs.function_call!=null&&(a.function_call=n.additional_kwargs.function_call,a.content=null),SN(n)&&((o=n.tool_calls)!=null&&o.length)?(a.tool_calls=n.tool_calls.map(Qde),a.content=null):(n.additional_kwargs.tool_calls!=null&&(a.tool_calls=n.additional_kwargs.tool_calls),n.tool_call_id!=null&&(a.tool_call_id=n.tool_call_id)),n.additional_kwargs.audio&&typeof n.additional_kwargs.audio=="object"&&"id"in n.additional_kwargs.audio){const i={role:"assistant",audio:{id:n.additional_kwargs.audio.id}};return[a,i]}return a})}function p8(e,t){return Ude(e)?(t==null?void 0:t.strict)!==void 0?{...e,function:{...e.function,strict:t.strict}}:e:Dfe(e,t)}class Bfe extends si{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(t,n){var r,a,o,i,s,c,l,u,d;if(super(t??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(t==null?void 0:t.apiKey)??(t==null?void 0:t.openAIApiKey)??((r=t==null?void 0:t.configuration)==null?void 0:r.apiKey)??Ci("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(t==null?void 0:t.azureOpenAIApiKey)??Ci("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(t==null?void 0:t.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(t==null?void 0:t.azureOpenAIApiInstanceName)??Ci("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(t==null?void 0:t.azureOpenAIApiDeploymentName)??Ci("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(t==null?void 0:t.azureOpenAIApiVersion)??Ci("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(t==null?void 0:t.azureOpenAIBasePath)??Ci("AZURE_OPENAI_BASE_PATH"),this.organization=((a=t==null?void 0:t.configuration)==null?void 0:a.organization)??Ci("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=(t==null?void 0:t.azureOpenAIEndpoint)??Ci("AZURE_OPENAI_ENDPOINT"),this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(t==null?void 0:t.modelKwargs)??{},this.timeout=t==null?void 0:t.timeout,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.topP=(t==null?void 0:t.topP)??this.topP,this.frequencyPenalty=(t==null?void 0:t.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(t==null?void 0:t.presencePenalty)??this.presencePenalty,this.maxTokens=t==null?void 0:t.maxTokens,this.logprobs=t==null?void 0:t.logprobs,this.topLogprobs=t==null?void 0:t.topLogprobs,this.n=(t==null?void 0:t.n)??this.n,this.logitBias=t==null?void 0:t.logitBias,this.stop=(t==null?void 0:t.stopSequences)??(t==null?void 0:t.stop),this.stopSequences=this==null?void 0:this.stop,this.user=t==null?void 0:t.user,this.__includeRawResponse=t==null?void 0:t.__includeRawResponse,this.audio=t==null?void 0:t.audio,this.modalities=t==null?void 0:t.modalities,this.reasoningEffort=t==null?void 0:t.reasoningEffort,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const p=this.azureOpenAIBasePath.split("/openai/deployments/");if(p.length===2){const[,f]=p;this.azureOpenAIApiDeploymentName=f}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.model==="o1"&&(this.disableStreaming=!0),this.streaming=(t==null?void 0:t.streaming)??!1,this.streamUsage=(t==null?void 0:t.streamUsage)??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(n==null?void 0:n.basePath)??((o=t==null?void 0:t.configuration)==null?void 0:o.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((i=n==null?void 0:n.baseOptions)==null?void 0:i.headers)??((c=(s=t==null?void 0:t.configuration)==null?void 0:s.baseOptions)==null?void 0:c.headers),defaultQuery:((l=n==null?void 0:n.baseOptions)==null?void 0:l.params)??((d=(u=t==null?void 0:t.configuration)==null?void 0:u.baseOptions)==null?void 0:d.params),...n,...t==null?void 0:t.configuration},(t==null?void 0:t.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=t.supportsStrictToolCalling)}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.max_tokens??void 0,ls_stop:t.stop}}bindTools(t,n){let r;return(n==null?void 0:n.strict)!==void 0?r=n.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:t.map(a=>p8(a,{strict:r})),...n})}createResponseFormat(t){return t&&t.type==="json_schema"&&t.json_schema.schema&&vm(t.json_schema.schema)?Efe(t.json_schema.schema,t.json_schema.name,{description:t.json_schema.description}):t}invocationParams(t,n){var s;let r;(t==null?void 0:t.strict)!==void 0?r=t.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling);let a={};(t==null?void 0:t.stream_options)!==void 0?a={stream_options:t.stream_options}:this.streamUsage&&(this.streaming||n!=null&&n.streaming)&&(a={stream_options:{include_usage:!0}});const o={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(t==null?void 0:t.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:t==null?void 0:t.functions,function_call:t==null?void 0:t.function_call,tools:(s=t==null?void 0:t.tools)!=null&&s.length?t.tools.map(c=>p8(c,{strict:r})):void 0,tool_choice:Tfe(t==null?void 0:t.tool_choice),response_format:this.createResponseFormat(t==null?void 0:t.response_format),seed:t==null?void 0:t.seed,...a,parallel_tool_calls:t==null?void 0:t.parallel_tool_calls,...this.audio||t!=null&&t.audio?{audio:this.audio||(t==null?void 0:t.audio)}:{},...this.modalities||t!=null&&t.modalities?{modalities:this.modalities||(t==null?void 0:t.modalities)}:{},...this.modelKwargs};(t==null?void 0:t.prediction)!==void 0&&(o.prediction=t.prediction);const i=(t==null?void 0:t.reasoning_effort)??this.reasoningEffort;return i!==void 0&&(o.reasoning_effort=i),o}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(t,n,r){var l,u,d,p,f,y,m,v,b,w;const a=d8(t,this.model),o={...this.invocationParams(n,{streaming:!0}),messages:a,stream:!0};let i;const s=await this.completionWithRetry(o,n);let c;for await(const _ of s){const x=(l=_==null?void 0:_.choices)==null?void 0:l[0];if(_.usage&&(c=_.usage),!x)continue;const{delta:j}=x;if(!j)continue;const S=Ffe(j,_,i,this.__includeRawResponse);i=j.role??i;const E={prompt:n.promptIndex??0,completion:x.index??0};if(typeof S.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const O={...E};x.finish_reason!=null&&(O.finish_reason=x.finish_reason,O.system_fingerprint=_.system_fingerprint,O.model_name=_.model),this.logprobs&&(O.logprobs=x.logprobs);const N=new Ng({message:S,text:S.content,generationInfo:O});yield N,await(r==null?void 0:r.handleLLMNewToken(N.text??"",E,void 0,void 0,void 0,{chunk:N}))}if(c){const _={...((u=c.prompt_tokens_details)==null?void 0:u.audio_tokens)!==null&&{audio:(d=c.prompt_tokens_details)==null?void 0:d.audio_tokens},...((p=c.prompt_tokens_details)==null?void 0:p.cached_tokens)!==null&&{cache_read:(f=c.prompt_tokens_details)==null?void 0:f.cached_tokens}},x={...((y=c.completion_tokens_details)==null?void 0:y.audio_tokens)!==null&&{audio:(m=c.completion_tokens_details)==null?void 0:m.audio_tokens},...((v=c.completion_tokens_details)==null?void 0:v.reasoning_tokens)!==null&&{reasoning:(b=c.completion_tokens_details)==null?void 0:b.reasoning_tokens}};yield new Ng({message:new hK({content:"",response_metadata:{usage:{...c}},usage_metadata:{input_tokens:c.prompt_tokens,output_tokens:c.completion_tokens,total_tokens:c.total_tokens,...Object.keys(_).length>0&&{input_token_details:_},...Object.keys(x).length>0&&{output_token_details:x}}}),text:""})}if((w=n.signal)!=null&&w.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(t,n,r){var s,c;const a={},o=this.invocationParams(n),i=d8(t,this.model);if(o.stream){const l=this._streamResponseChunks(t,n,r),u={};for await(const v of l){v.message.response_metadata={...v.generationInfo,...v.message.response_metadata};const b=((s=v.generationInfo)==null?void 0:s.completion)??0;u[b]===void 0?u[b]=v:u[b]=u[b].concat(v)}const d=Object.entries(u).sort(([v],[b])=>parseInt(v,10)-parseInt(b,10)).map(([v,b])=>b),{functions:p,function_call:f}=this.invocationParams(n),y=await this.getEstimatedTokenCountFromPrompt(t,p,f),m=await this.getNumTokensFromGenerations(d);return a.input_tokens=y,a.output_tokens=m,a.total_tokens=y+m,{generations:d,llmOutput:{estimatedTokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}else{let l;n.response_format&&n.response_format.type==="json_schema"?l=await this.betaParsedCompletionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options}):l=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options});const{completion_tokens:u,prompt_tokens:d,total_tokens:p,prompt_tokens_details:f,completion_tokens_details:y}=(l==null?void 0:l.usage)??{};u&&(a.output_tokens=(a.output_tokens??0)+u),d&&(a.input_tokens=(a.input_tokens??0)+d),p&&(a.total_tokens=(a.total_tokens??0)+p),((f==null?void 0:f.audio_tokens)!==null||(f==null?void 0:f.cached_tokens)!==null)&&(a.input_token_details={...(f==null?void 0:f.audio_tokens)!==null&&{audio:f==null?void 0:f.audio_tokens},...(f==null?void 0:f.cached_tokens)!==null&&{cache_read:f==null?void 0:f.cached_tokens}}),((y==null?void 0:y.audio_tokens)!==null||(y==null?void 0:y.reasoning_tokens)!==null)&&(a.output_token_details={...(y==null?void 0:y.audio_tokens)!==null&&{audio:y==null?void 0:y.audio_tokens},...(y==null?void 0:y.reasoning_tokens)!==null&&{reasoning:y==null?void 0:y.reasoning_tokens}});const m=[];for(const v of(l==null?void 0:l.choices)??[]){const b={text:((c=v.message)==null?void 0:c.content)??"",message:$fe(v.message??{role:"assistant"},l,this.__includeRawResponse)};b.generationInfo={...v.finish_reason?{finish_reason:v.finish_reason}:{},...v.logprobs?{logprobs:v.logprobs}:{}},SN(b.message)&&(b.message.usage_metadata=a),b.message=new Wo(Object.fromEntries(Object.entries(b.message).filter(([w])=>!w.startsWith("lc_")))),m.push(b)}return{generations:m,llmOutput:{tokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(t,n,r){let a=(await this.getNumTokensFromMessages(t)).totalCount;if(n&&r!=="auto"){const o=Rfe(n);a+=await this.getNumTokens(o),a+=9}return n&&t.find(o=>o._getType()==="system")&&(a-=4),r==="none"?a+=1:typeof r=="object"&&(a+=await this.getNumTokens(r.name)+4),a}async getNumTokensFromGenerations(t){return(await Promise.all(t.map(async n=>{var r;return(r=n.message.additional_kwargs)!=null&&r.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)}))).reduce((n,r)=>n+r,0)}async getNumTokensFromMessages(t){let n=0,r=0,a=0;this.model==="gpt-3.5-turbo-0301"?(r=4,a=-1):(r=3,a=1);const o=await Promise.all(t.map(async i=>{var p,f,y,m,v,b;const s=await this.getNumTokens(i.content),c=await this.getNumTokens(u8(i)),l=i.name!==void 0?a+await this.getNumTokens(i.name):0;let u=s+r+c+l;const d=i;if(d._getType()==="function"&&(u-=2),(p=d.additional_kwargs)!=null&&p.function_call&&(u+=3),(f=d==null?void 0:d.additional_kwargs.function_call)!=null&&f.name&&(u+=await this.getNumTokens((y=d.additional_kwargs.function_call)==null?void 0:y.name)),(m=d.additional_kwargs.function_call)==null?void 0:m.arguments)try{u+=await this.getNumTokens(JSON.stringify(JSON.parse((v=d.additional_kwargs.function_call)==null?void 0:v.arguments)))}catch(w){console.error("Error parsing function arguments",w,JSON.stringify(d.additional_kwargs.function_call)),u+=await this.getNumTokens((b=d.additional_kwargs.function_call)==null?void 0:b.arguments)}return n+=u,u}));return n+=3,{totalCount:n,countPerMessage:o}}async completionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(t,r)}catch(a){throw c8(a)}})}async betaParsedCompletionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(t,r)}catch(a){throw c8(a)}})}_getClientOptions(t){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},a=Cfe(r),o={...this.clientConfig,baseURL:a,timeout:this.timeout,maxRetries:0};o.baseURL||delete o.baseURL,this.client=new it(o)}const n={...this.clientConfig,...t};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),n}_llmType(){return"openai"}_combineLLMOutput(...t){return t.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(t,n){let r,a,o,i;zfe(t)?(r=t.schema,a=t.name,o=t.method,i=t.includeRaw):(r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw);let s,c;if((n==null?void 0:n.strict)!==void 0&&o==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(o==="jsonMode")s=this.bind({response_format:{type:"json_object"}}),vm(r)?c=U6.fromZodSchema(r):c=new q6;else if(o==="jsonSchema")s=this.bind({response_format:{type:"json_schema",json_schema:{name:a??"extract",description:r.description,schema:r,strict:n==null?void 0:n.strict}}}),vm(r)?c=U6.fromZodSchema(r):c=new q6;else{let p=a??"extract";if(vm(r)){const f=$pe(r);s=this.bind({tools:[{type:"function",function:{name:p,description:f.description,parameters:f}}],tool_choice:{type:"function",function:{name:p}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new K6({returnSingle:!0,keyName:p,zodSchema:r})}else{let f;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(f=r,p=r.name):(p=r.title??p,f={name:p,description:r.description??"",parameters:r}),s=this.bind({tools:[{type:"function",function:f}],tool_choice:{type:"function",function:{name:p}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new K6({returnSingle:!0,keyName:p})}}if(!i)return s.pipe(c);const l=fm.assign({parsed:(p,f)=>c.invoke(p.raw,f)}),u=fm.assign({parsed:()=>null}),d=l.withFallbacks({fallbacks:[u]});return pK.from([{raw:s},d])}}function vm(e){return typeof(e==null?void 0:e.parse)=="function"}function zfe(e){return e!==void 0&&typeof e.schema=="object"}const Vfe=e=>{const t=(n,r=null)=>{let a=`{
`;return n.filter(o=>o.parent_id===r).forEach(o=>{if(o.type==="object"){const i=e.filter(c=>c.parent_id===o.id),s=t(i,o.id);a+=`  ${o.name}${o.required?"":"?"}: ${s}
`}else a+=`  // ${o.description||""}
  ${o.name}${o.required?"":"?"}: ${o.type};
`}),a+="}",a};return t(e)},f8=e=>{const t=(r,a=null)=>{let o="";return r.filter(i=>i.parent_id===a).forEach(i=>{if(i.type==="object"){const s=t(r,i.id);o+=`    ${i.name}: z.object({
${s}    })${i.required?"":".optional()"}.describe('${i.description||""}'),
`}else o+=`    ${i.name}: z.${i.type}()${i.required?"":".optional()"}.describe('${i.description||""}'),
`}),o};let n=`const schema = z.object({
`;return n+=t(e),n+="});",n},Wfe=e=>{const t={},n={string:fa.string,number:fa.number,boolean:fa.boolean,enum:()=>fa.enum([""])};return e.forEach(r=>{if(!r.parent_id)if(r.type==="object"){const a=e.filter(i=>i.parent_id===r.id),o={};a.forEach(i=>{i.type==="object"||i.type==="array"||(o[i.name]=n[i.type](),i.required||(o[i.name]=o[i.name].optional()))}),t[r.name]=fa.object(o),r.required||(t[r.name]=t[r.name].optional())}else r.type==="array"?(t[r.name]=fa.array(fa.string()),r.required||(t[r.name]=t[r.name].optional())):r.type==="enum"?(t[r.name]=fa.enum((r.enum||"").split(",")),r.required||(t[r.name]=t[r.name].optional())):(t[r.name]=n[r.type](),r.required||(t[r.name]=t[r.name].optional()))}),fa.object(t)},Ufe=()=>{const{toast:e}=Qt(),{t}=Pe("errors"),n=Ye(a=>a.currentSession),{modalRef:r}=mc(od);return{stream:g.useCallback(async(a,o)=>{var l,u;const{schemas:i,onMessageUpdate:s,onMessageFinish:c}=o||{};if(!(n!=null&&n.passphrase))throw new Error("Session is not found");switch(await Ip.exists("passphrase")||await new Promise((d,p)=>{r.current.show({onConfirm:async f=>{try{const y=await h_(n.passphrase,f);await Ip.set("passphrase",y),d()}catch(y){e({content:t("invalid_passphrase"),variant:"destructive"}),p(y)}finally{r.current.hide()}},onCancel:()=>{p()}})}),o==null?void 0:o.provider){case ln.OpenAI:{const d=(l=o==null?void 0:o.llm)==null?void 0:l.parameters;if(!(d!=null&&d.key)||typeof d.key!="string")throw new Error("API Key is not found");const p=await Ip.get("passphrase");if(!p)throw new Error("Passphrase is not found");const f=await h_(d.key,p);if(!f)throw new Error("API Key is not found");const y=new Bfe({apiKey:f,model:(u=o==null?void 0:o.llm)==null?void 0:u.name});let m="",v;if(i!=null&&i.length){const b=i.filter(x=>{var j;return(j=x.schema_items)==null?void 0:j.length}).flatMap(x=>x.schema_items),w=Wfe(b),_=await y.withStructuredOutput(w).stream(a);for await(const x of _)m=JSON.stringify(x),s==null||s({content:m})}else{const b=await y.stream(a);for await(const w of b)m+=`${w.content}`,v=w,s==null||s({content:m,chunk:w})}return c==null||c({content:m,lastChunk:v}),{lastChunk:v,content:m}}default:throw new Error("Provider is not supported")}},[n==null?void 0:n.passphrase,r,t,e])}},kc=()=>{const e=kM(),t=Ufe();return{stream:g.useCallback((n,r,a)=>{switch(n){case ln.WebLLM:return e.stream(r,a);case ln.OpenAI:return t.stream(r,{...a,provider:n});default:throw new Error("Provider is not supported")}},[t,e])}},qfe=e=>{const[t]=g.useState(!1),n=js(i=>i.similaritySearchWithScore),{stream:r}=kc(),a=g.useCallback(async(i,s)=>{if(!(s!=null&&s.length))return[];const c=[];return await Promise.all(s.map(async l=>{var d,p,f,y;const u=l.placeholderEntity;if(u)switch(u.placeholder_type){case As.VECTOR_DATABASE_RETREIVER:{if(!l.promptNode||!l.promptEntity||!l.vectorDatabaseNode||!l.vectorDatabaseEntity)return;const m=(d=u.metadata)!=null&&d.k?+((p=u.metadata)==null?void 0:p.k):1;let v=(f=u.metadata)!=null&&f.minimalScore?+((y=u.metadata)==null?void 0:y.minimalScore):void 0;v&&v>1&&(v=v/100);const b=await n({databaseId:l.vectorDatabaseEntity.id},i,m);if(!b)return[];const w=new qo({template:l.promptEntity.content,inputVariables:["context"]});c.push(new Wo(await w.format({context:v?b.filter(([,_])=>_>=v).map(([_])=>_.pageContent).join(`
`):b.map(([_])=>_.pageContent).join(`
`)})))}}})),c},[n]),o=g.useCallback(async(i,s,{retriverInfo:c},{schema:l,onMessageUpdate:u,onResponseMessageCreate:d,onInjectedMessages:p})=>{var v,b;if(!((v=e.mainLLMInfo)!=null&&v.llm)||((b=e.mainLLMInfo)==null?void 0:b.status)!==Qe.Loaded)throw new Error("LLM not found");const f=[];c!=null&&c.length&&(f.push(...await a(i,c)),p==null||p(f));const y=s.map(w=>w.role==="system"?new Mg(w.content):w.role==="user"?new Pr(w.content):new Wo(w.content));d==null||d();const{content:m}=await r(e.mainLLMInfo.llm.provider,y,{schemas:l?[l]:void 0,onMessageUpdate:({content:w})=>{u==null||u({nodeData:{loading:!0,content:w}})},llm:e.mainLLMInfo.llm});return u==null||u({nodeData:{content:m}}),m},[a,r,e.mainLLMInfo]);return{loading:t,sendMessage:o}},Hfe=Ha(({onDelete:e})=>{const{t}=Pe("dialogs"),[n,r]=g.useState(!1),a=Xt(),{toast:o}=Qt(),i=async()=>{try{r(!0),await e(),a.hide()}catch{o({variant:"destructive",description:t("delete_chat_data_node.errors.delete_failed")})}finally{r(!1)}};return h.jsx(PA,{open:a.visible,onOpenChange:a.hide,children:h.jsxs(V0,{children:[h.jsxs(W0,{children:[h.jsx(q0,{children:t("delete_chat_data_node.title")}),h.jsx(H0,{children:t("delete_chat_data_node.description")})]}),h.jsxs(U0,{children:[h.jsx(Z0,{onClick:a.hide,children:t("delete_chat_data_node.cancel")}),h.jsx(K0,{disabled:n,onClick:i,children:t("delete_chat_data_node.delete")})]})]})})});function bm(){return h.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"text-foreground",children:[h.jsx("circle",{cx:"4",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_qFRN",begin:"0;spinner_OcgL.end+0.25s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{begin:"spinner_qFRN.begin+0.1s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"20",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_OcgL",begin:"spinner_qFRN.begin+0.2s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})})]})}const Kfe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",height:192,viewBox:"0 0 150 150",width:192,...e},g.createElement("clipPath",{id:"a"},g.createElement("path",{d:"m0 0h150v150h-150z"})),g.createElement("g",{clipPath:"url(#a)"},g.createElement("path",{d:"m150 0h-150v150h150z",fill:"#29b5e8"}),g.createElement("path",{clipRule:"evenodd",d:"m130.375 67.2532-14.096 8.1221 14.096 8.0536c.843.4872 1.581 1.1357 2.174 1.9084.592.7727 1.026 1.6545 1.278 2.5951.251.9406.315 1.9215.188 2.8867-.128.9652-.444 1.8959-.931 2.7388-.488.843-1.136 1.5817-1.909 2.174s-1.654 1.0267-2.595 1.2782-1.921.3154-2.887.1878c-.965-.1275-1.896-.444-2.739-.9312l-25.2559-14.5496c-1.1575-.6696-2.1128-1.6394-2.765-2.8068-.6523-1.1674-.9773-2.4893-.9408-3.826.0198-.5792.1089-1.1538.2653-1.7117.517-1.8711 1.7458-3.4654 3.4234-4.4419l25.256-14.4983c.847-.4892 1.782-.8067 2.751-.9343.97-.1275 1.955-.0627 2.899.1909.945.2536 1.83.6909 2.605 1.287.775.596 1.425 1.3391 1.913 2.1866.49.8402.808 1.7693.935 2.7334.128.964.063 1.9439-.191 2.8826-.254.9388-.692 1.8177-1.288 2.5859-.597.7681-1.34 1.4101-2.186 1.8887zm-13.343 39.3698-25.2478-14.5243c-1.1296-.6483-2.4091-.9896-3.7115-.9902s-2.5823.3397-3.7124.987c-1.1301.6472-2.0712 1.579-2.7297 2.7026-.6585 1.1237-1.0115 2.4001-1.0239 3.7024v29.0135c.0654 1.928.8772 3.755 2.264 5.095 1.3869 1.341 3.2403 2.09 5.1691 2.09 1.9289 0 3.7823-.749 5.1691-2.09 1.3868-1.34 2.1986-3.167 2.264-5.095v-16.261l14.1301 8.122c.843.488 1.774.805 2.739.933.966.128 1.947.064 2.888-.187s1.823-.685 2.596-1.277c.774-.592 1.423-1.331 1.91-2.174.488-.843.805-1.773.933-2.739.128-.965.065-1.946-.186-2.887s-.685-1.824-1.277-2.597-1.331-1.422-2.174-1.91zm-29.0992-28.3806-10.527 10.3986c-.3601.3349-.8269.5319-1.318.5563h-3.0897c-.49-.0294-.9551-.2257-1.318-.5563l-10.4671-10.4329c-.3274-.3573-.521-.817-.5478-1.3009v-3.081c.0283-.4861.2215-.9481.5478-1.3095l10.4671-10.4329c.3637-.3281.829-.5214 1.318-.5477h3.0897c.4899.0228.9562.2166 1.318.5477l10.4928 10.4329c.3237.3623.514.8243.5392 1.3095v3.081c-.0237.483-.2143.9428-.5392 1.3009zm-8.3874-2.8928c-.0404-.499-.2485-.9696-.5905-1.3352l-3.0383-3.004c-.3641-.3275-.8291-.5207-1.318-.5478h-.1113c-.4867.0255-.9495.2191-1.3094.5478l-3.0383 3.004c-.3262.3676-.5165.8358-.5392 1.3266v.1113c.0215.4834.2124.9439.5392 1.3009l3.0554 2.9955c.3607.3274.823.5208 1.3094.5477h.1113c.4889-.027.9539-.2203 1.318-.5477l3.0383-3.0212c.3282-.3576.5244-.8166.5563-1.3009zm-47.4914-31.2217 25.2563 14.4811c1.1308.648 2.4115.989 3.7149.9889 1.3033 0 2.584-.3409 3.7148-.989 1.1309-.648 2.0725-1.5806 2.7314-2.7051.659-1.1245 1.0123-2.4018 1.0249-3.7051v-28.9879c-.0654-1.9277-.8772-3.7546-2.264-5.0952s-3.2402-2.0899-5.1691-2.0899c-1.9288 0-3.7822.7493-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v16.2613l-14.1473-8.1307c-.8429-.4877-1.7737-.8047-2.7392-.9328-.9654-.1281-1.9466-.0647-2.8876.1864s-1.8232.6852-2.5965 1.2773c-.7732.5921-1.4222 1.3307-1.91 2.1736-.4878.843-.8048 1.7738-.9329 2.7392-.128.9655-.0647 1.9467.1864 2.8876.2512.941.6852 1.8233 1.2773 2.5965.5921.7733 1.3307 1.4223 2.1737 1.9101zm55.4252 15.4739c1.4914.118 2.9836-.2193 4.2793-.9671l25.2475-14.5496c.843-.4877 1.582-1.1368 2.174-1.91s1.026-1.6555 1.277-2.5965.315-1.9222.187-2.8876c-.128-.9655-.445-1.8962-.933-2.7392-.488-.8429-1.137-1.5816-1.91-2.1737-.774-.5921-1.656-1.0261-2.597-1.2772-1.9-.5072-3.924-.2387-5.627.7464l-14.1298 8.1991v-16.2613c-.0654-1.9277-.8772-3.7546-2.264-5.0952-1.3868-1.3405-3.2402-2.0899-5.1691-2.0899-1.9288 0-3.7822.7494-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v29.0136c-.0023 1.8784.7086 3.6876 1.9892 5.0619 1.2805 1.3743 3.0351 2.2111 4.909 2.3412zm-25.8554 31.5298c-1.4916-.1213-2.9847.2162-4.2793.9671l-25.2905 14.4893c-1.7024.985-2.9438 2.607-3.451 4.507s-.2387 3.924.7465 5.627c.9851 1.702 2.6061 2.943 4.5065 3.451 1.9004.507 3.9244.238 5.6268-.747l14.1473-8.122v16.261c.0654 1.928.8772 3.755 2.2641 5.096 1.3868 1.34 3.2402 2.09 5.169 2.09 1.9289 0 3.7823-.75 5.1691-2.09 1.3868-1.341 2.1986-3.168 2.264-5.096v-29.0645c-.0038-1.869-.7144-3.6673-1.9891-5.0341s-3.0192-2.2009-4.8834-2.3348zm-6.8468-13.5825c.4875-1.6032.414-3.3247-.2083-4.8806-.6224-1.5559-1.7564-2.8532-3.2152-3.6779l-25.2306-14.541c-1.704-.976-3.7248-1.2385-5.6216-.7303-1.8968.5083-3.5155 1.7461-4.5032 3.4433-.4889.84-.8065 1.7686-.9343 2.732-.1278.9635-.0632 1.9428.1899 2.8811.2531.9384.6897 1.8173 1.2846 2.5858.595.7686 1.3364 1.4115 2.1814 1.8917l14.096 8.1221-14.096 8.0536c-.8429.4861-1.5819 1.1334-2.1746 1.9051-.5928.7717-1.0277 1.6526-1.2801 2.5923-.2523.9398-.317 1.9201-.1905 2.8849s.4418 1.8952.9279 2.7382c.4861.8429 1.1335 1.5819 1.9051 2.1746.7717.5928 1.6526 1.0277 2.5924 1.2801.9397.2523 1.92.317 2.8848.1905s1.8952-.4418 2.7382-.9279l25.2306-14.5496c1.6248-.9071 2.8451-2.3965 3.4149-4.168z",fill:"#fff",fillRule:"evenodd"}))),Zfe=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:48,height:48,...e},g.createElement("path",{fill:"#fbc02d",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20 s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),g.createElement("path",{fill:"#e53935",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039 l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),g.createElement("path",{fill:"#4caf50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36 c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),g.createElement("path",{fill:"#1565c0",d:"M43.611,20.083L43.595,20L42,20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571 c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),Xfe=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:1024,height:1024,viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M44.522 44.5217H489.739V489.739H44.522V44.5217Z",fill:"#F35325"}),g.createElement("path",{d:"M534.261 44.5217H979.478V489.739H534.261V44.5217Z",fill:"#81BC06"}),g.createElement("path",{d:"M44.522 534.261H489.739V979.478H44.522V534.261Z",fill:"#05A6F0"}),g.createElement("path",{d:"M534.261 534.261H979.478V979.478H534.261V534.261Z",fill:"#FFBA08"})),Qfe=e=>g.createElement("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 287.56 191",...e},g.createElement("defs",null,g.createElement("style",null,".cls-1{fill:#0081fb;}.cls-2{fill:url(#linear-gradient);}.cls-3{fill:url(#linear-gradient-2);}"),g.createElement("linearGradient",{id:"linear-gradient",x1:62.34,y1:101.45,x2:260.34,y2:91.45,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0064e1"}),g.createElement("stop",{offset:.4,stopColor:"#0064e1"}),g.createElement("stop",{offset:.83,stopColor:"#0073ee"}),g.createElement("stop",{offset:1,stopColor:"#0082fb"})),g.createElement("linearGradient",{id:"linear-gradient-2",x1:41.42,y1:53,x2:41.42,y2:126,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0082fb"}),g.createElement("stop",{offset:1,stopColor:"#0064e0"}))),g.createElement("title",null,"facebook-meta"),g.createElement("path",{className:"cls-1",d:"M31.06,126c0,11,2.41,19.41,5.56,24.51A19,19,0,0,0,53.19,160c8.1,0,15.51-2,29.79-21.76,11.44-15.83,24.92-38,34-52l15.36-23.6c10.67-16.39,23-34.61,37.18-47C181.07,5.6,193.54,0,206.09,0c21.07,0,41.14,12.21,56.5,35.11,16.81,25.08,25,56.67,25,89.27,0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191V160c17.63,0,22-16.2,22-34.74,0-26.42-6.16-55.74-19.73-76.69-9.63-14.86-22.11-23.94-35.84-23.94-14.85,0-26.8,11.2-40.23,31.17-7.14,10.61-14.47,23.54-22.7,38.13l-9.06,16c-18.2,32.27-22.81,39.62-31.91,51.75C84.74,183,71.12,191,53.19,191c-21.27,0-34.72-9.21-43-23.09C3.34,156.6,0,141.76,0,124.85Z"}),g.createElement("path",{className:"cls-2",d:"M24.49,37.3C38.73,15.35,59.28,0,82.85,0c13.65,0,27.22,4,41.39,15.61,15.5,12.65,32,33.48,52.63,67.81l7.39,12.32c17.84,29.72,28,45,33.93,52.22,7.64,9.26,13,12,19.94,12,17.63,0,22-16.2,22-34.74l27.4-.86c0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191c-12.8,0-24.14-2.78-36.68-14.61-9.64-9.08-20.91-25.21-29.58-39.71L146.08,93.6c-12.94-21.62-24.81-37.74-31.68-45C107,40.71,97.51,31.23,82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78Z"}),g.createElement("path",{className:"cls-3",d:"M82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78C38.61,71.62,31.06,99.34,31.06,126c0,11,2.41,19.41,5.56,24.51L10.14,167.91C3.34,156.6,0,141.76,0,124.85,0,94.1,8.44,62.05,24.49,37.3,38.73,15.35,59.28,0,82.85,0Z"})),Gfe=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:256,height:233,viewBox:"0 0 256 233",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M186.182 0h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#f7d046",d:"M209.455 0H256v46.545h-46.545z"}),g.createElement("path",{d:"M0 0h46.545v46.545H0zm0 46.545h46.545V93.09H0zm0 46.546h46.545v46.545H0zm0 46.545h46.545v46.545H0zm0 46.546h46.545v46.545H0z"}),g.createElement("path",{fill:"#f7d046",d:"M23.273 0h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#f2a73b",d:"M209.455 46.545H256V93.09h-46.545zm-186.182 0h46.545V93.09H23.273z"}),g.createElement("path",{d:"M139.636 46.545h46.545V93.09h-46.545z"}),g.createElement("path",{fill:"#f2a73b",d:"M162.909 46.545h46.545V93.09h-46.545zm-93.091 0h46.545V93.09H69.818z"}),g.createElement("path",{fill:"#ee792f",d:"M116.364 93.091h46.545v46.545h-46.545zm46.545 0h46.545v46.545h-46.545zm-93.091 0h46.545v46.545H69.818z"}),g.createElement("path",{d:"M93.091 139.636h46.545v46.545H93.091z"}),g.createElement("path",{fill:"#eb5829",d:"M116.364 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#ee792f",d:"M209.455 93.091H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"}),g.createElement("path",{d:"M186.182 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M209.455 139.636H256v46.545h-46.545z"}),g.createElement("path",{d:"M186.182 186.182h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M23.273 139.636h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#ea3326",d:"M209.455 186.182H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"})),Jfe="/NoLLMChat/assets/qwen-B-gSh3_v.webp",Yfe="/NoLLMChat/assets/smollm-CikBjd4F.png",ehe="/NoLLMChat/assets/stablelm-BquePdQ7.png",the="/NoLLMChat/assets/nomic-BjJqoFji.webp",nhe="/NoLLMChat/assets/joshua-ByaReJuI.webp",rhe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{fill:"#fff",d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),ahe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),Aa=g.memo(({name:e,className:t,...n})=>{const r=Vo(a=>a.theme);return e=e.toLowerCase(),e.includes("gpt")?r==="dark"?h.jsx(rhe,{className:Z("w-5 h-5",t),...n}):h.jsx(ahe,{className:Z("w-5 h-5",t),...n}):e.includes("gemma")?h.jsx(Zfe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("qwen")?h.jsx("img",{className:Z("w-5 h-5",t),src:Jfe,alt:"qwen",...n}):e!=null&&e.includes("phi")?h.jsx(Xfe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("llama")?h.jsx(Qfe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("smollm")?h.jsx("img",{className:Z("w-5 h-5",t),src:Yfe,alt:"smollm",...n}):e!=null&&e.includes("mistral")?h.jsx(Gfe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("snowflake")?h.jsx(Kfe,{className:Z("w-5 h-5 rounded-full",t),...n}):e!=null&&e.includes("stablelm")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:ehe,alt:"stablelm",...n}):e!=null&&e.includes("nomic")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:the,alt:"nomic",...n}):e!=null&&e.includes("Xenova")||e!=null&&e.includes("janus")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:nhe,alt:"Xenova",...n}):h.jsx(de,{className:Z("w-5 h-5",t),name:"brain"})}),yj=["Qwen2.5-1.5B-Instruct-q4f32_1-MLC","Qwen2.5-Coder-1.5B-Instruct-q4f16_1-MLC","stablelm-2-zephyr-1_6b-q4f16_1-MLC-1k","Phi-3.5-mini-instruct-q4f16_1-MLC-1k","Llama-3.2-3B-Instruct-q4f32_1-MLC"],ohe=qa("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function xn({className:e,variant:t,...n}){return h.jsx("div",{className:Z(ohe({variant:t}),e),...n})}const Sd=g.memo(e=>{var c;const{name:t,model:n,isCached:r,isFunctionCalling:a}=e,{t:o}=Pe("atoms"),i=g.useCallback(l=>l===1?"llm_info.model_types.embedding":l===2?"llm_info.model_types.vlm":"llm_info.model_types.llm",[]),s=g.useMemo(()=>{if(n)switch(n.model_type){case 0:case 1:return h.jsx(xn,{className:"",children:o(i(n.model_type))});case 2:return h.jsxs(h.Fragment,{children:[h.jsx(xn,{className:"",children:o(i(0))}),h.jsx(xn,{className:"",children:o(i(n.model_type))})]})}},[n,i,o]);if(n)return h.jsxs(h.Fragment,{children:[s,yj.some(l=>t&&l.includes(t))?h.jsx(xn,{className:"",variant:"outline",children:o("llm_info.recommended")}):null,r?h.jsx(xn,{className:"",variant:"outline",children:o("llm_info.cached")}):null,a?h.jsx(xn,{className:"",variant:"outline",children:o("llm_info.function_calling")}):null,n!=null&&n.low_resource_required?h.jsx(xn,{className:"",variant:"outline",children:o("llm_info.low_resource_required")}):null,(c=n==null?void 0:n.overrides)!=null&&c.context_window_size?h.jsxs(xn,{className:"",variant:"outline",children:[n.overrides.context_window_size.toLocaleString("en-US")," Tokens"]}):null,n!=null&&n.vram_required_MB?h.jsxs(xn,{className:"",variant:"outline",children:["VRAM: ",n.vram_required_MB.toLocaleString("en-US")," MB"]}):null]})}),Zt=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Zt.displayName="Card";const Ln=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex flex-col space-y-1.5 p-6",e),...t}));Ln.displayName="CardHeader";const Kn=g.forwardRef(({className:e,...t},n)=>h.jsx("h3",{ref:n,className:Z("text-2xl font-semibold leading-none tracking-tight",e),...t}));Kn.displayName="CardTitle";const h8=g.forwardRef(({className:e,...t},n)=>h.jsx("p",{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));h8.displayName="CardDescription";const $n=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("p-6 pt-0",e),...t}));$n.displayName="CardContent";const ci=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex items-center p-6 pt-0",e),...t}));ci.displayName="CardFooter";const ihe=g.memo(({llm:e,status:t,loadLLM:n,progress:r})=>{const{t:a}=Pe("flows"),[o,i]=g.useState();g.useEffect(()=>{o||!(e!=null&&e.name)||At(()=>import("./index-C4ZCpUfV.js").then(async l=>(await l.__tla,l)),__vite__mapDeps([5,1,2,3,4])).then(async({hasModelInCache:l,functionCallingModelIds:u,prebuiltAppConfig:d})=>{const p=await l(e==null?void 0:e.name);i({hasCache:p,isFunctionCalling:u.includes(e==null?void 0:e.name),info:d.model_list.find(f=>f.model_id===(e==null?void 0:e.name))})})},[e==null?void 0:e.name,o]);const s=g.useCallback(async()=>{await(n==null?void 0:n())},[n]),c=g.useMemo(()=>{switch(t){case Qe.Downloading:return h.jsx(de,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case Qe.Loaded:return h.jsx(Aa,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"});default:return h.jsx(Aa,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"})}},[e==null?void 0:e.name,t]);return h.jsx(Zt,{className:"flex justify-center !bg-inherit !p-2 max-w-full overflow-y-hidden !mb-2 m-2 !mt-0",children:h.jsxs("div",{className:"ml-2 pt-1 max-w-full",children:[h.jsxs("p",{className:"flex gap-2 items-center pr-6 !text-sm font-semibold",children:[c,`${(e==null?void 0:e.name)||""}`]}),h.jsxs("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:[h.jsx(Sd,{model:o==null?void 0:o.info,isFunctionCalling:(o==null?void 0:o.isFunctionCalling)||!1,name:e==null?void 0:e.name,isCached:(o==null?void 0:o.hasCache)||!1}),t!==Qe.Loaded?r?h.jsx("div",{className:"text-sm break-words flex-wrap",children:r}):h.jsx(ut,{disabled:t===Qe.Loading,onClick:s,className:"mt-4 w-full",children:a(o!=null&&o.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")}):void 0]})]})})}),she=e=>{const[t,n]=g.useState([]),r=Ye(i=>i.currentSession),a=g.useCallback(async()=>{if(!e||!(r!=null&&r.id))return;const i=await ue("FlowEdge").find({where:{session_id:r.id,source:e.id},order:{id:"DESC"}}),{flowNodes:s,flowNodeDatas:c}=await Vh({where:{session_id:r.id,id:Ca(i.map(l=>l.target)),source_type:"JSONData"},order:{updated_at:"DESC"},select:["id","source_id","source_type","updated_at"]});n(s.reduce((l,u)=>{var p;const d=(p=c[u.source_type])==null?void 0:p.find(f=>f.id===u.source_id);return d&&l.push({node:u,entity:d}),l},[]))},[r==null?void 0:r.id,e]),o=g.useCallback(async i=>{await ue("FlowNode").delete(i.id),await ue("JSONData").delete(i.source_id);const s=await ue("FlowEdge").find({where:[{source:i.id},{target:i.id}]});await Promise.all(s.map(c=>ue("FlowEdge").delete(c.id))),a()},[a]);return g.useEffect(()=>{e&&a()},[a,e]),{chatList:t,deleteChat:o,getChatList:a}};class che{async loadAndSplit(t){if(t===void 0)throw new Error("You must pass a text splitter to use this method.");const n=await this.load();return t.invoke(n)}}class m8 extends che{constructor(t,{splitPages:n=!0,pdfjs:r=lhe,parsedItemSeparator:a=""}={}){super(),Object.defineProperty(this,"blob",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"splitPages",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"pdfjs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parsedItemSeparator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.blob=t,this.splitPages=n??this.splitPages,this.pdfjs=r,this.parsedItemSeparator=a}async load(){const{getDocument:t,version:n}=await this.pdfjs(),r=await t({data:new Uint8Array(await this.blob.arrayBuffer()),useWorkerFetch:!1,isEvalSupported:!1,useSystemFonts:!0}).promise,a=await r.getMetadata().catch(()=>null),o=[];for(let i=1;i<=r.numPages;i+=1){const s=await(await r.getPage(i)).getTextContent();if(s.items.length===0)continue;let c;const l=[];for(const d of s.items)"str"in d&&(c===d.transform[5]||!c?l.push(d.str):l.push(`
${d.str}`),c=d.transform[5]);const u=l.join(this.parsedItemSeparator);o.push(new Lp({pageContent:u,metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages},loc:{pageNumber:i}}}))}return this.splitPages?o:o.length===0?[]:[new Lp({pageContent:o.map(i=>i.pageContent).join(`

`),metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages}}})]}}async function lhe(){try{const{default:e}=await At(async()=>{const{default:r}=await import("./pdf-DIU9JUyD.js").then(async a=>(await a.__tla,a)).then(a=>a.p);return{default:r}},__vite__mapDeps([6,1,2])),{getDocument:t,version:n}=e;return{getDocument:t,version:n}}catch(e){throw console.error(e),new Error("Failed to load pdf-parse. Please install it with eg. `npm install pdf-parse`.")}}var gj="Tabs",[uhe,l2e]=er(gj,[Za]),y8=Za(),[dhe,vj]=uhe(gj),g8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:o,orientation:i="horizontal",dir:s,activationMode:c="automatic",...l}=e,u=Uo(s),[d,p]=Sn({prop:r,onChange:a,defaultProp:o});return h.jsx(dhe,{scope:n,baseId:Pt(),value:d,onValueChange:p,orientation:i,dir:u,activationMode:c,children:h.jsx(Ae.div,{dir:u,"data-orientation":i,...l,ref:t})})});g8.displayName=gj;var v8="TabsList",b8=g.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,o=vj(v8,n),i=y8(n);return h.jsx(Fl,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:r,children:h.jsx(Ae.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:t})})});b8.displayName=v8;var w8="TabsTrigger",x8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...o}=e,i=vj(w8,n),s=y8(n),c=S8(i.baseId,r),l=E8(i.baseId,r),u=r===i.value;return h.jsx(Bl,{asChild:!0,...s,focusable:!a,active:u,children:h.jsx(Ae.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":l,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:t,onMouseDown:ge(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?i.onValueChange(r):d.preventDefault()}),onKeyDown:ge(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(r)}),onFocus:ge(e.onFocus,()=>{const d=i.activationMode!=="manual";!u&&!a&&d&&i.onValueChange(r)})})})});x8.displayName=w8;var _8="TabsContent",j8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:o,...i}=e,s=vj(_8,n),c=S8(s.baseId,r),l=E8(s.baseId,r),u=r===s.value,d=g.useRef(u);return g.useEffect(()=>{const p=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(p)},[]),h.jsx(Mr,{present:a||u,children:({present:p})=>h.jsx(Ae.div,{"data-state":u?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":c,hidden:!p,id:l,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:p&&o})})});j8.displayName=_8;function S8(e,t){return`${e}-trigger-${t}`}function E8(e,t){return`${e}-content-${t}`}var phe=g8,O8=b8,C8=x8,N8=j8;const bj=phe,wm=g.forwardRef(({className:e,...t},n)=>h.jsx(O8,{ref:n,className:Z("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));wm.displayName=O8.displayName;const ra=g.forwardRef(({className:e,...t},n)=>h.jsx(C8,{ref:n,className:Z("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));ra.displayName=C8.displayName;const aa=g.forwardRef(({className:e,...t},n)=>h.jsx(N8,{ref:n,className:Z("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));aa.displayName=N8.displayName,xv=function(e,[t,n]){return Math.min(n,Math.max(t,e))};function M8(e){const t=g.useRef({value:e,previous:e});return g.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var fhe=[" ","Enter","ArrowUp","ArrowDown"],hhe=[" ","Enter"],Ed="Select",[xm,_m,mhe]=Tp(Ed),[Ac,u2e]=er(Ed,[mhe,Vs]),jm=Vs(),[yhe,li]=Ac(Ed),[ghe,vhe]=Ac(Ed),P8=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:o,value:i,defaultValue:s,onValueChange:c,dir:l,name:u,autoComplete:d,disabled:p,required:f,form:y}=e,m=jm(t),[v,b]=g.useState(null),[w,_]=g.useState(null),[x,j]=g.useState(!1),S=Uo(l),[E=!1,O]=Sn({prop:r,defaultProp:a,onChange:o}),[N,M]=Sn({prop:i,defaultProp:s,onChange:c}),P=g.useRef(null),I=v?y||!!v.closest("form"):!0,[k,C]=g.useState(new Set),T=Array.from(k).map(A=>A.props.value).join(";");return h.jsx(Of,{...m,children:h.jsxs(yhe,{required:f,scope:t,trigger:v,onTriggerChange:b,valueNode:w,onValueNodeChange:_,valueNodeHasChildren:x,onValueNodeHasChildrenChange:j,contentId:Pt(),value:N,onValueChange:M,open:E,onOpenChange:O,dir:S,triggerPointerDownPosRef:P,disabled:p,children:[h.jsx(xm.Provider,{scope:t,children:h.jsx(ghe,{scope:e.__scopeSelect,onNativeOptionAdd:g.useCallback(A=>{C(R=>new Set(R).add(A))},[]),onNativeOptionRemove:g.useCallback(A=>{C(R=>{const L=new Set(R);return L.delete(A),L})},[]),children:n})}),I?h.jsxs(t$,{"aria-hidden":!0,required:f,tabIndex:-1,name:u,autoComplete:d,value:N,onChange:A=>M(A.target.value),disabled:p,form:y,children:[N===void 0?h.jsx("option",{value:""}):null,Array.from(k)]},T):null]})})};P8.displayName=Ed;var k8="SelectTrigger",A8=g.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,o=jm(n),i=li(k8,n),s=i.disabled||r,c=wt(t,i.onTriggerChange),l=_m(n),u=g.useRef("touch"),[d,p,f]=n$(m=>{const v=l().filter(_=>!_.disabled),b=v.find(_=>_.value===i.value),w=r$(v,m,b);w!==void 0&&i.onValueChange(w.value)}),y=m=>{s||(i.onOpenChange(!0),f()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return h.jsx(k0,{asChild:!0,...o,children:h.jsx(Ae.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":e$(i.value)?"":void 0,...a,ref:c,onClick:ge(a.onClick,m=>{m.currentTarget.focus(),u.current!=="mouse"&&y(m)}),onPointerDown:ge(a.onPointerDown,m=>{u.current=m.pointerType;const v=m.target;v.hasPointerCapture(m.pointerId)&&v.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(y(m),m.preventDefault())}),onKeyDown:ge(a.onKeyDown,m=>{const v=d.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&p(m.key),!(v&&m.key===" ")&&fhe.includes(m.key)&&(y(),m.preventDefault())})})})});A8.displayName=k8;var T8="SelectValue",I8=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:o,placeholder:i="",...s}=e,c=li(T8,n),{onValueNodeHasChildrenChange:l}=c,u=o!==void 0,d=wt(t,c.onValueNodeChange);return tn(()=>{l(u)},[l,u]),h.jsx(Ae.span,{...s,ref:d,style:{pointerEvents:"none"},children:e$(c.value)?h.jsx(h.Fragment,{children:i}):o})});I8.displayName=T8;var bhe="SelectIcon",R8=g.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return h.jsx(Ae.span,{"aria-hidden":!0,...a,ref:t,children:r||"\u25BC"})});R8.displayName=bhe;var whe="SelectPortal",D8=e=>h.jsx(Cg,{asChild:!0,...e});D8.displayName=whe;var es="SelectContent",L8=g.forwardRef((e,t)=>{const n=li(es,e.__scopeSelect),[r,a]=g.useState();if(tn(()=>{a(new DocumentFragment)},[]),!n.open){const o=r;return o?Nl.createPortal(h.jsx($8,{scope:e.__scopeSelect,children:h.jsx(xm.Slot,{scope:e.__scopeSelect,children:h.jsx("div",{children:e.children})})}),o):null}return h.jsx(F8,{...e,ref:t})});L8.displayName=es;var oa=10,[$8,ui]=Ac(es),xhe="SelectContentImpl",F8=g.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:i,side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:p,collisionPadding:f,sticky:y,hideWhenDetached:m,avoidCollisions:v,...b}=e,w=li(es,n),[_,x]=g.useState(null),[j,S]=g.useState(null),E=wt(t,J=>x(J)),[O,N]=g.useState(null),[M,P]=g.useState(null),I=_m(n),[k,C]=g.useState(!1),T=g.useRef(!1);g.useEffect(()=>{if(_)return Vl(_)},[_]),Wl();const A=g.useCallback(J=>{const[K,...q]=I().map(z=>z.ref.current),[G]=q.slice(-1),ne=document.activeElement;for(const z of J)if(z===ne||(z==null||z.scrollIntoView({block:"nearest"}),z===K&&j&&(j.scrollTop=0),z===G&&j&&(j.scrollTop=j.scrollHeight),z==null||z.focus(),document.activeElement!==ne))return},[I,j]),R=g.useCallback(()=>A([O,_]),[A,O,_]);g.useEffect(()=>{k&&R()},[k,R]);const{onOpenChange:L,triggerPointerDownPosRef:D}=w;g.useEffect(()=>{if(_){let J={x:0,y:0};const K=G=>{var ne,z;J={x:Math.abs(Math.round(G.pageX)-(((ne=D.current)==null?void 0:ne.x)??0)),y:Math.abs(Math.round(G.pageY)-(((z=D.current)==null?void 0:z.y)??0))}},q=G=>{J.x<=10&&J.y<=10?G.preventDefault():_.contains(G.target)||L(!1),document.removeEventListener("pointermove",K),D.current=null};return D.current!==null&&(document.addEventListener("pointermove",K),document.addEventListener("pointerup",q,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",K),document.removeEventListener("pointerup",q,{capture:!0})}}},[_,L,D]),g.useEffect(()=>{const J=()=>L(!1);return window.addEventListener("blur",J),window.addEventListener("resize",J),()=>{window.removeEventListener("blur",J),window.removeEventListener("resize",J)}},[L]);const[B,F]=n$(J=>{const K=I().filter(ne=>!ne.disabled),q=K.find(ne=>ne.ref.current===document.activeElement),G=r$(K,J,q);G&&setTimeout(()=>G.ref.current.focus())}),$=g.useCallback((J,K,q)=>{const G=!T.current&&!q;(w.value!==void 0&&w.value===K||G)&&(N(J),G&&(T.current=!0))},[w.value]),V=g.useCallback(()=>_==null?void 0:_.focus(),[_]),Q=g.useCallback((J,K,q)=>{const G=!T.current&&!q;(w.value!==void 0&&w.value===K||G)&&P(J)},[w.value]),X=r==="popper"?wj:B8,H=X===wj?{side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:p,collisionPadding:f,sticky:y,hideWhenDetached:m,avoidCollisions:v}:{};return h.jsx($8,{scope:n,content:_,viewport:j,onViewportChange:S,itemRefCallback:$,selectedItem:O,onItemLeave:V,itemTextRefCallback:Q,focusSelectedItem:R,selectedItemText:M,position:r,isPositioned:k,searchRef:B,children:h.jsx(hf,{as:zo,allowPinchZoom:!0,children:h.jsx(of,{asChild:!0,trapped:w.open,onMountAutoFocus:J=>{J.preventDefault()},onUnmountAutoFocus:ge(a,J=>{var K;(K=w.trigger)==null||K.focus({preventScroll:!0}),J.preventDefault()}),children:h.jsx(Og,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:J=>J.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:h.jsx(X,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:J=>J.preventDefault(),...b,...H,onPlaced:()=>C(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:ge(b.onKeyDown,J=>{const K=J.ctrlKey||J.altKey||J.metaKey;if(J.key==="Tab"&&J.preventDefault(),!K&&J.key.length===1&&F(J.key),["ArrowUp","ArrowDown","Home","End"].includes(J.key)){let q=I().filter(G=>!G.disabled).map(G=>G.ref.current);if(["ArrowUp","End"].includes(J.key)&&(q=q.slice().reverse()),["ArrowUp","ArrowDown"].includes(J.key)){const G=J.target,ne=q.indexOf(G);q=q.slice(ne+1)}setTimeout(()=>A(q)),J.preventDefault()}})})})})})})});F8.displayName=xhe;var _he="SelectItemAlignedPosition",B8=g.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,o=li(es,n),i=ui(es,n),[s,c]=g.useState(null),[l,u]=g.useState(null),d=wt(t,E=>u(E)),p=_m(n),f=g.useRef(!1),y=g.useRef(!0),{viewport:m,selectedItem:v,selectedItemText:b,focusSelectedItem:w}=i,_=g.useCallback(()=>{if(o.trigger&&o.valueNode&&s&&l&&m&&v&&b){const E=o.trigger.getBoundingClientRect(),O=l.getBoundingClientRect(),N=o.valueNode.getBoundingClientRect(),M=b.getBoundingClientRect();if(o.dir!=="rtl"){const G=M.left-O.left,ne=N.left-G,z=E.left-ne,se=E.width+z,re=Math.max(se,O.width),le=window.innerWidth-oa,je=xv(ne,[oa,Math.max(oa,le-re)]);s.style.minWidth=se+"px",s.style.left=je+"px"}else{const G=O.right-M.right,ne=window.innerWidth-N.right-G,z=window.innerWidth-E.right-ne,se=E.width+z,re=Math.max(se,O.width),le=window.innerWidth-oa,je=xv(ne,[oa,Math.max(oa,le-re)]);s.style.minWidth=se+"px",s.style.right=je+"px"}const P=p(),I=window.innerHeight-oa*2,k=m.scrollHeight,C=window.getComputedStyle(l),T=parseInt(C.borderTopWidth,10),A=parseInt(C.paddingTop,10),R=parseInt(C.borderBottomWidth,10),L=parseInt(C.paddingBottom,10),D=T+A+k+L+R,B=Math.min(v.offsetHeight*5,D),F=window.getComputedStyle(m),$=parseInt(F.paddingTop,10),V=parseInt(F.paddingBottom,10),Q=E.top+E.height/2-oa,X=I-Q,H=v.offsetHeight/2,J=v.offsetTop+H,K=T+A+J,q=D-K;if(K<=Q){const G=P.length>0&&v===P[P.length-1].ref.current;s.style.bottom="0px";const ne=l.clientHeight-m.offsetTop-m.offsetHeight,z=Math.max(X,H+(G?V:0)+ne+R),se=K+z;s.style.height=se+"px"}else{const G=P.length>0&&v===P[0].ref.current;s.style.top="0px";const ne=Math.max(Q,T+m.offsetTop+(G?$:0)+H)+q;s.style.height=ne+"px",m.scrollTop=K-Q+m.offsetTop}s.style.margin=`${oa}px 0`,s.style.minHeight=B+"px",s.style.maxHeight=I+"px",r==null||r(),requestAnimationFrame(()=>f.current=!0)}},[p,o.trigger,o.valueNode,s,l,m,v,b,o.dir,r]);tn(()=>_(),[_]);const[x,j]=g.useState();tn(()=>{l&&j(window.getComputedStyle(l).zIndex)},[l]);const S=g.useCallback(E=>{E&&y.current===!0&&(_(),w==null||w(),y.current=!1)},[_,w]);return h.jsx(She,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:f,onScrollButtonChange:S,children:h.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:x},children:h.jsx(Ae.div,{...a,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});B8.displayName=_he;var jhe="SelectPopperPosition",wj=g.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=oa,...o}=e,i=jm(n);return h.jsx(A0,{...i,...o,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});wj.displayName=jhe;var[She,xj]=Ac(es,{}),_j="SelectViewport",z8=g.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,o=ui(_j,n),i=xj(_j,n),s=wt(t,o.onViewportChange),c=g.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),h.jsx(xm.Slot,{scope:n,children:h.jsx(Ae.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ge(a.onScroll,l=>{const u=l.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:p}=i;if(p!=null&&p.current&&d){const f=Math.abs(c.current-u.scrollTop);if(f>0){const y=window.innerHeight-oa*2,m=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),b=Math.max(m,v);if(b<y){const w=b+f,_=Math.min(y,w),x=w-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=x>0?x:0,d.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});z8.displayName=_j;var V8="SelectGroup",[Ehe,Ohe]=Ac(V8),Che=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Pt();return h.jsx(Ehe,{scope:n,id:a,children:h.jsx(Ae.div,{role:"group","aria-labelledby":a,...r,ref:t})})});Che.displayName=V8;var W8="SelectLabel",U8=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Ohe(W8,n);return h.jsx(Ae.div,{id:a.id,...r,ref:t})});U8.displayName=W8;var Sm="SelectItem",[Nhe,q8]=Ac(Sm),H8=g.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:o,...i}=e,s=li(Sm,n),c=ui(Sm,n),l=s.value===r,[u,d]=g.useState(o??""),[p,f]=g.useState(!1),y=wt(t,w=>{var _;return(_=c.itemRefCallback)==null?void 0:_.call(c,w,r,a)}),m=Pt(),v=g.useRef("touch"),b=()=>{a||(s.onValueChange(r),s.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(Nhe,{scope:n,value:r,disabled:a,textId:m,isSelected:l,onItemTextChange:g.useCallback(w=>{d(_=>_||((w==null?void 0:w.textContent)??"").trim())},[]),children:h.jsx(xm.ItemSlot,{scope:n,value:r,disabled:a,textValue:u,children:h.jsx(Ae.div,{role:"option","aria-labelledby":m,"data-highlighted":p?"":void 0,"aria-selected":l&&p,"data-state":l?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:y,onFocus:ge(i.onFocus,()=>f(!0)),onBlur:ge(i.onBlur,()=>f(!1)),onClick:ge(i.onClick,()=>{v.current!=="mouse"&&b()}),onPointerUp:ge(i.onPointerUp,()=>{v.current==="mouse"&&b()}),onPointerDown:ge(i.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:ge(i.onPointerMove,w=>{var _;v.current=w.pointerType,a?(_=c.onItemLeave)==null||_.call(c):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ge(i.onPointerLeave,w=>{var _;w.currentTarget===document.activeElement&&((_=c.onItemLeave)==null||_.call(c))}),onKeyDown:ge(i.onKeyDown,w=>{var _;((_=c.searchRef)==null?void 0:_.current)!==""&&w.key===" "||(hhe.includes(w.key)&&b(),w.key===" "&&w.preventDefault())})})})})});H8.displayName=Sm;var Od="SelectItemText",K8=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...o}=e,i=li(Od,n),s=ui(Od,n),c=q8(Od,n),l=vhe(Od,n),[u,d]=g.useState(null),p=wt(t,b=>d(b),c.onItemTextChange,b=>{var w;return(w=s.itemTextRefCallback)==null?void 0:w.call(s,b,c.value,c.disabled)}),f=u==null?void 0:u.textContent,y=g.useMemo(()=>h.jsx("option",{value:c.value,disabled:c.disabled,children:f},c.value),[c.disabled,c.value,f]),{onNativeOptionAdd:m,onNativeOptionRemove:v}=l;return tn(()=>(m(y),()=>v(y)),[m,v,y]),h.jsxs(h.Fragment,{children:[h.jsx(Ae.span,{id:c.textId,...o,ref:p}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Nl.createPortal(o.children,i.valueNode):null]})});K8.displayName=Od;var Z8="SelectItemIndicator",X8=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return q8(Z8,n).isSelected?h.jsx(Ae.span,{"aria-hidden":!0,...r,ref:t}):null});X8.displayName=Z8;var jj="SelectScrollUpButton",Q8=g.forwardRef((e,t)=>{const n=ui(jj,e.__scopeSelect),r=xj(jj,e.__scopeSelect),[a,o]=g.useState(!1),i=wt(t,r.onScrollButtonChange);return tn(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollTop>0;o(l)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(J8,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop-c.offsetHeight)}}):null});Q8.displayName=jj;var Sj="SelectScrollDownButton",G8=g.forwardRef((e,t)=>{const n=ui(Sj,e.__scopeSelect),r=xj(Sj,e.__scopeSelect),[a,o]=g.useState(!1),i=wt(t,r.onScrollButtonChange);return tn(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<l;o(u)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(J8,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop+c.offsetHeight)}}):null});G8.displayName=Sj;var J8=g.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,o=ui("SelectScrollButton",n),i=g.useRef(null),s=_m(n),c=g.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return g.useEffect(()=>()=>c(),[c]),tn(()=>{var l,u;(u=(l=s().find(d=>d.ref.current===document.activeElement))==null?void 0:l.ref.current)==null||u.scrollIntoView({block:"nearest"})},[s]),h.jsx(Ae.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ge(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:ge(a.onPointerMove,()=>{var l;(l=o.onItemLeave)==null||l.call(o),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:ge(a.onPointerLeave,()=>{c()})})}),Mhe="SelectSeparator",Y8=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return h.jsx(Ae.div,{"aria-hidden":!0,...r,ref:t})});Y8.displayName=Mhe;var Ej="SelectArrow",Phe=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=jm(n),o=li(Ej,n),i=ui(Ej,n);return o.open&&i.position==="popper"?h.jsx(T0,{...a,...r,ref:t}):null});Phe.displayName=Ej;function e$(e){return e===""||e===void 0}var t$=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=g.useRef(null),o=wt(t,a),i=M8(n);return g.useEffect(()=>{const s=a.current,c=window.HTMLSelectElement.prototype,l=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==n&&l){const u=new Event("change",{bubbles:!0});l.call(s,n),s.dispatchEvent(u)}},[i,n]),h.jsx($Ae,{asChild:!0,children:h.jsx("select",{...r,ref:o,defaultValue:n})})});t$.displayName="BubbleSelect";function n$(e){const t=tr(e),n=g.useRef(""),r=g.useRef(0),a=g.useCallback(i=>{const s=n.current+i;t(s),function c(l){n.current=l,window.clearTimeout(r.current),l!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(s)},[t]),o=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,o]}function r$(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=khe(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.textValue.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function khe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var Ahe=P8,a$=A8,The=I8,Ihe=R8,Rhe=D8,o$=L8,Dhe=z8,i$=U8,s$=H8,Lhe=K8,$he=X8,c$=Q8,l$=G8,u$=Y8;const _o=Ahe,jo=The,Ta=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(a$,{ref:r,className:Z("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,h.jsx(Ihe,{asChild:!0,children:h.jsx(de,{name:"chevron-down",className:"h-4 w-4 opacity-50"})})]}));Ta.displayName=a$.displayName;const d$=g.forwardRef(({className:e,...t},n)=>h.jsx(c$,{ref:n,className:Z("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(de,{name:"chevron-up",className:"h-4 w-4"})}));d$.displayName=c$.displayName;const p$=g.forwardRef(({className:e,...t},n)=>h.jsx(l$,{ref:n,className:Z("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(de,{name:"chevron-down",className:"h-4 w-4"})}));p$.displayName=l$.displayName;const Ia=g.forwardRef(({className:e,children:t,position:n="popper",...r},a)=>h.jsx(Rhe,{children:h.jsxs(o$,{ref:a,className:Z("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[h.jsx(d$,{}),h.jsx(Dhe,{className:Z("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),h.jsx(p$,{})]})}));Ia.displayName=o$.displayName;const Fhe=g.forwardRef(({className:e,...t},n)=>h.jsx(i$,{ref:n,className:Z("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Fhe.displayName=i$.displayName;const Zn=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(s$,{ref:r,className:Z("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx($he,{children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}),h.jsx(Lhe,{children:t})]}));Zn.displayName=s$.displayName;const Bhe=g.forwardRef(({className:e,...t},n)=>h.jsx(u$,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));Bhe.displayName=u$.displayName;var So="Accordion",zhe=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Oj,Vhe,Whe]=Tp(So),[Em,d2e]=er(So,[Whe,jP]),Cj=jP(),f$=U.forwardRef((e,t)=>{const{type:n,...r}=e,a=r,o=r;return h.jsx(Oj.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?h.jsx(Khe,{...o,ref:t}):h.jsx(Hhe,{...a,ref:t})})});f$.displayName=So;var[h$,Uhe]=Em(So),[m$,qhe]=Em(So,{collapsible:!1}),Hhe=U.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:o=!1,...i}=e,[s,c]=Sn({prop:n,defaultProp:r,onChange:a});return h.jsx(h$,{scope:e.__scopeAccordion,value:s?[s]:[],onItemOpen:c,onItemClose:U.useCallback(()=>o&&c(""),[o,c]),children:h.jsx(m$,{scope:e.__scopeAccordion,collapsible:o,children:h.jsx(y$,{...i,ref:t})})})}),Khe=U.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Sn({prop:n,defaultProp:r,onChange:a}),c=U.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=U.useCallback(u=>s((d=[])=>d.filter(p=>p!==u)),[s]);return h.jsx(h$,{scope:e.__scopeAccordion,value:i,onItemOpen:c,onItemClose:l,children:h.jsx(m$,{scope:e.__scopeAccordion,collapsible:!0,children:h.jsx(y$,{...o,ref:t})})})}),[Zhe,Om]=Em(So),y$=U.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:o="vertical",...i}=e,s=U.useRef(null),c=wt(s,t),l=Vhe(n),u=Uo(a)==="ltr",d=ge(e.onKeyDown,p=>{var E;if(!zhe.includes(p.key))return;const f=p.target,y=l().filter(O=>{var N;return!((N=O.ref.current)!=null&&N.disabled)}),m=y.findIndex(O=>O.ref.current===f),v=y.length;if(m===-1)return;p.preventDefault();let b=m;const w=0,_=v-1,x=()=>{b=m+1,b>_&&(b=w)},j=()=>{b=m-1,b<w&&(b=_)};switch(p.key){case"Home":b=w;break;case"End":b=_;break;case"ArrowRight":o==="horizontal"&&(u?x():j());break;case"ArrowDown":o==="vertical"&&x();break;case"ArrowLeft":o==="horizontal"&&(u?j():x());break;case"ArrowUp":o==="vertical"&&j();break}const S=b%v;(E=y[S].ref.current)==null||E.focus()});return h.jsx(Zhe,{scope:n,disabled:r,direction:a,orientation:o,children:h.jsx(Oj.Slot,{scope:n,children:h.jsx(Ae.div,{...i,"data-orientation":o,ref:c,onKeyDown:r?void 0:d})})})}),Cm="AccordionItem",[Xhe,Nj]=Em(Cm),g$=U.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...a}=e,o=Om(Cm,n),i=Uhe(Cm,n),s=Cj(n),c=Pt(),l=r&&i.value.includes(r)||!1,u=o.disabled||e.disabled;return h.jsx(Xhe,{scope:n,open:l,disabled:u,triggerId:c,children:h.jsx(OP,{"data-orientation":o.orientation,"data-state":j$(l),...s,...a,ref:t,disabled:u,open:l,onOpenChange:d=>{d?i.onItemOpen(r):i.onItemClose(r)}})})});g$.displayName=Cm;var v$="AccordionHeader",b$=U.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Om(So,n),o=Nj(v$,n);return h.jsx(Ae.h3,{"data-orientation":a.orientation,"data-state":j$(o.open),"data-disabled":o.disabled?"":void 0,...r,ref:t})});b$.displayName=v$;var Mj="AccordionTrigger",w$=U.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Om(So,n),o=Nj(Mj,n),i=qhe(Mj,n),s=Cj(n);return h.jsx(Oj.ItemSlot,{scope:n,children:h.jsx(ZX,{"aria-disabled":o.open&&!i.collapsible||void 0,"data-orientation":a.orientation,id:o.triggerId,...s,...r,ref:t})})});w$.displayName=Mj;var x$="AccordionContent",_$=U.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Om(So,n),o=Nj(x$,n),i=Cj(n);return h.jsx(XX,{role:"region","aria-labelledby":o.triggerId,"data-orientation":a.orientation,...i,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});_$.displayName=x$;function j$(e){return e?"open":"closed"}let S$;uM=f$,dM=g$,S$=b$,_v=w$,jv=_$;const E$=uM,Pj=g.forwardRef(({className:e,...t},n)=>h.jsx(dM,{ref:n,className:Z("border-b",e),...t}));Pj.displayName="AccordionItem";const kj=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(S$,{className:"flex",children:h.jsxs(_v,{ref:r,className:Z("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,h.jsx(de,{name:"chevron-down",className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));kj.displayName=_v.displayName;const Aj=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(jv,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:h.jsx("div",{className:Z("pb-4 pt-0",e),children:t})}));Aj.displayName=jv.displayName;const Qhe=[1,2,3,4,5,6,7,8,9,10],O$=g.memo(e=>{const{t}=Pe("flows"),[n,r]=g.useState(""),[a,o]=g.useState([]),[i,s]=g.useState("1"),{loading:c,onSimilaritySearch:l,onCreatePrompt:u,onCreateRetriever:d}=e,p=async()=>{o(await l(n,+i)),r("")},f=async y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),p())};return h.jsxs("div",{className:"mt-4 max-w-full",children:[h.jsx("div",{className:"bg-black/5 dark:bg-white/5 rounded-xl relative",children:h.jsxs("div",{className:"relative px-2 py-1 pb-2",children:[h.jsxs(_o,{value:`${i}`,onValueChange:y=>s(y),children:[h.jsx(Ta,{className:"absolute left-0 !w-14 top-[2px] rounded-xl bg-transparent border-none focus:outline-none focus:ring-0 focus:border-opacity-0 focus:ring-transparent",children:h.jsx(jo,{placeholder:t("vector_database_node.k_select_placeholder")})}),h.jsx(Ia,{children:Qhe.map(y=>h.jsx(Zn,{value:`${y}`,children:y},`${y}`))})]}),h.jsx(uo,{value:n,disabled:c,placeholder:t("vector_database_node.similarity_search_placeholder"),className:Z("w-full rounded-xl px-2 pl-11 border-none resize-none bg-transparent","min-h-8 max-h-8"),onKeyDown:f,onChange:y=>{r(y.target.value)}}),h.jsx("button",{type:"button",disabled:c,onClick:p,className:"absolute right-3 top-5 -translate-y-1/2 rounded-xl bg-black/5 dark:bg-white/5 p-1",children:h.jsx(de,{name:c?"loader-circle":"arrow-right",className:Z("w-4 h-4 dark:text-white",n?"opacity-100":"opacity-30",c?"animate-spin":"")})})]})}),h.jsx(E$,{type:"single",collapsible:!0,children:a==null?void 0:a.map(([y,m],v)=>h.jsxs(Pj,{value:`${v}`,children:[h.jsxs(kj,{children:[`[${m.toFixed(2)}] ${y.pageContent}`.substring(0,32),"..."]}),h.jsx(Aj,{children:y.pageContent})]},`${v}`))}),h.jsxs("div",{className:"w-full mt-4 flex flex-col gap-1",children:[d?h.jsx(ut,{disabled:c,onClick:d,className:"w-full",children:t("vector_database_node.to_retriever")}):void 0,a!=null&&a.length&&u?h.jsx(ut,{disabled:c,onClick:()=>u(a),className:"w-full",children:t("vector_database_node.create_prompt")}):void 0]})]})}),C$=g.memo(({loading:e,onCreateData:t})=>{const{t:n}=Pe("flows"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=async()=>{o&&(await t({id:r,content:o}),a(""),i(""))};return h.jsxs("div",{className:"min-w-80",children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("vector_database_node.add_text.id")}),h.jsx(En,{value:r,disabled:e,onChange:c=>a(c.target.value||""),placeholder:n("vector_database_node.add_text.id_placeholder"),className:"mb-4"}),h.jsxs(nt,{htmlFor:"name",children:[n("vector_database_node.add_text.content")," ",h.jsx("span",{className:"text-red-600",children:"*"})]}),h.jsx(uo,{value:o,disabled:e,onChange:c=>i(c.target.value||""),placeholder:n("vector_database_node.add_text.content_placeholder")})]}),h.jsx("div",{className:"flex justify-between mt-6",children:h.jsx(Vn,{loading:e,disabled:!(o!=null&&o.length),onClick:s,className:"w-full",children:n("vector_database_node.add_text.add")})})]})}),Tj=({className:e,size:t=200,duration:n=15,anchor:r=90,borderWidth:a=1.5,colorFrom:o="#ffaa40",colorTo:i="#9c40ff",delay:s=0})=>h.jsx("div",{style:{"--size":t,"--duration":n,"--anchor":r,"--border-width":a,"--color-from":o,"--color-to":i,"--delay":`-${s}s`},className:Z("pointer-events-none absolute inset-0 rounded-[inherit] [border:calc(var(--border-width)*1px)_solid_transparent]","![mask-clip:padding-box,border-box] ![mask-composite:intersect] [mask:linear-gradient(transparent,transparent),linear-gradient(white,white)]","after:absolute after:aspect-square after:w-[calc(var(--size)*1px)] after:animate-border-beam after:[animation-delay:var(--delay)] after:[background:linear-gradient(to_left,var(--color-from),var(--color-to),transparent)] after:[offset-anchor:calc(var(--anchor)*1%)_50%] after:[offset-path:rect(0_auto_auto_0_round_calc(var(--size)*1px))]",e)});function Ghe({accept:e,maxSize:t}){const{t:n}=Pe("atoms"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=g.useRef(null),[c,l]=g.useState(0),u=p=>{var y;const f=(y=p.target.files)==null?void 0:y[0];d(f)},d=p=>{if(i(""),p){if(t&&p.size>t*1024*1024){i(n("file_upload_input.errors.max_size",{maxSize:t,fileSize:(p.size/1024/1024).toFixed(2)}));return}const f=e==null?void 0:e.split(",").map(y=>y.replace(".","").trim());if(e&&!p.type.match(e.replace("/*",""))&&!(f!=null&&f.some(y=>p.type.includes(y)))){i(n("file_upload_input.errors.accept",{accept:e}));return}return l(p.size),a(p.name),p}};return{fileName:r,error:o,fileInputRef:s,handleFileSelect:u,validateAndSetFile:d,clearFile:()=>{a(""),i(""),l(0),s.current&&(s.current.value="")},fileSize:c}}function Jhe({file:e,setFile:t,loading:n,progress:r,fileOptions:a}){const{toast:o}=Qt(),{t:i}=Pe("atoms"),[s,c]=g.useState(!1),{fileName:l,fileInputRef:u,clearFile:d,error:p,validateAndSetFile:f,fileSize:y}=Ghe({accept:(a==null?void 0:a.accept)||"image/*",maxSize:(a==null?void 0:a.maxSize)||3});g.useEffect(()=>{e||d()},[d,e]),g.useEffect(()=>{p&&o({title:p,variant:"destructive"})},[p,o]);function m(x){const j=f(x);j&&t(j)}function v(x){x.preventDefault(),c(!1);const j=x.dataTransfer.files[0];j&&m(j)}function b(x){var S;const j=(S=x.target.files)==null?void 0:S[0];j&&m(j)}function w(){d(),t(void 0)}const _=g.useMemo(()=>{if(!e)return h.jsx("div",{className:"w-16 h-16 rounded-lg bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center",children:h.jsx(de,{name:"file-text",className:"w-8 h-8 text-zinc-400"})});const x=e.type.startsWith("image/");return h.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:x?h.jsx("img",{src:URL.createObjectURL(e),alt:"Preview",className:"w-full h-full object-cover"}):h.jsx(de,{className:"w-14 h-14",name:"file-text"})})},[e]);return h.jsx(h.Fragment,{children:h.jsxs("div",{className:Z("relative group cursor-pointer","rounded-lg border-2 border-dashed","transition-colors duration-200",s?"border-indigo-500 bg-indigo-50/50 dark:bg-indigo-500/10":"border-zinc-200 dark:border-zinc-800"),onDragOver:x=>{x.preventDefault(),c(!0)},onDragLeave:()=>c(!1),onDrop:v,onClick:()=>{var x;return(x=u.current)==null?void 0:x.click()},onKeyDown:x=>{var j;(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),(j=u.current)==null||j.click())},"aria-label":"Upload file",children:[h.jsx("input",{ref:u,type:"file",disabled:n||!!(r&&r<1),accept:(a==null?void 0:a.accept)||"image/*",onChange:b,className:"hidden"}),h.jsx("div",{className:"p-8 space-y-4",children:l?h.jsxs("div",{className:"flex items-center gap-4",children:[_,h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("p",{className:"text-sm font-medium truncate",children:[l||"No file selected"," ",h.jsx("span",{className:"text-xs text-zinc-500 leading-5",children:y?`(${(y/1024/1024).toFixed(2)} MB)`:""})]}),r&&r<1?h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsxs("p",{children:[(r*100).toFixed(2)," %"]}),h.jsx("div",{className:"h-1 flex-1 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden items-center flex",children:h.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-200",style:{width:`${r*100}%`}})})]}):void 0]}),h.jsx("button",{type:"button",disabled:n||!!(r&&r<1),onClick:x=>{x.stopPropagation(),w()},className:"p-1 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded",children:h.jsx(de,{name:"x",className:"w-5 h-5 text-zinc-400"})}),r&&r<1?h.jsx(Tj,{className:"rounded-lg"}):void 0]}):h.jsxs("div",{className:"flex flex-col items-center gap-2",children:[h.jsx(de,{name:"upload",className:"w-8 h-8 text-zinc-400 dark:text-zinc-500"}),h.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:i("file_upload_input.drop_file")})]})})]})})}function N$({onFileSubmit:e,fileOptions:t,progress:n,loading:r}){const{t:a}=Pe("flows"),[o,i]=g.useState(),s=async()=>{o&&(await e(o),i(void 0))};return h.jsxs("div",{className:"w-full max-w-full space-y-2 mt-4",children:[h.jsx("div",{className:"mb-6",children:h.jsx(Jhe,{progress:n,loading:r,fileOptions:t,setFile:i,file:o})}),h.jsx(Vn,{loading:r,disabled:!o,onClick:s,className:"w-full mt-4",children:a("vector_database_node.add_file.index")})]})}const Nm=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{className:"relative w-full overflow-auto",children:h.jsx("table",{ref:n,className:Z("w-full caption-bottom text-sm",e),...t})}));Nm.displayName="Table";const Mm=g.forwardRef(({className:e,...t},n)=>h.jsx("thead",{ref:n,className:Z("[&_tr]:border-b",e),...t}));Mm.displayName="TableHeader";const Pm=g.forwardRef(({className:e,...t},n)=>h.jsx("tbody",{ref:n,className:Z("[&_tr:last-child]:border-0",e),...t}));Pm.displayName="TableBody";const Yhe=g.forwardRef(({className:e,...t},n)=>h.jsx("tfoot",{ref:n,className:Z("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Yhe.displayName="TableFooter";const ts=g.forwardRef(({className:e,...t},n)=>h.jsx("tr",{ref:n,className:Z("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ts.displayName="TableRow";const Tc=g.forwardRef(({className:e,...t},n)=>h.jsx("th",{ref:n,className:Z("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Tc.displayName="TableHead";const Ic=g.forwardRef(({className:e,...t},n)=>h.jsx("td",{ref:n,className:Z("align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Ic.displayName="TableCell";const eme=g.forwardRef(({className:e,...t},n)=>h.jsx("caption",{ref:n,className:Z("mt-4 text-sm text-muted-foreground",e),...t}));eme.displayName="TableCaption";const M$=({className:e,...t})=>h.jsx("nav",{role:"navigation","aria-label":"pagination",className:Z("mx-auto flex w-full justify-center",e),...t});M$.displayName="Pagination";const P$=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,className:Z("flex flex-row items-center gap-1",e),...t}));P$.displayName="PaginationContent";const Rc=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,className:Z("",e),...t}));Rc.displayName="PaginationItem";const km=({className:e,isActive:t,size:n="icon",...r})=>h.jsx("a",{"aria-current":t?"page":void 0,className:Z(eu({variant:t?"outline":"ghost",size:n}),e),...r});km.displayName="PaginationLink";const k$=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs(km,{"aria-label":"Go to previous page",size:"default",className:Z("gap-1 pl-2.5",e),...t,children:[h.jsx(de,{name:"chevron-left",className:"h-4 w-4"}),h.jsx("span",{children:n("pagination.previous")})]})};k$.displayName="PaginationPrevious";const A$=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs(km,{"aria-label":"Go to next page",size:"default",className:Z("gap-1 pr-2.5",e),...t,children:[h.jsx("span",{children:n("pagination.next")}),h.jsx(de,{name:"chevron-right",className:"h-4 w-4"})]})};A$.displayName="PaginationNext";const Ij=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs("span",{"aria-hidden":!0,className:Z("flex h-9 w-9 items-center justify-center",e),...t,children:[h.jsx(de,{name:"ellipsis",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:n("pagination.more_pages")})]})};Ij.displayName="PaginationEllipsis";const T$=Ha(({title:e,content:t})=>{const n=Xt();return h.jsx(Yo,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(no,{className:"sm:max-w-2xl",children:[h.jsx(ro,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(ao,{children:e})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-96 overflow-hidden",children:h.jsx("div",{className:"relative w-full h-full overflow-hidden rounded-xl p-1 border border-border",children:h.jsx("pre",{className:"break-all h-full overflow-y-auto bg-background font-mono text-xs w-full",children:t})})})]})})}),Am=g.memo(e=>{const{data:t,headers:n,limitLengthByColumns:r,showPerPage:a=7,paginationShowLimit:o=1,contentLengthLimit:i=64}=e,[s,c]=g.useState({page:1,maxPage:1}),l=Xt(T$);g.useEffect(()=>{c(f=>({...f,maxPage:Math.ceil(t.length/a)}))},[t.length,a]);const u=g.useMemo(()=>t.slice((s.page-1)*a,s.page*a),[t,s.page,a]),d=g.useMemo(()=>{let f=!1,y=!1;return h.jsx(M$,{className:"mt-4 mb-4 ml-4 mr-4 w-full",children:h.jsxs(P$,{children:[s.page>1?h.jsx(Rc,{onClick:()=>c(m=>({...m,page:m.page-1})),children:h.jsx(k$,{})}):null,Array.from({length:s.maxPage},(m,v)=>{const b=v+1,w=v===0||v===s.maxPage-1;return!w&&b>s.page+o&&y?null:!w&&b>s.page+o?(y=!0,h.jsx(Rc,{children:h.jsx(Ij,{})},v)):!w&&b<s.page-o&&f?null:!w&&b<s.page-o?(f=!0,h.jsx(Rc,{children:h.jsx(Ij,{})},v)):h.jsx(Rc,{onClick:()=>c(_=>({..._,page:b})),children:h.jsx(km,{isActive:v+1===s.page,children:v+1})},v)}),s.page<s.maxPage?h.jsx(Rc,{onClick:()=>c(m=>({...m,page:m.page+1})),children:h.jsx(A$,{})}):null]})})},[s.maxPage,s.page,o]),p=(f,y)=>{if(!f)return;const m=Array.isArray(f)?f:n.map(v=>f[v]);return h.jsxs(ts,{children:[h.jsx(Ic,{children:h.jsx("div",{className:"font-bold",children:y+1})}),m.map((v,b)=>{const w=typeof v=="string"?v:JSON.stringify(v),_=n[b],x=(r==null?void 0:r[_])||i,j=w.length>x;return h.jsx(Ic,{className:"p-4",children:h.jsxs("div",{onClick:j?()=>l.show({title:_,content:w}):void 0,className:"flex gap-4",children:[j?`${w.substring(0,x)}...`:w,j?h.jsx(de,{className:"w-6 mt-[-2px]",name:"chevron-right"}):null]})},`${b}`)})]},`${y}`)};return h.jsxs(h.Fragment,{children:[h.jsxs(Nm,{className:"w-full",children:[h.jsx(Mm,{children:h.jsxs(ts,{children:[h.jsx(Tc,{},"index"),n?n.map(f=>h.jsx(Tc,{children:h.jsx("div",{className:"font-bold",children:f})},f)):void 0]})}),h.jsx(Pm,{children:u!=null&&u.length?u==null?void 0:u.map(p):void 0})]}),d]})});var Rj,I$;Av=function(){if(I$)return Rj;I$=1;function e(t,n,r){var a=-1,o=t.length;n<0&&(n=-n>o?0:o+n),r=r>o?o:r,r<0&&(r+=o),o=n>r?0:r-n>>>0,n>>>=0;for(var i=Array(o);++a<o;)i[a]=t[a+n];return i}return Rj=e,Rj};var Dj,R$;Ss=function(){if(R$)return Dj;R$=1;var e=Rl(),t=Ni(),n=Jf(),r=Tr();function a(o,i,s){if(!r(s))return!1;var c=typeof i;return(c=="number"?t(s)&&n(i,s.length):c=="string"&&i in s)?e(s[i],o):!1}return Dj=a,Dj};var Lj,D$;function tme(){if(D$)return Lj;D$=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return Lj=t,Lj}var $j,L$;function nme(){if(L$)return $j;L$=1;var e=tme(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return $j=n,$j}var Fj,$$;function F$(){if($$)return Fj;$$=1;var e=nme(),t=Tr(),n=Gs(),r=NaN,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=o.test(l);return d||i.test(l)?s(l.slice(2),d?2:8):a.test(l)?r:+l}return Fj=c,Fj}var Bj,B$;function z$(){if(B$)return Bj;B$=1;var e=F$(),t=1/0,n=17976931348623157e292;function r(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var o=a<0?-1:1;return o*n}return a===a?a:0}return Bj=r,Bj}var zj,V$;function W$(){if(V$)return zj;V$=1;var e=z$();function t(n){var r=e(n),a=r%1;return r===r?a?r-a:r:0}return zj=t,zj}var Vj,U$;function rme(){if(U$)return Vj;U$=1;var e=Av(),t=Ss(),n=W$(),r=Math.ceil,a=Math.max;function o(i,s,c){(c?t(i,s,c):s===void 0)?s=1:s=a(n(s),0);var l=i==null?0:i.length;if(!l||s<1)return[];for(var u=0,d=0,p=Array(r(l/s));u<l;)p[d++]=e(i,u,u+=s);return p}return Vj=o,Vj}var ame=rme();const Wj=ot(ame),ome=()=>{const[e,t]=g.useState(!1),{t:n}=Pe("flows"),{toast:r}=Qt(),a=js(c=>c.index),o=js(c=>c.similaritySearchWithScore),i=g.useCallback(async(c,l)=>{try{if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===kr.DataNode)throw new Error("DataNode storage is not supported for similarity search");return t(!0),await o({databaseId:l.vectorDatabase.id},c,l==null?void 0:l.k)}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[o,r,n]),s=g.useCallback(async(c,l)=>{var u;try{t(!0);const d=c.content?[new Lp({pageContent:c.content,id:c.id,metadata:{id:c.id}})]:c.documents;if(!(d!=null&&d.length)){r({variant:"destructive",title:n("vector_database_node.errors.content_not_found")});return}if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===kr.DataNode)throw new Error("DataNode storage is not supported for indexing");{const p=Wj(d,10);let f=0;for(const y of p)(u=l==null?void 0:l.onProgressReport)==null||u.call(l,{handling:y.length,handled:f,total:d.length}),await a({databaseId:l.vectorDatabase.id},y),f+=y.length}}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[a,r,n]);return{loading:e,indexData:s,similaritySearchWithScore:i}},ime=Ha(({retriverInfo:e})=>{var m,v,b;const{t}=Pe("applications"),{loading:n,similaritySearchWithScore:r,indexData:a}=ome(),[o,i]=g.useState("search"),[s,c]=g.useState(0),l=Xt(),u=g.useMemo(()=>{var x,j;if(!((x=e==null?void 0:e.vectorDatabaseEntity)!=null&&x.raw))return{headers:[],rows:[]};const w=["content","embedding","metadata"],_=Pg((j=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:j.raw);return{headers:w,rows:_.map(S=>{try{return JSON.parse(S)}catch{return[]}})}},[(m=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:m.raw]),d=g.useCallback(async(...w)=>{const[_,x]=w;await a(_,{...x,vectorDatabase:e.vectorDatabaseEntity})},[a,e.vectorDatabaseEntity]),p=g.useCallback(async(w,_)=>{const x=w.trim(),j=await r(x,{k:_,vectorDatabase:e.vectorDatabaseEntity});if(j!=null&&j.length)return j},[e.vectorDatabaseEntity,r]),f=g.useCallback(async w=>{if(w.type.includes("text")||w.type.includes("txt")){const _=new FileReader;_.onload=async x=>{var S;const j=(S=x.target)==null?void 0:S.result;await d({content:j},{vectorDatabase:e.vectorDatabaseEntity})},_.readAsText(w)}else if(w.type.endsWith("pdf")){const _=new Blob([w],{type:"application/pdf"}),x=await new m8(_,{pdfjs:async()=>{const j=await At(()=>import("./pdf.min-CapCbGu3.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([7,1,2,3,4]));return await At(()=>import("./pdf.worker.min-DTwv-ugy.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([8,1,2,3,4])),j.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),j},parsedItemSeparator:" "}).load();await d({documents:x},{vectorDatabase:e.vectorDatabaseEntity,onProgressReport:j=>{c((j.handled+j.handling)/j.total)}})}},[d,e.vectorDatabaseEntity]),y=g.useMemo(()=>{switch(o){case"search":return h.jsx(aa,{value:"search",children:h.jsx(O$,{loading:n,onSimilaritySearch:p})});case"new":return h.jsx(aa,{className:"min-w-80",value:"new",children:h.jsx(C$,{loading:n,onCreateData:d})});case"file":return h.jsx(aa,{value:"file",children:h.jsx(N$,{loading:n,progress:s,onFileSubmit:f,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(aa,{value:"view",className:"max-h-full overflow-auto",children:h.jsx(Am,{data:u.rows,headers:u.headers,limitLengthByColumns:{embedding:32}})})}},[d,f,p,n,o,s,u]);return h.jsx(Yo,{open:l.visible,onOpenChange:l.hide,children:h.jsxs(no,{className:"max-w-3xl",children:[h.jsx(ro,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(ao,{children:t("chat.vector_database")})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-full overflow-hidden",children:h.jsx("div",{className:"w-full h-full",children:h.jsxs(bj,{value:o,onValueChange:i,defaultValue:"search",className:Z("w-full h-full mt-4"),children:[h.jsxs(wm,{className:Z("grid w-full grid-cols-3",((v=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:v.storage)===kr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(ra,{value:"search",children:t("chat.search")}),h.jsx(ra,{value:"new",children:t("chat.text")}),h.jsx(ra,{value:"file",children:t("chat.file")}),((b=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:b.storage)===kr.DatabaseNode?h.jsx(ra,{value:"view",children:t("chat.view")}):void 0]}),y]})})})]})})}),sme=g.lazy(()=>At(()=>import("./index-BvUKr9zq.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([9,10,1,2,11,12])));function cme({schema:e,mainLLMInfo:t,loadLLM:n,retriverInfo:r,threadNode:a,onSelectThread:o,onAddNewThread:i,currentDataNode:s,...c}){var S;const{t:l}=Pe("applications"),[u,d]=g.useState(!1),p=Vo(E=>E.theme),f=Xt(Hfe),y=Xt(ime),{chatList:m,getChatList:v,deleteChat:b}=she(a),w=g.useCallback(async()=>{try{d(!0),await(i==null?void 0:i()),v()}finally{d(!1)}},[v,i]),_=g.useCallback(()=>{y.show({retriverInfo:r[0]})},[r,y]),x=g.useCallback(async(E,O)=>{E.stopPropagation(),f.show({onDelete:()=>b(O)})},[b,f]),j=g.useMemo(()=>{var E;return h.jsx(sme,{className:Z("overflow-hidden break-words whitespace-pre-wrap w-full rounded-lg"),source:(E=e==null?void 0:e.schema_items)!=null&&E.length?`\`\`\`javascript
${f8((e==null?void 0:e.schema_items)||[])}
\`\`\``:"",wrapperElement:{"data-color-mode":p==="dark"?"dark":"light"},components:{pre:({children:O,...N})=>h.jsx("pre",{...N,className:Z(N.className,"nowheel"),children:O})}})},[e==null?void 0:e.schema_items,p]);return h.jsxs(F0,{variant:"sidebar",side:"right",collapsible:"none",...c,children:[h.jsx("div",{className:"h-1"}),h.jsxs(uu,{className:"justify-between",children:[h.jsx("div",{className:"text-sm pl-2",children:l("chat.history")}),h.jsx(Vn,{loading:u,onClick:w,variant:"link",className:"mr-[-6px]",children:h.jsx(de,{name:"circle-plus"})})]}),h.jsxs(z0,{children:[h.jsx(lu,{className:"flex-1",children:h.jsx(Us,{children:m.map(({node:E},O)=>{var N;return h.jsx(eo,{onClick:()=>o(E),children:h.jsx(to,{className:"cursor-pointer",children:h.jsxs("div",{className:"flex flex-row justify-between items-center w-full",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx(de,{size:16,name:((N=s==null?void 0:s.node)==null?void 0:N.id)===E.id?"check":"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"}),h.jsx("span",{children:`Thread ${O+1}`})]}),h.jsx(de,{onClick:M=>x(M,E),size:16,name:"trash-2"})]})})},E.id)})})}),r!=null&&r.length?h.jsxs(Zt,{className:"m-2 p-2 max-w-full",children:[h.jsx("pre",{className:"overflow-auto",children:r.map((E,O)=>{var N;return h.jsx("span",{children:((N=E.promptEntity)==null?void 0:N.content)||""},`${O}`)})}),h.jsx(ut,{onClick:_,className:"w-full mt-4",children:l("chat.vector_database")})]}):void 0,(S=e==null?void 0:e.schema_items)!=null&&S.length?h.jsx("div",{className:"m-2 !mb-0",children:h.jsx(g.Suspense,{fallback:h.jsx(bm,{}),children:j})}):void 0,h.jsx(ihe,{llm:t==null?void 0:t.llm,status:t==null?void 0:t.status,progress:t==null?void 0:t.progress,loadLLM:n})]})]})}var lme=Object.defineProperty,ume=Object.defineProperties,dme=Object.getOwnPropertyDescriptors,Tm=Object.getOwnPropertySymbols,q$=Object.prototype.hasOwnProperty,H$=Object.prototype.propertyIsEnumerable,K$=(e,t,n)=>t in e?lme(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Im=(e,t)=>{for(var n in t||(t={}))q$.call(t,n)&&K$(e,n,t[n]);if(Tm)for(var n of Tm(t))H$.call(t,n)&&K$(e,n,t[n]);return e},pme=(e,t)=>ume(e,dme(t)),fme=(e,t)=>{var n={};for(var r in e)q$.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Tm)for(var r of Tm(e))t.indexOf(r)<0&&H$.call(e,r)&&(n[r]=e[r]);return n};Es=function(...e){return FAe(BAe(e))},YN=function(e,t){const n=e;return U.forwardRef(function(r,a){return U.createElement(n,pme(Im(Im({ref:a},t),r),{className:Es(t.className,r.className)}))})},xK=function(e,...t){return YN(e,{className:Es(t)})},_K=function(e,t,n){const r=e;return U.forwardRef(function(a,o){const i=a,{className:s}=i,c=fme(i,["className"]),l=Im({},c);return n&&n.forEach(u=>{c[u]!==void 0&&delete l[u]}),U.createElement(r,Im({ref:o,className:Es(t(c),s)},l))})};var Uj="Avatar",[hme,p2e]=er(Uj),[mme,Z$]=hme(Uj),X$=g.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,o]=g.useState("idle");return h.jsx(mme,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:h.jsx(Ae.span,{...r,ref:t})})});X$.displayName=Uj;var Q$="AvatarImage",G$=g.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...o}=e,i=Z$(Q$,n),s=yme(r,o.referrerPolicy),c=tr(l=>{a(l),i.onImageLoadingStatusChange(l)});return tn(()=>{s!=="idle"&&c(s)},[s,c]),s==="loaded"?h.jsx(Ae.img,{...o,ref:t,src:r}):null});G$.displayName=Q$;var J$="AvatarFallback",Y$=g.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,o=Z$(J$,n),[i,s]=g.useState(r===void 0);return g.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(c)}},[r]),i&&o.imageLoadingStatus!=="loaded"?h.jsx(Ae.span,{...a,ref:t}):null});Y$.displayName=J$;function yme(e,t){const[n,r]=g.useState("idle");return tn(()=>{if(!e){r("error");return}let a=!0;const o=new window.Image,i=s=>()=>{a&&r(s)};return r("loading"),o.onload=i("loaded"),o.onerror=i("error"),o.src=e,t&&(o.referrerPolicy=t),()=>{a=!1}},[e,t]),n}var eF=X$,tF=G$,nF=Y$;const rF=g.forwardRef(({className:e,...t},n)=>h.jsx(eF,{ref:n,className:Z("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));rF.displayName=eF.displayName;const aF=g.forwardRef(({className:e,...t},n)=>h.jsx(tF,{ref:n,className:Z("aspect-square h-full w-full",e),...t}));aF.displayName=tF.displayName;const oF=g.forwardRef(({className:e,...t},n)=>h.jsx(nF,{ref:n,className:Z("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));oF.displayName=nF.displayName;const gme=qa("flex gap-2 max-w-[60%] items-end relative group",{variants:{variant:{received:"self-start",sent:"self-end flex-row-reverse"},layout:{default:"",ai:"max-w-full w-full items-center"}},defaultVariants:{variant:"received",layout:"default"}}),iF=g.forwardRef(({className:e,variant:t,layout:n,children:r,...a},o)=>h.jsx("div",{className:Z(gme({variant:t,layout:n,className:e}),"relative group"),ref:o,...a,children:g.Children.map(r,i=>g.isValidElement(i)&&typeof i.type!="string"?g.cloneElement(i,{variant:t,layout:n,className:a==null?void 0:a.innerclassname}):i)}));iF.displayName="ChatBubble";const vme=({src:e,fallback:t,className:n})=>h.jsxs(rF,{className:n,children:[h.jsx(aF,{src:e,alt:"Avatar"}),h.jsx(oF,{children:t})]}),bme=qa("p-4",{variants:{variant:{received:"bg-secondary text-secondary-foreground rounded-r-lg rounded-tl-lg",sent:"bg-primary text-primary-foreground rounded-l-lg rounded-tr-lg"},layout:{default:"",ai:"border-t w-full rounded-none bg-transparent"}},defaultVariants:{variant:"received",layout:"default"}}),sF=g.forwardRef(({className:e,variant:t,layout:n,isLoading:r=!1,children:a,...o},i)=>h.jsx("div",{className:Z(bme({variant:t,layout:n,className:e}),"break-words max-w-full whitespace-pre-wrap"),ref:i,...o,children:r?h.jsx("div",{className:"flex items-center space-x-2",children:h.jsx(bm,{})}):a}));sF.displayName="ChatBubbleMessage";const wme=({icon:e,onClick:t,className:n,variant:r="ghost",size:a="icon",...o})=>h.jsx(ut,{variant:r,size:a,className:n,onClick:t,...o,children:e}),xme=g.forwardRef(({variant:e,className:t,children:n,...r},a)=>h.jsx("div",{ref:a,className:Z("absolute top-1/2 -translate-y-1/2 flex opacity-0 group-hover:opacity-100 transition-opacity duration-200",e==="sent"?"-left-1 -translate-x-full flex-row-reverse":"-right-1 translate-x-full",t),...r,children:n}));xme.displayName="ChatBubbleActionWrapper";const _me=g.lazy(()=>At(()=>import("./index-BvUKr9zq.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([9,10,1,2,11,12]))),jme=[{icon:"copy",label:"Copy"},{icon:"refresh-ccw",label:"Refresh"},{icon:"volume-2",label:"Volume"}],Sme=g.memo(({message:e,index:t,isLastMessage:n,isGenerating:r,isSchema:a,onActionClick:o})=>{const i=Vo(c=>c.theme),s=g.useMemo(()=>h.jsx(_me,{className:Es("[&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans !text-sm"),style:{color:"unset !important"},source:e.content?a?`\`\`\`json
${e.content}
\`\`\``:e.content:"",wrapperElement:{"data-color-mode":i==="dark"?"dark":"light"},components:{pre:({children:c,...l})=>h.jsx("pre",{...l,className:Es(l.className,"nowheel"),children:c})}}),[a,e.content,i]);return h.jsxs(iF,{innerclassname:e.role=="system"?"!bg-transparent font-semibold":void 0,variant:e.role=="user"?"sent":"received",children:[e.role==="system"?h.jsx("div",{className:"w-10 h-10"}):e.role==="assistant"?h.jsx(vme,{src:"",fallback:e.data&&typeof e.data=="object"&&"injectedMessage"in e.data?"\u{1F4C2}":"\u{1F916}"}):void 0,h.jsxs(sF,{children:[r&&n&&(!e.content||a)?h.jsx(bm,{}):h.jsxs(g.Suspense,{fallback:h.jsx(bm,{}),children:[e.role==="system"?h.jsx(xn,{className:"!text-sm mb-1",children:"System"}):void 0,s]}),e.role==="assistant"&&n&&h.jsx("div",{className:"flex items-center mt-1.5 gap-1",children:!r&&h.jsx(h.Fragment,{children:jme.map((c,l)=>h.jsx(wme,{variant:"ghost",className:"size-5",icon:h.jsx(de,{name:c.icon,className:"size-3"}),onClick:()=>o(c.label,e)},l))})})]})]},t)},()=>!1),Eme=g.memo(()=>{const{t:e}=Pe("applications"),t=g.useRef(!1),[n,r]=g.useState(!1),a=g.useCallback(()=>{setTimeout(()=>{N.current&&(N.current.scrollTop=N.current.scrollHeight)},50)},[]),o=bue(),{schema:i,threadInfo:s,mainLLMInfo:c,retriverInfo:l,currentDataNode:u,loadLLM:d,addNewDataNode:p,selectDataNode:f,updateMessagesData:y,onThreadMessagesLoaded:m}=o,{sendMessage:v}=qfe(o),{input:b,messages:w,isLoading:_,reload:x,setInput:j,handleSubmit:S,handleInputChange:E,setMessages:O}=HN({fetch:async(C,T)=>{try{r(!0);const A=JSON.parse(T==null?void 0:T.body),R=Oi(),L=A.messages[A.messages.length-1];return t.current=!0,O(D=>[...D,{id:Oi(),content:L.content,role:"user"}]),await v(L.content,A.messages||[],{retriverInfo:l},{schema:i,onInjectedMessages:D=>{D.length&&O(B=>[...B,...D.map(F=>F._getType()==="system"?{id:Oi(),content:`${F.content}`,role:"system",data:{injectedMessage:!0}}:F._getType()==="human"?{id:Oi(),content:`${F.content}`,role:"user",data:{injectedMessage:!0}}:{id:Oi(),content:`${F.content}`,role:"assistant",data:{injectedMessage:!0}})])},onResponseMessageCreate:D=>{O(B=>[...B,{id:R,content:D||"",role:"assistant"}])},onMessageUpdate:D=>{O(B=>{const F=[...B],$=F.findIndex(V=>V.id===R);return $!==-1&&(F[$]={...F[$],content:D.nodeData.content||""}),F}),t.current&&a()}}),O(D=>(y(D),D)),r(!1),j(""),t.current&&a(),new Response}finally{r(!1)}}}),N=g.useRef(null);g.useEffect(()=>{const C=m(T=>{O(T||[]),a()});return()=>{C()}},[O,m,a]);const M=async(C,T)=>(r(!0),await S(T),!0),P=g.useCallback(async(C,T)=>{if(C==="Refresh"){r(!0);try{await x()}finally{r(!1)}}C==="Copy"&&T&&T.role==="assistant"&&navigator.clipboard.writeText(T.content),C==="Volume"&&(T!=null&&T.content)&&await EN.speak((T==null?void 0:T.content)||"")},[x]),I=g.useCallback(()=>t.current=!1,[]),k=g.useMemo(()=>w&&w.map((C,T)=>h.jsx(Sme,{message:C,index:T,isLastMessage:T===w.length-1,isGenerating:n,isSchema:!!i,onActionClick:P},C.id||`${T}`)),[w,n,i,P]);return h.jsxs($0,{onClick:I,className:"max-h-full !overflow-hidden !min-h-full",style:{minHeight:"unset"},defaultOpen:!0,children:[h.jsx(B0,{className:"!max-h-full !overflow-hidden",style:{minHeight:"unset"},children:h.jsxs("main",{className:"flex h-full w-full max-w-2xl flex-col items-center mx-auto overflow-hidden",children:[h.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-w-full max-w-full",children:h.jsx(Q2,{className:"!max-h-full",ref:N,children:k})}),h.jsx(bv,{className:"!max-w-2xl px-4",onSubmit:M,disabled:_||n||(c==null?void 0:c.status)!==Qe.Loaded,placeholder:e("chat.input_message_placeholder"),maxHeight:72,value:b,onChange:E})]})}),h.jsx(cme,{schema:i,currentDataNode:u,threadNode:s==null?void 0:s.threadNode,loadLLM:d,mainLLMInfo:c,retriverInfo:l,onAddNewThread:p,onSelectThread:f})]})}),Ome=()=>{const[e,t]=g.useState(),n=Ye(u=>u.currentSession),{t:r}=Pe("flows"),{toast:a}=Qt(),{stream:o}=kc(),{loadModel:i}=Wh(),{modalRef:s}=mc(od),c=g.useCallback(async(u,d)=>{if(n!=null&&n.main_node_id){if(!(e!=null&&e.llm))return a({variant:"destructive",description:r("editor_node.errors.llm_not_found")});(e==null?void 0:e.status)!==Qe.Loaded&&(await i(e.llm.provider,e.llm.name,p=>{t(f=>f&&{...f,progress:p.text})}),t(p=>p&&{...p,status:Qe.Loaded,progress:""}));try{return(await o(e==null?void 0:e.llm.provider,typeof u=="string"?[new Pr(u)]:u,{onMessageUpdate:p=>{d==null||d(p.content)},llm:e==null?void 0:e.llm})).content}catch(p){if(p instanceof Error&&p.message.includes("LLM_NOT_LOADED_YET"))return a({title:r("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:r("editor_node.errors.stream_message_failed")})}}},[n==null?void 0:n.main_node_id,e==null?void 0:e.llm,e==null?void 0:e.status,a,r,i,o]),l=g.useCallback(async()=>{if(!(n!=null&&n.main_node_id))return;const u=await ue("FlowEdge").find({where:{target:n.main_node_id}}),d=(await ue("FlowNode").find({where:{id:Ca(u.map(f=>f.source))}})).find(f=>f.source_type===oe.LLM);if(!d)return;const p=await ue("LLM").findOne({where:{id:d.source_id}});p&&(n.passphrase&&await qh(n.passphrase,s.current),await i(p.provider,p.name,f=>{t(y=>y&&{...y,llm:p,progress:f.text})}),t({llm:p,status:Qe.Loaded}))},[n==null?void 0:n.main_node_id,n==null?void 0:n.passphrase,i,s]);return g.useEffect(()=>{n!=null&&n.main_node_id&&l()},[n==null?void 0:n.main_node_id,l]),{mainLLMInfo:e,createMessage:c}},Cme=()=>{const e=Ye(o=>o.currentSession),t=g.useRef(null),[n,r]=g.useState(),a=g.useCallback(async o=>{e!=null&&e.main_node_id&&(clearTimeout(t.current),t.current=setTimeout(async()=>{e!=null&&e.main_node_id&&await ue("FlowNode").update(e.main_node_id,{data:o})},150))},[e]);return g.useEffect(()=>{e!=null&&e.main_node_id&&ue("FlowNode").findOne({where:{id:e.main_node_id}}).then(o=>{r(o)})},[e]),{flowNode:n,updateEditorContent:a}},Nme=g.lazy(()=>At(()=>import("./index-V6CS-75v.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,11,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),Mme=g.memo(()=>{var o,i,s,c,l;const{flowNode:e,updateEditorContent:t}=Cme(),{mainLLMInfo:n,createMessage:r}=Ome(),a=g.useCallback(u=>{t(u)},[t]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(su,{children:h.jsx(ba,{children:h.jsxs("div",{className:Z("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(n==null?void 0:n.status)===Qe.Loaded&&((o=n==null?void 0:n.llm)!=null&&o.name)?h.jsx(Aa,{name:(i=n==null?void 0:n.llm)==null?void 0:i.name,className:"w-5 h-5 mr-1"}):void 0,h.jsx(wa,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:n!=null&&n.progress?n==null?void 0:n.progress:(n==null?void 0:n.status)===Qe.Loaded?(s=n==null?void 0:n.llm)==null?void 0:s.name:h.jsx(de,{size:16,name:"loader-circle",className:"animate-spin ml-2"})}),h.jsx(Br,{children:h.jsx("p",{children:(n==null?void 0:n.progress)||((c=n==null?void 0:n.llm)==null?void 0:c.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(Al,{simple:!0}),children:e?h.jsx(Nme,{defaultValue:e==null?void 0:e.data,onValueChange:a,copilotStream:r,hideDragIcon:!0,enableHistoryControl:!0},((l=n==null?void 0:n.llm)==null?void 0:l.name)||"default"):h.jsx(Al,{simple:!0})})]})}),Pme=()=>{const[e,t]=g.useState(!1),[n,r]=g.useState(),a=Ye(f=>f.currentSession),{t:o}=Pe("flows"),{toast:i}=Qt(),{loadModel:s}=Wh(),{stream:c}=kc(),{modalRef:l}=mc(od),u=g.useCallback(async(f,y,m)=>{if(a!=null&&a.main_node_id){if(!(n!=null&&n.llm)){i({variant:"destructive",description:o("editor_node.errors.llm_not_found")});return}(n==null?void 0:n.status)!==Qe.Loaded&&(await s(n.llm.provider,n.llm.name,v=>{r(b=>b&&{...b,progress:v.text})}),r(v=>v&&{...v,status:Qe.Loaded,progress:""}));try{const v=y.map(w=>w.role==="system"?new Mg(w.content):w.role==="assistant"?new Wo(w.content):new Pr(w.content)),{content:b}=await c(n.llm.provider,[...v,new Pr(f)],{onMessageUpdate:({content:w})=>{m==null||m(w)},llm:n.llm});return m==null||m(b),b}catch(v){if(v instanceof Error&&v.message.includes("LLM_NOT_LOADED_YET")){i({title:o("editor_node.errors.llm_not_loaded_yet")});return}i({variant:"destructive",title:o("editor_node.errors.stream_message_failed")})}}},[a==null?void 0:a.main_node_id,n==null?void 0:n.llm,n==null?void 0:n.status,i,o,s,c]),d=g.useCallback(async()=>{try{if(t(!0),!(a!=null&&a.main_node_id))return;const f=await ue("FlowEdge").find({where:{target:a.main_node_id}}),y=(await ue("FlowNode").find({where:{id:Ca(f.map(v=>v.source))}})).find(v=>v.source_type===oe.LLM);if(!y)return;const m=await ue("LLM").findOne({where:{id:y.source_id}});if(!m)return;a.passphrase&&await qh(a.passphrase,l.current),await s(m.provider,m.name,v=>{r(b=>b&&{...b,llm:m,progress:v.text})}),r({llm:m,status:Qe.Loaded})}finally{t(!1)}},[a==null?void 0:a.main_node_id,a==null?void 0:a.passphrase,s,l]),p=g.useCallback(async()=>{try{if(t(!0),!(n!=null&&n.llm))return;await s(n.llm.provider,n.llm.name,f=>{r(y=>y&&{...y,progress:f.text})}),r(f=>f&&{...f,status:Qe.Loaded,progress:""})}finally{t(!1)}},[s,n==null?void 0:n.llm]);return g.useEffect(()=>{a!=null&&a.main_node_id&&d()},[a==null?void 0:a.main_node_id,d]),{loading:e,mainLLMInfo:n,createMessage:u,loadCurrentModel:p}};pM=function(e,t=""){const n=[];for(const[r,a]of Object.entries(e)){const o=Oi(),i=[t,r].filter(Boolean).join("/"),s="file"in a&&"contents"in a.file?a.file:void 0,c={id:o,isSelectable:!0,content:typeof(s==null?void 0:s.contents)=="string"?s.contents:void 0,file:i,name:r,children:[]};"directory"in a&&(c.children=pM(a.directory,i)),n.push(c)}return n},Sv=function(e){const t=e.trim().split(`
`),n={};return t.forEach(r=>{const{file:a,content:o}=JSON.parse(r),i=a.split("/");let s=n;for(let c=0;c<i.length;c++){const l=i[c];c===i.length-1?s[l]={file:{contents:o}}:(s[l]||(s[l]={directory:{}}),s=s[l].directory)}}),n},wv=function(e){const t=[];function n(r,a=[]){for(const[o,i]of Object.entries(r))if("file"in i){const s=[...a,o].join("/");if("contents"in i.file){const c=i.file.contents;t.push(JSON.stringify({file:s,content:c}))}}else"directory"in i&&n(i.directory,[...a,o])}return n(e),t.join(`
`)},Ev=function(e,t){return gK(`[UpdateCodeContainerFile] Changes ${t.map(n=>`${n.type||"create_or_update"}:${n.path}`).join(", ")}`),t.forEach(({path:n,content:r,type:a="create_or_update"})=>{const o=n.replace(/^\.\//,"").split("/");let i=e;for(let s=0;s<o.length;s++){const c=o[s];if(s===o.length-1)a==="delete"?c in i&&"file"in i[c]?delete i[c]:console.warn(`Path "${n}" is not a file or does not exist.`):c in i&&"file"in i[c]?i[c].file.contents=r:i[c]={file:{contents:r}};else if(c in i&&"directory"in i[c])i=i[c].directory;else if(a==="delete"){console.warn(`Path "${n}" does not exist.`);break}else i[c]={directory:{}},i=i[c].directory}}),e};const kme=()=>{const e=Ye(i=>i.currentSession),[t,n]=g.useState(),r=g.useCallback(async(i,s)=>{await ue("FlowNode").update(i,{raw:wv(s)})},[]),a=g.useCallback(async i=>{e!=null&&e.main_node_id&&n(s=>{if(!(e!=null&&e.main_node_id))return s;const c=Ev(s||{},i);return r(e==null?void 0:e.main_node_id,c),c})},[e==null?void 0:e.main_node_id,r]),o=g.useCallback(async()=>{if(!(e!=null&&e.main_node_id))return;const i=await ue("FlowNode").findOne({where:{id:e==null?void 0:e.main_node_id}});i&&n(i.raw?Sv(i.raw):{})},[e==null?void 0:e.main_node_id]);return g.useEffect(()=>{e!=null&&e.main_node_id&&o()},[e==null?void 0:e.main_node_id,o]),{fileSystemTree:t,updateCodeContainerFile:a,updateCodeContainerData:r}},Ame=g.lazy(()=>At(()=>import("./index-D0mkdqkZ.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),Tme=g.memo(()=>{var s,c,l,u;const{loading:e,mainLLMInfo:t,loadCurrentModel:n,createMessage:r}=Pme(),{fileSystemTree:a,updateCodeContainerFile:o}=kme(),i=g.useCallback((d,p,f)=>r(d,p,f),[r]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(su,{children:h.jsx(ba,{children:h.jsxs("div",{className:Z("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(t==null?void 0:t.status)===Qe.Loaded&&((s=t==null?void 0:t.llm)!=null&&s.name)?h.jsx(Aa,{name:(c=t==null?void 0:t.llm)==null?void 0:c.name,className:"w-5 h-5 mr-1"}):void 0,h.jsxs(wa,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:[t!=null&&t.progress?t.progress:(t==null?void 0:t.status)===Qe.Loaded?((l=t==null?void 0:t.llm)==null?void 0:l.name)||"":e?h.jsx(de,{size:16,name:"loader-circle",className:"animate-spin ml-2"}):void 0,t!=null&&t.llm&&(t==null?void 0:t.status)!==Qe.Loaded?h.jsx(de,{size:16,name:"loader-circle",onClick:n,className:"animate-spin ml-2"}):void 0]}),h.jsx(Br,{children:h.jsx("p",{children:(t==null?void 0:t.progress)||((u=t==null?void 0:t.llm)==null?void 0:u.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(Al,{simple:!0}),children:a!==void 0?h.jsx(Ame,{autoLoad:!0,hideAppName:!0,llm:t==null?void 0:t.llm,fileSystemTree:a,onUpdateFileContent:o,sendMessage:i}):void 0})]})});function Ime(){var t,n;const e=Ye(r=>r.currentSession);if(!e)return h.jsx(Al,{simple:!0,className:"w-full h-full"});if(e.main_source_type==="Thread")return h.jsx(Eme,{});if(((t=e.main_node)==null?void 0:t.node_type)==="EDITOR_APP")return h.jsx(Mme,{});if(((n=e.main_node)==null?void 0:n.node_type)==="VSLITE_APP")return h.jsx(Tme,{})}var Rm="Menubar",[qj,Rme,Dme]=Tp(Rm),[cF,f2e]=er(Rm,[Dme,Za]),Fn=If(),lF=Za(),[Lme,Hj]=cF(Rm),uF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,value:r,onValueChange:a,defaultValue:o,loop:i=!0,dir:s,...c}=e,l=Uo(s),u=lF(n),[d="",p]=Sn({prop:r,onChange:a,defaultProp:o}),[f,y]=g.useState(null);return h.jsx(Lme,{scope:n,value:d,onMenuOpen:g.useCallback(m=>{p(m),y(m)},[p]),onMenuClose:g.useCallback(()=>p(""),[p]),onMenuToggle:g.useCallback(m=>{p(v=>v?"":m),y(m)},[p]),dir:l,loop:i,children:h.jsx(qj.Provider,{scope:n,children:h.jsx(qj.Slot,{scope:n,children:h.jsx(Fl,{asChild:!0,...u,orientation:"horizontal",loop:i,dir:l,currentTabStopId:f,onCurrentTabStopIdChange:y,children:h.jsx(Ae.div,{role:"menubar",...c,ref:t})})})})})});uF.displayName=Rm;var Kj="MenubarMenu",[$me,dF]=cF(Kj),pF=e=>{const{__scopeMenubar:t,value:n,...r}=e,a=Pt(),o=n||a||"LEGACY_REACT_AUTO_VALUE",i=Hj(Kj,t),s=Fn(t),c=g.useRef(null),l=g.useRef(!1),u=i.value===o;return g.useEffect(()=>{u||(l.current=!1)},[u]),h.jsx($me,{scope:t,value:o,triggerId:Pt(),triggerRef:c,contentId:Pt(),wasKeyboardTriggerOpenRef:l,children:h.jsx(m2,{...s,open:u,onOpenChange:d=>{d||i.onMenuClose()},modal:!1,dir:i.dir,...r})})};pF.displayName=Kj;var Zj="MenubarTrigger",fF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,disabled:r=!1,...a}=e,o=lF(n),i=Fn(n),s=Hj(Zj,n),c=dF(Zj,n),l=g.useRef(null),u=wt(t,l,c.triggerRef),[d,p]=g.useState(!1),f=s.value===c.value;return h.jsx(qj.ItemSlot,{scope:n,value:c.value,disabled:r,children:h.jsx(Bl,{asChild:!0,...o,focusable:!r,tabStopId:c.value,children:h.jsx(y2,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",role:"menuitem",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":f,"aria-controls":f?c.contentId:void 0,"data-highlighted":d?"":void 0,"data-state":f?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:u,onPointerDown:ge(e.onPointerDown,y=>{!r&&y.button===0&&y.ctrlKey===!1&&(s.onMenuOpen(c.value),f||y.preventDefault())}),onPointerEnter:ge(e.onPointerEnter,()=>{var y;s.value&&!f&&(s.onMenuOpen(c.value),(y=l.current)==null||y.focus())}),onKeyDown:ge(e.onKeyDown,y=>{r||(["Enter"," "].includes(y.key)&&s.onMenuToggle(c.value),y.key==="ArrowDown"&&s.onMenuOpen(c.value),["Enter"," ","ArrowDown"].includes(y.key)&&(c.wasKeyboardTriggerOpenRef.current=!0,y.preventDefault()))}),onFocus:ge(e.onFocus,()=>p(!0)),onBlur:ge(e.onBlur,()=>p(!1))})})})})});fF.displayName=Zj;var Fme="MenubarPortal",hF=e=>{const{__scopeMenubar:t,...n}=e,r=Fn(t);return h.jsx(g2,{...r,...n})};hF.displayName=Fme;var Xj="MenubarContent",mF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,align:r="start",...a}=e,o=Fn(n),i=Hj(Xj,n),s=dF(Xj,n),c=Rme(n),l=g.useRef(!1);return h.jsx(v2,{id:s.contentId,"aria-labelledby":s.triggerId,"data-radix-menubar-content":"",...o,...a,ref:t,align:r,onCloseAutoFocus:ge(e.onCloseAutoFocus,u=>{var d;!i.value&&!l.current&&((d=s.triggerRef.current)==null||d.focus()),l.current=!1,u.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,u=>{const d=u.target;c().some(p=>{var f;return(f=p.ref.current)==null?void 0:f.contains(d)})&&u.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,()=>{l.current=!0}),onEntryFocus:u=>{s.wasKeyboardTriggerOpenRef.current||u.preventDefault()},onKeyDown:ge(e.onKeyDown,u=>{if(["ArrowRight","ArrowLeft"].includes(u.key)){const d=u.target,p=d.hasAttribute("data-radix-menubar-subtrigger"),f=d.closest("[data-radix-menubar-content]")!==u.currentTarget,y=(i.dir==="rtl"?"ArrowRight":"ArrowLeft")===u.key;if(!y&&p||f&&y)return;let m=c().filter(w=>!w.disabled).map(w=>w.value);y&&m.reverse();const v=m.indexOf(s.value);m=i.loop?eye(m,v+1):m.slice(v+1);const[b]=m;b&&i.onMenuOpen(b)}},{checkForDefaultPrevented:!1}),style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});mF.displayName=Xj;var Bme="MenubarGroup",zme=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(b2,{...a,...r,ref:t})});zme.displayName=Bme;var Vme="MenubarLabel",yF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(w2,{...a,...r,ref:t})});yF.displayName=Vme;var Wme="MenubarItem",gF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(x2,{...a,...r,ref:t})});gF.displayName=Wme;var Ume="MenubarCheckboxItem",vF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(_2,{...a,...r,ref:t})});vF.displayName=Ume;var qme="MenubarRadioGroup",Hme=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(j2,{...a,...r,ref:t})});Hme.displayName=qme;var Kme="MenubarRadioItem",bF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(S2,{...a,...r,ref:t})});bF.displayName=Kme;var Zme="MenubarItemIndicator",wF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(E2,{...a,...r,ref:t})});wF.displayName=Zme;var Xme="MenubarSeparator",xF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(O2,{...a,...r,ref:t})});xF.displayName=Xme;var Qme="MenubarArrow",Gme=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(C2,{...a,...r,ref:t})});Gme.displayName=Qme;var Jme="MenubarSubTrigger",_F=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(N2,{"data-radix-menubar-subtrigger":"",...a,...r,ref:t})});_F.displayName=Jme;var Yme="MenubarSubContent",jF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(M2,{...a,"data-radix-menubar-content":"",...r,ref:t,style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});jF.displayName=Yme;function eye(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var SF=uF,tye=pF,EF=fF,nye=hF,OF=mF,CF=yF,NF=gF,MF=vF,PF=bF,kF=wF,AF=xF,TF=_F,IF=jF;const Qj=tye,RF=g.forwardRef(({className:e,...t},n)=>h.jsx(SF,{ref:n,className:Z("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",e),...t}));RF.displayName=SF.displayName;const Gj=g.forwardRef(({className:e,...t},n)=>h.jsx(EF,{ref:n,className:Z("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",e),...t}));Gj.displayName=EF.displayName;const rye=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(TF,{ref:a,className:Z("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...r,children:[n,h.jsx(de,{name:"chevron-right",className:"ml-auto h-4 w-4"})]}));rye.displayName=TF.displayName;const aye=g.forwardRef(({className:e,...t},n)=>h.jsx(IF,{ref:n,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));aye.displayName=IF.displayName;const DF=g.forwardRef(({className:e,align:t="start",alignOffset:n=-4,sideOffset:r=8,...a},o)=>h.jsx(nye,{children:h.jsx(OF,{ref:o,align:t,alignOffset:n,sideOffset:r,className:Z("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));DF.displayName=OF.displayName;const LF=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(NF,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));LF.displayName=NF.displayName;const oye=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(MF,{ref:a,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(kF,{children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}),t]}));oye.displayName=MF.displayName;const iye=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(PF,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(kF,{children:h.jsx(de,{name:"circle",className:"h-2 w-2 fill-current"})})}),t]}));iye.displayName=PF.displayName;const sye=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(CF,{ref:r,className:Z("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));sye.displayName=CF.displayName;const cye=g.forwardRef(({className:e,...t},n)=>h.jsx(AF,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));cye.displayName=AF.displayName;let $F;De=zAe()(VAe(WAe((e,t)=>({...W4,...tue(e,t)})))),$F=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.pushSyncNodeQueue),a=De(i=>i.createOrUpdateFlowNode),o=g.useCallback(async(i,s)=>{try{if(!e)throw new Error("Session not found");if(!s.provider||!s.name)throw new Error("Provider and name are required");n(!0);const c=await ue("LLM").findOne({where:{name:s.name,session_id:e}});return c?(r("LLM",{where:{source_type:"LLM",source_id:c.id}}),c):ue("LLM").save({name:`${s.name}`,status:s.provider===ln.WebLLM?Qe.Started:Qe.Loaded,session_id:e,provider:s.provider,metadata:JSON.stringify(s.metadata||{}),model_type:s.model_type||Hl.LLM,parameters:s.parameters||void 0,...s}).then(async l=>{var u,d,p;return await a({source_id:l.id,source_type:"LLM",node_type:oe.LLM,x:(u=i.position)==null?void 0:u.x,y:((d=i.position)==null?void 0:d.y)+(((p=i.measured)==null?void 0:p.height)||0)+30}),l})}finally{n(!1)}},[a,r,e]);return{loading:t,createLLM:o}};function di(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e==null||e(r),n===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function FF(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function BF(...e){return t=>{let n=!1;const r=e.map(a=>{const o=FF(a,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let a=0;a<r.length;a++){const o=r[a];typeof o=="function"?o():FF(e[a],null)}}}}function pi(...e){return g.useCallback(BF(...e),e)}var Jj=g.forwardRef((e,t)=>{const{children:n,...r}=e,a=g.Children.toArray(n),o=a.find(uye);if(o){const i=o.props.children,s=a.map(c=>c===o?g.Children.count(i)>1?g.Children.only(null):g.isValidElement(i)?i.props.children:null:c);return h.jsx(Yj,{...r,ref:t,children:g.isValidElement(i)?g.cloneElement(i,void 0,s):null})}return h.jsx(Yj,{...r,ref:t,children:n})});Jj.displayName="Slot";var Yj=g.forwardRef((e,t)=>{const{children:n,...r}=e;if(g.isValidElement(n)){const a=pye(n);return g.cloneElement(n,{...dye(r,n.props),ref:t?BF(t,a):a})}return g.Children.count(n)>1?g.Children.only(null):null});Yj.displayName="SlotClone";var lye=({children:e})=>h.jsx(h.Fragment,{children:e});function uye(e){return g.isValidElement(e)&&e.type===lye}function dye(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...i)=>{o(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function pye(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var fye=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Eo=fye.reduce((e,t)=>{const n=g.forwardRef((r,a)=>{const{asChild:o,...i}=r,s=o?Jj:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(s,{...i,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function hye(e,t){e&&Nl.flushSync(()=>e.dispatchEvent(t))}var mye="DismissableLayer",eS="dismissableLayer.update",yye="dismissableLayer.pointerDownOutside",gye="dismissableLayer.focusOutside",zF,VF=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),WF=g.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:i,onDismiss:s,...c}=e,l=g.useContext(VF),[u,d]=g.useState(null),p=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=g.useState({}),y=pi(t,E=>d(E)),m=Array.from(l.layers),[v]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),b=m.indexOf(v),w=u?m.indexOf(u):-1,_=l.layersWithOutsidePointerEventsDisabled.size>0,x=w>=b,j=wye(E=>{const O=E.target,N=[...l.branches].some(M=>M.contains(O));!x||N||(a==null||a(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},p),S=xye(E=>{const O=E.target;[...l.branches].some(N=>N.contains(O))||(o==null||o(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},p);return UAe(E=>{w===l.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&s&&(E.preventDefault(),s()))},p),g.useEffect(()=>{if(u)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(zF=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(u)),l.layers.add(u),UF(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=zF)}},[u,p,n,l]),g.useEffect(()=>()=>{u&&(l.layers.delete(u),l.layersWithOutsidePointerEventsDisabled.delete(u),UF())},[u,l]),g.useEffect(()=>{const E=()=>f({});return document.addEventListener(eS,E),()=>document.removeEventListener(eS,E)},[]),h.jsx(Eo.div,{...c,ref:y,style:{pointerEvents:_?x?"auto":"none":void 0,...e.style},onFocusCapture:di(e.onFocusCapture,S.onFocusCapture),onBlurCapture:di(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:di(e.onPointerDownCapture,j.onPointerDownCapture)})});WF.displayName=mye;var vye="DismissableLayerBranch",bye=g.forwardRef((e,t)=>{const n=g.useContext(VF),r=g.useRef(null),a=pi(t,r);return g.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),h.jsx(Eo.div,{...e,ref:a})});bye.displayName=vye;function wye(e,t=globalThis==null?void 0:globalThis.document){const n=tr(e),r=g.useRef(!1),a=g.useRef(()=>{});return g.useEffect(()=>{const o=s=>{if(s.target&&!r.current){let c=function(){qF(yye,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function xye(e,t=globalThis==null?void 0:globalThis.document){const n=tr(e),r=g.useRef(!1);return g.useEffect(()=>{const a=o=>{o.target&&!r.current&&qF(gye,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function UF(){const e=new CustomEvent(eS);document.dispatchEvent(e)}function qF(e,t,n,{discrete:r}){const a=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?hye(a,o):a.dispatchEvent(o)}var tS="focusScope.autoFocusOnMount",nS="focusScope.autoFocusOnUnmount",HF={bubbles:!1,cancelable:!0},_ye="FocusScope",KF=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=tr(a),u=tr(o),d=g.useRef(null),p=pi(t,m=>c(m)),f=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let m=function(_){if(f.paused||!s)return;const x=_.target;s.contains(x)?d.current=x:fi(d.current,{select:!0})},v=function(_){if(f.paused||!s)return;const x=_.relatedTarget;x!==null&&(s.contains(x)||fi(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const x of _)x.removedNodes.length>0&&fi(s)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,f.paused]),g.useEffect(()=>{if(s){QF.add(f);const m=document.activeElement;if(!s.contains(m)){const v=new CustomEvent(tS,HF);s.addEventListener(tS,l),s.dispatchEvent(v),v.defaultPrevented||(jye(Nye(ZF(s)),{select:!0}),document.activeElement===m&&fi(s))}return()=>{s.removeEventListener(tS,l),setTimeout(()=>{const v=new CustomEvent(nS,HF);s.addEventListener(nS,u),s.dispatchEvent(v),v.defaultPrevented||fi(m??document.body,{select:!0}),s.removeEventListener(nS,u),QF.remove(f)},0)}}},[s,l,u,f]);const y=g.useCallback(m=>{if(!n&&!r||f.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,b=document.activeElement;if(v&&b){const w=m.currentTarget,[_,x]=Sye(w);_&&x?!m.shiftKey&&b===x?(m.preventDefault(),n&&fi(_,{select:!0})):m.shiftKey&&b===_&&(m.preventDefault(),n&&fi(x,{select:!0})):b===w&&m.preventDefault()}},[n,r,f.paused]);return h.jsx(Eo.div,{tabIndex:-1,...i,ref:p,onKeyDown:y})});KF.displayName=_ye;function jye(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(fi(r,{select:t}),document.activeElement!==n)return}function Sye(e){const t=ZF(e),n=XF(t,e),r=XF(t.reverse(),e);return[n,r]}function ZF(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function XF(e,t){for(const n of e)if(!Eye(n,{upTo:t}))return n}function Eye(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Oye(e){return e instanceof HTMLInputElement&&"select"in e}function fi(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Oye(e)&&t&&e.select()}}var QF=Cye();function Cye(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=GF(e,t),e.unshift(t)},remove(t){var n;e=GF(e,t),(n=e[0])==null||n.resume()}}}function GF(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Nye(e){return e.filter(t=>t.tagName!=="A")}var Mye="Arrow",JF=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Eo.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});JF.displayName=Mye;var Pye=JF,rS="Popper",[YF,e9]=er(rS),[kye,t9]=YF(rS),n9=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(kye,{scope:t,anchor:r,onAnchorChange:a,children:n})};n9.displayName=rS;var r9="PopperAnchor",a9=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=t9(r9,n),i=g.useRef(null),s=pi(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Eo.div,{...a,ref:s})});a9.displayName=r9;var aS="PopperContent",[Aye,Tye]=YF(aS),o9=g.forwardRef((e,t)=>{var J,K,q,G,ne,z;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:y,...m}=e,v=t9(aS,n),[b,w]=g.useState(null),_=pi(t,se=>w(se)),[x,j]=g.useState(null),S=zp(x),E=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,N=r+(o!=="center"?"-"+o:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(l)?l:[l],I=P.length>0,k={padding:M,boundary:P.filter(Rye),altBoundary:I},{refs:C,floatingStyles:T,placement:A,isPositioned:R,middlewareData:L}=Xg({strategy:"fixed",placement:N,whileElementsMounted:(...se)=>Rg(...se,{animationFrame:f==="always"}),elements:{reference:v.anchor},middleware:[Lg({mainAxis:a+O,alignmentAxis:i}),c&&cv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?lv():void 0,...k}),c&&uv({...k}),dv({...k,apply:({elements:se,rects:re,availableWidth:le,availableHeight:je})=>{const{width:Le,height:$e}=re.reference,Se=se.floating.style;Se.setProperty("--radix-popper-available-width",`${le}px`),Se.setProperty("--radix-popper-available-height",`${je}px`),Se.setProperty("--radix-popper-anchor-width",`${Le}px`),Se.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&pv({element:x,padding:s}),Dye({arrowWidth:E,arrowHeight:O}),p&&fv({strategy:"referenceHidden",...k})]}),[D,B]=c9(A),F=tr(y);tn(()=>{R&&(F==null||F())},[R,F]);const $=(J=L.arrow)==null?void 0:J.x,V=(K=L.arrow)==null?void 0:K.y,Q=((q=L.arrow)==null?void 0:q.centerOffset)!==0,[X,H]=g.useState();return tn(()=>{b&&H(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:R?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:X,"--radix-popper-transform-origin":[(G=L.transformOrigin)==null?void 0:G.x,(ne=L.transformOrigin)==null?void 0:ne.y].join(" "),...((z=L.hide)==null?void 0:z.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(Aye,{scope:n,placedSide:D,onArrowChange:j,arrowX:$,arrowY:V,shouldHideArrow:Q,children:h.jsx(Eo.div,{"data-side":D,"data-align":B,...m,ref:_,style:{...m.style,animation:R?void 0:"none"}})})})});o9.displayName=aS;var i9="PopperArrow",Iye={top:"bottom",right:"left",bottom:"top",left:"right"},s9=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=Tye(i9,n),o=Iye[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(Pye,{...r,ref:t,style:{...r.style,display:"block"}})})});s9.displayName=i9;function Rye(e){return e!==null}var Dye=e=>({name:"transformOrigin",options:e,fn(t){var m,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((m=a.arrow)==null?void 0:m.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=c9(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,p=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let f="",y="";return c==="bottom"?(f=o?u:`${d}px`,y=`${-s}px`):c==="top"?(f=o?u:`${d}px`,y=`${r.floating.height+s}px`):c==="right"?(f=`${-s}px`,y=o?u:`${p}px`):c==="left"&&(f=`${r.floating.width+s}px`,y=o?u:`${p}px`),{data:{x:f,y}}}});function c9(e){const[t,n="center"]=e.split("-");return[t,n]}var Lye=n9,l9=a9,$ye=o9,Fye=s9,Bye="Portal",u9=g.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[a,o]=g.useState(!1);tn(()=>o(!0),[]);const i=n||a&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return i?qAe.createPortal(h.jsx(Eo.div,{...r,ref:t}),i):null});u9.displayName=Bye;function zye(e,t){return g.useReducer((n,r)=>t[n][r]??n,e)}var oS=e=>{const{present:t,children:n}=e,r=Vye(t),a=typeof n=="function"?n({present:r.isPresent}):g.Children.only(n),o=pi(r.ref,Wye(a));return typeof n=="function"||r.isPresent?g.cloneElement(a,{ref:o}):null};oS.displayName="Presence";function Vye(e){const[t,n]=g.useState(),r=g.useRef({}),a=g.useRef(e),o=g.useRef("none"),i=e?"mounted":"unmounted",[s,c]=zye(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const l=Dm(r.current);o.current=s==="mounted"?l:"none"},[s]),tn(()=>{const l=r.current,u=a.current;if(u!==e){const d=o.current,p=Dm(l);e?c("MOUNT"):p==="none"||(l==null?void 0:l.display)==="none"?c("UNMOUNT"):c(u&&d!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),tn(()=>{if(t){let l;const u=t.ownerDocument.defaultView??window,d=f=>{const y=Dm(r.current).includes(f.animationName);if(f.target===t&&y&&(c("ANIMATION_END"),!a.current)){const m=t.style.animationFillMode;t.style.animationFillMode="forwards",l=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=m)})}},p=f=>{f.target===t&&(o.current=Dm(r.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(l),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:g.useCallback(l=>{l&&(r.current=getComputedStyle(l)),n(l)},[])}}function Dm(e){return(e==null?void 0:e.animationName)||"none"}function Wye(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Lm="right-scroll-bar-position",$m="width-before-scroll-bar",Uye="with-scroll-bars-hidden",qye="--removed-body-scroll-bar-size";function iS(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Hye(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var Kye=typeof window<"u"?g.useLayoutEffect:g.useEffect,d9=new WeakMap;function Zye(e,t){var n=Hye(null,function(r){return e.forEach(function(a){return iS(a,r)})});return Kye(function(){var r=d9.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||iS(s,null)}),o.forEach(function(s){a.has(s)||iS(s,i)})}d9.set(n,e)},[e]),n}var p9=hv(),sS=function(){},Fm=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:sS,onWheelCapture:sS,onTouchMoveCapture:sS}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,p=e.sideCar,f=e.noIsolation,y=e.inert,m=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,_=Vp(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=p,j=Zye([n,t]),S=mn(mn({},_),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:p9,removeScrollBar:l,shards:d,noIsolation:f,inert:y,setCallbacks:o,allowPinchZoom:!!m,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),mn(mn({},S),{ref:j})):g.createElement(b,mn({},S,{className:c,ref:j}),s))});Fm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Fm.classNames={fullWidth:$m,zeroRight:Lm};function Xye(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=mv();return t&&e.setAttribute("nonce",t),e}function Qye(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Gye(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Jye=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Xye())&&(Qye(t,n),Gye(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Yye=function(){var e=Jye();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},ege=function(){var e=Yye(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},tge={left:0,top:0,right:0,gap:0},cS=function(e){return parseInt(e||"",10)||0},nge=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[cS(n),cS(r),cS(a)]},rge=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return tge;var t=nge(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},age=ege(),Dc="data-scroll-locked",oge=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Uye,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Dc,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Lm,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat($m,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Lm," .").concat(Lm,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat($m," .").concat($m,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Dc,`] {
    `).concat(qye,": ").concat(s,`px;
  }
`)},f9=function(){var e=parseInt(document.body.getAttribute(Dc)||"0",10);return isFinite(e)?e:0},ige=function(){g.useEffect(function(){return document.body.setAttribute(Dc,(f9()+1).toString()),function(){var e=f9()-1;e<=0?document.body.removeAttribute(Dc):document.body.setAttribute(Dc,e.toString())}},[])},sge=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;ige();var o=g.useMemo(function(){return rge(a)},[a]);return g.createElement(age,{styles:oge(o,!t,a,n?"":"!important")})},lS=!1;if(typeof window<"u")try{var Bm=Object.defineProperty({},"passive",{get:function(){return lS=!0,!0}});window.addEventListener("test",Bm,Bm),window.removeEventListener("test",Bm,Bm)}catch{lS=!1}var Lc=lS?{passive:!1}:!1,cge=function(e){return e.tagName==="TEXTAREA"},h9=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!cge(e)&&n[t]==="visible")},lge=function(e){return h9(e,"overflowY")},uge=function(e){return h9(e,"overflowX")},m9=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=y9(e,r);if(a){var o=g9(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},dge=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},pge=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},y9=function(e,t){return e==="v"?lge(t):uge(t)},g9=function(e,t){return e==="v"?dge(t):pge(t)},fge=function(e,t){return e==="h"&&t==="rtl"?-1:1},hge=function(e,t,n,r,a){var o=fge(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,p=0;do{var f=g9(e,s),y=f[0],m=f[1],v=f[2],b=m-v-o*y;(y||b)&&y9(e,s)&&(d+=b,p+=y),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(p)<1||!a))&&(l=!0),l},zm=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},v9=function(e){return[e.deltaX,e.deltaY]},b9=function(e){return e&&"current"in e?e.current:e},mge=function(e,t){return e[0]===t[0]&&e[1]===t[1]},yge=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},gge=0,$c=[];function vge(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(gge++)[0],o=g.useState(Wp)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=yv([e.lockRef.current],(e.shards||[]).map(b9),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var b=zm(m),w=n.current,_="deltaX"in m?m.deltaX:w[0]-b[0],x="deltaY"in m?m.deltaY:w[1]-b[1],j,S=m.target,E=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in m&&E==="h"&&S.type==="range")return!1;var O=m9(E,S);if(!O)return!0;if(O?j=E:(j=E==="v"?"h":"v",O=m9(E,S)),!O)return!1;if(!r.current&&"changedTouches"in m&&(_||x)&&(r.current=j),!j)return!0;var N=r.current||j;return hge(N,v,m,N==="h"?_:x,!0)},[]),c=g.useCallback(function(m){var v=m;if(!(!$c.length||$c[$c.length-1]!==o)){var b="deltaY"in v?v9(v):zm(v),w=t.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&mge(j.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(b9).filter(Boolean).filter(function(j){return j.contains(v.target)}),x=_.length>0?s(v,_[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(m,v,b,w){var _={name:m,delta:v,target:b,should:w,shadowParent:bge(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(x){return x!==_})},1)},[]),u=g.useCallback(function(m){n.current=zm(m),r.current=void 0},[]),d=g.useCallback(function(m){l(m.type,v9(m),m.target,s(m,e.lockRef.current))},[]),p=g.useCallback(function(m){l(m.type,zm(m),m.target,s(m,e.lockRef.current))},[]);g.useEffect(function(){return $c.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:p}),document.addEventListener("wheel",c,Lc),document.addEventListener("touchmove",c,Lc),document.addEventListener("touchstart",u,Lc),function(){$c=$c.filter(function(m){return m!==o}),document.removeEventListener("wheel",c,Lc),document.removeEventListener("touchmove",c,Lc),document.removeEventListener("touchstart",u,Lc)}},[]);var f=e.removeScrollBar,y=e.inert;return g.createElement(g.Fragment,null,y?g.createElement(o,{styles:yge(a)}):null,f?g.createElement(sge,{gapMode:e.gapMode}):null)}function bge(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const wge=gv(p9,vge);var w9=g.forwardRef(function(e,t){return g.createElement(Fm,mn({},e,{ref:t,sideCar:wge}))});w9.classNames=Fm.classNames;var uS="Popover",[x9,h2e]=er(uS,[e9]),Cd=e9(),[xge,hi]=x9(uS),_9=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!1}=e,s=Cd(t),c=g.useRef(null),[l,u]=g.useState(!1),[d=!1,p]=Sn({prop:r,defaultProp:a,onChange:o});return h.jsx(Lye,{...s,children:h.jsx(xge,{scope:t,contentId:Pt(),triggerRef:c,open:d,onOpenChange:p,onOpenToggle:g.useCallback(()=>p(f=>!f),[p]),hasCustomAnchor:l,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:i,children:n})})};_9.displayName=uS;let dS;dS="PopoverAnchor",$g=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hi(dS,n),o=Cd(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:s}=a;return g.useEffect(()=>(i(),()=>s()),[i,s]),h.jsx(l9,{...o,...r,ref:t})}),$g.displayName=dS;var j9="PopoverTrigger",pS=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hi(j9,n),o=Cd(n),i=pi(t,a.triggerRef),s=h.jsx(Eo.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":N9(a.open),...r,ref:i,onClick:di(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?s:h.jsx(l9,{asChild:!0,...o,children:s})});pS.displayName=j9;var fS="PopoverPortal",[_ge,jge]=x9(fS,{forceMount:void 0}),S9=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,o=hi(fS,t);return h.jsx(_ge,{scope:t,forceMount:n,children:h.jsx(oS,{present:n||o.open,children:h.jsx(u9,{asChild:!0,container:a,children:r})})})};S9.displayName=fS;var Fc="PopoverContent",E9=g.forwardRef((e,t)=>{const n=jge(Fc,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,o=hi(Fc,e.__scopePopover);return h.jsx(oS,{present:r||o.open,children:o.modal?h.jsx(Sge,{...a,ref:t}):h.jsx(Ege,{...a,ref:t})})});E9.displayName=Fc;var Sge=g.forwardRef((e,t)=>{const n=hi(Fc,e.__scopePopover),r=g.useRef(null),a=pi(t,r),o=g.useRef(!1);return g.useEffect(()=>{const i=r.current;if(i)return Vl(i)},[]),h.jsx(w9,{as:Jj,allowPinchZoom:!0,children:h.jsx(O9,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:di(e.onCloseAutoFocus,i=>{var s;i.preventDefault(),o.current||((s=n.triggerRef.current)==null||s.focus())}),onPointerDownOutside:di(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,c=s.button===0&&s.ctrlKey===!0,l=s.button===2||c;o.current=l},{checkForDefaultPrevented:!1}),onFocusOutside:di(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ege=g.forwardRef((e,t)=>{const n=hi(Fc,e.__scopePopover),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(O9,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),O9=g.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onInteractOutside:u,...d}=e,p=hi(Fc,n),f=Cd(n);return Wl(),h.jsx(KF,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(WF,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onDismiss:()=>p.onOpenChange(!1),children:h.jsx($ye,{"data-state":N9(p.open),role:"dialog",id:p.contentId,...f,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),C9="PopoverClose",Oge=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hi(C9,n);return h.jsx(Eo.button,{type:"button",...r,ref:t,onClick:di(e.onClick,()=>a.onOpenChange(!1))})});Oge.displayName=C9;var Cge="PopoverArrow",Nge=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Cd(n);return h.jsx(Fye,{...a,...r,ref:t})});Nge.displayName=Cge;function N9(e){return e?"open":"closed"}GN=_9,OK=$g,JN=pS,QN=S9,Qg=E9,lM=GN,PK=JN,vv=g.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},a)=>h.jsx(QN,{children:h.jsx(Qg,{ref:a,align:t,sideOffset:n,className:Z("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})})),vv.displayName=Qg.displayName;var M9=1,Mge=.9,Pge=.8,kge=.17,hS=.1,mS=.999,Age=.9999,Tge=.99,Ige=/[\\\/_+.#"@\[\(\{&]/,Rge=/[\\\/_+.#"@\[\(\{&]/g,Dge=/[\s-]/,P9=/[\s-]/g;function yS(e,t,n,r,a,o,i){if(o===t.length)return a===e.length?M9:Tge;var s=`${a},${o}`;if(i[s]!==void 0)return i[s];for(var c=r.charAt(o),l=n.indexOf(c,a),u=0,d,p,f,y;l>=0;)d=yS(e,t,n,r,l+1,o+1,i),d>u&&(l===a?d*=M9:Ige.test(e.charAt(l-1))?(d*=Pge,f=e.slice(a,l-1).match(Rge),f&&a>0&&(d*=Math.pow(mS,f.length))):Dge.test(e.charAt(l-1))?(d*=Mge,y=e.slice(a,l-1).match(P9),y&&a>0&&(d*=Math.pow(mS,y.length))):(d*=kge,a>0&&(d*=Math.pow(mS,l-a))),e.charAt(l)!==t.charAt(o)&&(d*=Age)),(d<hS&&n.charAt(l-1)===r.charAt(o+1)||r.charAt(o+1)===r.charAt(o)&&n.charAt(l-1)!==r.charAt(o))&&(p=yS(e,t,n,r,l+1,o+2,i),p*hS>d&&(d=p*hS)),d>u&&(u=d),l=n.indexOf(c,l+1);return i[s]=u,u}function k9(e){return e.toLowerCase().replace(P9," ")}function Lge(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,yS(e,t,k9(e),k9(t),0,0,{})}var Nd='[cmdk-group=""]',gS='[cmdk-group-items=""]',$ge='[cmdk-group-heading=""]',vS='[cmdk-item=""]',A9=`${vS}:not([aria-disabled="true"])`,bS="cmdk-item-select",ns="data-value",Fge=(e,t,n)=>Lge(e,t,n),T9=g.createContext(void 0),Md=()=>g.useContext(T9),I9=g.createContext(void 0),wS=()=>g.useContext(I9),R9=g.createContext(void 0),D9=g.forwardRef((e,t)=>{let n=Bc(()=>{var $,V;return{search:"",value:(V=($=e.value)!=null?$:e.defaultValue)!=null?V:"",filtered:{count:0,items:new Map,groups:new Set}}}),r=Bc(()=>new Set),a=Bc(()=>new Map),o=Bc(()=>new Map),i=Bc(()=>new Set),s=L9(e),{label:c,children:l,value:u,onValueChange:d,filter:p,shouldFilter:f,loop:y,disablePointerSelection:m=!1,vimBindings:v=!0,...b}=e,w=Pt(),_=Pt(),x=Pt(),j=g.useRef(null),S=Qge();rs(()=>{if(u!==void 0){let $=u.trim();n.current.value=$,E.emit()}},[u]),rs(()=>{S(6,k)},[]);let E=g.useMemo(()=>({subscribe:$=>(i.current.add($),()=>i.current.delete($)),snapshot:()=>n.current,setState:($,V,Q)=>{var X,H,J;if(!Object.is(n.current[$],V)){if(n.current[$]=V,$==="search")I(),M(),S(1,P);else if($==="value"&&(Q||S(5,k),((X=s.current)==null?void 0:X.value)!==void 0)){let K=V??"";(J=(H=s.current).onValueChange)==null||J.call(H,K);return}E.emit()}},emit:()=>{i.current.forEach($=>$())}}),[]),O=g.useMemo(()=>({value:($,V,Q)=>{var X;V!==((X=o.current.get($))==null?void 0:X.value)&&(o.current.set($,{value:V,keywords:Q}),n.current.filtered.items.set($,N(V,Q)),S(2,()=>{M(),E.emit()}))},item:($,V)=>(r.current.add($),V&&(a.current.has(V)?a.current.get(V).add($):a.current.set(V,new Set([$]))),S(3,()=>{I(),M(),n.current.value||P(),E.emit()}),()=>{o.current.delete($),r.current.delete($),n.current.filtered.items.delete($);let Q=C();S(4,()=>{I(),(Q==null?void 0:Q.getAttribute("id"))===$&&P(),E.emit()})}),group:$=>(a.current.has($)||a.current.set($,new Set),()=>{o.current.delete($),a.current.delete($)}),filter:()=>s.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>s.current.disablePointerSelection,listId:w,inputId:x,labelId:_,listInnerRef:j}),[]);function N($,V){var Q,X;let H=(X=(Q=s.current)==null?void 0:Q.filter)!=null?X:Fge;return $?H($,n.current.search,V):0}function M(){if(!n.current.search||s.current.shouldFilter===!1)return;let $=n.current.filtered.items,V=[];n.current.filtered.groups.forEach(X=>{let H=a.current.get(X),J=0;H.forEach(K=>{let q=$.get(K);J=Math.max(q,J)}),V.push([X,J])});let Q=j.current;T().sort((X,H)=>{var J,K;let q=X.getAttribute("id"),G=H.getAttribute("id");return((J=$.get(G))!=null?J:0)-((K=$.get(q))!=null?K:0)}).forEach(X=>{let H=X.closest(gS);H?H.appendChild(X.parentElement===H?X:X.closest(`${gS} > *`)):Q.appendChild(X.parentElement===Q?X:X.closest(`${gS} > *`))}),V.sort((X,H)=>H[1]-X[1]).forEach(X=>{var H;let J=(H=j.current)==null?void 0:H.querySelector(`${Nd}[${ns}="${encodeURIComponent(X[0])}"]`);J==null||J.parentElement.appendChild(J)})}function P(){let $=T().find(Q=>Q.getAttribute("aria-disabled")!=="true"),V=$==null?void 0:$.getAttribute(ns);E.setState("value",V||void 0)}function I(){var $,V,Q,X;if(!n.current.search||s.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let H=0;for(let J of r.current){let K=(V=($=o.current.get(J))==null?void 0:$.value)!=null?V:"",q=(X=(Q=o.current.get(J))==null?void 0:Q.keywords)!=null?X:[],G=N(K,q);n.current.filtered.items.set(J,G),G>0&&H++}for(let[J,K]of a.current)for(let q of K)if(n.current.filtered.items.get(q)>0){n.current.filtered.groups.add(J);break}n.current.filtered.count=H}function k(){var $,V,Q;let X=C();X&&((($=X.parentElement)==null?void 0:$.firstChild)===X&&((Q=(V=X.closest(Nd))==null?void 0:V.querySelector($ge))==null||Q.scrollIntoView({block:"nearest"})),X.scrollIntoView({block:"nearest"}))}function C(){var $;return($=j.current)==null?void 0:$.querySelector(`${vS}[aria-selected="true"]`)}function T(){var $;return Array.from((($=j.current)==null?void 0:$.querySelectorAll(A9))||[])}function A($){let V=T()[$];V&&E.setState("value",V.getAttribute(ns))}function R($){var V;let Q=C(),X=T(),H=X.findIndex(K=>K===Q),J=X[H+$];(V=s.current)!=null&&V.loop&&(J=H+$<0?X[X.length-1]:H+$===X.length?X[0]:X[H+$]),J&&E.setState("value",J.getAttribute(ns))}function L($){let V=C(),Q=V==null?void 0:V.closest(Nd),X;for(;Q&&!X;)Q=$>0?Zge(Q,Nd):Xge(Q,Nd),X=Q==null?void 0:Q.querySelector(A9);X?E.setState("value",X.getAttribute(ns)):R($)}let D=()=>A(T().length-1),B=$=>{$.preventDefault(),$.metaKey?D():$.altKey?L(1):R(1)},F=$=>{$.preventDefault(),$.metaKey?A(0):$.altKey?L(-1):R(-1)};return g.createElement(Ae.div,{ref:t,tabIndex:-1,...b,"cmdk-root":"",onKeyDown:$=>{var V;if((V=b.onKeyDown)==null||V.call(b,$),!$.defaultPrevented)switch($.key){case"n":case"j":{v&&$.ctrlKey&&B($);break}case"ArrowDown":{B($);break}case"p":case"k":{v&&$.ctrlKey&&F($);break}case"ArrowUp":{F($);break}case"Home":{$.preventDefault(),A(0);break}case"End":{$.preventDefault(),D();break}case"Enter":if(!$.nativeEvent.isComposing&&$.keyCode!==229){$.preventDefault();let Q=C();if(Q){let X=new Event(bS);Q.dispatchEvent(X)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:Jge},c),Vm(e,$=>g.createElement(I9.Provider,{value:E},g.createElement(T9.Provider,{value:O},$))))}),Bge=g.forwardRef((e,t)=>{var n,r;let a=Pt(),o=g.useRef(null),i=g.useContext(R9),s=Md(),c=L9(e),l=(r=(n=c.current)==null?void 0:n.forceMount)!=null?r:i==null?void 0:i.forceMount;rs(()=>{if(!l)return s.item(a,i==null?void 0:i.id)},[l]);let u=$9(a,o,[e.value,e.children,o],e.keywords),d=wS(),p=as(S=>S.value&&S.value===u.current),f=as(S=>l||s.filter()===!1?!0:S.search?S.filtered.items.get(a)>0:!0);g.useEffect(()=>{let S=o.current;if(!(!S||e.disabled))return S.addEventListener(bS,y),()=>S.removeEventListener(bS,y)},[f,e.onSelect,e.disabled]);function y(){var S,E;m(),(E=(S=c.current).onSelect)==null||E.call(S,u.current)}function m(){d.setState("value",u.current,!0)}if(!f)return null;let{disabled:v,value:b,onSelect:w,forceMount:_,keywords:x,...j}=e;return g.createElement(Ae.div,{ref:Pd([o,t]),...j,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!p,"data-disabled":!!v,"data-selected":!!p,onPointerMove:v||s.getDisablePointerSelection()?void 0:m,onClick:v?void 0:y},e.children)}),zge=g.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:a,...o}=e,i=Pt(),s=g.useRef(null),c=g.useRef(null),l=Pt(),u=Md(),d=as(f=>a||u.filter()===!1?!0:f.search?f.filtered.groups.has(i):!0);rs(()=>u.group(i),[]),$9(i,s,[e.value,e.heading,c]);let p=g.useMemo(()=>({id:i,forceMount:a}),[a]);return g.createElement(Ae.div,{ref:Pd([s,t]),...o,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&g.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:l},n),Vm(e,f=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?l:void 0},g.createElement(R9.Provider,{value:p},f))))}),Vge=g.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,a=g.useRef(null),o=as(i=>!i.search);return!n&&!o?null:g.createElement(Ae.div,{ref:Pd([a,t]),...r,"cmdk-separator":"",role:"separator"})}),Wge=g.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,a=e.value!=null,o=wS(),i=as(u=>u.search),s=as(u=>u.value),c=Md(),l=g.useMemo(()=>{var u;let d=(u=c.listInnerRef.current)==null?void 0:u.querySelector(`${vS}[${ns}="${encodeURIComponent(s)}"]`);return d==null?void 0:d.getAttribute("id")},[]);return g.useEffect(()=>{e.value!=null&&o.setState("search",e.value)},[e.value]),g.createElement(Ae.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:a?e.value:i,onChange:u=>{a||o.setState("search",u.target.value),n==null||n(u.target.value)}})}),Uge=g.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...a}=e,o=g.useRef(null),i=g.useRef(null),s=Md();return g.useEffect(()=>{if(i.current&&o.current){let c=i.current,l=o.current,u,d=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let p=c.offsetHeight;l.style.setProperty("--cmdk-list-height",p.toFixed(1)+"px")})});return d.observe(c),()=>{cancelAnimationFrame(u),d.unobserve(c)}}},[]),g.createElement(Ae.div,{ref:Pd([o,t]),...a,"cmdk-list":"",role:"listbox","aria-label":r,id:s.listId},Vm(e,c=>g.createElement("div",{ref:Pd([i,s.listInnerRef]),"cmdk-list-sizer":""},c)))}),qge=g.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:a,contentClassName:o,container:i,...s}=e;return g.createElement(Dl,{open:n,onOpenChange:r},g.createElement(Ll,{container:i},g.createElement(Mi,{"cmdk-overlay":"",className:a}),g.createElement(Pi,{"aria-label":e.label,"cmdk-dialog":"",className:o},g.createElement(D9,{ref:t,...s}))))}),Hge=g.forwardRef((e,t)=>as(n=>n.filtered.count===0)?g.createElement(Ae.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Kge=g.forwardRef((e,t)=>{let{progress:n,children:r,label:a="Loading...",...o}=e;return g.createElement(Ae.div,{ref:t,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Vm(e,i=>g.createElement("div",{"aria-hidden":!0},i)))}),Xn=Object.assign(D9,{List:Uge,Item:Bge,Input:Wge,Group:zge,Separator:Vge,Dialog:qge,Empty:Hge,Loading:Kge});function Zge(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function Xge(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function L9(e){let t=g.useRef(e);return rs(()=>{t.current=e}),t}var rs=typeof window>"u"?g.useEffect:g.useLayoutEffect;function Bc(e){let t=g.useRef();return t.current===void 0&&(t.current=e()),t}function Pd(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function as(e){let t=wS(),n=()=>e(t.snapshot());return Bp.useSyncExternalStore(t.subscribe,n,n)}function $9(e,t,n,r=[]){let a=g.useRef(),o=Md();return rs(()=>{var i;let s=(()=>{var l;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():a.current}})(),c=r.map(l=>l.trim());o.value(e,s,c),(i=t.current)==null||i.setAttribute(ns,s),a.current=s}),a}var Qge=()=>{let[e,t]=g.useState(),n=Bc(()=>new Map);return rs(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,a)=>{n.current.set(r,a),t({})}};function Gge(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function Vm({asChild:e,children:t},n){return e&&g.isValidElement(t)?g.cloneElement(Gge(t),{ref:t.ref},n(t.props.children)):n(t)}var Jge={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const F9=g.forwardRef(({className:e,...t},n)=>h.jsx(Xn,{ref:n,className:Z("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));F9.displayName=Xn.displayName;const B9=g.forwardRef(({className:e,...t},n)=>h.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[h.jsx(de,{name:"search",className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),h.jsx(Xn.Input,{ref:n,className:Z("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));B9.displayName=Xn.Input.displayName;const z9=g.forwardRef(({className:e,...t},n)=>h.jsx(Xn.List,{ref:n,className:Z("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));z9.displayName=Xn.List.displayName;const V9=g.forwardRef((e,t)=>h.jsx(Xn.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));V9.displayName=Xn.Empty.displayName;const W9=g.forwardRef(({className:e,...t},n)=>h.jsx(Xn.Group,{ref:n,className:Z("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));W9.displayName=Xn.Group.displayName;const Yge=g.forwardRef(({className:e,...t},n)=>h.jsx(Xn.Separator,{ref:n,className:Z("-mx-1 h-px bg-border",e),...t}));Yge.displayName=Xn.Separator.displayName;const xS=g.forwardRef(({className:e,...t},n)=>h.jsx(Xn.Item,{ref:n,className:Z("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...t}));xS.displayName=Xn.Item.displayName;const eve=qa("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Ra=g.forwardRef(({className:e,variant:t,...n},r)=>h.jsx("div",{ref:r,role:"alert",className:Z(eve({variant:t}),e),...n}));Ra.displayName="Alert";const Oo=g.forwardRef(({className:e,...t},n)=>h.jsx("h5",{ref:n,className:Z("mb-1 font-medium leading-none tracking-tight",e),...t}));Oo.displayName="AlertTitle";const zc=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("text-sm [&_p]:leading-relaxed",e),...t}));zc.displayName="AlertDescription";const tve=Ha(({onConfirm:e,onCancel:t})=>{const n=Xt(),{t:r}=Pe("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{e(a),o("")},c=()=>{t(),n.hide(),o("")};return h.jsx(Yo,{open:n.visible,onOpenChange:c,children:h.jsxs(no,{className:"w-[330px]",children:[h.jsxs(ro,{children:[h.jsx(ao,{children:r("create_session_passkey.title")}),h.jsx(pu,{children:r("create_session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(u_,{onChange:i,maxLength:6,children:[h.jsxs(ad,{children:[h.jsx(ur,{index:0,hidden:!0}),h.jsx(ur,{index:1,hidden:!0}),h.jsx(ur,{index:2,hidden:!0})]}),h.jsx(d_,{}),h.jsxs(ad,{children:[h.jsx(ur,{index:3,hidden:!0}),h.jsx(ur,{index:4,hidden:!0}),h.jsx(ur,{index:5,hidden:!0})]})]})}),h.jsx(du,{children:h.jsx(ut,{onClick:s,type:"submit",children:r("create_session_passkey.confirm")})})]})})}),nve=()=>{const[e,t]=g.useState(!1),n=Ye(o=>o.currentSession),r=Ye(o=>o.setCurrentSession),a=g.useCallback(async o=>{if(!(!n||!o))try{t(!0);const i=await yue(),s=await J4(i,o);await ue("Session").update(n.id,{passphrase:s});const c=await ue("Session").findOne({where:{id:n.id}});return c&&r(c),{passphrase:i,encrypted:s}}finally{t(!1)}},[n,r]);return{loading:e,updateSessionPassphrase:a}},rve=[ln.WebLLM,ln.OpenAI],ave=["gpt-4o","gpt-4o-mini","gpt-4-turbo","gpt-4","gpt-3.5-turbo"];function ove(e){var Q,X;const{id:t,setDialog:n}=e,{t:r}=Pe("components"),{toast:a}=Qt(),o=Tn(t),[i,s]=g.useState(!1),[c,l]=g.useState(""),[u,d]=g.useState(!1),[p,f]=g.useState(""),[y,m]=g.useState(),[v,b]=g.useState(ln.WebLLM),[w,_]=g.useState(!1),[x,j]=g.useState(),{updateSessionPassphrase:S}=nve(),E=Ye(H=>H.currentSession),O=Ua(H=>H.syncCachedLLMURLs),N=Ua(H=>H.cachedLLMURLs),{loading:M,createLLM:P}=$F(),{modalRef:I}=mc(tve),{modalRef:k}=mc(od);g.useEffect(()=>{At(()=>import("./index-C4ZCpUfV.js").then(async H=>(await H.__tla,H)),__vite__mapDeps([5,1,2,3,4])).then(async({functionCallingModelIds:H,prebuiltAppConfig:J})=>{const K=J.model_list;j({modelList:K,functionCallingModelIds:H})})},[]),g.useEffect(()=>{O()},[O]);const C=g.useMemo(()=>c?v!==ln.WebLLM:!1,[c,v]),T=g.useMemo(()=>!(x!=null&&x.functionCallingModelIds)||!(x!=null&&x.modelList)?[]:((p?x==null?void 0:x.modelList.filter(H=>H.model_id.toLowerCase().includes(p.toLowerCase())):x==null?void 0:x.modelList)||[]).sort((H,J)=>{const K=N.some(re=>re.includes(H.model_id)),q=N.some(re=>re.includes(J.model_id));if(K&&!q)return-1;if(!K&&q)return 1;const G=yj.includes(H.model_id),ne=yj.includes(J.model_id);if(G&&!ne)return-1;if(!G&&ne)return 1;const z=x==null?void 0:x.functionCallingModelIds.includes(H.model_id),se=x==null?void 0:x.functionCallingModelIds.includes(J.model_id);return z&&!se?-1:!z&&se?1:H.vram_required_MB&&J.vram_required_MB&&H.vram_required_MB!==J.vram_required_MB?H.vram_required_MB-J.vram_required_MB:H.model_id.localeCompare(J.model_id)}),[x==null?void 0:x.modelList,x==null?void 0:x.functionCallingModelIds,p,N]),A=g.useMemo(()=>{if(c)switch(v){case ln.WebLLM:return(x==null?void 0:x.modelList)&&T.find(H=>H.model_id===c);case ln.OpenAI:return m({}),{model:c,model_id:c,model_type:2,overrides:{}}}},[c,x==null?void 0:x.modelList,T,v]);g.useEffect(()=>{!(A!=null&&A.model_id)||!N||_(N.some(H=>H.includes(A.model_id)))},[N,A==null?void 0:A.model_id]);const R=g.useCallback(H=>{l(H),d(!1)},[]),L=g.useCallback(H=>{f(H)},[]),D=g.useCallback(H=>{b(H)},[]),B=async()=>{var H;if(!(!o||!E))try{s(!0);let J="",K;if(C&&!E.passphrase){await new Promise((G,ne)=>{I.current.show({onConfirm:z=>{J=z,I.current.hide(),G(void 0)},onCancel:()=>{ne()}})});const q=await S(J);if(!q||!Object.keys(y||{}).length)throw new Error("Failed to update session passphrase");await Ip.set("passphrase",q.passphrase),K=await Y4(y||{},q.passphrase)}else if(C&&E.passphrase){const q=await qh(E.passphrase,k.current);K=await Y4(y||{},q)}await P(o,{name:c,model_type:F(A==null?void 0:A.model_type),function_calling:A!=null&&A.model_id?(H=x==null?void 0:x.functionCallingModelIds)==null?void 0:H.includes(A==null?void 0:A.model_id):!1,parameters:K,provider:v}),n==null||n(!1)}catch(J){Pl(J),a({variant:"destructive",description:r("add_llm_card.errors.failed_to_create")})}finally{s(!1),l("")}},F=g.useCallback(H=>H===1?Hl.embedding:H===2?Hl.VLM:Hl.LLM,[]),$=g.useMemo(()=>{switch(v){case ln.WebLLM:return T.map(H=>{var J;return h.jsxs(xS,{value:H.model_id,onSelect:R,children:[c===H.model_id?h.jsx(de,{name:"check",className:"mr-2 h-4 w-4"}):h.jsx("div",{className:"mr-2 h-4 w-4"}),h.jsxs("span",{className:"max-w-md",children:[h.jsxs("div",{className:"flex gap-2 mb-2",children:[h.jsx(Aa,{name:H.model_id}),H.model_id]}),h.jsx("div",{className:"flex max-w-full flex-wrap gap-1",children:h.jsx(Sd,{model:H,isFunctionCalling:((J=x==null?void 0:x.functionCallingModelIds)==null?void 0:J.includes(H.model_id))||!1,name:H.model_id,isCached:N.some(K=>K.includes(H.model_id))||!1})})]})]},H.model_id)});case ln.OpenAI:return ave.map(H=>h.jsxs(xS,{value:H,onSelect:R,children:[c===H?h.jsx(de,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Aa,{name:H}),H]})})]},H))}},[N,R,c,x==null?void 0:x.functionCallingModelIds,T,v]),V=g.useMemo(()=>{if(C)switch(v){case ln.OpenAI:return h.jsxs(h.Fragment,{children:[h.jsx(Ra,{variant:"destructive",className:"mt-4",children:r("add_llm_card.alert.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(nt,{children:r("add_llm_card.encrypted_fields.api_key")}),h.jsx(En,{type:"password",value:(y==null?void 0:y.key)||"",onChange:H=>m(J=>({...J,key:H.target.value}))})]})]})}},[C,v,r,y]);return h.jsxs(Zt,{className:"max-w-lg",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:r("add_llm_card.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(nt,{children:r("add_llm_card.provider")}),h.jsxs(_o,{value:v,onValueChange:D,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(jo,{placeholder:r("add_llm_card.provider_select_placeholder")})}),h.jsx(Ia,{children:Object.values(rve).map(H=>h.jsx(Zn,{value:H,children:r(`add_llm_card.providers.${H.toLowerCase()}`)},H))})]}),h.jsx(nt,{children:r("add_llm_card.model_name")}),h.jsxs(lM,{open:u,onOpenChange:d,children:[h.jsx(pS,{asChild:!0,children:h.jsxs(ut,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between",children:[c?A==null?void 0:A.model_id:r("add_llm_card.select_model_placeholder"),h.jsx(de,{name:"chevrons-up-down",className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),h.jsx(vv,{className:"w-full p-0",children:h.jsxs(F9,{children:[h.jsx(B9,{onValueChange:L,placeholder:r("add_llm_card.search_placeholder")}),h.jsxs(z9,{children:[h.jsx(V9,{children:r("add_llm_card.no_model")}),h.jsx(W9,{children:$})]})]})})]})]}),A?h.jsxs("div",{className:"mt-4",children:[h.jsxs("div",{className:"mt-4 text-sm text-muted-foreground center flex max-w-full flex-wrap gap-1",children:[h.jsx(Aa,{name:A.model_id,className:"mr-2"}),h.jsx(Sd,{model:A,isFunctionCalling:((Q=x==null?void 0:x.functionCallingModelIds)==null?void 0:Q.includes(A.model_id))||!1,name:A.model_id,isCached:N.some(H=>H.includes(A.model_id))||!1})]}),h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_url")}),A.model]}),A.model_lib?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_lib_url")}),A.model_lib]}):void 0,A.overrides&&((X=Object.keys(A.overrides))!=null&&X.length)?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.metadata")}),JSON.stringify(A.overrides)]}):void 0]}):null,V]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:M||i,disabled:!(c!=null&&c.length),onClick:B,className:"w-full",children:r(w?"add_llm_card.button_add":"add_llm_card.button_download_and_add")})})]})}const U9=()=>{const e=Ye(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=De(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i)=>{var s,c,l;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const u=((s=o.position)==null?void 0:s.x)||0,d=(((c=o.position)==null?void 0:c.y)||0)+(((l=o.measured)==null?void 0:l.height)||0),p=await ue("Prompt").save({content:i.content,prefix:i.prefix,role:i.role||nr.System,status:Ir.Started,session_id:e,type:i.type||rr.Chat});if(!p)throw new Error("Failed to save prompt");if(!await r({source_id:p.id,source_type:"Prompt",node_type:oe.Prompt,x:u,y:d+20}))throw new Error("Failed to save prompt node")}finally{n(!1)}},[e,r]);return{loading:t,createPrompt:a}},ive={[rr.Chat]:{label:"add_prompt_card.prompt_types.chat",value:rr.Chat},[rr.FewShotExample]:{label:"add_prompt_card.prompt_types.few_shot_example",value:rr.FewShotExample}},sve={[nr.System]:{label:"add_prompt_card.prompt_roles.system",value:nr.System},[nr.Human]:{label:"add_prompt_card.prompt_roles.human",value:nr.Human},[nr.AI]:{label:"add_prompt_card.prompt_roles.ai",value:nr.AI}},_S=g.memo(({defaultPromptContent:e,defaultPromptRole:t,defaultPromptType:n,hidePromptRole:r,hidePromptType:a,loading:o,onSubmit:i})=>{const[s,c]=g.useState(e||""),[l,u]=g.useState(n||rr.Chat),[d,p]=g.useState(t),[f,y]=g.useState(""),{t:m}=Pe("components"),v=g.useCallback(j=>{c(j.target.value)},[]),b=g.useCallback(j=>{y(j.target.value)},[]),w=g.useCallback(j=>{j===rr.FewShotExample&&c(`Question: {input}
Answer: {output}`),u(j)},[]),_=g.useCallback(j=>{p(j)},[]),x=async()=>{await i({content:s,role:d,prefix:f,type:l})&&(c(""),p(void 0),u("chat"),y(""))};return h.jsxs("div",{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[a?void 0:h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_type")}),h.jsxs(_o,{value:l,onValueChange:w,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(jo,{placeholder:m("add_prompt_card.type_select_placeholder")})}),h.jsx(Ia,{children:Object.values(ive).map(j=>h.jsx(Zn,{value:j.value,children:m(j.label)},j.value))})]})]}),r?void 0:h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_role")}),h.jsxs(_o,{value:d,onValueChange:_,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(jo,{placeholder:m("add_prompt_card.role_select_placeholder")})}),h.jsx(Ia,{children:Object.values(sve).map(j=>h.jsx(Zn,{value:j.value,children:m(j.label)},j.value))})]})]}),l===rr.FewShotExample&&h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_prefix")}),h.jsx(uo,{value:f,onChange:b,disabled:!1,className:"h-20",placeholder:m("add_prompt_card.placeholder"),id:"message"}),h.jsx(nt,{children:m("add_prompt_card.prompt_content")}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm justify-end items-center",children:[h.jsx(de,{name:"info",className:"mr-2",size:14}),m("add_prompt_card.few_shot_example_note")]})]}),h.jsx(uo,{value:s,onChange:v,disabled:!1,placeholder:m("add_prompt_card.placeholder"),id:"message"})]}),h.jsx("div",{children:h.jsx(Vn,{loading:o,disabled:!(s!=null&&s.length),onClick:x,className:"w-full mt-4",children:m("add_prompt_card.button")})})]})}),cve=g.memo(e=>{const{id:t,thread:n,setDialog:r}=e,{t:a}=Pe("components"),{toast:o}=Qt(),i=Tn(t),{createPrompt:s,loading:c}=U9(),l=async u=>{if(i)try{if(!(u!=null&&u.content))throw new Error("Prompt data is missing");await s(i,{...u,content:u.content,thread:n}),r==null||r(!1)}catch(d){o({variant:"destructive",title:`${d}`})}};return h.jsxs(Zt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:a("add_prompt_card.title")})}),h.jsx($n,{children:h.jsx(_S,{onSubmit:l,loading:c,defaultPromptRole:"system",defaultPromptType:"chat"})})]})}),lve=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=g.useCallback((i,s,c,l)=>{var u;if(e){for(const d of s)(u=d.data)!=null&&u.length?a(i,d.data,c,d.id):c.push({name:d.name,type:d.type,enum:d.enum?JSON.stringify(d.enum):"",required:d.required,description:d.description,id:d.id||yu(),parent_id:l,schema_id:i,session_id:e});return c}},[e]),o=g.useCallback(async(i,s)=>{var c,l,u;try{if(!i||!e)throw new Error("Source or Session not found");n(!0);const d=((c=i.position)==null?void 0:c.x)||0,p=(((l=i.position)==null?void 0:l.y)||0)+(((u=i.measured)==null?void 0:u.height)||0),f=await ue("Schema").save({name:"Untitled Schema",session_id:e});if(!f)throw new Error("Failed to save schema");const y=a(f.id,s,[],void 0);if(!(y!=null&&y.length))throw new Error("Failed to convert schema items");if(await ue("SchemaItem").save(y),!await r({source_id:f.id,source_type:"Schema",node_type:oe.Schema,x:d,y:p+20}))throw new Error("Failed to save schema node")}finally{n(!1)}},[e,a,r]);return{loading:t,createSchema:o}};var jS="Checkbox",[uve,m2e]=er(jS),[dve,pve]=uve(jS),q9=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:o,required:i,disabled:s,value:c="on",onCheckedChange:l,form:u,...d}=e,[p,f]=g.useState(null),y=wt(t,x=>f(x)),m=g.useRef(!1),v=p?u||!!p.closest("form"):!0,[b=!1,w]=Sn({prop:a,defaultProp:o,onChange:l}),_=g.useRef(b);return g.useEffect(()=>{const x=p==null?void 0:p.form;if(x){const j=()=>w(_.current);return x.addEventListener("reset",j),()=>x.removeEventListener("reset",j)}},[p,w]),h.jsxs(dve,{scope:n,state:b,disabled:s,children:[h.jsx(Ae.button,{type:"button",role:"checkbox","aria-checked":mi(b)?"mixed":b,"aria-required":i,"data-state":Z9(b),"data-disabled":s?"":void 0,disabled:s,value:c,...d,ref:y,onKeyDown:ge(e.onKeyDown,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:ge(e.onClick,x=>{w(j=>mi(j)?!0:!j),v&&(m.current=x.isPropagationStopped(),m.current||x.stopPropagation())})}),v&&h.jsx(fve,{control:p,bubbles:!m.current,name:r,value:c,checked:b,required:i,disabled:s,form:u,style:{transform:"translateX(-100%)"},defaultChecked:mi(o)?!1:o})]})});q9.displayName=jS;var H9="CheckboxIndicator",K9=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,o=pve(H9,n);return h.jsx(Mr,{present:r||mi(o.state)||o.state===!0,children:h.jsx(Ae.span,{"data-state":Z9(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});K9.displayName=H9;var fve=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:a,...o}=e,i=g.useRef(null),s=M8(n),c=zp(t);g.useEffect(()=>{const u=i.current,d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(s!==n&&p){const f=new Event("click",{bubbles:r});u.indeterminate=mi(n),p.call(u,mi(n)?!1:n),u.dispatchEvent(f)}},[s,n,r]);const l=g.useRef(mi(n)?!1:n);return h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??l.current,...o,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function mi(e){return e==="indeterminate"}function Z9(e){return mi(e)?"indeterminate":e?"checked":"unchecked"}Bg=q9,KN=K9;const X9=g.forwardRef(({className:e,...t},n)=>h.jsx(Bg,{ref:n,className:Z("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:h.jsx(KN,{className:Z("flex items-center justify-center text-current"),children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}));X9.displayName=Bg.displayName;const Q9=g.memo(({setData:e,data:t,id:n})=>{const{t:r}=Pe("components"),[a,o]=g.useState({name:"",description:"",type:"string",required:!1,data:[]}),i=g.useMemo(()=>n&&t.find(m=>m.id===n)||a,[t,a,n]),s=g.useCallback(m=>{m.target.value&&!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(m.target.value)||(n?e(v=>[...v.map(b=>b.id===n?{...b,name:m.target.value||""}:b)]):o(v=>({...v,name:m.target.value||""})))},[n,e]),c=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,description:m.target.value||""}:b)]):o(v=>({...v,description:m.target.value||""}))},[n,e]),l=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,type:m||""}:b)]):o(v=>({...v,type:m||"string"}))},[n,e]),u=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,required:!!m||!1}:b)]):o(v=>({...v,required:!!m||!1}))},[n,e]),d=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,enum:m.target.value||""}:b)]):o(v=>({...v,enum:m.target.value||""}))},[n,e]),p=g.useCallback(()=>{if(t.find(m=>m.name===a.name))return Tl({variant:"destructive",content:"Name already exists"});a.id=yu(),e(m=>[...m,{...a}]),o({name:"",description:"",type:"string",required:!1,id:yu(),parent:n||void 0,data:[]})},[t,a,e,n]),f=g.useCallback(m=>{e(v=>[...v.map(b=>b.id===n?{...b,data:m(b.data||[])}:b)])},[n,e]),y=["object","array"].includes(i.type);return h.jsxs("div",{className:"w-full p-1",children:[h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.name")}),h.jsx(En,{id:"name",onChange:s,placeholder:r("add_schema_card.field.name_placeholder"),value:(i==null?void 0:i.name)||""})]}),h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.description")}),h.jsx(En,{id:"description",placeholder:r("add_schema_card.field.description_placeholder"),onChange:c,value:(i==null?void 0:i.description)||""})]}),h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.type")}),h.jsxs(_o,{onValueChange:l,value:(i==null?void 0:i.type)||"",children:[h.jsx(Ta,{children:h.jsx(jo,{placeholder:r("add_schema_card.field.type_placeholder")})}),h.jsxs(Ia,{children:[h.jsx(Zn,{value:"string",children:r("add_schema_card.types.string")}),h.jsx(Zn,{value:"boolean",children:r("add_schema_card.types.boolean")}),h.jsx(Zn,{value:"number",children:r("add_schema_card.types.number")}),h.jsx(Zn,{value:"object",children:r("add_schema_card.types.object")}),h.jsx(Zn,{value:"array",children:r("add_schema_card.types.array")})]})]})]}),h.jsxs("div",{className:"flex items-center h-10",children:[h.jsx(nt,{children:r("add_schema_card.field.required")}),h.jsx(X9,{className:"ml-2","aria-label":"Select row",onCheckedChange:u,checked:i==null?void 0:i.required})]}),y?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(nt,{children:r("add_schema_card.children")}),h.jsx(G9,{data:(i==null?void 0:i.data)||[],setData:f})]}):null,(i==null?void 0:i.type)==="enum"?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(nt,{children:r("add_schema_card.field.enum")}),h.jsx(En,{id:"enum",onChange:d,placeholder:"Enum"})]}):null,n?null:h.jsx("div",{className:"w-full flex justify-end mt-2",children:h.jsx(ut,{variant:"secondary",disabled:!i.name||!i.description||!i.type,onClick:p,className:"w-full",children:r("add_schema_card.field.add_field")})})]})}),G9=g.memo(({data:e,setData:t})=>h.jsxs(E$,{type:"single",collapsible:!0,children:[e.map(n=>h.jsxs(Pj,{value:`${n.id}`,children:[h.jsx(kj,{children:n.name}),h.jsx(Aj,{children:h.jsx(Q9,{setData:t,data:e,id:n.id})})]},n.id||"new")),h.jsx(Zt,{className:"p-2 mt-4",children:h.jsx(Q9,{setData:t,data:e})})]})),hve=g.memo(e=>{const{t}=Pe("components"),{id:n}=e,r=Tn(n),[a,o]=g.useState([]),{createSchema:i,loading:s}=lve(),c=async()=>{if(r&&(a!=null&&a.length))try{await i(r,a),o([])}catch(l){Tl({variant:"destructive",title:`${l}`})}};return h.jsxs(Zt,{className:"max-w-lg",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("add_schema_card.title")})}),h.jsx($n,{className:"min-w-96",children:h.jsx(G9,{setData:o,data:a})}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:s,disabled:!(a!=null&&a.length),onClick:c,className:"w-full",children:t("add_schema_card.create")})})]})}),J9=()=>{const e=Ye(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=De(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i,s)=>{var c,l,u;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const d=((c=o.position)==null?void 0:c.x)||0,p=(((l=o.position)==null?void 0:l.y)||0)+(((u=o.measured)==null?void 0:u.height)||0),f=HAe(i,s),y=await ue("CSVData").save({headers:f.headers,csv:f.data,session_id:e});if(!y)throw new Error("Failed to save");if(!await r({source_id:y.id,source_type:"CSVData",node_type:oe.CSVData,x:d,y:p+20}))throw new Error("Failed to save node")}finally{n(!1)}},[e,r]);return{loading:t,createCSVData:a}};function mve({data:e}){const{t}=Pe("components");return h.jsxs(Nm,{className:"w-full",children:[h.jsx(Mm,{children:h.jsxs(ts,{children:[h.jsx(Tc,{children:t("add_few_shot_example_card.input")}),h.jsx(Tc,{children:t("add_few_shot_example_card.output")})]})}),h.jsx(Pm,{children:e==null?void 0:e.map((n,r)=>h.jsxs(ts,{children:[h.jsx(Ic,{className:"p-4",children:n.input}),h.jsx(Ic,{className:"p-4",children:n.output})]},`${n.input}_${n.output}_${r}`))})]})}const yve=g.memo(e=>{const{id:t}=e,{t:n}=Pe("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),[s,c]=g.useState(""),l=Tn(t),{createCSVData:u,loading:d}=J9(),p=()=>{a(y=>[...y,{input:o,output:s}]),i(""),c("")},f=async()=>{l&&await u(l,["input","output"],r.map(y=>[y.input,y.output]))};return h.jsxs(Zt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:n("add_few_shot_example_card.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{htmlFor:"name",children:n("add_few_shot_example_card.input")}),h.jsx(En,{value:o,onChange:y=>i(y.target.value||""),id:"name",placeholder:n("add_few_shot_example_card.input_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("add_few_shot_example_card.output")}),h.jsx(uo,{value:s,onChange:y=>c(y.target.value||""),placeholder:n("add_few_shot_example_card.output_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(ut,{disabled:!o||!s,onClick:p,className:"w-40",children:n("add_few_shot_example_card.add")})}),h.jsx(mve,{data:r||[]})]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:d,disabled:!(r!=null&&r.length),onClick:f,className:"w-full",children:n("add_few_shot_example_card.create")})})]})}),gve=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!i||!e)throw new Error("Source or Session not found");if(!s.name||!s.description)throw new Error("Name is required");n(!0);const p=((l=i.position)==null?void 0:l.x)||0,f=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),y=await ue("ToolDefinition").save({...s,name:`${s.name}`,description:`${s.description}`,session_id:e});if(!y)throw new Error("Failed create tool.");const m=await r({source_id:y.id,source_type:"ToolDefinition",node_type:oe.ToolDefinition,x:p,y:f+20});if(!m)throw new Error("Failed to save node");c!=null&&c.schemaNode&&await a({source:c.schemaNode.id,target:m.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createTool:o}},vve=g.memo(e=>{const{t}=Pe("components"),{toast:n}=Qt(),{id:r}=e,a=Tn(r),[o,i]=g.useState(""),[s,c]=g.useState(""),{createTool:l,loading:u}=gve(),d=y=>{i(y.target.value)},p=y=>{c(y.target.value)},f=async()=>{if(a&&o&&s)try{await l(a,{name:o,description:s}),i(""),c("")}catch(y){Bo(y),n({variant:"destructive",title:t("add_tool_card.errors.create_tool_failed")})}};return h.jsxs(Zt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("add_tool_card.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{htmlFor:"name",children:t("add_tool_card.tool_name")}),h.jsx(En,{onChange:d,id:"name",placeholder:t("add_tool_card.name_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:t("add_tool_card.tool_description")}),h.jsx(uo,{onChange:p,placeholder:t("add_tool_card.description_placeholder")})]})]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:u,onClick:f,className:"w-full",children:t("add_tool_card.create")})})]})}),bve=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!(s!=null&&s.name)||!i||!e)throw new Error("Source or Session not found");n(!0);const p=((l=i.position)==null?void 0:l.x)||0,f=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),y=await ue("VectorDatabase").save({...s,name:`${s.name}`,type:s.type||KAe.Local,storage:s.storage||kr.DatabaseNode,raw:"",provider:s.provider||vK.Memory,session_id:e,metadata:c?JSON.stringify({textSplitter:c}):void 0});if(!y)throw new Error("Failed to save vectorDatabase");const m=await r({source_id:y.id,source_type:"VectorDatabase",node_type:oe.VectorDatabase,x:p,y:f+30});if(!m)throw new Error("Failed to save vectorDatabase node");if(s.storage===kr.DataNode){const v=await ue("JSONLData").save({headers:ZAe(["content","embedding","metadata"]),jsonl:"",session_id:e});if(!v)throw new Error("Failed to save databaseSource");const b=await r({source_id:v.id,source_type:"JSONLData",node_type:oe.JSONLData,x:p+80,y:f+30});if(!b)throw new Error("Failed to save databaseSource node");await a({source:b.id,target:m.id})}return{vectorDatabase:y,vectorDatabaseNode:m}}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabase:o}},kd=[vK.Memory],Ad=[kr.DatabaseNode],wve=["TokenTextSplitter","CharacterTextSplitter","RecursiveCharacterTextSplitter"],xve=g.memo(e=>{const{t}=Pe("components"),{id:n}=e,r=Tn(n),{toast:a}=Qt(),[o,i]=g.useState(""),[s,c]=g.useState(kd[0]),[l,u]=g.useState(Ad[0]),[d,p]=g.useState({}),{loading:f,createVectorDatabase:y}=bve(),m=g.useCallback(S=>{c(S)},[]),v=g.useCallback(S=>{u(S)},[]),b=g.useCallback(S=>{p(E=>({...E,type:S,chunkSize:500,chunkOverlap:40}))},[]),w=g.useCallback(S=>{i(S.target.value||"")},[]),_=g.useCallback(S=>{p(E=>({...E,chunkSize:Number(S.target.value)}))},[]),x=g.useCallback(S=>{p(E=>({...E,chunkOverlap:Number(S.target.value)}))},[]),j=async()=>{try{if(!r)return;await y(r,{name:o,provider:s,storage:l},d!=null&&d.type?{type:d.type,chunkSize:d.chunkSize||500,chunkOverlap:d.chunkOverlap||0}:void 0),i(""),p({})}catch{a({variant:"destructive",description:t("create_vector_database_card.errors.create_failed")})}};return h.jsxs(Zt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("create_vector_database_card.title")})}),h.jsx($n,{children:h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(nt,{children:t("create_vector_database_card.name")}),h.jsx(En,{className:"mb-4",value:o,onChange:w}),(Ad==null?void 0:Ad.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:t("create_vector_database_card.storage_type")}),h.jsxs(_o,{value:l,onValueChange:v,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(jo,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(Ia,{children:Object.values(Ad).map(S=>h.jsx(Zn,{value:S,children:t(`create_vector_database_card.storage_types.${S.toLowerCase()}`)},S))})]})]}):void 0,(kd==null?void 0:kd.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:t("create_vector_database_card.provider")}),h.jsxs(_o,{value:s,onValueChange:m,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(jo,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(Ia,{children:Object.values(kd).map(S=>h.jsx(Zn,{value:S,children:t(`create_vector_database_card.providers.${S.toLowerCase()}`)},S))})]})]}):void 0,h.jsx(nt,{children:t("create_vector_database_card.text_splitter")}),h.jsxs(_o,{value:d.type,onValueChange:b,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(jo,{placeholder:t("create_vector_database_card.text_splitter_select_placeholder")})}),h.jsx(Ia,{children:Object.values(wve).map(S=>h.jsx(Zn,{value:S,children:t(`create_vector_database_card.text_splitters.${S.toLowerCase()}`)},S))})]}),d.type?h.jsxs(Zt,{children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("create_vector_database_card.text_splitter_configuration")})}),h.jsxs($n,{children:[h.jsx(nt,{children:t("create_vector_database_card.text_splitter_chunksize")}),h.jsx(En,{value:d.chunkSize,onChange:_,placeholder:t("create_vector_database_card.text_splitter_chunksize_placeholder")}),h.jsx(nt,{children:t("create_vector_database_card.text_splitter_chunkoverlap")}),h.jsx(En,{value:d.chunkOverlap,onChange:x,placeholder:t("create_vector_database_card.text_splitter_chunkoverlap_placeholder")})]})]}):void 0]})}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{disabled:!d.type||!o,loading:f,onClick:j,className:"w-full",children:t("create_vector_database_card.create")})})]})});function _ve({data:e}){const{t}=Pe("components");return h.jsxs(Nm,{className:"w-full",children:[h.jsx(Mm,{children:h.jsx(ts,{children:h.jsx(Tc,{children:t("add_text_data.text")})})}),h.jsx(Pm,{children:e==null?void 0:e.map((n,r)=>h.jsx(ts,{children:h.jsx(Ic,{className:"p-4",children:n.text})},`${n.text}_${r}`))})]})}const jve=g.memo(e=>{const{id:t}=e,{t:n}=Pe("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),s=Tn(t),{createCSVData:c,loading:l}=J9(),u=()=>{a(p=>[...p,{text:o}]),i("")},d=async()=>{s&&await c(s,["text"],r.map(p=>[p.text]))};return h.jsxs(Zt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:n("add_text_data.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("add_text_data.text")}),h.jsx(uo,{value:o,onChange:p=>i(p.target.value||""),placeholder:n("add_text_data.text_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(ut,{disabled:!o,onClick:u,className:"w-40",children:n("add_text_data.add")})}),h.jsx(_ve,{data:r||[]})]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:l,disabled:!(r!=null&&r.length),onClick:d,className:"w-full",children:n("add_text_data.create")})})]})});var Co=(e=>(e.ADD_LLM="ADD_LLM",e.ADD_PROMPT="ADD_PROMPT",e.ADD_TOOL_DEFINITION="ADD_TOOL_DEFINITION",e.ADD_SCHEMA="ADD_SCHEMA",e.ADD_FEW_SHOT_EXAMPLE="ADD_FEW_SHOT_EXAMPLE",e.ADD_VECTOR_DATABASE="ADD_VECTOR_DATABASE",e.ADD_TEXT_DATA="ADD_TEXT_DATA",e))(Co||{});const Sve=["ADD_LLM","ADD_PROMPT","ADD_SCHEMA","ADD_VECTOR_DATABASE",{key:"more",label:"more",icon:"ellipsis",children:["ADD_TOOL_DEFINITION","ADD_FEW_SHOT_EXAMPLE"]}],Eve=()=>{const e="_coolMode_effect",t=document.getElementById(e);if(t)return t;const n=document.createElement("div");return n.setAttribute("id",e),n.setAttribute("style","overflow:hidden; position:fixed; height:100%; top:0; left:0; right:0; bottom:0; pointer-events:none; z-index:2147483647"),document.body.appendChild(n),n};let Y9=0,eB,tB,nB,rB,aB,oB,Nn,lt,iB,sB,cB,lB,Wm,SS,ES,OS,uB,dB,CS,pB,fB,hB;eB=(e,t)=>{Y9++;const n=(t==null?void 0:t.particle)||"circle",r=[15,20,25,35,45],a=45;let o=[],i=!1,s=0,c=0;const l=Eve();function u(){const E=(t==null?void 0:t.size)||r[Math.floor(Math.random()*r.length)],O=(t==null?void 0:t.speedHorz)||Math.random()*10,N=(t==null?void 0:t.speedUp)||Math.random()*25,M=Math.random()*360,P=Math.random()*35*(Math.random()<=.5?-1:1),I=c-E/2,k=s-E/2,C=Math.random()<=.5?-1:1,T=document.createElement("div");if(n==="circle"){const A="http://www.w3.org/2000/svg",R=document.createElementNS(A,"svg"),L=document.createElementNS(A,"circle");L.setAttributeNS(null,"cx",(E/2).toString()),L.setAttributeNS(null,"cy",(E/2).toString()),L.setAttributeNS(null,"r",(E/2).toString()),L.setAttributeNS(null,"fill",`hsl(${Math.random()*360}, 70%, 50%)`),R.appendChild(L),R.setAttribute("width",E.toString()),R.setAttribute("height",E.toString()),T.appendChild(R)}else T.innerHTML=`<img src="${n}" width="${E}" height="${E}" style="border-radius: 50%">`;T.style.position="absolute",T.style.transform=`translate3d(${k}px, ${I}px, 0px) rotate(${M}deg)`,l.appendChild(T),o.push({direction:C,element:T,left:k,size:E,speedHorz:O,speedUp:N,spinSpeed:P,spinVal:M,top:I})}function d(){o.forEach(E=>{E.left=E.left-E.speedHorz*E.direction,E.top=E.top-E.speedUp,E.speedUp=Math.min(E.size,E.speedUp-1),E.spinVal=E.spinVal+E.spinSpeed,E.top>=Math.max(window.innerHeight,document.body.clientHeight)+E.size&&(o=o.filter(O=>O!==E),E.element.remove()),E.element.setAttribute("style",["position:absolute","will-change:transform",`top:${E.top}px`,`left:${E.left}px`,`transform:rotate(${E.spinVal}deg)`].join(";"))})}let p,f=0;const y=30;function m(){const E=performance.now();i&&o.length<a&&E-f>y&&(u(),f=E),d(),p=requestAnimationFrame(m)}m();const v="ontouchstart"in window,b=v?"touchstart":"mousedown",w=v?"touchend":"mouseup",_=v?"touchmove":"mousemove",x=E=>{var O,N;"touches"in E?(s=(O=E.touches)==null?void 0:O[0].clientX,c=(N=E.touches)==null?void 0:N[0].clientY):(s=E.clientX,c=E.clientY)},j=E=>{x(E),i=!0},S=()=>{i=!1};return e.addEventListener(_,x,{passive:!0}),e.addEventListener(b,j,{passive:!0}),e.addEventListener(w,S,{passive:!0}),e.addEventListener("mouseleave",S,{passive:!0}),()=>{e.removeEventListener(_,x),e.removeEventListener(b,j),e.removeEventListener(w,S),e.removeEventListener("mouseleave",S);const E=setInterval(()=>{p&&o.length===0&&(cancelAnimationFrame(p),clearInterval(E),--Y9===0&&l.remove())},500)}},tB=({children:e,options:t})=>{const n=g.useRef(null);return g.useEffect(()=>{if(n.current)return eB(n.current,t)},[t]),U.cloneElement(e,{ref:n})},nB=g.memo(e=>{const{t}=Pe("flows"),n=Vo(s=>s.theme),[r,a]=g.useState(`${Co.ADD_LLM}`),o=g.useMemo(()=>h.jsxs(RF,{children:[h.jsx(Qj,{children:h.jsx(tB,{children:h.jsx(ut,{variant:"link",className:"!p-0 !pl-3",children:h.jsx(XAe,{width:32,height:32,className:Z(n==="dark"?"fill-white":"fill-black")})})})}),Sve.map(s=>typeof s=="object"?h.jsxs(Qj,{children:[h.jsx(Gj,{children:s.icon?h.jsx(de,{name:s.icon}):t(`supported_nodes.${s.label}`)}),h.jsx(DF,{children:s.children.map(c=>h.jsx(LF,{onClick:()=>a(c),children:t(`supported_nodes.${c.toLowerCase()}`)},c))})]},s.key):h.jsx(Qj,{children:h.jsx(Gj,{value:s,onClick:()=>a(s),children:t(`supported_nodes.${s.toLowerCase()}`)})},s))]}),[t,n]),i=g.useMemo(()=>{switch(r){case Co.ADD_LLM:return h.jsx(ove,{...e});case Co.ADD_PROMPT:return h.jsx(cve,{...e});case Co.ADD_SCHEMA:return h.jsx(hve,{...e});case Co.ADD_FEW_SHOT_EXAMPLE:return h.jsx(yve,{...e});case Co.ADD_TOOL_DEFINITION:return h.jsx(vve,{...e});case Co.ADD_VECTOR_DATABASE:return h.jsx(xve,{...e});case Co.ADD_TEXT_DATA:return h.jsx(jve,{...e})}},[e,r]);return h.jsxs(h.Fragment,{children:[o,h.jsx("div",{className:"mt-4",children:i})]})}),rB=()=>{const[e,t]=g.useState(!1),n=Ii(),r=Ye(s=>s.currentSession),a=Ye(s=>s.getLatestApplications),o=g.useCallback(async(s,c,l,u)=>{var f;const d=(f=c.data)==null?void 0:f.entity;let p=c.type?QAe[c.type]:void 0;if(p&&d&&c&&typeof d=="object"&&"id"in d&&!l.has(`${d.id}`)&&!u.has(`${c.id}`)){p=p;const y=await ue(p).save({...d,...d&&typeof d=="object"&&"session_id"in d?{session_id:s.id}:{}});l.set(`${d.id}`,y.id);const m=await ue("FlowNode").findOne({where:{id:c.data.flowNode.id}}),v=await ue("FlowNode").save({...m||c.data.flowNode,session_id:s.id,id:void 0,source_type:p,source_id:y.id});return u.set(`${c.id}`,v.id),{entityName:p,entity:y,node:v}}else if(!u.has(`${c.id}`)){const y=await ue("FlowNode").findOne({where:{id:c.data.flowNode.id}}),m=await ue("FlowNode").save({...y||c.data.flowNode,node_type:c.type,session_id:s.id,id:void 0});return u.set(`${c.id}`,m.id),{node:m}}},[]),i=g.useCallback(async(s,c)=>{try{if(!r)throw new Error("No current session");t(!0);const l=await ue("Session").save({type:Ml.StandaloneApp,name:c.name||(r!=null&&r.name?`${r.name}`:"Standalone"),status:GAe.Started,passphrase:r.passphrase});if(!l)throw new Error("Failed create standalone session");const u=new Map,d=new Map,p=await o(l,s,u,d);if(!p)throw new Error("Failed to clone main node");await ue("Session").update(l.id,{main_node_id:p.node.id,main_source_id:p!=null&&p.entity?p.entity.id:void 0,main_source_type:p.entityName?p.entityName:void 0});for(const{node:f,connectedNodes:y}of c.connections)if(await o(l,f,u,d),y)for(const m of y)await o(l,m,u,d);for(const{connections:f}of c.connections)for(const y of f){const m=d.get(`${y.source}`),v=d.get(`${y.target}`);if(!m||!v)throw new Error("Failed to get connected flow node id");await ue("FlowEdge").save({source:m,target:v,sourceHandle:y.sourceHandle,targetHandle:y.targetHandle,session_id:l.id})}return a(),n(yn("application",{applicationId:l.id})),!0}finally{t(!1)}},[o,r,a,n]);return{loading:e,createStandaloneSession:i}},aB=()=>{const[e,t]=g.useState(!1),n=De(o=>o.updateNodes),r=De(o=>o.updateEdges),a=g.useCallback(async o=>{try{t(!0),await ue("FlowNode").delete(o);const i=await ue("FlowEdge").find({where:[{source:o},{target:o}]});return await Promise.all(i.map(s=>ue("FlowEdge").delete(s.id))),await n([{id:o,type:"remove"}]),await r(i.map(s=>({id:s.id,type:"remove"}))),!0}catch{return!1}finally{t(!1)}},[r,n]);return{loading:e,deleteNodeFlow:a}},oB=Ha(({cloneStandaloneSession:e})=>{const t=Xt(),{t:n}=Pe("dialogs"),[r,a]=g.useState(""),{toast:o}=Qt(),i=c=>{a(c.target.value)},s=async()=>{try{t.hide(),await e(r),a("")}catch{o({variant:"destructive",description:n("create_standalone_application.errors.create_failed")})}};return h.jsx(Yo,{open:t.visible,onOpenChange:t.hide,children:h.jsxs(no,{className:"sm:max-w-[425px]",children:[h.jsxs(ro,{children:[h.jsx(ao,{children:n("create_session.title")}),h.jsx(pu,{children:n("create_standalone_application.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{className:"mb-2",htmlFor:"name",children:n("create_standalone_application.name")}),h.jsx(En,{onChange:i,id:"name",value:r,placeholder:n("create_standalone_application.name_placeholder")})]})}),h.jsx(du,{children:h.jsx(ut,{onClick:s,disabled:!r,type:"submit",children:n("create_standalone_application.create")})})]})})}),Nn=g.memo(({id:e,className:t,enableToStandalone:n,getLinkedConnections:r})=>{const{t:a}=Pe("common"),{getNode:o}=lr(),{loading:i,deleteNodeFlow:s}=aB(),{createStandaloneSession:c}=rB(),{toast:l}=Qt(),u=Xt(oB),d=g.useCallback(async()=>{try{await s(e),l({description:a("deleted")})}catch{l({description:a("errors.delete_failed"),variant:"destructive"})}},[s,e,l,a]),p=g.useCallback(async y=>{try{const m=o(e);if(!m)throw new Error("No current node");const v=(r==null?void 0:r(e))||[];await c(m,{name:y,connections:v}),l({description:a("standalone_session_created")})}catch(m){Pl(m),l({description:a("errors.create_standalone_session_failed"),variant:"destructive"})}},[o,e,r,c,l,a]),f=g.useCallback(()=>{u.show({cloneStandaloneSession:p})},[p,u]);return h.jsxs("div",{className:Z("flex absolute z-[51] right-0 top-0 h-10",t),children:[n?h.jsx(ut,{className:"!rounded-none !px-2",onClick:f,variant:"ghost",children:h.jsx(de,{name:"package-plus",size:16})}):void 0,h.jsx(Vn,{loading:i,className:"!rounded-none !px-2",onClick:d,variant:"ghost",children:h.jsx(de,{name:"trash-2",size:16})})]})}),lt=g.memo(e=>{const{className:t,...n}=e;return h.jsx(Yu,{className:Z("!w-2 !h-2 !border-none !rounded-full !bg-slate-700",e.position===fe.Top?"!top-[-2px]":"",t),...n})}),iB=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async i=>{var s,c;n(!0);try{const l=(s=i.data)==null?void 0:s.entity;if(!l||!e)throw new Error("LLM or Session not found");const u=i.position.x,d=i.position.y+(((c=i.measured)==null?void 0:c.height)||0),p=await ue("Thread").save({initial_llm_id:l.id,title:`New thread with ${l.name}`,status:qp.Started,messages:[],session_id:e}),f=await r({source_id:p.id,source_type:"Thread",node_type:oe.Thread,x:u,y:d+60});if(!f)throw new Error("Failed to create thread node");const y=await a({source:i.id,target:f.id});return{thread:p,flowNode:f,flowEdge:y}}finally{n(!1)}},[a,r,e]);return{loading:t,createThread:o}},sB=(e,t)=>{var w;const{t:n}=Pe("flows"),{toast:r}=Qt(),[a,o]=g.useState(!1),[i,s]=g.useState(!1),c=Tn(e),{loadModel:l}=Wh(),{createThread:u,loading:d}=iB(),p=De(_=>_.updateNodes),f=De(_=>_.pushSyncNodeQueue),{getNodes:y}=lr(),m=g.useCallback(async()=>{try{if(s(!0),t.entity.id){const _=await ue("Thread").find({where:{initial_llm_id:t.entity.id}});f("Thread",{where:{source_type:"Thread",source_id:Ca(_.map(x=>x.id))}})}}finally{s(!1)}},[(w=t==null?void 0:t.entity)==null?void 0:w.id,f]),v=g.useCallback(async()=>{try{if(o(!0),t.entity&&c){await(l==null?void 0:l(t.entity.provider,`${t.entity.name}`,x=>{c.data.status=x.progress===100?Qe.Loaded:Qe.Loading,c.data.label=x.text,p([{id:e,type:"replace",item:c}])}));const _=y().filter(x=>x.type===oe.LLM?x.data.entity.provider===ln.WebLLM:!1).map(x=>(x.data.status=Qe.Started,{id:x.id,type:"replace",item:x}));c.data.label="",c.data.status=Qe.Loaded,_.push({id:e,type:"replace",item:c}),p(_),await m()}}catch(_){Bo(_),r({variant:"destructive",description:n("llm_node.errors.loading_model")})}finally{o(!1)}},[t.entity,y,e,l,c,m,n,r,p]),b=g.useCallback(async()=>{t.entity&&c&&await(u==null?void 0:u(c))},[t.entity,c,u]);return g.useEffect(()=>{t.entity&&c&&t.entity.status!==t.status&&(c.data.status=t.entity.status,p([{id:e,type:"replace",item:c}]))},[]),{loadingModel:a,creatingThread:d,queringThreads:i,loadModel:v,createThread:b,queryThreads:m}},An=(e,t)=>{const[n,r]=g.useState(!1),[a,o]=g.useState([]),{deleteElements:i,getNode:s}=lr();Dh({type:"target",nodeId:e,onConnect:l=>{l!=null&&l.length&&o(u=>[...u,...Zle(l)])}});const c=g.useCallback(async(l,u,d,p)=>{try{return await t({id:e,edgeId:l,source:u,target:d,connection:p})}catch{return{deleteEdgeId:l}}},[t,e]);g.useEffect(()=>{!(a!=null&&a.length)||n||(async()=>{try{r(!0);const l=[...a];o([]);const u=[],d=s(e);await Promise.all(l.map(async p=>{const f="edgeId"in p?p.edgeId:void 0,y=s(p.source);if(!y||!d)return;const m=await c(`${f}`,y,d,p);m!=null&&m.deleteEdgeId&&u.push(...Array.isArray(m.deleteEdgeId)?m.deleteEdgeId:[m.deleteEdgeId])})),u!=null&&u.length&&await i({edges:u.map(p=>({id:p}))})}finally{r(!1)}})()},[i,s,e,n,c,a])},cB=e=>{const t=g.useCallback(async()=>{},[]);An(e,t)},lB=g.memo(e=>{var m,v,b,w,_;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(),{t:i}=Pe("flows"),{createThread:s,loadModel:c,queringThreads:l,queryThreads:u,loadingModel:d}=sB(t,n);cB(t);const p=[Qe.Loading,Qe.Downloading].includes(n.status);g.useEffect(()=>{var x,j,S,E,O;if(!(a||!((x=n==null?void 0:n.entity)!=null&&x.name))){if(((j=n==null?void 0:n.entity)==null?void 0:j.provider)!==ln.WebLLM){o({hasCache:!0,isFunctionCalling:!0,info:{model_id:(S=n==null?void 0:n.entity)==null?void 0:S.name,model:(E=n==null?void 0:n.entity)==null?void 0:E.name,model_lib:(O=n==null?void 0:n.entity)==null?void 0:O.provider,model_type:2}});return}At(()=>import("./index-C4ZCpUfV.js").then(async N=>(await N.__tla,N)),__vite__mapDeps([5,1,2,3,4])).then(async({hasModelInCache:N,functionCallingModelIds:M,prebuiltAppConfig:P})=>{var k,C;const I=await N((k=n==null?void 0:n.entity)==null?void 0:k.name);o({hasCache:I,isFunctionCalling:M.includes((C=n==null?void 0:n.entity)==null?void 0:C.name),info:P.model_list.find(T=>{var A;return T.model_id===((A=n==null?void 0:n.entity)==null?void 0:A.name)})})})}},[(m=n==null?void 0:n.entity)==null?void 0:m.name,(v=n==null?void 0:n.entity)==null?void 0:v.provider,a]);const f=g.useMemo(()=>{var x,j;switch(n.status){case Qe.Downloading:return h.jsx(de,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case Qe.Loaded:return h.jsx(Aa,{name:((x=n.entity)==null?void 0:x.name)||"brain",className:"w-7 h-7"});case Qe.Loading:return h.jsx(de,{className:"animate-spin w-7 h-7",name:"loader-circle"});default:return h.jsx(Aa,{name:((j=n.entity)==null?void 0:j.name)||"brain",className:"w-7 h-7"})}},[(b=n.entity)==null?void 0:b.name,n.status]),y=g.useMemo(()=>p?null:d?h.jsx(ut,{disabled:!0,className:"w-full mt-4",children:h.jsx(de,{className:"animate-spin",size:24,name:"loader-circle"})}):n.status===Qe.Loaded?h.jsx(ut,{onClick:s,className:"mt-4 w-full",children:i("llm_node.create_thread_button")}):h.jsxs("div",{className:"flex gap-2 mt-4",children:[a!=null&&a.hasCache?h.jsx(Vn,{loading:l,onClick:u,children:h.jsx(de,{size:24,name:"message-square-more"})}):null,h.jsx(ut,{disabled:d,onClick:c,className:"w-full",children:i(a!=null&&a.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")})]}),[p,d,n.status,a==null?void 0:a.hasCache,l,u,c,i,s]);return h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Ra,{className:"flex justify-center",children:[f,h.jsxs("div",{className:"ml-2 pt-1 max-w-lg",children:[h.jsx(Oo,{className:"flex gap-2 items-center pr-6",children:`${((w=n==null?void 0:n.entity)==null?void 0:w.name)||""}`}),h.jsx(zc,{className:"max-w-full",children:`${n.label||""}`}),h.jsx("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:h.jsx(Sd,{model:a==null?void 0:a.info,isFunctionCalling:(a==null?void 0:a.isFunctionCalling)||!1,name:(_=n==null?void 0:n.entity)==null?void 0:_.name,isCached:(a==null?void 0:a.hasCache)||!1})}),y]})]}),p?h.jsx(Tj,{className:"rounded-lg"}):void 0]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),Wm=g.memo(({tags:e,disabled:t,loading:n,onSubmit:r})=>{const{t:a}=Pe("components"),o=async i=>{try{return await r(i),!0}catch{return!1}};return h.jsxs(Zt,{className:"min-w-80",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:a("add_message_card.title")})}),h.jsxs($n,{children:[h.jsx("div",{className:"grid w-full gap-1.5",children:h.jsx(bv,{onSubmit:o,disabled:t||n,placeholder:a("add_message_card.placeholder")})}),e?h.jsx("div",{className:"mt-2 gap-1 flex flex-wrap",children:e}):null]})]})}),SS=(e,t,n,r=[],a)=>{const o=e.map(i=>a.getNode(i));for(const i of o){if(!i)continue;const s=a.getHandleConnections({type:"target",nodeId:i.id});if(n.push(...s),i.type===oe.Thread){r.push(i.id),t.push(i);continue}else if(i.type!==oe.Message){r.push(i.id);continue}else if(r.includes(i.id))continue;r.push(i.id),t.push(i),s.length&&SS(s.map(c=>c.source),t,n,r,a)}return{nodes:t,connections:n}},ES=(e,t)=>{const n=t.getHandleConnections({nodeId:e.id,type:"target"}),r=n.map(d=>{const p=t.getNode(d.source);return p?{connections:t.getHandleConnections({nodeId:p.id,type:"target"}),node:p}:void 0}),a=r.filter(d=>{var p;return((p=d.node)==null?void 0:p.type)===oe.Prompt}),o=[];a!=null&&a.length&&a.forEach(d=>{var f;const p=(f=d.connections)==null?void 0:f.map(y=>t.getNode(y.source)).filter(Boolean);o.push({node:d.node,connections:d.connections,connectedNodes:p})});const i=r.filter(d=>{var p;return((p=d.node)==null?void 0:p.type)===oe.ToolDefinition}),s=[];i!=null&&i.length&&i.forEach(d=>{var f;const p=(f=d.connections)==null?void 0:f.map(y=>t.getNode(y.source)).filter(Boolean);p!=null&&p.find(y=>y.type===oe.Schema)&&s.push({node:d.node,connections:d.connections,connectedNodes:p})});const c=r.filter(d=>{var p;return((p=d.node)==null?void 0:p.type)===oe.PlaceHolder}),l=[];c!=null&&c.length&&c.forEach(d=>{var f;const p=(f=d.connections)==null?void 0:f.map(y=>t.getNode(y.source)).filter(Boolean);p&&l.push({node:d.node,connections:d.connections,connectedNodes:p})});const u=r.find(d=>{var p;return((p=d.node)==null?void 0:p.type)===oe.Schema});return{thread:{node:e,connections:n},llm:r.find(d=>{var p;return((p=d.node)==null?void 0:p.type)===oe.LLM}),schemas:u?[u]:[],prompts:o,tools:s,placeholders:l}},OS=e=>{const t=[];return e.forEach(n=>{var o,i,s;const{node:r,connectedNodes:a}=n;if((o=r.data)!=null&&o.entity){if(r.type===oe.Message){const c=r.data.entity;switch(c.role){case"human":t.push(new Pr(c.content));break;case"ai":t.push(new Wo(c.content));break}}else if(r.type===oe.Prompt){const c=r.data.entity;let l=`${c.prefix?`${c.prefix}
`:""}`;if(c.type===rr.FewShotExample){const u=(s=(i=a.find(d=>d.type===oe.CSVData))==null?void 0:i.data)==null?void 0:s.entity;if(u){const{rows:d}=bK(u.headers,u.csv);d.forEach(p=>{l+=`${c.content.replace(/{([^{}]*)}/g,(f,y)=>`${p[y]}`)}
`})}}else l+=c.content;switch(c.suffix&&(l+=`
${c.suffix}`),c.role){case"human":t.push(new Pr(l));break;case"system":t.push(new Mg(l));break;default:t.push(new Wo(l));break}}}}),t},uB=(e,t)=>{const n=(e==null?void 0:e.filter(a=>a.type===oe.Message).map(a=>({node:a,connectedNodes:[]})).reverse())||[],r=[];return t.forEach(async a=>{r.unshift({node:a.node,connectedNodes:a.connectedNodes||[]})}),{history:OS(n),systems:OS(r)}},dB=e=>e?e.reduce((t,n)=>{var o,i,s,c,l;const r=(o=n.node.data)==null?void 0:o.entity,a=(c=(s=(i=n==null?void 0:n.connectedNodes)==null?void 0:i.find(u=>u.type===oe.Schema))==null?void 0:s.data)==null?void 0:c.entity;return r&&((l=a==null?void 0:a.schema_items)!=null&&l.length)&&t.push({name:r.name,description:r.description,schemaItems:a.schema_items}),t},[]):[],CS=({getNode:e,getHandleConnections:t})=>{const{t:n}=Pe("create_new_message"),[r,a]=g.useState(!1),o=Ye(y=>y.currentSession),i=De(y=>y.createOrUpdateFlowNode),s=De(y=>y.createOrUpdateFlowEdge),c=js(y=>y.similaritySearchWithScore),{stream:l}=kc(),u=g.useCallback(async({content:y,threadId:m,sourceId:v,initialX:b,initialY:w,initialLLMId:_})=>{if(!o)throw new Error("Session is not found");const x=await ue("Message").save({thread_id:m,content:y,role:nr.Human,status:Ir.Started,llm_id:_,session_id:o.id});if(!x)throw new Error("Failed to save message");const j=await i({source_id:x.id,source_type:"Message",node_type:oe.Message,x:b,y:w+80});if(!j)throw new Error("Failed to save human message node");await s({source:v,target:j.id});const S=await ue("Message").save({thread_id:m,content:n("initial_ai_message"),role:nr.AI,status:Ir.Inprogress,llm_id:_,parent_message_id:x.id,session_id:o.id});if(!S)throw new Error("Failed to save message");const E=await i({source_id:S.id,source_type:"Message",node_type:oe.Message,x:b,y:w+250});if(!E)throw new Error("Failed to save ai message node");return await s({source:j.id,target:E.id}),{aiMessage:S,humanMessage:x,aiMessageNode:E,humanMessageNode:j}},[s,i,o,n]),d=g.useCallback(async(y,m)=>{const{placeholders:v}=m;if(!(v!=null&&v.length))return[];const b=[];return await Promise.all(v.map(async w=>{var x,j,S,E,O,N,M,P,I,k,C,T;const _=(x=w.node.data)==null?void 0:x.entity;if(_)switch(_.placeholder_type){case As.VECTOR_DATABASE_RETREIVER:{const A=(j=w.connectedNodes)==null?void 0:j.find(V=>V.type===oe.VectorDatabase),R=(S=A==null?void 0:A.data)==null?void 0:S.entity,L=(N=(O=(E=w.connectedNodes)==null?void 0:E.find(V=>V.type===oe.Prompt))==null?void 0:O.data)==null?void 0:N.entity;if(!L||!R||!A)return;const D=(M=_.metadata)!=null&&M.k?+((P=_.metadata)==null?void 0:P.k):1;let B=(I=_.metadata)!=null&&I.minimalScore?+((k=_.metadata)==null?void 0:k.minimalScore):void 0;B&&B>1&&(B=B/100);const F=[];if(R.storage===kr.DataNode){const V=(T=(C=t({nodeId:A.id,type:"target"}).map(Q=>e(Q.source)).find(Q=>(Q==null?void 0:Q.type)&&[oe.JSONLData,oe.CSVData].includes(Q==null?void 0:Q.type)))==null?void 0:C.data)==null?void 0:T.entity;if(!V)return;F.push(...await c({databaseId:R.id,dataSourceId:V.id,dataSourceType:ON(V)},y.humanMessage.content,D))}else F.push(...await c({databaseId:R.id},y.humanMessage.content,D));if(!F)return[];const $=new qo({template:L.content,inputVariables:["context"]});b.push(new Wo(await $.format({context:B?F.filter(([,V])=>V>=B).map(([V])=>V.pageContent).join(`
`):F.map(([V])=>V.pageContent).join(`
`)})))}}})),b},[t,e,c]),p=g.useCallback(async(y,m,v,{onMessageUpdate:b})=>{var T;const{prompts:w,tools:_,schemas:x,placeholders:j,llm:S}=m,E=(T=S==null?void 0:S.node.data)==null?void 0:T.entity;if(!E)throw new Error("LLM is not found");const O=[];j!=null&&j.length&&O.push(...await d(y,m));const{history:N,systems:M}=uB(v,w),P=[...M,...O,...N,new Pr(y.humanMessage.content)],I=x.map(A=>{var R;return(R=A.node.data)==null?void 0:R.entity}).filter(Boolean),{lastChunk:k,content:C}=await l(E.provider,P,{tools:dB(_),schemas:I,llm:E,onMessageUpdate:({content:A})=>{b==null||b({id:y.aiMessageNode.id,nodeData:{loading:!0,content:A}})}});return y.aiMessage.content=C,y.aiMessage.metadata=JSON.stringify({message:k}),b==null||b({id:y.aiMessageNode.id,nodeData:{content:C,loading:!1,entity:y.aiMessage}}),y.aiMessage.id&&await ue("Message").update(y.aiMessage.id,{content:C,metadata:JSON.stringify({message:k})}),C},[d,l]),f=g.useCallback(async(y,m,v)=>{var S,E,O;const{nodes:b}=SS([y.id],[],[],[],{getNode:e,getHandleConnections:t}),w=b.find(N=>N.type===oe.Thread),_=w==null?void 0:w.data.entity;if(!y||!_||!w)throw new Error("Source or thread is not found");const x=ES(w,{getNode:e,getHandleConnections:t});if(!(x!=null&&x.thread))throw new Error("Thread node is not found");let j;try{a(!0);const N=((S=y.position)==null?void 0:S.x)||0,M=(((E=y.position)==null?void 0:E.y)||0)+(((O=y.measured)==null?void 0:O.height)||0);return j=await u({content:m,initialX:N,initialY:M,sourceId:y.id,threadId:_.id,initialLLMId:_.initial_llm_id}),await p(j,x,b,v),await ue("Message").update(`${j.aiMessage.id}`,{status:Ir.Success}),j.aiMessage.status=Ir.Success,v.onMessageUpdate({id:j.aiMessageNode.id,nodeData:{entity:j.aiMessage,loading:!1}}),!0}catch(N){Pl(N),j!=null&&j.aiMessage&&await ue("Message").update(`${j.aiMessage.id}`,{status:Ir.Failed,content:n("errors.ai_message_content_failed")}),j!=null&&j.aiMessageNode.id&&(v==null||v.onMessageUpdate({id:j.aiMessageNode.id,nodeData:{content:n("errors.ai_message_content_failed"),entity:{...j.aiMessage,status:Ir.Failed,content:n("errors.ai_message_content_failed")},loading:!1}}))}finally{a(!1)}},[t,e,u,p,n]);return{loading:r,createMessage:f}},pB=(e,t)=>{const n=Tn(e),{t:r}=Pe("flows"),{getNode:a,getHandleConnections:o}=lr(),i=De(p=>p.updateNodes),{createMessage:s,loading:c}=CS({getNode:a,getHandleConnections:o}),l=g.useCallback(p=>{if(!p.id)return;const f=a(p.id);!f||!p.nodeData||i([{id:f.id,type:"replace",item:{...f,data:{...f.data,...ku(p.nodeData,Au)}}}])},[a,i]),u=g.useCallback(async p=>{if(n&&t.entity)try{await s(n,p,{onMessageUpdate:l})}catch(f){if(f instanceof Error&&f.message.includes("LLM_NOT_LOADED_YET"))return Tl({variant:"destructive",title:r("thread_node.errors.llm_not_loaded_yet")});Tl({variant:"destructive",title:`${f}`})}},[n,t.entity,s,l,r]),d=g.useCallback(p=>{const f=a(p);if(!f)return[];const y=[],m=ES(f,{getNode:a,getHandleConnections:o});return m.thread&&y.push({node:m.thread.node,connectedNodes:[],connections:m.thread.connections}),m.prompts&&y.push(...m.prompts.map(v=>({node:v.node,connectedNodes:v.connectedNodes,connections:v.connections}))),m.schemas&&y.push(...m.schemas.map(v=>({node:v.node,connectedNodes:[],connections:v.connections}))),m.placeholders&&m.placeholders.forEach(v=>{const b=v.connections.map(w=>a(w.source)).filter(Boolean);y.push({node:v.node,connectedNodes:b||[],connections:v.connections})}),m.llm&&y.push(m.llm),y},[o,a]);return{loading:c,createMessage:u,getLinkedConnections:d}},fB=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.Prompt&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.Schema&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.ToolDefinition&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.VectorDatabase&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.PlaceHolder&&(o==null?void 0:o.type)===oe.Thread&&a.data.entity.placeholder_type===As.VECTOR_DATABASE_RETREIVER){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},hB=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e,{t:a}=Pe("flows"),[o,i]=g.useState(!1),s=Dh({type:"source"}),c=Dh({type:"target"}),{getNode:l}=lr(),{loading:u,createMessage:d,getLinkedConnections:p}=pB(t,n);fB(t);const f=g.useCallback(async(...b)=>(i(!1),await d(...b)),[d]),y=g.useMemo(()=>s.length>0,[s]),m=g.useCallback(()=>{i(b=>!b)},[]),v=g.useMemo(()=>{var w,_;const b=c.map((x,j)=>{var E;const S=l(x.source);if((S==null?void 0:S.type)===oe.Schema)return h.jsx(xn,{children:a("thread_node.structured_output")},`${j}`);if((S==null?void 0:S.type)===oe.Prompt){const O=S.data.entity;return h.jsx(xn,{children:a(O.type===rr.FewShotExample?"thread_node.prompts.few_shot_example":`thread_node.prompts.${O.role.toLowerCase()}`)},`${j}`)}else if((S==null?void 0:S.type)===oe.PlaceHolder&&((E=S.data.entity)==null?void 0:E.placeholder_type)===As.VECTOR_DATABASE_RETREIVER)return h.jsx(xn,{children:a("thread_node.vector_database_retriever")},`${j}`)}).filter(Boolean);return e.data.entity&&!((_=(w=e.data.entity)==null?void 0:w.messages)!=null&&_.length)&&!y?h.jsx(Wm,{disabled:u,loading:u,onSubmit:f,tags:b}):b!=null&&b.length?h.jsxs(Zt,{className:"p-4 pt-2",children:[h.jsx(Kn,{className:"mb-2",children:a("thread_node.title")}),h.jsx("div",{className:"flex gap-1.5",children:b}),h.jsx("div",{className:"mt-4 w-full flex justify-end",children:h.jsxs(ut,{onClick:m,variant:"outline",children:[h.jsx(de,{name:o?"copy-minus":"copy-plus"}),a(o?"thread_node.hide":"thread_node.clone")]})})]}):h.jsx("div",{className:"w-12 h-10"})},[y,l,f,m,u,e.data.entity,o,a,c]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t,enableToStandalone:!0,getLinkedConnections:p}),v,o?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(Wm,{disabled:u,loading:u,onSubmit:f})})})]}):void 0]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})});function Ove({data:e,onNewThread:t,loading:n,showThread:r}){var o;const{t:a}=Pe("flows");return h.jsxs(Ra,{className:"flex min-w-52",children:[h.jsx(de,{size:24,name:"user"}),h.jsxs("div",{className:"ml-2 max-w-full w-full",children:[h.jsx(Oo,{children:"Human"}),h.jsx(zc,{children:`${e.content||((o=e.entity)==null?void 0:o.content)||""}`}),t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(ut,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(de,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]})]})}const Cve=g.lazy(()=>At(()=>import("./index-BvUKr9zq.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([9,10,1,2,11,12])));function Nve({data:e,onNewThread:t,loading:n,showThread:r}){var l,u,d,p,f,y,m,v,b;const{t:a}=Pe("flows"),o=Vo(w=>w.theme),i=g.useMemo(()=>{var w;try{return JSON.parse(((w=e==null?void 0:e.entity)==null?void 0:w.metadata)||"{}")}catch{return{}}},[(l=e==null?void 0:e.entity)==null?void 0:l.metadata]),s=e.entity.status===Ir.Failed,c=g.useMemo(()=>{var w;return h.jsx(Cve,{className:"!text-sm [&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans",source:`${e.content||((w=e.entity)==null?void 0:w.content)||""}`,wrapperElement:{"data-color-mode":o==="dark"?"dark":"light"},components:{pre:({children:_,...x})=>h.jsx("pre",{...x,className:Z(x.className,"nowheel"),children:_})}})},[e.content,(u=e.entity)==null?void 0:u.content,o]);return h.jsxs(Ra,{className:Z("flex min-w-52",s?"bg-background":""),variant:s?"destructive":"default",children:[h.jsx(de,{className:Z(e.loading?"animate-spin":void 0),size:24,name:e.loading?"loader-circle":"bot"}),h.jsx(de,{name:r?"minus":"plus",size:24}),h.jsxs("div",{className:"ml-2 w-full max-w-full",children:[h.jsx(Oo,{children:a(`message_node.message_roles.${(p=(d=e.entity)==null?void 0:d.role)==null?void 0:p.toLowerCase()}`)}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:s?e.content||((f=e.entity)==null?void 0:f.content)||"":c}),Array.isArray((y=i==null?void 0:i.message)==null?void 0:y.tool_calls)&&((v=(m=i==null?void 0:i.message)==null?void 0:m.tool_calls)!=null&&v.length)?(b=i==null?void 0:i.message)==null?void 0:b.tool_calls.map((w,_)=>h.jsx(xn,{children:a("message_node.tool_call",{name:w.name,args:Object.entries(w.args).map(([x,j])=>`"${x}": "${j}"`).join(", ")})},`${w.name}_${_}`)):null,t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(ut,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(de,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]}),e.loading?h.jsx(Tj,{size:350,duration:10}):void 0]})}const Mve=e=>{const{t}=Pe("flows"),n=Tn(e),r=De(u=>u.updateNodes),{getNode:a,getHandleConnections:o}=lr(),{createMessage:i,loading:s}=CS({getNode:a,getHandleConnections:o}),c=g.useCallback(u=>{if(!u.id)return;const d=a(u.id);!d||!u.nodeData||r([{id:d.id,type:"replace",item:{...d,data:{...d.data,...ku(u.nodeData,Au)}}}])},[a,r]),l=g.useCallback(async u=>{if(n)try{await i(n,u,{onMessageUpdate:c})}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return Tl({variant:"destructive",title:t("message_node.errors.llm_not_loaded_yet")});Tl({variant:"destructive",title:t("message_node.errors.create_message")})}},[n,t,i,c]);return{loading:s,createMessage:l}},mB=()=>{const e=Ye(r=>r.currentSession),t=De(r=>r.createOrUpdateFlowNode),n=De(r=>r.createOrUpdateFlowEdge);return{createIdieMessage:g.useCallback(async(r,a,o,i)=>{var y,m,v,b,w;if(!r||!a||!e)return;const s=(m=(y=i==null?void 0:i.promptNode)==null?void 0:y.data)==null?void 0:m.entity,c=((v=r.position)==null?void 0:v.x)||0,l=(((b=r.position)==null?void 0:b.y)||0)+(((w=r.measured)==null?void 0:w.height)||0),u=await ue("Message").save({thread_id:a.id,content:o,role:(s==null?void 0:s.role)||nr.Human,status:Ir.Started,llm_id:a.initial_llm_id,session_id:e.id});if(!u)throw new Error("Failed to save message");const d=await t({source_id:u.id,source_type:"Message",node_type:oe.Message,x:c,y:l});if(!d)throw new Error("Failed to save message node");const p=await n({source:r.id,target:d.id});let f;return i!=null&&i.promptNode&&(f=await n({source:i==null?void 0:i.promptNode.id,target:d.id})),{message:u,edgeToPrompt:f,messageNode:d,messageEdge:p}},[t,n])}},Pve=e=>{const{createIdieMessage:t}=mB(),n=g.useCallback(async({edgeId:r,source:a,target:o})=>{var i,s;try{if((a==null?void 0:a.type)===oe.Prompt&&(o==null?void 0:o.type)===oe.Message){const c=(i=o==null?void 0:o.data)==null?void 0:i.entity,l=(s=a==null?void 0:a.data)==null?void 0:s.entity;if(!l||!c||!o)return{deleteEdgeId:r};await t(o,{id:c==null?void 0:c.thread_id,title:"",status:qp.Started,initial_llm_id:c.llm_id,session_id:l.session_id},l.content,{promptNode:a});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},kve=g.memo(e=>{var _,x,j;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(!1),[i,s]=g.useState(!1),{t:c}=Pe("common"),l=Dh({type:"source"}),{loading:u,createMessage:d}=Mve(t),{toast:p}=Qt();Pve(t);const f=g.useCallback(async(...S)=>{const E=await d(...S);return o(!1),E},[d]),y=g.useMemo(()=>l.length===0,[l]),m=g.useCallback(()=>{var S;(S=n.entity)!=null&&S.content&&(navigator.clipboard.writeText(n.entity.content),p({description:c("copied")}))},[p,n,c]),v=g.useCallback(async()=>{var S;try{if(i)return await EN.stop(),s(!1);s(!0),await EN.speak(((S=n.entity)==null?void 0:S.content)||"")}catch{p({variant:"destructive",description:c("errors.speech_is_not_supported")})}finally{s(!1)}},[(_=n.entity)==null?void 0:_.content,i,c,p]),b=g.useCallback(()=>{o(S=>!S)},[]),w=g.useMemo(()=>{var S;if(!(!y&&!a||n.loading||u||((S=n==null?void 0:n.entity)==null?void 0:S.status)==="inprogress"))return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(Wm,{disabled:u,loading:u,onSubmit:f})})})]})},[(x=n==null?void 0:n.entity)==null?void 0:x.status,n.loading,f,y,u,a]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs("div",{className:"max-w-sm min-w-64",children:[h.jsxs("div",{className:"w-auto",children:[h.jsx(Nn,{id:t}),h.jsx("div",{children:((j=n.entity)==null?void 0:j.role)===nr.Human?h.jsx(Ove,{data:n,showThread:a,onNewThread:y?void 0:b}):h.jsx(Nve,{data:n,showThread:a,loading:u,onNewThread:y?void 0:b})}),h.jsx(ut,{onClick:v,className:"absolute top-0 right-[68px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(de,{name:i?"circle-stop":"speech",size:16})}),h.jsx(ut,{onClick:m,className:"absolute top-0 right-[36px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(de,{name:"copy",size:16})})]}),w]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),Ave=e=>{const t=De(a=>a.createOrUpdateFlowEdge),{createIdieMessage:n}=mB(),r=g.useCallback(async({edgeId:a,source:o,target:i})=>{var s,c,l,u;try{const d=(s=i==null?void 0:i.data)==null?void 0:s.entity,p=(c=o==null?void 0:o.data)==null?void 0:c.entity;if((o==null?void 0:o.type)===oe.Message&&(i==null?void 0:i.type)===oe.Prompt){const f=(l=o==null?void 0:o.data)==null?void 0:l.entity,y=(u=i==null?void 0:i.data)==null?void 0:u.entity;if(!y||!f||!i)return{deleteEdgeId:a};await n(o,{id:f==null?void 0:f.thread_id,title:"",status:qp.Started,initial_llm_id:f.llm_id,session_id:y.session_id},y.content,{promptNode:i});return}else if((o==null?void 0:o.type)===oe.CSVData&&(i==null?void 0:i.type)===oe.Prompt&&(d==null?void 0:d.type)===rr.FewShotExample&&(p!=null&&p.headers.includes("input"))&&(p!=null&&p.headers.includes("output"))){await t({source:o.id,target:i.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[n,t]);An(e,r)},Tve=g.memo(e=>{var l,u,d;const{id:t,data:n,isConnectable:r}=e;Ave(t);const a=Xt(T$),o=g.useMemo(()=>{var p,f,y;return`${(p=n.entity)!=null&&p.prefix?`${(f=n.entity)==null?void 0:f.prefix}
`:""}${((y=n.entity)==null?void 0:y.content)||""}`},[(l=n.entity)==null?void 0:l.prefix,(u=n.entity)==null?void 0:u.content]),i=g.useMemo(()=>{var f;const p=/{(.*?)}/g;return((f=o.match(p))==null?void 0:f.map(y=>y.replace("{","").replace("}","")))||[]},[o]),s=o.length>990,c=()=>{a.show({title:"Prompt",content:o})};return h.jsxs("div",{className:"min-w-56",children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Ra,{className:"flex justify-center max-w-72",variant:"default",children:[h.jsx(de,{size:24,name:"notepad-text"}),h.jsxs("div",{className:"ml-2 max-w-full break-words break-all",children:[h.jsx(Oo,{children:`${((d=n.entity)==null?void 0:d.role)||""}`}),h.jsxs(zc,{onClick:s?c:void 0,children:[s?`${o.slice(0,990)}...`:o,s?h.jsx("span",{className:"float-right",children:h.jsx(de,{name:"chevron-right"})}):void 0]}),i!=null&&i.length?i.map((p,f)=>h.jsx(xn,{className:"mt-2 mr-1",variant:"default",children:p},f)):void 0]})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})});var Ive=KR();const xr=ot(Ive);var NS,yB;function Rve(){if(yB)return NS;yB=1;function e(t){return t==null}return NS=e,NS}var Dve=Rve();const gt=ot(Dve);var MS,gB;function Lve(){if(gB)return MS;gB=1;var e=po(),t=In(),n=ha(),r="[object String]";function a(o){return typeof o=="string"||!t(o)&&n(o)&&e(o)==r}return MS=a,MS}var $ve=Lve();const Td=ot($ve);var Fve=Fp();const tt=ot(Fve);var Bve=Tr();const Vc=ot(Bve);var vB={exports:{}},vt={},bB;function zve(){if(bB)return vt;bB=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),i=Symbol.for("react.context"),s=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.for("react.offscreen"),y;y=Symbol.for("react.module.reference");function m(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case e:switch(v=v.type,v){case n:case a:case r:case l:case u:return v;default:switch(v=v&&v.$$typeof,v){case s:case i:case c:case p:case d:case o:return v;default:return b}}case t:return b}}}return vt.ContextConsumer=i,vt.ContextProvider=o,vt.Element=e,vt.ForwardRef=c,vt.Fragment=n,vt.Lazy=p,vt.Memo=d,vt.Portal=t,vt.Profiler=a,vt.StrictMode=r,vt.Suspense=l,vt.SuspenseList=u,vt.isAsyncMode=function(){return!1},vt.isConcurrentMode=function(){return!1},vt.isContextConsumer=function(v){return m(v)===i},vt.isContextProvider=function(v){return m(v)===o},vt.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===e},vt.isForwardRef=function(v){return m(v)===c},vt.isFragment=function(v){return m(v)===n},vt.isLazy=function(v){return m(v)===p},vt.isMemo=function(v){return m(v)===d},vt.isPortal=function(v){return m(v)===t},vt.isProfiler=function(v){return m(v)===a},vt.isStrictMode=function(v){return m(v)===r},vt.isSuspense=function(v){return m(v)===l},vt.isSuspenseList=function(v){return m(v)===u},vt.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===n||v===a||v===r||v===l||v===u||v===f||typeof v=="object"&&v!==null&&(v.$$typeof===p||v.$$typeof===d||v.$$typeof===o||v.$$typeof===i||v.$$typeof===c||v.$$typeof===y||v.getModuleId!==void 0)},vt.typeOf=m,vt}var wB;function Vve(){return wB||(wB=1,vB.exports=zve()),vB.exports}var Wve=Vve(),PS,xB;function _B(){if(xB)return PS;xB=1;var e=po(),t=ha(),n="[object Number]";function r(a){return typeof a=="number"||t(a)&&e(a)==n}return PS=r,PS}var kS,jB;function Uve(){if(jB)return kS;jB=1;var e=_B();function t(n){return e(n)&&n!=+n}return kS=t,kS}var qve=Uve();const Id=ot(qve);var Hve=_B();const Kve=ot(Hve);var ia=function(e){return e===0?0:e>0?1:-1},os=function(e){return Td(e)&&e.indexOf("%")===e.length-1},ye=function(e){return Kve(e)&&!Id(e)},on=function(e){return ye(e)||Td(e)},Zve=0,Um=function(e){var t=++Zve;return"".concat(e||"").concat(t)},is=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ye(e)&&!Td(e))return n;var a;if(os(e)){var o=e.indexOf("%");a=t*parseFloat(e.slice(0,o))/100}else a=+e;return Id(a)&&(a=n),r&&a>t&&(a=t),a},yi=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},Xve=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1},Wc=function(e,t){return ye(e)&&ye(t)?function(n){return e+n*(t-e)}:function(){return t}};function AS(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):xr(r,t))===n})}function Uc(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function TS(e){"@babel/helpers - typeof";return TS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TS(e)}var Qve=["viewBox","children"],Gve=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],SB=["points","pathLength"],IS={svg:Qve,polygon:SB,polyline:SB},RS=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],qm=function(e,t){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),!Vc(n))return null;var r={};return Object.keys(n).forEach(function(a){RS.includes(a)&&(r[a]=t||function(o){return n[a](n,o)})}),r},Jve=function(e,t,n){return function(r){return e(t,n,r),null}},Hm=function(e,t,n){if(!Vc(e)||TS(e)!=="object")return null;var r=null;return Object.keys(e).forEach(function(a){var o=e[a];RS.includes(a)&&typeof o=="function"&&(r||(r={}),r[a]=Jve(o,t,n))}),r},Yve=["children"],e0e=["children"];function EB(e,t){if(e==null)return{};var n=t0e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function t0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var OB={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},No=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},CB=null,DS=null,LS=function e(t){if(t===CB&&Array.isArray(DS))return DS;var n=[];return g.Children.forEach(t,function(r){gt(r)||(Wve.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),DS=n,CB=t,n};function sa(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(a){return No(a)}):r=[No(t)],LS(e).forEach(function(a){var o=xr(a,"type.displayName")||xr(a,"type.name");r.indexOf(o)!==-1&&n.push(a)}),n}function fr(e,t){var n=sa(e,t);return n&&n[0]}var NB=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!ye(n)||n<=0||!ye(r)||r<=0)},n0e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],r0e=function(e){return e&&e.type&&Td(e.type)&&n0e.indexOf(e.type)>=0},a0e=function(e,t,n,r){var a,o=(a=IS==null?void 0:IS[r])!==null&&a!==void 0?a:[];return!tt(e)&&(r&&o.includes(t)||Gve.includes(t))||n&&RS.includes(t)},yt=function(e,t,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(g.isValidElement(e)&&(r=e.props),!Vc(r))return null;var a={};return Object.keys(r).forEach(function(o){var i;a0e((i=r)===null||i===void 0?void 0:i[o],o,t,n)&&(a[o]=r[o])}),a},$S=function e(t,n){if(t===n)return!0;var r=g.Children.count(t);if(r!==g.Children.count(n))return!1;if(r===0)return!0;if(r===1)return MB(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var o=t[a],i=n[a];if(Array.isArray(o)||Array.isArray(i)){if(!e(o,i))return!1}else if(!MB(o,i))return!1}return!0},MB=function(e,t){if(gt(e)&&gt(t))return!0;if(!gt(e)&&!gt(t)){var n=e.props||{},r=n.children,a=EB(n,Yve),o=t.props||{},i=o.children,s=EB(o,e0e);return r&&i?Uc(a,s)&&$S(r,i):!r&&!i?Uc(a,s):!1}return!1},PB=function(e,t){var n=[],r={};return LS(e).forEach(function(a,o){if(r0e(a))n.push(a);else if(a){var i=No(a.type),s=t[i]||{},c=s.handler,l=s.once;if(c&&(!l||!r[i])){var u=c(a,i,o);n.push(u),r[i]=!0}}}),n},o0e=function(e){var t=e&&e.type;return t&&OB[t]?OB[t]:null},i0e=function(e,t){return LS(t).indexOf(e)},s0e=["children","width","height","viewBox","className","style","title","desc"];function FS(){return FS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FS.apply(this,arguments)}function c0e(e,t){if(e==null)return{};var n=l0e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function l0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function BS(e){var t=e.children,n=e.width,r=e.height,a=e.viewBox,o=e.className,i=e.style,s=e.title,c=e.desc,l=c0e(e,s0e),u=a||{width:n,height:r,x:0,y:0},d=xt("recharts-surface",o);return U.createElement("svg",FS({},yt(l,!0,"svg"),{className:d,width:n,height:r,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),U.createElement("title",null,s),U.createElement("desc",null,c),t)}var u0e=["children","className"];function zS(){return zS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zS.apply(this,arguments)}function d0e(e,t){if(e==null)return{};var n=p0e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function p0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var pn=U.forwardRef(function(e,t){var n=e.children,r=e.className,a=d0e(e,u0e),o=xt("recharts-layer",r);return U.createElement("g",zS({className:o},yt(a,!0),{ref:t}),n)}),Mo=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]},VS,kB;function f0e(){if(kB)return VS;kB=1;var e=Av();function t(n,r,a){var o=n.length;return a=a===void 0?o:a,!r&&a>=o?n:e(n,r,a)}return VS=t,VS}var WS,AB;function TB(){if(AB)return WS;AB=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="\\u200d",s=RegExp("["+i+e+a+o+"]");function c(l){return s.test(l)}return WS=c,WS}var US,IB;function h0e(){if(IB)return US;IB=1;function e(t){return t.split("")}return US=e,US}var qS,RB;function m0e(){if(RB)return qS;RB=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="["+e+"]",s="["+a+"]",c="\uD83C[\uDFFB-\uDFFF]",l="(?:"+s+"|"+c+")",u="[^"+e+"]",d="(?:\uD83C[\uDDE6-\uDDFF]){2}",p="[\uD800-\uDBFF][\uDC00-\uDFFF]",f="\\u200d",y=l+"?",m="["+o+"]?",v="(?:"+f+"(?:"+[u,d,p].join("|")+")"+m+y+")*",b=m+y+v,w="(?:"+[u+s+"?",s,d,p,i].join("|")+")",_=RegExp(c+"(?="+c+")|"+w+b,"g");function x(j){return j.match(_)||[]}return qS=x,qS}var HS,DB;function y0e(){if(DB)return HS;DB=1;var e=h0e(),t=TB(),n=m0e();function r(a){return t(a)?n(a):e(a)}return HS=r,HS}var KS,LB;function g0e(){if(LB)return KS;LB=1;var e=f0e(),t=TB(),n=y0e(),r=VR();function a(o){return function(i){i=r(i);var s=t(i)?n(i):void 0,c=s?s[0]:i.charAt(0),l=s?e(s,1).join(""):i.slice(1);return c[o]()+l}}return KS=a,KS}var ZS,$B;function v0e(){if($B)return ZS;$B=1;var e=g0e(),t=e("toUpperCase");return ZS=t,ZS}var b0e=v0e();const Km=ot(b0e);function It(e){return function(){return e}}const FB=Math.cos,Zm=Math.sin,ca=Math.sqrt,Xm=Math.PI,Qm=2*Xm,XS=Math.PI,QS=2*XS,ss=1e-6,w0e=QS-ss;function BB(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function x0e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return BB;const n=10**t;return function(r){this._+=r[0];for(let a=1,o=r.length;a<o;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class _0e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?BB:x0e(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,a){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(t,n,r,a,o,i){this._append`C${+t},${+n},${+r},${+a},${this._x1=+o},${this._y1=+i}`}arcTo(t,n,r,a,o){if(t=+t,n=+n,r=+r,a=+a,o=+o,o<0)throw new Error(`negative radius: ${o}`);let i=this._x1,s=this._y1,c=r-t,l=a-n,u=i-t,d=s-n,p=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(p>ss)if(!(Math.abs(d*c-l*u)>ss)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let f=r-i,y=a-s,m=c*c+l*l,v=f*f+y*y,b=Math.sqrt(m),w=Math.sqrt(p),_=o*Math.tan((XS-Math.acos((m+p-v)/(2*b*w)))/2),x=_/w,j=_/b;Math.abs(x-1)>ss&&this._append`L${t+x*u},${n+x*d}`,this._append`A${o},${o},0,0,${+(d*f>u*y)},${this._x1=t+j*c},${this._y1=n+j*l}`}}arc(t,n,r,a,o,i){if(t=+t,n=+n,r=+r,i=!!i,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(a),c=r*Math.sin(a),l=t+s,u=n+c,d=1^i,p=i?a-o:o-a;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>ss||Math.abs(this._y1-u)>ss)&&this._append`L${l},${u}`,r&&(p<0&&(p=p%QS+QS),p>w0e?this._append`A${r},${r},0,1,${d},${t-s},${n-c}A${r},${r},0,1,${d},${this._x1=l},${this._y1=u}`:p>ss&&this._append`A${r},${r},0,${+(p>=XS)},${d},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function GS(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new _0e(t)}function JS(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function zB(e){this._context=e}zB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Gm(e){return new zB(e)}function VB(e){return e[0]}function WB(e){return e[1]}function UB(e,t){var n=It(!0),r=null,a=Gm,o=null,i=GS(s);e=typeof e=="function"?e:e===void 0?VB:It(e),t=typeof t=="function"?t:t===void 0?WB:It(t);function s(c){var l,u=(c=JS(c)).length,d,p=!1,f;for(r==null&&(o=a(f=i())),l=0;l<=u;++l)!(l<u&&n(d=c[l],l,c))===p&&((p=!p)?o.lineStart():o.lineEnd()),p&&o.point(+e(d,l,c),+t(d,l,c));if(f)return o=null,f+""||null}return s.x=function(c){return arguments.length?(e=typeof c=="function"?c:It(+c),s):e},s.y=function(c){return arguments.length?(t=typeof c=="function"?c:It(+c),s):t},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:It(!!c),s):n},s.curve=function(c){return arguments.length?(a=c,r!=null&&(o=a(r)),s):a},s.context=function(c){return arguments.length?(c==null?r=o=null:o=a(r=c),s):r},s}function Jm(e,t,n){var r=null,a=It(!0),o=null,i=Gm,s=null,c=GS(l);e=typeof e=="function"?e:e===void 0?VB:It(+e),t=typeof t=="function"?t:It(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?WB:It(+n);function l(d){var p,f,y,m=(d=JS(d)).length,v,b=!1,w,_=new Array(m),x=new Array(m);for(o==null&&(s=i(w=c())),p=0;p<=m;++p){if(!(p<m&&a(v=d[p],p,d))===b)if(b=!b)f=p,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),y=p-1;y>=f;--y)s.point(_[y],x[y]);s.lineEnd(),s.areaEnd()}b&&(_[p]=+e(v,p,d),x[p]=+t(v,p,d),s.point(r?+r(v,p,d):_[p],n?+n(v,p,d):x[p]))}if(w)return s=null,w+""||null}function u(){return UB().defined(a).curve(i).context(o)}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:It(+d),r=null,l):e},l.x0=function(d){return arguments.length?(e=typeof d=="function"?d:It(+d),l):e},l.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:It(+d),l):r},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:It(+d),n=null,l):t},l.y0=function(d){return arguments.length?(t=typeof d=="function"?d:It(+d),l):t},l.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:It(+d),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(d){return arguments.length?(a=typeof d=="function"?d:It(!!d),l):a},l.curve=function(d){return arguments.length?(i=d,o!=null&&(s=i(o)),l):i},l.context=function(d){return arguments.length?(d==null?o=s=null:s=i(o=d),l):o},l}class qB{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function j0e(e){return new qB(e,!0)}function S0e(e){return new qB(e,!1)}const YS={draw(e,t){const n=ca(t/Xm);e.moveTo(n,0),e.arc(0,0,n,0,Qm)}},E0e={draw(e,t){const n=ca(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},HB=ca(1/3),O0e=HB*2,C0e={draw(e,t){const n=ca(t/O0e),r=n*HB;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},N0e={draw(e,t){const n=ca(t),r=-n/2;e.rect(r,r,n,n)}},M0e=.8908130915292852,KB=Zm(Xm/10)/Zm(7*Xm/10),P0e=Zm(Qm/10)*KB,k0e=-FB(Qm/10)*KB,A0e={draw(e,t){const n=ca(t*M0e),r=P0e*n,a=k0e*n;e.moveTo(0,-n),e.lineTo(r,a);for(let o=1;o<5;++o){const i=Qm*o/5,s=FB(i),c=Zm(i);e.lineTo(c*n,-s*n),e.lineTo(s*r-c*a,c*r+s*a)}e.closePath()}},eE=ca(3),T0e={draw(e,t){const n=-ca(t/(eE*3));e.moveTo(0,n*2),e.lineTo(-eE*n,-n),e.lineTo(eE*n,-n),e.closePath()}},_r=-.5,jr=ca(3)/2,tE=1/ca(12),I0e=(tE/2+1)*3,R0e={draw(e,t){const n=ca(t/I0e),r=n/2,a=n*tE,o=r,i=n*tE+n,s=-o,c=i;e.moveTo(r,a),e.lineTo(o,i),e.lineTo(s,c),e.lineTo(_r*r-jr*a,jr*r+_r*a),e.lineTo(_r*o-jr*i,jr*o+_r*i),e.lineTo(_r*s-jr*c,jr*s+_r*c),e.lineTo(_r*r+jr*a,_r*a-jr*r),e.lineTo(_r*o+jr*i,_r*i-jr*o),e.lineTo(_r*s+jr*c,_r*c-jr*s),e.closePath()}};function D0e(e,t){let n=null,r=GS(a);e=typeof e=="function"?e:It(e||YS),t=typeof t=="function"?t:It(t===void 0?64:+t);function a(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return a.type=function(o){return arguments.length?(e=typeof o=="function"?o:It(o),a):e},a.size=function(o){return arguments.length?(t=typeof o=="function"?o:It(+o),a):t},a.context=function(o){return arguments.length?(n=o??null,a):n},a}function Ym(){}function ey(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function ZB(e){this._context=e}ZB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ey(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ey(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function L0e(e){return new ZB(e)}function XB(e){this._context=e}XB.prototype={areaStart:Ym,areaEnd:Ym,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ey(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $0e(e){return new XB(e)}function QB(e){this._context=e}QB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:ey(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function F0e(e){return new QB(e)}function GB(e){this._context=e}GB.prototype={areaStart:Ym,areaEnd:Ym,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function B0e(e){return new GB(e)}function JB(e){return e<0?-1:1}function YB(e,t,n){var r=e._x1-e._x0,a=t-e._x1,o=(e._y1-e._y0)/(r||a<0&&-0),i=(n-e._y1)/(a||r<0&&-0),s=(o*a+i*r)/(r+a);return(JB(o)+JB(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(s))||0}function ez(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function nE(e,t,n){var r=e._x0,a=e._y0,o=e._x1,i=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,a+s*t,o-s,i-s*n,o,i)}function ty(e){this._context=e}ty.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:nE(this,this._t0,ez(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,nE(this,ez(this,n=YB(this,e,t)),n);break;default:nE(this,this._t0,n=YB(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function tz(e){this._context=new nz(e)}(tz.prototype=Object.create(ty.prototype)).point=function(e,t){ty.prototype.point.call(this,t,e)};function nz(e){this._context=e}nz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,o){this._context.bezierCurveTo(t,e,r,n,o,a)}};function z0e(e){return new ty(e)}function V0e(e){return new tz(e)}function rz(e){this._context=e}rz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=az(e),a=az(t),o=0,i=1;i<n;++o,++i)this._context.bezierCurveTo(r[0][o],a[0][o],r[1][o],a[1][o],e[i],t[i]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function az(e){var t,n=e.length-1,r,a=new Array(n),o=new Array(n),i=new Array(n);for(a[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,o[n-1]=7,i[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/o[t-1],o[t]-=r,i[t]-=r*i[t-1];for(a[n-1]=i[n-1]/o[n-1],t=n-2;t>=0;--t)a[t]=(i[t]-a[t+1])/o[t];for(o[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-a[t+1];return[a,o]}function W0e(e){return new rz(e)}function ny(e,t){this._context=e,this._t=t}ny.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function U0e(e){return new ny(e,.5)}function q0e(e){return new ny(e,0)}function H0e(e){return new ny(e,1)}function qc(e,t){if((i=e.length)>1)for(var n=1,r,a,o=e[t[0]],i,s=o.length;n<i;++n)for(a=o,o=e[t[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function rE(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function K0e(e,t){return e[t]}function Z0e(e){const t=[];return t.key=e,t}function X0e(){var e=It([]),t=rE,n=qc,r=K0e;function a(o){var i=Array.from(e.apply(this,arguments),Z0e),s,c=i.length,l=-1,u;for(const d of o)for(s=0,++l;s<c;++s)(i[s][l]=[0,+r(d,i[s].key,l,o)]).data=d;for(s=0,u=JS(t(i));s<c;++s)i[u[s]].index=s;return n(i,u),i}return a.keys=function(o){return arguments.length?(e=typeof o=="function"?o:It(Array.from(o)),a):e},a.value=function(o){return arguments.length?(r=typeof o=="function"?o:It(+o),a):r},a.order=function(o){return arguments.length?(t=o==null?rE:typeof o=="function"?o:It(Array.from(o)),a):t},a.offset=function(o){return arguments.length?(n=o??qc,a):n},a}function Q0e(e,t){if((r=e.length)>0){for(var n,r,a=0,o=e[0].length,i;a<o;++a){for(i=n=0;n<r;++n)i+=e[n][a][1]||0;if(i)for(n=0;n<r;++n)e[n][a][1]/=i}qc(e,t)}}function G0e(e,t){if((a=e.length)>0){for(var n=0,r=e[t[0]],a,o=r.length;n<o;++n){for(var i=0,s=0;i<a;++i)s+=e[i][n][1]||0;r[n][1]+=r[n][0]=-s/2}qc(e,t)}}function J0e(e,t){if(!(!((i=e.length)>0)||!((o=(a=e[t[0]]).length)>0))){for(var n=0,r=1,a,o,i;r<o;++r){for(var s=0,c=0,l=0;s<i;++s){for(var u=e[t[s]],d=u[r][1]||0,p=u[r-1][1]||0,f=(d-p)/2,y=0;y<s;++y){var m=e[t[y]],v=m[r][1]||0,b=m[r-1][1]||0;f+=v-b}c+=d,l+=f*d}a[r-1][1]+=a[r-1][0]=n,c&&(n-=l/c)}a[r-1][1]+=a[r-1][0]=n,qc(e,t)}}function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}var Y0e=["type","size","sizeType"];function aE(){return aE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aE.apply(this,arguments)}function oz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function iz(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oz(Object(n),!0).forEach(function(r){ebe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ebe(e,t,n){return t=tbe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tbe(e){var t=nbe(e,"string");return Rd(t)=="symbol"?t:t+""}function nbe(e,t){if(Rd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Rd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rbe(e,t){if(e==null)return{};var n=abe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function abe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var sz={symbolCircle:YS,symbolCross:E0e,symbolDiamond:C0e,symbolSquare:N0e,symbolStar:A0e,symbolTriangle:T0e,symbolWye:R0e},obe=Math.PI/180,ibe=function(e){var t="symbol".concat(Km(e));return sz[t]||YS},sbe=function(e,t,n){if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*obe;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.pow(Math.tan(r),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},cbe=function(e,t){sz["symbol".concat(Km(e))]=t},oE=function(e){var t=e.type,n=t===void 0?"circle":t,r=e.size,a=r===void 0?64:r,o=e.sizeType,i=o===void 0?"area":o,s=rbe(e,Y0e),c=iz(iz({},s),{},{type:n,size:a,sizeType:i}),l=function(){var y=ibe(n),m=D0e().type(y).size(sbe(a,i,n));return m()},u=c.className,d=c.cx,p=c.cy,f=yt(c,!0);return d===+d&&p===+p&&a===+a?U.createElement("path",aE({},f,{className:xt("recharts-symbols",u),transform:"translate(".concat(d,", ").concat(p,")"),d:l()})):null};oE.registerSymbol=cbe;function Hc(e){"@babel/helpers - typeof";return Hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hc(e)}function iE(){return iE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iE.apply(this,arguments)}function cz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function lbe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cz(Object(n),!0).forEach(function(r){Dd(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ube(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dbe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uz(r.key),r)}}function pbe(e,t,n){return t&&dbe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function fbe(e,t,n){return t=ry(t),hbe(e,lz()?Reflect.construct(t,n||[],ry(e).constructor):t.apply(e,n))}function hbe(e,t){if(t&&(Hc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mbe(e)}function mbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lz(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lz=function(){return!!e})()}function ry(e){return ry=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ry(e)}function ybe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sE(e,t)}function sE(e,t){return sE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},sE(e,t)}function Dd(e,t,n){return t=uz(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uz(e){var t=gbe(e,"string");return Hc(t)=="symbol"?t:t+""}function gbe(e,t){if(Hc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Hc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sr=32,cE=function(e){function t(){return ube(this,t),fbe(this,t,arguments)}return ybe(t,e),pbe(t,[{key:"renderIcon",value:function(n){var r=this.props.inactiveColor,a=Sr/2,o=Sr/6,i=Sr/3,s=n.inactive?r:n.color;if(n.type==="plainline")return U.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:a,x2:Sr,y2:a,className:"recharts-legend-icon"});if(n.type==="line")return U.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(a,"h").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*i,",").concat(a,`
            H`).concat(Sr,"M").concat(2*i,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(i,",").concat(a),className:"recharts-legend-icon"});if(n.type==="rect")return U.createElement("path",{stroke:"none",fill:s,d:"M0,".concat(Sr/8,"h").concat(Sr,"v").concat(Sr*3/4,"h").concat(-Sr,"z"),className:"recharts-legend-icon"});if(U.isValidElement(n.legendIcon)){var c=lbe({},n);return delete c.legendIcon,U.cloneElement(n.legendIcon,c)}return U.createElement(oE,{fill:s,cx:a,cy:a,size:Sr,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,r=this.props,a=r.payload,o=r.iconSize,i=r.layout,s=r.formatter,c=r.inactiveColor,l={x:0,y:0,width:Sr,height:Sr},u={display:i==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(p,f){var y=p.formatter||s,m=xt(Dd(Dd({"recharts-legend-item":!0},"legend-item-".concat(f),!0),"inactive",p.inactive));if(p.type==="none")return null;var v=tt(p.value)?null:p.value;Mo(!tt(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=p.inactive?c:p.color;return U.createElement("li",iE({className:m,style:u,key:"legend-item-".concat(f)},Hm(n.props,p,f)),U.createElement(BS,{width:o,height:o,viewBox:l,style:d},n.renderIcon(p)),U.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},y?y(v,p,f):v))})}},{key:"render",value:function(){var n=this.props,r=n.payload,a=n.layout,o=n.align;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return U.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(g.PureComponent);Dd(cE,"displayName","Legend"),Dd(cE,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var lE,dz;function pz(){if(dz)return lE;dz=1;function e(t,n,r,a){for(var o=t.length,i=r+(a?1:-1);a?i--:++i<o;)if(n(t[i],i,t))return i;return-1}return lE=e,lE}var uE,fz;function vbe(){if(fz)return uE;fz=1;function e(t){return t!==t}return uE=e,uE}var dE,hz;function bbe(){if(hz)return dE;hz=1;function e(t,n,r){for(var a=r-1,o=t.length;++a<o;)if(t[a]===n)return a;return-1}return dE=e,dE}var pE,mz;function wbe(){if(mz)return pE;mz=1;var e=pz(),t=vbe(),n=bbe();function r(a,o,i){return o===o?n(a,o,i):e(a,t,i)}return pE=r,pE}var fE,yz;function xbe(){if(yz)return fE;yz=1;var e=wbe();function t(n,r){var a=n==null?0:n.length;return!!a&&e(n,r,0)>-1}return fE=t,fE}var hE,gz;function _be(){if(gz)return hE;gz=1;function e(t,n,r){for(var a=-1,o=t==null?0:t.length;++a<o;)if(r(n,t[a]))return!0;return!1}return hE=e,hE}var mE,vz;function jbe(){if(vz)return mE;vz=1;function e(){}return mE=e,mE}var yE,bz;function Sbe(){if(bz)return yE;bz=1;var e=xR(),t=jbe(),n=Ew(),r=1/0,a=e&&1/n(new e([,-0]))[1]==r?function(o){return new e(o)}:t;return yE=a,yE}var gE,wz;function Ebe(){if(wz)return gE;wz=1;var e=PI(),t=xbe(),n=_be(),r=II(),a=Sbe(),o=Ew(),i=200;function s(c,l,u){var d=-1,p=t,f=c.length,y=!0,m=[],v=m;if(u)y=!1,p=n;else if(f>=i){var b=l?null:a(c);if(b)return o(b);y=!1,p=r,v=new e}else v=l?[]:m;e:for(;++d<f;){var w=c[d],_=l?l(w):w;if(w=u||w!==0?w:0,y&&_===_){for(var x=v.length;x--;)if(v[x]===_)continue e;l&&v.push(_),m.push(w)}else p(v,_,u)||(v!==m&&v.push(_),m.push(w))}return m}return gE=s,gE}var vE,xz;function Obe(){if(xz)return vE;xz=1;var e=_a(),t=Ebe();function n(r,a){return r&&r.length?t(r,e(a,2)):[]}return vE=n,vE}var Cbe=Obe();const _z=ot(Cbe);function jz(e,t,n){return t===!0?_z(e,n):tt(t)?_z(e,t):e}function Kc(e){"@babel/helpers - typeof";return Kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kc(e)}var Nbe=["ref"];function Sz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Po(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Sz(Object(n),!0).forEach(function(r){oy(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Mbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ez(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Cz(r.key),r)}}function Pbe(e,t,n){return t&&Ez(e.prototype,t),n&&Ez(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kbe(e,t,n){return t=ay(t),Abe(e,Oz()?Reflect.construct(t,n||[],ay(e).constructor):t.apply(e,n))}function Abe(e,t){if(t&&(Kc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tbe(e)}function Tbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oz(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Oz=function(){return!!e})()}function ay(e){return ay=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ay(e)}function Ibe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bE(e,t)}function bE(e,t){return bE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},bE(e,t)}function oy(e,t,n){return t=Cz(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cz(e){var t=Rbe(e,"string");return Kc(t)=="symbol"?t:t+""}function Rbe(e,t){if(Kc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Kc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dbe(e,t){if(e==null)return{};var n=Lbe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Lbe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function $be(e){return e.value}function Fbe(e,t){if(U.isValidElement(e))return U.cloneElement(e,t);if(typeof e=="function")return U.createElement(e,t);t.ref;var n=Dbe(t,Nbe);return U.createElement(cE,n)}var Nz=1,Zc=function(e){function t(){var n;Mbe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=kbe(this,t,[].concat(a)),oy(n,"lastBoundingBox",{width:-1,height:-1}),n}return Ibe(t,e),Pbe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,r=this.getBBox();r?(Math.abs(r.width-this.lastBoundingBox.width)>Nz||Math.abs(r.height-this.lastBoundingBox.height)>Nz)&&(this.lastBoundingBox.width=r.width,this.lastBoundingBox.height=r.height,n&&n(r)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Po({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var r=this.props,a=r.layout,o=r.align,i=r.verticalAlign,s=r.margin,c=r.chartWidth,l=r.chartHeight,u,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&a==="vertical"){var p=this.getBBoxSnapshot();u={left:((c||0)-p.width)/2}}else u=o==="right"?{right:s&&s.right||0}:{left:s&&s.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var f=this.getBBoxSnapshot();d={top:((l||0)-f.height)/2}}else d=i==="bottom"?{bottom:s&&s.bottom||0}:{top:s&&s.top||0};return Po(Po({},u),d)}},{key:"render",value:function(){var n=this,r=this.props,a=r.content,o=r.width,i=r.height,s=r.wrapperStyle,c=r.payloadUniqBy,l=r.payload,u=Po(Po({position:"absolute",width:o||"auto",height:i||"auto"},this.getDefaultPosition(s)),s);return U.createElement("div",{className:"recharts-legend-wrapper",style:u,ref:function(d){n.wrapperNode=d}},Fbe(a,Po(Po({},this.props),{},{payload:jz(l,c,$be)})))}}],[{key:"getWithHeight",value:function(n,r){var a=Po(Po({},this.defaultProps),n.props),o=a.layout;return o==="vertical"&&ye(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||r}:null}}])}(g.PureComponent);oy(Zc,"displayName","Legend"),oy(Zc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var wE,Mz;function Bbe(){if(Mz)return wE;Mz=1;var e=Ps(),t=$p(),n=In(),r=e?e.isConcatSpreadable:void 0;function a(o){return n(o)||t(o)||!!(r&&o&&o[r])}return wE=a,wE}var xE,Pz;kg=function(){if(Pz)return xE;Pz=1;var e=Nw(),t=Bbe();function n(r,a,o,i,s){var c=-1,l=r.length;for(o||(o=t),s||(s=[]);++c<l;){var u=r[c];a>0&&o(u)?a>1?n(u,a-1,o,i,s):e(s,u):i||(s[s.length]=u)}return s}return xE=n,xE};var _E,kz;function zbe(){if(kz)return _E;kz=1;function e(t){return function(n,r,a){for(var o=-1,i=Object(n),s=a(n),c=s.length;c--;){var l=s[t?c:++o];if(r(i[l],l,i)===!1)break}return n}}return _E=e,_E}var jE,Az;kN=function(){if(Az)return jE;Az=1;var e=zbe(),t=e();return jE=t,jE};var SE,Tz;function Iz(){if(Tz)return SE;Tz=1;var e=kN(),t=zl();function n(r,a){return r&&e(r,a,t)}return SE=n,SE}var EE,Rz;function Vbe(){if(Rz)return EE;Rz=1;var e=Ni();function t(n,r){return function(a,o){if(a==null)return a;if(!e(a))return n(a,o);for(var i=a.length,s=r?i:-1,c=Object(a);(r?s--:++s<i)&&o(c[s],s,c)!==!1;);return a}}return EE=t,EE}var OE,Dz;function CE(){if(Dz)return OE;Dz=1;var e=Iz(),t=Vbe(),n=t(e);return OE=n,OE}var NE,Lz;function $z(){if(Lz)return NE;Lz=1;var e=CE(),t=Ni();function n(r,a){var o=-1,i=t(r)?Array(r.length):[];return e(r,function(s,c,l){i[++o]=a(s,c,l)}),i}return NE=n,NE}var ME,Fz;function Wbe(){if(Fz)return ME;Fz=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return ME=e,ME}var PE,Bz;function Ube(){if(Bz)return PE;Bz=1;var e=Gs();function t(n,r){if(n!==r){var a=n!==void 0,o=n===null,i=n===n,s=e(n),c=r!==void 0,l=r===null,u=r===r,d=e(r);if(!l&&!d&&!s&&n>r||s&&c&&u&&!l&&!d||o&&c&&u||!a&&u||!i)return 1;if(!o&&!s&&!d&&n<r||d&&a&&i&&!o&&!s||l&&a&&i||!c&&i||!u)return-1}return 0}return PE=t,PE}var kE,zz;function qbe(){if(zz)return kE;zz=1;var e=Ube();function t(n,r,a){for(var o=-1,i=n.criteria,s=r.criteria,c=i.length,l=a.length;++o<c;){var u=e(i[o],s[o]);if(u){if(o>=l)return u;var d=a[o];return u*(d=="desc"?-1:1)}}return n.index-r.index}return kE=t,kE}var AE,Vz;function Hbe(){if(Vz)return AE;Vz=1;var e=Il(),t=Ul(),n=_a(),r=$z(),a=Wbe(),o=Mv(),i=qbe(),s=Js(),c=In();function l(u,d,p){d.length?d=e(d,function(m){return c(m)?function(v){return t(v,m.length===1?m[0]:m)}:m}):d=[s];var f=-1;d=e(d,o(n));var y=r(u,function(m,v,b){var w=e(d,function(_){return _(m)});return{criteria:w,index:++f,value:m}});return a(y,function(m,v){return i(m,v,p)})}return AE=l,AE}var TE,Wz;FN=function(){if(Wz)return TE;Wz=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return TE=e,TE};var IE,Uz;PN=function(){if(Uz)return IE;Uz=1;var e=FN(),t=Math.max;function n(r,a,o){return a=t(a===void 0?r.length-1:a,0),function(){for(var i=arguments,s=-1,c=t(i.length-a,0),l=Array(c);++s<c;)l[s]=i[a+s];s=-1;for(var u=Array(a+1);++s<a;)u[s]=i[s];return u[a]=o(l),e(r,this,u)}}return IE=n,IE};var RE,qz;function Kbe(){if(qz)return RE;qz=1;function e(t){return function(){return t}}return RE=e,RE}var DE,Hz;function Zbe(){if(Hz)return DE;Hz=1;var e=Kbe(),t=oD(),n=Js(),r=t?function(a,o){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:n;return DE=r,DE}var LE,Kz;function Xbe(){if(Kz)return LE;Kz=1;var e=800,t=16,n=Date.now;function r(a){var o=0,i=0;return function(){var s=n(),c=t-(s-i);if(i=s,c>0){if(++o>=e)return arguments[0]}else o=0;return a.apply(void 0,arguments)}}return LE=r,LE}var $E,Zz;MN=function(){if(Zz)return $E;Zz=1;var e=Zbe(),t=Xbe(),n=t(e);return $E=n,$E};var FE,Xz;AN=function(){if(Xz)return FE;Xz=1;var e=Js(),t=PN(),n=MN();function r(a,o){return n(t(a,o,e),a+"")}return FE=r,FE};var BE,Qz;function Qbe(){if(Qz)return BE;Qz=1;var e=kg(),t=Hbe(),n=AN(),r=Ss(),a=n(function(o,i){if(o==null)return[];var s=i.length;return s>1&&r(o,i[0],i[1])?i=[]:s>2&&r(i[0],i[1],i[2])&&(i=[i[0]]),t(o,e(i,1),[])});return BE=a,BE}var Gbe=Qbe();const zE=ot(Gbe);function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}function VE(){return VE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VE.apply(this,arguments)}function Jbe(e,t){return nwe(e)||twe(e,t)||ewe(e,t)||Ybe()}function Ybe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ewe(e,t){if(e){if(typeof e=="string")return Gz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gz(e,t)}}function Gz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function twe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function nwe(e){if(Array.isArray(e))return e}function Jz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function WE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Jz(Object(n),!0).forEach(function(r){rwe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function rwe(e,t,n){return t=awe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function awe(e){var t=owe(e,"string");return Ld(t)=="symbol"?t:t+""}function owe(e,t){if(Ld(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ld(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iwe(e){return Array.isArray(e)&&on(e[0])&&on(e[1])?e.join(" ~ "):e}var swe=function(e){var t=e.separator,n=t===void 0?" : ":t,r=e.contentStyle,a=r===void 0?{}:r,o=e.itemStyle,i=o===void 0?{}:o,s=e.labelStyle,c=s===void 0?{}:s,l=e.payload,u=e.formatter,d=e.itemSorter,p=e.wrapperClassName,f=e.labelClassName,y=e.label,m=e.labelFormatter,v=e.accessibilityLayer,b=v===void 0?!1:v,w=function(){if(l&&l.length){var M={padding:0,margin:0},P=(d?zE(l,d):l).map(function(I,k){if(I.type==="none")return null;var C=WE({display:"block",paddingTop:4,paddingBottom:4,color:I.color||"#000"},i),T=I.formatter||u||iwe,A=I.value,R=I.name,L=A,D=R;if(T&&L!=null&&D!=null){var B=T(A,R,I,k,l);if(Array.isArray(B)){var F=Jbe(B,2);L=F[0],D=F[1]}else L=B}return U.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(k),style:C},on(D)?U.createElement("span",{className:"recharts-tooltip-item-name"},D):null,on(D)?U.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,U.createElement("span",{className:"recharts-tooltip-item-value"},L),U.createElement("span",{className:"recharts-tooltip-item-unit"},I.unit||""))});return U.createElement("ul",{className:"recharts-tooltip-item-list",style:M},P)}return null},_=WE({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),x=WE({margin:0},c),j=!gt(y),S=j?y:"",E=xt("recharts-default-tooltip",p),O=xt("recharts-tooltip-label",f);j&&m&&l!==void 0&&l!==null&&(S=m(y,l));var N=b?{role:"status","aria-live":"assertive"}:{};return U.createElement("div",VE({className:E,style:_},N),U.createElement("p",{className:O,style:x},U.isValidElement(S)?S:"".concat(S)),w())};function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}function iy(e,t,n){return t=cwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cwe(e){var t=lwe(e,"string");return $d(t)=="symbol"?t:t+""}function lwe(e,t){if($d(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($d(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fd="recharts-tooltip-wrapper",uwe={visibility:"hidden"};function dwe(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return xt(Fd,iy(iy(iy(iy({},"".concat(Fd,"-right"),ye(n)&&t&&ye(t.x)&&n>=t.x),"".concat(Fd,"-left"),ye(n)&&t&&ye(t.x)&&n<t.x),"".concat(Fd,"-bottom"),ye(r)&&t&&ye(t.y)&&r>=t.y),"".concat(Fd,"-top"),ye(r)&&t&&ye(t.y)&&r<t.y))}function Yz(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,a=e.offsetTopLeft,o=e.position,i=e.reverseDirection,s=e.tooltipDimension,c=e.viewBox,l=e.viewBoxDimension;if(o&&ye(o[r]))return o[r];var u=n[r]-s-a,d=n[r]+a;if(t[r])return i[r]?u:d;if(i[r]){var p=u,f=c[r];return p<f?Math.max(d,c[r]):Math.max(u,c[r])}var y=d+s,m=c[r]+l;return y>m?Math.max(u,c[r]):Math.max(d,c[r])}function pwe(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function fwe(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,a=e.position,o=e.reverseDirection,i=e.tooltipBox,s=e.useTranslate3d,c=e.viewBox,l,u,d;return i.height>0&&i.width>0&&n?(u=Yz({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),d=Yz({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),l=pwe({translateX:u,translateY:d,useTranslate3d:s})):l=uwe,{cssProperties:l,cssClasses:dwe({translateX:u,translateY:d,coordinate:n})}}function Xc(e){"@babel/helpers - typeof";return Xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xc(e)}function e7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function t7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?e7(Object(n),!0).forEach(function(r){qE(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mwe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r7(r.key),r)}}function ywe(e,t,n){return t&&mwe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gwe(e,t,n){return t=sy(t),vwe(e,n7()?Reflect.construct(t,n||[],sy(e).constructor):t.apply(e,n))}function vwe(e,t){if(t&&(Xc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bwe(e)}function bwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(n7=function(){return!!e})()}function sy(e){return sy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sy(e)}function wwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UE(e,t)}function UE(e,t){return UE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},UE(e,t)}function qE(e,t,n){return t=r7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r7(e){var t=xwe(e,"string");return Xc(t)=="symbol"?t:t+""}function xwe(e,t){if(Xc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Xc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a7=1,_we=function(e){function t(){var n;hwe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=gwe(this,t,[].concat(a)),qE(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),qE(n,"handleKeyDown",function(i){if(i.key==="Escape"){var s,c,l,u;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&s!==void 0?s:0,y:(l=(u=n.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0}})}}),n}return wwe(t,e),ywe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>a7||Math.abs(n.height-this.state.lastBoundingBox.height)>a7)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,r;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.children,l=r.coordinate,u=r.hasPayload,d=r.isAnimationActive,p=r.offset,f=r.position,y=r.reverseDirection,m=r.useTranslate3d,v=r.viewBox,b=r.wrapperStyle,w=fwe({allowEscapeViewBox:o,coordinate:l,offsetTopLeft:p,position:f,reverseDirection:y,tooltipBox:this.state.lastBoundingBox,useTranslate3d:m,viewBox:v}),_=w.cssClasses,x=w.cssProperties,j=t7(t7({transition:d&&a?"transform ".concat(i,"ms ").concat(s):void 0},x),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&u?"visible":"hidden",position:"absolute",top:0,left:0},b);return U.createElement("div",{tabIndex:-1,className:_,style:j,ref:function(S){n.wrapperNode=S}},c)}}])}(g.PureComponent),jwe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},gi={isSsr:jwe(),get:function(e){return gi[e]},set:function(e,t){if(typeof e=="string")gi[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(r){gi[r]=e[r]})}}};function Qc(e){"@babel/helpers - typeof";return Qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qc(e)}function o7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function i7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?o7(Object(n),!0).forEach(function(r){KE(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Swe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ewe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c7(r.key),r)}}function Owe(e,t,n){return t&&Ewe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cwe(e,t,n){return t=cy(t),Nwe(e,s7()?Reflect.construct(t,n||[],cy(e).constructor):t.apply(e,n))}function Nwe(e,t){if(t&&(Qc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mwe(e)}function Mwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s7=function(){return!!e})()}function cy(e){return cy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cy(e)}function Pwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HE(e,t)}function HE(e,t){return HE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},HE(e,t)}function KE(e,t,n){return t=c7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c7(e){var t=kwe(e,"string");return Qc(t)=="symbol"?t:t+""}function kwe(e,t){if(Qc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Qc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Awe(e){return e.dataKey}function Twe(e,t){return U.isValidElement(e)?U.cloneElement(e,t):typeof e=="function"?U.createElement(e,t):U.createElement(swe,t)}var Da=function(e){function t(){return Swe(this,t),Cwe(this,t,arguments)}return Pwe(t,e),Owe(t,[{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.content,l=r.coordinate,u=r.filterNull,d=r.isAnimationActive,p=r.offset,f=r.payload,y=r.payloadUniqBy,m=r.position,v=r.reverseDirection,b=r.useTranslate3d,w=r.viewBox,_=r.wrapperStyle,x=f??[];u&&x.length&&(x=jz(f.filter(function(S){return S.value!=null&&(S.hide!==!0||n.props.includeHidden)}),y,Awe));var j=x.length>0;return U.createElement(_we,{allowEscapeViewBox:o,animationDuration:i,animationEasing:s,isAnimationActive:d,active:a,coordinate:l,hasPayload:j,offset:p,position:m,reverseDirection:v,useTranslate3d:b,viewBox:w,wrapperStyle:_},Twe(c,i7(i7({},this.props),{},{payload:x})))}}])}(g.PureComponent);KE(Da,"displayName","Tooltip"),KE(Da,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!gi.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var ZE,l7;function Iwe(){if(l7)return ZE;l7=1;var e=Ar(),t=function(){return e.Date.now()};return ZE=t,ZE}var XE,u7;DN=function(){if(u7)return XE;u7=1;var e=Tr(),t=Iwe(),n=F$(),r="Expected a function",a=Math.max,o=Math.min;function i(s,c,l){var u,d,p,f,y,m,v=0,b=!1,w=!1,_=!0;if(typeof s!="function")throw new TypeError(r);c=n(c)||0,e(l)&&(b=!!l.leading,w="maxWait"in l,p=w?a(n(l.maxWait)||0,c):p,_="trailing"in l?!!l.trailing:_);function x(k){var C=u,T=d;return u=d=void 0,v=k,f=s.apply(T,C),f}function j(k){return v=k,y=setTimeout(O,c),b?x(k):f}function S(k){var C=k-m,T=k-v,A=c-C;return w?o(A,p-T):A}function E(k){var C=k-m,T=k-v;return m===void 0||C>=c||C<0||w&&T>=p}function O(){var k=t();if(E(k))return N(k);y=setTimeout(O,S(k))}function N(k){return y=void 0,_&&u?x(k):(u=d=void 0,f)}function M(){y!==void 0&&clearTimeout(y),v=0,u=m=d=y=void 0}function P(){return y===void 0?f:N(t())}function I(){var k=t(),C=E(k);if(u=arguments,d=this,m=k,C){if(y===void 0)return j(m);if(w)return clearTimeout(y),y=setTimeout(O,c),x(m)}return y===void 0&&(y=setTimeout(O,c)),f}return I.cancel=M,I.flush=P,I}return XE=i,XE};var QE,d7;function Rwe(){if(d7)return QE;d7=1;var e=DN(),t=Tr(),n="Expected a function";function r(a,o,i){var s=!0,c=!0;if(typeof a!="function")throw new TypeError(n);return t(i)&&(s="leading"in i?!!i.leading:s,c="trailing"in i?!!i.trailing:c),e(a,o,{leading:s,maxWait:o,trailing:c})}return QE=r,QE}var Dwe=Rwe();Ig=ot(Dwe);function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function p7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ly(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?p7(Object(n),!0).forEach(function(r){Lwe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Lwe(e,t,n){return t=$we(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $we(e){var t=Fwe(e,"string");return Bd(t)=="symbol"?t:t+""}function Fwe(e,t){if(Bd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bwe(e,t){return Uwe(e)||Wwe(e,t)||Vwe(e,t)||zwe()}function zwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vwe(e,t){if(e){if(typeof e=="string")return f7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f7(e,t)}}function f7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wwe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function Uwe(e){if(Array.isArray(e))return e}var qwe=g.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,a=r===void 0?{width:-1,height:-1}:r,o=e.width,i=o===void 0?"100%":o,s=e.height,c=s===void 0?"100%":s,l=e.minWidth,u=l===void 0?0:l,d=e.minHeight,p=e.maxHeight,f=e.children,y=e.debounce,m=y===void 0?0:y,v=e.id,b=e.className,w=e.onResize,_=e.style,x=_===void 0?{}:_,j=g.useRef(null),S=g.useRef();S.current=w,g.useImperativeHandle(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var E=g.useState({containerWidth:a.width,containerHeight:a.height}),O=Bwe(E,2),N=O[0],M=O[1],P=g.useCallback(function(k,C){M(function(T){var A=Math.round(k),R=Math.round(C);return T.containerWidth===A&&T.containerHeight===R?T:{containerWidth:A,containerHeight:R}})},[]);g.useEffect(function(){var k=function(L){var D,B=L[0].contentRect,F=B.width,$=B.height;P(F,$),(D=S.current)===null||D===void 0||D.call(S,F,$)};m>0&&(k=Ig(k,m,{trailing:!0,leading:!1}));var C=new ResizeObserver(k),T=j.current.getBoundingClientRect(),A=T.width,R=T.height;return P(A,R),C.observe(j.current),function(){C.disconnect()}},[P,m]);var I=g.useMemo(function(){var k=N.containerWidth,C=N.containerHeight;if(k<0||C<0)return null;Mo(os(i)||os(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),Mo(!n||n>0,"The aspect(%s) must be greater than zero.",n);var T=os(i)?k:i,A=os(c)?C:c;n&&n>0&&(T?A=T/n:A&&(T=A*n),p&&A>p&&(A=p)),Mo(T>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,T,A,i,c,u,d,n);var R=!Array.isArray(f)&&No(f.type).endsWith("Chart");return U.Children.map(f,function(L){return U.isValidElement(L)?g.cloneElement(L,ly({width:T,height:A},R?{style:ly({height:"100%",width:"100%",maxHeight:A,maxWidth:T},L.props.style)}:{})):L})},[n,f,c,p,d,u,N,i]);return U.createElement("div",{id:v?"".concat(v):void 0,className:xt("recharts-responsive-container",b),style:ly(ly({},x),{},{width:i,height:c,minWidth:u,minHeight:d,maxHeight:p}),ref:j},I)}),h7=function(e){return null};h7.displayName="Cell";function zd(e){"@babel/helpers - typeof";return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zd(e)}function m7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function GE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?m7(Object(n),!0).forEach(function(r){Hwe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Hwe(e,t,n){return t=Kwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kwe(e){var t=Zwe(e,"string");return zd(t)=="symbol"?t:t+""}function Zwe(e,t){if(zd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(zd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gc={widthCache:{},cacheCount:0},Xwe=2e3,Qwe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},y7="recharts_measurement_span";function Gwe(e){var t=GE({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var Vd=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||gi.isSsr)return{width:0,height:0};var n=Gwe(t),r=JSON.stringify({text:e,copyStyle:n});if(Gc.widthCache[r])return Gc.widthCache[r];try{var a=document.getElementById(y7);a||(a=document.createElement("span"),a.setAttribute("id",y7),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=GE(GE({},Qwe),n);Object.assign(a.style,o),a.textContent="".concat(e);var i=a.getBoundingClientRect(),s={width:i.width,height:i.height};return Gc.widthCache[r]=s,++Gc.cacheCount>Xwe&&(Gc.cacheCount=0,Gc.widthCache={}),s}catch{return{width:0,height:0}}},Jwe=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function Wd(e){"@babel/helpers - typeof";return Wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wd(e)}function uy(e,t){return nxe(e)||txe(e,t)||exe(e,t)||Ywe()}function Ywe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function exe(e,t){if(e){if(typeof e=="string")return g7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g7(e,t)}}function g7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function txe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function nxe(e){if(Array.isArray(e))return e}function rxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oxe(r.key),r)}}function axe(e,t,n){return t&&v7(e.prototype,t),n&&v7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function oxe(e){var t=ixe(e,"string");return Wd(t)=="symbol"?t:t+""}function ixe(e,t){if(Wd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Wd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var b7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,w7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,sxe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,cxe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,x7={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},lxe=Object.keys(x7),Jc="NaN";function uxe(e,t){return e*x7[t]}var dy=function(){function e(t,n){rxe(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!sxe.test(n)&&(this.num=NaN,this.unit=""),lxe.includes(n)&&(this.num=uxe(t,n),this.unit="px")}return axe(e,[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(t){var n,r=(n=cxe.exec(t))!==null&&n!==void 0?n:[],a=uy(r,3),o=a[1],i=a[2];return new e(parseFloat(o),i??"")}}])}();function _7(e){if(e.includes(Jc))return Jc;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=b7.exec(t))!==null&&n!==void 0?n:[],a=uy(r,4),o=a[1],i=a[2],s=a[3],c=dy.parse(o??""),l=dy.parse(s??""),u=i==="*"?c.multiply(l):c.divide(l);if(u.isNaN())return Jc;t=t.replace(b7,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,p=(d=w7.exec(t))!==null&&d!==void 0?d:[],f=uy(p,4),y=f[1],m=f[2],v=f[3],b=dy.parse(y??""),w=dy.parse(v??""),_=m==="+"?b.add(w):b.subtract(w);if(_.isNaN())return Jc;t=t.replace(w7,_.toString())}return t}var j7=/\(([^()]*)\)/;function dxe(e){for(var t=e;t.includes("(");){var n=j7.exec(t),r=uy(n,2),a=r[1];t=t.replace(j7,_7(a))}return t}function pxe(e){var t=e.replace(/\s+/g,"");return t=dxe(t),t=_7(t),t}function fxe(e){try{return pxe(e)}catch{return Jc}}function JE(e){var t=fxe(e.slice(5,-1));return t===Jc?"":t}var hxe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],mxe=["dx","dy","angle","className","breakAll"];function YE(){return YE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YE.apply(this,arguments)}function S7(e,t){if(e==null)return{};var n=yxe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function yxe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function E7(e,t){return wxe(e)||bxe(e,t)||vxe(e,t)||gxe()}function gxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vxe(e,t){if(e){if(typeof e=="string")return O7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O7(e,t)}}function O7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bxe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function wxe(e){if(Array.isArray(e))return e}var C7=/[ \f\n\r\t\v\u2028\u2029]+/,N7=function(e){var t=e.children,n=e.breakAll,r=e.style;try{var a=[];gt(t)||(n?a=t.toString().split(""):a=t.toString().split(C7));var o=a.map(function(s){return{word:s,width:Vd(s,r).width}}),i=n?0:Vd("\xA0",r).width;return{wordsWithComputedWidth:o,spaceWidth:i}}catch{return null}},xxe=function(e,t,n,r,a){var o=e.maxLines,i=e.children,s=e.style,c=e.breakAll,l=ye(o),u=i,d=function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return k.reduce(function(C,T){var A=T.word,R=T.width,L=C[C.length-1];if(L&&(r==null||a||L.width+R+n<Number(r)))L.words.push(A),L.width+=R+n;else{var D={words:[A],width:R};C.push(D)}return C},[])},p=d(t),f=function(k){return k.reduce(function(C,T){return C.width>T.width?C:T})};if(!l)return p;for(var y="\u2026",m=function(k){var C=u.slice(0,k),T=N7({breakAll:c,style:s,children:C+y}).wordsWithComputedWidth,A=d(T),R=A.length>o||f(A).width>Number(r);return[R,A]},v=0,b=u.length-1,w=0,_;v<=b&&w<=u.length-1;){var x=Math.floor((v+b)/2),j=x-1,S=m(j),E=E7(S,2),O=E[0],N=E[1],M=m(x),P=E7(M,1),I=P[0];if(!O&&!I&&(v=x+1),O&&I&&(b=x-1),!O&&I){_=N;break}w++}return _||p},M7=function(e){var t=gt(e)?[]:e.toString().split(C7);return[{words:t}]},_xe=function(e){var t=e.width,n=e.scaleToFit,r=e.children,a=e.style,o=e.breakAll,i=e.maxLines;if((t||n)&&!gi.isSsr){var s,c,l=N7({breakAll:o,children:r,style:a});if(l){var u=l.wordsWithComputedWidth,d=l.spaceWidth;s=u,c=d}else return M7(r);return xxe({breakAll:o,children:r,maxLines:i,style:a},s,c,t,n)}return M7(r)},P7="#808080",py=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.lineHeight,i=o===void 0?"1em":o,s=e.capHeight,c=s===void 0?"0.71em":s,l=e.scaleToFit,u=l===void 0?!1:l,d=e.textAnchor,p=d===void 0?"start":d,f=e.verticalAnchor,y=f===void 0?"end":f,m=e.fill,v=m===void 0?P7:m,b=S7(e,hxe),w=g.useMemo(function(){return _xe({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:u,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,u,b.style,b.width]),_=b.dx,x=b.dy,j=b.angle,S=b.className,E=b.breakAll,O=S7(b,mxe);if(!on(n)||!on(a))return null;var N=n+(ye(_)?_:0),M=a+(ye(x)?x:0),P;switch(y){case"start":P=JE("calc(".concat(c,")"));break;case"middle":P=JE("calc(".concat((w.length-1)/2," * -").concat(i," + (").concat(c," / 2))"));break;default:P=JE("calc(".concat(w.length-1," * -").concat(i,")"));break}var I=[];if(u){var k=w[0].width,C=b.width;I.push("scale(".concat((ye(C)?C/k:1)/k,")"))}return j&&I.push("rotate(".concat(j,", ").concat(N,", ").concat(M,")")),I.length&&(O.transform=I.join(" ")),U.createElement("text",YE({},yt(O,!0),{x:N,y:M,className:xt("recharts-text",S),textAnchor:p,fill:v.includes("url")?P7:v}),w.map(function(T,A){var R=T.words.join(E?"":" ");return U.createElement("tspan",{x:N,dy:A===0?P:i,key:"".concat(R,"-").concat(A)},R)}))};function vi(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function jxe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function eO(e){let t,n,r;e.length!==2?(t=vi,n=(s,c)=>vi(e(s),c),r=(s,c)=>e(s)-c):(t=e===vi||e===jxe?e:Sxe,n=e,r=e);function a(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<0?l=d+1:u=d}while(l<u)}return l}function o(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<=0?l=d+1:u=d}while(l<u)}return l}function i(s,c,l=0,u=s.length){const d=a(s,c,l,u-1);return d>l&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:a,center:i,right:o}}function Sxe(){return 0}function k7(e){return e===null?NaN:+e}function*Exe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const Oxe=eO(vi),Ud=Oxe.right;eO(k7).center;class A7 extends Map{constructor(t,n=Mxe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,a]of t)this.set(r,a)}get(t){return super.get(T7(this,t))}has(t){return super.has(T7(this,t))}set(t,n){return super.set(Cxe(this,t),n)}delete(t){return super.delete(Nxe(this,t))}}function T7({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Cxe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Nxe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function Mxe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Pxe(e=vi){if(e===vi)return I7;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function I7(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const kxe=Math.sqrt(50),Axe=Math.sqrt(10),Txe=Math.sqrt(2);function fy(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),o=r/Math.pow(10,a),i=o>=kxe?10:o>=Axe?5:o>=Txe?2:1;let s,c,l;return a<0?(l=Math.pow(10,-a)/i,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=Math.pow(10,a)*i,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?fy(e,t,n*2):[s,c,l]}function tO(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,o,i]=r?fy(t,e,n):fy(e,t,n);if(!(o>=a))return[];const s=o-a+1,c=new Array(s);if(r)if(i<0)for(let l=0;l<s;++l)c[l]=(o-l)/-i;else for(let l=0;l<s;++l)c[l]=(o-l)*i;else if(i<0)for(let l=0;l<s;++l)c[l]=(a+l)/-i;else for(let l=0;l<s;++l)c[l]=(a+l)*i;return c}function nO(e,t,n){return t=+t,e=+e,n=+n,fy(e,t,n)[2]}function rO(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?nO(t,e,n):nO(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function R7(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function D7(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function L7(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=a===void 0?I7:Pxe(a);r>n;){if(r-n>600){const c=r-n+1,l=t-n+1,u=Math.log(c),d=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*d*(c-d)/c)*(l-c/2<0?-1:1),f=Math.max(n,Math.floor(t-l*d/c+p)),y=Math.min(r,Math.floor(t+(c-l)*d/c+p));L7(e,t,f,y,a)}const o=e[t];let i=n,s=r;for(qd(e,n,t),a(e[r],o)>0&&qd(e,n,r);i<s;){for(qd(e,i,s),++i,--s;a(e[i],o)<0;)++i;for(;a(e[s],o)>0;)--s}a(e[n],o)===0?qd(e,n,s):(++s,qd(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function qd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Ixe(e,t,n){if(e=Float64Array.from(Exe(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return D7(e);if(t>=1)return R7(e);var r,a=(r-1)*t,o=Math.floor(a),i=R7(L7(e,o).subarray(0,o+1)),s=D7(e.subarray(o+1));return i+(s-i)*(a-o)}}function Rxe(e,t,n=k7){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,o=Math.floor(a),i=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return i+(s-i)*(a-o)}}function Dxe(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(a);++r<a;)o[r]=e+r*n;return o}function Er(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ko(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const aO=Symbol("implicit");function oO(){var e=new A7,t=[],n=[],r=aO;function a(o){let i=e.get(o);if(i===void 0){if(r!==aO)return r;e.set(o,i=t.push(o)-1)}return n[i%n.length]}return a.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new A7;for(const i of o)e.has(i)||e.set(i,t.push(i)-1);return a},a.range=function(o){return arguments.length?(n=Array.from(o),a):n.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return oO(t,n).unknown(r)},Er.apply(a,arguments),a}function Hd(){var e=oO().unknown(void 0),t=e.domain,n=e.range,r=0,a=1,o,i,s=!1,c=0,l=0,u=.5;delete e.unknown;function d(){var p=t().length,f=a<r,y=f?a:r,m=f?r:a;o=(m-y)/Math.max(1,p-c+l*2),s&&(o=Math.floor(o)),y+=(m-y-o*(p-c))*u,i=o*(1-c),s&&(y=Math.round(y),i=Math.round(i));var v=Dxe(p).map(function(b){return y+o*b});return n(f?v.reverse():v)}return e.domain=function(p){return arguments.length?(t(p),d()):t()},e.range=function(p){return arguments.length?([r,a]=p,r=+r,a=+a,d()):[r,a]},e.rangeRound=function(p){return[r,a]=p,r=+r,a=+a,s=!0,d()},e.bandwidth=function(){return i},e.step=function(){return o},e.round=function(p){return arguments.length?(s=!!p,d()):s},e.padding=function(p){return arguments.length?(c=Math.min(1,l=+p),d()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),d()):c},e.paddingOuter=function(p){return arguments.length?(l=+p,d()):l},e.align=function(p){return arguments.length?(u=Math.max(0,Math.min(1,p)),d()):u},e.copy=function(){return Hd(t(),[r,a]).round(s).paddingInner(c).paddingOuter(l).align(u)},Er.apply(d(),arguments)}function $7(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return $7(t())},e}function Kd(){return $7(Hd.apply(null,arguments).paddingInner(1))}function Lxe(e){return function(){return e}}function hy(e){return+e}var F7=[0,1];function Bn(e){return e}function iO(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Lxe(isNaN(t)?NaN:.5)}function $xe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Fxe(e,t,n){var r=e[0],a=e[1],o=t[0],i=t[1];return a<r?(r=iO(a,r),o=n(i,o)):(r=iO(r,a),o=n(o,i)),function(s){return o(r(s))}}function Bxe(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),o=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)a[i]=iO(e[i],e[i+1]),o[i]=n(t[i],t[i+1]);return function(s){var c=Ud(e,s,1,r)-1;return o[c](a[c](s))}}function Zd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function my(){var e=F7,t=F7,n=nc,r,a,o,i=Bn,s,c,l;function u(){var p=Math.min(e.length,t.length);return i!==Bn&&(i=$xe(e[0],e[p-1])),s=p>2?Bxe:Fxe,c=l=null,d}function d(p){return p==null||isNaN(p=+p)?o:(c||(c=s(e.map(r),t,n)))(r(i(p)))}return d.invert=function(p){return i(a((l||(l=s(t,e.map(r),Ur)))(p)))},d.domain=function(p){return arguments.length?(e=Array.from(p,hy),u()):e.slice()},d.range=function(p){return arguments.length?(t=Array.from(p),u()):t.slice()},d.rangeRound=function(p){return t=Array.from(p),n=s1,u()},d.clamp=function(p){return arguments.length?(i=p?!0:Bn,u()):i!==Bn},d.interpolate=function(p){return arguments.length?(n=p,u()):n},d.unknown=function(p){return arguments.length?(o=p,d):o},function(p,f){return r=p,a=f,u()}}function sO(){return my()(Bn,Bn)}function zxe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function yy(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Yc(e){return e=yy(Math.abs(e)),e?e[1]:NaN}function Vxe(e,t){return function(n,r){for(var a=n.length,o=[],i=0,s=e[0],c=0;a>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(n.substring(a-=s,a+s)),!((c+=s+1)>r));)s=e[i=(i+1)%e.length];return o.reverse().join(t)}}function Wxe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Uxe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Xd(e){if(!(t=Uxe.exec(e)))throw new Error("invalid format: "+e);var t;return new cO({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Xd.prototype=cO.prototype;function cO(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}cO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function qxe(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var B7;function Hxe(e,t){var n=yy(e,t);if(!n)return e+"";var r=n[0],a=n[1],o=a-(B7=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+yy(e,Math.max(0,t+o-1))[0]}function z7(e,t){var n=yy(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const V7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:zxe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>z7(e*100,t),r:z7,s:Hxe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function W7(e){return e}var U7=Array.prototype.map,q7=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Kxe(e){var t=e.grouping===void 0||e.thousands===void 0?W7:Vxe(U7.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?W7:Wxe(U7.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(d){d=Xd(d);var p=d.fill,f=d.align,y=d.sign,m=d.symbol,v=d.zero,b=d.width,w=d.comma,_=d.precision,x=d.trim,j=d.type;j==="n"?(w=!0,j="g"):V7[j]||(_===void 0&&(_=12),x=!0,j="g"),(v||p==="0"&&f==="=")&&(v=!0,p="0",f="=");var S=m==="$"?n:m==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",E=m==="$"?r:/[%p]/.test(j)?i:"",O=V7[j],N=/[defgprs%]/.test(j);_=_===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function M(P){var I=S,k=E,C,T,A;if(j==="c")k=O(P)+k,P="";else{P=+P;var R=P<0||1/P<0;if(P=isNaN(P)?c:O(Math.abs(P),_),x&&(P=qxe(P)),R&&+P==0&&y!=="+"&&(R=!1),I=(R?y==="("?y:s:y==="-"||y==="("?"":y)+I,k=(j==="s"?q7[8+B7/3]:"")+k+(R&&y==="("?")":""),N){for(C=-1,T=P.length;++C<T;)if(A=P.charCodeAt(C),48>A||A>57){k=(A===46?a+P.slice(C+1):P.slice(C))+k,P=P.slice(0,C);break}}}w&&!v&&(P=t(P,1/0));var L=I.length+P.length+k.length,D=L<b?new Array(b-L+1).join(p):"";switch(w&&v&&(P=t(D+P,D.length?b-k.length:1/0),D=""),f){case"<":P=I+P+k+D;break;case"=":P=I+D+P+k;break;case"^":P=D.slice(0,L=D.length>>1)+I+P+k+D.slice(L);break;default:P=D+I+P+k;break}return o(P)}return M.toString=function(){return d+""},M}function u(d,p){var f=l((d=Xd(d),d.type="f",d)),y=Math.max(-8,Math.min(8,Math.floor(Yc(p)/3)))*3,m=Math.pow(10,-y),v=q7[8+y/3];return function(b){return f(m*b)+v}}return{format:l,formatPrefix:u}}var gy,lO,H7;Zxe({thousands:",",grouping:[3],currency:["$",""]});function Zxe(e){return gy=Kxe(e),lO=gy.format,H7=gy.formatPrefix,gy}function Xxe(e){return Math.max(0,-Yc(Math.abs(e)))}function Qxe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Yc(t)/3)))*3-Yc(Math.abs(e)))}function Gxe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Yc(t)-Yc(e))+1}function K7(e,t,n,r){var a=rO(e,t,n),o;switch(r=Xd(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=Qxe(a,i))&&(r.precision=o),H7(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Gxe(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Xxe(a))&&(r.precision=o-(r.type==="%")*2);break}}return lO(r)}function bi(e){var t=e.domain;return e.ticks=function(n){var r=t();return tO(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return K7(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,o=r.length-1,i=r[a],s=r[o],c,l,u=10;for(s<i&&(l=i,i=s,s=l,l=a,a=o,o=l);u-- >0;){if(l=nO(i,s,n),l===c)return r[a]=i,r[o]=s,t(r);if(l>0)i=Math.floor(i/l)*l,s=Math.ceil(s/l)*l;else if(l<0)i=Math.ceil(i*l)/l,s=Math.floor(s*l)/l;else break;c=l}return e},e}function vy(){var e=sO();return e.copy=function(){return Zd(e,vy())},Er.apply(e,arguments),bi(e)}function Z7(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,hy),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Z7(e).unknown(t)},e=arguments.length?Array.from(e,hy):[0,1],bi(n)}function X7(e,t){e=e.slice();var n=0,r=e.length-1,a=e[n],o=e[r],i;return o<a&&(i=n,n=r,r=i,i=a,a=o,o=i),e[n]=t.floor(a),e[r]=t.ceil(o),e}function Q7(e){return Math.log(e)}function G7(e){return Math.exp(e)}function Jxe(e){return-Math.log(-e)}function Yxe(e){return-Math.exp(-e)}function e1e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function t1e(e){return e===10?e1e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function n1e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function J7(e){return(t,n)=>-e(-t,n)}function uO(e){const t=e(Q7,G7),n=t.domain;let r=10,a,o;function i(){return a=n1e(r),o=t1e(r),n()[0]<0?(a=J7(a),o=J7(o),e(Jxe,Yxe)):e(Q7,G7),t}return t.base=function(s){return arguments.length?(r=+s,i()):r},t.domain=function(s){return arguments.length?(n(s),i()):n()},t.ticks=s=>{const c=n();let l=c[0],u=c[c.length-1];const d=u<l;d&&([l,u]=[u,l]);let p=a(l),f=a(u),y,m;const v=s==null?10:+s;let b=[];if(!(r%1)&&f-p<v){if(p=Math.floor(p),f=Math.ceil(f),l>0){for(;p<=f;++p)for(y=1;y<r;++y)if(m=p<0?y/o(-p):y*o(p),!(m<l)){if(m>u)break;b.push(m)}}else for(;p<=f;++p)for(y=r-1;y>=1;--y)if(m=p>0?y/o(-p):y*o(p),!(m<l)){if(m>u)break;b.push(m)}b.length*2<v&&(b=tO(l,u,v))}else b=tO(p,f,Math.min(f-p,v)).map(o);return d?b.reverse():b},t.tickFormat=(s,c)=>{if(s==null&&(s=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=Xd(c)).precision==null&&(c.trim=!0),c=lO(c)),s===1/0)return c;const l=Math.max(1,r*s/t.ticks().length);return u=>{let d=u/o(Math.round(a(u)));return d*r<r-.5&&(d*=r),d<=l?c(u):""}},t.nice=()=>n(X7(n(),{floor:s=>o(Math.floor(a(s))),ceil:s=>o(Math.ceil(a(s)))})),t}function Y7(){const e=uO(my()).domain([1,10]);return e.copy=()=>Zd(e,Y7()).base(e.base()),Er.apply(e,arguments),e}function eV(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function tV(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function dO(e){var t=1,n=e(eV(t),tV(t));return n.constant=function(r){return arguments.length?e(eV(t=+r),tV(t)):t},bi(n)}function nV(){var e=dO(my());return e.copy=function(){return Zd(e,nV()).constant(e.constant())},Er.apply(e,arguments)}function rV(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function r1e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function a1e(e){return e<0?-e*e:e*e}function pO(e){var t=e(Bn,Bn),n=1;function r(){return n===1?e(Bn,Bn):n===.5?e(r1e,a1e):e(rV(n),rV(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,r()):n},bi(t)}function fO(){var e=pO(my());return e.copy=function(){return Zd(e,fO()).exponent(e.exponent())},Er.apply(e,arguments),e}function o1e(){return fO.apply(null,arguments).exponent(.5)}function aV(e){return Math.sign(e)*e*e}function i1e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function oV(){var e=sO(),t=[0,1],n=!1,r;function a(o){var i=i1e(e(o));return isNaN(i)?r:n?Math.round(i):i}return a.invert=function(o){return e.invert(aV(o))},a.domain=function(o){return arguments.length?(e.domain(o),a):e.domain()},a.range=function(o){return arguments.length?(e.range((t=Array.from(o,hy)).map(aV)),a):t.slice()},a.rangeRound=function(o){return a.range(o).round(!0)},a.round=function(o){return arguments.length?(n=!!o,a):n},a.clamp=function(o){return arguments.length?(e.clamp(o),a):e.clamp()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return oV(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},Er.apply(a,arguments),bi(a)}function iV(){var e=[],t=[],n=[],r;function a(){var i=0,s=Math.max(1,t.length);for(n=new Array(s-1);++i<s;)n[i-1]=Rxe(e,i/s);return o}function o(i){return i==null||isNaN(i=+i)?r:t[Ud(n,i)]}return o.invertExtent=function(i){var s=t.indexOf(i);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(vi),a()},o.range=function(i){return arguments.length?(t=Array.from(i),a()):t.slice()},o.unknown=function(i){return arguments.length?(r=i,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return iV().domain(e).range(t).unknown(r)},Er.apply(o,arguments)}function sV(){var e=0,t=1,n=1,r=[.5],a=[0,1],o;function i(c){return c!=null&&c<=c?a[Ud(r,c,0,n)]:o}function s(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,s()):[e,t]},i.range=function(c){return arguments.length?(n=(a=Array.from(c)).length-1,s()):a.slice()},i.invertExtent=function(c){var l=a.indexOf(c);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},i.unknown=function(c){return arguments.length&&(o=c),i},i.thresholds=function(){return r.slice()},i.copy=function(){return sV().domain([e,t]).range(a).unknown(o)},Er.apply(bi(i),arguments)}function cV(){var e=[.5],t=[0,1],n,r=1;function a(o){return o!=null&&o<=o?t[Ud(e,o,0,r)]:n}return a.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(o){var i=t.indexOf(o);return[e[i-1],e[i]]},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return cV().domain(e).range(t).unknown(n)},Er.apply(a,arguments)}const hO=new Date,mO=new Date;function sn(e,t,n,r){function a(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return a.floor=o=>(e(o=new Date(+o)),o),a.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),a.round=o=>{const i=a(o),s=a.ceil(o);return o-i<s-o?i:s},a.offset=(o,i)=>(t(o=new Date(+o),i==null?1:Math.floor(i)),o),a.range=(o,i,s)=>{const c=[];if(o=a.ceil(o),s=s==null?1:Math.floor(s),!(o<i)||!(s>0))return c;let l;do c.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<i);return c},a.filter=o=>sn(i=>{if(i>=i)for(;e(i),!o(i);)i.setTime(i-1)},(i,s)=>{if(i>=i)if(s<0)for(;++s<=0;)for(;t(i,-1),!o(i););else for(;--s>=0;)for(;t(i,1),!o(i););}),n&&(a.count=(o,i)=>(hO.setTime(+o),mO.setTime(+i),e(hO),e(mO),Math.floor(n(hO,mO))),a.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?a.filter(r?i=>r(i)%o===0:i=>a.count(0,i)%o===0):a)),a}const by=sn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);by.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?sn(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):by),by.range;const Ao=1e3,Or=Ao*60,To=Or*60,Io=To*24,yO=Io*7,lV=Io*30,gO=Io*365,cs=sn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ao)},(e,t)=>(t-e)/Ao,e=>e.getUTCSeconds());cs.range;const vO=sn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ao)},(e,t)=>{e.setTime(+e+t*Or)},(e,t)=>(t-e)/Or,e=>e.getMinutes());vO.range;const bO=sn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Or)},(e,t)=>(t-e)/Or,e=>e.getUTCMinutes());bO.range;const wO=sn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ao-e.getMinutes()*Or)},(e,t)=>{e.setTime(+e+t*To)},(e,t)=>(t-e)/To,e=>e.getHours());wO.range;const xO=sn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*To)},(e,t)=>(t-e)/To,e=>e.getUTCHours());xO.range;const Qd=sn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Or)/Io,e=>e.getDate()-1);Qd.range;const wy=sn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Io,e=>e.getUTCDate()-1);wy.range;const uV=sn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Io,e=>Math.floor(e/Io));uV.range;function ls(e){return sn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Or)/yO)}const xy=ls(0),_y=ls(1),s1e=ls(2),c1e=ls(3),el=ls(4),l1e=ls(5),u1e=ls(6);xy.range,_y.range,s1e.range,c1e.range,el.range,l1e.range,u1e.range;function us(e){return sn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/yO)}const jy=us(0),Sy=us(1),d1e=us(2),p1e=us(3),tl=us(4),f1e=us(5),h1e=us(6);jy.range,Sy.range,d1e.range,p1e.range,tl.range,f1e.range,h1e.range;const _O=sn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());_O.range;const jO=sn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());jO.range;const Ro=sn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ro.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:sn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}),Ro.range;const Do=sn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Do.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:sn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}),Do.range;function dV(e,t,n,r,a,o){const i=[[cs,1,Ao],[cs,5,5*Ao],[cs,15,15*Ao],[cs,30,30*Ao],[o,1,Or],[o,5,5*Or],[o,15,15*Or],[o,30,30*Or],[a,1,To],[a,3,3*To],[a,6,6*To],[a,12,12*To],[r,1,Io],[r,2,2*Io],[n,1,yO],[t,1,lV],[t,3,3*lV],[e,1,gO]];function s(l,u,d){const p=u<l;p&&([l,u]=[u,l]);const f=d&&typeof d.range=="function"?d:c(l,u,d),y=f?f.range(l,+u+1):[];return p?y.reverse():y}function c(l,u,d){const p=Math.abs(u-l)/d,f=eO(([,,v])=>v).right(i,p);if(f===i.length)return e.every(rO(l/gO,u/gO,d));if(f===0)return by.every(Math.max(rO(l,u,d),1));const[y,m]=i[p/i[f-1][2]<i[f][2]/p?f-1:f];return y.every(m)}return[s,c]}const[m1e,y1e]=dV(Do,jO,jy,uV,xO,bO),[g1e,v1e]=dV(Ro,_O,xy,Qd,wO,vO);function SO(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function EO(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Gd(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function b1e(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,o=e.days,i=e.shortDays,s=e.months,c=e.shortMonths,l=Jd(a),u=Yd(a),d=Jd(o),p=Yd(o),f=Jd(i),y=Yd(i),m=Jd(s),v=Yd(s),b=Jd(c),w=Yd(c),_={a:R,A:L,b:D,B,c:null,d:gV,e:gV,f:V1e,g:J1e,G:e_e,H:F1e,I:B1e,j:z1e,L:vV,m:W1e,M:U1e,p:F,q:$,Q:SV,s:EV,S:q1e,u:H1e,U:K1e,V:Z1e,w:X1e,W:Q1e,x:null,X:null,y:G1e,Y:Y1e,Z:t_e,"%":jV},x={a:V,A:Q,b:X,B:H,c:null,d:wV,e:wV,f:o_e,g:m_e,G:g_e,H:n_e,I:r_e,j:a_e,L:xV,m:i_e,M:s_e,p:J,q:K,Q:SV,s:EV,S:c_e,u:l_e,U:u_e,V:d_e,w:p_e,W:f_e,x:null,X:null,y:h_e,Y:y_e,Z:v_e,"%":jV},j={a:M,A:P,b:I,B:k,c:C,d:mV,e:mV,f:R1e,g:hV,G:fV,H:yV,I:yV,j:k1e,L:I1e,m:P1e,M:A1e,p:N,q:M1e,Q:L1e,s:$1e,S:T1e,u:S1e,U:E1e,V:O1e,w:j1e,W:C1e,x:T,X:A,y:hV,Y:fV,Z:N1e,"%":D1e};_.x=S(n,_),_.X=S(r,_),_.c=S(t,_),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(q,G){return function(ne){var z=[],se=-1,re=0,le=q.length,je,Le,$e;for(ne instanceof Date||(ne=new Date(+ne));++se<le;)q.charCodeAt(se)===37&&(z.push(q.slice(re,se)),(Le=pV[je=q.charAt(++se)])!=null?je=q.charAt(++se):Le=je==="e"?" ":"0",($e=G[je])&&(je=$e(ne,Le)),z.push(je),re=se+1);return z.push(q.slice(re,se)),z.join("")}}function E(q,G){return function(ne){var z=Gd(1900,void 0,1),se=O(z,q,ne+="",0),re,le;if(se!=ne.length)return null;if("Q"in z)return new Date(z.Q);if("s"in z)return new Date(z.s*1e3+("L"in z?z.L:0));if(G&&!("Z"in z)&&(z.Z=0),"p"in z&&(z.H=z.H%12+z.p*12),z.m===void 0&&(z.m="q"in z?z.q:0),"V"in z){if(z.V<1||z.V>53)return null;"w"in z||(z.w=1),"Z"in z?(re=EO(Gd(z.y,0,1)),le=re.getUTCDay(),re=le>4||le===0?Sy.ceil(re):Sy(re),re=wy.offset(re,(z.V-1)*7),z.y=re.getUTCFullYear(),z.m=re.getUTCMonth(),z.d=re.getUTCDate()+(z.w+6)%7):(re=SO(Gd(z.y,0,1)),le=re.getDay(),re=le>4||le===0?_y.ceil(re):_y(re),re=Qd.offset(re,(z.V-1)*7),z.y=re.getFullYear(),z.m=re.getMonth(),z.d=re.getDate()+(z.w+6)%7)}else("W"in z||"U"in z)&&("w"in z||(z.w="u"in z?z.u%7:"W"in z?1:0),le="Z"in z?EO(Gd(z.y,0,1)).getUTCDay():SO(Gd(z.y,0,1)).getDay(),z.m=0,z.d="W"in z?(z.w+6)%7+z.W*7-(le+5)%7:z.w+z.U*7-(le+6)%7);return"Z"in z?(z.H+=z.Z/100|0,z.M+=z.Z%100,EO(z)):SO(z)}}function O(q,G,ne,z){for(var se=0,re=G.length,le=ne.length,je,Le;se<re;){if(z>=le)return-1;if(je=G.charCodeAt(se++),je===37){if(je=G.charAt(se++),Le=j[je in pV?G.charAt(se++):je],!Le||(z=Le(q,ne,z))<0)return-1}else if(je!=ne.charCodeAt(z++))return-1}return z}function N(q,G,ne){var z=l.exec(G.slice(ne));return z?(q.p=u.get(z[0].toLowerCase()),ne+z[0].length):-1}function M(q,G,ne){var z=f.exec(G.slice(ne));return z?(q.w=y.get(z[0].toLowerCase()),ne+z[0].length):-1}function P(q,G,ne){var z=d.exec(G.slice(ne));return z?(q.w=p.get(z[0].toLowerCase()),ne+z[0].length):-1}function I(q,G,ne){var z=b.exec(G.slice(ne));return z?(q.m=w.get(z[0].toLowerCase()),ne+z[0].length):-1}function k(q,G,ne){var z=m.exec(G.slice(ne));return z?(q.m=v.get(z[0].toLowerCase()),ne+z[0].length):-1}function C(q,G,ne){return O(q,t,G,ne)}function T(q,G,ne){return O(q,n,G,ne)}function A(q,G,ne){return O(q,r,G,ne)}function R(q){return i[q.getDay()]}function L(q){return o[q.getDay()]}function D(q){return c[q.getMonth()]}function B(q){return s[q.getMonth()]}function F(q){return a[+(q.getHours()>=12)]}function $(q){return 1+~~(q.getMonth()/3)}function V(q){return i[q.getUTCDay()]}function Q(q){return o[q.getUTCDay()]}function X(q){return c[q.getUTCMonth()]}function H(q){return s[q.getUTCMonth()]}function J(q){return a[+(q.getUTCHours()>=12)]}function K(q){return 1+~~(q.getUTCMonth()/3)}return{format:function(q){var G=S(q+="",_);return G.toString=function(){return q},G},parse:function(q){var G=E(q+="",!1);return G.toString=function(){return q},G},utcFormat:function(q){var G=S(q+="",x);return G.toString=function(){return q},G},utcParse:function(q){var G=E(q+="",!0);return G.toString=function(){return q},G}}}var pV={"-":"",_:" ",0:"0"},fn=/^\s*\d+/,w1e=/^%/,x1e=/[\\^$*+?|[\]().{}]/g;function pt(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",o=a.length;return r+(o<n?new Array(n-o+1).join(t)+a:a)}function _1e(e){return e.replace(x1e,"\\$&")}function Jd(e){return new RegExp("^(?:"+e.map(_1e).join("|")+")","i")}function Yd(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function j1e(e,t,n){var r=fn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function S1e(e,t,n){var r=fn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function E1e(e,t,n){var r=fn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function O1e(e,t,n){var r=fn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function C1e(e,t,n){var r=fn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function fV(e,t,n){var r=fn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function hV(e,t,n){var r=fn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function N1e(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function M1e(e,t,n){var r=fn.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function P1e(e,t,n){var r=fn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function mV(e,t,n){var r=fn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function k1e(e,t,n){var r=fn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function yV(e,t,n){var r=fn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function A1e(e,t,n){var r=fn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function T1e(e,t,n){var r=fn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function I1e(e,t,n){var r=fn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function R1e(e,t,n){var r=fn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function D1e(e,t,n){var r=w1e.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function L1e(e,t,n){var r=fn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function $1e(e,t,n){var r=fn.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function gV(e,t){return pt(e.getDate(),t,2)}function F1e(e,t){return pt(e.getHours(),t,2)}function B1e(e,t){return pt(e.getHours()%12||12,t,2)}function z1e(e,t){return pt(1+Qd.count(Ro(e),e),t,3)}function vV(e,t){return pt(e.getMilliseconds(),t,3)}function V1e(e,t){return vV(e,t)+"000"}function W1e(e,t){return pt(e.getMonth()+1,t,2)}function U1e(e,t){return pt(e.getMinutes(),t,2)}function q1e(e,t){return pt(e.getSeconds(),t,2)}function H1e(e){var t=e.getDay();return t===0?7:t}function K1e(e,t){return pt(xy.count(Ro(e)-1,e),t,2)}function bV(e){var t=e.getDay();return t>=4||t===0?el(e):el.ceil(e)}function Z1e(e,t){return e=bV(e),pt(el.count(Ro(e),e)+(Ro(e).getDay()===4),t,2)}function X1e(e){return e.getDay()}function Q1e(e,t){return pt(_y.count(Ro(e)-1,e),t,2)}function G1e(e,t){return pt(e.getFullYear()%100,t,2)}function J1e(e,t){return e=bV(e),pt(e.getFullYear()%100,t,2)}function Y1e(e,t){return pt(e.getFullYear()%1e4,t,4)}function e_e(e,t){var n=e.getDay();return e=n>=4||n===0?el(e):el.ceil(e),pt(e.getFullYear()%1e4,t,4)}function t_e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+pt(t/60|0,"0",2)+pt(t%60,"0",2)}function wV(e,t){return pt(e.getUTCDate(),t,2)}function n_e(e,t){return pt(e.getUTCHours(),t,2)}function r_e(e,t){return pt(e.getUTCHours()%12||12,t,2)}function a_e(e,t){return pt(1+wy.count(Do(e),e),t,3)}function xV(e,t){return pt(e.getUTCMilliseconds(),t,3)}function o_e(e,t){return xV(e,t)+"000"}function i_e(e,t){return pt(e.getUTCMonth()+1,t,2)}function s_e(e,t){return pt(e.getUTCMinutes(),t,2)}function c_e(e,t){return pt(e.getUTCSeconds(),t,2)}function l_e(e){var t=e.getUTCDay();return t===0?7:t}function u_e(e,t){return pt(jy.count(Do(e)-1,e),t,2)}function _V(e){var t=e.getUTCDay();return t>=4||t===0?tl(e):tl.ceil(e)}function d_e(e,t){return e=_V(e),pt(tl.count(Do(e),e)+(Do(e).getUTCDay()===4),t,2)}function p_e(e){return e.getUTCDay()}function f_e(e,t){return pt(Sy.count(Do(e)-1,e),t,2)}function h_e(e,t){return pt(e.getUTCFullYear()%100,t,2)}function m_e(e,t){return e=_V(e),pt(e.getUTCFullYear()%100,t,2)}function y_e(e,t){return pt(e.getUTCFullYear()%1e4,t,4)}function g_e(e,t){var n=e.getUTCDay();return e=n>=4||n===0?tl(e):tl.ceil(e),pt(e.getUTCFullYear()%1e4,t,4)}function v_e(){return"+0000"}function jV(){return"%"}function SV(e){return+e}function EV(e){return Math.floor(+e/1e3)}var nl,OV,CV;b_e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function b_e(e){return nl=b1e(e),OV=nl.format,nl.parse,CV=nl.utcFormat,nl.utcParse,nl}function w_e(e){return new Date(e)}function x_e(e){return e instanceof Date?+e:+new Date(+e)}function OO(e,t,n,r,a,o,i,s,c,l){var u=sO(),d=u.invert,p=u.domain,f=l(".%L"),y=l(":%S"),m=l("%I:%M"),v=l("%I %p"),b=l("%a %d"),w=l("%b %d"),_=l("%B"),x=l("%Y");function j(S){return(c(S)<S?f:s(S)<S?y:i(S)<S?m:o(S)<S?v:r(S)<S?a(S)<S?b:w:n(S)<S?_:x)(S)}return u.invert=function(S){return new Date(d(S))},u.domain=function(S){return arguments.length?p(Array.from(S,x_e)):p().map(w_e)},u.ticks=function(S){var E=p();return e(E[0],E[E.length-1],S??10)},u.tickFormat=function(S,E){return E==null?j:l(E)},u.nice=function(S){var E=p();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?p(X7(E,S)):u},u.copy=function(){return Zd(u,OO(e,t,n,r,a,o,i,s,c,l))},u}function __e(){return Er.apply(OO(g1e,v1e,Ro,_O,xy,Qd,wO,vO,cs,OV).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function j_e(){return Er.apply(OO(m1e,y1e,Do,jO,jy,wy,xO,bO,cs,CV).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Ey(){var e=0,t=1,n,r,a,o,i=Bn,s=!1,c;function l(d){return d==null||isNaN(d=+d)?c:i(a===0?.5:(d=(o(d)-n)*a,s?Math.max(0,Math.min(1,d)):d))}l.domain=function(d){return arguments.length?([e,t]=d,n=o(e=+e),r=o(t=+t),a=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(d){return arguments.length?(s=!!d,l):s},l.interpolator=function(d){return arguments.length?(i=d,l):i};function u(d){return function(p){var f,y;return arguments.length?([f,y]=p,i=d(f,y),l):[i(0),i(1)]}}return l.range=u(nc),l.rangeRound=u(s1),l.unknown=function(d){return arguments.length?(c=d,l):c},function(d){return o=d,n=d(e),r=d(t),a=n===r?0:1/(r-n),l}}function wi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function NV(){var e=bi(Ey()(Bn));return e.copy=function(){return wi(e,NV())},ko.apply(e,arguments)}function MV(){var e=uO(Ey()).domain([1,10]);return e.copy=function(){return wi(e,MV()).base(e.base())},ko.apply(e,arguments)}function PV(){var e=dO(Ey());return e.copy=function(){return wi(e,PV()).constant(e.constant())},ko.apply(e,arguments)}function CO(){var e=pO(Ey());return e.copy=function(){return wi(e,CO()).exponent(e.exponent())},ko.apply(e,arguments)}function S_e(){return CO.apply(null,arguments).exponent(.5)}function kV(){var e=[],t=Bn;function n(r){if(r!=null&&!isNaN(r=+r))return t((Ud(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let a of r)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(vi),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,o)=>Ixe(e,o/r))},n.copy=function(){return kV(t).domain(e)},ko.apply(n,arguments)}function Oy(){var e=0,t=.5,n=1,r=1,a,o,i,s,c,l=Bn,u,d=!1,p;function f(m){return isNaN(m=+m)?p:(m=.5+((m=+u(m))-o)*(r*m<r*o?s:c),l(d?Math.max(0,Math.min(1,m)):m))}f.domain=function(m){return arguments.length?([e,t,n]=m,a=u(e=+e),o=u(t=+t),i=u(n=+n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,f):[e,t,n]},f.clamp=function(m){return arguments.length?(d=!!m,f):d},f.interpolator=function(m){return arguments.length?(l=m,f):l};function y(m){return function(v){var b,w,_;return arguments.length?([b,w,_]=v,l=Oae(m,[b,w,_]),f):[l(0),l(.5),l(1)]}}return f.range=y(nc),f.rangeRound=y(s1),f.unknown=function(m){return arguments.length?(p=m,f):p},function(m){return u=m,a=m(e),o=m(t),i=m(n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,f}}function AV(){var e=bi(Oy()(Bn));return e.copy=function(){return wi(e,AV())},ko.apply(e,arguments)}function TV(){var e=uO(Oy()).domain([.1,1,10]);return e.copy=function(){return wi(e,TV()).base(e.base())},ko.apply(e,arguments)}function IV(){var e=dO(Oy());return e.copy=function(){return wi(e,IV()).constant(e.constant())},ko.apply(e,arguments)}function NO(){var e=pO(Oy());return e.copy=function(){return wi(e,NO()).exponent(e.exponent())},ko.apply(e,arguments)}function E_e(){return NO.apply(null,arguments).exponent(.5)}const RV=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Hd,scaleDiverging:AV,scaleDivergingLog:TV,scaleDivergingPow:NO,scaleDivergingSqrt:E_e,scaleDivergingSymlog:IV,scaleIdentity:Z7,scaleImplicit:aO,scaleLinear:vy,scaleLog:Y7,scaleOrdinal:oO,scalePoint:Kd,scalePow:fO,scaleQuantile:iV,scaleQuantize:sV,scaleRadial:oV,scaleSequential:NV,scaleSequentialLog:MV,scaleSequentialPow:CO,scaleSequentialQuantile:kV,scaleSequentialSqrt:S_e,scaleSequentialSymlog:PV,scaleSqrt:o1e,scaleSymlog:nV,scaleThreshold:cV,scaleTime:__e,scaleUtc:j_e,tickFormat:K7},Symbol.toStringTag,{value:"Module"}));var MO,DV;function LV(){if(DV)return MO;DV=1;var e=Gs();function t(n,r,a){for(var o=-1,i=n.length;++o<i;){var s=n[o],c=r(s);if(c!=null&&(l===void 0?c===c&&!e(c):a(c,l)))var l=c,u=s}return u}return MO=t,MO}var PO,$V;function O_e(){if($V)return PO;$V=1;function e(t,n){return t>n}return PO=e,PO}var kO,FV;function C_e(){if(FV)return kO;FV=1;var e=LV(),t=O_e(),n=Js();function r(a){return a&&a.length?e(a,n,t):void 0}return kO=r,kO}var N_e=C_e();const Cy=ot(N_e);var AO,BV;function M_e(){if(BV)return AO;BV=1;function e(t,n){return t<n}return AO=e,AO}var TO,zV;function P_e(){if(zV)return TO;zV=1;var e=LV(),t=M_e(),n=Js();function r(a){return a&&a.length?e(a,n,t):void 0}return TO=r,TO}var k_e=P_e();const Ny=ot(k_e);var IO,VV;TN=function(){if(VV)return IO;VV=1;var e=Il(),t=_a(),n=$z(),r=In();function a(o,i){var s=r(o)?e:n;return s(o,t(i,3))}return IO=a,IO};var RO,WV;function A_e(){if(WV)return RO;WV=1;var e=kg(),t=TN();function n(r,a){return e(t(r,a),1)}return RO=n,RO}var T_e=A_e();const I_e=ot(T_e);var DO,UV;function R_e(){if(UV)return DO;UV=1;var e=sx();function t(n,r){return e(n,r)}return DO=t,DO}var D_e=R_e();const LO=ot(D_e);var rl=1e9,L_e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},BO,Ft=!0,Cr="[DecimalError] ",ds=Cr+"Invalid argument: ",$O=Cr+"Exponent out of range: ",al=Math.floor,ps=Math.pow,$_e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,hr,hn=1e7,Rt=7,qV=9007199254740991,My=al(qV/Rt),Ce={};Ce.absoluteValue=Ce.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},Ce.comparedTo=Ce.cmp=function(e){var t,n,r,a,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(r=o.d.length,a=e.d.length,t=0,n=r<a?r:a;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===a?0:r>a^o.s<0?1:-1},Ce.decimalPlaces=Ce.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Rt;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n},Ce.dividedBy=Ce.div=function(e){return Lo(this,new this.constructor(e))},Ce.dividedToIntegerBy=Ce.idiv=function(e){var t=this,n=t.constructor;return Nt(Lo(t,new n(e),0,1),n.precision)},Ce.equals=Ce.eq=function(e){return!this.cmp(e)},Ce.exponent=function(){return Yt(this)},Ce.greaterThan=Ce.gt=function(e){return this.cmp(e)>0},Ce.greaterThanOrEqualTo=Ce.gte=function(e){return this.cmp(e)>=0},Ce.isInteger=Ce.isint=function(){return this.e>this.d.length-2},Ce.isNegative=Ce.isneg=function(){return this.s<0},Ce.isPositive=Ce.ispos=function(){return this.s>0},Ce.isZero=function(){return this.s===0},Ce.lessThan=Ce.lt=function(e){return this.cmp(e)<0},Ce.lessThanOrEqualTo=Ce.lte=function(e){return this.cmp(e)<1},Ce.logarithm=Ce.log=function(e){var t,n=this,r=n.constructor,a=r.precision,o=a+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(hr))throw Error(Cr+"NaN");if(n.s<1)throw Error(Cr+(n.s?"NaN":"-Infinity"));return n.eq(hr)?new r(0):(Ft=!1,t=Lo(ep(n,o),ep(e,o),o),Ft=!0,Nt(t,a))},Ce.minus=Ce.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?XV(t,e):HV(t,(e.s=-e.s,e))},Ce.modulo=Ce.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(e=new r(e),!e.s)throw Error(Cr+"NaN");return n.s?(Ft=!1,t=Lo(n,e,0,1).times(e),Ft=!0,n.minus(t)):Nt(new r(n),a)},Ce.naturalExponential=Ce.exp=function(){return KV(this)},Ce.naturalLogarithm=Ce.ln=function(){return ep(this)},Ce.negated=Ce.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},Ce.plus=Ce.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?HV(t,e):XV(t,(e.s=-e.s,e))},Ce.precision=Ce.sd=function(e){var t,n,r,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ds+e);if(t=Yt(a)+1,r=a.d.length-1,n=r*Rt+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},Ce.squareRoot=Ce.sqrt=function(){var e,t,n,r,a,o,i,s=this,c=s.constructor;if(s.s<1){if(!s.s)return new c(0);throw Error(Cr+"NaN")}for(e=Yt(s),Ft=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=$a(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=al((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(a.toString()),n=c.precision,a=i=n+3;;)if(o=r,r=o.plus(Lo(s,o,i+2)).times(.5),$a(o.d).slice(0,i)===(t=$a(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&t=="4999"){if(Nt(o,n+1,0),o.times(o).eq(s)){r=o;break}}else if(t!="9999")break;i+=4}return Ft=!0,Nt(r,n)},Ce.times=Ce.mul=function(e){var t,n,r,a,o,i,s,c,l,u=this,d=u.constructor,p=u.d,f=(e=new d(e)).d;if(!u.s||!e.s)return new d(0);for(e.s*=u.s,n=u.e+e.e,c=p.length,l=f.length,c<l&&(o=p,p=f,f=o,i=c,c=l,l=i),o=[],i=c+l,r=i;r--;)o.push(0);for(r=l;--r>=0;){for(t=0,a=c+r;a>r;)s=o[a]+f[r]*p[a-r-1]+t,o[a--]=s%hn|0,t=s/hn|0;o[a]=(o[a]+t)%hn|0}for(;!o[--i];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,Ft?Nt(e,d.precision):e},Ce.toDecimalPlaces=Ce.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(La(e,0,rl),t===void 0?t=r.rounding:La(t,0,8),Nt(n,e+Yt(n)+1,t))},Ce.toExponential=function(e,t){var n,r=this,a=r.constructor;return e===void 0?n=fs(r,!0):(La(e,0,rl),t===void 0?t=a.rounding:La(t,0,8),r=Nt(new a(r),e+1,t),n=fs(r,!0,e+1)),n},Ce.toFixed=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?fs(a):(La(e,0,rl),t===void 0?t=o.rounding:La(t,0,8),r=Nt(new o(a),e+Yt(a)+1,t),n=fs(r.abs(),!1,e+Yt(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},Ce.toInteger=Ce.toint=function(){var e=this,t=e.constructor;return Nt(new t(e),Yt(e)+1,t.rounding)},Ce.toNumber=function(){return+this},Ce.toPower=Ce.pow=function(e){var t,n,r,a,o,i,s=this,c=s.constructor,l=12,u=+(e=new c(e));if(!e.s)return new c(hr);if(s=new c(s),!s.s){if(e.s<1)throw Error(Cr+"Infinity");return s}if(s.eq(hr))return s;if(r=c.precision,e.eq(hr))return Nt(s,r);if(t=e.e,n=e.d.length-1,i=t>=n,o=s.s,i){if((n=u<0?-u:u)<=qV){for(a=new c(hr),t=Math.ceil(r/Rt+4),Ft=!1;n%2&&(a=a.times(s),QV(a.d,t)),n=al(n/2),n!==0;)s=s.times(s),QV(s.d,t);return Ft=!0,e.s<0?new c(hr).div(a):Nt(a,r)}}else if(o<0)throw Error(Cr+"NaN");return o=o<0&&e.d[Math.max(t,n)]&1?-1:1,s.s=1,Ft=!1,a=e.times(ep(s,r+l)),Ft=!0,a=KV(a),a.s=o,a},Ce.toPrecision=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?(n=Yt(a),r=fs(a,n<=o.toExpNeg||n>=o.toExpPos)):(La(e,1,rl),t===void 0?t=o.rounding:La(t,0,8),a=Nt(new o(a),e,t),n=Yt(a),r=fs(a,e<=n||n<=o.toExpNeg,e)),r},Ce.toSignificantDigits=Ce.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(La(e,1,rl),t===void 0?t=r.rounding:La(t,0,8)),Nt(new r(n),e,t)},Ce.toString=Ce.valueOf=Ce.val=Ce.toJSON=Ce[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Yt(e),n=e.constructor;return fs(e,t<=n.toExpNeg||t>=n.toExpPos)};function HV(e,t){var n,r,a,o,i,s,c,l,u=e.constructor,d=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Ft?Nt(t,d):t;if(c=e.d,l=t.d,i=e.e,a=t.e,c=c.slice(),o=i-a,o){for(o<0?(r=c,o=-o,s=l.length):(r=l,a=i,s=c.length),i=Math.ceil(d/Rt),s=i>s?i+1:s+1,o>s&&(o=s,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(s=c.length,o=l.length,s-o<0&&(o=s,r=l,l=c,c=r),n=0;o;)n=(c[--o]=c[o]+l[o]+n)/hn|0,c[o]%=hn;for(n&&(c.unshift(n),++a),s=c.length;c[--s]==0;)c.pop();return t.d=c,t.e=a,Ft?Nt(t,d):t}function La(e,t,n){if(e!==~~e||e<t||e>n)throw Error(ds+e)}function $a(e){var t,n,r,a=e.length-1,o="",i=e[0];if(a>0){for(o+=i,t=1;t<a;t++)r=e[t]+"",n=Rt-r.length,n&&(o+=xi(n)),o+=r;i=e[t],r=i+"",n=Rt-r.length,n&&(o+=xi(n))}else if(i===0)return"0";for(;i%10===0;)i/=10;return o+i}var Lo=function(){function e(r,a){var o,i=0,s=r.length;for(r=r.slice();s--;)o=r[s]*a+i,r[s]=o%hn|0,i=o/hn|0;return i&&r.unshift(i),r}function t(r,a,o,i){var s,c;if(o!=i)c=o>i?1:-1;else for(s=c=0;s<o;s++)if(r[s]!=a[s]){c=r[s]>a[s]?1:-1;break}return c}function n(r,a,o){for(var i=0;o--;)r[o]-=i,i=r[o]<a[o]?1:0,r[o]=i*hn+r[o]-a[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,o,i){var s,c,l,u,d,p,f,y,m,v,b,w,_,x,j,S,E,O,N=r.constructor,M=r.s==a.s?1:-1,P=r.d,I=a.d;if(!r.s)return new N(r);if(!a.s)throw Error(Cr+"Division by zero");for(c=r.e-a.e,E=I.length,j=P.length,f=new N(M),y=f.d=[],l=0;I[l]==(P[l]||0);)++l;if(I[l]>(P[l]||0)&&--c,o==null?w=o=N.precision:i?w=o+(Yt(r)-Yt(a))+1:w=o,w<0)return new N(0);if(w=w/Rt+2|0,l=0,E==1)for(u=0,I=I[0],w++;(l<j||u)&&w--;l++)_=u*hn+(P[l]||0),y[l]=_/I|0,u=_%I|0;else{for(u=hn/(I[0]+1)|0,u>1&&(I=e(I,u),P=e(P,u),E=I.length,j=P.length),x=E,m=P.slice(0,E),v=m.length;v<E;)m[v++]=0;O=I.slice(),O.unshift(0),S=I[0],I[1]>=hn/2&&++S;do u=0,s=t(I,m,E,v),s<0?(b=m[0],E!=v&&(b=b*hn+(m[1]||0)),u=b/S|0,u>1?(u>=hn&&(u=hn-1),d=e(I,u),p=d.length,v=m.length,s=t(d,m,p,v),s==1&&(u--,n(d,E<p?O:I,p))):(u==0&&(s=u=1),d=I.slice()),p=d.length,p<v&&d.unshift(0),n(m,d,v),s==-1&&(v=m.length,s=t(I,m,E,v),s<1&&(u++,n(m,E<v?O:I,v))),v=m.length):s===0&&(u++,m=[0]),y[l++]=u,s&&m[0]?m[v++]=P[x]||0:(m=[P[x]],v=1);while((x++<j||m[0]!==void 0)&&w--)}return y[0]||y.shift(),f.e=c,Nt(f,i?o+Yt(f)+1:o)}}();function KV(e,t){var n,r,a,o,i,s,c=0,l=0,u=e.constructor,d=u.precision;if(Yt(e)>16)throw Error($O+Yt(e));if(!e.s)return new u(hr);for(t==null?(Ft=!1,s=d):s=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),l+=5;for(r=Math.log(ps(2,l))/Math.LN10*2+5|0,s+=r,n=a=o=new u(hr),u.precision=s;;){if(a=Nt(a.times(e),s),n=n.times(++c),i=o.plus(Lo(a,n,s)),$a(i.d).slice(0,s)===$a(o.d).slice(0,s)){for(;l--;)o=Nt(o.times(o),s);return u.precision=d,t==null?(Ft=!0,Nt(o,d)):o}o=i}}function Yt(e){for(var t=e.e*Rt,n=e.d[0];n>=10;n/=10)t++;return t}function FO(e,t,n){if(t>e.LN10.sd())throw Ft=!0,n&&(e.precision=n),Error(Cr+"LN10 precision limit exceeded");return Nt(new e(e.LN10),t)}function xi(e){for(var t="";e--;)t+="0";return t}function ep(e,t){var n,r,a,o,i,s,c,l,u,d=1,p=10,f=e,y=f.d,m=f.constructor,v=m.precision;if(f.s<1)throw Error(Cr+(f.s?"NaN":"-Infinity"));if(f.eq(hr))return new m(0);if(t==null?(Ft=!1,l=v):l=t,f.eq(10))return t==null&&(Ft=!0),FO(m,l);if(l+=p,m.precision=l,n=$a(y),r=n.charAt(0),o=Yt(f),Math.abs(o)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)f=f.times(e),n=$a(f.d),r=n.charAt(0),d++;o=Yt(f),r>1?(f=new m("0."+n),o++):f=new m(r+"."+n.slice(1))}else return c=FO(m,l+2,v).times(o+""),f=ep(new m(r+"."+n.slice(1)),l-p).plus(c),m.precision=v,t==null?(Ft=!0,Nt(f,v)):f;for(s=i=f=Lo(f.minus(hr),f.plus(hr),l),u=Nt(f.times(f),l),a=3;;){if(i=Nt(i.times(u),l),c=s.plus(Lo(i,new m(a),l)),$a(c.d).slice(0,l)===$a(s.d).slice(0,l))return s=s.times(2),o!==0&&(s=s.plus(FO(m,l+2,v).times(o+""))),s=Lo(s,new m(d),l),m.precision=v,t==null?(Ft=!0,Nt(s,v)):s;s=c,a+=2}}function ZV(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=al(n/Rt),e.d=[],r=(n+1)%Rt,n<0&&(r+=Rt),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=Rt;r<a;)e.d.push(+t.slice(r,r+=Rt));t=t.slice(r),r=Rt-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),Ft&&(e.e>My||e.e<-My))throw Error($O+n)}else e.s=0,e.e=0,e.d=[0];return e}function Nt(e,t,n){var r,a,o,i,s,c,l,u,d=e.d;for(i=1,o=d[0];o>=10;o/=10)i++;if(r=t-i,r<0)r+=Rt,a=t,l=d[u=0];else{if(u=Math.ceil((r+1)/Rt),o=d.length,u>=o)return e;for(l=o=d[u],i=1;o>=10;o/=10)i++;r%=Rt,a=r-Rt+i}if(n!==void 0&&(o=ps(10,i-a-1),s=l/o%10|0,c=t<0||d[u+1]!==void 0||l%o,c=n<4?(s||c)&&(n==0||n==(e.s<0?3:2)):s>5||s==5&&(n==4||c||n==6&&(r>0?a>0?l/ps(10,i-a):0:d[u-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return c?(o=Yt(e),d.length=1,t=t-o-1,d[0]=ps(10,(Rt-t%Rt)%Rt),e.e=al(-t/Rt)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=u,o=1,u--):(d.length=u+1,o=ps(10,Rt-r),d[u]=a>0?(l/ps(10,i-a)%ps(10,a)|0)*o:0),c)for(;;)if(u==0){(d[0]+=o)==hn&&(d[0]=1,++e.e);break}else{if(d[u]+=o,d[u]!=hn)break;d[u--]=0,o=1}for(r=d.length;d[--r]===0;)d.pop();if(Ft&&(e.e>My||e.e<-My))throw Error($O+Yt(e));return e}function XV(e,t){var n,r,a,o,i,s,c,l,u,d,p=e.constructor,f=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),Ft?Nt(t,f):t;if(c=e.d,d=t.d,r=t.e,l=e.e,c=c.slice(),i=l-r,i){for(u=i<0,u?(n=c,i=-i,s=d.length):(n=d,r=l,s=c.length),a=Math.max(Math.ceil(f/Rt),s)+2,i>a&&(i=a,n.length=1),n.reverse(),a=i;a--;)n.push(0);n.reverse()}else{for(a=c.length,s=d.length,u=a<s,u&&(s=a),a=0;a<s;a++)if(c[a]!=d[a]){u=c[a]<d[a];break}i=0}for(u&&(n=c,c=d,d=n,t.s=-t.s),s=c.length,a=d.length-s;a>0;--a)c[s++]=0;for(a=d.length;a>i;){if(c[--a]<d[a]){for(o=a;o&&c[--o]===0;)c[o]=hn-1;--c[o],c[a]+=hn}c[a]-=d[a]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,Ft?Nt(t,f):t):new p(0)}function fs(e,t,n){var r,a=Yt(e),o=$a(e.d),i=o.length;return t?(n&&(r=n-i)>0?o=o.charAt(0)+"."+o.slice(1)+xi(r):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(a<0?"e":"e+")+a):a<0?(o="0."+xi(-a-1)+o,n&&(r=n-i)>0&&(o+=xi(r))):a>=i?(o+=xi(a+1-i),n&&(r=n-a-1)>0&&(o=o+"."+xi(r))):((r=a+1)<i&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-i)>0&&(a+1===i&&(o+="."),o+=xi(r))),e.s<0?"-"+o:o}function QV(e,t){if(e.length>t)return e.length=t,!0}function GV(e){var t,n,r;function a(o){var i=this;if(!(i instanceof a))return new a(o);if(i.constructor=a,o instanceof a){i.s=o.s,i.e=o.e,i.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(ds+o);if(o>0)i.s=1;else if(o<0)o=-o,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(o===~~o&&o<1e7){i.e=0,i.d=[o];return}return ZV(i,o.toString())}else if(typeof o!="string")throw Error(ds+o);if(o.charCodeAt(0)===45?(o=o.slice(1),i.s=-1):i.s=1,$_e.test(o))ZV(i,o);else throw Error(ds+o)}if(a.prototype=Ce,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=GV,a.config=a.set=F_e,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return a.config(e),a}function F_e(e){if(!e||typeof e!="object")throw Error(Cr+"Object expected");var t,n,r,a=["precision",1,rl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((r=e[n=a[t]])!==void 0)if(al(r)===r&&r>=a[t+1]&&r<=a[t+2])this[n]=r;else throw Error(ds+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(ds+n+": "+r);return this}var BO=GV(L_e);hr=new BO(1);const Ot=BO;function B_e(e){return U_e(e)||W_e(e)||V_e(e)||z_e()}function z_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V_e(e,t){if(e){if(typeof e=="string")return zO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zO(e,t)}}function W_e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function U_e(e){if(Array.isArray(e))return zO(e)}function zO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q_e=function(e){return e},JV={"@@functional/placeholder":!0},YV=function(e){return e===JV},eW=function(e){return function t(){return arguments.length===0||arguments.length===1&&YV(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},H_e=function e(t,n){return t===1?n:eW(function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var i=a.filter(function(s){return s!==JV}).length;return i>=t?n.apply(void 0,a):e(t-i,eW(function(){for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=a.map(function(d){return YV(d)?c.shift():d});return n.apply(void 0,B_e(u).concat(c))}))})},Py=function(e){return H_e(e.length,e)},VO=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},K_e=Py(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),Z_e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return q_e;var r=t.reverse(),a=r[0],o=r.slice(1);return function(){return o.reduce(function(i,s){return s(i)},a.apply(void 0,arguments))}},WO=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},tW=function(e){var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t&&a.every(function(i,s){return i===t[s]})||(t=a,n=e.apply(void 0,a)),n}};function X_e(e){var t;return e===0?t=1:t=Math.floor(new Ot(e).abs().log(10).toNumber())+1,t}function Q_e(e,t,n){for(var r=new Ot(e),a=0,o=[];r.lt(t)&&a<1e5;)o.push(r.toNumber()),r=r.add(n),a++;return o}var G_e=Py(function(e,t,n){var r=+e,a=+t;return r+n*(a-r)}),J_e=Py(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),Y_e=Py(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const ky={rangeStep:Q_e,getDigitCount:X_e,interpolateNumber:G_e,uninterpolateNumber:J_e,uninterpolateTruncation:Y_e};function UO(e){return nje(e)||tje(e)||nW(e)||eje()}function eje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tje(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function nje(e){if(Array.isArray(e))return qO(e)}function tp(e,t){return oje(e)||aje(e,t)||nW(e,t)||rje()}function rje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nW(e,t){if(e){if(typeof e=="string")return qO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qO(e,t)}}function qO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aje(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),s;!(r=(s=i.next()).done)&&(n.push(s.value),!(t&&n.length===t));r=!0);}catch(c){a=!0,o=c}finally{try{!r&&i.return!=null&&i.return()}finally{if(a)throw o}}return n}}function oje(e){if(Array.isArray(e))return e}function rW(e){var t=tp(e,2),n=t[0],r=t[1],a=n,o=r;return n>r&&(a=r,o=n),[a,o]}function aW(e,t,n){if(e.lte(0))return new Ot(0);var r=ky.getDigitCount(e.toNumber()),a=new Ot(10).pow(r),o=e.div(a),i=r!==1?.05:.1,s=new Ot(Math.ceil(o.div(i).toNumber())).add(n).mul(i),c=s.mul(a);return t?c:new Ot(Math.ceil(c))}function ije(e,t,n){var r=1,a=new Ot(e);if(!a.isint()&&n){var o=Math.abs(e);o<1?(r=new Ot(10).pow(ky.getDigitCount(e)-1),a=new Ot(Math.floor(a.div(r).toNumber())).mul(r)):o>1&&(a=new Ot(Math.floor(e)))}else e===0?a=new Ot(Math.floor((t-1)/2)):n||(a=new Ot(Math.floor(e)));var i=Math.floor((t-1)/2),s=Z_e(K_e(function(c){return a.add(new Ot(c-i).mul(r)).toNumber()}),VO);return s(0,t)}function oW(e,t,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Ot(0),tickMin:new Ot(0),tickMax:new Ot(0)};var o=aW(new Ot(t).sub(e).div(n-1),r,a),i;e<=0&&t>=0?i=new Ot(0):(i=new Ot(e).add(t).div(2),i=i.sub(new Ot(i).mod(o)));var s=Math.ceil(i.sub(e).div(o).toNumber()),c=Math.ceil(new Ot(t).sub(i).div(o).toNumber()),l=s+c+1;return l>n?oW(e,t,n,r,a+1):(l<n&&(c=t>0?c+(n-l):c,s=t>0?s:s+(n-l)),{step:o,tickMin:i.sub(new Ot(s).mul(o)),tickMax:i.add(new Ot(c).mul(o))})}function sje(e){var t=tp(e,2),n=t[0],r=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),s=rW([n,r]),c=tp(s,2),l=c[0],u=c[1];if(l===-1/0||u===1/0){var d=u===1/0?[l].concat(UO(VO(0,a-1).map(function(){return 1/0}))):[].concat(UO(VO(0,a-1).map(function(){return-1/0})),[u]);return n>r?WO(d):d}if(l===u)return ije(l,a,o);var p=oW(l,u,i,o),f=p.step,y=p.tickMin,m=p.tickMax,v=ky.rangeStep(y,m.add(new Ot(.1).mul(f)),f);return n>r?WO(v):v}function cje(e,t){var n=tp(e,2),r=n[0],a=n[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=rW([r,a]),s=tp(i,2),c=s[0],l=s[1];if(c===-1/0||l===1/0)return[r,a];if(c===l)return[c];var u=Math.max(t,2),d=aW(new Ot(l).sub(c).div(u-1),o,0),p=[].concat(UO(ky.rangeStep(new Ot(c),new Ot(l).sub(new Ot(.99).mul(d)),d)),[l]);return r>a?WO(p):p}var lje=tW(sje),uje=tW(cje),dje="Invariant failed";function hs(e,t){throw new Error(dje)}var pje=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function ol(e){"@babel/helpers - typeof";return ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ol(e)}function Ay(){return Ay=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ay.apply(this,arguments)}function fje(e,t){return gje(e)||yje(e,t)||mje(e,t)||hje()}function hje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mje(e,t){if(e){if(typeof e=="string")return iW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iW(e,t)}}function iW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yje(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function gje(e){if(Array.isArray(e))return e}function vje(e,t){if(e==null)return{};var n=bje(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function wje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xje(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lW(r.key),r)}}function _je(e,t,n){return t&&xje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jje(e,t,n){return t=Ty(t),Sje(e,sW()?Reflect.construct(t,n||[],Ty(e).constructor):t.apply(e,n))}function Sje(e,t){if(t&&(ol(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Eje(e)}function Eje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sW=function(){return!!e})()}function Ty(e){return Ty=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ty(e)}function Oje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HO(e,t)}function HO(e,t){return HO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},HO(e,t)}function cW(e,t,n){return t=lW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lW(e){var t=Cje(e,"string");return ol(t)=="symbol"?t:t+""}function Cje(e,t){if(ol(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ol(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iy=function(e){function t(){return wje(this,t),jje(this,t,arguments)}return Oje(t,e),_je(t,[{key:"render",value:function(){var n=this.props,r=n.offset,a=n.layout,o=n.width,i=n.dataKey,s=n.data,c=n.dataPointFormatter,l=n.xAxis,u=n.yAxis,d=vje(n,pje),p=yt(d,!1);this.props.direction==="x"&&l.type!=="number"&&hs();var f=s.map(function(y){var m=c(y,i),v=m.x,b=m.y,w=m.value,_=m.errorVal;if(!_)return null;var x=[],j,S;if(Array.isArray(_)){var E=fje(_,2);j=E[0],S=E[1]}else j=S=_;if(a==="vertical"){var O=l.scale,N=b+r,M=N+o,P=N-o,I=O(w-j),k=O(w+S);x.push({x1:k,y1:M,x2:k,y2:P}),x.push({x1:I,y1:N,x2:k,y2:N}),x.push({x1:I,y1:M,x2:I,y2:P})}else if(a==="horizontal"){var C=u.scale,T=v+r,A=T-o,R=T+o,L=C(w-j),D=C(w+S);x.push({x1:A,y1:D,x2:R,y2:D}),x.push({x1:T,y1:L,x2:T,y2:D}),x.push({x1:A,y1:L,x2:R,y2:L})}return U.createElement(pn,Ay({className:"recharts-errorBar",key:"bar-".concat(x.map(function(B){return"".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)}))},p),x.map(function(B){return U.createElement("line",Ay({},B,{key:"line-".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)}))}))});return U.createElement(pn,{className:"recharts-errorBars"},f)}}])}(U.Component);cW(Iy,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),cW(Iy,"displayName","ErrorBar");function np(e){"@babel/helpers - typeof";return np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},np(e)}function uW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ms(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uW(Object(n),!0).forEach(function(r){Nje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Nje(e,t,n){return t=Mje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mje(e){var t=Pje(e,"string");return np(t)=="symbol"?t:t+""}function Pje(e,t){if(np(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(np(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dW=function(e){var t=e.children,n=e.formattedGraphicalItems,r=e.legendWidth,a=e.legendContent,o=fr(t,Zc);if(!o)return null;var i=Zc.defaultProps,s=i!==void 0?ms(ms({},i),o.props):{},c;return o.props&&o.props.payload?c=o.props&&o.props.payload:a==="children"?c=(n||[]).reduce(function(l,u){var d=u.item,p=u.props,f=p.sectors||p.data||[];return l.concat(f.map(function(y){return{type:o.props.iconType||d.props.legendType,value:y.name,color:y.fill,payload:y}}))},[]):c=(n||[]).map(function(l){var u=l.item,d=u.type.defaultProps,p=d!==void 0?ms(ms({},d),u.props):{},f=p.dataKey,y=p.name,m=p.legendType,v=p.hide;return{inactive:v,dataKey:f,type:s.iconType||m||"square",color:ZO(u),value:y||f,payload:p}}),ms(ms(ms({},s),Zc.getWithHeight(o,r)),{},{payload:c,item:o})};function rp(e){"@babel/helpers - typeof";return rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rp(e)}function pW(e){return Ije(e)||Tje(e)||Aje(e)||kje()}function kje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aje(e,t){if(e){if(typeof e=="string")return KO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return KO(e,t)}}function Tje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ije(e){if(Array.isArray(e))return KO(e)}function KO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fW(Object(n),!0).forEach(function(r){il(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function il(e,t,n){return t=Rje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rje(e){var t=Dje(e,"string");return rp(t)=="symbol"?t:t+""}function Dje(e,t){if(rp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(rp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fa(e,t,n){return gt(e)||gt(t)?n:on(t)?xr(e,t,n):tt(t)?t(e):n}function Ry(e,t,n,r){var a=I_e(e,function(s){return Fa(s,t)});if(n==="number"){var o=a.filter(function(s){return ye(s)||parseFloat(s)});return o.length?[Ny(o),Cy(o)]:[1/0,-1/0]}var i=r?a.filter(function(s){return!gt(s)}):a;return i.map(function(s){return on(s)||s instanceof Date?s:""})}var Lje=function(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,i=(t=n==null?void 0:n.length)!==null&&t!==void 0?t:0;if(i<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var s=a.range,c=0;c<i;c++){var l=c>0?r[c-1].coordinate:r[i-1].coordinate,u=r[c].coordinate,d=c>=i-1?r[0].coordinate:r[c+1].coordinate,p=void 0;if(ia(u-l)!==ia(d-u)){var f=[];if(ia(d-u)===ia(s[1]-s[0])){p=d;var y=u+s[1]-s[0];f[0]=Math.min(y,(y+l)/2),f[1]=Math.max(y,(y+l)/2)}else{p=l;var m=d+s[1]-s[0];f[0]=Math.min(u,(m+u)/2),f[1]=Math.max(u,(m+u)/2)}var v=[Math.min(u,(p+u)/2),Math.max(u,(p+u)/2)];if(e>v[0]&&e<=v[1]||e>=f[0]&&e<=f[1]){o=r[c].index;break}}else{var b=Math.min(l,d),w=Math.max(l,d);if(e>(b+u)/2&&e<=(w+u)/2){o=r[c].index;break}}}else for(var _=0;_<i;_++)if(_===0&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_>0&&_<i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_===i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2){o=n[_].index;break}return o},ZO=function(e){var t,n=e,r=n.type.displayName,a=(t=e.type)!==null&&t!==void 0&&t.defaultProps?qt(qt({},e.type.defaultProps),e.props):e.props,o=a.stroke,i=a.fill,s;switch(r){case"Line":s=o;break;case"Area":case"Radar":s=o&&o!=="none"?o:i;break;default:s=i;break}return s},$je=function(e){var t=e.barSize,n=e.totalSize,r=e.stackGroups,a=r===void 0?{}:r;if(!a)return{};for(var o={},i=Object.keys(a),s=0,c=i.length;s<c;s++)for(var l=a[i[s]].stackGroups,u=Object.keys(l),d=0,p=u.length;d<p;d++){var f=l[u[d]],y=f.items,m=f.cateAxisId,v=y.filter(function(S){return No(S.type).indexOf("Bar")>=0});if(v&&v.length){var b=v[0].type.defaultProps,w=b!==void 0?qt(qt({},b),v[0].props):v[0].props,_=w.barSize,x=w[m];o[x]||(o[x]=[]);var j=gt(_)?t:_;o[x].push({item:v[0],stackList:v.slice(1),barSize:gt(j)?void 0:is(j,n,0)})}}return o},Fje=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,a=e.sizeList,o=a===void 0?[]:a,i=e.maxBarSize,s=o.length;if(s<1)return null;var c=is(t,r,0,!0),l,u=[];if(o[0].barSize===+o[0].barSize){var d=!1,p=r/s,f=o.reduce(function(_,x){return _+x.barSize||0},0);f+=(s-1)*c,f>=r&&(f-=(s-1)*c,c=0),f>=r&&p>0&&(d=!0,p*=.9,f=s*p);var y=(r-f)/2>>0,m={offset:y-c,size:0};l=o.reduce(function(_,x){var j={item:x.item,position:{offset:m.offset+m.size+c,size:d?p:x.barSize}},S=[].concat(pW(_),[j]);return m=S[S.length-1].position,x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){S.push({item:E,position:m})}),S},u)}else{var v=is(n,r,0,!0);r-2*v-(s-1)*c<=0&&(c=0);var b=(r-2*v-(s-1)*c)/s;b>1&&(b>>=0);var w=i===+i?Math.min(b,i):b;l=o.reduce(function(_,x,j){var S=[].concat(pW(_),[{item:x.item,position:{offset:v+(b+c)*j+(b-w)/2,size:w}}]);return x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){S.push({item:E,position:S[S.length-1].position})}),S},u)}return l},Bje=function(e,t,n,r){var a=n.children,o=n.width,i=n.margin,s=o-(i.left||0)-(i.right||0),c=dW({children:a,legendWidth:s});if(c){var l=r||{},u=l.width,d=l.height,p=c.align,f=c.verticalAlign,y=c.layout;if((y==="vertical"||y==="horizontal"&&f==="middle")&&p!=="center"&&ye(e[p]))return qt(qt({},e),{},il({},p,e[p]+(u||0)));if((y==="horizontal"||y==="vertical"&&p==="center")&&f!=="middle"&&ye(e[f]))return qt(qt({},e),{},il({},f,e[f]+(d||0)))}return e},zje=function(e,t,n){return gt(t)?!0:e==="horizontal"?t==="yAxis":e==="vertical"||n==="x"?t==="xAxis":n==="y"?t==="yAxis":!0},hW=function(e,t,n,r,a){var o=t.props.children,i=sa(o,Iy).filter(function(c){return zje(r,a,c.props.direction)});if(i&&i.length){var s=i.map(function(c){return c.props.dataKey});return e.reduce(function(c,l){var u=Fa(l,n);if(gt(u))return c;var d=Array.isArray(u)?[Ny(u),Cy(u)]:[u,u],p=s.reduce(function(f,y){var m=Fa(l,y,0),v=d[0]-Math.abs(Array.isArray(m)?m[0]:m),b=d[1]+Math.abs(Array.isArray(m)?m[1]:m);return[Math.min(v,f[0]),Math.max(b,f[1])]},[1/0,-1/0]);return[Math.min(p[0],c[0]),Math.max(p[1],c[1])]},[1/0,-1/0])}return null},Vje=function(e,t,n,r,a){var o=t.map(function(i){return hW(e,i,n,a,r)}).filter(function(i){return!gt(i)});return o&&o.length?o.reduce(function(i,s){return[Math.min(i[0],s[0]),Math.max(i[1],s[1])]},[1/0,-1/0]):null},mW=function(e,t,n,r,a){var o=t.map(function(s){var c=s.props.dataKey;return n==="number"&&c&&hW(e,s,c,r)||Ry(e,c,n,a)});if(n==="number")return o.reduce(function(s,c){return[Math.min(s[0],c[0]),Math.max(s[1],c[1])]},[1/0,-1/0]);var i={};return o.reduce(function(s,c){for(var l=0,u=c.length;l<u;l++)i[c[l]]||(i[c[l]]=!0,s.push(c[l]));return s},[])},yW=function(e,t){return e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis"},gW=function(e,t,n,r){if(r)return e.map(function(s){return s.coordinate});var a,o,i=e.map(function(s){return s.coordinate===t&&(a=!0),s.coordinate===n&&(o=!0),s.coordinate});return a||i.push(t),o||i.push(n),i},$o=function(e,t,n){if(!e)return null;var r=e.scale,a=e.duplicateDomain,o=e.type,i=e.range,s=e.realScaleType==="scaleBand"?r.bandwidth()/2:2,c=(t||n)&&o==="category"&&r.bandwidth?r.bandwidth()/s:0;if(c=e.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?ia(i[0]-i[1])*2*c:c,t&&(e.ticks||e.niceTicks)){var l=(e.ticks||e.niceTicks).map(function(u){var d=a?a.indexOf(u):u;return{coordinate:r(d)+c,value:u,offset:c}});return l.filter(function(u){return!Id(u.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(u,d){return{coordinate:r(u)+c,value:u,index:d,offset:c}}):r.ticks&&!n?r.ticks(e.tickCount).map(function(u){return{coordinate:r(u)+c,value:u,offset:c}}):r.domain().map(function(u,d){return{coordinate:r(u)+c,value:a?a[u]:u,index:d,offset:c}})},XO=new WeakMap,Dy=function(e,t){if(typeof t!="function")return e;XO.has(e)||XO.set(e,new WeakMap);var n=XO.get(e);if(n.has(t))return n.get(t);var r=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return n.set(t,r),r},Wje=function(e,t,n){var r=e.scale,a=e.type,o=e.layout,i=e.axisType;if(r==="auto")return o==="radial"&&i==="radiusAxis"?{scale:Hd(),realScaleType:"band"}:o==="radial"&&i==="angleAxis"?{scale:vy(),realScaleType:"linear"}:a==="category"&&t&&(t.indexOf("LineChart")>=0||t.indexOf("AreaChart")>=0||t.indexOf("ComposedChart")>=0&&!n)?{scale:Kd(),realScaleType:"point"}:a==="category"?{scale:Hd(),realScaleType:"band"}:{scale:vy(),realScaleType:"linear"};if(Td(r)){var s="scale".concat(Km(r));return{scale:(RV[s]||Kd)(),realScaleType:RV[s]?s:"point"}}return tt(r)?{scale:r}:{scale:Kd(),realScaleType:"point"}},vW=1e-4,Uje=function(e){var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-vW,o=Math.max(r[0],r[1])+vW,i=e(t[0]),s=e(t[n-1]);(i<a||i>o||s<a||s>o)&&e.domain([t[0],t[n-1]])}},qje=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null},Hje=function(e,t){if(!t||t.length!==2||!ye(t[0])||!ye(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!ye(e[0])||e[0]<n)&&(a[0]=n),(!ye(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a},Kje=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0,i=0;i<t;++i){var s=Id(e[i][n][1])?e[i][n][0]:e[i][n][1];s>=0?(e[i][n][0]=a,e[i][n][1]=a+s,a=e[i][n][1]):(e[i][n][0]=o,e[i][n][1]=o+s,o=e[i][n][1])}},Zje=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0;o<t;++o){var i=Id(e[o][n][1])?e[o][n][0]:e[o][n][1];i>=0?(e[o][n][0]=a,e[o][n][1]=a+i,a=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}},Xje={sign:Kje,expand:Q0e,none:qc,silhouette:G0e,wiggle:J0e,positive:Zje},Qje=function(e,t,n){var r=t.map(function(i){return i.props.dataKey}),a=Xje[n],o=X0e().keys(r).value(function(i,s){return+Fa(i,s,0)}).order(rE).offset(a);return o(e)},Gje=function(e,t,n,r,a,o){if(!e)return null;var i=o?t.reverse():t,s={},c=i.reduce(function(u,d){var p,f=(p=d.type)!==null&&p!==void 0&&p.defaultProps?qt(qt({},d.type.defaultProps),d.props):d.props,y=f.stackId,m=f.hide;if(m)return u;var v=f[n],b=u[v]||{hasStack:!1,stackGroups:{}};if(on(y)){var w=b.stackGroups[y]||{numericAxisId:n,cateAxisId:r,items:[]};w.items.push(d),b.hasStack=!0,b.stackGroups[y]=w}else b.stackGroups[Um("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[d]};return qt(qt({},u),{},il({},v,b))},s),l={};return Object.keys(c).reduce(function(u,d){var p=c[d];if(p.hasStack){var f={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(y,m){var v=p.stackGroups[m];return qt(qt({},y),{},il({},m,{numericAxisId:n,cateAxisId:r,items:v.items,stackedData:Qje(e,v.items,a)}))},f)}return qt(qt({},u),{},il({},d,p))},l)},Jje=function(e,t){var n=t.realScaleType,r=t.type,a=t.tickCount,o=t.originalDomain,i=t.allowDecimals,s=n||t.scale;if(s!=="auto"&&s!=="linear")return null;if(a&&r==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=e.domain();if(!c.length)return null;var l=lje(c,a,i);return e.domain([Ny(l),Cy(l)]),{niceTicks:l}}if(a&&r==="number"){var u=e.domain(),d=uje(u,a,i);return{niceTicks:d}}return null},bW=function(e){var t=e.axis,n=e.ticks,r=e.offset,a=e.bandSize,o=e.entry,i=e.index;if(t.type==="category")return n[i]?n[i].coordinate+r:null;var s=Fa(o,t.dataKey,t.domain[i]);return gt(s)?null:t.scale(s)-a/2+r},Yje=function(e){var t=e.numericAxis,n=t.scale.domain();if(t.type==="number"){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]},eSe=function(e,t){var n,r=(n=e.type)!==null&&n!==void 0&&n.defaultProps?qt(qt({},e.type.defaultProps),e.props):e.props,a=r.stackId;if(on(a)){var o=t[a];if(o){var i=o.items.indexOf(e);return i>=0?o.stackedData[i]:null}}return null},tSe=function(e){return e.reduce(function(t,n){return[Ny(n.concat([t[0]]).filter(ye)),Cy(n.concat([t[1]]).filter(ye))]},[1/0,-1/0])},wW=function(e,t,n){return Object.keys(e).reduce(function(r,a){var o=e[a],i=o.stackedData,s=i.reduce(function(c,l){var u=tSe(l.slice(t,n+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]).map(function(r){return r===1/0||r===-1/0?0:r})},xW=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,_W=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,QO=function(e,t,n){if(tt(e))return e(t,n);if(!Array.isArray(e))return t;var r=[];if(ye(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(xW.test(e[0])){var a=+xW.exec(e[0])[1];r[0]=t[0]-a}else tt(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(ye(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(_W.test(e[1])){var o=+_W.exec(e[1])[1];r[1]=t[1]+o}else tt(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},Ly=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=zE(t,function(u){return u.coordinate}),o=1/0,i=1,s=a.length;i<s;i++){var c=a[i],l=a[i-1];o=Math.min((c.coordinate||0)-(l.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},jW=function(e,t,n){return!e||!e.length||LO(e,xr(n,"type.defaultProps.domain"))?t:e},SW=function(e,t){var n=e.type.defaultProps?qt(qt({},e.type.defaultProps),e.props):e.props,r=n.dataKey,a=n.name,o=n.unit,i=n.formatter,s=n.tooltipType,c=n.chartType,l=n.hide;return qt(qt({},yt(e,!1)),{},{dataKey:r,unit:o,formatter:i,name:a||r,color:ZO(e),value:Fa(t,r),type:s,payload:t,chartType:c,hide:l})};function ap(e){"@babel/helpers - typeof";return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function EW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function OW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EW(Object(n),!0).forEach(function(r){nSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nSe(e,t,n){return t=rSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rSe(e){var t=aSe(e,"string");return ap(t)=="symbol"?t:t+""}function aSe(e,t){if(ap(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ap(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $y=Math.PI/180,oSe=function(e){return e*180/Math.PI},_n=function(e,t,n,r){return{x:e+Math.cos(-$y*r)*n,y:t+Math.sin(-$y*r)*n}},iSe=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-o,2))},sSe=function(e,t){var n=e.x,r=e.y,a=t.cx,o=t.cy,i=iSe({x:n,y:r},{x:a,y:o});if(i<=0)return{radius:i};var s=(n-a)/i,c=Math.acos(s);return r>o&&(c=2*Math.PI-c),{radius:i,angle:oSe(c),angleInRadian:c}},cSe=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),a=Math.floor(n/360),o=Math.min(r,a);return{startAngle:t-o*360,endAngle:n-o*360}},lSe=function(e,t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),o=Math.floor(r/360),i=Math.min(a,o);return e+i*360},CW=function(e,t){var n=e.x,r=e.y,a=sSe({x:n,y:r},t),o=a.radius,i=a.angle,s=t.innerRadius,c=t.outerRadius;if(o<s||o>c)return!1;if(o===0)return!0;var l=cSe(t),u=l.startAngle,d=l.endAngle,p=i,f;if(u<=d){for(;p>d;)p-=360;for(;p<u;)p+=360;f=p>=u&&p<=d}else{for(;p>u;)p-=360;for(;p<d;)p+=360;f=p>=d&&p<=u}return f?OW(OW({},t),{},{radius:o,angle:lSe(p,t)}):null};function op(e){"@babel/helpers - typeof";return op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},op(e)}var uSe=["offset"];function dSe(e){return mSe(e)||hSe(e)||fSe(e)||pSe()}function pSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fSe(e,t){if(e){if(typeof e=="string")return GO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GO(e,t)}}function hSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mSe(e){if(Array.isArray(e))return GO(e)}function GO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ySe(e,t){if(e==null)return{};var n=gSe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function gSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function NW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function cn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NW(Object(n),!0).forEach(function(r){vSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function vSe(e,t,n){return t=bSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bSe(e){var t=wSe(e,"string");return op(t)=="symbol"?t:t+""}function wSe(e,t){if(op(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(op(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ip(){return ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ip.apply(this,arguments)}var xSe=function(e){var t=e.value,n=e.formatter,r=gt(e.children)?t:e.children;return tt(n)?n(r):r},_Se=function(e,t){var n=ia(t-e),r=Math.min(Math.abs(t-e),360);return n*r},jSe=function(e,t,n){var r=e.position,a=e.viewBox,o=e.offset,i=e.className,s=a,c=s.cx,l=s.cy,u=s.innerRadius,d=s.outerRadius,p=s.startAngle,f=s.endAngle,y=s.clockWise,m=(u+d)/2,v=_Se(p,f),b=v>=0?1:-1,w,_;r==="insideStart"?(w=p+b*o,_=y):r==="insideEnd"?(w=f-b*o,_=!y):r==="end"&&(w=f+b*o,_=y),_=v<=0?_:!_;var x=_n(c,l,m,w),j=_n(c,l,m,w+(_?1:-1)*359),S="M".concat(x.x,",").concat(x.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(_?0:1,`,
    `).concat(j.x,",").concat(j.y),E=gt(e.id)?Um("recharts-radial-line-"):e.id;return U.createElement("text",ip({},n,{dominantBaseline:"central",className:xt("recharts-radial-bar-label",i)}),U.createElement("defs",null,U.createElement("path",{id:E,d:S})),U.createElement("textPath",{xlinkHref:"#".concat(E)},t))},SSe=function(e){var t=e.viewBox,n=e.offset,r=e.position,a=t,o=a.cx,i=a.cy,s=a.innerRadius,c=a.outerRadius,l=a.startAngle,u=a.endAngle,d=(l+u)/2;if(r==="outside"){var p=_n(o,i,c+n,d),f=p.x,y=p.y;return{x:f,y,textAnchor:f>=o?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"end"};var m=(s+c)/2,v=_n(o,i,m,d),b=v.x,w=v.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},ESe=function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,a=e.position,o=t,i=o.x,s=o.y,c=o.width,l=o.height,u=l>=0?1:-1,d=u*r,p=u>0?"end":"start",f=u>0?"start":"end",y=c>=0?1:-1,m=y*r,v=y>0?"end":"start",b=y>0?"start":"end";if(a==="top"){var w={x:i+c/2,y:s-u*r,textAnchor:"middle",verticalAnchor:p};return cn(cn({},w),n?{height:Math.max(s-n.y,0),width:c}:{})}if(a==="bottom"){var _={x:i+c/2,y:s+l+d,textAnchor:"middle",verticalAnchor:f};return cn(cn({},_),n?{height:Math.max(n.y+n.height-(s+l),0),width:c}:{})}if(a==="left"){var x={x:i-m,y:s+l/2,textAnchor:v,verticalAnchor:"middle"};return cn(cn({},x),n?{width:Math.max(x.x-n.x,0),height:l}:{})}if(a==="right"){var j={x:i+c+m,y:s+l/2,textAnchor:b,verticalAnchor:"middle"};return cn(cn({},j),n?{width:Math.max(n.x+n.width-j.x,0),height:l}:{})}var S=n?{width:c,height:l}:{};return a==="insideLeft"?cn({x:i+m,y:s+l/2,textAnchor:b,verticalAnchor:"middle"},S):a==="insideRight"?cn({x:i+c-m,y:s+l/2,textAnchor:v,verticalAnchor:"middle"},S):a==="insideTop"?cn({x:i+c/2,y:s+d,textAnchor:"middle",verticalAnchor:f},S):a==="insideBottom"?cn({x:i+c/2,y:s+l-d,textAnchor:"middle",verticalAnchor:p},S):a==="insideTopLeft"?cn({x:i+m,y:s+d,textAnchor:b,verticalAnchor:f},S):a==="insideTopRight"?cn({x:i+c-m,y:s+d,textAnchor:v,verticalAnchor:f},S):a==="insideBottomLeft"?cn({x:i+m,y:s+l-d,textAnchor:b,verticalAnchor:p},S):a==="insideBottomRight"?cn({x:i+c-m,y:s+l-d,textAnchor:v,verticalAnchor:p},S):Vc(a)&&(ye(a.x)||os(a.x))&&(ye(a.y)||os(a.y))?cn({x:i+is(a.x,c),y:s+is(a.y,l),textAnchor:"end",verticalAnchor:"end"},S):cn({x:i+c/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},S)},OSe=function(e){return"cx"in e&&ye(e.cx)};function Mn(e){var t=e.offset,n=t===void 0?5:t,r=ySe(e,uSe),a=cn({offset:n},r),o=a.viewBox,i=a.position,s=a.value,c=a.children,l=a.content,u=a.className,d=u===void 0?"":u,p=a.textBreakAll;if(!o||gt(s)&&gt(c)&&!g.isValidElement(l)&&!tt(l))return null;if(g.isValidElement(l))return g.cloneElement(l,a);var f;if(tt(l)){if(f=g.createElement(l,a),g.isValidElement(f))return f}else f=xSe(a);var y=OSe(o),m=yt(a,!0);if(y&&(i==="insideStart"||i==="insideEnd"||i==="end"))return jSe(a,f,m);var v=y?SSe(a):ESe(a);return U.createElement(py,ip({className:xt("recharts-label",d)},m,v,{breakAll:p}),f)}Mn.displayName="Label";var MW=function(e){var t=e.cx,n=e.cy,r=e.angle,a=e.startAngle,o=e.endAngle,i=e.r,s=e.radius,c=e.innerRadius,l=e.outerRadius,u=e.x,d=e.y,p=e.top,f=e.left,y=e.width,m=e.height,v=e.clockWise,b=e.labelViewBox;if(b)return b;if(ye(y)&&ye(m)){if(ye(u)&&ye(d))return{x:u,y:d,width:y,height:m};if(ye(p)&&ye(f))return{x:p,y:f,width:y,height:m}}return ye(u)&&ye(d)?{x:u,y:d,width:0,height:0}:ye(t)&&ye(n)?{cx:t,cy:n,startAngle:a||r||0,endAngle:o||r||0,innerRadius:c||0,outerRadius:l||s||i||0,clockWise:v}:e.viewBox?e.viewBox:{}},CSe=function(e,t){return e?e===!0?U.createElement(Mn,{key:"label-implicit",viewBox:t}):on(e)?U.createElement(Mn,{key:"label-implicit",viewBox:t,value:e}):g.isValidElement(e)?e.type===Mn?g.cloneElement(e,{key:"label-implicit",viewBox:t}):U.createElement(Mn,{key:"label-implicit",content:e,viewBox:t}):tt(e)?U.createElement(Mn,{key:"label-implicit",content:e,viewBox:t}):Vc(e)?U.createElement(Mn,ip({viewBox:t},e,{key:"label-implicit"})):null:null},NSe=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=MW(e),o=sa(r,Mn).map(function(s,c){return g.cloneElement(s,{viewBox:t||a,key:"label-".concat(c)})});if(!n)return o;var i=CSe(e.label,t||a);return[i].concat(dSe(o))};Mn.parseViewBox=MW,Mn.renderCallByParent=NSe;var JO,PW;_M=function(){if(PW)return JO;PW=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return JO=e,JO};var MSe=_M();IN=ot(MSe);function sp(e){"@babel/helpers - typeof";return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(e)}var PSe=["valueAccessor"],kSe=["data","dataKey","clockWise","id","textBreakAll"];function ASe(e){return DSe(e)||RSe(e)||ISe(e)||TSe()}function TSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ISe(e,t){if(e){if(typeof e=="string")return YO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YO(e,t)}}function RSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DSe(e){if(Array.isArray(e))return YO(e)}function YO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fy(){return Fy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fy.apply(this,arguments)}function kW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function AW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kW(Object(n),!0).forEach(function(r){LSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function LSe(e,t,n){return t=$Se(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $Se(e){var t=FSe(e,"string");return sp(t)=="symbol"?t:t+""}function FSe(e,t){if(sp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(sp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TW(e,t){if(e==null)return{};var n=BSe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function BSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var zSe=function(e){return Array.isArray(e.value)?IN(e.value):e.value};function ys(e){var t=e.valueAccessor,n=t===void 0?zSe:t,r=TW(e,PSe),a=r.data,o=r.dataKey,i=r.clockWise,s=r.id,c=r.textBreakAll,l=TW(r,kSe);return!a||!a.length?null:U.createElement(pn,{className:"recharts-label-list"},a.map(function(u,d){var p=gt(o)?n(u,d):Fa(u&&u.payload,o),f=gt(s)?{}:{id:"".concat(s,"-").concat(d)};return U.createElement(Mn,Fy({},yt(u,!0),l,f,{parentViewBox:u.parentViewBox,value:p,textBreakAll:c,viewBox:Mn.parseViewBox(gt(i)?u:AW(AW({},u),{},{clockWise:i})),key:"label-".concat(d),index:d}))}))}ys.displayName="LabelList";function VSe(e,t){return e?e===!0?U.createElement(ys,{key:"labelList-implicit",data:t}):U.isValidElement(e)||tt(e)?U.createElement(ys,{key:"labelList-implicit",data:t,content:e}):Vc(e)?U.createElement(ys,Fy({data:t},e,{key:"labelList-implicit"})):null:null}function WSe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=sa(r,ys).map(function(i,s){return g.cloneElement(i,{data:t,key:"labelList-".concat(s)})});if(!n)return a;var o=VSe(e.label,t);return[o].concat(ASe(a))}ys.renderCallByParent=WSe;function cp(e){"@babel/helpers - typeof";return cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cp(e)}function eC(){return eC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eC.apply(this,arguments)}function IW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function RW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IW(Object(n),!0).forEach(function(r){USe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function USe(e,t,n){return t=qSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qSe(e){var t=HSe(e,"string");return cp(t)=="symbol"?t:t+""}function HSe(e,t){if(cp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KSe=function(e,t){var n=ia(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},By=function(e){var t=e.cx,n=e.cy,r=e.radius,a=e.angle,o=e.sign,i=e.isExternal,s=e.cornerRadius,c=e.cornerIsExternal,l=s*(i?1:-1)+r,u=Math.asin(s/l)/$y,d=c?a:a+o*u,p=_n(t,n,l,d),f=_n(t,n,r,d),y=c?a-o*u:a,m=_n(t,n,l*Math.cos(u*$y),y);return{center:p,circleTangency:f,lineTangency:m,theta:u}},DW=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.startAngle,i=e.endAngle,s=KSe(o,i),c=o+s,l=_n(t,n,a,o),u=_n(t,n,a,c),d="M ".concat(l.x,",").concat(l.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(o>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(r>0){var p=_n(t,n,r,o),f=_n(t,n,r,c);d+="L ".concat(f.x,",").concat(f.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(o<=c),`,
            `).concat(p.x,",").concat(p.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},ZSe=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.cornerRadius,i=e.forceCornerRadius,s=e.cornerIsExternal,c=e.startAngle,l=e.endAngle,u=ia(l-c),d=By({cx:t,cy:n,radius:a,angle:c,sign:u,cornerRadius:o,cornerIsExternal:s}),p=d.circleTangency,f=d.lineTangency,y=d.theta,m=By({cx:t,cy:n,radius:a,angle:l,sign:-u,cornerRadius:o,cornerIsExternal:s}),v=m.circleTangency,b=m.lineTangency,w=m.theta,_=s?Math.abs(c-l):Math.abs(c-l)-y-w;if(_<0)return i?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):DW({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:c,endAngle:l});var x="M ".concat(f.x,",").concat(f.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(_>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(r>0){var j=By({cx:t,cy:n,radius:r,angle:c,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),S=j.circleTangency,E=j.lineTangency,O=j.theta,N=By({cx:t,cy:n,radius:r,angle:l,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),M=N.circleTangency,P=N.lineTangency,I=N.theta,k=s?Math.abs(c-l):Math.abs(c-l)-O-I;if(k<0&&o===0)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(P.x,",").concat(P.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(M.x,",").concat(M.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(k>180),",").concat(+(u>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(E.x,",").concat(E.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x},XSe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},LW=function(e){var t=RW(RW({},XSe),e),n=t.cx,r=t.cy,a=t.innerRadius,o=t.outerRadius,i=t.cornerRadius,s=t.forceCornerRadius,c=t.cornerIsExternal,l=t.startAngle,u=t.endAngle,d=t.className;if(o<a||l===u)return null;var p=xt("recharts-sector",d),f=o-a,y=is(i,f,0,!0),m;return y>0&&Math.abs(l-u)<360?m=ZSe({cx:n,cy:r,innerRadius:a,outerRadius:o,cornerRadius:Math.min(y,f/2),forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u}):m=DW({cx:n,cy:r,innerRadius:a,outerRadius:o,startAngle:l,endAngle:u}),U.createElement("path",eC({},yt(t,!0),{className:p,d:m,role:"img"}))};function lp(e){"@babel/helpers - typeof";return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(e)}function tC(){return tC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tC.apply(this,arguments)}function $W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function FW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$W(Object(n),!0).forEach(function(r){QSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$W(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function QSe(e,t,n){return t=GSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GSe(e){var t=JSe(e,"string");return lp(t)=="symbol"?t:t+""}function JSe(e,t){if(lp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(lp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BW={curveBasisClosed:$0e,curveBasisOpen:F0e,curveBasis:L0e,curveBumpX:j0e,curveBumpY:S0e,curveLinearClosed:B0e,curveLinear:Gm,curveMonotoneX:z0e,curveMonotoneY:V0e,curveNatural:W0e,curveStep:U0e,curveStepAfter:H0e,curveStepBefore:q0e},zy=function(e){return e.x===+e.x&&e.y===+e.y},up=function(e){return e.x},dp=function(e){return e.y},YSe=function(e,t){if(tt(e))return e;var n="curve".concat(Km(e));return(n==="curveMonotone"||n==="curveBump")&&t?BW["".concat(n).concat(t==="vertical"?"Y":"X")]:BW[n]||Gm},eEe=function(e){var t=e.type,n=t===void 0?"linear":t,r=e.points,a=r===void 0?[]:r,o=e.baseLine,i=e.layout,s=e.connectNulls,c=s===void 0?!1:s,l=YSe(n,i),u=c?a.filter(function(y){return zy(y)}):a,d;if(Array.isArray(o)){var p=c?o.filter(function(y){return zy(y)}):o,f=u.map(function(y,m){return FW(FW({},y),{},{base:p[m]})});return i==="vertical"?d=Jm().y(dp).x1(up).x0(function(y){return y.base.x}):d=Jm().x(up).y1(dp).y0(function(y){return y.base.y}),d.defined(zy).curve(l),d(f)}return i==="vertical"&&ye(o)?d=Jm().y(dp).x1(up).x0(o):ye(o)?d=Jm().x(up).y1(dp).y0(o):d=UB().x(up).y(dp),d.defined(zy).curve(l),d(u)},zW=function(e){var t=e.className,n=e.points,r=e.path,a=e.pathRef;if((!n||!n.length)&&!r)return null;var o=n&&n.length?eEe(e):r;return U.createElement("path",tC({},yt(e,!1),qm(e),{className:xt("recharts-curve",t),d:o,ref:a}))},VW={exports:{}},nC,WW;function tEe(){if(WW)return nC;WW=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return nC=e,nC}var rC,UW;function nEe(){if(UW)return rC;UW=1;var e=tEe();function t(){}function n(){}return n.resetWarningCache=t,rC=function(){function r(i,s,c,l,u,d){if(d!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o},rC}var qW;function rEe(){return qW||(qW=1,VW.exports=nEe()()),VW.exports}var aEe=rEe();const He=ot(aEe);var oEe=Object.getOwnPropertyNames,iEe=Object.getOwnPropertySymbols,sEe=Object.prototype.hasOwnProperty;function HW(e,t){return function(n,r,a){return e(n,r,a)&&t(n,r,a)}}function Vy(e){return function(t,n,r){if(!t||!n||typeof t!="object"||typeof n!="object")return e(t,n,r);var a=r.cache,o=a.get(t),i=a.get(n);if(o&&i)return o===n&&i===t;a.set(t,n),a.set(n,t);var s=e(t,n,r);return a.delete(t),a.delete(n),s}}function KW(e){return oEe(e).concat(iEe(e))}var ZW=Object.hasOwn||function(e,t){return sEe.call(e,t)};function sl(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var XW="_owner",QW=Object.getOwnPropertyDescriptor,GW=Object.keys;function cEe(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function lEe(e,t){return sl(e.getTime(),t.getTime())}function JW(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.entries(),o=0,i,s;(i=a.next())&&!i.done;){for(var c=t.entries(),l=!1,u=0;(s=c.next())&&!s.done;){var d=i.value,p=d[0],f=d[1],y=s.value,m=y[0],v=y[1];!l&&!r[u]&&(l=n.equals(p,m,o,u,e,t,n)&&n.equals(f,v,p,m,e,t,n))&&(r[u]=!0),u++}if(!l)return!1;o++}return!0}function uEe(e,t,n){var r=GW(e),a=r.length;if(GW(t).length!==a)return!1;for(var o;a-- >0;)if(o=r[a],o===XW&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!ZW(t,o)||!n.equals(e[o],t[o],o,o,e,t,n))return!1;return!0}function pp(e,t,n){var r=KW(e),a=r.length;if(KW(t).length!==a)return!1;for(var o,i,s;a-- >0;)if(o=r[a],o===XW&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!ZW(t,o)||!n.equals(e[o],t[o],o,o,e,t,n)||(i=QW(e,o),s=QW(t,o),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return!1;return!0}function dEe(e,t){return sl(e.valueOf(),t.valueOf())}function pEe(e,t){return e.source===t.source&&e.flags===t.flags}function YW(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.values(),o,i;(o=a.next())&&!o.done;){for(var s=t.values(),c=!1,l=0;(i=s.next())&&!i.done;)!c&&!r[l]&&(c=n.equals(o.value,i.value,o.value,i.value,e,t,n))&&(r[l]=!0),l++;if(!c)return!1}return!0}function fEe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var hEe="[object Arguments]",mEe="[object Boolean]",yEe="[object Date]",gEe="[object Map]",vEe="[object Number]",bEe="[object Object]",wEe="[object RegExp]",xEe="[object Set]",_Ee="[object String]",jEe=Array.isArray,eU=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,tU=Object.assign,SEe=Object.prototype.toString.call.bind(Object.prototype.toString);function EEe(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,a=e.areObjectsEqual,o=e.arePrimitiveWrappersEqual,i=e.areRegExpsEqual,s=e.areSetsEqual,c=e.areTypedArraysEqual;return function(l,u,d){if(l===u)return!0;if(l==null||u==null||typeof l!="object"||typeof u!="object")return l!==l&&u!==u;var p=l.constructor;if(p!==u.constructor)return!1;if(p===Object)return a(l,u,d);if(jEe(l))return t(l,u,d);if(eU!=null&&eU(l))return c(l,u,d);if(p===Date)return n(l,u,d);if(p===RegExp)return i(l,u,d);if(p===Map)return r(l,u,d);if(p===Set)return s(l,u,d);var f=SEe(l);return f===yEe?n(l,u,d):f===wEe?i(l,u,d):f===gEe?r(l,u,d):f===xEe?s(l,u,d):f===bEe?typeof l.then!="function"&&typeof u.then!="function"&&a(l,u,d):f===hEe?a(l,u,d):f===mEe||f===vEe||f===_Ee?o(l,u,d):!1}}function OEe(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,a={areArraysEqual:r?pp:cEe,areDatesEqual:lEe,areMapsEqual:r?HW(JW,pp):JW,areObjectsEqual:r?pp:uEe,arePrimitiveWrappersEqual:dEe,areRegExpsEqual:pEe,areSetsEqual:r?HW(YW,pp):YW,areTypedArraysEqual:r?pp:fEe};if(n&&(a=tU({},a,n(a))),t){var o=Vy(a.areArraysEqual),i=Vy(a.areMapsEqual),s=Vy(a.areObjectsEqual),c=Vy(a.areSetsEqual);a=tU({},a,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c})}return a}function CEe(e){return function(t,n,r,a,o,i,s){return e(t,n,s)}}function NEe(e){var t=e.circular,n=e.comparator,r=e.createState,a=e.equals,o=e.strict;if(r)return function(s,c){var l=r(),u=l.cache,d=u===void 0?t?new WeakMap:void 0:u,p=l.meta;return n(s,c,{cache:d,equals:a,meta:p,strict:o})};if(t)return function(s,c){return n(s,c,{cache:new WeakMap,equals:a,meta:void 0,strict:o})};var i={cache:void 0,equals:a,meta:void 0,strict:o};return function(s,c){return n(s,c,i)}}var MEe=_i();_i({strict:!0}),_i({circular:!0}),_i({circular:!0,strict:!0}),_i({createInternalComparator:function(){return sl}}),_i({strict:!0,createInternalComparator:function(){return sl}}),_i({circular:!0,createInternalComparator:function(){return sl}}),_i({circular:!0,createInternalComparator:function(){return sl},strict:!0});function _i(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,a=e.createState,o=e.strict,i=o===void 0?!1:o,s=OEe(e),c=EEe(s),l=r?r(c):CEe(c);return NEe({circular:n,comparator:c,createState:a,equals:l,strict:i})}function PEe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function nU(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function a(o){n<0&&(n=o),o-n>t?(e(o),n=-1):PEe(a)};requestAnimationFrame(r)}function aC(e){"@babel/helpers - typeof";return aC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aC(e)}function kEe(e){return REe(e)||IEe(e)||TEe(e)||AEe()}function AEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TEe(e,t){if(e){if(typeof e=="string")return rU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rU(e,t)}}function rU(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function IEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function REe(e){if(Array.isArray(e))return e}function DEe(){var e={},t=function(){return null},n=!1,r=function a(o){if(!n){if(Array.isArray(o)){if(!o.length)return;var i=o,s=kEe(i),c=s[0],l=s.slice(1);if(typeof c=="number"){nU(a.bind(null,l),c);return}a(c),nU(a.bind(null,l));return}aC(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){n=!0},start:function(a){n=!1,r(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function fp(e){"@babel/helpers - typeof";return fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fp(e)}function aU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function oU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aU(Object(n),!0).forEach(function(r){iU(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function iU(e,t,n){return t=LEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LEe(e){var t=$Ee(e,"string");return fp(t)==="symbol"?t:String(t)}function $Ee(e,t){if(fp(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(fp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FEe=function(e,t){return[Object.keys(e),Object.keys(t)].reduce(function(n,r){return n.filter(function(a){return r.includes(a)})})},BEe=function(e){return e},zEe=function(e){return e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})},hp=function(e,t){return Object.keys(t).reduce(function(n,r){return oU(oU({},n),{},iU({},r,e(r,t[r])))},{})},sU=function(e,t,n){return e.map(function(r){return"".concat(zEe(r)," ").concat(t,"ms ").concat(n)}).join(",")};function VEe(e,t){return qEe(e)||UEe(e,t)||cU(e,t)||WEe()}function WEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function qEe(e){if(Array.isArray(e))return e}function HEe(e){return XEe(e)||ZEe(e)||cU(e)||KEe()}function KEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cU(e,t){if(e){if(typeof e=="string")return oC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oC(e,t)}}function ZEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XEe(e){if(Array.isArray(e))return oC(e)}function oC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wy=1e-4,lU=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},uU=function(e,t){return e.map(function(n,r){return n*Math.pow(t,r)}).reduce(function(n,r){return n+r})},dU=function(e,t){return function(n){var r=lU(e,t);return uU(r,n)}},QEe=function(e,t){return function(n){var r=lU(e,t),a=[].concat(HEe(r.map(function(o,i){return o*i}).slice(1)),[0]);return uU(a,n)}},pU=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],o=t[2],i=t[3];if(t.length===1)switch(t[0]){case"linear":r=0,a=0,o=1,i=1;break;case"ease":r=.25,a=.1,o=.25,i=1;break;case"ease-in":r=.42,a=0,o=1,i=1;break;case"ease-out":r=.42,a=0,o=.58,i=1;break;case"ease-in-out":r=0,a=0,o=.58,i=1;break;default:{var s=t[0].split("(");if(s[0]==="cubic-bezier"&&s[1].split(")")[0].split(",").length===4){var c=s[1].split(")")[0].split(",").map(function(m){return parseFloat(m)}),l=VEe(c,4);r=l[0],a=l[1],o=l[2],i=l[3]}}}var u=dU(r,o),d=dU(a,i),p=QEe(r,o),f=function(m){return m>1?1:m<0?0:m},y=function(m){for(var v=m>1?1:m,b=v,w=0;w<8;++w){var _=u(b)-v,x=p(b);if(Math.abs(_-v)<Wy||x<Wy)return d(b);b=f(b-_/x)}return d(b)};return y.isStepper=!1,y},GEe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.stiff,n=t===void 0?100:t,r=e.damping,a=r===void 0?8:r,o=e.dt,i=o===void 0?17:o,s=function(c,l,u){var d=-(c-l)*n,p=u*a,f=u+(d-p)*i/1e3,y=u*i/1e3+c;return Math.abs(y-l)<Wy&&Math.abs(f)<Wy?[l,0]:[y,f]};return s.isStepper=!0,s.dt=i,s},JEe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if(typeof r=="string")switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return pU(r);case"spring":return GEe();default:if(r.split("(")[0]==="cubic-bezier")return pU(r)}return typeof r=="function"?r:null};function mp(e){"@babel/helpers - typeof";return mp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mp(e)}function fU(e){return tOe(e)||eOe(e)||mU(e)||YEe()}function YEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tOe(e){if(Array.isArray(e))return sC(e)}function hU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function jn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hU(Object(n),!0).forEach(function(r){iC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function iC(e,t,n){return t=nOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nOe(e){var t=rOe(e,"string");return mp(t)==="symbol"?t:String(t)}function rOe(e,t){if(mp(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(mp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aOe(e,t){return sOe(e)||iOe(e,t)||mU(e,t)||oOe()}function oOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mU(e,t){if(e){if(typeof e=="string")return sC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sC(e,t)}}function sC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function sOe(e){if(Array.isArray(e))return e}var Uy=function(e,t,n){return e+(t-e)*n},cC=function(e){var t=e.from,n=e.to;return t!==n},cOe=function e(t,n,r){var a=hp(function(o,i){if(cC(i)){var s=t(i.from,i.to,i.velocity),c=aOe(s,2),l=c[0],u=c[1];return jn(jn({},i),{},{from:l,velocity:u})}return i},n);return r<1?hp(function(o,i){return cC(i)?jn(jn({},i),{},{velocity:Uy(i.velocity,a[o].velocity,r),from:Uy(i.from,a[o].from,r)}):i},n):e(t,a,r-1)};const lOe=function(e,t,n,r,a){var o=FEe(e,t),i=o.reduce(function(v,b){return jn(jn({},v),{},iC({},b,[e[b],t[b]]))},{}),s=o.reduce(function(v,b){return jn(jn({},v),{},iC({},b,{from:e[b],velocity:0,to:t[b]}))},{}),c=-1,l,u,d=function(){return null},p=function(){return hp(function(v,b){return b.from},s)},f=function(){return!Object.values(s).filter(cC).length},y=function(v){l||(l=v);var b=v-l,w=b/n.dt;s=cOe(n,s,w),a(jn(jn(jn({},e),t),p())),l=v,f()||(c=requestAnimationFrame(d))},m=function(v){u||(u=v);var b=(v-u)/r,w=hp(function(x,j){return Uy.apply(void 0,fU(j).concat([n(b)]))},i);if(a(jn(jn(jn({},e),t),w)),b<1)c=requestAnimationFrame(d);else{var _=hp(function(x,j){return Uy.apply(void 0,fU(j).concat([n(1)]))},i);a(jn(jn(jn({},e),t),_))}};return d=n.isStepper?y:m,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(c)}}};function cl(e){"@babel/helpers - typeof";return cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cl(e)}var uOe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function dOe(e,t){if(e==null)return{};var n=pOe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function pOe(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,o;for(o=0;o<r.length;o++)a=r[o],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function lC(e){return yOe(e)||mOe(e)||hOe(e)||fOe()}function fOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hOe(e,t){if(e){if(typeof e=="string")return uC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uC(e,t)}}function mOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yOe(e){if(Array.isArray(e))return uC(e)}function uC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function la(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yU(Object(n),!0).forEach(function(r){yp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yp(e,t,n){return t=gU(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vOe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gU(r.key),r)}}function bOe(e,t,n){return t&&vOe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gU(e){var t=wOe(e,"string");return cl(t)==="symbol"?t:String(t)}function wOe(e,t){if(cl(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cl(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dC(e,t)}function dC(e,t){return dC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},dC(e,t)}function _Oe(e){var t=jOe();return function(){var n=qy(e),r;if(t){var a=qy(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return pC(this,r)}}function pC(e,t){if(t&&(cl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fC(e)}function fC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qy(e){return qy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qy(e)}var ji=function(e){xOe(n,e);var t=_Oe(n);function n(r,a){var o;gOe(this,n),o=t.call(this,r,a);var i=o.props,s=i.isActive,c=i.attributeName,l=i.from,u=i.to,d=i.steps,p=i.children,f=i.duration;if(o.handleStyleChange=o.handleStyleChange.bind(fC(o)),o.changeStyle=o.changeStyle.bind(fC(o)),!s||f<=0)return o.state={style:{}},typeof p=="function"&&(o.state={style:u}),pC(o);if(d&&d.length)o.state={style:d[0].style};else if(l){if(typeof p=="function")return o.state={style:l},pC(o);o.state={style:c?yp({},c,l):l}}else o.state={style:{}};return o}return bOe(n,[{key:"componentDidMount",value:function(){var r=this.props,a=r.isActive,o=r.canBegin;this.mounted=!0,!(!a||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(r){var a=this.props,o=a.isActive,i=a.canBegin,s=a.attributeName,c=a.shouldReAnimate,l=a.to,u=a.from,d=this.state.style;if(i){if(!o){var p={style:s?yp({},s,l):l};this.state&&d&&(s&&d[s]!==l||!s&&d!==l)&&this.setState(p);return}if(!(MEe(r.to,l)&&r.canBegin&&r.isActive)){var f=!r.canBegin||!r.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var y=f||c?u:r.to;if(this.state&&d){var m={style:s?yp({},s,y):y};(s&&d[s]!==y||!s&&d!==y)&&this.setState(m)}this.runAnimation(la(la({},this.props),{},{from:y,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var r=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),r&&r()}},{key:"handleStyleChange",value:function(r){this.changeStyle(r)}},{key:"changeStyle",value:function(r){this.mounted&&this.setState({style:r})}},{key:"runJSAnimation",value:function(r){var a=this,o=r.from,i=r.to,s=r.duration,c=r.easing,l=r.begin,u=r.onAnimationEnd,d=r.onAnimationStart,p=lOe(o,i,JEe(c),s,this.changeStyle),f=function(){a.stopJSAnimation=p()};this.manager.start([d,l,f,s,u])}},{key:"runStepAnimation",value:function(r){var a=this,o=r.steps,i=r.begin,s=r.onAnimationStart,c=o[0],l=c.style,u=c.duration,d=u===void 0?0:u,p=function(f,y,m){if(m===0)return f;var v=y.duration,b=y.easing,w=b===void 0?"ease":b,_=y.style,x=y.properties,j=y.onAnimationEnd,S=m>0?o[m-1]:y,E=x||Object.keys(_);if(typeof w=="function"||w==="spring")return[].concat(lC(f),[a.runJSAnimation.bind(a,{from:S.style,to:_,duration:v,easing:w}),v]);var O=sU(E,v,w),N=la(la(la({},S.style),_),{},{transition:O});return[].concat(lC(f),[N,v,j]).filter(BEe)};return this.manager.start([s].concat(lC(o.reduce(p,[l,Math.max(d,i)])),[r.onAnimationEnd]))}},{key:"runAnimation",value:function(r){this.manager||(this.manager=DEe());var a=r.begin,o=r.duration,i=r.attributeName,s=r.to,c=r.easing,l=r.onAnimationStart,u=r.onAnimationEnd,d=r.steps,p=r.children,f=this.manager;if(this.unSubscribe=f.subscribe(this.handleStyleChange),typeof c=="function"||typeof p=="function"||c==="spring"){this.runJSAnimation(r);return}if(d.length>1){this.runStepAnimation(r);return}var y=i?yp({},i,s):s,m=sU(Object.keys(y),o,c);f.start([l,a,la(la({},y),{},{transition:m}),o,u])}},{key:"render",value:function(){var r=this.props,a=r.children;r.begin;var o=r.duration;r.attributeName,r.easing;var i=r.isActive;r.steps,r.from,r.to,r.canBegin,r.onAnimationEnd,r.shouldReAnimate,r.onAnimationReStart;var s=dOe(r,uOe),c=g.Children.count(a),l=this.state.style;if(typeof a=="function")return a(l);if(!i||c===0||o<=0)return a;var u=function(d){var p=d.props,f=p.style,y=f===void 0?{}:f,m=p.className,v=g.cloneElement(d,la(la({},s),{},{style:la(la({},y),l),className:m}));return v};return c===1?u(g.Children.only(a)):U.createElement("div",null,g.Children.map(a,function(d){return u(d)}))}}]),n}(g.PureComponent);ji.displayName="Animate",ji.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},ji.propTypes={from:He.oneOfType([He.object,He.string]),to:He.oneOfType([He.object,He.string]),attributeName:He.string,duration:He.number,begin:He.number,easing:He.oneOfType([He.string,He.func]),steps:He.arrayOf(He.shape({duration:He.number.isRequired,style:He.object.isRequired,easing:He.oneOfType([He.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),He.func]),properties:He.arrayOf("string"),onAnimationEnd:He.func})),children:He.oneOfType([He.node,He.func]),isActive:He.bool,canBegin:He.bool,onAnimationEnd:He.func,shouldReAnimate:He.bool,onAnimationStart:He.func,onAnimationReStart:He.func},He.object,He.object,He.object,He.element,He.object,He.object,He.object,He.oneOfType([He.array,He.element]),He.any;function gp(e){"@babel/helpers - typeof";return gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gp(e)}function Hy(){return Hy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hy.apply(this,arguments)}function SOe(e,t){return NOe(e)||COe(e,t)||OOe(e,t)||EOe()}function EOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OOe(e,t){if(e){if(typeof e=="string")return vU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vU(e,t)}}function vU(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function COe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function NOe(e){if(Array.isArray(e))return e}function bU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function wU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bU(Object(n),!0).forEach(function(r){MOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function MOe(e,t,n){return t=POe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function POe(e){var t=kOe(e,"string");return gp(t)=="symbol"?t:t+""}function kOe(e,t){if(gp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(gp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xU=function(e,t,n,r,a){var o=Math.min(Math.abs(n)/2,Math.abs(r)/2),i=r>=0?1:-1,s=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0,l;if(o>0&&a instanceof Array){for(var u=[0,0,0,0],d=0,p=4;d<p;d++)u[d]=a[d]>o?o:a[d];l="M".concat(e,",").concat(t+i*u[0]),u[0]>0&&(l+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+s*u[0],",").concat(t)),l+="L ".concat(e+n-s*u[1],",").concat(t),u[1]>0&&(l+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+n,",").concat(t+i*u[1])),l+="L ".concat(e+n,",").concat(t+r-i*u[2]),u[2]>0&&(l+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+n-s*u[2],",").concat(t+r)),l+="L ".concat(e+s*u[3],",").concat(t+r),u[3]>0&&(l+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+r-i*u[3])),l+="Z"}else if(o>0&&a===+a&&a>0){var f=Math.min(o,a);l="M ".concat(e,",").concat(t+i*f,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e+s*f,",").concat(t,`
            L `).concat(e+n-s*f,",").concat(t,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e+n,",").concat(t+i*f,`
            L `).concat(e+n,",").concat(t+r-i*f,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e+n-s*f,",").concat(t+r,`
            L `).concat(e+s*f,",").concat(t+r,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e,",").concat(t+r-i*f," Z")}else l="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return l},AOe=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,a=t.x,o=t.y,i=t.width,s=t.height;if(Math.abs(i)>0&&Math.abs(s)>0){var c=Math.min(a,a+i),l=Math.max(a,a+i),u=Math.min(o,o+s),d=Math.max(o,o+s);return n>=c&&n<=l&&r>=u&&r<=d}return!1},TOe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},hC=function(e){var t=wU(wU({},TOe),e),n=g.useRef(),r=g.useState(-1),a=SOe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var _=n.current.getTotalLength();_&&i(_)}catch{}},[]);var s=t.x,c=t.y,l=t.width,u=t.height,d=t.radius,p=t.className,f=t.animationEasing,y=t.animationDuration,m=t.animationBegin,v=t.isAnimationActive,b=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||l===0||u===0)return null;var w=xt("recharts-rectangle",p);return b?U.createElement(ji,{canBegin:o>0,from:{width:l,height:u,x:s,y:c},to:{width:l,height:u,x:s,y:c},duration:y,animationEasing:f,isActive:b},function(_){var x=_.width,j=_.height,S=_.x,E=_.y;return U.createElement(ji,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:y,isActive:v,easing:f},U.createElement("path",Hy({},yt(t,!0),{className:w,d:xU(S,E,x,j,d),ref:n})))}):U.createElement("path",Hy({},yt(t,!0),{className:w,d:xU(s,c,l,u,d)}))};function mC(){return mC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mC.apply(this,arguments)}var _U=function(e){var t=e.cx,n=e.cy,r=e.r,a=e.className,o=xt("recharts-dot",a);return t===+t&&n===+n&&r===+r?U.createElement("circle",mC({},yt(e,!1),qm(e),{className:o,cx:t,cy:n,r})):null};function vp(e){"@babel/helpers - typeof";return vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vp(e)}var IOe=["x","y","top","left","width","height","className"];function yC(){return yC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yC.apply(this,arguments)}function jU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ROe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jU(Object(n),!0).forEach(function(r){DOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function DOe(e,t,n){return t=LOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LOe(e){var t=$Oe(e,"string");return vp(t)=="symbol"?t:t+""}function $Oe(e,t){if(vp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(vp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FOe(e,t){if(e==null)return{};var n=BOe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function BOe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var zOe=function(e,t,n,r,a,o){return"M".concat(e,",").concat(a,"v").concat(r,"M").concat(o,",").concat(t,"h").concat(n)},VOe=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.top,i=o===void 0?0:o,s=e.left,c=s===void 0?0:s,l=e.width,u=l===void 0?0:l,d=e.height,p=d===void 0?0:d,f=e.className,y=FOe(e,IOe),m=ROe({x:n,y:a,top:i,left:c,width:u,height:p},y);return!ye(n)||!ye(a)||!ye(u)||!ye(p)||!ye(i)||!ye(c)?null:U.createElement("path",yC({},yt(m,!0),{className:xt("recharts-cross",f),d:zOe(n,a,u,p,i,c)}))},gC,SU;NN=function(){if(SU)return gC;SU=1;var e=po(),t=Cv(),n=ha(),r="[object Object]",a=Function.prototype,o=Object.prototype,i=a.toString,s=o.hasOwnProperty,c=i.call(Object);function l(u){if(!n(u)||e(u)!=r)return!1;var d=t(u);if(d===null)return!0;var p=s.call(d,"constructor")&&d.constructor;return typeof p=="function"&&p instanceof p&&i.call(p)==c}return gC=l,gC};var WOe=NN();const UOe=ot(WOe);var vC,EU;function qOe(){if(EU)return vC;EU=1;var e=po(),t=ha(),n="[object Boolean]";function r(a){return a===!0||a===!1||t(a)&&e(a)==n}return vC=r,vC}var HOe=qOe();const KOe=ot(HOe);function bp(e){"@babel/helpers - typeof";return bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bp(e)}function Ky(){return Ky=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ky.apply(this,arguments)}function ZOe(e,t){return JOe(e)||GOe(e,t)||QOe(e,t)||XOe()}function XOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QOe(e,t){if(e){if(typeof e=="string")return OU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return OU(e,t)}}function OU(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function GOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function JOe(e){if(Array.isArray(e))return e}function CU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function NU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CU(Object(n),!0).forEach(function(r){YOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function YOe(e,t,n){return t=eCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eCe(e){var t=tCe(e,"string");return bp(t)=="symbol"?t:t+""}function tCe(e,t){if(bp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MU=function(e,t,n,r,a){var o=n-r,i;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+n,",").concat(t),i+="L ".concat(e+n-o/2,",").concat(t+a),i+="L ".concat(e+n-o/2-r,",").concat(t+a),i+="L ".concat(e,",").concat(t," Z"),i},nCe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},rCe=function(e){var t=NU(NU({},nCe),e),n=g.useRef(),r=g.useState(-1),a=ZOe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&i(w)}catch{}},[]);var s=t.x,c=t.y,l=t.upperWidth,u=t.lowerWidth,d=t.height,p=t.className,f=t.animationEasing,y=t.animationDuration,m=t.animationBegin,v=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||d!==+d||l===0&&u===0||d===0)return null;var b=xt("recharts-trapezoid",p);return v?U.createElement(ji,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:d,x:s,y:c},to:{upperWidth:l,lowerWidth:u,height:d,x:s,y:c},duration:y,animationEasing:f,isActive:v},function(w){var _=w.upperWidth,x=w.lowerWidth,j=w.height,S=w.x,E=w.y;return U.createElement(ji,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:y,easing:f},U.createElement("path",Ky({},yt(t,!0),{className:b,d:MU(S,E,_,x,j),ref:n})))}):U.createElement("g",null,U.createElement("path",Ky({},yt(t,!0),{className:b,d:MU(s,c,l,u,d)})))},aCe=["option","shapeType","propTransformer","activeClassName","isActive"];function wp(e){"@babel/helpers - typeof";return wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wp(e)}function oCe(e,t){if(e==null)return{};var n=iCe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function iCe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function PU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Zy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?PU(Object(n),!0).forEach(function(r){sCe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function sCe(e,t,n){return t=cCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cCe(e){var t=lCe(e,"string");return wp(t)=="symbol"?t:t+""}function lCe(e,t){if(wp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uCe(e,t){return Zy(Zy({},t),e)}function dCe(e,t){return e==="symbols"}function kU(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return U.createElement(hC,n);case"trapezoid":return U.createElement(rCe,n);case"sector":return U.createElement(LW,n);case"symbols":if(dCe(t))return U.createElement(oE,n);break;default:return null}}function pCe(e){return g.isValidElement(e)?e.props:e}function fCe(e){var t=e.option,n=e.shapeType,r=e.propTransformer,a=r===void 0?uCe:r,o=e.activeClassName,i=o===void 0?"recharts-active-shape":o,s=e.isActive,c=oCe(e,aCe),l;if(g.isValidElement(t))l=g.cloneElement(t,Zy(Zy({},c),pCe(t)));else if(tt(t))l=t(c);else if(UOe(t)&&!KOe(t)){var u=a(t,c);l=U.createElement(kU,{shapeType:n,elementProps:u})}else{var d=c;l=U.createElement(kU,{shapeType:n,elementProps:d})}return s?U.createElement(pn,{className:i},l):l}function Xy(e,t){return t!=null&&"trapezoids"in e.props}function Qy(e,t){return t!=null&&"sectors"in e.props}function xp(e,t){return t!=null&&"points"in e.props}function hCe(e,t){var n,r,a=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,o=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return a&&o}function mCe(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function yCe(e,t){var n=e.x===t.x,r=e.y===t.y,a=e.z===t.z;return n&&r&&a}function gCe(e,t){var n;return Xy(e,t)?n=hCe:Qy(e,t)?n=mCe:xp(e,t)&&(n=yCe),n}function vCe(e,t){var n;return Xy(e,t)?n="trapezoids":Qy(e,t)?n="sectors":xp(e,t)&&(n="points"),n}function bCe(e,t){if(Xy(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(Qy(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return xp(e,t)?t.payload:{}}function wCe(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,a=vCe(n,t),o=bCe(n,t),i=r.filter(function(c,l){var u=LO(o,c),d=n.props[a].filter(function(y){var m=gCe(n,t);return m(y,t)}),p=n.props[a].indexOf(d[d.length-1]),f=l===p;return u&&f}),s=r.indexOf(i[i.length-1]);return s}var bC,AU;function xCe(){if(AU)return bC;AU=1;var e=Math.ceil,t=Math.max;function n(r,a,o,i){for(var s=-1,c=t(e((a-r)/(o||1)),0),l=Array(c);c--;)l[i?c:++s]=r,r+=o;return l}return bC=n,bC}var wC,TU;function _Ce(){if(TU)return wC;TU=1;var e=xCe(),t=Ss(),n=z$();function r(a){return function(o,i,s){return s&&typeof s!="number"&&t(o,i,s)&&(i=s=void 0),o=n(o),i===void 0?(i=o,o=0):i=n(i),s=s===void 0?o<i?1:-1:n(s),e(o,i,s,a)}}return wC=r,wC}var xC,IU;function jCe(){if(IU)return xC;IU=1;var e=_Ce(),t=e();return xC=t,xC}var SCe=jCe();const Gy=ot(SCe);function _p(e){"@babel/helpers - typeof";return _p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_p(e)}function RU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function DU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RU(Object(n),!0).forEach(function(r){LU(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function LU(e,t,n){return t=ECe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ECe(e){var t=OCe(e,"string");return _p(t)=="symbol"?t:t+""}function OCe(e,t){if(_p(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_p(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CCe=["Webkit","Moz","O","ms"],NCe=function(e,t){var n=e.replace(/(\w)/,function(a){return a.toUpperCase()}),r=CCe.reduce(function(a,o){return DU(DU({},a),{},LU({},o+n,t))},{});return r[e]=t,r};function ll(e){"@babel/helpers - typeof";return ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ll(e)}function Jy(){return Jy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jy.apply(this,arguments)}function $U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function _C(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$U(Object(n),!0).forEach(function(r){mr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$U(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function MCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zU(r.key),r)}}function PCe(e,t,n){return t&&FU(e.prototype,t),n&&FU(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kCe(e,t,n){return t=Yy(t),ACe(e,BU()?Reflect.construct(t,n||[],Yy(e).constructor):t.apply(e,n))}function ACe(e,t){if(t&&(ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TCe(e)}function TCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BU=function(){return!!e})()}function Yy(e){return Yy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yy(e)}function ICe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jC(e,t)}function jC(e,t){return jC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},jC(e,t)}function mr(e,t,n){return t=zU(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zU(e){var t=RCe(e,"string");return ll(t)=="symbol"?t:t+""}function RCe(e,t){if(ll(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ll(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DCe=function(e){var t=e.data,n=e.startIndex,r=e.endIndex,a=e.x,o=e.width,i=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,c=Kd().domain(Gy(0,s)).range([a,a+o-i]),l=c.domain().map(function(u){return c(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(n),endX:c(r),scale:c,scaleValues:l}},VU=function(e){return e.changedTouches&&!!e.changedTouches.length},ul=function(e){function t(n){var r;return MCe(this,t),r=kCe(this,t,[n]),mr(r,"handleDrag",function(a){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(a):r.state.isSlideMoving&&r.handleSlideDrag(a)}),mr(r,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&r.handleDrag(a.changedTouches[0])}),mr(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=r.props,o=a.endIndex,i=a.onDragEnd,s=a.startIndex;i==null||i({endIndex:o,startIndex:s})}),r.detachDragEndListener()}),mr(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),mr(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),mr(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),mr(r,"handleSlideDragStart",function(a){var o=VU(a)?a.changedTouches[0]:a;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return ICe(t,e),PCe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var r=n.startX,a=n.endX,o=this.state.scaleValues,i=this.props,s=i.gap,c=i.data,l=c.length-1,u=Math.min(r,a),d=Math.max(r,a),p=t.getIndexInRange(o,u),f=t.getIndexInRange(o,d);return{startIndex:p-p%s,endIndex:f===l?l:f-f%s}}},{key:"getTextOfTick",value:function(n){var r=this.props,a=r.data,o=r.tickFormatter,i=r.dataKey,s=Fa(a[n],i,n);return tt(o)?o(s,n):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var r=this.state,a=r.slideMoveStartX,o=r.startX,i=r.endX,s=this.props,c=s.x,l=s.width,u=s.travellerWidth,d=s.startIndex,p=s.endIndex,f=s.onChange,y=n.pageX-a;y>0?y=Math.min(y,c+l-u-i,c+l-u-o):y<0&&(y=Math.max(y,c-o,c-i));var m=this.getIndex({startX:o+y,endX:i+y});(m.startIndex!==d||m.endIndex!==p)&&f&&f(m),this.setState({startX:o+y,endX:i+y,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,r){var a=VU(r)?r.changedTouches[0]:r;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var r=this.state,a=r.brushMoveStartX,o=r.movingTravellerId,i=r.endX,s=r.startX,c=this.state[o],l=this.props,u=l.x,d=l.width,p=l.travellerWidth,f=l.onChange,y=l.gap,m=l.data,v={startX:this.state.startX,endX:this.state.endX},b=n.pageX-a;b>0?b=Math.min(b,u+d-p-c):b<0&&(b=Math.max(b,u-c)),v[o]=c+b;var w=this.getIndex(v),_=w.startIndex,x=w.endIndex,j=function(){var S=m.length-1;return o==="startX"&&(i>s?_%y===0:x%y===0)||i<s&&x===S||o==="endX"&&(i>s?x%y===0:_%y===0)||i>s&&x===S};this.setState(mr(mr({},o,c+b),"brushMoveStartX",n.pageX),function(){f&&j()&&f(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,r){var a=this,o=this.state,i=o.scaleValues,s=o.startX,c=o.endX,l=this.state[r],u=i.indexOf(l);if(u!==-1){var d=u+n;if(!(d===-1||d>=i.length)){var p=i[d];r==="startX"&&p>=c||r==="endX"&&p<=s||this.setState(mr({},r,p),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.fill,c=n.stroke;return U.createElement("rect",{stroke:c,fill:s,x:r,y:a,width:o,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.data,c=n.children,l=n.padding,u=g.Children.only(c);return u?U.cloneElement(u,{x:r,y:a,width:o,height:i,margin:l,compact:!0,data:s}):null}},{key:"renderTravellerLayer",value:function(n,r){var a,o,i=this,s=this.props,c=s.y,l=s.travellerWidth,u=s.height,d=s.traveller,p=s.ariaLabel,f=s.data,y=s.startIndex,m=s.endIndex,v=Math.max(n,this.props.x),b=_C(_C({},yt(this.props,!1)),{},{x:v,y:c,width:l,height:u}),w=p||"Min value: ".concat((a=f[y])===null||a===void 0?void 0:a.name,", Max value: ").concat((o=f[m])===null||o===void 0?void 0:o.name);return U.createElement(pn,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),i.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,r))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(d,b))}},{key:"renderSlide",value:function(n,r){var a=this.props,o=a.y,i=a.height,s=a.stroke,c=a.travellerWidth,l=Math.min(n,r)+c,u=Math.max(Math.abs(r-n)-c,0);return U.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:s,fillOpacity:.2,x:l,y:o,width:u,height:i})}},{key:"renderText",value:function(){var n=this.props,r=n.startIndex,a=n.endIndex,o=n.y,i=n.height,s=n.travellerWidth,c=n.stroke,l=this.state,u=l.startX,d=l.endX,p=5,f={pointerEvents:"none",fill:c};return U.createElement(pn,{className:"recharts-brush-texts"},U.createElement(py,Jy({textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,d)-p,y:o+i/2},f),this.getTextOfTick(r)),U.createElement(py,Jy({textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,d)+s+p,y:o+i/2},f),this.getTextOfTick(a)))}},{key:"render",value:function(){var n=this.props,r=n.data,a=n.className,o=n.children,i=n.x,s=n.y,c=n.width,l=n.height,u=n.alwaysShowText,d=this.state,p=d.startX,f=d.endX,y=d.isTextActive,m=d.isSlideMoving,v=d.isTravellerMoving,b=d.isTravellerFocused;if(!r||!r.length||!ye(i)||!ye(s)||!ye(c)||!ye(l)||c<=0||l<=0)return null;var w=xt("recharts-brush",a),_=U.Children.count(o)===1,x=NCe("userSelect","none");return U.createElement(pn,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:x},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(p,f),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(f,"endX"),(y||m||v||b||u)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var r=n.x,a=n.y,o=n.width,i=n.height,s=n.stroke,c=Math.floor(a+i/2)-1;return U.createElement(U.Fragment,null,U.createElement("rect",{x:r,y:a,width:o,height:i,fill:s,stroke:"none"}),U.createElement("line",{x1:r+1,y1:c,x2:r+o-1,y2:c,fill:"none",stroke:"#fff"}),U.createElement("line",{x1:r+1,y1:c+2,x2:r+o-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,r){var a;return U.isValidElement(n)?a=U.cloneElement(n,r):tt(n)?a=n(r):a=t.renderDefaultTraveller(r),a}},{key:"getDerivedStateFromProps",value:function(n,r){var a=n.data,o=n.width,i=n.x,s=n.travellerWidth,c=n.updateId,l=n.startIndex,u=n.endIndex;if(a!==r.prevData||c!==r.prevUpdateId)return _C({prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o},a&&a.length?DCe({data:a,width:o,x:i,travellerWidth:s,startIndex:l,endIndex:u}):{scale:null,scaleValues:null});if(r.scale&&(o!==r.prevWidth||i!==r.prevX||s!==r.prevTravellerWidth)){r.scale.range([i,i+o-s]);var d=r.scale.domain().map(function(p){return r.scale(p)});return{prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o,startX:r.scale(n.startIndex),endX:r.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,r){for(var a=n.length,o=0,i=a-1;i-o>1;){var s=Math.floor((o+i)/2);n[s]>r?i=s:o=s}return r>=n[i]?i:o}}])}(g.PureComponent);mr(ul,"displayName","Brush"),mr(ul,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var SC,WU;function LCe(){if(WU)return SC;WU=1;var e=CE();function t(n,r){var a;return e(n,function(o,i,s){return a=r(o,i,s),!a}),!!a}return SC=t,SC}var EC,UU;function $Ce(){if(UU)return EC;UU=1;var e=AI(),t=_a(),n=LCe(),r=In(),a=Ss();function o(i,s,c){var l=r(i)?e:n;return c&&a(i,s,c)&&(s=void 0),l(i,t(s,3))}return EC=o,EC}var FCe=$Ce();const BCe=ot(FCe);var Ba=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},OC,qU;function zCe(){if(qU)return OC;qU=1;var e=Dg(),t=Iz(),n=_a();function r(a,o){var i={};return o=n(o,3),t(a,function(s,c,l){e(i,c,o(s,c,l))}),i}return OC=r,OC}var VCe=zCe();const WCe=ot(VCe);var CC,HU;function UCe(){if(HU)return CC;HU=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(!n(t[r],r,t))return!1;return!0}return CC=e,CC}var NC,KU;function qCe(){if(KU)return NC;KU=1;var e=CE();function t(n,r){var a=!0;return e(n,function(o,i,s){return a=!!r(o,i,s),a}),a}return NC=t,NC}var MC,ZU;function HCe(){if(ZU)return MC;ZU=1;var e=UCe(),t=qCe(),n=_a(),r=In(),a=Ss();function o(i,s,c){var l=r(i)?e:t;return c&&a(i,s,c)&&(s=void 0),l(i,n(s,3))}return MC=o,MC}var KCe=HCe();const XU=ot(KCe);var ZCe=["x","y"];function jp(e){"@babel/helpers - typeof";return jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(e)}function PC(){return PC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PC.apply(this,arguments)}function QU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Sp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?QU(Object(n),!0).forEach(function(r){XCe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function XCe(e,t,n){return t=QCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QCe(e){var t=GCe(e,"string");return jp(t)=="symbol"?t:t+""}function GCe(e,t){if(jp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(jp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JCe(e,t){if(e==null)return{};var n=YCe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YCe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function eNe(e,t){var n=e.x,r=e.y,a=JCe(e,ZCe),o="".concat(n),i=parseInt(o,10),s="".concat(r),c=parseInt(s,10),l="".concat(t.height||a.height),u=parseInt(l,10),d="".concat(t.width||a.width),p=parseInt(d,10);return Sp(Sp(Sp(Sp(Sp({},t),a),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:p,name:t.name,radius:t.radius})}function GU(e){return U.createElement(fCe,PC({shapeType:"rectangle",propTransformer:eNe,activeClassName:"recharts-active-bar"},e))}var tNe=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,r){if(typeof e=="number")return e;var a=typeof n=="number";return a?e(n,r):(a||hs(),t)}},nNe=["value","background"],JU;function dl(e){"@babel/helpers - typeof";return dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dl(e)}function rNe(e,t){if(e==null)return{};var n=aNe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aNe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function eg(){return eg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eg.apply(this,arguments)}function YU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YU(Object(n),!0).forEach(function(r){Si(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function oNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nq(r.key),r)}}function iNe(e,t,n){return t&&eq(e.prototype,t),n&&eq(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function sNe(e,t,n){return t=tg(t),cNe(e,tq()?Reflect.construct(t,n||[],tg(e).constructor):t.apply(e,n))}function cNe(e,t){if(t&&(dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lNe(e)}function lNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tq=function(){return!!e})()}function tg(e){return tg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tg(e)}function uNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kC(e,t)}function kC(e,t){return kC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},kC(e,t)}function Si(e,t,n){return t=nq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nq(e){var t=dNe(e,"string");return dl(t)=="symbol"?t:t+""}function dNe(e,t){if(dl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(dl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gs=function(e){function t(){var n;oNe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=sNe(this,t,[].concat(a)),Si(n,"state",{isAnimationFinished:!1}),Si(n,"id",Um("recharts-bar-")),Si(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),i&&i()}),Si(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),i&&i()}),n}return uNe(t,e),iNe(t,[{key:"renderRectanglesStatically",value:function(n){var r=this,a=this.props,o=a.shape,i=a.dataKey,s=a.activeIndex,c=a.activeBar,l=yt(this.props,!1);return n&&n.map(function(u,d){var p=d===s,f=p?c:o,y=en(en(en({},l),u),{},{isActive:p,option:f,index:d,dataKey:i,onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd});return U.createElement(pn,eg({className:"recharts-bar-rectangle"},Hm(r.props,u,d),{key:"rectangle-".concat(u==null?void 0:u.x,"-").concat(u==null?void 0:u.y,"-").concat(u==null?void 0:u.value)}),U.createElement(GU,y))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,r=this.props,a=r.data,o=r.layout,i=r.isAnimationActive,s=r.animationBegin,c=r.animationDuration,l=r.animationEasing,u=r.animationId,d=this.state.prevData;return U.createElement(ji,{begin:s,duration:c,isActive:i,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var f=p.t,y=a.map(function(m,v){var b=d&&d[v];if(b){var w=Wc(b.x,m.x),_=Wc(b.y,m.y),x=Wc(b.width,m.width),j=Wc(b.height,m.height);return en(en({},m),{},{x:w(f),y:_(f),width:x(f),height:j(f)})}if(o==="horizontal"){var S=Wc(0,m.height),E=S(f);return en(en({},m),{},{y:m.y+m.height-E,height:E})}var O=Wc(0,m.width),N=O(f);return en(en({},m),{},{width:N})});return U.createElement(pn,null,n.renderRectanglesStatically(y))})}},{key:"renderRectangles",value:function(){var n=this.props,r=n.data,a=n.isAnimationActive,o=this.state.prevData;return a&&r&&r.length&&(!o||!LO(o,r))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(r)}},{key:"renderBackground",value:function(){var n=this,r=this.props,a=r.data,o=r.dataKey,i=r.activeIndex,s=yt(this.props.background,!1);return a.map(function(c,l){c.value;var u=c.background,d=rNe(c,nNe);if(!u)return null;var p=en(en(en(en(en({},d),{},{fill:"#eee"},u),s),Hm(n.props,c,l)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:l,className:"recharts-bar-background-rectangle"});return U.createElement(GU,eg({key:"background-bar-".concat(l),option:n.props.background,isActive:l===i},p))})}},{key:"renderErrorBar",value:function(n,r){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.data,i=a.xAxis,s=a.yAxis,c=a.layout,l=a.children,u=sa(l,Iy);if(!u)return null;var d=c==="vertical"?o[0].height/2:o[0].width/2,p=function(y,m){var v=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:v,errorVal:Fa(y,m)}},f={clipPath:n?"url(#clipPath-".concat(r,")"):null};return U.createElement(pn,f,u.map(function(y){return U.cloneElement(y,{key:"error-bar-".concat(r,"-").concat(y.props.dataKey),data:o,xAxis:i,yAxis:s,layout:c,offset:d,dataPointFormatter:p})}))}},{key:"render",value:function(){var n=this.props,r=n.hide,a=n.data,o=n.className,i=n.xAxis,s=n.yAxis,c=n.left,l=n.top,u=n.width,d=n.height,p=n.isAnimationActive,f=n.background,y=n.id;if(r||!a||!a.length)return null;var m=this.state.isAnimationFinished,v=xt("recharts-bar",o),b=i&&i.allowDataOverflow,w=s&&s.allowDataOverflow,_=b||w,x=gt(y)?this.id:y;return U.createElement(pn,{className:v},b||w?U.createElement("defs",null,U.createElement("clipPath",{id:"clipPath-".concat(x)},U.createElement("rect",{x:b?c:c-u/2,y:w?l:l-d/2,width:b?u:u*2,height:w?d:d*2}))):null,U.createElement(pn,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(x,")"):null},f?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,x),(!p||m)&&ys.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,r){return n.animationId!==r.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:r.curData}:n.data!==r.curData?{curData:n.data}:null}}])}(g.PureComponent);JU=gs,Si(gs,"displayName","Bar"),Si(gs,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!gi.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),Si(gs,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,o=e.xAxis,i=e.yAxis,s=e.xAxisTicks,c=e.yAxisTicks,l=e.stackedData,u=e.dataStartIndex,d=e.displayedData,p=e.offset,f=qje(r,n);if(!f)return null;var y=t.layout,m=n.type.defaultProps,v=m!==void 0?en(en({},m),n.props):n.props,b=v.dataKey,w=v.children,_=v.minPointSize,x=y==="horizontal"?i:o,j=l?x.scale.domain():null,S=Yje({numericAxis:x}),E=sa(w,h7),O=d.map(function(N,M){var P,I,k,C,T,A;l?P=Hje(l[u+M],j):(P=Fa(N,b),Array.isArray(P)||(P=[S,P]));var R=tNe(_,JU.defaultProps.minPointSize)(P[1],M);if(y==="horizontal"){var L,D=[i.scale(P[0]),i.scale(P[1])],B=D[0],F=D[1];I=bW({axis:o,ticks:s,bandSize:a,offset:f.offset,entry:N,index:M}),k=(L=F??B)!==null&&L!==void 0?L:void 0,C=f.size;var $=B-F;if(T=Number.isNaN($)?0:$,A={x:I,y:i.y,width:C,height:i.height},Math.abs(R)>0&&Math.abs(T)<Math.abs(R)){var V=ia(T||R)*(Math.abs(R)-Math.abs(T));k-=V,T+=V}}else{var Q=[o.scale(P[0]),o.scale(P[1])],X=Q[0],H=Q[1];if(I=X,k=bW({axis:i,ticks:c,bandSize:a,offset:f.offset,entry:N,index:M}),C=H-X,T=f.size,A={x:o.x,y:k,width:o.width,height:T},Math.abs(R)>0&&Math.abs(C)<Math.abs(R)){var J=ia(C||R)*(Math.abs(R)-Math.abs(C));C+=J}}return en(en(en({},N),{},{x:I,y:k,width:C,height:T,value:l?P:P[1],payload:N,background:A},E&&E[M]&&E[M].props),{},{tooltipPayload:[SW(n,N)],tooltipPosition:{x:I+C/2,y:k+T/2}})});return en({data:O,layout:y},p)});function Ep(e){"@babel/helpers - typeof";return Ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ep(e)}function pNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oq(r.key),r)}}function fNe(e,t,n){return t&&rq(e.prototype,t),n&&rq(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function aq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ua(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aq(Object(n),!0).forEach(function(r){ng(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ng(e,t,n){return t=oq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oq(e){var t=hNe(e,"string");return Ep(t)=="symbol"?t:t+""}function hNe(e,t){if(Ep(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ep(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mNe=function(e,t,n,r,a){var o=e.width,i=e.height,s=e.layout,c=e.children,l=Object.keys(t),u={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},d=!!fr(c,gs);return l.reduce(function(p,f){var y=t[f],m=y.orientation,v=y.domain,b=y.padding,w=b===void 0?{}:b,_=y.mirror,x=y.reversed,j="".concat(m).concat(_?"Mirror":""),S,E,O,N,M;if(y.type==="number"&&(y.padding==="gap"||y.padding==="no-gap")){var P=v[1]-v[0],I=1/0,k=y.categoricalDomain.sort();if(k.forEach(function(V,Q){Q>0&&(I=Math.min((V||0)-(k[Q-1]||0),I))}),Number.isFinite(I)){var C=I/P,T=y.layout==="vertical"?n.height:n.width;if(y.padding==="gap"&&(S=C*T/2),y.padding==="no-gap"){var A=is(e.barCategoryGap,C*T),R=C*T/2;S=R-A-(R-A)/T*A}}}r==="xAxis"?E=[n.left+(w.left||0)+(S||0),n.left+n.width-(w.right||0)-(S||0)]:r==="yAxis"?E=s==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(S||0),n.top+n.height-(w.bottom||0)-(S||0)]:E=y.range,x&&(E=[E[1],E[0]]);var L=Wje(y,a,d),D=L.scale,B=L.realScaleType;D.domain(v).range(E),Uje(D);var F=Jje(D,ua(ua({},y),{},{realScaleType:B}));r==="xAxis"?(M=m==="top"&&!_||m==="bottom"&&_,O=n.left,N=u[j]-M*y.height):r==="yAxis"&&(M=m==="left"&&!_||m==="right"&&_,O=u[j]-M*y.width,N=n.top);var $=ua(ua(ua({},y),F),{},{realScaleType:B,x:O,y:N,scale:D,width:r==="xAxis"?n.width:y.width,height:r==="yAxis"?n.height:y.height});return $.bandSize=Ly($,F),!y.hide&&r==="xAxis"?u[j]+=(M?-1:1)*$.height:y.hide||(u[j]+=(M?-1:1)*$.width),ua(ua({},p),{},ng({},f,$))},{})},iq=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return{x:Math.min(n,a),y:Math.min(r,o),width:Math.abs(a-n),height:Math.abs(o-r)}},yNe=function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return iq({x:t,y:n},{x:r,y:a})},sq=function(){function e(t){pNe(this,e),this.scale=t}return fNe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.bandAware,a=n.position;if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}},{key:"isInRange",value:function(t){var n=this.range(),r=n[0],a=n[n.length-1];return r<=a?t>=r&&t<=a:t>=a&&t<=r}}],[{key:"create",value:function(t){return new e(t)}}])}();ng(sq,"EPS",1e-4);var AC=function(e){var t=Object.keys(e).reduce(function(n,r){return ua(ua({},n),{},ng({},r,sq.create(e[r])))},{});return ua(ua({},t),{},{apply:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.bandAware,o=r.position;return WCe(n,function(i,s){return t[s].apply(i,{bandAware:a,position:o})})},isInRange:function(n){return XU(n,function(r,a){return t[a].isInRange(r)})}})};function gNe(e){return(e%180+180)%180}var vNe=function(e){var t=e.width,n=e.height,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=gNe(r),o=a*Math.PI/180,i=Math.atan(n/t),s=o>i&&o<Math.PI-i?n/Math.sin(o):t/Math.cos(o);return Math.abs(s)},TC,cq;function bNe(){if(cq)return TC;cq=1;var e=_a(),t=Ni(),n=zl();function r(a){return function(o,i,s){var c=Object(o);if(!t(o)){var l=e(i,3);o=n(o),i=function(d){return l(c[d],d,c)}}var u=a(o,i,s);return u>-1?c[l?o[u]:u]:void 0}}return TC=r,TC}var IC,lq;function wNe(){if(lq)return IC;lq=1;var e=pz(),t=_a(),n=W$(),r=Math.max;function a(o,i,s){var c=o==null?0:o.length;if(!c)return-1;var l=s==null?0:n(s);return l<0&&(l=r(c+l,0)),e(o,t(i,3),l)}return IC=a,IC}var RC,uq;function xNe(){if(uq)return RC;uq=1;var e=bNe(),t=wNe(),n=e(t);return RC=n,RC}var _Ne=xNe();const jNe=ot(_Ne);var SNe=DR(),ENe=ot(SNe)(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),DC=g.createContext(void 0),LC=g.createContext(void 0),dq=g.createContext(void 0),pq=g.createContext({}),fq=g.createContext(void 0),hq=g.createContext(0),mq=g.createContext(0),yq=function(e){var t=e.state,n=t.xAxisMap,r=t.yAxisMap,a=t.offset,o=e.clipPathId,i=e.children,s=e.width,c=e.height,l=ENe(a);return U.createElement(DC.Provider,{value:n},U.createElement(LC.Provider,{value:r},U.createElement(pq.Provider,{value:a},U.createElement(dq.Provider,{value:l},U.createElement(fq.Provider,{value:o},U.createElement(hq.Provider,{value:c},U.createElement(mq.Provider,{value:s},i)))))))},ONe=function(){return g.useContext(fq)},gq=function(e){var t=g.useContext(DC);t==null&&hs();var n=t[e];return n==null&&hs(),n},CNe=function(){var e=g.useContext(DC);return yi(e)},NNe=function(){var e=g.useContext(LC),t=jNe(e,function(n){return XU(n.domain,Number.isFinite)});return t||yi(e)},vq=function(e){var t=g.useContext(LC);t==null&&hs();var n=t[e];return n==null&&hs(),n},MNe=function(){var e=g.useContext(dq);return e},PNe=function(){return g.useContext(pq)},$C=function(){return g.useContext(mq)},FC=function(){return g.useContext(hq)};function pl(e){"@babel/helpers - typeof";return pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pl(e)}function kNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ANe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_q(r.key),r)}}function TNe(e,t,n){return t&&ANe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function INe(e,t,n){return t=rg(t),RNe(e,bq()?Reflect.construct(t,n||[],rg(e).constructor):t.apply(e,n))}function RNe(e,t){if(t&&(pl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DNe(e)}function DNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bq=function(){return!!e})()}function rg(e){return rg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rg(e)}function LNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BC(e,t)}function BC(e,t){return BC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},BC(e,t)}function wq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function xq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wq(Object(n),!0).forEach(function(r){zC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function zC(e,t,n){return t=_q(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _q(e){var t=$Ne(e,"string");return pl(t)=="symbol"?t:t+""}function $Ne(e,t){if(pl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(pl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FNe(e,t){return WNe(e)||VNe(e,t)||zNe(e,t)||BNe()}function BNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zNe(e,t){if(e){if(typeof e=="string")return jq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jq(e,t)}}function jq(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function VNe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function WNe(e){if(Array.isArray(e))return e}function VC(){return VC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VC.apply(this,arguments)}var UNe=function(e,t){var n;return U.isValidElement(e)?n=U.cloneElement(e,t):tt(e)?n=e(t):n=U.createElement("line",VC({},t,{className:"recharts-reference-line-line"})),n},qNe=function(e,t,n,r,a,o,i,s,c){var l=a.x,u=a.y,d=a.width,p=a.height;if(n){var f=c.y,y=e.y.apply(f,{position:o});if(Ba(c,"discard")&&!e.y.isInRange(y))return null;var m=[{x:l+d,y},{x:l,y}];return s==="left"?m.reverse():m}if(t){var v=c.x,b=e.x.apply(v,{position:o});if(Ba(c,"discard")&&!e.x.isInRange(b))return null;var w=[{x:b,y:u+p},{x:b,y:u}];return i==="top"?w.reverse():w}if(r){var _=c.segment,x=_.map(function(j){return e.apply(j,{position:o})});return Ba(c,"discard")&&BCe(x,function(j){return!e.isInRange(j)})?null:x}return null};function HNe(e){var t=e.x,n=e.y,r=e.segment,a=e.xAxisId,o=e.yAxisId,i=e.shape,s=e.className,c=e.alwaysShow,l=ONe(),u=gq(a),d=vq(o),p=MNe();if(!l||!p)return null;Mo(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=AC({x:u.scale,y:d.scale}),y=on(t),m=on(n),v=r&&r.length===2,b=qNe(f,y,m,v,p,e.position,u.orientation,d.orientation,e);if(!b)return null;var w=FNe(b,2),_=w[0],x=_.x,j=_.y,S=w[1],E=S.x,O=S.y,N=Ba(e,"hidden")?"url(#".concat(l,")"):void 0,M=xq(xq({clipPath:N},yt(e,!0)),{},{x1:x,y1:j,x2:E,y2:O});return U.createElement(pn,{className:xt("recharts-reference-line",s)},UNe(i,M),Mn.renderCallByParent(e,yNe({x1:x,y1:j,x2:E,y2:O})))}var WC=function(e){function t(){return kNe(this,t),INe(this,t,arguments)}return LNe(t,e),TNe(t,[{key:"render",value:function(){return U.createElement(HNe,this.props)}}])}(U.Component);zC(WC,"displayName","ReferenceLine"),zC(WC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function UC(){return UC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UC.apply(this,arguments)}function fl(e){"@babel/helpers - typeof";return fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fl(e)}function Sq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Eq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Sq(Object(n),!0).forEach(function(r){og(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function KNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZNe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Cq(r.key),r)}}function XNe(e,t,n){return t&&ZNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function QNe(e,t,n){return t=ag(t),GNe(e,Oq()?Reflect.construct(t,n||[],ag(e).constructor):t.apply(e,n))}function GNe(e,t){if(t&&(fl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JNe(e)}function JNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Oq=function(){return!!e})()}function ag(e){return ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ag(e)}function YNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qC(e,t)}function qC(e,t){return qC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},qC(e,t)}function og(e,t,n){return t=Cq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cq(e){var t=eMe(e,"string");return fl(t)=="symbol"?t:t+""}function eMe(e,t){if(fl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(fl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tMe=function(e){var t=e.x,n=e.y,r=e.xAxis,a=e.yAxis,o=AC({x:r.scale,y:a.scale}),i=o.apply({x:t,y:n},{bandAware:!0});return Ba(e,"discard")&&!o.isInRange(i)?null:i},ig=function(e){function t(){return KNe(this,t),QNe(this,t,arguments)}return YNe(t,e),XNe(t,[{key:"render",value:function(){var n=this.props,r=n.x,a=n.y,o=n.r,i=n.alwaysShow,s=n.clipPathId,c=on(r),l=on(a);if(Mo(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!l)return null;var u=tMe(this.props);if(!u)return null;var d=u.x,p=u.y,f=this.props,y=f.shape,m=f.className,v=Ba(this.props,"hidden")?"url(#".concat(s,")"):void 0,b=Eq(Eq({clipPath:v},yt(this.props,!0)),{},{cx:d,cy:p});return U.createElement(pn,{className:xt("recharts-reference-dot",m)},t.renderDot(y,b),Mn.renderCallByParent(this.props,{x:d-o,y:p-o,width:2*o,height:2*o}))}}])}(U.Component);og(ig,"displayName","ReferenceDot"),og(ig,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),og(ig,"renderDot",function(e,t){var n;return U.isValidElement(e)?n=U.cloneElement(e,t):tt(e)?n=e(t):n=U.createElement(_U,UC({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function HC(){return HC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HC.apply(this,arguments)}function hl(e){"@babel/helpers - typeof";return hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hl(e)}function Nq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Mq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Nq(Object(n),!0).forEach(function(r){cg(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rMe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kq(r.key),r)}}function aMe(e,t,n){return t&&rMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oMe(e,t,n){return t=sg(t),iMe(e,Pq()?Reflect.construct(t,n||[],sg(e).constructor):t.apply(e,n))}function iMe(e,t){if(t&&(hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sMe(e)}function sMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pq=function(){return!!e})()}function sg(e){return sg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sg(e)}function cMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KC(e,t)}function KC(e,t){return KC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},KC(e,t)}function cg(e,t,n){return t=kq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kq(e){var t=lMe(e,"string");return hl(t)=="symbol"?t:t+""}function lMe(e,t){if(hl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(hl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uMe=function(e,t,n,r,a){var o=a.x1,i=a.x2,s=a.y1,c=a.y2,l=a.xAxis,u=a.yAxis;if(!l||!u)return null;var d=AC({x:l.scale,y:u.scale}),p={x:e?d.x.apply(o,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(s,{position:"start"}):d.y.rangeMin},f={x:t?d.x.apply(i,{position:"end"}):d.x.rangeMax,y:r?d.y.apply(c,{position:"end"}):d.y.rangeMax};return Ba(a,"discard")&&(!d.isInRange(p)||!d.isInRange(f))?null:iq(p,f)},lg=function(e){function t(){return nMe(this,t),oMe(this,t,arguments)}return cMe(t,e),aMe(t,[{key:"render",value:function(){var n=this.props,r=n.x1,a=n.x2,o=n.y1,i=n.y2,s=n.className,c=n.alwaysShow,l=n.clipPathId;Mo(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=on(r),d=on(a),p=on(o),f=on(i),y=this.props.shape;if(!u&&!d&&!p&&!f&&!y)return null;var m=uMe(u,d,p,f,this.props);if(!m&&!y)return null;var v=Ba(this.props,"hidden")?"url(#".concat(l,")"):void 0;return U.createElement(pn,{className:xt("recharts-reference-area",s)},t.renderRect(y,Mq(Mq({clipPath:v},yt(this.props,!0)),m)),Mn.renderCallByParent(this.props,m))}}])}(U.Component);cg(lg,"displayName","ReferenceArea"),cg(lg,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),cg(lg,"renderRect",function(e,t){var n;return U.isValidElement(e)?n=U.cloneElement(e,t):tt(e)?n=e(t):n=U.createElement(hC,HC({},t,{className:"recharts-reference-area-rect"})),n});function Aq(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function dMe(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return vNe(r,n)}function pMe(e,t,n){var r=n==="width",a=e.x,o=e.y,i=e.width,s=e.height;return t===1?{start:r?a:o,end:r?a+i:o+s}:{start:r?a+i:o+s,end:r?a:o}}function ug(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var o=n();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-a)<=0}function fMe(e,t){return Aq(e,t+1)}function hMe(e,t,n,r,a){for(var o=(r||[]).slice(),i=t.start,s=t.end,c=0,l=1,u=i,d=function(){var f=r==null?void 0:r[c];if(f===void 0)return{v:Aq(r,l)};var y=c,m,v=function(){return m===void 0&&(m=n(f,y)),m},b=f.coordinate,w=c===0||ug(e,b,v,u,s);w||(c=0,u=i,l+=1),w&&(u=b+e*(v()/2+a),c+=l)},p;l<=o.length;)if(p=d(),p)return p.v;return[]}function Op(e){"@babel/helpers - typeof";return Op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Op(e)}function Tq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Tq(Object(n),!0).forEach(function(r){mMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function mMe(e,t,n){return t=yMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yMe(e){var t=gMe(e,"string");return Op(t)=="symbol"?t:t+""}function gMe(e,t){if(Op(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Op(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vMe(e,t,n,r,a){for(var o=(r||[]).slice(),i=o.length,s=t.start,c=t.end,l=function(d){var p=o[d],f,y=function(){return f===void 0&&(f=n(p,d)),f};if(d===i-1){var m=e*(p.coordinate+e*y()/2-c);o[d]=p=Pn(Pn({},p),{},{tickCoord:m>0?p.coordinate-m*e:p.coordinate})}else o[d]=p=Pn(Pn({},p),{},{tickCoord:p.coordinate});var v=ug(e,p.tickCoord,y,s,c);v&&(c=p.tickCoord-e*(y()/2+a),o[d]=Pn(Pn({},p),{},{isShow:!0}))},u=i-1;u>=0;u--)l(u);return o}function bMe(e,t,n,r,a,o){var i=(r||[]).slice(),s=i.length,c=t.start,l=t.end;if(o){var u=r[s-1],d=n(u,s-1),p=e*(u.coordinate+e*d/2-l);i[s-1]=u=Pn(Pn({},u),{},{tickCoord:p>0?u.coordinate-p*e:u.coordinate});var f=ug(e,u.tickCoord,function(){return d},c,l);f&&(l=u.tickCoord-e*(d/2+a),i[s-1]=Pn(Pn({},u),{},{isShow:!0}))}for(var y=o?s-1:s,m=function(b){var w=i[b],_,x=function(){return _===void 0&&(_=n(w,b)),_};if(b===0){var j=e*(w.coordinate-e*x()/2-c);i[b]=w=Pn(Pn({},w),{},{tickCoord:j<0?w.coordinate-j*e:w.coordinate})}else i[b]=w=Pn(Pn({},w),{},{tickCoord:w.coordinate});var S=ug(e,w.tickCoord,x,c,l);S&&(c=w.tickCoord+e*(x()/2+a),i[b]=Pn(Pn({},w),{},{isShow:!0}))},v=0;v<y;v++)m(v);return i}function ZC(e,t,n){var r=e.tick,a=e.ticks,o=e.viewBox,i=e.minTickGap,s=e.orientation,c=e.interval,l=e.tickFormatter,u=e.unit,d=e.angle;if(!a||!a.length||!r)return[];if(ye(c)||gi.isSsr)return fMe(a,typeof c=="number"&&ye(c)?c:0);var p=[],f=s==="top"||s==="bottom"?"width":"height",y=u&&f==="width"?Vd(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},m=function(w,_){var x=tt(l)?l(w.value,_):w.value;return f==="width"?dMe(Vd(x,{fontSize:t,letterSpacing:n}),y,d):Vd(x,{fontSize:t,letterSpacing:n})[f]},v=a.length>=2?ia(a[1].coordinate-a[0].coordinate):1,b=pMe(o,v,f);return c==="equidistantPreserveStart"?hMe(v,b,m,a,i):(c==="preserveStart"||c==="preserveStartEnd"?p=bMe(v,b,m,a,i,c==="preserveStartEnd"):p=vMe(v,b,m,a,i),p.filter(function(w){return w.isShow}))}var wMe=["viewBox"],xMe=["viewBox"],_Me=["ticks"];function ml(e){"@babel/helpers - typeof";return ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ml(e)}function yl(){return yl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yl.apply(this,arguments)}function Iq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function zn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Iq(Object(n),!0).forEach(function(r){GC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Iq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function XC(e,t){if(e==null)return{};var n=jMe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function jMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function SMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Lq(r.key),r)}}function EMe(e,t,n){return t&&Rq(e.prototype,t),n&&Rq(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function OMe(e,t,n){return t=dg(t),CMe(e,Dq()?Reflect.construct(t,n||[],dg(e).constructor):t.apply(e,n))}function CMe(e,t){if(t&&(ml(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NMe(e)}function NMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dq=function(){return!!e})()}function dg(e){return dg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dg(e)}function MMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QC(e,t)}function QC(e,t){return QC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},QC(e,t)}function GC(e,t,n){return t=Lq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lq(e){var t=PMe(e,"string");return ml(t)=="symbol"?t:t+""}function PMe(e,t){if(ml(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ml(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gl=function(e){function t(n){var r;return SMe(this,t),r=OMe(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return MMe(t,e),EMe(t,[{key:"shouldComponentUpdate",value:function(n,r){var a=n.viewBox,o=XC(n,wMe),i=this.props,s=i.viewBox,c=XC(i,xMe);return!Uc(a,s)||!Uc(o,c)||!Uc(r,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var r=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];r&&this.setState({fontSize:window.getComputedStyle(r).fontSize,letterSpacing:window.getComputedStyle(r).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var r=this.props,a=r.x,o=r.y,i=r.width,s=r.height,c=r.orientation,l=r.tickSize,u=r.mirror,d=r.tickMargin,p,f,y,m,v,b,w=u?-1:1,_=n.tickSize||l,x=ye(n.tickCoord)?n.tickCoord:n.coordinate;switch(c){case"top":p=f=n.coordinate,m=o+ +!u*s,y=m-w*_,b=y-w*d,v=x;break;case"left":y=m=n.coordinate,f=a+ +!u*i,p=f-w*_,v=p-w*d,b=x;break;case"right":y=m=n.coordinate,f=a+ +u*i,p=f+w*_,v=p+w*d,b=x;break;default:p=f=n.coordinate,m=o+ +u*s,y=m+w*_,b=y+w*d,v=x;break}return{line:{x1:p,y1:y,x2:f,y2:m},tick:{x:v,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o;switch(r){case"left":o=a?"start":"end";break;case"right":o=a?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o="end";switch(r){case"left":case"right":o="middle";break;case"top":o=a?"start":"end";break;default:o=a?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.orientation,c=n.mirror,l=n.axisLine,u=zn(zn(zn({},yt(this.props,!1)),yt(l,!1)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!c||s==="bottom"&&c);u=zn(zn({},u),{},{x1:r,y1:a+d*i,x2:r+o,y2:a+d*i})}else{var p=+(s==="left"&&!c||s==="right"&&c);u=zn(zn({},u),{},{x1:r+p*o,y1:a,x2:r+p*o,y2:a+i})}return U.createElement("line",yl({},u,{className:xt("recharts-cartesian-axis-line",xr(l,"className"))}))}},{key:"renderTicks",value:function(n,r,a){var o=this,i=this.props,s=i.tickLine,c=i.stroke,l=i.tick,u=i.tickFormatter,d=i.unit,p=ZC(zn(zn({},this.props),{},{ticks:n}),r,a),f=this.getTickTextAnchor(),y=this.getTickVerticalAnchor(),m=yt(this.props,!1),v=yt(l,!1),b=zn(zn({},m),{},{fill:"none"},yt(s,!1)),w=p.map(function(_,x){var j=o.getTickLineCoord(_),S=j.line,E=j.tick,O=zn(zn(zn(zn({textAnchor:f,verticalAnchor:y},m),{},{stroke:"none",fill:c},v),E),{},{index:x,payload:_,visibleTicksCount:p.length,tickFormatter:u});return U.createElement(pn,yl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},Hm(o.props,_,x)),s&&U.createElement("line",yl({},b,S,{className:xt("recharts-cartesian-axis-tick-line",xr(s,"className"))})),l&&t.renderTickItem(l,O,"".concat(tt(u)?u(_.value,x):_.value).concat(d||"")))});return U.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,r=this.props,a=r.axisLine,o=r.width,i=r.height,s=r.ticksGenerator,c=r.className,l=r.hide;if(l)return null;var u=this.props,d=u.ticks,p=XC(u,_Me),f=d;return tt(s)&&(f=d&&d.length>0?s(this.props):s(p)),o<=0||i<=0||!f||!f.length?null:U.createElement(pn,{className:xt("recharts-cartesian-axis",c),ref:function(y){n.layerReference=y}},a&&this.renderAxisLine(),this.renderTicks(f,this.state.fontSize,this.state.letterSpacing),Mn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,r,a){var o;return U.isValidElement(n)?o=U.cloneElement(n,r):tt(n)?o=n(r):o=U.createElement(py,yl({},r,{className:"recharts-cartesian-axis-tick-value"}),a),o}}])}(g.Component);GC(gl,"displayName","CartesianAxis"),GC(gl,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var kMe=["x1","y1","x2","y2","key"],AMe=["offset"];function vs(e){"@babel/helpers - typeof";return vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vs(e)}function $q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$q(Object(n),!0).forEach(function(r){TMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$q(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function TMe(e,t,n){return t=IMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IMe(e){var t=RMe(e,"string");return vs(t)=="symbol"?t:t+""}function RMe(e,t){if(vs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(vs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bs(){return bs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bs.apply(this,arguments)}function Fq(e,t){if(e==null)return{};var n=DMe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function DMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var LMe=function(e){var t=e.fill;if(!t||t==="none")return null;var n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.ry;return U.createElement("rect",{x:r,y:a,ry:s,width:o,height:i,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function Bq(e,t){var n;if(U.isValidElement(e))n=U.cloneElement(e,t);else if(tt(e))n=e(t);else{var r=t.x1,a=t.y1,o=t.x2,i=t.y2,s=t.key,c=Fq(t,kMe),l=yt(c,!1);l.offset;var u=Fq(l,AMe);n=U.createElement("line",bs({},u,{x1:r,y1:a,x2:o,y2:i,fill:"none",key:s}))}return n}function $Me(e){var t=e.x,n=e.width,r=e.horizontal,a=r===void 0?!0:r,o=e.horizontalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=kn(kn({},e),{},{x1:t,y1:s,x2:t+n,y2:s,key:"line-".concat(c),index:c});return Bq(a,l)});return U.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function FMe(e){var t=e.y,n=e.height,r=e.vertical,a=r===void 0?!0:r,o=e.verticalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=kn(kn({},e),{},{x1:s,y1:t,x2:s,y2:t+n,key:"line-".concat(c),index:c});return Bq(a,l)});return U.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function BMe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.horizontalPoints,c=e.horizontal,l=c===void 0?!0:c;if(!l||!t||!t.length)return null;var u=s.map(function(p){return Math.round(p+a-a)}).sort(function(p,f){return p-f});a!==u[0]&&u.unshift(0);var d=u.map(function(p,f){var y=!u[f+1],m=y?a+i-p:u[f+1]-p;if(m<=0)return null;var v=f%t.length;return U.createElement("rect",{key:"react-".concat(f),y:p,x:r,height:m,width:o,stroke:"none",fill:t[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return U.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function zMe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,a=e.fillOpacity,o=e.x,i=e.y,s=e.width,c=e.height,l=e.verticalPoints;if(!n||!r||!r.length)return null;var u=l.map(function(p){return Math.round(p+o-o)}).sort(function(p,f){return p-f});o!==u[0]&&u.unshift(0);var d=u.map(function(p,f){var y=!u[f+1],m=y?o+s-p:u[f+1]-p;if(m<=0)return null;var v=f%r.length;return U.createElement("rect",{key:"react-".concat(f),x:p,y:i,width:m,height:c,stroke:"none",fill:r[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return U.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var VMe=function(e,t){var n=e.xAxis,r=e.width,a=e.height,o=e.offset;return gW(ZC(kn(kn(kn({},gl.defaultProps),n),{},{ticks:$o(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.left,o.left+o.width,t)},WMe=function(e,t){var n=e.yAxis,r=e.width,a=e.height,o=e.offset;return gW(ZC(kn(kn(kn({},gl.defaultProps),n),{},{ticks:$o(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.top,o.top+o.height,t)},vl={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function zq(e){var t,n,r,a,o,i,s=$C(),c=FC(),l=PNe(),u=kn(kn({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:vl.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:vl.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:vl.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:vl.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:vl.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:vl.verticalFill,x:ye(e.x)?e.x:l.left,y:ye(e.y)?e.y:l.top,width:ye(e.width)?e.width:l.width,height:ye(e.height)?e.height:l.height}),d=u.x,p=u.y,f=u.width,y=u.height,m=u.syncWithTicks,v=u.horizontalValues,b=u.verticalValues,w=CNe(),_=NNe();if(!ye(f)||f<=0||!ye(y)||y<=0||!ye(d)||d!==+d||!ye(p)||p!==+p)return null;var x=u.verticalCoordinatesGenerator||VMe,j=u.horizontalCoordinatesGenerator||WMe,S=u.horizontalPoints,E=u.verticalPoints;if((!S||!S.length)&&tt(j)){var O=v&&v.length,N=j({yAxis:_?kn(kn({},_),{},{ticks:O?v:_.ticks}):void 0,width:s,height:c,offset:l},O?!0:m);Mo(Array.isArray(N),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(vs(N),"]")),Array.isArray(N)&&(S=N)}if((!E||!E.length)&&tt(x)){var M=b&&b.length,P=x({xAxis:w?kn(kn({},w),{},{ticks:M?b:w.ticks}):void 0,width:s,height:c,offset:l},M?!0:m);Mo(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(vs(P),"]")),Array.isArray(P)&&(E=P)}return U.createElement("g",{className:"recharts-cartesian-grid"},U.createElement(LMe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),U.createElement($Me,bs({},u,{offset:l,horizontalPoints:S,xAxis:w,yAxis:_})),U.createElement(FMe,bs({},u,{offset:l,verticalPoints:E,xAxis:w,yAxis:_})),U.createElement(BMe,bs({},u,{horizontalPoints:S})),U.createElement(zMe,bs({},u,{verticalPoints:E})))}zq.displayName="CartesianGrid";function bl(e){"@babel/helpers - typeof";return bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bl(e)}function UMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qMe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Uq(r.key),r)}}function HMe(e,t,n){return t&&qMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function KMe(e,t,n){return t=pg(t),ZMe(e,Vq()?Reflect.construct(t,n||[],pg(e).constructor):t.apply(e,n))}function ZMe(e,t){if(t&&(bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XMe(e)}function XMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vq=function(){return!!e})()}function pg(e){return pg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pg(e)}function QMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JC(e,t)}function JC(e,t){return JC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},JC(e,t)}function Wq(e,t,n){return t=Uq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uq(e){var t=GMe(e,"string");return bl(t)=="symbol"?t:t+""}function GMe(e,t){if(bl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YC(){return YC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YC.apply(this,arguments)}function JMe(e){var t=e.xAxisId,n=$C(),r=FC(),a=gq(t);return a==null?null:U.createElement(gl,YC({},a,{className:xt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return $o(o,!0)}}))}var fg=function(e){function t(){return UMe(this,t),KMe(this,t,arguments)}return QMe(t,e),HMe(t,[{key:"render",value:function(){return U.createElement(JMe,this.props)}}])}(U.Component);Wq(fg,"displayName","XAxis"),Wq(fg,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function wl(e){"@babel/helpers - typeof";return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wl(e)}function YMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ePe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Kq(r.key),r)}}function tPe(e,t,n){return t&&ePe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function nPe(e,t,n){return t=hg(t),rPe(e,qq()?Reflect.construct(t,n||[],hg(e).constructor):t.apply(e,n))}function rPe(e,t){if(t&&(wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aPe(e)}function aPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qq=function(){return!!e})()}function hg(e){return hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hg(e)}function oPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eN(e,t)}function eN(e,t){return eN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},eN(e,t)}function Hq(e,t,n){return t=Kq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kq(e){var t=iPe(e,"string");return wl(t)=="symbol"?t:t+""}function iPe(e,t){if(wl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tN(){return tN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tN.apply(this,arguments)}var sPe=function(e){var t=e.yAxisId,n=$C(),r=FC(),a=vq(t);return a==null?null:U.createElement(gl,tN({},a,{className:xt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return $o(o,!0)}}))},nN=function(e){function t(){return YMe(this,t),nPe(this,t,arguments)}return oPe(t,e),tPe(t,[{key:"render",value:function(){return U.createElement(sPe,this.props)}}])}(U.Component);Hq(nN,"displayName","YAxis"),Hq(nN,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function Zq(e){return dPe(e)||uPe(e)||lPe(e)||cPe()}function cPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lPe(e,t){if(e){if(typeof e=="string")return rN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rN(e,t)}}function uPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dPe(e){if(Array.isArray(e))return rN(e)}function rN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var aN=function(e,t,n,r,a){var o=sa(e,WC),i=sa(e,ig),s=[].concat(Zq(o),Zq(i)),c=sa(e,lg),l="".concat(r,"Id"),u=r[0],d=t;if(s.length&&(d=s.reduce(function(y,m){if(m.props[l]===n&&Ba(m.props,"extendDomain")&&ye(m.props[u])){var v=m.props[u];return[Math.min(y[0],v),Math.max(y[1],v)]}return y},d)),c.length){var p="".concat(u,"1"),f="".concat(u,"2");d=c.reduce(function(y,m){if(m.props[l]===n&&Ba(m.props,"extendDomain")&&ye(m.props[p])&&ye(m.props[f])){var v=m.props[p],b=m.props[f];return[Math.min(y[0],v,b),Math.max(y[1],v,b)]}return y},d)}return a&&a.length&&(d=a.reduce(function(y,m){return ye(m)?[Math.min(y[0],m),Math.max(y[1],m)]:y},d)),d},Xq={exports:{}},Qq;function pPe(){return Qq||(Qq=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,p){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new a(u,d||c,p),y=n?n+l:l;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],f]:c._events[y].push(f):(c._events[y]=f,c._eventsCount++),c}function i(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)t.call(l,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},s.prototype.listeners=function(c){var l=n?n+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,p=u.length,f=new Array(p);d<p;d++)f[d]=u[d].fn;return f},s.prototype.listenerCount=function(c){var l=n?n+c:c,u=this._events[l];return u?u.fn?1:u.length:0},s.prototype.emit=function(c,l,u,d,p,f){var y=n?n+c:c;if(!this._events[y])return!1;var m=this._events[y],v=arguments.length,b,w;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,u),!0;case 4:return m.fn.call(m.context,l,u,d),!0;case 5:return m.fn.call(m.context,l,u,d,p),!0;case 6:return m.fn.call(m.context,l,u,d,p,f),!0}for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];m.fn.apply(m.context,b)}else{var _=m.length,x;for(w=0;w<_;w++)switch(m[w].once&&this.removeListener(c,m[w].fn,void 0,!0),v){case 1:m[w].fn.call(m[w].context);break;case 2:m[w].fn.call(m[w].context,l);break;case 3:m[w].fn.call(m[w].context,l,u);break;case 4:m[w].fn.call(m[w].context,l,u,d);break;default:if(!b)for(x=1,b=new Array(v-1);x<v;x++)b[x-1]=arguments[x];m[w].fn.apply(m[w].context,b)}}return!0},s.prototype.on=function(c,l,u){return o(this,c,l,u,!1)},s.prototype.once=function(c,l,u){return o(this,c,l,u,!0)},s.prototype.removeListener=function(c,l,u,d){var p=n?n+c:c;if(!this._events[p])return this;if(!l)return i(this,p),this;var f=this._events[p];if(f.fn)f.fn===l&&(!d||f.once)&&(!u||f.context===u)&&i(this,p);else{for(var y=0,m=[],v=f.length;y<v;y++)(f[y].fn!==l||d&&!f[y].once||u&&f[y].context!==u)&&m.push(f[y]);m.length?this._events[p]=m.length===1?m[0]:m:i(this,p)}return this},s.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&i(this,l)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(Xq)),Xq.exports}var fPe=pPe();const hPe=ot(fPe);var oN=new hPe,iN="recharts.syncMouseEvents";function Cp(e){"@babel/helpers - typeof";return Cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cp(e)}function mPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yPe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Gq(r.key),r)}}function gPe(e,t,n){return t&&yPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function sN(e,t,n){return t=Gq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gq(e){var t=vPe(e,"string");return Cp(t)=="symbol"?t:t+""}function vPe(e,t){if(Cp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Cp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var bPe=function(){function e(){mPe(this,e),sN(this,"activeIndex",0),sN(this,"coordinateList",[]),sN(this,"layout","horizontal")}return gPe(e,[{key:"setDetails",value:function(t){var n,r=t.coordinateList,a=r===void 0?null:r,o=t.container,i=o===void 0?null:o,s=t.layout,c=s===void 0?null:s,l=t.offset,u=l===void 0?null:l,d=t.mouseHandlerCallback,p=d===void 0?null:d;this.coordinateList=(n=a??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=c??this.layout,this.offset=u??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(t){if(this.coordinateList.length!==0)switch(t.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(t){this.activeIndex=t}},{key:"spoofMouse",value:function(){var t,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var r=this.container.getBoundingClientRect(),a=r.x,o=r.y,i=r.height,s=this.coordinateList[this.activeIndex].coordinate,c=((t=window)===null||t===void 0?void 0:t.scrollX)||0,l=((n=window)===null||n===void 0?void 0:n.scrollY)||0,u=a+s+c,d=o+this.offset.top+i/2+l;this.mouseHandlerCallback({pageX:u,pageY:d})}}}])}();function wPe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],a=e==null?void 0:e[1];if(r&&a&&ye(r)&&ye(a))return!0}return!1}function xPe(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function Jq(e){var t=e.cx,n=e.cy,r=e.radius,a=e.startAngle,o=e.endAngle,i=_n(t,n,r,a),s=_n(t,n,r,o);return{points:[i,s],cx:t,cy:n,radius:r,startAngle:a,endAngle:o}}function _Pe(e,t,n){var r,a,o,i;if(e==="horizontal")r=t.x,o=r,a=n.top,i=n.top+n.height;else if(e==="vertical")a=t.y,i=a,r=n.left,o=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,c=t.cy,l=t.innerRadius,u=t.outerRadius,d=t.angle,p=_n(s,c,l,d),f=_n(s,c,u,d);r=p.x,a=p.y,o=f.x,i=f.y}else return Jq(t);return[{x:r,y:a},{x:o,y:i}]}function Np(e){"@babel/helpers - typeof";return Np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Np(e)}function Yq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function mg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yq(Object(n),!0).forEach(function(r){jPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function jPe(e,t,n){return t=SPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SPe(e){var t=EPe(e,"string");return Np(t)=="symbol"?t:t+""}function EPe(e,t){if(Np(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Np(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OPe(e){var t,n,r=e.element,a=e.tooltipEventType,o=e.isActive,i=e.activeCoordinate,s=e.activePayload,c=e.offset,l=e.activeTooltipIndex,u=e.tooltipAxisBandSize,d=e.layout,p=e.chartName,f=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!f||!o||!i||p!=="ScatterChart"&&a!=="axis")return null;var y,m=zW;if(p==="ScatterChart")y=i,m=VOe;else if(p==="BarChart")y=xPe(d,i,c,u),m=hC;else if(d==="radial"){var v=Jq(i),b=v.cx,w=v.cy,_=v.radius,x=v.startAngle,j=v.endAngle;y={cx:b,cy:w,startAngle:x,endAngle:j,innerRadius:_,outerRadius:_},m=LW}else y={points:_Pe(d,i,c)},m=zW;var S=mg(mg(mg(mg({stroke:"#ccc",pointerEvents:"none"},c),y),yt(f,!1)),{},{payload:s,payloadIndex:l,className:xt("recharts-tooltip-cursor",f.className)});return g.isValidElement(f)?g.cloneElement(f,S):g.createElement(m,S)}var CPe=["item"],NPe=["children","className","width","height","style","compact","title","desc"];function xl(e){"@babel/helpers - typeof";return xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xl(e)}function _l(){return _l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_l.apply(this,arguments)}function eH(e,t){return kPe(e)||PPe(e,t)||rH(e,t)||MPe()}function MPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PPe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function kPe(e){if(Array.isArray(e))return e}function tH(e,t){if(e==null)return{};var n=APe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function APe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function TPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IPe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oH(r.key),r)}}function RPe(e,t,n){return t&&IPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function DPe(e,t,n){return t=yg(t),LPe(e,nH()?Reflect.construct(t,n||[],yg(e).constructor):t.apply(e,n))}function LPe(e,t){if(t&&(xl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Pe(e)}function $Pe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nH=function(){return!!e})()}function yg(e){return yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yg(e)}function FPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cN(e,t)}function cN(e,t){return cN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},cN(e,t)}function jl(e){return VPe(e)||zPe(e)||rH(e)||BPe()}function BPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rH(e,t){if(e){if(typeof e=="string")return lN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lN(e,t)}}function zPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VPe(e){if(Array.isArray(e))return lN(e)}function lN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aH(Object(n),!0).forEach(function(r){Fe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fe(e,t,n){return t=oH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oH(e){var t=WPe(e,"string");return xl(t)=="symbol"?t:t+""}function WPe(e,t){if(xl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UPe={xAxis:["bottom","top"],yAxis:["left","right"]},qPe={width:"100%",height:"100%"},iH={x:0,y:0};function gg(e){return e}var HPe=function(e,t){return t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius},KPe=function(e,t,n,r){var a=t.find(function(l){return l&&l.index===n});if(a){if(e==="horizontal")return{x:a.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:a.coordinate};if(e==="centric"){var o=a.coordinate,i=r.radius;return ie(ie(ie({},r),_n(r.cx,r.cy,i,o)),{},{angle:o,radius:i})}var s=a.coordinate,c=r.angle;return ie(ie(ie({},r),_n(r.cx,r.cy,s,c)),{},{angle:c,radius:s})}return iH},vg=function(e,t){var n=t.graphicalItems,r=t.dataStartIndex,a=t.dataEndIndex,o=(n??[]).reduce(function(i,s){var c=s.props.data;return c&&c.length?[].concat(jl(i),jl(c)):i},[]);return o.length>0?o:e&&e.length&&ye(r)&&ye(a)?e.slice(r,a+1):[]};function sH(e){return e==="number"?[0,"auto"]:void 0}var uN=function(e,t,n,r){var a=e.graphicalItems,o=e.tooltipAxis,i=vg(t,e);return n<0||!a||!a.length||n>=i.length?null:a.reduce(function(s,c){var l,u=(l=c.props.data)!==null&&l!==void 0?l:t;u&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(u=u.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(o.dataKey&&!o.allowDuplicatedCategory){var p=u===void 0?i:u;d=AS(p,o.dataKey,r)}else d=u&&u[n]||i[n];return d?[].concat(jl(s),[SW(c,d)]):s},[])},cH=function(e,t,n,r){var a=r||{x:e.chartX,y:e.chartY},o=HPe(a,n),i=e.orderedTooltipTicks,s=e.tooltipAxis,c=e.tooltipTicks,l=Lje(o,i,c,s);if(l>=0&&c){var u=c[l]&&c[l].value,d=uN(e,t,l,u),p=KPe(n,i,l,a);return{activeTooltipIndex:l,activeLabel:u,activePayload:d,activeCoordinate:p}}return null},ZPe=function(e,t){var n=t.axes,r=t.graphicalItems,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=e.stackOffset,p=yW(l,a);return n.reduce(function(f,y){var m,v=y.type.defaultProps!==void 0?ie(ie({},y.type.defaultProps),y.props):y.props,b=v.type,w=v.dataKey,_=v.allowDataOverflow,x=v.allowDuplicatedCategory,j=v.scale,S=v.ticks,E=v.includeHidden,O=v[o];if(f[O])return f;var N=vg(e.data,{graphicalItems:r.filter(function(F){var $,V=o in F.props?F.props[o]:($=F.type.defaultProps)===null||$===void 0?void 0:$[o];return V===O}),dataStartIndex:s,dataEndIndex:c}),M=N.length,P,I,k;wPe(v.domain,_,b)&&(P=QO(v.domain,null,_),p&&(b==="number"||j!=="auto")&&(k=Ry(N,w,"category")));var C=sH(b);if(!P||P.length===0){var T,A=(T=v.domain)!==null&&T!==void 0?T:C;if(w){if(P=Ry(N,w,b),b==="category"&&p){var R=Xve(P);x&&R?(I=P,P=Gy(0,M)):x||(P=jW(A,P,y).reduce(function(F,$){return F.indexOf($)>=0?F:[].concat(jl(F),[$])},[]))}else if(b==="category")x?P=P.filter(function(F){return F!==""&&!gt(F)}):P=jW(A,P,y).reduce(function(F,$){return F.indexOf($)>=0||$===""||gt($)?F:[].concat(jl(F),[$])},[]);else if(b==="number"){var L=Vje(N,r.filter(function(F){var $,V,Q=o in F.props?F.props[o]:($=F.type.defaultProps)===null||$===void 0?void 0:$[o],X="hide"in F.props?F.props.hide:(V=F.type.defaultProps)===null||V===void 0?void 0:V.hide;return Q===O&&(E||!X)}),w,a,l);L&&(P=L)}p&&(b==="number"||j!=="auto")&&(k=Ry(N,w,"category"))}else p?P=Gy(0,M):i&&i[O]&&i[O].hasStack&&b==="number"?P=d==="expand"?[0,1]:wW(i[O].stackGroups,s,c):P=mW(N,r.filter(function(F){var $=o in F.props?F.props[o]:F.type.defaultProps[o],V="hide"in F.props?F.props.hide:F.type.defaultProps.hide;return $===O&&(E||!V)}),b,l,!0);if(b==="number")P=aN(u,P,O,a,S),A&&(P=QO(A,P,_));else if(b==="category"&&A){var D=A,B=P.every(function(F){return D.indexOf(F)>=0});B&&(P=D)}}return ie(ie({},f),{},Fe({},O,ie(ie({},v),{},{axisType:a,domain:P,categoricalDomain:k,duplicateDomain:I,originalDomain:(m=v.domain)!==null&&m!==void 0?m:C,isCategorical:p,layout:l})))},{})},XPe=function(e,t){var n=t.graphicalItems,r=t.Axis,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=vg(e.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:c}),p=d.length,f=yW(l,a),y=-1;return n.reduce(function(m,v){var b=v.type.defaultProps!==void 0?ie(ie({},v.type.defaultProps),v.props):v.props,w=b[o],_=sH("number");if(!m[w]){y++;var x;return f?x=Gy(0,p):i&&i[w]&&i[w].hasStack?(x=wW(i[w].stackGroups,s,c),x=aN(u,x,w,a)):(x=QO(_,mW(d,n.filter(function(j){var S,E,O=o in j.props?j.props[o]:(S=j.type.defaultProps)===null||S===void 0?void 0:S[o],N="hide"in j.props?j.props.hide:(E=j.type.defaultProps)===null||E===void 0?void 0:E.hide;return O===w&&!N}),"number",l),r.defaultProps.allowDataOverflow),x=aN(u,x,w,a)),ie(ie({},m),{},Fe({},w,ie(ie({axisType:a},r.defaultProps),{},{hide:!0,orientation:xr(UPe,"".concat(a,".").concat(y%2),null),domain:x,originalDomain:_,isCategorical:f,layout:l})))}return m},{})},QPe=function(e,t){var n=t.axisType,r=n===void 0?"xAxis":n,a=t.AxisComp,o=t.graphicalItems,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.children,u="".concat(r,"Id"),d=sa(l,a),p={};return d&&d.length?p=ZPe(e,{axes:d,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c}):o&&o.length&&(p=XPe(e,{Axis:a,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c})),p},GPe=function(e){var t=yi(e),n=$o(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:zE(n,function(r){return r.coordinate}),tooltipAxis:t,tooltipAxisBandSize:Ly(t,n)}},lH=function(e){var t=e.children,n=e.defaultShowTooltip,r=fr(t,ul),a=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(a=r.props.startIndex),r.props.endIndex>=0&&(o=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},JPe=function(e){return!e||!e.length?!1:e.some(function(t){var n=No(t&&t.type);return n&&n.indexOf("Bar")>=0})},uH=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},YPe=function(e,t){var n=e.props,r=e.graphicalItems,a=e.xAxisMap,o=a===void 0?{}:a,i=e.yAxisMap,s=i===void 0?{}:i,c=n.width,l=n.height,u=n.children,d=n.margin||{},p=fr(u,ul),f=fr(u,Zc),y=Object.keys(s).reduce(function(x,j){var S=s[j],E=S.orientation;return!S.mirror&&!S.hide?ie(ie({},x),{},Fe({},E,x[E]+S.width)):x},{left:d.left||0,right:d.right||0}),m=Object.keys(o).reduce(function(x,j){var S=o[j],E=S.orientation;return!S.mirror&&!S.hide?ie(ie({},x),{},Fe({},E,xr(x,"".concat(E))+S.height)):x},{top:d.top||0,bottom:d.bottom||0}),v=ie(ie({},m),y),b=v.bottom;p&&(v.bottom+=p.props.height||ul.defaultProps.height),f&&t&&(v=Bje(v,r,n,t));var w=c-v.left-v.right,_=l-v.top-v.bottom;return ie(ie({brushBottom:b},v),{},{width:Math.max(w,0),height:Math.max(_,0)})},eke=function(e,t){if(t==="xAxis")return e[t].width;if(t==="yAxis")return e[t].height},tke=function(e){var t=e.chartName,n=e.GraphicalChild,r=e.defaultTooltipEventType,a=r===void 0?"axis":r,o=e.validateTooltipEventTypes,i=o===void 0?["axis"]:o,s=e.axisComponents,c=e.legendContent,l=e.formatAxisMap,u=e.defaultProps,d=function(m,v){var b=v.graphicalItems,w=v.stackGroups,_=v.offset,x=v.updateId,j=v.dataStartIndex,S=v.dataEndIndex,E=m.barSize,O=m.layout,N=m.barGap,M=m.barCategoryGap,P=m.maxBarSize,I=uH(O),k=I.numericAxisName,C=I.cateAxisName,T=JPe(b),A=[];return b.forEach(function(R,L){var D=vg(m.data,{graphicalItems:[R],dataStartIndex:j,dataEndIndex:S}),B=R.type.defaultProps!==void 0?ie(ie({},R.type.defaultProps),R.props):R.props,F=B.dataKey,$=B.maxBarSize,V=B["".concat(k,"Id")],Q=B["".concat(C,"Id")],X={},H=s.reduce(function(Se,Ve){var Ue=v["".concat(Ve.axisType,"Map")],qe=B["".concat(Ve.axisType,"Id")];Ue&&Ue[qe]||Ve.axisType==="zAxis"||hs();var Mt=Ue[qe];return ie(ie({},Se),{},Fe(Fe({},Ve.axisType,Mt),"".concat(Ve.axisType,"Ticks"),$o(Mt)))},X),J=H[C],K=H["".concat(C,"Ticks")],q=w&&w[V]&&w[V].hasStack&&eSe(R,w[V].stackGroups),G=No(R.type).indexOf("Bar")>=0,ne=Ly(J,K),z=[],se=T&&$je({barSize:E,stackGroups:w,totalSize:eke(H,C)});if(G){var re,le,je=gt($)?P:$,Le=(re=(le=Ly(J,K,!0))!==null&&le!==void 0?le:je)!==null&&re!==void 0?re:0;z=Fje({barGap:N,barCategoryGap:M,bandSize:Le!==ne?Le:ne,sizeList:se[Q],maxBarSize:je}),Le!==ne&&(z=z.map(function(Se){return ie(ie({},Se),{},{position:ie(ie({},Se.position),{},{offset:Se.position.offset-Le/2})})}))}var $e=R&&R.type&&R.type.getComposedData;$e&&A.push({props:ie(ie({},$e(ie(ie({},H),{},{displayedData:D,props:m,dataKey:F,item:R,bandSize:ne,barPosition:z,offset:_,stackedData:q,layout:O,dataStartIndex:j,dataEndIndex:S}))),{},Fe(Fe(Fe({key:R.key||"item-".concat(L)},k,H[k]),C,H[C]),"animationId",x)),childIndex:i0e(R,m.children),item:R})}),A},p=function(m,v){var b=m.props,w=m.dataStartIndex,_=m.dataEndIndex,x=m.updateId;if(!NB({props:b}))return null;var j=b.children,S=b.layout,E=b.stackOffset,O=b.data,N=b.reverseStackOrder,M=uH(S),P=M.numericAxisName,I=M.cateAxisName,k=sa(j,n),C=Gje(O,k,"".concat(P,"Id"),"".concat(I,"Id"),E,N),T=s.reduce(function(B,F){var $="".concat(F.axisType,"Map");return ie(ie({},B),{},Fe({},$,QPe(b,ie(ie({},F),{},{graphicalItems:k,stackGroups:F.axisType===P&&C,dataStartIndex:w,dataEndIndex:_}))))},{}),A=YPe(ie(ie({},T),{},{props:b,graphicalItems:k}),v==null?void 0:v.legendBBox);Object.keys(T).forEach(function(B){T[B]=l(b,T[B],A,B.replace("Map",""),t)});var R=T["".concat(I,"Map")],L=GPe(R),D=d(b,ie(ie({},T),{},{dataStartIndex:w,dataEndIndex:_,updateId:x,graphicalItems:k,stackGroups:C,offset:A}));return ie(ie({formattedGraphicalItems:D,graphicalItems:k,offset:A,stackGroups:C},L),T)},f=function(m){function v(b){var w,_,x;return TPe(this,v),x=DPe(this,v,[b]),Fe(x,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Fe(x,"accessibilityManager",new bPe),Fe(x,"handleLegendBBoxUpdate",function(j){if(j){var S=x.state,E=S.dataStartIndex,O=S.dataEndIndex,N=S.updateId;x.setState(ie({legendBBox:j},p({props:x.props,dataStartIndex:E,dataEndIndex:O,updateId:N},ie(ie({},x.state),{},{legendBBox:j}))))}}),Fe(x,"handleReceiveSyncEvent",function(j,S,E){if(x.props.syncId===j){if(E===x.eventEmitterSymbol&&typeof x.props.syncMethod!="function")return;x.applySyncEvent(S)}}),Fe(x,"handleBrushChange",function(j){var S=j.startIndex,E=j.endIndex;if(S!==x.state.dataStartIndex||E!==x.state.dataEndIndex){var O=x.state.updateId;x.setState(function(){return ie({dataStartIndex:S,dataEndIndex:E},p({props:x.props,dataStartIndex:S,dataEndIndex:E,updateId:O},x.state))}),x.triggerSyncEvent({dataStartIndex:S,dataEndIndex:E})}}),Fe(x,"handleMouseEnter",function(j){var S=x.getMouseInfo(j);if(S){var E=ie(ie({},S),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseEnter;tt(O)&&O(E,j)}}),Fe(x,"triggeredAfterMouseMove",function(j){var S=x.getMouseInfo(j),E=S?ie(ie({},S),{},{isTooltipActive:!0}):{isTooltipActive:!1};x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseMove;tt(O)&&O(E,j)}),Fe(x,"handleItemMouseEnter",function(j){x.setState(function(){return{isTooltipActive:!0,activeItem:j,activePayload:j.tooltipPayload,activeCoordinate:j.tooltipPosition||{x:j.cx,y:j.cy}}})}),Fe(x,"handleItemMouseLeave",function(){x.setState(function(){return{isTooltipActive:!1}})}),Fe(x,"handleMouseMove",function(j){j.persist(),x.throttleTriggeredAfterMouseMove(j)}),Fe(x,"handleMouseLeave",function(j){x.throttleTriggeredAfterMouseMove.cancel();var S={isTooltipActive:!1};x.setState(S),x.triggerSyncEvent(S);var E=x.props.onMouseLeave;tt(E)&&E(S,j)}),Fe(x,"handleOuterEvent",function(j){var S=o0e(j),E=xr(x.props,"".concat(S));if(S&&tt(E)){var O,N;/.*touch.*/i.test(S)?N=x.getMouseInfo(j.changedTouches[0]):N=x.getMouseInfo(j),E((O=N)!==null&&O!==void 0?O:{},j)}}),Fe(x,"handleClick",function(j){var S=x.getMouseInfo(j);if(S){var E=ie(ie({},S),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onClick;tt(O)&&O(E,j)}}),Fe(x,"handleMouseDown",function(j){var S=x.props.onMouseDown;if(tt(S)){var E=x.getMouseInfo(j);S(E,j)}}),Fe(x,"handleMouseUp",function(j){var S=x.props.onMouseUp;if(tt(S)){var E=x.getMouseInfo(j);S(E,j)}}),Fe(x,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.throttleTriggeredAfterMouseMove(j.changedTouches[0])}),Fe(x,"handleTouchStart",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.handleMouseDown(j.changedTouches[0])}),Fe(x,"handleTouchEnd",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.handleMouseUp(j.changedTouches[0])}),Fe(x,"triggerSyncEvent",function(j){x.props.syncId!==void 0&&oN.emit(iN,x.props.syncId,j,x.eventEmitterSymbol)}),Fe(x,"applySyncEvent",function(j){var S=x.props,E=S.layout,O=S.syncMethod,N=x.state.updateId,M=j.dataStartIndex,P=j.dataEndIndex;if(j.dataStartIndex!==void 0||j.dataEndIndex!==void 0)x.setState(ie({dataStartIndex:M,dataEndIndex:P},p({props:x.props,dataStartIndex:M,dataEndIndex:P,updateId:N},x.state)));else if(j.activeTooltipIndex!==void 0){var I=j.chartX,k=j.chartY,C=j.activeTooltipIndex,T=x.state,A=T.offset,R=T.tooltipTicks;if(!A)return;if(typeof O=="function")C=O(R,j);else if(O==="value"){C=-1;for(var L=0;L<R.length;L++)if(R[L].value===j.activeLabel){C=L;break}}var D=ie(ie({},A),{},{x:A.left,y:A.top}),B=Math.min(I,D.x+D.width),F=Math.min(k,D.y+D.height),$=R[C]&&R[C].value,V=uN(x.state,x.props.data,C),Q=R[C]?{x:E==="horizontal"?R[C].coordinate:B,y:E==="horizontal"?F:R[C].coordinate}:iH;x.setState(ie(ie({},j),{},{activeLabel:$,activeCoordinate:Q,activePayload:V,activeTooltipIndex:C}))}else x.setState(j)}),Fe(x,"renderCursor",function(j){var S,E=x.state,O=E.isTooltipActive,N=E.activeCoordinate,M=E.activePayload,P=E.offset,I=E.activeTooltipIndex,k=E.tooltipAxisBandSize,C=x.getTooltipEventType(),T=(S=j.props.active)!==null&&S!==void 0?S:O,A=x.props.layout,R=j.key||"_recharts-cursor";return U.createElement(OPe,{key:R,activeCoordinate:N,activePayload:M,activeTooltipIndex:I,chartName:t,element:j,isActive:T,layout:A,offset:P,tooltipAxisBandSize:k,tooltipEventType:C})}),Fe(x,"renderPolarAxis",function(j,S,E){var O=xr(j,"type.axisType"),N=xr(x.state,"".concat(O,"Map")),M=j.type.defaultProps,P=M!==void 0?ie(ie({},M),j.props):j.props,I=N&&N[P["".concat(O,"Id")]];return g.cloneElement(j,ie(ie({},I),{},{className:xt(O,I.className),key:j.key||"".concat(S,"-").concat(E),ticks:$o(I,!0)}))}),Fe(x,"renderPolarGrid",function(j){var S=j.props,E=S.radialLines,O=S.polarAngles,N=S.polarRadius,M=x.state,P=M.radiusAxisMap,I=M.angleAxisMap,k=yi(P),C=yi(I),T=C.cx,A=C.cy,R=C.innerRadius,L=C.outerRadius;return g.cloneElement(j,{polarAngles:Array.isArray(O)?O:$o(C,!0).map(function(D){return D.coordinate}),polarRadius:Array.isArray(N)?N:$o(k,!0).map(function(D){return D.coordinate}),cx:T,cy:A,innerRadius:R,outerRadius:L,key:j.key||"polar-grid",radialLines:E})}),Fe(x,"renderLegend",function(){var j=x.state.formattedGraphicalItems,S=x.props,E=S.children,O=S.width,N=S.height,M=x.props.margin||{},P=O-(M.left||0)-(M.right||0),I=dW({children:E,formattedGraphicalItems:j,legendWidth:P,legendContent:c});if(!I)return null;var k=I.item,C=tH(I,CPe);return g.cloneElement(k,ie(ie({},C),{},{chartWidth:O,chartHeight:N,margin:M,onBBoxUpdate:x.handleLegendBBoxUpdate}))}),Fe(x,"renderTooltip",function(){var j,S=x.props,E=S.children,O=S.accessibilityLayer,N=fr(E,Da);if(!N)return null;var M=x.state,P=M.isTooltipActive,I=M.activeCoordinate,k=M.activePayload,C=M.activeLabel,T=M.offset,A=(j=N.props.active)!==null&&j!==void 0?j:P;return g.cloneElement(N,{viewBox:ie(ie({},T),{},{x:T.left,y:T.top}),active:A,label:C,payload:A?k:[],coordinate:I,accessibilityLayer:O})}),Fe(x,"renderBrush",function(j){var S=x.props,E=S.margin,O=S.data,N=x.state,M=N.offset,P=N.dataStartIndex,I=N.dataEndIndex,k=N.updateId;return g.cloneElement(j,{key:j.key||"_recharts-brush",onChange:Dy(x.handleBrushChange,j.props.onChange),data:O,x:ye(j.props.x)?j.props.x:M.left,y:ye(j.props.y)?j.props.y:M.top+M.height+M.brushBottom-(E.bottom||0),width:ye(j.props.width)?j.props.width:M.width,startIndex:P,endIndex:I,updateId:"brush-".concat(k)})}),Fe(x,"renderReferenceElement",function(j,S,E){if(!j)return null;var O=x,N=O.clipPathId,M=x.state,P=M.xAxisMap,I=M.yAxisMap,k=M.offset,C=j.type.defaultProps||{},T=j.props,A=T.xAxisId,R=A===void 0?C.xAxisId:A,L=T.yAxisId,D=L===void 0?C.yAxisId:L;return g.cloneElement(j,{key:j.key||"".concat(S,"-").concat(E),xAxis:P[R],yAxis:I[D],viewBox:{x:k.left,y:k.top,width:k.width,height:k.height},clipPathId:N})}),Fe(x,"renderActivePoints",function(j){var S=j.item,E=j.activePoint,O=j.basePoint,N=j.childIndex,M=j.isRange,P=[],I=S.props.key,k=S.item.type.defaultProps!==void 0?ie(ie({},S.item.type.defaultProps),S.item.props):S.item.props,C=k.activeDot,T=k.dataKey,A=ie(ie({index:N,dataKey:T,cx:E.x,cy:E.y,r:4,fill:ZO(S.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},yt(C,!1)),qm(C));return P.push(v.renderActiveDot(C,A,"".concat(I,"-activePoint-").concat(N))),O?P.push(v.renderActiveDot(C,ie(ie({},A),{},{cx:O.x,cy:O.y}),"".concat(I,"-basePoint-").concat(N))):M&&P.push(null),P}),Fe(x,"renderGraphicChild",function(j,S,E){var O=x.filterFormatItem(j,S,E);if(!O)return null;var N=x.getTooltipEventType(),M=x.state,P=M.isTooltipActive,I=M.tooltipAxis,k=M.activeTooltipIndex,C=M.activeLabel,T=x.props.children,A=fr(T,Da),R=O.props,L=R.points,D=R.isRange,B=R.baseLine,F=O.item.type.defaultProps!==void 0?ie(ie({},O.item.type.defaultProps),O.item.props):O.item.props,$=F.activeDot,V=F.hide,Q=F.activeBar,X=F.activeShape,H=!!(!V&&P&&A&&($||Q||X)),J={};N!=="axis"&&A&&A.props.trigger==="click"?J={onClick:Dy(x.handleItemMouseEnter,j.props.onClick)}:N!=="axis"&&(J={onMouseLeave:Dy(x.handleItemMouseLeave,j.props.onMouseLeave),onMouseEnter:Dy(x.handleItemMouseEnter,j.props.onMouseEnter)});var K=g.cloneElement(j,ie(ie({},O.props),J));function q(Ue){return typeof I.dataKey=="function"?I.dataKey(Ue.payload):null}if(H)if(k>=0){var G,ne;if(I.dataKey&&!I.allowDuplicatedCategory){var z=typeof I.dataKey=="function"?q:"payload.".concat(I.dataKey.toString());G=AS(L,z,C),ne=D&&B&&AS(B,z,C)}else G=L==null?void 0:L[k],ne=D&&B&&B[k];if(X||Q){var se=j.props.activeIndex!==void 0?j.props.activeIndex:k;return[g.cloneElement(j,ie(ie(ie({},O.props),J),{},{activeIndex:se})),null,null]}if(!gt(G))return[K].concat(jl(x.renderActivePoints({item:O,activePoint:G,basePoint:ne,childIndex:k,isRange:D})))}else{var re,le=(re=x.getItemByXY(x.state.activeCoordinate))!==null&&re!==void 0?re:{graphicalItem:K},je=le.graphicalItem,Le=je.item,$e=Le===void 0?j:Le,Se=je.childIndex,Ve=ie(ie(ie({},O.props),J),{},{activeIndex:Se});return[g.cloneElement($e,Ve),null,null]}return D?[K,null,null]:[K,null]}),Fe(x,"renderCustomized",function(j,S,E){return g.cloneElement(j,ie(ie({key:"recharts-customized-".concat(E)},x.props),x.state))}),Fe(x,"renderMap",{CartesianGrid:{handler:gg,once:!0},ReferenceArea:{handler:x.renderReferenceElement},ReferenceLine:{handler:gg},ReferenceDot:{handler:x.renderReferenceElement},XAxis:{handler:gg},YAxis:{handler:gg},Brush:{handler:x.renderBrush,once:!0},Bar:{handler:x.renderGraphicChild},Line:{handler:x.renderGraphicChild},Area:{handler:x.renderGraphicChild},Radar:{handler:x.renderGraphicChild},RadialBar:{handler:x.renderGraphicChild},Scatter:{handler:x.renderGraphicChild},Pie:{handler:x.renderGraphicChild},Funnel:{handler:x.renderGraphicChild},Tooltip:{handler:x.renderCursor,once:!0},PolarGrid:{handler:x.renderPolarGrid,once:!0},PolarAngleAxis:{handler:x.renderPolarAxis},PolarRadiusAxis:{handler:x.renderPolarAxis},Customized:{handler:x.renderCustomized}}),x.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:Um("recharts"),"-clip"),x.throttleTriggeredAfterMouseMove=Ig(x.triggeredAfterMouseMove,(_=b.throttleDelay)!==null&&_!==void 0?_:1e3/60),x.state={},x}return FPe(v,m),RPe(v,[{key:"componentDidMount",value:function(){var b,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,w=b.children,_=b.data,x=b.height,j=b.layout,S=fr(w,Da);if(S){var E=S.props.defaultIndex;if(!(typeof E!="number"||E<0||E>this.state.tooltipTicks.length-1)){var O=this.state.tooltipTicks[E]&&this.state.tooltipTicks[E].value,N=uN(this.state,_,E,O),M=this.state.tooltipTicks[E].coordinate,P=(this.state.offset.top+x)/2,I=j==="horizontal",k=I?{x:M,y:P}:{y:M,x:P},C=this.state.formattedGraphicalItems.find(function(A){var R=A.item;return R.type.name==="Scatter"});C&&(k=ie(ie({},k),C.props.points[E].tooltipPosition),N=C.props.points[E].tooltipPayload);var T={activeTooltipIndex:E,isTooltipActive:!0,activeLabel:O,activePayload:N,activeCoordinate:k};this.setState(T),this.renderCursor(S),this.accessibilityManager.setIndex(E)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var _,x;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(x=this.props.margin.top)!==null&&x!==void 0?x:0}})}return null}},{key:"componentDidUpdate",value:function(b){$S([fr(b.children,Da)],[fr(this.props.children,Da)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=fr(this.props.children,Da);if(b&&typeof b.props.shared=="boolean"){var w=b.props.shared?"axis":"item";return i.indexOf(w)>=0?w:a}return a}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var w=this.container,_=w.getBoundingClientRect(),x=Jwe(_),j={chartX:Math.round(b.pageX-x.left),chartY:Math.round(b.pageY-x.top)},S=_.width/w.offsetWidth||1,E=this.inRange(j.chartX,j.chartY,S);if(!E)return null;var O=this.state,N=O.xAxisMap,M=O.yAxisMap,P=this.getTooltipEventType();if(P!=="axis"&&N&&M){var I=yi(N).scale,k=yi(M).scale,C=I&&I.invert?I.invert(j.chartX):null,T=k&&k.invert?k.invert(j.chartY):null;return ie(ie({},j),{},{xValue:C,yValue:T})}var A=cH(this.state,this.props.data,this.props.layout,E);return A?ie(ie({},j),A):null}},{key:"inRange",value:function(b,w){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=this.props.layout,j=b/_,S=w/_;if(x==="horizontal"||x==="vertical"){var E=this.state.offset,O=j>=E.left&&j<=E.left+E.width&&S>=E.top&&S<=E.top+E.height;return O?{x:j,y:S}:null}var N=this.state,M=N.angleAxisMap,P=N.radiusAxisMap;if(M&&P){var I=yi(M);return CW({x:j,y:S},I)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,w=this.getTooltipEventType(),_=fr(b,Da),x={};_&&w==="axis"&&(_.props.trigger==="click"?x={onClick:this.handleClick}:x={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var j=qm(this.props,this.handleOuterEvent);return ie(ie({},j),x)}},{key:"addListener",value:function(){oN.on(iN,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){oN.removeListener(iN,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,w,_){for(var x=this.state.formattedGraphicalItems,j=0,S=x.length;j<S;j++){var E=x[j];if(E.item===b||E.props.key===b.key||w===No(E.item.type)&&_===E.childIndex)return E}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,w=this.state.offset,_=w.left,x=w.top,j=w.height,S=w.width;return U.createElement("defs",null,U.createElement("clipPath",{id:b},U.createElement("rect",{x:_,y:x,height:j,width:S})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(w,_){var x=eH(_,2),j=x[0],S=x[1];return ie(ie({},w),{},Fe({},j,S.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(w,_){var x=eH(_,2),j=x[0],S=x[1];return ie(ie({},w),{},Fe({},j,S.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(b){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(b){var w=this.state,_=w.formattedGraphicalItems,x=w.activeItem;if(_&&_.length)for(var j=0,S=_.length;j<S;j++){var E=_[j],O=E.props,N=E.item,M=N.type.defaultProps!==void 0?ie(ie({},N.type.defaultProps),N.props):N.props,P=No(N.type);if(P==="Bar"){var I=(O.data||[]).find(function(A){return AOe(b,A)});if(I)return{graphicalItem:E,payload:I}}else if(P==="RadialBar"){var k=(O.data||[]).find(function(A){return CW(b,A)});if(k)return{graphicalItem:E,payload:k}}else if(Xy(E,x)||Qy(E,x)||xp(E,x)){var C=wCe({graphicalItem:E,activeTooltipItem:x,itemData:M.data}),T=M.activeIndex===void 0?C:M.activeIndex;return{graphicalItem:ie(ie({},E),{},{childIndex:T}),payload:xp(E,x)?M.data[C]:E.props.data[C]}}}return null}},{key:"render",value:function(){var b=this;if(!NB(this))return null;var w=this.props,_=w.children,x=w.className,j=w.width,S=w.height,E=w.style,O=w.compact,N=w.title,M=w.desc,P=tH(w,NPe),I=yt(P,!1);if(O)return U.createElement(yq,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},U.createElement(BS,_l({},I,{width:j,height:S,title:N,desc:M}),this.renderClipPath(),PB(_,this.renderMap)));if(this.props.accessibilityLayer){var k,C;I.tabIndex=(k=this.props.tabIndex)!==null&&k!==void 0?k:0,I.role=(C=this.props.role)!==null&&C!==void 0?C:"application",I.onKeyDown=function(A){b.accessibilityManager.keyboardEvent(A)},I.onFocus=function(){b.accessibilityManager.focus()}}var T=this.parseEventsOfWrapper();return U.createElement(yq,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},U.createElement("div",_l({className:xt("recharts-wrapper",x),style:ie({position:"relative",cursor:"default",width:j,height:S},E)},T,{ref:function(A){b.container=A}}),U.createElement(BS,_l({},I,{width:j,height:S,title:N,desc:M,style:qPe}),this.renderClipPath(),PB(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(g.Component);Fe(f,"displayName",t),Fe(f,"defaultProps",ie({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),Fe(f,"getDerivedStateFromProps",function(m,v){var b=m.dataKey,w=m.data,_=m.children,x=m.width,j=m.height,S=m.layout,E=m.stackOffset,O=m.margin,N=v.dataStartIndex,M=v.dataEndIndex;if(v.updateId===void 0){var P=lH(m);return ie(ie(ie({},P),{},{updateId:0},p(ie(ie({props:m},P),{},{updateId:0}),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:j,prevLayout:S,prevStackOffset:E,prevMargin:O,prevChildren:_})}if(b!==v.prevDataKey||w!==v.prevData||x!==v.prevWidth||j!==v.prevHeight||S!==v.prevLayout||E!==v.prevStackOffset||!Uc(O,v.prevMargin)){var I=lH(m),k={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},C=ie(ie({},cH(v,w,S)),{},{updateId:v.updateId+1}),T=ie(ie(ie({},I),k),C);return ie(ie(ie({},T),p(ie({props:m},T),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:j,prevLayout:S,prevStackOffset:E,prevMargin:O,prevChildren:_})}if(!$S(_,v.prevChildren)){var A,R,L,D,B=fr(_,ul),F=B&&(A=(R=B.props)===null||R===void 0?void 0:R.startIndex)!==null&&A!==void 0?A:N,$=B&&(L=(D=B.props)===null||D===void 0?void 0:D.endIndex)!==null&&L!==void 0?L:M,V=F!==N||$!==M,Q=!gt(w),X=Q&&!V?v.updateId:v.updateId+1;return ie(ie({updateId:X},p(ie(ie({props:m},v),{},{updateId:X,dataStartIndex:F,dataEndIndex:$}),v)),{},{prevChildren:_,dataStartIndex:F,dataEndIndex:$})}return null}),Fe(f,"renderActiveDot",function(m,v,b){var w;return g.isValidElement(m)?w=g.cloneElement(m,v):tt(m)?w=m(v):w=U.createElement(_U,v),U.createElement(pn,{className:"recharts-active-dot",key:b},w)});var y=g.forwardRef(function(m,v){return U.createElement(f,_l({},m,{ref:v}))});return y.displayName=f.displayName,y},nke=tke({chartName:"BarChart",GraphicalChild:gs,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:fg},{axisType:"yAxis",AxisComp:nN}],formatAxisMap:mNe});const rke={light:"",dark:".dark"},dH=g.createContext(null);function pH(){const e=g.useContext(dH);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const fH=g.forwardRef(({id:e,className:t,children:n,config:r,...a},o)=>{const i=g.useId(),s=`chart-${e||i.replace(/:/g,"")}`;return h.jsx(dH.Provider,{value:{config:r},children:h.jsxs("div",{"data-chart":s,ref:o,className:Z("flex aspect-video justify-center text-xs",t),...a,children:[h.jsx(ake,{id:s,config:r}),h.jsx(qwe,{children:n})]})})});fH.displayName="Chart";const ake=({id:e,config:t})=>{const n=Object.entries(t).filter(([r,a])=>a.theme||a.color);return n.length?h.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(rke).map(([r,a])=>`
${a} [data-chart=${e}] {
${n.map(([o,i])=>{var c;const s=((c=i.theme)==null?void 0:c[r])||i.color;return s?`  --color-${o}: ${s};`:null}).join(`
`)}
}
`).join(`
`)}}):null},oke=Da,hH=g.forwardRef(({active:e,payload:t,className:n,indicator:r="dot",hideLabel:a=!1,hideIndicator:o=!1,label:i,labelFormatter:s,labelClassName:c,formatter:l,color:u,nameKey:d,labelKey:p},f)=>{const{config:y}=pH(),m=g.useMemo(()=>{var j;if(a||!(t!=null&&t.length))return null;const[b]=t,w=`${p||b.dataKey||b.name||"value"}`,_=dN(y,b,w),x=!p&&typeof i=="string"?((j=y[i])==null?void 0:j.label)||i:_==null?void 0:_.label;return s?h.jsx("div",{className:Z("font-medium",c),children:s(x,t)}):x?h.jsx("div",{className:Z("font-medium",c),children:x}):null},[i,s,t,a,c,y,p]);if(!e||!(t!=null&&t.length))return null;const v=t.length===1&&r!=="dot";return h.jsxs("div",{ref:f,className:Z("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[v?null:m,h.jsx("div",{className:"grid gap-1.5",children:t.map((b,w)=>{const _=`${d||b.name||b.dataKey||"value"}`,x=dN(y,b,_),j=u||b.payload.fill||b.color;return h.jsx("div",{className:Z("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",r==="dot"&&"items-center"),children:l&&(b==null?void 0:b.value)!==void 0&&b.name?l(b.value,b.name,b,w,b.payload):h.jsxs(h.Fragment,{children:[x!=null&&x.icon?h.jsx(x.icon,{}):!o&&h.jsx("div",{className:Z("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":v&&r==="dashed"}),style:{"--color-bg":j,"--color-border":j}}),h.jsxs("div",{className:Z("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[h.jsxs("div",{className:"grid gap-1.5",children:[v?m:null,h.jsx("span",{className:"text-muted-foreground",children:(x==null?void 0:x.label)||b.name})]}),b.value&&h.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:b.value.toLocaleString()})]})]})},b.dataKey)})})]})});hH.displayName="ChartTooltip";const ike=g.forwardRef(({className:e,hideIcon:t=!1,payload:n,verticalAlign:r="bottom",nameKey:a},o)=>{const{config:i}=pH();return n!=null&&n.length?h.jsx("div",{ref:o,className:Z("flex items-center justify-center gap-4",r==="top"?"pb-3":"pt-3",e),children:n.map(s=>{const c=`${a||s.dataKey||"value"}`,l=dN(i,s,c);return h.jsxs("div",{className:Z("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[l!=null&&l.icon&&!t?h.jsx(l.icon,{}):h.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:s.color}}),l==null?void 0:l.label]},s.value)})}):null});ike.displayName="ChartLegend";function dN(e,t,n){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=n;return n in t&&typeof t[n]=="string"?a=t[n]:r&&n in r&&typeof r[n]=="string"&&(a=r[n]),a in e?e[a]:e[n]}const mH=e=>{const t=["Bytes","KB","MB","GB","TB"];if(e===void 0)return"Unknown size";if(e===0)return"0 Byte";const n=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,n))} ${t[n]}`},ske=g.memo(()=>{const{t:e}=Pe("flows"),[t,n]=g.useState(),r=Ua(y=>y.cachedLLMURLs),a=Ye(y=>y.currentSession),[o,i]=g.useState(),[s,c]=g.useState(""),[l,u]=g.useState(),d=g.useMemo(()=>({nodes:{label:e("session_info_node.entities.nodes"),color:"#2563eb"},edges:{label:e("session_info_node.entities.edges"),color:"#34d399"},threads:{label:e("session_info_node.entities.threads"),color:"#fbbf24"},llms:{label:e("session_info_node.entities.llms"),color:"#f87171"},prompts:{label:e("session_info_node.entities.prompts"),color:"#a78bfa"},tools:{label:e("session_info_node.entities.tools"),color:"#ffcccb"},schemas:{label:e("session_info_node.entities.schemas"),color:"#ffb6c1"},vectorDatabases:{label:e("session_info_node.entities.vector_databases"),color:"#ff69b4"},jsonlDatas:{label:e("session_info_node.entities.jsonl_data"),color:"#ff1493"},csvDatas:{label:e("session_info_node.entities.csv_data"),color:"#db7093"}}),[e]);g.useEffect(()=>{At(async()=>{const{functionCallingModelIds:y,prebuiltAppConfig:m}=await import("./index-C4ZCpUfV.js").then(async v=>(await v.__tla,v));return{functionCallingModelIds:y,prebuiltAppConfig:m}},__vite__mapDeps([5,1,2,3,4])).then(({functionCallingModelIds:y,prebuiltAppConfig:m})=>{n(r==null?void 0:r.map(v=>{const b=m.model_list.find(w=>v.includes(w.model));if(b)return{model_id:(b==null?void 0:b.model_id)||"",info:b,isFunctionCalling:y.includes((b==null?void 0:b.model_id)||"")}}))})},[r,a==null?void 0:a.id]);const p=g.useCallback(async()=>{navigator.storage.estimate().then(y=>{y&&c(e("session_info_node.used_bytes",{used:mH(y.usage),total:mH(y==null?void 0:y.quota)}))}),a!=null&&a.id&&(Promise.all([ue("FlowNode").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("FlowEdge").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("Thread").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("Prompt").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("LLM").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("Schema").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("ToolDefinition").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("VectorDatabase").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("JSONLData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("CSVData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}})]).then(y=>{const m=y.reduce((v,b)=>b!=null&&b.updated_at&&(!v||new Date(b.updated_at)>v)?new Date(b.updated_at):v,a.updated_at?new Date(a.updated_at):void 0);i(m)}),Promise.all([ue("FlowNode").count({where:{session_id:a==null?void 0:a.id}}),ue("FlowEdge").count({where:{session_id:a==null?void 0:a.id}}),ue("Thread").count({where:{session_id:a==null?void 0:a.id}}),ue("Prompt").count({where:{session_id:a==null?void 0:a.id}}),ue("LLM").count({where:{session_id:a==null?void 0:a.id}}),ue("ToolDefinition").count({where:{session_id:a==null?void 0:a.id}}),ue("Schema").count({where:{session_id:a==null?void 0:a.id}}),ue("VectorDatabase").count({where:{session_id:a==null?void 0:a.id}}),ue("JSONLData").count({where:{session_id:a==null?void 0:a.id}}),ue("CSVData").count({where:{session_id:a==null?void 0:a.id}})]).then(([y,m,v,b,w,_,x,j,S,E])=>{u([{name:e("session_info_node.count_info.title"),nodes:y||0,edges:m||0,threads:v||0,prompts:b||0,llms:w||0,tools:_||0,schemas:x||0,vectorDatabases:j||0,jsonlDatas:S||0,csvDatas:E||0}])}))},[a==null?void 0:a.id,a==null?void 0:a.updated_at,e]),f=g.useCallback(()=>{p()},[p]);return g.useEffect(()=>{p()},[p]),h.jsxs(Zt,{className:"w-96",children:[h.jsxs(Ln,{children:[h.jsx(Kn,{children:e("session_info_node.title")}),h.jsx(h8,{children:o||a!=null&&a.updated_at?JAe(o||(a==null?void 0:a.updated_at)).fromNow():""})]}),h.jsxs($n,{className:"grid gap-4",children:[h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsx("p",{className:"text-sm font-medium leading-none",children:e("session_info_node.disk_size")}),h.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})}),h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsxs("div",{className:"text-sm font-medium leading-none",children:[e("session_info_node.cached_llms"),h.jsx(xn,{className:"ml-2",children:(t==null?void 0:t.length)||0})]}),t==null?void 0:t.map(y=>h.jsxs("div",{className:"text-sm text-muted-foreground gap-1",children:[y==null?void 0:y.model_id,h.jsx("div",{className:"max-w-full gap-1 flex flex-wrap mt-1",children:h.jsx(Sd,{model:y==null?void 0:y.info,isFunctionCalling:(y==null?void 0:y.isFunctionCalling)||!1,isCached:!0})})]},y==null?void 0:y.model_id))]})}),h.jsx("div",{children:h.jsx(fH,{config:d,className:"min-h-28 w-full",children:h.jsxs(nke,{accessibilityLayer:!0,data:l,children:[h.jsx(zq,{vertical:!1}),h.jsx(fg,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),h.jsx(oke,{content:h.jsx(hH,{})}),Object.entries(d).map(([y,m])=>h.jsx(gs,{dataKey:y,fill:m.color,radius:4},y))]})})})]}),h.jsx(ci,{children:h.jsxs(ut,{className:"w-full",onClick:f,children:[h.jsx(de,{size:24,name:"refresh-ccw"}),e("session_info_node.reload")]})})]})}),cke=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);An(e,t)},lke=g.memo(e=>{var c,l;const{t}=Pe("flows"),{id:n,data:r,isConnectable:a}=e,o=g.useRef(!1),i=Tn(n),s=De(u=>u.updateNodes);return cke(n),g.useEffect(()=>{var d;const u=r==null?void 0:r.entity;!u||!i||o.current||(d=u==null?void 0:u.schema_items)!=null&&d.length||r.loaded||(o.current=!0,ue("SchemaItem").find({where:{schema_id:u.id}}).then(p=>{s([{id:i.id,type:"replace",item:{...i,data:{...(i==null?void 0:i.data)||{},loaded:!0,entity:{...r.entity,schema_items:p}}}}])}).finally(()=>{o.current=!1}))},[r.entity,r.loaded,i,s]),h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Nn,{id:n}),h.jsxs(bj,{defaultValue:"account",className:"w-[400px]",children:[h.jsxs(wm,{className:"grid w-full grid-cols-2",children:[h.jsx(ra,{value:"account",children:t("schema_node.typescript")}),h.jsx(ra,{value:"password",children:t("schema_node.zod")})]}),h.jsx(aa,{value:"account",children:h.jsx(Zt,{className:"p-4",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:Vfe(((c=r==null?void 0:r.entity)==null?void 0:c.schema_items)||[])})})}),h.jsx(aa,{value:"password",children:h.jsx(Zt,{className:"p-4 max-w-full",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:f8(((l=r==null?void 0:r.entity)==null?void 0:l.schema_items)||[])})})})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:a})]})}),uke=g.memo(e=>{var o,i;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{if(!(n!=null&&n.entity))return{headers:[],rows:[]};const s=Pg(n.entity.csv);return{headers:CN(n.entity.headers),rows:s.map(c=>CN(c))}},[n==null?void 0:n.entity]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Zt,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Ln,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(de,{name:"file-spreadsheet",className:"mr-2"}),h.jsxs(nt,{className:"!font-medium leading-none tracking-tight pr-8",children:[oe.CSVData," ",(o=a==null?void 0:a.rows)!=null&&o.length?`(${((i=a==null?void 0:a.rows)==null?void 0:i.length)||0})`:""]})]})}),h.jsx($n,{className:"pb-0",children:h.jsx(Am,{data:a.rows,headers:a.headers})})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),dke=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.Schema&&(o==null?void 0:o.type)===oe.ToolDefinition){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},pke=g.memo(({id:e,data:t,isConnectable:n})=>{var r,a;return dke(e),h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:n}),h.jsx("div",{children:h.jsxs(Ra,{className:"flex justify-center",children:[h.jsx(de,{size:24,name:"wrench"}),h.jsxs("div",{className:"ml-2",children:[h.jsx(Oo,{children:`${((r=t.entity)==null?void 0:r.name)||""}`}),h.jsx(zc,{children:`${((a=t.entity)==null?void 0:a.description)||""}`})]})]})}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:n})]})}),fke=e=>{const t=g.useCallback(async({edgeId:n})=>({deleteEdgeId:n}),[]);An(e,t)},hke=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e;return fke(t),h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsx("div",{children:h.jsxs(Ra,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(Aa,{name:n.model||"brain",className:"w-7 h-7"}),h.jsx("div",{className:"ml-2 pr-4 flex items-center",children:h.jsx(Oo,{children:`${n.model||""}`})})]})}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),mke=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
Use three sentences maximum and keep the answer as concise as possible.

{context}
`,yke=Ha(e=>{const{source:t,documents:n}=e,r=Xt(),{toast:a}=Qt(),{t:o}=Pe("dialogs"),{loading:i,createPrompt:s}=U9(),c=async l=>{try{if(!l.content||!l.content.includes("{context}")){a({title:o("create_vector_database_prompt.errors.fill_context"),variant:"destructive"});return}const u=l.content.replace("{context}",n.map(d=>`<document>${d.pageContent}</document>`).join(`
`));return await s(t,{...l,content:u}),r.hide(),!0}catch{a({title:o("create_vector_database_prompt.errors.create_failed"),variant:"destructive"})}};return h.jsx(Yo,{open:r.visible,onOpenChange:r.hide,children:h.jsxs(no,{className:"sm:max-w-[425px]",children:[h.jsx(ro,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(ao,{children:o("create_vector_database_prompt.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(_S,{onSubmit:c,loading:i,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:mke}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(de,{name:"info",className:"mr-2",size:14}),o("create_vector_database_prompt.fill_content_note")]})]})]})})}),gke=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async({prompt:i,source:s,metadata:c})=>{var l,u,d,p;try{const f=(l=s==null?void 0:s.data)==null?void 0:l.entity;if(!f||!e)throw new Error("Source or Session not found");n(!0);const y=((u=s.position)==null?void 0:u.x)||0,m=(((d=s.position)==null?void 0:d.y)||0)+(((p=s.measured)==null?void 0:p.height)||0),v=await ue("Prompt").save({...i,status:(i==null?void 0:i.status)||Ir.Started,role:(i==null?void 0:i.role)||nr.System,type:(i==null?void 0:i.type)||rr.Chat,content:(i==null?void 0:i.content)||"{context}",session_id:e});if(!v)throw new Error("Failed to save prompt");const b=await r({source_id:v.id,source_type:"Prompt",node_type:oe.Prompt,x:y,y:m+20});if(!b)throw new Error("Failed to save prompt node");const w=await ue("FlowNodePlaceholder").save({placeholder:`Retriever for ${f.name}`,placeholder_type:As.VECTOR_DATABASE_RETREIVER,session_id:e,metadata:c});if(!w)throw new Error("Failed to save node placeholder");const _=await r({source_id:w.id,source_type:"FlowNodePlaceholder",node_type:oe.PlaceHolder,x:y,y:m+40});if(!_)throw new Error("Failed to save node placeholder node");await a({source:b.id,target:_.id}),await a({source:s.id,target:_.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabaseRetriever:o}},vke=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}
`,bke=Ha(e=>{const{source:t}=e,n=Xt(),{toast:r}=Qt(),{t:a}=Pe("dialogs"),[o,i]=g.useState(1),[s,c]=g.useState(void 0),{loading:l,createVectorDatabaseRetriever:u}=gke(),d=async y=>{try{const m=y.content;if(!m||!m.includes("{context}")){r({title:a("create_vector_database_retriever.errors.fill_context"),variant:"destructive"});return}return await u({source:t,prompt:{content:m},metadata:{k:o,minimalScore:s}}),i(1),c(void 0),n.hide(),!0}catch{r({title:a("create_vector_database_retriever.errors.create_failed"),variant:"destructive"})}},p=y=>{i(y.target.value?Number(y.target.value):void 0)},f=y=>{c(y.target.value?Number(y.target.value):void 0)};return h.jsx(Yo,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(no,{className:"sm:max-w-[425px]",children:[h.jsx(ro,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(ao,{children:a("create_vector_database_retriever.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(_S,{onSubmit:d,loading:l,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:vke}),h.jsxs(Zt,{children:[h.jsx(Ln,{children:h.jsx(Kn,{children:a("create_vector_database_retriever.retriever_settings")})}),h.jsxs($n,{children:[h.jsx(nt,{children:a("create_vector_database_retriever.retriever_k")}),h.jsx(En,{value:o||"",type:"number",onChange:p,placeholder:a("create_vector_database_retriever.retriever_k_placeholder")}),h.jsx(nt,{children:a("create_vector_database_retriever.retriever_minimum_score")}),h.jsx(En,{value:s||"",type:"number",onChange:f,placeholder:a("create_vector_database_retriever.retriever_minimum_score_placeholder")})]})]}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(de,{name:"info",className:"mr-2",size:14}),a("create_vector_database_retriever.fill_content_note")]})]})]})})}),wke=e=>{const t=De(a=>a.createOrUpdateFlowEdge),n=js(a=>a.index),r=g.useCallback(async({edgeId:a,target:o,source:i})=>{var s,c;try{const l=(s=o==null?void 0:o.data)==null?void 0:s.entity;if((i==null?void 0:i.type)===oe.CSVData&&(o==null?void 0:o.type)===oe.VectorDatabase){const u=(c=i==null?void 0:i.data)==null?void 0:c.entity;if(!u||!l)return{deleteEdgeId:a};const{rows:d}=bK(u.headers,u.csv),p=d.map(f=>new Lp({pageContent:`${f.text}`}));await n({databaseId:l.id,dataSourceId:u.id,dataSourceType:"CSVData"},p),await t({source:i.id,target:o.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[t,n]);An(e,r)},xke=e=>{const[t,n]=g.useState(!1),{t:r}=Pe("flows"),{toast:a}=Qt(),{getNode:o,getHandleConnections:i}=lr(),s=De(p=>p.updateNodes),c=js(p=>p.index),l=js(p=>p.similaritySearchWithScore),u=g.useCallback(async(p,f)=>{var y,m,v;try{const b=o(e);if(!b)return;const w=(y=b.data)==null?void 0:y.entity;if(!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(w.storage===kr.DataNode){const _=(v=(m=i({nodeId:e,type:"target"}).map(x=>o(x.source)).find(x=>(x==null?void 0:x.type)&&[oe.JSONLData,oe.CSVData].includes(x==null?void 0:x.type)))==null?void 0:m.data)==null?void 0:v.entity;if(!_){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}return n(!0),await l({databaseId:w.id,dataSourceId:_.id,dataSourceType:ON(_)},p,f==null?void 0:f.k)}else return n(!0),await l({databaseId:w.id},p,f==null?void 0:f.k)}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,l,a,r,o]),d=g.useCallback(async(p,f)=>{var y,m,v,b;try{const w=o(e);if(!w)return;n(!0);const _=p.content?[new Lp({pageContent:p.content,id:p.id,metadata:{id:p.id}})]:p.documents;if(!(_!=null&&_.length)){a({variant:"destructive",title:r("vector_database_node.errors.content_not_found")});return}const x=(y=w.data)==null?void 0:y.entity;if(!x||!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(x.storage===kr.DataNode){const j=i({nodeId:e,type:"target"}).map(M=>o(M.source)).find(M=>(M==null?void 0:M.type)&&[oe.JSONLData,oe.CSVData].includes(M==null?void 0:M.type)),S=(m=j==null?void 0:j.data)==null?void 0:m.entity;if(!S){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}const E=ON(S),O=Wj(_,10);let N=0;for(const M of O){if((v=f==null?void 0:f.onProgressReport)==null||v.call(f,{handling:M.length,handled:N,total:_.length}),await c({databaseId:x.id,dataSourceId:S.id,dataSourceType:E},M),E&&j){const P=await ue(E).findOne({where:{id:S.id}});s([{type:"replace",id:j.id,item:{...j,data:{...j.data,entity:P}}}])}N+=M.length}}else{const j=Wj(_,10);let S=0;for(const E of j){(b=f==null?void 0:f.onProgressReport)==null||b.call(f,{handling:E.length,handled:S,total:_.length}),await c({databaseId:x.id},E);const O=await ue("VectorDatabase").findOne({where:{id:`${x.id}`}});s([{type:"replace",id:w.id,item:{...w,data:{...w.data,entity:O}}}]),S+=E.length}}}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,c,a,r,o,s]);return{loading:t,indexData:d,similaritySearchWithScore:u}},_ke=g.memo(e=>{var S,E,O,N;const{t}=Pe("flows"),[n,r]=g.useState(0),[a,o]=g.useState("search"),i=Tn(e.id),{id:s,data:c,isConnectable:l}=e,{loading:u,similaritySearchWithScore:d,indexData:p}=xke(s),f=Xt(yke),y=Xt(bke);wke(s);const m=g.useCallback(async(...M)=>{i&&await p(...M)},[p,i]),v=g.useCallback(async(M,P)=>{const I=M.trim(),k=await d(I,{k:P});if(k!=null&&k.length)return k},[d]),b=g.useCallback(M=>{f.show({source:i,documents:M.map(([P])=>P)})},[f,i]),w=g.useCallback(async()=>{y.show({source:i})},[y,i]),_=g.useCallback(async M=>{if(M.type.includes("text")||M.type.includes("txt")){const P=new FileReader;P.onload=async I=>{var C;const k=(C=I.target)==null?void 0:C.result;await m({content:k})},P.readAsText(M)}else if(M.type.endsWith("pdf")){const P=new Blob([M],{type:"application/pdf"}),I=await new m8(P,{pdfjs:async()=>{const k=await At(()=>import("./pdf.min-CapCbGu3.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([7,1,2,3,4]));return await At(()=>import("./pdf.worker.min-DTwv-ugy.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([8,1,2,3,4])),k.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),k},parsedItemSeparator:" "}).load();await m({documents:I},{onProgressReport:k=>{r((k.handled+k.handling)/k.total)}})}},[m]),x=g.useMemo(()=>{var I,k;if(!((I=c==null?void 0:c.entity)!=null&&I.raw))return{headers:[],rows:[]};const M=["content","embedding","metadata"],P=Pg((k=c==null?void 0:c.entity)==null?void 0:k.raw);return{headers:M,rows:P.map(C=>{try{return JSON.parse(C)}catch{return[]}})}},[(S=c==null?void 0:c.entity)==null?void 0:S.raw]),j=g.useMemo(()=>{switch(a){case"search":return h.jsx(aa,{value:"search",children:h.jsx(O$,{loading:u,onSimilaritySearch:v,onCreatePrompt:b,onCreateRetriever:w})});case"new":return h.jsx(aa,{className:"min-w-80",value:"new",children:h.jsx(C$,{loading:u,onCreateData:m})});case"file":return h.jsx(aa,{value:"file",children:h.jsx(N$,{loading:u,progress:n,onFileSubmit:_,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(aa,{value:"view",children:h.jsx(Am,{data:x.rows,headers:x.headers,limitLengthByColumns:{embedding:32}})})}},[m,b,w,_,v,u,a,n,x]);return h.jsxs("div",{className:"min-w-72",children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:l}),h.jsxs("div",{className:"max-w-full",children:[h.jsx(Nn,{id:s}),h.jsxs(Ra,{className:"flex justify-center",variant:"default",children:[h.jsx(de,{size:24,name:"database-zap"}),h.jsxs("div",{className:"ml-2 max-w-full",children:[h.jsx(Oo,{children:`${((E=c.entity)==null?void 0:E.name)||""}`}),h.jsxs(bj,{value:a,onValueChange:o,defaultValue:"search",className:Z("w-full mt-4"),children:[h.jsxs(wm,{className:Z("grid w-full grid-cols-3",((O=c.entity)==null?void 0:O.storage)===kr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(ra,{value:"search",children:t("vector_database_node.search")}),h.jsx(ra,{value:"new",children:t("vector_database_node.text")}),h.jsx(ra,{value:"file",children:t("vector_database_node.file")}),((N=c.entity)==null?void 0:N.storage)===kr.DatabaseNode?h.jsx(ra,{value:"view",children:t("vector_database_node.view")}):void 0]}),j]})]})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:l})]})}),jke={embedding:32},Ske=g.memo(e=>{var o,i,s;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{var u;if(!((u=n==null?void 0:n.entity)!=null&&u.jsonl))return{headers:[],rows:[]};const c=CN(n.entity.headers||""),l=Pg(n.entity.jsonl);return{headers:c,rows:l.map(d=>{try{return JSON.parse(d)}catch{return[]}})}},[(o=n==null?void 0:n.entity)==null?void 0:o.jsonl,n.entity.headers]);return h.jsxs("div",{className:"min-w-80",children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Zt,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Ln,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(de,{name:"file-json",className:"mr-2"}),h.jsxs(nt,{className:"!font-medium leading-none tracking-tight pr-8",children:[oe.JSONLData," ",(i=a==null?void 0:a.rows)!=null&&i.length?`(${((s=a==null?void 0:a.rows)==null?void 0:s.length)||0})`:""]})]})}),h.jsx($n,{className:"pb-0",children:h.jsx(Am,{data:a.rows,headers:a.headers,limitLengthByColumns:jke})})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),yH=60,gH=140,Eke=qa("supports-backdrop-blur:bg-white/10 supports-backdrop-blur:dark:bg-black/10 mx-auto flex h-[58px] w-max gap-2 rounded-lg border p-2 backdrop-blur-md"),vH=U.forwardRef(({className:e,children:t,magnification:n=yH,distance:r=gH,direction:a="bottom",...o},i)=>{const s=Tv(1/0),c=()=>U.Children.map(t,l=>U.isValidElement(l)&&l.type===Mp?U.cloneElement(l,{...l.props,mouseX:s,magnification:n,distance:r}):l);return h.jsx(Ap.div,{ref:i,onMouseMove:l=>s.set(l.pageX),onMouseLeave:()=>s.set(1/0),...o,className:Z(Eke({className:e}),{"items-start":a==="top","items-center":a==="middle","items-end":a==="bottom"}),children:c()})});vH.displayName="Dock";const Mp=({magnification:e=yH,distance:t=gH,mouseX:n,className:r,children:a,...o})=>{const i=g.useRef(null),s=OM(n||new YAe,u=>{var p;const d=((p=i.current)==null?void 0:p.getBoundingClientRect())??{x:0,width:0};return u-d.x-d.width/2}),c=OM(s,[-t,0,t],[40,e,40]),l=zK(c,{mass:.1,stiffness:150,damping:12});return h.jsx(Ap.div,{ref:i,style:{width:l},className:Z("flex aspect-square cursor-pointer items-center justify-center rounded-full",r),...o,children:a})};Mp.displayName="DockIcon";let bH,wH,xH,_H,bg,jH,Pp,SH,EH,OH,CH,NH,MH,PH,kH,AH,TH,IH,RH,DH,LH,$H,FH,BH,zH,VH,WH,UH;bH=e=>g.createElement("svg",{viewBox:"0 0 256 254",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:256,height:254,preserveAspectRatio:"xMidYMid",...e},g.createElement("defs",null,g.createElement("linearGradient",{id:"c",x1:"50%",x2:"50%",y1:"0%",y2:"100%"},g.createElement("stop",{offset:"0%",stopColor:"#FFF"}),g.createElement("stop",{offset:"100%",stopColor:"#FFF",stopOpacity:0})),g.createElement("path",{id:"a",d:"M180.828 252.605a15.872 15.872 0 0 0 12.65-.486l52.501-25.262a15.94 15.94 0 0 0 9.025-14.364V41.197a15.939 15.939 0 0 0-9.025-14.363l-52.5-25.263a15.877 15.877 0 0 0-18.115 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.507 91.695a15.853 15.853 0 0 0 5.464 3.571Zm10.464-183.649-76.262 57.889 76.262 57.888V68.956Z"})),g.createElement("mask",{id:"b",fill:"#fff"},g.createElement("use",{xlinkHref:"#a"})),g.createElement("path",{fill:"#0065A9",d:"M246.135 26.873 193.593 1.575a15.885 15.885 0 0 0-18.123 3.08L3.466 161.482c-4.626 4.219-4.62 11.502.012 15.714l14.05 12.772a10.625 10.625 0 0 0 13.569.604L238.229 33.436c6.949-5.271 16.93-.315 16.93 8.407v-.61a15.938 15.938 0 0 0-9.024-14.36Z"}),g.createElement("path",{fill:"#007ACC",d:"m246.135 226.816-52.542 25.298a15.887 15.887 0 0 1-18.123-3.08L3.466 92.207c-4.626-4.218-4.62-11.502.012-15.713l14.05-12.773a10.625 10.625 0 0 1 13.569-.603l207.132 157.135c6.949 5.271 16.93.315 16.93-8.408v.611a15.939 15.939 0 0 1-9.024 14.36Z"}),g.createElement("path",{fill:"#1F9CF0",d:"M193.428 252.134a15.892 15.892 0 0 1-18.125-3.083c5.881 5.88 15.938 1.715 15.938-6.603V11.273c0-8.318-10.057-12.483-15.938-6.602a15.892 15.892 0 0 1 18.125-3.084l52.533 25.263a15.937 15.937 0 0 1 9.03 14.363V212.51c0 6.125-3.51 11.709-9.03 14.363l-52.533 25.262Z"}),g.createElement("path",{fill:"url(#c)",fillOpacity:.25,d:"M180.828 252.605a15.874 15.874 0 0 0 12.65-.486l52.5-25.263a15.938 15.938 0 0 0 9.026-14.363V41.197a15.939 15.939 0 0 0-9.025-14.363L193.477 1.57a15.877 15.877 0 0 0-18.114 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.506 91.695a15.857 15.857 0 0 0 5.465 3.571Zm10.464-183.65-76.262 57.89 76.262 57.888V68.956Z"})),wH="/NoLLMChat/assets/plate-editor-C1jTW62C.png",xH={[oe.Shape]:{width:100,height:100},[oe.CircleShape]:{width:100,height:100},[oe.TriangleShape]:{width:100,height:100},[oe.EditorApp]:{width:1240,height:400}},_H=e=>{const t=Tn(e),n=Ye(s=>s.currentSession),[r,a]=g.useState(!1),o=De(s=>s.createOrUpdateFlowNode),i=g.useCallback(async s=>{var c,l,u;try{if(a(!0),t&&(n==null?void 0:n.id)){const d=((c=t.position)==null?void 0:c.x)||0,p=(((l=t.position)==null?void 0:l.y)||0)+(((u=t.measured)==null?void 0:u.height)||0),f=await ue("FlowNodeData").save({data:{},session_id:n.id});if(!f)throw new Error("Failed to save node data");if(!await o({node_type:s,data:{},source_id:f.id,source_type:"FlowNodeData",x:d,y:p+20,...xH[s]||{}}))throw new Error("Failed to save node")}}finally{a(!1)}},[o,n==null?void 0:n.id,t]);return{loading:r,createNode:i}},bg={applications:[{key:oe.EditorApp,image:wH,label:"application_bar.editor"},{key:oe.VSLiteApp,icon:bH,label:"application_bar.vslite"}],shapes:[{key:oe.Shape,icon:"square",label:"application_bar.square"},{key:oe.CircleShape,icon:"circle",label:"application_bar.circle"},{key:oe.TriangleShape,icon:"triangle",label:"application_bar.triangle"}],old:[{key:oe.CodeContainerApp,icon:"file-code-2",label:"application_bar.code_editor"}]},jH=g.memo(e=>{const{t}=Pe("flows"),{toast:n}=Qt(),{loading:r,createNode:a}=_H(e.id),o=async i=>{try{if(r)return;await a(i)}catch{n({description:t("application_bar.errors.add_node_failed"),variant:"destructive"})}};return h.jsx(su,{children:h.jsxs(vH,{direction:"middle",children:[bg.applications.map(i=>{const s=i.icon;return h.jsx(Mp,{children:h.jsxs(ba,{children:[h.jsxs(wa,{children:[s?h.jsx(s,{width:20,height:20,onClick:()=>o(i.key)}):void 0,i.image?h.jsx("img",{src:i.image,alt:t(i.label),className:"w-8 h-8 rounded-md",onClick:()=>o(i.key)}):void 0]}),h.jsx(Br,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)}),h.jsx(Ms,{orientation:"vertical",className:"h-full"}),bg.shapes.map(i=>h.jsx(Mp,{children:h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(de,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Br,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)),h.jsx(Ms,{orientation:"vertical",className:"h-full"}),bg.old.map(i=>h.jsx(Mp,{children:h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(de,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Br,{children:h.jsx("p",{children:t(i.label)})})]})},i.label))]})})}),Pp=g.memo(e=>{const{lineClassName:t,handleClassName:n,...r}=e;return h.jsx(nle,{lineClassName:Z("!border-1.5",t),handleClassName:Z("!w-2 !h-2 !border-2 !rounded-full",n),...r})}),SH=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.CircleShape,oe.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.Shape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},EH=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return SH(t),h.jsxs(h.Fragment,{children:[h.jsx(Pp,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border border",children:h.jsx(Nn,{id:t})}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:r})]})}),OH=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.Shape,oe.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.CircleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},CH=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return OH(t),h.jsxs(h.Fragment,{children:[h.jsx(Pp,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border rounded-full border",children:h.jsx(Nn,{id:t})}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:r})]})}),NH=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.CircleShape,oe.Shape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.TriangleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},MH=g.memo(e=>{const{id:t,selected:n,width:r,height:a,isConnectable:o}=e;return NH(t),h.jsxs(h.Fragment,{children:[h.jsx(Pp,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:fe.Top,isConnectable:o}),h.jsx("div",{className:"w-0 h-0 border-l-transparent border-r-transparent border-b-border",style:{borderLeftWidth:(r||0)/2,borderRightWidth:(r||0)/2,borderBottomWidth:a||0}}),h.jsx(Nn,{id:t,className:"absolute top-0 right-0"}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:o})]})}),PH=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.EditorApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},kH=e=>{const t=Tn(e),{t:n}=Pe("flows"),r=g.useRef(null),{toast:a}=Qt(),{getNode:o,getHandleConnections:i}=lr(),{stream:s}=kc(),c=g.useCallback(async d=>{t&&(clearTimeout(r.current),r.current=setTimeout(async()=>{await ue("FlowNode").update(t.id,{data:d})},150))},[t]),l=g.useCallback(async(d,p)=>{var f;if(t){const y=i({nodeId:e,type:"target"}).find(b=>{var w;return((w=o(b.source))==null?void 0:w.type)===oe.LLM}),m=y?o(y==null?void 0:y.source):void 0,v=(f=m==null?void 0:m.data)==null?void 0:f.entity;if(!m||!v)return a({variant:"destructive",description:n("editor_node.errors.llm_not_found")});if(m.data.status!==Qe.Loaded)return a({variant:"destructive",description:n("editor_node.errors.llm_not_loaded_yet")});try{return(await s(v.provider,typeof d=="string"?[new Pr(d)]:d,{onMessageUpdate:b=>{p==null||p(b.content)},llm:v})).content}catch(b){if(b instanceof Error&&b.message.includes("LLM_NOT_LOADED_YET"))return a({title:n("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:n("editor_node.errors.stream_message_failed")})}}},[t,i,e,o,a,n,s]),u=g.useCallback(d=>{if(!o(d))return[];const p=[];return i({nodeId:d,type:"target"}).forEach(f=>{const y=o(f.source);!y||y.type!==oe.LLM||p.push({node:y,connections:[f]})}),p},[i,o]);return{createMessage:l,updateEditorContent:c,getLinkedConnections:u}},AH=g.lazy(()=>At(()=>import("./index-V6CS-75v.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,11,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),TH=g.memo(e=>{var l;const{id:t,data:n,selected:r,isConnectable:a}=e;PH(t);const{createMessage:o,updateEditorContent:i,getLinkedConnections:s}=kH(t),c=g.useCallback(u=>{i(u)},[i]);return h.jsxs("div",{className:"w-full min-w-[1240px] h-full",children:[h.jsx(Pp,{isVisible:!!r,minWidth:1240,minHeight:400}),h.jsx(lt,{type:"target",position:fe.Top,isConnectable:a}),h.jsxs("div",{className:"min-w-10 min-h-10 w-full h-full rounded-lg border bg-background",children:[h.jsx(Nn,{className:"!z-[100]",id:t,enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx("div",{className:"h-full w-ful rounded-lg","data-registry":"plate",children:h.jsx(AH,{defaultValue:(l=n==null?void 0:n.flowNode)==null?void 0:l.data,onValueChange:c,copilotStream:o})})})]}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:a})]})}),IH=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);An(e,t)},RH=g.memo(e=>{var i,s;const{id:t,data:n,isConnectable:r}=e,{t:a}=Pe("flows");IH(t);let o="";switch((i=n.entity)==null?void 0:i.placeholder_type){case"VECTOR_DATABASE_RETREIVER":o=a("placeholder_node.vector_database_retriever");break}return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs(Ra,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(Nn,{id:t}),h.jsx(de,{name:"land-plot",className:"w-7 h-7"}),h.jsxs("div",{className:"ml-2 pr-4",children:[h.jsx(Oo,{children:`${((s=n.entity)==null?void 0:s.placeholder)||""}`}),h.jsx(zc,{children:o?h.jsx(xn,{children:o}):void 0})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),DH=g.lazy(()=>At(()=>import("./CodeContainerApp-DMgoiVss.js").then(async e=>(await e.__tla,e)).then(e=>e.C),__vite__mapDeps([62,1,2,14,60,10]))),LH=g.memo(e=>{const{id:t,isConnectable:n}=e;return h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Nn,{id:t}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(DH,{...e})})]}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:n})]})}),$H=["empty-source","vite-vue","shadcn-react-vite","todo-app-react-vite","porfolio-nextjs"],FH=async e=>{switch(e){case"empty-source":return At(()=>import("./empty-source-Dw1dvL8s.js"),[]).then(t=>t.BASE);case"vite-vue":return At(()=>import("./vite-vue-Bmz2z3Fo.js"),[]).then(t=>t.BASE);case"shadcn-react-vite":return At(()=>import("./shadcn-react-vite-CDJ9BaE9.js"),[]).then(t=>t.BASE);case"todo-app-react-vite":return At(()=>import("./todo-app-react-vite-BBWBkRjR.js"),[]).then(t=>t.BASE);case"porfolio-nextjs":return At(()=>import("./porfolio-nextjs-DCkli5iW.js"),[]).then(t=>t.BASE);default:throw new Error(`Unknown source base: ${e}`)}},fM=g.memo(({className:e,onUpdateSourceBase:t})=>{const{t:n}=Pe("components"),[r,a]=g.useState();return h.jsxs(Zt,{className:Z("mw-full",e),children:[h.jsx(Ln,{className:"p-4",children:h.jsx(Kn,{children:n("add_source_base.title")})}),h.jsx($n,{className:"p-4",children:h.jsxs("div",{className:"flex items-center justify-center w-full h-full flex-col",children:[h.jsxs(_o,{onValueChange:o=>a(o),children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(jo,{placeholder:n("add_source_base.source_base_select_placeholder")})}),h.jsx(Ia,{children:$H.map(o=>h.jsx(Zn,{value:`${o}`,children:n(`add_source_base.sourcebases.${o.toLowerCase()}`)},`${o}`))})]}),h.jsx(ut,{className:"w-full",onClick:async()=>r&&t(await FH(r)),children:n("add_source_base.update_source")})]})})]})}),BH=()=>{const{getNode:e,getHandleConnections:t}=lr(),{stream:n}=kc(),r=g.useCallback(async(o,i)=>{await ue("FlowNode").update(o,{raw:wv(i)})},[]),a=g.useCallback(o=>{if(!e(o))return[];const i=[];return t({nodeId:o,type:"target"}).forEach(s=>{const c=e(s.source);!c||c.type!==oe.LLM||i.push({node:c,connections:[s]})}),i},[t,e]);return{sendMessage:g.useCallback(async(o,i,{onMessageUpdate:s,onResponseMessageCreate:c}={})=>{const l=i.map(d=>d.role==="system"?new Mg(d.content):d.role==="user"?new Pr(d.content):new Wo(d.content));c==null||c();const{content:u}=await n(ln.WebLLM,[...l,new Pr(o)],{onMessageUpdate:({content:d})=>{s==null||s({nodeData:{loading:!0,content:d}})},llm:void 0});return s==null||s({nodeData:{loading:!1,content:u}}),u},[n]),getLinkedConnections:a,updateCodeContainerData:r}},zH=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.VSLiteApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},VH=g.lazy(()=>At(()=>import("./index-D0mkdqkZ.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),WH=g.memo(e=>{var p,f,y,m;const{id:t,isConnectable:n,data:r}=e,[a,o]=g.useState((p=r==null?void 0:r.flowNode)!=null&&p.raw?Sv(r.flowNode.raw):void 0),{updateCodeContainerData:i,getLinkedConnections:s,sendMessage:c}=BH();zH(t);const l=g.useCallback(async v=>{var b,w;(b=r==null?void 0:r.flowNode)!=null&&b.id&&(await i((w=r==null?void 0:r.flowNode)==null?void 0:w.id,v),o(v))},[(f=r==null?void 0:r.flowNode)==null?void 0:f.id,i]),u=g.useCallback(async(v,b)=>{var w;return(w=r==null?void 0:r.flowNode)!=null&&w.id?await c(v,b):void 0},[(y=r==null?void 0:r.flowNode)==null?void 0:y.id,c]),d=g.useCallback(async v=>{o(b=>{var _;const w=Ev(b||{},v);return i((_=r==null?void 0:r.flowNode)==null?void 0:_.id,w),w})},[(m=r==null?void 0:r.flowNode)==null?void 0:m.id,i]);return a?h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Nn,{id:t,className:"z-50",enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(VH,{fileSystemTree:a,onUpdateFileContent:d,sendMessage:u})})]}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:n})]}):h.jsx("div",{className:"h-full flex justify-center items-center",children:h.jsx(fM,{className:"w-64",onUpdateSourceBase:l})})}),UH={[oe.LLM]:lB,[oe.Toolbox]:nB,[oe.Thread]:hB,[oe.Message]:kve,[oe.Prompt]:Tve,[oe.SessionInfo]:ske,[oe.Schema]:lke,[oe.CSVData]:uke,[oe.ToolDefinition]:pke,[oe.DefaultEmbeddingModel]:hke,[oe.VectorDatabase]:_ke,[oe.JSONLData]:Ske,[oe.ApplicationBar]:jH,[oe.Shape]:EH,[oe.CircleShape]:CH,[oe.TriangleShape]:MH,[oe.EditorApp]:TH,[oe.PlaceHolder]:RH,[oe.CodeContainerApp]:LH,[oe.VSLiteApp]:WH};function Oke(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:p,children:f,...y}=d,m=(p==null?void 0:p[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:f})}function u(d,p){const f=(p==null?void 0:p[e][c])||s,y=g.useContext(f);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,Cke(a,...t)]}function Cke(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var Nke="Toggle",pN=g.forwardRef((e,t)=>{const{pressed:n,defaultPressed:r=!1,onPressedChange:a,...o}=e,[i=!1,s]=Sn({prop:n,onChange:a,defaultProp:r});return h.jsx(Ae.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":e.disabled?"":void 0,...o,ref:t,onClick:ge(e.onClick,()=>{e.disabled||s(!i)})})});pN.displayName=Nke;let fN,ws,hN,mN,wg;fN=pN,ws="ToggleGroup",[hN,EK]=Oke(ws,[Za]),mN=Za(),wg=U.forwardRef((e,t)=>{const{type:n,...r}=e;if(n==="single"){const a=r;return h.jsx(Mke,{...a,ref:t})}if(n==="multiple"){const a=r;return h.jsx(Pke,{...a,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${ws}\``)}),wg.displayName=ws;var[qH,HH]=hN(ws),Mke=U.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i,s]=Sn({prop:n,defaultProp:r,onChange:a});return h.jsx(qH,{scope:e.__scopeToggleGroup,type:"single",value:i?[i]:[],onItemActivate:s,onItemDeactivate:U.useCallback(()=>s(""),[s]),children:h.jsx(KH,{...o,ref:t})})}),Pke=U.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Sn({prop:n,defaultProp:r,onChange:a}),c=U.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=U.useCallback(u=>s((d=[])=>d.filter(p=>p!==u)),[s]);return h.jsx(qH,{scope:e.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:c,onItemDeactivate:l,children:h.jsx(KH,{...o,ref:t})})});wg.displayName=ws;var[kke,Ake]=hN(ws),KH=U.forwardRef((e,t)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:a=!0,orientation:o,dir:i,loop:s=!0,...c}=e,l=mN(n),u=Uo(i),d={role:"group",dir:u,...c};return h.jsx(kke,{scope:n,rovingFocus:a,disabled:r,children:a?h.jsx(Fl,{asChild:!0,...l,orientation:o,dir:u,loop:s,children:h.jsx(Ae.div,{...d,ref:t})}):h.jsx(Ae.div,{...d,ref:t})})}),xg="ToggleGroupItem",ZH=U.forwardRef((e,t)=>{const n=HH(xg,e.__scopeToggleGroup),r=Ake(xg,e.__scopeToggleGroup),a=mN(e.__scopeToggleGroup),o=n.value.includes(e.value),i=r.disabled||e.disabled,s={...e,pressed:o,disabled:i},c=U.useRef(null);return r.rovingFocus?h.jsx(Bl,{asChild:!0,...a,focusable:!i,active:o,ref:c,children:h.jsx(yN,{...s,ref:t})}):h.jsx(yN,{...s,ref:t})});ZH.displayName=xg;let yN;yN=U.forwardRef((e,t)=>{const{__scopeToggleGroup:n,value:r,...a}=e,o=HH(xg,n),i={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},s=o.type==="single"?i:void 0;return h.jsx(pN,{...s,...a,ref:t,onPressedChange:c=>{c?o.onItemActivate(r):o.onItemDeactivate(r)}})}),zg=wg,Vg=ZH;const XH=qa("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),Tke=g.forwardRef(({className:e,variant:t,size:n,...r},a)=>h.jsx(fN,{ref:a,className:Z(XH({variant:t,size:n,className:e})),...r}));Tke.displayName=fN.displayName;const QH=g.createContext({size:"default",variant:"default"}),GH=g.forwardRef(({className:e,variant:t,size:n,children:r,...a},o)=>h.jsx(zg,{ref:o,className:Z("flex items-center justify-center gap-1",e),...a,children:h.jsx(QH.Provider,{value:{variant:t,size:n},children:r})}));GH.displayName=zg.displayName;const JH=g.forwardRef(({className:e,children:t,variant:n,size:r,...a},o)=>{const i=g.useContext(QH);return h.jsx(Vg,{ref:o,className:Z(XH({variant:i.variant||n,size:i.size||r}),e),...a,children:t})});JH.displayName=Vg.displayName;function Ike(){const e=Ge(t=>`x: ${t.transform[0].toFixed(2)}, y: ${t.transform[1].toFixed(2)}, zoom: ${t.transform[2].toFixed(2)}`);return h.jsx("div",{children:e})}function Rke({change:e}){var r,a,o,i;const t="id"in e?e.id:"-",{type:n}=e;return h.jsxs("div",{className:"mb-3",children:[h.jsxs("div",{children:["node id: ",t]}),h.jsxs("div",{children:[n==="add"?JSON.stringify(e.item,null,2):null,n==="dimensions"?`dimensions: ${(r=e.dimensions)==null?void 0:r.width} \xD7 ${(a=e.dimensions)==null?void 0:a.height}`:null,n==="position"?`position: ${(o=e.position)==null?void 0:o.x.toFixed(1)}, ${(i=e.position)==null?void 0:i.y.toFixed(1)}`:null,n==="remove"?"remove":null,n==="select"?e.selected?"select":"unselect":null]})]})}function Dke({limit:e=20}){const[t,n]=g.useState([]),r=Tt(),a=g.useCallback(i=>{n(s=>[...i,...s].slice(0,e))},[e]);g.useEffect(()=>(r.setState({onNodesChange:a}),()=>r.setState({onNodesChange:void 0})),[a,r]);const o=()=>h.jsx("div",{children:"No Changes Triggered"});return h.jsx(h.Fragment,{children:t.length===0?h.jsx(o,{}):t.map((i,s)=>h.jsx(Rke,{change:i},s))})}function Lke(){const{getInternalNode:e}=lr(),t=Pce();return h.jsx(Nce,{children:h.jsx("div",{className:"text-secondary-foreground",children:t.map(n=>{var o,i;const r=e(n.id);if(!r)return null;const a=r==null?void 0:r.internals.positionAbsolute;return h.jsx($ke,{id:n.id,selected:!!n.selected,type:n.type||"default",position:n.position,absPosition:a,width:((o=n.measured)==null?void 0:o.width)??0,height:((i=n.measured)==null?void 0:i.height)??0,data:n.data},n.id)})})})}function $ke({id:e,type:t,selected:n,position:r,absPosition:a,width:o,height:i,data:s}){if(!o||!i)return null;const c=`translate(${a.x}px, ${a.y+i}px)`,l=`${r.x.toFixed(1)}, ${r.y.toFixed(1)}`,u=`${o} \xD7 ${i}`,d=n?"Selected":"Not Selected";return h.jsxs("div",{style:{position:"absolute",transform:c,width:o*2},className:"text-xs",children:[h.jsxs("div",{children:["id: ",e]}),h.jsxs("div",{children:["type: ",t]}),h.jsxs("div",{children:["selected: ",d]}),h.jsxs("div",{children:["position: ",l]}),h.jsxs("div",{children:["dimensions: ",u]}),h.jsxs("div",{children:["data: ",JSON.stringify(s,null,2)]})]})}function Fke({tools:e}){return h.jsx(uc,{position:"top-left",className:"bg-card p-1 border rounded shadow-sm",children:h.jsx(GH,{type:"multiple",children:e.map(({active:t,setActive:n,label:r,value:a})=>h.jsx(JH,{value:a,onClick:()=>n(o=>!o),"aria-pressed":t,className:"bg-card text-card-foreground transition-colors duration-300 hover:bg-secondary hover:text-secondary-foreground",children:r},a))})})}function YH(){const[e,t]=g.useState(!1),[n,r]=g.useState(!1),[a,o]=g.useState(!1),i=[{active:e,setActive:t,label:"Node Inspector",value:"node-inspector"},{active:n,setActive:r,label:"Change Logger",value:"change-logger"},{active:a,setActive:o,label:"Viewport Logger",value:"viewport-logger"}];return h.jsxs(h.Fragment,{children:[h.jsx(Fke,{tools:i}),n&&h.jsx(uc,{className:"text-xs p-5 bg-white rounded shadow-md overflow-y-auto max-h-[50%] mt-20",position:"bottom-right",children:h.jsx(Dke,{})}),e&&h.jsx(Lke,{}),a&&h.jsx(uc,{position:"bottom-left",className:"text-secondary-foreground",children:h.jsx(Ike,{})})]})}YH.displayName="DevTools";const Bke=()=>{const e=g.useRef({}),t=g.useRef({}),n=De(M=>M.flowEdges),r=Ye(M=>M.currentSession),a=De(M=>M.setNodes),o=De(M=>M.updateNodes),i=De(M=>M.updateEdges),s=De(M=>M.addConnectionToEdges),c=De(M=>M.reset),l=De(M=>M.findFlowEdges),u=De(M=>M.deleteFlowNode),d=De(M=>M.deleteFlowEdge),p=De(M=>M.updateFlowNode),f=De(M=>M.getNodes),y=De(M=>M.findFlowNodesWithSource),m=g.useRef(n),v=g.useRef(),[b,w]=g.useState({loading:!1});m.current=n;const _=g.useCallback(async(M,P)=>{try{v.current=M,c(),await(P==null?void 0:P())}catch{v.current=void 0}},[c]),x=g.useCallback(async M=>{try{if(!(r!=null&&r.id))return;w(k=>({...k,loading:!0}));const P=await y({...M,where:{...M.where,session_id:r.id}}),I=await l({where:[{source:Ca(P.map(k=>k.id))},{target:Ca(P.map(k=>k.id))}]});return{flowNodes:P,flowEdges:I}}finally{w(P=>({...P,loading:!1}))}},[y,l,r==null?void 0:r.id]),j=g.useCallback(async M=>{var P,I;for(const k of M)if("id"in k&&Object.values(nd).includes(k.id)&&k.type!=="remove")o([k]);else if(k.type==="position"&&k.position&&!isNaN(k.position.x)&&!isNaN(k.position.y)){o([k]);const C=k.position.x,T=k.position.y;clearTimeout(e.current[k.id]),e.current[k.id]=setTimeout(async()=>{e.current[k.id]=void 0,await p({id:k.id,x:C,y:T},{silent:!0})},200)}else if(k.type==="remove"){const C=(P=f([k.id]))==null?void 0:P[0];if(!(C!=null&&C.type)||eue.includes(C.type))return;await u({id:k.id})}else if(k.type==="dimensions"&&k.dimensions&&!isNaN(k.dimensions.width)&&!isNaN(k.dimensions.height)){const C=(I=f([k.id]))==null?void 0:I[0];if(!(C!=null&&C.width)&&!(C!=null&&C.height))return;o([k]),clearTimeout(t.current[k.id]);const T=k.dimensions.width,A=k.dimensions.height;t.current[k.id]=setTimeout(async()=>{await p({id:k.id,width:T,height:A},{silent:!0})},200)}else k.type==="select"&&o([k])},[o,p,f,u]),S=g.useCallback(M=>{Promise.all(M.map(async P=>{if(P.type==="remove")return d({id:P.id})})),i(M)},[d,i]),E=g.useCallback(M=>{s(M)},[s]),O=g.useCallback(()=>{var M;(M=m.current)==null||M.length},[]),N=g.useCallback(M=>{a(P=>{var T,A;let I;if(typeof M=="function"?I=M(P):I=M,!I)return P;const k=P==null?void 0:P.find(R=>R.id===I.id),C={id:I.id,item:k?$h(k,I):{...I,position:{x:((T=I.position)==null?void 0:T.x)||0,y:((A=I.position)==null?void 0:A.y)||0}},type:k?"replace":"add"};return Hi([C],P)})},[a]);return{syncEdges:O,initialFlow:_,loadingState:b,prepareFlowInfo:x,updateNodeChanges:j,updateEdgeChanges:S,updateOrCreateNode:N,currentSessionIdRef:v,updateEdgeConnection:E}},zke=e=>{const t=Ye(u=>{var d;return(d=u.currentSession)==null?void 0:d.id}),{loadingState:n,prepareFlowInfo:r,syncEdges:a,initialFlow:o,currentSessionIdRef:i}=e,s=De(u=>u.ready),c=De(u=>u.removeSyncNodeQueue),l=De(u=>u.removeSyncEdgeQueue);g.useLayoutEffect(()=>{},[t]),g.useEffect(()=>{n.loading||!s||!t||i.current===t||o(t,async()=>{await r({where:{session_id:t}})})},[o,r,n.loading,i,s,t]),g.useEffect(()=>{const u=De.subscribe(p=>p.syncNodeQueue,async(p,f)=>{const y=f.map(v=>v.timestamp),m=p.filter(v=>!y.includes(v.timestamp));m.length&&c(m.map(v=>v.timestamp))}),d=De.subscribe(p=>p.syncEdgeQueue,async(p,f)=>{const y=f.map(v=>v.timestamp),m=p.filter(v=>!y.includes(v.timestamp));m.length&&(l(m.map(v=>v.timestamp)),a())});return()=>{u(),d()}},[r,l,c,a])},Vke=()=>{const[e,t]=g.useState(!0),n=Bke(),r=Ua(u=>u.selectedModel),a=g.useRef(r),o=Ua(u=>u.setInitProgressCallback),{updateOrCreateNode:i,updateNodeChanges:s,updateEdgeChanges:c,updateEdgeConnection:l}=n;return zke(n),a.current=r,g.useEffect(()=>{const u=o==null?void 0:o(d=>{if(!a.current)return;const p=`${a.current}`;i(f=>{const y=f==null?void 0:f.find(m=>{var v;return(v=m.data)!=null&&v.entity&&typeof m.data.entity=="object"&&"name"in m.data.entity?m.data.entity.name===p:!1});if(y)return y.data.label=d.text,y.data.status=Qe.Loading,d.progress===100&&(y.data.label="",y.data.status=Qe.Loaded),y})});return()=>{u==null||u()}},[o,i]),g.useMemo(()=>({updateNodeChanges:s,updateEdgeChanges:c,initializing:e,setInitializing:t,updateEdgeConnection:l}),[s,c,e,t,l])},Wke=()=>{const e=Vo(l=>l.theme),t=De(l=>l.nodes),n=De(l=>l.edges),{updateNodeChanges:r,updateEdgeChanges:a,updateEdgeConnection:o}=Vke(),i=g.useCallback(l=>{r(l)},[r]),s=g.useCallback(l=>{a(l)},[a]),c=g.useCallback(l=>{o(l)},[o]);return h.jsxs(Oce,{nodes:t,edges:n,nodeTypes:UH,onNodesChange:i,onEdgesChange:s,onConnect:c,panOnScroll:!0,panOnScrollMode:ti.Free,colorMode:e,fitView:!0,children:[h.jsx(Rce,{variant:bo.Dots,gap:24,size:1}),h.jsx(Vce,{}),h.jsx(ele,{}),e2e?h.jsx(YH,{}):void 0]})},Uke=g.memo(Wke);function qke(){return h.jsx(Uke,{})}const Hke=g.lazy(()=>At(()=>import("./DocumentViewer-C77eLLXN.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([63,1,2,15]))),Kke=()=>{const{documentId:e}=lP();return h.jsx(g.Suspense,{fallback:h.jsx(Al,{flickeringGrid:!0,className:"w-full h-full"}),children:h.jsx(Hke,{name:e||""})})};function _g(){const e=uP();return Pl(e),h.jsx(t2e,{})}const Zke=sX(h.jsxs(Zo,{errorElement:h.jsx(_g,{}),children:[h.jsxs(Zo,{element:h.jsx(X2,{requiredSession:!0}),children:[h.jsx(Zo,{path:Pf.whiteboard,Component:qke,errorElement:h.jsx(_g,{})}),h.jsx(Zo,{path:Pf.application,errorElement:h.jsx(_g,{}),Component:Ime}),h.jsx(Zo,{path:"*",element:h.jsx(aX,{to:yn("whiteboard")})})]}),h.jsx(Zo,{element:h.jsx(X2,{}),children:h.jsx(Zo,{path:Pf.document,errorElement:h.jsx(_g,{}),Component:Kke})})]})),Xke=(e,t)=>{switch(cJ){case"browser":return bP(e,t);case"hash":return kX(e);default:return bP(e,t)}},Qke=Xke(Zke,{basename:"/NoLLMChat/"});gK("[BASE_URL]","/NoLLMChat/");let eK;eK=g.memo(()=>{const e=!window.location.pathname.includes("/NoLLMChat/");return g.useLayoutEffect(()=>{e&&(window.location.href="/NoLLMChat/".replace("//","/"))},[e]),e?h.jsx(Al,{className:"w-screen h-screen",simple:!0}):h.jsx(VX,{router:Qke})},()=>!0),MK=Object.freeze(Object.defineProperty({__proto__:null,default:eK},Symbol.toStringTag,{value:"Module"}))});export{Pt as $,NN as A,kg as B,MN as C,PN as D,Il as E,Ag as F,Rl as G,Ni as H,$p as I,Fp as J,Tg as K,kN as L,AN as M,Ss as N,TN as O,IN as P,RN as Q,DN as R,Ig as S,LN as T,$N as U,Es as V,FN as W,BN as X,zN as Y,VN as Z,Rg as _,a2e as __tla,Dg as a,Lg as a$,Dl as a0,Ll as a1,Mi as a2,Pi as a3,Bp as a4,xK as a5,$l as a6,Os as a7,Cs as a8,_K as a9,jK as aA,$g as aB,WN as aC,UN as aD,qN as aE,SK as aF,Fg as aG,HN as aH,Bg as aI,KN as aJ,Za as aK,EK as aL,Uo as aM,Fl as aN,Bl as aO,zg as aP,Vg as aQ,Wg as aR,Ug as aS,qg as aT,Hg as aU,Kg as aV,Zg as aW,ZN as aX,XN as aY,zp as aZ,Xg as a_,QN as aa,Qg as ab,GN as ac,JN as ad,OK as ae,YN as af,Gg as ag,CK as ah,eM as ai,tM as aj,nM as ak,Jg as al,rM as am,NK as an,Yg as ao,ev as ap,tv as aq,aM as ar,nv as as,rv as at,av as au,ov as av,iv as aw,sv as ax,oM as ay,iM as az,zl as b,cv as b0,lv as b1,uv as b2,dv as b3,pv as b4,fv as b5,hv as b6,Vp as b7,mn as b8,mv as b9,sM as bA,cM as bB,Ns as bC,qo as bD,MK as bE,Wp as ba,yv as bb,gv as bc,Vl as bd,Wl as be,PK as bf,lM as bg,nt as bh,Ms as bi,vv as bj,bv as bk,Vn as bl,De as bm,An as bn,Tn as bo,wv as bp,xv as bq,uM as br,dM as bs,_v as bt,jv as bu,ut as bv,pM as bw,Sv as bx,Ev as by,fM as bz,hM as c,Ar as d,Ov as e,mM as f,yM as g,Ps as h,Tr as i,Cv as j,Nv as k,gM as l,ha as m,vM as n,Mv as o,Pv as p,bM as q,wM as r,xM as s,kv as t,In as u,Ul as v,Av as w,ql as x,ks as y,_M as z};
