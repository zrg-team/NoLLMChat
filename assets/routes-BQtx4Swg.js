const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ChatApplication-DB_kECka.js","assets/index-Dm1R2z7R.js","assets/index-BHmW4Jet.css","assets/index-uPlhTHZf.js","assets/toNumber-BU9jO53P.js","assets/popover-Cui8Ka4E.js","assets/index-BohVFg5g.js","assets/chunk-GdREbNHQ.js","assets/LLMIcon-8SFnyBlJ.js","assets/dot-C-EbcjRb.js","assets/createLucideIcon-B-o_1Xz_.js","assets/EditorApplication-BLTFxFzD.js","assets/VSLiteApplication-BZ_LF9KD.js","assets/file-tree-JWOQ6MD3.js","assets/Home-Bwbq7TXb.js","assets/index-uEu2-lE9.js","assets/DocumentViewer-BF0A7NqO.js","assets/index-Ck543mmG.js"])))=>i.map(i=>d[i]);
var HN=Object.defineProperty;var GN=(Tt,cn,ia)=>cn in Tt?HN(Tt,cn,{enumerable:!0,configurable:!0,writable:!0,value:ia}):Tt[cn]=ia;var qe=(Tt,cn,ia)=>GN(Tt,typeof cn!="symbol"?cn+"":cn,ia);import{r as m,a as W0,u as po,R as WN,c as qa,b as Ja,j as g,P as Ge,d as ve,e as xn,f as ot,g as se,h as xc,S as fr,i as Jr,D as Lh,k as VN,l as Mh,L as Ce,m as V0,n as qN,o as pr,p as JN,q as Un,s as q0,t as mo,v as J0,w as tt,x as Ec,y as K0,z as Y0,A as KN,B as YN,T as X0,C as Kr,E as Q0,F as Ka,G as Dh,H as go,I as XN,J as QN,K as mr,M as gr,W as eC,N as yo,O as yr,Q as ew,U as tw,V as tC,_ as vo,X as bo,Y as nC,Z as rC,__tla as aC}from"./index-Dm1R2z7R.js";let vr,wo,Bn,pt,br,Sc,Oc,wr,_o,Fh,xo,nw,Uh,rw,je,Bh,Ya,on,rt,kc,Lt,zh,zn,Zh,aw,Hh,Eo,Gh,Wh,Yr,iw,Vh,Tc,ow,Xa,Xr,sw,Rc,cw,K,Ic,Nc,So,lw,qh,uw,dw,Oo,Jh,Kh,Yh,Xh,Qh,ef,tf,nf,rf,af,of,Cc,Mt,sf,jc,cf,lf,Ac,Qr,_r,Qa,Pc,$c,Lc,Mc,uf,Dc,Dt,df,hf,ff,Fc,ko,To,Uc,Bc,Ft,pf,mf,ei,zc,Zc,Hc,Ro,Io,Gc,hw,xr,Wc,gf,yf,vf,bf,wf,_f,xf,Ef,Sf,ti,ea,ta,Vc,Of,kf,Tf,qc,Rf,fw,Jc,Kc,Yc,If,Xc,Qc,el,tl,nl,rl,Nf,Cf,pw,jf,Af,Pf,$f,Lf,Mf,Df,Ff,Uf,Bf,No,Co,na,ra,al,mw,zf,sn,jo,Er,Xe,Zf,Hf,Ao,Po,ni,Gf,Wf,Vf,il,ol,sl,cl,ll,ul,dl,hl,qf,Jf,Kf,gw,fl,pl,ml,gl,yl,$o,Yf,vl,bl,wl,_l,ri,xl,ai,aa,En,Sn,El,Sl,Xf,yw,Sr,Ol,iC=Promise.all([(()=>{try{return aC}catch{}})()]).then(async()=>{let Tt,cn;zf=(t=>(t.Local="local",t.Remote="remote",t))(zf||{}),sn=(t=>(t.Voy="voy",t.Memory="memory",t))(sn||{}),zn=(t=>(t.DataNode="DataNode",t.DatabaseNode="DatabaseNode",t.IndexedDB="IndexedDB",t))(zn||{}),Tt={};function ia(){if(cn)return Tt;cn=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.parse=o,Tt.serialize=l;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,i=(()=>{const h=function(){};return h.prototype=Object.create(null),h})();function o(h,f){const p=new i,y=h.length;if(y<2)return p;const v=(f==null?void 0:f.decode)||u;let x=0;do{const O=h.indexOf("=",x);if(O===-1)break;const I=h.indexOf(";",x),A=I===-1?y:I;if(O>A){x=h.lastIndexOf(";",O-1)+1;continue}const _=s(h,x,O),U=c(h,O,_),Z=h.slice(_,U);if(p[Z]===void 0){let F=s(h,O+1,A),G=c(h,A,F);const re=v(h.slice(F,G));p[Z]=re}x=A+1}while(x<y);return p}function s(h,f,p){do{const y=h.charCodeAt(f);if(y!==32&&y!==9)return f}while(++f<p);return p}function c(h,f,p){for(;f>p;){const y=h.charCodeAt(--f);if(y!==32&&y!==9)return f+1}return p}function l(h,f,p){const y=(p==null?void 0:p.encode)||encodeURIComponent;if(!t.test(h))throw new TypeError(`argument name is invalid: ${h}`);const v=y(f);if(!e.test(v))throw new TypeError(`argument val is invalid: ${f}`);let x=h+"="+v;if(!p)return x;if(p.maxAge!==void 0){if(!Number.isInteger(p.maxAge))throw new TypeError(`option maxAge is invalid: ${p.maxAge}`);x+="; Max-Age="+p.maxAge}if(p.domain){if(!n.test(p.domain))throw new TypeError(`option domain is invalid: ${p.domain}`);x+="; Domain="+p.domain}if(p.path){if(!r.test(p.path))throw new TypeError(`option path is invalid: ${p.path}`);x+="; Path="+p.path}if(p.expires){if(!d(p.expires)||!Number.isFinite(p.expires.valueOf()))throw new TypeError(`option expires is invalid: ${p.expires}`);x+="; Expires="+p.expires.toUTCString()}if(p.httpOnly&&(x+="; HttpOnly"),p.secure&&(x+="; Secure"),p.partitioned&&(x+="; Partitioned"),p.priority)switch(typeof p.priority=="string"?p.priority.toLowerCase():void 0){case"low":x+="; Priority=Low";break;case"medium":x+="; Priority=Medium";break;case"high":x+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${p.priority}`)}if(p.sameSite)switch(typeof p.sameSite=="string"?p.sameSite.toLowerCase():p.sameSite){case!0:case"strict":x+="; SameSite=Strict";break;case"lax":x+="; SameSite=Lax";break;case"none":x+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${p.sameSite}`)}return x}function u(h){if(h.indexOf("%")===-1)return h;try{return decodeURIComponent(h)}catch{return h}}function d(h){return a.call(h)==="[object Date]"}return Tt}ia();var Qf="popstate";function vw(t={}){function e(r,a){let{pathname:i,search:o,hash:s}=r.location;return oa("",{pathname:i,search:o,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:On(a)}return tp(e,n,null,t)}function bw(t={}){function e(a,i){let{pathname:o="/",search:s="",hash:c=""}=kn(a.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),oa("",{pathname:o,search:s,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(a,i){let o=a.document.querySelector("base"),s="";if(o&&o.getAttribute("href")){let c=a.location.href,l=c.indexOf("#");s=l===-1?c:c.slice(0,l)}return s+"#"+(typeof i=="string"?i:On(i))}function r(a,i){Qe(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return tp(e,n,r,t)}function Ee(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qe(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ww(){return Math.random().toString(36).substring(2,10)}function ep(t,e){return{usr:t.state,key:t.key,idx:e}}function oa(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?kn(e):e,state:n,key:e&&e.key||r||ww()}}function On({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function kn(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function tp(t,e,n,r={}){let{window:a=document.defaultView,v5Compat:i=!1}=r,o=a.history,s="POP",c=null,l=u();l==null&&(l=0,o.replaceState({...o.state,idx:l},""));function u(){return(o.state||{idx:null}).idx}function d(){s="POP";let v=u(),x=v==null?null:v-l;l=v,c&&c({action:s,location:y.location,delta:x})}function h(v,x){s="PUSH";let O=oa(y.location,v,x);n&&n(O,v),l=u()+1;let I=ep(O,l),A=y.createHref(O);try{o.pushState(I,"",A)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;a.location.assign(A)}i&&c&&c({action:s,location:y.location,delta:1})}function f(v,x){s="REPLACE";let O=oa(y.location,v,x);n&&n(O,v),l=u();let I=ep(O,l),A=y.createHref(O);o.replaceState(I,"",A),i&&c&&c({action:s,location:y.location,delta:0})}function p(v){let x=a.location.origin!=="null"?a.location.origin:a.location.href,O=typeof v=="string"?v:On(v);return O=O.replace(/ $/,"%20"),Ee(x,`No window.location.(origin|href) available to create URL for href: ${O}`),new URL(O,x)}let y={get action(){return s},get location(){return t(a,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(Qf,d),c=v,()=>{a.removeEventListener(Qf,d),c=null}},createHref(v){return e(a,v)},createURL:p,encodeLocation(v){let x=p(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:f,go(v){return o.go(v)}};return y}var _w=new Set(["lazy","caseSensitive","path","id","index","children"]);function xw(t){return t.index===!0}function Lo(t,e,n=[],r={}){return t.map((a,i)=>{let o=[...n,String(i)],s=typeof a.id=="string"?a.id:o.join("-");if(Ee(a.index!==!0||!a.children,"Cannot specify children on an index route"),Ee(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),xw(a)){let c={...a,...e(a),id:s};return r[s]=c,c}else{let c={...a,...e(a),id:s,children:void 0};return r[s]=c,a.children&&(c.children=Lo(a.children,e,o,r)),c}})}function Zn(t,e,n="/"){return Mo(t,e,n,!1)}function Mo(t,e,n,r){let a=typeof e=="string"?kn(e):e,i=Ut(a.pathname||"/",n);if(i==null)return null;let o=np(t);Sw(o);let s=null;for(let c=0;s==null&&c<o.length;++c){let l=$w(i);s=Aw(o[c],l,r)}return s}function Ew(t,e){let{route:n,pathname:r,params:a}=t;return{id:n.id,pathname:r,params:a,data:e[n.id],handle:n.handle}}function np(t,e=[],n=[],r=""){let a=(i,o,s)=>{let c={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Ee(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let l=ln([r,c.relativePath]),u=n.concat(c);i.children&&i.children.length>0&&(Ee(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),np(i.children,e,u,l)),!(i.path==null&&!i.index)&&e.push({path:l,score:Cw(l,i.index),routesMeta:u})};return t.forEach((i,o)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))a(i,o);else for(let c of rp(i.path))a(i,o,c)}),e}function rp(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let o=rp(r.join("/")),s=[];return s.push(...o.map(c=>c===""?i:[i,c].join("/"))),a&&s.push(...o),s.map(c=>t.startsWith("/")&&c===""?"/":c)}function Sw(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:jw(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var Ow=/^:[\w-]+$/,kw=3,Tw=2,Rw=1,Iw=10,Nw=-2,ap=t=>t==="*";function Cw(t,e){let n=t.split("/"),r=n.length;return n.some(ap)&&(r+=Nw),e&&(r+=Tw),n.filter(a=>!ap(a)).reduce((a,i)=>a+(Ow.test(i)?kw:i===""?Rw:Iw),r)}function jw(t,e){return t.length===e.length&&t.slice(0,-1).every((n,r)=>n===e[r])?t[t.length-1]-e[e.length-1]:0}function Aw(t,e,n=!1){let{routesMeta:r}=t,a={},i="/",o=[];for(let s=0;s<r.length;++s){let c=r[s],l=s===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=Do({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),h=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=Do({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(a,d.params),o.push({params:a,pathname:ln([i,d.pathname]),pathnameBase:Dw(ln([i,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(i=ln([i,d.pathnameBase]))}return o}function Do(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Pw(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((c,{paramName:l,isOptional:u},d)=>{if(l==="*"){let f=s[d]||"";o=i.slice(0,i.length-f.length).replace(/(.)\/+$/,"$1")}const h=s[d];return u&&!h?c[l]=void 0:c[l]=(h||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function Pw(t,e=!1,n=!0){Qe(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,s)=>(r.push({paramName:o,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function $w(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qe(!1,`The URL path "${t}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ut(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Lw(t,e="/"){let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?kn(t):t;return{pathname:n?n.startsWith("/")?n:Mw(n,e):e,search:Fw(r),hash:Uw(a)}}function Mw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function kl(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ip(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Fo(t){let e=ip(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function Uo(t,e,n,r=!1){let a;typeof t=="string"?a=kn(t):(a={...t},Ee(!a.pathname||!a.pathname.includes("?"),kl("?","pathname","search",a)),Ee(!a.pathname||!a.pathname.includes("#"),kl("#","pathname","hash",a)),Ee(!a.search||!a.search.includes("#"),kl("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,s;if(o==null)s=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;a.pathname=h.join("/")}s=d>=0?e[d]:"/"}let c=Lw(a,s),l=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}var ln=t=>t.join("/").replace(/\/\/+/g,"/"),Dw=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Fw=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Uw=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,Bo=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function zo(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var op=["POST","PUT","PATCH","DELETE"],Bw=new Set(op),zw=["GET",...op],Zw=new Set(zw),Hw=new Set([301,302,303,307,308]),Gw=new Set([307,308]),Tl={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Ww={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ii={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Rl=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vw=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),sp="remix-router-transitions",cp=Symbol("ResetLoaderData");function lp(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u";Ee(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=t.mapRouteProperties||Vw,a={},i=Lo(t.routes,r,void 0,a),o,s=t.basename||"/",c=t.dataStrategy||Xw,l=t.patchRoutesOnNavigation,u={...t.future},d=null,h=new Set,f=null,p=null,y=null,v=t.hydrationData!=null,x=Zn(i,t.history.location,s),O=null;if(x==null&&!l){let N=Rt(404,{pathname:t.history.location.pathname}),{matches:D,route:B}=_p(i);x=D,O={[B.id]:N}}x&&!t.hydrationData&&Gr(x,i,t.history.location.pathname).active&&(x=null);let I;if(x)if(x.some(N=>N.route.lazy))I=!1;else if(!x.some(N=>N.route.loader))I=!0;else{let N=t.hydrationData?t.hydrationData.loaderData:null,D=t.hydrationData?t.hydrationData.errors:null;if(D){let B=x.findIndex(V=>D[V.route.id]!==void 0);I=x.slice(0,B+1).every(V=>!Nl(V.route,N,D))}else I=x.every(B=>!Nl(B.route,N,D))}else{I=!1,x=[];let N=Gr(null,i,t.history.location.pathname);N.active&&N.matches&&(x=N.matches)}let A,_={historyAction:t.history.action,location:t.history.location,matches:x,initialized:I,navigation:Tl,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||O,fetchers:new Map,blockers:new Map},U="POP",Z=!1,F,G=!1,re=new Map,he=null,E=!1,R=!1,S=new Set,b=new Map,z=0,C=-1,$=new Map,P=new Set,Y=new Map,ae=new Map,le=new Set,we=new Map,xe,Be=null;function gt(){if(d=t.history.listen(({action:N,location:D,delta:B})=>{if(xe){xe(),xe=void 0;return}Qe(we.size===0||B!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let V=Ga({currentLocation:_.location,nextLocation:D,historyAction:N});if(V&&B!=null){let ie=new Promise(de=>{xe=de});t.history.go(B*-1),Ha(V,{state:"blocked",location:D,proceed(){Ha(V,{state:"proceeding",proceed:void 0,reset:void 0,location:D}),ie.then(()=>t.history.go(B))},reset(){let de=new Map(_.blockers);de.set(V,ii),Pe({blockers:de})}});return}return ft(N,D)}),n){l_(e,re);let N=()=>u_(e,re);e.addEventListener("pagehide",N),he=()=>e.removeEventListener("pagehide",N)}return _.initialized||ft("POP",_.location,{initialHydration:!0}),A}function Dn(){d&&d(),he&&he(),h.clear(),F&&F.abort(),_.fetchers.forEach((N,D)=>Za(D)),_.blockers.forEach((N,D)=>bc(D))}function Fn(N){return h.add(N),()=>h.delete(N)}function Pe(N,D={}){_={..._,...N};let B=[],V=[];_.fetchers.forEach((ie,de)=>{ie.state==="idle"&&(le.has(de)?B.push(de):V.push(de))}),[...h].forEach(ie=>ie(_,{deletedFetchers:B,viewTransitionOpts:D.viewTransitionOpts,flushSync:D.flushSync===!0})),B.forEach(ie=>Za(ie)),V.forEach(ie=>_.fetchers.delete(ie))}function yt(N,D,{flushSync:B}={}){var ee,ye;let V=_.actionData!=null&&_.navigation.formMethod!=null&&Bt(_.navigation.formMethod)&&_.navigation.state==="loading"&&((ee=N.state)==null?void 0:ee._isRedirect)!==!0,ie;D.actionData?Object.keys(D.actionData).length>0?ie=D.actionData:ie=null:V?ie=_.actionData:ie=null;let de=D.loaderData?bp(_.loaderData,D.loaderData,D.matches||[],D.errors):_.loaderData,ge=_.blockers;ge.size>0&&(ge=new Map(ge),ge.forEach((Se,Fe)=>ge.set(Fe,ii)));let oe=Z===!0||_.navigation.formMethod!=null&&Bt(_.navigation.formMethod)&&((ye=N.state)==null?void 0:ye._isRedirect)!==!0;o&&(i=o,o=void 0),E||U==="POP"||(U==="PUSH"?t.history.push(N,N.state):U==="REPLACE"&&t.history.replace(N,N.state));let ce;if(U==="POP"){let Se=re.get(_.location.pathname);Se&&Se.has(N.pathname)?ce={currentLocation:_.location,nextLocation:N}:re.has(N.pathname)&&(ce={currentLocation:N,nextLocation:_.location})}else if(G){let Se=re.get(_.location.pathname);Se?Se.add(N.pathname):(Se=new Set([N.pathname]),re.set(_.location.pathname,Se)),ce={currentLocation:_.location,nextLocation:N}}Pe({...D,actionData:ie,loaderData:de,historyAction:U,location:N,initialized:!0,navigation:Tl,revalidation:"idle",restoreScrollPosition:wc(N,D.matches||_.matches),preventScrollReset:oe,blockers:ge},{viewTransitionOpts:ce,flushSync:B===!0}),U="POP",Z=!1,G=!1,E=!1,R=!1,Be==null||Be.resolve(),Be=null}async function Hr(N,D){if(typeof N=="number"){t.history.go(N);return}let B=Il(_.location,_.matches,s,N,D==null?void 0:D.fromRouteId,D==null?void 0:D.relative),{path:V,submission:ie,error:de}=up(!1,B,D),ge=_.location,oe=oa(_.location,V,D&&D.state);oe={...oe,...t.history.encodeLocation(oe)};let ce=D&&D.replace!=null?D.replace:void 0,ee="PUSH";ce===!0?ee="REPLACE":ce===!1||ie!=null&&Bt(ie.formMethod)&&ie.formAction===_.location.pathname+_.location.search&&(ee="REPLACE");let ye=D&&"preventScrollReset"in D?D.preventScrollReset===!0:void 0,Se=(D&&D.flushSync)===!0,Fe=Ga({currentLocation:ge,nextLocation:oe,historyAction:ee});if(Fe){Ha(Fe,{state:"blocked",location:oe,proceed(){Ha(Fe,{state:"proceeding",proceed:void 0,reset:void 0,location:oe}),Hr(N,D)},reset(){let ze=new Map(_.blockers);ze.set(Fe,ii),Pe({blockers:ze})}});return}await ft(ee,oe,{submission:ie,pendingError:de,preventScrollReset:ye,replace:D&&D.replace,enableViewTransition:D&&D.viewTransition,flushSync:Se})}function Fa(){Be||(Be=d_()),za(),Pe({revalidation:"loading"});let N=Be.promise;return _.navigation.state==="submitting"?N:_.navigation.state==="idle"?(ft(_.historyAction,_.location,{startUninterruptedRevalidation:!0}),N):(ft(U||_.historyAction,_.navigation.location,{overrideNavigation:_.navigation,enableViewTransition:G===!0}),N)}async function ft(N,D,B){F&&F.abort(),F=null,U=N,E=(B&&B.startUninterruptedRevalidation)===!0,Ch(_.location,_.matches),Z=(B&&B.preventScrollReset)===!0,G=(B&&B.enableViewTransition)===!0;let V=o||i,ie=B&&B.overrideNavigation,de=Zn(V,D,s),ge=(B&&B.flushSync)===!0,oe=Gr(de,V,D.pathname);if(oe.active&&oe.matches&&(de=oe.matches),!de){let{error:Ne,notFoundMatches:vt,route:Ve}=Wa(D.pathname);yt(D,{matches:vt,loaderData:{},errors:{[Ve.id]:Ne}},{flushSync:ge});return}if(_.initialized&&!R&&a_(_.location,D)&&!(B&&B.submission&&Bt(B.submission.formMethod))){yt(D,{matches:de},{flushSync:ge});return}F=new AbortController;let ce=sa(t.history,D,F.signal,B&&B.submission),ee;if(B&&B.pendingError)ee=[Or(de).route.id,{type:"error",error:B.pendingError}];else if(B&&B.submission&&Bt(B.submission.formMethod)){let Ne=await ro(ce,D,B.submission,de,oe.active,{replace:B.replace,flushSync:ge});if(Ne.shortCircuited)return;if(Ne.pendingActionResult){let[vt,Ve]=Ne.pendingActionResult;if(wt(Ve)&&zo(Ve.error)&&Ve.error.status===404){F=null,yt(D,{matches:Ne.matches,loaderData:{},errors:{[vt]:Ve.error}});return}}de=Ne.matches||de,ee=Ne.pendingActionResult,ie=Al(D,B.submission),ge=!1,oe.active=!1,ce=sa(t.history,ce.url,ce.signal)}let{shortCircuited:ye,matches:Se,loaderData:Fe,errors:ze}=await At(ce,D,de,oe.active,ie,B&&B.submission,B&&B.fetcherSubmission,B&&B.replace,B&&B.initialHydration===!0,ge,ee);ye||(F=null,yt(D,{matches:Se||de,...wp(ee),loaderData:Fe,errors:ze}))}async function ro(N,D,B,V,ie,de={}){za();let ge=s_(D,B);if(Pe({navigation:ge},{flushSync:de.flushSync===!0}),ie){let ee=await Va(V,D.pathname,N.signal);if(ee.type==="aborted")return{shortCircuited:!0};if(ee.type==="error"){let ye=Or(ee.partialMatches).route.id;return{matches:ee.partialMatches,pendingActionResult:[ye,{type:"error",error:ee.error}]}}else if(ee.matches)V=ee.matches;else{let{notFoundMatches:ye,error:Se,route:Fe}=Wa(D.pathname);return{matches:ye,pendingActionResult:[Fe.id,{type:"error",error:Se}]}}}let oe,ce=oi(V,D);if(!ce.route.action&&!ce.route.lazy)oe={type:"error",error:Rt(405,{method:N.method,pathname:D.pathname,routeId:ce.route.id})};else if(oe=(await ur("action",_,N,[ce],V,null))[ce.route.id],N.signal.aborted)return{shortCircuited:!0};if(kr(oe)){let ee;return de&&de.replace!=null?ee=de.replace:ee=gp(oe.response.headers.get("Location"),new URL(N.url),s)===_.location.pathname+_.location.search,await Qt(N,oe,!0,{submission:B,replace:ee}),{shortCircuited:!0}}if(wt(oe)){let ee=Or(V,ce.route.id);return(de&&de.replace)!==!0&&(U="PUSH"),{matches:V,pendingActionResult:[ee.route.id,oe]}}return{matches:V,pendingActionResult:[ce.route.id,oe]}}async function At(N,D,B,V,ie,de,ge,oe,ce,ee,ye){let Se=ie||Al(D,de),Fe=de||ge||Op(Se),ze=!E&&!ce;if(V){if(ze){let bt=Ua(ye);Pe({navigation:Se,...bt!==void 0?{actionData:bt}:{}},{flushSync:ee})}let ke=await Va(B,D.pathname,N.signal);if(ke.type==="aborted")return{shortCircuited:!0};if(ke.type==="error"){let bt=Or(ke.partialMatches).route.id;return{matches:ke.partialMatches,loaderData:{},errors:{[bt]:ke.error}}}else if(ke.matches)B=ke.matches;else{let{error:bt,notFoundMatches:_n,route:Ue}=Wa(D.pathname);return{matches:_n,loaderData:{},errors:{[Ue.id]:bt}}}}let Ne=o||i,[vt,Ve]=hp(t.history,_,B,Fe,D,ce===!0,R,S,le,Y,P,Ne,s,ye);if(C=++z,vt.length===0&&Ve.length===0){let ke=co();return yt(D,{matches:B,loaderData:{},errors:ye&&wt(ye[1])?{[ye[0]]:ye[1].error}:null,...wp(ye),...ke?{fetchers:new Map(_.fetchers)}:{}},{flushSync:ee}),{shortCircuited:!0}}if(ze){let ke={};if(!V){ke.navigation=Se;let bt=Ua(ye);bt!==void 0&&(ke.actionData=bt)}Ve.length>0&&(ke.fetchers=Ba(Ve)),Pe(ke,{flushSync:ee})}Ve.forEach(ke=>{tn(ke.key),ke.controller&&b.set(ke.key,ke.controller)});let Wr=()=>Ve.forEach(ke=>tn(ke.key));F&&F.signal.addEventListener("abort",Wr);let{loaderResults:rn,fetcherResults:dr}=await io(_,B,vt,Ve,N);if(N.signal.aborted)return{shortCircuited:!0};F&&F.signal.removeEventListener("abort",Wr),Ve.forEach(ke=>b.delete(ke.key));let bn=Zo(rn);if(bn)return await Qt(N,bn.result,!0,{replace:oe}),{shortCircuited:!0};if(bn=Zo(dr),bn)return P.add(bn.key),await Qt(N,bn.result,!0,{replace:oe}),{shortCircuited:!0};let{loaderData:ho,errors:an}=vp(_,B,rn,ye,Ve,dr);ce&&_.errors&&(an={..._.errors,...an});let Vr=co(),wn=lo(C),qr=Vr||wn||Ve.length>0;return{matches:B,loaderData:ho,errors:an,...qr?{fetchers:new Map(_.fetchers)}:{}}}function Ua(N){if(N&&!wt(N[1]))return{[N[0]]:N[1].data};if(_.actionData)return Object.keys(_.actionData).length===0?null:_.actionData}function Ba(N){return N.forEach(D=>{let B=_.fetchers.get(D.key),V=si(void 0,B?B.data:void 0);_.fetchers.set(D.key,V)}),new Map(_.fetchers)}async function lr(N,D,B,V){tn(N);let ie=(V&&V.flushSync)===!0,de=o||i,ge=Il(_.location,_.matches,s,B,D,V==null?void 0:V.relative),oe=Zn(de,ge,s),ce=Gr(oe,de,ge);if(ce.active&&ce.matches&&(oe=ce.matches),!oe){Pt(N,D,Rt(404,{pathname:ge}),{flushSync:ie});return}let{path:ee,submission:ye,error:Se}=up(!0,ge,V);if(Se){Pt(N,D,Se,{flushSync:ie});return}let Fe=oi(oe,ee),ze=(V&&V.preventScrollReset)===!0;if(ye&&Bt(ye.formMethod)){await vn(N,D,ee,Fe,oe,ce.active,ie,ze,ye);return}Y.set(N,{routeId:D,path:ee}),await ao(N,D,ee,Fe,oe,ce.active,ie,ze,ye)}async function vn(N,D,B,V,ie,de,ge,oe,ce){za(),Y.delete(N);function ee(Ue){if(!Ue.route.action&&!Ue.route.lazy){let hr=Rt(405,{method:ce.formMethod,pathname:B,routeId:D});return Pt(N,D,hr,{flushSync:ge}),!0}return!1}if(!de&&ee(V))return;let ye=_.fetchers.get(N);en(N,c_(ce,ye),{flushSync:ge});let Se=new AbortController,Fe=sa(t.history,B,Se.signal,ce);if(de){let Ue=await Va(ie,B,Fe.signal);if(Ue.type==="aborted")return;if(Ue.type==="error"){Pt(N,D,Ue.error,{flushSync:ge});return}else if(Ue.matches){if(ie=Ue.matches,V=oi(ie,B),ee(V))return}else{Pt(N,D,Rt(404,{pathname:B}),{flushSync:ge});return}}b.set(N,Se);let ze=z,Ne=(await ur("action",_,Fe,[V],ie,N))[V.route.id];if(Fe.signal.aborted){b.get(N)===Se&&b.delete(N);return}if(le.has(N)){if(kr(Ne)||wt(Ne)){en(N,Hn(void 0));return}}else{if(kr(Ne))if(b.delete(N),C>ze){en(N,Hn(void 0));return}else return P.add(N),en(N,si(ce)),Qt(Fe,Ne,!1,{fetcherSubmission:ce,preventScrollReset:oe});if(wt(Ne)){Pt(N,D,Ne.error);return}}let vt=_.navigation.location||_.location,Ve=sa(t.history,vt,Se.signal),Wr=o||i,rn=_.navigation.state!=="idle"?Zn(Wr,_.navigation.location,s):_.matches;Ee(rn,"Didn't find any matches after fetcher action");let dr=++z;$.set(N,dr);let bn=si(ce,Ne.data);_.fetchers.set(N,bn);let[ho,an]=hp(t.history,_,rn,ce,vt,!1,R,S,le,Y,P,Wr,s,[V.route.id,Ne]);an.filter(Ue=>Ue.key!==N).forEach(Ue=>{let hr=Ue.key,_c=_.fetchers.get(hr),fo=si(void 0,_c?_c.data:void 0);_.fetchers.set(hr,fo),tn(hr),Ue.controller&&b.set(hr,Ue.controller)}),Pe({fetchers:new Map(_.fetchers)});let Vr=()=>an.forEach(Ue=>tn(Ue.key));Se.signal.addEventListener("abort",Vr);let{loaderResults:wn,fetcherResults:qr}=await io(_,rn,ho,an,Ve);if(Se.signal.aborted)return;Se.signal.removeEventListener("abort",Vr),$.delete(N),b.delete(N),an.forEach(Ue=>b.delete(Ue.key));let ke=Zo(wn);if(ke)return Qt(Ve,ke.result,!1,{preventScrollReset:oe});if(ke=Zo(qr),ke)return P.add(ke.key),Qt(Ve,ke.result,!1,{preventScrollReset:oe});let{loaderData:bt,errors:_n}=vp(_,rn,wn,void 0,an,qr);if(_.fetchers.has(N)){let Ue=Hn(Ne.data);_.fetchers.set(N,Ue)}lo(dr),_.navigation.state==="loading"&&dr>C?(Ee(U,"Expected pending action"),F&&F.abort(),yt(_.navigation.location,{matches:rn,loaderData:bt,errors:_n,fetchers:new Map(_.fetchers)})):(Pe({errors:_n,loaderData:bp(_.loaderData,bt,rn,_n),fetchers:new Map(_.fetchers)}),R=!1)}async function ao(N,D,B,V,ie,de,ge,oe,ce){let ee=_.fetchers.get(N);en(N,si(ce,ee?ee.data:void 0),{flushSync:ge});let ye=new AbortController,Se=sa(t.history,B,ye.signal);if(de){let Ne=await Va(ie,B,Se.signal);if(Ne.type==="aborted")return;if(Ne.type==="error"){Pt(N,D,Ne.error,{flushSync:ge});return}else if(Ne.matches)ie=Ne.matches,V=oi(ie,B);else{Pt(N,D,Rt(404,{pathname:B}),{flushSync:ge});return}}b.set(N,ye);let Fe=z,ze=(await ur("loader",_,Se,[V],ie,N))[V.route.id];if(b.get(N)===ye&&b.delete(N),!Se.signal.aborted){if(le.has(N)){en(N,Hn(void 0));return}if(kr(ze))if(C>Fe){en(N,Hn(void 0));return}else{P.add(N),await Qt(Se,ze,!1,{preventScrollReset:oe});return}if(wt(ze)){Pt(N,D,ze.error);return}en(N,Hn(ze.data))}}async function Qt(N,D,B,{submission:V,fetcherSubmission:ie,preventScrollReset:de,replace:ge}={}){D.response.headers.has("X-Remix-Revalidate")&&(R=!0);let oe=D.response.headers.get("Location");Ee(oe,"Expected a Location header on the redirect Response"),oe=gp(oe,new URL(N.url),s);let ce=oa(_.location,oe,{_isRedirect:!0});if(n){let Ne=!1;if(D.response.headers.has("X-Remix-Reload-Document"))Ne=!0;else if(Rl.test(oe)){const vt=t.history.createURL(oe);Ne=vt.origin!==e.location.origin||Ut(vt.pathname,s)==null}if(Ne){ge?e.location.replace(oe):e.location.assign(oe);return}}F=null;let ee=ge===!0||D.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:ye,formAction:Se,formEncType:Fe}=_.navigation;!V&&!ie&&ye&&Se&&Fe&&(V=Op(_.navigation));let ze=V||ie;if(Gw.has(D.response.status)&&ze&&Bt(ze.formMethod))await ft(ee,ce,{submission:{...ze,formAction:oe},preventScrollReset:de||Z,enableViewTransition:B?G:void 0});else{let Ne=Al(ce,V);await ft(ee,ce,{overrideNavigation:Ne,fetcherSubmission:ie,preventScrollReset:de||Z,enableViewTransition:B?G:void 0})}}async function ur(N,D,B,V,ie,de){let ge,oe={};try{ge=await Qw(c,N,D,B,V,ie,de,a,r)}catch(ce){return V.forEach(ee=>{oe[ee.route.id]={type:"error",error:ce}}),oe}for(let[ce,ee]of Object.entries(ge))if(i_(ee)){let ye=ee.result;oe[ce]={type:"redirect",response:n_(ye,B,ce,ie,s)}}else oe[ce]=await t_(ee);return oe}async function io(N,D,B,V,ie){let de=ur("loader",N,ie,B,D,null),ge=Promise.all(V.map(async ee=>{if(ee.matches&&ee.match&&ee.controller){let ye=(await ur("loader",N,sa(t.history,ee.path,ee.controller.signal),[ee.match],ee.matches,ee.key))[ee.match.route.id];return{[ee.key]:ye}}else return Promise.resolve({[ee.key]:{type:"error",error:Rt(404,{pathname:ee.path})}})})),oe=await de,ce=(await ge).reduce((ee,ye)=>Object.assign(ee,ye),{});return{loaderResults:oe,fetcherResults:ce}}function za(){R=!0,Y.forEach((N,D)=>{b.has(D)&&S.add(D),tn(D)})}function en(N,D,B={}){_.fetchers.set(N,D),Pe({fetchers:new Map(_.fetchers)},{flushSync:(B&&B.flushSync)===!0})}function Pt(N,D,B,V={}){let ie=Or(_.matches,D);Za(N),Pe({errors:{[ie.route.id]:B},fetchers:new Map(_.fetchers)},{flushSync:(V&&V.flushSync)===!0})}function oo(N){return ae.set(N,(ae.get(N)||0)+1),le.has(N)&&le.delete(N),_.fetchers.get(N)||Ww}function Za(N){let D=_.fetchers.get(N);b.has(N)&&!(D&&D.state==="loading"&&$.has(N))&&tn(N),Y.delete(N),$.delete(N),P.delete(N),le.delete(N),S.delete(N),_.fetchers.delete(N)}function vc(N){let D=(ae.get(N)||0)-1;D<=0?(ae.delete(N),le.add(N)):ae.set(N,D),Pe({fetchers:new Map(_.fetchers)})}function tn(N){let D=b.get(N);D&&(D.abort(),b.delete(N))}function so(N){for(let D of N){let B=oo(D),V=Hn(B.data);_.fetchers.set(D,V)}}function co(){let N=[],D=!1;for(let B of P){let V=_.fetchers.get(B);Ee(V,`Expected fetcher: ${B}`),V.state==="loading"&&(P.delete(B),N.push(B),D=!0)}return so(N),D}function lo(N){let D=[];for(let[B,V]of $)if(V<N){let ie=_.fetchers.get(B);Ee(ie,`Expected fetcher: ${B}`),ie.state==="loading"&&(tn(B),$.delete(B),D.push(B))}return so(D),D.length>0}function uo(N,D){let B=_.blockers.get(N)||ii;return we.get(N)!==D&&we.set(N,D),B}function bc(N){_.blockers.delete(N),we.delete(N)}function Ha(N,D){let B=_.blockers.get(N)||ii;Ee(B.state==="unblocked"&&D.state==="blocked"||B.state==="blocked"&&D.state==="blocked"||B.state==="blocked"&&D.state==="proceeding"||B.state==="blocked"&&D.state==="unblocked"||B.state==="proceeding"&&D.state==="unblocked",`Invalid blocker state transition: ${B.state} -> ${D.state}`);let V=new Map(_.blockers);V.set(N,D),Pe({blockers:V})}function Ga({currentLocation:N,nextLocation:D,historyAction:B}){if(we.size===0)return;we.size>1&&Qe(!1,"A router only supports one blocker at a time");let V=Array.from(we.entries()),[ie,de]=V[V.length-1],ge=_.blockers.get(ie);if(!(ge&&ge.state==="proceeding")&&de({currentLocation:N,nextLocation:D,historyAction:B}))return ie}function Wa(N){let D=Rt(404,{pathname:N}),B=o||i,{matches:V,route:ie}=_p(B);return{notFoundMatches:V,route:ie,error:D}}function Nh(N,D,B){if(f=N,y=D,p=B||null,!v&&_.navigation===Tl){v=!0;let V=wc(_.location,_.matches);V!=null&&Pe({restoreScrollPosition:V})}return()=>{f=null,y=null,p=null}}function nn(N,D){return p&&p(N,D.map(B=>Ew(B,_.loaderData)))||N.key}function Ch(N,D){if(f&&y){let B=nn(N,D);f[B]=y()}}function wc(N,D){if(f){let B=nn(N,D),V=f[B];if(typeof V=="number")return V}return null}function Gr(N,D,B){if(l)if(N){if(Object.keys(N[0].params).length>0)return{active:!0,matches:Mo(D,B,s,!0)}}else return{active:!0,matches:Mo(D,B,s,!0)||[]};return{active:!1,matches:null}}async function Va(N,D,B){if(!l)return{type:"success",matches:N};let V=N;for(;;){let ie=o==null,de=o||i,ge=a;try{await l({path:D,matches:V,patch:(ee,ye)=>{B.aborted||pp(ee,ye,de,ge,r)}})}catch(ee){return{type:"error",error:ee,partialMatches:V}}finally{ie&&!B.aborted&&(i=[...i])}if(B.aborted)return{type:"aborted"};let oe=Zn(de,D,s);if(oe)return{type:"success",matches:oe};let ce=Mo(de,D,s,!0);if(!ce||V.length===ce.length&&V.every((ee,ye)=>ee.route.id===ce[ye].route.id))return{type:"success",matches:null};V=ce}}function jh(N){a={},o=Lo(N,r,void 0,a)}function Ah(N,D){let B=o==null;pp(N,D,o||i,a,r),B&&(i=[...i],Pe({}))}return A={get basename(){return s},get future(){return u},get state(){return _},get routes(){return i},get window(){return e},initialize:gt,subscribe:Fn,enableScrollRestoration:Nh,navigate:Hr,fetch:lr,revalidate:Fa,createHref:N=>t.history.createHref(N),encodeLocation:N=>t.history.encodeLocation(N),getFetcher:oo,deleteFetcher:vc,dispose:Dn,getBlocker:uo,deleteBlocker:bc,patchRoutes:Ah,_internalFetchControllers:b,_internalSetRoutes:jh},A}function qw(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Il(t,e,n,r,a,i){let o,s;if(a){o=[];for(let l of e)if(o.push(l),l.route.id===a){s=l;break}}else o=e,s=e[e.length-1];let c=Uo(r||".",Fo(o),Ut(t.pathname,n)||t.pathname,i==="path");if(r==null&&(c.search=t.search,c.hash=t.hash),(r==null||r===""||r===".")&&s){let l=jl(c.search);if(s.route.index&&!l)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&l){let u=new URLSearchParams(c.search),d=u.getAll("index");u.delete("index"),d.filter(f=>f).forEach(f=>u.append("index",f));let h=u.toString();c.search=h?`?${h}`:""}}return n!=="/"&&(c.pathname=c.pathname==="/"?n:ln([n,c.pathname])),On(c)}function up(t,e,n){if(!n||!qw(n))return{path:e};if(n.formMethod&&!o_(n.formMethod))return{path:e,error:Rt(405,{method:n.formMethod})};let r=()=>({path:e,error:Rt(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),i=xp(e);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Bt(a))return r();let u=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((d,[h,f])=>`${d}${h}=${f}
`,""):String(n.body);return{path:e,submission:{formMethod:a,formAction:i,formEncType:n.formEncType,formData:void 0,json:void 0,text:u}}}else if(n.formEncType==="application/json"){if(!Bt(a))return r();try{let u=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:e,submission:{formMethod:a,formAction:i,formEncType:n.formEncType,formData:void 0,json:u,text:void 0}}}catch{return r()}}}Ee(typeof FormData=="function","FormData is not available in this environment");let o,s;if(n.formData)o=Cl(n.formData),s=n.formData;else if(n.body instanceof FormData)o=Cl(n.body),s=n.body;else if(n.body instanceof URLSearchParams)o=n.body,s=yp(o);else if(n.body==null)o=new URLSearchParams,s=new FormData;else try{o=new URLSearchParams(n.body),s=yp(o)}catch{return r()}let c={formMethod:a,formAction:i,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:s,json:void 0,text:void 0};if(Bt(c.formMethod))return{path:e,submission:c};let l=kn(e);return t&&l.search&&jl(l.search)&&o.append("index",""),l.search=`?${o}`,{path:On(l),submission:c}}function dp(t,e,n=!1){let r=t.findIndex(a=>a.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function hp(t,e,n,r,a,i,o,s,c,l,u,d,h,f){let p=f?wt(f[1])?f[1].error:f[1].data:void 0,y=t.createURL(e.location),v=t.createURL(a),x=n;i&&e.errors?x=dp(n,Object.keys(e.errors)[0],!0):f&&wt(f[1])&&(x=dp(n,f[0]));let O=f?f[1].statusCode:void 0,I=O&&O>=400,A=x.filter((U,Z)=>{let{route:F}=U;if(F.lazy)return!0;if(F.loader==null)return!1;if(i)return Nl(F,e.loaderData,e.errors);if(Jw(e.loaderData,e.matches[Z],U))return!0;let G=e.matches[Z],re=U;return fp(U,{currentUrl:y,currentParams:G.params,nextUrl:v,nextParams:re.params,...r,actionResult:p,actionStatus:O,defaultShouldRevalidate:I?!1:o||y.pathname+y.search===v.pathname+v.search||y.search!==v.search||Kw(G,re)})}),_=[];return l.forEach((U,Z)=>{if(i||!n.some(E=>E.route.id===U.routeId)||c.has(Z))return;let F=Zn(d,U.path,h);if(!F){_.push({key:Z,routeId:U.routeId,path:U.path,matches:null,match:null,controller:null});return}let G=e.fetchers.get(Z),re=oi(F,U.path),he=!1;u.has(Z)?he=!1:s.has(Z)?(s.delete(Z),he=!0):G&&G.state!=="idle"&&G.data===void 0?he=o:he=fp(re,{currentUrl:y,currentParams:e.matches[e.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params,...r,actionResult:p,actionStatus:O,defaultShouldRevalidate:I?!1:o}),he&&_.push({key:Z,routeId:U.routeId,path:U.path,matches:F,match:re,controller:new AbortController})}),[A,_]}function Nl(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,a=n!=null&&n[t.id]!==void 0;return!r&&a?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!a}function Jw(t,e,n){let r=!e||n.route.id!==e.route.id,a=!t.hasOwnProperty(n.route.id);return r||a}function Kw(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function fp(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function pp(t,e,n,r,a){let i;if(t){let c=r[t];Ee(c,`No route found to patch children into: routeId = ${t}`),c.children||(c.children=[]),i=c.children}else i=n;let o=e.filter(c=>!i.some(l=>mp(c,l))),s=Lo(o,a,[t||"_","patch",String((i==null?void 0:i.length)||"0")],r);i.push(...s)}function mp(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var a;return(a=e.children)==null?void 0:a.some(i=>mp(n,i))}):!1}async function Yw(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let a=n[t.id];Ee(a,"No route found in manifest");let i={};for(let o in r){let s=a[o]!==void 0&&o!=="hasErrorBoundary";Qe(!s,`Route "${a.id}" has a static property "${o}" defined but its lazy function is also returning a value for this property. The lazy route property "${o}" will be ignored.`),!s&&!_w.has(o)&&(i[o]=r[o])}Object.assign(a,i),Object.assign(a,{...e(a),lazy:void 0})}async function Xw({matches:t}){let e=t.filter(n=>n.shouldLoad);return(await Promise.all(e.map(n=>n.resolve()))).reduce((n,r,a)=>Object.assign(n,{[e[a].route.id]:r}),{})}async function Qw(t,e,n,r,a,i,o,s,c,l){let u=i.map(f=>f.route.lazy?Yw(f.route,c,s):void 0),d=i.map((f,p)=>{let y=u[p],v=a.some(x=>x.route.id===f.route.id);return{...f,shouldLoad:v,resolve:async x=>(x&&r.method==="GET"&&(f.route.lazy||f.route.loader)&&(v=!0),v?e_(e,r,f,y,x,l):Promise.resolve({type:"data",result:void 0}))}}),h=await t({matches:d,request:r,params:i[0].params,fetcherKey:o,context:l});try{await Promise.all(u)}catch{}return h}async function e_(t,e,n,r,a,i){let o,s,c=l=>{let u,d=new Promise((p,y)=>u=y);s=()=>u(),e.signal.addEventListener("abort",s);let h=p=>typeof l!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${t}" [routeId: ${n.route.id}]`)):l({request:e,params:n.params,context:i},...p!==void 0?[p]:[]),f=(async()=>{try{return{type:"data",result:await(a?a(p=>h(p)):h())}}catch(p){return{type:"error",result:p}}})();return Promise.race([f,d])};try{let l=n.route[t];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(h=>{u=h}),r]);if(u!==void 0)throw u;o=d}else if(await r,l=n.route[t],l)o=await c(l);else if(t==="action"){let u=new URL(e.url),d=u.pathname+u.search;throw Rt(405,{method:e.method,pathname:d,routeId:n.route.id})}else return{type:"data",result:void 0};else if(l)o=await c(l);else{let u=new URL(e.url),d=u.pathname+u.search;throw Rt(404,{pathname:d})}}catch(l){return{type:"error",result:l}}finally{s&&e.signal.removeEventListener("abort",s)}return o}async function t_(t){var r,a,i,o;let{result:e,type:n}=t;if(Sp(e)){let s;try{let c=e.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?e.body==null?s=null:s=await e.json():s=await e.text()}catch(c){return{type:"error",error:c}}return n==="error"?{type:"error",error:new Bo(e.status,e.statusText,s),statusCode:e.status,headers:e.headers}:{type:"data",data:s,statusCode:e.status,headers:e.headers}}if(n==="error"){if(Ep(e)){if(e.data instanceof Error)return{type:"error",error:e.data,statusCode:(r=e.init)==null?void 0:r.status};e=new Bo(((a=e.init)==null?void 0:a.status)||500,void 0,e.data)}return{type:"error",error:e,statusCode:zo(e)?e.status:void 0}}return Ep(e)?{type:"data",data:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}:{type:"data",data:e}}function n_(t,e,n,r,a){let i=t.headers.get("Location");if(Ee(i,"Redirects returned/thrown from loaders/actions must have a Location header"),!Rl.test(i)){let o=r.slice(0,r.findIndex(s=>s.route.id===n)+1);i=Il(new URL(e.url),o,a,i),t.headers.set("Location",i)}return t}function gp(t,e,n){if(Rl.test(t)){let r=t,a=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=Ut(a.pathname,n)!=null;if(a.origin===e.origin&&i)return a.pathname+a.search+a.hash}return t}function sa(t,e,n,r){let a=t.createURL(xp(e)).toString(),i={signal:n};if(r&&Bt(r.formMethod)){let{formMethod:o,formEncType:s}=r;i.method=o.toUpperCase(),s==="application/json"?(i.headers=new Headers({"Content-Type":s}),i.body=JSON.stringify(r.json)):s==="text/plain"?i.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?i.body=Cl(r.formData):i.body=r.formData}return new Request(a,i)}function Cl(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function yp(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function r_(t,e,n,r=!1,a=!1){let i={},o=null,s,c=!1,l={},u=n&&wt(n[1])?n[1].error:void 0;return t.forEach(d=>{if(!(d.route.id in e))return;let h=d.route.id,f=e[h];if(Ee(!kr(f),"Cannot handle redirect results in processLoaderData"),wt(f)){let p=f.error;if(u!==void 0&&(p=u,u=void 0),o=o||{},a)o[h]=p;else{let y=Or(t,h);o[y.route.id]==null&&(o[y.route.id]=p)}r||(i[h]=cp),c||(c=!0,s=zo(f.error)?f.error.status:500),f.headers&&(l[h]=f.headers)}else i[h]=f.data,f.statusCode&&f.statusCode!==200&&!c&&(s=f.statusCode),f.headers&&(l[h]=f.headers)}),u!==void 0&&n&&(o={[n[0]]:u},i[n[0]]=void 0),{loaderData:i,errors:o,statusCode:s||200,loaderHeaders:l}}function vp(t,e,n,r,a,i){let{loaderData:o,errors:s}=r_(e,n,r);return a.forEach(c=>{let{key:l,match:u,controller:d}=c,h=i[l];if(Ee(h,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(wt(h)){let f=Or(t.matches,u==null?void 0:u.route.id);s&&s[f.route.id]||(s={...s,[f.route.id]:h.error}),t.fetchers.delete(l)}else if(kr(h))Ee(!1,"Unhandled fetcher revalidation redirect");else{let f=Hn(h.data);t.fetchers.set(l,f)}}),{loaderData:o,errors:s}}function bp(t,e,n,r){let a=Object.entries(e).filter(([,i])=>i!==cp).reduce((i,[o,s])=>(i[o]=s,i),{});for(let i of n){let o=i.route.id;if(!e.hasOwnProperty(o)&&t.hasOwnProperty(o)&&i.route.loader&&(a[o]=t[o]),r&&r.hasOwnProperty(o))break}return a}function wp(t){return t?wt(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Or(t,e){return(e?t.slice(0,t.findIndex(n=>n.route.id===e)+1):[...t]).reverse().find(n=>n.route.hasErrorBoundary===!0)||t[0]}function _p(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Rt(t,{pathname:e,routeId:n,method:r,type:a,message:i}={}){let o="Unknown Server Error",s="Unknown @remix-run/router error";return t===400?(o="Bad Request",r&&e&&n?s=`You made a ${r} request to "${e}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:a==="invalid-body"&&(s="Unable to encode submission body")):t===403?(o="Forbidden",s=`Route "${n}" does not match URL "${e}"`):t===404?(o="Not Found",s=`No route matches URL "${e}"`):t===405&&(o="Method Not Allowed",r&&e&&n?s=`You made a ${r.toUpperCase()} request to "${e}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new Bo(t||500,o,new Error(s),!0)}function Zo(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,a]=e[n];if(kr(a))return{key:r,result:a}}}function xp(t){let e=typeof t=="string"?kn(t):t;return On({...e,hash:""})}function a_(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function i_(t){return Sp(t.result)&&Hw.has(t.result.status)}function wt(t){return t.type==="error"}function kr(t){return(t&&t.type)==="redirect"}function Ep(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function Sp(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function o_(t){return Zw.has(t.toUpperCase())}function Bt(t){return Bw.has(t.toUpperCase())}function jl(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function oi(t,e){let n=typeof e=="string"?kn(e).search:e.search;if(t[t.length-1].route.index&&jl(n||""))return t[t.length-1];let r=ip(t);return r[r.length-1]}function Op(t){let{formMethod:e,formAction:n,formEncType:r,text:a,formData:i,json:o}=t;if(!(!e||!n||!r)){if(a!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:a};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function Al(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function s_(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function si(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function c_(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Hn(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function l_(t,e){try{let n=t.sessionStorage.getItem(sp);if(n){let r=JSON.parse(n);for(let[a,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(a,new Set(i||[]))}}catch{}}function u_(t,e){if(e.size>0){let n={};for(let[r,a]of e)n[r]=[...a];try{t.sessionStorage.setItem(sp,JSON.stringify(n))}catch(r){Qe(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function d_(){let t,e,n=new Promise((r,a)=>{t=async i=>{r(i);try{await n}catch{}},e=async i=>{a(i);try{await n}catch{}}});return{promise:n,resolve:t,reject:e}}var Tr=m.createContext(null);Tr.displayName="DataRouter";var ci=m.createContext(null);ci.displayName="DataRouterState";var Pl=m.createContext({isTransitioning:!1});Pl.displayName="ViewTransition";var kp=m.createContext(new Map);kp.displayName="Fetchers";var h_=m.createContext(null);h_.displayName="Await";var zt=m.createContext(null);zt.displayName="Navigation";var Ho=m.createContext(null);Ho.displayName="Location";var It=m.createContext({outlet:null,matches:[],isDataRoute:!1});It.displayName="Route";var $l=m.createContext(null);$l.displayName="RouteError";function f_(t,{relative:e}={}){Ee(ca(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=m.useContext(zt),{hash:a,pathname:i,search:o}=li(t,{relative:e}),s=i;return n!=="/"&&(s=i==="/"?n:ln([n,i])),r.createHref({pathname:s,search:o,hash:a})}function ca(){return m.useContext(Ho)!=null}function un(){return Ee(ca(),"useLocation() may be used only in the context of a <Router> component."),m.useContext(Ho).location}var Tp="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Rp(t){m.useContext(zt).static||m.useLayoutEffect(t)}Er=function(){let{isDataRoute:t}=m.useContext(It);return t?T_():p_()};function p_(){Ee(ca(),"useNavigate() may be used only in the context of a <Router> component.");let t=m.useContext(Tr),{basename:e,navigator:n}=m.useContext(zt),{matches:r}=m.useContext(It),{pathname:a}=un(),i=JSON.stringify(Fo(r)),o=m.useRef(!1);return Rp(()=>{o.current=!0}),m.useCallback((s,c={})=>{if(Qe(o.current,Tp),!o.current)return;if(typeof s=="number"){n.go(s);return}let l=Uo(s,JSON.parse(i),a,c.relative==="path");t==null&&e!=="/"&&(l.pathname=l.pathname==="/"?e:ln([e,l.pathname])),(c.replace?n.replace:n.push)(l,c.state,c)},[e,n,i,a,t])}var m_=m.createContext(null);function g_(t){let e=m.useContext(It).outlet;return e&&m.createElement(m_.Provider,{value:t},e)}function Go(){let{matches:t}=m.useContext(It),e=t[t.length-1];return e?e.params:{}}function li(t,{relative:e}={}){let{matches:n}=m.useContext(It),{pathname:r}=un(),a=JSON.stringify(Fo(n));return m.useMemo(()=>Uo(t,JSON.parse(a),r,e==="path"),[t,a,r,e])}function y_(t,e,n,r){Ee(ca(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=m.useContext(zt),{matches:i}=m.useContext(It),o=i[i.length-1],s=o?o.params:{},c=o?o.pathname:"/",l=o?o.pathnameBase:"/",u=o&&o.route;{let v=u&&u.path||"";Cp(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=un(),h;h=d;let f=h.pathname||"/",p=f;if(l!=="/"){let v=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let y=Zn(t,{pathname:p});return Qe(u||y!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),Qe(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),x_(y&&y.map(v=>Object.assign({},v,{params:Object.assign({},s,v.params),pathname:ln([l,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:ln([l,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,n,r)}function v_(){let t=Ip(),e=zo(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=m.createElement(m.Fragment,null,m.createElement("p",null,"\u{1F4BF} Hey developer \u{1F44B}"),m.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",m.createElement("code",{style:i},"ErrorBoundary")," or"," ",m.createElement("code",{style:i},"errorElement")," prop on your route.")),m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},e),n?m.createElement("pre",{style:a},n):null,o)}var b_=m.createElement(v_,null),w_=class extends m.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?m.createElement(It.Provider,{value:this.props.routeContext},m.createElement($l.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function __({routeContext:t,match:e,children:n}){let r=m.useContext(Tr);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),m.createElement(It.Provider,{value:t},n)}function x_(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,i=n==null?void 0:n.errors;if(i!=null){let c=a.findIndex(l=>l.route.id&&(i==null?void 0:i[l.route.id])!==void 0);Ee(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let o=!1,s=-1;if(n)for(let c=0;c<a.length;c++){let l=a[c];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(s=c),l.route.id){let{loaderData:u,errors:d}=n,h=l.route.loader&&!u.hasOwnProperty(l.route.id)&&(!d||d[l.route.id]===void 0);if(l.route.lazy||h){o=!0,s>=0?a=a.slice(0,s+1):a=[a[0]];break}}}return a.reduceRight((c,l,u)=>{let d,h=!1,f=null,p=null;n&&(d=i&&l.route.id?i[l.route.id]:void 0,f=l.route.errorElement||b_,o&&(s<0&&u===0?(Cp("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):s===u&&(h=!0,p=l.route.hydrateFallbackElement||null)));let y=e.concat(a.slice(0,u+1)),v=()=>{let x;return d?x=f:h?x=p:l.route.Component?x=m.createElement(l.route.Component,null):l.route.element?x=l.route.element:x=c,m.createElement(__,{match:l,routeContext:{outlet:c,matches:y,isDataRoute:n!=null},children:x})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?m.createElement(w_,{location:n.location,revalidation:n.revalidation,component:f,error:d,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}function Ll(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function E_(t){let e=m.useContext(Tr);return Ee(e,Ll(t)),e}function S_(t){let e=m.useContext(ci);return Ee(e,Ll(t)),e}function O_(t){let e=m.useContext(It);return Ee(e,Ll(t)),e}function Ml(t){let e=O_(t),n=e.matches[e.matches.length-1];return Ee(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function k_(){return Ml("useRouteId")}function Ip(){var r;let t=m.useContext($l),e=S_("useRouteError"),n=Ml("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function T_(){let{router:t}=E_("useNavigate"),e=Ml("useNavigate"),n=m.useRef(!1);return Rp(()=>{n.current=!0}),m.useCallback(async(r,a={})=>{Qe(n.current,Tp),n.current&&(typeof r=="number"?t.navigate(r):await t.navigate(r,{fromRouteId:e,...a}))},[t,e])}var Np={};function Cp(t,e,n){!e&&!Np[t]&&(Np[t]=!0,Qe(!1,n))}var jp={};function Ap(t,e){!t&&!jp[e]&&(jp[e]=!0,console.warn(e))}function Pp(t){let e={hasErrorBoundary:t.hasErrorBoundary||t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&(t.element&&Qe(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(e,{element:m.createElement(t.Component),Component:void 0})),t.HydrateFallback&&(t.hydrateFallbackElement&&Qe(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(e,{hydrateFallbackElement:m.createElement(t.HydrateFallback),HydrateFallback:void 0})),t.ErrorBoundary&&(t.errorElement&&Qe(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(e,{errorElement:m.createElement(t.ErrorBoundary),ErrorBoundary:void 0})),e}var R_=class{constructor(){this.status="pending",this.promise=new Promise((t,e)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",e(n))}})}};function I_({router:t,flushSync:e}){let[n,r]=m.useState(t.state),[a,i]=m.useState(),[o,s]=m.useState({isTransitioning:!1}),[c,l]=m.useState(),[u,d]=m.useState(),[h,f]=m.useState(),p=m.useRef(new Map),y=m.useCallback((I,{deletedFetchers:A,flushSync:_,viewTransitionOpts:U})=>{A.forEach(F=>p.current.delete(F)),I.fetchers.forEach((F,G)=>{F.data!==void 0&&p.current.set(G,F.data)}),Ap(_===!1||e!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let Z=t.window!=null&&t.window.document!=null&&typeof t.window.document.startViewTransition=="function";if(Ap(U==null||Z,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!U||!Z){e&&_?e(()=>r(I)):m.startTransition(()=>r(I));return}if(e&&_){e(()=>{u&&(c&&c.resolve(),u.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:U.currentLocation,nextLocation:U.nextLocation})});let F=t.window.document.startViewTransition(()=>{e(()=>r(I))});F.finished.finally(()=>{e(()=>{l(void 0),d(void 0),i(void 0),s({isTransitioning:!1})})}),e(()=>d(F));return}u?(c&&c.resolve(),u.skipTransition(),f({state:I,currentLocation:U.currentLocation,nextLocation:U.nextLocation})):(i(I),s({isTransitioning:!0,flushSync:!1,currentLocation:U.currentLocation,nextLocation:U.nextLocation}))},[t.window,e,u,c]);m.useLayoutEffect(()=>t.subscribe(y),[t,y]),m.useEffect(()=>{o.isTransitioning&&!o.flushSync&&l(new R_)},[o]),m.useEffect(()=>{if(c&&a&&t.window){let I=a,A=c.promise,_=t.window.document.startViewTransition(async()=>{m.startTransition(()=>r(I)),await A});_.finished.finally(()=>{l(void 0),d(void 0),i(void 0),s({isTransitioning:!1})}),d(_)}},[a,c,t.window]),m.useEffect(()=>{c&&a&&n.location.key===a.location.key&&c.resolve()},[c,u,n.location,a]),m.useEffect(()=>{!o.isTransitioning&&h&&(i(h.state),s({isTransitioning:!0,flushSync:!1,currentLocation:h.currentLocation,nextLocation:h.nextLocation}),f(void 0))},[o.isTransitioning,h]);let v=m.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:I=>t.navigate(I),push:(I,A,_)=>t.navigate(I,{state:A,preventScrollReset:_==null?void 0:_.preventScrollReset}),replace:(I,A,_)=>t.navigate(I,{replace:!0,state:A,preventScrollReset:_==null?void 0:_.preventScrollReset})}),[t]),x=t.basename||"/",O=m.useMemo(()=>({router:t,navigator:v,static:!1,basename:x}),[t,v,x]);return m.createElement(m.Fragment,null,m.createElement(Tr.Provider,{value:O},m.createElement(ci.Provider,{value:n},m.createElement(kp.Provider,{value:p.current},m.createElement(Pl.Provider,{value:o},m.createElement(P_,{basename:x,location:n.location,navigationType:n.historyAction,navigator:v},m.createElement(N_,{routes:t.routes,future:t.future,state:n})))))),null)}var N_=m.memo(C_);function C_({routes:t,future:e,state:n}){return y_(t,void 0,n,e)}function j_({to:t,replace:e,state:n,relative:r}){Ee(ca(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=m.useContext(zt);Qe(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=m.useContext(It),{pathname:o}=un(),s=Er(),c=Uo(t,Fo(i),o,r==="path"),l=JSON.stringify(c);return m.useEffect(()=>{s(JSON.parse(l),{replace:e,state:n,relative:r})},[s,l,r,e,n]),null}function A_(t){return g_(t.context)}function Gn(t){Ee(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function P_({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:a,static:i=!1}){Ee(!ca(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),s=m.useMemo(()=>({basename:o,navigator:a,static:i,future:{}}),[o,a,i]);typeof n=="string"&&(n=kn(n));let{pathname:c="/",search:l="",hash:u="",state:d=null,key:h="default"}=n,f=m.useMemo(()=>{let p=Ut(c,o);return p==null?null:{location:{pathname:p,search:l,hash:u,state:d,key:h},navigationType:r}},[o,c,l,u,d,h,r]);return Qe(f!=null,`<Router basename="${o}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:m.createElement(zt.Provider,{value:s},m.createElement(Ho.Provider,{children:e,value:f}))}function Dl(t,e=[]){let n=[];return m.Children.forEach(t,(r,a)=>{if(!m.isValidElement(r))return;let i=[...e,a];if(r.type===m.Fragment){n.push.apply(n,Dl(r.props.children,i));return}Ee(r.type===Gn,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ee(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Dl(r.props.children,i)),n.push(o)}),n}var $_=Dl,Wo="get",Vo="application/x-www-form-urlencoded";function qo(t){return t!=null&&typeof t.tagName=="string"}function L_(t){return qo(t)&&t.tagName.toLowerCase()==="button"}function M_(t){return qo(t)&&t.tagName.toLowerCase()==="form"}function D_(t){return qo(t)&&t.tagName.toLowerCase()==="input"}function F_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function U_(t,e){return t.button===0&&(!e||e==="_self")&&!F_(t)}var Jo=null;function B_(){if(Jo===null)try{new FormData(document.createElement("form"),0),Jo=!1}catch{Jo=!0}return Jo}var z_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Fl(t){return t!=null&&!z_.has(t)?(Qe(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Vo}"`),null):t}function Z_(t,e){let n,r,a,i,o;if(M_(t)){let s=t.getAttribute("action");r=s?Ut(s,e):null,n=t.getAttribute("method")||Wo,a=Fl(t.getAttribute("enctype"))||Vo,i=new FormData(t)}else if(L_(t)||D_(t)&&(t.type==="submit"||t.type==="image")){let s=t.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||s.getAttribute("action");if(r=c?Ut(c,e):null,n=t.getAttribute("formmethod")||s.getAttribute("method")||Wo,a=Fl(t.getAttribute("formenctype"))||Fl(s.getAttribute("enctype"))||Vo,i=new FormData(s,t),!B_()){let{name:l,type:u,value:d}=t;if(u==="image"){let h=l?`${l}.`:"";i.append(`${h}x`,"0"),i.append(`${h}y`,"0")}else l&&i.append(l,d)}}else{if(qo(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Wo,r=null,a=Vo,o=t}return i&&a==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:i,body:o}}function Ul(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function H_(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module).then(async r=>(await r.__tla,r));return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function G_(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function W_(t,e,n){let r=await Promise.all(t.map(async a=>{let i=e.routes[a.route.id];if(i){let o=await H_(i,n);return o.links?o.links():[]}return[]}));return K_(r.flat(1).filter(G_).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function $p(t,e,n,r,a,i){let o=(c,l)=>n[l]?c.route.id!==n[l].route.id:!0,s=(c,l)=>{var u;return n[l].pathname!==c.pathname||((u=n[l].route.path)==null?void 0:u.endsWith("*"))&&n[l].params["*"]!==c.params["*"]};return i==="assets"?e.filter((c,l)=>o(c,l)||s(c,l)):i==="data"?e.filter((c,l)=>{var d;let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(o(c,l)||s(c,l))return!0;if(c.route.shouldRevalidate){let h=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function V_(t,e){return q_(t.map(n=>{let r=e.routes[n.route.id];if(!r)return[];let a=[r.module];return r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function q_(t){return[...new Set(t)]}function J_(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function K_(t,e){let n=new Set;return new Set(e),t.reduce((r,a)=>{let i=JSON.stringify(J_(a));return n.has(i)||(n.add(i),r.push({key:i,link:a})),r},[])}function Y_(t){let e=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function X_(){let t=m.useContext(Tr);return Ul(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Q_(){let t=m.useContext(ci);return Ul(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Bl=m.createContext(void 0);Bl.displayName="FrameworkContext";function Lp(){let t=m.useContext(Bl);return Ul(t,"You must render this element inside a <HydratedRouter> element"),t}function ex(t,e){let n=m.useContext(Bl),[r,a]=m.useState(!1),[i,o]=m.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=e,h=m.useRef(null);m.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let y=x=>{x.forEach(O=>{o(O.isIntersecting)})},v=new IntersectionObserver(y,{threshold:.5});return h.current&&v.observe(h.current),()=>{v.disconnect()}}},[t]),m.useEffect(()=>{if(r){let y=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(y)}}},[r]);let f=()=>{a(!0)},p=()=>{a(!1),o(!1)};return n?t!=="intent"?[i,h,{}]:[i,h,{onFocus:ui(s,f),onBlur:ui(c,p),onMouseEnter:ui(l,f),onMouseLeave:ui(u,p),onTouchStart:ui(d,f)}]:[!1,h,{}]}function ui(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function tx({page:t,...e}){let{router:n}=X_(),r=m.useMemo(()=>Zn(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?m.createElement(rx,{page:t,matches:r,...e}):(console.warn(`Tried to prefetch ${t} but no routes matched.`),null)}function nx(t){let{manifest:e,routeModules:n}=Lp(),[r,a]=m.useState([]);return m.useEffect(()=>{let i=!1;return W_(t,e,n).then(o=>{i||a(o)}),()=>{i=!0}},[t,e,n]),r}function rx({page:t,matches:e,...n}){let r=un(),{manifest:a,routeModules:i}=Lp(),{loaderData:o,matches:s}=Q_(),c=m.useMemo(()=>$p(t,e,s,a,r,"data"),[t,e,s,a,r]),l=m.useMemo(()=>$p(t,e,s,a,r,"assets"),[t,e,s,a,r]),u=m.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let f=new Set,p=!1;if(e.forEach(v=>{var O;let x=a.routes[v.route.id];!x||!x.hasLoader||(!c.some(I=>I.route.id===v.route.id)&&v.route.id in o&&((O=i[v.route.id])!=null&&O.shouldRevalidate)||x.hasClientLoader?p=!0:f.add(v.route.id))}),f.size===0)return[];let y=Y_(t);return p&&f.size>0&&y.searchParams.set("_routes",e.filter(v=>f.has(v.route.id)).map(v=>v.route.id).join(",")),[y.pathname+y.search]},[o,r,a,c,e,t,i]),d=m.useMemo(()=>V_(l,a),[l,a]),h=nx(l);return m.createElement(m.Fragment,null,u.map(f=>m.createElement("link",{key:f,rel:"prefetch",as:"fetch",href:f,...n})),d.map(f=>m.createElement("link",{key:f,rel:"modulepreload",href:f,...n})),h.map(({key:f,link:p})=>m.createElement("link",{key:f,...p})))}function ax(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Mp=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Mp&&(window.__reactRouterVersion="7.0.2")}catch{}function Dp(t,e){return lp({basename:e==null?void 0:e.basename,future:e==null?void 0:e.future,history:vw({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||Fp(),routes:t,mapRouteProperties:Pp,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function ix(t,e){return lp({basename:e==null?void 0:e.basename,future:e==null?void 0:e.future,history:bw({window:e==null?void 0:e.window}),hydrationData:Fp(),routes:t,mapRouteProperties:Pp,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function Fp(){let t=window==null?void 0:window.__staticRouterHydrationData;return t&&t.errors&&(t={...t,errors:ox(t.errors)}),t}function ox(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,a]of e)if(a&&a.__type==="RouteErrorResponse")n[r]=new Bo(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let i=window[a.__subType];if(typeof i=="function")try{let o=new i(a.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(a.message);i.stack="",n[r]=i}}else n[r]=a;return n}var Up=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zl=m.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:r,reloadDocument:a,replace:i,state:o,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},h){let{basename:f}=m.useContext(zt),p=typeof c=="string"&&Up.test(c),y,v=!1;if(typeof c=="string"&&p&&(y=c,Mp))try{let F=new URL(window.location.href),G=c.startsWith("//")?new URL(F.protocol+c):new URL(c),re=Ut(G.pathname,f);G.origin===F.origin&&re!=null?c=re+G.search+G.hash:v=!0}catch{Qe(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let x=f_(c,{relative:r}),[O,I,A]=ex(n,d),_=ux(c,{replace:i,state:o,target:s,preventScrollReset:l,relative:r,viewTransition:u});function U(F){t&&t(F),F.defaultPrevented||_(F)}let Z=m.createElement("a",{...d,...A,href:y||x,onClick:v||a?t:U,ref:ax(h,I),target:s,"data-discover":!p&&e==="render"?"true":void 0});return O&&!p?m.createElement(m.Fragment,null,Z,m.createElement(tx,{page:x})):Z});zl.displayName="Link";var sx=m.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:r=!1,style:a,to:i,viewTransition:o,children:s,...c},l){let u=li(i,{relative:c.relative}),d=un(),h=m.useContext(ci),{navigator:f,basename:p}=m.useContext(zt),y=h!=null&&mx(u)&&o===!0,v=f.encodeLocation?f.encodeLocation(u).pathname:u.pathname,x=d.pathname,O=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;e||(x=x.toLowerCase(),O=O?O.toLowerCase():null,v=v.toLowerCase()),O&&p&&(O=Ut(O,p)||O);const I=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let A=x===v||!r&&x.startsWith(v)&&x.charAt(I)==="/",_=O!=null&&(O===v||!r&&O.startsWith(v)&&O.charAt(v.length)==="/"),U={isActive:A,isPending:_,isTransitioning:y},Z=A?t:void 0,F;typeof n=="function"?F=n(U):F=[n,A?"active":null,_?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let G=typeof a=="function"?a(U):a;return m.createElement(zl,{...c,"aria-current":Z,className:F,ref:l,style:G,to:i,viewTransition:o},typeof s=="function"?s(U):s)});sx.displayName="NavLink";var cx=m.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:a,state:i,method:o=Wo,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...h},f)=>{let p=fx(),y=px(s,{relative:l}),v=o.toLowerCase()==="get"?"get":"post",x=typeof s=="string"&&Up.test(s),O=I=>{if(c&&c(I),I.defaultPrevented)return;I.preventDefault();let A=I.nativeEvent.submitter,_=(A==null?void 0:A.getAttribute("formmethod"))||o;p(A||I.currentTarget,{fetcherKey:e,method:_,navigate:n,replace:a,state:i,relative:l,preventScrollReset:u,viewTransition:d})};return m.createElement("form",{ref:f,method:v,action:y,onSubmit:r?c:O,...h,"data-discover":!x&&t==="render"?"true":void 0})});cx.displayName="Form";function lx(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Bp(t){let e=m.useContext(Tr);return Ee(e,lx(t)),e}function ux(t,{target:e,replace:n,state:r,preventScrollReset:a,relative:i,viewTransition:o}={}){let s=Er(),c=un(),l=li(t,{relative:i});return m.useCallback(u=>{if(U_(u,e)){u.preventDefault();let d=n!==void 0?n:On(c)===On(l);s(t,{replace:d,state:r,preventScrollReset:a,relative:i,viewTransition:o})}},[c,s,l,n,r,e,t,a,i,o])}var dx=0,hx=()=>`__${String(++dx)}__`;function fx(){let{router:t}=Bp("useSubmit"),{basename:e}=m.useContext(zt),n=k_();return m.useCallback(async(r,a={})=>{let{action:i,method:o,encType:s,formData:c,body:l}=Z_(r,e);if(a.navigate===!1){let u=a.fetcherKey||hx();await t.fetch(u,n,a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||o,formEncType:a.encType||s,flushSync:a.flushSync})}else await t.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||o,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,n])}function px(t,{relative:e}={}){let{basename:n}=m.useContext(zt),r=m.useContext(It);Ee(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),i={...li(t||".",{relative:e})},o=un();if(t==null){i.search=o.search;let s=new URLSearchParams(i.search),c=s.getAll("index");if(c.some(l=>l==="")){s.delete("index"),c.filter(u=>u).forEach(u=>s.append("index",u));let l=s.toString();i.search=l?`?${l}`:""}}return(!t||t===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:ln([n,i.pathname])),On(i)}function mx(t,e={}){let n=m.useContext(Pl);Ee(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Bp("useViewTransitionState"),a=li(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=Ut(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Ut(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Do(a.pathname,o)!=null||Do(a.pathname,i)!=null}new TextEncoder;function gx(t){return m.createElement(I_,{flushSync:W0.flushSync,...t})}var yx=WN.useId||(()=>{}),vx=0;Ft=function(t){const[e,n]=m.useState(yx());return po(()=>{t||n(r=>r??String(vx++))},[t]),t||(e?`radix-${e}`:"")};let Ko,zp,Zp,Yo,Zl;Ko="Collapsible",[zp,lw]=qa(Ko),[Zp,Yo]=zp(Ko),Zl=m.forwardRef((t,e)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:i,onOpenChange:o,...s}=t,[c=!1,l]=Ja({prop:r,defaultProp:a,onChange:o});return g.jsx(Zp,{scope:n,disabled:i,contentId:Ft(),open:c,onOpenToggle:m.useCallback(()=>l(u=>!u),[l]),children:g.jsx(Ge.div,{"data-state":Vl(c),"data-disabled":i?"":void 0,...s,ref:e})})}),Zl.displayName=Ko;var Hp="CollapsibleTrigger",Hl=m.forwardRef((t,e)=>{const{__scopeCollapsible:n,...r}=t,a=Yo(Hp,n);return g.jsx(Ge.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":Vl(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:e,onClick:ve(t.onClick,a.onOpenToggle)})});Hl.displayName=Hp;var Gl="CollapsibleContent",Wl=m.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=Yo(Gl,t.__scopeCollapsible);return g.jsx(xn,{present:n||a.open,children:({present:i})=>g.jsx(bx,{...r,ref:e,present:i})})});Wl.displayName=Gl;var bx=m.forwardRef((t,e)=>{const{__scopeCollapsible:n,present:r,children:a,...i}=t,o=Yo(Gl,n),[s,c]=m.useState(r),l=m.useRef(null),u=ot(e,l),d=m.useRef(0),h=d.current,f=m.useRef(0),p=f.current,y=o.open||s,v=m.useRef(y),x=m.useRef();return m.useEffect(()=>{const O=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(O)},[]),po(()=>{const O=l.current;if(O){x.current=x.current||{transitionDuration:O.style.transitionDuration,animationName:O.style.animationName},O.style.transitionDuration="0s",O.style.animationName="none";const I=O.getBoundingClientRect();d.current=I.height,f.current=I.width,v.current||(O.style.transitionDuration=x.current.transitionDuration,O.style.animationName=x.current.animationName),c(r)}},[o.open,r]),g.jsx(Ge.div,{"data-state":Vl(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!y,...i,ref:u,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":p?`${p}px`:void 0,...t.style},children:y&&a})});function Vl(t){return t?"open":"closed"}qh=Zl,uw=Hl,dw=Wl;const wx=qh,_x=Hl,xx=Wl,ql=768;function Ex(){const[t,e]=m.useState(void 0);return m.useEffect(()=>{const n=window.matchMedia(`(max-width: ${ql-1}px)`),r=()=>{e(window.innerWidth<ql)};return n.addEventListener("change",r),e(window.innerWidth<ql),()=>n.removeEventListener("change",r)},[]),!!t}Oo=xc("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Bn=m.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...a},i)=>{const o=r?fr:"button";return g.jsx(o,{className:se(Oo({variant:e,size:n,className:t})),ref:i,...a})}),Bn.displayName="Button",To=m.forwardRef(({className:t,type:e,...n},r)=>g.jsx("input",{type:e,className:se("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n})),To.displayName="Input";var Sx="Separator",Gp="horizontal",Ox=["horizontal","vertical"],Wp=m.forwardRef((t,e)=>{const{decorative:n,orientation:r=Gp,...a}=t,i=kx(r)?r:Gp,o=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return g.jsx(Ge.div,{"data-orientation":i,...o,...a,ref:e})});Wp.displayName=Sx;function kx(t){return Ox.includes(t)}Vc=Wp,Po=m.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...r},a)=>g.jsx(Vc,{ref:a,decorative:n,orientation:e,className:se("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r})),Po.displayName=Vc.displayName;let Xo,Qo,Jl,Vp;Xo="focusScope.autoFocusOnMount",Qo="focusScope.autoFocusOnUnmount",Jl={bubbles:!1,cancelable:!0},Vp="FocusScope",Io=m.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=t,[s,c]=m.useState(null),l=Jr(a),u=Jr(i),d=m.useRef(null),h=ot(e,y=>c(y)),f=m.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;m.useEffect(()=>{if(r){let y=function(I){if(f.paused||!s)return;const A=I.target;s.contains(A)?d.current=A:Wn(d.current,{select:!0})},v=function(I){if(f.paused||!s)return;const A=I.relatedTarget;A!==null&&(s.contains(A)||Wn(d.current,{select:!0}))},x=function(I){if(document.activeElement===document.body)for(const A of I)A.removedNodes.length>0&&Wn(s)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const O=new MutationObserver(x);return s&&O.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),O.disconnect()}}},[r,s,f.paused]),m.useEffect(()=>{if(s){Kp.add(f);const y=document.activeElement;if(!s.contains(y)){const v=new CustomEvent(Xo,Jl);s.addEventListener(Xo,l),s.dispatchEvent(v),v.defaultPrevented||(Tx(jx(qp(s)),{select:!0}),document.activeElement===y&&Wn(s))}return()=>{s.removeEventListener(Xo,l),setTimeout(()=>{const v=new CustomEvent(Qo,Jl);s.addEventListener(Qo,u),s.dispatchEvent(v),v.defaultPrevented||Wn(y??document.body,{select:!0}),s.removeEventListener(Qo,u),Kp.remove(f)},0)}}},[s,l,u,f]);const p=m.useCallback(y=>{if(!n&&!r||f.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,x=document.activeElement;if(v&&x){const O=y.currentTarget,[I,A]=Rx(O);I&&A?!y.shiftKey&&x===A?(y.preventDefault(),n&&Wn(I,{select:!0})):y.shiftKey&&x===I&&(y.preventDefault(),n&&Wn(A,{select:!0})):x===O&&y.preventDefault()}},[n,r,f.paused]);return g.jsx(Ge.div,{tabIndex:-1,...o,ref:h,onKeyDown:p})}),Io.displayName=Vp;function Tx(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Wn(r,{select:e}),document.activeElement!==n)return}function Rx(t){const e=qp(t),n=Jp(e,t),r=Jp(e.reverse(),t);return[n,r]}function qp(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Jp(t,e){for(const n of t)if(!Ix(n,{upTo:e}))return n}function Ix(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Nx(t){return t instanceof HTMLInputElement&&"select"in t}function Wn(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Nx(t)&&e&&t.select()}}var Kp=Cx();function Cx(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Yp(t,e),t.unshift(e)},remove(e){var n;t=Yp(t,e),(n=t[0])==null||n.resume()}}}function Yp(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function jx(t){return t.filter(e=>e.tagName!=="A")}var Kl=0;Hc=function(){m.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Xp()),document.body.insertAdjacentElement("beforeend",t[1]??Xp()),Kl++,()=>{Kl===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Kl--}},[])};function Xp(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}Mt=function(){return Mt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Mt.apply(this,arguments)},Cc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n},cf=function(t,e,n){if(n||arguments.length===2)for(var r=0,a=e.length,i;r<a;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))};var es="right-scroll-bar-position",ts="width-before-scroll-bar",Ax="with-scroll-bars-hidden",Px="--removed-body-scroll-bar-size";function Yl(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function $x(t,e){var n=m.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=e,n.facade}var Lx=typeof window<"u"?m.useLayoutEffect:m.useEffect,Qp=new WeakMap;function Mx(t,e){var n=$x(null,function(r){return t.forEach(function(a){return Yl(a,r)})});return Lx(function(){var r=Qp.get(n);if(r){var a=new Set(r),i=new Set(t),o=n.current;a.forEach(function(s){i.has(s)||Yl(s,null)}),i.forEach(function(s){a.has(s)||Yl(s,o)})}Qp.set(n,t)},[t]),n}function Dx(t){return t}function Fx(t,e){e===void 0&&(e=Dx);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(s){return s!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(s){return i(s)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var s=n;n=[],s.forEach(i),o=n}var c=function(){var u=o;o=[],u.forEach(i)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){o.push(u),l()},filter:function(u){return o=o.filter(u),n}}}};return a}of=function(t){t===void 0&&(t={});var e=Fx(null);return e.options=Mt({async:!0,ssr:!1},t),e};var em=function(t){var e=t.sideCar,n=Cc(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return m.createElement(r,Mt({},n))};em.isSideCarExport=!0,lf=function(t,e){return t.useMedium(e),em};var tm=of(),Xl=function(){},ns=m.forwardRef(function(t,e){var n=m.useRef(null),r=m.useState({onScrollCapture:Xl,onWheelCapture:Xl,onTouchMoveCapture:Xl}),a=r[0],i=r[1],o=t.forwardProps,s=t.children,c=t.className,l=t.removeScrollBar,u=t.enabled,d=t.shards,h=t.sideCar,f=t.noIsolation,p=t.inert,y=t.allowPinchZoom,v=t.as,x=v===void 0?"div":v,O=t.gapMode,I=Cc(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),A=h,_=Mx([n,e]),U=Mt(Mt({},I),a);return m.createElement(m.Fragment,null,u&&m.createElement(A,{sideCar:tm,removeScrollBar:l,shards:d,noIsolation:f,inert:p,setCallbacks:i,allowPinchZoom:!!y,lockRef:n,gapMode:O}),o?m.cloneElement(m.Children.only(s),Mt(Mt({},U),{ref:_})):m.createElement(x,Mt({},U,{className:c,ref:_}),s))});ns.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},ns.classNames={fullWidth:ts,zeroRight:es},sf=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Ux(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=sf();return e&&t.setAttribute("nonce",e),t}function Bx(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function zx(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}let nm,rm,am,rs,im,om,sm,Rr,cm,Ql,lm,um,as;if(nm=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Ux())&&(Bx(e,n),zx(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},rm=function(){var t=nm();return function(e,n){m.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},jc=function(){var t=rm(),e=function(n){var r=n.styles,a=n.dynamic;return t(r,a),null};return e},am={left:0,top:0,right:0,gap:0},rs=function(t){return parseInt(t||"",10)||0},im=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],a=e[t==="padding"?"paddingRight":"marginRight"];return[rs(n),rs(r),rs(a)]},om=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return am;var e=im(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},sm=jc(),Rr="data-scroll-locked",cm=function(t,e,n,r){var a=t.left,i=t.top,o=t.right,s=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Ax,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Rr,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(es,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(ts,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(es," .").concat(es,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(ts," .").concat(ts,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Rr,`] {
    `).concat(Px,": ").concat(s,`px;
  }
`)},Ql=function(){var t=parseInt(document.body.getAttribute(Rr)||"0",10);return isFinite(t)?t:0},lm=function(){m.useEffect(function(){return document.body.setAttribute(Rr,(Ql()+1).toString()),function(){var t=Ql()-1;t<=0?document.body.removeAttribute(Rr):document.body.setAttribute(Rr,t.toString())}},[])},um=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,a=r===void 0?"margin":r;lm();var i=m.useMemo(function(){return om(a)},[a]);return m.createElement(sm,{styles:cm(i,!e,a,n?"":"!important")})},as=!1,typeof window<"u")try{var is=Object.defineProperty({},"passive",{get:function(){return as=!0,!0}});window.addEventListener("test",is,is),window.removeEventListener("test",is,is)}catch{as=!1}var la=as?{passive:!1}:!1,Zx=function(t){return t.tagName==="TEXTAREA"},dm=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Zx(t)&&n[e]==="visible")},Hx=function(t){return dm(t,"overflowY")},Gx=function(t){return dm(t,"overflowX")},hm=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=fm(t,r);if(a){var i=pm(t,r),o=i[1],s=i[2];if(o>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Wx=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},Vx=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},fm=function(t,e){return t==="v"?Hx(e):Gx(e)},pm=function(t,e){return t==="v"?Wx(e):Vx(e)},qx=function(t,e){return t==="h"&&e==="rtl"?-1:1},Jx=function(t,e,n,r,a){var i=qx(t,window.getComputedStyle(e).direction),o=i*r,s=n.target,c=e.contains(s),l=!1,u=o>0,d=0,h=0;do{var f=pm(t,s),p=f[0],y=f[1],v=f[2],x=y-v-i*p;(p||x)&&fm(t,s)&&(d+=x,h+=p),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(e.contains(s)||e===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(h)<1||!a))&&(l=!0),l},os=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},mm=function(t){return[t.deltaX,t.deltaY]},gm=function(t){return t&&"current"in t?t.current:t},Kx=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Yx=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Xx=0,ua=[];function Qx(t){var e=m.useRef([]),n=m.useRef([0,0]),r=m.useRef(),a=m.useState(Xx++)[0],i=m.useState(jc)[0],o=m.useRef(t);m.useEffect(function(){o.current=t},[t]),m.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var y=cf([t.lockRef.current],(t.shards||[]).map(gm),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var s=m.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!o.current.allowPinchZoom;var x=os(y),O=n.current,I="deltaX"in y?y.deltaX:O[0]-x[0],A="deltaY"in y?y.deltaY:O[1]-x[1],_,U=y.target,Z=Math.abs(I)>Math.abs(A)?"h":"v";if("touches"in y&&Z==="h"&&U.type==="range")return!1;var F=hm(Z,U);if(!F)return!0;if(F?_=Z:(_=Z==="v"?"h":"v",F=hm(Z,U)),!F)return!1;if(!r.current&&"changedTouches"in y&&(I||A)&&(r.current=_),!_)return!0;var G=r.current||_;return Jx(G,v,y,G==="h"?I:A,!0)},[]),c=m.useCallback(function(y){var v=y;if(!(!ua.length||ua[ua.length-1]!==i)){var x="deltaY"in v?mm(v):os(v),O=e.current.filter(function(_){return _.name===v.type&&(_.target===v.target||v.target===_.shadowParent)&&Kx(_.delta,x)})[0];if(O&&O.should){v.cancelable&&v.preventDefault();return}if(!O){var I=(o.current.shards||[]).map(gm).filter(Boolean).filter(function(_){return _.contains(v.target)}),A=I.length>0?s(v,I[0]):!o.current.noIsolation;A&&v.cancelable&&v.preventDefault()}}},[]),l=m.useCallback(function(y,v,x,O){var I={name:y,delta:v,target:x,should:O,shadowParent:eE(x)};e.current.push(I),setTimeout(function(){e.current=e.current.filter(function(A){return A!==I})},1)},[]),u=m.useCallback(function(y){n.current=os(y),r.current=void 0},[]),d=m.useCallback(function(y){l(y.type,mm(y),y.target,s(y,t.lockRef.current))},[]),h=m.useCallback(function(y){l(y.type,os(y),y.target,s(y,t.lockRef.current))},[]);m.useEffect(function(){return ua.push(i),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",c,la),document.addEventListener("touchmove",c,la),document.addEventListener("touchstart",u,la),function(){ua=ua.filter(function(y){return y!==i}),document.removeEventListener("wheel",c,la),document.removeEventListener("touchmove",c,la),document.removeEventListener("touchstart",u,la)}},[]);var f=t.removeScrollBar,p=t.inert;return m.createElement(m.Fragment,null,p?m.createElement(i,{styles:Yx(a)}):null,f?m.createElement(um,{gapMode:t.gapMode}):null)}function eE(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const tE=lf(tm,Qx);Ro=m.forwardRef(function(t,e){return m.createElement(ns,Mt({},t,{ref:e,sideCar:tE}))}),Ro.classNames=ns.classNames;let ym,Ir,di,hi,ss,eu,vm,bm,cs,tu,nu,wm,Nt,ru;ym=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Ir=new WeakMap,di=new WeakMap,hi={},ss=0,eu=function(t){return t&&(t.host||eu(t.parentNode))},vm=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=eu(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},bm=function(t,e,n,r){var a=vm(e,Array.isArray(t)?t:[t]);hi[n]||(hi[n]=new WeakMap);var i=hi[n],o=[],s=new Set,c=new Set(a),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};a.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(h){if(s.has(h))u(h);else try{var f=h.getAttribute(r),p=f!==null&&f!=="false",y=(Ir.get(h)||0)+1,v=(i.get(h)||0)+1;Ir.set(h,y),i.set(h,v),o.push(h),y===1&&p&&di.set(h,!0),v===1&&h.setAttribute(n,"true"),p||h.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(e),s.clear(),ss++,function(){o.forEach(function(d){var h=Ir.get(d)-1,f=i.get(d)-1;Ir.set(d,h),i.set(d,f),h||(di.has(d)||d.removeAttribute(r),di.delete(d)),f||d.removeAttribute(n)}),ss--,ss||(Ir=new WeakMap,Ir=new WeakMap,di=new WeakMap,hi={})}},Zc=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),a=ym(t);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),bm(r,a,n,"aria-hidden")):function(){return null}},cs="Dialog",[tu,nu]=qa(cs),[wm,Nt]=tu(cs),ru=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:a,onOpenChange:i,modal:o=!0}=t,s=m.useRef(null),c=m.useRef(null),[l=!1,u]=Ja({prop:r,defaultProp:a,onChange:i});return g.jsx(wm,{scope:e,triggerRef:s,contentRef:c,contentId:Ft(),titleId:Ft(),descriptionId:Ft(),open:l,onOpenChange:u,onOpenToggle:m.useCallback(()=>u(d=>!d),[u]),modal:o,children:n})},ru.displayName=cs;var _m="DialogTrigger",xm=m.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=Nt(_m,n),i=ot(e,a.triggerRef);return g.jsx(Ge.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":ou(a.open),...r,ref:i,onClick:ve(t.onClick,a.onOpenToggle)})});xm.displayName=_m;var au="DialogPortal",[nE,Em]=tu(au,{forceMount:void 0}),Sm=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:a}=t,i=Nt(au,e);return g.jsx(nE,{scope:e,forceMount:n,children:m.Children.map(r,o=>g.jsx(xn,{present:n||i.open,children:g.jsx(Mh,{asChild:!0,container:a,children:o})}))})};Sm.displayName=au;var ls="DialogOverlay",Om=m.forwardRef((t,e)=>{const n=Em(ls,t.__scopeDialog),{forceMount:r=n.forceMount,...a}=t,i=Nt(ls,t.__scopeDialog);return i.modal?g.jsx(xn,{present:r||i.open,children:g.jsx(rE,{...a,ref:e})}):null});Om.displayName=ls;var rE=m.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=Nt(ls,n);return g.jsx(Ro,{as:fr,allowPinchZoom:!0,shards:[a.contentRef],children:g.jsx(Ge.div,{"data-state":ou(a.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Nr="DialogContent",km=m.forwardRef((t,e)=>{const n=Em(Nr,t.__scopeDialog),{forceMount:r=n.forceMount,...a}=t,i=Nt(Nr,t.__scopeDialog);return g.jsx(xn,{present:r||i.open,children:i.modal?g.jsx(aE,{...a,ref:e}):g.jsx(iE,{...a,ref:e})})});km.displayName=Nr;var aE=m.forwardRef((t,e)=>{const n=Nt(Nr,t.__scopeDialog),r=m.useRef(null),a=ot(e,n.contentRef,r);return m.useEffect(()=>{const i=r.current;if(i)return Zc(i)},[]),g.jsx(Tm,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ve(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:ve(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,s=o.button===0&&o.ctrlKey===!0;(o.button===2||s)&&i.preventDefault()}),onFocusOutside:ve(t.onFocusOutside,i=>i.preventDefault())})}),iE=m.forwardRef((t,e)=>{const n=Nt(Nr,t.__scopeDialog),r=m.useRef(!1),a=m.useRef(!1);return g.jsx(Tm,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,s;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),i.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:i=>{var s,c;(s=t.onInteractOutside)==null||s.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;(c=n.triggerRef.current)!=null&&c.contains(o)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),Tm=m.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=t,s=Nt(Nr,n),c=m.useRef(null),l=ot(e,c);return Hc(),g.jsxs(g.Fragment,{children:[g.jsx(Io,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:i,children:g.jsx(Lh,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":ou(s.open),...o,ref:l,onDismiss:()=>s.onOpenChange(!1)})}),g.jsxs(g.Fragment,{children:[g.jsx(Pm,{titleId:s.titleId}),g.jsx(Lm,{contentRef:c,descriptionId:s.descriptionId})]})]})}),iu="DialogTitle",Rm=m.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=Nt(iu,n);return g.jsx(Ge.h2,{id:a.titleId,...r,ref:e})});Rm.displayName=iu;var Im="DialogDescription",Nm=m.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=Nt(Im,n);return g.jsx(Ge.p,{id:a.descriptionId,...r,ref:e})});Nm.displayName=Im;var Cm="DialogClose",jm=m.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=Nt(Cm,n);return g.jsx(Ge.button,{type:"button",...r,ref:e,onClick:ve(t.onClick,()=>a.onOpenChange(!1))})});jm.displayName=Cm;function ou(t){return t?"open":"closed"}let su,Am,cu,Pm,$m,Lm,Mm;su="DialogTitleWarning",[Am,cu]=VN(su,{contentName:Nr,titleName:iu,docsSlug:"dialog"}),Pm=({titleId:t})=>{const e=cu(su),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return m.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},$m="DialogDescriptionWarning",Lm=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${cu($m).contentName}}.`;return m.useEffect(()=>{var a;const r=(a=t.current)==null?void 0:a.getAttribute("aria-describedby");e&&r&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},No=ru,Mm=xm,Co=Sm,na=Om,ra=km,ea=Rm,ta=Nm,ti=jm;const oE=No,sE=Co,Dm=m.forwardRef(({className:t,...e},n)=>g.jsx(na,{className:se("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));Dm.displayName=na.displayName;const cE=xc("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Fm=m.forwardRef(({side:t="right",className:e,children:n,...r},a)=>g.jsxs(sE,{children:[g.jsx(Dm,{}),g.jsxs(ra,{ref:a,className:se(cE({side:t}),e),...r,children:[n,g.jsxs(ti,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[g.jsx(Ce,{name:"x",className:"h-4 w-4"}),g.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Fm.displayName=ra.displayName;const lE=m.forwardRef(({className:t,...e},n)=>g.jsx(ea,{ref:n,className:se("text-lg font-semibold text-foreground",t),...e}));lE.displayName=ea.displayName;const uE=m.forwardRef(({className:t,...e},n)=>g.jsx(ta,{ref:n,className:se("text-sm text-muted-foreground",t),...e}));uE.displayName=ta.displayName;function Um({className:t,...e}){return g.jsx("div",{className:se("animate-pulse rounded-md bg-muted",t),...e})}const dE=["top","right","bottom","left"],dn=Math.min,_t=Math.max,us=Math.round,ds=Math.floor,Vn=t=>({x:t,y:t}),hE={left:"right",right:"left",bottom:"top",top:"bottom"},fE={start:"end",end:"start"};function lu(t,e,n){return _t(t,dn(e,n))}function Tn(t,e){return typeof t=="function"?t(e):t}function Rn(t){return t.split("-")[0]}function da(t){return t.split("-")[1]}function uu(t){return t==="x"?"y":"x"}function du(t){return t==="y"?"height":"width"}function qn(t){return["top","bottom"].includes(Rn(t))?"y":"x"}function hu(t){return uu(qn(t))}function pE(t,e,n){n===void 0&&(n=!1);const r=da(t),a=hu(t),i=du(a);let o=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=hs(o)),[o,hs(o)]}function mE(t){const e=hs(t);return[fu(t),e,fu(e)]}function fu(t){return t.replace(/start|end/g,e=>fE[e])}function gE(t,e,n){const r=["left","right"],a=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?a:r:e?r:a;case"left":case"right":return e?i:o;default:return[]}}function yE(t,e,n,r){const a=da(t);let i=gE(Rn(t),n==="start",r);return a&&(i=i.map(o=>o+"-"+a),e&&(i=i.concat(i.map(fu)))),i}function hs(t){return t.replace(/left|right|bottom|top/g,e=>hE[e])}function vE(t){return{top:0,right:0,bottom:0,left:0,...t}}function Bm(t){return typeof t!="number"?vE(t):{top:t,right:t,bottom:t,left:t}}function fs(t){const{x:e,y:n,width:r,height:a}=t;return{width:r,height:a,top:n,left:e,right:e+r,bottom:n+a,x:e,y:n}}function zm(t,e,n){let{reference:r,floating:a}=t;const i=qn(e),o=hu(e),s=du(o),c=Rn(e),l=i==="y",u=r.x+r.width/2-a.width/2,d=r.y+r.height/2-a.height/2,h=r[s]/2-a[s]/2;let f;switch(c){case"top":f={x:u,y:r.y-a.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-a.width,y:d};break;default:f={x:r.x,y:r.y}}switch(da(e)){case"start":f[o]-=h*(n&&l?-1:1);break;case"end":f[o]+=h*(n&&l?-1:1);break}return f}const bE=async(t,e,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:i=[],platform:o}=n,s=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let l=await o.getElementRects({reference:t,floating:e,strategy:a}),{x:u,y:d}=zm(l,r,c),h=r,f={},p=0;for(let y=0;y<s.length;y++){const{name:v,fn:x}=s[y],{x:O,y:I,data:A,reset:_}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:a,middlewareData:f,rects:l,platform:o,elements:{reference:t,floating:e}});u=O??u,d=I??d,f={...f,[v]:{...f[v],...A}},_&&p<=50&&(p++,typeof _=="object"&&(_.placement&&(h=_.placement),_.rects&&(l=_.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:a}):_.rects),{x:u,y:d}=zm(l,h,c)),y=-1)}return{x:u,y:d,placement:h,strategy:a,middlewareData:f}};async function fi(t,e){var n;e===void 0&&(e={});const{x:r,y:a,platform:i,rects:o,elements:s,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=Tn(e,t),p=Bm(f),y=s[h?d==="floating"?"reference":"floating":d],v=fs(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(y)))==null||n?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),x=d==="floating"?{x:r,y:a,width:o.floating.width,height:o.floating.height}:o.reference,O=await(i.getOffsetParent==null?void 0:i.getOffsetParent(s.floating)),I=await(i.isElement==null?void 0:i.isElement(O))?await(i.getScale==null?void 0:i.getScale(O))||{x:1,y:1}:{x:1,y:1},A=fs(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:x,offsetParent:O,strategy:c}):x);return{top:(v.top-A.top+p.top)/I.y,bottom:(A.bottom-v.bottom+p.bottom)/I.y,left:(v.left-A.left+p.left)/I.x,right:(A.right-v.right+p.right)/I.x}}const wE=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:a,rects:i,platform:o,elements:s,middlewareData:c}=e,{element:l,padding:u=0}=Tn(t,e)||{};if(l==null)return{};const d=Bm(u),h={x:n,y:r},f=hu(a),p=du(f),y=await o.getDimensions(l),v=f==="y",x=v?"top":"left",O=v?"bottom":"right",I=v?"clientHeight":"clientWidth",A=i.reference[p]+i.reference[f]-h[f]-i.floating[p],_=h[f]-i.reference[f],U=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l));let Z=U?U[I]:0;(!Z||!await(o.isElement==null?void 0:o.isElement(U)))&&(Z=s.floating[I]||i.floating[p]);const F=A/2-_/2,G=Z/2-y[p]/2-1,re=dn(d[x],G),he=dn(d[O],G),E=re,R=Z-y[p]-he,S=Z/2-y[p]/2+F,b=lu(E,S,R),z=!c.arrow&&da(a)!=null&&S!==b&&i.reference[p]/2-(S<E?re:he)-y[p]/2<0,C=z?S<E?S-E:S-R:0;return{[f]:h[f]+C,data:{[f]:b,centerOffset:S-b-C,...z&&{alignmentOffset:C}},reset:z}}}),_E=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:a,middlewareData:i,rects:o,initialPlacement:s,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:y=!0,...v}=Tn(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=Rn(a),O=qn(s),I=Rn(s)===s,A=await(c.isRTL==null?void 0:c.isRTL(l.floating)),_=h||(I||!y?[hs(s)]:mE(s)),U=p!=="none";!h&&U&&_.push(...yE(s,y,p,A));const Z=[s,..._],F=await fi(e,v),G=[];let re=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&G.push(F[x]),d){const S=pE(a,o,A);G.push(F[S[0]],F[S[1]])}if(re=[...re,{placement:a,overflows:G}],!G.every(S=>S<=0)){var he,E;const S=(((he=i.flip)==null?void 0:he.index)||0)+1,b=Z[S];if(b)return{data:{index:S,overflows:re},reset:{placement:b}};let z=(E=re.filter(C=>C.overflows[0]<=0).sort((C,$)=>C.overflows[1]-$.overflows[1])[0])==null?void 0:E.placement;if(!z)switch(f){case"bestFit":{var R;const C=(R=re.filter($=>{if(U){const P=qn($.placement);return P===O||P==="y"}return!0}).map($=>[$.placement,$.overflows.filter(P=>P>0).reduce((P,Y)=>P+Y,0)]).sort(($,P)=>$[1]-P[1])[0])==null?void 0:R[0];C&&(z=C);break}case"initialPlacement":z=s;break}if(a!==z)return{reset:{placement:z}}}return{}}}};function Zm(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Hm(t){return dE.some(e=>t[e]>=0)}const xE=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...a}=Tn(t,e);switch(r){case"referenceHidden":{const i=await fi(e,{...a,elementContext:"reference"}),o=Zm(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Hm(o)}}}case"escaped":{const i=await fi(e,{...a,altBoundary:!0}),o=Zm(i,n.floating);return{data:{escapedOffsets:o,escaped:Hm(o)}}}default:return{}}}}};async function EE(t,e){const{placement:n,platform:r,elements:a}=t,i=await(r.isRTL==null?void 0:r.isRTL(a.floating)),o=Rn(n),s=da(n),c=qn(n)==="y",l=["left","top"].includes(o)?-1:1,u=i&&c?-1:1,d=Tn(e,t);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof p=="number"&&(f=s==="end"?p*-1:p),c?{x:f*u,y:h*l}:{x:h*l,y:f*u}}const SE=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:a,y:i,placement:o,middlewareData:s}=e,c=await EE(e,t);return o===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:a+c.x,y:i+c.y,data:{...c,placement:o}}}}},OE=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:a}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:s={fn:v=>{let{x,y:O}=v;return{x,y:O}}},...c}=Tn(t,e),l={x:n,y:r},u=await fi(e,c),d=qn(Rn(a)),h=uu(d);let f=l[h],p=l[d];if(i){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",O=f+u[v],I=f-u[x];f=lu(O,f,I)}if(o){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",O=p+u[v],I=p-u[x];p=lu(O,p,I)}const y=s.fn({...e,[h]:f,[d]:p});return{...y,data:{x:y.x-n,y:y.y-r}}}}},kE=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:a,rects:i,middlewareData:o}=e,{offset:s=0,mainAxis:c=!0,crossAxis:l=!0}=Tn(t,e),u={x:n,y:r},d=qn(a),h=uu(d);let f=u[h],p=u[d];const y=Tn(s,e),v=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(c){const I=h==="y"?"height":"width",A=i.reference[h]-i.floating[I]+v.mainAxis,_=i.reference[h]+i.reference[I]-v.mainAxis;f<A?f=A:f>_&&(f=_)}if(l){var x,O;const I=h==="y"?"width":"height",A=["top","left"].includes(Rn(a)),_=i.reference[d]-i.floating[I]+(A&&((x=o.offset)==null?void 0:x[d])||0)+(A?0:v.crossAxis),U=i.reference[d]+i.reference[I]+(A?0:((O=o.offset)==null?void 0:O[d])||0)-(A?v.crossAxis:0);p<_?p=_:p>U&&(p=U)}return{[h]:f,[d]:p}}}},TE=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:r,platform:a,elements:i}=e,{apply:o=()=>{},...s}=Tn(t,e),c=await fi(e,s),l=Rn(n),u=da(n),d=qn(n)==="y",{width:h,height:f}=r.floating;let p,y;l==="top"||l==="bottom"?(p=l,y=u===(await(a.isRTL==null?void 0:a.isRTL(i.floating))?"start":"end")?"left":"right"):(y=l,p=u==="end"?"top":"bottom");const v=f-c.top-c.bottom,x=h-c.left-c.right,O=dn(f-c[p],v),I=dn(h-c[y],x),A=!e.middlewareData.shift;let _=O,U=I;if(d?U=u||A?dn(I,x):x:_=u||A?dn(O,v):v,A&&!u){const F=_t(c.left,0),G=_t(c.right,0),re=_t(c.top,0),he=_t(c.bottom,0);d?U=h-2*(F!==0||G!==0?F+G:_t(c.left,c.right)):_=f-2*(re!==0||he!==0?re+he:_t(c.top,c.bottom))}await o({...e,availableWidth:U,availableHeight:_});const Z=await a.getDimensions(i.floating);return h!==Z.width||f!==Z.height?{reset:{rects:!0}}:{}}}};function ha(t){return Gm(t)?(t.nodeName||"").toLowerCase():"#document"}function xt(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function In(t){var e;return(e=(Gm(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Gm(t){return t instanceof Node||t instanceof xt(t).Node}function Zt(t){return t instanceof Element||t instanceof xt(t).Element}function hn(t){return t instanceof HTMLElement||t instanceof xt(t).HTMLElement}function Wm(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof xt(t).ShadowRoot}function pi(t){const{overflow:e,overflowX:n,overflowY:r,display:a}=Ht(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(a)}function RE(t){return["table","td","th"].includes(ha(t))}function ps(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function pu(t){const e=mu(),n=Zt(t)?Ht(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function IE(t){let e=Jn(t);for(;hn(e)&&!fa(e);){if(pu(e))return e;if(ps(e))return null;e=Jn(e)}return null}function mu(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function fa(t){return["html","body","#document"].includes(ha(t))}function Ht(t){return xt(t).getComputedStyle(t)}function ms(t){return Zt(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Jn(t){if(ha(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Wm(t)&&t.host||In(t);return Wm(e)?e.host:e}function Vm(t){const e=Jn(t);return fa(e)?t.ownerDocument?t.ownerDocument.body:t.body:hn(e)&&pi(e)?e:Vm(e)}function mi(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const a=Vm(t),i=a===((r=t.ownerDocument)==null?void 0:r.body),o=xt(a);if(i){const s=gu(o);return e.concat(o,o.visualViewport||[],pi(a)?a:[],s&&n?mi(s):[])}return e.concat(a,mi(a,[],n))}function gu(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function qm(t){const e=Ht(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const a=hn(t),i=a?t.offsetWidth:n,o=a?t.offsetHeight:r,s=us(n)!==i||us(r)!==o;return s&&(n=i,r=o),{width:n,height:r,$:s}}function yu(t){return Zt(t)?t:t.contextElement}function pa(t){const e=yu(t);if(!hn(e))return Vn(1);const n=e.getBoundingClientRect(),{width:r,height:a,$:i}=qm(e);let o=(i?us(n.width):n.width)/r,s=(i?us(n.height):n.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!s||!Number.isFinite(s))&&(s=1),{x:o,y:s}}const NE=Vn(0);function Jm(t){const e=xt(t);return!mu()||!e.visualViewport?NE:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function CE(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==xt(t)?!1:e}function Cr(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const a=t.getBoundingClientRect(),i=yu(t);let o=Vn(1);e&&(r?Zt(r)&&(o=pa(r)):o=pa(t));const s=CE(i,n,r)?Jm(i):Vn(0);let c=(a.left+s.x)/o.x,l=(a.top+s.y)/o.y,u=a.width/o.x,d=a.height/o.y;if(i){const h=xt(i),f=r&&Zt(r)?xt(r):r;let p=h,y=gu(p);for(;y&&r&&f!==p;){const v=pa(y),x=y.getBoundingClientRect(),O=Ht(y),I=x.left+(y.clientLeft+parseFloat(O.paddingLeft))*v.x,A=x.top+(y.clientTop+parseFloat(O.paddingTop))*v.y;c*=v.x,l*=v.y,u*=v.x,d*=v.y,c+=I,l+=A,p=xt(y),y=gu(p)}}return fs({width:u,height:d,x:c,y:l})}function jE(t){let{elements:e,rect:n,offsetParent:r,strategy:a}=t;const i=a==="fixed",o=In(r),s=e?ps(e.floating):!1;if(r===o||s&&i)return n;let c={scrollLeft:0,scrollTop:0},l=Vn(1);const u=Vn(0),d=hn(r);if((d||!d&&!i)&&((ha(r)!=="body"||pi(o))&&(c=ms(r)),hn(r))){const h=Cr(r);l=pa(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function AE(t){return Array.from(t.getClientRects())}function Km(t){return Cr(In(t)).left+ms(t).scrollLeft}function PE(t){const e=In(t),n=ms(t),r=t.ownerDocument.body,a=_t(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=_t(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+Km(t);const s=-n.scrollTop;return Ht(r).direction==="rtl"&&(o+=_t(e.clientWidth,r.clientWidth)-a),{width:a,height:i,x:o,y:s}}function $E(t,e){const n=xt(t),r=In(t),a=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,s=0,c=0;if(a){i=a.width,o=a.height;const l=mu();(!l||l&&e==="fixed")&&(s=a.offsetLeft,c=a.offsetTop)}return{width:i,height:o,x:s,y:c}}function LE(t,e){const n=Cr(t,!0,e==="fixed"),r=n.top+t.clientTop,a=n.left+t.clientLeft,i=hn(t)?pa(t):Vn(1),o=t.clientWidth*i.x,s=t.clientHeight*i.y,c=a*i.x,l=r*i.y;return{width:o,height:s,x:c,y:l}}function Ym(t,e,n){let r;if(e==="viewport")r=$E(t,n);else if(e==="document")r=PE(In(t));else if(Zt(e))r=LE(e,n);else{const a=Jm(t);r={...e,x:e.x-a.x,y:e.y-a.y}}return fs(r)}function Xm(t,e){const n=Jn(t);return n===e||!Zt(n)||fa(n)?!1:Ht(n).position==="fixed"||Xm(n,e)}function ME(t,e){const n=e.get(t);if(n)return n;let r=mi(t,[],!1).filter(s=>Zt(s)&&ha(s)!=="body"),a=null;const i=Ht(t).position==="fixed";let o=i?Jn(t):t;for(;Zt(o)&&!fa(o);){const s=Ht(o),c=pu(o);!c&&s.position==="fixed"&&(a=null),(i?!c&&!a:!c&&s.position==="static"&&a&&["absolute","fixed"].includes(a.position)||pi(o)&&!c&&Xm(t,o))?r=r.filter(l=>l!==o):a=s,o=Jn(o)}return e.set(t,r),r}function DE(t){let{element:e,boundary:n,rootBoundary:r,strategy:a}=t;const i=[...n==="clippingAncestors"?ps(e)?[]:ME(e,this._c):[].concat(n),r],o=i[0],s=i.reduce((c,l)=>{const u=Ym(e,l,a);return c.top=_t(u.top,c.top),c.right=dn(u.right,c.right),c.bottom=dn(u.bottom,c.bottom),c.left=_t(u.left,c.left),c},Ym(e,o,a));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function FE(t){const{width:e,height:n}=qm(t);return{width:e,height:n}}function UE(t,e,n){const r=hn(e),a=In(e),i=n==="fixed",o=Cr(t,!0,i,e);let s={scrollLeft:0,scrollTop:0};const c=Vn(0);if(r||!r&&!i)if((ha(e)!=="body"||pi(a))&&(s=ms(e)),r){const d=Cr(e,!0,i,e);c.x=d.x+e.clientLeft,c.y=d.y+e.clientTop}else a&&(c.x=Km(a));const l=o.left+s.scrollLeft-c.x,u=o.top+s.scrollTop-c.y;return{x:l,y:u,width:o.width,height:o.height}}function vu(t){return Ht(t).position==="static"}function Qm(t,e){return!hn(t)||Ht(t).position==="fixed"?null:e?e(t):t.offsetParent}function eg(t,e){const n=xt(t);if(ps(t))return n;if(!hn(t)){let a=Jn(t);for(;a&&!fa(a);){if(Zt(a)&&!vu(a))return a;a=Jn(a)}return n}let r=Qm(t,e);for(;r&&RE(r)&&vu(r);)r=Qm(r,e);return r&&fa(r)&&vu(r)&&!pu(r)?n:r||IE(t)||n}const BE=async function(t){const e=this.getOffsetParent||eg,n=this.getDimensions,r=await n(t.floating);return{reference:UE(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function zE(t){return Ht(t).direction==="rtl"}const ZE={convertOffsetParentRelativeRectToViewportRelativeRect:jE,getDocumentElement:In,getClippingRect:DE,getOffsetParent:eg,getElementRects:BE,getClientRects:AE,getDimensions:FE,getScale:pa,isElement:Zt,isRTL:zE};function HE(t,e){let n=null,r;const a=In(t);function i(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function o(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),i();const{left:l,top:u,width:d,height:h}=t.getBoundingClientRect();if(s||e(),!d||!h)return;const f=ds(u),p=ds(a.clientWidth-(l+d)),y=ds(a.clientHeight-(u+h)),v=ds(l),x={rootMargin:-f+"px "+-p+"px "+-y+"px "+-v+"px",threshold:_t(0,dn(1,c))||1};let O=!0;function I(A){const _=A[0].intersectionRatio;if(_!==c){if(!O)return o();_?o(!1,_):r=setTimeout(()=>{o(!1,1e-7)},1e3)}O=!1}try{n=new IntersectionObserver(I,{...x,root:a.ownerDocument})}catch{n=new IntersectionObserver(I,x)}n.observe(t)}return o(!0),i}Yh=function(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=yu(t),u=a||i?[...l?mi(l):[],...mi(e)]:[];u.forEach(x=>{a&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const d=l&&s?HE(l,n):null;let h=-1,f=null;o&&(f=new ResizeObserver(x=>{let[O]=x;O&&O.target===l&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var I;(I=f)==null||I.observe(e)})),n()}),l&&!c&&f.observe(l),f.observe(e));let p,y=c?Cr(t):null;c&&v();function v(){const x=Cr(t);y&&(x.x!==y.x||x.y!==y.y||x.width!==y.width||x.height!==y.height)&&n(),y=x,p=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(O=>{a&&O.removeEventListener("scroll",n),i&&O.removeEventListener("resize",n)}),d==null||d(),(x=f)==null||x.disconnect(),f=null,c&&cancelAnimationFrame(p)}};let tg;Wf=SE,Of=OE,Vf=_E,Tf=TE,tg=xE,qc=wE,kf=kE,Sf=(t,e,n)=>{const r=new Map,a={platform:ZE,...n},i={...a.platform,_c:r};return bE(t,e,{...a,platform:i})};var gs=typeof document<"u"?m.useLayoutEffect:m.useEffect;function ys(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,a;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!ys(t[r],e[r]))return!1;return!0}if(a=Object.keys(t),n=a.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,a[r]))return!1;for(r=n;r--!==0;){const i=a[r];if(!(i==="_owner"&&t.$$typeof)&&!ys(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function ng(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function rg(t,e){const n=ng(t);return Math.round(e*n)/n}function ag(t){const e=m.useRef(t);return gs(()=>{e.current=t}),e}Kh=function(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:i,floating:o}={},transform:s=!0,whileElementsMounted:c,open:l}=t,[u,d]=m.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,f]=m.useState(r);ys(h,r)||f(r);const[p,y]=m.useState(null),[v,x]=m.useState(null),O=m.useCallback(C=>{C!==U.current&&(U.current=C,y(C))},[]),I=m.useCallback(C=>{C!==Z.current&&(Z.current=C,x(C))},[]),A=i||p,_=o||v,U=m.useRef(null),Z=m.useRef(null),F=m.useRef(u),G=c!=null,re=ag(c),he=ag(a),E=m.useCallback(()=>{if(!U.current||!Z.current)return;const C={placement:e,strategy:n,middleware:h};he.current&&(C.platform=he.current),Sf(U.current,Z.current,C).then($=>{const P={...$,isPositioned:!0};R.current&&!ys(F.current,P)&&(F.current=P,W0.flushSync(()=>{d(P)}))})},[h,e,n,he]);gs(()=>{l===!1&&F.current.isPositioned&&(F.current.isPositioned=!1,d(C=>({...C,isPositioned:!1})))},[l]);const R=m.useRef(!1);gs(()=>(R.current=!0,()=>{R.current=!1}),[]),gs(()=>{if(A&&(U.current=A),_&&(Z.current=_),A&&_){if(re.current)return re.current(A,_,E);E()}},[A,_,E,re,G]);const S=m.useMemo(()=>({reference:U,floating:Z,setReference:O,setFloating:I}),[O,I]),b=m.useMemo(()=>({reference:A,floating:_}),[A,_]),z=m.useMemo(()=>{const C={position:n,left:0,top:0};if(!b.floating)return C;const $=rg(b.floating,u.x),P=rg(b.floating,u.y);return s?{...C,transform:"translate("+$+"px, "+P+"px)",...ng(b.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:$,top:P}},[n,s,b.floating,u.x,u.y]);return m.useMemo(()=>({...u,update:E,refs:S,elements:b,floatingStyles:z}),[u,E,S,b,z])};let ig;ig=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:a}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?qc({element:r.current,padding:a}).fn(n):{}:r?qc({element:r,padding:a}).fn(n):{}}}},Xh=(t,e)=>({...Wf(t),options:[t,e]}),Qh=(t,e)=>({...Of(t),options:[t,e]}),af=(t,e)=>({...kf(t),options:[t,e]}),ef=(t,e)=>({...Vf(t),options:[t,e]}),tf=(t,e)=>({...Tf(t),options:[t,e]}),rf=(t,e)=>({...tg(t),options:[t,e]}),nf=(t,e)=>({...ig(t),options:[t,e]});var GE="Arrow",og=m.forwardRef((t,e)=>{const{children:n,width:r=10,height:a=5,...i}=t;return g.jsx(Ge.svg,{...i,ref:e,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:g.jsx("polygon",{points:"0,0 30,0 15,10"})})});og.displayName=GE;var WE=og;function VE(t,e=[]){let n=[];function r(i,o){const s=m.createContext(o),c=n.length;n=[...n,o];function l(d){const{scope:h,children:f,...p}=d,y=(h==null?void 0:h[t][c])||s,v=m.useMemo(()=>p,Object.values(p));return g.jsx(y.Provider,{value:v,children:f})}function u(d,h){const f=(h==null?void 0:h[t][c])||s,p=m.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return l.displayName=i+"Provider",[l,u]}const a=()=>{const i=n.map(o=>m.createContext(o));return function(o){const s=(o==null?void 0:o[t])||i;return m.useMemo(()=>({[`__scope${t}`]:{...o,[t]:s}}),[o,s])}};return a.scopeName=t,[r,qE(a,...e)]}function qE(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const i=r.reduce((o,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...o,...l}},{});return m.useMemo(()=>({[`__scope${e.scopeName}`]:i}),[i])}};return n.scopeName=e.scopeName,n}Jh=function(t){const[e,n]=m.useState(void 0);return po(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,s;if("borderBoxSize"in i){const c=i.borderBoxSize,l=Array.isArray(c)?c[0]:c;o=l.inlineSize,s=l.blockSize}else o=t.offsetWidth,s=t.offsetHeight;n({width:o,height:s})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e};let vs,bu,sg,wu,_u;vs="Popper",[bu,ei]=VE(vs),[sg,wu]=bu(vs),_u=t=>{const{__scopePopper:e,children:n}=t,[r,a]=m.useState(null);return g.jsx(sg,{scope:e,anchor:r,onAnchorChange:a,children:n})},_u.displayName=vs;var cg="PopperAnchor",lg=m.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...a}=t,i=wu(cg,n),o=m.useRef(null),s=ot(e,o);return m.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:g.jsx(Ge.div,{...a,ref:s})});lg.displayName=cg;var xu="PopperContent",[JE,KE]=bu(xu),ug=m.forwardRef((t,e)=>{var Dn,Fn,Pe,yt,Hr,Fa;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:p,...y}=t,v=wu(xu,n),[x,O]=m.useState(null),I=ot(e,ft=>O(ft)),[A,_]=m.useState(null),U=Jh(A),Z=(U==null?void 0:U.width)??0,F=(U==null?void 0:U.height)??0,G=r+(i!=="center"?"-"+i:""),re=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},he=Array.isArray(l)?l:[l],E=he.length>0,R={padding:re,boundary:he.filter(XE),altBoundary:E},{refs:S,floatingStyles:b,placement:z,isPositioned:C,middlewareData:$}=Kh({strategy:"fixed",placement:G,whileElementsMounted:(...ft)=>Yh(...ft,{animationFrame:f==="always"}),elements:{reference:v.anchor},middleware:[Xh({mainAxis:a+F,alignmentAxis:o}),c&&Qh({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?af():void 0,...R}),c&&ef({...R}),tf({...R,apply:({elements:ft,rects:ro,availableWidth:At,availableHeight:Ua})=>{const{width:Ba,height:lr}=ro.reference,vn=ft.floating.style;vn.setProperty("--radix-popper-available-width",`${At}px`),vn.setProperty("--radix-popper-available-height",`${Ua}px`),vn.setProperty("--radix-popper-anchor-width",`${Ba}px`),vn.setProperty("--radix-popper-anchor-height",`${lr}px`)}}),A&&nf({element:A,padding:s}),QE({arrowWidth:Z,arrowHeight:F}),h&&rf({strategy:"referenceHidden",...R})]}),[P,Y]=fg(z),ae=Jr(p);po(()=>{C&&(ae==null||ae())},[C,ae]);const le=(Dn=$.arrow)==null?void 0:Dn.x,we=(Fn=$.arrow)==null?void 0:Fn.y,xe=((Pe=$.arrow)==null?void 0:Pe.centerOffset)!==0,[Be,gt]=m.useState();return po(()=>{x&&gt(window.getComputedStyle(x).zIndex)},[x]),g.jsx("div",{ref:S.setFloating,"data-radix-popper-content-wrapper":"",style:{...b,transform:C?b.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Be,"--radix-popper-transform-origin":[(yt=$.transformOrigin)==null?void 0:yt.x,(Hr=$.transformOrigin)==null?void 0:Hr.y].join(" "),...((Fa=$.hide)==null?void 0:Fa.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:g.jsx(JE,{scope:n,placedSide:P,onArrowChange:_,arrowX:le,arrowY:we,shouldHideArrow:xe,children:g.jsx(Ge.div,{"data-side":P,"data-align":Y,...y,ref:I,style:{...y.style,animation:C?void 0:"none"}})})})});ug.displayName=xu;var dg="PopperArrow",YE={top:"bottom",right:"left",bottom:"top",left:"right"},hg=m.forwardRef(function(t,e){const{__scopePopper:n,...r}=t,a=KE(dg,n),i=YE[a.placedSide];return g.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:g.jsx(WE,{...r,ref:e,style:{...r.style,display:"block"}})})});hg.displayName=dg;function XE(t){return t!==null}var QE=t=>({name:"transformOrigin",options:t,fn(e){var y,v,x;const{placement:n,rects:r,middlewareData:a}=e,i=((y=a.arrow)==null?void 0:y.centerOffset)!==0,o=i?0:t.arrowWidth,s=i?0:t.arrowHeight,[c,l]=fg(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+o/2,h=(((x=a.arrow)==null?void 0:x.y)??0)+s/2;let f="",p="";return c==="bottom"?(f=i?u:`${d}px`,p=`${-s}px`):c==="top"?(f=i?u:`${d}px`,p=`${r.floating.height+s}px`):c==="right"?(f=`${-s}px`,p=i?u:`${h}px`):c==="left"&&(f=`${r.floating.width+s}px`,p=i?u:`${h}px`),{data:{x:f,y:p}}}});function fg(t){const[e,n="center"]=t.split("-");return[e,n]}let gi,e1,yi,Eu,pg,bs,mg,ws,Su;So=_u,zc=lg,Ic=ug,Nc=hg,[gi,e1]=qa("Tooltip",[ei]),yi=ei(),Eu="TooltipProvider",pg=700,bs="tooltip.open",[mg,ws]=gi(Eu),Su=t=>{const{__scopeTooltip:e,delayDuration:n=pg,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:i}=t,[o,s]=m.useState(!0),c=m.useRef(!1),l=m.useRef(0);return m.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),g.jsx(mg,{scope:e,isOpenDelayed:o,delayDuration:n,onOpen:m.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:m.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:m.useCallback(u=>{c.current=u},[]),disableHoverableContent:a,children:i})},Su.displayName=Eu;var _s="Tooltip",[t1,vi]=gi(_s),gg=t=>{const{__scopeTooltip:e,children:n,open:r,defaultOpen:a=!1,onOpenChange:i,disableHoverableContent:o,delayDuration:s}=t,c=ws(_s,t.__scopeTooltip),l=yi(e),[u,d]=m.useState(null),h=Ft(),f=m.useRef(0),p=o??c.disableHoverableContent,y=s??c.delayDuration,v=m.useRef(!1),[x=!1,O]=Ja({prop:r,defaultProp:a,onChange:Z=>{Z?(c.onOpen(),document.dispatchEvent(new CustomEvent(bs))):c.onClose(),i==null||i(Z)}}),I=m.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),A=m.useCallback(()=>{window.clearTimeout(f.current),f.current=0,v.current=!1,O(!0)},[O]),_=m.useCallback(()=>{window.clearTimeout(f.current),f.current=0,O(!1)},[O]),U=m.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{v.current=!0,O(!0),f.current=0},y)},[y,O]);return m.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),g.jsx(So,{...l,children:g.jsx(t1,{scope:e,contentId:h,open:x,stateAttribute:I,trigger:u,onTriggerChange:d,onTriggerEnter:m.useCallback(()=>{c.isOpenDelayed?U():A()},[c.isOpenDelayed,U,A]),onTriggerLeave:m.useCallback(()=>{p?_():(window.clearTimeout(f.current),f.current=0)},[_,p]),onOpen:A,onClose:_,disableHoverableContent:p,children:n})})};gg.displayName=_s;var Ou="TooltipTrigger",yg=m.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,a=vi(Ou,n),i=ws(Ou,n),o=yi(n),s=m.useRef(null),c=ot(e,s,a.onTriggerChange),l=m.useRef(!1),u=m.useRef(!1),d=m.useCallback(()=>l.current=!1,[]);return m.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),g.jsx(zc,{asChild:!0,...o,children:g.jsx(Ge.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:c,onPointerMove:ve(t.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:ve(t.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:ve(t.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ve(t.onFocus,()=>{l.current||a.onOpen()}),onBlur:ve(t.onBlur,a.onClose),onClick:ve(t.onClick,a.onClose)})})});yg.displayName=Ou;var ku="TooltipPortal",[n1,r1]=gi(ku,{forceMount:void 0}),vg=t=>{const{__scopeTooltip:e,forceMount:n,children:r,container:a}=t,i=vi(ku,e);return g.jsx(n1,{scope:e,forceMount:n,children:g.jsx(xn,{present:n||i.open,children:g.jsx(Mh,{asChild:!0,container:a,children:r})})})};vg.displayName=ku;var ma="TooltipContent",bg=m.forwardRef((t,e)=>{const n=r1(ma,t.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...i}=t,o=vi(ma,t.__scopeTooltip);return g.jsx(xn,{present:r||o.open,children:o.disableHoverableContent?g.jsx(wg,{side:a,...i,ref:e}):g.jsx(a1,{side:a,...i,ref:e})})}),a1=m.forwardRef((t,e)=>{const n=vi(ma,t.__scopeTooltip),r=ws(ma,t.__scopeTooltip),a=m.useRef(null),i=ot(e,a),[o,s]=m.useState(null),{trigger:c,onClose:l}=n,u=a.current,{onPointerInTransitChange:d}=r,h=m.useCallback(()=>{s(null),d(!1)},[d]),f=m.useCallback((p,y)=>{const v=p.currentTarget,x={x:p.clientX,y:p.clientY},O=c1(x,v.getBoundingClientRect()),I=l1(x,O),A=u1(y.getBoundingClientRect()),_=h1([...I,...A]);s(_),d(!0)},[d]);return m.useEffect(()=>()=>h(),[h]),m.useEffect(()=>{if(c&&u){const p=v=>f(v,u),y=v=>f(v,c);return c.addEventListener("pointerleave",p),u.addEventListener("pointerleave",y),()=>{c.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",y)}}},[c,u,f,h]),m.useEffect(()=>{if(o){const p=y=>{const v=y.target,x={x:y.clientX,y:y.clientY},O=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),I=!d1(x,o);O?h():I&&(h(),l())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[c,u,o,l,h]),g.jsx(wg,{...t,ref:i})}),[i1,o1]=gi(_s,{isInside:!1}),wg=m.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...s}=t,c=vi(ma,n),l=yi(n),{onClose:u}=c;return m.useEffect(()=>(document.addEventListener(bs,u),()=>document.removeEventListener(bs,u)),[u]),m.useEffect(()=>{if(c.trigger){const d=h=>{var f;(f=h.target)!=null&&f.contains(c.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[c.trigger,u]),g.jsx(Lh,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:g.jsxs(Ic,{"data-state":c.stateAttribute,...l,...s,ref:e,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[g.jsx(V0,{children:r}),g.jsx(i1,{scope:n,isInside:!0,children:g.jsx(qN,{id:c.contentId,role:"tooltip",children:a||r})})]})})});bg.displayName=ma;var _g="TooltipArrow",s1=m.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,a=yi(n);return o1(_g,n).isInside?null:g.jsx(Nc,{...a,...r,ref:e})});s1.displayName=_g;function c1(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),a=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,a,i)){case i:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function l1(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function u1(t){const{top:e,right:n,bottom:r,left:a}=t;return[{x:a,y:e},{x:n,y:e},{x:n,y:r},{x:a,y:r}]}function d1(t,e){const{x:n,y:r}=t;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const s=e[i].x,c=e[i].y,l=e[o].x,u=e[o].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function h1(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),f1(e)}function f1(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const a=t[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))e.pop();else break}e.push(a)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const a=t[r];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))n.pop();else break}n.push(a)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}jf=Su,Af=gg,Pf=yg,hw=vg,ol=bg,Ac=jf,Qr=Af,Yr=Pf,xr=m.forwardRef(({className:t,sideOffset:e=4,...n},r)=>g.jsx(ol,{ref:r,sideOffset:e,className:se("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})),xr.displayName=ol.displayName;const p1="sidebar:state",m1=60*60*24*7,g1="16rem",y1="18rem",v1="3rem",b1="b",xg=m.createContext(null);function bi(){const t=m.useContext(xg);if(!t)throw new Error("useSidebar must be used within a SidebarProvider.");return t}El=m.forwardRef(({defaultOpen:t=!0,open:e,onOpenChange:n,className:r,style:a,children:i,...o},s)=>{const c=Ex(),[l,u]=m.useState(!1),[d,h]=m.useState(t),f=e??d,p=m.useCallback(O=>{const I=typeof O=="function"?O(f):O;n?n(I):h(I),document.cookie=`${p1}=${I}; path=/; max-age=${m1}`},[n,f]),y=m.useCallback(()=>c?u(O=>!O):p(O=>!O),[c,p,u]);m.useEffect(()=>{const O=I=>{I.key===b1&&(I.metaKey||I.ctrlKey)&&(I.preventDefault(),y())};return window.addEventListener("keydown",O),()=>window.removeEventListener("keydown",O)},[y]);const v=f?"expanded":"collapsed",x=m.useMemo(()=>({state:v,open:f,setOpen:p,isMobile:c,openMobile:l,setOpenMobile:u,toggleSidebar:y}),[v,f,p,c,l,u,y]);return g.jsx(xg.Provider,{value:x,children:g.jsx(Ac,{delayDuration:0,children:g.jsx("div",{style:{"--sidebar-width":g1,"--sidebar-width-icon":v1,...a},className:se("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:s,...o,children:i})})})}),El.displayName="SidebarProvider",_l=m.forwardRef(({side:t="left",variant:e="sidebar",collapsible:n="offcanvas",className:r,children:a,...i},o)=>{const{isMobile:s,state:c,openMobile:l,setOpenMobile:u}=bi();return n==="none"?g.jsx("div",{className:se("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:o,...i,children:a}):s?g.jsx(oE,{open:l,onOpenChange:u,...i,children:g.jsx(Fm,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":y1},side:t,children:g.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):g.jsxs("div",{ref:o,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?n:"","data-variant":e,"data-side":t,children:[g.jsx("div",{className:se("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",e==="floating"||e==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),g.jsx("div",{className:se("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",t==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",e==="floating"||e==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...i,children:g.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})}),_l.displayName="Sidebar";const Eg=m.forwardRef(({className:t,onClick:e,...n},r)=>{const{toggleSidebar:a}=bi();return g.jsx(Bn,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:se("h-7 w-7",t),onClick:i=>{e==null||e(i),a()},...n,children:g.jsx(Ce,{size:32,name:"panel-left"})})});Eg.displayName="SidebarTrigger";const Sg=m.forwardRef(({className:t,...e},n)=>{const{toggleSidebar:r}=bi();return g.jsx("button",{ref:n,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:se("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",t),...e})});Sg.displayName="SidebarRail",Sl=m.forwardRef(({className:t,...e},n)=>g.jsx("main",{ref:n,className:se("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",t),...e})),Sl.displayName="SidebarInset";const w1=m.forwardRef(({className:t,...e},n)=>g.jsx(To,{ref:n,"data-sidebar":"input",className:se("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",t),...e}));w1.displayName="SidebarInput";const _1=m.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,"data-sidebar":"header",className:se("flex flex-col gap-2 p-2",t),...e}));_1.displayName="SidebarHeader";const Og=m.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,"data-sidebar":"footer",className:se("flex flex-col gap-2 p-2",t),...e}));Og.displayName="SidebarFooter";const x1=m.forwardRef(({className:t,...e},n)=>g.jsx(Po,{ref:n,"data-sidebar":"separator",className:se("mx-2 w-auto bg-sidebar-border",t),...e}));x1.displayName="SidebarSeparator",xl=m.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,"data-sidebar":"content",className:se("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...e})),xl.displayName="SidebarContent",ai=m.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,"data-sidebar":"group",className:se("relative flex w-full min-w-0 flex-col p-2",t),...e})),ai.displayName="SidebarGroup",ri=m.forwardRef(({className:t,asChild:e=!1,...n},r)=>{const a=e?fr:"div";return g.jsx(a,{ref:r,"data-sidebar":"group-label",className:se("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",t),...n})}),ri.displayName="SidebarGroupLabel";const E1=m.forwardRef(({className:t,asChild:e=!1,...n},r)=>{const a=e?fr:"button";return g.jsx(a,{ref:r,"data-sidebar":"group-action",className:se("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",t),...n})});E1.displayName="SidebarGroupAction";const S1=m.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,"data-sidebar":"group-content",className:se("w-full text-sm",t),...e}));S1.displayName="SidebarGroupContent",aa=m.forwardRef(({className:t,...e},n)=>g.jsx("ul",{ref:n,"data-sidebar":"menu",className:se("flex w-full min-w-0 flex-col gap-1",t),...e})),aa.displayName="SidebarMenu",En=m.forwardRef(({className:t,...e},n)=>g.jsx("li",{ref:n,"data-sidebar":"menu-item",className:se("group/menu-item relative",t),...e})),En.displayName="SidebarMenuItem";let kg;kg=xc("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),Sn=m.forwardRef(({onClick:t,asChild:e=!1,isActive:n=!1,variant:r="default",size:a="default",tooltip:i,className:o,autoHide:s,...c},l)=>{const u=e?fr:"button",{isMobile:d,state:h,toggleSidebar:f}=bi(),p=g.jsx(u,{ref:l,"data-sidebar":"menu-button","data-size":a,"data-active":n,className:se(kg({variant:r,size:a}),o),onClick:s?y=>{t==null||t(y),f()}:t,...c});return i?(typeof i=="string"&&(i={children:i}),g.jsxs(Qr,{children:[g.jsx(Yr,{asChild:!0,children:p}),g.jsx(xr,{side:"right",align:"center",hidden:h!=="collapsed"||d,...i})]})):p}),Sn.displayName="SidebarMenuButton";const O1=m.forwardRef(({className:t,asChild:e=!1,showOnHover:n=!1,...r},a)=>{const i=e?fr:"button";return g.jsx(i,{ref:a,"data-sidebar":"menu-action",className:se("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",t),...r})});O1.displayName="SidebarMenuAction";const k1=m.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,"data-sidebar":"menu-badge",className:se("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",t),...e}));k1.displayName="SidebarMenuBadge";const T1=m.forwardRef(({className:t,showIcon:e=!1,...n},r)=>{const a=m.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return g.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:se("rounded-md h-8 flex gap-2 px-2 items-center",t),...n,children:[e&&g.jsx(Um,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),g.jsx(Um,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});T1.displayName="SidebarMenuSkeleton";const Tg=m.forwardRef(({className:t,...e},n)=>g.jsx("ul",{ref:n,"data-sidebar":"menu-sub",className:se("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",t),...e}));Tg.displayName="SidebarMenuSub";const Rg=m.forwardRef(({...t},e)=>g.jsx("li",{ref:e,...t}));Rg.displayName="SidebarMenuSubItem";const Ig=m.forwardRef(({asChild:t=!1,size:e="md",isActive:n,className:r,...a},i)=>{const o=t?fr:"a";return g.jsx(o,{ref:i,"data-sidebar":"menu-sub-button","data-size":e,"data-active":n,className:se("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",e==="sm"&&"text-xs",e==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...a})});Ig.displayName="SidebarMenuSubButton";let Ng,wi,Cg;Ng="hash",wi={application:"/application/:applicationId?",whiteboard:"/whiteboard/:sessionId?",document:"/document/:documentId?"},Xe=(t,e)=>{let n=wi[t];return e?n=Object.keys(e||{}).reduce((r,a)=>r.replace(`:${a}`,(e==null?void 0:e[a])||""),n):n=n.replace(/\/:[^/]+/g,""),n!=null&&n.endsWith("?")?n.slice(0,-1):n},Cg=()=>{{const[,t]=window.location.hash.split("?");return new URLSearchParams(`?${t}`)}};function R1({items:t}){const{t:e}=pr("documents");return g.jsxs(ai,{children:[g.jsx(ri,{children:g.jsx("div",{className:"text-sm",children:e("title")})}),g.jsx(aa,{children:t.map(n=>{var r;return g.jsx(wx,{asChild:!0,defaultOpen:n.isActive,className:"group/collapsible",children:g.jsxs(En,{children:[g.jsx(_x,{asChild:!0,children:g.jsxs(Sn,{className:"cursor-pointer",tooltip:e(n.title),children:[n.icon,g.jsx("span",{children:e(n.title)}),g.jsx(Ce,{name:"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),g.jsx(xx,{children:g.jsx(Tg,{children:(r=n.items)==null?void 0:r.map(a=>g.jsx(Rg,{className:"cursor-pointer",children:g.jsx(Ig,{asChild:!0,children:g.jsx(zl,{to:Xe("document",{documentId:a.id}),children:g.jsx("span",{children:e(a.title)})})})},e(a.title)))})})]})},n.title)})})]})}const I1=m.memo(({text:t,colors:e={first:"#9E7AFF",second:"#FE8BBB"},className:n,sparklesCount:r=10,...a})=>{const[i,o]=m.useState([]);return m.useEffect(()=>{const s=()=>{const d=`${Math.random()*100}%`,h=`${Math.random()*100}%`,f=Math.random()>.5?e.first:e.second,p=Math.random()*2,y=Math.random()*1+.3,v=Math.random()*10+5;return{id:`${d}-${h}-${Date.now()}`,x:d,y:h,color:f,delay:p,scale:y,lifespan:v}},c=()=>{const d=Array.from({length:r},s);o(d)},l=()=>{o(d=>d.map(h=>h.lifespan<=0?s():{...h,lifespan:h.lifespan-.1}))};c();const u=setInterval(l,100);return()=>clearInterval(u)},[e.first,e.second]),g.jsx("div",{className:se("text-6xl font-bold",n),...a,style:{"--sparkles-first-color":`${e.first}`,"--sparkles-second-color":`${e.second}`},children:g.jsxs("span",{className:"relative inline-block",children:[i.map(s=>g.jsx(N1,{...s},s.id)),g.jsx("strong",{children:t})]})})},(t,e)=>t.text===e.text),N1=({id:t,x:e,y:n,color:r,delay:a,scale:i})=>g.jsx(JN.svg,{className:"pointer-events-none absolute z-20",initial:{opacity:0,left:e,top:n},animate:{opacity:[0,1,0],scale:[0,i,0],rotate:[75,120,150]},transition:{duration:.8,repeat:1/0,delay:a},width:"21",height:"21",viewBox:"0 0 21 21",children:g.jsx("path",{d:"M9.82531 0.843845C10.0553 0.215178 10.9446 0.215178 11.1746 0.843845L11.8618 2.72026C12.4006 4.19229 12.3916 6.39157 13.5 7.5C14.6084 8.60843 16.8077 8.59935 18.2797 9.13822L20.1561 9.82534C20.7858 10.0553 20.7858 10.9447 20.1561 11.1747L18.2797 11.8618C16.8077 12.4007 14.6084 12.3916 13.5 13.5C12.3916 14.6084 12.4006 16.8077 11.8618 18.2798L11.1746 20.1562C10.9446 20.7858 10.0553 20.7858 9.82531 20.1562L9.13819 18.2798C8.59932 16.8077 8.60843 14.6084 7.5 13.5C6.39157 12.3916 4.19225 12.4007 2.72023 11.8618L0.843814 11.1747C0.215148 10.9447 0.215148 10.0553 0.843814 9.82534L2.72023 9.13822C4.19225 8.59935 6.39157 8.60843 7.5 7.5C8.60843 6.39157 8.59932 4.19229 9.13819 2.72026L9.82531 0.843845Z",fill:r})},t);function C1({className:t,onClick:e}){const{t:n}=pr("sidebar");return g.jsxs(Sn,{className:se(t,"tw-w-full"),onClick:e,children:[g.jsx(Ce,{name:"frame"}),g.jsx(I1,{text:n("new_session"),className:"text-sm",sparklesCount:3})]})}let jg,Ag,Tu;jg=()=>{const[t,e]=m.useState(!1),n=Un(a=>a.createSession),r=m.useCallback(async a=>{try{return e(!0),await n(a)}finally{e(!1)}},[n]);return{loading:t,createSession:r}},Yf=No,Ag=Co,Tu=m.forwardRef(({className:t,...e},n)=>g.jsx(na,{ref:n,className:se("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e})),Tu.displayName=na.displayName,vl=m.forwardRef(({className:t,children:e,...n},r)=>g.jsxs(Ag,{children:[g.jsx(Tu,{}),g.jsxs(ra,{ref:r,className:se("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,g.jsxs(ti,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[g.jsx(Ce,{name:"x",className:"h-4 w-4"}),g.jsx("span",{className:"sr-only",children:"Close"})]})]})]})),vl.displayName=ra.displayName,bl=({className:t,...e})=>g.jsx("div",{className:se("flex flex-col space-y-1.5 text-center sm:text-left",t),...e}),bl.displayName="DialogHeader",Oc=({className:t,...e})=>g.jsx("div",{className:se("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e}),Oc.displayName="DialogFooter",wl=m.forwardRef(({className:t,...e},n)=>g.jsx(ea,{ref:n,className:se("text-lg font-semibold leading-none tracking-tight",t),...e})),wl.displayName=ea.displayName,Sc=m.forwardRef(({className:t,...e},n)=>g.jsx(ta,{ref:n,className:se("text-sm text-muted-foreground",t),...e})),Sc.displayName=ta.displayName;var j1="Label",Pg=m.forwardRef((t,e)=>g.jsx(Ge.label,{...t,ref:e,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=t.onMouseDown)==null||r.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));Pg.displayName=j1;var $g=Pg;let Lg;Lg=xc("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ko=m.forwardRef(({className:t,...e},n)=>g.jsx($g,{ref:n,className:se(Lg(),t),...e})),ko.displayName=$g.displayName;const A1=q0(()=>{const t=mo(),{t:e}=pr("dialogs"),[n,r]=m.useState(""),{toast:a}=J0(),{loading:i,createSession:o}=jg(),s=u=>{r(u.target.value)},c=async()=>{try{const u=await o({name:n});r(""),t.resolve(u.id),t.hide()}catch(u){a({variant:"destructive",description:e("create_session.errors.create_failed")}),t.reject(u)}},l=()=>{r(""),t.resolve(void 0),t.hide()};return g.jsx(Yf,{open:t.visible,onOpenChange:l,children:g.jsxs(vl,{className:"sm:max-w-[425px]",children:[g.jsxs(bl,{children:[g.jsx(wl,{children:e("create_session.title")}),g.jsx(Sc,{children:e("create_session.description")})]}),g.jsx("div",{className:"grid gap-4 py-4",children:g.jsxs("div",{className:"flex flex-col space-y-1.5",children:[g.jsx(ko,{className:"mb-2",htmlFor:"name",children:e("create_session.name")}),g.jsx(To,{onChange:s,id:"name",value:n,placeholder:e("create_session.name_placeholder")})]})}),g.jsx(Oc,{children:g.jsx(Bn,{onClick:c,disabled:i||!n,type:"submit",children:e("create_session.create")})})]})})}),P1=()=>{const[t,e]=m.useState(!1),n=Un(a=>a.deleteSession),r=m.useCallback(async a=>{try{e(!0),await n(a),await Promise.all([tt("FlowEdge").find({select:["id"],where:{session_id:a}}).then(i=>Promise.all(i.map(o=>tt("FlowEdge").delete(o.id)))),tt("FlowNode").find({select:["id"],where:{session_id:a}}).then(i=>Promise.all(i.map(o=>tt("FlowNode").delete(o.id))))])}finally{e(!1)}},[n]);return{loading:t,deleteSession:r}};var Mg="AlertDialog",[$1,oC]=qa(Mg,[nu]),Nn=nu(),Dg=t=>{const{__scopeAlertDialog:e,...n}=t,r=Nn(e);return g.jsx(No,{...r,...n,modal:!0})};Dg.displayName=Mg;var L1="AlertDialogTrigger",M1=m.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,a=Nn(n);return g.jsx(Mm,{...a,...r,ref:e})});M1.displayName=L1;var D1="AlertDialogPortal",Fg=t=>{const{__scopeAlertDialog:e,...n}=t,r=Nn(e);return g.jsx(Co,{...r,...n})};Fg.displayName=D1;var F1="AlertDialogOverlay",Ug=m.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,a=Nn(n);return g.jsx(na,{...a,...r,ref:e})});Ug.displayName=F1;var ga="AlertDialogContent",[U1,B1]=$1(ga),Bg=m.forwardRef((t,e)=>{const{__scopeAlertDialog:n,children:r,...a}=t,i=Nn(n),o=m.useRef(null),s=ot(e,o),c=m.useRef(null);return g.jsx(Am,{contentName:ga,titleName:zg,docsSlug:"alert-dialog",children:g.jsx(U1,{scope:n,cancelRef:c,children:g.jsxs(ra,{role:"alertdialog",...i,...a,ref:s,onOpenAutoFocus:ve(a.onOpenAutoFocus,l=>{var u;l.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[g.jsx(V0,{children:r}),g.jsx(Jg,{contentRef:o})]})})})});Bg.displayName=ga;var zg="AlertDialogTitle",Zg=m.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,a=Nn(n);return g.jsx(ea,{...a,...r,ref:e})});Zg.displayName=zg;var Hg="AlertDialogDescription",Gg=m.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,a=Nn(n);return g.jsx(ta,{...a,...r,ref:e})});Gg.displayName=Hg;var z1="AlertDialogAction",Wg=m.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,a=Nn(n);return g.jsx(ti,{...a,...r,ref:e})});Wg.displayName=z1;var Vg="AlertDialogCancel",qg=m.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,{cancelRef:a}=B1(Vg,n),i=Nn(n),o=ot(e,a);return g.jsx(ti,{...i,...r,ref:o})});qg.displayName=Vg;let Jg;Jg=({contentRef:t})=>{const e=`\`${ga}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${ga}\` by passing a \`${Hg}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${ga}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return m.useEffect(()=>{var n;document.getElementById((n=t.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(e)},[e,t]),null},Jf=Dg,qf=Fg,sl=Ug,cl=Bg,dl=Wg,hl=qg,ll=Zg,ul=Gg;let Kg,Ru;Wh=Jf,Kg=qf,Ru=m.forwardRef(({className:t,...e},n)=>g.jsx(sl,{className:se("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n})),Ru.displayName=sl.displayName,Gc=m.forwardRef(({className:t,...e},n)=>g.jsxs(Kg,{children:[g.jsx(Ru,{}),g.jsx(cl,{ref:n,className:se("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e})]})),Gc.displayName=cl.displayName,il=({className:t,...e})=>g.jsx("div",{className:se("flex flex-col space-y-2 text-center sm:text-left",t),...e}),il.displayName="AlertDialogHeader",ml=({className:t,...e})=>g.jsx("div",{className:se("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e}),ml.displayName="AlertDialogFooter",fl=m.forwardRef(({className:t,...e},n)=>g.jsx(ll,{ref:n,className:se("text-lg font-semibold",t),...e})),fl.displayName=ll.displayName,pl=m.forwardRef(({className:t,...e},n)=>g.jsx(ul,{ref:n,className:se("text-sm text-muted-foreground",t),...e})),pl.displayName=ul.displayName,yl=m.forwardRef(({className:t,...e},n)=>g.jsx(dl,{ref:n,className:se(Oo(),t),...e})),yl.displayName=dl.displayName,gl=m.forwardRef(({className:t,...e},n)=>g.jsx(hl,{ref:n,className:se(Oo({variant:"outline"}),"mt-2 sm:mt-0",t),...e})),gl.displayName=hl.displayName;const Yg=q0(({id:t})=>{const{t:e}=pr("dialogs"),n=mo(),{toast:r}=J0(),{deleteSession:a,loading:i}=P1(),o=async()=>{try{await a(t),n.hide()}catch{r({variant:"destructive",description:e("delete_session.errors.delete_failed")})}};return g.jsx(Wh,{open:n.visible,onOpenChange:n.hide,children:g.jsxs(Gc,{children:[g.jsxs(il,{children:[g.jsx(fl,{children:e("delete_session.title")}),g.jsx(pl,{children:e("delete_session.description")})]}),g.jsxs(ml,{children:[g.jsx(gl,{onClick:n.hide,children:e("delete_session.cancel")}),g.jsx(yl,{disabled:i,onClick:o,children:e("delete_session.delete")})]})]})})});function Z1({sessions:t,currentSession:e,setCurrentSession:n}){const{t:r}=pr("sidebar"),a=Er(),{sessionId:i}=Go(),[o,s]=m.useState(),c=mo(A1),l=mo(Yg),u=m.useCallback(async()=>{try{const f=await c.show({});f&&typeof f=="string"&&a(Xe("whiteboard",{sessionId:f}))}catch{}},[c,a]),d=m.useCallback((f,p)=>{f.preventDefault(),f.stopPropagation(),l.show({id:p})},[l]),h=async f=>{try{s(f.id),await n(f),a(Xe("whiteboard",{sessionId:f.id}))}catch(p){Ec("Set Current Session",p),s(void 0)}};return m.useEffect(()=>{!o||o!==(e==null?void 0:e.id)||s(void 0)},[o,e==null?void 0:e.id]),g.jsxs(ai,{className:"group-data-[collapsible=icon]:hidden",children:[g.jsx(ri,{children:g.jsx("div",{className:"text-sm",children:r("sessions")})}),g.jsxs(aa,{children:[g.jsx(En,{children:g.jsx(C1,{onClick:u,className:"w-full"})}),t.map(f=>g.jsx(En,{className:"cursor-pointer",children:g.jsx(Sn,{autoHide:!0,disabled:!!o,asChild:!0,onClick:()=>h(f),children:g.jsxs("div",{className:"flex flex-row justify-between items-center",children:[g.jsxs("div",{className:"flex gap-2",children:[f.id===o?g.jsx(Ce,{size:16,name:"loader",className:"animate-spin"}):i===f.id?g.jsx(Ce,{size:16,color:"green",name:"check"}):g.jsx(Ce,{size:16,name:"chevron-right"}),g.jsx("span",{children:f.name})]}),g.jsx(Ce,{onClick:p=>d(p,f.id),size:16,name:"trash-2",className:"!z-50"})]})})},f.id)),t!=null&&t.length?g.jsx(En,{children:g.jsxs(Sn,{className:"text-sidebar-foreground/70",children:[g.jsx(Ce,{name:"ellipsis",className:"text-sidebar-foreground/70"}),g.jsx("span",{children:r("more_session")})]})}):null]})]})}var H1=m.createContext(void 0);Bc=function(t){const e=m.useContext(H1);return t||e||"ltr"};function G1(t,e=[]){let n=[];function r(i,o){const s=m.createContext(o),c=n.length;n=[...n,o];function l(d){const{scope:h,children:f,...p}=d,y=(h==null?void 0:h[t][c])||s,v=m.useMemo(()=>p,Object.values(p));return g.jsx(y.Provider,{value:v,children:f})}function u(d,h){const f=(h==null?void 0:h[t][c])||s,p=m.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return l.displayName=i+"Provider",[l,u]}const a=()=>{const i=n.map(o=>m.createContext(o));return function(o){const s=(o==null?void 0:o[t])||i;return m.useMemo(()=>({[`__scope${t}`]:{...o,[t]:s}}),[o,s])}};return a.scopeName=t,[r,W1(a,...e)]}function W1(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const i=r.reduce((o,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...o,...l}},{});return m.useMemo(()=>({[`__scope${e.scopeName}`]:i}),[i])}};return n.scopeName=e.scopeName,n}let xs,Xg,_i,Es,Iu,Qg,ey,ty,ny,Nu;xs="rovingFocusGroup.onEntryFocus",Xg={bubbles:!1,cancelable:!0},_i="RovingFocusGroup",[Es,Iu,Qg]=K0(_i),[ey,Uc]=G1(_i,[Qg]),[ty,ny]=ey(_i),Nu=m.forwardRef((t,e)=>g.jsx(Es.Provider,{scope:t.__scopeRovingFocusGroup,children:g.jsx(Es.Slot,{scope:t.__scopeRovingFocusGroup,children:g.jsx(V1,{...t,ref:e})})})),Nu.displayName=_i;var V1=m.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=t,h=m.useRef(null),f=ot(e,h),p=Bc(i),[y=null,v]=Ja({prop:o,defaultProp:s,onChange:c}),[x,O]=m.useState(!1),I=Jr(l),A=Iu(n),_=m.useRef(!1),[U,Z]=m.useState(0);return m.useEffect(()=>{const F=h.current;if(F)return F.addEventListener(xs,I),()=>F.removeEventListener(xs,I)},[I]),g.jsx(ty,{scope:n,orientation:r,dir:p,loop:a,currentTabStopId:y,onItemFocus:m.useCallback(F=>v(F),[v]),onItemShiftTab:m.useCallback(()=>O(!0),[]),onFocusableItemAdd:m.useCallback(()=>Z(F=>F+1),[]),onFocusableItemRemove:m.useCallback(()=>Z(F=>F-1),[]),children:g.jsx(Ge.div,{tabIndex:x||U===0?-1:0,"data-orientation":r,...d,ref:f,style:{outline:"none",...t.style},onMouseDown:ve(t.onMouseDown,()=>{_.current=!0}),onFocus:ve(t.onFocus,F=>{const G=!_.current;if(F.target===F.currentTarget&&G&&!x){const re=new CustomEvent(xs,Xg);if(F.currentTarget.dispatchEvent(re),!re.defaultPrevented){const he=A().filter(b=>b.focusable),E=he.find(b=>b.active),R=he.find(b=>b.id===y),S=[E,R,...he].filter(Boolean).map(b=>b.ref.current);iy(S,u)}}_.current=!1}),onBlur:ve(t.onBlur,()=>O(!1))})})}),ry="RovingFocusGroupItem",ay=m.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:i,...o}=t,s=Ft(),c=i||s,l=ny(ry,n),u=l.currentTabStopId===c,d=Iu(n),{onFocusableItemAdd:h,onFocusableItemRemove:f}=l;return m.useEffect(()=>{if(r)return h(),()=>f()},[r,h,f]),g.jsx(Es.ItemSlot,{scope:n,id:c,focusable:r,active:a,children:g.jsx(Ge.span,{tabIndex:u?0:-1,"data-orientation":l.orientation,...o,ref:e,onMouseDown:ve(t.onMouseDown,p=>{r?l.onItemFocus(c):p.preventDefault()}),onFocus:ve(t.onFocus,()=>l.onItemFocus(c)),onKeyDown:ve(t.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){l.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const y=K1(p,l.orientation,l.dir);if(y!==void 0){if(p.metaKey||p.ctrlKey||p.altKey||p.shiftKey)return;p.preventDefault();let v=d().filter(x=>x.focusable).map(x=>x.ref.current);if(y==="last")v.reverse();else if(y==="prev"||y==="next"){y==="prev"&&v.reverse();const x=v.indexOf(p.currentTarget);v=l.loop?Y1(v,x+1):v.slice(x+1)}setTimeout(()=>iy(v))}})})})});ay.displayName=ry;var q1={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function J1(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function K1(t,e,n){const r=J1(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return q1[r]}function iy(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function Y1(t,e){return t.map((n,r)=>t[(e+r)%t.length])}let Ss,oy,Cu,sy,cy,ly,ya,va,uy,dy,Kn,ba,ju,Au,Cn,hy,wa,Pu;pf=Nu,mf=ay,Ss=["Enter"," "],oy=["ArrowDown","PageUp","Home"],Cu=["ArrowUp","PageDown","End"],sy=[...oy,...Cu],cy={ltr:[...Ss,"ArrowRight"],rtl:[...Ss,"ArrowLeft"]},ly={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ya="Menu",[va,uy,dy]=K0(ya),[Kn,Wc]=qa(ya,[dy,ei,Uc]),ba=ei(),ju=Uc(),[Au,Cn]=Kn(ya),[hy,wa]=Kn(ya),Pu=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:a,onOpenChange:i,modal:o=!0}=t,s=ba(e),[c,l]=m.useState(null),u=m.useRef(!1),d=Jr(i),h=Bc(a);return m.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),g.jsx(So,{...s,children:g.jsx(Au,{scope:e,open:n,onOpenChange:d,content:c,onContentChange:l,children:g.jsx(hy,{scope:e,onClose:m.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:o,children:r})})})},Pu.displayName=ya;var X1="MenuAnchor",$u=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,a=ba(n);return g.jsx(zc,{...a,...r,ref:e})});$u.displayName=X1;var Lu="MenuPortal",[Q1,fy]=Kn(Lu,{forceMount:void 0}),py=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:a}=t,i=Cn(Lu,e);return g.jsx(Q1,{scope:e,forceMount:n,children:g.jsx(xn,{present:n||i.open,children:g.jsx(Mh,{asChild:!0,container:a,children:r})})})};py.displayName=Lu;var Ct="MenuContent",[eS,Mu]=Kn(Ct),my=m.forwardRef((t,e)=>{const n=fy(Ct,t.__scopeMenu),{forceMount:r=n.forceMount,...a}=t,i=Cn(Ct,t.__scopeMenu),o=wa(Ct,t.__scopeMenu);return g.jsx(va.Provider,{scope:t.__scopeMenu,children:g.jsx(xn,{present:r||i.open,children:g.jsx(va.Slot,{scope:t.__scopeMenu,children:o.modal?g.jsx(tS,{...a,ref:e}):g.jsx(nS,{...a,ref:e})})})})}),tS=m.forwardRef((t,e)=>{const n=Cn(Ct,t.__scopeMenu),r=m.useRef(null),a=ot(e,r);return m.useEffect(()=>{const i=r.current;if(i)return Zc(i)},[]),g.jsx(Du,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ve(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),nS=m.forwardRef((t,e)=>{const n=Cn(Ct,t.__scopeMenu);return g.jsx(Du,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Du=m.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,disableOutsideScroll:p,...y}=t,v=Cn(Ct,n),x=wa(Ct,n),O=ba(n),I=ju(n),A=uy(n),[_,U]=m.useState(null),Z=m.useRef(null),F=ot(e,Z,v.onContentChange),G=m.useRef(0),re=m.useRef(""),he=m.useRef(0),E=m.useRef(null),R=m.useRef("right"),S=m.useRef(0),b=p?Ro:m.Fragment,z=p?{as:fr,allowPinchZoom:!0}:void 0,C=P=>{var Dn,Fn;const Y=re.current+P,ae=A().filter(Pe=>!Pe.disabled),le=document.activeElement,we=(Dn=ae.find(Pe=>Pe.ref.current===le))==null?void 0:Dn.textValue,xe=ae.map(Pe=>Pe.textValue),Be=pS(xe,Y,we),gt=(Fn=ae.find(Pe=>Pe.textValue===Be))==null?void 0:Fn.ref.current;(function Pe(yt){re.current=yt,window.clearTimeout(G.current),yt!==""&&(G.current=window.setTimeout(()=>Pe(""),1e3))})(Y),gt&&setTimeout(()=>gt.focus())};m.useEffect(()=>()=>window.clearTimeout(G.current),[]),Hc();const $=m.useCallback(P=>{var Y,ae;return R.current===((Y=E.current)==null?void 0:Y.side)&&gS(P,(ae=E.current)==null?void 0:ae.area)},[]);return g.jsx(eS,{scope:n,searchRef:re,onItemEnter:m.useCallback(P=>{$(P)&&P.preventDefault()},[$]),onItemLeave:m.useCallback(P=>{var Y;$(P)||((Y=Z.current)==null||Y.focus(),U(null))},[$]),onTriggerLeave:m.useCallback(P=>{$(P)&&P.preventDefault()},[$]),pointerGraceTimerRef:he,onPointerGraceIntentChange:m.useCallback(P=>{E.current=P},[]),children:g.jsx(b,{...z,children:g.jsx(Io,{asChild:!0,trapped:a,onMountAutoFocus:ve(i,P=>{var Y;P.preventDefault(),(Y=Z.current)==null||Y.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:g.jsx(Lh,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,children:g.jsx(pf,{asChild:!0,...I,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:_,onCurrentTabStopIdChange:U,onEntryFocus:ve(c,P=>{x.isUsingKeyboardRef.current||P.preventDefault()}),preventScrollOnEntryFocus:!0,children:g.jsx(Ic,{role:"menu","aria-orientation":"vertical","data-state":Ay(v.open),"data-radix-menu-content":"",dir:x.dir,...O,...y,ref:F,style:{outline:"none",...y.style},onKeyDown:ve(y.onKeyDown,P=>{const Y=P.target.closest("[data-radix-menu-content]")===P.currentTarget,ae=P.ctrlKey||P.altKey||P.metaKey,le=P.key.length===1;Y&&(P.key==="Tab"&&P.preventDefault(),!ae&&le&&C(P.key));const we=Z.current;if(P.target!==we||!sy.includes(P.key))return;P.preventDefault();const xe=A().filter(Be=>!Be.disabled).map(Be=>Be.ref.current);Cu.includes(P.key)&&xe.reverse(),hS(xe)}),onBlur:ve(t.onBlur,P=>{P.currentTarget.contains(P.target)||(window.clearTimeout(G.current),re.current="")}),onPointerMove:ve(t.onPointerMove,Ei(P=>{const Y=P.target,ae=S.current!==P.clientX;if(P.currentTarget.contains(Y)&&ae){const le=P.clientX>S.current?"right":"left";R.current=le,S.current=P.clientX}}))})})})})})})});my.displayName=Ct;var rS="MenuGroup",Fu=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return g.jsx(Ge.div,{role:"group",...r,ref:e})});Fu.displayName=rS;var aS="MenuLabel",gy=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return g.jsx(Ge.div,{...r,ref:e})});gy.displayName=aS;var Os="MenuItem",yy="menu.itemSelect",ks=m.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...a}=t,i=m.useRef(null),o=wa(Os,t.__scopeMenu),s=Mu(Os,t.__scopeMenu),c=ot(e,i),l=m.useRef(!1),u=()=>{const d=i.current;if(!n&&d){const h=new CustomEvent(yy,{bubbles:!0,cancelable:!0});d.addEventListener(yy,f=>r==null?void 0:r(f),{once:!0}),KN(d,h),h.defaultPrevented?l.current=!1:o.onClose()}};return g.jsx(vy,{...a,ref:c,disabled:n,onClick:ve(t.onClick,u),onPointerDown:d=>{var h;(h=t.onPointerDown)==null||h.call(t,d),l.current=!0},onPointerUp:ve(t.onPointerUp,d=>{var h;l.current||((h=d.currentTarget)==null||h.click())}),onKeyDown:ve(t.onKeyDown,d=>{const h=s.searchRef.current!=="";n||h&&d.key===" "||Ss.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});ks.displayName=Os;var vy=m.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...i}=t,o=Mu(Os,n),s=ju(n),c=m.useRef(null),l=ot(e,c),[u,d]=m.useState(!1),[h,f]=m.useState("");return m.useEffect(()=>{const p=c.current;p&&f((p.textContent??"").trim())},[i.children]),g.jsx(va.ItemSlot,{scope:n,disabled:r,textValue:a??h,children:g.jsx(mf,{asChild:!0,...s,focusable:!r,children:g.jsx(Ge.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:l,onPointerMove:ve(t.onPointerMove,Ei(p=>{r?o.onItemLeave(p):(o.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ve(t.onPointerLeave,Ei(p=>o.onItemLeave(p))),onFocus:ve(t.onFocus,()=>d(!0)),onBlur:ve(t.onBlur,()=>d(!1))})})})}),iS="MenuCheckboxItem",by=m.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...a}=t;return g.jsx(Sy,{scope:t.__scopeMenu,checked:n,children:g.jsx(ks,{role:"menuitemcheckbox","aria-checked":Ts(n)?"mixed":n,...a,ref:e,"data-state":zu(n),onSelect:ve(a.onSelect,()=>r==null?void 0:r(Ts(n)?!0:!n),{checkForDefaultPrevented:!1})})})});by.displayName=iS;var wy="MenuRadioGroup",[oS,sS]=Kn(wy,{value:void 0,onValueChange:()=>{}}),_y=m.forwardRef((t,e)=>{const{value:n,onValueChange:r,...a}=t,i=Jr(r);return g.jsx(oS,{scope:t.__scopeMenu,value:n,onValueChange:i,children:g.jsx(Fu,{...a,ref:e})})});_y.displayName=wy;var xy="MenuRadioItem",Ey=m.forwardRef((t,e)=>{const{value:n,...r}=t,a=sS(xy,t.__scopeMenu),i=n===a.value;return g.jsx(Sy,{scope:t.__scopeMenu,checked:i,children:g.jsx(ks,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":zu(i),onSelect:ve(r.onSelect,()=>{var o;return(o=a.onValueChange)==null?void 0:o.call(a,n)},{checkForDefaultPrevented:!1})})})});Ey.displayName=xy;var Uu="MenuItemIndicator",[Sy,cS]=Kn(Uu,{checked:!1}),Oy=m.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...a}=t,i=cS(Uu,n);return g.jsx(xn,{present:r||Ts(i.checked)||i.checked===!0,children:g.jsx(Ge.span,{...a,ref:e,"data-state":zu(i.checked)})})});Oy.displayName=Uu;var lS="MenuSeparator",ky=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return g.jsx(Ge.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});ky.displayName=lS;var uS="MenuArrow",Ty=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,a=ba(n);return g.jsx(Nc,{...a,...r,ref:e})});Ty.displayName=uS;var Bu="MenuSub",[dS,Ry]=Kn(Bu),Iy=t=>{const{__scopeMenu:e,children:n,open:r=!1,onOpenChange:a}=t,i=Cn(Bu,e),o=ba(e),[s,c]=m.useState(null),[l,u]=m.useState(null),d=Jr(a);return m.useEffect(()=>(i.open===!1&&d(!1),()=>d(!1)),[i.open,d]),g.jsx(So,{...o,children:g.jsx(Au,{scope:e,open:r,onOpenChange:d,content:l,onContentChange:u,children:g.jsx(dS,{scope:e,contentId:Ft(),triggerId:Ft(),trigger:s,onTriggerChange:c,children:n})})})};Iy.displayName=Bu;var xi="MenuSubTrigger",Ny=m.forwardRef((t,e)=>{const n=Cn(xi,t.__scopeMenu),r=wa(xi,t.__scopeMenu),a=Ry(xi,t.__scopeMenu),i=Mu(xi,t.__scopeMenu),o=m.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:c}=i,l={__scopeMenu:t.__scopeMenu},u=m.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return m.useEffect(()=>u,[u]),m.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),c(null)}},[s,c]),g.jsx($u,{asChild:!0,...l,children:g.jsx(vy,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":Ay(n.open),...t,ref:Y0(e,a.onTriggerChange),onClick:d=>{var h;(h=t.onClick)==null||h.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ve(t.onPointerMove,Ei(d=>{i.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ve(t.onPointerLeave,Ei(d=>{var f,p;u();const h=(f=n.content)==null?void 0:f.getBoundingClientRect();if(h){const y=(p=n.content)==null?void 0:p.dataset.side,v=y==="right",x=v?-5:5,O=h[v?"left":"right"],I=h[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:O,y:h.top},{x:I,y:h.top},{x:I,y:h.bottom},{x:O,y:h.bottom}],side:y}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:ve(t.onKeyDown,d=>{var f;const h=i.searchRef.current!=="";t.disabled||h&&d.key===" "||cy[r.dir].includes(d.key)&&(n.onOpenChange(!0),(f=n.content)==null||f.focus(),d.preventDefault())})})})});Ny.displayName=xi;var Cy="MenuSubContent",jy=m.forwardRef((t,e)=>{const n=fy(Ct,t.__scopeMenu),{forceMount:r=n.forceMount,...a}=t,i=Cn(Ct,t.__scopeMenu),o=wa(Ct,t.__scopeMenu),s=Ry(Cy,t.__scopeMenu),c=m.useRef(null),l=ot(e,c);return g.jsx(va.Provider,{scope:t.__scopeMenu,children:g.jsx(xn,{present:r||i.open,children:g.jsx(va.Slot,{scope:t.__scopeMenu,children:g.jsx(Du,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:l,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;o.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ve(t.onFocusOutside,u=>{u.target!==s.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:ve(t.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:ve(t.onKeyDown,u=>{var f;const d=u.currentTarget.contains(u.target),h=ly[o.dir].includes(u.key);d&&h&&(i.onOpenChange(!1),(f=s.trigger)==null||f.focus(),u.preventDefault())})})})})})});jy.displayName=Cy;function Ay(t){return t?"open":"closed"}function Ts(t){return t==="indeterminate"}function zu(t){return Ts(t)?"indeterminate":t?"checked":"unchecked"}function hS(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function fS(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function pS(t,e,n){const r=e.length>1&&Array.from(e).every(s=>s===e[0])?e[0]:e,a=n?t.indexOf(n):-1;let i=fS(t,Math.max(a,0));r.length===1&&(i=i.filter(s=>s!==n));const o=i.find(s=>s.toLowerCase().startsWith(r.toLowerCase()));return o!==n?o:void 0}function mS(t,e){const{x:n,y:r}=t;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const s=e[i].x,c=e[i].y,l=e[o].x,u=e[o].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function gS(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return mS(n,e)}function Ei(t){return e=>e.pointerType==="mouse"?t(e):void 0}let Py,Rs,$y,yS,at,Ly,Zu,Hu;Uf=Pu,gf=$u,Bf=py,yf=my,vf=Fu,bf=gy,wf=ks,_f=by,xf=_y,Ef=Ey,$f=Oy,Lf=ky,Mf=Ty,Py=Iy,Df=Ny,Ff=jy,Rs="DropdownMenu",[$y,yS]=qa(Rs,[Wc]),at=Wc(),[Ly,Zu]=$y(Rs),Hu=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:a,defaultOpen:i,onOpenChange:o,modal:s=!0}=t,c=at(e),l=m.useRef(null),[u=!1,d]=Ja({prop:a,defaultProp:i,onChange:o});return g.jsx(Ly,{scope:e,triggerId:Ft(),triggerRef:l,contentId:Ft(),open:u,onOpenChange:d,onOpenToggle:m.useCallback(()=>d(h=>!h),[d]),modal:s,children:g.jsx(Uf,{...c,open:u,onOpenChange:d,dir:r,modal:s,children:n})})},Hu.displayName=Rs;var My="DropdownMenuTrigger",Dy=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=t,i=Zu(My,n),o=at(n);return g.jsx(gf,{asChild:!0,...o,children:g.jsx(Ge.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:Y0(e,i.triggerRef),onPointerDown:ve(t.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(i.onOpenToggle(),i.open||s.preventDefault())}),onKeyDown:ve(t.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&i.onOpenToggle(),s.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});Dy.displayName=My;var vS="DropdownMenuPortal",Fy=t=>{const{__scopeDropdownMenu:e,...n}=t,r=at(e);return g.jsx(Bf,{...r,...n})};Fy.displayName=vS;var Uy="DropdownMenuContent",By=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Zu(Uy,n),i=at(n),o=m.useRef(!1);return g.jsx(yf,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...r,ref:e,onCloseAutoFocus:ve(t.onCloseAutoFocus,s=>{var c;o.current||((c=a.triggerRef.current)==null||c.focus()),o.current=!1,s.preventDefault()}),onInteractOutside:ve(t.onInteractOutside,s=>{const c=s.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!a.modal||u)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});By.displayName=Uy;var bS="DropdownMenuGroup",zy=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx(vf,{...a,...r,ref:e})});zy.displayName=bS;var wS="DropdownMenuLabel",Zy=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx(bf,{...a,...r,ref:e})});Zy.displayName=wS;var _S="DropdownMenuItem",Hy=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx(wf,{...a,...r,ref:e})});Hy.displayName=_S;var xS="DropdownMenuCheckboxItem",Gy=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx(_f,{...a,...r,ref:e})});Gy.displayName=xS;var ES="DropdownMenuRadioGroup",Wy=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx(xf,{...a,...r,ref:e})});Wy.displayName=ES;var SS="DropdownMenuRadioItem",Vy=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx(Ef,{...a,...r,ref:e})});Vy.displayName=SS;var OS="DropdownMenuItemIndicator",qy=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx($f,{...a,...r,ref:e})});qy.displayName=OS;var kS="DropdownMenuSeparator",Jy=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx(Lf,{...a,...r,ref:e})});Jy.displayName=kS;var TS="DropdownMenuArrow",RS=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx(Mf,{...a,...r,ref:e})});RS.displayName=TS;var IS=t=>{const{__scopeDropdownMenu:e,children:n,open:r,onOpenChange:a,defaultOpen:i}=t,o=at(e),[s=!1,c]=Ja({prop:r,defaultProp:i,onChange:a});return g.jsx(Py,{...o,open:s,onOpenChange:c,children:n})},NS="DropdownMenuSubTrigger",Ky=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx(Df,{...a,...r,ref:e})});Ky.displayName=NS;var CS="DropdownMenuSubContent",Yy=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=at(n);return g.jsx(Ff,{...a,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Yy.displayName=CS,Nf=Hu,Cf=Dy,If=Fy,Jc=By,Rf=zy,nl=Zy,Xc=Hy,Qc=Gy,fw=Wy,tl=Vy,el=qy,rl=Jy,pw=IS,Kc=Ky,Yc=Yy;const jS=Nf,AS=Cf,PS=Rf,$S=m.forwardRef(({className:t,inset:e,children:n,...r},a)=>g.jsxs(Kc,{ref:a,className:se("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...r,children:[n,g.jsx(Ce,{name:"chevron-right",className:"ml-auto"})]}));$S.displayName=Kc.displayName;const LS=m.forwardRef(({className:t,...e},n)=>g.jsx(Yc,{ref:n,className:se("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));LS.displayName=Yc.displayName;const Xy=m.forwardRef(({className:t,sideOffset:e=4,...n},r)=>g.jsx(If,{children:g.jsx(Jc,{ref:r,sideOffset:e,className:se("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));Xy.displayName=Jc.displayName;const Qy=m.forwardRef(({className:t,inset:e,...n},r)=>g.jsx(Xc,{ref:r,className:se("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...n}));Qy.displayName=Xc.displayName;const MS=m.forwardRef(({className:t,children:e,checked:n,...r},a)=>g.jsxs(Qc,{ref:a,className:se("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(el,{children:g.jsx(Ce,{name:"check",className:"h-4 w-4"})})}),e]}));MS.displayName=Qc.displayName;const DS=m.forwardRef(({className:t,children:e,...n},r)=>g.jsxs(tl,{ref:r,className:se("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(el,{children:g.jsx(Ce,{name:"circle",className:"h-4 w-4"})})}),e]}));DS.displayName=tl.displayName;const FS=m.forwardRef(({className:t,inset:e,...n},r)=>g.jsx(nl,{ref:r,className:se("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));FS.displayName=nl.displayName;const US=m.forwardRef(({className:t,...e},n)=>g.jsx(rl,{ref:n,className:se("-mx-1 my-1 h-px bg-muted",t),...e}));US.displayName=rl.displayName;function BS(){const{t}=pr("sidebar"),{isMobile:e}=bi();return g.jsx(aa,{children:g.jsx(En,{children:g.jsxs(jS,{children:[g.jsx(AS,{asChild:!0,children:g.jsxs(Sn,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[g.jsx("div",{children:g.jsx(Ce,{name:"settings",size:28,className:"pr-2"})}),g.jsx(Ce,{name:"chevrons-up-down",className:"ml-auto size-4"})]})}),g.jsx(Xy,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:e?"bottom":"right",align:"end",sideOffset:4,children:g.jsx(PS,{children:g.jsxs(Qy,{children:[g.jsx(Ce,{name:"sparkles"}),t("contact")]})})})]})})})}function zS({applications:t,currentSession:e,setCurrentSession:n}){const{t:r}=pr("sidebar"),a=Er(),{applicationId:i}=Go(),[o,s]=m.useState(),c=mo(Yg),l=m.useCallback((h,f)=>{h.preventDefault(),h.stopPropagation(),c.show({id:f})},[c]),u=async h=>{try{s(h.id),n(h),a(Xe("application",{applicationId:h.id}))}catch(f){console.error(f),s(void 0)}},d=h=>{switch(h.main_source_type){case"Thread":return g.jsx(Ce,{className:"inline-flex items-center ml-2",name:"message-circle-more",size:14});default:return null}};return m.useEffect(()=>{!o||o!==(e==null?void 0:e.id)||s(void 0)},[o,e==null?void 0:e.id]),g.jsxs(ai,{className:"group-data-[collapsible=icon]:hidden pt-0",children:[g.jsx(ri,{children:g.jsx("div",{className:"text-sm",children:r("applications")})}),g.jsxs(aa,{children:[t==null?void 0:t.map(h=>g.jsx(En,{className:"cursor-pointer",children:g.jsx(Sn,{disabled:!!o,asChild:!0,autoHide:!0,onClick:()=>u(h),children:g.jsxs("div",{className:"flex flex-row justify-between items-center !h-auto",children:[g.jsxs("div",{className:"flex gap-2",children:[h.id===o?g.jsx(Ce,{size:16,name:"loader",className:"animate-spin"}):i===h.id?g.jsx(Ce,{size:16,color:"green",name:"check"}):g.jsx(Ce,{size:16,name:"chevron-right"}),g.jsxs("span",{children:[h.name,d(h)]})]}),g.jsx(Ce,{onClick:f=>l(f,h.id),size:16,className:"!z-50",name:"trash-2"})]})})},h.id)),t?g.jsx(En,{children:g.jsxs(Sn,{className:"text-sidebar-foreground/70",children:[g.jsx(Ce,{name:"ellipsis",className:"text-sidebar-foreground/70"}),g.jsx("span",{children:r("more_session")})]})}):null]})]})}const ZS={navMain:[{title:"playground.title",icon:g.jsx(Ce,{name:"square-terminal"}),isActive:!0,items:[{title:"playground.nodes",id:"nodes"},{title:"playground.connections",id:"connections"}]},{title:"model.title",url:"#",icon:g.jsx(Ce,{name:"bot"}),items:[{title:"model.llm",id:"llm"},{title:"model.embedding",id:"embedding"}]},{title:"tutorial.title",icon:g.jsx(Ce,{name:"book-open"}),items:[{title:"tutorial.get_started",id:"get-started"},{title:"tutorial.simple_workflow",id:"simple-workflow"},{title:"tutorial.ai_structured_output",id:"ai-structured-output"},{title:"tutorial.standalone_chat_application",id:"chat-application"},{title:"tutorial.standalone_editor_application",id:"editor-application"},{title:"tutorial.tool_calling",id:"tool-calling"},{title:"tutorial.vector_database",id:"vector-database"}]},{title:"application.title",icon:g.jsx(Ce,{name:"settings-2"}),items:[{title:"application.chat",id:"chat"},{title:"application.editor",id:"editor"},{title:"application.vslite",id:"vslite"}]}]};function HS({sessions:t,applications:e,currentSession:n,setCurrentSession:r,...a}){return g.jsxs(_l,{collapsible:"offcanvas",...a,children:[g.jsx("div",{className:"h-1"}),g.jsxs(xl,{children:[g.jsx(Z1,{sessions:t||[],currentSession:n,setCurrentSession:r}),g.jsx(zS,{applications:e||[],currentSession:n,setCurrentSession:r}),g.jsx(R1,{items:ZS.navMain})]}),g.jsx(Og,{children:g.jsx(BS,{})}),g.jsx(Sg,{})]})}Uh=m.memo(t=>{const{loading:e,...n}=t;return g.jsx(Bn,{...n,disabled:t.disabled||e,children:e?g.jsx(Ce,{name:"loader-circle",className:"animate-spin"}):t.children})});function GS({className:t,onProcess:e=async()=>(await new Promise(a=>setTimeout(a,2e3)),Math.random()>.5),processDuration:n=2e3,...r}){const[a,i]=m.useState(!1),[o,s]=m.useState(null),[c,l]=m.useState(!1),[,u]=m.useState(0);m.useEffect(()=>{if(a){const h=Date.now(),f=setInterval(()=>{const p=(Date.now()-h)/n*100;p>=100?(clearInterval(f),u(100)):u(p)},10);return()=>clearInterval(f)}},[a,n]);async function d(){if(a)return;i(!0),s(null),u(0),await new Promise(f=>setTimeout(f,n));const h=e?await e():!0;s(h),i(!1),l(!0),setTimeout(()=>{s(null),u(0),l(!1)},2e3)}return g.jsx(Bn,{className:se("relative group","transition-all duration-300",a&&"cursor-wait",t),variant:"ghost",onClick:d,disabled:a,...r,children:g.jsx("div",{className:se("w-full flex items-center justify-center gap-2",c&&"animate-[scale_300ms_ease-in-out]"),children:o===null?g.jsx(g.Fragment,{children:g.jsx(Ce,{name:"forward",className:se("w-4 h-4 transition-transform duration-200","group-hover:scale-110",a&&"animate-bounce")})}):o?g.jsx(g.Fragment,{children:g.jsx(Ce,{name:"check",className:"w-4 h-4 text-green-500"})}):g.jsx(g.Fragment,{children:g.jsx(Ce,{name:"x",className:"w-4 h-4 text-red-500"})})})})}const fn="NOLLM",WS="0123456789abcdef",VS=[8,4,4,4,12];al=function(){return VS.map(t=>YN(WS,t)()).join("-")};const qS=()=>{const t=Un(e=>e.currentSession);return{exportSession:m.useCallback(async()=>{if(!(t!=null&&t.id))return;const e={},n={},r=Object.keys(X0).filter(c=>c!=="Session");await Promise.all(r.map(c=>tt(c).find({where:{session_id:t.id}}).then(l=>{l.map(u=>{n[u.id]=u.id}),e[c]=l}))),Object.keys(n).forEach(c=>{n[c]=`[ID_${al()}]`});let a=JSON.stringify({[fn]:{key:t.id,session:Object.entries(t).reduce((c,[l,u])=>((typeof u!="object"||u===null)&&(c[l]=u),u===void 0&&(c[l]=null),c),{}),ids:Object.keys(n)},...e});Object.keys(n).forEach(c=>{a=a.replace(new RegExp(c,"g"),n[c])}),a=a.replace(new RegExp(t.id,"g"),"[SESSION_ID]");const i=new Blob([a],{type:"application/json"}),o=URL.createObjectURL(i),s=document.createElement("a");s.href=o,s.download=`${t.name}_${new Date}.json`,s.click()},[t])}},JS=()=>{const[t,e]=m.useState(!1),n=Er(),r=m.useCallback((i,{idMap:o,newSessionId:s,replaceItem:c})=>{const l=i;return{...Object.keys(l).reduce((u,d)=>(l[d]&&typeof l[d]=="string"&&o[l[d]]?u[d]=o[l[d]]:d==="session_id"&&s?u[d]=s:u[d]=l[d],u),{}),...c||{}}},[]),a=m.useCallback(async i=>{try{e(!0);const o=Object.keys(X0).filter(d=>d!==fn);if(!Object.keys(i[fn]).length||typeof i[fn]!="object")throw new Error("Missing Metadata");if(!("session"in i[fn])||!i[fn].session)throw new Error("Missing Session Metadata");const s=i[fn].session;if(!("ids"in i[fn]))throw new Error("Missing Session ID");const c=i[fn].ids.reduce((d,h)=>(d[h]=al(),d),{}),l=Object.keys(i).filter(d=>d!==fn);if(!l.every(d=>o.includes(d)))throw new Error("Invalid JSON keys");if(!l.every(d=>Array.isArray(i[d])))throw new Error("Invalid JSON values");l.forEach(d=>{i[d].forEach(h=>{if("session_id"in h&&h.session_id!=="[SESSION_ID]")throw new Error("Invalid JSON values")})});const u=await tt("Session").save(r(s,{idMap:c,newSessionId:"",replaceItem:{id:void 0}}));if(!u)throw new Error("Failed to import session");await Promise.all(o.map(d=>{const h=i[d];if(!h||!h.length)return Promise.resolve();const f=h.map(p=>r(p,{idMap:c,newSessionId:u.id}));return tt(d).save(f)})),u.type===Kr.Whiteboard?n(Xe("whiteboard",{sessionId:u.id})):u.type===Kr.StandaloneApp&&n(Xe("application",{applicationId:u.id}))}finally{e(!1)}},[n,r]);return{loading:t,importSession:a}};function KS(){const{t}=pr("tooltips"),e=un(),n=Q0(h=>h.setTheme),r=Q0(h=>h.theme),{exportSession:a}=qS(),{loading:i,importSession:o}=JS(),s=m.useRef(null),c=m.useCallback(()=>{n(r==="dark"?"light":"dark")},[r,n]),l=m.useCallback(async()=>{try{return await a(),!0}catch(h){return Ec("Export Session",h),!1}},[a]),u=m.useCallback(async h=>{var f;try{const p=(f=h.target.files)==null?void 0:f[0];if(!p)return;const y=await new Promise((v,x)=>{const O=new FileReader;O.onload=I=>{var A;try{const _=(A=I.target)==null?void 0:A.result;v(JSON.parse(_))}catch(_){x(_)}},O.onerror=I=>{x(I)},O.readAsText(p)});await o(y)}catch(p){return Ec("Import Session",p),!1}},[o]),d=m.useMemo(()=>{if(e.pathname.includes(Xe("whiteboard")))return t("whiteboard");if(e.pathname.includes(Xe("application")))return t("apllication")},[e.pathname,t]);return g.jsxs("header",{className:"flex h-14 shrink-0 items-center gap-2 transition-[width,height] ease-linear justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2 px-4",children:[g.jsx(Eg,{}),g.jsx(ko,{children:d})]}),g.jsx("div",{className:"flex items-center pl-4 pr-2",children:g.jsxs(Ac,{children:[g.jsxs(Qr,{children:[g.jsx(Yr,{children:g.jsxs(Uh,{loading:i,variant:"ghost",onClick:()=>{var h;return(h=s.current)==null?void 0:h.click()},children:[g.jsx(Ce,{size:18,name:"import"}),g.jsx("input",{ref:s,type:"file",accept:".json",onChange:u,className:"hidden"},`${Date.now()}`)]})}),g.jsx(xr,{children:g.jsx("p",{children:t("import")})})]}),g.jsxs(Qr,{children:[g.jsx(Yr,{children:g.jsx(GS,{onProcess:l})}),g.jsx(xr,{children:g.jsx("p",{children:t("export")})})]}),g.jsxs(Qr,{children:[g.jsx(Yr,{children:g.jsx(Bn,{disabled:i,onClick:c,variant:"ghost",children:g.jsx(Ce,{size:18,name:r==="dark"?"moon":"sun"})})}),g.jsx(xr,{children:g.jsx("p",{children:t("theme")})})]}),g.jsxs(Qr,{children:[g.jsx(Yr,{children:g.jsx(Bn,{variant:"link",children:g.jsx("a",{referrerPolicy:"no-referrer",target:"_blank",href:"https://github.com/zrg-team/NoLLMChat",children:g.jsx(Ce,{size:18,name:"github"})})})}),g.jsx(xr,{children:g.jsx("p",{children:"https://github.com/zrg-team/NoLLMChat"})})]})]})})]})}function ev({requiredSession:t}){const e=Go(),n=Er(),r=un(),a=m.useRef(r),i=Un(u=>u.currentSession),o=Un(u=>u.sessions),s=Un(u=>u.applications),c=Un(u=>u.setCurrentSession),l=Un(u=>u.setToDefaultSession);return a.current=r,m.useEffect(()=>{!(i!=null&&i.id)||!t||(r.pathname.includes(Xe("whiteboard"))?e.sessionId?e.sessionId&&e.sessionId!==(i==null?void 0:i.id)&&c(e.sessionId):n(Xe("whiteboard",{sessionId:i==null?void 0:i.id})):r.pathname.includes(Xe("application"))&&(e.applicationId?e.applicationId&&e.applicationId!==(i==null?void 0:i.id)&&c(e.applicationId):n(Xe("application",{applicationId:i==null?void 0:i.id}))))},[i==null?void 0:i.id,r.pathname,n,e.applicationId,e.sessionId,t,c]),m.useEffect(()=>{t&&c(e.sessionId||e.applicationId).then(u=>{if(!u)return l(r.pathname.includes(Xe("whiteboard"))?Kr.Whiteboard:Kr.StandaloneApp);Cg().has("flow")&&u.type===Kr.StandaloneApp||(u.type===Kr.StandaloneApp&&a.current.pathname.includes(Xe("whiteboard").replace("/",""))?n(Xe("application",{applicationId:u.id})):u.type===Kr.Whiteboard&&a.current.pathname.includes(Xe("application").replace("/",""))&&n(Xe("whiteboard",{sessionId:u.id})))})},[n,e.applicationId,e.sessionId,t,c,l]),g.jsxs(El,{defaultOpen:!1,children:[g.jsx(HS,{sessions:o,applications:s,currentSession:i,setCurrentSession:c}),g.jsxs(Sl,{className:"max-h-screen overflow-hidden",children:[g.jsx(KS,{}),g.jsx(Po,{className:"shrink-0"}),g.jsx("div",{className:"flex flex-1 flex-col p-0 m-0 overflow-y-auto",children:g.jsx(A_,{})})]})]})}br=class{constructor(t){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=t.pageContent!==void 0?t.pageContent.toString():"",this.metadata=t.metadata??{},this.id=t.id}};var Ie;(function(t){t.assertEqual=a=>a;function e(a){}t.assertIs=e;function n(a){throw new Error}t.assertNever=n,t.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},t.getValidEnumValues=a=>{const i=t.objectKeys(a).filter(s=>typeof a[a[s]]!="number"),o={};for(const s of i)o[s]=a[s];return t.objectValues(o)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},t.find=(a,i)=>{for(const o of a)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Ie||(Ie={}));var Gu;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Gu||(Gu={}));const ne=Ie.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Yn=t=>{switch(typeof t){case"undefined":return ne.undefined;case"string":return ne.string;case"number":return isNaN(t)?ne.nan:ne.number;case"boolean":return ne.boolean;case"function":return ne.function;case"bigint":return ne.bigint;case"symbol":return ne.symbol;case"object":return Array.isArray(t)?ne.array:t===null?ne.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ne.promise:typeof Map<"u"&&t instanceof Map?ne.map:typeof Set<"u"&&t instanceof Set?ne.set:typeof Date<"u"&&t instanceof Date?ne.date:ne.object;default:return ne.unknown}},q=Ie.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),YS=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Et extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let s=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(s[l]=s[l]||{_errors:[]},s[l]._errors.push(n(o))):s[l]=s[l]||{_errors:[]},s=s[l],c++}}};return a(this),r}static assert(e){if(!(e instanceof Et))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ie.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const a of this.issues)a.path.length>0?(n[a.path[0]]=n[a.path[0]]||[],n[a.path[0]].push(e(a))):r.push(e(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Et.create=t=>new Et(t);const _a=(t,e)=>{let n;switch(t.code){case q.invalid_type:t.received===ne.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case q.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Ie.jsonStringifyReplacer)}`;break;case q.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ie.joinValues(t.keys,", ")}`;break;case q.invalid_union:n="Invalid input";break;case q.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ie.joinValues(t.options)}`;break;case q.invalid_enum_value:n=`Invalid enum value. Expected ${Ie.joinValues(t.options)}, received '${t.received}'`;break;case q.invalid_arguments:n="Invalid function arguments";break;case q.invalid_return_type:n="Invalid function return type";break;case q.invalid_date:n="Invalid date";break;case q.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Ie.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case q.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case q.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case q.custom:n="Invalid input";break;case q.invalid_intersection_types:n="Intersection results could not be merged";break;case q.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case q.not_finite:n="Number must be finite";break;default:n=e.defaultError,Ie.assertNever(t)}return{message:n}};let tv=_a;function XS(t){tv=t}function Is(){return tv}const Ns=t=>{const{data:e,path:n,errorMaps:r,issueData:a}=t,i=[...n,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let s="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)s=l(o,{data:e,defaultError:s}).message;return{...a,path:i,message:s}},QS=[];function te(t,e){const n=Is(),r=Ns({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===_a?void 0:_a].filter(a=>!!a)});t.common.issues.push(r)}class st{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const a of n){if(a.status==="aborted")return me;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const a of n){const i=await a.key,o=await a.value;r.push({key:i,value:o})}return st.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const a of n){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return me;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const me=Object.freeze({status:"aborted"}),Cs=t=>({status:"dirty",value:t}),lt=t=>({status:"valid",value:t}),Wu=t=>t.status==="aborted",Vu=t=>t.status==="dirty",Si=t=>t.status==="valid",Oi=t=>typeof Promise<"u"&&t instanceof Promise;function js(t,e,n,r){if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function nv(t,e,n,r,a){if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var ue;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ue||(ue={}));var ki,Ti;class pn{constructor(e,n,r,a){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const rv=(t,e)=>{if(Si(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Et(t.common.issues);return this._error=n,this._error}}};function be(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:a}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(i,o)=>{var s,c;const{message:l}=t;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:(s=l??r)!==null&&s!==void 0?s:o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:(c=l??n)!==null&&c!==void 0?c:o.defaultError}},description:a}}class _e{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Yn(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Yn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new st,ctx:{common:e.parent.common,data:e.data,parsedType:Yn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Oi(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const a={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Yn(e)},i=this._parseSync({data:e,path:a.path,parent:a});return rv(a,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Yn(e)},a=this._parse({data:e,path:r.path,parent:r}),i=await(Oi(a)?a:Promise.resolve(a));return rv(r,i)}refine(e,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,i)=>{const o=e(a),s=()=>i.addIssue({code:q.custom,...r(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(s(),!1)):o?!0:(s(),!1)})}refinement(e,n){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(e){return new Vt({schema:this,typeName:K.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Dt.create(this,this._def)}nullable(){return nr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Wt.create(this,this._def)}promise(){return Oa.create(this,this._def)}or(e){return Ci.create([this,e],this._def)}and(e){return ji.create(this,e,this._def)}transform(e){return new Vt({...be(this._def),schema:this,typeName:K.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Mi({...be(this._def),innerType:this,defaultValue:n,typeName:K.ZodDefault})}brand(){return new Ku({typeName:K.ZodBranded,type:this,...be(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Di({...be(this._def),innerType:this,catchValue:n,typeName:K.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Fi.create(this,e)}readonly(){return Ui.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const eO=/^c[^\s-]{8,}$/i,tO=/^[0-9a-z]+$/,nO=/^[0-9A-HJKMNP-TV-Z]{26}$/,rO=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,aO=/^[a-z0-9_-]{21}$/i,iO=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,oO=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,sO="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let qu;const cO=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,lO=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,uO=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,av="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dO=new RegExp(`^${av}$`);function iv(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function hO(t){return new RegExp(`^${iv(t)}$`)}function ov(t){let e=`${av}T${iv(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function fO(t,e){return!!((e==="v4"||!e)&&cO.test(t)||(e==="v6"||!e)&&lO.test(t))}class Gt extends _e{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ne.string){const a=this._getOrReturnCtx(e);return te(a,{code:q.invalid_type,expected:ne.string,received:a.parsedType}),me}const n=new st;let r;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(r=this._getOrReturnCtx(e,r),te(r,{code:q.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(r=this._getOrReturnCtx(e,r),te(r,{code:q.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){const i=e.data.length>a.value,o=e.data.length<a.value;(i||o)&&(r=this._getOrReturnCtx(e,r),i?te(r,{code:q.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&te(r,{code:q.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")oO.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"email",code:q.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")qu||(qu=new RegExp(sO,"u")),qu.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"emoji",code:q.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")rO.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"uuid",code:q.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")aO.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"nanoid",code:q.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")eO.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"cuid",code:q.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")tO.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"cuid2",code:q.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")nO.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"ulid",code:q.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),te(r,{validation:"url",code:q.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"regex",code:q.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(r=this._getOrReturnCtx(e,r),te(r,{code:q.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(r=this._getOrReturnCtx(e,r),te(r,{code:q.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(r=this._getOrReturnCtx(e,r),te(r,{code:q.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?ov(a).test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{code:q.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?dO.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{code:q.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?hO(a).test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{code:q.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?iO.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"duration",code:q.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?fO(e.data,a.version)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"ip",code:q.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?uO.test(e.data)||(r=this._getOrReturnCtx(e,r),te(r,{validation:"base64",code:q.invalid_string,message:a.message}),n.dirty()):Ie.assertNever(a);return{status:n.value,value:e.data}}_regex(e,n,r){return this.refinement(a=>e.test(a),{validation:n,code:q.invalid_string,...ue.errToObj(r)})}_addCheck(e){return new Gt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ue.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ue.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ue.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ue.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ue.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ue.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ue.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ue.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ue.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ue.errToObj(e)})}datetime(e){var n,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...ue.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ue.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ue.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...ue.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...ue.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...ue.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...ue.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...ue.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...ue.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...ue.errToObj(n)})}nonempty(e){return this.min(1,ue.errToObj(e))}trim(){return new Gt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Gt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Gt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Gt.create=t=>{var e;return new Gt({checks:[],typeName:K.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...be(t)})};function pO(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=n>r?n:r,i=parseInt(t.toFixed(a).replace(".","")),o=parseInt(e.toFixed(a).replace(".",""));return i%o/Math.pow(10,a)}class Xn extends _e{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ne.number){const a=this._getOrReturnCtx(e);return te(a,{code:q.invalid_type,expected:ne.number,received:a.parsedType}),me}let n;const r=new st;for(const a of this._def.checks)a.kind==="int"?Ie.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),te(n,{code:q.invalid_type,expected:"integer",received:"float",message:a.message}),r.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),te(n,{code:q.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),te(n,{code:q.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="multipleOf"?pO(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),te(n,{code:q.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),te(n,{code:q.not_finite,message:a.message}),r.dirty()):Ie.assertNever(a);return{status:r.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ue.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ue.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ue.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ue.toString(n))}setLimit(e,n,r,a){return new Xn({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ue.toString(a)}]})}_addCheck(e){return new Xn({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ue.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ue.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ue.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ue.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ue.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ue.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:ue.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ue.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ue.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ie.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Xn.create=t=>new Xn({checks:[],typeName:K.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...be(t)});class Qn extends _e{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ne.bigint){const a=this._getOrReturnCtx(e);return te(a,{code:q.invalid_type,expected:ne.bigint,received:a.parsedType}),me}let n;const r=new st;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),te(n,{code:q.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),te(n,{code:q.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),te(n,{code:q.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):Ie.assertNever(a);return{status:r.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ue.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ue.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ue.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ue.toString(n))}setLimit(e,n,r,a){return new Qn({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ue.toString(a)}]})}_addCheck(e){return new Qn({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ue.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ue.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ue.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ue.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ue.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Qn.create=t=>{var e;return new Qn({checks:[],typeName:K.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...be(t)})};class Ri extends _e{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ne.boolean){const n=this._getOrReturnCtx(e);return te(n,{code:q.invalid_type,expected:ne.boolean,received:n.parsedType}),me}return lt(e.data)}}Ri.create=t=>new Ri({typeName:K.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...be(t)});class jr extends _e{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ne.date){const a=this._getOrReturnCtx(e);return te(a,{code:q.invalid_type,expected:ne.date,received:a.parsedType}),me}if(isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return te(a,{code:q.invalid_date}),me}const n=new st;let r;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(r=this._getOrReturnCtx(e,r),te(r,{code:q.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(r=this._getOrReturnCtx(e,r),te(r,{code:q.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):Ie.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new jr({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:ue.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:ue.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}jr.create=t=>new jr({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:K.ZodDate,...be(t)});class As extends _e{_parse(e){if(this._getType(e)!==ne.symbol){const n=this._getOrReturnCtx(e);return te(n,{code:q.invalid_type,expected:ne.symbol,received:n.parsedType}),me}return lt(e.data)}}As.create=t=>new As({typeName:K.ZodSymbol,...be(t)});class Ii extends _e{_parse(e){if(this._getType(e)!==ne.undefined){const n=this._getOrReturnCtx(e);return te(n,{code:q.invalid_type,expected:ne.undefined,received:n.parsedType}),me}return lt(e.data)}}Ii.create=t=>new Ii({typeName:K.ZodUndefined,...be(t)});class Ni extends _e{_parse(e){if(this._getType(e)!==ne.null){const n=this._getOrReturnCtx(e);return te(n,{code:q.invalid_type,expected:ne.null,received:n.parsedType}),me}return lt(e.data)}}Ni.create=t=>new Ni({typeName:K.ZodNull,...be(t)});class xa extends _e{constructor(){super(...arguments),this._any=!0}_parse(e){return lt(e.data)}}xa.create=t=>new xa({typeName:K.ZodAny,...be(t)});class Ar extends _e{constructor(){super(...arguments),this._unknown=!0}_parse(e){return lt(e.data)}}Ar.create=t=>new Ar({typeName:K.ZodUnknown,...be(t)});class jn extends _e{_parse(e){const n=this._getOrReturnCtx(e);return te(n,{code:q.invalid_type,expected:ne.never,received:n.parsedType}),me}}jn.create=t=>new jn({typeName:K.ZodNever,...be(t)});class Ps extends _e{_parse(e){if(this._getType(e)!==ne.undefined){const n=this._getOrReturnCtx(e);return te(n,{code:q.invalid_type,expected:ne.void,received:n.parsedType}),me}return lt(e.data)}}Ps.create=t=>new Ps({typeName:K.ZodVoid,...be(t)});class Wt extends _e{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),a=this._def;if(n.parsedType!==ne.array)return te(n,{code:q.invalid_type,expected:ne.array,received:n.parsedType}),me;if(a.exactLength!==null){const o=n.data.length>a.exactLength.value,s=n.data.length<a.exactLength.value;(o||s)&&(te(n,{code:o?q.too_big:q.too_small,minimum:s?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(te(n,{code:q.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(te(n,{code:q.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,s)=>a.type._parseAsync(new pn(n,o,n.path,s)))).then(o=>st.mergeArray(r,o));const i=[...n.data].map((o,s)=>a.type._parseSync(new pn(n,o,n.path,s)));return st.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Wt({...this._def,minLength:{value:e,message:ue.toString(n)}})}max(e,n){return new Wt({...this._def,maxLength:{value:e,message:ue.toString(n)}})}length(e,n){return new Wt({...this._def,exactLength:{value:e,message:ue.toString(n)}})}nonempty(e){return this.min(1,e)}}Wt.create=(t,e)=>new Wt({type:t,minLength:null,maxLength:null,exactLength:null,typeName:K.ZodArray,...be(e)});function Ea(t){if(t instanceof Ze){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Dt.create(Ea(r))}return new Ze({...t._def,shape:()=>e})}else return t instanceof Wt?new Wt({...t._def,type:Ea(t.element)}):t instanceof Dt?Dt.create(Ea(t.unwrap())):t instanceof nr?nr.create(Ea(t.unwrap())):t instanceof mn?mn.create(t.items.map(e=>Ea(e))):t}class Ze extends _e{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Ie.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==ne.object){const c=this._getOrReturnCtx(e);return te(c,{code:q.invalid_type,expected:ne.object,received:c.parsedType}),me}const{status:n,ctx:r}=this._processInputParams(e),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof jn&&this._def.unknownKeys==="strip"))for(const c in r.data)i.includes(c)||o.push(c);const s=[];for(const c of i){const l=a[c],u=r.data[c];s.push({key:{status:"valid",value:c},value:l._parse(new pn(r,u,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof jn){const c=this._def.unknownKeys;if(c==="passthrough")for(const l of o)s.push({key:{status:"valid",value:l},value:{status:"valid",value:r.data[l]}});else if(c==="strict")o.length>0&&(te(r,{code:q.unrecognized_keys,keys:o}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const l of o){const u=r.data[l];s.push({key:{status:"valid",value:l},value:c._parse(new pn(r,u,r.path,l)),alwaysSet:l in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const c=[];for(const l of s){const u=await l.key,d=await l.value;c.push({key:u,value:d,alwaysSet:l.alwaysSet})}return c}).then(c=>st.mergeObjectSync(n,c)):st.mergeObjectSync(n,s)}get shape(){return this._def.shape()}strict(e){return ue.errToObj,new Ze({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var a,i,o,s;const c=(o=(i=(a=this._def).errorMap)===null||i===void 0?void 0:i.call(a,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(s=ue.errToObj(e).message)!==null&&s!==void 0?s:c}:{message:c}}}:{}})}strip(){return new Ze({...this._def,unknownKeys:"strip"})}passthrough(){return new Ze({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ze({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ze({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:K.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Ze({...this._def,catchall:e})}pick(e){const n={};return Ie.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Ze({...this._def,shape:()=>n})}omit(e){const n={};return Ie.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new Ze({...this._def,shape:()=>n})}deepPartial(){return Ea(this)}partial(e){const n={};return Ie.objectKeys(this.shape).forEach(r=>{const a=this.shape[r];e&&!e[r]?n[r]=a:n[r]=a.optional()}),new Ze({...this._def,shape:()=>n})}required(e){const n={};return Ie.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Dt;)a=a._def.innerType;n[r]=a}}),new Ze({...this._def,shape:()=>n})}keyof(){return sv(Ie.objectKeys(this.shape))}}Ze.create=(t,e)=>new Ze({shape:()=>t,unknownKeys:"strip",catchall:jn.create(),typeName:K.ZodObject,...be(e)}),Ze.strictCreate=(t,e)=>new Ze({shape:()=>t,unknownKeys:"strict",catchall:jn.create(),typeName:K.ZodObject,...be(e)}),Ze.lazycreate=(t,e)=>new Ze({shape:t,unknownKeys:"strip",catchall:jn.create(),typeName:K.ZodObject,...be(e)});class Ci extends _e{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function a(i){for(const s of i)if(s.result.status==="valid")return s.result;for(const s of i)if(s.result.status==="dirty")return n.common.issues.push(...s.ctx.common.issues),s.result;const o=i.map(s=>new Et(s.ctx.common.issues));return te(n,{code:q.invalid_union,unionErrors:o}),me}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const c of r){const l={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const s=o.map(c=>new Et(c));return te(n,{code:q.invalid_union,unionErrors:s}),me}}get options(){return this._def.options}}Ci.create=(t,e)=>new Ci({options:t,typeName:K.ZodUnion,...be(e)});const er=t=>t instanceof Pi?er(t.schema):t instanceof Vt?er(t.innerType()):t instanceof $i?[t.value]:t instanceof tr?t.options:t instanceof Li?Ie.objectValues(t.enum):t instanceof Mi?er(t._def.innerType):t instanceof Ii?[void 0]:t instanceof Ni?[null]:t instanceof Dt?[void 0,...er(t.unwrap())]:t instanceof nr?[null,...er(t.unwrap())]:t instanceof Ku||t instanceof Ui?er(t.unwrap()):t instanceof Di?er(t._def.innerType):[];class $s extends _e{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ne.object)return te(n,{code:q.invalid_type,expected:ne.object,received:n.parsedType}),me;const r=this.discriminator,a=n.data[r],i=this.optionsMap.get(a);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(te(n,{code:q.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),me)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const a=new Map;for(const i of n){const o=er(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const s of o){if(a.has(s))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);a.set(s,i)}}return new $s({typeName:K.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:a,...be(r)})}}function Ju(t,e){const n=Yn(t),r=Yn(e);if(t===e)return{valid:!0,data:t};if(n===ne.object&&r===ne.object){const a=Ie.objectKeys(e),i=Ie.objectKeys(t).filter(s=>a.indexOf(s)!==-1),o={...t,...e};for(const s of i){const c=Ju(t[s],e[s]);if(!c.valid)return{valid:!1};o[s]=c.data}return{valid:!0,data:o}}else if(n===ne.array&&r===ne.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<t.length;i++){const o=t[i],s=e[i],c=Ju(o,s);if(!c.valid)return{valid:!1};a.push(c.data)}return{valid:!0,data:a}}else return n===ne.date&&r===ne.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class ji extends _e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=(i,o)=>{if(Wu(i)||Wu(o))return me;const s=Ju(i.value,o.value);return s.valid?((Vu(i)||Vu(o))&&n.dirty(),{status:n.value,value:s.data}):(te(r,{code:q.invalid_intersection_types}),me)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ji.create=(t,e,n)=>new ji({left:t,right:e,typeName:K.ZodIntersection,...be(n)});class mn extends _e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ne.array)return te(r,{code:q.invalid_type,expected:ne.array,received:r.parsedType}),me;if(r.data.length<this._def.items.length)return te(r,{code:q.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),me;!this._def.rest&&r.data.length>this._def.items.length&&(te(r,{code:q.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((i,o)=>{const s=this._def.items[o]||this._def.rest;return s?s._parse(new pn(r,i,r.path,o)):null}).filter(i=>!!i);return r.common.async?Promise.all(a).then(i=>st.mergeArray(n,i)):st.mergeArray(n,a)}get items(){return this._def.items}rest(e){return new mn({...this._def,rest:e})}}mn.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new mn({items:t,typeName:K.ZodTuple,rest:null,...be(e)})};class Ai extends _e{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ne.object)return te(r,{code:q.invalid_type,expected:ne.object,received:r.parsedType}),me;const a=[],i=this._def.keyType,o=this._def.valueType;for(const s in r.data)a.push({key:i._parse(new pn(r,s,r.path,s)),value:o._parse(new pn(r,r.data[s],r.path,s)),alwaysSet:s in r.data});return r.common.async?st.mergeObjectAsync(n,a):st.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof _e?new Ai({keyType:e,valueType:n,typeName:K.ZodRecord,...be(r)}):new Ai({keyType:Gt.create(),valueType:e,typeName:K.ZodRecord,...be(n)})}}class Ls extends _e{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ne.map)return te(r,{code:q.invalid_type,expected:ne.map,received:r.parsedType}),me;const a=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([s,c],l)=>({key:a._parse(new pn(r,s,r.path,[l,"key"])),value:i._parse(new pn(r,c,r.path,[l,"value"]))}));if(r.common.async){const s=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return me;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),s.set(l.value,u.value)}return{status:n.value,value:s}})}else{const s=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return me;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),s.set(l.value,u.value)}return{status:n.value,value:s}}}}Ls.create=(t,e,n)=>new Ls({valueType:e,keyType:t,typeName:K.ZodMap,...be(n)});class Pr extends _e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ne.set)return te(r,{code:q.invalid_type,expected:ne.set,received:r.parsedType}),me;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(te(r,{code:q.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(te(r,{code:q.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return me;u.status==="dirty"&&n.dirty(),l.add(u.value)}return{status:n.value,value:l}}const s=[...r.data.values()].map((c,l)=>i._parse(new pn(r,c,r.path,l)));return r.common.async?Promise.all(s).then(c=>o(c)):o(s)}min(e,n){return new Pr({...this._def,minSize:{value:e,message:ue.toString(n)}})}max(e,n){return new Pr({...this._def,maxSize:{value:e,message:ue.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Pr.create=(t,e)=>new Pr({valueType:t,minSize:null,maxSize:null,typeName:K.ZodSet,...be(e)});class Sa extends _e{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ne.function)return te(n,{code:q.invalid_type,expected:ne.function,received:n.parsedType}),me;function r(s,c){return Ns({data:s,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Is(),_a].filter(l=>!!l),issueData:{code:q.invalid_arguments,argumentsError:c}})}function a(s,c){return Ns({data:s,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Is(),_a].filter(l=>!!l),issueData:{code:q.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof Oa){const s=this;return lt(async function(...c){const l=new Et([]),u=await s._def.args.parseAsync(c,i).catch(h=>{throw l.addIssue(r(c,h)),l}),d=await Reflect.apply(o,this,u);return await s._def.returns._def.type.parseAsync(d,i).catch(h=>{throw l.addIssue(a(d,h)),l})})}else{const s=this;return lt(function(...c){const l=s._def.args.safeParse(c,i);if(!l.success)throw new Et([r(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=s._def.returns.safeParse(u,i);if(!d.success)throw new Et([a(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Sa({...this._def,args:mn.create(e).rest(Ar.create())})}returns(e){return new Sa({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new Sa({args:e||mn.create([]).rest(Ar.create()),returns:n||Ar.create(),typeName:K.ZodFunction,...be(r)})}}class Pi extends _e{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Pi.create=(t,e)=>new Pi({getter:t,typeName:K.ZodLazy,...be(e)});class $i extends _e{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return te(n,{received:n.data,code:q.invalid_literal,expected:this._def.value}),me}return{status:"valid",value:e.data}}get value(){return this._def.value}}$i.create=(t,e)=>new $i({value:t,typeName:K.ZodLiteral,...be(e)});function sv(t,e){return new tr({values:t,typeName:K.ZodEnum,...be(e)})}class tr extends _e{constructor(){super(...arguments),ki.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return te(n,{expected:Ie.joinValues(r),received:n.parsedType,code:q.invalid_type}),me}if(js(this,ki)||nv(this,ki,new Set(this._def.values)),!js(this,ki).has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return te(n,{received:n.data,code:q.invalid_enum_value,options:r}),me}return lt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return tr.create(e,{...this._def,...n})}exclude(e,n=this._def){return tr.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}ki=new WeakMap,tr.create=sv;class Li extends _e{constructor(){super(...arguments),Ti.set(this,void 0)}_parse(e){const n=Ie.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ne.string&&r.parsedType!==ne.number){const a=Ie.objectValues(n);return te(r,{expected:Ie.joinValues(a),received:r.parsedType,code:q.invalid_type}),me}if(js(this,Ti)||nv(this,Ti,new Set(Ie.getValidEnumValues(this._def.values))),!js(this,Ti).has(e.data)){const a=Ie.objectValues(n);return te(r,{received:r.data,code:q.invalid_enum_value,options:a}),me}return lt(e.data)}get enum(){return this._def.values}}Ti=new WeakMap,Li.create=(t,e)=>new Li({values:t,typeName:K.ZodNativeEnum,...be(e)});class Oa extends _e{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ne.promise&&n.common.async===!1)return te(n,{code:q.invalid_type,expected:ne.promise,received:n.parsedType}),me;const r=n.parsedType===ne.promise?n.data:Promise.resolve(n.data);return lt(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Oa.create=(t,e)=>new Oa({type:t,typeName:K.ZodPromise,...be(e)});class Vt extends _e{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===K.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:o=>{te(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async s=>{if(n.value==="aborted")return me;const c=await this._def.schema._parseAsync({data:s,path:r.path,parent:r});return c.status==="aborted"?me:c.status==="dirty"||n.value==="dirty"?Cs(c.value):c});{if(n.value==="aborted")return me;const s=this._def.schema._parseSync({data:o,path:r.path,parent:r});return s.status==="aborted"?me:s.status==="dirty"||n.value==="dirty"?Cs(s.value):s}}if(a.type==="refinement"){const o=s=>{const c=a.refinement(s,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return s};if(r.common.async===!1){const s=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?me:(s.status==="dirty"&&n.dirty(),o(s.value),{status:n.value,value:s.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(s=>s.status==="aborted"?me:(s.status==="dirty"&&n.dirty(),o(s.value).then(()=>({status:n.value,value:s.value}))))}if(a.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Si(o))return o;const s=a.transform(o.value,i);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:s}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Si(o)?Promise.resolve(a.transform(o.value,i)).then(s=>({status:n.value,value:s})):o);Ie.assertNever(a)}}Vt.create=(t,e,n)=>new Vt({schema:t,typeName:K.ZodEffects,effect:e,...be(n)}),Vt.createWithPreprocess=(t,e,n)=>new Vt({schema:e,effect:{type:"preprocess",transform:t},typeName:K.ZodEffects,...be(n)}),Dt=class extends _e{_parse(t){return this._getType(t)===ne.undefined?lt(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}},Dt.create=(t,e)=>new Dt({innerType:t,typeName:K.ZodOptional,...be(e)});class nr extends _e{_parse(e){return this._getType(e)===ne.null?lt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}nr.create=(t,e)=>new nr({innerType:t,typeName:K.ZodNullable,...be(e)});class Mi extends _e{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===ne.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Mi.create=(t,e)=>new Mi({innerType:t,typeName:K.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...be(e)});class Di extends _e{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Oi(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Et(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Et(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Di.create=(t,e)=>new Di({innerType:t,typeName:K.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...be(e)});class Ms extends _e{_parse(e){if(this._getType(e)!==ne.nan){const n=this._getOrReturnCtx(e);return te(n,{code:q.invalid_type,expected:ne.nan,received:n.parsedType}),me}return{status:"valid",value:e.data}}}Ms.create=t=>new Ms({typeName:K.ZodNaN,...be(t)});const mO=Symbol("zod_brand");class Ku extends _e{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Fi extends _e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?me:a.status==="dirty"?(n.dirty(),Cs(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?me:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,n){return new Fi({in:e,out:n,typeName:K.ZodPipeline})}}class Ui extends _e{_parse(e){const n=this._def.innerType._parse(e),r=a=>(Si(a)&&(a.value=Object.freeze(a.value)),a);return Oi(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}Ui.create=(t,e)=>new Ui({innerType:t,typeName:K.ZodReadonly,...be(e)});function cv(t,e={},n){return t?xa.create().superRefine((r,a)=>{var i,o;if(!t(r)){const s=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(i=s.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,l=typeof s=="string"?{message:s}:s;a.addIssue({code:"custom",...l,fatal:c})}}):xa.create()}const gO={object:Ze.lazycreate};(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(K||(K={}));const yO=(t,e={message:`Input not instance of ${t.name}`})=>cv(n=>n instanceof t,e),lv=Gt.create,uv=Xn.create,vO=Ms.create,bO=Qn.create,dv=Ri.create,wO=jr.create,_O=As.create,xO=Ii.create,EO=Ni.create,SO=xa.create,OO=Ar.create,kO=jn.create,TO=Ps.create,RO=Wt.create,IO=Ze.create,NO=Ze.strictCreate,CO=Ci.create,jO=$s.create,AO=ji.create,PO=mn.create,$O=Ai.create,LO=Ls.create,MO=Pr.create,DO=Sa.create,FO=Pi.create,UO=$i.create,BO=tr.create,zO=Li.create,ZO=Oa.create,hv=Vt.create,HO=Dt.create,GO=nr.create,WO=Vt.createWithPreprocess,VO=Fi.create,qO=()=>lv().optional(),JO=()=>uv().optional(),KO=()=>dv().optional(),YO={string:t=>Gt.create({...t,coerce:!0}),number:t=>Xn.create({...t,coerce:!0}),boolean:t=>Ri.create({...t,coerce:!0}),bigint:t=>Qn.create({...t,coerce:!0}),date:t=>jr.create({...t,coerce:!0})},XO=me;let ka,Yu,Xu,fv;Xr=Object.freeze({__proto__:null,defaultErrorMap:_a,setErrorMap:XS,getErrorMap:Is,makeIssue:Ns,EMPTY_PATH:QS,addIssueToContext:te,ParseStatus:st,INVALID:me,DIRTY:Cs,OK:lt,isAborted:Wu,isDirty:Vu,isValid:Si,isAsync:Oi,get util(){return Ie},get objectUtil(){return Gu},ZodParsedType:ne,getParsedType:Yn,ZodType:_e,datetimeRegex:ov,ZodString:Gt,ZodNumber:Xn,ZodBigInt:Qn,ZodBoolean:Ri,ZodDate:jr,ZodSymbol:As,ZodUndefined:Ii,ZodNull:Ni,ZodAny:xa,ZodUnknown:Ar,ZodNever:jn,ZodVoid:Ps,ZodArray:Wt,ZodObject:Ze,ZodUnion:Ci,ZodDiscriminatedUnion:$s,ZodIntersection:ji,ZodTuple:mn,ZodRecord:Ai,ZodMap:Ls,ZodSet:Pr,ZodFunction:Sa,ZodLazy:Pi,ZodLiteral:$i,ZodEnum:tr,ZodNativeEnum:Li,ZodPromise:Oa,ZodEffects:Vt,ZodTransformer:Vt,ZodOptional:Dt,ZodNullable:nr,ZodDefault:Mi,ZodCatch:Di,ZodNaN:Ms,BRAND:mO,ZodBranded:Ku,ZodPipeline:Fi,ZodReadonly:Ui,custom:cv,Schema:_e,ZodSchema:_e,late:gO,get ZodFirstPartyTypeKind(){return K},coerce:YO,any:SO,array:RO,bigint:bO,boolean:dv,date:wO,discriminatedUnion:jO,effect:hv,enum:BO,function:DO,instanceof:yO,intersection:AO,lazy:FO,literal:UO,map:LO,nan:vO,nativeEnum:zO,never:kO,null:EO,nullable:GO,number:uv,object:IO,oboolean:KO,onumber:JO,optional:HO,ostring:qO,pipeline:VO,preprocess:WO,promise:ZO,record:$O,set:MO,strictObject:NO,string:lv,symbol:_O,transformer:hv,tuple:PO,undefined:xO,union:CO,unknown:OO,void:TO,NEVER:XO,ZodIssueCode:q,quotelessJson:YS,ZodError:Et}),ka={exports:{}},Yu={};function QO(){if(fv)return Xu;fv=1;function t(e,n){typeof n=="boolean"&&(n={forever:n}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=n||{},this._maxRetryTime=n&&n.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return Xu=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var n=new Date().getTime();if(e&&n-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var a=this;return this._timer=setTimeout(function(){a._attempts++,a._operationTimeoutCb&&(a._timeout=setTimeout(function(){a._operationTimeoutCb(a._attempts)},a._operationTimeout),a._options.unref&&a._timeout.unref()),a._fn(a._attempts)},r),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,n){this._fn=e,n&&(n.timeout&&(this._operationTimeout=n.timeout),n.cb&&(this._operationTimeoutCb=n.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},n=null,r=0,a=0;a<this._errors.length;a++){var i=this._errors[a],o=i.message,s=(e[o]||0)+1;e[o]=s,s>=r&&(n=i,r=s)}return n},Xu}var pv;function ek(){return pv||(pv=1,function(t){var e=QO();t.operation=function(n){var r=t.timeouts(n);return new e(r,{forever:n&&(n.forever||n.retries===1/0),unref:n&&n.unref,maxRetryTime:n&&n.maxRetryTime})},t.timeouts=function(n){if(n instanceof Array)return[].concat(n);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var a in n)r[a]=n[a];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],o=0;o<r.retries;o++)i.push(this.createTimeout(o,r));return n&&n.forever&&!i.length&&i.push(this.createTimeout(o,r)),i.sort(function(s,c){return s-c}),i},t.createTimeout=function(n,r){var a=r.randomize?Math.random()+1:1,i=Math.round(a*Math.max(r.minTimeout,1)*Math.pow(r.factor,n));return i=Math.min(i,r.maxTimeout),i},t.wrap=function(n,r,a){if(r instanceof Array&&(a=r,r=null),!a){a=[];for(var i in n)typeof n[i]=="function"&&a.push(i)}for(var o=0;o<a.length;o++){var s=a[o],c=n[s];n[s]=(function(l){var u=t.operation(r),d=Array.prototype.slice.call(arguments,1),h=d.pop();d.push(function(f){u.retry(f)||(f&&(arguments[0]=u.mainError()),h.apply(this,arguments))}),u.attempt(function(){l.apply(n,d)})}).bind(n,c),n[s].options=r}}}(Yu)),Yu}var mv,gv;function tk(){return gv||(gv=1,mv=ek()),mv}var yv;function nk(){if(yv)return ka.exports;yv=1;const t=tk(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class n extends Error{constructor(s){super(),s instanceof Error?(this.originalError=s,{message:s}=s):(this.originalError=new Error(s),this.originalError.stack=this.stack),this.name="AbortError",this.message=s}}const r=(o,s,c)=>{const l=c.retries-(s-1);return o.attemptNumber=s,o.retriesLeft=l,o},a=o=>e.includes(o),i=(o,s)=>new Promise((c,l)=>{s={onFailedAttempt:()=>{},retries:10,...s};const u=t.operation(s);u.attempt(async d=>{try{c(await o(d))}catch(h){if(!(h instanceof Error)){l(new TypeError(`Non-error was thrown: "${h}". You should only throw errors.`));return}if(h instanceof n)u.stop(),l(h.originalError);else if(h instanceof TypeError&&!a(h.message))u.stop(),l(h);else{r(h,d,s);try{await s.onFailedAttempt(h)}catch(f){l(f);return}u.retry(h)||l(u.mainError())}}})});return ka.exports=i,ka.exports.default=i,ka.exports.AbortError=n,ka.exports}var rk=nk();const Ds=Ka(rk),ak=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function Fs(t){return typeof t=="string"&&ak.test(t)}for(var it=[],Qu=0;Qu<256;++Qu)it.push((Qu+256).toString(16).slice(1));function ik(t,e=0){return(it[t[e+0]]+it[t[e+1]]+it[t[e+2]]+it[t[e+3]]+"-"+it[t[e+4]]+it[t[e+5]]+"-"+it[t[e+6]]+it[t[e+7]]+"-"+it[t[e+8]]+it[t[e+9]]+"-"+it[t[e+10]]+it[t[e+11]]+it[t[e+12]]+it[t[e+13]]+it[t[e+14]]+it[t[e+15]]).toLowerCase()}var Us,ok=new Uint8Array(16);function sk(){if(!Us&&(Us=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Us))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Us(ok)}var ck=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const vv={randomUUID:ck};function St(t,e,n){if(vv.randomUUID&&!e&&!t)return vv.randomUUID();t=t||{};var r=t.random||(t.rng||sk)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,ik(r)}let lk=class{getStore(){}run(t,e){return e()}};const ed=Symbol.for("ls:tracing_async_local_storage"),uk=new lk;let dk=class{getInstance(){return globalThis[ed]??uk}initializeGlobalInstance(t){globalThis[ed]===void 0&&(globalThis[ed]=t)}};const hk=new dk,fk=()=>{const t=hk.getInstance().getStore();if(t===void 0)throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function or the tracing is enabled."].join(`
`));return t};function td(t){return typeof t=="function"&&"langsmith:traceable"in t}const pk=Object.prototype.hasOwnProperty;Xf=function(t,e){return pk.call(t,e)},Gh=function(t){if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=""+r;return n}if(Object.keys)return Object.keys(t);let e=[];for(let n in t)Xf(t,n)&&e.push(n);return e},Sr=function(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}};function nd(t){let e=0;const n=t.length;let r;for(;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}yw=function(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")};function mk(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function rd(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(rd(t[n]))return!0}else if(typeof t=="object"){const n=Gh(t),r=n.length;for(var e=0;e<r;e++)if(rd(t[n[e]]))return!0}}return!1}function bv(t,e){const n=[t];for(const r in e){const a=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof a<"u"&&n.push(`${r}: ${a}`)}return n.join(`
`)}class gk extends Error{constructor(e,n,r,a,i){super(bv(e,{name:n,index:r,operation:a,tree:i})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.setPrototypeOf(this,new.target.prototype),this.message=bv(e,{name:n,index:r,operation:a,tree:i})}}const Ke=gk,Ta={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){let r=ad(n,this.path);r&&(r=Sr(r));const a=Bi(n,{op:"remove",path:this.from}).removed;return Bi(n,{op:"add",path:this.path,value:a}),{newDocument:n,removed:r}},copy:function(t,e,n){const r=ad(n,this.from);return Bi(n,{op:"add",path:this.path,value:Sr(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:zs(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}};var yk={add:function(t,e,n){return nd(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:Ta.move,copy:Ta.copy,test:Ta.test,_get:Ta._get};function ad(t,e){if(e=="")return t;var n={op:"_get",path:e};return Bi(t,n),n.value}function Bi(t,e,n=!1,r=!0,a=!0,i=0){if(n&&(typeof n=="function"?n(e,0,t,e.path):id(e,0)),e.path===""){let o={newDocument:t};if(e.op==="add")return o.newDocument=e.value,o;if(e.op==="replace")return o.newDocument=e.value,o.removed=t,o;if(e.op==="move"||e.op==="copy")return o.newDocument=ad(t,e.from),e.op==="move"&&(o.removed=t),o;if(e.op==="test"){if(o.test=zs(t,e.value),o.test===!1)throw new Ke("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return o.newDocument=t,o}else{if(e.op==="remove")return o.removed=t,o.newDocument=null,o;if(e.op==="_get")return e.value=t,o;if(n)throw new Ke("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,e,t);return o}}else{r||(t=Sr(t));const o=(e.path||"").split("/");let s=t,c=1,l=o.length,u,d,h;for(typeof n=="function"?h=n:h=id;;){if(d=o[c],d&&d.indexOf("~")!=-1&&(d=mk(d)),a&&(d=="__proto__"||d=="prototype"&&c>0&&o[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&u===void 0&&(s[d]===void 0?u=o.slice(0,c).join("/"):c==l-1&&(u=e.path),u!==void 0&&h(e,0,t,u)),c++,Array.isArray(s)){if(d==="-")d=s.length;else{if(n&&!nd(d))throw new Ke("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,e,t);nd(d)&&(d=~~d)}if(c>=l){if(n&&e.op==="add"&&d>s.length)throw new Ke("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,e,t);const f=yk[e.op].call(e,s,d,t);if(f.test===!1)throw new Ke("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return f}}else if(c>=l){const f=Ta[e.op].call(e,s,d,t);if(f.test===!1)throw new Ke("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return f}if(s=s[d],n&&c<l&&(!s||typeof s!="object"))throw new Ke("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,e,t)}}}function Bs(t,e,n,r=!0,a=!0){if(n&&!Array.isArray(e))throw new Ke("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=Sr(t));const i=new Array(e.length);for(let o=0,s=e.length;o<s;o++)i[o]=Bi(t,e[o],n,!0,a,o),t=i[o].newDocument;return i.newDocument=t,i}function id(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new Ke("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(Ta[t.op]){if(typeof t.path!="string")throw new Ke("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new Ke('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new Ke("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new Ke("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&rd(t.value))throw new Ke("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var a=t.path.split("/").length,i=r.split("/").length;if(a!==i+1&&a!==i)throw new Ke("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new Ke("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var o={op:"_get",path:t.from,value:void 0},s=vk([o],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new Ke("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new Ke("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function vk(t,e,n){try{if(!Array.isArray(t))throw new Ke("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Bs(Sr(e),Sr(t),n||!0);else{n=n||id;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(a){if(a instanceof Ke)return a;throw a}}function zs(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),a,i,o;if(n&&r){if(i=t.length,i!=e.length)return!1;for(a=i;a--!==0;)if(!zs(t[a],e[a]))return!1;return!0}if(n!=r)return!1;var s=Object.keys(t);if(i=s.length,i!==Object.keys(e).length)return!1;for(a=i;a--!==0;)if(!e.hasOwnProperty(s[a]))return!1;for(a=i;a--!==0;)if(o=s[a],!zs(t[o],e[o]))return!1;return!0}return t!==t&&e!==e}var wv,_v;function bk(){return _v||(_v=1,wv=function(t,e){if(typeof t!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}),wv}var wk=bk();const _k=Ka(wk);var Zs={exports:{}},xv;function xk(){if(xv)return Zs.exports;xv=1;const t=/[\p{Lu}]/u,e=/[\p{Ll}]/u,n=/^[\p{Lu}](?![\p{Lu}])/gu,r=/([\p{Alpha}\p{N}_]|$)/u,a=/[_.\- ]+/,i=new RegExp("^"+a.source),o=new RegExp(a.source+r.source,"gu"),s=new RegExp("\\d+"+r.source,"gu"),c=(h,f,p)=>{let y=!1,v=!1,x=!1;for(let O=0;O<h.length;O++){const I=h[O];y&&t.test(I)?(h=h.slice(0,O)+"-"+h.slice(O),y=!1,x=v,v=!0,O++):v&&x&&e.test(I)?(h=h.slice(0,O-1)+"-"+h.slice(O-1),x=v,v=!1,y=!0):(y=f(I)===I&&p(I)!==I,x=v,v=p(I)===I&&f(I)!==I)}return h},l=(h,f)=>(n.lastIndex=0,h.replace(n,p=>f(p))),u=(h,f)=>(o.lastIndex=0,s.lastIndex=0,h.replace(o,(p,y)=>f(y)).replace(s,p=>f(p))),d=(h,f)=>{if(!(typeof h=="string"||Array.isArray(h)))throw new TypeError("Expected the input to be `string | string[]`");if(f={pascalCase:!1,preserveConsecutiveUppercase:!1,...f},Array.isArray(h)?h=h.map(v=>v.trim()).filter(v=>v.length).join("-"):h=h.trim(),h.length===0)return"";const p=f.locale===!1?v=>v.toLowerCase():v=>v.toLocaleLowerCase(f.locale),y=f.locale===!1?v=>v.toUpperCase():v=>v.toLocaleUpperCase(f.locale);return h.length===1?f.pascalCase?y(h):p(h):(h!==p(h)&&(h=c(h,p,y)),h=h.replace(i,""),f.preserveConsecutiveUppercase?h=l(h,p):h=p(h),f.pascalCase&&(h=y(h.charAt(0))+h.slice(1)),u(h,y))};return Zs.exports=d,Zs.exports.default=d,Zs.exports}xk();function Ek(t,e){return(e==null?void 0:e[t])||_k(t)}function Sk(t,e,n){const r={};for(const a in t)Object.hasOwn(t,a)&&(r[e(a,n)]=t[a]);return r}function Ev(t){return Array.isArray(t)?[...t]:{...t}}function Ok(t,e){const n=Ev(t);for(const[r,a]of Object.entries(e)){const[i,...o]=r.split(".").reverse();let s=n;for(const c of o.reverse()){if(s[c]===void 0)break;s[c]=Ev(s[c]),s=s[c]}s[i]!==void 0&&(s[i]={lc:1,type:"secret",id:[a]})}return n}function Sv(t){const e=Object.getPrototypeOf(t);return typeof t.lc_name=="function"&&(typeof e.lc_name!="function"||t.lc_name()!==e.lc_name())?t.lc_name():t.name}wr=class{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,Sv(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(t,...e){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=t||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof wr||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const t={},e={},n=Object.keys(this.lc_kwargs).reduce((r,a)=>(r[a]=a in this?this[a]:this.lc_kwargs[a],r),{});for(let r=Object.getPrototypeOf(this);r;r=Object.getPrototypeOf(r))Object.assign(t,Reflect.get(r,"lc_aliases",this)),Object.assign(e,Reflect.get(r,"lc_secrets",this)),Object.assign(n,Reflect.get(r,"lc_attributes",this));return Object.keys(e).forEach(r=>{let a=this,i=n;const[o,...s]=r.split(".").reverse();for(const c of s.reverse()){if(!(c in a)||a[c]===void 0)return;(!(c in i)||i[c]===void 0)&&(typeof a[c]=="object"&&a[c]!=null?i[c]={}:Array.isArray(a[c])&&(i[c]=[])),a=a[c],i=i[c]}o in a&&a[o]!==void 0&&(i[o]=i[o]||a[o])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:Sk(Object.keys(e).length?Ok(n,e):n,Ek,t)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}};function kk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ov={exports:{}},Je=Ov.exports={},gn,yn;function od(){throw new Error("setTimeout has not been defined")}function sd(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?gn=setTimeout:gn=od}catch{gn=od}try{typeof clearTimeout=="function"?yn=clearTimeout:yn=sd}catch{yn=sd}})();function kv(t){if(gn===setTimeout)return setTimeout(t,0);if((gn===od||!gn)&&setTimeout)return gn=setTimeout,setTimeout(t,0);try{return gn(t,0)}catch{try{return gn.call(null,t,0)}catch{return gn.call(this,t,0)}}}function Tk(t){if(yn===clearTimeout)return clearTimeout(t);if((yn===sd||!yn)&&clearTimeout)return yn=clearTimeout,clearTimeout(t);try{return yn(t)}catch{try{return yn.call(null,t)}catch{return yn.call(this,t)}}}var An=[],Ra=!1,$r,Hs=-1;function Rk(){!Ra||!$r||(Ra=!1,$r.length?An=$r.concat(An):Hs=-1,An.length&&Tv())}function Tv(){if(!Ra){var t=kv(Rk);Ra=!0;for(var e=An.length;e;){for($r=An,An=[];++Hs<e;)$r&&$r[Hs].run();Hs=-1,e=An.length}$r=null,Ra=!1,Tk(t)}}Je.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];An.push(new Rv(t,e)),An.length===1&&!Ra&&kv(Tv)};function Rv(t,e){this.fun=t,this.array=e}Rv.prototype.run=function(){this.fun.apply(null,this.array)},Je.title="browser",Je.browser=!0,Je.env={},Je.argv=[],Je.version="",Je.versions={};function Pn(){}Je.on=Pn,Je.addListener=Pn,Je.once=Pn,Je.off=Pn,Je.removeListener=Pn,Je.removeAllListeners=Pn,Je.emit=Pn,Je.prependListener=Pn,Je.prependOnceListener=Pn,Je.listeners=function(t){return[]},Je.binding=function(t){throw new Error("process.binding is not supported")},Je.cwd=function(){return"/"},Je.chdir=function(t){throw new Error("process.chdir is not supported")},Je.umask=function(){return 0};var Ik=Ov.exports;pt=kk(Ik);var cd={};const Nk=()=>typeof window<"u"&&typeof window.document<"u",Ck=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",jk=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),Iv=()=>typeof Deno<"u",Ak=()=>typeof pt<"u"&&typeof pt.versions<"u"&&typeof pt.versions.node<"u"&&!Iv(),Pk=()=>{let t;return Nk()?t="browser":Ak()?t="node":Ck()?t="webworker":jk()?t="jsdom":Iv()?t="deno":t="other",t};let ld;async function $k(){return ld===void 0&&(ld={library:"langchain-js",runtime:Pk()}),ld}_r=function(t){try{return typeof pt<"u"?cd==null?void 0:cd[t]:void 0}catch{return}};class Lk{}class zi extends Lk{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,Sv(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:_r("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return wr.prototype.toJSON.call(this)}toJSONNotImplemented(){return wr.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class n extends zi{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:St()}),Object.assign(this,e)}}return new n}}function ud(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}function Mk(t){return t.replace(/[-:.]/g,"")}function Dk(t,e,n){const r=n.toFixed(0).slice(0,3).padStart(3,"0");return Mk(`${new Date(t).toISOString().slice(0,-1)}${r}Z`)+e}function Zi(t){return typeof t._addRunToRunMap=="function"}class Hi extends zi{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,n){e.child_runs.push(n)}_addRunToRunMap(e){const n=Dk(e.start_time,e.id,e.execution_order),r={...e};if(r.parent_run_id!==void 0){const a=this.runMap.get(r.parent_run_id);a&&(this._addChildRun(a,r),a.child_execution_order=Math.max(a.child_execution_order,r.child_execution_order),r.trace_id=a.trace_id,a.dotted_order!==void 0&&(r.dotted_order=[a.dotted_order,n].join(".")))}else r.trace_id=r.id,r.dotted_order=n;return this.runMap.set(r.id,r),r}async _endTrace(e){var r;const n=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);n?n.child_execution_order=Math.max(n.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((r=this.onRunUpdate)==null?void 0:r.call(this,e))}_getExecutionOrder(e){const n=e!==void 0&&this.runMap.get(e);return n?n.child_execution_order+1:1}_createRunForLLMStart(e,n,r,a,i,o,s,c){const l=this._getExecutionOrder(a),u=Date.now(),d=s?{...i,metadata:s}:i,h={id:r,name:c??e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{prompts:n},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:d??{},tags:o||[]};return this._addRunToRunMap(h)}async handleLLMStart(e,n,r,a,i,o,s,c){var u,d;const l=this.runMap.get(r)??this._createRunForLLMStart(e,n,r,a,i,o,s,c);return await((u=this.onRunCreate)==null?void 0:u.call(this,l)),await((d=this.onLLMStart)==null?void 0:d.call(this,l)),l}_createRunForChatModelStart(e,n,r,a,i,o,s,c){const l=this._getExecutionOrder(a),u=Date.now(),d=s?{...i,metadata:s}:i,h={id:r,name:c??e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{messages:n},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:d??{},tags:o||[]};return this._addRunToRunMap(h)}async handleChatModelStart(e,n,r,a,i,o,s,c){var u,d;const l=this.runMap.get(r)??this._createRunForChatModelStart(e,n,r,a,i,o,s,c);return await((u=this.onRunCreate)==null?void 0:u.call(this,l)),await((d=this.onLLMStart)==null?void 0:d.call(this,l)),l}async handleLLMEnd(e,n){var a;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");return r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((a=this.onLLMEnd)==null?void 0:a.call(this,r)),await this._endTrace(r),r}async handleLLMError(e,n){var a;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((a=this.onLLMError)==null?void 0:a.call(this,r)),await this._endTrace(r),r}_createRunForChainStart(e,n,r,a,i,o,s,c){const l=this._getExecutionOrder(a),u=Date.now(),d={id:r,name:c??e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:n,execution_order:l,child_execution_order:l,run_type:s??"chain",child_runs:[],extra:o?{metadata:o}:{},tags:i||[]};return this._addRunToRunMap(d)}async handleChainStart(e,n,r,a,i,o,s,c){var u,d;const l=this.runMap.get(r)??this._createRunForChainStart(e,n,r,a,i,o,s,c);return await((u=this.onRunCreate)==null?void 0:u.call(this,l)),await((d=this.onChainStart)==null?void 0:d.call(this,l)),l}async handleChainEnd(e,n,r,a,i){var s;const o=this.runMap.get(n);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.outputs=ud(e,"output"),o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),(i==null?void 0:i.inputs)!==void 0&&(o.inputs=ud(i.inputs,"input")),await((s=this.onChainEnd)==null?void 0:s.call(this,o)),await this._endTrace(o),o}async handleChainError(e,n,r,a,i){var s;const o=this.runMap.get(n);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),(i==null?void 0:i.inputs)!==void 0&&(o.inputs=ud(i.inputs,"input")),await((s=this.onChainError)==null?void 0:s.call(this,o)),await this._endTrace(o),o}_createRunForToolStart(e,n,r,a,i,o,s){const c=this._getExecutionOrder(a),l=Date.now(),u={id:r,name:s??e.id[e.id.length-1],parent_run_id:a,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{input:n},execution_order:c,child_execution_order:c,run_type:"tool",child_runs:[],extra:o?{metadata:o}:{},tags:i||[]};return this._addRunToRunMap(u)}async handleToolStart(e,n,r,a,i,o,s){var l,u;const c=this.runMap.get(r)??this._createRunForToolStart(e,n,r,a,i,o,s);return await((l=this.onRunCreate)==null?void 0:l.call(this,c)),await((u=this.onToolStart)==null?void 0:u.call(this,c)),c}async handleToolEnd(e,n){var a;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((a=this.onToolEnd)==null?void 0:a.call(this,r)),await this._endTrace(r),r}async handleToolError(e,n){var a;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((a=this.onToolError)==null?void 0:a.call(this,r)),await this._endTrace(r),r}async handleAgentAction(e,n){var i;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const a=r;a.actions=a.actions||[],a.actions.push(e),a.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((i=this.onAgentAction)==null?void 0:i.call(this,r))}async handleAgentEnd(e,n){var a;const r=this.runMap.get(n);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((a=this.onAgentEnd)==null?void 0:a.call(this,r)))}_createRunForRetrieverStart(e,n,r,a,i,o,s){const c=this._getExecutionOrder(a),l=Date.now(),u={id:r,name:s??e.id[e.id.length-1],parent_run_id:a,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{query:n},execution_order:c,child_execution_order:c,run_type:"retriever",child_runs:[],extra:o?{metadata:o}:{},tags:i||[]};return this._addRunToRunMap(u)}async handleRetrieverStart(e,n,r,a,i,o,s){var l,u;const c=this.runMap.get(r)??this._createRunForRetrieverStart(e,n,r,a,i,o,s);return await((l=this.onRunCreate)==null?void 0:l.call(this,c)),await((u=this.onRetrieverStart)==null?void 0:u.call(this,c)),c}async handleRetrieverEnd(e,n){var a;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((a=this.onRetrieverEnd)==null?void 0:a.call(this,r)),await this._endTrace(r),r}async handleRetrieverError(e,n){var a;const r=this.runMap.get(n);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((a=this.onRetrieverError)==null?void 0:a.call(this,r)),await this._endTrace(r),r}async handleText(e,n){var a;const r=this.runMap.get(n);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((a=this.onText)==null?void 0:a.call(this,r)))}async handleLLMNewToken(e,n,r,a,i,o){var c;const s=this.runMap.get(r);if(!s||(s==null?void 0:s.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return s.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:n,chunk:o==null?void 0:o.chunk}}),await((c=this.onLLMNewToken)==null?void 0:c.call(this,s,e,{chunk:o==null?void 0:o.chunk})),s}}var Gs={},Nv={exports:{}},Cv;function Fk(){return Cv||(Cv=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function i(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new a(u,d||c,h),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],f]:c._events[p].push(f):(c._events[p]=f,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)e.call(l,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},s.prototype.listeners=function(c){var l=n?n+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,h=u.length,f=new Array(h);d<h;d++)f[d]=u[d].fn;return f},s.prototype.listenerCount=function(c){var l=n?n+c:c,u=this._events[l];return u?u.fn?1:u.length:0},s.prototype.emit=function(c,l,u,d,h,f){var p=n?n+c:c;if(!this._events[p])return!1;var y=this._events[p],v=arguments.length,x,O;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),v){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,l),!0;case 3:return y.fn.call(y.context,l,u),!0;case 4:return y.fn.call(y.context,l,u,d),!0;case 5:return y.fn.call(y.context,l,u,d,h),!0;case 6:return y.fn.call(y.context,l,u,d,h,f),!0}for(O=1,x=new Array(v-1);O<v;O++)x[O-1]=arguments[O];y.fn.apply(y.context,x)}else{var I=y.length,A;for(O=0;O<I;O++)switch(y[O].once&&this.removeListener(c,y[O].fn,void 0,!0),v){case 1:y[O].fn.call(y[O].context);break;case 2:y[O].fn.call(y[O].context,l);break;case 3:y[O].fn.call(y[O].context,l,u);break;case 4:y[O].fn.call(y[O].context,l,u,d);break;default:if(!x)for(A=1,x=new Array(v-1);A<v;A++)x[A-1]=arguments[A];y[O].fn.apply(y[O].context,x)}}return!0},s.prototype.on=function(c,l,u){return i(this,c,l,u,!1)},s.prototype.once=function(c,l,u){return i(this,c,l,u,!0)},s.prototype.removeListener=function(c,l,u,d){var h=n?n+c:c;if(!this._events[h])return this;if(!l)return o(this,h),this;var f=this._events[h];if(f.fn)f.fn===l&&(!d||f.once)&&(!u||f.context===u)&&o(this,h);else{for(var p=0,y=[],v=f.length;p<v;p++)(f[p].fn!==l||d&&!f[p].once||u&&f[p].context!==u)&&y.push(f[p]);y.length?this._events[h]=y.length===1?y[0]:y:o(this,h)}return this},s.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&o(this,l)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s}(Nv)),Nv.exports}var Gi={exports:{}},jv,Av;function Uk(){return Av||(Av=1,jv=(t,e)=>(e=e||(()=>{}),t.then(n=>new Promise(r=>{r(e())}).then(()=>n),n=>new Promise(r=>{r(e())}).then(()=>{throw n})))),jv}var Pv;function Bk(){if(Pv)return Gi.exports;Pv=1;const t=Uk();class e extends Error{constructor(a){super(a),this.name="TimeoutError"}}const n=(r,a,i)=>new Promise((o,s)=>{if(typeof a!="number"||a<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(a===1/0){o(r);return}const c=setTimeout(()=>{if(typeof i=="function"){try{o(i())}catch(d){s(d)}return}const l=typeof i=="string"?i:`Promise timed out after ${a} milliseconds`,u=i instanceof Error?i:new e(l);typeof r.cancel=="function"&&r.cancel(),s(u)},a);t(r.then(o,s),()=>{clearTimeout(c)})});return Gi.exports=n,Gi.exports.default=n,Gi.exports.TimeoutError=e,Gi.exports}var Ws={},Vs={},$v;function zk(){if($v)return Vs;$v=1,Object.defineProperty(Vs,"__esModule",{value:!0});function t(e,n,r){let a=0,i=e.length;for(;i>0;){const o=i/2|0;let s=a+o;r(e[s],n)<=0?(a=++s,i-=o+1):i=o}return a}return Vs.default=t,Vs}var Lv;function Zk(){if(Lv)return Ws;Lv=1,Object.defineProperty(Ws,"__esModule",{value:!0});const t=zk();class e{constructor(){this._queue=[]}enqueue(r,a){a=Object.assign({priority:0},a);const i={priority:a.priority,run:r};if(this.size&&this._queue[this.size-1].priority>=a.priority){this._queue.push(i);return}const o=t.default(this._queue,i,(s,c)=>c.priority-s.priority);this._queue.splice(o,0,i)}dequeue(){const r=this._queue.shift();return r==null?void 0:r.run}filter(r){return this._queue.filter(a=>a.priority===r.priority).map(a=>a.run)}get size(){return this._queue.length}}return Ws.default=e,Ws}var Mv;function Hk(){if(Mv)return Gs;Mv=1,Object.defineProperty(Gs,"__esModule",{value:!0});const t=Fk(),e=Bk(),n=Zk(),r=()=>{},a=new e.TimeoutError;class i extends t{constructor(s){var c,l,u,d;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=r,this._resolveIdle=r,s=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:n.default},s),!(typeof s.intervalCap=="number"&&s.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(l=(c=s.intervalCap)===null||c===void 0?void 0:c.toString())!==null&&l!==void 0?l:""}\` (${typeof s.intervalCap})`);if(s.interval===void 0||!(Number.isFinite(s.interval)&&s.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(d=(u=s.interval)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""}\` (${typeof s.interval})`);this._carryoverConcurrencyCount=s.carryoverConcurrencyCount,this._isIntervalIgnored=s.intervalCap===1/0||s.interval===0,this._intervalCap=s.intervalCap,this._interval=s.interval,this._queue=new s.queueClass,this._queueClass=s.queueClass,this.concurrency=s.concurrency,this._timeout=s.timeout,this._throwOnTimeout=s.throwOnTimeout===!0,this._isPaused=s.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=r,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=r,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const s=Date.now();if(this._intervalId===void 0){const c=this._intervalEnd-s;if(c<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},c)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const s=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const c=this._queue.dequeue();return c?(this.emit("active"),c(),s&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(s){if(!(typeof s=="number"&&s>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${s}\` (${typeof s})`);this._concurrency=s,this._processQueue()}async add(s,c={}){return new Promise((l,u)=>{const d=async()=>{this._pendingCount++,this._intervalCount++;try{const h=this._timeout===void 0&&c.timeout===void 0?s():e.default(Promise.resolve(s()),c.timeout===void 0?this._timeout:c.timeout,()=>{(c.throwOnTimeout===void 0?this._throwOnTimeout:c.throwOnTimeout)&&u(a)});l(await h)}catch(h){u(h)}this._next()};this._queue.enqueue(d,c),this._tryToStartAnother(),this.emit("add")})}async addAll(s,c){return Promise.all(s.map(async l=>this.add(l,c)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(s=>{const c=this._resolveEmpty;this._resolveEmpty=()=>{c(),s()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(s=>{const c=this._resolveIdle;this._resolveIdle=()=>{c(),s()}})}get size(){return this._queue.size}sizeBy(s){return this._queue.filter(s).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(s){this._timeout=s}}return Gs.default=i,Gs}var Gk=Hk();const $n=Ka(Gk),Wk=(...t)=>fetch(...t),Vk=Symbol.for("ls:fetch_implementation"),pe=()=>globalThis[Vk]??Wk,qk=[400,401,403,404,405,406,407,408],Jk=[409];let Dv=class{constructor(t){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=t.maxConcurrency??1/0,this.maxRetries=t.maxRetries??6,"default"in $n?this.queue=new $n.default({concurrency:this.maxConcurrency}):this.queue=new $n({concurrency:this.maxConcurrency}),this.onFailedResponseHook=t==null?void 0:t.onFailedResponseHook}call(t,...e){const n=this.onFailedResponseHook;return this.queue.add(()=>Ds(()=>t(...e).catch(r=>{throw r instanceof Error?r:new Error(r)}),{async onFailedAttempt(r){if(r.message.startsWith("Cancel")||r.message.startsWith("TimeoutError")||r.message.startsWith("AbortError")||(r==null?void 0:r.code)==="ECONNABORTED")throw r;const a=r==null?void 0:r.response,i=a==null?void 0:a.status;if(i){if(qk.includes(+i))throw r;if(Jk.includes(+i))return;n&&await n(a)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(t,e,...n){return t.signal?Promise.race([this.call(e,...n),new Promise((r,a)=>{var i;(i=t.signal)==null||i.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(e,...n)}fetch(...t){return this.call(()=>pe()(...t).then(e=>e.ok?e:Promise.reject(e)))}};function Fv(t){return typeof(t==null?void 0:t._getType)=="function"}function Uv(t){const e={type:t._getType(),data:{content:t.content}};return t!=null&&t.additional_kwargs&&Object.keys(t.additional_kwargs).length>0&&(e.data.additional_kwargs={...t.additional_kwargs}),e}var Wi={};let rr;const Kk=()=>typeof window<"u"&&typeof window.document<"u",Yk=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",Xk=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),Bv=()=>typeof Deno<"u",Qk=()=>typeof pt<"u"&&typeof pt.versions<"u"&&typeof pt.versions.node<"u"&&!Bv(),eT=()=>rr||(Kk()?rr="browser":Qk()?rr="node":Yk()?rr="webworker":Xk()?rr="jsdom":Bv()?rr="deno":rr="other",rr);let dd;async function zv(){if(dd===void 0){const t=eT(),e=rT();dd={library:"langsmith",runtime:t,sdk:"langsmith-js",sdk_version:Gb,...e}}return dd}function tT(){const t=nT()||{},e={},n=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION"];for(const[r,a]of Object.entries(t))r.startsWith("LANGCHAIN_")&&typeof a=="string"&&!n.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=a:e[r]=a);return e}function nT(){try{return typeof pt<"u"&&Wi?Object.entries(Wi).reduce((t,[e,n])=>(t[e]=String(n),t),{}):void 0}catch{return}}function Lr(t){try{return typeof pt<"u"?Wi==null?void 0:Wi[t]:void 0}catch{return}}function Mr(t){return Lr(`LANGSMITH_${t}`)||Lr(`LANGCHAIN_${t}`)}let hd;function rT(){if(hd!==void 0)return hd;const t=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const n of t){const r=Lr(n);r!==void 0&&(e[n]=r)}return hd=e,e}function Re(t,e){if(!Fs(t)){const n=e!==void 0?`Invalid UUID for ${e}: ${t}`:`Invalid UUID: ${t}`;throw new Error(n)}return t}const Zv={};function Hv(t){Zv[t]||(console.warn(t),Zv[t]=!0)}var fd={exports:{}},pd,Gv;function qs(){if(Gv)return pd;Gv=1;const t="2.0.0",e=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,a=e-6;return pd={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:a,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:t,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},pd}var md,Wv;function Js(){if(Wv)return md;Wv=1;var t={};return md=typeof pt=="object"&&t&&t.NODE_DEBUG&&/\bsemver\b/i.test(t.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{},md}var Vv;function Vi(){return Vv||(Vv=1,function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:a}=qs(),i=Js();e=t.exports={};const o=e.re=[],s=e.safeRe=[],c=e.src=[],l=e.t={};let u=0;const d="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",a],[d,r]],f=y=>{for(const[v,x]of h)y=y.split(`${v}*`).join(`${v}{0,${x}}`).split(`${v}+`).join(`${v}{1,${x}}`);return y},p=(y,v,x)=>{const O=f(v),I=u++;i(y,I,v),l[y]=I,c[I]=v,o[I]=new RegExp(v,x?"g":void 0),s[I]=new RegExp(O,x?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),p("MAINVERSION",`(${c[l.NUMERICIDENTIFIER]})\\.(${c[l.NUMERICIDENTIFIER]})\\.(${c[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${c[l.NUMERICIDENTIFIERLOOSE]})\\.(${c[l.NUMERICIDENTIFIERLOOSE]})\\.(${c[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${c[l.NUMERICIDENTIFIER]}|${c[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${c[l.NUMERICIDENTIFIERLOOSE]}|${c[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${c[l.PRERELEASEIDENTIFIER]}(?:\\.${c[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${c[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${d}+`),p("BUILD",`(?:\\+(${c[l.BUILDIDENTIFIER]}(?:\\.${c[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${c[l.MAINVERSION]}${c[l.PRERELEASE]}?${c[l.BUILD]}?`),p("FULL",`^${c[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${c[l.MAINVERSIONLOOSE]}${c[l.PRERELEASELOOSE]}?${c[l.BUILD]}?`),p("LOOSE",`^${c[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${c[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${c[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${c[l.XRANGEIDENTIFIER]})(?:\\.(${c[l.XRANGEIDENTIFIER]})(?:\\.(${c[l.XRANGEIDENTIFIER]})(?:${c[l.PRERELEASE]})?${c[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${c[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[l.XRANGEIDENTIFIERLOOSE]})(?:${c[l.PRERELEASELOOSE]})?${c[l.BUILD]}?)?)?`),p("XRANGE",`^${c[l.GTLT]}\\s*${c[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${c[l.GTLT]}\\s*${c[l.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),p("COERCE",`${c[l.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",c[l.COERCEPLAIN]+`(?:${c[l.PRERELEASE]})?(?:${c[l.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",c[l.COERCE],!0),p("COERCERTLFULL",c[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${c[l.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",p("TILDE",`^${c[l.LONETILDE]}${c[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${c[l.LONETILDE]}${c[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${c[l.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",p("CARET",`^${c[l.LONECARET]}${c[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${c[l.LONECARET]}${c[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${c[l.GTLT]}\\s*(${c[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${c[l.GTLT]}\\s*(${c[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${c[l.GTLT]}\\s*(${c[l.LOOSEPLAIN]}|${c[l.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${c[l.XRANGEPLAIN]})\\s+-\\s+(${c[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${c[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(fd,fd.exports)),fd.exports}var gd,qv;function yd(){if(qv)return gd;qv=1;const t=Object.freeze({loose:!0}),e=Object.freeze({});return gd=n=>n?typeof n!="object"?t:n:e,gd}var vd,Jv;function Kv(){if(Jv)return vd;Jv=1;const t=/^[0-9]+$/,e=(n,r)=>{const a=t.test(n),i=t.test(r);return a&&i&&(n=+n,r=+r),n===r?0:a&&!i?-1:i&&!a?1:n<r?-1:1};return vd={compareIdentifiers:e,rcompareIdentifiers:(n,r)=>e(r,n)},vd}var bd,Yv;function ut(){if(Yv)return bd;Yv=1;const t=Js(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:n}=qs(),{safeRe:r,t:a}=Vi(),i=yd(),{compareIdentifiers:o}=Kv();class s{constructor(l,u){if(u=i(u),l instanceof s){if(l.loose===!!u.loose&&l.includePrerelease===!!u.includePrerelease)return l;l=l.version}else if(typeof l!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof l}".`);if(l.length>e)throw new TypeError(`version is longer than ${e} characters`);t("SemVer",l,u),this.options=u,this.loose=!!u.loose,this.includePrerelease=!!u.includePrerelease;const d=l.trim().match(u.loose?r[a.LOOSE]:r[a.FULL]);if(!d)throw new TypeError(`Invalid Version: ${l}`);if(this.raw=l,this.major=+d[1],this.minor=+d[2],this.patch=+d[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");d[4]?this.prerelease=d[4].split(".").map(h=>{if(/^[0-9]+$/.test(h)){const f=+h;if(f>=0&&f<n)return f}return h}):this.prerelease=[],this.build=d[5]?d[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(l){if(t("SemVer.compare",this.version,this.options,l),!(l instanceof s)){if(typeof l=="string"&&l===this.version)return 0;l=new s(l,this.options)}return l.version===this.version?0:this.compareMain(l)||this.comparePre(l)}compareMain(l){return l instanceof s||(l=new s(l,this.options)),o(this.major,l.major)||o(this.minor,l.minor)||o(this.patch,l.patch)}comparePre(l){if(l instanceof s||(l=new s(l,this.options)),this.prerelease.length&&!l.prerelease.length)return-1;if(!this.prerelease.length&&l.prerelease.length)return 1;if(!this.prerelease.length&&!l.prerelease.length)return 0;let u=0;do{const d=this.prerelease[u],h=l.prerelease[u];if(t("prerelease compare",u,d,h),d===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(d===void 0)return-1;if(d!==h)return o(d,h)}while(++u)}compareBuild(l){l instanceof s||(l=new s(l,this.options));let u=0;do{const d=this.build[u],h=l.build[u];if(t("build compare",u,d,h),d===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(d===void 0)return-1;if(d!==h)return o(d,h)}while(++u)}inc(l,u,d){switch(l){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",u,d);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",u,d);break;case"prepatch":this.prerelease.length=0,this.inc("patch",u,d),this.inc("pre",u,d);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",u,d),this.inc("pre",u,d);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const h=Number(d)?1:0;if(!u&&d===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[h];else{let f=this.prerelease.length;for(;--f>=0;)typeof this.prerelease[f]=="number"&&(this.prerelease[f]++,f=-2);if(f===-1){if(u===this.prerelease.join(".")&&d===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(h)}}if(u){let f=[u,h];d===!1&&(f=[u]),o(this.prerelease[0],u)===0?isNaN(this.prerelease[1])&&(this.prerelease=f):this.prerelease=f}break}default:throw new Error(`invalid increment argument: ${l}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return bd=s,bd}var wd,Xv;function Ia(){if(Xv)return wd;Xv=1;const t=ut();return wd=(e,n,r=!1)=>{if(e instanceof t)return e;try{return new t(e,n)}catch(a){if(!r)return null;throw a}},wd}var _d,Qv;function aT(){if(Qv)return _d;Qv=1;const t=Ia();return _d=(e,n)=>{const r=t(e,n);return r?r.version:null},_d}var xd,eb;function iT(){if(eb)return xd;eb=1;const t=Ia();return xd=(e,n)=>{const r=t(e.trim().replace(/^[=v]+/,""),n);return r?r.version:null},xd}var Ed,tb;function oT(){if(tb)return Ed;tb=1;const t=ut();return Ed=(e,n,r,a,i)=>{typeof r=="string"&&(i=a,a=r,r=void 0);try{return new t(e instanceof t?e.version:e,r).inc(n,a,i).version}catch{return null}},Ed}var Sd,nb;function sT(){if(nb)return Sd;nb=1;const t=Ia();return Sd=(e,n)=>{const r=t(e,null,!0),a=t(n,null,!0),i=r.compare(a);if(i===0)return null;const o=i>0,s=o?r:a,c=o?a:r,l=!!s.prerelease.length;if(c.prerelease.length&&!l)return!c.patch&&!c.minor?"major":s.patch?"patch":s.minor?"minor":"major";const u=l?"pre":"";return r.major!==a.major?u+"major":r.minor!==a.minor?u+"minor":r.patch!==a.patch?u+"patch":"prerelease"},Sd}var Od,rb;function cT(){if(rb)return Od;rb=1;const t=ut();return Od=(e,n)=>new t(e,n).major,Od}var kd,ab;function lT(){if(ab)return kd;ab=1;const t=ut();return kd=(e,n)=>new t(e,n).minor,kd}var Td,ib;function uT(){if(ib)return Td;ib=1;const t=ut();return Td=(e,n)=>new t(e,n).patch,Td}var Rd,ob;function dT(){if(ob)return Rd;ob=1;const t=Ia();return Rd=(e,n)=>{const r=t(e,n);return r&&r.prerelease.length?r.prerelease:null},Rd}var Id,sb;function qt(){if(sb)return Id;sb=1;const t=ut();return Id=(e,n,r)=>new t(e,r).compare(new t(n,r)),Id}var Nd,cb;function hT(){if(cb)return Nd;cb=1;const t=qt();return Nd=(e,n,r)=>t(n,e,r),Nd}var Cd,lb;function fT(){if(lb)return Cd;lb=1;const t=qt();return Cd=(e,n)=>t(e,n,!0),Cd}var jd,ub;function Ad(){if(ub)return jd;ub=1;const t=ut();return jd=(e,n,r)=>{const a=new t(e,r),i=new t(n,r);return a.compare(i)||a.compareBuild(i)},jd}var Pd,db;function pT(){if(db)return Pd;db=1;const t=Ad();return Pd=(e,n)=>e.sort((r,a)=>t(r,a,n)),Pd}var $d,hb;function mT(){if(hb)return $d;hb=1;const t=Ad();return $d=(e,n)=>e.sort((r,a)=>t(a,r,n)),$d}var Ld,fb;function Ks(){if(fb)return Ld;fb=1;const t=qt();return Ld=(e,n,r)=>t(e,n,r)>0,Ld}var Md,pb;function Dd(){if(pb)return Md;pb=1;const t=qt();return Md=(e,n,r)=>t(e,n,r)<0,Md}var Fd,mb;function gb(){if(mb)return Fd;mb=1;const t=qt();return Fd=(e,n,r)=>t(e,n,r)===0,Fd}var Ud,yb;function vb(){if(yb)return Ud;yb=1;const t=qt();return Ud=(e,n,r)=>t(e,n,r)!==0,Ud}var Bd,bb;function zd(){if(bb)return Bd;bb=1;const t=qt();return Bd=(e,n,r)=>t(e,n,r)>=0,Bd}var Zd,wb;function Hd(){if(wb)return Zd;wb=1;const t=qt();return Zd=(e,n,r)=>t(e,n,r)<=0,Zd}var Gd,_b;function xb(){if(_b)return Gd;_b=1;const t=gb(),e=vb(),n=Ks(),r=zd(),a=Dd(),i=Hd();return Gd=(o,s,c,l)=>{switch(s){case"===":return typeof o=="object"&&(o=o.version),typeof c=="object"&&(c=c.version),o===c;case"!==":return typeof o=="object"&&(o=o.version),typeof c=="object"&&(c=c.version),o!==c;case"":case"=":case"==":return t(o,c,l);case"!=":return e(o,c,l);case">":return n(o,c,l);case">=":return r(o,c,l);case"<":return a(o,c,l);case"<=":return i(o,c,l);default:throw new TypeError(`Invalid operator: ${s}`)}},Gd}var Wd,Eb;function gT(){if(Eb)return Wd;Eb=1;const t=ut(),e=Ia(),{safeRe:n,t:r}=Vi();return Wd=(a,i)=>{if(a instanceof t)return a;if(typeof a=="number"&&(a=String(a)),typeof a!="string")return null;i=i||{};let o=null;if(!i.rtl)o=a.match(i.includePrerelease?n[r.COERCEFULL]:n[r.COERCE]);else{const h=i.includePrerelease?n[r.COERCERTLFULL]:n[r.COERCERTL];let f;for(;(f=h.exec(a))&&(!o||o.index+o[0].length!==a.length);)(!o||f.index+f[0].length!==o.index+o[0].length)&&(o=f),h.lastIndex=f.index+f[1].length+f[2].length;h.lastIndex=-1}if(o===null)return null;const s=o[2],c=o[3]||"0",l=o[4]||"0",u=i.includePrerelease&&o[5]?`-${o[5]}`:"",d=i.includePrerelease&&o[6]?`+${o[6]}`:"";return e(`${s}.${c}.${l}${u}${d}`,i)},Wd}var Vd,Sb;function yT(){if(Sb)return Vd;Sb=1;class t{constructor(){this.max=1e3,this.map=new Map}get(n){const r=this.map.get(n);if(r!==void 0)return this.map.delete(n),this.map.set(n,r),r}delete(n){return this.map.delete(n)}set(n,r){if(!this.delete(n)&&r!==void 0){if(this.map.size>=this.max){const a=this.map.keys().next().value;this.delete(a)}this.map.set(n,r)}return this}}return Vd=t,Vd}var qd,Ob;function Jt(){if(Ob)return qd;Ob=1;const t=/\s+/g;class e{constructor(b,z){if(z=a(z),b instanceof e)return b.loose===!!z.loose&&b.includePrerelease===!!z.includePrerelease?b:new e(b.raw,z);if(b instanceof i)return this.raw=b.value,this.set=[[b]],this.formatted=void 0,this;if(this.options=z,this.loose=!!z.loose,this.includePrerelease=!!z.includePrerelease,this.raw=b.trim().replace(t," "),this.set=this.raw.split("||").map(C=>this.parseRange(C.trim())).filter(C=>C.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const C=this.set[0];if(this.set=this.set.filter($=>!y($[0])),this.set.length===0)this.set=[C];else if(this.set.length>1){for(const $ of this.set)if($.length===1&&v($[0])){this.set=[$];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let b=0;b<this.set.length;b++){b>0&&(this.formatted+="||");const z=this.set[b];for(let C=0;C<z.length;C++)C>0&&(this.formatted+=" "),this.formatted+=z[C].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(b){const z=((this.options.includePrerelease&&f)|(this.options.loose&&p))+":"+b,C=r.get(z);if(C)return C;const $=this.options.loose,P=$?c[l.HYPHENRANGELOOSE]:c[l.HYPHENRANGE];b=b.replace(P,E(this.options.includePrerelease)),o("hyphen replace",b),b=b.replace(c[l.COMPARATORTRIM],u),o("comparator trim",b),b=b.replace(c[l.TILDETRIM],d),o("tilde trim",b),b=b.replace(c[l.CARETTRIM],h),o("caret trim",b);let Y=b.split(" ").map(xe=>O(xe,this.options)).join(" ").split(/\s+/).map(xe=>he(xe,this.options));$&&(Y=Y.filter(xe=>(o("loose invalid filter",xe,this.options),!!xe.match(c[l.COMPARATORLOOSE])))),o("range list",Y);const ae=new Map,le=Y.map(xe=>new i(xe,this.options));for(const xe of le){if(y(xe))return[xe];ae.set(xe.value,xe)}ae.size>1&&ae.has("")&&ae.delete("");const we=[...ae.values()];return r.set(z,we),we}intersects(b,z){if(!(b instanceof e))throw new TypeError("a Range is required");return this.set.some(C=>x(C,z)&&b.set.some($=>x($,z)&&C.every(P=>$.every(Y=>P.intersects(Y,z)))))}test(b){if(!b)return!1;if(typeof b=="string")try{b=new s(b,this.options)}catch{return!1}for(let z=0;z<this.set.length;z++)if(R(this.set[z],b,this.options))return!0;return!1}}qd=e;const n=yT(),r=new n,a=yd(),i=Ys(),o=Js(),s=ut(),{safeRe:c,t:l,comparatorTrimReplace:u,tildeTrimReplace:d,caretTrimReplace:h}=Vi(),{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:p}=qs(),y=S=>S.value==="<0.0.0-0",v=S=>S.value==="",x=(S,b)=>{let z=!0;const C=S.slice();let $=C.pop();for(;z&&C.length;)z=C.every(P=>$.intersects(P,b)),$=C.pop();return z},O=(S,b)=>(o("comp",S,b),S=U(S,b),o("caret",S),S=A(S,b),o("tildes",S),S=F(S,b),o("xrange",S),S=re(S,b),o("stars",S),S),I=S=>!S||S.toLowerCase()==="x"||S==="*",A=(S,b)=>S.trim().split(/\s+/).map(z=>_(z,b)).join(" "),_=(S,b)=>{const z=b.loose?c[l.TILDELOOSE]:c[l.TILDE];return S.replace(z,(C,$,P,Y,ae)=>{o("tilde",S,C,$,P,Y,ae);let le;return I($)?le="":I(P)?le=`>=${$}.0.0 <${+$+1}.0.0-0`:I(Y)?le=`>=${$}.${P}.0 <${$}.${+P+1}.0-0`:ae?(o("replaceTilde pr",ae),le=`>=${$}.${P}.${Y}-${ae} <${$}.${+P+1}.0-0`):le=`>=${$}.${P}.${Y} <${$}.${+P+1}.0-0`,o("tilde return",le),le})},U=(S,b)=>S.trim().split(/\s+/).map(z=>Z(z,b)).join(" "),Z=(S,b)=>{o("caret",S,b);const z=b.loose?c[l.CARETLOOSE]:c[l.CARET],C=b.includePrerelease?"-0":"";return S.replace(z,($,P,Y,ae,le)=>{o("caret",S,$,P,Y,ae,le);let we;return I(P)?we="":I(Y)?we=`>=${P}.0.0${C} <${+P+1}.0.0-0`:I(ae)?P==="0"?we=`>=${P}.${Y}.0${C} <${P}.${+Y+1}.0-0`:we=`>=${P}.${Y}.0${C} <${+P+1}.0.0-0`:le?(o("replaceCaret pr",le),P==="0"?Y==="0"?we=`>=${P}.${Y}.${ae}-${le} <${P}.${Y}.${+ae+1}-0`:we=`>=${P}.${Y}.${ae}-${le} <${P}.${+Y+1}.0-0`:we=`>=${P}.${Y}.${ae}-${le} <${+P+1}.0.0-0`):(o("no pr"),P==="0"?Y==="0"?we=`>=${P}.${Y}.${ae}${C} <${P}.${Y}.${+ae+1}-0`:we=`>=${P}.${Y}.${ae}${C} <${P}.${+Y+1}.0-0`:we=`>=${P}.${Y}.${ae} <${+P+1}.0.0-0`),o("caret return",we),we})},F=(S,b)=>(o("replaceXRanges",S,b),S.split(/\s+/).map(z=>G(z,b)).join(" ")),G=(S,b)=>{S=S.trim();const z=b.loose?c[l.XRANGELOOSE]:c[l.XRANGE];return S.replace(z,(C,$,P,Y,ae,le)=>{o("xRange",S,C,$,P,Y,ae,le);const we=I(P),xe=we||I(Y),Be=xe||I(ae),gt=Be;return $==="="&&gt&&($=""),le=b.includePrerelease?"-0":"",we?$===">"||$==="<"?C="<0.0.0-0":C="*":$&&gt?(xe&&(Y=0),ae=0,$===">"?($=">=",xe?(P=+P+1,Y=0,ae=0):(Y=+Y+1,ae=0)):$==="<="&&($="<",xe?P=+P+1:Y=+Y+1),$==="<"&&(le="-0"),C=`${$+P}.${Y}.${ae}${le}`):xe?C=`>=${P}.0.0${le} <${+P+1}.0.0-0`:Be&&(C=`>=${P}.${Y}.0${le} <${P}.${+Y+1}.0-0`),o("xRange return",C),C})},re=(S,b)=>(o("replaceStars",S,b),S.trim().replace(c[l.STAR],"")),he=(S,b)=>(o("replaceGTE0",S,b),S.trim().replace(c[b.includePrerelease?l.GTE0PRE:l.GTE0],"")),E=S=>(b,z,C,$,P,Y,ae,le,we,xe,Be,gt)=>(I(C)?z="":I($)?z=`>=${C}.0.0${S?"-0":""}`:I(P)?z=`>=${C}.${$}.0${S?"-0":""}`:Y?z=`>=${z}`:z=`>=${z}${S?"-0":""}`,I(we)?le="":I(xe)?le=`<${+we+1}.0.0-0`:I(Be)?le=`<${we}.${+xe+1}.0-0`:gt?le=`<=${we}.${xe}.${Be}-${gt}`:S?le=`<${we}.${xe}.${+Be+1}-0`:le=`<=${le}`,`${z} ${le}`.trim()),R=(S,b,z)=>{for(let C=0;C<S.length;C++)if(!S[C].test(b))return!1;if(b.prerelease.length&&!z.includePrerelease){for(let C=0;C<S.length;C++)if(o(S[C].semver),S[C].semver!==i.ANY&&S[C].semver.prerelease.length>0){const $=S[C].semver;if($.major===b.major&&$.minor===b.minor&&$.patch===b.patch)return!0}return!1}return!0};return qd}var Jd,kb;function Ys(){if(kb)return Jd;kb=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(u,d){if(d=n(d),u instanceof e){if(u.loose===!!d.loose)return u;u=u.value}u=u.trim().split(/\s+/).join(" "),o("comparator",u,d),this.options=d,this.loose=!!d.loose,this.parse(u),this.semver===t?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(u){const d=this.options.loose?r[a.COMPARATORLOOSE]:r[a.COMPARATOR],h=u.match(d);if(!h)throw new TypeError(`Invalid comparator: ${u}`);this.operator=h[1]!==void 0?h[1]:"",this.operator==="="&&(this.operator=""),h[2]?this.semver=new s(h[2],this.options.loose):this.semver=t}toString(){return this.value}test(u){if(o("Comparator.test",u,this.options.loose),this.semver===t||u===t)return!0;if(typeof u=="string")try{u=new s(u,this.options)}catch{return!1}return i(u,this.operator,this.semver,this.options)}intersects(u,d){if(!(u instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new c(u.value,d).test(this.value):u.operator===""?u.value===""?!0:new c(this.value,d).test(u.semver):(d=n(d),d.includePrerelease&&(this.value==="<0.0.0-0"||u.value==="<0.0.0-0")||!d.includePrerelease&&(this.value.startsWith("<0.0.0")||u.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&u.operator.startsWith(">")||this.operator.startsWith("<")&&u.operator.startsWith("<")||this.semver.version===u.semver.version&&this.operator.includes("=")&&u.operator.includes("=")||i(this.semver,"<",u.semver,d)&&this.operator.startsWith(">")&&u.operator.startsWith("<")||i(this.semver,">",u.semver,d)&&this.operator.startsWith("<")&&u.operator.startsWith(">")))}}Jd=e;const n=yd(),{safeRe:r,t:a}=Vi(),i=xb(),o=Js(),s=ut(),c=Jt();return Jd}var Kd,Tb;function Xs(){if(Tb)return Kd;Tb=1;const t=Jt();return Kd=(e,n,r)=>{try{n=new t(n,r)}catch{return!1}return n.test(e)},Kd}var Yd,Rb;function vT(){if(Rb)return Yd;Rb=1;const t=Jt();return Yd=(e,n)=>new t(e,n).set.map(r=>r.map(a=>a.value).join(" ").trim().split(" ")),Yd}var Xd,Ib;function bT(){if(Ib)return Xd;Ib=1;const t=ut(),e=Jt();return Xd=(n,r,a)=>{let i=null,o=null,s=null;try{s=new e(r,a)}catch{return null}return n.forEach(c=>{s.test(c)&&(!i||o.compare(c)===-1)&&(i=c,o=new t(i,a))}),i},Xd}var Qd,Nb;function wT(){if(Nb)return Qd;Nb=1;const t=ut(),e=Jt();return Qd=(n,r,a)=>{let i=null,o=null,s=null;try{s=new e(r,a)}catch{return null}return n.forEach(c=>{s.test(c)&&(!i||o.compare(c)===1)&&(i=c,o=new t(i,a))}),i},Qd}var eh,Cb;function _T(){if(Cb)return eh;Cb=1;const t=ut(),e=Jt(),n=Ks();return eh=(r,a)=>{r=new e(r,a);let i=new t("0.0.0");if(r.test(i)||(i=new t("0.0.0-0"),r.test(i)))return i;i=null;for(let o=0;o<r.set.length;++o){const s=r.set[o];let c=null;s.forEach(l=>{const u=new t(l.semver.version);switch(l.operator){case">":u.prerelease.length===0?u.patch++:u.prerelease.push(0),u.raw=u.format();case"":case">=":(!c||n(u,c))&&(c=u);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${l.operator}`)}}),c&&(!i||n(i,c))&&(i=c)}return i&&r.test(i)?i:null},eh}var th,jb;function xT(){if(jb)return th;jb=1;const t=Jt();return th=(e,n)=>{try{return new t(e,n).range||"*"}catch{return null}},th}var nh,Ab;function rh(){if(Ab)return nh;Ab=1;const t=ut(),e=Ys(),{ANY:n}=e,r=Jt(),a=Xs(),i=Ks(),o=Dd(),s=Hd(),c=zd();return nh=(l,u,d,h)=>{l=new t(l,h),u=new r(u,h);let f,p,y,v,x;switch(d){case">":f=i,p=s,y=o,v=">",x=">=";break;case"<":f=o,p=c,y=i,v="<",x="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(l,u,h))return!1;for(let O=0;O<u.set.length;++O){const I=u.set[O];let A=null,_=null;if(I.forEach(U=>{U.semver===n&&(U=new e(">=0.0.0")),A=A||U,_=_||U,f(U.semver,A.semver,h)?A=U:y(U.semver,_.semver,h)&&(_=U)}),A.operator===v||A.operator===x||(!_.operator||_.operator===v)&&p(l,_.semver)||_.operator===x&&y(l,_.semver))return!1}return!0},nh}var ah,Pb;function ET(){if(Pb)return ah;Pb=1;const t=rh();return ah=(e,n,r)=>t(e,n,">",r),ah}var ih,$b;function ST(){if($b)return ih;$b=1;const t=rh();return ih=(e,n,r)=>t(e,n,"<",r),ih}var oh,Lb;function OT(){if(Lb)return oh;Lb=1;const t=Jt();return oh=(e,n,r)=>(e=new t(e,r),n=new t(n,r),e.intersects(n,r)),oh}var sh,Mb;function kT(){if(Mb)return sh;Mb=1;const t=Xs(),e=qt();return sh=(n,r,a)=>{const i=[];let o=null,s=null;const c=n.sort((h,f)=>e(h,f,a));for(const h of c)t(h,r,a)?(s=h,o||(o=h)):(s&&i.push([o,s]),s=null,o=null);o&&i.push([o,null]);const l=[];for(const[h,f]of i)h===f?l.push(h):!f&&h===c[0]?l.push("*"):f?h===c[0]?l.push(`<=${f}`):l.push(`${h} - ${f}`):l.push(`>=${h}`);const u=l.join(" || "),d=typeof r.raw=="string"?r.raw:String(r);return u.length<d.length?u:r},sh}var ch,Db;function TT(){if(Db)return ch;Db=1;const t=Jt(),e=Ys(),{ANY:n}=e,r=Xs(),a=qt(),i=(d,h,f={})=>{if(d===h)return!0;d=new t(d,f),h=new t(h,f);let p=!1;e:for(const y of d.set){for(const v of h.set){const x=c(y,v,f);if(p=p||x!==null,x)continue e}if(p)return!1}return!0},o=[new e(">=0.0.0-0")],s=[new e(">=0.0.0")],c=(d,h,f)=>{if(d===h)return!0;if(d.length===1&&d[0].semver===n){if(h.length===1&&h[0].semver===n)return!0;f.includePrerelease?d=o:d=s}if(h.length===1&&h[0].semver===n){if(f.includePrerelease)return!0;h=s}const p=new Set;let y,v;for(const F of d)F.operator===">"||F.operator===">="?y=l(y,F,f):F.operator==="<"||F.operator==="<="?v=u(v,F,f):p.add(F.semver);if(p.size>1)return null;let x;if(y&&v&&(x=a(y.semver,v.semver,f),x>0||x===0&&(y.operator!==">="||v.operator!=="<=")))return null;for(const F of p){if(y&&!r(F,String(y),f)||v&&!r(F,String(v),f))return null;for(const G of h)if(!r(F,String(G),f))return!1;return!0}let O,I,A,_,U=v&&!f.includePrerelease&&v.semver.prerelease.length?v.semver:!1,Z=y&&!f.includePrerelease&&y.semver.prerelease.length?y.semver:!1;U&&U.prerelease.length===1&&v.operator==="<"&&U.prerelease[0]===0&&(U=!1);for(const F of h){if(_=_||F.operator===">"||F.operator===">=",A=A||F.operator==="<"||F.operator==="<=",y){if(Z&&F.semver.prerelease&&F.semver.prerelease.length&&F.semver.major===Z.major&&F.semver.minor===Z.minor&&F.semver.patch===Z.patch&&(Z=!1),F.operator===">"||F.operator===">="){if(O=l(y,F,f),O===F&&O!==y)return!1}else if(y.operator===">="&&!r(y.semver,String(F),f))return!1}if(v){if(U&&F.semver.prerelease&&F.semver.prerelease.length&&F.semver.major===U.major&&F.semver.minor===U.minor&&F.semver.patch===U.patch&&(U=!1),F.operator==="<"||F.operator==="<="){if(I=u(v,F,f),I===F&&I!==v)return!1}else if(v.operator==="<="&&!r(v.semver,String(F),f))return!1}if(!F.operator&&(v||y)&&x!==0)return!1}return!(y&&A&&!v&&x!==0||v&&_&&!y&&x!==0||Z||U)},l=(d,h,f)=>{if(!d)return h;const p=a(d.semver,h.semver,f);return p>0?d:p<0||h.operator===">"&&d.operator===">="?h:d},u=(d,h,f)=>{if(!d)return h;const p=a(d.semver,h.semver,f);return p<0?d:p>0||h.operator==="<"&&d.operator==="<="?h:d};return ch=i,ch}var lh,Fb;function RT(){if(Fb)return lh;Fb=1;const t=Vi(),e=qs(),n=ut(),r=Kv(),a=Ia(),i=aT(),o=iT(),s=oT(),c=sT(),l=cT(),u=lT(),d=uT(),h=dT(),f=qt(),p=hT(),y=fT(),v=Ad(),x=pT(),O=mT(),I=Ks(),A=Dd(),_=gb(),U=vb(),Z=zd(),F=Hd(),G=xb(),re=gT(),he=Ys(),E=Jt(),R=Xs(),S=vT(),b=bT(),z=wT(),C=_T(),$=xT(),P=rh(),Y=ET(),ae=ST(),le=OT(),we=kT(),xe=TT();return lh={parse:a,valid:i,clean:o,inc:s,diff:c,major:l,minor:u,patch:d,prerelease:h,compare:f,rcompare:p,compareLoose:y,compareBuild:v,sort:x,rsort:O,gt:I,lt:A,eq:_,neq:U,gte:Z,lte:F,cmp:G,coerce:re,Comparator:he,Range:E,satisfies:R,toComparators:S,maxSatisfying:b,minSatisfying:z,minVersion:C,validRange:$,outside:P,gtr:Y,ltr:ae,intersects:le,simplifyRange:we,subset:xe,SemVer:n,re:t.re,src:t.src,tokens:t.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:r.compareIdentifiers,rcompareIdentifiers:r.rcompareIdentifiers},lh}var Ub=RT();function IT(t,e){const n=Ub.parse(t),r=Ub.parse(e);if(!n||!r)throw new Error("Invalid version format.");return n.compare(r)>=0}function ar(t){if(!t||t.split("/").length>2||t.startsWith("/")||t.endsWith("/")||t.split(":").length>2)throw new Error(`Invalid identifier format: ${t}`);const[e,n]=t.split(":"),r=n||"latest";if(e.includes("/")){const[a,i]=e.split("/",2);if(!a||!i)throw new Error(`Invalid identifier format: ${t}`);return[a,i,r]}else{if(!e)throw new Error(`Invalid identifier format: ${t}`);return["-",e,r]}}class NT extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function Oe(t,e,n){let r;if(t.ok){n&&(r=await t.text());return}r=await t.text();const a=`Failed to ${e}. Received status [${t.status}]: ${t.statusText}. Server response: ${r}`;throw t.status===409?new NT(a):new Error(a)}var Bb="[...]",CT={result:"[Circular]"},Qs=[],Na=[];function jT(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function qi(t,e,n,r){typeof r>"u"&&(r=jT()),dh(t,"",0,[],void 0,0,r);var a;try{Na.length===0?a=JSON.stringify(t,e,n):a=JSON.stringify(t,AT(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Qs.length!==0;){var i=Qs.pop();i.length===4?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return a}function uh(t,e,n,r){var a=Object.getOwnPropertyDescriptor(r,n);a.get!==void 0?a.configurable?(Object.defineProperty(r,n,{value:t}),Qs.push([r,n,e,a])):Na.push([e,n,t]):(r[n]=t,Qs.push([r,n,e]))}function dh(t,e,n,r,a,i,o){i+=1;var s;if(typeof t=="object"&&t!==null){for(s=0;s<r.length;s++)if(r[s]===t){uh(CT,t,e,a);return}if(typeof o.depthLimit<"u"&&i>o.depthLimit){uh(Bb,t,e,a);return}if(typeof o.edgesLimit<"u"&&n+1>o.edgesLimit){uh(Bb,t,e,a);return}if(r.push(t),Array.isArray(t))for(s=0;s<t.length;s++)dh(t[s],s,s,r,t,i,o);else{var c=Object.keys(t);for(s=0;s<c.length;s++){var l=c[s];dh(t[l],l,s,r,t,i,o)}}r.pop()}}function AT(t){return t=typeof t<"u"?t:function(e,n){return n},function(e,n){if(Na.length>0)for(var r=0;r<Na.length;r++){var a=Na[r];if(a[1]===e&&a[0]===n){n=a[2],Na.splice(r,1);break}}return t.call(this,e,n)}}async function zb(t){const e=await zv(),n=tT();return t.map(r=>{const a=r.extra??{},i=a.metadata;return r.extra={...a,runtime:{...e,...a==null?void 0:a.runtime},metadata:{...n,...n.revision_id||r.revision_id?{revision_id:r.revision_id??n.revision_id}:{},...i}},r})}const PT=()=>{const t=Mr("TRACING_SAMPLING_RATE");if(t===void 0)return;const e=parseFloat(t);if(e<0||e>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${e}`);return e},$T=t=>{const e=t.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return e==="localhost"||e==="127.0.0.1"||e==="::1"};async function LT(t){const e=[];for await(const n of t)e.push(n);return e}function hh(t){if(t!==void 0)return t.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const MT=async t=>{if((t==null?void 0:t.status)===429){const e=parseInt(t.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(n=>setTimeout(n,e)),!0}return!1};class DT{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]})}get size(){return this.items.length}push(e){return new Promise(n=>{this.items.push([e,n])})}pop(e){if(e<1)throw new Error("Number of items to pop off may not be less than 1.");const n=[];for(;n.length<e&&this.items.length;){const r=this.items.shift();if(r)n.push(r);else break}return[n.map(r=>r[0]),()=>n.forEach(r=>r[1]())]}}const FT=20971520;class Ji{constructor(e={}){var r;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"batchEndpointSupported",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new DT}),Object.defineProperty(this,"pendingAutoBatchedRunLimit",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchInitialDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const n=Ji.getDefaultClientConfig();this.tracingSampleRate=PT(),this.apiUrl=hh(e.apiUrl??n.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=hh(e.apiKey??n.apiKey),this.webUrl=hh(e.webUrl??n.webUrl),(r=this.webUrl)!=null&&r.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??12e3,this.caller=new Dv(e.callerOptions??{}),this.batchIngestCaller=new Dv({...e.callerOptions??{},onFailedResponseHook:MT}),this.hideInputs=e.hideInputs??e.anonymizer??n.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??n.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.pendingAutoBatchedRunLimit=e.pendingAutoBatchedRunLimit??this.pendingAutoBatchedRunLimit,this.fetchOptions=e.fetchOptions||{}}static getDefaultClientConfig(){const e=Mr("API_KEY"),n=Mr("ENDPOINT")??"https://api.smith.langchain.com",r=Mr("HIDE_INPUTS")==="true",a=Mr("HIDE_OUTPUTS")==="true";return{apiUrl:n,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:a}}getHostUrl(){return this.webUrl?this.webUrl:$T(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${Gb}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const n={...e};return n.inputs!==void 0&&(n.inputs=this.processInputs(n.inputs)),n.outputs!==void 0&&(n.outputs=this.processOutputs(n.outputs)),n}async _getResponse(e,n){const r=(n==null?void 0:n.toString())??"",a=`${this.apiUrl}${e}?${r}`,i=await this.caller.call(pe(),a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(i,`Failed to fetch ${e}`),i}async _get(e,n){return(await this._getResponse(e,n)).json()}async*_getPaginated(e,n=new URLSearchParams,r){let a=Number(n.get("offset"))||0;const i=Number(n.get("limit"))||100;for(;;){n.set("offset",String(a)),n.set("limit",String(i));const o=`${this.apiUrl}${e}?${n}`,s=await this.caller.call(pe(),o,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(s,`Failed to fetch ${e}`);const c=r?r(await s.json()):await s.json();if(c.length===0||(yield c,c.length<i))break;a+=c.length}}async*_getCursorPaginatedList(e,n=null,r="POST",a="runs"){const i=n?{...n}:{};for(;;){const o=await(await this.caller.call(pe(),`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(i)})).json();if(!o||!o[a])break;yield o[a];const s=o.cursors;if(!s||!s.next)break;i.cursor=s.next}}_filterForSampling(e,n=!1){if(this.tracingSampleRate===void 0)return e;if(n){const r=[];for(const a of e)this.filteredPostUuids.has(a.id)?this.filteredPostUuids.delete(a.id):r.push(a);return r}else{const r=[];for(const a of e)a.id!==a.trace_id&&!this.filteredPostUuids.has(a.trace_id)||Math.random()<this.tracingSampleRate?r.push(a):this.filteredPostUuids.add(a.id);return r}}async drainAutoBatchQueue(){for(;this.autoBatchQueue.size>=0;){const[e,n]=this.autoBatchQueue.pop(this.pendingAutoBatchedRunLimit);if(!e.length){n();return}try{await this.batchIngestRuns({runCreates:e.filter(r=>r.action==="create").map(r=>r.item),runUpdates:e.filter(r=>r.action==="update").map(r=>r.item)})}finally{n()}}}async processRunOperation(e,n){const r=this.autoBatchTimeout;clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0;const a=this.autoBatchQueue.push(e);return(n||this.autoBatchQueue.size>this.pendingAutoBatchedRunLimit)&&await this.drainAutoBatchQueue().catch(console.error),this.autoBatchQueue.size>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue().catch(console.error)},r?this.autoBatchAggregationDelayMs:this.autoBatchInitialDelayMs)),a}async _getServerInfo(){const e=await pe()(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(e,"get server info"),e.json()}async batchEndpointIsSupported(){try{this.serverInfo=await this._getServerInfo()}catch{return!1}return!0}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async createRun(e){if(!this._filterForSampling([e]).length)return;const n={...this.headers,"Content-Type":"application/json"},r=e.project_name;delete e.project_name;const a=this.prepareRunCreateOrUpdateInputs({session_name:r,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&a.trace_id!==void 0&&a.dotted_order!==void 0){this.processRunOperation({action:"create",item:a}).catch(console.error);return}const i=await zb([a]),o=await this.caller.call(pe(),`${this.apiUrl}/runs`,{method:"POST",headers:n,body:qi(i[0]),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(o,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:n}){var l,u;if(e===void 0&&n===void 0)return;let r=(e==null?void 0:e.map(d=>this.prepareRunCreateOrUpdateInputs(d)))??[],a=(n==null?void 0:n.map(d=>this.prepareRunCreateOrUpdateInputs(d)))??[];if(r.length>0&&a.length>0){const d=r.reduce((f,p)=>(p.id&&(f[p.id]=p),f),{}),h=[];for(const f of a)f.id!==void 0&&d[f.id]?d[f.id]={...d[f.id],...f}:h.push(f);r=Object.values(d),a=h}const i={post:this._filterForSampling(r),patch:this._filterForSampling(a,!0)};if(!i.post.length&&!i.patch.length)return;if(r=await zb(r),this.batchEndpointSupported===void 0&&(this.batchEndpointSupported=await this.batchEndpointIsSupported()),!this.batchEndpointSupported){this.autoBatchTracing=!1;for(const d of i.post)await this.createRun(d);for(const d of i.patch)d.id!==void 0&&await this.updateRun(d.id,d);return}const o=((u=(l=this.serverInfo)==null?void 0:l.batch_ingest_config)==null?void 0:u.size_limit_bytes)??FT,s={post:[],patch:[]};let c=0;for(const d of["post","patch"]){const h=d,f=i[h].reverse();let p=f.pop();for(;p!==void 0;){const y=qi(p);c>0&&c+y.length>o&&(await this._postBatchIngestRuns(qi(s)),c=0,s.post=[],s.patch=[]),c+=y.length,s[h].push(p),p=f.pop()}}(s.post.length>0||s.patch.length>0)&&await this._postBatchIngestRuns(qi(s))}async _postBatchIngestRuns(e){const n={...this.headers,"Content-Type":"application/json",Accept:"application/json"},r=await this.batchIngestCaller.call(pe(),`${this.apiUrl}/runs/batch`,{method:"POST",headers:n,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(r,"batch create run",!0)}async updateRun(e,n){Re(e),n.inputs&&(n.inputs=this.processInputs(n.inputs)),n.outputs&&(n.outputs=this.processOutputs(n.outputs));const r={...n,id:e};if(!this._filterForSampling([r],!0).length)return;if(this.autoBatchTracing&&r.trace_id!==void 0&&r.dotted_order!==void 0){if(n.end_time!==void 0&&r.parent_run_id===void 0){await this.processRunOperation({action:"update",item:r},!0);return}else this.processRunOperation({action:"update",item:r}).catch(console.error);return}const a={...this.headers,"Content-Type":"application/json"},i=await this.caller.call(pe(),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:a,body:qi(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(i,"update run",!0)}async readRun(e,{loadChildRuns:n}={loadChildRuns:!1}){Re(e);let r=await this._get(`/runs/${e}`);return n&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:n,projectOpts:r}){if(n!==void 0){let a;n.session_id?a=n.session_id:r!=null&&r.projectName?a=(await this.readProject({projectName:r==null?void 0:r.projectName})).id:r!=null&&r.projectId?a=r==null?void 0:r.projectId:a=(await this.readProject({projectName:Mr("PROJECT")||"default"})).id;const i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/projects/p/${a}/r/${n.id}?poll=true`}else if(e!==void 0){const a=await this.readRun(e);if(!a.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${a.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const n=await LT(this.listRuns({id:e.child_run_ids})),r={},a={};n.sort((i,o)=>((i==null?void 0:i.dotted_order)??"").localeCompare((o==null?void 0:o.dotted_order)??""));for(const i of n){if(i.parent_run_id===null||i.parent_run_id===void 0)throw new Error(`Child run ${i.id} has no parent`);i.parent_run_id in r||(r[i.parent_run_id]=[]),r[i.parent_run_id].push(i),a[i.id]=i}e.child_runs=r[e.id]||[];for(const i in r)i!==e.id&&(a[i].child_runs=r[i]);return e}async*listRuns(e){const{projectId:n,projectName:r,parentRunId:a,traceId:i,referenceExampleId:o,startTime:s,executionOrder:c,isRoot:l,runType:u,error:d,id:h,query:f,filter:p,traceFilter:y,treeFilter:v,limit:x,select:O}=e;let I=[];if(n&&(I=Array.isArray(n)?n:[n]),r){const Z=Array.isArray(r)?r:[r],F=await Promise.all(Z.map(G=>this.readProject({projectName:G}).then(re=>re.id)));I.push(...F)}const A=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],_={session:I.length?I:null,run_type:u,reference_example:o,query:f,filter:p,trace_filter:y,tree_filter:v,execution_order:c,parent_run:a,start_time:s?s.toISOString():null,error:d,id:h,limit:x,trace:i,select:O||A,is_root:l};let U=0;for await(const Z of this._getCursorPaginatedList("/runs/query",_))if(x){if(U>=x)break;if(Z.length+U>x){yield*Z.slice(0,x-U);break}U+=Z.length,yield*Z}else yield*Z}async getRunStats({id:e,trace:n,parentRun:r,runType:a,projectNames:i,projectIds:o,referenceExampleIds:s,startTime:c,endTime:l,error:u,query:d,filter:h,traceFilter:f,treeFilter:p,isRoot:y,dataSourceType:v}){let x=o||[];i&&(x=[...o||[],...await Promise.all(i.map(I=>this.readProject({projectName:I}).then(A=>A.id)))]);const O=Object.fromEntries(Object.entries({id:e,trace:n,parent_run:r,run_type:a,session:x,reference_example:s,start_time:c,end_time:l,error:u,query:d,filter:h,trace_filter:f,tree_filter:p,is_root:y,data_source_type:v}).filter(([I,A])=>A!==void 0));return await(await this.caller.call(pe(),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(O),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:n}={}){const r={run_id:e,share_token:n||St()};Re(e);const a=await(await this.caller.call(pe(),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(a===null||!("share_token"in a))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${a.share_token}/r`}async unshareRun(e){Re(e);const n=await this.caller.call(pe(),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(n,"unshare run",!0)}async readRunSharedLink(e){Re(e);const n=await(await this.caller.call(pe(),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(n===null||!("share_token"in n)))return`${this.getHostUrl()}/public/${n.share_token}/r`}async listSharedRuns(e,{runIds:n}={}){const r=new URLSearchParams({share_token:e});if(n!==void 0)for(const a of n)r.append("id",a);return Re(e),await(await this.caller.call(pe(),`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id),Re(e);const r=await(await this.caller.call(pe(),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return r.url=`${this.getHostUrl()}/public/${r.share_token}/d`,r}async shareDataset(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id);const r={dataset_id:e};Re(e);const a=await(await this.caller.call(pe(),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async unshareDataset(e){Re(e);const n=await this.caller.call(pe(),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(n,"unshare dataset",!0)}async readSharedDataset(e){return Re(e),await(await this.caller.call(pe(),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,n){const r={};n!=null&&n.exampleIds&&(r.id=n.exampleIds);const a=new URLSearchParams;Object.entries(r).forEach(([s,c])=>{Array.isArray(c)?c.forEach(l=>a.append(s,l)):a.append(s,c)});const i=await this.caller.call(pe(),`${this.apiUrl}/public/${e}/examples?${a.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),o=await i.json();if(!i.ok)throw"detail"in o?new Error(`Failed to list shared examples.
Status: ${i.status}
Message: ${o.detail.join(`
`)}`):new Error(`Failed to list shared examples: ${i.status} ${i.statusText}`);return o.map(s=>({...s,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:n=null,metadata:r=null,upsert:a=!1,projectExtra:i=null,referenceDatasetId:o=null}){const s=a?"?upsert=true":"",c=`${this.apiUrl}/sessions${s}`,l=i||{};r&&(l.metadata=r);const u={name:e,extra:l,description:n};o!==null&&(u.reference_dataset_id=o);const d=await this.caller.call(pe(),c,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(d,"create project"),await d.json()}async updateProject(e,{name:n=null,description:r=null,metadata:a=null,projectExtra:i=null,endTime:o=null}){const s=`${this.apiUrl}/sessions/${e}`;let c=i;a&&(c={...c||{},metadata:a});const l={name:n,extra:c,description:r,end_time:o?new Date(o).toISOString():null},u=await this.caller.call(pe(),s,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(u,"update project"),await u.json()}async hasProject({projectId:e,projectName:n}){let r="/sessions";const a=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)Re(e),r+=`/${e}`;else if(n!==void 0)a.append("name",n);else throw new Error("Must provide projectName or projectId");const i=await this.caller.call(pe(),`${this.apiUrl}${r}?${a}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const o=await i.json();return i.ok?Array.isArray(o)?o.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:n,includeStats:r}){let a="/sessions";const i=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)Re(e),a+=`/${e}`;else if(n!==void 0)i.append("name",n);else throw new Error("Must provide projectName or projectId");r!==void 0&&i.append("include_stats",r.toString());const o=await this._get(a,i);let s;if(Array.isArray(o)){if(o.length===0)throw new Error(`Project[id=${e}, name=${n}] not found`);s=o[0]}else s=o;return s}async getProjectUrl({projectId:e,projectName:n}){if(e===void 0&&n===void 0)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:e,projectName:n}),a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:n}){if(e===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:e,datasetName:n}),a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/datasets/${r.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const n of this._getPaginated("/sessions",e))return this._tenantId=n[0].tenant_id,n[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:n,nameContains:r,referenceDatasetId:a,referenceDatasetName:i,referenceFree:o,metadata:s}={}){const c=new URLSearchParams;if(e!==void 0)for(const l of e)c.append("id",l);if(n!==void 0&&c.append("name",n),r!==void 0&&c.append("name_contains",r),a!==void 0)c.append("reference_dataset",a);else if(i!==void 0){const l=await this.readDataset({datasetName:i});c.append("reference_dataset",l.id)}o!==void 0&&c.append("reference_free",o.toString()),s!==void 0&&c.append("metadata",JSON.stringify(s));for await(const l of this._getPaginated("/sessions",c))yield*l}async deleteProject({projectId:e,projectName:n}){let r;if(e===void 0&&n===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:n})).id:r=e,Re(r);const a=await this.caller.call(pe(),`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(a,`delete session ${r} (${n})`,!0)}async uploadCsv({csvFile:e,fileName:n,inputKeys:r,outputKeys:a,description:i,dataType:o,name:s}){const c=`${this.apiUrl}/datasets/upload`,l=new FormData;l.append("file",e,n),r.forEach(d=>{l.append("input_keys",d)}),a.forEach(d=>{l.append("output_keys",d)}),i&&l.append("description",i),o&&l.append("data_type",o),s&&l.append("name",s);const u=await this.caller.call(pe(),c,{method:"POST",headers:this.headers,body:l,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(u,"upload CSV"),await u.json()}async createDataset(e,{description:n,dataType:r,inputsSchema:a,outputsSchema:i,metadata:o}={}){const s={name:e,description:n,extra:o?{metadata:o}:void 0};r&&(s.data_type=r),a&&(s.inputs_schema_definition=a),i&&(s.outputs_schema_definition=i);const c=await this.caller.call(pe(),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(c,"create dataset"),await c.json()}async readDataset({datasetId:e,datasetName:n}){let r="/datasets";const a=new URLSearchParams({limit:"1"});if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)Re(e),r+=`/${e}`;else if(n!==void 0)a.append("name",n);else throw new Error("Must provide datasetName or datasetId");const i=await this._get(r,a);let o;if(Array.isArray(i)){if(i.length===0)throw new Error(`Dataset[id=${e}, name=${n}] not found`);o=i[0]}else o=i;return o}async hasDataset({datasetId:e,datasetName:n}){try{return await this.readDataset({datasetId:e,datasetName:n}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions({datasetId:e,datasetName:n,fromVersion:r,toVersion:a}){let i=e;if(i===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");if(i!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");i===void 0&&(i=(await this.readDataset({datasetName:n})).id);const o=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof a=="string"?a:a.toISOString()});return await this._get(`/datasets/${i}/versions/diff`,o)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:n}){const r="/datasets";if(e===void 0)if(n!==void 0)e=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(a=>JSON.parse(a))}async*listDatasets({limit:e=100,offset:n=0,datasetIds:r,datasetName:a,datasetNameContains:i,metadata:o}={}){const s="/datasets",c=new URLSearchParams({limit:e.toString(),offset:n.toString()});if(r!==void 0)for(const l of r)c.append("id",l);a!==void 0&&c.append("name",a),i!==void 0&&c.append("name_contains",i),o!==void 0&&c.append("metadata",JSON.stringify(o));for await(const l of this._getPaginated(s,c))yield*l}async updateDataset(e){const{datasetId:n,datasetName:r,...a}=e;if(!n&&!r)throw new Error("Must provide either datasetName or datasetId");const i=n??(await this.readDataset({datasetName:r})).id;Re(i);const o=await this.caller.call(pe(),`${this.apiUrl}/datasets/${i}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(o,"update dataset"),await o.json()}async deleteDataset({datasetId:e,datasetName:n}){let r="/datasets",a=e;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(n!==void 0&&(a=(await this.readDataset({datasetName:n})).id),a!==void 0)Re(a),r+=`/${a}`;else throw new Error("Must provide datasetName or datasetId");const i=await this.caller.call(pe(),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(i,`delete ${r}`),await i.json()}async indexDataset({datasetId:e,datasetName:n,tag:r}){let a=e;if(!a&&!n)throw new Error("Must provide either datasetName or datasetId");if(a&&n)throw new Error("Must provide either datasetName or datasetId, not both");a||(a=(await this.readDataset({datasetName:n})).id),Re(a);const i={tag:r},o=await this.caller.call(pe(),`${this.apiUrl}/datasets/${a}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(o,"index dataset"),await o.json()}async similarExamples(e,n,r,{filter:a}={}){const i={limit:r,inputs:e};a!==void 0&&(i.filter=a),Re(n);const o=await this.caller.call(pe(),`${this.apiUrl}/datasets/${n}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(o,"fetch similar examples"),(await o.json()).examples}async createExample(e,n,{datasetId:r,datasetName:a,createdAt:i,exampleId:o,metadata:s,split:c,sourceRunId:l}){var f;let u=r;if(u===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(u!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");u===void 0&&(u=(await this.readDataset({datasetName:a})).id);const d={dataset_id:u,inputs:e,outputs:n,created_at:(f=i||new Date)==null?void 0:f.toISOString(),id:o,metadata:s,split:c,source_run_id:l},h=await this.caller.call(pe(),`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(h,"create example"),await h.json()}async createExamples(e){const{inputs:n,outputs:r,metadata:a,sourceRunIds:i,exampleIds:o,datasetId:s,datasetName:c}=e;let l=s;if(l===void 0&&c===void 0)throw new Error("Must provide either datasetName or datasetId");if(l!==void 0&&c!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");l===void 0&&(l=(await this.readDataset({datasetName:c})).id);const u=n.map((h,f)=>({dataset_id:l,inputs:h,outputs:r?r[f]:void 0,metadata:a?a[f]:void 0,split:e.splits?e.splits[f]:void 0,id:o?o[f]:void 0,source_run_id:i?i[f]:void 0})),d=await this.caller.call(pe(),`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(d,"create examples"),await d.json()}async createLLMExample(e,n,r){return this.createExample({input:e},{output:n},r)}async createChatExample(e,n,r){const a=e.map(o=>Fv(o)?Uv(o):o),i=Fv(n)?Uv(n):n;return this.createExample({input:a},{output:i},r)}async readExample(e){Re(e);const n=`/examples/${e}`;return await this._get(n)}async*listExamples({datasetId:e,datasetName:n,exampleIds:r,asOf:a,splits:i,inlineS3Urls:o,metadata:s,limit:c,offset:l,filter:u}={}){let d;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)d=e;else if(n!==void 0)d=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide a datasetName or datasetId");const h=new URLSearchParams({dataset:d}),f=a?typeof a=="string"?a:a==null?void 0:a.toISOString():void 0;f&&h.append("as_of",f);const p=o??!0;if(h.append("inline_s3_urls",p.toString()),r!==void 0)for(const v of r)h.append("id",v);if(i!==void 0)for(const v of i)h.append("splits",v);if(s!==void 0){const v=JSON.stringify(s);h.append("metadata",v)}c!==void 0&&h.append("limit",c.toString()),l!==void 0&&h.append("offset",l.toString()),u!==void 0&&h.append("filter",u);let y=0;for await(const v of this._getPaginated("/examples",h)){for(const x of v)yield x,y++;if(c!==void 0&&y>=c)break}}async deleteExample(e){Re(e);const n=`/examples/${e}`,r=await this.caller.call(pe(),this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(r,`delete ${n}`),await r.json()}async updateExample(e,n){Re(e);const r=await this.caller.call(pe(),`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(r,"update example"),await r.json()}async updateExamples(e){const n=await this.caller.call(pe(),`${this.apiUrl}/examples/bulk`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(n,"update examples"),await n.json()}async listDatasetSplits({datasetId:e,datasetName:n,asOf:r}){let a;if(e===void 0&&n===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?a=(await this.readDataset({datasetName:n})).id:a=e,Re(a);const i=new URLSearchParams,o=r?typeof r=="string"?r:r==null?void 0:r.toISOString():void 0;return o&&i.append("as_of",o),await this._get(`/datasets/${a}/splits`,i)}async updateDatasetSplits({datasetId:e,datasetName:n,splitName:r,exampleIds:a,remove:i=!1}){let o;if(e===void 0&&n===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?o=(await this.readDataset({datasetName:n})).id:o=e,Re(o);const s={split_name:r,examples:a.map(l=>(Re(l),l)),remove:i},c=await this.caller.call(pe(),`${this.apiUrl}/datasets/${o}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(c,"update dataset splits",!0)}async evaluateRun(e,n,{sourceInfo:r,loadChildRuns:a,referenceExample:i}={loadChildRuns:!1}){Hv("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let o;if(typeof e=="string")o=await this.readRun(e,{loadChildRuns:a});else if(typeof e=="object"&&"id"in e)o=e;else throw new Error(`Invalid run type: ${typeof e}`);o.reference_example_id!==null&&o.reference_example_id!==void 0&&(i=await this.readExample(o.reference_example_id));const s=await n.evaluateRun(o,i),[c,l]=await this._logEvaluationFeedback(s,o,r);return l[0]}async createFeedback(e,n,{score:r,value:a,correction:i,comment:o,sourceInfo:s,feedbackSourceType:c="api",sourceRunId:l,feedbackId:u,feedbackConfig:d,projectId:h,comparativeExperimentId:f}){var O;if(!e&&!h)throw new Error("One of runId or projectId must be provided");if(e&&h)throw new Error("Only one of runId or projectId can be provided");const p={type:c??"api",metadata:s??{}};l!==void 0&&(p==null?void 0:p.metadata)!==void 0&&!p.metadata.__run&&(p.metadata.__run={run_id:l}),(p==null?void 0:p.metadata)!==void 0&&((O=p.metadata.__run)==null?void 0:O.run_id)!==void 0&&Re(p.metadata.__run.run_id);const y={id:u??St(),run_id:e,key:n,score:r,value:a,correction:i,comment:o,feedback_source:p,comparative_experiment_id:f,feedbackConfig:d,session_id:h},v=`${this.apiUrl}/feedback`,x=await this.caller.call(pe(),v,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(y),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(x,"create feedback",!0),y}async updateFeedback(e,{score:n,value:r,correction:a,comment:i}){const o={};n!=null&&(o.score=n),r!=null&&(o.value=r),a!=null&&(o.correction=a),i!=null&&(o.comment=i),Re(e);const s=await this.caller.call(pe(),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(s,"update feedback",!0)}async readFeedback(e){Re(e);const n=`/feedback/${e}`;return await this._get(n)}async deleteFeedback(e){Re(e);const n=`/feedback/${e}`,r=await this.caller.call(pe(),this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(r,`delete ${n}`),await r.json()}async*listFeedback({runIds:e,feedbackKeys:n,feedbackSourceTypes:r}={}){const a=new URLSearchParams;if(e&&a.append("run",e.join(",")),n)for(const i of n)a.append("key",i);if(r)for(const i of r)a.append("source",i);for await(const i of this._getPaginated("/feedback",a))yield*i}async createPresignedFeedbackToken(e,n,{expiration:r,feedbackConfig:a}={}){const i={run_id:e,feedback_key:n,feedback_config:a};return r?typeof r=="string"?i.expires_at=r:(r!=null&&r.hours||r!=null&&r.minutes||r!=null&&r.days)&&(i.expires_in=r):i.expires_in={hours:3},await(await this.caller.call(pe(),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:n,referenceDatasetId:r,createdAt:a,description:i,metadata:o,id:s}){var l;if(n.length===0)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:n[0]})).reference_dataset_id),!r==null)throw new Error("A reference dataset is required");const c={id:s,name:e,experiment_ids:n,reference_dataset_id:r,description:i,created_at:(l=a??new Date)==null?void 0:l.toISOString(),extra:{}};return o&&(c.extra.metadata=o),await(await this.caller.call(pe(),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){Re(e);const n=new URLSearchParams({run_id:e});for await(const r of this._getPaginated("/feedback/tokens",n))yield*r}_selectEvalResults(e){let n;return"results"in e?n=e.results:n=[e],n}async _logEvaluationFeedback(e,n,r){const a=this._selectEvalResults(e),i=[];for(const o of a){let s=r||{};o.evaluatorInfo&&(s={...o.evaluatorInfo,...s});let c=null;o.targetRunId?c=o.targetRunId:n&&(c=n.id),i.push(await this.createFeedback(c,o.key,{score:o.score,value:o.value,comment:o.comment,correction:o.correction,sourceInfo:s,sourceRunId:o.sourceRunId,feedbackConfig:o.feedbackConfig,feedbackSourceType:"model"}))}return[a,i]}async logEvaluationFeedback(e,n,r){const[a]=await this._logEvaluationFeedback(e,n,r);return a}async*listAnnotationQueues(e={}){const{queueIds:n,name:r,nameContains:a,limit:i}=e,o=new URLSearchParams;n&&n.forEach((c,l)=>{Re(c,`queueIds[${l}]`),o.append("ids",c)}),r&&o.append("name",r),a&&o.append("name_contains",a),o.append("limit",(i!==void 0?Math.min(i,100):100).toString());let s=0;for await(const c of this._getPaginated("/annotation-queues",o))if(yield*c,s++,i!==void 0&&s>=i)break}async createAnnotationQueue(e){const{name:n,description:r,queueId:a}=e,i={name:n,description:r,id:a||St()},o=await this.caller.call(pe(),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(i).filter(([s,c])=>c!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(o,"create annotation queue"),await o.json()}async readAnnotationQueue(e){const n=await this.listAnnotationQueues({queueIds:[e]}).next();if(n.done)throw new Error(`Annotation queue with ID ${e} not found`);return n.value}async updateAnnotationQueue(e,n){const{name:r,description:a}=n,i=await this.caller.call(pe(),`${this.apiUrl}/annotation-queues/${Re(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:r,description:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(i,"update annotation queue")}async deleteAnnotationQueue(e){const n=await this.caller.call(pe(),`${this.apiUrl}/annotation-queues/${Re(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(n,"delete annotation queue")}async addRunsToAnnotationQueue(e,n){const r=await this.caller.call(pe(),`${this.apiUrl}/annotation-queues/${Re(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n.map((a,i)=>Re(a,`runIds[${i}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(r,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,n){const r=`/annotation-queues/${Re(e,"queueId")}/run`,a=await this.caller.call(pe(),`${this.apiUrl}${r}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(a,"get run from annotation queue"),await a.json()}async _currentTenantIsOwner(e){const n=await this._getSettings();return e=="-"||n.tenant_handle===e}async _ownerConflictError(e,n){const r=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${n}`)}async _getLatestCommitHash(e){const n=await this.caller.call(pe(),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await n.json();if(!n.ok){const a=typeof r.detail=="string"?r.detail:JSON.stringify(r.detail),i=new Error(`Error ${n.status}: ${n.statusText}
${a}`);throw i.statusCode=n.status,i}if(r.commits.length!==0)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,n){const[r,a,i]=ar(e),o=await this.caller.call(pe(),`${this.apiUrl}/likes/${r}/${a}`,{method:"POST",body:JSON.stringify({like:n}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(o,`${n?"like":"unlike"} prompt`),await o.json()}async _getPromptUrl(e){const[n,r,a]=ar(e);if(await this._currentTenantIsOwner(n)){const i=await this._getSettings();return a!=="latest"?`${this.getHostUrl()}/prompts/${r}/${a.substring(0,8)}?organizationId=${i.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${i.id}`}else return a!=="latest"?`${this.getHostUrl()}/hub/${n}/${r}/${a.substring(0,8)}`:`${this.getHostUrl()}/hub/${n}/${r}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const n of this._getPaginated(`/commits/${e}/`,new URLSearchParams,r=>r.commits))yield*n}async*listPrompts(e){const n=new URLSearchParams;n.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),n.append("sort_direction","desc"),n.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&n.append("is_public",e.isPublic.toString()),e!=null&&e.query&&n.append("query",e.query);for await(const r of this._getPaginated("/repos",n,a=>a.repos))yield*r}async getPrompt(e){const[n,r,a]=ar(e),i=await this.caller.call(pe(),`${this.apiUrl}/repos/${n}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(i.status===404)return null;await Oe(i,"get prompt");const o=await i.json();return o.repo?o.repo:null}async createPrompt(e,n){const r=await this._getSettings();if(n!=null&&n.isPublic&&!r.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[a,i,o]=ar(e);if(!await this._currentTenantIsOwner(a))throw await this._ownerConflictError("create a prompt",a);const s={repo_handle:i,...(n==null?void 0:n.description)&&{description:n.description},...(n==null?void 0:n.readme)&&{readme:n.readme},...(n==null?void 0:n.tags)&&{tags:n.tags},is_public:!!(n!=null&&n.isPublic)},c=await this.caller.call(pe(),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(c,"create prompt");const{repo:l}=await c.json();return l}async createCommit(e,n,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[a,i,o]=ar(e),s=(r==null?void 0:r.parentCommitHash)==="latest"||!(r!=null&&r.parentCommitHash)?await this._getLatestCommitHash(`${a}/${i}`):r==null?void 0:r.parentCommitHash,c={manifest:JSON.parse(JSON.stringify(n)),parent_commit:s},l=await this.caller.call(pe(),`${this.apiUrl}/commits/${a}/${i}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(l,"create commit");const u=await l.json();return this._getPromptUrl(`${a}/${i}${u.commit_hash?`:${u.commit_hash}`:""}`)}async updatePrompt(e,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,a]=ar(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);const i={};if((n==null?void 0:n.description)!==void 0&&(i.description=n.description),(n==null?void 0:n.readme)!==void 0&&(i.readme=n.readme),(n==null?void 0:n.tags)!==void 0&&(i.tags=n.tags),(n==null?void 0:n.isPublic)!==void 0&&(i.is_public=n.isPublic),(n==null?void 0:n.isArchived)!==void 0&&(i.is_archived=n.isArchived),Object.keys(i).length===0)throw new Error("No valid update options provided");const o=await this.caller.call(pe(),`${this.apiUrl}/repos/${r}/${a}`,{method:"PATCH",body:JSON.stringify(i),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Oe(o,"update prompt"),o.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,r,a]=ar(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("delete a prompt",n);return await(await this.caller.call(pe(),`${this.apiUrl}/repos/${n}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,n){const[r,a,i]=ar(e),o=await this._getServerInfo(),s=IT(o.version,"0.5.23");let c=i;if(!s&&i==="latest"){const d=await this._getLatestCommitHash(`${r}/${a}`);if(d)c=d;else throw new Error("No commits found")}const l=await this.caller.call(pe(),`${this.apiUrl}/commits/${r}/${a}/${c}${n!=null&&n.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Oe(l,"pull prompt commit");const u=await l.json();return{owner:r,repo:a,commit_hash:u.commit_hash,manifest:u.manifest,examples:u.examples}}async _pullPrompt(e,n){const r=await this.pullPromptCommit(e,{includeModel:n==null?void 0:n.includeModel});return JSON.stringify(r.manifest)}async pushPrompt(e,n){return await this.promptExists(e)?n&&Object.keys(n).some(r=>r!=="object")&&await this.updatePrompt(e,{description:n==null?void 0:n.description,readme:n==null?void 0:n.readme,tags:n==null?void 0:n.tags,isPublic:n==null?void 0:n.isPublic}):await this.createPrompt(e,{description:n==null?void 0:n.description,readme:n==null?void 0:n.readme,tags:n==null?void 0:n.tags,isPublic:n==null?void 0:n.isPublic}),n!=null&&n.object?await this.createCommit(e,n==null?void 0:n.object,{parentCommitHash:n==null?void 0:n.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,n={}){const{sourceApiUrl:r=this.apiUrl,datasetName:a}=n,[i,o]=this.parseTokenOrUrl(e,r),s=new Ji({apiUrl:i,apiKey:"placeholder"}),c=await s.readSharedDataset(o),l=a||c.name;try{if(await this.hasDataset({datasetId:l})){console.log(`Dataset ${l} already exists in your tenant. Skipping.`);return}}catch{}const u=await s.listSharedExamples(o),d=await this.createDataset(l,{description:c.description,dataType:c.data_type||"kv",inputsSchema:c.inputs_schema_definition??void 0,outputsSchema:c.outputs_schema_definition??void 0});try{await this.createExamples({inputs:u.map(h=>h.inputs),outputs:u.flatMap(h=>h.outputs?[h.outputs]:[]),datasetId:d.id})}catch(h){throw console.error(`An error occurred while creating dataset ${l}. You should delete it manually.`),h}}parseTokenOrUrl(e,n,r=2,a="dataset"){try{return Re(e),[n,e]}catch{}try{const i=new URL(e).pathname.split("/").filter(o=>o!=="");if(i.length>=r){const o=i[i.length-r];return[n,o]}else throw new Error(`Invalid public ${a} URL: ${e}`)}catch{throw new Error(`Invalid public ${a} URL or token: ${e}`)}}}const UT=t=>!!["TRACING_V2","TRACING"].find(e=>Mr(e)==="true");function BT(t){return t.replace(/[-:.]/g,"")}function zT(t,e,n=1){const r=n.toFixed(0).slice(0,3).padStart(3,"0");return BT(`${new Date(t).toISOString().slice(0,-1)}${r}Z`)+e}class ec{constructor(e,n){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=n}static fromHeader(e){const n=e.split(",");let r={},a=[];for(const i of n){const[o,s]=i.split("="),c=decodeURIComponent(s);o==="langsmith-metadata"?r=JSON.parse(c):o==="langsmith-tags"&&(a=c.split(","))}return new ec(r,a)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class Ot{constructor(e){var s;Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const n=Ot.getDefaultConfig(),{metadata:r,...a}=e,i=a.client??Ot.getSharedClient(),o={...r,...(s=a==null?void 0:a.extra)==null?void 0:s.metadata};if(a.extra={...a.extra,metadata:o},Object.assign(this,{...n,...a,client:i}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const c=zT(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+c:this.dotted_order=c}}static getDefaultConfig(){return{id:St(),run_type:"chain",project_name:Lr("LANGCHAIN_PROJECT")??Lr("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:Lr("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:Lr("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return Ot.sharedClient||(Ot.sharedClient=new Ji),Ot.sharedClient}createChild(e){var c,l,u,d,h,f;const n=this.child_execution_order+1,r=new Ot({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:n,child_execution_order:n}),a=Symbol.for("lc:child_config"),i=((c=e.extra)==null?void 0:c[a])??this.extra[a];if(HT(i)){const p={...i},y=ZT(p.callbacks)?(u=(l=p.callbacks).copy)==null?void 0:u.call(l):void 0;y&&(Object.assign(y,{_parentRunId:r.id}),(f=(h=(d=y.handlers)==null?void 0:d.find(Zb))==null?void 0:h.updateFromRunTree)==null||f.call(h,r),p.callbacks=y),r.extra[a]=p}const o=new Set;let s=this;for(;s!=null&&!o.has(s.id);)o.add(s.id),s.child_execution_order=Math.max(s.child_execution_order,n),s=s.parent_run;return this.child_runs.push(r),r}async end(e,n,r=Date.now()){this.outputs=this.outputs??e,this.error=this.error??n,this.end_time=this.end_time??r}_convertToCreate(e,n,r=!0){var s;const a=e.extra??{};if(a.runtime||(a.runtime={}),n)for(const[c,l]of Object.entries(n))a.runtime[c]||(a.runtime[c]=l);let i,o;return r?(o=(s=e.parent_run)==null?void 0:s.id,i=[]):(i=e.child_runs.map(c=>this._convertToCreate(c,n,r)),o=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:a,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:i,parent_run_id:o,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags}}async postRun(e=!0){try{const n=await zv(),r=await this._convertToCreate(this,n,!0);if(await this.client.createRun(r),!e){Hv("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const a of this.child_runs)await a.postRun(!1)}}catch(n){console.error(`Error in postRun for run ${this.id}:`,n)}}async patchRun(){var e;try{const n={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:(e=this.parent_run)==null?void 0:e.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags};await this.client.updateRun(this.id,n)}catch(n){console.error(`Error in patchRun for run ${this.id}`,n)}}toJSON(){return this._convertToCreate(this,void 0,!1)}static fromRunnableConfig(e,n){var c,l,u,d;const r=e==null?void 0:e.callbacks;let a,i,o,s=UT();if(r){const h=((c=r==null?void 0:r.getParentRunId)==null?void 0:c.call(r))??"",f=(l=r==null?void 0:r.handlers)==null?void 0:l.find(p=>(p==null?void 0:p.name)=="langchain_tracer");a=(u=f==null?void 0:f.getRun)==null?void 0:u.call(f,h),i=f==null?void 0:f.projectName,o=f==null?void 0:f.client,s=s||!!f}return a?new Ot({name:a.name,id:a.id,trace_id:a.trace_id,dotted_order:a.dotted_order,client:o,tracingEnabled:s,project_name:i,tags:[...new Set(((a==null?void 0:a.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(d=a==null?void 0:a.extra)==null?void 0:d.metadata,...e==null?void 0:e.metadata}}}).createChild(n):new Ot({...n,client:o,tracingEnabled:s,project_name:i})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,n){var l;const r="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,a=r["langsmith-trace"];if(!a||typeof a!="string")return;const i=a.trim(),o=i.split(".").map(u=>{const[d,h]=u.split("Z");return{strTime:d,time:Date.parse(d+"Z"),uuid:h}}),s=o[0].uuid,c={...n,name:(n==null?void 0:n.name)??"parent",run_type:(n==null?void 0:n.run_type)??"chain",start_time:(n==null?void 0:n.start_time)??Date.now(),id:(l=o.at(-1))==null?void 0:l.uuid,trace_id:s,dotted_order:i};if(r.baggage&&typeof r.baggage=="string"){const u=ec.fromHeader(r.baggage);c.metadata=u.metadata,c.tags=u.tags}return new Ot(c)}toHeaders(e){var r;const n={"langsmith-trace":this.dotted_order,baggage:new ec((r=this.extra)==null?void 0:r.metadata,this.tags).toHeader()};if(e)for(const[a,i]of Object.entries(n))e.set(a,i);return n}}Object.defineProperty(Ot,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function Zb(t){return typeof t=="object"&&t!=null&&typeof t.name=="string"&&t.name==="langchain_tracer"}function Hb(t){return Array.isArray(t)&&t.some(e=>Zb(e))}function ZT(t){return typeof t=="object"&&t!=null&&Array.isArray(t.handlers)}function HT(t){var e;return t!==void 0&&typeof t.callbacks=="object"&&(Hb((e=t.callbacks)==null?void 0:e.handlers)||Hb(t.callbacks))}const Gb="0.1.61";var fh={exports:{}};fh.exports;var Wb;function GT(){return Wb||(Wb=1,function(t){const e=(a=0)=>i=>`\x1B[${38+a};5;${i}m`,n=(a=0)=>(i,o,s)=>`\x1B[${38+a};2;${i};${o};${s}m`;function r(){const a=new Map,i={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};i.color.gray=i.color.blackBright,i.bgColor.bgGray=i.bgColor.bgBlackBright,i.color.grey=i.color.blackBright,i.bgColor.bgGrey=i.bgColor.bgBlackBright;for(const[o,s]of Object.entries(i)){for(const[c,l]of Object.entries(s))i[c]={open:`\x1B[${l[0]}m`,close:`\x1B[${l[1]}m`},s[c]=i[c],a.set(l[0],l[1]);Object.defineProperty(i,o,{value:s,enumerable:!1})}return Object.defineProperty(i,"codes",{value:a,enumerable:!1}),i.color.close="\x1B[39m",i.bgColor.close="\x1B[49m",i.color.ansi256=e(),i.color.ansi16m=n(),i.bgColor.ansi256=e(10),i.bgColor.ansi16m=n(10),Object.defineProperties(i,{rgbToAnsi256:{value:(o,s,c)=>o===s&&s===c?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(s/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:o=>{const s=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!s)return[0,0,0];let{colorString:c}=s.groups;c.length===3&&(c=c.split("").map(u=>u+u).join(""));const l=Number.parseInt(c,16);return[l>>16&255,l>>8&255,l&255]},enumerable:!1},hexToAnsi256:{value:o=>i.rgbToAnsi256(...i.hexToRgb(o)),enumerable:!1}}),i}Object.defineProperty(t,"exports",{enumerable:!0,get:r})}(fh)),fh.exports}var WT=GT();const Vb=Ka(WT);function dt(t,e){return`${t.open}${e}${t.close}`}function jt(t,e){try{return JSON.stringify(t,null,2)}catch{return e}}function qb(t){return typeof t=="string"?t.trim():t==null?t:jt(t,t.toString())}function ir(t){if(!t.end_time)return"";const e=t.end_time-t.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:mt}=Vb;class Jb extends Hi{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const n=[];let r=e;for(;r.parent_run_id;){const a=this.runMap.get(r.parent_run_id);if(a)n.push(a),r=a;else break}return n}getBreadcrumbs(e){const n=[...this.getParents(e).reverse(),e].map((r,a,i)=>{const o=`${r.execution_order}:${r.run_type}:${r.name}`;return a===i.length-1?dt(Vb.bold,o):o}).join(" > ");return dt(mt.grey,n)}onChainStart(e){const n=this.getBreadcrumbs(e);console.log(`${dt(mt.green,"[chain/start]")} [${n}] Entering Chain run with input: ${jt(e.inputs,"[inputs]")}`)}onChainEnd(e){const n=this.getBreadcrumbs(e);console.log(`${dt(mt.cyan,"[chain/end]")} [${n}] [${ir(e)}] Exiting Chain run with output: ${jt(e.outputs,"[outputs]")}`)}onChainError(e){const n=this.getBreadcrumbs(e);console.log(`${dt(mt.red,"[chain/error]")} [${n}] [${ir(e)}] Chain run errored with error: ${jt(e.error,"[error]")}`)}onLLMStart(e){const n=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(a=>a.trim())}:e.inputs;console.log(`${dt(mt.green,"[llm/start]")} [${n}] Entering LLM run with input: ${jt(r,"[inputs]")}`)}onLLMEnd(e){const n=this.getBreadcrumbs(e);console.log(`${dt(mt.cyan,"[llm/end]")} [${n}] [${ir(e)}] Exiting LLM run with output: ${jt(e.outputs,"[response]")}`)}onLLMError(e){const n=this.getBreadcrumbs(e);console.log(`${dt(mt.red,"[llm/error]")} [${n}] [${ir(e)}] LLM run errored with error: ${jt(e.error,"[error]")}`)}onToolStart(e){const n=this.getBreadcrumbs(e);console.log(`${dt(mt.green,"[tool/start]")} [${n}] Entering Tool run with input: "${qb(e.inputs.input)}"`)}onToolEnd(e){var r;const n=this.getBreadcrumbs(e);console.log(`${dt(mt.cyan,"[tool/end]")} [${n}] [${ir(e)}] Exiting Tool run with output: "${qb((r=e.outputs)==null?void 0:r.output)}"`)}onToolError(e){const n=this.getBreadcrumbs(e);console.log(`${dt(mt.red,"[tool/error]")} [${n}] [${ir(e)}] Tool run errored with error: ${jt(e.error,"[error]")}`)}onRetrieverStart(e){const n=this.getBreadcrumbs(e);console.log(`${dt(mt.green,"[retriever/start]")} [${n}] Entering Retriever run with input: ${jt(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const n=this.getBreadcrumbs(e);console.log(`${dt(mt.cyan,"[retriever/end]")} [${n}] [${ir(e)}] Exiting Retriever run with output: ${jt(e.outputs,"[outputs]")}`)}onRetrieverError(e){const n=this.getBreadcrumbs(e);console.log(`${dt(mt.red,"[retriever/error]")} [${n}] [${ir(e)}] Retriever run errored with error: ${jt(e.error,"[error]")}`)}onAgentAction(e){const n=e,r=this.getBreadcrumbs(e);console.log(`${dt(mt.blue,"[agent/action]")} [${r}] Agent selected action: ${jt(n.actions[n.actions.length-1],"[action]")}`)}}function Kb(t){return!!(t&&typeof t=="object"&&"type"in t&&t.type==="tool_call")}class VT extends Error{constructor(e,n){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=n}}sw=function(t,e=Rc){t=t.trim();const n=/```(json)?(.*)```/s.exec(t);return e(n?n[2]:t)},Rc=function(t){if(typeof t>"u")return null;try{return JSON.parse(t)}catch{}let e="";const n=[];let r=!1,a=!1;for(let i of t){if(r)i==='"'&&!a?r=!1:i===`
`&&!a?i="\\n":i==="\\"?a=!a:a=!1;else if(i==='"')r=!0,a=!1;else if(i==="{")n.push("}");else if(i==="[")n.push("]");else if(i==="}"||i==="]")if(n&&n[n.length-1]===i)n.pop();else return null;e+=i}r&&(e+='"');for(let i=n.length-1;i>=0;i-=1)e+=n[i];try{return JSON.parse(e)}catch{return null}};function Ca(t,e){return typeof t=="string"?typeof e=="string"?t+e:[{type:"text",text:t},...e]:Array.isArray(e)?tc(t,e)??[...t,...e]:[...t,{type:"text",text:e}]}function qT(t,e){return t==="error"||e==="error"?"error":"success"}function JT(t,e){function n(r,a){if(typeof r!="object"||r===null||r===void 0)return r;if(a>=e)return Array.isArray(r)?"[Array]":"[Object]";if(Array.isArray(r))return r.map(o=>n(o,a+1));const i={};for(const o of Object.keys(r))i[o]=n(r[o],a+1);return i}return JSON.stringify(n(t,0),null,2)}class ja extends wr{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:""}constructor(e,n){typeof e=="string"&&(e={content:e,additional_kwargs:n,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const n=JT(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${n}`}}function ht(t,e){const n={...t};for(const[r,a]of Object.entries(e))if(n[r]==null)n[r]=a;else{if(a==null)continue;if(typeof n[r]!=typeof a||Array.isArray(n[r])!==Array.isArray(a))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if(typeof n[r]=="string"){if(r==="type")continue;n[r]+=a}else if(typeof n[r]=="object"&&!Array.isArray(n[r]))n[r]=ht(n[r],a);else if(Array.isArray(n[r]))n[r]=tc(n[r],a);else{if(n[r]===a)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}}return n}function tc(t,e){if(!(t===void 0&&e===void 0)){if(t===void 0||e===void 0)return t||e;{const n=[...t];for(const r of e)if(typeof r=="object"&&"index"in r&&typeof r.index=="number"){const a=n.findIndex(i=>i.index===r.index);a!==-1?n[a]=ht(n[a],r):n.push(r)}else{if(typeof r=="object"&&"text"in r&&r.text==="")continue;n.push(r)}return n}}}function KT(t,e){if(!t&&!e)throw new Error("Cannot merge two undefined objects.");if(!t||!e)return t||e;if(typeof t!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof t}
Right ${typeof e}`);if(typeof t=="string"&&typeof e=="string")return t+e;if(Array.isArray(t)&&Array.isArray(e))return tc(t,e);if(typeof t=="object"&&typeof e=="object")return ht(t,e);if(t===e)return t;throw new Error(`Can not merge objects of different types.
Left ${t}
Right ${e}`)}class Aa extends ja{}function YT(t){return typeof t.role=="string"}Tc=function(t){return typeof(t==null?void 0:t._getType)=="function"},iw=function(t){return Tc(t)&&typeof t.concat=="function"};class XT extends ja{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,n,r){typeof e=="string"&&(e={content:e,name:r,tool_call_id:n}),super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}uf=class extends Aa{constructor(t){super(t),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=t.tool_call_id,this.artifact=t.artifact,this.status=t.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(t){return new uf({content:Ca(this.content,t.content),additional_kwargs:ht(this.additional_kwargs,t.additional_kwargs),response_metadata:ht(this.response_metadata,t.response_metadata),artifact:KT(this.artifact,t.artifact),tool_call_id:this.tool_call_id,id:this.id??t.id,status:qT(this.status,t.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}};function QT(t){const e=[],n=[];for(const r of t)if(r.function){const a=r.function.name;try{const i=JSON.parse(r.function.arguments),o={name:a||"",args:i||{},id:r.id};e.push(o)}catch{n.push({name:a,args:r.function.arguments,id:r.id,error:"Malformed args."})}}else continue;return[e,n]}wo=class extends ja{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(t,e){var r;let n;if(typeof t=="string")n={content:t,tool_calls:[],invalid_tool_calls:[],additional_kwargs:e??{}};else{n=t;const a=(r=n.additional_kwargs)==null?void 0:r.tool_calls,i=n.tool_calls;a!=null&&a.length>0&&(i===void 0||i.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(a!=null&&i===void 0){const[o,s]=QT(a);n.tool_calls=o??[],n.invalid_tool_calls=s??[]}else n.tool_calls=n.tool_calls??[],n.invalid_tool_calls=n.invalid_tool_calls??[]}catch{n.tool_calls=[],n.invalid_tool_calls=[]}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof n!="string"&&(this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=n.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}},cw=function(t){return t._getType()==="ai"},Qa=class extends Aa{constructor(t){let e;if(typeof t=="string")e={content:t,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(t.tool_call_chunks===void 0)e={...t,tool_calls:t.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[]};else{const n=[],r=[];for(const a of t.tool_call_chunks){let i={};try{if(i=Rc(a.args||"{}"),i===null||typeof i!="object"||Array.isArray(i))throw new Error("Malformed tool call chunk args.");n.push({name:a.name??"",args:i,id:a.id,type:"tool_call"})}catch{r.push({name:a.name,args:a.args,id:a.id,error:"Malformed args.",type:"invalid_tool_call"})}}e={...t,tool_calls:n,invalid_tool_calls:r}}super(e),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=e.tool_call_chunks??this.tool_call_chunks,this.tool_calls=e.tool_calls??this.tool_calls,this.invalid_tool_calls=e.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=e.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(t){const e={content:Ca(this.content,t.content),additional_kwargs:ht(this.additional_kwargs,t.additional_kwargs),response_metadata:ht(this.response_metadata,t.response_metadata),tool_call_chunks:[],id:this.id??t.id};if(this.tool_call_chunks!==void 0||t.tool_call_chunks!==void 0){const n=tc(this.tool_call_chunks,t.tool_call_chunks);n!==void 0&&n.length>0&&(e.tool_call_chunks=n)}if(this.usage_metadata!==void 0||t.usage_metadata!==void 0){const n=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},r=t.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},a={input_tokens:n.input_tokens+r.input_tokens,output_tokens:n.output_tokens+r.output_tokens,total_tokens:n.total_tokens+r.total_tokens};e.usage_metadata=a}return new Qa(e)}},Pc=class extends ja{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return Pc}constructor(t,e){typeof t=="string"&&(t={content:t,role:e}),super(t),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=t.role}_getType(){return"generic"}static isInstance(t){return t._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}},Dc=class extends Aa{static lc_name(){return"ChatMessageChunk"}constructor(t,e){typeof t=="string"&&(t={content:t,role:e}),super(t),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=t.role}_getType(){return"generic"}concat(t){return new Dc({content:Ca(this.content,t.content),additional_kwargs:ht(this.additional_kwargs,t.additional_kwargs),response_metadata:ht(this.response_metadata,t.response_metadata),role:this.role,id:this.id??t.id})}get _printableFields(){return{...super._printableFields,role:this.role}}},Mc=class extends Aa{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(t){return new Mc({content:Ca(this.content,t.content),additional_kwargs:ht(this.additional_kwargs,t.additional_kwargs),response_metadata:ht(this.response_metadata,t.response_metadata),name:this.name??"",id:this.id??t.id})}},_o=class extends ja{static lc_name(){return"HumanMessage"}_getType(){return"human"}},$c=class extends Aa{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(t){return new $c({content:Ca(this.content,t.content),additional_kwargs:ht(this.additional_kwargs,t.additional_kwargs),response_metadata:ht(this.response_metadata,t.response_metadata),id:this.id??t.id})}},kc=class extends ja{static lc_name(){return"SystemMessage"}_getType(){return"system"}},Lc=class extends Aa{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(t){return new Lc({content:Ca(this.content,t.content),additional_kwargs:ht(this.additional_kwargs,t.additional_kwargs),response_metadata:ht(this.response_metadata,t.response_metadata),id:this.id??t.id})}};function eR(t){return Kb(t)?t:typeof t.id=="string"&&t.type==="function"&&typeof t.function=="object"&&t.function!==null&&"arguments"in t.function&&typeof t.function.arguments=="string"&&"name"in t.function&&typeof t.function.name=="string"?{id:t.id,args:JSON.parse(t.function.arguments),name:t.function.name,type:"tool_call"}:t}function ph(t){const{type:e,...n}=t;if(e==="human"||e==="user")return new _o(n);if(e==="ai"||e==="assistant"){const{tool_calls:r,...a}=n;if(!Array.isArray(r))return new wo(n);const i=r.map(eR);return new wo({...a,tool_calls:i})}else{if(e==="system")return new kc(n);if(e==="tool"&&"tool_call_id"in n)return new XT({...n,content:n.content,tool_call_id:n.tool_call_id,name:n.name});throw new Error("Unable to coerce message from array: only human, AI, or system message coercion is currently supported.")}}rw=function(t){if(typeof t=="string")return new _o(t);if(Tc(t))return t;if(Array.isArray(t)){const[e,n]=t;return ph({type:e,content:n})}else if(YT(t)){const{role:e,...n}=t;return ph({...n,type:e})}else return ph(t)},Fh=function(t,e="Human",n="AI"){const r=[];for(const a of t){let i;if(a._getType()==="human")i=e;else if(a._getType()==="ai")i=n;else if(a._getType()==="system")i="System";else if(a._getType()==="function")i="Function";else if(a._getType()==="tool")i="Tool";else if(a._getType()==="generic")i=a.role;else throw new Error(`Got unsupported message type: ${a._getType()}`);const o=a.name?`${a.name}, `:"",s=typeof a.content=="string"?a.content:JSON.stringify(a.content,null,2);r.push(`${i}: ${o}${s}`)}return r.join(`
`)},ow=function(t){var n;const e=t._getType();if(e==="human")return new $c({...t});if(e==="ai"){let r={...t};return"tool_calls"in r&&(r={...r,tool_call_chunks:(n=r.tool_calls)==null?void 0:n.map(a=>({...a,type:"tool_call_chunk",index:void 0,args:JSON.stringify(a.args)}))}),new Qa({...r})}else{if(e==="system")return new Lc({...t});if(e==="function")return new Mc({...t});if(Pc.isInstance(t))return new Dc({...t});throw new Error("Unknown message type.")}};class Ki extends Hi{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:n,projectName:r,client:a}=e;this.projectName=r??_r("LANGCHAIN_PROJECT")??_r("LANGCHAIN_SESSION"),this.exampleId=n,this.client=a??new Ji({});const i=Ki.getTraceableRunTree();i&&this.updateFromRunTree(i)}async _convertToCreate(e,n=void 0){return{...e,extra:{...e.extra,runtime:await $k()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:n}}async persistRun(e){}async onRunCreate(e){const n=await this._convertToCreate(e,this.exampleId);await this.client.createRun(n)}async onRunUpdate(e){const n={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id};await this.client.updateRun(e.id,n)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let n=e;const r=new Set;for(;n.parent_run&&!(r.has(n.id)||(r.add(n.id),!n.parent_run));)n=n.parent_run;r.clear();const a=[n];for(;a.length>0;){const i=a.shift();!i||r.has(i.id)||(r.add(i.id),this.runMap.set(i.id,i),i.child_runs&&a.push(...i.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const n={},r=[];for(const[a,i]of this.runMap){const o=new Ot({...i,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});n[a]=o,r.push([a,i.dotted_order])}r.sort((a,i)=>!a[1]||!i[1]?0:a[1].localeCompare(i[1]));for(const[a]of r){const i=this.runMap.get(a),o=n[a];if(!(!i||!o)&&i.parent_run_id){const s=n[i.parent_run_id];s&&(s.child_runs.push(o),o.parent_run=s)}}return n[e]}static getTraceableRunTree(){try{return fk()}catch{return}}}let mh;function tR(){const t="default"in $n?$n.default:$n;return new t({autoStart:!0,concurrency:1})}async function et(t,e){e===!0?await t():(typeof mh>"u"&&(mh=tR()),mh.add(t))}const nR=t=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(e=>_r(e)==="true");function rR(t){return t?Array.isArray(t)||"name"in t?{callbacks:t}:t:{}}class aR{setHandler(e){return this.setHandlers([e])}}class nc{constructor(e,n,r,a,i,o,s,c){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:c})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(n=>et(async()=>{var r;try{await((r=n.handleText)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(a){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleText: ${a}`),n.raiseError)throw a}},n.awaitHandlers)))}async handleCustomEvent(e,n,r,a,i){await Promise.all(this.handlers.map(o=>et(async()=>{var s;try{await((s=o.handleCustomEvent)==null?void 0:s.call(o,e,n,this.runId,this.tags,this.metadata))}catch(c){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${c}`),o.raiseError)throw c}},o.awaitHandlers)))}}class iR extends nc{getChild(e){const n=new Lt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(n=>et(async()=>{var r;if(!n.ignoreRetriever)try{await((r=n.handleRetrieverEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(a){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleRetriever`),n.raiseError)throw a}},n.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(n=>et(async()=>{var r;if(!n.ignoreRetriever)try{await((r=n.handleRetrieverError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(a){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleRetrieverError: ${a}`),n.raiseError)throw e}},n.awaitHandlers)))}}class Yb extends nc{async handleLLMNewToken(e,n,r,a,i,o){await Promise.all(this.handlers.map(s=>et(async()=>{var c;if(!s.ignoreLLM)try{await((c=s.handleLLMNewToken)==null?void 0:c.call(s,e,n??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,o))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleLLMNewToken: ${l}`),s.raiseError)throw l}},s.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(n=>et(async()=>{var r;if(!n.ignoreLLM)try{await((r=n.handleLLMError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(a){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleLLMError: ${a}`),n.raiseError)throw a}},n.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(n=>et(async()=>{var r;if(!n.ignoreLLM)try{await((r=n.handleLLMEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(a){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleLLMEnd: ${a}`),n.raiseError)throw a}},n.awaitHandlers)))}}class oR extends nc{getChild(e){const n=new Lt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleChainError(e,n,r,a,i){await Promise.all(this.handlers.map(o=>et(async()=>{var s;if(!o.ignoreChain)try{await((s=o.handleChainError)==null?void 0:s.call(o,e,this.runId,this._parentRunId,this.tags,i))}catch(c){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainError: ${c}`),o.raiseError)throw c}},o.awaitHandlers)))}async handleChainEnd(e,n,r,a,i){await Promise.all(this.handlers.map(o=>et(async()=>{var s;if(!o.ignoreChain)try{await((s=o.handleChainEnd)==null?void 0:s.call(o,e,this.runId,this._parentRunId,this.tags,i))}catch(c){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainEnd: ${c}`),o.raiseError)throw c}},o.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(n=>et(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleAgentAction)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(a){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleAgentAction: ${a}`),n.raiseError)throw a}},n.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(n=>et(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleAgentEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(a){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleAgentEnd: ${a}`),n.raiseError)throw a}},n.awaitHandlers)))}}class sR extends nc{getChild(e){const n=new Lt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleToolError(e){await Promise.all(this.handlers.map(n=>et(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleToolError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(a){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleToolError: ${a}`),n.raiseError)throw a}},n.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(n=>et(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleToolEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(a){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleToolEnd: ${a}`),n.raiseError)throw a}},n.awaitHandlers)))}}Lt=class extends aR{constructor(t,e){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(e==null?void 0:e.handlers)??this.handlers,this.inheritableHandlers=(e==null?void 0:e.inheritableHandlers)??this.inheritableHandlers,this.tags=(e==null?void 0:e.tags)??this.tags,this.inheritableTags=(e==null?void 0:e.inheritableTags)??this.inheritableTags,this.metadata=(e==null?void 0:e.metadata)??this.metadata,this.inheritableMetadata=(e==null?void 0:e.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=t}getParentRunId(){return this._parentRunId}async handleLLMStart(t,e,n=void 0,r=void 0,a=void 0,i=void 0,o=void 0,s=void 0){return Promise.all(e.map(async(c,l)=>{const u=l===0&&n?n:St();return await Promise.all(this.handlers.map(d=>{if(!d.ignoreLLM)return Zi(d)&&d._createRunForLLMStart(t,[c],u,this._parentRunId,a,this.tags,this.metadata,s),et(async()=>{var h;try{await((h=d.handleLLMStart)==null?void 0:h.call(d,t,[c],u,this._parentRunId,a,this.tags,this.metadata,s))}catch(f){if((d.raiseError?console.error:console.warn)(`Error in handler ${d.constructor.name}, handleLLMStart: ${f}`),d.raiseError)throw f}},d.awaitHandlers)})),new Yb(u,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(t,e,n=void 0,r=void 0,a=void 0,i=void 0,o=void 0,s=void 0){return Promise.all(e.map(async(c,l)=>{const u=l===0&&n?n:St();return await Promise.all(this.handlers.map(d=>{if(!d.ignoreLLM)return Zi(d)&&d._createRunForChatModelStart(t,[c],u,this._parentRunId,a,this.tags,this.metadata,s),et(async()=>{var h,f;try{if(d.handleChatModelStart)await((h=d.handleChatModelStart)==null?void 0:h.call(d,t,[c],u,this._parentRunId,a,this.tags,this.metadata,s));else if(d.handleLLMStart){const p=Fh(c);await((f=d.handleLLMStart)==null?void 0:f.call(d,t,[p],u,this._parentRunId,a,this.tags,this.metadata,s))}}catch(p){if((d.raiseError?console.error:console.warn)(`Error in handler ${d.constructor.name}, handleLLMStart: ${p}`),d.raiseError)throw p}},d.awaitHandlers)})),new Yb(u,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(t,e,n=St(),r=void 0,a=void 0,i=void 0,o=void 0){return await Promise.all(this.handlers.map(s=>{if(!s.ignoreChain)return Zi(s)&&s._createRunForChainStart(t,e,n,this._parentRunId,this.tags,this.metadata,r,o),et(async()=>{var c;try{await((c=s.handleChainStart)==null?void 0:c.call(s,t,e,n,this._parentRunId,this.tags,this.metadata,r,o))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleChainStart: ${l}`),s.raiseError)throw l}},s.awaitHandlers)})),new oR(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(t,e,n=St(),r=void 0,a=void 0,i=void 0,o=void 0){return await Promise.all(this.handlers.map(s=>{if(!s.ignoreAgent)return Zi(s)&&s._createRunForToolStart(t,e,n,this._parentRunId,this.tags,this.metadata,o),et(async()=>{var c;try{await((c=s.handleToolStart)==null?void 0:c.call(s,t,e,n,this._parentRunId,this.tags,this.metadata,o))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleToolStart: ${l}`),s.raiseError)throw l}},s.awaitHandlers)})),new sR(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(t,e,n=St(),r=void 0,a=void 0,i=void 0,o=void 0){return await Promise.all(this.handlers.map(s=>{if(!s.ignoreRetriever)return Zi(s)&&s._createRunForRetrieverStart(t,e,n,this._parentRunId,this.tags,this.metadata,o),et(async()=>{var c;try{await((c=s.handleRetrieverStart)==null?void 0:c.call(s,t,e,n,this._parentRunId,this.tags,this.metadata,o))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleRetrieverStart: ${l}`),s.raiseError)throw l}},s.awaitHandlers)})),new iR(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(t,e,n,r,a){await Promise.all(this.handlers.map(i=>et(async()=>{var o;if(!i.ignoreCustomEvent)try{await((o=i.handleCustomEvent)==null?void 0:o.call(i,t,e,n,this.tags,this.metadata))}catch(s){if((i.raiseError?console.error:console.warn)(`Error in handler ${i.constructor.name}, handleCustomEvent: ${s}`),i.raiseError)throw s}},i.awaitHandlers)))}addHandler(t,e=!0){this.handlers.push(t),e&&this.inheritableHandlers.push(t)}removeHandler(t){this.handlers=this.handlers.filter(e=>e!==t),this.inheritableHandlers=this.inheritableHandlers.filter(e=>e!==t)}setHandlers(t,e=!0){this.handlers=[],this.inheritableHandlers=[];for(const n of t)this.addHandler(n,e)}addTags(t,e=!0){this.removeTags(t),this.tags.push(...t),e&&this.inheritableTags.push(...t)}removeTags(t){this.tags=this.tags.filter(e=>!t.includes(e)),this.inheritableTags=this.inheritableTags.filter(e=>!t.includes(e))}addMetadata(t,e=!0){this.metadata={...this.metadata,...t},e&&(this.inheritableMetadata={...this.inheritableMetadata,...t})}removeMetadata(t){for(const e of Object.keys(t))delete this.metadata[e],delete this.inheritableMetadata[e]}copy(t=[],e=!0){const n=new Lt(this._parentRunId);for(const r of this.handlers){const a=this.inheritableHandlers.includes(r);n.addHandler(r,a)}for(const r of this.tags){const a=this.inheritableTags.includes(r);n.addTags([r],a)}for(const r of Object.keys(this.metadata)){const a=Object.keys(this.inheritableMetadata).includes(r);n.addMetadata({[r]:this.metadata[r]},a)}for(const r of t)n.handlers.filter(a=>a.name==="console_callback_handler").some(a=>a.name===r.name)||n.addHandler(r,e);return n}static fromHandlers(t){class e extends zi{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:St()}),Object.assign(this,t)}}const n=new this;return n.addHandler(new e),n}static configure(t,e,n,r,a,i,o){return this._configureSync(t,e,n,r,a,i,o)}static _configureSync(t,e,n,r,a,i,o){var d,h;let s;(t||e)&&(Array.isArray(t)||!t?(s=new Lt,s.setHandlers((t==null?void 0:t.map(rc))??[],!0)):s=t,s=s.copy(Array.isArray(e)?e.map(rc):e==null?void 0:e.handlers,!1));const c=_r("LANGCHAIN_VERBOSE")==="true"||(o==null?void 0:o.verbose),l=((d=Ki.getTraceableRunTree())==null?void 0:d.tracingEnabled)||nR(),u=l||(_r("LANGCHAIN_TRACING")??!1);if(c||u){if(s||(s=new Lt),c&&!s.handlers.some(f=>f.name===Jb.prototype.name)){const f=new Jb;s.addHandler(f,!0)}if(u&&!s.handlers.some(f=>f.name==="langchain_tracer")&&l){const f=new Ki;s.addHandler(f,!0),s._parentRunId=((h=Ki.getTraceableRunTree())==null?void 0:h.id)??s._parentRunId}}return(n||r)&&s&&(s.addTags(n??[]),s.addTags(r??[],!1)),(a||i)&&s&&(s.addMetadata(a??{}),s.addMetadata(i??{},!1)),s}};function rc(t){return"name"in t?t:zi.fromMethods(t)}class cR{getStore(){}run(e,n){return n()}}const lR=new cR,gh=Symbol.for("ls:tracing_async_local_storage"),Xb=Symbol.for("lc:child_config");class uR{getInstance(){return globalThis[gh]??lR}getRunnableConfig(){var e,n;return(n=(e=this.getInstance().getStore())==null?void 0:e.extra)==null?void 0:n[Xb]}runWithConfig(e,n,r){var l;const a=Lt._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),i=this.getInstance(),o=a==null?void 0:a.getParentRunId(),s=(l=a==null?void 0:a.handlers)==null?void 0:l.find(u=>(u==null?void 0:u.name)==="langchain_tracer");let c;return s&&o?c=s.convertToRunTree(o):r||(c=new Ot({name:"<runnable_lambda>",tracingEnabled:!1})),c&&(c.extra={...c.extra,[Xb]:e}),i.run(c,n)}initializeGlobalInstance(e){globalThis[gh]===void 0&&(globalThis[gh]=e)}}const Dr=new uR;async function or(t,e){if(e===void 0)return t;let n;return Promise.race([t.catch(r=>{if(!(e!=null&&e.aborted))throw r}),new Promise((r,a)=>{n=()=>{a(new Error("Aborted"))},e.addEventListener("abort",n),e.aborted&&a(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",n))}class kt extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const n=this.reader.cancel();this.reader.releaseLock(),await n}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const n=e.getReader();return new kt({start(r){return a();function a(){return n.read().then(({done:i,value:o})=>{if(i){r.close();return}return r.enqueue(o),a()})}},cancel(){n.releaseLock()}})}static fromAsyncGenerator(e){return new kt({async pull(n){const{value:r,done:a}=await e.next();a&&n.close(),n.enqueue(r)},async cancel(n){await e.return(n)}})}}function Qb(t,e=2){const n=Array.from({length:e},()=>[]);return n.map(async function*(r){for(;;)if(r.length===0){const a=await t.next();for(const i of n)i.push(a)}else{if(r[0].done)return;yield r.shift().value}})}on=function(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);if(typeof t=="string"&&typeof e=="string"||typeof t=="number"&&typeof e=="number")return t+e;if("concat"in t&&typeof t.concat=="function")return t.concat(e);if(typeof t=="object"&&typeof e=="object"){const n={...t};for(const[r,a]of Object.entries(e))r in n&&!Array.isArray(n[r])?n[r]=on(n[r],a):n[r]=a;return n}else throw new Error(`Cannot concat ${typeof t} and ${typeof e}`)};class Pa{constructor(e){var n;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((n=this.config)==null?void 0:n.signal),this.setup=new Promise((r,a)=>{Dr.runWithConfig(e.config,async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(r,a):this.firstResult.then(i=>r(void 0),a)},!0)})}async next(...e){var n;return(n=this.signal)==null||n.throwIfAborted(),this.firstResultUsed?Dr.runWithConfig(this.config,this.signal?async()=>or(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function dR(t,e,n,r,...a){const i=new Pa({generator:e,startSetup:n,signal:r}),o=await i.setup;return{output:t(i,o,...a),setup:o}}class sr{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const n=this.ops.concat(e.ops),r=Bs({},n);return new Yi({ops:n,state:r[r.length-1].newDocument})}}class Yi extends sr{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const n=this.ops.concat(e.ops),r=Bs(this.state,e.ops);return new Yi({ops:n,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){const n=Bs({},e.ops);return new Yi({ops:e.ops,state:n[n.length-1].newDocument})}}Zh=t=>t.name==="log_stream_tracer";async function e0(t,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:n}=t;if(["retriever","llm","prompt"].includes(t.run_type))return n;if(!(Object.keys(n).length===1&&(n==null?void 0:n.input)===""))return n.input}async function t0(t,e){const{outputs:n}=t;return e==="original"||["retriever","llm","prompt"].includes(t.run_type)?n:n!==void 0&&Object.keys(n).length===1&&(n==null?void 0:n.output)!==void 0?n.output:n}function hR(t){return t!==void 0&&t.message!==void 0}class n0 extends Hi{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=kt.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const n=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(r=r||n.find(a=>{var i;return(i=this.includeTags)==null?void 0:i.includes(a)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(r=r&&n.every(a=>{var i;return!((i=this.excludeTags)!=null&&i.includes(a))})),r}async*tapOutputIterable(e,n){for await(const r of n){if(e!==this.rootId){const a=this.keyMapByRunId[e];a&&await this.writer.write(new sr({ops:[{op:"add",path:`/logs/${a}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){var a;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new sr({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const n=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=n===1?e.name:`${e.name}:${n}`;const r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(r.inputs=await e0(e,this._schemaFormat)),await this.writer.write(new sr({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{const n=this.keyMapByRunId[e.id];if(n===void 0)return;const r=[];this._schemaFormat==="streaming_events"&&r.push({op:"replace",path:`/logs/${n}/inputs`,value:await e0(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${n}/final_output`,value:await t0(e,this._schemaFormat)}),e.end_time!==void 0&&r.push({op:"add",path:`/logs/${n}/end_time`,value:new Date(e.end_time).toISOString()});const a=new sr({ops:r});await this.writer.write(a)}finally{if(e.id===this.rootId){const n=new sr({ops:[{op:"replace",path:"/final_output",value:await t0(e,this._schemaFormat)}]});await this.writer.write(n),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,n,r){const a=this.keyMapByRunId[e.id];if(a===void 0)return;const i=e.inputs.messages!==void 0;let o;i?hR(r==null?void 0:r.chunk)?o=r==null?void 0:r.chunk:o=new Qa({id:`run-${e.id}`,content:n}):o=n;const s=new sr({ops:[{op:"add",path:`/logs/${a}/streamed_output_str/-`,value:n},{op:"add",path:`/logs/${a}/streamed_output/-`,value:o}]});await this.writer.write(s)}}aw="__run",Xa=class{constructor(t){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=t.text,this.generationInfo=t.generationInfo}concat(t){return new Xa({text:this.text+t.text,generationInfo:{...this.generationInfo,...t.generationInfo}})}},Vh=class extends Xa{constructor(t){super(t),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=t.message}concat(t){return new Vh({text:this.text+t.text,generationInfo:{...this.generationInfo,...t.generationInfo},message:this.message.concat(t.message)})}};function ac({name:t,serialized:e}){return t!==void 0?t:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}zh=t=>t.name==="event_stream_tracer";class fR extends Hi{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=kt.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const n=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(r=r||n.find(a=>{var i;return(i=this.includeTags)==null?void 0:i.includes(a)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(r=r&&n.every(a=>{var i;return!((i=this.excludeTags)!=null&&i.includes(a))})),r}async*tapOutputIterable(e,n){const r=await n.next();if(r.done)return;const a=this.runInfoMap.get(e);if(a===void 0){yield r.value;return}function i(s,c){return s==="llm"&&typeof c=="string"?new Xa({text:c}):c}let o=this.tappedPromises.get(e);if(o===void 0){let s;o=new Promise(c=>{s=c}),this.tappedPromises.set(e,o);try{const c={event:`on_${a.runType}_stream`,run_id:e,name:a.name,tags:a.tags,metadata:a.metadata,data:{}};await this.send({...c,data:{chunk:i(a.runType,r.value)}},a),yield r.value;for await(const l of n)a.runType!=="tool"&&a.runType!=="retriever"&&await this.send({...c,data:{chunk:i(a.runType,l)}},a),yield l}finally{s()}}else{yield r.value;for await(const s of n)yield s}}async send(e,n){this._includeRun(n)&&await this.writer.write(e)}async sendEndEvent(e,n){const r=this.tappedPromises.get(e.run_id);r!==void 0?r.then(()=>{this.send(e,n)}):await this.send(e,n)}async onLLMStart(e){var o,s;const n=ac(e),r=e.inputs.messages!==void 0?"chat_model":"llm",a={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:n,runType:r,inputs:e.inputs};this.runInfoMap.set(e.id,a);const i=`on_${r}_start`;await this.send({event:i,data:{input:e.inputs},name:n,tags:e.tags??[],run_id:e.id,metadata:((s=e.extra)==null?void 0:s.metadata)??{}},a)}async onLLMNewToken(e,n,r){const a=this.runInfoMap.get(e.id);let i,o;if(a===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(a.runType==="chat_model")o="on_chat_model_stream",(r==null?void 0:r.chunk)===void 0?i=new Qa({content:n,id:`run-${e.id}`}):i=r.chunk.message;else if(a.runType==="llm")o="on_llm_stream",(r==null?void 0:r.chunk)===void 0?i=new Xa({text:n}):i=r.chunk;else throw new Error(`Unexpected run type ${a.runType}`);await this.send({event:o,data:{chunk:i},run_id:e.id,name:a.name,tags:a.tags,metadata:a.metadata},a)}}async onLLMEnd(e){var o,s,c;const n=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let r;if(n===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const a=(o=e.outputs)==null?void 0:o.generations;let i;if(n.runType==="chat_model"){for(const l of a??[]){if(i!==void 0)break;i=(s=l[0])==null?void 0:s.message}r="on_chat_model_end"}else if(n.runType==="llm")i={generations:a==null?void 0:a.map(l=>l.map(u=>({text:u.text,generationInfo:u.generationInfo}))),llmOutput:((c=e.outputs)==null?void 0:c.llmOutput)??{}},r="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${n.runType}`);await this.sendEndEvent({event:r,data:{output:i,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async onChainStart(e){var o,s;const n=ac(e),r=e.run_type??"chain",a={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:n,runType:e.run_type};let i={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(i={},a.inputs={}):e.inputs.input!==void 0?(i.input=e.inputs.input,a.inputs=e.inputs.input):(i.input=e.inputs,a.inputs=e.inputs),this.runInfoMap.set(e.id,a),await this.send({event:`on_${r}_start`,data:i,name:n,tags:e.tags??[],run_id:e.id,metadata:((s=e.extra)==null?void 0:s.metadata)??{}},a)}async onChainEnd(e){var o;const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const r=`on_${e.run_type}_end`,a=e.inputs??n.inputs??{},i={output:((o=e.outputs)==null?void 0:o.output)??e.outputs,input:a};a.input&&Object.keys(a).length===1&&(i.input=a.input,n.inputs=a.input),await this.sendEndEvent({event:r,data:i,run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata??{}},n)}async onToolStart(e){var a,i;const n=ac(e),r={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:n,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,r),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:n,run_id:e.id,tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{}},r)}async onToolEnd(e){var a;const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(n.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const r=((a=e.outputs)==null?void 0:a.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:r,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async onRetrieverStart(e){var a,i;const n=ac(e),r={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:n,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,r),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:n,tags:e.tags??[],run_id:e.id,metadata:((i=e.extra)==null?void 0:i.metadata)??{}},r)}async onRetrieverEnd(e){var r;const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((r=e.outputs)==null?void 0:r.documents)??e.outputs,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async handleCustomEvent(e,n,r){const a=this.runInfoMap.get(r);if(a===void 0)throw new Error(`handleCustomEvent: Run ID ${r} not found in run map.`);await this.send({event:"on_custom_event",run_id:r,name:e,tags:a.tags,metadata:a.metadata,data:n},a)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const yh=25;async function Kt(t){return Lt._configureSync(t==null?void 0:t.callbacks,void 0,t==null?void 0:t.tags,void 0,t==null?void 0:t.metadata)}function r0(...t){const e={};for(const n of t.filter(r=>!!r))for(const r of Object.keys(n))if(r==="metadata")e[r]={...e[r],...n[r]};else if(r==="tags"){const a=e[r]??[];e[r]=[...new Set(a.concat(n[r]??[]))]}else if(r==="configurable")e[r]={...e[r],...n[r]};else if(r==="timeout")e.timeout===void 0?e.timeout=n.timeout:n.timeout!==void 0&&(e.timeout=Math.min(e.timeout,n.timeout));else if(r==="signal")e.signal===void 0?e.signal=n.signal:n.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,n.signal]):e.signal=n.signal);else if(r==="callbacks"){const a=e.callbacks,i=n.callbacks;if(Array.isArray(i))if(!a)e.callbacks=i;else if(Array.isArray(a))e.callbacks=a.concat(i);else{const o=a.copy();for(const s of i)o.addHandler(rc(s),!0);e.callbacks=o}else if(i)if(!a)e.callbacks=i;else if(Array.isArray(a)){const o=i.copy();for(const s of a)o.addHandler(rc(s),!0);e.callbacks=o}else e.callbacks=new Lt(i._parentRunId,{handlers:a.handlers.concat(i.handlers),inheritableHandlers:a.inheritableHandlers.concat(i.inheritableHandlers),tags:Array.from(new Set(a.tags.concat(i.tags))),inheritableTags:Array.from(new Set(a.inheritableTags.concat(i.inheritableTags))),metadata:{...a.metadata,...i.metadata}})}else{const a=r;e[a]=n[a]??e[a]}return e}const pR=new Set(["string","number","boolean"]);je=function(t){var r;const e=Dr.getRunnableConfig();let n={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:a,runName:i,...o}=e;n=Object.entries(o).reduce((s,[c,l])=>(l!==void 0&&(s[c]=l),s),n)}if(t&&(n=Object.entries(t).reduce((a,[i,o])=>(o!==void 0&&(a[i]=o),a),n)),n==null?void 0:n.configurable)for(const a of Object.keys(n.configurable))pR.has(typeof n.configurable[a])&&!((r=n.metadata)!=null&&r[a])&&(n.metadata||(n.metadata={}),n.metadata[a]=n.configurable[a]);if(n.timeout!==void 0){if(n.timeout<=0)throw new Error("Timeout must be a positive number");const a=AbortSignal.timeout(n.timeout);n.signal!==void 0?"any"in AbortSignal&&(n.signal=AbortSignal.any([n.signal,a])):n.signal=a,delete n.timeout}return n};function ct(t={},{callbacks:e,maxConcurrency:n,recursionLimit:r,runName:a,configurable:i,runId:o}={}){const s=je(t);return e!==void 0&&(delete s.runName,s.callbacks=e),r!==void 0&&(s.recursionLimit=r),n!==void 0&&(s.maxConcurrency=n),a!==void 0&&(s.runName=a),i!==void 0&&(s.configurable={...s.configurable,...i}),o!==void 0&&delete s.runId,s}const mR=[400,401,402,403,404,405,406,407,409],gR=t=>{var n,r;if(t.message.startsWith("Cancel")||t.message.startsWith("AbortError")||t.name==="AbortError"||(t==null?void 0:t.code)==="ECONNABORTED")throw t;const e=((n=t==null?void 0:t.response)==null?void 0:n.status)??(t==null?void 0:t.status);if(e&&mR.includes(+e))throw t;if(((r=t==null?void 0:t.error)==null?void 0:r.code)==="insufficient_quota"){const a=new Error(t==null?void 0:t.message);throw a.name="InsufficientQuotaError",a}};xo=class{constructor(t){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=t.maxConcurrency??1/0,this.maxRetries=t.maxRetries??6,this.onFailedAttempt=t.onFailedAttempt??gR;const e="default"in $n?$n.default:$n;this.queue=new e({concurrency:this.maxConcurrency})}call(t,...e){return this.queue.add(()=>Ds(()=>t(...e).catch(n=>{throw n instanceof Error?n:new Error(n)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(t,e,...n){return t.signal?Promise.race([this.call(e,...n),new Promise((r,a)=>{var i;(i=t.signal)==null||i.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(e,...n)}fetch(...t){return this.call(()=>fetch(...t).then(e=>e.ok?e:Promise.reject(e)))}};class a0 extends Hi{constructor({config:e,onStart:n,onEnd:r,onError:a}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=n,this.argOnEnd=r,this.argOnError=a}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function vh(t){return t?t.lc_runnable:!1}class yR{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,n){let r=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const a=e.tags??[];return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(n)),this.includeTags!==void 0&&(r=r||a.some(i=>{var o;return(o=this.includeTags)==null?void 0:o.includes(i)})),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(n)),this.excludeTags!==void 0&&(r=r&&a.every(i=>{var o;return!((o=this.excludeTags)!=null&&o.includes(i))})),r}}const vR=Symbol("Let zodToJsonSchema decide on which parser to use"),bR={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},wR=t=>({...bR,...t}),_R=t=>{const e=wR(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function i0(t,e,n,r){r!=null&&r.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function $e(t,e,n,r,a){t[e]=n,i0(t,e,r,a)}function xR(){return{}}function ER(t,e){var r,a;const n={type:"array"};return((a=(r=t.type)==null?void 0:r._def)==null?void 0:a.typeName)!==K.ZodAny&&(n.items=Ae(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&$e(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&$e(n,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&($e(n,"minItems",t.exactLength.value,t.exactLength.message,e),$e(n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function SR(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?$e(n,"minimum",r.value,r.message,e):$e(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),$e(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?$e(n,"maximum",r.value,r.message,e):$e(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),$e(n,"maximum",r.value,r.message,e));break;case"multipleOf":$e(n,"multipleOf",r.value,r.message,e);break}return n}function OR(){return{type:"boolean"}}function kR(t,e){return Ae(t.type._def,e)}const TR=(t,e)=>Ae(t.innerType._def,e);function o0(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,i)=>o0(t,e,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return RR(t,e)}}const RR=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":$e(n,"minimum",r.value,r.message,e);break;case"max":$e(n,"maximum",r.value,r.message,e);break}return n};function IR(t,e){return{...Ae(t.innerType._def,e),default:t.defaultValue()}}function NR(t,e){return e.effectStrategy==="input"?Ae(t.schema._def,e):{}}function CR(t){return{type:"string",enum:t.values}}const jR=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function AR(t,e){const n=[Ae(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Ae(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(i=>!!i);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(i=>{if(jR(i))a.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let o=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:s,...c}=i;o=c}else r=void 0;a.push(o)}}),a.length?{allOf:a,...r}:void 0}function PR(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}let bh;const Fr={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(bh===void 0&&(bh=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),bh),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function s0(t,e){const n={type:"string"};function r(a){return e.patternStrategy==="escape"?$R(a):a}if(t.checks)for(const a of t.checks)switch(a.kind){case"min":$e(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,e);break;case"max":$e(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Yt(n,"email",a.message,e);break;case"format:idn-email":Yt(n,"idn-email",a.message,e);break;case"pattern:zod":Xt(n,Fr.email,a.message,e);break}break;case"url":Yt(n,"uri",a.message,e);break;case"uuid":Yt(n,"uuid",a.message,e);break;case"regex":Xt(n,a.regex,a.message,e);break;case"cuid":Xt(n,Fr.cuid,a.message,e);break;case"cuid2":Xt(n,Fr.cuid2,a.message,e);break;case"startsWith":Xt(n,RegExp(`^${r(a.value)}`),a.message,e);break;case"endsWith":Xt(n,RegExp(`${r(a.value)}$`),a.message,e);break;case"datetime":Yt(n,"date-time",a.message,e);break;case"date":Yt(n,"date",a.message,e);break;case"time":Yt(n,"time",a.message,e);break;case"duration":Yt(n,"duration",a.message,e);break;case"length":$e(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,e),$e(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,e);break;case"includes":{Xt(n,RegExp(r(a.value)),a.message,e);break}case"ip":{a.version!=="v6"&&Yt(n,"ipv4",a.message,e),a.version!=="v4"&&Yt(n,"ipv6",a.message,e);break}case"emoji":Xt(n,Fr.emoji,a.message,e);break;case"ulid":{Xt(n,Fr.ulid,a.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Yt(n,"binary",a.message,e);break}case"contentEncoding:base64":{$e(n,"contentEncoding","base64",a.message,e);break}case"pattern:zod":{Xt(n,Fr.base64,a.message,e);break}}break}case"nanoid":Xt(n,Fr.nanoid,a.message,e)}return n}const $R=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Yt=(t,e,n,r)=>{var a;t.format||(a=t.anyOf)!=null&&a.some(i=>i.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):$e(t,"format",e,n,r)},Xt=(t,e,n,r)=>{var a;t.pattern||(a=t.allOf)!=null&&a.some(i=>i.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:c0(e,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):$e(t,"pattern",c0(e,r),n,r)},c0=(t,e)=>{var l;const n=typeof t=="function"?t():t;if(!e.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let i="",o=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(o){i+=a[u],o=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(i+=a[u],i+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(i+=a[u],c=!0):i+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){i+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){i+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){i+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}i+=a[u],a[u]==="\\"?o=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return i};function l0(t,e){var r,a,i,o;if(e.target==="openApi3"&&((r=t.keyType)==null?void 0:r._def.typeName)===K.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((s,c)=>({...s,[c]:Ae(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:Ae(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return n;if(((a=t.keyType)==null?void 0:a._def.typeName)===K.ZodString&&((i=t.keyType._def.checks)!=null&&i.length)){const s=Object.entries(s0(t.keyType._def,e)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((o=t.keyType)==null?void 0:o._def.typeName)===K.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};return n}function LR(t,e){if(e.mapStrategy==="record")return l0(t,e);const n=Ae(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=Ae(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function MR(t){const e=t.values,n=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function DR(){return{not:{}}}function FR(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const ic={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function UR(t,e){if(e.target==="openApi3")return u0(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in ic&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,i)=>{const o=ic[i._def.typeName];return o&&!a.includes(o)?[...a,o]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,i)=>{const o=typeof i._def.value;switch(o){case"string":case"number":case"boolean":return[...a,o];case"bigint":return[...a,"integer"];case"object":if(i._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((i,o,s)=>s.indexOf(i)===o);return{type:a.length>1?a:a[0],enum:n.reduce((i,o)=>i.includes(o._def.value)?i:[...i,o._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(i=>!r.includes(i))],[])};return u0(t,e)}const u0=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,a)=>Ae(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function BR(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:ic[t.innerType._def.typeName],nullable:!0}:{type:[ic[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=Ae(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=Ae(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function zR(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",i0(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?$e(n,"minimum",r.value,r.message,e):$e(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),$e(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?$e(n,"maximum",r.value,r.message,e):$e(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),$e(n,"maximum",r.value,r.message,e));break;case"multipleOf":$e(n,"multipleOf",r.value,r.message,e);break}return n}function ZR(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":Ae(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":Ae(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function HR(t,e){const n={type:"object",...Object.entries(t.shape()).reduce((r,[a,i])=>{if(i===void 0||i._def===void 0)return r;const o=Ae(i._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});return o===void 0?r:{properties:{...r.properties,[a]:o},required:i.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:ZR(t,e)};return n.required.length||delete n.required,n}const GR=(t,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return Ae(t.innerType._def,e);const n=Ae(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},WR=(t,e)=>{if(e.pipeStrategy==="input")return Ae(t.in._def,e);if(e.pipeStrategy==="output")return Ae(t.out._def,e);const n=Ae(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=Ae(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function VR(t,e){return Ae(t.type._def,e)}function qR(t,e){const n={type:"array",uniqueItems:!0,items:Ae(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&$e(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&$e(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function JR(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((n,r)=>Ae(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:Ae(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>Ae(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function KR(){return{not:{}}}function YR(){return{}}const XR=(t,e)=>Ae(t.innerType._def,e);function Ae(t,e,n=!1){var o;const r=e.seen.get(t);if(e.override){const s=(o=e.override)==null?void 0:o.call(e,t,e,r,n);if(s!==vR)return s}if(r&&!n){const s=d0(r,e);if(s!==void 0)return s}const a={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,a);const i=f0(t,t.typeName,e);return i&&p0(t,e,i),a.jsonSchema=i,i}let d0,h0,f0,p0;d0=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:h0(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},h0=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")},f0=(t,e,n)=>{switch(e){case K.ZodString:return s0(t,n);case K.ZodNumber:return zR(t,n);case K.ZodObject:return HR(t,n);case K.ZodBigInt:return SR(t,n);case K.ZodBoolean:return OR();case K.ZodDate:return o0(t,n);case K.ZodUndefined:return KR();case K.ZodNull:return FR(n);case K.ZodArray:return ER(t,n);case K.ZodUnion:case K.ZodDiscriminatedUnion:return UR(t,n);case K.ZodIntersection:return AR(t,n);case K.ZodTuple:return JR(t,n);case K.ZodRecord:return l0(t,n);case K.ZodLiteral:return PR(t,n);case K.ZodEnum:return CR(t);case K.ZodNativeEnum:return MR(t);case K.ZodNullable:return BR(t,n);case K.ZodOptional:return GR(t,n);case K.ZodMap:return LR(t,n);case K.ZodSet:return qR(t,n);case K.ZodLazy:return Ae(t.getter()._def,n);case K.ZodPromise:return VR(t,n);case K.ZodNaN:case K.ZodNever:return DR();case K.ZodEffects:return NR(t,n);case K.ZodAny:return xR();case K.ZodUnknown:return YR();case K.ZodDefault:return IR(t,n);case K.ZodBranded:return kR(t,n);case K.ZodReadonly:return XR(t,n);case K.ZodCatch:return TR(t,n);case K.ZodPipeline:return WR(t,n);case K.ZodFunction:case K.ZodVoid:case K.ZodSymbol:return;default:return(r=>{})()}},p0=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),Hh=(t,e)=>{const n=_R(e),r=void 0,a=e==null?void 0:e.name,i=Ae(t._def,n,!1)??{},o=a===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:i}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};function wh(t){return t.replace(/[^a-zA-Z-_0-9]/g,"_")}function QR(t,e){const n=e[t.source]??t.source,r=e[t.target]??t.target;return[n,r]}function eI(t){let e="";for(const[n,r]of Object.entries(t))e+=`	classDef ${n}class fill:${r};
`;return e}function tI(t,e,n){const{firstNodeLabel:r,lastNodeLabel:a,nodeColors:i,withStyles:o=!0,curveStyle:s="linear",wrapLabelNWords:c=9}=n??{};let l=o?`%%{init: {'flowchart': {'curve': '${s}'}}}%%
graph TD;
`:`graph TD;
`;if(o){const d="default",h={[d]:"{0}([{1}]):::otherclass"};r!==void 0&&(h[r]="{0}[{0}]:::startclass"),a!==void 0&&(h[a]="{0}[{0}]:::endclass");for(const f of Object.values(t)){const p=h[f]??h[d],y=wh(f),v=f.split(":"),x=v[v.length-1];l+=`	${p.replace(/\{0\}/g,y).replace(/\{1\}/g,x)};
`}}let u="";for(const d of e){const h=d.source.includes(":")?d.source.split(":")[0]:void 0,f=d.target.includes(":")?d.target.split(":")[0]:void 0;u!==""&&(u!==h||u!==f)&&(l+=`	end
`,u=""),u===""&&h!==void 0&&h===f&&(l=`	subgraph ${h}
`,u=h);const[p,y]=QR(d,t);let v="";if(d.data!==void 0){let x=d.data;const O=x.split(" ");O.length>c&&(x=O.reduce((I,A,_)=>(_%c===0&&I.push(""),I[I.length-1]+=` ${A}`,I),[]).join("<br>")),d.conditional?v=` -. ${x} .-> `:v=` -- ${x} --> `}else d.conditional?v=" -.-> ":v=" --> ";l+=`	${wh(p)}${v}${wh(y)};
`}return u!==""&&(l+=`end
`),o&&i!==void 0&&(l+=eI(i)),l}async function nI(t,e){let{backgroundColor:n="white"}=e??{};const r=btoa(t);n!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(n)||(n=`!${n}`));const a=`https://mermaid.ink/img/${r}?bgColor=${n}`,i=await fetch(a);if(!i.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${i.status}`,`Status text: ${i.statusText}`].join(`
`));return await i.blob()}const m0=42;function _h(t){if(Fs(t.id))if(vh(t.data))try{let e=t.data.getName();return e=e.startsWith("Runnable")?e.slice(8):e,e.length>m0&&(e=`${e.substring(0,m0)}...`),e}catch{return t.data.getName()}else return t.data.name??"UnknownSchema";else return t.id}function rI(t){return vh(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:{...Hh(t.data.schema),title:t.data.name}}}class g0{constructor(){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]})}toJSON(){const e={};return Object.values(this.nodes).forEach((n,r)=>{e[n.id]=Fs(n.id)?r:n.id}),{nodes:Object.values(this.nodes).map(n=>({id:e[n.id],...rI(n)})),edges:this.edges.map(n=>{const r={source:e[n.source],target:e[n.target]};return typeof n.data<"u"&&(r.data=n.data),typeof n.conditional<"u"&&(r.conditional=n.conditional),r})}}addNode(e,n){if(n!==void 0&&this.nodes[n]!==void 0)throw new Error(`Node with id ${n} already exists`);const r=n||St(),a={id:r,data:e};return this.nodes[r]=a,a}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(n=>n.source!==e.id&&n.target!==e.id)}addEdge(e,n,r,a){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[n.id]===void 0)throw new Error(`Target node ${n.id} not in graph`);const i={source:e.id,target:n.id,data:r,conditional:a};return this.edges.push(i),i}firstNode(){const e=new Set(this.edges.map(r=>r.target)),n=[];return Object.values(this.nodes).forEach(r=>{e.has(r.id)||n.push(r)}),n[0]}lastNode(){const e=new Set(this.edges.map(r=>r.source)),n=[];return Object.values(this.nodes).forEach(r=>{e.has(r.id)||n.push(r)}),n[0]}extend(e,n=""){let r=n;Object.values(e.nodes).map(c=>c.id).every(Fs)&&(r="");const a=c=>r?`${r}:${c}`:c;Object.entries(e.nodes).forEach(([c,l])=>{this.nodes[a(c)]={...l,id:a(c)}});const i=e.edges.map(c=>({...c,source:a(c.source),target:a(c.target)}));this.edges=[...this.edges,...i];const o=e.firstNode(),s=e.lastNode();return[o?{id:a(o.id),data:o.data}:void 0,s?{id:a(s.id),data:s.data}:void 0]}trimFirstNode(){const e=this.firstNode();if(e){const n=this.edges.filter(r=>r.source===e.id);(Object.keys(this.nodes).length===1||n.length===1)&&this.removeNode(e)}}trimLastNode(){const e=this.lastNode();if(e){const n=this.edges.filter(r=>r.target===e.id);(Object.keys(this.nodes).length===1||n.length===1)&&this.removeNode(e)}}drawMermaid(e){const{withStyles:n,curveStyle:r,nodeColors:a={start:"#ffdfba",end:"#baffc9",other:"#fad7de"},wrapLabelNWords:i}=e??{},o={};for(const d of Object.values(this.nodes))o[d.id]=_h(d);const s=this.firstNode(),c=s?_h(s):void 0,l=this.lastNode(),u=l?_h(l):void 0;return tI(o,this.edges,{firstNodeLabel:c,lastNodeLabel:u,withStyles:n,curveStyle:r,nodeColors:a,wrapLabelNWords:i})}async drawMermaidPng(e){const n=this.drawMermaid(e);return nI(n,{backgroundColor:e==null?void 0:e.backgroundColor})}}function aI(t){const e=new TextEncoder,n=new ReadableStream({async start(r){for await(const a of t)r.enqueue(e.encode(`event: data
data: ${JSON.stringify(a)}

`));r.enqueue(e.encode(`event: end

`)),r.close()}});return kt.fromReadableStream(n)}function y0(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.iterator]=="function"&&typeof t.next=="function"}const iI=t=>t!=null&&typeof t=="object"&&"next"in t&&typeof t.next=="function";function xh(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function"}function*v0(t,e){for(;;){const{value:n,done:r}=Dr.runWithConfig(t,e.next.bind(e),!0);if(r)break;yield n}}async function*b0(t,e){const n=e[Symbol.asyncIterator]();for(;;){const{value:r,done:a}=await Dr.runWithConfig(t,n.next.bind(e),!0);if(a)break;yield r}}function nt(t,e){return t&&!Array.isArray(t)&&!(t instanceof Date)&&typeof t=="object"?t:{[e]:t}}rt=class extends wr{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(t){const e=this.name??this.constructor.lc_name()??this.constructor.name;return t?`${e}${t}`:e}bind(t){return new Ur({bound:this,kwargs:t,config:{}})}map(){return new oc({bound:this})}withRetry(t){return new oI({bound:this,kwargs:{},config:{},maxAttemptNumber:t==null?void 0:t.stopAfterAttempt,...t})}withConfig(t){return new Ur({bound:this,config:t,kwargs:{}})}withFallbacks(t){const e=Array.isArray(t)?t:t.fallbacks;return new cI({runnable:this,fallbacks:e})}_getOptionsList(t,e=0){if(Array.isArray(t)&&t.length!==e)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${t.length} options for ${e} inputs`);if(Array.isArray(t))return t.map(je);if(e>1&&!Array.isArray(t)&&t.runId){console.warn("Provided runId will be used only for the first element of the batch.");const n=Object.fromEntries(Object.entries(t).filter(([r])=>r!=="runId"));return Array.from({length:e},(r,a)=>je(a===0?t:n))}return Array.from({length:e},()=>je(t))}async batch(t,e,n){var s;const r=this._getOptionsList(e??{},t.length),a=((s=r[0])==null?void 0:s.maxConcurrency)??(n==null?void 0:n.maxConcurrency),i=new xo({maxConcurrency:a,onFailedAttempt:c=>{throw c}}),o=t.map((c,l)=>i.call(async()=>{try{return await this.invoke(c,r[l])}catch(u){if(n!=null&&n.returnExceptions)return u;throw u}}));return Promise.all(o)}async*_streamIterator(t,e){yield this.invoke(t,e)}async stream(t,e){const n=je(e),r=new Pa({generator:this._streamIterator(t,n),config:n});return await r.setup,kt.fromAsyncGenerator(r)}_separateRunnableConfigFromCallOptions(t){let e;t===void 0?e=je(t):e=je({callbacks:t.callbacks,tags:t.tags,metadata:t.metadata,runName:t.runName,configurable:t.configurable,recursionLimit:t.recursionLimit,maxConcurrency:t.maxConcurrency,runId:t.runId,timeout:t.timeout,signal:t.signal});const n={...t};return delete n.callbacks,delete n.tags,delete n.metadata,delete n.runName,delete n.configurable,delete n.recursionLimit,delete n.maxConcurrency,delete n.runId,delete n.timeout,delete n.signal,[e,n]}async _callWithConfig(t,e,n){var o;const r=je(n),a=await((o=await Kt(r))==null?void 0:o.handleChainStart(this.toJSON(),nt(e,"input"),r.runId,r==null?void 0:r.runType,void 0,void 0,(r==null?void 0:r.runName)??this.getName()));delete r.runId;let i;try{const s=t.call(this,e,r,a);i=await or(s,n==null?void 0:n.signal)}catch(s){throw await(a==null?void 0:a.handleChainError(s)),s}return await(a==null?void 0:a.handleChainEnd(nt(i,"output"))),i}async _batchWithConfig(t,e,n,r){var c;const a=this._getOptionsList(n??{},e.length),i=await Promise.all(a.map(Kt)),o=await Promise.all(i.map(async(l,u)=>{const d=await(l==null?void 0:l.handleChainStart(this.toJSON(),nt(e[u],"input"),a[u].runId,a[u].runType,void 0,void 0,a[u].runName??this.getName()));return delete a[u].runId,d}));let s;try{const l=t.call(this,e,a,o,r);s=await or(l,(c=a==null?void 0:a[0])==null?void 0:c.signal)}catch(l){throw await Promise.all(o.map(u=>u==null?void 0:u.handleChainError(l))),l}return await Promise.all(o.map(l=>l==null?void 0:l.handleChainEnd(nt(s,"output")))),s}async*_transformStreamWithConfig(t,e,n){let r,a=!0,i,o=!0;const s=je(n),c=await Kt(s);async function*l(){for await(const d of t){if(a)if(r===void 0)r=d;else try{r=on(r,d)}catch{r=void 0,a=!1}yield d}}let u;try{const d=await dR(e.bind(this),l(),async()=>c==null?void 0:c.handleChainStart(this.toJSON(),{input:""},s.runId,s.runType,void 0,void 0,s.runName??this.getName()),n==null?void 0:n.signal,s);delete s.runId,u=d.setup;const h=u==null?void 0:u.handlers.find(zh);let f=d.output;h!==void 0&&u!==void 0&&(f=h.tapOutputIterable(u.runId,f));const p=u==null?void 0:u.handlers.find(Zh);p!==void 0&&u!==void 0&&(f=p.tapOutputIterable(u.runId,f));for await(const y of f)if(yield y,o)if(i===void 0)i=y;else try{i=on(i,y)}catch{i=void 0,o=!1}}catch(d){throw await(u==null?void 0:u.handleChainError(d,void 0,void 0,void 0,{inputs:nt(r,"input")})),d}await(u==null?void 0:u.handleChainEnd(i??{},void 0,void 0,void 0,{inputs:nt(r,"input")}))}getGraph(t){const e=new g0,n=e.addNode({name:`${this.getName()}Input`,schema:Xr.any()}),r=e.addNode(this),a=e.addNode({name:`${this.getName()}Output`,schema:Xr.any()});return e.addEdge(n,r),e.addEdge(r,a),e}pipe(t){return new vr({first:this,last:Br(t)})}pick(t){return this.pipe(new lI(t))}assign(t){return this.pipe(new Bh(new Ya({steps:t})))}async*transform(t,e){let n;for await(const r of t)n===void 0?n=r:n=on(n,r);yield*this._streamIterator(n,je(e))}async*streamLog(t,e,n){const r=new n0({...n,autoClose:!1,_schemaFormat:"original"}),a=je(e);yield*this._streamLog(t,r,a)}async*_streamLog(t,e,n){const{callbacks:r}=n;if(r===void 0)n.callbacks=[e];else if(Array.isArray(r))n.callbacks=r.concat([e]);else{const s=r.copy();s.addHandler(e,!0),n.callbacks=s}const a=this.stream(t,n);async function i(){try{const s=await a;for await(const c of s){const l=new sr({ops:[{op:"add",path:"/streamed_output/-",value:c}]});await e.writer.write(l)}}finally{await e.writer.close()}}const o=i();try{for await(const s of e)yield s}finally{await o}}streamEvents(t,e,n){let r;if(e.version==="v1")r=this._streamEventsV1(t,e,n);else if(e.version==="v2")r=this._streamEventsV2(t,e,n);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return e.encoding==="text/event-stream"?aI(r):kt.fromAsyncGenerator(r)}async*_streamEventsV2(t,e,n){var h;const r=new fR({...n,autoClose:!1}),a=je(e),i=a.runId??St();a.runId=i;const o=a.callbacks;if(o===void 0)a.callbacks=[r];else if(Array.isArray(o))a.callbacks=o.concat(r);else{const f=o.copy();f.addHandler(r,!0),a.callbacks=f}const s=this;async function c(){try{const f=await s.stream(t,a),p=r.tapOutputIterable(i,f);for await(const y of p);}finally{await r.finish()}}const l=c();let u=!1,d;try{for await(const f of r){if(!u){f.data.input=t,u=!0,d=f.run_id,yield f;continue}f.run_id===d&&f.event.endsWith("_end")&&((h=f.data)!=null&&h.input)&&delete f.data.input,yield f}}finally{await l}}async*_streamEventsV1(t,e,n){let r,a=!1;const i=je(e),o=i.tags??[],s=i.metadata??{},c=i.runName??this.getName(),l=new n0({...n,autoClose:!1,_schemaFormat:"streaming_events"}),u=new yR({...n}),d=this._streamLog(t,l,i);for await(const f of d){if(r?r=r.concat(f):r=Yi.fromRunLogPatch(f),r.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!a){a=!0;const x={...r.state},O={run_id:x.id,event:`on_${x.type}_start`,name:c,tags:o,metadata:s,data:{input:t}};u.includeEvent(O,x.type)&&(yield O)}const p=f.ops.filter(x=>x.path.startsWith("/logs/")).map(x=>x.path.split("/")[2]),y=[...new Set(p)];for(const x of y){let O,I={};const A=r.state.logs[x];if(A.end_time===void 0?A.streamed_output.length>0?O="stream":O="start":O="end",O==="start")A.inputs!==void 0&&(I.input=A.inputs);else if(O==="end")A.inputs!==void 0&&(I.input=A.inputs),I.output=A.final_output;else if(O==="stream"){const _=A.streamed_output.length;if(_!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${_} instead. Encountered in: "${A.name}"`);I={chunk:A.streamed_output[0]},A.streamed_output=[]}yield{event:`on_${A.type}_${O}`,name:A.name,run_id:A.id,tags:A.tags,metadata:A.metadata,data:I}}const{state:v}=r;if(v.streamed_output.length>0){const x=v.streamed_output.length;if(x!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${x} instead. Encountered in: "${v.name}"`);const O={chunk:v.streamed_output[0]};v.streamed_output=[];const I={event:`on_${v.type}_stream`,run_id:v.id,tags:o,metadata:s,name:c,data:O};u.includeEvent(I,v.type)&&(yield I)}}const h=r==null?void 0:r.state;if(h!==void 0){const f={event:`on_${h.type}_end`,name:c,run_id:h.id,tags:o,metadata:s,data:{output:h.final_output}};u.includeEvent(f,h.type)&&(yield f)}}static isRunnable(t){return vh(t)}withListeners({onStart:t,onEnd:e,onError:n}){return new Ur({bound:this,config:{},configFactories:[r=>({callbacks:[new a0({config:r,onStart:t,onEnd:e,onError:n})]})]})}asTool(t){return uI(this,t)}};class Ur extends rt{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const n=r0(this.config,...e);return r0(n,...this.configFactories?await Promise.all(this.configFactories.map(async r=>await r(n))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,n){return this.bound.invoke(e,await this._mergeConfig(je(n),this.kwargs))}async batch(e,n,r){const a=Array.isArray(n)?await Promise.all(n.map(async i=>this._mergeConfig(je(i),this.kwargs))):await this._mergeConfig(je(n),this.kwargs);return this.bound.batch(e,a,r)}async*_streamIterator(e,n){yield*this.bound._streamIterator(e,await this._mergeConfig(je(n),this.kwargs))}async stream(e,n){return this.bound.stream(e,await this._mergeConfig(je(n),this.kwargs))}async*transform(e,n){yield*this.bound.transform(e,await this._mergeConfig(je(n),this.kwargs))}streamEvents(e,n,r){const a=this,i=async function*(){yield*a.bound.streamEvents(e,{...await a._mergeConfig(je(n),a.kwargs),version:n.version},r)};return kt.fromAsyncGenerator(i())}static isRunnableBinding(e){return e.bound&&rt.isRunnable(e.bound)}withListeners({onStart:e,onEnd:n,onError:r}){return new Ur({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[a=>({callbacks:[new a0({config:a,onStart:e,onEnd:n,onError:r})]})]})}}class oc extends rt{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new oc({bound:this.bound.bind(e)})}async invoke(e,n){return this._callWithConfig(this._invoke.bind(this),e,n)}async _invoke(e,n,r){return this.bound.batch(e,ct(n,{callbacks:r==null?void 0:r.getChild()}))}withListeners({onStart:e,onEnd:n,onError:r}){return new oc({bound:this.bound.withListeners({onStart:e,onEnd:n,onError:r})})}}class oI extends Ur{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,n,r){const a=e>1?`retry:attempt:${e}`:void 0;return ct(n,{callbacks:r==null?void 0:r.getChild(a)})}async _invoke(e,n,r){return Ds(a=>super.invoke(e,this._patchConfigForRetry(a,n,r)),{onFailedAttempt:a=>this.onFailedAttempt(a,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,n){return this._callWithConfig(this._invoke.bind(this),e,n)}async _batch(e,n,r,a){const i={};try{await Ds(async o=>{const s=e.map((h,f)=>f).filter(h=>i[h.toString()]===void 0||i[h.toString()]instanceof Error),c=s.map(h=>e[h]),l=s.map(h=>this._patchConfigForRetry(o,n==null?void 0:n[h],r==null?void 0:r[h])),u=await super.batch(c,l,{...a,returnExceptions:!0});let d;for(let h=0;h<u.length;h+=1){const f=u[h],p=s[h];f instanceof Error&&d===void 0&&(d=f,d.input=c[h]),i[p.toString()]=f}if(d)throw d;return u},{onFailedAttempt:o=>this.onFailedAttempt(o,o.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(o){if((a==null?void 0:a.returnExceptions)!==!0)throw o}return Object.keys(i).sort((o,s)=>parseInt(o,10)-parseInt(s,10)).map(o=>i[parseInt(o,10)])}async batch(e,n,r){return this._batchWithConfig(this._batch.bind(this),e,n,r)}}vr=class extends rt{static lc_name(){return"RunnableSequence"}constructor(t){super(t),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=t.first,this.middle=t.middle??this.middle,this.last=t.last,this.name=t.name}get steps(){return[this.first,...this.middle,this.last]}async invoke(t,e){var o,s;const n=je(e),r=await((o=await Kt(n))==null?void 0:o.handleChainStart(this.toJSON(),nt(t,"input"),n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));delete n.runId;let a=t,i;try{const c=[this.first,...this.middle];for(let l=0;l<c.length;l+=1){const u=c[l].invoke(a,ct(n,{callbacks:r==null?void 0:r.getChild(`seq:step:${l+1}`)}));a=await or(u,e==null?void 0:e.signal)}if((s=e==null?void 0:e.signal)!=null&&s.aborted)throw new Error("Aborted");i=await this.last.invoke(a,ct(n,{callbacks:r==null?void 0:r.getChild(`seq:step:${this.steps.length}`)}))}catch(c){throw await(r==null?void 0:r.handleChainError(c)),c}return await(r==null?void 0:r.handleChainEnd(nt(i,"output"))),i}async batch(t,e,n){var s;const r=this._getOptionsList(e??{},t.length),a=await Promise.all(r.map(Kt)),i=await Promise.all(a.map(async(c,l)=>{const u=await(c==null?void 0:c.handleChainStart(this.toJSON(),nt(t[l],"input"),r[l].runId,void 0,void 0,void 0,r[l].runName));return delete r[l].runId,u}));let o=t;try{for(let c=0;c<this.steps.length;c+=1){const l=this.steps[c].batch(o,i.map((u,d)=>{const h=u==null?void 0:u.getChild(`seq:step:${c+1}`);return ct(r[d],{callbacks:h})}),n);o=await or(l,(s=r[0])==null?void 0:s.signal)}}catch(c){throw await Promise.all(i.map(l=>l==null?void 0:l.handleChainError(c))),c}return await Promise.all(i.map(c=>c==null?void 0:c.handleChainEnd(nt(o,"output")))),o}async*_streamIterator(t,e){var u;const n=await Kt(e),{runId:r,...a}=e??{},i=await(n==null?void 0:n.handleChainStart(this.toJSON(),nt(t,"input"),r,void 0,void 0,void 0,a==null?void 0:a.runName)),o=[this.first,...this.middle,this.last];let s=!0,c;async function*l(){yield t}try{let d=o[0].transform(l(),ct(a,{callbacks:i==null?void 0:i.getChild("seq:step:1")}));for(let h=1;h<o.length;h+=1)d=await o[h].transform(d,ct(a,{callbacks:i==null?void 0:i.getChild(`seq:step:${h+1}`)}));for await(const h of d)if((u=e==null?void 0:e.signal)==null||u.throwIfAborted(),yield h,s)if(c===void 0)c=h;else try{c=on(c,h)}catch{c=void 0,s=!1}}catch(d){throw await(i==null?void 0:i.handleChainError(d)),d}await(i==null?void 0:i.handleChainEnd(nt(c,"output")))}getGraph(t){const e=new g0;let n=null;return this.steps.forEach((r,a)=>{const i=r.getGraph(t);a!==0&&i.trimFirstNode(),a!==this.steps.length-1&&i.trimLastNode(),e.extend(i);const o=i.firstNode();if(!o)throw new Error(`Runnable ${r} has no first node`);n&&e.addEdge(n,o),n=i.lastNode()}),e}pipe(t){return vr.isRunnableSequence(t)?new vr({first:this.first,middle:this.middle.concat([this.last,t.first,...t.middle]),last:t.last,name:this.name??t.name}):new vr({first:this.first,middle:[...this.middle,this.last],last:Br(t),name:this.name})}static isRunnableSequence(t){return Array.isArray(t.middle)&&rt.isRunnable(t)}static from([t,...e],n){return new vr({first:Br(t),middle:e.slice(0,-1).map(Br),last:Br(e[e.length-1]),name:n})}},Ya=class extends rt{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[e,n]of Object.entries(t.steps))this.steps[e]=Br(n)}static from(t){return new Ya({steps:t})}async invoke(t,e){var i;const n=je(e),r=await((i=await Kt(n))==null?void 0:i.handleChainStart(this.toJSON(),{input:t},n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));delete n.runId;const a={};try{const o=Object.entries(this.steps).map(async([s,c])=>{a[s]=await c.invoke(t,ct(n,{callbacks:r==null?void 0:r.getChild(`map:key:${s}`)}))});await or(Promise.all(o),e==null?void 0:e.signal)}catch(o){throw await(r==null?void 0:r.handleChainError(o)),o}return await(r==null?void 0:r.handleChainEnd(a)),a}async*_transform(t,e,n){const r={...this.steps},a=Qb(t,Object.keys(r).length),i=new Map(Object.entries(r).map(([o,s],c)=>{const l=s.transform(a[c],ct(n,{callbacks:e==null?void 0:e.getChild(`map:key:${o}`)}));return[o,l.next().then(u=>({key:o,gen:l,result:u}))]}));for(;i.size;){const o=Promise.race(i.values()),{key:s,result:c,gen:l}=await or(o,n==null?void 0:n.signal);i.delete(s),c.done||(yield{[s]:c.value},i.set(s,l.next().then(u=>({key:s,gen:l,result:u}))))}}transform(t,e){return this._transformStreamWithConfig(t,this._transform.bind(this),e)}async stream(t,e){async function*n(){yield t}const r=je(e),a=new Pa({generator:this.transform(n(),r),config:r});return await a.setup,kt.fromAsyncGenerator(a)}};class Eh extends rt{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!td(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,n){const[r]=this._getOptionsList(n??{},1),a=await Kt(r),i=this.func(ct(r,{callbacks:a}),e);return or(i,r==null?void 0:r.signal)}async*_streamIterator(e,n){var i,o;const[r]=this._getOptionsList(n??{},1),a=await this.invoke(e,n);if(xh(a)){for await(const s of a)(i=r==null?void 0:r.signal)==null||i.throwIfAborted(),yield s;return}if(iI(a)){for(;;){(o=r==null?void 0:r.signal)==null||o.throwIfAborted();const s=a.next();if(s.done)break;yield s.value}return}yield a}static from(e){return new Eh({func:e})}}function sI(t){if(td(t))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}Eo=class extends rt{static lc_name(){return"RunnableLambda"}constructor(t){if(td(t.func))return Eh.from(t.func);super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),sI(t.func),this.func=t.func}static from(t){return new Eo({func:t})}async _invoke(t,e,n){return new Promise((r,a)=>{const i=ct(e,{callbacks:n==null?void 0:n.getChild(),recursionLimit:((e==null?void 0:e.recursionLimit)??yh)-1});Dr.runWithConfig(i,async()=>{var o,s;try{let c=await this.func(t,{...i});if(c&&rt.isRunnable(c)){if((e==null?void 0:e.recursionLimit)===0)throw new Error("Recursion limit reached.");c=await c.invoke(t,{...i,recursionLimit:(i.recursionLimit??yh)-1})}else if(xh(c)){let l;for await(const u of b0(i,c))if((o=e==null?void 0:e.signal)==null||o.throwIfAborted(),l===void 0)l=u;else try{l=on(l,u)}catch{l=u}c=l}else if(y0(c)){let l;for(const u of v0(i,c))if((s=e==null?void 0:e.signal)==null||s.throwIfAborted(),l===void 0)l=u;else try{l=on(l,u)}catch{l=u}c=l}r(c)}catch(c){a(c)}})})}async invoke(t,e){return this._callWithConfig(this._invoke.bind(this),t,e)}async*_transform(t,e,n){var o,s;let r;for await(const c of t)if(r===void 0)r=c;else try{r=on(r,c)}catch{r=c}const a=ct(n,{callbacks:e==null?void 0:e.getChild(),recursionLimit:((n==null?void 0:n.recursionLimit)??yh)-1}),i=await new Promise((c,l)=>{Dr.runWithConfig(a,async()=>{try{const u=await this.func(r,{...a,config:a});c(u)}catch(u){l(u)}})});if(i&&rt.isRunnable(i)){if((n==null?void 0:n.recursionLimit)===0)throw new Error("Recursion limit reached.");const c=await i.stream(r,a);for await(const l of c)yield l}else if(xh(i))for await(const c of b0(a,i))(o=n==null?void 0:n.signal)==null||o.throwIfAborted(),yield c;else if(y0(i))for(const c of v0(a,i))(s=n==null?void 0:n.signal)==null||s.throwIfAborted(),yield c;else yield i}transform(t,e){return this._transformStreamWithConfig(t,this._transform.bind(this),e)}async stream(t,e){async function*n(){yield t}const r=je(e),a=new Pa({generator:this.transform(n(),r),config:r});return await a.setup,kt.fromAsyncGenerator(a)}};class cI extends rt{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,n){var l;const r=je(n),a=await Kt(n),{runId:i,...o}=r,s=await(a==null?void 0:a.handleChainStart(this.toJSON(),nt(e,"input"),i,void 0,void 0,void 0,o==null?void 0:o.runName));let c;for(const u of this.runnables()){(l=r==null?void 0:r.signal)==null||l.throwIfAborted();try{const d=await u.invoke(e,ct(o,{callbacks:s==null?void 0:s.getChild()}));return await(s==null?void 0:s.handleChainEnd(nt(d,"output"))),d}catch(d){c===void 0&&(c=d)}}throw c===void 0?new Error("No error stored at end of fallback."):(await(s==null?void 0:s.handleChainError(c)),c)}async*_streamIterator(e,n){var d;const r=je(n),a=await Kt(n),{runId:i,...o}=r,s=await(a==null?void 0:a.handleChainStart(this.toJSON(),nt(e,"input"),i,void 0,void 0,void 0,o==null?void 0:o.runName));let c,l;for(const h of this.runnables()){(d=r==null?void 0:r.signal)==null||d.throwIfAborted();const f=ct(o,{callbacks:s==null?void 0:s.getChild()});try{l=await h.stream(e,f);break}catch(p){c===void 0&&(c=p)}}if(l===void 0){const h=c??new Error("No error stored at end of fallback.");throw await(s==null?void 0:s.handleChainError(h)),h}let u;try{for await(const h of l){yield h;try{u=u===void 0?u:on(u,h)}catch{u=void 0}}}catch(h){throw await(s==null?void 0:s.handleChainError(h)),h}await(s==null?void 0:s.handleChainEnd(nt(u,"output")))}async batch(e,n,r){var c;if(r!=null&&r.returnExceptions)throw new Error("Not implemented.");const a=this._getOptionsList(n??{},e.length),i=await Promise.all(a.map(l=>Kt(l))),o=await Promise.all(i.map(async(l,u)=>{const d=await(l==null?void 0:l.handleChainStart(this.toJSON(),nt(e[u],"input"),a[u].runId,void 0,void 0,void 0,a[u].runName));return delete a[u].runId,d}));let s;for(const l of this.runnables()){(c=a[0].signal)==null||c.throwIfAborted();try{const u=await l.batch(e,o.map((d,h)=>ct(a[h],{callbacks:d==null?void 0:d.getChild()})),r);return await Promise.all(o.map((d,h)=>d==null?void 0:d.handleChainEnd(nt(u[h],"output")))),u}catch(u){s===void 0&&(s=u)}}throw s?(await Promise.all(o.map(l=>l==null?void 0:l.handleChainError(s))),s):new Error("No error stored at end of fallbacks.")}}function Br(t){if(typeof t=="function")return new Eo({func:t});if(rt.isRunnable(t))return t;if(!Array.isArray(t)&&typeof t=="object"){const e={};for(const[n,r]of Object.entries(t))e[n]=Br(r);return new Ya({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}Bh=class extends rt{static lc_name(){return"RunnableAssign"}constructor(t){t instanceof Ya&&(t={mapper:t}),super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=t.mapper}async invoke(t,e){const n=await this.mapper.invoke(t,e);return{...t,...n}}async*_transform(t,e,n){const r=this.mapper.getStepsKeys(),[a,i]=Qb(t),o=this.mapper.transform(i,ct(n,{callbacks:e==null?void 0:e.getChild()})),s=o.next();for await(const c of a){if(typeof c!="object"||Array.isArray(c))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof c}`);const l=Object.fromEntries(Object.entries(c).filter(([u])=>!r.includes(u)));Object.keys(l).length>0&&(yield l)}yield(await s).value;for await(const c of o)yield c}transform(t,e){return this._transformStreamWithConfig(t,this._transform.bind(this),e)}async stream(t,e){async function*n(){yield t}const r=je(e),a=new Pa({generator:this.transform(n(),r),config:r});return await a.setup,kt.fromAsyncGenerator(a)}};class lI extends rt{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const n=this.keys.map(r=>[r,e[r]]).filter(r=>r[1]!==void 0);return n.length===0?void 0:Object.fromEntries(n)}}async invoke(e,n){return this._callWithConfig(this._pick.bind(this),e,n)}async*_transform(e){for await(const n of e){const r=await this._pick(n);r!==void 0&&(yield r)}}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const a=je(n),i=new Pa({generator:this.transform(r(),a),config:a});return await i.setup,kt.fromAsyncGenerator(i)}}class w0 extends Ur{constructor(e){const n=vr.from([Eo.from(async r=>{let a;if(Kb(r))try{a=await this.schema.parseAsync(r.args)}catch{throw new VT("Received tool input did not match expected schema",JSON.stringify(r.args))}else a=r;return a}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:n,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function uI(t,e){var a;const n=e.name??t.getName(),r=e.description??((a=e.schema)==null?void 0:a.description);return e.schema.constructor===Xr.ZodString?new w0({name:n,description:r,schema:Xr.object({input:Xr.string()}).transform(i=>i.input),bound:t}):new w0({name:n,description:r,schema:e.schema,bound:t})}class dI extends rt{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","documents","transformers"]})}invoke(e,n){return this.transformDocuments(e)}}var Xi={},_0;function hI(){if(_0)return Xi;_0=1,Xi.byteLength=s,Xi.toByteArray=l,Xi.fromByteArray=h;for(var t=[],e=[],n=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,i=r.length;a<i;++a)t[a]=r[a],e[r.charCodeAt(a)]=a;e[45]=62,e[95]=63;function o(f){var p=f.length;if(p%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=f.indexOf("=");y===-1&&(y=p);var v=y===p?0:4-y%4;return[y,v]}function s(f){var p=o(f),y=p[0],v=p[1];return(y+v)*3/4-v}function c(f,p,y){return(p+y)*3/4-y}function l(f){var p,y=o(f),v=y[0],x=y[1],O=new n(c(f,v,x)),I=0,A=x>0?v-4:v,_;for(_=0;_<A;_+=4)p=e[f.charCodeAt(_)]<<18|e[f.charCodeAt(_+1)]<<12|e[f.charCodeAt(_+2)]<<6|e[f.charCodeAt(_+3)],O[I++]=p>>16&255,O[I++]=p>>8&255,O[I++]=p&255;return x===2&&(p=e[f.charCodeAt(_)]<<2|e[f.charCodeAt(_+1)]>>4,O[I++]=p&255),x===1&&(p=e[f.charCodeAt(_)]<<10|e[f.charCodeAt(_+1)]<<4|e[f.charCodeAt(_+2)]>>2,O[I++]=p>>8&255,O[I++]=p&255),O}function u(f){return t[f>>18&63]+t[f>>12&63]+t[f>>6&63]+t[f&63]}function d(f,p,y){for(var v,x=[],O=p;O<y;O+=3)v=(f[O]<<16&16711680)+(f[O+1]<<8&65280)+(f[O+2]&255),x.push(u(v));return x.join("")}function h(f){for(var p,y=f.length,v=y%3,x=[],O=16383,I=0,A=y-v;I<A;I+=O)x.push(d(f,I,I+O>A?A:I+O));return v===1?(p=f[y-1],x.push(t[p>>2]+t[p<<4&63]+"==")):v===2&&(p=(f[y-2]<<8)+f[y-1],x.push(t[p>>10]+t[p>>4&63]+t[p<<2&63]+"=")),x.join("")}return Xi}var fI=hI();const pI=Ka(fI);var mI=Object.defineProperty,gI=(t,e,n)=>e in t?mI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yI=(t,e,n)=>(gI(t,e+"",n),n);function vI(t,e){let n=Array.from({length:t.length},(r,a)=>({start:a,end:a+1}));for(;n.length>1;){let r=null;for(let a=0;a<n.length-1;a++){const i=t.slice(n[a].start,n[a+1].end),o=e.get(i.join(","));o!=null&&(r==null||o<r[0])&&(r=[o,a])}if(r!=null){const a=r[1];n[a]={start:n[a].start,end:n[a+1].end},n.splice(a+1,1)}else break}return n}function bI(t,e){return t.length===1?[e.get(t.join(","))]:vI(t,e).map(n=>e.get(t.slice(n.start,n.end).join(","))).filter(n=>n!=null)}function wI(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var Sh=class{constructor(t,e){qe(this,"specialTokens");qe(this,"inverseSpecialTokens");qe(this,"patStr");qe(this,"textEncoder",new TextEncoder);qe(this,"textDecoder",new TextDecoder("utf-8"));qe(this,"rankMap",new Map);qe(this,"textMap",new Map);this.patStr=t.pat_str;const n=t.bpe_ranks.split(`
`).filter(Boolean).reduce((r,a)=>{const[i,o,...s]=a.split(" "),c=Number.parseInt(o,10);return s.forEach((l,u)=>r[l]=c+u),r},{});for(const[r,a]of Object.entries(n)){const i=pI.toByteArray(r);this.rankMap.set(i.join(","),a),this.textMap.set(a,i)}this.specialTokens={...t.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[a,i])=>(r[i]=this.textEncoder.encode(a),r),{})}encode(t,e=[],n="all"){const r=new RegExp(this.patStr,"ug"),a=Sh.specialTokenRegex(Object.keys(this.specialTokens)),i=[],o=new Set(e==="all"?Object.keys(this.specialTokens):e),s=new Set(n==="all"?Object.keys(this.specialTokens).filter(l=>!o.has(l)):n);if(s.size>0){const l=Sh.specialTokenRegex([...s]),u=t.match(l);if(u!=null)throw new Error(`The text contains a special token that is not allowed: ${u[0]}`)}let c=0;for(;;){let l=null,u=c;for(;a.lastIndex=u,l=a.exec(t),!(l==null||o.has(l[0]));)u=l.index+1;const d=(l==null?void 0:l.index)??t.length;for(const f of t.substring(c,d).matchAll(r)){const p=this.textEncoder.encode(f[0]),y=this.rankMap.get(p.join(","));if(y!=null){i.push(y);continue}i.push(...bI(p,this.rankMap))}if(l==null)break;let h=this.specialTokens[l[0]];i.push(h),c=l.index+l[0].length}return i}decode(t){const e=[];let n=0;for(let i=0;i<t.length;++i){const o=t[i],s=this.textMap.get(o)??this.inverseSpecialTokens[o];s!=null&&(e.push(s),n+=s.length)}const r=new Uint8Array(n);let a=0;for(const i of e)r.set(i,a),a+=i.length;return this.textDecoder.decode(r)}},x0=Sh;yI(x0,"specialTokenRegex",t=>new RegExp(t.map(e=>wI(e)).join("|"),"g"));function _I(t){switch(t){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":return"o200k_base";default:throw new Error("Unknown model")}}const sc={},xI=new xo({});async function E0(t){return t in sc||(sc[t]=xI.fetch(`https://tiktoken.pages.dev/js/${t}.json`).then(e=>e.json()).then(e=>new x0(e)).catch(e=>{throw delete sc[t],e})),await sc[t]}nw=async function(t){return E0(_I(t))};class Oh extends dI{constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers","text_splitters"]}),Object.defineProperty(this,"chunkSize",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"chunkOverlap",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(this,"keepSeparator",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lengthFunction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chunkSize=(e==null?void 0:e.chunkSize)??this.chunkSize,this.chunkOverlap=(e==null?void 0:e.chunkOverlap)??this.chunkOverlap,this.keepSeparator=(e==null?void 0:e.keepSeparator)??this.keepSeparator,this.lengthFunction=(e==null?void 0:e.lengthFunction)??(n=>n.length),this.chunkOverlap>=this.chunkSize)throw new Error("Cannot have chunkOverlap >= chunkSize")}async transformDocuments(e,n={}){return this.splitDocuments(e,n)}splitOnSeparator(e,n){let r;if(n)if(this.keepSeparator){const a=n.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");r=e.split(new RegExp(`(?=${a})`))}else r=e.split(n);else r=e.split("");return r.filter(a=>a!=="")}async createDocuments(e,n=[],r={}){const a=n.length>0?n:[...Array(e.length)].map(()=>({})),{chunkHeader:i="",chunkOverlapHeader:o="(cont'd) ",appendChunkOverlapHeader:s=!1}=r,c=new Array;for(let l=0;l<e.length;l+=1){const u=e[l];let d=1,h=null,f=-1;for(const p of await this.splitText(u)){let y=i;const v=u.indexOf(p,f+1);if(h===null){const A=this.numberOfNewLines(u,0,v);d+=A}else{const A=f+await this.lengthFunction(h);if(A<v){const _=this.numberOfNewLines(u,A,v);d+=_}else if(A>v){const _=this.numberOfNewLines(u,v,A);d-=_}s&&(y+=o)}const x=this.numberOfNewLines(p),O=a[l].loc&&typeof a[l].loc=="object"?{...a[l].loc}:{};O.lines={from:d,to:d+x};const I={...a[l],loc:O};y+=p,c.push(new br({pageContent:y,metadata:I})),d+=x,h=p,f=v}}return c}numberOfNewLines(e,n,r){return(e.slice(n,r).match(/\n/g)||[]).length}async splitDocuments(e,n={}){const r=e.filter(o=>o.pageContent!==void 0),a=r.map(o=>o.pageContent),i=r.map(o=>o.metadata);return this.createDocuments(a,i,n)}joinDocs(e,n){const r=e.join(n).trim();return r===""?null:r}async mergeSplits(e,n){const r=[],a=[];let i=0;for(const s of e){const c=await this.lengthFunction(s);if(i+c+a.length*n.length>this.chunkSize&&(i>this.chunkSize&&console.warn(`Created a chunk of size ${i}, +
which is longer than the specified ${this.chunkSize}`),a.length>0)){const l=this.joinDocs(a,n);for(l!==null&&r.push(l);i>this.chunkOverlap||i+c+a.length*n.length>this.chunkSize&&i>0;)i-=await this.lengthFunction(a[0]),a.shift()}a.push(s),i+=c}const o=this.joinDocs(a,n);return o!==null&&r.push(o),r}}class EI extends Oh{static lc_name(){return"CharacterTextSplitter"}constructor(e){super(e),Object.defineProperty(this,"separator",{enumerable:!0,configurable:!0,writable:!0,value:`

`}),this.separator=(e==null?void 0:e.separator)??this.separator}async splitText(e){const n=this.splitOnSeparator(e,this.separator);return this.mergeSplits(n,this.keepSeparator?"":this.separator)}}class cc extends Oh{static lc_name(){return"RecursiveCharacterTextSplitter"}constructor(e){super(e),Object.defineProperty(this,"separators",{enumerable:!0,configurable:!0,writable:!0,value:[`

`,`
`," ",""]}),this.separators=(e==null?void 0:e.separators)??this.separators,this.keepSeparator=(e==null?void 0:e.keepSeparator)??!0}async _splitText(e,n){const r=[];let a=n[n.length-1],i;for(let l=0;l<n.length;l+=1){const u=n[l];if(u===""){a=u;break}if(e.includes(u)){a=u,i=n.slice(l+1);break}}const o=this.splitOnSeparator(e,a);let s=[];const c=this.keepSeparator?"":a;for(const l of o)if(await this.lengthFunction(l)<this.chunkSize)s.push(l);else{if(s.length){const u=await this.mergeSplits(s,c);r.push(...u),s=[]}if(!i)r.push(l);else{const u=await this._splitText(l,i);r.push(...u)}}if(s.length){const l=await this.mergeSplits(s,c);r.push(...l)}return r}async splitText(e){return this._splitText(e,this.separators)}static fromLanguage(e,n){return new cc({...n,separators:cc.getSeparatorsForLanguage(e)})}static getSeparatorsForLanguage(e){if(e==="cpp")return[`
class `,`
void `,`
int `,`
float `,`
double `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="go")return[`
func `,`
var `,`
const `,`
type `,`
if `,`
for `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="java")return[`
class `,`
public `,`
protected `,`
private `,`
static `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="js")return[`
function `,`
const `,`
let `,`
var `,`
class `,`
if `,`
for `,`
while `,`
switch `,`
case `,`
default `,`

`,`
`," ",""];if(e==="php")return[`
function `,`
class `,`
if `,`
foreach `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="proto")return[`
message `,`
service `,`
enum `,`
option `,`
import `,`
syntax `,`

`,`
`," ",""];if(e==="python")return[`
class `,`
def `,`
	def `,`

`,`
`," ",""];if(e==="rst")return[`
===
`,`
---
`,`
***
`,`
.. `,`

`,`
`," ",""];if(e==="ruby")return[`
def `,`
class `,`
if `,`
unless `,`
while `,`
for `,`
do `,`
begin `,`
rescue `,`

`,`
`," ",""];if(e==="rust")return[`
fn `,`
const `,`
let `,`
if `,`
while `,`
for `,`
loop `,`
match `,`
const `,`

`,`
`," ",""];if(e==="scala")return[`
class `,`
object `,`
def `,`
val `,`
var `,`
if `,`
for `,`
while `,`
match `,`
case `,`

`,`
`," ",""];if(e==="swift")return[`
func `,`
class `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="markdown")return[`
## `,`
### `,`
#### `,`
##### `,`
###### `,"```\n\n",`

***

`,`

---

`,`

___

`,`

`,`
`," ",""];if(e==="latex")return[`
\\chapter{`,`
\\section{`,`
\\subsection{`,`
\\subsubsection{`,`
\\begin{enumerate}`,`
\\begin{itemize}`,`
\\begin{description}`,`
\\begin{list}`,`
\\begin{quote}`,`
\\begin{quotation}`,`
\\begin{verse}`,`
\\begin{verbatim}`,`
\\begin{align}`,"$$","$",`

`,`
`," ",""];if(e==="html")return["<body>","<div>","<p>","<br>","<li>","<h1>","<h2>","<h3>","<h4>","<h5>","<h6>","<span>","<table>","<tr>","<td>","<th>","<ul>","<ol>","<header>","<footer>","<nav>","<head>","<style>","<script>","<meta>","<title>"," ",""];if(e==="sol")return[`
pragma `,`
using `,`
contract `,`
interface `,`
library `,`
constructor `,`
type `,`
function `,`
event `,`
modifier `,`
error `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do while `,`
assembly `,`

`,`
`," ",""];throw new Error(`Language ${e} is not supported.`)}}class SI extends Oh{static lc_name(){return"TokenTextSplitter"}constructor(e){super(e),Object.defineProperty(this,"encodingName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"allowedSpecial",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"disallowedSpecial",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tokenizer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.encodingName=(e==null?void 0:e.encodingName)??"gpt2",this.allowedSpecial=(e==null?void 0:e.allowedSpecial)??[],this.disallowedSpecial=(e==null?void 0:e.disallowedSpecial)??"all"}async splitText(e){this.tokenizer||(this.tokenizer=await E0(this.encodingName));const n=[],r=this.tokenizer.encode(e,this.allowedSpecial,this.disallowedSpecial);let a=0;for(;a<r.length;){a>0&&(a-=this.chunkOverlap);const i=Math.min(a+this.chunkSize,r.length),o=r.slice(a,i);n.push(this.tokenizer.decode(o)),a=i}return n}}const OI="/NoLLMChat/assets/voy_search_bg-FlZi7F4l.wasm",kI=async(t={},e)=>{let n;if(e.startsWith("data:")){const r=e.replace(/^data:.*?base64,/,"");let a;if(typeof Dh=="function"&&typeof Dh.from=="function")a=Dh.from(r,"base64");else if(typeof atob=="function"){const i=atob(r);a=new Uint8Array(i.length);for(let o=0;o<i.length;o++)a[o]=i.charCodeAt(o)}else throw new Error("Cannot decode base64-encoded data URL");n=await WebAssembly.instantiate(a,t)}else{const r=await fetch(e),a=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&a.startsWith("application/wasm"))n=await WebAssembly.instantiateStreaming(r,t);else{const i=await r.arrayBuffer();n=await WebAssembly.instantiate(i,t)}}return n.instance.exports};let De;function TI(t){De=t}const Ln=new Array(128).fill(void 0);Ln.push(void 0,null,!0,!1);function $a(t){return Ln[t]}let Qi=Ln.length;function Mn(t){Qi===Ln.length&&Ln.push(Ln.length+1);const e=Qi;return Qi=Ln[e],Ln[e]=t,e}function RI(t){t<132||(Ln[t]=Qi,Qi=t)}function S0(t){const e=$a(t);return RI(t),e}let zr=0,lc=null;function uc(){return(lc===null||lc.byteLength===0)&&(lc=new Uint8Array(De.memory.buffer)),lc}const II=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let dc=new II("utf-8");const NI=typeof dc.encodeInto=="function"?function(t,e){return dc.encodeInto(t,e)}:function(t,e){const n=dc.encode(t);return e.set(n),{read:t.length,written:n.length}};function kh(t,e,n){if(n===void 0){const s=dc.encode(t),c=e(s.length)>>>0;return uc().subarray(c,c+s.length).set(s),zr=s.length,c}let r=t.length,a=e(r)>>>0;const i=uc();let o=0;for(;o<r;o++){const s=t.charCodeAt(o);if(s>127)break;i[a+o]=s}if(o!==r){o!==0&&(t=t.slice(o)),a=n(a,r,r=o+t.length*3)>>>0;const s=uc().subarray(a+o,a+r),c=NI(t,s);o+=c.written}return zr=o,a}function O0(t){return t==null}let hc=null;function La(){return(hc===null||hc.byteLength===0)&&(hc=new Int32Array(De.memory.buffer)),hc}const CI=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let k0=new CI("utf-8",{ignoreBOM:!0,fatal:!0});k0.decode();function fc(t,e){return t=t>>>0,k0.decode(uc().subarray(t,t+e))}let pc=null;function jI(){return(pc===null||pc.byteLength===0)&&(pc=new Float32Array(De.memory.buffer)),pc}function AI(t,e){const n=e(t.length*4)>>>0;return jI().set(t,n/4),zr=t.length,n}function T0(t,e){try{return t.apply(this,e)}catch(n){De.__wbindgen_exn_store(Mn(n))}}class cr{static __wrap(e){e=e>>>0;const n=Object.create(cr.prototype);return n.__wbg_ptr=e,n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();De.__wbg_voy_free(e)}constructor(e){const n=De.voy_new(O0(e)?0:Mn(e));return cr.__wrap(n)}serialize(){let e,n;try{const i=De.__wbindgen_add_to_stack_pointer(-16);De.voy_serialize(i,this.__wbg_ptr);var r=La()[i/4+0],a=La()[i/4+1];return e=r,n=a,fc(r,a)}finally{De.__wbindgen_add_to_stack_pointer(16),De.__wbindgen_free(e,n)}}static deserialize(e){const n=kh(e,De.__wbindgen_malloc,De.__wbindgen_realloc),r=zr,a=De.voy_deserialize(n,r);return cr.__wrap(a)}index(e){De.voy_index(this.__wbg_ptr,Mn(e))}search(e,n){const r=AI(e,De.__wbindgen_malloc),a=zr,i=De.voy_search(this.__wbg_ptr,r,a,n);return S0(i)}add(e){De.voy_add(this.__wbg_ptr,Mn(e))}remove(e){De.voy_remove(this.__wbg_ptr,Mn(e))}clear(){De.voy_clear(this.__wbg_ptr)}size(){return De.voy_size(this.__wbg_ptr)>>>0}}function PI(t){const e=$a(t);return Mn(e)}function $I(t){return $a(t)===void 0}function LI(t){S0(t)}function MI(){const t=new Error;return Mn(t)}function DI(t,e){const n=$a(e).stack,r=kh(n,De.__wbindgen_malloc,De.__wbindgen_realloc),a=zr;La()[t/4+1]=a,La()[t/4+0]=r}function FI(t,e){let n,r;try{n=t,r=e,console.error(fc(t,e))}finally{De.__wbindgen_free(n,r)}}function UI(){return T0(function(t,e){const n=JSON.parse(fc(t,e));return Mn(n)},arguments)}function BI(){return T0(function(t){const e=JSON.stringify($a(t));return Mn(e)},arguments)}function zI(t,e){const n=$a(e),r=typeof n=="string"?n:void 0;var a=O0(r)?0:kh(r,De.__wbindgen_malloc,De.__wbindgen_realloc),i=zr;La()[t/4+1]=i,La()[t/4+0]=a}function ZI(t,e){throw new Error(fc(t,e))}URL=globalThis.URL;const We=await kI({"./voy_search_bg.js":{__wbindgen_object_clone_ref:PI,__wbindgen_is_undefined:$I,__wbindgen_object_drop_ref:LI,__wbg_new_abda76e883ba8a5f:MI,__wbg_stack_658279fe44541cf6:DI,__wbg_error_f851667af71bcfc6:FI,__wbg_parse_76a8a18ca3f8730b:UI,__wbg_stringify_d06ad2addc54d51e:BI,__wbindgen_string_get:zI,__wbindgen_throw:ZI}},OI),HI=We.memory,GI=We.__wbg_voy_free,WI=We.voy_new,VI=We.voy_serialize,qI=We.voy_deserialize,JI=We.voy_index,KI=We.voy_search,YI=We.voy_add,XI=We.voy_remove,QI=We.voy_clear,eN=We.voy_size,tN=We.index,nN=We.search,rN=We.add,aN=We.remove,iN=We.clear,oN=We.size,sN=We.__wbindgen_malloc,cN=We.__wbindgen_realloc,lN=We.__wbindgen_add_to_stack_pointer,uN=We.__wbindgen_free,dN=We.__wbindgen_exn_store,hN=Object.freeze(Object.defineProperty({__proto__:null,__wbg_voy_free:GI,__wbindgen_add_to_stack_pointer:lN,__wbindgen_exn_store:dN,__wbindgen_free:uN,__wbindgen_malloc:sN,__wbindgen_realloc:cN,add:rN,clear:iN,index:tN,memory:HI,remove:aN,search:nN,size:oN,voy_add:YI,voy_clear:QI,voy_deserialize:qI,voy_index:JI,voy_new:WI,voy_remove:XI,voy_search:KI,voy_serialize:VI,voy_size:eN},Symbol.toStringTag,{value:"Module"}));TI(hN),ni=function(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')};var R0={exports:{}},I0;function fN(){return I0||(I0=1,function(t,e){(function(n){t.exports=n()})(function(){return function n(r,a,i){function o(l,u){if(!a[l]){if(!r[l]){var d=typeof ni=="function"&&ni;if(!u&&d)return d(l,!0);if(s)return s(l,!0);var h=new Error("Cannot find module '"+l+"'");throw h.code="MODULE_NOT_FOUND",h}var f=a[l]={exports:{}};r[l][0].call(f.exports,function(p){var y=r[l][1][p];return o(y||p)},f,f.exports,n,r,a,i)}return a[l].exports}for(var s=typeof ni=="function"&&ni,c=0;c<i.length;c++)o(i[c]);return o}({1:[function(n,r,a){(function(i){var o=i.MutationObserver||i.WebKitMutationObserver,s;if(o){var c=0,l=new o(p),u=i.document.createTextNode("");l.observe(u,{characterData:!0}),s=function(){u.data=c=++c%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var d=new i.MessageChannel;d.port1.onmessage=p,s=function(){d.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?s=function(){var v=i.document.createElement("script");v.onreadystatechange=function(){p(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},i.document.documentElement.appendChild(v)}:s=function(){setTimeout(p,0)};var h,f=[];function p(){h=!0;for(var v,x,O=f.length;O;){for(x=f,f=[],v=-1;++v<O;)x[v]();O=f.length}h=!1}r.exports=y;function y(v){f.push(v)===1&&!h&&s()}}).call(this,typeof go<"u"?go:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,r,a){var i=n(1);function o(){}var s={},c=["REJECTED"],l=["FULFILLED"],u=["PENDING"];r.exports=d;function d(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,_!==o&&y(this,_)}d.prototype.catch=function(_){return this.then(null,_)},d.prototype.then=function(_,U){if(typeof _!="function"&&this.state===l||typeof U!="function"&&this.state===c)return this;var Z=new this.constructor(o);if(this.state!==u){var F=this.state===l?_:U;f(Z,F,this.outcome)}else this.queue.push(new h(Z,_,U));return Z};function h(_,U,Z){this.promise=_,typeof U=="function"&&(this.onFulfilled=U,this.callFulfilled=this.otherCallFulfilled),typeof Z=="function"&&(this.onRejected=Z,this.callRejected=this.otherCallRejected)}h.prototype.callFulfilled=function(_){s.resolve(this.promise,_)},h.prototype.otherCallFulfilled=function(_){f(this.promise,this.onFulfilled,_)},h.prototype.callRejected=function(_){s.reject(this.promise,_)},h.prototype.otherCallRejected=function(_){f(this.promise,this.onRejected,_)};function f(_,U,Z){i(function(){var F;try{F=U(Z)}catch(G){return s.reject(_,G)}F===_?s.reject(_,new TypeError("Cannot resolve promise with itself")):s.resolve(_,F)})}s.resolve=function(_,U){var Z=v(p,U);if(Z.status==="error")return s.reject(_,Z.value);var F=Z.value;if(F)y(_,F);else{_.state=l,_.outcome=U;for(var G=-1,re=_.queue.length;++G<re;)_.queue[G].callFulfilled(U)}return _},s.reject=function(_,U){_.state=c,_.outcome=U;for(var Z=-1,F=_.queue.length;++Z<F;)_.queue[Z].callRejected(U);return _};function p(_){var U=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof U=="function")return function(){U.apply(_,arguments)}}function y(_,U){var Z=!1;function F(E){Z||(Z=!0,s.reject(_,E))}function G(E){Z||(Z=!0,s.resolve(_,E))}function re(){U(G,F)}var he=v(re);he.status==="error"&&F(he.value)}function v(_,U){var Z={};try{Z.value=_(U),Z.status="success"}catch(F){Z.status="error",Z.value=F}return Z}d.resolve=x;function x(_){return _ instanceof this?_:s.resolve(new this(o),_)}d.reject=O;function O(_){var U=new this(o);return s.reject(U,_)}d.all=I;function I(_){var U=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Z=_.length,F=!1;if(!Z)return this.resolve([]);for(var G=new Array(Z),re=0,he=-1,E=new this(o);++he<Z;)R(_[he],he);return E;function R(S,b){U.resolve(S).then(z,function(C){F||(F=!0,s.reject(E,C))});function z(C){G[b]=C,++re===Z&&!F&&(F=!0,s.resolve(E,G))}}}d.race=A;function A(_){var U=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Z=_.length,F=!1;if(!Z)return this.resolve([]);for(var G=-1,re=new this(o);++G<Z;)he(_[G]);return re;function he(E){U.resolve(E).then(function(R){F||(F=!0,s.resolve(re,R))},function(R){F||(F=!0,s.reject(re,R))})}}},{1:1}],3:[function(n,r,a){(function(i){typeof i.Promise!="function"&&(i.Promise=n(2))}).call(this,typeof go<"u"?go:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,r,a){var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w};function o(w,k){if(!(w instanceof k))throw new TypeError("Cannot call a class as a function")}function s(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var c=s();function l(){try{if(!c||!c.open)return!1;var w=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),k=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!w||k)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function u(w,k){w=w||[],k=k||{};try{return new Blob(w,k)}catch(M){if(M.name!=="TypeError")throw M;for(var T=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,L=new T,j=0;j<w.length;j+=1)L.append(w[j]);return L.getBlob(k.type)}}typeof Promise>"u"&&n(3);var d=Promise;function h(w,k){k&&w.then(function(T){k(null,T)},function(T){k(T)})}function f(w,k,T){typeof k=="function"&&w.then(k),typeof T=="function"&&w.catch(T)}function p(w){return typeof w!="string"&&(console.warn(w+" used as a key, but it is not a string."),w=String(w)),w}function y(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var v="local-forage-detect-blob-support",x=void 0,O={},I=Object.prototype.toString,A="readonly",_="readwrite";function U(w){for(var k=w.length,T=new ArrayBuffer(k),L=new Uint8Array(T),j=0;j<k;j++)L[j]=w.charCodeAt(j);return T}function Z(w){return new d(function(k){var T=w.transaction(v,_),L=u([""]);T.objectStore(v).put(L,"key"),T.onabort=function(j){j.preventDefault(),j.stopPropagation(),k(!1)},T.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),M=navigator.userAgent.match(/Edge\//);k(M||!j||parseInt(j[1],10)>=43)}}).catch(function(){return!1})}function F(w){return typeof x=="boolean"?d.resolve(x):Z(w).then(function(k){return x=k,x})}function G(w){var k=O[w.name],T={};T.promise=new d(function(L,j){T.resolve=L,T.reject=j}),k.deferredOperations.push(T),k.dbReady?k.dbReady=k.dbReady.then(function(){return T.promise}):k.dbReady=T.promise}function re(w){var k=O[w.name],T=k.deferredOperations.pop();if(T)return T.resolve(),T.promise}function he(w,k){var T=O[w.name],L=T.deferredOperations.pop();if(L)return L.reject(k),L.promise}function E(w,k){return new d(function(T,L){if(O[w.name]=O[w.name]||le(),w.db)if(k)G(w),w.db.close();else return T(w.db);var j=[w.name];k&&j.push(w.version);var M=c.open.apply(c,j);k&&(M.onupgradeneeded=function(H){var W=M.result;try{W.createObjectStore(w.storeName),H.oldVersion<=1&&W.createObjectStore(v)}catch(Q){if(Q.name==="ConstraintError")console.warn('The database "'+w.name+'" has been upgraded from version '+H.oldVersion+" to version "+H.newVersion+', but the storage "'+w.storeName+'" already exists.');else throw Q}}),M.onerror=function(H){H.preventDefault(),L(M.error)},M.onsuccess=function(){var H=M.result;H.onversionchange=function(W){W.target.close()},T(H),re(w)}})}function R(w){return E(w,!1)}function S(w){return E(w,!0)}function b(w,k){if(!w.db)return!0;var T=!w.db.objectStoreNames.contains(w.storeName),L=w.version<w.db.version,j=w.version>w.db.version;if(L&&(w.version!==k&&console.warn('The database "'+w.name+`" can't be downgraded from version `+w.db.version+" to version "+w.version+"."),w.version=w.db.version),j||T){if(T){var M=w.db.version+1;M>w.version&&(w.version=M)}return!0}return!1}function z(w){return new d(function(k,T){var L=new FileReader;L.onerror=T,L.onloadend=function(j){var M=btoa(j.target.result||"");k({__local_forage_encoded_blob:!0,data:M,type:w.type})},L.readAsBinaryString(w)})}function C(w){var k=U(atob(w.data));return u([k],{type:w.type})}function $(w){return w&&w.__local_forage_encoded_blob}function P(w){var k=this,T=k._initReady().then(function(){var L=O[k._dbInfo.name];if(L&&L.dbReady)return L.dbReady});return f(T,w,w),T}function Y(w){G(w);for(var k=O[w.name],T=k.forages,L=0;L<T.length;L++){var j=T[L];j._dbInfo.db&&(j._dbInfo.db.close(),j._dbInfo.db=null)}return w.db=null,R(w).then(function(M){return w.db=M,b(w)?S(w):M}).then(function(M){w.db=k.db=M;for(var H=0;H<T.length;H++)T[H]._dbInfo.db=M}).catch(function(M){throw he(w,M),M})}function ae(w,k,T,L){L===void 0&&(L=1);try{var j=w.db.transaction(w.storeName,k);T(null,j)}catch(M){if(L>0&&(!w.db||M.name==="InvalidStateError"||M.name==="NotFoundError"))return d.resolve().then(function(){if(!w.db||M.name==="NotFoundError"&&!w.db.objectStoreNames.contains(w.storeName)&&w.version<=w.db.version)return w.db&&(w.version=w.db.version+1),S(w)}).then(function(){return Y(w).then(function(){ae(w,k,T,L-1)})}).catch(T);T(M)}}function le(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function we(w){var k=this,T={db:null};if(w)for(var L in w)T[L]=w[L];var j=O[T.name];j||(j=le(),O[T.name]=j),j.forages.push(k),k._initReady||(k._initReady=k.ready,k.ready=P);var M=[];function H(){return d.resolve()}for(var W=0;W<j.forages.length;W++){var Q=j.forages[W];Q!==k&&M.push(Q._initReady().catch(H))}var X=j.forages.slice(0);return d.all(M).then(function(){return T.db=j.db,R(T)}).then(function(J){return T.db=J,b(T,k._defaultConfig.version)?S(T):J}).then(function(J){T.db=j.db=J,k._dbInfo=T;for(var fe=0;fe<X.length;fe++){var Te=X[fe];Te!==k&&(Te._dbInfo.db=T.db,Te._dbInfo.version=T.version)}})}function xe(w,k){var T=this;w=p(w);var L=new d(function(j,M){T.ready().then(function(){ae(T._dbInfo,A,function(H,W){if(H)return M(H);try{var Q=W.objectStore(T._dbInfo.storeName),X=Q.get(w);X.onsuccess=function(){var J=X.result;J===void 0&&(J=null),$(J)&&(J=C(J)),j(J)},X.onerror=function(){M(X.error)}}catch(J){M(J)}})}).catch(M)});return h(L,k),L}function Be(w,k){var T=this,L=new d(function(j,M){T.ready().then(function(){ae(T._dbInfo,A,function(H,W){if(H)return M(H);try{var Q=W.objectStore(T._dbInfo.storeName),X=Q.openCursor(),J=1;X.onsuccess=function(){var fe=X.result;if(fe){var Te=fe.value;$(Te)&&(Te=C(Te));var Me=w(Te,fe.key,J++);Me!==void 0?j(Me):fe.continue()}else j()},X.onerror=function(){M(X.error)}}catch(fe){M(fe)}})}).catch(M)});return h(L,k),L}function gt(w,k,T){var L=this;w=p(w);var j=new d(function(M,H){var W;L.ready().then(function(){return W=L._dbInfo,I.call(k)==="[object Blob]"?F(W.db).then(function(Q){return Q?k:z(k)}):k}).then(function(Q){ae(L._dbInfo,_,function(X,J){if(X)return H(X);try{var fe=J.objectStore(L._dbInfo.storeName);Q===null&&(Q=void 0);var Te=fe.put(Q,w);J.oncomplete=function(){Q===void 0&&(Q=null),M(Q)},J.onabort=J.onerror=function(){var Me=Te.error?Te.error:Te.transaction.error;H(Me)}}catch(Me){H(Me)}})}).catch(H)});return h(j,T),j}function Dn(w,k){var T=this;w=p(w);var L=new d(function(j,M){T.ready().then(function(){ae(T._dbInfo,_,function(H,W){if(H)return M(H);try{var Q=W.objectStore(T._dbInfo.storeName),X=Q.delete(w);W.oncomplete=function(){j()},W.onerror=function(){M(X.error)},W.onabort=function(){var J=X.error?X.error:X.transaction.error;M(J)}}catch(J){M(J)}})}).catch(M)});return h(L,k),L}function Fn(w){var k=this,T=new d(function(L,j){k.ready().then(function(){ae(k._dbInfo,_,function(M,H){if(M)return j(M);try{var W=H.objectStore(k._dbInfo.storeName),Q=W.clear();H.oncomplete=function(){L()},H.onabort=H.onerror=function(){var X=Q.error?Q.error:Q.transaction.error;j(X)}}catch(X){j(X)}})}).catch(j)});return h(T,w),T}function Pe(w){var k=this,T=new d(function(L,j){k.ready().then(function(){ae(k._dbInfo,A,function(M,H){if(M)return j(M);try{var W=H.objectStore(k._dbInfo.storeName),Q=W.count();Q.onsuccess=function(){L(Q.result)},Q.onerror=function(){j(Q.error)}}catch(X){j(X)}})}).catch(j)});return h(T,w),T}function yt(w,k){var T=this,L=new d(function(j,M){if(w<0){j(null);return}T.ready().then(function(){ae(T._dbInfo,A,function(H,W){if(H)return M(H);try{var Q=W.objectStore(T._dbInfo.storeName),X=!1,J=Q.openKeyCursor();J.onsuccess=function(){var fe=J.result;if(!fe){j(null);return}w===0||X?j(fe.key):(X=!0,fe.advance(w))},J.onerror=function(){M(J.error)}}catch(fe){M(fe)}})}).catch(M)});return h(L,k),L}function Hr(w){var k=this,T=new d(function(L,j){k.ready().then(function(){ae(k._dbInfo,A,function(M,H){if(M)return j(M);try{var W=H.objectStore(k._dbInfo.storeName),Q=W.openKeyCursor(),X=[];Q.onsuccess=function(){var J=Q.result;if(!J){L(X);return}X.push(J.key),J.continue()},Q.onerror=function(){j(Q.error)}}catch(J){j(J)}})}).catch(j)});return h(T,w),T}function Fa(w,k){k=y.apply(this,arguments);var T=this.config();w=typeof w!="function"&&w||{},w.name||(w.name=w.name||T.name,w.storeName=w.storeName||T.storeName);var L=this,j;if(!w.name)j=d.reject("Invalid arguments");else{var M=w.name===T.name&&L._dbInfo.db,H=M?d.resolve(L._dbInfo.db):R(w).then(function(W){var Q=O[w.name],X=Q.forages;Q.db=W;for(var J=0;J<X.length;J++)X[J]._dbInfo.db=W;return W});w.storeName?j=H.then(function(W){if(W.objectStoreNames.contains(w.storeName)){var Q=W.version+1;G(w);var X=O[w.name],J=X.forages;W.close();for(var fe=0;fe<J.length;fe++){var Te=J[fe];Te._dbInfo.db=null,Te._dbInfo.version=Q}var Me=new d(function(Le,Ye){var He=c.open(w.name,Q);He.onerror=function($t){var Ph=He.result;Ph.close(),Ye($t)},He.onupgradeneeded=function(){var $t=He.result;$t.deleteObjectStore(w.storeName)},He.onsuccess=function(){var $t=He.result;$t.close(),Le($t)}});return Me.then(function(Le){X.db=Le;for(var Ye=0;Ye<J.length;Ye++){var He=J[Ye];He._dbInfo.db=Le,re(He._dbInfo)}}).catch(function(Le){throw(he(w,Le)||d.resolve()).catch(function(){}),Le})}}):j=H.then(function(W){G(w);var Q=O[w.name],X=Q.forages;W.close();for(var J=0;J<X.length;J++){var fe=X[J];fe._dbInfo.db=null}var Te=new d(function(Me,Le){var Ye=c.deleteDatabase(w.name);Ye.onerror=function(){var He=Ye.result;He&&He.close(),Le(Ye.error)},Ye.onblocked=function(){console.warn('dropInstance blocked for database "'+w.name+'" until all open connections are closed')},Ye.onsuccess=function(){var He=Ye.result;He&&He.close(),Me(He)}});return Te.then(function(Me){Q.db=Me;for(var Le=0;Le<X.length;Le++){var Ye=X[Le];re(Ye._dbInfo)}}).catch(function(Me){throw(he(w,Me)||d.resolve()).catch(function(){}),Me})})}return h(j,k),j}var ft={_driver:"asyncStorage",_initStorage:we,_support:l(),iterate:Be,getItem:xe,setItem:gt,removeItem:Dn,clear:Fn,length:Pe,key:yt,keys:Hr,dropInstance:Fa};function ro(){return typeof openDatabase=="function"}var At="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ua="~~local_forage_type~",Ba=/^~~local_forage_type~([^~]+)~/,lr="__lfsc__:",vn=lr.length,ao="arbf",Qt="blob",ur="si08",io="ui08",za="uic8",en="si16",Pt="si32",oo="ur16",Za="ui32",vc="fl32",tn="fl64",so=vn+ao.length,co=Object.prototype.toString;function lo(w){var k=w.length*.75,T=w.length,L,j=0,M,H,W,Q;w[w.length-1]==="="&&(k--,w[w.length-2]==="="&&k--);var X=new ArrayBuffer(k),J=new Uint8Array(X);for(L=0;L<T;L+=4)M=At.indexOf(w[L]),H=At.indexOf(w[L+1]),W=At.indexOf(w[L+2]),Q=At.indexOf(w[L+3]),J[j++]=M<<2|H>>4,J[j++]=(H&15)<<4|W>>2,J[j++]=(W&3)<<6|Q&63;return X}function uo(w){var k=new Uint8Array(w),T="",L;for(L=0;L<k.length;L+=3)T+=At[k[L]>>2],T+=At[(k[L]&3)<<4|k[L+1]>>4],T+=At[(k[L+1]&15)<<2|k[L+2]>>6],T+=At[k[L+2]&63];return k.length%3===2?T=T.substring(0,T.length-1)+"=":k.length%3===1&&(T=T.substring(0,T.length-2)+"=="),T}function bc(w,k){var T="";if(w&&(T=co.call(w)),w&&(T==="[object ArrayBuffer]"||w.buffer&&co.call(w.buffer)==="[object ArrayBuffer]")){var L,j=lr;w instanceof ArrayBuffer?(L=w,j+=ao):(L=w.buffer,T==="[object Int8Array]"?j+=ur:T==="[object Uint8Array]"?j+=io:T==="[object Uint8ClampedArray]"?j+=za:T==="[object Int16Array]"?j+=en:T==="[object Uint16Array]"?j+=oo:T==="[object Int32Array]"?j+=Pt:T==="[object Uint32Array]"?j+=Za:T==="[object Float32Array]"?j+=vc:T==="[object Float64Array]"?j+=tn:k(new Error("Failed to get type for BinaryArray"))),k(j+uo(L))}else if(T==="[object Blob]"){var M=new FileReader;M.onload=function(){var H=Ua+w.type+"~"+uo(this.result);k(lr+Qt+H)},M.readAsArrayBuffer(w)}else try{k(JSON.stringify(w))}catch(H){console.error("Couldn't convert value into a JSON string: ",w),k(null,H)}}function Ha(w){if(w.substring(0,vn)!==lr)return JSON.parse(w);var k=w.substring(so),T=w.substring(vn,so),L;if(T===Qt&&Ba.test(k)){var j=k.match(Ba);L=j[1],k=k.substring(j[0].length)}var M=lo(k);switch(T){case ao:return M;case Qt:return u([M],{type:L});case ur:return new Int8Array(M);case io:return new Uint8Array(M);case za:return new Uint8ClampedArray(M);case en:return new Int16Array(M);case oo:return new Uint16Array(M);case Pt:return new Int32Array(M);case Za:return new Uint32Array(M);case vc:return new Float32Array(M);case tn:return new Float64Array(M);default:throw new Error("Unkown type: "+T)}}var Ga={serialize:bc,deserialize:Ha,stringToBuffer:lo,bufferToString:uo};function Wa(w,k,T,L){w.executeSql("CREATE TABLE IF NOT EXISTS "+k.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],T,L)}function Nh(w){var k=this,T={db:null};if(w)for(var L in w)T[L]=typeof w[L]!="string"?w[L].toString():w[L];var j=new d(function(M,H){try{T.db=openDatabase(T.name,String(T.version),T.description,T.size)}catch(W){return H(W)}T.db.transaction(function(W){Wa(W,T,function(){k._dbInfo=T,M()},function(Q,X){H(X)})},H)});return T.serializer=Ga,j}function nn(w,k,T,L,j,M){w.executeSql(T,L,j,function(H,W){W.code===W.SYNTAX_ERR?H.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[k.storeName],function(Q,X){X.rows.length?M(Q,W):Wa(Q,k,function(){Q.executeSql(T,L,j,M)},M)},M):M(H,W)},M)}function Ch(w,k){var T=this;w=p(w);var L=new d(function(j,M){T.ready().then(function(){var H=T._dbInfo;H.db.transaction(function(W){nn(W,H,"SELECT * FROM "+H.storeName+" WHERE key = ? LIMIT 1",[w],function(Q,X){var J=X.rows.length?X.rows.item(0).value:null;J&&(J=H.serializer.deserialize(J)),j(J)},function(Q,X){M(X)})})}).catch(M)});return h(L,k),L}function wc(w,k){var T=this,L=new d(function(j,M){T.ready().then(function(){var H=T._dbInfo;H.db.transaction(function(W){nn(W,H,"SELECT * FROM "+H.storeName,[],function(Q,X){for(var J=X.rows,fe=J.length,Te=0;Te<fe;Te++){var Me=J.item(Te),Le=Me.value;if(Le&&(Le=H.serializer.deserialize(Le)),Le=w(Le,Me.key,Te+1),Le!==void 0){j(Le);return}}j()},function(Q,X){M(X)})})}).catch(M)});return h(L,k),L}function Gr(w,k,T,L){var j=this;w=p(w);var M=new d(function(H,W){j.ready().then(function(){k===void 0&&(k=null);var Q=k,X=j._dbInfo;X.serializer.serialize(k,function(J,fe){fe?W(fe):X.db.transaction(function(Te){nn(Te,X,"INSERT OR REPLACE INTO "+X.storeName+" (key, value) VALUES (?, ?)",[w,J],function(){H(Q)},function(Me,Le){W(Le)})},function(Te){if(Te.code===Te.QUOTA_ERR){if(L>0){H(Gr.apply(j,[w,Q,T,L-1]));return}W(Te)}})})}).catch(W)});return h(M,T),M}function Va(w,k,T){return Gr.apply(this,[w,k,T,1])}function jh(w,k){var T=this;w=p(w);var L=new d(function(j,M){T.ready().then(function(){var H=T._dbInfo;H.db.transaction(function(W){nn(W,H,"DELETE FROM "+H.storeName+" WHERE key = ?",[w],function(){j()},function(Q,X){M(X)})})}).catch(M)});return h(L,k),L}function Ah(w){var k=this,T=new d(function(L,j){k.ready().then(function(){var M=k._dbInfo;M.db.transaction(function(H){nn(H,M,"DELETE FROM "+M.storeName,[],function(){L()},function(W,Q){j(Q)})})}).catch(j)});return h(T,w),T}function N(w){var k=this,T=new d(function(L,j){k.ready().then(function(){var M=k._dbInfo;M.db.transaction(function(H){nn(H,M,"SELECT COUNT(key) as c FROM "+M.storeName,[],function(W,Q){var X=Q.rows.item(0).c;L(X)},function(W,Q){j(Q)})})}).catch(j)});return h(T,w),T}function D(w,k){var T=this,L=new d(function(j,M){T.ready().then(function(){var H=T._dbInfo;H.db.transaction(function(W){nn(W,H,"SELECT key FROM "+H.storeName+" WHERE id = ? LIMIT 1",[w+1],function(Q,X){var J=X.rows.length?X.rows.item(0).key:null;j(J)},function(Q,X){M(X)})})}).catch(M)});return h(L,k),L}function B(w){var k=this,T=new d(function(L,j){k.ready().then(function(){var M=k._dbInfo;M.db.transaction(function(H){nn(H,M,"SELECT key FROM "+M.storeName,[],function(W,Q){for(var X=[],J=0;J<Q.rows.length;J++)X.push(Q.rows.item(J).key);L(X)},function(W,Q){j(Q)})})}).catch(j)});return h(T,w),T}function V(w){return new d(function(k,T){w.transaction(function(L){L.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(j,M){for(var H=[],W=0;W<M.rows.length;W++)H.push(M.rows.item(W).name);k({db:w,storeNames:H})},function(j,M){T(M)})},function(L){T(L)})})}function ie(w,k){k=y.apply(this,arguments);var T=this.config();w=typeof w!="function"&&w||{},w.name||(w.name=w.name||T.name,w.storeName=w.storeName||T.storeName);var L=this,j;return w.name?j=new d(function(M){var H;w.name===T.name?H=L._dbInfo.db:H=openDatabase(w.name,"","",0),w.storeName?M({db:H,storeNames:[w.storeName]}):M(V(H))}).then(function(M){return new d(function(H,W){M.db.transaction(function(Q){function X(Me){return new d(function(Le,Ye){Q.executeSql("DROP TABLE IF EXISTS "+Me,[],function(){Le()},function(He,$t){Ye($t)})})}for(var J=[],fe=0,Te=M.storeNames.length;fe<Te;fe++)J.push(X(M.storeNames[fe]));d.all(J).then(function(){H()}).catch(function(Me){W(Me)})},function(Q){W(Q)})})}):j=d.reject("Invalid arguments"),h(j,k),j}var de={_driver:"webSQLStorage",_initStorage:Nh,_support:ro(),iterate:wc,getItem:Ch,setItem:Va,removeItem:jh,clear:Ah,length:N,key:D,keys:B,dropInstance:ie};function ge(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function oe(w,k){var T=w.name+"/";return w.storeName!==k.storeName&&(T+=w.storeName+"/"),T}function ce(){var w="_localforage_support_test";try{return localStorage.setItem(w,!0),localStorage.removeItem(w),!1}catch{return!0}}function ee(){return!ce()||localStorage.length>0}function ye(w){var k=this,T={};if(w)for(var L in w)T[L]=w[L];return T.keyPrefix=oe(w,k._defaultConfig),ee()?(k._dbInfo=T,T.serializer=Ga,d.resolve()):d.reject()}function Se(w){var k=this,T=k.ready().then(function(){for(var L=k._dbInfo.keyPrefix,j=localStorage.length-1;j>=0;j--){var M=localStorage.key(j);M.indexOf(L)===0&&localStorage.removeItem(M)}});return h(T,w),T}function Fe(w,k){var T=this;w=p(w);var L=T.ready().then(function(){var j=T._dbInfo,M=localStorage.getItem(j.keyPrefix+w);return M&&(M=j.serializer.deserialize(M)),M});return h(L,k),L}function ze(w,k){var T=this,L=T.ready().then(function(){for(var j=T._dbInfo,M=j.keyPrefix,H=M.length,W=localStorage.length,Q=1,X=0;X<W;X++){var J=localStorage.key(X);if(J.indexOf(M)===0){var fe=localStorage.getItem(J);if(fe&&(fe=j.serializer.deserialize(fe)),fe=w(fe,J.substring(H),Q++),fe!==void 0)return fe}}});return h(L,k),L}function Ne(w,k){var T=this,L=T.ready().then(function(){var j=T._dbInfo,M;try{M=localStorage.key(w)}catch{M=null}return M&&(M=M.substring(j.keyPrefix.length)),M});return h(L,k),L}function vt(w){var k=this,T=k.ready().then(function(){for(var L=k._dbInfo,j=localStorage.length,M=[],H=0;H<j;H++){var W=localStorage.key(H);W.indexOf(L.keyPrefix)===0&&M.push(W.substring(L.keyPrefix.length))}return M});return h(T,w),T}function Ve(w){var k=this,T=k.keys().then(function(L){return L.length});return h(T,w),T}function Wr(w,k){var T=this;w=p(w);var L=T.ready().then(function(){var j=T._dbInfo;localStorage.removeItem(j.keyPrefix+w)});return h(L,k),L}function rn(w,k,T){var L=this;w=p(w);var j=L.ready().then(function(){k===void 0&&(k=null);var M=k;return new d(function(H,W){var Q=L._dbInfo;Q.serializer.serialize(k,function(X,J){if(J)W(J);else try{localStorage.setItem(Q.keyPrefix+w,X),H(M)}catch(fe){(fe.name==="QuotaExceededError"||fe.name==="NS_ERROR_DOM_QUOTA_REACHED")&&W(fe),W(fe)}})})});return h(j,T),j}function dr(w,k){if(k=y.apply(this,arguments),w=typeof w!="function"&&w||{},!w.name){var T=this.config();w.name=w.name||T.name,w.storeName=w.storeName||T.storeName}var L=this,j;return w.name?j=new d(function(M){w.storeName?M(oe(w,L._defaultConfig)):M(w.name+"/")}).then(function(M){for(var H=localStorage.length-1;H>=0;H--){var W=localStorage.key(H);W.indexOf(M)===0&&localStorage.removeItem(W)}}):j=d.reject("Invalid arguments"),h(j,k),j}var bn={_driver:"localStorageWrapper",_initStorage:ye,_support:ge(),iterate:ze,getItem:Fe,setItem:rn,removeItem:Wr,clear:Se,length:Ve,key:Ne,keys:vt,dropInstance:dr},ho=function(w,k){return w===k||typeof w=="number"&&typeof k=="number"&&isNaN(w)&&isNaN(k)},an=function(w,k){for(var T=w.length,L=0;L<T;){if(ho(w[L],k))return!0;L++}return!1},Vr=Array.isArray||function(w){return Object.prototype.toString.call(w)==="[object Array]"},wn={},qr={},ke={INDEXEDDB:ft,WEBSQL:de,LOCALSTORAGE:bn},bt=[ke.INDEXEDDB._driver,ke.WEBSQL._driver,ke.LOCALSTORAGE._driver],_n=["dropInstance"],Ue=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(_n),hr={description:"",driver:bt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function _c(w,k){w[k]=function(){var T=arguments;return w.ready().then(function(){return w[k].apply(w,T)})}}function fo(){for(var w=1;w<arguments.length;w++){var k=arguments[w];if(k)for(var T in k)k.hasOwnProperty(T)&&(Vr(k[T])?arguments[0][T]=k[T].slice():arguments[0][T]=k[T])}return arguments[0]}var UN=function(){function w(k){o(this,w);for(var T in ke)if(ke.hasOwnProperty(T)){var L=ke[T],j=L._driver;this[T]=j,wn[j]||this.defineDriver(L)}this._defaultConfig=fo({},hr),this._config=fo({},this._defaultConfig,k),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return w.prototype.config=function(k){if((typeof k>"u"?"undefined":i(k))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var T in k){if(T==="storeName"&&(k[T]=k[T].replace(/\W/g,"_")),T==="version"&&typeof k[T]!="number")return new Error("Database version must be a number.");this._config[T]=k[T]}return"driver"in k&&k.driver?this.setDriver(this._config.driver):!0}else return typeof k=="string"?this._config[k]:this._config},w.prototype.defineDriver=function(k,T,L){var j=new d(function(M,H){try{var W=k._driver,Q=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!k._driver){H(Q);return}for(var X=Ue.concat("_initStorage"),J=0,fe=X.length;J<fe;J++){var Te=X[J],Me=!an(_n,Te);if((Me||k[Te])&&typeof k[Te]!="function"){H(Q);return}}var Le=function(){for(var He=function(zN){return function(){var ZN=new Error("Method "+zN+" is not implemented by the current driver"),G0=d.reject(ZN);return h(G0,arguments[arguments.length-1]),G0}},$t=0,Ph=_n.length;$t<Ph;$t++){var $h=_n[$t];k[$h]||(k[$h]=He($h))}};Le();var Ye=function(He){wn[W]&&console.info("Redefining LocalForage driver: "+W),wn[W]=k,qr[W]=He,M()};"_support"in k?k._support&&typeof k._support=="function"?k._support().then(Ye,H):Ye(!!k._support):Ye(!0)}catch(He){H(He)}});return f(j,T,L),j},w.prototype.driver=function(){return this._driver||null},w.prototype.getDriver=function(k,T,L){var j=wn[k]?d.resolve(wn[k]):d.reject(new Error("Driver not found."));return f(j,T,L),j},w.prototype.getSerializer=function(k){var T=d.resolve(Ga);return f(T,k),T},w.prototype.ready=function(k){var T=this,L=T._driverSet.then(function(){return T._ready===null&&(T._ready=T._initDriver()),T._ready});return f(L,k,k),L},w.prototype.setDriver=function(k,T,L){var j=this;Vr(k)||(k=[k]);var M=this._getSupportedDrivers(k);function H(){j._config.driver=j.driver()}function W(J){return j._extend(J),H(),j._ready=j._initStorage(j._config),j._ready}function Q(J){return function(){var fe=0;function Te(){for(;fe<J.length;){var Me=J[fe];return fe++,j._dbInfo=null,j._ready=null,j.getDriver(Me).then(W).catch(Te)}H();var Le=new Error("No available storage method found.");return j._driverSet=d.reject(Le),j._driverSet}return Te()}}var X=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=X.then(function(){var J=M[0];return j._dbInfo=null,j._ready=null,j.getDriver(J).then(function(fe){j._driver=fe._driver,H(),j._wrapLibraryMethodsWithReady(),j._initDriver=Q(M)})}).catch(function(){H();var J=new Error("No available storage method found.");return j._driverSet=d.reject(J),j._driverSet}),f(this._driverSet,T,L),this._driverSet},w.prototype.supports=function(k){return!!qr[k]},w.prototype._extend=function(k){fo(this,k)},w.prototype._getSupportedDrivers=function(k){for(var T=[],L=0,j=k.length;L<j;L++){var M=k[L];this.supports(M)&&T.push(M)}return T},w.prototype._wrapLibraryMethodsWithReady=function(){for(var k=0,T=Ue.length;k<T;k++)_c(this,Ue[k])},w.prototype.createInstance=function(k){return new w(k)},w}(),BN=new UN;r.exports=BN},{3:3}]},{},[4])(4)})}(R0)),R0.exports}var pN=fN();const N0=Ka(pN);class mN extends rt{constructor(e){super(e),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callbacks=e==null?void 0:e.callbacks,this.tags=(e==null?void 0:e.tags)??[],this.metadata=(e==null?void 0:e.metadata)??{},this.verbose=(e==null?void 0:e.verbose)??!1}_getRelevantDocuments(e,n){throw new Error("Not implemented!")}async invoke(e,n){return this.getRelevantDocuments(e,je(n))}async getRelevantDocuments(e,n){var i;const r=je(rR(n)),a=await((i=await Lt.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}))==null?void 0:i.handleRetrieverStart(this.toJSON(),e,r.runId,void 0,void 0,void 0,r.runName));try{const o=await this._getRelevantDocuments(e,a);return await(a==null?void 0:a.handleRetrieverEnd(o)),o}catch(o){throw await(a==null?void 0:a.handleRetrieverError(o)),o}}}class Th extends mN{static lc_name(){return"VectorStoreRetriever"}get lc_namespace(){return["langchain_core","vectorstores"]}_vectorstoreType(){return this.vectorStore._vectorstoreType()}constructor(e){super(e),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"searchType",{enumerable:!0,configurable:!0,writable:!0,value:"similarity"}),Object.defineProperty(this,"searchKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.searchType=e.searchType??this.searchType,this.filter=e.filter,e.searchType==="mmr"&&(this.searchKwargs=e.searchKwargs)}async _getRelevantDocuments(e,n){if(this.searchType==="mmr"){if(typeof this.vectorStore.maxMarginalRelevanceSearch!="function")throw new Error(`The vector store backing this retriever, ${this._vectorstoreType()} does not support max marginal relevance search.`);return this.vectorStore.maxMarginalRelevanceSearch(e,{k:this.k,filter:this.filter,...this.searchKwargs},n==null?void 0:n.getChild("vectorstore"))}return this.vectorStore.similaritySearch(e,this.k,this.filter,n==null?void 0:n.getChild("vectorstore"))}async addDocuments(e,n){return this.vectorStore.addDocuments(e,n)}}class C0 extends wr{constructor(e,n){super(n),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","vectorstores",this._vectorstoreType()]}),Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw new Error("Not implemented.")}async similaritySearch(e,n=4,r=void 0,a=void 0){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),n,r)).map(i=>i[0])}async similaritySearchWithScore(e,n=4,r=void 0,a=void 0){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),n,r)}static fromTexts(e,n,r,a){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,n,r){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,n,r,a,i,o){if(typeof e=="number")return new Th({vectorStore:this,k:e,filter:n,tags:[...a??[],this._vectorstoreType()],metadata:i,verbose:o,callbacks:r});{const s={vectorStore:this,k:e==null?void 0:e.k,filter:e==null?void 0:e.filter,tags:[...(e==null?void 0:e.tags)??[],this._vectorstoreType()],metadata:e==null?void 0:e.metadata,verbose:e==null?void 0:e.verbose,callbacks:e==null?void 0:e.callbacks,searchType:e==null?void 0:e.searchType};return(e==null?void 0:e.searchType)==="mmr"?new Th({...s,searchKwargs:e.searchKwargs}):new Th({...s})}}}function gN(t,e){let n=0,r=0,a=0;for(let i=0;i<t.length;i++)n+=t[i]*e[i],r+=t[i]*t[i],a+=e[i]*e[i];return n/(Math.sqrt(r)*Math.sqrt(a))}function yN(t,e){let n=0,r=0,a=0;for(let i=0;i<t.length;i++)n+=t[i]*e[i],r+=t[i]*t[i],a+=e[i]*e[i];return n/(Math.sqrt(r)*Math.sqrt(a))}function vN(t,e,n){if(t.length===0||t[0].length===0||e.length===0||e[0].length===0)return[[]];if(t[0].length!==e[0].length)throw new Error(`Number of columns in X and Y must be the same. X has shape ${[t.length,t[0].length]} and Y has shape ${[e.length,e[0].length]}.`);return t.map(r=>e.map(a=>n(r,a)).map(a=>Number.isNaN(a)?0:a))}function j0(t,e){return vN(t,e,yN)}function bN(t,e,n=.5,r=4){if(Math.min(r,e.length)<=0)return[];const a=Array.isArray(t[0])?t:[t],i=j0(a,e)[0],o=wN(i).maxIndex,s=[e[o]],c=[o];for(;c.length<Math.min(r,e.length);){let l=-1/0,u=-1;const d=j0(e,s);i.forEach((h,f)=>{if(c.includes(f))return;const p=Math.max(...d[f]),y=n*h-(1-n)*p;y>l&&(l=y,u=f)}),s.push(e[u]),c.push(u)}return c}function wN(t){if(t.length===0)return{maxIndex:-1,maxValue:NaN};let e=t[0],n=0;for(let r=1;r<t.length;r+=1)t[r]>e&&(n=r,e=t[r]);return{maxIndex:n,maxValue:e}}class Ma extends C0{_vectorstoreType(){return"memory"}constructor(e,{similarity:n,...r}={}){super(e,r),Object.defineProperty(this,"memoryVectors",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"similarity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.similarity=n??gN}async addDocuments(e){const n=e.map(({pageContent:r})=>r);return this.addVectors(await this.embeddings.embedDocuments(n),e)}async addVectors(e,n){const r=e.map((a,i)=>({content:n[i].pageContent,embedding:a,metadata:n[i].metadata,id:n[i].id}));this.memoryVectors=this.memoryVectors.concat(r)}async _queryVectors(e,n,r){const a=i=>{if(!r)return!0;const o=new br({metadata:i.metadata,pageContent:i.content,id:i.id});return r(o)};return this.memoryVectors.filter(a).map((i,o)=>({similarity:this.similarity(e,i.embedding),index:o,metadata:i.metadata,content:i.content,embedding:i.embedding,id:i.id})).sort((i,o)=>i.similarity>o.similarity?-1:0).slice(0,n)}async similaritySearchVectorWithScore(e,n,r){return(await this._queryVectors(e,n,r)).map(a=>[new br({metadata:a.metadata,pageContent:a.content,id:a.id}),a.similarity])}async maxMarginalRelevanceSearch(e,n){const r=await this.embeddings.embedQuery(e),a=await this._queryVectors(r,n.fetchK??20,n.filter),i=a.map(o=>o.embedding);return bN(r,i,n.lambda,n.k).map(o=>new br({metadata:a[o].metadata,pageContent:a[o].content,id:a[o].id}))}static async fromTexts(e,n,r,a){const i=[];for(let o=0;o<e.length;o+=1){const s=Array.isArray(n)?n[o]:n,c=new br({pageContent:e[o],metadata:s});i.push(c)}return Ma.fromDocuments(i,r,a)}static async fromDocuments(e,n,r){const a=new this(n,r);return await a.addDocuments(e),a}static async fromExistingIndex(e,n){return new this(e,n)}}class Zr extends C0{_vectorstoreType(){return"voi"}constructor(e,n){super(n,{}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numDimensions",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"docstore",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.client=e,this.embeddings=n}async addDocuments(e){const n=e.map(({pageContent:i})=>i);if(e.length===0)return;const r=(await this.embeddings.embedDocuments(n.slice(0,1)))[0];if(this.numDimensions===null)this.numDimensions=r.length;else if(this.numDimensions!==r.length)throw new Error(`Vectors must have the same length as the number of dimensions (${this.numDimensions})`);const a=await this.embeddings.embedDocuments(n.slice(1));await this.addVectors([r,...a],e)}async addVectors(e,n){if(e.length===0)return;if(this.numDimensions===null&&(this.numDimensions=e[0].length),e.length!==n.length)throw new Error("Vectors and metadata must have the same length");if(!e.every(a=>a.length===this.numDimensions))throw new Error(`Vectors must have the same length as the number of dimensions (${this.numDimensions})`);e.forEach((a,i)=>{const o=n[i];this.docstore.push({embeddings:a,document:o})});const r=this.docstore.map((a,i)=>({id:String(i),embeddings:a.embeddings,title:"",url:""}));this.client.index({embeddings:r})}async similaritySearchVectorWithScore(e,n){if(this.numDimensions===null)throw new Error("There aren't any elements in the index yet.");if(e.length!==this.numDimensions)throw new Error(`Query vector must have the same length as the number of dimensions (${this.numDimensions})`);const r=Math.min(this.docstore.length,n);return r>this.docstore.length&&console.warn(`k (${n}) is greater than the number of elements in the index (${this.docstore.length}), setting k to ${r}`),this.client.search(new Float32Array(e),r).neighbors.map(({id:a},i)=>[this.docstore[parseInt(a,10)].document,i])}async delete(e){if(e.deleteAll===!0)await this.client.clear();else throw new Error('You must provide a "deleteAll" parameter.')}static async fromTexts(e,n,r,a){const i=[];for(let o=0;o<e.length;o+=1){const s=Array.isArray(n)?n[o]:n,c=new br({pageContent:e[o],metadata:s});i.push(c)}return Zr.fromDocuments(i,r,a)}static async fromDocuments(e,n,r){const a=new Zr(r,n);return await a.addDocuments(e),a}}var A0={exports:{}};let P0;P0={},Kf=Object.freeze(Object.defineProperty({__proto__:null,default:P0},Symbol.toStringTag,{value:"Module"})),Gf=XN(Kf);var $0;function _N(){return $0||($0=1,function(t){(function(){var e="input is invalid type",n="finalize already called",r=typeof window=="object",a=r?window:{};a.JS_MD5_NO_WINDOW&&(r=!1);var i=!r&&typeof self=="object",o=!a.JS_MD5_NO_NODE_JS&&typeof pt=="object"&&pt.versions&&pt.versions.node;o?a=go:i&&(a=self);var s=!a.JS_MD5_NO_COMMON_JS&&!0&&t.exports,c=!a.JS_MD5_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",l="0123456789abcdef".split(""),u=[128,32768,8388608,-2147483648],d=[0,8,16,24],h=["hex","array","digest","buffer","arrayBuffer","base64"],f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),p=[],y;if(c){var v=new ArrayBuffer(68);y=new Uint8Array(v),p=new Uint32Array(v)}var x=Array.isArray;(a.JS_MD5_NO_NODE_JS||!x)&&(x=function(E){return Object.prototype.toString.call(E)==="[object Array]"});var O=ArrayBuffer.isView;c&&(a.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW||!O)&&(O=function(E){return typeof E=="object"&&E.buffer&&E.buffer.constructor===ArrayBuffer});var I=function(E){var R=typeof E;if(R==="string")return[E,!0];if(R!=="object"||E===null)throw new Error(e);if(c&&E.constructor===ArrayBuffer)return[new Uint8Array(E),!1];if(!x(E)&&!O(E))throw new Error(e);return[E,!1]},A=function(E){return function(R){return new G(!0).update(R)[E]()}},_=function(){var E=A("hex");o&&(E=U(E)),E.create=function(){return new G},E.update=function(b){return E.create().update(b)};for(var R=0;R<h.length;++R){var S=h[R];E[S]=A(S)}return E},U=function(E){var R=Gf,S=QN().Buffer,b;S.from&&!a.JS_MD5_NO_BUFFER_FROM?b=S.from:b=function(C){return new S(C)};var z=function(C){if(typeof C=="string")return R.createHash("md5").update(C,"utf8").digest("hex");if(C==null)throw new Error(e);return C.constructor===ArrayBuffer&&(C=new Uint8Array(C)),x(C)||O(C)||C.constructor===S?R.createHash("md5").update(b(C)).digest("hex"):E(C)};return z},Z=function(E){return function(R,S){return new re(R,!0).update(S)[E]()}},F=function(){var E=Z("hex");E.create=function(b){return new re(b)},E.update=function(b,z){return E.create(b).update(z)};for(var R=0;R<h.length;++R){var S=h[R];E[S]=Z(S)}return E};function G(E){if(E)p[0]=p[16]=p[1]=p[2]=p[3]=p[4]=p[5]=p[6]=p[7]=p[8]=p[9]=p[10]=p[11]=p[12]=p[13]=p[14]=p[15]=0,this.blocks=p,this.buffer8=y;else if(c){var R=new ArrayBuffer(68);this.buffer8=new Uint8Array(R),this.blocks=new Uint32Array(R)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}G.prototype.update=function(E){if(this.finalized)throw new Error(n);var R=I(E);E=R[0];for(var S=R[1],b,z=0,C,$=E.length,P=this.blocks,Y=this.buffer8;z<$;){if(this.hashed&&(this.hashed=!1,P[0]=P[16],P[16]=P[1]=P[2]=P[3]=P[4]=P[5]=P[6]=P[7]=P[8]=P[9]=P[10]=P[11]=P[12]=P[13]=P[14]=P[15]=0),S)if(c)for(C=this.start;z<$&&C<64;++z)b=E.charCodeAt(z),b<128?Y[C++]=b:b<2048?(Y[C++]=192|b>>>6,Y[C++]=128|b&63):b<55296||b>=57344?(Y[C++]=224|b>>>12,Y[C++]=128|b>>>6&63,Y[C++]=128|b&63):(b=65536+((b&1023)<<10|E.charCodeAt(++z)&1023),Y[C++]=240|b>>>18,Y[C++]=128|b>>>12&63,Y[C++]=128|b>>>6&63,Y[C++]=128|b&63);else for(C=this.start;z<$&&C<64;++z)b=E.charCodeAt(z),b<128?P[C>>>2]|=b<<d[C++&3]:b<2048?(P[C>>>2]|=(192|b>>>6)<<d[C++&3],P[C>>>2]|=(128|b&63)<<d[C++&3]):b<55296||b>=57344?(P[C>>>2]|=(224|b>>>12)<<d[C++&3],P[C>>>2]|=(128|b>>>6&63)<<d[C++&3],P[C>>>2]|=(128|b&63)<<d[C++&3]):(b=65536+((b&1023)<<10|E.charCodeAt(++z)&1023),P[C>>>2]|=(240|b>>>18)<<d[C++&3],P[C>>>2]|=(128|b>>>12&63)<<d[C++&3],P[C>>>2]|=(128|b>>>6&63)<<d[C++&3],P[C>>>2]|=(128|b&63)<<d[C++&3]);else if(c)for(C=this.start;z<$&&C<64;++z)Y[C++]=E[z];else for(C=this.start;z<$&&C<64;++z)P[C>>>2]|=E[z]<<d[C++&3];this.lastByteIndex=C,this.bytes+=C-this.start,C>=64?(this.start=C-64,this.hash(),this.hashed=!0):this.start=C}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this},G.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var E=this.blocks,R=this.lastByteIndex;E[R>>>2]|=u[R&3],R>=56&&(this.hashed||this.hash(),E[0]=E[16],E[16]=E[1]=E[2]=E[3]=E[4]=E[5]=E[6]=E[7]=E[8]=E[9]=E[10]=E[11]=E[12]=E[13]=E[14]=E[15]=0),E[14]=this.bytes<<3,E[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},G.prototype.hash=function(){var E,R,S,b,z,C,$=this.blocks;this.first?(E=$[0]-680876937,E=(E<<7|E>>>25)-271733879<<0,b=(-1732584194^E&2004318071)+$[1]-117830708,b=(b<<12|b>>>20)+E<<0,S=(-271733879^b&(E^-271733879))+$[2]-1126478375,S=(S<<17|S>>>15)+b<<0,R=(E^S&(b^E))+$[3]-1316259209,R=(R<<22|R>>>10)+S<<0):(E=this.h0,R=this.h1,S=this.h2,b=this.h3,E+=(b^R&(S^b))+$[0]-680876936,E=(E<<7|E>>>25)+R<<0,b+=(S^E&(R^S))+$[1]-389564586,b=(b<<12|b>>>20)+E<<0,S+=(R^b&(E^R))+$[2]+606105819,S=(S<<17|S>>>15)+b<<0,R+=(E^S&(b^E))+$[3]-1044525330,R=(R<<22|R>>>10)+S<<0),E+=(b^R&(S^b))+$[4]-176418897,E=(E<<7|E>>>25)+R<<0,b+=(S^E&(R^S))+$[5]+1200080426,b=(b<<12|b>>>20)+E<<0,S+=(R^b&(E^R))+$[6]-1473231341,S=(S<<17|S>>>15)+b<<0,R+=(E^S&(b^E))+$[7]-45705983,R=(R<<22|R>>>10)+S<<0,E+=(b^R&(S^b))+$[8]+1770035416,E=(E<<7|E>>>25)+R<<0,b+=(S^E&(R^S))+$[9]-1958414417,b=(b<<12|b>>>20)+E<<0,S+=(R^b&(E^R))+$[10]-42063,S=(S<<17|S>>>15)+b<<0,R+=(E^S&(b^E))+$[11]-1990404162,R=(R<<22|R>>>10)+S<<0,E+=(b^R&(S^b))+$[12]+1804603682,E=(E<<7|E>>>25)+R<<0,b+=(S^E&(R^S))+$[13]-40341101,b=(b<<12|b>>>20)+E<<0,S+=(R^b&(E^R))+$[14]-1502002290,S=(S<<17|S>>>15)+b<<0,R+=(E^S&(b^E))+$[15]+1236535329,R=(R<<22|R>>>10)+S<<0,E+=(S^b&(R^S))+$[1]-165796510,E=(E<<5|E>>>27)+R<<0,b+=(R^S&(E^R))+$[6]-1069501632,b=(b<<9|b>>>23)+E<<0,S+=(E^R&(b^E))+$[11]+643717713,S=(S<<14|S>>>18)+b<<0,R+=(b^E&(S^b))+$[0]-373897302,R=(R<<20|R>>>12)+S<<0,E+=(S^b&(R^S))+$[5]-701558691,E=(E<<5|E>>>27)+R<<0,b+=(R^S&(E^R))+$[10]+38016083,b=(b<<9|b>>>23)+E<<0,S+=(E^R&(b^E))+$[15]-660478335,S=(S<<14|S>>>18)+b<<0,R+=(b^E&(S^b))+$[4]-405537848,R=(R<<20|R>>>12)+S<<0,E+=(S^b&(R^S))+$[9]+568446438,E=(E<<5|E>>>27)+R<<0,b+=(R^S&(E^R))+$[14]-1019803690,b=(b<<9|b>>>23)+E<<0,S+=(E^R&(b^E))+$[3]-187363961,S=(S<<14|S>>>18)+b<<0,R+=(b^E&(S^b))+$[8]+1163531501,R=(R<<20|R>>>12)+S<<0,E+=(S^b&(R^S))+$[13]-1444681467,E=(E<<5|E>>>27)+R<<0,b+=(R^S&(E^R))+$[2]-51403784,b=(b<<9|b>>>23)+E<<0,S+=(E^R&(b^E))+$[7]+1735328473,S=(S<<14|S>>>18)+b<<0,R+=(b^E&(S^b))+$[12]-1926607734,R=(R<<20|R>>>12)+S<<0,z=R^S,E+=(z^b)+$[5]-378558,E=(E<<4|E>>>28)+R<<0,b+=(z^E)+$[8]-2022574463,b=(b<<11|b>>>21)+E<<0,C=b^E,S+=(C^R)+$[11]+1839030562,S=(S<<16|S>>>16)+b<<0,R+=(C^S)+$[14]-35309556,R=(R<<23|R>>>9)+S<<0,z=R^S,E+=(z^b)+$[1]-1530992060,E=(E<<4|E>>>28)+R<<0,b+=(z^E)+$[4]+1272893353,b=(b<<11|b>>>21)+E<<0,C=b^E,S+=(C^R)+$[7]-155497632,S=(S<<16|S>>>16)+b<<0,R+=(C^S)+$[10]-1094730640,R=(R<<23|R>>>9)+S<<0,z=R^S,E+=(z^b)+$[13]+681279174,E=(E<<4|E>>>28)+R<<0,b+=(z^E)+$[0]-358537222,b=(b<<11|b>>>21)+E<<0,C=b^E,S+=(C^R)+$[3]-722521979,S=(S<<16|S>>>16)+b<<0,R+=(C^S)+$[6]+76029189,R=(R<<23|R>>>9)+S<<0,z=R^S,E+=(z^b)+$[9]-640364487,E=(E<<4|E>>>28)+R<<0,b+=(z^E)+$[12]-421815835,b=(b<<11|b>>>21)+E<<0,C=b^E,S+=(C^R)+$[15]+530742520,S=(S<<16|S>>>16)+b<<0,R+=(C^S)+$[2]-995338651,R=(R<<23|R>>>9)+S<<0,E+=(S^(R|~b))+$[0]-198630844,E=(E<<6|E>>>26)+R<<0,b+=(R^(E|~S))+$[7]+1126891415,b=(b<<10|b>>>22)+E<<0,S+=(E^(b|~R))+$[14]-1416354905,S=(S<<15|S>>>17)+b<<0,R+=(b^(S|~E))+$[5]-57434055,R=(R<<21|R>>>11)+S<<0,E+=(S^(R|~b))+$[12]+1700485571,E=(E<<6|E>>>26)+R<<0,b+=(R^(E|~S))+$[3]-1894986606,b=(b<<10|b>>>22)+E<<0,S+=(E^(b|~R))+$[10]-1051523,S=(S<<15|S>>>17)+b<<0,R+=(b^(S|~E))+$[1]-2054922799,R=(R<<21|R>>>11)+S<<0,E+=(S^(R|~b))+$[8]+1873313359,E=(E<<6|E>>>26)+R<<0,b+=(R^(E|~S))+$[15]-30611744,b=(b<<10|b>>>22)+E<<0,S+=(E^(b|~R))+$[6]-1560198380,S=(S<<15|S>>>17)+b<<0,R+=(b^(S|~E))+$[13]+1309151649,R=(R<<21|R>>>11)+S<<0,E+=(S^(R|~b))+$[4]-145523070,E=(E<<6|E>>>26)+R<<0,b+=(R^(E|~S))+$[11]-1120210379,b=(b<<10|b>>>22)+E<<0,S+=(E^(b|~R))+$[2]+718787259,S=(S<<15|S>>>17)+b<<0,R+=(b^(S|~E))+$[9]-343485551,R=(R<<21|R>>>11)+S<<0,this.first?(this.h0=E+1732584193<<0,this.h1=R-271733879<<0,this.h2=S-1732584194<<0,this.h3=b+271733878<<0,this.first=!1):(this.h0=this.h0+E<<0,this.h1=this.h1+R<<0,this.h2=this.h2+S<<0,this.h3=this.h3+b<<0)},G.prototype.hex=function(){this.finalize();var E=this.h0,R=this.h1,S=this.h2,b=this.h3;return l[E>>>4&15]+l[E&15]+l[E>>>12&15]+l[E>>>8&15]+l[E>>>20&15]+l[E>>>16&15]+l[E>>>28&15]+l[E>>>24&15]+l[R>>>4&15]+l[R&15]+l[R>>>12&15]+l[R>>>8&15]+l[R>>>20&15]+l[R>>>16&15]+l[R>>>28&15]+l[R>>>24&15]+l[S>>>4&15]+l[S&15]+l[S>>>12&15]+l[S>>>8&15]+l[S>>>20&15]+l[S>>>16&15]+l[S>>>28&15]+l[S>>>24&15]+l[b>>>4&15]+l[b&15]+l[b>>>12&15]+l[b>>>8&15]+l[b>>>20&15]+l[b>>>16&15]+l[b>>>28&15]+l[b>>>24&15]},G.prototype.toString=G.prototype.hex,G.prototype.digest=function(){this.finalize();var E=this.h0,R=this.h1,S=this.h2,b=this.h3;return[E&255,E>>>8&255,E>>>16&255,E>>>24&255,R&255,R>>>8&255,R>>>16&255,R>>>24&255,S&255,S>>>8&255,S>>>16&255,S>>>24&255,b&255,b>>>8&255,b>>>16&255,b>>>24&255]},G.prototype.array=G.prototype.digest,G.prototype.arrayBuffer=function(){this.finalize();var E=new ArrayBuffer(16),R=new Uint32Array(E);return R[0]=this.h0,R[1]=this.h1,R[2]=this.h2,R[3]=this.h3,E},G.prototype.buffer=G.prototype.arrayBuffer,G.prototype.base64=function(){for(var E,R,S,b="",z=this.array(),C=0;C<15;)E=z[C++],R=z[C++],S=z[C++],b+=f[E>>>2]+f[(E<<4|R>>>4)&63]+f[(R<<2|S>>>6)&63]+f[S&63];return E=z[C],b+=f[E>>>2]+f[E<<4&63]+"==",b};function re(E,R){var S,b=I(E);if(E=b[0],b[1]){var z=[],C=E.length,$=0,P;for(S=0;S<C;++S)P=E.charCodeAt(S),P<128?z[$++]=P:P<2048?(z[$++]=192|P>>>6,z[$++]=128|P&63):P<55296||P>=57344?(z[$++]=224|P>>>12,z[$++]=128|P>>>6&63,z[$++]=128|P&63):(P=65536+((P&1023)<<10|E.charCodeAt(++S)&1023),z[$++]=240|P>>>18,z[$++]=128|P>>>12&63,z[$++]=128|P>>>6&63,z[$++]=128|P&63);E=z}E.length>64&&(E=new G(!0).update(E).array());var Y=[],ae=[];for(S=0;S<64;++S){var le=E[S]||0;Y[S]=92^le,ae[S]=54^le}G.call(this,R),this.update(ae),this.oKeyPad=Y,this.inner=!0,this.sharedMemory=R}re.prototype=new G,re.prototype.finalize=function(){if(G.prototype.finalize.call(this),this.inner){this.inner=!1;var E=this.array();G.call(this,this.sharedMemory),this.update(this.oKeyPad),this.update(E),G.prototype.finalize.call(this)}};var he=_();he.md5=he,he.md5.hmac=F(),s?t.exports=he:a.md5=he})()}(A0)),A0.exports}var xN=_N();let eo,Da,to,Rh,no;jo=t=>t?t.join("|\u294A|"):"",Ao=t=>t?t.split("|\u294A|"):[],eo=t=>t?t.join("|\u294C|"):"",$o=t=>t?t.split("|\u294C|"):[],mw=(t,e)=>({headers:jo(t),data:eo(e.map(n=>jo(n)))}),Zf=(t,e)=>{const n=Ao(t),r=$o(e).reduce((a,i)=>{const o=Ao(i);return o.length===n.length?[...a,n.reduce((s,c,l)=>({...s,[c]:o[l]}),{})]:a},[]);return{headers:n,rows:r}},Da=async({provider:t,storedData:e,databaseName:n})=>{switch(t){case"voy":return e.map((r,a)=>{var i,o;return{id:r.id||((i=r.metadata)==null?void 0:i.id)||a,title:JSON.stringify({pageContent:r.content,metadata:r.metadata}),url:`/${n}/items/${r.id||((o=r.metadata)==null?void 0:o.id)||a}`,embeddings:r.embedding}});case"memory":return e.map((r,a)=>{var i;return{content:r.content,embedding:r.embedding,metadata:r.metadata,id:r.id||((i=r.metadata)==null?void 0:i.id)||a}});default:throw new Error("Invalid provider")}},to=async({storageType:t,provider:e,databaseName:n,storageService:r,storageDataNode:a})=>{switch(t){case zn.DataNode:{if(!a)throw new Error("Storage data node not found");if("csv"in a){const{rows:i}=Zf((a==null?void 0:a.headers)||"",(a==null?void 0:a.csv)||"");return Da({provider:e,storedData:i,databaseName:n})}return"json"in a?Da({provider:e,storedData:JSON.parse((a==null?void 0:a.json)||"[]"),databaseName:n}):"jsonl"in a?Da({provider:e,storedData:$o(a==null?void 0:a.jsonl).map(i=>JSON.parse(i)),databaseName:n}):[]}case zn.DatabaseNode:return Da({provider:e,storedData:$o(a==null?void 0:a.raw).map(i=>JSON.parse(i)),databaseName:n});case zn.IndexedDB:{const i=await(r==null?void 0:r.getItem(n));return i?Da({provider:e,storedData:i,databaseName:n}):[]}default:throw new Error("Invalid storage type")}},Rh=async({docstore:t,storageType:e,databaseName:n,embeddingStorage:r,storageDataNode:a})=>{const i=t.map(o=>"embedding"in o?{id:o.id,embedding:o.embedding,content:o.content,metadata:o.metadata}:{id:o.document.metadata.id,content:o.document.pageContent,metadata:o.document.metadata,embedding:o.embeddings});switch(e){case zn.DataNode:{if(a=a,!a)throw new Error("Storage data node not found");const o=Hf(a);o==="CSVData"&&await tt(o).update(a.id,{csv:eo(i.map(s=>{const c=Ao(a.headers).map(l=>s[l]);return jo(c)}))}),o==="JSONData"&&await tt(o).update(a.id,{json:JSON.stringify(i)}),o==="JSONLData"&&await tt(o).update(a.id,{jsonl:eo(i.map(s=>JSON.stringify(s)))})}break;case zn.DatabaseNode:{const o=a;await tt("VectorDatabase").update(o.id,{raw:eo(i.map(s=>JSON.stringify(s)))})}break;case zn.IndexedDB:await r.setItem(n,i);break}return i},Hf=t=>"csv"in t?"CSVData":"json"in t?"JSONData":"jsonl"in t?"JSONLData":void 0,no=t=>xN.md5(t),df="nomic-ai/nomic-embed-text-v1.5",hf=class{constructor(t){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new xo(t??{})}},ff=(t,e)=>t.reduce((n,r,a)=>{const i=Math.floor(a/e),o=n[i]||[];return n[i]=o.concat([r]),n},[]);class EN extends hf{constructor(n){super(n??{});qe(this,"worker");qe(this,"EMBEDDING_LOAD_MESSAGE_ID","EMBEDDING_LOAD_MESSAGE_ID");qe(this,"ready",!1);qe(this,"timeout");qe(this,"stripNewLines",!0);qe(this,"modelName","Xenova/all-MiniLM-L6-v2");qe(this,"model","Xenova/all-MiniLM-L6-v2");qe(this,"batchSize",512);qe(this,"pretrainedOptions");qe(this,"pipelineOptions");qe(this,"refProcesses",new Map);qe(this,"initWorker",()=>{mr(this.worker,"load",this.EMBEDDING_LOAD_MESSAGE_ID,[this.model,this.pretrainedOptions]),this.worker.removeEventListener("message",this.handleMessages),this.worker.addEventListener("message",this.handleMessages);const n=gr();return this.refProcesses.set(this.EMBEDDING_LOAD_MESSAGE_ID,[n.promise,n.resolve,n.reject]),n.promise});qe(this,"handleMessages",n=>{const r=n.data.messageId;if(r!==eC)if(n.data.type==="complete"||n.data.type==="error"){const[,a,i]=this.refProcesses.get(r)||[];n.data.type==="complete"?a==null||a(n.data.payload):i==null||i(new Error(JSON.stringify(n.data.payload))),r===this.EMBEDDING_LOAD_MESSAGE_ID&&(this.ready=!!n.data.payload),this.refProcesses.delete(r)}else n.data.type==="started"||n.data.type==="inprogress"||yo("Unknown message type",n.data)});qe(this,"runEmbedding",async n=>{if(!this.worker)throw new Error("MISSING WORKER");const r=this.refProcesses.get(this.EMBEDDING_LOAD_MESSAGE_ID);if(r!=null&&r[0]&&await(r==null?void 0:r[0]),!this.ready)throw new Error("WORKER NOT READY YET");return this.caller.call(async()=>{const a=yr(),i=gr(()=>{mr(this.worker,"embedding",a,[n,this.pipelineOptions])});return this.refProcesses.set(a,[i.promise,i.resolve,i.reject]),i.promise.then(o=>o)})});this.worker=n.worker,this.modelName=(n==null?void 0:n.model)??(n==null?void 0:n.modelName)??this.model,this.model=this.modelName,this.stripNewLines=(n==null?void 0:n.stripNewLines)??this.stripNewLines,this.timeout=n==null?void 0:n.timeout,this.pretrainedOptions=(n==null?void 0:n.pretrainedOptions)??{},this.pipelineOptions={pooling:"mean",normalize:!0,...n==null?void 0:n.pipelineOptions},this.initWorker()}async embedDocuments(n){const r=ff(this.stripNewLines?n.map(o=>o.replace(/\n/g," ")):n,this.batchSize).map(o=>this.runEmbedding(o)),a=await Promise.all(r),i=[];for(let o=0;o<a.length;o+=1){const s=a[o];for(let c=0;c<s.length;c+=1)i.push(s[c])}return i}async embedQuery(n){return(await this.runEmbedding([this.stripNewLines?n.replace(/\n/g," "):n]))[0]}}let L0,M0,D0,F0;L0=()=>new Worker(new URL("/NoLLMChat/assets/embedding.worker-D6RYcgJ2.js",import.meta.url),{type:"module"}),M0=(t,e)=>{var n;try{const r=JSON.parse(t.metadata||"{}");if(!(r!=null&&r.textSplitter))return e;switch((n=r==null?void 0:r.textSplitter)==null?void 0:n.type){case"TokenTextSplitter":return new SI({chunkOverlap:+r.textSplitter.chunkOverlap,chunkSize:+r.textSplitter.chunkSize}).splitDocuments(e);case"CharacterTextSplitter":return new EI({chunkOverlap:+r.textSplitter.chunkOverlap,chunkSize:+r.textSplitter.chunkSize}).splitDocuments(e);case"RecursiveCharacterTextSplitter":return new cc({chunkOverlap:+r.textSplitter.chunkOverlap,chunkSize:+r.textSplitter.chunkSize}).splitDocuments(e);default:throw new Error("Invalid text splitter")}}catch{return e}},D0=(t,e)=>({destroy:()=>{try{const n=e().worker;n&&n.terminate(),t({localEmbedding:void 0,embeddingStorage:void 0,worker:void 0})}catch(n){yo("Destroy Local Embedding Thread",n)}},init:async()=>{try{const n=e().worker;n&&n.terminate();const r=L0(),a=new EN({modelName:df,worker:r}),i=N0.createInstance({name:"vector-database",driver:N0.INDEXEDDB,storeName:"main"});t({worker:r,localEmbedding:a,embeddingStorage:i})}catch(n){yo("Init Local Embedding Thread",n)}finally{t({ready:!0})}},index:async(n,r)=>{const a=(n==null?void 0:n.embedding)||e().localEmbedding,i=e().embeddingStorage;if(!a||!i)throw new Error("Missing embedding model or storage.");const o=await tt("VectorDatabase").findOne({where:{id:n.database.databaseId}});if(!o)throw new Error("Database not found.");if(!o.provider)throw new Error("Database provider not found.");const s=n.database.dataSourceId&&n.database.dataSourceType?await tt(n.database.dataSourceType).findOne({where:{id:n.database.dataSourceId}}):void 0,c=no(o.name),l=await M0(o,r),u=await to({databaseName:c,storageType:o.storage||"IndexedDB",provider:o.provider,storageService:i,storageDataNode:o||s});switch(o.provider){case sn.Voy:{const d=new cr({embeddings:u}),h=new Zr(d,a);await h.addDocuments(l),await Rh({databaseName:c,provider:o.provider,embeddingStorage:i,docstore:h.docstore,storageType:o.storage||"IndexedDB",storageDataNode:s||o})}break;case sn.Memory:{const d=new Ma(a);d.memoryVectors=u,await d.addDocuments(l),await Rh({databaseName:c,provider:o.provider,embeddingStorage:i,docstore:d.memoryVectors,storageType:o.storage||"IndexedDB",storageDataNode:s||o})}break}},getVectorDatabase:async(n,...r)=>{const a=n.embedding||e().localEmbedding,i=e().embeddingStorage;if(!a||!i)throw new Error("Missing embedding model or storage.");const o=await tt("VectorDatabase").findOne({where:{id:n.database.databaseId}});if(!o)throw new Error("Database not found.");if(!o.provider)throw new Error("Database provider not found.");const s=n.database.dataSourceId&&n.database.dataSourceType?await tt(n.database.dataSourceType).findOne({where:{id:n.database.dataSourceId}}):void 0,c=no(o.name),l=await to({databaseName:c,storageType:o.storage||"IndexedDB",provider:o.provider,storageService:e().embeddingStorage,storageDataNode:s});switch(o.provider){case sn.Voy:{const u=new cr({embeddings:l});return new Zr(u,a)}case sn.Memory:{const u=new Ma(a,r);return u.memoryVectors=l,u}default:throw new Error("Invalid provider")}},similaritySearch:async(n,...r)=>{const a=n.embedding||e().localEmbedding,i=e().embeddingStorage;if(!a||!i)throw new Error("Missing embedding model or storage.");const o=await tt("VectorDatabase").findOne({where:{id:n.database.databaseId}});if(!o||!o.provider)throw new Error("Database not found.");if(!o.provider)throw new Error("Database provider not found.");const s=n.database.dataSourceId&&n.database.dataSourceType?await tt(n.database.dataSourceType).findOne({where:{id:n.database.dataSourceId}}):void 0,c=no(o.name),l=await to({databaseName:c,storageDataNode:s||o,provider:o.provider,storageService:i,storageType:o.storage||"IndexedDB"});switch(o.provider){case sn.Voy:{const u=new cr({embeddings:l});return await new Zr(u,a).similaritySearch(...r)}case sn.Memory:{const u=new Ma(a);return u.memoryVectors=l,await u.similaritySearch(...r)}default:throw new Error("Invalid provider")}},similaritySearchWithScore:async(n,...r)=>{const a=n.embedding||e().localEmbedding,i=e().embeddingStorage;if(!a||!i)throw new Error("Missing embedding model or storage.");const o=await tt("VectorDatabase").findOne({where:{id:n.database.databaseId}});if(!o||!o.provider)throw new Error("Database not found.");if(!o.provider)throw new Error("Database provider not found.");const s=n.database.dataSourceId&&n.database.dataSourceType?await tt(n.database.dataSourceType).findOne({where:{id:n.database.dataSourceId}}):void 0,c=no(o.name),l=await to({databaseName:c,provider:o.provider,storageDataNode:s||o,storageService:i,storageType:o.storage||"IndexedDB"});switch(o.provider){case sn.Voy:{const u=new cr({embeddings:l});return await new Zr(u,a).similaritySearchWithScore(...r)}case sn.Memory:{const u=new Ma(a);return u.memoryVectors=l,await u.similaritySearchWithScore(...r)}default:throw new Error("Invalid provider")}}}),F0={ready:!1,localEmbedding:void 0,embeddingStorage:void 0,worker:void 0},Fc=ew()(tw((t,e)=>({...F0,...D0(t,e)})));async function*mc(t,e,n,r){for(;;){const i=n.get(e);if(i){const{processInfo:o}=i;if(o&&typeof o=="object"&&"data"in o&&"lastIndex"in o&&Array.isArray(o.data)){const s=r!=null&&r.lastChunkOnly?o.data[o.data.length-1]:o.data.slice(+`${o.lastIndex}`);s&&(!Array.isArray(s)||s!=null&&s.length)&&(o.lastIndex=r!=null&&r.lastChunkOnly?o.data.length-1:o.data.length>0?o.data.length:0,yield s)}await new Promise(s=>setTimeout(s,(r==null?void 0:r.interval)||150))}else break}const a=await t;return yield a,a}const SN=()=>new Worker(new URL("/NoLLMChat/assets/local-llm.worker-3P0lie7n.js",import.meta.url),{type:"module"}),ON=(t,e)=>n=>{tC(n,t().refProcesses,{onWorkerInit:()=>e({ready:!0})})};async function kN(t,...e){const n=t.worker,r=t.refProcesses;if(!n)throw new Error("Worker not initialized");const a=gr(()=>{mr(n,"load",t.messageId,e)});return r.set(t.messageId,{promise:a.promise,resolve:a.resolve,reject:a.reject,processInfo:{type:"load",data:[],lastIndex:0}}),mc(a.promise,t.messageId,r,{lastChunkOnly:!0})}let U0,B0,Ih,gc,z0;U0=(t,e)=>({setInitializing:n=>{const r=e().initializing;t({initializing:{...r,...n}})},setSelectedModel:n=>{t({selectedModel:n})},destroy:()=>{try{const n=e().handler,r=e().worker;r&&(n&&r.removeEventListener("message",n),r.terminate()),t({handler:void 0,worker:void 0})}catch(n){yo("Destroy Local LLM thread",n)}},init:()=>{try{const n=e().handler,r=e().worker;r&&(n&&r.removeEventListener("message",n),r.terminate());const a=SN(),i=ON(e,t);a.addEventListener("message",i),t({handler:i,worker:a})}catch(n){yo("Init Local LLM Thread",n)}},syncCachedLLMURLs:async()=>caches.open("webllm/config").then(async n=>n.keys()).then(n=>{const r=n.map(a=>a.url);return t({cachedLLMURLs:r}),r}),loadModel:async(n,r)=>{let a=e().currentLoadModelMessageId;const i=e().worker,o=e().initProgressCallbacks,s=e().initializing,c=e().refProcesses;if(a){const u=c.get(a);if(u){const{reject:d}=u;d==null||d("stop"),c.delete(a)}}a=yr(),t({currentLoadModelMessageId:yr(),selectedModel:n,initializing:{...s,loading:!0}});const l=await kN({messageId:a,worker:i,refProcesses:c},{model:n});for await(const u of l)u&&(o.forEach(d=>d(u)),r==null||r(u));setTimeout(()=>{o.forEach(u=>u({progress:100,timeElapsed:1,text:`Model ${n} loaded.`})),t({initializing:{...e().initializing,loading:!1}})},100)},setInitProgressCallback:n=>{const r=e().initProgressCallbacks;return r.push(n),t({initProgressCallbacks:r}),()=>{t({initProgressCallbacks:e().initProgressCallbacks.filter(a=>a!==n)})}},invoke:(...n)=>{const r=e().refProcesses,a=e().worker;if(!a)throw new Error("Worker not initialized");const i=yr(),o=gr(()=>{mr(a,"invoke",i,n)});return r.set(i,{promise:o.promise,resolve:o.resolve,reject:o.reject,processInfo:{type:"invoke",data:[],lastIndex:0}}),o.promise},stream:(...n)=>{const r=e().refProcesses,a=e().worker;if(!a)throw new Error("Worker not initialized");const i=yr(),[o,...s]=n,c=gr(()=>{mr(a,"stream",i,[gc(o),...s])});r.set(i,{promise:c.promise,resolve:c.resolve,reject:c.reject,processInfo:{type:"invoke",data:[],lastIndex:0}});const l=c.promise;return mc(l,i,r)},structuredStream:(n,...r)=>{const a=e().refProcesses,i=e().worker;if(!i)throw new Error("Worker not initialized");const o=yr(),[s,...c]=r,l=gr(()=>{mr(i,"structured-stream",o,[n,gc(s),...c])});a.set(o,{promise:l.promise,resolve:l.resolve,reject:l.reject,processInfo:{type:"invoke",data:[],lastIndex:0}});const u=l.promise;return mc(u,o,a)},toolsCallingStream:(n,...r)=>{const a=e().refProcesses,i=e().worker;if(!i)throw new Error("Worker not initialized");const o=yr(),[s,...c]=r,l=gr(()=>{mr(i,"tools-calling-stream",o,[n,gc(s),...c])});a.set(o,{promise:l.promise,resolve:l.resolve,reject:l.reject,processInfo:{type:"invoke",data:[],lastIndex:0}});const u=l.promise;return mc(u,o,a)},getCurrentModelInfo:async()=>{const n=e().refProcesses,r=e().worker;if(!r)throw new Error("Worker not initialized");const a=yr(),i=gr(()=>{mr(r,"get-current-model-info",a,[])});return n.set(a,{promise:i.promise,resolve:i.resolve,reject:i.reject,processInfo:{type:"get-current-model-info",data:[],lastIndex:0}}),i.promise}}),B0={cachedLLMURLs:[],ready:!1,initializing:{worker:!0,init:!0,loading:!1},selectedModel:"",refProcesses:new Map,currentLoadModelMessageId:void 0,handler:void 0,initProgressCallbacks:[],worker:void 0},Ol=ew()(tw((t,e)=>({...B0,...U0(t,e)}))),Ih=t=>typeof t=="string"?t:t instanceof _o?{instanceof:"HumanMessage",item:t,content:t.content}:t instanceof wo?{instanceof:"AIMessage",item:t,content:t.content}:t instanceof kc?{instanceof:"SystemMessage",item:t,content:t.content}:t,gc=t=>Array.isArray(t)?t.map(Ih):Ih(t),z0=m.memo(({children:t})=>{const e=Ol(i=>i.destroy),n=Fc(i=>i.destroy),r=Ol(i=>i.init),a=Fc(i=>i.init);return m.useEffect(()=>(r(),a(),()=>{e(),n()}),[e,n,r,a]),t});function Z0(t){return e=>g.jsx(z0,{children:g.jsx(t,{...e})})}const TN=m.lazy(()=>vo(()=>import("./ChatApplication-DB_kECka.js").then(async t=>(await t.__tla,t)),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),RN=m.lazy(()=>vo(()=>import("./EditorApplication-BLTFxFzD.js").then(async t=>(await t.__tla,t)),__vite__mapDeps([11,1,2,8,9,10]))),IN=m.lazy(()=>vo(()=>import("./VSLiteApplication-BZ_LF9KD.js").then(async t=>(await t.__tla,t)),__vite__mapDeps([12,1,2,8,9,10,13])));function NN(){var n;const t=Un(r=>r.currentSession),e=m.useMemo(()=>{var r,a;if(!(t!=null&&t.id))return g.jsx(bo,{simple:!0,className:"w-full h-full"});if(t.main_source_type==="Thread")return g.jsx(TN,{});if(((r=t.main_node)==null?void 0:r.node_type)==="EDITOR_APP")return g.jsx(RN,{});if(((a=t.main_node)==null?void 0:a.node_type)==="VSLITE_APP")return g.jsx(IN,{})},[t==null?void 0:t.id,t==null?void 0:t.main_source_type,(n=t==null?void 0:t.main_node)==null?void 0:n.node_type]);return g.jsx(m.Suspense,{fallback:g.jsx(bo,{flickeringGrid:!0,className:"w-full h-full"}),children:e})}const CN=Z0(NN),jN=m.lazy(()=>vo(()=>import("./Home-Bwbq7TXb.js").then(async t=>(await t.__tla,t)).then(t=>t.H),__vite__mapDeps([14,1,2,7,4,8,9,10,5,6,15,13]))),AN=()=>g.jsx(m.Suspense,{fallback:g.jsx(bo,{flickeringGrid:!0,className:"w-full h-full"}),children:g.jsx(jN,{})}),PN=Z0(AN),$N=m.lazy(()=>vo(()=>import("./DocumentViewer-BF0A7NqO.js").then(async t=>(await t.__tla,t)),__vite__mapDeps([16,1,2,17]))),LN=()=>{const{documentId:t}=Go();return g.jsx(m.Suspense,{fallback:g.jsx(bo,{flickeringGrid:!0,className:"w-full h-full"}),children:g.jsx($N,{name:t||""})})};function yc(){const t=Ip();return Ec("Route Error Boundary",t),g.jsx(rC,{})}const MN=$_(g.jsxs(Gn,{errorElement:g.jsx(yc,{}),children:[g.jsxs(Gn,{element:g.jsx(ev,{requiredSession:!0}),children:[g.jsx(Gn,{path:wi.whiteboard,Component:PN,errorElement:g.jsx(yc,{})}),g.jsx(Gn,{path:wi.application,errorElement:g.jsx(yc,{}),Component:CN}),g.jsx(Gn,{path:"*",element:g.jsx(j_,{to:Xe("whiteboard")})})]}),g.jsx(Gn,{element:g.jsx(ev,{}),children:g.jsx(Gn,{path:wi.document,errorElement:g.jsx(yc,{}),Component:LN})})]})),DN=(t,e)=>{switch(Ng){case"browser":return Dp(t,e);case"hash":return ix(t);default:return Dp(t,e)}},FN=DN(MN,{basename:"/NoLLMChat/"});nC("[BASE_URL]","/NoLLMChat/");let H0;H0=m.memo(()=>{const t=!window.location.pathname.includes("/NoLLMChat/");return m.useLayoutEffect(()=>{t&&(window.location.href="/NoLLMChat/".replace("//","/"))},[t]),t?g.jsx(bo,{className:"w-screen h-screen",simple:!0}):g.jsx(gx,{router:FN})},()=>!0),gw=Object.freeze(Object.defineProperty({__proto__:null,default:H0},Symbol.toStringTag,{value:"Module"}))});export{vr as $,wo as A,Bn as B,pt as C,br as D,Sc as E,Oc as F,wr as G,_o as H,Fh as I,xo as J,nw as K,Uh as L,rw as M,je as N,Bh as O,Ya as P,on as Q,rt as R,kc as S,Lt as T,zh as U,zn as V,Zh as W,aw as X,Hh as Y,Eo as Z,Gh as _,iC as __tla,Wh as a,Yr as a$,iw as a0,Vh as a1,Tc as a2,ow as a3,Xa as a4,Xr as a5,sw as a6,Rc as a7,cw as a8,K as a9,Ic as aA,Nc as aB,So as aC,lw as aD,qh as aE,uw as aF,dw as aG,Oo as aH,Jh as aI,Kh as aJ,Yh as aK,Xh as aL,Qh as aM,ef as aN,tf as aO,nf as aP,rf as aQ,af as aR,of as aS,Cc as aT,Mt as aU,sf as aV,jc as aW,cf as aX,lf as aY,Ac as aZ,Qr as a_,_r as aa,Qa as ab,Pc as ac,$c as ad,Lc as ae,Mc as af,uf as ag,Dc as ah,Dt as ai,df as aj,hf as ak,ff as al,Fc as am,ko as an,To as ao,Uc as ap,Bc as aq,Ft as ar,pf as as,mf as at,ei as au,zc as av,Zc as aw,Hc as ax,Ro as ay,Io as az,Gc as b,hw as b$,xr as b0,Wc as b1,gf as b2,yf as b3,vf as b4,bf as b5,wf as b6,_f as b7,xf as b8,Ef as b9,Sf as bA,ti as bB,ea as bC,ta as bD,Vc as bE,Of as bF,kf as bG,Tf as bH,qc as bI,Rf as bJ,fw as bK,Jc as bL,Kc as bM,Yc as bN,If as bO,Xc as bP,Qc as bQ,el as bR,tl as bS,nl as bT,rl as bU,Nf as bV,Cf as bW,pw as bX,jf as bY,Af as bZ,Pf as b_,$f as ba,Lf as bb,Mf as bc,Df as bd,Ff as be,Uf as bf,Bf as bg,No as bh,Co as bi,na as bj,ra as bk,al as bl,mw as bm,zf as bn,sn as bo,jo as bp,Er as bq,Xe as br,Zf as bs,Hf as bt,Ao as bu,Po as bv,ni as bw,Gf as bx,Wf as by,Vf as bz,il as c,ol as c0,sl as c1,cl as c2,ll as c3,ul as c4,dl as c5,hl as c6,qf as c7,Jf as c8,Kf as c9,gw as ca,fl as d,pl as e,ml as f,gl as g,yl as h,$o as i,Yf as j,vl as k,bl as l,wl as m,_l as n,ri as o,xl as p,ai as q,aa as r,En as s,Sn as t,El as u,Sl as v,Xf as w,yw as x,Sr as y,Ol as z};
