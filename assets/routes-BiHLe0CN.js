const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/few_shot-CZwYL6L7.js","assets/index-DlgZvHNC.js","assets/index-BHmW4Jet.css","assets/dot-Xe5naG2D.js","assets/createLucideIcon-CG2tVMNv.js","assets/index-dyTZNkZk.js","assets/objectWithoutPropertiesLoose-BjXSgPXB.js","assets/index-SJHRONiT.js","assets/index-Cr8Tc6mT.css","assets/index-C6S3C89h.js","assets/pdf-2QNsmwQ-.js","assets/pdf.min-l1GqQ9Q_.js","assets/pdf.worker.min-BdOueeY8.js","assets/index-Cy5cgpTB.js","assets/use-prevent-pitch-zoom-_yrD-sve.js","assets/index-Y-w6Sa91.js","assets/link-DUWzY7OX.js","assets/trash-2-CTMeSHJ1.js","assets/text-gDtCDIWn.js","assets/external-link-Bc2IjJZp.js","assets/unlink-C6BNZTt4.js","assets/index-C8H_5KvO.js","assets/list-DDDTVHbW.js","assets/list-ordered-D4kv2CJN.js","assets/list-todo-Bhi8hSsZ.js","assets/indent-increase-Bay-_0ND.js","assets/pilcrow-DekDQO1p.js","assets/heading-1-BJ0h8fH-.js","assets/heading-2-CWgkE2Ph.js","assets/heading-3-DGynirzm.js","assets/table-BiWGI8Cq.js","assets/file-code-BA-MFDkJ.js","assets/quote-4Hp8kAaO.js","assets/minus-BxYIHTaJ.js","assets/square-Coan1DDs.js","assets/chevron-right-KUpnGyUQ.js","assets/image-B2wc0Rh6.js","assets/table-of-contents-CYJpkrB_.js","assets/columns-3-CrnBnFeq.js","assets/link-2-BBZPyKRr.js","assets/calendar-BTbaVGiT.js","assets/plus-BwBTjVEw.js","assets/wrap-text-CFCwUGg6.js","assets/pen-Bwoqv1S6.js","assets/eye-C5-oVp-I.js","assets/indent-decrease-DDWt7Ckk.js","assets/pointer-DwmT54Oo.js","assets/wand-sparkles-BH31cK34.js","assets/bold-L5fuidS0.js","assets/italic-Dxkjnl7c.js","assets/underline-CdDYuYLg.js","assets/strikethrough-CluPInsy.js","assets/code-xml-BZQe4-Ii.js","assets/baseline-BrVH5XuV.js","assets/paint-bucket-pAFJwVQD.js","assets/arrow-up-to-line-DEzIs2cl.js","assets/index-BCYu3EnN.css","assets/index-C8I42w52.js","assets/check-C6i7q8hl.js","assets/circle-CS-nFZAc.js","assets/index-CWYrunYU.js","assets/index-HSnfLTSA.css","assets/CodeContainerApp-C8e8kkPq.js","assets/DocumentViewer-C4YKHCkB.js"])))=>i.map(i=>d[i]);
import{r as g,M as zk,j as h,u as Sv,P as ODe,a as Uk,L as CDe,m as NDe,c as kDe,f as IG,i as MDe,b as Vk,d as RG,e as ADe,g as PDe,_ as DG,h as LG,k as Yl,l as Ov,n as lo,o as ni,p as Ql,q as ln,R as TDe,s as pr,t as In,v as Pe,w as ge,x as Ur,y as jt,z as Z,A as uo,S as ri,B as fr,D as Cv,C as IDe,E as Nv,F as pe,G as $G,H as RDe,I as Me,J as mf,K as Je,N as po,O as tn,Q as nn,T as le,U as Hs,V as yf,W as FG,X as DDe,Y as LDe,Z as BG,$ as Wi,a0 as eu,a1 as En,a2 as ct,a3 as zG,a4 as q,a5 as tu,a6 as $De,a7 as FDe,a8 as Sn,a9 as ie,aa as UG,ab as Hi,ac as ai,ad as gf,ae as qt,af as Vr,ag as BDe,ah as zDe,ai as UDe,aj as VDe,ak as vf,al as VG,am as WDe,an as HDe,ao as WG,ap as Wk,aq as qDe,ar as KDe,as as HG,at as Hk,au as ZDe,av as kv,aw as GDe,ax as qi,ay as qG,az as XDe,aA as JDe,aB as Pa,aC as KG,aD as YDe,aE as Mv,aF as Q,aG as gn,aH as nu,aI as Ta,aJ as Av,aK as ZG,aL as qk,aM as QDe,aN as e3e,aO as GG,aP as XG,aQ as JG,aR as t3e,aS as YG,aT as Pv,aU as n3e,aV as r3e,aW as bf,aX as a3e,aY as Wr,aZ as Tv,a_ as Kk,a$ as ru,b0 as QG,b1 as o3e,b2 as i3e,b3 as s3e,b4 as au,b5 as c3e,b6 as l3e,b7 as eX,b8 as u3e,b9 as d3e,ba as p3e,bb as f3e,bc as tX,bd as Zk,be as Et,bf as h3e,bg as Gk,bh as m3e,bi as y3e,bj as g3e,__tla as v3e}from"./index-DlgZvHNC.js";import nX,{__tla as b3e}from"./dot-Xe5naG2D.js";let ou,Xk,Iv,Jk,Yk,iu,Rv,su,Ki,wf,xf,Dv,Qk,eM,qs,tM,nM,rM,aM,Lv,oM,iM,sM,cM,lM,uM,$v,Rt,Fv,Bv,cu,Zi,Gi,_f,lu,Ks,Zs,dM,zv,pM,fM,rX,Uv,hM,Vv,mM,fo,aX,oi,uu,du,Wv,Hv,qv,Kv,Zv,Gv,Xv,Jv,yM,gM,jf,Yv,Qv,e0,t0,n0,vM,oX,r0,iX,bM,wM,xM,a0,_M,sX,o0,i0,s0,jM,c0,l0,u0,d0,p0,f0,EM,SM,cX,h0,OM,CM,pu,m0,y0,g0,Ef,On,v0,Sf,b0,w0,fu,lX,hu,x0,Of,Be,Gs,mu,_0,Qn,Ie,Hn,Rn,j0,E0,NM,kM,S0,O0,Ye,MM,C0,N0,AM,PM,TM,Xs,ii,IM,Hr,k0,RM,DM,Js,qr,M0,A0,LM,Ia,$M,P0,T0,FM,BM,zM,I0,qn,yu,R0,gu,Ys,UM,w3e=Promise.all([(()=>{try{return v3e}catch{}})(),(()=>{try{return b3e}catch{}})()]).then(async()=>{class pX extends g.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function fX({children:e,isPresent:t}){const n=g.useId(),r=g.useRef(null),a=g.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=g.useContext(zk);return g.useInsertionEffect(()=>{const{width:i,height:s,top:c,left:l}=a.current;if(t||!r.current||!i||!s)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return o&&(u.nonce=o),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${c}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),h.jsx(pX,{isPresent:t,childRef:r,sizeRef:a,children:g.cloneElement(e,{ref:r})})}const hX=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:o,mode:i})=>{const s=Sv(mX),c=g.useId(),l=g.useCallback(d=>{s.set(d,!0);for(const p of s.values())if(!p)return;r&&r()},[s,r]),u=g.useMemo(()=>({id:c,initial:t,isPresent:n,custom:a,onExitComplete:l,register:d=>(s.set(d,!1),()=>s.delete(d))}),o?[Math.random(),l]:[n,l]);return g.useMemo(()=>{s.forEach((d,p)=>s.set(p,!1))},[n]),g.useEffect(()=>{!n&&!s.size&&r&&r()},[n]),i==="popLayout"&&(e=h.jsx(fX,{isPresent:n,children:e})),h.jsx(ODe.Provider,{value:u,children:e})};function mX(){return new Map}const Nf=e=>e.key||"";function qM(e){const t=[];return g.Children.forEach(e,n=>{g.isValidElement(n)&&t.push(n)}),t}const yX=({children:e,exitBeforeEnter:t,custom:n,initial:r=!0,onExitComplete:a,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const s=g.useMemo(()=>qM(e),[e]),c=s.map(Nf),l=g.useRef(!0),u=g.useRef(s),d=Sv(()=>new Map),[p,f]=g.useState(s),[m,y]=g.useState(s);Uk(()=>{l.current=!1,u.current=s;for(let w=0;w<m.length;w++){const _=Nf(m[w]);c.includes(_)?d.delete(_):d.get(_)!==!0&&d.set(_,!1)}},[m,c.length,c.join("-")]);const v=[];if(s!==p){let w=[...s];for(let _=0;_<m.length;_++){const x=m[_],j=Nf(x);c.includes(j)||(w.splice(_,0,x),v.push(x))}i==="wait"&&v.length&&(w=v),y(qM(w)),f(s);return}const{forceRender:b}=g.useContext(CDe);return h.jsx(h.Fragment,{children:m.map(w=>{const _=Nf(w),x=s===m||c.includes(_),j=()=>{if(d.has(_))d.set(_,!0);else return;let E=!0;d.forEach(S=>{S||(E=!1)}),E&&(b==null||b(),y(u.current),a&&a())};return h.jsx(hX,{isPresent:x,initial:!l.current||r?void 0:!1,custom:x?void 0:n,presenceAffectsLayout:o,mode:i,onExitComplete:x?void 0:j,children:w},_)})})};function D0(e){const t=Sv(()=>NDe(e)),{isStatic:n}=g.useContext(zk);if(n){const[,r]=g.useState(e);g.useEffect(()=>t.on("change",r),[])}return t}function KM(e,t){const n=D0(t()),r=()=>n.set(t());return r(),Uk(()=>{const a=()=>IG.preRender(r,!1,!0),o=e.map(i=>i.on("change",a));return()=>{o.forEach(i=>i()),kDe(r)}}),n}const gX=e=>e&&typeof e=="object"&&e.mix,vX=e=>gX(e)?e.mix:void 0;function bX(...e){const t=!Array.isArray(e[0]),n=t?0:-1,r=e[0+n],a=e[1+n],o=e[2+n],i=e[3+n],s=MDe(a,o,{mixer:vX(o[0]),...i});return t?s(r):s}function wX(e){Vk.current=[],e();const t=KM(Vk.current,e);return Vk.current=void 0,t}function ZM(e,t,n,r){if(typeof e=="function")return wX(e);const a=typeof t=="function"?t:bX(t,n,r);return Array.isArray(e)?GM(e,a):GM([e],([o])=>a(o))}function GM(e,t){const n=Sv(()=>[]);return KM(e,()=>{n.length=0;const r=e.length;for(let a=0;a<r;a++)n[a]=e[a].get();return t(n)})}function XM(e){return typeof e=="number"?e:parseFloat(e)}function xX(e,t={}){const{isStatic:n}=g.useContext(zk),r=g.useRef(null),a=D0(RG(e)?XM(e.get()):e),o=g.useRef(a.get()),i=g.useRef(()=>{}),s=()=>{const l=r.current;l&&l.time===0&&l.sample(ADe.delta),c(),r.current=PDe({keyframes:[a.get(),o.current],velocity:a.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:i.current})},c=()=>{r.current&&r.current.stop()};return g.useInsertionEffect(()=>a.attach((l,u)=>n?u(l):(o.current=l,i.current=u,IG.update(s),a.get()),c),[JSON.stringify(t)]),Uk(()=>{if(RG(e))return e.on("change",l=>a.set(XM(l)))},[a]),a}var et=(e=>(e.Started="started",e.Downloading="downloading",e.Downloaded="downloaded",e.Loading="loading",e.Loaded="loaded",e))(et||{}),vu=(e=>(e.LLM="LLM",e.embedding="embedding",e.VLM="VLM",e))(vu||{}),Ve=(e=>(e.WebLLM="WebLLM",e.OpenAI="OpenAI",e.Groq="Groq",e.GoogleGenerativeAI="GoogleGenerativeAI",e))(Ve||{}),Kr=(e=>(e.Started="started",e.Inprogress="inprogress",e.Success="success",e.Failed="failed",e))(Kr||{}),hr=(e=>(e.Human="human",e.User="user",e.AI="ai",e.System="system",e.Assistant="assistant",e.Tool="tool",e.FewShotExample="few_shot_example",e))(hr||{}),kf=(e=>(e.Started="started",e.Inprogress="inprogress",e.Done="done",e))(kf||{}),mr=(e=>(e.Chat="chat",e.FewShotExample="few_shot_example",e))(mr||{}),Xi=(e=>(e.VECTOR_DATABASE_RETREIVER="VECTOR_DATABASE_RETREIVER",e.DEFAULT_EMBEDDING_MODEL="DEFAULT_EMBEDDING_MODEL",e))(Xi||{});function JM(e,t,n,r,a){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=DG(t),i=DG(e),s=!1,c=i.length-1;c>=0;c--){var l=i[c],u=e[l];if(LG(t,l)&&!(t[l]===void 0&&u!==void 0&&Array.isArray(t)===!1)){var d=t[l];typeof u=="object"&&u!=null&&typeof d=="object"&&d!=null&&Array.isArray(u)===Array.isArray(d)?JM(u,d,n,r+"/"+Yl(l),a):u!==d&&(a&&n.push({op:"test",path:r+"/"+Yl(l),value:Ov(u)}),n.push({op:"replace",path:r+"/"+Yl(l),value:Ov(d)}))}else Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+Yl(l),value:Ov(u)}),n.push({op:"remove",path:r+"/"+Yl(l)}),s=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&o.length==i.length))for(var c=0;c<o.length;c++){var l=o[c];!LG(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+Yl(l),value:Ov(t[l])})}}}function _X(e,t,n=!1){var r=[];return JM(e,t,r,"",n),r}let YM,QM;YM=async(e,t)=>{let n="",r="",a;const o=[];await e;for await(const i of e)i&&(Array.isArray(i)?(o.push(...i.map(s=>s.content)),o!=null&&o.length&&(r=o.join(""),t==null||t({chunk:i,content:r}))):(n=typeof i=="object"&&"content"in i?`${i.content}`:`${i}`,t==null||t({chunk:i,content:n})),a=i);return{lastChunk:a,content:n}},QM=()=>{const e=lo(a=>a.toolsCallingStream),t=lo(a=>a.structuredStream),n=lo(a=>a.stream),r=lo(a=>a.getCurrentModelInfo);return{stream:g.useCallback(async(a,o)=>{var f;const{tools:i,schemas:s,onMessageUpdate:c,onMessageFinish:l}=o||{};let u;if(!await r())throw new Error("Model is not found");if(s!=null&&s.length?(s&&(s==null?void 0:s.length)>1&&ni("Multiple schemas are not supported. Only the first schema will be used."),u=t(((f=s==null?void 0:s[0])==null?void 0:f.schema_items)||[],a)):i!=null&&i.length?u=e(i,a):u=n(a),!u)throw new Error("Stream is not supported");const{lastChunk:d,content:p}=await YM(u,c);return l==null||l({content:p,lastChunk:d}),{lastChunk:d,content:p}},[r,n,t,e])}},Rv=globalThis||void 0||self;var bu={},eA;function jX(){if(eA)return bu;eA=1,Object.defineProperty(bu,"__esModule",{value:!0}),bu.parse=i,bu.serialize=l;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const p=function(){};return p.prototype=Object.create(null),p})();function i(p,f){const m=new o,y=p.length;if(y<2)return m;const v=(f==null?void 0:f.decode)||u;let b=0;do{const w=p.indexOf("=",b);if(w===-1)break;const _=p.indexOf(";",b),x=_===-1?y:_;if(w>x){b=p.lastIndexOf(";",w-1)+1;continue}const j=s(p,b,w),E=c(p,w,j),S=p.slice(j,E);if(m[S]===void 0){let O=s(p,w+1,x),N=c(p,x,O);const M=v(p.slice(O,N));m[S]=M}b=x+1}while(b<y);return m}function s(p,f,m){do{const y=p.charCodeAt(f);if(y!==32&&y!==9)return f}while(++f<m);return m}function c(p,f,m){for(;f>m;){const y=p.charCodeAt(--f);if(y!==32&&y!==9)return f+1}return m}function l(p,f,m){const y=(m==null?void 0:m.encode)||encodeURIComponent;if(!e.test(p))throw new TypeError(`argument name is invalid: ${p}`);const v=y(f);if(!t.test(v))throw new TypeError(`argument val is invalid: ${f}`);let b=p+"="+v;if(!m)return b;if(m.maxAge!==void 0){if(!Number.isInteger(m.maxAge))throw new TypeError(`option maxAge is invalid: ${m.maxAge}`);b+="; Max-Age="+m.maxAge}if(m.domain){if(!n.test(m.domain))throw new TypeError(`option domain is invalid: ${m.domain}`);b+="; Domain="+m.domain}if(m.path){if(!r.test(m.path))throw new TypeError(`option path is invalid: ${m.path}`);b+="; Path="+m.path}if(m.expires){if(!d(m.expires)||!Number.isFinite(m.expires.valueOf()))throw new TypeError(`option expires is invalid: ${m.expires}`);b+="; Expires="+m.expires.toUTCString()}if(m.httpOnly&&(b+="; HttpOnly"),m.secure&&(b+="; Secure"),m.partitioned&&(b+="; Partitioned"),m.priority)switch(typeof m.priority=="string"?m.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${m.priority}`)}if(m.sameSite)switch(typeof m.sameSite=="string"?m.sameSite.toLowerCase():m.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${m.sameSite}`)}return b}function u(p){if(p.indexOf("%")===-1)return p;try{return decodeURIComponent(p)}catch{return p}}function d(p){return a.call(p)==="[object Date]"}return bu}jX();var tA="popstate";function EX(e={}){function t(r,a){let{pathname:o,search:i,hash:s}=r.location;return Qs("",{pathname:o,search:i,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:ho(a)}return rA(t,n,null,e)}function SX(e={}){function t(a,o){let{pathname:i="/",search:s="",hash:c=""}=mo(a.location.hash.substring(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),Qs("",{pathname:i,search:s,hash:c},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(a,o){let i=a.document.querySelector("base"),s="";if(i&&i.getAttribute("href")){let c=a.location.href,l=c.indexOf("#");s=l===-1?c:c.slice(0,l)}return s+"#"+(typeof o=="string"?o:ho(o))}function r(a,o){un(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return rA(t,n,r,e)}function Qe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function un(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function OX(){return Math.random().toString(36).substring(2,10)}function nA(e,t){return{usr:e.state,key:e.key,idx:t}}function Qs(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?mo(t):t,state:n,key:t&&t.key||r||OX()}}function ho({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function mo(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function rA(e,t,n,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,i=a.history,s="POP",c=null,l=u();l==null&&(l=0,i.replaceState({...i.state,idx:l},""));function u(){return(i.state||{idx:null}).idx}function d(){s="POP";let v=u(),b=v==null?null:v-l;l=v,c&&c({action:s,location:y.location,delta:b})}function p(v,b){s="PUSH";let w=Qs(y.location,v,b);n&&n(w,v),l=u()+1;let _=nA(w,l),x=y.createHref(w);try{i.pushState(_,"",x)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(x)}o&&c&&c({action:s,location:y.location,delta:1})}function f(v,b){s="REPLACE";let w=Qs(y.location,v,b);n&&n(w,v),l=u();let _=nA(w,l),x=y.createHref(w);i.replaceState(_,"",x),o&&c&&c({action:s,location:y.location,delta:0})}function m(v){let b=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof v=="string"?v:ho(v);return w=w.replace(/ $/,"%20"),Qe(b,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,b)}let y={get action(){return s},get location(){return e(a,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(tA,d),c=v,()=>{a.removeEventListener(tA,d),c=null}},createHref(v){return t(a,v)},createURL:m,encodeLocation(v){let b=m(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:f,go(v){return i.go(v)}};return y}var CX=new Set(["lazy","caseSensitive","path","id","index","children"]);function NX(e){return e.index===!0}function Mf(e,t,n=[],r={}){return e.map((a,o)=>{let i=[...n,String(o)],s=typeof a.id=="string"?a.id:i.join("-");if(Qe(a.index!==!0||!a.children,"Cannot specify children on an index route"),Qe(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),NX(a)){let c={...a,...t(a),id:s};return r[s]=c,c}else{let c={...a,...t(a),id:s,children:void 0};return r[s]=c,a.children&&(c.children=Mf(a.children,t,i,r)),c}})}function si(e,t,n="/"){return Af(e,t,n,!1)}function Af(e,t,n,r){let a=typeof t=="string"?mo(t):t,o=Zr(a.pathname||"/",n);if(o==null)return null;let i=aA(e);MX(i);let s=null;for(let c=0;s==null&&c<i.length;++c){let l=zX(o);s=FX(i[c],l,r)}return s}function kX(e,t){let{route:n,pathname:r,params:a}=e;return{id:n.id,pathname:r,params:a,data:t[n.id],handle:n.handle}}function aA(e,t=[],n=[],r=""){let a=(o,i,s)=>{let c={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(Qe(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let l=Ra([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(Qe(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),aA(o.children,t,u,l)),!(o.path==null&&!o.index)&&t.push({path:l,score:LX(l,o.index),routesMeta:u})};return e.forEach((o,i)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))a(o,i);else for(let c of oA(o.path))a(o,i,c)}),t}function oA(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let i=oA(r.join("/")),s=[];return s.push(...i.map(c=>c===""?o:[o,c].join("/"))),a&&s.push(...i),s.map(c=>e.startsWith("/")&&c===""?"/":c)}function MX(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:$X(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var AX=/^:[\w-]+$/,PX=3,TX=2,IX=1,RX=10,DX=-2,iA=e=>e==="*";function LX(e,t){let n=e.split("/"),r=n.length;return n.some(iA)&&(r+=DX),t&&(r+=TX),n.filter(a=>!iA(a)).reduce((a,o)=>a+(AX.test(o)?PX:o===""?IX:RX),r)}function $X(e,t){return e.length===t.length&&e.slice(0,-1).every((n,r)=>n===t[r])?e[e.length-1]-t[t.length-1]:0}function FX(e,t,n=!1){let{routesMeta:r}=e,a={},o="/",i=[];for(let s=0;s<r.length;++s){let c=r[s],l=s===r.length-1,u=o==="/"?t:t.slice(o.length)||"/",d=Pf({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),p=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=Pf({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Ra([o,d.pathname]),pathnameBase:WX(Ra([o,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(o=Ra([o,d.pathnameBase]))}return i}function Pf(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=BX(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((c,{paramName:l,isOptional:u},d)=>{if(l==="*"){let f=s[d]||"";i=o.slice(0,o.length-f.length).replace(/(.)\/+$/,"$1")}const p=s[d];return u&&!p?c[l]=void 0:c[l]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:i,pattern:e}}function BX(e,t=!1,n=!0){un(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,i,s)=>(r.push({paramName:i,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function zX(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return un(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Zr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function UX(e,t="/"){let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?mo(e):e;return{pathname:n?n.startsWith("/")?n:VX(n,t):t,search:HX(r),hash:qX(a)}}function VX(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function L0(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function sA(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Tf(e){let t=sA(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function If(e,t,n,r=!1){let a;typeof e=="string"?a=mo(e):(a={...e},Qe(!a.pathname||!a.pathname.includes("?"),L0("?","pathname","search",a)),Qe(!a.pathname||!a.pathname.includes("#"),L0("#","pathname","hash",a)),Qe(!a.search||!a.search.includes("#"),L0("#","search","hash",a)));let o=e===""||a.pathname==="",i=o?"/":a.pathname,s;if(i==null)s=n;else{let d=t.length-1;if(!r&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),d-=1;a.pathname=p.join("/")}s=d>=0?t[d]:"/"}let c=UX(a,s),l=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}var Ra=e=>e.join("/").replace(/\/\/+/g,"/"),WX=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),HX=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,qX=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Rf=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function Df(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var cA=["POST","PUT","PATCH","DELETE"],KX=new Set(cA),ZX=["GET",...cA],GX=new Set(ZX),XX=new Set([301,302,303,307,308]),JX=new Set([307,308]),$0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},YX={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},wu={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},F0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,QX=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),lA="remix-router-transitions",uA=Symbol("ResetLoaderData");function dA(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";Qe(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.mapRouteProperties||QX,a={},o=Mf(e.routes,r,void 0,a),i,s=e.basename||"/",c=e.dataStrategy||aJ,l=e.patchRoutesOnNavigation,u={...e.future},d=null,p=new Set,f=null,m=null,y=null,v=e.hydrationData!=null,b=si(o,e.history.location,s),w=null;if(b==null&&!l){let H=Nr(404,{pathname:e.history.location.pathname}),{matches:Y,route:oe}=jA(o);b=Y,w={[oe.id]:H}}b&&!e.hydrationData&&Oe(b,o,e.history.location.pathname).active&&(b=null);let _;if(b)if(b.some(H=>H.route.lazy))_=!1;else if(!b.some(H=>H.route.loader))_=!0;else{let H=e.hydrationData?e.hydrationData.loaderData:null,Y=e.hydrationData?e.hydrationData.errors:null;if(Y){let oe=b.findIndex(fe=>Y[fe.route.id]!==void 0);_=b.slice(0,oe+1).every(fe=>!z0(fe.route,H,Y))}else _=b.every(oe=>!z0(oe.route,H,Y))}else{_=!1,b=[];let H=Oe(null,o,e.history.location.pathname);H.active&&H.matches&&(b=H.matches)}let x,j={historyAction:e.history.action,location:e.history.location,matches:b,initialized:_,navigation:$0,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||w,fetchers:new Map,blockers:new Map},E="POP",S=!1,O,N=!1,M=new Map,k=null,A=!1,P=!1,C=new Set,T=new Map,I=0,R=-1,L=new Map,D=new Set,z=new Map,U=new Map,$=new Set,V=new Map,F,W=null;function re(){if(d=e.history.listen(({action:H,location:Y,delta:oe})=>{if(F){F(),F=void 0;return}un(V.size===0||oe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let fe=Xt({currentLocation:j.location,nextLocation:Y,historyAction:H});if(fe&&oe!=null){let Ne=new Promise(De=>{F=De});e.history.go(oe*-1),Te(fe,{state:"blocked",location:Y,proceed(){Te(fe,{state:"proceeding",proceed:void 0,reset:void 0,location:Y}),Ne.then(()=>e.history.go(oe))},reset(){let De=new Map(j.blockers);De.set(fe,wu),K({blockers:De})}});return}return ue(H,Y)}),n){mJ(t,M);let H=()=>yJ(t,M);t.addEventListener("pagehide",H),k=()=>t.removeEventListener("pagehide",H)}return j.initialized||ue("POP",j.location,{initialHydration:!0}),x}function ee(){d&&d(),k&&k(),p.clear(),O&&O.abort(),j.fetchers.forEach((H,Y)=>cr(Y)),j.blockers.forEach((H,Y)=>me(Y))}function G(H){return p.add(H),()=>p.delete(H)}function K(H,Y={}){j={...j,...H};let oe=[],fe=[];j.fetchers.forEach((Ne,De)=>{Ne.state==="idle"&&($.has(De)?oe.push(De):fe.push(De))}),[...p].forEach(Ne=>Ne(j,{deletedFetchers:oe,viewTransitionOpts:Y.viewTransitionOpts,flushSync:Y.flushSync===!0})),oe.forEach(Ne=>cr(Ne)),fe.forEach(Ne=>j.fetchers.delete(Ne))}function X(H,Y,{flushSync:oe}={}){var we,Ue;let fe=j.actionData!=null&&j.navigation.formMethod!=null&&Gr(j.navigation.formMethod)&&j.navigation.state==="loading"&&((we=H.state)==null?void 0:we._isRedirect)!==!0,Ne;Y.actionData?Object.keys(Y.actionData).length>0?Ne=Y.actionData:Ne=null:fe?Ne=j.actionData:Ne=null;let De=Y.loaderData?xA(j.loaderData,Y.loaderData,Y.matches||[],Y.errors):j.loaderData,ze=j.blockers;ze.size>0&&(ze=new Map(ze),ze.forEach((nt,Dt)=>ze.set(Dt,wu)));let ke=S===!0||j.navigation.formMethod!=null&&Gr(j.navigation.formMethod)&&((Ue=H.state)==null?void 0:Ue._isRedirect)!==!0;i&&(o=i,i=void 0),A||E==="POP"||(E==="PUSH"?e.history.push(H,H.state):E==="REPLACE"&&e.history.replace(H,H.state));let Ae;if(E==="POP"){let nt=M.get(j.location.pathname);nt&&nt.has(H.pathname)?Ae={currentLocation:j.location,nextLocation:H}:M.has(H.pathname)&&(Ae={currentLocation:H,nextLocation:j.location})}else if(N){let nt=M.get(j.location.pathname);nt?nt.add(H.pathname):(nt=new Set([H.pathname]),M.set(j.location.pathname,nt)),Ae={currentLocation:j.location,nextLocation:H}}K({...Y,actionData:Ne,loaderData:De,historyAction:E,location:H,initialized:!0,navigation:$0,revalidation:"idle",restoreScrollPosition:Se(H,Y.matches||j.matches),preventScrollReset:ke,blockers:ze},{viewTransitionOpts:Ae,flushSync:oe===!0}),E="POP",S=!1,N=!1,A=!1,P=!1,W==null||W.resolve(),W=null}async function ne(H,Y){if(typeof H=="number"){e.history.go(H);return}let oe=B0(j.location,j.matches,s,H,Y==null?void 0:Y.fromRouteId,Y==null?void 0:Y.relative),{path:fe,submission:Ne,error:De}=pA(!1,oe,Y),ze=j.location,ke=Qs(j.location,fe,Y&&Y.state);ke={...ke,...e.history.encodeLocation(ke)};let Ae=Y&&Y.replace!=null?Y.replace:void 0,we="PUSH";Ae===!0?we="REPLACE":Ae===!1||Ne!=null&&Gr(Ne.formMethod)&&Ne.formAction===j.location.pathname+j.location.search&&(we="REPLACE");let Ue=Y&&"preventScrollReset"in Y?Y.preventScrollReset===!0:void 0,nt=(Y&&Y.flushSync)===!0,Dt=Xt({currentLocation:ze,nextLocation:ke,historyAction:we});if(Dt){Te(Dt,{state:"blocked",location:ke,proceed(){Te(Dt,{state:"proceeding",proceed:void 0,reset:void 0,location:ke}),ne(H,Y)},reset(){let zt=new Map(j.blockers);zt.set(Dt,wu),K({blockers:zt})}});return}await ue(we,ke,{submission:Ne,pendingError:De,preventScrollReset:Ue,replace:Y&&Y.replace,enableViewTransition:Y&&Y.viewTransition,flushSync:nt})}function B(){W||(W=gJ()),lt(),K({revalidation:"loading"});let H=W.promise;return j.navigation.state==="submitting"?H:j.navigation.state==="idle"?(ue(j.historyAction,j.location,{startUninterruptedRevalidation:!0}),H):(ue(E||j.historyAction,j.navigation.location,{overrideNavigation:j.navigation,enableViewTransition:N===!0}),H)}async function ue(H,Y,oe){O&&O.abort(),O=null,E=H,A=(oe&&oe.startUninterruptedRevalidation)===!0,_e(j.location,j.matches),S=(oe&&oe.preventScrollReset)===!0,N=(oe&&oe.enableViewTransition)===!0;let fe=i||o,Ne=oe&&oe.overrideNavigation,De=si(fe,Y,s),ze=(oe&&oe.flushSync)===!0,ke=Oe(De,fe,Y.pathname);if(ke.active&&ke.matches&&(De=ke.matches),!De){let{error:st,notFoundMatches:ur,route:en}=Bt(Y.pathname);X(Y,{matches:ur,loaderData:{},errors:{[en.id]:st}},{flushSync:ze});return}if(j.initialized&&!P&&uJ(j.location,Y)&&!(oe&&oe.submission&&Gr(oe.submission.formMethod))){X(Y,{matches:De},{flushSync:ze});return}O=new AbortController;let Ae=ec(e.history,Y,O.signal,oe&&oe.submission),we;if(oe&&oe.pendingError)we=[Ji(De).route.id,{type:"error",error:oe.pendingError}];else if(oe&&oe.submission&&Gr(oe.submission.formMethod)){let st=await ae(Ae,Y,oe.submission,De,ke.active,{replace:oe.replace,flushSync:ze});if(st.shortCircuited)return;if(st.pendingActionResult){let[ur,en]=st.pendingActionResult;if(yr(en)&&Df(en.error)&&en.error.status===404){O=null,X(Y,{matches:st.matches,loaderData:{},errors:{[ur]:en.error}});return}}De=st.matches||De,we=st.pendingActionResult,Ne=W0(Y,oe.submission),ze=!1,ke.active=!1,Ae=ec(e.history,Ae.url,Ae.signal)}let{shortCircuited:Ue,matches:nt,loaderData:Dt,errors:zt}=await de(Ae,Y,De,ke.active,Ne,oe&&oe.submission,oe&&oe.fetcherSubmission,oe&&oe.replace,oe&&oe.initialHydration===!0,ze,we);Ue||(O=null,X(Y,{matches:nt||De,..._A(we),loaderData:Dt,errors:zt}))}async function ae(H,Y,oe,fe,Ne,De={}){lt();let ze=fJ(Y,oe);if(K({navigation:ze},{flushSync:De.flushSync===!0}),Ne){let we=await He(fe,Y.pathname,H.signal);if(we.type==="aborted")return{shortCircuited:!0};if(we.type==="error"){let Ue=Ji(we.partialMatches).route.id;return{matches:we.partialMatches,pendingActionResult:[Ue,{type:"error",error:we.error}]}}else if(we.matches)fe=we.matches;else{let{notFoundMatches:Ue,error:nt,route:Dt}=Bt(Y.pathname);return{matches:Ue,pendingActionResult:[Dt.id,{type:"error",error:nt}]}}}let ke,Ae=xu(fe,Y);if(!Ae.route.action&&!Ae.route.lazy)ke={type:"error",error:Nr(405,{method:H.method,pathname:Y.pathname,routeId:Ae.route.id})};else if(ke=(await Ke("action",j,H,[Ae],fe,null))[Ae.route.id],H.signal.aborted)return{shortCircuited:!0};if(Yi(ke)){let we;return De&&De.replace!=null?we=De.replace:we=vA(ke.response.headers.get("Location"),new URL(H.url),s)===j.location.pathname+j.location.search,await qe(H,ke,!0,{submission:oe,replace:we}),{shortCircuited:!0}}if(yr(ke)){let we=Ji(fe,Ae.route.id);return(De&&De.replace)!==!0&&(E="PUSH"),{matches:fe,pendingActionResult:[we.route.id,ke]}}return{matches:fe,pendingActionResult:[Ae.route.id,ke]}}async function de(H,Y,oe,fe,Ne,De,ze,ke,Ae,we,Ue){let nt=Ne||W0(Y,De),Dt=De||ze||CA(nt),zt=!A&&!Ae;if(fe){if(zt){let dr=je(Ue);K({navigation:nt,...dr!==void 0?{actionData:dr}:{}},{flushSync:we})}let ht=await He(oe,Y.pathname,H.signal);if(ht.type==="aborted")return{shortCircuited:!0};if(ht.type==="error"){let dr=Ji(ht.partialMatches).route.id;return{matches:ht.partialMatches,loaderData:{},errors:{[dr]:ht.error}}}else if(ht.matches)oe=ht.matches;else{let{error:dr,notFoundMatches:Ws,route:Ht}=Bt(Y.pathname);return{matches:Ws,loaderData:{},errors:{[Ht.id]:dr}}}}let st=i||o,[ur,en]=hA(e.history,j,oe,Dt,Y,Ae===!0,P,C,$,z,D,st,s,Ue);if(R=++I,ur.length===0&&en.length===0){let ht=J();return X(Y,{matches:oe,loaderData:{},errors:Ue&&yr(Ue[1])?{[Ue[0]]:Ue[1].error}:null,..._A(Ue),...ht?{fetchers:new Map(j.fetchers)}:{}},{flushSync:we}),{shortCircuited:!0}}if(zt){let ht={};if(!fe){ht.navigation=nt;let dr=je(Ue);dr!==void 0&&(ht.actionData=dr)}en.length>0&&(ht.fetchers=Le(en)),K(ht,{flushSync:we})}en.forEach(ht=>{lr(ht.key),ht.controller&&T.set(ht.key,ht.controller)});let Vs=()=>en.forEach(ht=>lr(ht.key));O&&O.signal.addEventListener("abort",Vs);let{loaderResults:Aa,fetcherResults:Vi}=await It(j,oe,ur,en,H);if(H.signal.aborted)return{shortCircuited:!0};O&&O.signal.removeEventListener("abort",Vs),en.forEach(ht=>T.delete(ht.key));let co=Lf(Aa);if(co)return await qe(H,co.result,!0,{replace:ke}),{shortCircuited:!0};if(co=Lf(Vi),co)return D.add(co.key),await qe(H,co.result,!0,{replace:ke}),{shortCircuited:!0};let{loaderData:hf,errors:zr}=wA(j,oe,Aa,Ue,en,Vi);Ae&&j.errors&&(zr={...j.errors,...zr});let Gl=J(),Xl=te(R),Jl=Gl||Xl||en.length>0;return{matches:oe,loaderData:hf,errors:zr,...Jl?{fetchers:new Map(j.fetchers)}:{}}}function je(H){if(H&&!yr(H[1]))return{[H[0]]:H[1].data};if(j.actionData)return Object.keys(j.actionData).length===0?null:j.actionData}function Le(H){return H.forEach(Y=>{let oe=j.fetchers.get(Y.key),fe=_u(void 0,oe?oe.data:void 0);j.fetchers.set(Y.key,fe)}),new Map(j.fetchers)}async function $e(H,Y,oe,fe){lr(H);let Ne=(fe&&fe.flushSync)===!0,De=i||o,ze=B0(j.location,j.matches,s,oe,Y,fe==null?void 0:fe.relative),ke=si(De,ze,s),Ae=Oe(ke,De,ze);if(Ae.active&&Ae.matches&&(ke=Ae.matches),!ke){_t(H,Y,Nr(404,{pathname:ze}),{flushSync:Ne});return}let{path:we,submission:Ue,error:nt}=pA(!0,ze,fe);if(nt){_t(H,Y,nt,{flushSync:Ne});return}let Dt=xu(ke,we),zt=(fe&&fe.preventScrollReset)===!0;if(Ue&&Gr(Ue.formMethod)){await Ee(H,Y,we,Dt,ke,Ae.active,Ne,zt,Ue);return}z.set(H,{routeId:Y,path:we}),await We(H,Y,we,Dt,ke,Ae.active,Ne,zt,Ue)}async function Ee(H,Y,oe,fe,Ne,De,ze,ke,Ae){lt(),z.delete(H);function we(Ht){if(!Ht.route.action&&!Ht.route.lazy){let ti=Nr(405,{method:Ae.formMethod,pathname:oe,routeId:Y});return _t(H,Y,ti,{flushSync:ze}),!0}return!1}if(!De&&we(fe))return;let Ue=j.fetchers.get(H);it(H,hJ(Ae,Ue),{flushSync:ze});let nt=new AbortController,Dt=ec(e.history,oe,nt.signal,Ae);if(De){let Ht=await He(Ne,oe,Dt.signal);if(Ht.type==="aborted")return;if(Ht.type==="error"){_t(H,Y,Ht.error,{flushSync:ze});return}else if(Ht.matches){if(Ne=Ht.matches,fe=xu(Ne,oe),we(fe))return}else{_t(H,Y,Nr(404,{pathname:oe}),{flushSync:ze});return}}T.set(H,nt);let zt=I,st=(await Ke("action",j,Dt,[fe],Ne,H))[fe.route.id];if(Dt.signal.aborted){T.get(H)===nt&&T.delete(H);return}if($.has(H)){if(Yi(st)||yr(st)){it(H,ci(void 0));return}}else{if(Yi(st))if(T.delete(H),R>zt){it(H,ci(void 0));return}else return D.add(H),it(H,_u(Ae)),qe(Dt,st,!1,{fetcherSubmission:Ae,preventScrollReset:ke});if(yr(st)){_t(H,Y,st.error);return}}let ur=j.navigation.location||j.location,en=ec(e.history,ur,nt.signal),Vs=i||o,Aa=j.navigation.state!=="idle"?si(Vs,j.navigation.location,s):j.matches;Qe(Aa,"Didn't find any matches after fetcher action");let Vi=++I;L.set(H,Vi);let co=_u(Ae,st.data);j.fetchers.set(H,co);let[hf,zr]=hA(e.history,j,Aa,Ae,ur,!1,P,C,$,z,D,Vs,s,[fe.route.id,st]);zr.filter(Ht=>Ht.key!==H).forEach(Ht=>{let ti=Ht.key,Ev=j.fetchers.get(ti),Fk=_u(void 0,Ev?Ev.data:void 0);j.fetchers.set(ti,Fk),lr(ti),Ht.controller&&T.set(ti,Ht.controller)}),K({fetchers:new Map(j.fetchers)});let Gl=()=>zr.forEach(Ht=>lr(Ht.key));nt.signal.addEventListener("abort",Gl);let{loaderResults:Xl,fetcherResults:Jl}=await It(j,Aa,hf,zr,en);if(nt.signal.aborted)return;nt.signal.removeEventListener("abort",Gl),L.delete(H),T.delete(H),zr.forEach(Ht=>T.delete(Ht.key));let ht=Lf(Xl);if(ht)return qe(en,ht.result,!1,{preventScrollReset:ke});if(ht=Lf(Jl),ht)return D.add(ht.key),qe(en,ht.result,!1,{preventScrollReset:ke});let{loaderData:dr,errors:Ws}=wA(j,Aa,Xl,void 0,zr,Jl);if(j.fetchers.has(H)){let Ht=ci(st.data);j.fetchers.set(H,Ht)}te(Vi),j.navigation.state==="loading"&&Vi>R?(Qe(E,"Expected pending action"),O&&O.abort(),X(j.navigation.location,{matches:Aa,loaderData:dr,errors:Ws,fetchers:new Map(j.fetchers)})):(K({errors:Ws,loaderData:xA(j.loaderData,dr,Aa,Ws),fetchers:new Map(j.fetchers)}),P=!1)}async function We(H,Y,oe,fe,Ne,De,ze,ke,Ae){let we=j.fetchers.get(H);it(H,_u(Ae,we?we.data:void 0),{flushSync:ze});let Ue=new AbortController,nt=ec(e.history,oe,Ue.signal);if(De){let st=await He(Ne,oe,nt.signal);if(st.type==="aborted")return;if(st.type==="error"){_t(H,Y,st.error,{flushSync:ze});return}else if(st.matches)Ne=st.matches,fe=xu(Ne,oe);else{_t(H,Y,Nr(404,{pathname:oe}),{flushSync:ze});return}}T.set(H,Ue);let Dt=I,zt=(await Ke("loader",j,nt,[fe],Ne,H))[fe.route.id];if(T.get(H)===Ue&&T.delete(H),!nt.signal.aborted){if($.has(H)){it(H,ci(void 0));return}if(Yi(zt))if(R>Dt){it(H,ci(void 0));return}else{D.add(H),await qe(nt,zt,!1,{preventScrollReset:ke});return}if(yr(zt)){_t(H,Y,zt.error);return}it(H,ci(zt.data))}}async function qe(H,Y,oe,{submission:fe,fetcherSubmission:Ne,preventScrollReset:De,replace:ze}={}){Y.response.headers.has("X-Remix-Revalidate")&&(P=!0);let ke=Y.response.headers.get("Location");Qe(ke,"Expected a Location header on the redirect Response"),ke=vA(ke,new URL(H.url),s);let Ae=Qs(j.location,ke,{_isRedirect:!0});if(n){let st=!1;if(Y.response.headers.has("X-Remix-Reload-Document"))st=!0;else if(F0.test(ke)){const ur=e.history.createURL(ke);st=ur.origin!==t.location.origin||Zr(ur.pathname,s)==null}if(st){ze?t.location.replace(ke):t.location.assign(ke);return}}O=null;let we=ze===!0||Y.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:Ue,formAction:nt,formEncType:Dt}=j.navigation;!fe&&!Ne&&Ue&&nt&&Dt&&(fe=CA(j.navigation));let zt=fe||Ne;if(JX.has(Y.response.status)&&zt&&Gr(zt.formMethod))await ue(we,Ae,{submission:{...zt,formAction:ke},preventScrollReset:De||S,enableViewTransition:oe?N:void 0});else{let st=W0(Ae,fe);await ue(we,Ae,{overrideNavigation:st,fetcherSubmission:Ne,preventScrollReset:De||S,enableViewTransition:oe?N:void 0})}}async function Ke(H,Y,oe,fe,Ne,De){let ze,ke={};try{ze=await oJ(c,H,Y,oe,fe,Ne,De,a,r)}catch(Ae){return fe.forEach(we=>{ke[we.route.id]={type:"error",error:Ae}}),ke}for(let[Ae,we]of Object.entries(ze))if(dJ(we)){let Ue=we.result;ke[Ae]={type:"redirect",response:cJ(Ue,oe,Ae,Ne,s)}}else ke[Ae]=await sJ(we);return ke}async function It(H,Y,oe,fe,Ne){let De=Ke("loader",H,Ne,oe,Y,null),ze=Promise.all(fe.map(async we=>{if(we.matches&&we.match&&we.controller){let Ue=(await Ke("loader",H,ec(e.history,we.path,we.controller.signal),[we.match],we.matches,we.key))[we.match.route.id];return{[we.key]:Ue}}else return Promise.resolve({[we.key]:{type:"error",error:Nr(404,{pathname:we.path})}})})),ke=await De,Ae=(await ze).reduce((we,Ue)=>Object.assign(we,Ue),{});return{loaderResults:ke,fetcherResults:Ae}}function lt(){P=!0,z.forEach((H,Y)=>{T.has(Y)&&C.add(Y),lr(Y)})}function it(H,Y,oe={}){j.fetchers.set(H,Y),K({fetchers:new Map(j.fetchers)},{flushSync:(oe&&oe.flushSync)===!0})}function _t(H,Y,oe,fe={}){let Ne=Ji(j.matches,Y);cr(H),K({errors:{[Ne.route.id]:oe},fetchers:new Map(j.fetchers)},{flushSync:(fe&&fe.flushSync)===!0})}function Qt(H){return U.set(H,(U.get(H)||0)+1),$.has(H)&&$.delete(H),j.fetchers.get(H)||YX}function cr(H){let Y=j.fetchers.get(H);T.has(H)&&!(Y&&Y.state==="loading"&&L.has(H))&&lr(H),z.delete(H),L.delete(H),D.delete(H),$.delete(H),C.delete(H),j.fetchers.delete(H)}function io(H){let Y=(U.get(H)||0)-1;Y<=0?(U.delete(H),$.add(H)):U.set(H,Y),K({fetchers:new Map(j.fetchers)})}function lr(H){let Y=T.get(H);Y&&(Y.abort(),T.delete(H))}function so(H){for(let Y of H){let oe=Qt(Y),fe=ci(oe.data);j.fetchers.set(Y,fe)}}function J(){let H=[],Y=!1;for(let oe of D){let fe=j.fetchers.get(oe);Qe(fe,`Expected fetcher: ${oe}`),fe.state==="loading"&&(D.delete(oe),H.push(oe),Y=!0)}return so(H),Y}function te(H){let Y=[];for(let[oe,fe]of L)if(fe<H){let Ne=j.fetchers.get(oe);Qe(Ne,`Expected fetcher: ${oe}`),Ne.state==="loading"&&(lr(oe),L.delete(oe),Y.push(oe))}return so(Y),Y.length>0}function ce(H,Y){let oe=j.blockers.get(H)||wu;return V.get(H)!==Y&&V.set(H,Y),oe}function me(H){j.blockers.delete(H),V.delete(H)}function Te(H,Y){let oe=j.blockers.get(H)||wu;Qe(oe.state==="unblocked"&&Y.state==="blocked"||oe.state==="blocked"&&Y.state==="blocked"||oe.state==="blocked"&&Y.state==="proceeding"||oe.state==="blocked"&&Y.state==="unblocked"||oe.state==="proceeding"&&Y.state==="unblocked",`Invalid blocker state transition: ${oe.state} -> ${Y.state}`);let fe=new Map(j.blockers);fe.set(H,Y),K({blockers:fe})}function Xt({currentLocation:H,nextLocation:Y,historyAction:oe}){if(V.size===0)return;V.size>1&&un(!1,"A router only supports one blocker at a time");let fe=Array.from(V.entries()),[Ne,De]=fe[fe.length-1],ze=j.blockers.get(Ne);if(!(ze&&ze.state==="proceeding")&&De({currentLocation:H,nextLocation:Y,historyAction:oe}))return Ne}function Bt(H){let Y=Nr(404,{pathname:H}),oe=i||o,{matches:fe,route:Ne}=jA(oe);return{notFoundMatches:fe,route:Ne,error:Y}}function Ge(H,Y,oe){if(f=H,y=Y,m=oe||null,!v&&j.navigation===$0){v=!0;let fe=Se(j.location,j.matches);fe!=null&&K({restoreScrollPosition:fe})}return()=>{f=null,y=null,m=null}}function be(H,Y){return m&&m(H,Y.map(oe=>kX(oe,j.loaderData)))||H.key}function _e(H,Y){if(f&&y){let oe=be(H,Y);f[oe]=y()}}function Se(H,Y){if(f){let oe=be(H,Y),fe=f[oe];if(typeof fe=="number")return fe}return null}function Oe(H,Y,oe){if(l)if(H){if(Object.keys(H[0].params).length>0)return{active:!0,matches:Af(Y,oe,s,!0)}}else return{active:!0,matches:Af(Y,oe,s,!0)||[]};return{active:!1,matches:null}}async function He(H,Y,oe){if(!l)return{type:"success",matches:H};let fe=H;for(;;){let Ne=i==null,De=i||o,ze=a;try{await l({path:Y,matches:fe,patch:(we,Ue)=>{oe.aborted||yA(we,Ue,De,ze,r)}})}catch(we){return{type:"error",error:we,partialMatches:fe}}finally{Ne&&!oe.aborted&&(o=[...o])}if(oe.aborted)return{type:"aborted"};let ke=si(De,Y,s);if(ke)return{type:"success",matches:ke};let Ae=Af(De,Y,s,!0);if(!Ae||fe.length===Ae.length&&fe.every((we,Ue)=>we.route.id===Ae[Ue].route.id))return{type:"success",matches:null};fe=Ae}}function kt(H){a={},i=Mf(H,r,void 0,a)}function Wt(H,Y){let oe=i==null;yA(H,Y,i||o,a,r),oe&&(o=[...o],K({}))}return x={get basename(){return s},get future(){return u},get state(){return j},get routes(){return o},get window(){return t},initialize:re,subscribe:G,enableScrollRestoration:Ge,navigate:ne,fetch:$e,revalidate:B,createHref:H=>e.history.createHref(H),encodeLocation:H=>e.history.encodeLocation(H),getFetcher:Qt,deleteFetcher:io,dispose:ee,getBlocker:ce,deleteBlocker:me,patchRoutes:Wt,_internalFetchControllers:T,_internalSetRoutes:kt},x}function eJ(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function B0(e,t,n,r,a,o){let i,s;if(a){i=[];for(let l of t)if(i.push(l),l.route.id===a){s=l;break}}else i=t,s=t[t.length-1];let c=If(r||".",Tf(i),Zr(e.pathname,n)||e.pathname,o==="path");if(r==null&&(c.search=e.search,c.hash=e.hash),(r==null||r===""||r===".")&&s){let l=V0(c.search);if(s.route.index&&!l)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&l){let u=new URLSearchParams(c.search),d=u.getAll("index");u.delete("index"),d.filter(f=>f).forEach(f=>u.append("index",f));let p=u.toString();c.search=p?`?${p}`:""}}return n!=="/"&&(c.pathname=c.pathname==="/"?n:Ra([n,c.pathname])),ho(c)}function pA(e,t,n){if(!n||!eJ(n))return{path:t};if(n.formMethod&&!pJ(n.formMethod))return{path:t,error:Nr(405,{method:n.formMethod})};let r=()=>({path:t,error:Nr(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),o=EA(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Gr(a))return r();let u=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((d,[p,f])=>`${d}${p}=${f}
`,""):String(n.body);return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:u}}}else if(n.formEncType==="application/json"){if(!Gr(a))return r();try{let u=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:u,text:void 0}}}catch{return r()}}}Qe(typeof FormData=="function","FormData is not available in this environment");let i,s;if(n.formData)i=U0(n.formData),s=n.formData;else if(n.body instanceof FormData)i=U0(n.body),s=n.body;else if(n.body instanceof URLSearchParams)i=n.body,s=bA(i);else if(n.body==null)i=new URLSearchParams,s=new FormData;else try{i=new URLSearchParams(n.body),s=bA(i)}catch{return r()}let c={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:s,json:void 0,text:void 0};if(Gr(c.formMethod))return{path:t,submission:c};let l=mo(t);return e&&l.search&&V0(l.search)&&i.append("index",""),l.search=`?${i}`,{path:ho(l),submission:c}}function fA(e,t,n=!1){let r=e.findIndex(a=>a.route.id===t);return r>=0?e.slice(0,n?r+1:r):e}function hA(e,t,n,r,a,o,i,s,c,l,u,d,p,f){let m=f?yr(f[1])?f[1].error:f[1].data:void 0,y=e.createURL(t.location),v=e.createURL(a),b=n;o&&t.errors?b=fA(n,Object.keys(t.errors)[0],!0):f&&yr(f[1])&&(b=fA(n,f[0]));let w=f?f[1].statusCode:void 0,_=w&&w>=400,x=b.filter((E,S)=>{let{route:O}=E;if(O.lazy)return!0;if(O.loader==null)return!1;if(o)return z0(O,t.loaderData,t.errors);if(tJ(t.loaderData,t.matches[S],E))return!0;let N=t.matches[S],M=E;return mA(E,{currentUrl:y,currentParams:N.params,nextUrl:v,nextParams:M.params,...r,actionResult:m,actionStatus:w,defaultShouldRevalidate:_?!1:i||y.pathname+y.search===v.pathname+v.search||y.search!==v.search||nJ(N,M)})}),j=[];return l.forEach((E,S)=>{if(o||!n.some(A=>A.route.id===E.routeId)||c.has(S))return;let O=si(d,E.path,p);if(!O){j.push({key:S,routeId:E.routeId,path:E.path,matches:null,match:null,controller:null});return}let N=t.fetchers.get(S),M=xu(O,E.path),k=!1;u.has(S)?k=!1:s.has(S)?(s.delete(S),k=!0):N&&N.state!=="idle"&&N.data===void 0?k=i:k=mA(M,{currentUrl:y,currentParams:t.matches[t.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params,...r,actionResult:m,actionStatus:w,defaultShouldRevalidate:_?!1:i}),k&&j.push({key:S,routeId:E.routeId,path:E.path,matches:O,match:M,controller:new AbortController})}),[x,j]}function z0(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&t[e.id]!==void 0,a=n!=null&&n[e.id]!==void 0;return!r&&a?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!a}function tJ(e,t,n){let r=!t||n.route.id!==t.route.id,a=!e.hasOwnProperty(n.route.id);return r||a}function nJ(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function mA(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function yA(e,t,n,r,a){let o;if(e){let c=r[e];Qe(c,`No route found to patch children into: routeId = ${e}`),c.children||(c.children=[]),o=c.children}else o=n;let i=t.filter(c=>!o.some(l=>gA(c,l))),s=Mf(i,a,[e||"_","patch",String((o==null?void 0:o.length)||"0")],r);o.push(...s)}function gA(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var a;return(a=t.children)==null?void 0:a.some(o=>gA(n,o))}):!1}async function rJ(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let a=n[e.id];Qe(a,"No route found in manifest");let o={};for(let i in r){let s=a[i]!==void 0&&i!=="hasErrorBoundary";un(!s,`Route "${a.id}" has a static property "${i}" defined but its lazy function is also returning a value for this property. The lazy route property "${i}" will be ignored.`),!s&&!CX.has(i)&&(o[i]=r[i])}Object.assign(a,o),Object.assign(a,{...t(a),lazy:void 0})}async function aJ({matches:e}){let t=e.filter(n=>n.shouldLoad);return(await Promise.all(t.map(n=>n.resolve()))).reduce((n,r,a)=>Object.assign(n,{[t[a].route.id]:r}),{})}async function oJ(e,t,n,r,a,o,i,s,c,l){let u=o.map(f=>f.route.lazy?rJ(f.route,c,s):void 0),d=o.map((f,m)=>{let y=u[m],v=a.some(b=>b.route.id===f.route.id);return{...f,shouldLoad:v,resolve:async b=>(b&&r.method==="GET"&&(f.route.lazy||f.route.loader)&&(v=!0),v?iJ(t,r,f,y,b,l):Promise.resolve({type:"data",result:void 0}))}}),p=await e({matches:d,request:r,params:o[0].params,fetcherKey:i,context:l});try{await Promise.all(u)}catch{}return p}async function iJ(e,t,n,r,a,o){let i,s,c=l=>{let u,d=new Promise((m,y)=>u=y);s=()=>u(),t.signal.addEventListener("abort",s);let p=m=>typeof l!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${e}" [routeId: ${n.route.id}]`)):l({request:t,params:n.params,context:o},...m!==void 0?[m]:[]),f=(async()=>{try{return{type:"data",result:await(a?a(m=>p(m)):p())}}catch(m){return{type:"error",result:m}}})();return Promise.race([f,d])};try{let l=n.route[e];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(p=>{u=p}),r]);if(u!==void 0)throw u;i=d}else if(await r,l=n.route[e],l)i=await c(l);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw Nr(405,{method:t.method,pathname:d,routeId:n.route.id})}else return{type:"data",result:void 0};else if(l)i=await c(l);else{let u=new URL(t.url),d=u.pathname+u.search;throw Nr(404,{pathname:d})}}catch(l){return{type:"error",result:l}}finally{s&&t.signal.removeEventListener("abort",s)}return i}async function sJ(e){var r,a,o,i;let{result:t,type:n}=e;if(OA(t)){let s;try{let c=t.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?t.body==null?s=null:s=await t.json():s=await t.text()}catch(c){return{type:"error",error:c}}return n==="error"?{type:"error",error:new Rf(t.status,t.statusText,s),statusCode:t.status,headers:t.headers}:{type:"data",data:s,statusCode:t.status,headers:t.headers}}if(n==="error"){if(SA(t)){if(t.data instanceof Error)return{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status};t=new Rf(((a=t.init)==null?void 0:a.status)||500,void 0,t.data)}return{type:"error",error:t,statusCode:Df(t)?t.status:void 0}}return SA(t)?{type:"data",data:t.data,statusCode:(o=t.init)==null?void 0:o.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function cJ(e,t,n,r,a){let o=e.headers.get("Location");if(Qe(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!F0.test(o)){let i=r.slice(0,r.findIndex(s=>s.route.id===n)+1);o=B0(new URL(t.url),i,a,o),e.headers.set("Location",o)}return e}function vA(e,t,n){if(F0.test(e)){let r=e,a=r.startsWith("//")?new URL(t.protocol+r):new URL(r),o=Zr(a.pathname,n)!=null;if(a.origin===t.origin&&o)return a.pathname+a.search+a.hash}return e}function ec(e,t,n,r){let a=e.createURL(EA(t)).toString(),o={signal:n};if(r&&Gr(r.formMethod)){let{formMethod:i,formEncType:s}=r;o.method=i.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=U0(r.formData):o.body=r.formData}return new Request(a,o)}function U0(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function bA(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function lJ(e,t,n,r=!1,a=!1){let o={},i=null,s,c=!1,l={},u=n&&yr(n[1])?n[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let p=d.route.id,f=t[p];if(Qe(!Yi(f),"Cannot handle redirect results in processLoaderData"),yr(f)){let m=f.error;if(u!==void 0&&(m=u,u=void 0),i=i||{},a)i[p]=m;else{let y=Ji(e,p);i[y.route.id]==null&&(i[y.route.id]=m)}r||(o[p]=uA),c||(c=!0,s=Df(f.error)?f.error.status:500),f.headers&&(l[p]=f.headers)}else o[p]=f.data,f.statusCode&&f.statusCode!==200&&!c&&(s=f.statusCode),f.headers&&(l[p]=f.headers)}),u!==void 0&&n&&(i={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:i,statusCode:s||200,loaderHeaders:l}}function wA(e,t,n,r,a,o){let{loaderData:i,errors:s}=lJ(t,n,r);return a.forEach(c=>{let{key:l,match:u,controller:d}=c,p=o[l];if(Qe(p,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(yr(p)){let f=Ji(e.matches,u==null?void 0:u.route.id);s&&s[f.route.id]||(s={...s,[f.route.id]:p.error}),e.fetchers.delete(l)}else if(Yi(p))Qe(!1,"Unhandled fetcher revalidation redirect");else{let f=ci(p.data);e.fetchers.set(l,f)}}),{loaderData:i,errors:s}}function xA(e,t,n,r){let a=Object.entries(t).filter(([,o])=>o!==uA).reduce((o,[i,s])=>(o[i]=s,o),{});for(let o of n){let i=o.route.id;if(!t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&o.route.loader&&(a[i]=e[i]),r&&r.hasOwnProperty(i))break}return a}function _A(e){return e?yr(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Ji(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function jA(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Nr(e,{pathname:t,routeId:n,method:r,type:a,message:o}={}){let i="Unknown Server Error",s="Unknown @remix-run/router error";return e===400?(i="Bad Request",r&&t&&n?s=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:a==="invalid-body"&&(s="Unable to encode submission body")):e===403?(i="Forbidden",s=`Route "${n}" does not match URL "${t}"`):e===404?(i="Not Found",s=`No route matches URL "${t}"`):e===405&&(i="Method Not Allowed",r&&t&&n?s=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new Rf(e||500,i,new Error(s),!0)}function Lf(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,a]=t[n];if(Yi(a))return{key:r,result:a}}}function EA(e){let t=typeof e=="string"?mo(e):e;return ho({...t,hash:""})}function uJ(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function dJ(e){return OA(e.result)&&XX.has(e.result.status)}function yr(e){return e.type==="error"}function Yi(e){return(e&&e.type)==="redirect"}function SA(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function OA(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function pJ(e){return GX.has(e.toUpperCase())}function Gr(e){return KX.has(e.toUpperCase())}function V0(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function xu(e,t){let n=typeof t=="string"?mo(t).search:t.search;if(e[e.length-1].route.index&&V0(n||""))return e[e.length-1];let r=sA(e);return r[r.length-1]}function CA(e){let{formMethod:t,formAction:n,formEncType:r,text:a,formData:o,json:i}=e;if(!(!t||!n||!r)){if(a!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:a};if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:i,text:void 0}}}function W0(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function fJ(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function _u(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function hJ(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function ci(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function mJ(e,t){try{let n=e.sessionStorage.getItem(lA);if(n){let r=JSON.parse(n);for(let[a,o]of Object.entries(r||{}))o&&Array.isArray(o)&&t.set(a,new Set(o||[]))}}catch{}}function yJ(e,t){if(t.size>0){let n={};for(let[r,a]of t)n[r]=[...a];try{e.sessionStorage.setItem(lA,JSON.stringify(n))}catch(r){un(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function gJ(){let e,t,n=new Promise((r,a)=>{e=async o=>{r(o);try{await n}catch{}},t=async o=>{a(o);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var Qi=g.createContext(null);Qi.displayName="DataRouter";var ju=g.createContext(null);ju.displayName="DataRouterState";var H0=g.createContext({isTransitioning:!1});H0.displayName="ViewTransition";var NA=g.createContext(new Map);NA.displayName="Fetchers";var vJ=g.createContext(null);vJ.displayName="Await";var Xr=g.createContext(null);Xr.displayName="Navigation";var $f=g.createContext(null);$f.displayName="Location";var kr=g.createContext({outlet:null,matches:[],isDataRoute:!1});kr.displayName="Route";var q0=g.createContext(null);q0.displayName="RouteError";function bJ(e,{relative:t}={}){Qe(tc(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=g.useContext(Xr),{hash:a,pathname:o,search:i}=Eu(e,{relative:t}),s=o;return n!=="/"&&(s=o==="/"?n:Ra([n,o])),r.createHref({pathname:s,search:i,hash:a})}function tc(){return g.useContext($f)!=null}function Da(){return Qe(tc(),"useLocation() may be used only in the context of a <Router> component."),g.useContext($f).location}var kA="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function MA(e){g.useContext(Xr).static||g.useLayoutEffect(e)}function es(){let{isDataRoute:e}=g.useContext(kr);return e?TJ():wJ()}function wJ(){Qe(tc(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(Qi),{basename:t,navigator:n}=g.useContext(Xr),{matches:r}=g.useContext(kr),{pathname:a}=Da(),o=JSON.stringify(Tf(r)),i=g.useRef(!1);return MA(()=>{i.current=!0}),g.useCallback((s,c={})=>{if(un(i.current,kA),!i.current)return;if(typeof s=="number"){n.go(s);return}let l=If(s,JSON.parse(o),a,c.relative==="path");e==null&&t!=="/"&&(l.pathname=l.pathname==="/"?t:Ra([t,l.pathname])),(c.replace?n.replace:n.push)(l,c.state,c)},[t,n,o,a,e])}var xJ=g.createContext(null);function _J(e){let t=g.useContext(kr).outlet;return t&&g.createElement(xJ.Provider,{value:e},t)}function Ff(){let{matches:e}=g.useContext(kr),t=e[e.length-1];return t?t.params:{}}function Eu(e,{relative:t}={}){let{matches:n}=g.useContext(kr),{pathname:r}=Da(),a=JSON.stringify(Tf(n));return g.useMemo(()=>If(e,JSON.parse(a),r,t==="path"),[e,a,r,t])}function jJ(e,t,n,r){Qe(tc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(Xr),{matches:o}=g.useContext(kr),i=o[o.length-1],s=i?i.params:{},c=i?i.pathname:"/",l=i?i.pathnameBase:"/",u=i&&i.route;{let v=u&&u.path||"";TA(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=Da(),p;p=d;let f=p.pathname||"/",m=f;if(l!=="/"){let v=l.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let y=si(e,{pathname:m});return un(u||y!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),un(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),NJ(y&&y.map(v=>Object.assign({},v,{params:Object.assign({},s,v.params),pathname:Ra([l,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Ra([l,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r)}function EJ(){let e=AA(),t=Df(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=g.createElement(g.Fragment,null,g.createElement("p",null,"\u{1F4BF} Hey developer \u{1F44B}"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:o},"ErrorBoundary")," or"," ",g.createElement("code",{style:o},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),n?g.createElement("pre",{style:a},n):null,i)}var SJ=g.createElement(EJ,null),OJ=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?g.createElement(kr.Provider,{value:this.props.routeContext},g.createElement(q0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function CJ({routeContext:e,match:t,children:n}){let r=g.useContext(Qi);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(kr.Provider,{value:e},n)}function NJ(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,o=n==null?void 0:n.errors;if(o!=null){let c=a.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id])!==void 0);Qe(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let i=!1,s=-1;if(n)for(let c=0;c<a.length;c++){let l=a[c];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(s=c),l.route.id){let{loaderData:u,errors:d}=n,p=l.route.loader&&!u.hasOwnProperty(l.route.id)&&(!d||d[l.route.id]===void 0);if(l.route.lazy||p){i=!0,s>=0?a=a.slice(0,s+1):a=[a[0]];break}}}return a.reduceRight((c,l,u)=>{let d,p=!1,f=null,m=null;n&&(d=o&&l.route.id?o[l.route.id]:void 0,f=l.route.errorElement||SJ,i&&(s<0&&u===0?(TA("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,m=null):s===u&&(p=!0,m=l.route.hydrateFallbackElement||null)));let y=t.concat(a.slice(0,u+1)),v=()=>{let b;return d?b=f:p?b=m:l.route.Component?b=g.createElement(l.route.Component,null):l.route.element?b=l.route.element:b=c,g.createElement(CJ,{match:l,routeContext:{outlet:c,matches:y,isDataRoute:n!=null},children:b})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?g.createElement(OJ,{location:n.location,revalidation:n.revalidation,component:f,error:d,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}function K0(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kJ(e){let t=g.useContext(Qi);return Qe(t,K0(e)),t}function MJ(e){let t=g.useContext(ju);return Qe(t,K0(e)),t}function AJ(e){let t=g.useContext(kr);return Qe(t,K0(e)),t}function Z0(e){let t=AJ(e),n=t.matches[t.matches.length-1];return Qe(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function PJ(){return Z0("useRouteId")}function AA(){var r;let e=g.useContext(q0),t=MJ("useRouteError"),n=Z0("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function TJ(){let{router:e}=kJ("useNavigate"),t=Z0("useNavigate"),n=g.useRef(!1);return MA(()=>{n.current=!0}),g.useCallback(async(r,a={})=>{un(n.current,kA),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...a}))},[e,t])}var PA={};function TA(e,t,n){!t&&!PA[e]&&(PA[e]=!0,un(!1,n))}var IA={};function RA(e,t){!e&&!IA[t]&&(IA[t]=!0,console.warn(t))}function DA(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&un(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:g.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&un(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:g.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&un(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:g.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var IJ=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function RJ({router:e,flushSync:t}){let[n,r]=g.useState(e.state),[a,o]=g.useState(),[i,s]=g.useState({isTransitioning:!1}),[c,l]=g.useState(),[u,d]=g.useState(),[p,f]=g.useState(),m=g.useRef(new Map),y=g.useCallback((_,{deletedFetchers:x,flushSync:j,viewTransitionOpts:E})=>{x.forEach(O=>m.current.delete(O)),_.fetchers.forEach((O,N)=>{O.data!==void 0&&m.current.set(N,O.data)}),RA(j===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let S=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(RA(E==null||S,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!E||!S){t&&j?t(()=>r(_)):g.startTransition(()=>r(_));return}if(t&&j){t(()=>{u&&(c&&c.resolve(),u.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:E.currentLocation,nextLocation:E.nextLocation})});let O=e.window.document.startViewTransition(()=>{t(()=>r(_))});O.finished.finally(()=>{t(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})})}),t(()=>d(O));return}u?(c&&c.resolve(),u.skipTransition(),f({state:_,currentLocation:E.currentLocation,nextLocation:E.nextLocation})):(o(_),s({isTransitioning:!0,flushSync:!1,currentLocation:E.currentLocation,nextLocation:E.nextLocation}))},[e.window,t,u,c]);g.useLayoutEffect(()=>e.subscribe(y),[e,y]),g.useEffect(()=>{i.isTransitioning&&!i.flushSync&&l(new IJ)},[i]),g.useEffect(()=>{if(c&&a&&e.window){let _=a,x=c.promise,j=e.window.document.startViewTransition(async()=>{g.startTransition(()=>r(_)),await x});j.finished.finally(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})}),d(j)}},[a,c,e.window]),g.useEffect(()=>{c&&a&&n.location.key===a.location.key&&c.resolve()},[c,u,n.location,a]),g.useEffect(()=>{!i.isTransitioning&&p&&(o(p.state),s({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),f(void 0))},[i.isTransitioning,p]);let v=g.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:_=>e.navigate(_),push:(_,x,j)=>e.navigate(_,{state:x,preventScrollReset:j==null?void 0:j.preventScrollReset}),replace:(_,x,j)=>e.navigate(_,{replace:!0,state:x,preventScrollReset:j==null?void 0:j.preventScrollReset})}),[e]),b=e.basename||"/",w=g.useMemo(()=>({router:e,navigator:v,static:!1,basename:b}),[e,v,b]);return g.createElement(g.Fragment,null,g.createElement(Qi.Provider,{value:w},g.createElement(ju.Provider,{value:n},g.createElement(NA.Provider,{value:m.current},g.createElement(H0.Provider,{value:i},g.createElement(BJ,{basename:b,location:n.location,navigationType:n.historyAction,navigator:v},g.createElement(DJ,{routes:e.routes,future:e.future,state:n})))))),null)}var DJ=g.memo(LJ);function LJ({routes:e,future:t,state:n}){return jJ(e,void 0,n,t)}function $J({to:e,replace:t,state:n,relative:r}){Qe(tc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(Xr);un(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=g.useContext(kr),{pathname:i}=Da(),s=es(),c=If(e,Tf(o),i,r==="path"),l=JSON.stringify(c);return g.useEffect(()=>{s(JSON.parse(l),{replace:t,state:n,relative:r})},[s,l,r,t,n]),null}function FJ(e){return _J(e.context)}function li(e){Qe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function BJ({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:a,static:o=!1}){Qe(!tc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),s=g.useMemo(()=>({basename:i,navigator:a,static:o,future:{}}),[i,a,o]);typeof n=="string"&&(n=mo(n));let{pathname:c="/",search:l="",hash:u="",state:d=null,key:p="default"}=n,f=g.useMemo(()=>{let m=Zr(c,i);return m==null?null:{location:{pathname:m,search:l,hash:u,state:d,key:p},navigationType:r}},[i,c,l,u,d,p,r]);return un(f!=null,`<Router basename="${i}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:g.createElement(Xr.Provider,{value:s},g.createElement($f.Provider,{children:t,value:f}))}function G0(e,t=[]){let n=[];return g.Children.forEach(e,(r,a)=>{if(!g.isValidElement(r))return;let o=[...t,a];if(r.type===g.Fragment){n.push.apply(n,G0(r.props.children,o));return}Qe(r.type===li,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qe(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=G0(r.props.children,o)),n.push(i)}),n}var zJ=G0,Bf="get",zf="application/x-www-form-urlencoded";function Uf(e){return e!=null&&typeof e.tagName=="string"}function UJ(e){return Uf(e)&&e.tagName.toLowerCase()==="button"}function VJ(e){return Uf(e)&&e.tagName.toLowerCase()==="form"}function WJ(e){return Uf(e)&&e.tagName.toLowerCase()==="input"}function HJ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function qJ(e,t){return e.button===0&&(!t||t==="_self")&&!HJ(e)}var Vf=null;function KJ(){if(Vf===null)try{new FormData(document.createElement("form"),0),Vf=!1}catch{Vf=!0}return Vf}var ZJ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function X0(e){return e!=null&&!ZJ.has(e)?(un(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${zf}"`),null):e}function GJ(e,t){let n,r,a,o,i;if(VJ(e)){let s=e.getAttribute("action");r=s?Zr(s,t):null,n=e.getAttribute("method")||Bf,a=X0(e.getAttribute("enctype"))||zf,o=new FormData(e)}else if(UJ(e)||WJ(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||s.getAttribute("action");if(r=c?Zr(c,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||Bf,a=X0(e.getAttribute("formenctype"))||X0(s.getAttribute("enctype"))||zf,o=new FormData(s,e),!KJ()){let{name:l,type:u,value:d}=e;if(u==="image"){let p=l?`${l}.`:"";o.append(`${p}x`,"0"),o.append(`${p}y`,"0")}else l&&o.append(l,d)}}else{if(Uf(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Bf,r=null,a=zf,i=e}return o&&a==="text/plain"&&(i=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:i}}function J0(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function XJ(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module).then(async r=>(await r.__tla,r));return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function JJ(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function YJ(e,t,n){let r=await Promise.all(e.map(async a=>{let o=t.routes[a.route.id];if(o){let i=await XJ(o,n);return i.links?i.links():[]}return[]}));return nY(r.flat(1).filter(JJ).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function LA(e,t,n,r,a,o){let i=(c,l)=>n[l]?c.route.id!==n[l].route.id:!0,s=(c,l)=>{var u;return n[l].pathname!==c.pathname||((u=n[l].route.path)==null?void 0:u.endsWith("*"))&&n[l].params["*"]!==c.params["*"]};return o==="assets"?t.filter((c,l)=>i(c,l)||s(c,l)):o==="data"?t.filter((c,l)=>{var d;let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(i(c,l)||s(c,l))return!0;if(c.route.shouldRevalidate){let p=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function QJ(e,t){return eY(e.map(n=>{let r=t.routes[n.route.id];if(!r)return[];let a=[r.module];return r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function eY(e){return[...new Set(e)]}function tY(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function nY(e,t){let n=new Set;return new Set(t),e.reduce((r,a)=>{let o=JSON.stringify(tY(a));return n.has(o)||(n.add(o),r.push({key:o,link:a})),r},[])}function rY(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function aY(){let e=g.useContext(Qi);return J0(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function oY(){let e=g.useContext(ju);return J0(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Y0=g.createContext(void 0);Y0.displayName="FrameworkContext";function $A(){let e=g.useContext(Y0);return J0(e,"You must render this element inside a <HydratedRouter> element"),e}function iY(e,t){let n=g.useContext(Y0),[r,a]=g.useState(!1),[o,i]=g.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=t,p=g.useRef(null);g.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let y=b=>{b.forEach(w=>{i(w.isIntersecting)})},v=new IntersectionObserver(y,{threshold:.5});return p.current&&v.observe(p.current),()=>{v.disconnect()}}},[e]),g.useEffect(()=>{if(r){let y=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(y)}}},[r]);let f=()=>{a(!0)},m=()=>{a(!1),i(!1)};return n?e!=="intent"?[o,p,{}]:[o,p,{onFocus:Su(s,f),onBlur:Su(c,m),onMouseEnter:Su(l,f),onMouseLeave:Su(u,m),onTouchStart:Su(d,f)}]:[!1,p,{}]}function Su(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function sY({page:e,...t}){let{router:n}=aY(),r=g.useMemo(()=>si(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?g.createElement(lY,{page:e,matches:r,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function cY(e){let{manifest:t,routeModules:n}=$A(),[r,a]=g.useState([]);return g.useEffect(()=>{let o=!1;return YJ(e,t,n).then(i=>{o||a(i)}),()=>{o=!0}},[e,t,n]),r}function lY({page:e,matches:t,...n}){let r=Da(),{manifest:a,routeModules:o}=$A(),{loaderData:i,matches:s}=oY(),c=g.useMemo(()=>LA(e,t,s,a,r,"data"),[e,t,s,a,r]),l=g.useMemo(()=>LA(e,t,s,a,r,"assets"),[e,t,s,a,r]),u=g.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let f=new Set,m=!1;if(t.forEach(v=>{var w;let b=a.routes[v.route.id];!b||!b.hasLoader||(!c.some(_=>_.route.id===v.route.id)&&v.route.id in i&&((w=o[v.route.id])!=null&&w.shouldRevalidate)||b.hasClientLoader?m=!0:f.add(v.route.id))}),f.size===0)return[];let y=rY(e);return m&&f.size>0&&y.searchParams.set("_routes",t.filter(v=>f.has(v.route.id)).map(v=>v.route.id).join(",")),[y.pathname+y.search]},[i,r,a,c,t,e,o]),d=g.useMemo(()=>QJ(l,a),[l,a]),p=cY(l);return g.createElement(g.Fragment,null,u.map(f=>g.createElement("link",{key:f,rel:"prefetch",as:"fetch",href:f,...n})),d.map(f=>g.createElement("link",{key:f,rel:"modulepreload",href:f,...n})),p.map(({key:f,link:m})=>g.createElement("link",{key:f,...m})))}function uY(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var FA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{FA&&(window.__reactRouterVersion="7.0.2")}catch{}function BA(e,t){return dA({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:EX({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||zA(),routes:e,mapRouteProperties:DA,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function dY(e,t){return dA({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:SX({window:t==null?void 0:t.window}),hydrationData:zA(),routes:e,mapRouteProperties:DA,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function zA(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:pY(e.errors)}),e}function pY(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,a]of t)if(a&&a.__type==="RouteErrorResponse")n[r]=new Rf(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let o=window[a.__subType];if(typeof o=="function")try{let i=new o(a.message);i.stack="",n[r]=i}catch{}}if(n[r]==null){let o=new Error(a.message);o.stack="",n[r]=o}}else n[r]=a;return n}var UA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Q0=g.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:a,replace:o,state:i,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},p){let{basename:f}=g.useContext(Xr),m=typeof c=="string"&&UA.test(c),y,v=!1;if(typeof c=="string"&&m&&(y=c,FA))try{let O=new URL(window.location.href),N=c.startsWith("//")?new URL(O.protocol+c):new URL(c),M=Zr(N.pathname,f);N.origin===O.origin&&M!=null?c=M+N.search+N.hash:v=!0}catch{un(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=bJ(c,{relative:r}),[w,_,x]=iY(n,d),j=yY(c,{replace:o,state:i,target:s,preventScrollReset:l,relative:r,viewTransition:u});function E(O){e&&e(O),O.defaultPrevented||j(O)}let S=g.createElement("a",{...d,...x,href:y||b,onClick:v||a?e:E,ref:uY(p,_),target:s,"data-discover":!m&&t==="render"?"true":void 0});return w&&!m?g.createElement(g.Fragment,null,S,g.createElement(sY,{page:b})):S});Q0.displayName="Link";var fY=g.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:a,to:o,viewTransition:i,children:s,...c},l){let u=Eu(o,{relative:c.relative}),d=Da(),p=g.useContext(ju),{navigator:f,basename:m}=g.useContext(Xr),y=p!=null&&xY(u)&&i===!0,v=f.encodeLocation?f.encodeLocation(u).pathname:u.pathname,b=d.pathname,w=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&m&&(w=Zr(w,m)||w);const _=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let x=b===v||!r&&b.startsWith(v)&&b.charAt(_)==="/",j=w!=null&&(w===v||!r&&w.startsWith(v)&&w.charAt(v.length)==="/"),E={isActive:x,isPending:j,isTransitioning:y},S=x?e:void 0,O;typeof n=="function"?O=n(E):O=[n,x?"active":null,j?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let N=typeof a=="function"?a(E):a;return g.createElement(Q0,{...c,"aria-current":S,className:O,ref:l,style:N,to:o,viewTransition:i},typeof s=="function"?s(E):s)});fY.displayName="NavLink";var hY=g.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:a,state:o,method:i=Bf,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...p},f)=>{let m=bY(),y=wY(s,{relative:l}),v=i.toLowerCase()==="get"?"get":"post",b=typeof s=="string"&&UA.test(s),w=_=>{if(c&&c(_),_.defaultPrevented)return;_.preventDefault();let x=_.nativeEvent.submitter,j=(x==null?void 0:x.getAttribute("formmethod"))||i;m(x||_.currentTarget,{fetcherKey:t,method:j,navigate:n,replace:a,state:o,relative:l,preventScrollReset:u,viewTransition:d})};return g.createElement("form",{ref:f,method:v,action:y,onSubmit:r?c:w,...p,"data-discover":!b&&e==="render"?"true":void 0})});hY.displayName="Form";function mY(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function VA(e){let t=g.useContext(Qi);return Qe(t,mY(e)),t}function yY(e,{target:t,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:i}={}){let s=es(),c=Da(),l=Eu(e,{relative:o});return g.useCallback(u=>{if(qJ(u,t)){u.preventDefault();let d=n!==void 0?n:ho(c)===ho(l);s(e,{replace:d,state:r,preventScrollReset:a,relative:o,viewTransition:i})}},[c,s,l,n,r,t,e,a,o,i])}var gY=0,vY=()=>`__${String(++gY)}__`;function bY(){let{router:e}=VA("useSubmit"),{basename:t}=g.useContext(Xr),n=PJ();return g.useCallback(async(r,a={})=>{let{action:o,method:i,encType:s,formData:c,body:l}=GJ(r,t);if(a.navigate===!1){let u=a.fetcherKey||vY();await e.fetch(u,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}function wY(e,{relative:t}={}){let{basename:n}=g.useContext(Xr),r=g.useContext(kr);Qe(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...Eu(e||".",{relative:t})},i=Da();if(e==null){o.search=i.search;let s=new URLSearchParams(o.search),c=s.getAll("index");if(c.some(l=>l==="")){s.delete("index"),c.filter(u=>u).forEach(u=>s.append("index",u));let l=s.toString();o.search=l?`?${l}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:Ra([n,o.pathname])),ho(o)}function xY(e,t={}){let n=g.useContext(H0);Qe(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=VA("useViewTransitionState"),a=Eu(e,{relative:t.relative});if(!n.isTransitioning)return!1;let o=Zr(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=Zr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Pf(a.pathname,i)!=null||Pf(a.pathname,o)!=null}new TextEncoder;function _Y(e){return g.createElement(RJ,{flushSync:Ql.flushSync,...e})}var jY=TDe.useId||(()=>{}),EY=0;Rt=function(e){const[t,n]=g.useState(jY());return ln(()=>{e||n(r=>r??String(EY++))},[e]),e||(t?`radix-${t}`:"")};var eb="Collapsible",[SY,WA]=pr(eb),[OY,tb]=SY(eb),HA=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:o,onOpenChange:i,...s}=e,[c=!1,l]=In({prop:r,defaultProp:a,onChange:i});return h.jsx(OY,{scope:n,disabled:o,contentId:Rt(),open:c,onOpenToggle:g.useCallback(()=>l(u=>!u),[l]),children:h.jsx(Pe.div,{"data-state":ob(c),"data-disabled":o?"":void 0,...s,ref:t})})});HA.displayName=eb;var qA="CollapsibleTrigger",nb=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=tb(qA,n);return h.jsx(Pe.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":ob(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:ge(e.onClick,a.onOpenToggle)})});nb.displayName=qA;var rb="CollapsibleContent",ab=g.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=tb(rb,e.__scopeCollapsible);return h.jsx(Ur,{present:n||a.open,children:({present:o})=>h.jsx(CY,{...r,ref:t,present:o})})});ab.displayName=rb;var CY=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...o}=e,i=tb(rb,n),[s,c]=g.useState(r),l=g.useRef(null),u=jt(t,l),d=g.useRef(0),p=d.current,f=g.useRef(0),m=f.current,y=i.open||s,v=g.useRef(y),b=g.useRef();return g.useEffect(()=>{const w=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(w)},[]),ln(()=>{const w=l.current;if(w){b.current=b.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const _=w.getBoundingClientRect();d.current=_.height,f.current=_.width,v.current||(w.style.transitionDuration=b.current.transitionDuration,w.style.animationName=b.current.animationName),c(r)}},[i.open,r]),h.jsx(Pe.div,{"data-state":ob(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!y,...o,ref:u,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":m?`${m}px`:void 0,...e.style},children:y&&a})});function ob(e){return e?"open":"closed"}var KA=HA,NY=nb,kY=ab;const MY=KA,AY=nb,PY=ab,ib=768;function TY(){const[e,t]=g.useState(void 0);return g.useEffect(()=>{const n=window.matchMedia(`(max-width: ${ib-1}px)`),r=()=>{t(window.innerWidth<ib)};return n.addEventListener("change",r),t(window.innerWidth<ib),()=>n.removeEventListener("change",r)},[]),!!e}let Ou;Ou=uo("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ye=g.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...a},o)=>{const i=r?ri:"button";return h.jsx(i,{className:Z(Ou({variant:t,size:n,className:e})),ref:o,...a})}),Ye.displayName="Button";const Kt=g.forwardRef(({className:e,type:t,...n},r)=>h.jsx("input",{type:t,className:Z("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));Kt.displayName="Input";var IY="Separator",ZA="horizontal",RY=["horizontal","vertical"],GA=g.forwardRef((e,t)=>{const{decorative:n,orientation:r=ZA,...a}=e,o=DY(r)?r:ZA,i=n?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return h.jsx(Pe.div,{"data-orientation":o,...i,...a,ref:t})});GA.displayName=IY;function DY(e){return RY.includes(e)}r0=GA,Gs=g.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},a)=>h.jsx(r0,{ref:a,decorative:n,orientation:t,className:Z("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r})),Gs.displayName=r0.displayName;var sb="focusScope.autoFocusOnMount",cb="focusScope.autoFocusOnUnmount",XA={bubbles:!1,cancelable:!0},LY="FocusScope",Wf=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=fr(a),u=fr(o),d=g.useRef(null),p=jt(t,y=>c(y)),f=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let y=function(_){if(f.paused||!s)return;const x=_.target;s.contains(x)?d.current=x:ui(d.current,{select:!0})},v=function(_){if(f.paused||!s)return;const x=_.relatedTarget;x!==null&&(s.contains(x)||ui(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const x of _)x.removedNodes.length>0&&ui(s)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,f.paused]),g.useEffect(()=>{if(s){QA.add(f);const y=document.activeElement;if(!s.contains(y)){const v=new CustomEvent(sb,XA);s.addEventListener(sb,l),s.dispatchEvent(v),v.defaultPrevented||($Y(VY(JA(s)),{select:!0}),document.activeElement===y&&ui(s))}return()=>{s.removeEventListener(sb,l),setTimeout(()=>{const v=new CustomEvent(cb,XA);s.addEventListener(cb,u),s.dispatchEvent(v),v.defaultPrevented||ui(y??document.body,{select:!0}),s.removeEventListener(cb,u),QA.remove(f)},0)}}},[s,l,u,f]);const m=g.useCallback(y=>{if(!n&&!r||f.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,b=document.activeElement;if(v&&b){const w=y.currentTarget,[_,x]=FY(w);_&&x?!y.shiftKey&&b===x?(y.preventDefault(),n&&ui(_,{select:!0})):y.shiftKey&&b===_&&(y.preventDefault(),n&&ui(x,{select:!0})):b===w&&y.preventDefault()}},[n,r,f.paused]);return h.jsx(Pe.div,{tabIndex:-1,...i,ref:p,onKeyDown:m})});Wf.displayName=LY;function $Y(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(ui(r,{select:t}),document.activeElement!==n)return}function FY(e){const t=JA(e),n=YA(t,e),r=YA(t.reverse(),e);return[n,r]}function JA(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function YA(e,t){for(const n of e)if(!BY(n,{upTo:t}))return n}function BY(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function zY(e){return e instanceof HTMLInputElement&&"select"in e}function ui(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&zY(e)&&t&&e.select()}}var QA=UY();function UY(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=eP(e,t),e.unshift(t)},remove(t){var n;e=eP(e,t),(n=e[0])==null||n.resume()}}}function eP(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function VY(e){return e.filter(t=>t.tagName!=="A")}var lb=0;hu=function(){g.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??tP()),document.body.insertAdjacentElement("beforeend",e[1]??tP()),lb++,()=>{lb===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),lb--}},[])};function tP(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}On=function(){return On=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},On.apply(this,arguments)},Ef=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},b0=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};var Hf="right-scroll-bar-position",qf="width-before-scroll-bar",WY="with-scroll-bars-hidden",HY="--removed-body-scroll-bar-size";function ub(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function qY(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var KY=typeof window<"u"?g.useLayoutEffect:g.useEffect,nP=new WeakMap;function ZY(e,t){var n=qY(null,function(r){return e.forEach(function(a){return ub(a,r)})});return KY(function(){var r=nP.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||ub(s,null)}),o.forEach(function(s){a.has(s)||ub(s,i)})}nP.set(n,e)},[e]),n}function GY(e){return e}function XY(e,t){t===void 0&&(t=GY);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var i=t(o,r);return n.push(i),function(){n=n.filter(function(s){return s!==i})}},assignSyncMedium:function(o){for(r=!0;n.length;){var i=n;n=[],i.forEach(o)}n={push:function(s){return o(s)},filter:function(){return n}}},assignMedium:function(o){r=!0;var i=[];if(n.length){var s=n;n=[],s.forEach(o),i=n}var c=function(){var u=i;i=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){i.push(u),l()},filter:function(u){return i=i.filter(u),n}}}};return a}g0=function(e){e===void 0&&(e={});var t=XY(null);return t.options=On({async:!0,ssr:!1},e),t};var rP=function(e){var t=e.sideCar,n=Ef(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,On({},n))};rP.isSideCarExport=!0,w0=function(e,t){return e.useMedium(t),rP};var aP=g0(),db=function(){},Kf=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:db,onWheelCapture:db,onTouchMoveCapture:db}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,p=e.sideCar,f=e.noIsolation,m=e.inert,y=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,_=Ef(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=p,j=ZY([n,t]),E=On(On({},_),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:aP,removeScrollBar:l,shards:d,noIsolation:f,inert:m,setCallbacks:o,allowPinchZoom:!!y,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),On(On({},E),{ref:j})):g.createElement(b,On({},E,{className:c,ref:j}),s))});Kf.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Kf.classNames={fullWidth:qf,zeroRight:Hf},v0=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function JY(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=v0();return t&&e.setAttribute("nonce",t),e}function YY(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function QY(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}let oP,iP,sP,Zf,cP,lP,uP,ts,dP,pb,pP,fP,Gf;if(oP=function(){var e=0,t=null;return{add:function(n){e==0&&(t=JY())&&(YY(t,n),QY(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},iP=function(){var e=oP();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Sf=function(){var e=iP(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},sP={left:0,top:0,right:0,gap:0},Zf=function(e){return parseInt(e||"",10)||0},cP=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[Zf(n),Zf(r),Zf(a)]},lP=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return sP;var t=cP(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},uP=Sf(),ts="data-scroll-locked",dP=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(WY,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(ts,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Hf,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(qf,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Hf," .").concat(Hf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(qf," .").concat(qf,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(ts,`] {
    `).concat(HY,": ").concat(s,`px;
  }
`)},pb=function(){var e=parseInt(document.body.getAttribute(ts)||"0",10);return isFinite(e)?e:0},pP=function(){g.useEffect(function(){return document.body.setAttribute(ts,(pb()+1).toString()),function(){var e=pb()-1;e<=0?document.body.removeAttribute(ts):document.body.setAttribute(ts,e.toString())}},[])},fP=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;pP();var o=g.useMemo(function(){return lP(a)},[a]);return g.createElement(uP,{styles:dP(o,!t,a,n?"":"!important")})},Gf=!1,typeof window<"u")try{var Xf=Object.defineProperty({},"passive",{get:function(){return Gf=!0,!0}});window.addEventListener("test",Xf,Xf),window.removeEventListener("test",Xf,Xf)}catch{Gf=!1}var nc=Gf?{passive:!1}:!1,eQ=function(e){return e.tagName==="TEXTAREA"},hP=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!eQ(e)&&n[t]==="visible")},tQ=function(e){return hP(e,"overflowY")},nQ=function(e){return hP(e,"overflowX")},mP=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=yP(e,r);if(a){var o=gP(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},rQ=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},aQ=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},yP=function(e,t){return e==="v"?tQ(t):nQ(t)},gP=function(e,t){return e==="v"?rQ(t):aQ(t)},oQ=function(e,t){return e==="h"&&t==="rtl"?-1:1},iQ=function(e,t,n,r,a){var o=oQ(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,p=0;do{var f=gP(e,s),m=f[0],y=f[1],v=f[2],b=y-v-o*m;(m||b)&&yP(e,s)&&(d+=b,p+=m),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(p)<1||!a))&&(l=!0),l},Jf=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},vP=function(e){return[e.deltaX,e.deltaY]},bP=function(e){return e&&"current"in e?e.current:e},sQ=function(e,t){return e[0]===t[0]&&e[1]===t[1]},cQ=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},lQ=0,rc=[];function uQ(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(lQ++)[0],o=g.useState(Sf)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var y=b0([e.lockRef.current],(e.shards||[]).map(bP),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!i.current.allowPinchZoom;var b=Jf(y),w=n.current,_="deltaX"in y?y.deltaX:w[0]-b[0],x="deltaY"in y?y.deltaY:w[1]-b[1],j,E=y.target,S=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in y&&S==="h"&&E.type==="range")return!1;var O=mP(S,E);if(!O)return!0;if(O?j=S:(j=S==="v"?"h":"v",O=mP(S,E)),!O)return!1;if(!r.current&&"changedTouches"in y&&(_||x)&&(r.current=j),!j)return!0;var N=r.current||j;return iQ(N,v,y,N==="h"?_:x,!0)},[]),c=g.useCallback(function(y){var v=y;if(!(!rc.length||rc[rc.length-1]!==o)){var b="deltaY"in v?vP(v):Jf(v),w=t.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&sQ(j.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(bP).filter(Boolean).filter(function(j){return j.contains(v.target)}),x=_.length>0?s(v,_[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(y,v,b,w){var _={name:y,delta:v,target:b,should:w,shadowParent:dQ(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(x){return x!==_})},1)},[]),u=g.useCallback(function(y){n.current=Jf(y),r.current=void 0},[]),d=g.useCallback(function(y){l(y.type,vP(y),y.target,s(y,e.lockRef.current))},[]),p=g.useCallback(function(y){l(y.type,Jf(y),y.target,s(y,e.lockRef.current))},[]);g.useEffect(function(){return rc.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:p}),document.addEventListener("wheel",c,nc),document.addEventListener("touchmove",c,nc),document.addEventListener("touchstart",u,nc),function(){rc=rc.filter(function(y){return y!==o}),document.removeEventListener("wheel",c,nc),document.removeEventListener("touchmove",c,nc),document.removeEventListener("touchstart",u,nc)}},[]);var f=e.removeScrollBar,m=e.inert;return g.createElement(g.Fragment,null,m?g.createElement(o,{styles:cQ(a)}):null,f?g.createElement(fP,{gapMode:e.gapMode}):null)}function dQ(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const pQ=w0(aP,uQ);var Yf=g.forwardRef(function(e,t){return g.createElement(Kf,On({},e,{ref:t,sideCar:pQ}))});Yf.classNames=Kf.classNames;let wP,ns,Cu,Nu,Qf,fb,xP,_P,eh,hb,mb,jP,Mr,yb;wP=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ns=new WeakMap,Cu=new WeakMap,Nu={},Qf=0,fb=function(e){return e&&(e.host||fb(e.parentNode))},xP=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=fb(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},_P=function(e,t,n,r){var a=xP(t,Array.isArray(e)?e:[e]);Nu[n]||(Nu[n]=new WeakMap);var o=Nu[n],i=[],s=new Set,c=new Set(a),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};a.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(p){if(s.has(p))u(p);else try{var f=p.getAttribute(r),m=f!==null&&f!=="false",y=(ns.get(p)||0)+1,v=(o.get(p)||0)+1;ns.set(p,y),o.set(p,v),i.push(p),y===1&&m&&Cu.set(p,!0),v===1&&p.setAttribute(n,"true"),m||p.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",p,b)}})};return u(t),s.clear(),Qf++,function(){i.forEach(function(d){var p=ns.get(d)-1,f=o.get(d)-1;ns.set(d,p),o.set(d,f),p||(Cu.has(d)||d.removeAttribute(r),Cu.delete(d)),f||d.removeAttribute(n)}),Qf--,Qf||(ns=new WeakMap,ns=new WeakMap,Cu=new WeakMap,Nu={})}},fu=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=wP(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),_P(r,a,n,"aria-hidden")):function(){return null}},eh="Dialog",[hb,mb]=pr(eh),[jP,Mr]=hb(eh),yb=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!0}=e,s=g.useRef(null),c=g.useRef(null),[l=!1,u]=In({prop:r,defaultProp:a,onChange:o});return h.jsx(jP,{scope:t,triggerRef:s,contentRef:c,contentId:Rt(),titleId:Rt(),descriptionId:Rt(),open:l,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:i,children:n})},yb.displayName=eh;var EP="DialogTrigger",SP=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Mr(EP,n),o=jt(t,a.triggerRef);return h.jsx(Pe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":bb(a.open),...r,ref:o,onClick:ge(e.onClick,a.onOpenToggle)})});SP.displayName=EP;var gb="DialogPortal",[fQ,OP]=hb(gb,{forceMount:void 0}),CP=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,o=Mr(gb,t);return h.jsx(fQ,{scope:t,forceMount:n,children:g.Children.map(r,i=>h.jsx(Ur,{present:n||o.open,children:h.jsx(Nv,{asChild:!0,container:a,children:i})}))})};CP.displayName=gb;var th="DialogOverlay",NP=g.forwardRef((e,t)=>{const n=OP(th,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=Mr(th,e.__scopeDialog);return o.modal?h.jsx(Ur,{present:r||o.open,children:h.jsx(hQ,{...a,ref:t})}):null});NP.displayName=th;var hQ=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Mr(th,n);return h.jsx(Yf,{as:ri,allowPinchZoom:!0,shards:[a.contentRef],children:h.jsx(Pe.div,{"data-state":bb(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),rs="DialogContent",kP=g.forwardRef((e,t)=>{const n=OP(rs,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=Mr(rs,e.__scopeDialog);return h.jsx(Ur,{present:r||o.open,children:o.modal?h.jsx(mQ,{...a,ref:t}):h.jsx(yQ,{...a,ref:t})})});kP.displayName=rs;var mQ=g.forwardRef((e,t)=>{const n=Mr(rs,e.__scopeDialog),r=g.useRef(null),a=jt(t,n.contentRef,r);return g.useEffect(()=>{const o=r.current;if(o)return fu(o)},[]),h.jsx(MP,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(e.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ge(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,s=i.button===0&&i.ctrlKey===!0;(i.button===2||s)&&o.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault())})}),yQ=g.forwardRef((e,t)=>{const n=Mr(rs,e.__scopeDialog),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(MP,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),MP=g.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,...i}=e,s=Mr(rs,n),c=g.useRef(null),l=jt(t,c);return hu(),h.jsxs(h.Fragment,{children:[h.jsx(Wf,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(Cv,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":bb(s.open),...i,ref:l,onDismiss:()=>s.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(LP,{titleId:s.titleId}),h.jsx(FP,{contentRef:c,descriptionId:s.descriptionId})]})]})}),vb="DialogTitle",AP=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Mr(vb,n);return h.jsx(Pe.h2,{id:a.titleId,...r,ref:t})});AP.displayName=vb;var PP="DialogDescription",TP=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Mr(PP,n);return h.jsx(Pe.p,{id:a.descriptionId,...r,ref:t})});TP.displayName=PP;var IP="DialogClose",RP=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Mr(IP,n);return h.jsx(Pe.button,{type:"button",...r,ref:t,onClick:ge(e.onClick,()=>a.onOpenChange(!1))})});RP.displayName=IP;function bb(e){return e?"open":"closed"}let wb,DP,xb,LP,$P,FP,BP;wb="DialogTitleWarning",[DP,xb]=IDe(wb,{contentName:rs,titleName:vb,docsSlug:"dialog"}),LP=({titleId:e})=>{const t=xb(wb),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return g.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},$P="DialogDescriptionWarning",FP=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${xb($P).contentName}}.`;return g.useEffect(()=>{var a;const r=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},ou=yb,BP=SP,cu=CP,Zi=NP,Gi=kP,Ks=AP,Zs=TP,lu=RP;const gQ=ou,vQ=cu,zP=g.forwardRef(({className:e,...t},n)=>h.jsx(Zi,{className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));zP.displayName=Zi.displayName;const bQ=uo("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),UP=g.forwardRef(({side:e="right",className:t,children:n,...r},a)=>h.jsxs(vQ,{children:[h.jsx(zP,{}),h.jsxs(Gi,{ref:a,className:Z(bQ({side:e}),t),...r,children:[n,h.jsxs(lu,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[h.jsx(pe,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));UP.displayName=Gi.displayName;const wQ=g.forwardRef(({className:e,...t},n)=>h.jsx(Ks,{ref:n,className:Z("text-lg font-semibold text-foreground",e),...t}));wQ.displayName=Ks.displayName;const xQ=g.forwardRef(({className:e,...t},n)=>h.jsx(Zs,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));xQ.displayName=Zs.displayName;function VP({className:e,...t}){return h.jsx("div",{className:Z("animate-pulse rounded-md bg-muted",e),...t})}const _Q=["top","right","bottom","left"],La=Math.min,gr=Math.max,nh=Math.round,rh=Math.floor,di=e=>({x:e,y:e}),jQ={left:"right",right:"left",bottom:"top",top:"bottom"},EQ={start:"end",end:"start"};function _b(e,t,n){return gr(e,La(t,n))}function yo(e,t){return typeof e=="function"?e(t):e}function go(e){return e.split("-")[0]}function ac(e){return e.split("-")[1]}function jb(e){return e==="x"?"y":"x"}function Eb(e){return e==="y"?"height":"width"}function pi(e){return["top","bottom"].includes(go(e))?"y":"x"}function Sb(e){return jb(pi(e))}function SQ(e,t,n){n===void 0&&(n=!1);const r=ac(e),a=Sb(e),o=Eb(a);let i=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=ah(i)),[i,ah(i)]}function OQ(e){const t=ah(e);return[Ob(e),t,Ob(t)]}function Ob(e){return e.replace(/start|end/g,t=>EQ[t])}function CQ(e,t,n){const r=["left","right"],a=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?o:i;default:return[]}}function NQ(e,t,n,r){const a=ac(e);let o=CQ(go(e),n==="start",r);return a&&(o=o.map(i=>i+"-"+a),t&&(o=o.concat(o.map(Ob)))),o}function ah(e){return e.replace(/left|right|bottom|top/g,t=>jQ[t])}function kQ(e){return{top:0,right:0,bottom:0,left:0,...e}}function WP(e){return typeof e!="number"?kQ(e):{top:e,right:e,bottom:e,left:e}}function oh(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function HP(e,t,n){let{reference:r,floating:a}=e;const o=pi(t),i=Sb(t),s=Eb(i),c=go(t),l=o==="y",u=r.x+r.width/2-a.width/2,d=r.y+r.height/2-a.height/2,p=r[s]/2-a[s]/2;let f;switch(c){case"top":f={x:u,y:r.y-a.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-a.width,y:d};break;default:f={x:r.x,y:r.y}}switch(ac(t)){case"start":f[i]-=p*(n&&l?-1:1);break;case"end":f[i]+=p*(n&&l?-1:1);break}return f}const MQ=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:i}=n,s=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let l=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:d}=HP(l,r,c),p=r,f={},m=0;for(let y=0;y<s.length;y++){const{name:v,fn:b}=s[y],{x:w,y:_,data:x,reset:j}=await b({x:u,y:d,initialPlacement:r,placement:p,strategy:a,middlewareData:f,rects:l,platform:i,elements:{reference:e,floating:t}});u=w??u,d=_??d,f={...f,[v]:{...f[v],...x}},j&&m<=50&&(m++,typeof j=="object"&&(j.placement&&(p=j.placement),j.rects&&(l=j.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):j.rects),{x:u,y:d}=HP(l,p,c)),y=-1)}return{x:u,y:d,placement:p,strategy:a,middlewareData:f}};async function ku(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:o,rects:i,elements:s,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:f=0}=yo(t,e),m=WP(f),y=s[p?d==="floating"?"reference":"floating":d],v=oh(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(y)))==null||n?y:y.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),b=d==="floating"?{x:r,y:a,width:i.floating.width,height:i.floating.height}:i.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),_=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},x=oh(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:w,strategy:c}):b);return{top:(v.top-x.top+m.top)/_.y,bottom:(x.bottom-v.bottom+m.bottom)/_.y,left:(v.left-x.left+m.left)/_.x,right:(x.right-v.right+m.right)/_.x}}const AQ=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:o,platform:i,elements:s,middlewareData:c}=t,{element:l,padding:u=0}=yo(e,t)||{};if(l==null)return{};const d=WP(u),p={x:n,y:r},f=Sb(a),m=Eb(f),y=await i.getDimensions(l),v=f==="y",b=v?"top":"left",w=v?"bottom":"right",_=v?"clientHeight":"clientWidth",x=o.reference[m]+o.reference[f]-p[f]-o.floating[m],j=p[f]-o.reference[f],E=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l));let S=E?E[_]:0;(!S||!await(i.isElement==null?void 0:i.isElement(E)))&&(S=s.floating[_]||o.floating[m]);const O=x/2-j/2,N=S/2-y[m]/2-1,M=La(d[b],N),k=La(d[w],N),A=M,P=S-y[m]-k,C=S/2-y[m]/2+O,T=_b(A,C,P),I=!c.arrow&&ac(a)!=null&&C!==T&&o.reference[m]/2-(C<A?M:k)-y[m]/2<0,R=I?C<A?C-A:C-P:0;return{[f]:p[f]+R,data:{[f]:T,centerOffset:C-T-R,...I&&{alignmentOffset:R}},reset:I}}}),PQ=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:i,initialPlacement:s,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:y=!0,...v}=yo(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const b=go(a),w=pi(s),_=go(s)===s,x=await(c.isRTL==null?void 0:c.isRTL(l.floating)),j=p||(_||!y?[ah(s)]:OQ(s)),E=m!=="none";!p&&E&&j.push(...NQ(s,y,m,x));const S=[s,...j],O=await ku(t,v),N=[];let M=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&N.push(O[b]),d){const C=SQ(a,i,x);N.push(O[C[0]],O[C[1]])}if(M=[...M,{placement:a,overflows:N}],!N.every(C=>C<=0)){var k,A;const C=(((k=o.flip)==null?void 0:k.index)||0)+1,T=S[C];if(T)return{data:{index:C,overflows:M},reset:{placement:T}};let I=(A=M.filter(R=>R.overflows[0]<=0).sort((R,L)=>R.overflows[1]-L.overflows[1])[0])==null?void 0:A.placement;if(!I)switch(f){case"bestFit":{var P;const R=(P=M.filter(L=>{if(E){const D=pi(L.placement);return D===w||D==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(D=>D>0).reduce((D,z)=>D+z,0)]).sort((L,D)=>L[1]-D[1])[0])==null?void 0:P[0];R&&(I=R);break}case"initialPlacement":I=s;break}if(a!==I)return{reset:{placement:I}}}return{}}}};function qP(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function KP(e){return _Q.some(t=>e[t]>=0)}const TQ=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=yo(e,t);switch(r){case"referenceHidden":{const o=await ku(t,{...a,elementContext:"reference"}),i=qP(o,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:KP(i)}}}case"escaped":{const o=await ku(t,{...a,altBoundary:!0}),i=qP(o,n.floating);return{data:{escapedOffsets:i,escaped:KP(i)}}}default:return{}}}}};async function IQ(e,t){const{placement:n,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),i=go(n),s=ac(n),c=pi(n)==="y",l=["left","top"].includes(i)?-1:1,u=o&&c?-1:1,d=yo(t,e);let{mainAxis:p,crossAxis:f,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof m=="number"&&(f=s==="end"?m*-1:m),c?{x:f*u,y:p*l}:{x:p*l,y:f*u}}const RQ=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:o,placement:i,middlewareData:s}=t,c=await IQ(t,e);return i===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:a+c.x,y:o+c.y,data:{...c,placement:i}}}}},DQ=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:s={fn:v=>{let{x:b,y:w}=v;return{x:b,y:w}}},...c}=yo(e,t),l={x:n,y:r},u=await ku(t,c),d=pi(go(a)),p=jb(d);let f=l[p],m=l[d];if(o){const v=p==="y"?"top":"left",b=p==="y"?"bottom":"right",w=f+u[v],_=f-u[b];f=_b(w,f,_)}if(i){const v=d==="y"?"top":"left",b=d==="y"?"bottom":"right",w=m+u[v],_=m-u[b];m=_b(w,m,_)}const y=s.fn({...t,[p]:f,[d]:m});return{...y,data:{x:y.x-n,y:y.y-r}}}}},LQ=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:o,middlewareData:i}=t,{offset:s=0,mainAxis:c=!0,crossAxis:l=!0}=yo(e,t),u={x:n,y:r},d=pi(a),p=jb(d);let f=u[p],m=u[d];const y=yo(s,t),v=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(c){const _=p==="y"?"height":"width",x=o.reference[p]-o.floating[_]+v.mainAxis,j=o.reference[p]+o.reference[_]-v.mainAxis;f<x?f=x:f>j&&(f=j)}if(l){var b,w;const _=p==="y"?"width":"height",x=["top","left"].includes(go(a)),j=o.reference[d]-o.floating[_]+(x&&((b=i.offset)==null?void 0:b[d])||0)+(x?0:v.crossAxis),E=o.reference[d]+o.reference[_]+(x?0:((w=i.offset)==null?void 0:w[d])||0)-(x?v.crossAxis:0);m<j?m=j:m>E&&(m=E)}return{[p]:f,[d]:m}}}},$Q=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:a,elements:o}=t,{apply:i=()=>{},...s}=yo(e,t),c=await ku(t,s),l=go(n),u=ac(n),d=pi(n)==="y",{width:p,height:f}=r.floating;let m,y;l==="top"||l==="bottom"?(m=l,y=u===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(y=l,m=u==="end"?"top":"bottom");const v=f-c.top-c.bottom,b=p-c.left-c.right,w=La(f-c[m],v),_=La(p-c[y],b),x=!t.middlewareData.shift;let j=w,E=_;if(d?E=u||x?La(_,b):b:j=u||x?La(w,v):v,x&&!u){const O=gr(c.left,0),N=gr(c.right,0),M=gr(c.top,0),k=gr(c.bottom,0);d?E=p-2*(O!==0||N!==0?O+N:gr(c.left,c.right)):j=f-2*(M!==0||k!==0?M+k:gr(c.top,c.bottom))}await i({...t,availableWidth:E,availableHeight:j});const S=await a.getDimensions(o.floating);return p!==S.width||f!==S.height?{reset:{rects:!0}}:{}}}};function oc(e){return ZP(e)?(e.nodeName||"").toLowerCase():"#document"}function vr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function vo(e){var t;return(t=(ZP(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function ZP(e){return e instanceof Node||e instanceof vr(e).Node}function Jr(e){return e instanceof Element||e instanceof vr(e).Element}function $a(e){return e instanceof HTMLElement||e instanceof vr(e).HTMLElement}function GP(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof vr(e).ShadowRoot}function Mu(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Yr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function FQ(e){return["table","td","th"].includes(oc(e))}function ih(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Cb(e){const t=Nb(),n=Jr(e)?Yr(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function BQ(e){let t=fi(e);for(;$a(t)&&!ic(t);){if(Cb(t))return t;if(ih(t))return null;t=fi(t)}return null}function Nb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ic(e){return["html","body","#document"].includes(oc(e))}function Yr(e){return vr(e).getComputedStyle(e)}function sh(e){return Jr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function fi(e){if(oc(e)==="html")return e;const t=e.assignedSlot||e.parentNode||GP(e)&&e.host||vo(e);return GP(t)?t.host:t}function XP(e){const t=fi(e);return ic(t)?e.ownerDocument?e.ownerDocument.body:e.body:$a(t)&&Mu(t)?t:XP(t)}function Au(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=XP(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),i=vr(a);if(o){const s=kb(i);return t.concat(i,i.visualViewport||[],Mu(a)?a:[],s&&n?Au(s):[])}return t.concat(a,Au(a,[],n))}function kb(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function JP(e){const t=Yr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=$a(e),o=a?e.offsetWidth:n,i=a?e.offsetHeight:r,s=nh(n)!==o||nh(r)!==i;return s&&(n=o,r=i),{width:n,height:r,$:s}}function Mb(e){return Jr(e)?e:e.contextElement}function sc(e){const t=Mb(e);if(!$a(t))return di(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=JP(t);let i=(o?nh(n.width):n.width)/r,s=(o?nh(n.height):n.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const zQ=di(0);function YP(e){const t=vr(e);return!Nb()||!t.visualViewport?zQ:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function UQ(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==vr(e)?!1:t}function as(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=Mb(e);let i=di(1);t&&(r?Jr(r)&&(i=sc(r)):i=sc(e));const s=UQ(o,n,r)?YP(o):di(0);let c=(a.left+s.x)/i.x,l=(a.top+s.y)/i.y,u=a.width/i.x,d=a.height/i.y;if(o){const p=vr(o),f=r&&Jr(r)?vr(r):r;let m=p,y=kb(m);for(;y&&r&&f!==m;){const v=sc(y),b=y.getBoundingClientRect(),w=Yr(y),_=b.left+(y.clientLeft+parseFloat(w.paddingLeft))*v.x,x=b.top+(y.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,l*=v.y,u*=v.x,d*=v.y,c+=_,l+=x,m=vr(y),y=kb(m)}}return oh({width:u,height:d,x:c,y:l})}function VQ(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const o=a==="fixed",i=vo(r),s=t?ih(t.floating):!1;if(r===i||s&&o)return n;let c={scrollLeft:0,scrollTop:0},l=di(1);const u=di(0),d=$a(r);if((d||!d&&!o)&&((oc(r)!=="body"||Mu(i))&&(c=sh(r)),$a(r))){const p=as(r);l=sc(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function WQ(e){return Array.from(e.getClientRects())}function QP(e){return as(vo(e)).left+sh(e).scrollLeft}function HQ(e){const t=vo(e),n=sh(e),r=e.ownerDocument.body,a=gr(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=gr(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+QP(e);const s=-n.scrollTop;return Yr(r).direction==="rtl"&&(i+=gr(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:i,y:s}}function qQ(e,t){const n=vr(e),r=vo(e),a=n.visualViewport;let o=r.clientWidth,i=r.clientHeight,s=0,c=0;if(a){o=a.width,i=a.height;const l=Nb();(!l||l&&t==="fixed")&&(s=a.offsetLeft,c=a.offsetTop)}return{width:o,height:i,x:s,y:c}}function KQ(e,t){const n=as(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,o=$a(e)?sc(e):di(1),i=e.clientWidth*o.x,s=e.clientHeight*o.y,c=a*o.x,l=r*o.y;return{width:i,height:s,x:c,y:l}}function e2(e,t,n){let r;if(t==="viewport")r=qQ(e,n);else if(t==="document")r=HQ(vo(e));else if(Jr(t))r=KQ(t,n);else{const a=YP(e);r={...t,x:t.x-a.x,y:t.y-a.y}}return oh(r)}function t2(e,t){const n=fi(e);return n===t||!Jr(n)||ic(n)?!1:Yr(n).position==="fixed"||t2(n,t)}function ZQ(e,t){const n=t.get(e);if(n)return n;let r=Au(e,[],!1).filter(s=>Jr(s)&&oc(s)!=="body"),a=null;const o=Yr(e).position==="fixed";let i=o?fi(e):e;for(;Jr(i)&&!ic(i);){const s=Yr(i),c=Cb(i);!c&&s.position==="fixed"&&(a=null),(o?!c&&!a:!c&&s.position==="static"&&a&&["absolute","fixed"].includes(a.position)||Mu(i)&&!c&&t2(e,i))?r=r.filter(l=>l!==i):a=s,i=fi(i)}return t.set(e,r),r}function GQ(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const o=[...n==="clippingAncestors"?ih(t)?[]:ZQ(t,this._c):[].concat(n),r],i=o[0],s=o.reduce((c,l)=>{const u=e2(t,l,a);return c.top=gr(u.top,c.top),c.right=La(u.right,c.right),c.bottom=La(u.bottom,c.bottom),c.left=gr(u.left,c.left),c},e2(t,i,a));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function XQ(e){const{width:t,height:n}=JP(e);return{width:t,height:n}}function JQ(e,t,n){const r=$a(t),a=vo(t),o=n==="fixed",i=as(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const c=di(0);if(r||!r&&!o)if((oc(t)!=="body"||Mu(a))&&(s=sh(t)),r){const d=as(t,!0,o,t);c.x=d.x+t.clientLeft,c.y=d.y+t.clientTop}else a&&(c.x=QP(a));const l=i.left+s.scrollLeft-c.x,u=i.top+s.scrollTop-c.y;return{x:l,y:u,width:i.width,height:i.height}}function Ab(e){return Yr(e).position==="static"}function n2(e,t){return!$a(e)||Yr(e).position==="fixed"?null:t?t(e):e.offsetParent}function r2(e,t){const n=vr(e);if(ih(e))return n;if(!$a(e)){let a=fi(e);for(;a&&!ic(a);){if(Jr(a)&&!Ab(a))return a;a=fi(a)}return n}let r=n2(e,t);for(;r&&FQ(r)&&Ab(r);)r=n2(r,t);return r&&ic(r)&&Ab(r)&&!Cb(r)?n:r||BQ(e)||n}const YQ=async function(e){const t=this.getOffsetParent||r2,n=this.getDimensions,r=await n(e.floating);return{reference:JQ(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function QQ(e){return Yr(e).direction==="rtl"}const eee={convertOffsetParentRelativeRectToViewportRelativeRect:VQ,getDocumentElement:vo,getClippingRect:GQ,getOffsetParent:r2,getElementRects:YQ,getClientRects:WQ,getDimensions:XQ,getScale:sc,isElement:Jr,isRTL:QQ};function tee(e,t){let n=null,r;const a=vo(e);function o(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),o();const{left:l,top:u,width:d,height:p}=e.getBoundingClientRect();if(s||t(),!d||!p)return;const f=rh(u),m=rh(a.clientWidth-(l+d)),y=rh(a.clientHeight-(u+p)),v=rh(l),b={rootMargin:-f+"px "+-m+"px "+-y+"px "+-v+"px",threshold:gr(0,La(1,c))||1};let w=!0;function _(x){const j=x[0].intersectionRatio;if(j!==c){if(!w)return i();j?i(!1,j):r=setTimeout(()=>{i(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(_,{...b,root:a.ownerDocument})}catch{n=new IntersectionObserver(_,b)}n.observe(e)}return i(!0),o}$v=function(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=Mb(e),u=a||o?[...l?Au(l):[],...Au(t)]:[];u.forEach(b=>{a&&b.addEventListener("scroll",n,{passive:!0}),o&&b.addEventListener("resize",n)});const d=l&&s?tee(l,n):null;let p=-1,f=null;i&&(f=new ResizeObserver(b=>{let[w]=b;w&&w.target===l&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var _;(_=f)==null||_.observe(t)})),n()}),l&&!c&&f.observe(l),f.observe(t));let m,y=c?as(e):null;c&&v();function v(){const b=as(e);y&&(b.x!==y.x||b.y!==y.y||b.width!==y.width||b.height!==y.height)&&n(),y=b,m=requestAnimationFrame(v)}return n(),()=>{var b;u.forEach(w=>{a&&w.removeEventListener("scroll",n),o&&w.removeEventListener("resize",n)}),d==null||d(),(b=f)==null||b.disconnect(),f=null,c&&cancelAnimationFrame(m)}};let a2;cM=RQ,bM=DQ,lM=PQ,xM=$Q,a2=TQ,a0=AQ,wM=LQ,uM=(e,t,n)=>{const r=new Map,a={platform:eee,...n},o={...a.platform,_c:r};return MQ(e,t,{...a,platform:o})};var ch=typeof document<"u"?g.useLayoutEffect:g.useEffect;function lh(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!lh(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!lh(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function o2(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function i2(e,t){const n=o2(e);return Math.round(t*n)/n}function s2(e){const t=g.useRef(e);return ch(()=>{t.current=e}),t}Yv=function(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:i}={},transform:s=!0,whileElementsMounted:c,open:l}=e,[u,d]=g.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,f]=g.useState(r);lh(p,r)||f(r);const[m,y]=g.useState(null),[v,b]=g.useState(null),w=g.useCallback(R=>{R!==E.current&&(E.current=R,y(R))},[]),_=g.useCallback(R=>{R!==S.current&&(S.current=R,b(R))},[]),x=o||m,j=i||v,E=g.useRef(null),S=g.useRef(null),O=g.useRef(u),N=c!=null,M=s2(c),k=s2(a),A=g.useCallback(()=>{if(!E.current||!S.current)return;const R={placement:t,strategy:n,middleware:p};k.current&&(R.platform=k.current),uM(E.current,S.current,R).then(L=>{const D={...L,isPositioned:!0};P.current&&!lh(O.current,D)&&(O.current=D,Ql.flushSync(()=>{d(D)}))})},[p,t,n,k]);ch(()=>{l===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,d(R=>({...R,isPositioned:!1})))},[l]);const P=g.useRef(!1);ch(()=>(P.current=!0,()=>{P.current=!1}),[]),ch(()=>{if(x&&(E.current=x),j&&(S.current=j),x&&j){if(M.current)return M.current(x,j,A);A()}},[x,j,A,M,N]);const C=g.useMemo(()=>({reference:E,floating:S,setReference:w,setFloating:_}),[w,_]),T=g.useMemo(()=>({reference:x,floating:j}),[x,j]),I=g.useMemo(()=>{const R={position:n,left:0,top:0};if(!T.floating)return R;const L=i2(T.floating,u.x),D=i2(T.floating,u.y);return s?{...R,transform:"translate("+L+"px, "+D+"px)",...o2(T.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:L,top:D}},[n,s,T.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:A,refs:C,elements:T,floatingStyles:I}),[u,A,C,T,I])};let c2;c2=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?a0({element:r.current,padding:a}).fn(n):{}:r?a0({element:r,padding:a}).fn(n):{}}}},Qv=(e,t)=>({...cM(e),options:[e,t]}),e0=(e,t)=>({...bM(e),options:[e,t]}),t0=(e,t)=>({...wM(e),options:[e,t]}),n0=(e,t)=>({...lM(e),options:[e,t]}),Bv=(e,t)=>({...xM(e),options:[e,t]}),y0=(e,t)=>({...a2(e),options:[e,t]}),m0=(e,t)=>({...c2(e),options:[e,t]});var nee="Arrow",l2=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Pe.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});l2.displayName=nee;var ree=l2;function aee(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:p,children:f,...m}=d,y=(p==null?void 0:p[e][c])||s,v=g.useMemo(()=>m,Object.values(m));return h.jsx(y.Provider,{value:v,children:f})}function u(d,p){const f=(p==null?void 0:p[e][c])||s,m=g.useContext(f);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,oee(a,...t)]}function oee(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}jf=function(e){const[t,n]=g.useState(void 0);return ln(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let i,s;if("borderBoxSize"in o){const c=o.borderBoxSize,l=Array.isArray(c)?c[0]:c;i=l.inlineSize,s=l.blockSize}else i=e.offsetWidth,s=e.offsetHeight;n({width:i,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t};var Pb="Popper",[u2,cc]=aee(Pb),[iee,d2]=u2(Pb),p2=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(iee,{scope:t,anchor:r,onAnchorChange:a,children:n})};p2.displayName=Pb;var f2="PopperAnchor",h2=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=d2(f2,n),i=g.useRef(null),s=jt(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Pe.div,{...a,ref:s})});h2.displayName=f2;var Tb="PopperContent",[see,cee]=u2(Tb),m2=g.forwardRef((e,t)=>{var ee,G,K,X,ne,B;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:m,...y}=e,v=d2(Tb,n),[b,w]=g.useState(null),_=jt(t,ue=>w(ue)),[x,j]=g.useState(null),E=jf(x),S=(E==null?void 0:E.width)??0,O=(E==null?void 0:E.height)??0,N=r+(o!=="center"?"-"+o:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},k=Array.isArray(l)?l:[l],A=k.length>0,P={padding:M,boundary:k.filter(uee),altBoundary:A},{refs:C,floatingStyles:T,placement:I,isPositioned:R,middlewareData:L}=Yv({strategy:"fixed",placement:N,whileElementsMounted:(...ue)=>$v(...ue,{animationFrame:f==="always"}),elements:{reference:v.anchor},middleware:[Qv({mainAxis:a+O,alignmentAxis:i}),c&&e0({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?t0():void 0,...P}),c&&n0({...P}),Bv({...P,apply:({elements:ue,rects:ae,availableWidth:de,availableHeight:je})=>{const{width:Le,height:$e}=ae.reference,Ee=ue.floating.style;Ee.setProperty("--radix-popper-available-width",`${de}px`),Ee.setProperty("--radix-popper-available-height",`${je}px`),Ee.setProperty("--radix-popper-anchor-width",`${Le}px`),Ee.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&m0({element:x,padding:s}),dee({arrowWidth:S,arrowHeight:O}),p&&y0({strategy:"referenceHidden",...P})]}),[D,z]=v2(I),U=fr(m);ln(()=>{R&&(U==null||U())},[R,U]);const $=(ee=L.arrow)==null?void 0:ee.x,V=(G=L.arrow)==null?void 0:G.y,F=((K=L.arrow)==null?void 0:K.centerOffset)!==0,[W,re]=g.useState();return ln(()=>{b&&re(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:R?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:W,"--radix-popper-transform-origin":[(X=L.transformOrigin)==null?void 0:X.x,(ne=L.transformOrigin)==null?void 0:ne.y].join(" "),...((B=L.hide)==null?void 0:B.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(see,{scope:n,placedSide:D,onArrowChange:j,arrowX:$,arrowY:V,shouldHideArrow:F,children:h.jsx(Pe.div,{"data-side":D,"data-align":z,...y,ref:_,style:{...y.style,animation:R?void 0:"none"}})})})});m2.displayName=Tb;var y2="PopperArrow",lee={top:"bottom",right:"left",bottom:"top",left:"right"},g2=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=cee(y2,n),o=lee[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(ree,{...r,ref:t,style:{...r.style,display:"block"}})})});g2.displayName=y2;function uee(e){return e!==null}var dee=e=>({name:"transformOrigin",options:e,fn(t){var y,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((y=a.arrow)==null?void 0:y.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=v2(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,p=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let f="",m="";return c==="bottom"?(f=o?u:`${d}px`,m=`${-s}px`):c==="top"?(f=o?u:`${d}px`,m=`${r.floating.height+s}px`):c==="right"?(f=`${-s}px`,m=o?u:`${p}px`):c==="left"&&(f=`${r.floating.width+s}px`,m=o?u:`${p}px`),{data:{x:f,y:m}}}});function v2(e){const[t,n="center"]=e.split("-");return[t,n]}var uh=p2,Ib=h2,Rb=m2,Db=g2,[dh,x3e]=pr("Tooltip",[cc]),ph=cc(),b2="TooltipProvider",pee=700,Lb="tooltip.open",[fee,$b]=dh(b2),w2=e=>{const{__scopeTooltip:t,delayDuration:n=pee,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:o}=e,[i,s]=g.useState(!0),c=g.useRef(!1),l=g.useRef(0);return g.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),h.jsx(fee,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:g.useCallback(u=>{c.current=u},[]),disableHoverableContent:a,children:o})};w2.displayName=b2;var fh="Tooltip",[hee,Pu]=dh(fh),x2=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a=!1,onOpenChange:o,disableHoverableContent:i,delayDuration:s}=e,c=$b(fh,e.__scopeTooltip),l=ph(t),[u,d]=g.useState(null),p=Rt(),f=g.useRef(0),m=i??c.disableHoverableContent,y=s??c.delayDuration,v=g.useRef(!1),[b=!1,w]=In({prop:r,defaultProp:a,onChange:S=>{S?(c.onOpen(),document.dispatchEvent(new CustomEvent(Lb))):c.onClose(),o==null||o(S)}}),_=g.useMemo(()=>b?v.current?"delayed-open":"instant-open":"closed",[b]),x=g.useCallback(()=>{window.clearTimeout(f.current),f.current=0,v.current=!1,w(!0)},[w]),j=g.useCallback(()=>{window.clearTimeout(f.current),f.current=0,w(!1)},[w]),E=g.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{v.current=!0,w(!0),f.current=0},y)},[y,w]);return g.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),h.jsx(uh,{...l,children:h.jsx(hee,{scope:t,contentId:p,open:b,stateAttribute:_,trigger:u,onTriggerChange:d,onTriggerEnter:g.useCallback(()=>{c.isOpenDelayed?E():x()},[c.isOpenDelayed,E,x]),onTriggerLeave:g.useCallback(()=>{m?j():(window.clearTimeout(f.current),f.current=0)},[j,m]),onOpen:x,onClose:j,disableHoverableContent:m,children:n})})};x2.displayName=fh;var Fb="TooltipTrigger",_2=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=Pu(Fb,n),o=$b(Fb,n),i=ph(n),s=g.useRef(null),c=jt(t,s,a.onTriggerChange),l=g.useRef(!1),u=g.useRef(!1),d=g.useCallback(()=>l.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),h.jsx(Ib,{asChild:!0,...i,children:h.jsx(Pe.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:c,onPointerMove:ge(e.onPointerMove,p=>{p.pointerType!=="touch"&&!u.current&&!o.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:ge(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:ge(e.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ge(e.onFocus,()=>{l.current||a.onOpen()}),onBlur:ge(e.onBlur,a.onClose),onClick:ge(e.onClick,a.onClose)})})});_2.displayName=Fb;var Bb="TooltipPortal",[mee,yee]=dh(Bb,{forceMount:void 0}),j2=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:a}=e,o=Pu(Bb,t);return h.jsx(mee,{scope:t,forceMount:n,children:h.jsx(Ur,{present:n||o.open,children:h.jsx(Nv,{asChild:!0,container:a,children:r})})})};j2.displayName=Bb;var lc="TooltipContent",E2=g.forwardRef((e,t)=>{const n=yee(lc,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...o}=e,i=Pu(lc,e.__scopeTooltip);return h.jsx(Ur,{present:r||i.open,children:i.disableHoverableContent?h.jsx(S2,{side:a,...o,ref:t}):h.jsx(gee,{side:a,...o,ref:t})})}),gee=g.forwardRef((e,t)=>{const n=Pu(lc,e.__scopeTooltip),r=$b(lc,e.__scopeTooltip),a=g.useRef(null),o=jt(t,a),[i,s]=g.useState(null),{trigger:c,onClose:l}=n,u=a.current,{onPointerInTransitChange:d}=r,p=g.useCallback(()=>{s(null),d(!1)},[d]),f=g.useCallback((m,y)=>{const v=m.currentTarget,b={x:m.clientX,y:m.clientY},w=xee(b,v.getBoundingClientRect()),_=_ee(b,w),x=jee(y.getBoundingClientRect()),j=See([..._,...x]);s(j),d(!0)},[d]);return g.useEffect(()=>()=>p(),[p]),g.useEffect(()=>{if(c&&u){const m=v=>f(v,u),y=v=>f(v,c);return c.addEventListener("pointerleave",m),u.addEventListener("pointerleave",y),()=>{c.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",y)}}},[c,u,f,p]),g.useEffect(()=>{if(i){const m=y=>{const v=y.target,b={x:y.clientX,y:y.clientY},w=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),_=!Eee(b,i);w?p():_&&(p(),l())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[c,u,i,l,p]),h.jsx(S2,{...e,ref:o})}),[vee,bee]=dh(fh,{isInside:!1}),S2=g.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:o,onPointerDownOutside:i,...s}=e,c=Pu(lc,n),l=ph(n),{onClose:u}=c;return g.useEffect(()=>(document.addEventListener(Lb,u),()=>document.removeEventListener(Lb,u)),[u]),g.useEffect(()=>{if(c.trigger){const d=p=>{var f;(f=p.target)!=null&&f.contains(c.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[c.trigger,u]),h.jsx(Cv,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:h.jsxs(Rb,{"data-state":c.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[h.jsx($G,{children:r}),h.jsx(vee,{scope:n,isInside:!0,children:h.jsx(RDe,{id:c.contentId,role:"tooltip",children:a||r})})]})})});E2.displayName=lc;var O2="TooltipArrow",wee=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=ph(n);return bee(O2,n).isInside?null:h.jsx(Db,{...a,...r,ref:t})});wee.displayName=O2;function xee(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(n,r,a,o)){case o:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function _ee(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function jee(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function Eee(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function See(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),Oee(t)}function Oee(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const o=n[n.length-1],i=n[n.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}OM=w2,CM=x2,fM=_2,rX=j2,Uv=E2;const Tu=OM,Fa=CM,Ba=fM,Qr=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(Uv,{ref:r,sideOffset:t,className:Z("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));Qr.displayName=Uv.displayName;const Cee="sidebar:state",Nee=60*60*24*7,kee="16rem",Mee="18rem",Aee="3rem",Pee="b",C2=g.createContext(null);function Iu(){const e=g.useContext(C2);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const zb=g.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:a,children:o,...i},s)=>{const c=TY(),[l,u]=g.useState(!1),[d,p]=g.useState(e),f=t??d,m=g.useCallback(w=>{const _=typeof w=="function"?w(f):w;n?n(_):p(_),document.cookie=`${Cee}=${_}; path=/; max-age=${Nee}`},[n,f]),y=g.useCallback(()=>c?u(w=>!w):m(w=>!w),[c,m,u]);g.useEffect(()=>{const w=_=>{_.key===Pee&&(_.metaKey||_.ctrlKey)&&(_.preventDefault(),y())};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[y]);const v=f?"expanded":"collapsed",b=g.useMemo(()=>({state:v,open:f,setOpen:m,isMobile:c,openMobile:l,setOpenMobile:u,toggleSidebar:y}),[v,f,m,c,l,u,y]);return h.jsx(C2.Provider,{value:b,children:h.jsx(Tu,{delayDuration:0,children:h.jsx("div",{style:{"--sidebar-width":kee,"--sidebar-width-icon":Aee,...a},className:Z("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:s,...i,children:o})})})});zb.displayName="SidebarProvider";const Ub=g.forwardRef(({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:r,children:a,...o},i)=>{const{isMobile:s,state:c,openMobile:l,setOpenMobile:u}=Iu();return n==="none"?h.jsx("div",{className:Z("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:i,...o,children:a}):s?h.jsx(gQ,{open:l,onOpenChange:u,...o,children:h.jsx(UP,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":Mee},side:e,children:h.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):h.jsxs("div",{ref:i,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?n:"","data-variant":t,"data-side":e,children:[h.jsx("div",{className:Z("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),h.jsx("div",{className:Z("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...o,children:h.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});Ub.displayName="Sidebar";const N2=g.forwardRef(({className:e,onClick:t,...n},r)=>{const{toggleSidebar:a}=Iu();return h.jsx(Ye,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Z("h-7 w-7",e),onClick:o=>{t==null||t(o),a()},...n,children:h.jsx(pe,{size:32,name:"panel-left"})})});N2.displayName="SidebarTrigger";const k2=g.forwardRef(({className:e,...t},n)=>{const{toggleSidebar:r}=Iu();return h.jsx("button",{ref:n,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:Z("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});k2.displayName="SidebarRail";const Vb=g.forwardRef(({className:e,...t},n)=>h.jsx("main",{ref:n,className:Z("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));Vb.displayName="SidebarInset";const Tee=g.forwardRef(({className:e,...t},n)=>h.jsx(Kt,{ref:n,"data-sidebar":"input",className:Z("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));Tee.displayName="SidebarInput";const Iee=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"header",className:Z("flex flex-col gap-2 p-2",e),...t}));Iee.displayName="SidebarHeader";const M2=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"footer",className:Z("flex flex-col gap-2 p-2",e),...t}));M2.displayName="SidebarFooter";const Ree=g.forwardRef(({className:e,...t},n)=>h.jsx(Gs,{ref:n,"data-sidebar":"separator",className:Z("mx-2 w-auto bg-sidebar-border",e),...t}));Ree.displayName="SidebarSeparator";const Wb=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"content",className:Z("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));Wb.displayName="SidebarContent";const Ru=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group",className:Z("relative flex w-full min-w-0 flex-col p-2",e),...t}));Ru.displayName="SidebarGroup";const Du=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?ri:"div";return h.jsx(a,{ref:r,"data-sidebar":"group-label",className:Z("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...n})});Du.displayName="SidebarGroupLabel";const Dee=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?ri:"button";return h.jsx(a,{ref:r,"data-sidebar":"group-action",className:Z("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...n})});Dee.displayName="SidebarGroupAction";const Lee=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group-content",className:Z("w-full text-sm",e),...t}));Lee.displayName="SidebarGroupContent";const uc=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu",className:Z("flex w-full min-w-0 flex-col gap-1",e),...t}));uc.displayName="SidebarMenu";const bo=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,"data-sidebar":"menu-item",className:Z("group/menu-item relative",e),...t}));bo.displayName="SidebarMenuItem";const $ee=uo("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),wo=g.forwardRef(({onClick:e,asChild:t=!1,isActive:n=!1,variant:r="default",size:a="default",tooltip:o,className:i,...s},c)=>{const l=t?ri:"button",{isMobile:u,state:d,toggleSidebar:p}=Iu(),f=h.jsx(l,{ref:c,"data-sidebar":"menu-button","data-size":a,"data-active":n,className:Z($ee({variant:r,size:a}),i),onClick:s!=null&&s.autoHide?m=>{e==null||e(m),p()}:e,...s});return o?(typeof o=="string"&&(o={children:o}),h.jsxs(Fa,{children:[h.jsx(Ba,{asChild:!0,children:f}),h.jsx(Qr,{side:"right",align:"center",hidden:d!=="collapsed"||u,...o})]})):f});wo.displayName="SidebarMenuButton";const Fee=g.forwardRef(({className:e,asChild:t=!1,showOnHover:n=!1,...r},a)=>{const o=t?ri:"button";return h.jsx(o,{ref:a,"data-sidebar":"menu-action",className:Z("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})});Fee.displayName="SidebarMenuAction";const Bee=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"menu-badge",className:Z("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));Bee.displayName="SidebarMenuBadge";const zee=g.forwardRef(({className:e,showIcon:t=!1,...n},r)=>{const a=g.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return h.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:Z("rounded-md h-8 flex gap-2 px-2 items-center",e),...n,children:[t&&h.jsx(VP,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),h.jsx(VP,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});zee.displayName="SidebarMenuSkeleton";const A2=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu-sub",className:Z("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));A2.displayName="SidebarMenuSub";const P2=g.forwardRef(({...e},t)=>h.jsx("li",{ref:t,...e}));P2.displayName="SidebarMenuSubItem";const T2=g.forwardRef(({asChild:e=!1,size:t="md",isActive:n,className:r,...a},o)=>{const i=e?ri:"a";return h.jsx(i,{ref:o,"data-sidebar":"menu-sub-button","data-size":t,"data-active":n,className:Z("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...a})});T2.displayName="SidebarMenuSubButton";const Uee="hash",hh={application:"/application/:applicationId?",whiteboard:"/whiteboard/:sessionId?",document:"/document/:documentId?"},dn=(e,t)=>{let n=hh[e];return t?n=Object.keys(t||{}).reduce((r,a)=>r.replace(`:${a}`,(t==null?void 0:t[a])||""),n):n=n.replace(/\/:[^/]+/g,""),n!=null&&n.endsWith("?")?n.slice(0,-1):n},Vee=()=>{{const[,e]=window.location.hash.split("?");return new URLSearchParams(`?${e}`)}};function Wee({items:e}){const{t}=Me("documents");return h.jsxs(Ru,{children:[h.jsx(Du,{children:h.jsx("div",{className:"text-sm",children:t("title")})}),h.jsx(uc,{children:e.map(n=>{var r;return h.jsx(MY,{asChild:!0,defaultOpen:n.isActive,className:"group/collapsible",children:h.jsxs(bo,{children:[h.jsx(AY,{asChild:!0,children:h.jsxs(wo,{className:"cursor-pointer",tooltip:t(n.title),children:[n.icon,h.jsx("span",{children:t(n.title)}),h.jsx(pe,{name:"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),h.jsx(PY,{children:h.jsx(A2,{children:(r=n.items)==null?void 0:r.map(a=>h.jsx(P2,{className:"cursor-pointer",children:h.jsx(T2,{asChild:!0,children:h.jsx(Q0,{to:dn("document",{documentId:a.id}),children:h.jsx("span",{children:t(a.title)})})})},t(a.title)))})})]})},n.title)})})]})}const Hee=g.memo(({text:e,colors:t={first:"#9E7AFF",second:"#FE8BBB"},className:n,sparklesCount:r=10,...a})=>{const[o,i]=g.useState([]);return g.useEffect(()=>{const s=()=>{const d=`${Math.random()*100}%`,p=`${Math.random()*100}%`,f=Math.random()>.5?t.first:t.second,m=Math.random()*2,y=Math.random()*1+.3,v=Math.random()*10+5;return{id:`${d}-${p}-${Date.now()}`,x:d,y:p,color:f,delay:m,scale:y,lifespan:v}},c=()=>{const d=Array.from({length:r},s);i(d)},l=()=>{i(d=>d.map(p=>p.lifespan<=0?s():{...p,lifespan:p.lifespan-.1}))};c();const u=setInterval(l,100);return()=>clearInterval(u)},[t.first,t.second]),h.jsx("div",{className:Z("text-6xl font-bold",n),...a,style:{"--sparkles-first-color":`${t.first}`,"--sparkles-second-color":`${t.second}`},children:h.jsxs("span",{className:"relative inline-block",children:[o.map(s=>h.jsx(qee,{...s},s.id)),h.jsx("strong",{children:e})]})})},(e,t)=>e.text===t.text),qee=({id:e,x:t,y:n,color:r,delay:a,scale:o})=>h.jsx(mf.svg,{className:"pointer-events-none absolute z-20",initial:{opacity:0,left:t,top:n},animate:{opacity:[0,1,0],scale:[0,o,0],rotate:[75,120,150]},transition:{duration:.8,repeat:1/0,delay:a},width:"21",height:"21",viewBox:"0 0 21 21",children:h.jsx("path",{d:"M9.82531 0.843845C10.0553 0.215178 10.9446 0.215178 11.1746 0.843845L11.8618 2.72026C12.4006 4.19229 12.3916 6.39157 13.5 7.5C14.6084 8.60843 16.8077 8.59935 18.2797 9.13822L20.1561 9.82534C20.7858 10.0553 20.7858 10.9447 20.1561 11.1747L18.2797 11.8618C16.8077 12.4007 14.6084 12.3916 13.5 13.5C12.3916 14.6084 12.4006 16.8077 11.8618 18.2798L11.1746 20.1562C10.9446 20.7858 10.0553 20.7858 9.82531 20.1562L9.13819 18.2798C8.59932 16.8077 8.60843 14.6084 7.5 13.5C6.39157 12.3916 4.19225 12.4007 2.72023 11.8618L0.843814 11.1747C0.215148 10.9447 0.215148 10.0553 0.843814 9.82534L2.72023 9.13822C4.19225 8.59935 6.39157 8.60843 7.5 7.5C8.60843 6.39157 8.59932 4.19229 9.13819 2.72026L9.82531 0.843845Z",fill:r})},e);function Kee({className:e,onClick:t}){const{t:n}=Me("sidebar");return h.jsxs(wo,{className:Z(e,"tw-w-full"),onClick:t,children:[h.jsx(pe,{name:"frame"}),h.jsx(Hee,{text:n("new_session"),className:"text-sm",sparklesCount:3})]})}const Zee=()=>{const[e,t]=g.useState(!1),n=Je(a=>a.createSession),r=g.useCallback(async a=>{try{return t(!0),await n(a)}finally{t(!1)}},[n]);return{loading:e,createSession:r}},hi=ou,Gee=cu,I2=g.forwardRef(({className:e,...t},n)=>h.jsx(Zi,{ref:n,className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));I2.displayName=Zi.displayName;const xo=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(Gee,{children:[h.jsx(I2,{}),h.jsxs(Gi,{ref:r,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,h.jsxs(lu,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(pe,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));xo.displayName=Gi.displayName;const _o=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});_o.displayName="DialogHeader";const Lu=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Lu.displayName="DialogFooter";const jo=g.forwardRef(({className:e,...t},n)=>h.jsx(Ks,{ref:n,className:Z("text-lg font-semibold leading-none tracking-tight",e),...t}));jo.displayName=Ks.displayName;const $u=g.forwardRef(({className:e,...t},n)=>h.jsx(Zs,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));$u.displayName=Zs.displayName;var Xee="Label",R2=g.forwardRef((e,t)=>h.jsx(Pe.label,{...e,ref:t,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=e.onMouseDown)==null||r.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));R2.displayName=Xee;var D2=R2;let L2;L2=uo("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Be=g.forwardRef(({className:e,...t},n)=>h.jsx(D2,{ref:n,className:Z(L2(),e),...t})),Be.displayName=D2.displayName;const Jee=po(()=>{const e=tn(),{t}=Me("dialogs"),[n,r]=g.useState(""),{toast:a}=nn(),{loading:o,createSession:i}=Zee(),s=u=>{r(u.target.value)},c=async()=>{try{const u=await i({name:n});r(""),e.resolve(u.id),e.hide()}catch(u){a({variant:"destructive",description:t("create_session.errors.create_failed")}),e.reject(u)}},l=()=>{r(""),e.resolve(void 0),e.hide()};return h.jsx(hi,{open:e.visible,onOpenChange:l,children:h.jsxs(xo,{className:"sm:max-w-[425px]",children:[h.jsxs(_o,{children:[h.jsx(jo,{children:t("create_session.title")}),h.jsx($u,{children:t("create_session.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(Be,{className:"mb-2",htmlFor:"name",children:t("create_session.name")}),h.jsx(Kt,{onChange:s,id:"name",value:n,placeholder:t("create_session.name_placeholder")})]})}),h.jsx(Lu,{children:h.jsx(Ye,{onClick:c,disabled:o||!n,type:"submit",children:t("create_session.create")})})]})})}),Yee=()=>{const[e,t]=g.useState(!1),n=Je(a=>a.deleteSession),r=g.useCallback(async a=>{try{t(!0),await n(a),await Promise.all([le("FlowEdge").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>le("FlowEdge").delete(i.id)))),le("FlowNode").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>le("FlowNode").delete(i.id))))])}finally{t(!1)}},[n]);return{loading:e,deleteSession:r}};var $2="AlertDialog",[Qee,_3e]=pr($2,[mb]),Eo=mb(),F2=e=>{const{__scopeAlertDialog:t,...n}=e,r=Eo(t);return h.jsx(ou,{...r,...n,modal:!0})};F2.displayName=$2;var ete="AlertDialogTrigger",tte=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Eo(n);return h.jsx(BP,{...a,...r,ref:t})});tte.displayName=ete;var nte="AlertDialogPortal",B2=e=>{const{__scopeAlertDialog:t,...n}=e,r=Eo(t);return h.jsx(cu,{...r,...n})};B2.displayName=nte;var rte="AlertDialogOverlay",z2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Eo(n);return h.jsx(Zi,{...a,...r,ref:t})});z2.displayName=rte;var dc="AlertDialogContent",[ate,ote]=Qee(dc),U2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,o=Eo(n),i=g.useRef(null),s=jt(t,i),c=g.useRef(null);return h.jsx(DP,{contentName:dc,titleName:V2,docsSlug:"alert-dialog",children:h.jsx(ate,{scope:n,cancelRef:c,children:h.jsxs(Gi,{role:"alertdialog",...o,...a,ref:s,onOpenAutoFocus:ge(a.onOpenAutoFocus,l=>{var u;l.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[h.jsx($G,{children:r}),h.jsx(X2,{contentRef:i})]})})})});U2.displayName=dc;var V2="AlertDialogTitle",W2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Eo(n);return h.jsx(Ks,{...a,...r,ref:t})});W2.displayName=V2;var H2="AlertDialogDescription",q2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Eo(n);return h.jsx(Zs,{...a,...r,ref:t})});q2.displayName=H2;var ite="AlertDialogAction",K2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Eo(n);return h.jsx(lu,{...a,...r,ref:t})});K2.displayName=ite;var Z2="AlertDialogCancel",G2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=ote(Z2,n),o=Eo(n),i=jt(t,a);return h.jsx(lu,{...o,...r,ref:i})});G2.displayName=Z2;let X2;X2=({contentRef:e})=>{const t=`\`${dc}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${dc}\` by passing a \`${H2}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${dc}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return g.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},gM=F2,yM=B2,qv=z2,Kv=U2,Xv=K2,Jv=G2,Zv=W2,Gv=q2;const J2=gM,ste=yM,Y2=g.forwardRef(({className:e,...t},n)=>h.jsx(qv,{className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));Y2.displayName=qv.displayName;const Hb=g.forwardRef(({className:e,...t},n)=>h.jsxs(ste,{children:[h.jsx(Y2,{}),h.jsx(Kv,{ref:n,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Hb.displayName=Kv.displayName;const qb=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col space-y-2 text-center sm:text-left",e),...t});qb.displayName="AlertDialogHeader";const Kb=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Kb.displayName="AlertDialogFooter";const Zb=g.forwardRef(({className:e,...t},n)=>h.jsx(Zv,{ref:n,className:Z("text-lg font-semibold",e),...t}));Zb.displayName=Zv.displayName;const Gb=g.forwardRef(({className:e,...t},n)=>h.jsx(Gv,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));Gb.displayName=Gv.displayName;const Xb=g.forwardRef(({className:e,...t},n)=>h.jsx(Xv,{ref:n,className:Z(Ou(),e),...t}));Xb.displayName=Xv.displayName;const Jb=g.forwardRef(({className:e,...t},n)=>h.jsx(Jv,{ref:n,className:Z(Ou({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Jb.displayName=Jv.displayName;const Q2=po(({id:e})=>{const{t}=Me("dialogs"),n=tn(),{toast:r}=nn(),{deleteSession:a,loading:o}=Yee(),i=async()=>{try{await a(e),n.hide()}catch{r({variant:"destructive",description:t("delete_session.errors.delete_failed")})}};return h.jsx(J2,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(Hb,{children:[h.jsxs(qb,{children:[h.jsx(Zb,{children:t("delete_session.title")}),h.jsx(Gb,{children:t("delete_session.description")})]}),h.jsxs(Kb,{children:[h.jsx(Jb,{onClick:n.hide,children:t("delete_session.cancel")}),h.jsx(Xb,{disabled:o,onClick:i,children:t("delete_session.delete")})]})]})})});function cte({sessions:e,currentSession:t,setCurrentSession:n}){const{t:r}=Me("sidebar"),a=es(),{sessionId:o}=Ff(),[i,s]=g.useState(),c=tn(Jee),l=tn(Q2),u=g.useCallback(async()=>{try{const f=await c.show({});f&&typeof f=="string"&&a(dn("whiteboard",{sessionId:f}))}catch{}},[c,a]),d=g.useCallback((f,m)=>{f.preventDefault(),f.stopPropagation(),l.show({id:m})},[l]),p=async f=>{try{s(f.id),await n(f),a(dn("whiteboard",{sessionId:f.id}))}catch(m){Hs(m),s(void 0)}};return g.useEffect(()=>{!i||i!==(t==null?void 0:t.id)||s(void 0)},[i,t==null?void 0:t.id]),h.jsxs(Ru,{className:"group-data-[collapsible=icon]:hidden",children:[h.jsx(Du,{children:h.jsx("div",{className:"text-sm",children:r("sessions")})}),h.jsxs(uc,{children:[h.jsx(bo,{children:h.jsx(Kee,{onClick:u,className:"w-full"})}),e.map(f=>h.jsx(bo,{className:"cursor-pointer",children:h.jsx(wo,{autoHide:!0,disabled:!!i,asChild:!0,onClick:()=>p(f),children:h.jsxs("div",{className:"flex flex-row justify-between items-center",children:[h.jsxs("div",{className:"flex gap-2",children:[f.id===i?h.jsx(pe,{size:16,name:"loader",className:"animate-spin"}):o===f.id?h.jsx(pe,{size:16,color:"green",name:"check"}):h.jsx(pe,{size:16,name:"chevron-right"}),h.jsx("span",{children:f.name})]}),h.jsx(pe,{onClick:m=>d(m,f.id),size:16,name:"trash-2",className:"!z-50"})]})})},f.id)),e!=null&&e.length?h.jsx(bo,{children:h.jsxs(wo,{className:"text-sidebar-foreground/70",children:[h.jsx(pe,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}var lte=g.createContext(void 0);oi=function(e){const t=g.useContext(lte);return e||t||"ltr"};function ute(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:p,children:f,...m}=d,y=(p==null?void 0:p[e][c])||s,v=g.useMemo(()=>m,Object.values(m));return h.jsx(y.Provider,{value:v,children:f})}function u(d,p){const f=(p==null?void 0:p[e][c])||s,m=g.useContext(f);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,dte(a,...t)]}function dte(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}let mh,eT,Fu,yh,Yb,tT,nT,rT,aT,Qb;mh="rovingFocusGroup.onEntryFocus",eT={bubbles:!1,cancelable:!0},Fu="RovingFocusGroup",[yh,Yb,tT]=yf(Fu),[nT,fo]=ute(Fu,[tT]),[rT,aT]=nT(Fu),Qb=g.forwardRef((e,t)=>h.jsx(yh.Provider,{scope:e.__scopeRovingFocusGroup,children:h.jsx(yh.Slot,{scope:e.__scopeRovingFocusGroup,children:h.jsx(pte,{...e,ref:t})})})),Qb.displayName=Fu;var pte=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=e,p=g.useRef(null),f=jt(t,p),m=oi(o),[y=null,v]=In({prop:i,defaultProp:s,onChange:c}),[b,w]=g.useState(!1),_=fr(l),x=Yb(n),j=g.useRef(!1),[E,S]=g.useState(0);return g.useEffect(()=>{const O=p.current;if(O)return O.addEventListener(mh,_),()=>O.removeEventListener(mh,_)},[_]),h.jsx(rT,{scope:n,orientation:r,dir:m,loop:a,currentTabStopId:y,onItemFocus:g.useCallback(O=>v(O),[v]),onItemShiftTab:g.useCallback(()=>w(!0),[]),onFocusableItemAdd:g.useCallback(()=>S(O=>O+1),[]),onFocusableItemRemove:g.useCallback(()=>S(O=>O-1),[]),children:h.jsx(Pe.div,{tabIndex:b||E===0?-1:0,"data-orientation":r,...d,ref:f,style:{outline:"none",...e.style},onMouseDown:ge(e.onMouseDown,()=>{j.current=!0}),onFocus:ge(e.onFocus,O=>{const N=!j.current;if(O.target===O.currentTarget&&N&&!b){const M=new CustomEvent(mh,eT);if(O.currentTarget.dispatchEvent(M),!M.defaultPrevented){const k=x().filter(T=>T.focusable),A=k.find(T=>T.active),P=k.find(T=>T.id===y),C=[A,P,...k].filter(Boolean).map(T=>T.ref.current);sT(C,u)}}j.current=!1}),onBlur:ge(e.onBlur,()=>w(!1))})})}),oT="RovingFocusGroupItem",iT=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,...i}=e,s=Rt(),c=o||s,l=aT(oT,n),u=l.currentTabStopId===c,d=Yb(n),{onFocusableItemAdd:p,onFocusableItemRemove:f}=l;return g.useEffect(()=>{if(r)return p(),()=>f()},[r,p,f]),h.jsx(yh.ItemSlot,{scope:n,id:c,focusable:r,active:a,children:h.jsx(Pe.span,{tabIndex:u?0:-1,"data-orientation":l.orientation,...i,ref:t,onMouseDown:ge(e.onMouseDown,m=>{r?l.onItemFocus(c):m.preventDefault()}),onFocus:ge(e.onFocus,()=>l.onItemFocus(c)),onKeyDown:ge(e.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){l.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const y=mte(m,l.orientation,l.dir);if(y!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let v=d().filter(b=>b.focusable).map(b=>b.ref.current);if(y==="last")v.reverse();else if(y==="prev"||y==="next"){y==="prev"&&v.reverse();const b=v.indexOf(m.currentTarget);v=l.loop?yte(v,b+1):v.slice(b+1)}setTimeout(()=>sT(v))}})})})});iT.displayName=oT;var fte={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function hte(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function mte(e,t,n){const r=hte(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return fte[r]}function sT(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function yte(e,t){return e.map((n,r)=>e[(t+r)%e.length])}let gh,cT,ew,lT,uT,dT,pc,fc,pT,fT,mi,vh,hc,tw,nw,So,hT,mc,rw;uu=Qb,du=iT,gh=["Enter"," "],cT=["ArrowDown","PageUp","Home"],ew=["ArrowUp","PageDown","End"],lT=[...cT,...ew],uT={ltr:[...gh,"ArrowRight"],rtl:[...gh,"ArrowLeft"]},dT={ltr:["ArrowLeft"],rtl:["ArrowRight"]},pc="Menu",[fc,pT,fT]=yf(pc),[mi,vh]=pr(pc,[fT,cc,fo]),hc=cc(),tw=fo(),[nw,So]=mi(pc),[hT,mc]=mi(pc),rw=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:o,modal:i=!0}=e,s=hc(t),[c,l]=g.useState(null),u=g.useRef(!1),d=fr(o),p=oi(a);return g.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),h.jsx(uh,{...s,children:h.jsx(nw,{scope:t,open:n,onOpenChange:d,content:c,onContentChange:l,children:h.jsx(hT,{scope:t,onClose:g.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:p,modal:i,children:r})})})},rw.displayName=pc;var gte="MenuAnchor",aw=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=hc(n);return h.jsx(Ib,{...a,...r,ref:t})});aw.displayName=gte;var ow="MenuPortal",[vte,mT]=mi(ow,{forceMount:void 0}),yT=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,o=So(ow,t);return h.jsx(vte,{scope:t,forceMount:n,children:h.jsx(Ur,{present:n||o.open,children:h.jsx(Nv,{asChild:!0,container:a,children:r})})})};yT.displayName=ow;var Ar="MenuContent",[bte,iw]=mi(Ar),gT=g.forwardRef((e,t)=>{const n=mT(Ar,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=So(Ar,e.__scopeMenu),i=mc(Ar,e.__scopeMenu);return h.jsx(fc.Provider,{scope:e.__scopeMenu,children:h.jsx(Ur,{present:r||o.open,children:h.jsx(fc.Slot,{scope:e.__scopeMenu,children:i.modal?h.jsx(wte,{...a,ref:t}):h.jsx(xte,{...a,ref:t})})})})}),wte=g.forwardRef((e,t)=>{const n=So(Ar,e.__scopeMenu),r=g.useRef(null),a=jt(t,r);return g.useEffect(()=>{const o=r.current;if(o)return fu(o)},[]),h.jsx(sw,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),xte=g.forwardRef((e,t)=>{const n=So(Ar,e.__scopeMenu);return h.jsx(sw,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),sw=g.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:p,onDismiss:f,disableOutsideScroll:m,...y}=e,v=So(Ar,n),b=mc(Ar,n),w=hc(n),_=tw(n),x=pT(n),[j,E]=g.useState(null),S=g.useRef(null),O=jt(t,S,v.onContentChange),N=g.useRef(0),M=g.useRef(""),k=g.useRef(0),A=g.useRef(null),P=g.useRef("right"),C=g.useRef(0),T=m?Yf:g.Fragment,I=m?{as:ri,allowPinchZoom:!0}:void 0,R=D=>{var ee,G;const z=M.current+D,U=x().filter(K=>!K.disabled),$=document.activeElement,V=(ee=U.find(K=>K.ref.current===$))==null?void 0:ee.textValue,F=U.map(K=>K.textValue),W=Tte(F,z,V),re=(G=U.find(K=>K.textValue===W))==null?void 0:G.ref.current;(function K(X){M.current=X,window.clearTimeout(N.current),X!==""&&(N.current=window.setTimeout(()=>K(""),1e3))})(z),re&&setTimeout(()=>re.focus())};g.useEffect(()=>()=>window.clearTimeout(N.current),[]),hu();const L=g.useCallback(D=>{var z,U;return P.current===((z=A.current)==null?void 0:z.side)&&Rte(D,(U=A.current)==null?void 0:U.area)},[]);return h.jsx(bte,{scope:n,searchRef:M,onItemEnter:g.useCallback(D=>{L(D)&&D.preventDefault()},[L]),onItemLeave:g.useCallback(D=>{var z;L(D)||((z=S.current)==null||z.focus(),E(null))},[L]),onTriggerLeave:g.useCallback(D=>{L(D)&&D.preventDefault()},[L]),pointerGraceTimerRef:k,onPointerGraceIntentChange:g.useCallback(D=>{A.current=D},[]),children:h.jsx(T,{...I,children:h.jsx(Wf,{asChild:!0,trapped:a,onMountAutoFocus:ge(o,D=>{var z;D.preventDefault(),(z=S.current)==null||z.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:h.jsx(Cv,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:p,onDismiss:f,children:h.jsx(uu,{asChild:!0,..._,dir:b.dir,orientation:"vertical",loop:r,currentTabStopId:j,onCurrentTabStopIdChange:E,onEntryFocus:ge(c,D=>{b.isUsingKeyboardRef.current||D.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(Rb,{role:"menu","aria-orientation":"vertical","data-state":RT(v.open),"data-radix-menu-content":"",dir:b.dir,...w,...y,ref:O,style:{outline:"none",...y.style},onKeyDown:ge(y.onKeyDown,D=>{const z=D.target.closest("[data-radix-menu-content]")===D.currentTarget,U=D.ctrlKey||D.altKey||D.metaKey,$=D.key.length===1;z&&(D.key==="Tab"&&D.preventDefault(),!U&&$&&R(D.key));const V=S.current;if(D.target!==V||!lT.includes(D.key))return;D.preventDefault();const F=x().filter(W=>!W.disabled).map(W=>W.ref.current);ew.includes(D.key)&&F.reverse(),Ate(F)}),onBlur:ge(e.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(N.current),M.current="")}),onPointerMove:ge(e.onPointerMove,zu(D=>{const z=D.target,U=C.current!==D.clientX;if(D.currentTarget.contains(z)&&U){const $=D.clientX>C.current?"right":"left";P.current=$,C.current=D.clientX}}))})})})})})})});gT.displayName=Ar;var _te="MenuGroup",cw=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Pe.div,{role:"group",...r,ref:t})});cw.displayName=_te;var jte="MenuLabel",vT=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Pe.div,{...r,ref:t})});vT.displayName=jte;var bh="MenuItem",bT="menu.itemSelect",wh=g.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,o=g.useRef(null),i=mc(bh,e.__scopeMenu),s=iw(bh,e.__scopeMenu),c=jt(t,o),l=g.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const p=new CustomEvent(bT,{bubbles:!0,cancelable:!0});d.addEventListener(bT,f=>r==null?void 0:r(f),{once:!0}),DDe(d,p),p.defaultPrevented?l.current=!1:i.onClose()}};return h.jsx(wT,{...a,ref:c,disabled:n,onClick:ge(e.onClick,u),onPointerDown:d=>{var p;(p=e.onPointerDown)==null||p.call(e,d),l.current=!0},onPointerUp:ge(e.onPointerUp,d=>{var p;l.current||((p=d.currentTarget)==null||p.click())}),onKeyDown:ge(e.onKeyDown,d=>{const p=s.searchRef.current!=="";n||p&&d.key===" "||gh.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});wh.displayName=bh;var wT=g.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...o}=e,i=iw(bh,n),s=tw(n),c=g.useRef(null),l=jt(t,c),[u,d]=g.useState(!1),[p,f]=g.useState("");return g.useEffect(()=>{const m=c.current;m&&f((m.textContent??"").trim())},[o.children]),h.jsx(fc.ItemSlot,{scope:n,disabled:r,textValue:a??p,children:h.jsx(du,{asChild:!0,...s,focusable:!r,children:h.jsx(Pe.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:l,onPointerMove:ge(e.onPointerMove,zu(m=>{r?i.onItemLeave(m):(i.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ge(e.onPointerLeave,zu(m=>i.onItemLeave(m))),onFocus:ge(e.onFocus,()=>d(!0)),onBlur:ge(e.onBlur,()=>d(!1))})})})}),Ete="MenuCheckboxItem",xT=g.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return h.jsx(OT,{scope:e.__scopeMenu,checked:n,children:h.jsx(wh,{role:"menuitemcheckbox","aria-checked":xh(n)?"mixed":n,...a,ref:t,"data-state":dw(n),onSelect:ge(a.onSelect,()=>r==null?void 0:r(xh(n)?!0:!n),{checkForDefaultPrevented:!1})})})});xT.displayName=Ete;var _T="MenuRadioGroup",[Ste,Ote]=mi(_T,{value:void 0,onValueChange:()=>{}}),jT=g.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,o=fr(r);return h.jsx(Ste,{scope:e.__scopeMenu,value:n,onValueChange:o,children:h.jsx(cw,{...a,ref:t})})});jT.displayName=_T;var ET="MenuRadioItem",ST=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=Ote(ET,e.__scopeMenu),o=n===a.value;return h.jsx(OT,{scope:e.__scopeMenu,checked:o,children:h.jsx(wh,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":dw(o),onSelect:ge(r.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,n)},{checkForDefaultPrevented:!1})})})});ST.displayName=ET;var lw="MenuItemIndicator",[OT,Cte]=mi(lw,{checked:!1}),CT=g.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,o=Cte(lw,n);return h.jsx(Ur,{present:r||xh(o.checked)||o.checked===!0,children:h.jsx(Pe.span,{...a,ref:t,"data-state":dw(o.checked)})})});CT.displayName=lw;var Nte="MenuSeparator",NT=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Pe.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});NT.displayName=Nte;var kte="MenuArrow",kT=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=hc(n);return h.jsx(Db,{...a,...r,ref:t})});kT.displayName=kte;var uw="MenuSub",[Mte,MT]=mi(uw),AT=e=>{const{__scopeMenu:t,children:n,open:r=!1,onOpenChange:a}=e,o=So(uw,t),i=hc(t),[s,c]=g.useState(null),[l,u]=g.useState(null),d=fr(a);return g.useEffect(()=>(o.open===!1&&d(!1),()=>d(!1)),[o.open,d]),h.jsx(uh,{...i,children:h.jsx(nw,{scope:t,open:r,onOpenChange:d,content:l,onContentChange:u,children:h.jsx(Mte,{scope:t,contentId:Rt(),triggerId:Rt(),trigger:s,onTriggerChange:c,children:n})})})};AT.displayName=uw;var Bu="MenuSubTrigger",PT=g.forwardRef((e,t)=>{const n=So(Bu,e.__scopeMenu),r=mc(Bu,e.__scopeMenu),a=MT(Bu,e.__scopeMenu),o=iw(Bu,e.__scopeMenu),i=g.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:c}=o,l={__scopeMenu:e.__scopeMenu},u=g.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return g.useEffect(()=>u,[u]),g.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),c(null)}},[s,c]),h.jsx(aw,{asChild:!0,...l,children:h.jsx(wT,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":RT(n.open),...e,ref:FG(t,a.onTriggerChange),onClick:d=>{var p;(p=e.onClick)==null||p.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ge(e.onPointerMove,zu(d=>{o.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ge(e.onPointerLeave,zu(d=>{var f,m;u();const p=(f=n.content)==null?void 0:f.getBoundingClientRect();if(p){const y=(m=n.content)==null?void 0:m.dataset.side,v=y==="right",b=v?-5:5,w=p[v?"left":"right"],_=p[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+b,y:d.clientY},{x:w,y:p.top},{x:_,y:p.top},{x:_,y:p.bottom},{x:w,y:p.bottom}],side:y}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:ge(e.onKeyDown,d=>{var f;const p=o.searchRef.current!=="";e.disabled||p&&d.key===" "||uT[r.dir].includes(d.key)&&(n.onOpenChange(!0),(f=n.content)==null||f.focus(),d.preventDefault())})})})});PT.displayName=Bu;var TT="MenuSubContent",IT=g.forwardRef((e,t)=>{const n=mT(Ar,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=So(Ar,e.__scopeMenu),i=mc(Ar,e.__scopeMenu),s=MT(TT,e.__scopeMenu),c=g.useRef(null),l=jt(t,c);return h.jsx(fc.Provider,{scope:e.__scopeMenu,children:h.jsx(Ur,{present:r||o.open,children:h.jsx(fc.Slot,{scope:e.__scopeMenu,children:h.jsx(sw,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:l,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;i.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ge(e.onFocusOutside,u=>{u.target!==s.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:ge(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:ge(e.onKeyDown,u=>{var f;const d=u.currentTarget.contains(u.target),p=dT[i.dir].includes(u.key);d&&p&&(o.onOpenChange(!1),(f=s.trigger)==null||f.focus(),u.preventDefault())})})})})})});IT.displayName=TT;function RT(e){return e?"open":"closed"}function xh(e){return e==="indeterminate"}function dw(e){return xh(e)?"indeterminate":e?"checked":"unchecked"}function Ate(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Pte(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function Tte(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=Pte(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function Ite(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function Rte(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Ite(n,t)}function zu(e){return t=>t.pointerType==="mouse"?e(t):void 0}var DT=rw,LT=aw,$T=yT,FT=gT,BT=cw,zT=vT,UT=wh,VT=xT,WT=jT,HT=ST,qT=CT,KT=NT,ZT=kT,Dte=AT,GT=PT,XT=IT,pw="DropdownMenu",[Lte,j3e]=pr(pw,[vh]),Dn=vh(),[$te,JT]=Lte(pw),YT=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:o,onOpenChange:i,modal:s=!0}=e,c=Dn(t),l=g.useRef(null),[u=!1,d]=In({prop:a,defaultProp:o,onChange:i});return h.jsx($te,{scope:t,triggerId:Rt(),triggerRef:l,contentId:Rt(),open:u,onOpenChange:d,onOpenToggle:g.useCallback(()=>d(p=>!p),[d]),modal:s,children:h.jsx(DT,{...c,open:u,onOpenChange:d,dir:r,modal:s,children:n})})};YT.displayName=pw;var QT="DropdownMenuTrigger",eI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,o=JT(QT,n),i=Dn(n);return h.jsx(LT,{asChild:!0,...i,children:h.jsx(Pe.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:FG(t,o.triggerRef),onPointerDown:ge(e.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(o.onOpenToggle(),o.open||s.preventDefault())}),onKeyDown:ge(e.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&o.onOpenToggle(),s.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});eI.displayName=QT;var Fte="DropdownMenuPortal",tI=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Dn(t);return h.jsx($T,{...r,...n})};tI.displayName=Fte;var nI="DropdownMenuContent",rI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=JT(nI,n),o=Dn(n),i=g.useRef(!1);return h.jsx(FT,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...r,ref:t,onCloseAutoFocus:ge(e.onCloseAutoFocus,s=>{var c;i.current||((c=a.triggerRef.current)==null||c.focus()),i.current=!1,s.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,s=>{const c=s.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!a.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});rI.displayName=nI;var Bte="DropdownMenuGroup",aI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(BT,{...a,...r,ref:t})});aI.displayName=Bte;var zte="DropdownMenuLabel",oI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(zT,{...a,...r,ref:t})});oI.displayName=zte;var Ute="DropdownMenuItem",iI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(UT,{...a,...r,ref:t})});iI.displayName=Ute;var Vte="DropdownMenuCheckboxItem",sI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(VT,{...a,...r,ref:t})});sI.displayName=Vte;var Wte="DropdownMenuRadioGroup",cI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(WT,{...a,...r,ref:t})});cI.displayName=Wte;var Hte="DropdownMenuRadioItem",lI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(HT,{...a,...r,ref:t})});lI.displayName=Hte;var qte="DropdownMenuItemIndicator",uI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(qT,{...a,...r,ref:t})});uI.displayName=qte;var Kte="DropdownMenuSeparator",dI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(KT,{...a,...r,ref:t})});dI.displayName=Kte;var Zte="DropdownMenuArrow",Gte=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(ZT,{...a,...r,ref:t})});Gte.displayName=Zte;var Xte=e=>{const{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:a,defaultOpen:o}=e,i=Dn(t),[s=!1,c]=In({prop:r,defaultProp:o,onChange:a});return h.jsx(Dte,{...i,open:s,onOpenChange:c,children:n})},Jte="DropdownMenuSubTrigger",pI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(GT,{...a,...r,ref:t})});pI.displayName=Jte;var Yte="DropdownMenuSubContent",fI=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(XT,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});fI.displayName=Yte,EM=YT,SM=eI,jM=tI,o0=rI,_M=aI,p0=oI,c0=iI,l0=sI,sX=cI,d0=lI,u0=uI,f0=dI,cX=Xte,i0=pI,s0=fI;const Qte=EM,ene=SM,tne=_M,nne=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(i0,{ref:a,className:Z("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r,children:[n,h.jsx(pe,{name:"chevron-right",className:"ml-auto"})]}));nne.displayName=i0.displayName;const rne=g.forwardRef(({className:e,...t},n)=>h.jsx(s0,{ref:n,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));rne.displayName=s0.displayName;const hI=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(jM,{children:h.jsx(o0,{ref:r,sideOffset:t,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));hI.displayName=o0.displayName;const mI=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(c0,{ref:r,className:Z("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n}));mI.displayName=c0.displayName;const ane=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(l0,{ref:a,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(u0,{children:h.jsx(pe,{name:"check",className:"h-4 w-4"})})}),t]}));ane.displayName=l0.displayName;const one=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(d0,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(u0,{children:h.jsx(pe,{name:"circle",className:"h-4 w-4"})})}),t]}));one.displayName=d0.displayName;const ine=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(p0,{ref:r,className:Z("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));ine.displayName=p0.displayName;const sne=g.forwardRef(({className:e,...t},n)=>h.jsx(f0,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));sne.displayName=f0.displayName;function cne(){const{t:e}=Me("sidebar"),{isMobile:t}=Iu();return h.jsx(uc,{children:h.jsx(bo,{children:h.jsxs(Qte,{children:[h.jsx(ene,{asChild:!0,children:h.jsxs(wo,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[h.jsx("div",{children:h.jsx(pe,{name:"settings",size:28,className:"pr-2"})}),h.jsx(pe,{name:"chevrons-up-down",className:"ml-auto size-4"})]})}),h.jsx(hI,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:t?"bottom":"right",align:"end",sideOffset:4,children:h.jsx(tne,{children:h.jsxs(mI,{children:[h.jsx(pe,{name:"sparkles"}),e("contact")]})})})]})})})}function lne({applications:e,currentSession:t,setCurrentSession:n}){const{t:r}=Me("sidebar"),a=es(),{applicationId:o}=Ff(),[i,s]=g.useState(),c=tn(Q2),l=g.useCallback((p,f)=>{p.preventDefault(),p.stopPropagation(),c.show({id:f})},[c]),u=async p=>{try{s(p.id),n(p),a(dn("application",{applicationId:p.id}))}catch(f){console.error(f),s(void 0)}},d=p=>{switch(p.main_source_type){case"Thread":return h.jsx(pe,{className:"inline-flex items-center ml-2",name:"message-circle-more",size:14});default:return null}};return g.useEffect(()=>{!i||i!==(t==null?void 0:t.id)||s(void 0)},[i,t==null?void 0:t.id]),h.jsxs(Ru,{className:"group-data-[collapsible=icon]:hidden pt-0",children:[h.jsx(Du,{children:h.jsx("div",{className:"text-sm",children:r("applications")})}),h.jsxs(uc,{children:[e==null?void 0:e.map(p=>h.jsx(bo,{className:"cursor-pointer",children:h.jsx(wo,{disabled:!!i,asChild:!0,autoHide:!0,onClick:()=>u(p),children:h.jsxs("div",{className:"flex flex-row justify-between items-center !h-auto",children:[h.jsxs("div",{className:"flex gap-2",children:[p.id===i?h.jsx(pe,{size:16,name:"loader",className:"animate-spin"}):o===p.id?h.jsx(pe,{size:16,color:"green",name:"check"}):h.jsx(pe,{size:16,name:"chevron-right"}),h.jsxs("span",{children:[p.name,d(p)]})]}),h.jsx(pe,{onClick:f=>l(f,p.id),size:16,className:"!z-50",name:"trash-2"})]})})},p.id)),e?h.jsx(bo,{children:h.jsxs(wo,{className:"text-sidebar-foreground/70",children:[h.jsx(pe,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}const une={navMain:[{title:"playground.title",icon:h.jsx(pe,{name:"square-terminal"}),isActive:!0,items:[{title:"playground.nodes",id:"nodes"},{title:"playground.connections",id:"connections"}]},{title:"model.title",url:"#",icon:h.jsx(pe,{name:"bot"}),items:[{title:"model.llm",id:"llm"},{title:"model.embedding",id:"embedding"}]},{title:"tutorial.title",icon:h.jsx(pe,{name:"book-open"}),items:[{title:"tutorial.get_started",id:"get-started"},{title:"tutorial.simple_workflow",id:"simple-workflow"},{title:"tutorial.ai_structured_output",id:"ai-structured-output"},{title:"tutorial.standalone_chat_application",id:"chat-application"},{title:"tutorial.standalone_editor_application",id:"editor-application"},{title:"tutorial.tool_calling",id:"tool-calling"},{title:"tutorial.vector_database",id:"vector-database"}]},{title:"application.title",icon:h.jsx(pe,{name:"settings-2"}),items:[{title:"application.chat",id:"chat"},{title:"application.editor",id:"editor"},{title:"application.vslite",id:"vslite"}]}]};function dne({sessions:e,applications:t,currentSession:n,setCurrentSession:r,...a}){return h.jsxs(Ub,{collapsible:"offcanvas",...a,children:[h.jsx("div",{className:"h-1"}),h.jsxs(Wb,{children:[h.jsx(cte,{sessions:e||[],currentSession:n,setCurrentSession:r}),h.jsx(lne,{applications:t||[],currentSession:n,setCurrentSession:r}),h.jsx(Wee,{items:une.navMain})]}),h.jsx(M2,{children:h.jsx(cne,{})}),h.jsx(k2,{})]})}Qn=g.memo(e=>{const{loading:t,...n}=e;return h.jsx(Ye,{...n,disabled:e.disabled||t,children:t?h.jsx(pe,{name:"loader-circle",className:"animate-spin"}):e.children})});function pne({className:e,onProcess:t=async()=>(await new Promise(a=>setTimeout(a,2e3)),Math.random()>.5),processDuration:n=2e3,...r}){const[a,o]=g.useState(!1),[i,s]=g.useState(null),[c,l]=g.useState(!1),[,u]=g.useState(0);g.useEffect(()=>{if(a){const p=Date.now(),f=setInterval(()=>{const m=(Date.now()-p)/n*100;m>=100?(clearInterval(f),u(100)):u(m)},10);return()=>clearInterval(f)}},[a,n]);async function d(){if(a)return;o(!0),s(null),u(0),await new Promise(f=>setTimeout(f,n));const p=t?await t():!0;s(p),o(!1),l(!0),setTimeout(()=>{s(null),u(0),l(!1)},2e3)}return h.jsx(Ye,{className:Z("relative group","transition-all duration-300",a&&"cursor-wait",e),variant:"ghost",onClick:d,disabled:a,...r,children:h.jsx("div",{className:Z("w-full flex items-center justify-center gap-2",c&&"animate-[scale_300ms_ease-in-out]"),children:i===null?h.jsx(h.Fragment,{children:h.jsx(pe,{name:"forward",className:Z("w-4 h-4 transition-transform duration-200","group-hover:scale-110",a&&"animate-bounce")})}):i?h.jsx(h.Fragment,{children:h.jsx(pe,{name:"check",className:"w-4 h-4 text-green-500"})}):h.jsx(h.Fragment,{children:h.jsx(pe,{name:"x",className:"w-4 h-4 text-red-500"})})})})}const za="NOLLM",fne="0123456789abcdef",hne=[8,4,4,4,12];function Uu(){return hne.map(e=>LDe(fne,e)()).join("-")}const mne=()=>{const e=Je(t=>t.currentSession);return{exportSession:g.useCallback(async()=>{if(!(e!=null&&e.id))return;const t={},n={},r=Object.keys(BG).filter(c=>c!=="Session");await Promise.all(r.map(c=>le(c).find({where:{session_id:e.id}}).then(l=>{l.map(u=>{n[u.id]=u.id}),t[c]=l}))),Object.keys(n).forEach(c=>{n[c]=`[ID_${Uu()}]`});let a=JSON.stringify({[za]:{key:e.id,session:Object.entries(e).reduce((c,[l,u])=>((typeof u!="object"||u===null)&&(c[l]=u),u===void 0&&(c[l]=null),c),{}),ids:Object.keys(n)},...t});Object.keys(n).forEach(c=>{a=a.replace(new RegExp(c,"g"),n[c])}),a=a.replace(new RegExp(e.id,"g"),"[SESSION_ID]");const o=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=`${e.name}_${new Date}.json`,s.click()},[e])}},yne=()=>{const[e,t]=g.useState(!1),n=es(),r=g.useCallback((o,{idMap:i,newSessionId:s,replaceItem:c})=>{const l=o;return{...Object.keys(l).reduce((u,d)=>(l[d]&&typeof l[d]=="string"&&i[l[d]]?u[d]=i[l[d]]:d==="session_id"&&s?u[d]=s:u[d]=l[d],u),{}),...c||{}}},[]),a=g.useCallback(async o=>{try{t(!0);const i=Object.keys(BG).filter(d=>d!==za);if(!Object.keys(o[za]).length||typeof o[za]!="object")throw new Error("Missing Metadata");if(!("session"in o[za])||!o[za].session)throw new Error("Missing Session Metadata");const s=o[za].session;if(!("ids"in o[za]))throw new Error("Missing Session ID");const c=o[za].ids.reduce((d,p)=>(d[p]=Uu(),d),{}),l=Object.keys(o).filter(d=>d!==za);if(!l.every(d=>i.includes(d)))throw new Error("Invalid JSON keys");if(!l.every(d=>Array.isArray(o[d])))throw new Error("Invalid JSON values");l.forEach(d=>{o[d].forEach(p=>{if("session_id"in p&&p.session_id!=="[SESSION_ID]")throw new Error("Invalid JSON values")})});const u=await le("Session").save(r(s,{idMap:c,newSessionId:"",replaceItem:{id:void 0}}));if(!u)throw new Error("Failed to import session");await Promise.all(i.map(d=>{const p=o[d];if(!p||!p.length)return Promise.resolve();const f=p.map(m=>r(m,{idMap:c,newSessionId:u.id}));return le(d).save(f)})),u.type===Wi.Whiteboard?n(dn("whiteboard",{sessionId:u.id})):u.type===Wi.StandaloneApp&&n(dn("application",{applicationId:u.id}))}finally{t(!1)}},[n,r]);return{loading:e,importSession:a}};function gne(){const{t:e}=Me("tooltips"),t=Da(),n=eu(p=>p.setTheme),r=eu(p=>p.theme),{exportSession:a}=mne(),{loading:o,importSession:i}=yne(),s=g.useRef(null),c=g.useCallback(()=>{n(r==="dark"?"light":"dark")},[r,n]),l=g.useCallback(async()=>{try{return await a(),!0}catch(p){return Hs(p),!1}},[a]),u=g.useCallback(async p=>{var f;try{const m=(f=p.target.files)==null?void 0:f[0];if(!m)return;const y=await new Promise((v,b)=>{const w=new FileReader;w.onload=_=>{var x;try{const j=(x=_.target)==null?void 0:x.result;v(JSON.parse(j))}catch(j){b(j)}},w.onerror=_=>{b(_)},w.readAsText(m)});await i(y)}catch(m){return Hs(m),!1}},[i]),d=g.useMemo(()=>{if(t.pathname.includes(dn("whiteboard")))return e("whiteboard");if(t.pathname.includes(dn("application")))return e("apllication")},[t.pathname,e]);return h.jsxs("header",{className:"flex h-14 shrink-0 items-center gap-2 transition-[width,height] ease-linear justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2 px-4",children:[h.jsx(N2,{}),h.jsx(Be,{children:d})]}),h.jsx("div",{className:"flex items-center pl-4 pr-2",children:h.jsxs(Tu,{children:[h.jsxs(Fa,{children:[h.jsx(Ba,{children:h.jsxs(Qn,{loading:o,variant:"ghost",onClick:()=>{var p;return(p=s.current)==null?void 0:p.click()},children:[h.jsx(pe,{size:18,name:"import"}),h.jsx("input",{ref:s,type:"file",accept:".json",onChange:u,className:"hidden"},`${Date.now()}`)]})}),h.jsx(Qr,{children:h.jsx("p",{children:e("import")})})]}),h.jsxs(Fa,{children:[h.jsx(Ba,{children:h.jsx(pne,{onProcess:l})}),h.jsx(Qr,{children:h.jsx("p",{children:e("export")})})]}),h.jsxs(Fa,{children:[h.jsx(Ba,{children:h.jsx(Ye,{disabled:o,onClick:c,variant:"ghost",children:h.jsx(pe,{size:18,name:r==="dark"?"moon":"sun"})})}),h.jsx(Qr,{children:h.jsx("p",{children:e("theme")})})]}),h.jsxs(Fa,{children:[h.jsx(Ba,{children:h.jsx(Ye,{variant:"link",children:h.jsx("a",{referrerPolicy:"no-referrer",target:"_blank",href:"https://github.com/zrg-team/NoLLMChat",children:h.jsx(pe,{size:18,name:"github"})})})}),h.jsx(Qr,{children:h.jsx("p",{children:"https://github.com/zrg-team/NoLLMChat"})})]})]})})]})}function yI({requiredSession:e}){const t=Ff(),n=es(),r=Da(),a=g.useRef(r),o=Je(u=>u.currentSession),i=Je(u=>u.sessions),s=Je(u=>u.applications),c=Je(u=>u.setCurrentSession),l=Je(u=>u.setToDefaultSession);return a.current=r,g.useEffect(()=>{!(o!=null&&o.id)||!e||(r.pathname.includes(dn("whiteboard"))?t.sessionId?t.sessionId&&t.sessionId!==(o==null?void 0:o.id)&&c(t.sessionId):n(dn("whiteboard",{sessionId:o==null?void 0:o.id})):r.pathname.includes(dn("application"))&&(t.applicationId?t.applicationId&&t.applicationId!==(o==null?void 0:o.id)&&c(t.applicationId):n(dn("application",{applicationId:o==null?void 0:o.id}))))},[o==null?void 0:o.id,r.pathname,n,t.applicationId,t.sessionId,e,c]),g.useEffect(()=>{e&&c(t.sessionId||t.applicationId).then(u=>{if(!u)return l(r.pathname.includes(dn("whiteboard"))?Wi.Whiteboard:Wi.StandaloneApp);Vee().has("flow")&&u.type===Wi.StandaloneApp||(u.type===Wi.StandaloneApp&&a.current.pathname.includes(dn("whiteboard").replace("/",""))?n(dn("application",{applicationId:u.id})):u.type===Wi.Whiteboard&&a.current.pathname.includes(dn("application").replace("/",""))&&n(dn("whiteboard",{sessionId:u.id})))})},[n,t.applicationId,t.sessionId,e,c,l]),h.jsxs(zb,{defaultOpen:!1,children:[h.jsx(dne,{sessions:i,applications:s,currentSession:o,setCurrentSession:c}),h.jsxs(Vb,{className:"max-h-screen overflow-hidden",children:[h.jsx(gne,{}),h.jsx(Gs,{className:"shrink-0"}),h.jsx("div",{className:"flex flex-1 flex-col p-0 m-0 overflow-y-auto",children:h.jsx(FJ,{})})]})]})}const gI=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx("div",{className:Z("flex flex-col w-full h-full p-4 gap-6 overflow-y-auto",e),ref:r,...n,children:t}));gI.displayName="ChatMessageList";var vI="vercel.ai.error",vne=Symbol.for(vI),bI,bne=class uX extends Error{constructor({name:t,message:n,cause:r}){super(n),this[bI]=!0,this.name=t,this.cause=r}static isInstance(t){return uX.hasMarker(t,vI)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};bI=vne;var yc=bne;function wI(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var xI="AI_InvalidArgumentError",_I=`vercel.ai.error.${xI}`,wne=Symbol.for(_I),jI,xne=class extends yc{constructor({message:e,cause:t,argument:n}){super({name:xI,message:e,cause:t}),this[jI]=!0,this.argument=n}static isInstance(e){return yc.hasMarker(e,_I)}};jI=wne;var EI="AI_JSONParseError",SI=`vercel.ai.error.${EI}`,_ne=Symbol.for(SI),OI,CI=class extends yc{constructor({text:e,cause:t}){super({name:EI,message:`JSON parsing failed: Text: ${e}.
Error message: ${wI(t)}`,cause:t}),this[OI]=!0,this.text=e}static isInstance(e){return yc.hasMarker(e,SI)}};OI=_ne;var NI="AI_TypeValidationError",kI=`vercel.ai.error.${NI}`,jne=Symbol.for(kI),MI,Ene=class VM extends yc{constructor({value:t,cause:n}){super({name:NI,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${wI(n)}`,cause:n}),this[MI]=!0,this.value=t}static isInstance(t){return yc.hasMarker(t,kI)}static wrap({value:t,cause:n}){return VM.isInstance(n)&&n.value===t?n:new VM({value:t,cause:n})}};MI=jne;var AI=Ene;let Sne=(e,t=21)=>(n=t)=>{let r="",a=n;for(;a--;)r+=e[Math.random()*e.length|0];return r};var os={exports:{}},PI;function One(){if(PI)return os.exports;PI=1;const e=typeof En<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(s,c,l){l==null&&c!==null&&typeof c=="object"&&(l=c,c=void 0),e&&En.isBuffer(s)&&(s=s.toString()),s&&s.charCodeAt(0)===65279&&(s=s.slice(1));const u=JSON.parse(s,c);if(u===null||typeof u!="object")return u;const d=l&&l.protoAction||"error",p=l&&l.constructorAction||"error";if(d==="ignore"&&p==="ignore")return u;if(d!=="ignore"&&p!=="ignore"){if(t.test(s)===!1&&n.test(s)===!1)return u}else if(d!=="ignore"&&p==="ignore"){if(t.test(s)===!1)return u}else if(n.test(s)===!1)return u;return a(u,{protoAction:d,constructorAction:p,safe:l&&l.safe})}function a(s,{protoAction:c="error",constructorAction:l="error",safe:u}={}){let d=[s];for(;d.length;){const p=d;d=[];for(const f of p){if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(f,"__proto__")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete f.__proto__}if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(f,"constructor")&&Object.prototype.hasOwnProperty.call(f.constructor,"prototype")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete f.constructor}for(const m in f){const y=f[m];y&&typeof y=="object"&&d.push(y)}}}return s}function o(s,c,l){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,l)}finally{Error.stackTraceLimit=u}}function i(s,c){const l=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=l}}return os.exports=o,os.exports.default=o,os.exports.parse=o,os.exports.safeParse=i,os.exports.scan=a,os.exports}var Cne=One();const Nne=ct(Cne);var kne=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=Sne(n,t);if(e==null)return a;if(n.includes(r))throw new xne({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return o=>`${e}${r}${a(o)}`},TI=kne(),fw=Symbol.for("vercel.ai.validator");function Mne(e){return{[fw]:!0,validate:e}}function Ane(e){return typeof e=="object"&&e!==null&&fw in e&&e[fw]===!0&&"validate"in e}function Pne(e){return Ane(e)?e:Tne(e)}function Tne(e){return Mne(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function Ine({value:e,schema:t}){const n=Pne(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:AI.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:AI.wrap({value:e,cause:r})}}}function II({text:e,schema:t}){try{const n=Nne.parse(e);return t==null?{success:!0,value:n}:Ine({value:n,schema:t})}catch(n){return{success:!1,error:CI.isInstance(n)?n:new CI({text:e,cause:n})}}}var _h={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},jh={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Eh={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Sh={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Oh={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},Rne=[_h,jh,Eh,Sh,Oh];_h.code+"",jh.code+"",Eh.code+"",Sh.code+"",Oh.code+"",_h.name+"",_h.code,jh.name+"",jh.code,Eh.name+"",Eh.code,Sh.name+"",Sh.code,Oh.name+"",Oh.code,Rne.map(e=>e.code);function Dne(e){const t=["ROOT"];let n=-1,r=null;function a(c,l,u){switch(c){case'"':{n=l,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=l,r=l,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=l,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=l,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function o(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=l,t.pop();break}}}function i(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}}}for(let c=0;c<e.length;c++){const l=e[c];switch(t[t.length-1]){case"ROOT":a(l,c,"FINISH");break;case"INSIDE_OBJECT_START":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=c,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(l){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{a(l,c,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{o(l,c);break}case"INSIDE_STRING":{switch(l){case'"':{t.pop(),n=c;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=c}break}case"INSIDE_ARRAY_START":{switch(l){case"]":{n=c,t.pop();break}default:{n=c,a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}default:{n=c;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=c;break}case"INSIDE_NUMBER":{switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const u=e.substring(r,c+1);!"false".startsWith(u)&&!"true".startsWith(u)&&!"null".startsWith(u)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?o(l,c):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c)):n=c;break}}}let s=e.slice(0,n+1);for(let c=t.length-1;c>=0;c--)switch(t[c]){case"INSIDE_STRING":{s+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{s+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{s+="]";break}case"INSIDE_LITERAL":{const l=e.substring(r,e.length);"true".startsWith(l)?s+="true".slice(l.length):"false".startsWith(l)?s+="false".slice(l.length):"null".startsWith(l)&&(s+="null".slice(l.length))}}return s}function Lne(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=II({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=II({text:Dne(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var Vu={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Wu={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},Hu={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},qu={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},Ku={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},Zu={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},Gu={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},Xu={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Ju={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Yu={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},$ne=[Vu,Wu,Hu,qu,Ku,Zu,Gu,Xu,Ju,Yu],Fne={[Vu.code]:Vu,[Wu.code]:Wu,[Hu.code]:Hu,[qu.code]:qu,[Ku.code]:Ku,[Zu.code]:Zu,[Gu.code]:Gu,[Xu.code]:Xu,[Ju.code]:Ju,[Yu.code]:Yu};Vu.name+"",Vu.code,Wu.name+"",Wu.code,Hu.name+"",Hu.code,qu.name+"",qu.code,Ku.name+"",Ku.code,Zu.name+"",Zu.code,Gu.name+"",Gu.code,Xu.name+"",Xu.code,Ju.name+"",Ju.code,Yu.name+"",Yu.code;var Bne=$ne.map(e=>e.code),zne=e=>{const t=e.indexOf(":");if(t===-1)throw new Error("Failed to parse stream string. No separator found.");const n=e.slice(0,t);if(!Bne.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const r=n,a=e.slice(t+1),o=JSON.parse(a);return Fne[r].parse(o)},Une=10;function Vne(e,t){const n=new Uint8Array(t);let r=0;for(const a of e)n.set(a,r),r+=a.length;return e.length=0,n}async function Wne({stream:e,onTextPart:t,onDataPart:n,onErrorPart:r,onToolCallStreamingStartPart:a,onToolCallDeltaPart:o,onToolCallPart:i,onToolResultPart:s,onMessageAnnotationsPart:c,onFinishMessagePart:l,onFinishStepPart:u}){const d=e.getReader(),p=new TextDecoder,f=[];let m=0;for(;;){const{value:y}=await d.read();if(y&&(f.push(y),m+=y.length,y[y.length-1]!==Une))continue;if(f.length===0)break;const v=Vne(f,m);m=0;const b=p.decode(v,{stream:!0}).split(`
`).filter(w=>w!=="").map(zne);for(const{type:w,value:_}of b)switch(w){case"text":await(t==null?void 0:t(_));break;case"data":await(n==null?void 0:n(_));break;case"error":await(r==null?void 0:r(_));break;case"message_annotations":await(c==null?void 0:c(_));break;case"tool_call_streaming_start":await(a==null?void 0:a(_));break;case"tool_call_delta":await(o==null?void 0:o(_));break;case"tool_call":await(i==null?void 0:i(_));break;case"tool_result":await(s==null?void 0:s(_));break;case"finish_message":await(l==null?void 0:l(_));break;case"finish_step":await(u==null?void 0:u(_));break;default:{const x=w;throw new Error(`Unknown stream part type: ${x}`)}}}}function Hne({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}async function qne({stream:e,update:t,onToolCall:n,onFinish:r,generateId:a=TI,getCurrentDate:o=()=>new Date}){const i=o();let s,c=!0;const l=[],u=[];let d;const p={};let f={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},m="unknown";function y(){const b=[...u];if(s==null){t(l,b);return}d!=null&&d.length&&(s.annotations=d);const w={...JSON.parse(JSON.stringify(s)),revisionId:a()};t([...l,w],b)}function v(){return(c||s==null)&&(s!=null&&l.push(s),c=!1,s={id:a(),role:"assistant",content:"",createdAt:i}),s}await Wne({stream:e,onTextPart(b){const w=v();s={...w,content:w.content+b},y()},onToolCallStreamingStartPart(b){const w=v();w.toolInvocations==null&&(w.toolInvocations=[]),p[b.toolCallId]={text:"",toolName:b.toolName,index:w.toolInvocations.length},w.toolInvocations.push({state:"partial-call",toolCallId:b.toolCallId,toolName:b.toolName,args:void 0}),y()},onToolCallDeltaPart(b){const w=v(),_=p[b.toolCallId];_.text+=b.argsTextDelta;const{value:x}=Lne(_.text);w.toolInvocations[_.index]={state:"partial-call",toolCallId:b.toolCallId,toolName:_.toolName,args:x},y()},async onToolCallPart(b){const w=v();if(p[b.toolCallId]!=null?w.toolInvocations[p[b.toolCallId].index]={state:"call",...b}:(w.toolInvocations==null&&(w.toolInvocations=[]),w.toolInvocations.push({state:"call",...b})),n){const _=await n({toolCall:b});_!=null&&(w.toolInvocations[w.toolInvocations.length-1]={state:"result",...b,result:_})}y()},onToolResultPart(b){const w=v().toolInvocations;if(w==null)throw new Error("tool_result must be preceded by a tool_call");const _=w.findIndex(x=>x.toolCallId===b.toolCallId);if(_===-1)throw new Error("tool_result must be preceded by a tool_call with the same toolCallId");w[_]={...w[_],state:"result",...b},y()},onDataPart(b){u.push(...b),y()},onMessageAnnotationsPart(b){d==null?d=[...b]:d.push(...b),y()},onFinishStepPart(b){c=!b.isContinued},onFinishMessagePart(b){m=b.finishReason,b.usage!=null&&(f=Hne(b.usage))},onErrorPart(b){throw new Error(b)}}),r==null||r({message:s,finishReason:m,usage:f})}async function Kne({stream:e,onTextPart:t}){const n=e.pipeThrough(new TextDecoderStream).getReader();for(;;){const{done:r,value:a}=await n.read();if(r)break;await t(a)}}var Zne=()=>fetch;async function Gne({api:e,body:t,streamProtocol:n="data",credentials:r,headers:a,abortController:o,restoreMessagesOnFailure:i,onResponse:s,onUpdate:c,onFinish:l,onToolCall:u,generateId:d,fetch:p=Zne()}){var f,m;const y=await p(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",...a},signal:(f=o==null?void 0:o())==null?void 0:f.signal,credentials:r}).catch(v=>{throw i(),v});if(s)try{await s(y)}catch(v){throw v}if(!y.ok)throw i(),new Error((m=await y.text())!=null?m:"Failed to fetch the chat response.");if(!y.body)throw new Error("The response body is empty.");switch(n){case"text":{const v={id:d(),createdAt:new Date,role:"assistant",content:""};await Kne({stream:y.body,onTextPart:b=>{v.content+=b,c([{...v}],[])}}),l==null||l(v,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"});return}case"data":{await qne({stream:y.body,update:c,onToolCall:u,onFinish({message:v,finishReason:b,usage:w}){l&&v!=null&&l(v,{usage:w,finishReason:b})},generateId:d});return}default:{const v=n;throw new Error(`Unknown stream protocol: ${v}`)}}}var RI={exports:{}},hw={},DI;function Xne(){if(DI)return hw;DI=1;var e=zG();function t(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,a=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function s(d,p){var f=p(),m=r({inst:{value:f,getSnapshot:p}}),y=m[0].inst,v=m[1];return o(function(){y.value=f,y.getSnapshot=p,c(y)&&v({inst:y})},[d,f,p]),a(function(){return c(y)&&v({inst:y}),d(function(){c(y)&&v({inst:y})})},[d]),i(f),f}function c(d){var p=d.getSnapshot;d=d.value;try{var f=p();return!n(d,f)}catch{return!0}}function l(d,p){return p()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:s;return hw.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,hw}var LI;function $I(){return LI||(LI=1,RI.exports=Xne()),RI.exports}_f=$I();let Oo,Kn,Ch,ut,ea,Co,FI,Qu;iX=ct(_f),Oo=()=>{},Kn=Oo(),Ch=Object,ut=e=>e===Kn,ea=e=>typeof e=="function",Co=(e,t)=>({...e,...t}),FI=e=>ea(e.then),Qu=new WeakMap;let Jne=0;const ed=e=>{const t=typeof e,n=e&&e.constructor,r=n==Date;let a,o;if(Ch(e)===e&&!r&&n!=RegExp){if(a=Qu.get(e),a)return a;if(a=++Jne+"~",Qu.set(e,a),n==Array){for(a="@",o=0;o<e.length;o++)a+=ed(e[o])+",";Qu.set(e,a)}if(n==Ch){a="#";const i=Ch.keys(e).sort();for(;!ut(o=i.pop());)ut(e[o])||(a+=o+":"+ed(e[o])+",");Qu.set(e,a)}}else a=r?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return a},No=new WeakMap,mw={},Nh={},yw="undefined",kh=typeof window!=yw,gw=typeof document!=yw,Yne=()=>kh&&typeof window.requestAnimationFrame!=yw,BI=(e,t)=>{const n=No.get(e);return[()=>!ut(t)&&e.get(t)||mw,r=>{if(!ut(t)){const a=e.get(t);t in Nh||(Nh[t]=a),n[5](t,Co(a,r),a||mw)}},n[6],()=>!ut(t)&&t in Nh?Nh[t]:!ut(t)&&e.get(t)||mw]};let vw=!0;const Qne=()=>vw,[bw,ww]=kh&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[Oo,Oo],ere=()=>{const e=gw&&document.visibilityState;return ut(e)||e!=="hidden"},tre=e=>(gw&&document.addEventListener("visibilitychange",e),bw("focus",e),()=>{gw&&document.removeEventListener("visibilitychange",e),ww("focus",e)}),nre=e=>{const t=()=>{vw=!0,e()},n=()=>{vw=!1};return bw("online",t),bw("offline",n),()=>{ww("online",t),ww("offline",n)}},rre={isOnline:Qne,isVisible:ere},are={initFocus:tre,initReconnect:nre},zI=!q.useId,td=!kh||"Deno"in window,ore=e=>Yne()?window.requestAnimationFrame(e):setTimeout(e,1),xw=td?g.useEffect:g.useLayoutEffect,_w=typeof navigator<"u"&&navigator.connection,UI=!td&&_w&&(["slow-2g","2g"].includes(_w.effectiveType)||_w.saveData),jw=e=>{if(ea(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?ed(e):"",[e,t]};let ire=0;const Ew=()=>++ire,VI=0,WI=1,HI=2;var nd={__proto__:null,ERROR_REVALIDATE_EVENT:3,FOCUS_EVENT:VI,MUTATE_EVENT:HI,RECONNECT_EVENT:WI};async function qI(...e){const[t,n,r,a]=e,o=Co({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let i=o.populateCache;const s=o.rollbackOnError;let c=o.optimisticData;const l=p=>typeof s=="function"?s(p):s!==!1,u=o.throwOnError;if(ea(n)){const p=n,f=[],m=t.keys();for(const y of m)!/^\$(inf|sub)\$/.test(y)&&p(t.get(y)._k)&&f.push(y);return Promise.all(f.map(d))}return d(n);async function d(p){const[f]=jw(p);if(!f)return;const[m,y]=BI(t,f),[v,b,w,_]=No.get(t),x=()=>{const P=v[f];return(ea(o.revalidate)?o.revalidate(m().data,p):o.revalidate!==!1)&&(delete w[f],delete _[f],P&&P[0])?P[0](HI).then(()=>m().data):m().data};if(e.length<3)return x();let j=r,E;const S=Ew();b[f]=[S,0];const O=!ut(c),N=m(),M=N.data,k=N._c,A=ut(k)?M:k;if(O&&(c=ea(c)?c(A,M):c,y({data:c,_c:A})),ea(j))try{j=j(A)}catch(P){E=P}if(j&&FI(j))if(j=await j.catch(P=>{E=P}),S!==b[f][0]){if(E)throw E;return j}else E&&O&&l(E)&&(i=!0,y({data:A,_c:Kn}));if(i&&!E)if(ea(i)){const P=i(j,A);y({data:P,error:Kn,_c:Kn})}else y({data:j,error:Kn,_c:Kn});if(b[f][1]=Ew(),Promise.resolve(x()).then(()=>{y({_c:Kn})}),E){if(u)throw E;return}return j}}const KI=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},sre=(e,t)=>{if(!No.has(e)){const n=Co(are,t),r={},a=qI.bind(Kn,e);let o=Oo;const i={},s=(u,d)=>{const p=i[u]||[];return i[u]=p,p.push(d),()=>p.splice(p.indexOf(d),1)},c=(u,d,p)=>{e.set(u,d);const f=i[u];if(f)for(const m of f)m(d,p)},l=()=>{if(!No.has(e)&&(No.set(e,[r,{},{},{},a,c,s]),!td)){const u=n.initFocus(setTimeout.bind(Kn,KI.bind(Kn,r,VI))),d=n.initReconnect(setTimeout.bind(Kn,KI.bind(Kn,r,WI)));o=()=>{u&&u(),d&&d(),No.delete(e)}}};return l(),[e,a,l,o]}return[e,No.get(e)[4]]},cre=(e,t,n,r,a)=>{const o=n.errorRetryCount,i=a.retryCount,s=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!ut(o)&&i>o||setTimeout(r,s,a)},lre=(e,t)=>ed(e)==ed(t),[ZI,ure]=sre(new Map),dre=Co({onLoadingSlow:Oo,onSuccess:Oo,onError:Oo,onErrorRetry:cre,onDiscarded:Oo,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:UI?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:UI?5e3:3e3,compare:lre,isPaused:()=>!1,cache:ZI,mutate:ure,fallback:{}},rre),pre=(e,t)=>{const n=Co(e,t);if(t){const{use:r,fallback:a}=e,{use:o,fallback:i}=t;r&&o&&(n.use=r.concat(o)),a&&i&&(n.fallback=Co(a,i))}return n},fre=g.createContext({}),hre="$inf$",GI=kh&&window.__SWR_DEVTOOLS_USE__,mre=GI?window.__SWR_DEVTOOLS_USE__:[],yre=()=>{GI&&(window.__SWR_DEVTOOLS_REACT__=q)},gre=e=>ea(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],vre=()=>Co(dre,g.useContext(fre)),bre=e=>(t,n,r)=>e(t,n&&((...a)=>{const[o]=jw(t),[,,,i]=No.get(ZI);if(o.startsWith(hre))return n(...a);const s=i[o];return ut(s)?n(...a):(delete i[o],s)}),r),wre=mre.concat(bre),xre=e=>function(...t){const n=vre(),[r,a,o]=gre(t),i=pre(n,o);let s=e;const{use:c}=i,l=(c||[]).concat(wre);for(let u=l.length;u--;)s=l[u](s);return s(r,a||i.fetcher||null,i)},_re=(e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const a=r.indexOf(n);a>=0&&(r[a]=r[r.length-1],r.pop())}};yre();const XI=q.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e)}),Sw={dedupe:!0},jre=(e,t,n)=>{const{cache:r,compare:a,suspense:o,fallbackData:i,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:l,refreshWhenHidden:u,refreshWhenOffline:d,keepPreviousData:p}=n,[f,m,y,v]=No.get(r),[b,w]=jw(e),_=g.useRef(!1),x=g.useRef(!1),j=g.useRef(b),E=g.useRef(t),S=g.useRef(n),O=()=>S.current,N=()=>O().isVisible()&&O().isOnline(),[M,k,A,P]=BI(r,b),C=g.useRef({}).current,T=ut(i)?n.fallback[b]:i,I=(B,ue)=>{for(const ae in C){const de=ae;if(de==="data"){if(!a(B[de],ue[de])&&(!ut(B[de])||!a(W,ue[de])))return!1}else if(ue[de]!==B[de])return!1}return!0},R=g.useMemo(()=>{const B=!b||!t?!1:ut(s)?O().isPaused()||o?!1:ut(c)?!0:c:s,ue=Ee=>{const We=Co(Ee);return delete We._k,B?{isValidating:!0,isLoading:!0,...We}:We},ae=M(),de=P(),je=ue(ae),Le=ae===de?je:ue(de);let $e=je;return[()=>{const Ee=ue(M());return I(Ee,$e)?($e.data=Ee.data,$e.isLoading=Ee.isLoading,$e.isValidating=Ee.isValidating,$e.error=Ee.error,$e):($e=Ee,Ee)},()=>Le]},[r,b]),L=_f.useSyncExternalStore(g.useCallback(B=>A(b,(ue,ae)=>{I(ae,ue)||B()}),[r,b]),R[0],R[1]),D=!_.current,z=f[b]&&f[b].length>0,U=L.data,$=ut(U)?T:U,V=L.error,F=g.useRef($),W=p?ut(U)?F.current:U:$,re=z&&!ut(V)?!1:D&&!ut(s)?s:O().isPaused()?!1:o?ut($)?!1:c:ut($)||c,ee=!!(b&&t&&D&&re),G=ut(L.isValidating)?ee:L.isValidating,K=ut(L.isLoading)?ee:L.isLoading,X=g.useCallback(async B=>{const ue=E.current;if(!b||!ue||x.current||O().isPaused())return!1;let ae,de,je=!0;const Le=B||{},$e=!y[b]||!Le.dedupe,Ee=()=>zI?!x.current&&b===j.current&&_.current:b===j.current,We={isValidating:!1,isLoading:!1},qe=()=>{k(We)},Ke=()=>{const lt=y[b];lt&&lt[1]===de&&delete y[b]},It={isValidating:!0};ut(M().data)&&(It.isLoading=!0);try{if($e&&(k(It),n.loadingTimeout&&ut(M().data)&&setTimeout(()=>{je&&Ee()&&O().onLoadingSlow(b,n)},n.loadingTimeout),y[b]=[ue(w),Ew()]),[ae,de]=y[b],ae=await ae,$e&&setTimeout(Ke,n.dedupingInterval),!y[b]||y[b][1]!==de)return $e&&Ee()&&O().onDiscarded(b),!1;We.error=Kn;const lt=m[b];if(!ut(lt)&&(de<=lt[0]||de<=lt[1]||lt[1]===0))return qe(),$e&&Ee()&&O().onDiscarded(b),!1;const it=M().data;We.data=a(it,ae)?it:ae,$e&&Ee()&&O().onSuccess(ae,b,n)}catch(lt){Ke();const it=O(),{shouldRetryOnError:_t}=it;it.isPaused()||(We.error=lt,$e&&Ee()&&(it.onError(lt,b,it),(_t===!0||ea(_t)&&_t(lt))&&(!O().revalidateOnFocus||!O().revalidateOnReconnect||N())&&it.onErrorRetry(lt,b,it,Qt=>{const cr=f[b];cr&&cr[0]&&cr[0](nd.ERROR_REVALIDATE_EVENT,Qt)},{retryCount:(Le.retryCount||0)+1,dedupe:!0})))}return je=!1,qe(),!0},[b,r]),ne=g.useCallback((...B)=>qI(r,j.current,...B),[]);if(xw(()=>{E.current=t,S.current=n,ut(U)||(F.current=U)}),xw(()=>{if(!b)return;const B=X.bind(Kn,Sw);let ue=0;const ae=_re(b,f,(de,je={})=>{if(de==nd.FOCUS_EVENT){const Le=Date.now();O().revalidateOnFocus&&Le>ue&&N()&&(ue=Le+O().focusThrottleInterval,B())}else if(de==nd.RECONNECT_EVENT)O().revalidateOnReconnect&&N()&&B();else{if(de==nd.MUTATE_EVENT)return X();if(de==nd.ERROR_REVALIDATE_EVENT)return X(je)}});return x.current=!1,j.current=b,_.current=!0,k({_k:w}),re&&(ut($)||td?B():ore(B)),()=>{x.current=!0,ae()}},[b]),xw(()=>{let B;function ue(){const de=ea(l)?l(M().data):l;de&&B!==-1&&(B=setTimeout(ae,de))}function ae(){!M().error&&(u||O().isVisible())&&(d||O().isOnline())?X(Sw).then(ue):ue()}return ue(),()=>{B&&(clearTimeout(B),B=-1)}},[l,u,d,b]),g.useDebugValue(W),o&&ut($)&&b){if(!zI&&td)throw new Error("Fallback data is required when using suspense in SSR.");E.current=t,S.current=n,x.current=!1;const B=v[b];if(!ut(B)){const ue=ne(B);XI(ue)}if(ut(V)){const ue=X(Sw);ut(W)||(ue.status="fulfilled",ue.value=!0),XI(ue)}else throw V}return{mutate:ne,get data(){return C.data=!0,W},get error(){return C.error=!0,V},get isValidating(){return C.isValidating=!0,G},get isLoading(){return C.isLoading=!0,K}}},Mh=xre(jre);var Ow,JI;function Ere(){if(JI)return Ow;JI=1;function e(t,n){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let r,a=0;return function(...o){clearTimeout(r);const i=Date.now(),s=i-a,c=n-s;c<=0?(a=i,t.apply(this,o)):r=setTimeout(()=>{a=Date.now(),t.apply(this,o)},c)}}return Ow=e,Ow}var Sre=Ere();const Ore=ct(Sre);function YI(e,t){return t!=null?Ore(e,t):e}var Cre=async(e,t,n,r,a,o,i,s,c,l,u,d,p,f,m,y,v)=>{var b;const w=i.current;n(t.messages,!1);const _=f?t.messages:t.messages.map(({role:j,content:E,experimental_attachments:S,data:O,annotations:N,toolInvocations:M})=>({role:j,content:E,...S!==void 0&&{experimental_attachments:S},...O!==void 0&&{data:O},...N!==void 0&&{annotations:N},...M!==void 0&&{toolInvocations:M}})),x=a.current;return await Gne({api:e,body:(b=m==null?void 0:m({messages:t.messages,requestData:t.data,requestBody:t.body}))!=null?b:{messages:_,data:t.data,...o.current.body,...t.body},streamProtocol:l,credentials:o.current.credentials,headers:{...o.current.headers,...t.headers},abortController:()=>s.current,restoreMessagesOnFailure(){v||n(w,!1)},onResponse:d,onUpdate(j,E){n([...t.messages,...j],!1),E!=null&&E.length&&r([...x??[],...E],!1)},onToolCall:p,onFinish:u,generateId:c,fetch:y})};function Nre({api:e="/api/chat",id:t,initialMessages:n,initialInput:r="",sendExtraMessageFields:a,onToolCall:o,experimental_prepareRequestBody:i,maxSteps:s=1,streamProtocol:c="data",onResponse:l,onFinish:u,onError:d,credentials:p,headers:f,body:m,generateId:y=TI,fetch:v,keepLastMessageOnError:b=!0,experimental_throttle:w}={}){const _=g.useId(),x=t??_,j=typeof e=="string"?[e,x]:x,[E]=g.useState([]),{data:S,mutate:O}=Mh([j,"messages"],null,{fallbackData:n??E}),N=g.useRef(S||[]);g.useEffect(()=>{N.current=S||[]},[S]);const{data:M,mutate:k}=Mh([j,"streamData"],null),A=g.useRef(M);g.useEffect(()=>{A.current=M},[M]);const{data:P=!1,mutate:C}=Mh([j,"loading"],null),{data:T=void 0,mutate:I}=Mh([j,"error"],null),R=g.useRef(null),L=g.useRef({credentials:p,headers:f,body:m});g.useEffect(()=>{L.current={credentials:p,headers:f,body:m}},[p,f,m]);const D=g.useCallback(async G=>{const K=N.current.length;try{C(!0),I(void 0);const B=new AbortController;R.current=B,await Cre(e,G,YI(O,w),YI(k,w),A,L,N,R,y,c,u,l,o,a,i,v,b),R.current=null}catch(B){if(B.name==="AbortError")return R.current=null,null;d&&B instanceof Error&&d(B),I(B)}finally{C(!1)}const X=N.current,ne=X[X.length-1];X.length>K&&ne!=null&&s>1&&QI(ne)&&kre(X)<s&&await D({messages:X})},[O,C,e,L,l,u,d,I,k,A,c,a,i,o,s,N,R,y,v,b,w]),z=g.useCallback(async(G,{data:K,headers:X,body:ne,experimental_attachments:B}={})=>{var ue,ae;G.id||(G.id=y());const de=await eR(B),je=N.current.concat({...G,id:(ue=G.id)!=null?ue:y(),createdAt:(ae=G.createdAt)!=null?ae:new Date,experimental_attachments:de.length>0?de:void 0});return D({messages:je,headers:X,body:ne,data:K})},[D,y]),U=g.useCallback(async({data:G,headers:K,body:X}={})=>{const ne=N.current;if(ne.length===0)return null;const B=ne[ne.length-1];return D({messages:B.role==="assistant"?ne.slice(0,-1):ne,headers:K,body:X,data:G})},[D]),$=g.useCallback(()=>{R.current&&(R.current.abort(),R.current=null)},[]),V=g.useCallback(G=>{typeof G=="function"&&(G=G(N.current)),O(G,!1),N.current=G},[O]),F=g.useCallback(G=>{typeof G=="function"&&(G=G(A.current)),k(G,!1),A.current=G},[k]),[W,re]=g.useState(r),ee=g.useCallback(async(G,K={},X)=>{var ne;if((ne=G==null?void 0:G.preventDefault)==null||ne.call(G),!W&&!K.allowEmptySubmit)return;X&&(L.current={...L.current,...X});const B=await eR(K.experimental_attachments),ue={messages:!W&&!B.length&&K.allowEmptySubmit?N.current:N.current.concat({id:y(),createdAt:new Date,role:"user",content:W,experimental_attachments:B.length>0?B:void 0}),headers:K.headers,body:K.body,data:K.data};D(ue),re("")},[W,y,D]);return{messages:S||[],setMessages:V,data:M,setData:F,error:T,append:z,reload:U,stop:$,input:W,setInput:re,handleInputChange:G=>{re(G.target.value)},handleSubmit:ee,isLoading:P,addToolResult:({toolCallId:G,result:K})=>{const X=N.current.map((B,ue,ae)=>ue===ae.length-1&&B.role==="assistant"&&B.toolInvocations?{...B,toolInvocations:B.toolInvocations.map(de=>de.toolCallId===G?{...de,result:K,state:"result"}:de)}:B);O(X,!1);const ne=X[X.length-1];QI(ne)&&D({messages:X})}}}function QI(e){return e.role==="assistant"&&e.toolInvocations&&e.toolInvocations.length>0&&e.toolInvocations.every(t=>"result"in t)}function kre(e){let t=0;for(let n=e.length-1;n>=0&&e[n].role==="assistant";n--)t++;return t}async function eR(e){if(e==null)return[];if(e instanceof FileList)return Promise.all(Array.from(e).map(async t=>{const{name:n,type:r}=t,a=await new Promise((o,i)=>{const s=new FileReader;s.onload=c=>{var l;o((l=c.target)==null?void 0:l.result)},s.onerror=c=>i(c),s.readAsDataURL(t)});return{name:n,contentType:r,url:a}}));if(Array.isArray(e))return e;throw new Error("Invalid attachments type")}hM=Nre;const ko=g.forwardRef(({className:e,...t},n)=>h.jsx("textarea",{className:Z("flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));ko.displayName="Textarea";function Mre({minHeight:e,maxHeight:t}){const n=g.useRef(null),r=g.useCallback(a=>{const o=n.current;if(!o)return;if(a){o.style.height=`${e}px`;return}o.style.height=`${e}px`;const i=Math.max(e,Math.min(o.scrollHeight,t??Number.POSITIVE_INFINITY));o.style.height=`${i}px`},[e,t]);return g.useEffect(()=>{const a=n.current;a&&(a.style.height=`${e}px`)},[e]),g.useEffect(()=>{const a=()=>r();return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[r]),{textareaRef:n,adjustHeight:r}}const Are=48,tR=164;_0=function({onSubmit:e,disabled:t,enableTool:n,enableFile:r,placeholder:a,minHeight:o,maxHeight:i,className:s,height:c,onChange:l,value:u}){const[d,p]=g.useState(!1),[f,m]=g.useState(""),{textareaRef:y,adjustHeight:v}=Mre({minHeight:o||Are,maxHeight:i||tR}),[b,w]=g.useState(!0),_=g.useCallback(async j=>{try{p(!0),await e(f,j)&&m("")}finally{p(!1)}},[f,e]),x=g.useMemo(()=>({maxHeight:`${i||tR}px`,...c?{height:`${c}px`}:{}}),[i,c]);return h.jsx("div",{className:Z("w-full py-4 max-w-xl",s),children:h.jsx("div",{className:"relative w-full mx-auto",children:h.jsxs("div",{className:"relative flex flex-col",children:[h.jsx("div",{className:"overflow-y-auto",style:x,children:h.jsx(ko,{id:"ai-input-04",value:(l?u:f)||"",disabled:t||d,placeholder:a,className:"w-full rounded-xl rounded-b-none px-4 py-3 bg-black/5 dark:bg-white/5 border-none dark:text-white placeholder:text-black/70 dark:placeholder:text-white/70 resize-none focus-visible:ring-0 leading-[1.2]",ref:y,onKeyDown:j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),_(j))},onChange:j=>{l||m(j.target.value),v(),l==null||l(j)}})}),h.jsxs("div",{className:"h-12 bg-black/5 dark:bg-white/5 rounded-b-xl",children:[h.jsxs("div",{className:"absolute left-3 bottom-3 flex items-center gap-2",children:[r?h.jsxs("label",{className:"cursor-pointer rounded-lg p-2 bg-black/5 dark:bg-white/5",children:[h.jsx("input",{type:"file",className:"hidden"}),h.jsx(pe,{name:"paperclip",className:"w-4 h-4 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white transition-colors"})]}):void 0,n?h.jsxs("button",{type:"button",onClick:()=>{w(!b)},className:Z("rounded-full transition-all flex items-center gap-2 px-1.5 py-1 border h-8",b?"bg-sky-500/15 border-sky-400 text-sky-500":"bg-black/5 dark:bg-white/5 border-transparent text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:[h.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:h.jsx(mf.div,{animate:{rotate:b?180:0,scale:b?1.1:1},whileHover:{rotate:b?180:15,scale:1.1,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:h.jsx(pe,{name:"globe",className:Z("w-4 h-4",b?"text-sky-500":"text-inherit")})})}),h.jsx(yX,{children:b&&h.jsx(mf.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-sm overflow-hidden whitespace-nowrap text-sky-500 flex-shrink-0",children:"Search"})})]}):void 0]}),h.jsx("div",{className:"absolute right-3 bottom-3",children:h.jsx("button",{type:"button",disabled:t||d,onClick:j=>{_(j)},className:Z("rounded-lg p-2",l&&u||f?"bg-sky-500/15 text-sky-500":"bg-black/5 dark:bg-white/5 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:h.jsx(pe,{name:"send",className:"w-4 h-4"})})})]})]})})})};var Cw,nR;function Pre(){if(nR)return Cw;nR=1;function e(){this.__data__=[],this.size=0}return Cw=e,Cw}var Nw,rR;su=function(){if(rR)return Nw;rR=1;function e(t,n){return t===n||t!==t&&n!==n}return Nw=e,Nw};var kw,aR;function Ah(){if(aR)return kw;aR=1;var e=su();function t(n,r){for(var a=n.length;a--;)if(e(n[a][0],r))return a;return-1}return kw=t,kw}var Mw,oR;function Tre(){if(oR)return Mw;oR=1;var e=Ah(),t=Array.prototype,n=t.splice;function r(a){var o=this.__data__,i=e(o,a);if(i<0)return!1;var s=o.length-1;return i==s?o.pop():n.call(o,i,1),--this.size,!0}return Mw=r,Mw}var Aw,iR;function Ire(){if(iR)return Aw;iR=1;var e=Ah();function t(n){var r=this.__data__,a=e(r,n);return a<0?void 0:r[a][1]}return Aw=t,Aw}var Pw,sR;function Rre(){if(sR)return Pw;sR=1;var e=Ah();function t(n){return e(this.__data__,n)>-1}return Pw=t,Pw}var Tw,cR;function Dre(){if(cR)return Tw;cR=1;var e=Ah();function t(n,r){var a=this.__data__,o=e(a,n);return o<0?(++this.size,a.push([n,r])):a[o][1]=r,this}return Tw=t,Tw}var Iw,lR;function Ph(){if(lR)return Iw;lR=1;var e=Pre(),t=Tre(),n=Ire(),r=Rre(),a=Dre();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,Iw=o,Iw}var Rw,uR;function Lre(){if(uR)return Rw;uR=1;var e=Ph();function t(){this.__data__=new e,this.size=0}return Rw=t,Rw}var Dw,dR;function $re(){if(dR)return Dw;dR=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return Dw=e,Dw}var Lw,pR;function Fre(){if(pR)return Lw;pR=1;function e(t){return this.__data__.get(t)}return Lw=e,Lw}var $w,fR;function Bre(){if(fR)return $w;fR=1;function e(t){return this.__data__.has(t)}return $w=e,$w}var Fw,hR;function mR(){if(hR)return Fw;hR=1;var e=typeof tu=="object"&&tu&&tu.Object===Object&&tu;return Fw=e,Fw}var Bw,yR;Hr=function(){if(yR)return Bw;yR=1;var e=mR(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return Bw=n,Bw};var zw,gR;Js=function(){if(gR)return zw;gR=1;var e=Hr(),t=e.Symbol;return zw=t,zw};var Uw,vR;function zre(){if(vR)return Uw;vR=1;var e=Js(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,a=e?e.toStringTag:void 0;function o(i){var s=n.call(i,a),c=i[a];try{i[a]=void 0;var l=!0}catch{}var u=r.call(i);return l&&(s?i[a]=c:delete i[a]),u}return Uw=o,Uw}var Vw,bR;function Ure(){if(bR)return Vw;bR=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return Vw=n,Vw}var Ww,wR;function Mo(){if(wR)return Ww;wR=1;var e=Js(),t=zre(),n=Ure(),r="[object Null]",a="[object Undefined]",o=e?e.toStringTag:void 0;function i(s){return s==null?s===void 0?a:r:o&&o in Object(s)?t(s):n(s)}return Ww=i,Ww}var Hw,xR;qr=function(){if(xR)return Hw;xR=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Hw=e,Hw};var qw,_R;xf=function(){if(_R)return qw;_R=1;var e=Mo(),t=qr(),n="[object AsyncFunction]",r="[object Function]",a="[object GeneratorFunction]",o="[object Proxy]";function i(s){if(!t(s))return!1;var c=e(s);return c==r||c==a||c==n||c==o}return qw=i,qw};var Kw,jR;function Vre(){if(jR)return Kw;jR=1;var e=Hr(),t=e["__core-js_shared__"];return Kw=t,Kw}var Zw,ER;function Wre(){if(ER)return Zw;ER=1;var e=Vre(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return Zw=n,Zw}var Gw,SR;function OR(){if(SR)return Gw;SR=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return Gw=n,Gw}var Xw,CR;function Hre(){if(CR)return Xw;CR=1;var e=xf(),t=Wre(),n=qr(),r=OR(),a=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,i=Function.prototype,s=Object.prototype,c=i.toString,l=s.hasOwnProperty,u=RegExp("^"+c.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(p){if(!n(p)||t(p))return!1;var f=e(p)?u:o;return f.test(r(p))}return Xw=d,Xw}var Jw,NR;function qre(){if(NR)return Jw;NR=1;function e(t,n){return t==null?void 0:t[n]}return Jw=e,Jw}var Yw,kR;function is(){if(kR)return Yw;kR=1;var e=Hre(),t=qre();function n(r,a){var o=t(r,a);return e(o)?o:void 0}return Yw=n,Yw}var Qw,MR;function ex(){if(MR)return Qw;MR=1;var e=is(),t=Hr(),n=e(t,"Map");return Qw=n,Qw}var tx,AR;function Th(){if(AR)return tx;AR=1;var e=is(),t=e(Object,"create");return tx=t,tx}var nx,PR;function Kre(){if(PR)return nx;PR=1;var e=Th();function t(){this.__data__=e?e(null):{},this.size=0}return nx=t,nx}var rx,TR;function Zre(){if(TR)return rx;TR=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return rx=e,rx}var ax,IR;function Gre(){if(IR)return ax;IR=1;var e=Th(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function a(o){var i=this.__data__;if(e){var s=i[o];return s===t?void 0:s}return r.call(i,o)?i[o]:void 0}return ax=a,ax}var ox,RR;function Xre(){if(RR)return ox;RR=1;var e=Th(),t=Object.prototype,n=t.hasOwnProperty;function r(a){var o=this.__data__;return e?o[a]!==void 0:n.call(o,a)}return ox=r,ox}var ix,DR;function Jre(){if(DR)return ix;DR=1;var e=Th(),t="__lodash_hash_undefined__";function n(r,a){var o=this.__data__;return this.size+=this.has(r)?0:1,o[r]=e&&a===void 0?t:a,this}return ix=n,ix}var sx,LR;function Yre(){if(LR)return sx;LR=1;var e=Kre(),t=Zre(),n=Gre(),r=Xre(),a=Jre();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,sx=o,sx}var cx,$R;function Qre(){if($R)return cx;$R=1;var e=Yre(),t=Ph(),n=ex();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return cx=r,cx}var lx,FR;function eae(){if(FR)return lx;FR=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return lx=e,lx}var ux,BR;function Ih(){if(BR)return ux;BR=1;var e=eae();function t(n,r){var a=n.__data__;return e(r)?a[typeof r=="string"?"string":"hash"]:a.map}return ux=t,ux}var dx,zR;function tae(){if(zR)return dx;zR=1;var e=Ih();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return dx=t,dx}var px,UR;function nae(){if(UR)return px;UR=1;var e=Ih();function t(n){return e(this,n).get(n)}return px=t,px}var fx,VR;function rae(){if(VR)return fx;VR=1;var e=Ih();function t(n){return e(this,n).has(n)}return fx=t,fx}var hx,WR;function aae(){if(WR)return hx;WR=1;var e=Ih();function t(n,r){var a=e(this,n),o=a.size;return a.set(n,r),this.size+=a.size==o?0:1,this}return hx=t,hx}var mx,HR;function yx(){if(HR)return mx;HR=1;var e=Qre(),t=tae(),n=nae(),r=rae(),a=aae();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,mx=o,mx}var gx,qR;function oae(){if(qR)return gx;qR=1;var e=Ph(),t=ex(),n=yx(),r=200;function a(o,i){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<r-1)return c.push([o,i]),this.size=++s.size,this;s=this.__data__=new n(c)}return s.set(o,i),this.size=s.size,this}return gx=a,gx}var vx,KR;T0=function(){if(KR)return vx;KR=1;var e=Ph(),t=Lre(),n=$re(),r=Fre(),a=Bre(),o=oae();function i(s){var c=this.__data__=new e(s);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=a,i.prototype.set=o,vx=i,vx};var bx,ZR;function iae(){if(ZR)return bx;ZR=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return bx=t,bx}var wx,GR;function sae(){if(GR)return wx;GR=1;function e(t){return this.__data__.has(t)}return wx=e,wx}var xx,XR;function JR(){if(XR)return xx;XR=1;var e=yx(),t=iae(),n=sae();function r(a){var o=-1,i=a==null?0:a.length;for(this.__data__=new e;++o<i;)this.add(a[o])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,xx=r,xx}var _x,YR;function QR(){if(YR)return _x;YR=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(n(t[r],r,t))return!0;return!1}return _x=e,_x}var jx,eD;function tD(){if(eD)return jx;eD=1;function e(t,n){return t.has(n)}return jx=e,jx}var Ex,nD;function rD(){if(nD)return Ex;nD=1;var e=JR(),t=QR(),n=tD(),r=1,a=2;function o(i,s,c,l,u,d){var p=c&r,f=i.length,m=s.length;if(f!=m&&!(p&&m>f))return!1;var y=d.get(i),v=d.get(s);if(y&&v)return y==s&&v==i;var b=-1,w=!0,_=c&a?new e:void 0;for(d.set(i,s),d.set(s,i);++b<f;){var x=i[b],j=s[b];if(l)var E=p?l(j,x,b,s,i,d):l(x,j,b,i,s,d);if(E!==void 0){if(E)continue;w=!1;break}if(_){if(!t(s,function(S,O){if(!n(_,O)&&(x===S||u(x,S,c,l,d)))return _.push(O)})){w=!1;break}}else if(!(x===j||u(x,j,c,l,d))){w=!1;break}}return d.delete(i),d.delete(s),w}return Ex=o,Ex}var Sx,aD;DM=function(){if(aD)return Sx;aD=1;var e=Hr(),t=e.Uint8Array;return Sx=t,Sx};var Ox,oD;function cae(){if(oD)return Ox;oD=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a,o){r[++n]=[o,a]}),r}return Ox=e,Ox}var Cx,iD;function Nx(){if(iD)return Cx;iD=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a){r[++n]=a}),r}return Cx=e,Cx}var kx,sD;function lae(){if(sD)return kx;sD=1;var e=Js(),t=DM(),n=su(),r=rD(),a=cae(),o=Nx(),i=1,s=2,c="[object Boolean]",l="[object Date]",u="[object Error]",d="[object Map]",p="[object Number]",f="[object RegExp]",m="[object Set]",y="[object String]",v="[object Symbol]",b="[object ArrayBuffer]",w="[object DataView]",_=e?e.prototype:void 0,x=_?_.valueOf:void 0;function j(E,S,O,N,M,k,A){switch(O){case w:if(E.byteLength!=S.byteLength||E.byteOffset!=S.byteOffset)return!1;E=E.buffer,S=S.buffer;case b:return!(E.byteLength!=S.byteLength||!k(new t(E),new t(S)));case c:case l:case p:return n(+E,+S);case u:return E.name==S.name&&E.message==S.message;case f:case y:return E==S+"";case d:var P=a;case m:var C=N&i;if(P||(P=o),E.size!=S.size&&!C)return!1;var T=A.get(E);if(T)return T==S;N|=s,A.set(E,S);var I=r(P(E),P(S),N,M,k,A);return A.delete(E),I;case v:if(x)return x.call(E)==x.call(S)}return!1}return kx=j,kx}var Mx,cD;function Ax(){if(cD)return Mx;cD=1;function e(t,n){for(var r=-1,a=n.length,o=t.length;++r<a;)t[o+r]=n[r];return t}return Mx=e,Mx}var Px,lD;qn=function(){if(lD)return Px;lD=1;var e=Array.isArray;return Px=e,Px};var Tx,uD;function dD(){if(uD)return Tx;uD=1;var e=Ax(),t=qn();function n(r,a,o){var i=a(r);return t(r)?i:e(i,o(r))}return Tx=n,Tx}var Ix,pD;function uae(){if(pD)return Ix;pD=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=0,i=[];++r<a;){var s=t[r];n(s,r,t)&&(i[o++]=s)}return i}return Ix=e,Ix}var Rx,fD;function hD(){if(fD)return Rx;fD=1;function e(){return[]}return Rx=e,Rx}var Dx,mD;k0=function(){if(mD)return Dx;mD=1;var e=uae(),t=hD(),n=Object.prototype,r=n.propertyIsEnumerable,a=Object.getOwnPropertySymbols,o=a?function(i){return i==null?[]:(i=Object(i),e(a(i),function(s){return r.call(i,s)}))}:t;return Dx=o,Dx};var Lx,yD;function dae(){if(yD)return Lx;yD=1;function e(t,n){for(var r=-1,a=Array(t);++r<t;)a[r]=n(r);return a}return Lx=e,Lx}var $x,gD;Ia=function(){if(gD)return $x;gD=1;function e(t){return t!=null&&typeof t=="object"}return $x=e,$x};var Fx,vD;function pae(){if(vD)return Fx;vD=1;var e=Mo(),t=Ia(),n="[object Arguments]";function r(a){return t(a)&&e(a)==n}return Fx=r,Fx}var Bx,bD;wf=function(){if(bD)return Bx;bD=1;var e=pae(),t=Ia(),n=Object.prototype,r=n.hasOwnProperty,a=n.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(i){return t(i)&&r.call(i,"callee")&&!a.call(i,"callee")};return Bx=o,Bx};var Rh={exports:{}},zx,wD;function fae(){if(wD)return zx;wD=1;function e(){return!1}return zx=e,zx}Rh.exports;var xD;I0=function(){return xD||(xD=1,function(e,t){var n=Hr(),r=fae(),a=t&&!t.nodeType&&t,o=a&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===a,s=i?n.Buffer:void 0,c=s?s.isBuffer:void 0,l=c||r;e.exports=l}(Rh,Rh.exports)),Rh.exports};var Ux,_D;function Dh(){if(_D)return Ux;_D=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,a){var o=typeof r;return a=a??e,!!a&&(o=="number"||o!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<a}return Ux=n,Ux}var Vx,jD;function Wx(){if(jD)return Vx;jD=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return Vx=t,Vx}var Hx,ED;function hae(){if(ED)return Hx;ED=1;var e=Mo(),t=Wx(),n=Ia(),r="[object Arguments]",a="[object Array]",o="[object Boolean]",i="[object Date]",s="[object Error]",c="[object Function]",l="[object Map]",u="[object Number]",d="[object Object]",p="[object RegExp]",f="[object Set]",m="[object String]",y="[object WeakMap]",v="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",j="[object Int16Array]",E="[object Int32Array]",S="[object Uint8Array]",O="[object Uint8ClampedArray]",N="[object Uint16Array]",M="[object Uint32Array]",k={};k[w]=k[_]=k[x]=k[j]=k[E]=k[S]=k[O]=k[N]=k[M]=!0,k[r]=k[a]=k[v]=k[o]=k[b]=k[i]=k[s]=k[c]=k[l]=k[u]=k[d]=k[p]=k[f]=k[m]=k[y]=!1;function A(P){return n(P)&&t(P.length)&&!!k[e(P)]}return Hx=A,Hx}var qx,SD;P0=function(){if(SD)return qx;SD=1;function e(t){return function(n){return t(n)}}return qx=e,qx};var Lh={exports:{}};Lh.exports;var OD;$M=function(){return OD||(OD=1,function(e,t){var n=mR(),r=t&&!t.nodeType&&t,a=r&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===r,i=o&&n.process,s=function(){try{var c=a&&a.require&&a.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=s}(Lh,Lh.exports)),Lh.exports};var Kx,CD;Dv=function(){if(CD)return Kx;CD=1;var e=hae(),t=P0(),n=$M(),r=n&&n.isTypedArray,a=r?t(r):e;return Kx=a,Kx};var Zx,ND;function kD(){if(ND)return Zx;ND=1;var e=dae(),t=wf(),n=qn(),r=I0(),a=Dh(),o=Dv(),i=Object.prototype,s=i.hasOwnProperty;function c(l,u){var d=n(l),p=!d&&t(l),f=!d&&!p&&r(l),m=!d&&!p&&!f&&o(l),y=d||p||f||m,v=y?e(l.length,String):[],b=v.length;for(var w in l)(u||s.call(l,w))&&!(y&&(w=="length"||f&&(w=="offset"||w=="parent")||m&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||a(w,b)))&&v.push(w);return v}return Zx=c,Zx}var Gx,MD;A0=function(){if(MD)return Gx;MD=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,a=typeof r=="function"&&r.prototype||e;return n===a}return Gx=t,Gx};var Xx,AD;function PD(){if(AD)return Xx;AD=1;function e(t,n){return function(r){return t(n(r))}}return Xx=e,Xx}var Jx,TD;function mae(){if(TD)return Jx;TD=1;var e=PD(),t=e(Object.keys,Object);return Jx=t,Jx}var Yx,ID;function yae(){if(ID)return Yx;ID=1;var e=A0(),t=mae(),n=Object.prototype,r=n.hasOwnProperty;function a(o){if(!e(o))return t(o);var i=[];for(var s in Object(o))r.call(o,s)&&s!="constructor"&&i.push(s);return i}return Yx=a,Yx}var Qx,RD;Ki=function(){if(RD)return Qx;RD=1;var e=xf(),t=Wx();function n(r){return r!=null&&t(r.length)&&!e(r)}return Qx=n,Qx};var e1,DD;pu=function(){if(DD)return e1;DD=1;var e=kD(),t=yae(),n=Ki();function r(a){return n(a)?e(a):t(a)}return e1=r,e1};var t1,LD;FM=function(){if(LD)return t1;LD=1;var e=dD(),t=k0(),n=pu();function r(a){return e(a,n,t)}return t1=r,t1};var n1,$D;function gae(){if($D)return n1;$D=1;var e=FM(),t=1,n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s,c,l,u){var d=s&t,p=e(o),f=p.length,m=e(i),y=m.length;if(f!=y&&!d)return!1;for(var v=f;v--;){var b=p[v];if(!(d?b in i:r.call(i,b)))return!1}var w=u.get(o),_=u.get(i);if(w&&_)return w==i&&_==o;var x=!0;u.set(o,i),u.set(i,o);for(var j=d;++v<f;){b=p[v];var E=o[b],S=i[b];if(c)var O=d?c(S,E,b,i,o,u):c(E,S,b,o,i,u);if(!(O===void 0?E===S||l(E,S,s,c,u):O)){x=!1;break}j||(j=b=="constructor")}if(x&&!j){var N=o.constructor,M=i.constructor;N!=M&&"constructor"in o&&"constructor"in i&&!(typeof N=="function"&&N instanceof N&&typeof M=="function"&&M instanceof M)&&(x=!1)}return u.delete(o),u.delete(i),x}return n1=a,n1}var r1,FD;function vae(){if(FD)return r1;FD=1;var e=is(),t=Hr(),n=e(t,"DataView");return r1=n,r1}var a1,BD;function bae(){if(BD)return a1;BD=1;var e=is(),t=Hr(),n=e(t,"Promise");return a1=n,a1}var o1,zD;function UD(){if(zD)return o1;zD=1;var e=is(),t=Hr(),n=e(t,"Set");return o1=n,o1}var i1,VD;function wae(){if(VD)return i1;VD=1;var e=is(),t=Hr(),n=e(t,"WeakMap");return i1=n,i1}var s1,WD;LM=function(){if(WD)return s1;WD=1;var e=vae(),t=ex(),n=bae(),r=UD(),a=wae(),o=Mo(),i=OR(),s="[object Map]",c="[object Object]",l="[object Promise]",u="[object Set]",d="[object WeakMap]",p="[object DataView]",f=i(e),m=i(t),y=i(n),v=i(r),b=i(a),w=o;return(e&&w(new e(new ArrayBuffer(1)))!=p||t&&w(new t)!=s||n&&w(n.resolve())!=l||r&&w(new r)!=u||a&&w(new a)!=d)&&(w=function(_){var x=o(_),j=x==c?_.constructor:void 0,E=j?i(j):"";if(E)switch(E){case f:return p;case m:return s;case y:return l;case v:return u;case b:return d}return x}),s1=w,s1};var c1,HD;function xae(){if(HD)return c1;HD=1;var e=T0(),t=rD(),n=lae(),r=gae(),a=LM(),o=qn(),i=I0(),s=Dv(),c=1,l="[object Arguments]",u="[object Array]",d="[object Object]",p=Object.prototype,f=p.hasOwnProperty;function m(y,v,b,w,_,x){var j=o(y),E=o(v),S=j?u:a(y),O=E?u:a(v);S=S==l?d:S,O=O==l?d:O;var N=S==d,M=O==d,k=S==O;if(k&&i(y)){if(!i(v))return!1;j=!0,N=!1}if(k&&!N)return x||(x=new e),j||s(y)?t(y,v,b,w,_,x):n(y,v,S,b,w,_,x);if(!(b&c)){var A=N&&f.call(y,"__wrapped__"),P=M&&f.call(v,"__wrapped__");if(A||P){var C=A?y.value():y,T=P?v.value():v;return x||(x=new e),_(C,T,b,w,x)}}return k?(x||(x=new e),r(y,v,b,w,_,x)):!1}return c1=m,c1}var l1,qD;function u1(){if(qD)return l1;qD=1;var e=xae(),t=Ia();function n(r,a,o,i,s){return r===a?!0:r==null||a==null||!t(r)&&!t(a)?r!==r&&a!==a:e(r,a,o,i,n,s)}return l1=n,l1}var d1,KD;function _ae(){if(KD)return d1;KD=1;var e=T0(),t=u1(),n=1,r=2;function a(o,i,s,c){var l=s.length,u=l,d=!c;if(o==null)return!u;for(o=Object(o);l--;){var p=s[l];if(d&&p[2]?p[1]!==o[p[0]]:!(p[0]in o))return!1}for(;++l<u;){p=s[l];var f=p[0],m=o[f],y=p[1];if(d&&p[2]){if(m===void 0&&!(f in o))return!1}else{var v=new e;if(c)var b=c(m,y,f,o,i,v);if(!(b===void 0?t(y,m,n|r,c,v):b))return!1}}return!0}return d1=a,d1}var p1,ZD;function GD(){if(ZD)return p1;ZD=1;var e=qr();function t(n){return n===n&&!e(n)}return p1=t,p1}var f1,XD;function jae(){if(XD)return f1;XD=1;var e=GD(),t=pu();function n(r){for(var a=t(r),o=a.length;o--;){var i=a[o],s=r[i];a[o]=[i,s,e(s)]}return a}return f1=n,f1}var h1,JD;function YD(){if(JD)return h1;JD=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return h1=e,h1}var m1,QD;function Eae(){if(QD)return m1;QD=1;var e=_ae(),t=jae(),n=YD();function r(a){var o=t(a);return o.length==1&&o[0][2]?n(o[0][0],o[0][1]):function(i){return i===a||e(i,a,o)}}return m1=r,m1}var y1,e3;function gc(){if(e3)return y1;e3=1;var e=Mo(),t=Ia(),n="[object Symbol]";function r(a){return typeof a=="symbol"||t(a)&&e(a)==n}return y1=r,y1}var g1,t3;function v1(){if(t3)return g1;t3=1;var e=qn(),t=gc(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function a(o,i){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:r.test(o)||!n.test(o)||i!=null&&o in Object(i)}return g1=a,g1}var b1,n3;function r3(){if(n3)return b1;n3=1;var e=yx(),t="Expected a function";function n(r,a){if(typeof r!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var o=function(){var i=arguments,s=a?a.apply(this,i):i[0],c=o.cache;if(c.has(s))return c.get(s);var l=r.apply(this,i);return o.cache=c.set(s,l)||c,l};return o.cache=new(n.Cache||e),o}return n.Cache=e,b1=n,b1}var w1,a3;function Sae(){if(a3)return w1;a3=1;var e=r3(),t=500;function n(r){var a=e(r,function(i){return o.size===t&&o.clear(),i}),o=a.cache;return a}return w1=n,w1}var x1,o3;function Oae(){if(o3)return x1;o3=1;var e=Sae(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(a){var o=[];return a.charCodeAt(0)===46&&o.push(""),a.replace(t,function(i,s,c,l){o.push(c?l.replace(n,"$1"):s||i)}),o});return x1=r,x1}var _1,i3;iu=function(){if(i3)return _1;i3=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=Array(a);++r<a;)o[r]=n(t[r],r,t);return o}return _1=e,_1};var j1,s3;function Cae(){if(s3)return j1;s3=1;var e=Js(),t=iu(),n=qn(),r=gc(),a=1/0,o=e?e.prototype:void 0,i=o?o.toString:void 0;function s(c){if(typeof c=="string")return c;if(n(c))return t(c,s)+"";if(r(c))return i?i.call(c):"";var l=c+"";return l=="0"&&1/c==-a?"-0":l}return j1=s,j1}var E1,c3;function l3(){if(c3)return E1;c3=1;var e=Cae();function t(n){return n==null?"":e(n)}return E1=t,E1}var S1,u3;gu=function(){if(u3)return S1;u3=1;var e=qn(),t=v1(),n=Oae(),r=l3();function a(o,i){return e(o)?o:t(o,i)?[o]:n(r(o))}return S1=a,S1};var O1,d3;Ys=function(){if(d3)return O1;d3=1;var e=gc(),t=1/0;function n(r){if(typeof r=="string"||e(r))return r;var a=r+"";return a=="0"&&1/r==-t?"-0":a}return O1=n,O1};var C1,p3;yu=function(){if(p3)return C1;p3=1;var e=gu(),t=Ys();function n(r,a){a=e(a,r);for(var o=0,i=a.length;r!=null&&o<i;)r=r[t(a[o++])];return o&&o==i?r:void 0}return C1=n,C1};var N1,f3;function h3(){if(f3)return N1;f3=1;var e=yu();function t(n,r,a){var o=n==null?void 0:e(n,r);return o===void 0?a:o}return N1=t,N1}var k1,m3;function Nae(){if(m3)return k1;m3=1;function e(t,n){return t!=null&&n in Object(t)}return k1=e,k1}var M1,y3;function kae(){if(y3)return M1;y3=1;var e=gu(),t=wf(),n=qn(),r=Dh(),a=Wx(),o=Ys();function i(s,c,l){c=e(c,s);for(var u=-1,d=c.length,p=!1;++u<d;){var f=o(c[u]);if(!(p=s!=null&&l(s,f)))break;s=s[f]}return p||++u!=d?p:(d=s==null?0:s.length,!!d&&a(d)&&r(f,d)&&(n(s)||t(s)))}return M1=i,M1}var A1,g3;iM=function(){if(g3)return A1;g3=1;var e=Nae(),t=kae();function n(r,a){return r!=null&&t(r,a,e)}return A1=n,A1};var P1,v3;function Mae(){if(v3)return P1;v3=1;var e=u1(),t=h3(),n=iM(),r=v1(),a=GD(),o=YD(),i=Ys(),s=1,c=2;function l(u,d){return r(u)&&a(d)?o(i(u),d):function(p){var f=t(p,u);return f===void 0&&f===d?n(p,u):e(d,f,s|c)}}return P1=l,P1}var T1,b3;function vc(){if(b3)return T1;b3=1;function e(t){return t}return T1=e,T1}var I1,w3;function Aae(){if(w3)return I1;w3=1;function e(t){return function(n){return n==null?void 0:n[t]}}return I1=e,I1}var R1,x3;function Pae(){if(x3)return R1;x3=1;var e=yu();function t(n){return function(r){return e(r,n)}}return R1=t,R1}var D1,_3;function Tae(){if(_3)return D1;_3=1;var e=Aae(),t=Pae(),n=v1(),r=Ys();function a(o){return n(o)?e(r(o)):t(o)}return D1=a,D1}var L1,j3;function Ua(){if(j3)return L1;j3=1;var e=Eae(),t=Mae(),n=vc(),r=qn(),a=Tae();function o(i){return typeof i=="function"?i:i==null?n:typeof i=="object"?r(i)?t(i[0],i[1]):e(i):a(i)}return L1=o,L1}var $1,E3;function Iae(){if(E3)return $1;E3=1;var e="Expected a function";function t(n){if(typeof n!="function")throw new TypeError(e);return function(){var r=arguments;switch(r.length){case 0:return!n.call(this);case 1:return!n.call(this,r[0]);case 2:return!n.call(this,r[0],r[1]);case 3:return!n.call(this,r[0],r[1],r[2])}return!n.apply(this,r)}}return $1=t,$1}var F1,S3;function O3(){if(S3)return F1;S3=1;var e=is(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return F1=t,F1}var B1,C3;Fv=function(){if(C3)return B1;C3=1;var e=O3();function t(n,r,a){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[r]=a}return B1=t,B1};var z1,N3;BM=function(){if(N3)return z1;N3=1;var e=Fv(),t=su(),n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s){var c=o[i];(!(r.call(o,i)&&t(c,s))||s===void 0&&!(i in o))&&e(o,i,s)}return z1=a,z1};var U1,k3;function Rae(){if(k3)return U1;k3=1;var e=BM(),t=gu(),n=Dh(),r=qr(),a=Ys();function o(i,s,c,l){if(!r(i))return i;s=t(s,i);for(var u=-1,d=s.length,p=d-1,f=i;f!=null&&++u<d;){var m=a(s[u]),y=c;if(m==="__proto__"||m==="constructor"||m==="prototype")return i;if(u!=p){var v=f[m];y=l?l(v,m,f):void 0,y===void 0&&(y=r(v)?v:n(s[u+1])?[]:{})}e(f,m,y),f=f[m]}return i}return U1=o,U1}var V1,M3;oM=function(){if(M3)return V1;M3=1;var e=yu(),t=Rae(),n=gu();function r(a,o,i){for(var s=-1,c=o.length,l={};++s<c;){var u=o[s],d=e(a,u);i(d,u)&&t(l,n(u,a),d)}return l}return V1=r,V1};var W1,A3;M0=function(){if(A3)return W1;A3=1;var e=PD(),t=e(Object.getPrototypeOf,Object);return W1=t,W1};var H1,P3;RM=function(){if(P3)return H1;P3=1;var e=Ax(),t=M0(),n=k0(),r=hD(),a=Object.getOwnPropertySymbols,o=a?function(i){for(var s=[];i;)e(s,n(i)),i=t(i);return s}:r;return H1=o,H1};var q1,T3;function Dae(){if(T3)return q1;T3=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return q1=e,q1}var K1,I3;function Lae(){if(I3)return K1;I3=1;var e=qr(),t=A0(),n=Dae(),r=Object.prototype,a=r.hasOwnProperty;function o(i){if(!e(i))return n(i);var s=t(i),c=[];for(var l in i)l=="constructor"&&(s||!a.call(i,l))||c.push(l);return c}return K1=o,K1}var Z1,R3;IM=function(){if(R3)return Z1;R3=1;var e=kD(),t=Lae(),n=Ki();function r(a){return n(a)?e(a,!0):t(a)}return Z1=r,Z1};var G1,D3;zM=function(){if(D3)return G1;D3=1;var e=dD(),t=RM(),n=IM();function r(a){return e(a,n,t)}return G1=r,G1};var X1,L3;function $ae(){if(L3)return X1;L3=1;var e=iu(),t=Ua(),n=oM(),r=zM();function a(o,i){if(o==null)return{};var s=e(r(o),function(c){return[c]});return i=t(i),n(o,s,function(c,l){return i(c,l[0])})}return X1=a,X1}var J1,$3;function Fae(){if($3)return J1;$3=1;var e=Ua(),t=Iae(),n=$ae();function r(a,o){return n(a,t(e(o)))}return J1=r,J1}var Bae=Fae();const rd=ct(Bae);var Y1,F3;function zae(){if(F3)return Y1;F3=1;function e(t){return t===void 0}return Y1=e,Y1}var Uae=zae();const ad=ct(Uae);function rn(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=rn(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Vae={value:()=>{}};function $h(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Fh(n)}function Fh(e){this._=e}function Wae(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Fh.prototype=$h.prototype={constructor:Fh,on:function(e,t){var n=this._,r=Wae(e+"",n),a,o=-1,i=r.length;if(arguments.length<2){for(;++o<i;)if((a=(e=r[o]).type)&&(a=Hae(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<i;)if(a=(e=r[o]).type)n[a]=B3(n[a],e.name,t);else if(t==null)for(a in n)n[a]=B3(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Fh(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,o;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,a=o.length;r<a;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,o=r.length;a<o;++a)r[a].value.apply(t,n)}};function Hae(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function B3(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=Vae,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Q1="http://www.w3.org/1999/xhtml";const z3={svg:"http://www.w3.org/2000/svg",xhtml:Q1,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Bh(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),z3.hasOwnProperty(t)?{space:z3[t],local:e}:e}function qae(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Q1&&t.documentElement.namespaceURI===Q1?t.createElement(e):t.createElementNS(n,e)}}function Kae(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function U3(e){var t=Bh(e);return(t.local?Kae:qae)(t)}function Zae(){}function e_(e){return e==null?Zae:function(){return this.querySelector(e)}}function Gae(e){typeof e!="function"&&(e=e_(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=new Array(i),c,l,u=0;u<i;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),s[u]=l);return new br(r,this._parents)}function Xae(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Jae(){return[]}function V3(e){return e==null?Jae:function(){return this.querySelectorAll(e)}}function Yae(e){return function(){return Xae(e.apply(this,arguments))}}function Qae(e){typeof e=="function"?e=Yae(e):e=V3(e);for(var t=this._groups,n=t.length,r=[],a=[],o=0;o<n;++o)for(var i=t[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),a.push(c));return new br(r,a)}function W3(e){return function(){return this.matches(e)}}function H3(e){return function(t){return t.matches(e)}}var eoe=Array.prototype.find;function toe(e){return function(){return eoe.call(this.children,e)}}function noe(){return this.firstElementChild}function roe(e){return this.select(e==null?noe:toe(typeof e=="function"?e:H3(e)))}var aoe=Array.prototype.filter;function ooe(){return Array.from(this.children)}function ioe(e){return function(){return aoe.call(this.children,e)}}function soe(e){return this.selectAll(e==null?ooe:ioe(typeof e=="function"?e:H3(e)))}function coe(e){typeof e!="function"&&(e=W3(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new br(r,this._parents)}function q3(e){return new Array(e.length)}function loe(){return new br(this._enter||this._groups.map(q3),this._parents)}function zh(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}zh.prototype={constructor:zh,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function uoe(e){return function(){return e}}function doe(e,t,n,r,a,o){for(var i=0,s,c=t.length,l=o.length;i<l;++i)(s=t[i])?(s.__data__=o[i],r[i]=s):n[i]=new zh(e,o[i]);for(;i<c;++i)(s=t[i])&&(a[i]=s)}function poe(e,t,n,r,a,o,i){var s,c,l=new Map,u=t.length,d=o.length,p=new Array(u),f;for(s=0;s<u;++s)(c=t[s])&&(p[s]=f=i.call(c,c.__data__,s,t)+"",l.has(f)?a[s]=c:l.set(f,c));for(s=0;s<d;++s)f=i.call(e,o[s],s,o)+"",(c=l.get(f))?(r[s]=c,c.__data__=o[s],l.delete(f)):n[s]=new zh(e,o[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(p[s])===c&&(a[s]=c)}function foe(e){return e.__data__}function hoe(e,t){if(!arguments.length)return Array.from(this,foe);var n=t?poe:doe,r=this._parents,a=this._groups;typeof e!="function"&&(e=uoe(e));for(var o=a.length,i=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],d=a[l],p=d.length,f=moe(e.call(u,u&&u.__data__,l,r)),m=f.length,y=s[l]=new Array(m),v=i[l]=new Array(m),b=c[l]=new Array(p);n(u,d,y,v,b,f,t);for(var w=0,_=0,x,j;w<m;++w)if(x=y[w]){for(w>=_&&(_=w+1);!(j=v[_])&&++_<m;);x._next=j||null}}return i=new br(i,r),i._enter=s,i._exit=c,i}function moe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function yoe(){return new br(this._exit||this._groups.map(q3),this._parents)}function goe(e,t,n){var r=this.enter(),a=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?o.remove():n(o),r&&a?r.merge(a).order():a}function voe(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,o=r.length,i=Math.min(a,o),s=new Array(a),c=0;c<i;++c)for(var l=n[c],u=r[c],d=l.length,p=s[c]=new Array(d),f,m=0;m<d;++m)(f=l[m]||u[m])&&(p[m]=f);for(;c<a;++c)s[c]=n[c];return new br(s,this._parents)}function boe(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,o=r[a],i;--a>=0;)(i=r[a])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function woe(e){e||(e=xoe);function t(d,p){return d&&p?e(d.__data__,p.__data__):!d-!p}for(var n=this._groups,r=n.length,a=new Array(r),o=0;o<r;++o){for(var i=n[o],s=i.length,c=a[o]=new Array(s),l,u=0;u<s;++u)(l=i[u])&&(c[u]=l);c.sort(t)}return new br(a,this._parents).order()}function xoe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function _oe(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function joe(){return Array.from(this)}function Eoe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length;a<o;++a){var i=r[a];if(i)return i}return null}function Soe(){let e=0;for(const t of this)++e;return e}function Ooe(){return!this.node()}function Coe(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],o=0,i=a.length,s;o<i;++o)(s=a[o])&&e.call(s,s.__data__,o,a);return this}function Noe(e){return function(){this.removeAttribute(e)}}function koe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Moe(e,t){return function(){this.setAttribute(e,t)}}function Aoe(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Poe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Toe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Ioe(e,t){var n=Bh(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?koe:Noe:typeof t=="function"?n.local?Toe:Poe:n.local?Aoe:Moe)(n,t))}function K3(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Roe(e){return function(){this.style.removeProperty(e)}}function Doe(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Loe(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function $oe(e,t,n){return arguments.length>1?this.each((t==null?Roe:typeof t=="function"?Loe:Doe)(e,t,n??"")):bc(this.node(),e)}function bc(e,t){return e.style.getPropertyValue(t)||K3(e).getComputedStyle(e,null).getPropertyValue(t)}function Foe(e){return function(){delete this[e]}}function Boe(e,t){return function(){this[e]=t}}function zoe(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Uoe(e,t){return arguments.length>1?this.each((t==null?Foe:typeof t=="function"?zoe:Boe)(e,t)):this.node()[e]}function Z3(e){return e.trim().split(/^|\s+/)}function t_(e){return e.classList||new G3(e)}function G3(e){this._node=e,this._names=Z3(e.getAttribute("class")||"")}G3.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function X3(e,t){for(var n=t_(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function J3(e,t){for(var n=t_(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function Voe(e){return function(){X3(this,e)}}function Woe(e){return function(){J3(this,e)}}function Hoe(e,t){return function(){(t.apply(this,arguments)?X3:J3)(this,e)}}function qoe(e,t){var n=Z3(e+"");if(arguments.length<2){for(var r=t_(this.node()),a=-1,o=n.length;++a<o;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?Hoe:t?Voe:Woe)(n,t))}function Koe(){this.textContent=""}function Zoe(e){return function(){this.textContent=e}}function Goe(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Xoe(e){return arguments.length?this.each(e==null?Koe:(typeof e=="function"?Goe:Zoe)(e)):this.node().textContent}function Joe(){this.innerHTML=""}function Yoe(e){return function(){this.innerHTML=e}}function Qoe(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function eie(e){return arguments.length?this.each(e==null?Joe:(typeof e=="function"?Qoe:Yoe)(e)):this.node().innerHTML}function tie(){this.nextSibling&&this.parentNode.appendChild(this)}function nie(){return this.each(tie)}function rie(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function aie(){return this.each(rie)}function oie(e){var t=typeof e=="function"?e:U3(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function iie(){return null}function sie(e,t){var n=typeof e=="function"?e:U3(e),r=t==null?iie:typeof t=="function"?t:e_(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function cie(){var e=this.parentNode;e&&e.removeChild(this)}function lie(){return this.each(cie)}function uie(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function die(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function pie(e){return this.select(e?die:uie)}function fie(e){return arguments.length?this.property("__data__",e):this.node().__data__}function hie(e){return function(t){e.call(this,t,this.__data__)}}function mie(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function yie(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,o;n<a;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function gie(e,t,n){return function(){var r=this.__on,a,o=hie(t);if(r){for(var i=0,s=r.length;i<s;++i)if((a=r[i]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=o,a.options=n),a.value=t;return}}this.addEventListener(e.type,o,n),a={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(a):this.__on=[a]}}function vie(e,t,n){var r=mie(e+""),a,o=r.length,i;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(a=0,u=s[c];a<o;++a)if((i=r[a]).type===u.type&&i.name===u.name)return u.value}return}for(s=t?gie:yie,a=0;a<o;++a)this.each(s(r[a],t,n));return this}function Y3(e,t,n){var r=K3(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function bie(e,t){return function(){return Y3(this,e,t)}}function wie(e,t){return function(){return Y3(this,e,t.apply(this,arguments))}}function xie(e,t){return this.each((typeof t=="function"?wie:bie)(e,t))}function*_ie(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length,i;a<o;++a)(i=r[a])&&(yield i)}var Q3=[null];function br(e,t){this._groups=e,this._parents=t}function od(){return new br([[document.documentElement]],Q3)}function jie(){return this}br.prototype=od.prototype={constructor:br,select:Gae,selectAll:Qae,selectChild:roe,selectChildren:soe,filter:coe,data:hoe,enter:loe,exit:yoe,join:goe,merge:voe,selection:jie,order:boe,sort:woe,call:_oe,nodes:joe,node:Eoe,size:Soe,empty:Ooe,each:Coe,attr:Ioe,style:$oe,property:Uoe,classed:qoe,text:Xoe,html:eie,raise:nie,lower:aie,append:oie,insert:sie,remove:lie,clone:pie,datum:fie,on:vie,dispatch:xie,[Symbol.iterator]:_ie};function wr(e){return typeof e=="string"?new br([[document.querySelector(e)]],[document.documentElement]):new br([[e]],Q3)}function Eie(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ta(e,t){if(e=Eie(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const Sie={passive:!1},id={capture:!0,passive:!1};function n_(e){e.stopImmediatePropagation()}function wc(e){e.preventDefault(),e.stopImmediatePropagation()}function e4(e){var t=e.document.documentElement,n=wr(e).on("dragstart.drag",wc,id);"onselectstart"in t?n.on("selectstart.drag",wc,id):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function t4(e,t){var n=e.document.documentElement,r=wr(e).on("dragstart.drag",null);t&&(r.on("click.drag",wc,id),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Uh=e=>()=>e;function r_(e,{sourceEvent:t,subject:n,target:r,identifier:a,active:o,x:i,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}r_.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Oie(e){return!e.ctrlKey&&!e.button}function Cie(){return this.parentNode}function Nie(e,t){return t??{x:e.x,y:e.y}}function kie(){return navigator.maxTouchPoints||"ontouchstart"in this}function n4(){var e=Oie,t=Cie,n=Nie,r=kie,a={},o=$h("start","drag","end"),i=0,s,c,l,u,d=0;function p(x){x.on("mousedown.drag",f).filter(r).on("touchstart.drag",v).on("touchmove.drag",b,Sie).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(x,j){if(!(u||!e.call(this,x,j))){var E=_(this,t.call(this,x,j),x,j,"mouse");E&&(wr(x.view).on("mousemove.drag",m,id).on("mouseup.drag",y,id),e4(x.view),n_(x),l=!1,s=x.clientX,c=x.clientY,E("start",x))}}function m(x){if(wc(x),!l){var j=x.clientX-s,E=x.clientY-c;l=j*j+E*E>d}a.mouse("drag",x)}function y(x){wr(x.view).on("mousemove.drag mouseup.drag",null),t4(x.view,l),wc(x),a.mouse("end",x)}function v(x,j){if(e.call(this,x,j)){var E=x.changedTouches,S=t.call(this,x,j),O=E.length,N,M;for(N=0;N<O;++N)(M=_(this,S,x,j,E[N].identifier,E[N]))&&(n_(x),M("start",x,E[N]))}}function b(x){var j=x.changedTouches,E=j.length,S,O;for(S=0;S<E;++S)(O=a[j[S].identifier])&&(wc(x),O("drag",x,j[S]))}function w(x){var j=x.changedTouches,E=j.length,S,O;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),S=0;S<E;++S)(O=a[j[S].identifier])&&(n_(x),O("end",x,j[S]))}function _(x,j,E,S,O,N){var M=o.copy(),k=ta(N||E,j),A,P,C;if((C=n.call(x,new r_("beforestart",{sourceEvent:E,target:p,identifier:O,active:i,x:k[0],y:k[1],dx:0,dy:0,dispatch:M}),S))!=null)return A=C.x-k[0]||0,P=C.y-k[1]||0,function T(I,R,L){var D=k,z;switch(I){case"start":a[O]=T,z=i++;break;case"end":delete a[O],--i;case"drag":k=ta(L||R,j),z=i;break}M.call(I,x,new r_(I,{sourceEvent:R,subject:C,target:p,identifier:O,active:z,x:k[0]+A,y:k[1]+P,dx:k[0]-D[0],dy:k[1]-D[1],dispatch:M}),S)}}return p.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Uh(!!x),p):e},p.container=function(x){return arguments.length?(t=typeof x=="function"?x:Uh(x),p):t},p.subject=function(x){return arguments.length?(n=typeof x=="function"?x:Uh(x),p):n},p.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:Uh(!!x),p):r},p.on=function(){var x=o.on.apply(o,arguments);return x===o?p:x},p.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,p):Math.sqrt(d)},p}function a_(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function r4(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function sd(){}var cd=.7,Vh=1/cd,xc="\\s*([+-]?\\d+)\\s*",ld="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Va="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Mie=/^#([0-9a-f]{3,8})$/,Aie=new RegExp(`^rgb\\(${xc},${xc},${xc}\\)$`),Pie=new RegExp(`^rgb\\(${Va},${Va},${Va}\\)$`),Tie=new RegExp(`^rgba\\(${xc},${xc},${xc},${ld}\\)$`),Iie=new RegExp(`^rgba\\(${Va},${Va},${Va},${ld}\\)$`),Rie=new RegExp(`^hsl\\(${ld},${Va},${Va}\\)$`),Die=new RegExp(`^hsla\\(${ld},${Va},${Va},${ld}\\)$`),a4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};a_(sd,ss,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:o4,formatHex:o4,formatHex8:Lie,formatHsl:$ie,formatRgb:i4,toString:i4});function o4(){return this.rgb().formatHex()}function Lie(){return this.rgb().formatHex8()}function $ie(){return d4(this).formatHsl()}function i4(){return this.rgb().formatRgb()}function ss(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Mie.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?s4(t):n===3?new er(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Wh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Wh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Aie.exec(e))?new er(t[1],t[2],t[3],1):(t=Pie.exec(e))?new er(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Tie.exec(e))?Wh(t[1],t[2],t[3],t[4]):(t=Iie.exec(e))?Wh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Rie.exec(e))?u4(t[1],t[2]/100,t[3]/100,1):(t=Die.exec(e))?u4(t[1],t[2]/100,t[3]/100,t[4]):a4.hasOwnProperty(e)?s4(a4[e]):e==="transparent"?new er(NaN,NaN,NaN,0):null}function s4(e){return new er(e>>16&255,e>>8&255,e&255,1)}function Wh(e,t,n,r){return r<=0&&(e=t=n=NaN),new er(e,t,n,r)}function Fie(e){return e instanceof sd||(e=ss(e)),e?(e=e.rgb(),new er(e.r,e.g,e.b,e.opacity)):new er}function o_(e,t,n,r){return arguments.length===1?Fie(e):new er(e,t,n,r??1)}function er(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}a_(er,o_,r4(sd,{brighter(e){return e=e==null?Vh:Math.pow(Vh,e),new er(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?cd:Math.pow(cd,e),new er(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new er(cs(this.r),cs(this.g),cs(this.b),Hh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:c4,formatHex:c4,formatHex8:Bie,formatRgb:l4,toString:l4}));function c4(){return`#${ls(this.r)}${ls(this.g)}${ls(this.b)}`}function Bie(){return`#${ls(this.r)}${ls(this.g)}${ls(this.b)}${ls((isNaN(this.opacity)?1:this.opacity)*255)}`}function l4(){const e=Hh(this.opacity);return`${e===1?"rgb(":"rgba("}${cs(this.r)}, ${cs(this.g)}, ${cs(this.b)}${e===1?")":`, ${e})`}`}function Hh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function cs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ls(e){return e=cs(e),(e<16?"0":"")+e.toString(16)}function u4(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new na(e,t,n,r)}function d4(e){if(e instanceof na)return new na(e.h,e.s,e.l,e.opacity);if(e instanceof sd||(e=ss(e)),!e)return new na;if(e instanceof na)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,s=o-a,c=(o+a)/2;return s?(t===o?i=(n-r)/s+(n<r)*6:n===o?i=(r-t)/s+2:i=(t-n)/s+4,s/=c<.5?o+a:2-o-a,i*=60):s=c>0&&c<1?0:i,new na(i,s,c,e.opacity)}function zie(e,t,n,r){return arguments.length===1?d4(e):new na(e,t,n,r??1)}function na(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}a_(na,zie,r4(sd,{brighter(e){return e=e==null?Vh:Math.pow(Vh,e),new na(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?cd:Math.pow(cd,e),new na(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new er(i_(e>=240?e-240:e+120,a,r),i_(e,a,r),i_(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new na(p4(this.h),qh(this.s),qh(this.l),Hh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Hh(this.opacity);return`${e===1?"hsl(":"hsla("}${p4(this.h)}, ${qh(this.s)*100}%, ${qh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function p4(e){return e=(e||0)%360,e<0?e+360:e}function qh(e){return Math.max(0,Math.min(1,e||0))}function i_(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const s_=e=>()=>e;function Uie(e,t){return function(n){return e+n*t}}function Vie(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Wie(e){return(e=+e)==1?f4:function(t,n){return n-t?Vie(t,n,e):s_(isNaN(t)?n:t)}}function f4(e,t){var n=t-e;return n?Uie(e,n):s_(isNaN(e)?t:e)}const Kh=function e(t){var n=Wie(t);function r(a,o){var i=n((a=o_(a)).r,(o=o_(o)).r),s=n(a.g,o.g),c=n(a.b,o.b),l=f4(a.opacity,o.opacity);return function(u){return a.r=i(u),a.g=s(u),a.b=c(u),a.opacity=l(u),a+""}}return r.gamma=e,r}(1);function Hie(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(o){for(a=0;a<n;++a)r[a]=e[a]*(1-o)+t[a]*o;return r}}function qie(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Kie(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),o=new Array(n),i;for(i=0;i<r;++i)a[i]=_c(e[i],t[i]);for(;i<n;++i)o[i]=t[i];return function(s){for(i=0;i<r;++i)o[i]=a[i](s);return o}}function Zie(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ra(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Gie(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=_c(e[a],t[a]):r[a]=t[a];return function(o){for(a in n)r[a]=n[a](o);return r}}var c_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,l_=new RegExp(c_.source,"g");function Xie(e){return function(){return e}}function Jie(e){return function(t){return e(t)+""}}function h4(e,t){var n=c_.lastIndex=l_.lastIndex=0,r,a,o,i=-1,s=[],c=[];for(e=e+"",t=t+"";(r=c_.exec(e))&&(a=l_.exec(t));)(o=a.index)>n&&(o=t.slice(n,o),s[i]?s[i]+=o:s[++i]=o),(r=r[0])===(a=a[0])?s[i]?s[i]+=a:s[++i]=a:(s[++i]=null,c.push({i,x:ra(r,a)})),n=l_.lastIndex;return n<t.length&&(o=t.slice(n),s[i]?s[i]+=o:s[++i]=o),s.length<2?c[0]?Jie(c[0].x):Xie(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)s[(d=c[u]).i]=d.x(l);return s.join("")})}function _c(e,t){var n=typeof t,r;return t==null||n==="boolean"?s_(t):(n==="number"?ra:n==="string"?(r=ss(t))?(t=r,Kh):h4:t instanceof ss?Kh:t instanceof Date?Zie:qie(t)?Hie:Array.isArray(t)?Kie:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Gie:ra)(e,t)}function u_(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var m4=180/Math.PI,y4={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function g4(e,t,n,r,a,o){var i,s,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:a,translateY:o,rotate:Math.atan2(t,e)*m4,skewX:Math.atan(c)*m4,scaleX:i,scaleY:s}}var Zh;function Yie(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?y4:g4(t.a,t.b,t.c,t.d,t.e,t.f)}function Qie(e){return e==null||(Zh||(Zh=document.createElementNS("http://www.w3.org/2000/svg","g")),Zh.setAttribute("transform",e),!(e=Zh.transform.baseVal.consolidate()))?y4:(e=e.matrix,g4(e.a,e.b,e.c,e.d,e.e,e.f))}function v4(e,t,n,r){function a(l){return l.length?l.pop()+" ":""}function o(l,u,d,p,f,m){if(l!==d||u!==p){var y=f.push("translate(",null,t,null,n);m.push({i:y-4,x:ra(l,d)},{i:y-2,x:ra(u,p)})}else(d||p)&&f.push("translate("+d+t+p+n)}function i(l,u,d,p){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),p.push({i:d.push(a(d)+"rotate(",null,r)-2,x:ra(l,u)})):u&&d.push(a(d)+"rotate("+u+r)}function s(l,u,d,p){l!==u?p.push({i:d.push(a(d)+"skewX(",null,r)-2,x:ra(l,u)}):u&&d.push(a(d)+"skewX("+u+r)}function c(l,u,d,p,f,m){if(l!==d||u!==p){var y=f.push(a(f)+"scale(",null,",",null,")");m.push({i:y-4,x:ra(l,d)},{i:y-2,x:ra(u,p)})}else(d!==1||p!==1)&&f.push(a(f)+"scale("+d+","+p+")")}return function(l,u){var d=[],p=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,d,p),i(l.rotate,u.rotate,d,p),s(l.skewX,u.skewX,d,p),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,p),l=u=null,function(f){for(var m=-1,y=p.length,v;++m<y;)d[(v=p[m]).i]=v.x(f);return d.join("")}}}var ese=v4(Yie,"px, ","px)","deg)"),tse=v4(Qie,", ",")",")"),nse=1e-12;function b4(e){return((e=Math.exp(e))+1/e)/2}function rse(e){return((e=Math.exp(e))-1/e)/2}function ase(e){return((e=Math.exp(2*e))-1)/(e+1)}const ose=function e(t,n,r){function a(o,i){var s=o[0],c=o[1],l=o[2],u=i[0],d=i[1],p=i[2],f=u-s,m=d-c,y=f*f+m*m,v,b;if(y<nse)b=Math.log(p/l)/t,v=function(S){return[s+S*f,c+S*m,l*Math.exp(t*S*b)]};else{var w=Math.sqrt(y),_=(p*p-l*l+r*y)/(2*l*n*w),x=(p*p-l*l-r*y)/(2*p*n*w),j=Math.log(Math.sqrt(_*_+1)-_),E=Math.log(Math.sqrt(x*x+1)-x);b=(E-j)/t,v=function(S){var O=S*b,N=b4(j),M=l/(n*w)*(N*ase(t*O+j)-rse(j));return[s+M*f,c+M*m,l*N/b4(t*O+j)]}}return v.duration=b*1e3*t/Math.SQRT2,v}return a.rho=function(o){var i=Math.max(.001,+o),s=i*i,c=s*s;return e(i,s,c)},a}(Math.SQRT2,2,4);function ise(e,t){t===void 0&&(t=e,e=_c);for(var n=0,r=t.length-1,a=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(a,a=t[++n]);return function(i){var s=Math.max(0,Math.min(r-1,Math.floor(i*=r)));return o[s](i-s)}}var jc=0,ud=0,dd=0,w4=1e3,Gh,pd,Xh=0,us=0,Jh=0,fd=typeof performance=="object"&&performance.now?performance:Date,x4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function d_(){return us||(x4(sse),us=fd.now()+Jh)}function sse(){us=0}function Yh(){this._call=this._time=this._next=null}Yh.prototype=_4.prototype={constructor:Yh,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?d_():+n)+(t==null?0:+t),!this._next&&pd!==this&&(pd?pd._next=this:Gh=this,pd=this),this._call=e,this._time=n,p_()},stop:function(){this._call&&(this._call=null,this._time=1/0,p_())}};function _4(e,t,n){var r=new Yh;return r.restart(e,t,n),r}function cse(){d_(),++jc;for(var e=Gh,t;e;)(t=us-e._time)>=0&&e._call.call(void 0,t),e=e._next;--jc}function j4(){us=(Xh=fd.now())+Jh,jc=ud=0;try{cse()}finally{jc=0,use(),us=0}}function lse(){var e=fd.now(),t=e-Xh;t>w4&&(Jh-=t,Xh=e)}function use(){for(var e,t=Gh,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Gh=n);pd=e,p_(r)}function p_(e){if(!jc){ud&&(ud=clearTimeout(ud));var t=e-us;t>24?(e<1/0&&(ud=setTimeout(j4,e-fd.now()-Jh)),dd&&(dd=clearInterval(dd))):(dd||(Xh=fd.now(),dd=setInterval(lse,w4)),jc=1,x4(j4))}}function E4(e,t,n){var r=new Yh;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var dse=$h("start","end","cancel","interrupt"),pse=[],S4=0,O4=1,f_=2,Qh=3,C4=4,h_=5,em=6;function tm(e,t,n,r,a,o){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;fse(e,n,{name:t,index:r,group:a,on:dse,tween:pse,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:S4})}function m_(e,t){var n=aa(e,t);if(n.state>S4)throw new Error("too late; already scheduled");return n}function Wa(e,t){var n=aa(e,t);if(n.state>Qh)throw new Error("too late; already running");return n}function aa(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function fse(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=_4(o,0,n.time);function o(l){n.state=O4,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var u,d,p,f;if(n.state!==O4)return c();for(u in r)if(f=r[u],f.name===n.name){if(f.state===Qh)return E4(i);f.state===C4?(f.state=em,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete r[u]):+u<t&&(f.state=em,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete r[u])}if(E4(function(){n.state===Qh&&(n.state=C4,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=f_,n.on.call("start",e,e.__data__,n.index,n.group),n.state===f_){for(n.state=Qh,a=new Array(p=n.tween.length),u=0,d=-1;u<p;++u)(f=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(a[++d]=f);a.length=d+1}}function s(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=h_,1),d=-1,p=a.length;++d<p;)a[d].call(e,u);n.state===h_&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=em,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function nm(e,t){var n=e.__transition,r,a,o=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){o=!1;continue}a=r.state>f_&&r.state<h_,r.state=em,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}o&&delete e.__transition}}function hse(e){return this.each(function(){nm(this,e)})}function mse(e,t){var n,r;return function(){var a=Wa(this,e),o=a.tween;if(o!==n){r=n=o;for(var i=0,s=r.length;i<s;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}a.tween=r}}function yse(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var o=Wa(this,e),i=o.tween;if(i!==r){a=(r=i).slice();for(var s={name:t,value:n},c=0,l=a.length;c<l;++c)if(a[c].name===t){a[c]=s;break}c===l&&a.push(s)}o.tween=a}}function gse(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=aa(this.node(),n).tween,a=0,o=r.length,i;a<o;++a)if((i=r[a]).name===e)return i.value;return null}return this.each((t==null?mse:yse)(n,e,t))}function y_(e,t,n){var r=e._id;return e.each(function(){var a=Wa(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return aa(a,r).value[t]}}function N4(e,t){var n;return(typeof t=="number"?ra:t instanceof ss?Kh:(n=ss(t))?(t=n,Kh):h4)(e,t)}function vse(e){return function(){this.removeAttribute(e)}}function bse(e){return function(){this.removeAttributeNS(e.space,e.local)}}function wse(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttribute(e);return i===a?null:i===r?o:o=t(r=i,n)}}function xse(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===r?o:o=t(r=i,n)}}function _se(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function jse(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function Ese(e,t){var n=Bh(e),r=n==="transform"?tse:N4;return this.attrTween(e,typeof t=="function"?(n.local?jse:_se)(n,r,y_(this,"attr."+e,t)):t==null?(n.local?bse:vse)(n):(n.local?xse:wse)(n,r,t))}function Sse(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Ose(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Cse(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Ose(e,o)),n}return a._value=t,a}function Nse(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Sse(e,o)),n}return a._value=t,a}function kse(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Bh(e);return this.tween(n,(r.local?Cse:Nse)(r,t))}function Mse(e,t){return function(){m_(this,e).delay=+t.apply(this,arguments)}}function Ase(e,t){return t=+t,function(){m_(this,e).delay=t}}function Pse(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Mse:Ase)(t,e)):aa(this.node(),t).delay}function Tse(e,t){return function(){Wa(this,e).duration=+t.apply(this,arguments)}}function Ise(e,t){return t=+t,function(){Wa(this,e).duration=t}}function Rse(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Tse:Ise)(t,e)):aa(this.node(),t).duration}function Dse(e,t){if(typeof t!="function")throw new Error;return function(){Wa(this,e).ease=t}}function Lse(e){var t=this._id;return arguments.length?this.each(Dse(t,e)):aa(this.node(),t).ease}function $se(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Wa(this,e).ease=n}}function Fse(e){if(typeof e!="function")throw new Error;return this.each($se(this._id,e))}function Bse(e){typeof e!="function"&&(e=W3(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new Ao(r,this._parents,this._name,this._id)}function zse(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,o=Math.min(r,a),i=new Array(r),s=0;s<o;++s)for(var c=t[s],l=n[s],u=c.length,d=i[s]=new Array(u),p,f=0;f<u;++f)(p=c[f]||l[f])&&(d[f]=p);for(;s<r;++s)i[s]=t[s];return new Ao(i,this._parents,this._name,this._id)}function Use(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Vse(e,t,n){var r,a,o=Use(t)?m_:Wa;return function(){var i=o(this,e),s=i.on;s!==r&&(a=(r=s).copy()).on(t,n),i.on=a}}function Wse(e,t){var n=this._id;return arguments.length<2?aa(this.node(),n).on.on(e):this.each(Vse(n,e,t))}function Hse(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function qse(){return this.on("end.remove",Hse(this._id))}function Kse(e){var t=this._name,n=this._id;typeof e!="function"&&(e=e_(e));for(var r=this._groups,a=r.length,o=new Array(a),i=0;i<a;++i)for(var s=r[i],c=s.length,l=o[i]=new Array(c),u,d,p=0;p<c;++p)(u=s[p])&&(d=e.call(u,u.__data__,p,s))&&("__data__"in u&&(d.__data__=u.__data__),l[p]=d,tm(l[p],t,n,p,l,aa(u,n)));return new Ao(o,this._parents,t,n)}function Zse(e){var t=this._name,n=this._id;typeof e!="function"&&(e=V3(e));for(var r=this._groups,a=r.length,o=[],i=[],s=0;s<a;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var p=e.call(u,u.__data__,d,c),f,m=aa(u,n),y=0,v=p.length;y<v;++y)(f=p[y])&&tm(f,t,n,y,p,m);o.push(p),i.push(u)}return new Ao(o,i,t,n)}var Gse=od.prototype.constructor;function Xse(){return new Gse(this._groups,this._parents)}function Jse(e,t){var n,r,a;return function(){var o=bc(this,e),i=(this.style.removeProperty(e),bc(this,e));return o===i?null:o===n&&i===r?a:a=t(n=o,r=i)}}function k4(e){return function(){this.style.removeProperty(e)}}function Yse(e,t,n){var r,a=n+"",o;return function(){var i=bc(this,e);return i===a?null:i===r?o:o=t(r=i,n)}}function Qse(e,t,n){var r,a,o;return function(){var i=bc(this,e),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),bc(this,e))),i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s))}}function ece(e,t){var n,r,a,o="style."+t,i="end."+o,s;return function(){var c=Wa(this,e),l=c.on,u=c.value[o]==null?s||(s=k4(t)):void 0;(l!==n||a!==u)&&(r=(n=l).copy()).on(i,a=u),c.on=r}}function tce(e,t,n){var r=(e+="")=="transform"?ese:N4;return t==null?this.styleTween(e,Jse(e,r)).on("end.style."+e,k4(e)):typeof t=="function"?this.styleTween(e,Qse(e,r,y_(this,"style."+e,t))).each(ece(this._id,e)):this.styleTween(e,Yse(e,r,t),n).on("end.style."+e,null)}function nce(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function rce(e,t,n){var r,a;function o(){var i=t.apply(this,arguments);return i!==a&&(r=(a=i)&&nce(e,i,n)),r}return o._value=t,o}function ace(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,rce(e,t,n??""))}function oce(e){return function(){this.textContent=e}}function ice(e){return function(){var t=e(this);this.textContent=t??""}}function sce(e){return this.tween("text",typeof e=="function"?ice(y_(this,"text",e)):oce(e==null?"":e+""))}function cce(e){return function(t){this.textContent=e.call(this,t)}}function lce(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&cce(a)),t}return r._value=e,r}function uce(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,lce(e))}function dce(){for(var e=this._name,t=this._id,n=M4(),r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)if(c=i[l]){var u=aa(c,t);tm(c,e,n,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ao(r,this._parents,e,n)}function pce(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(o,i){var s={value:i},c={value:function(){--a===0&&o()}};n.each(function(){var l=Wa(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),l.on=t}),a===0&&o()})}var fce=0;function Ao(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function M4(){return++fce}var Po=od.prototype;Ao.prototype={constructor:Ao,select:Kse,selectAll:Zse,selectChild:Po.selectChild,selectChildren:Po.selectChildren,filter:Bse,merge:zse,selection:Xse,transition:dce,call:Po.call,nodes:Po.nodes,node:Po.node,size:Po.size,empty:Po.empty,each:Po.each,on:Wse,attr:Ese,attrTween:kse,style:tce,styleTween:ace,text:sce,textTween:uce,remove:qse,tween:gse,delay:Pse,duration:Rse,ease:Lse,easeVarying:Fse,end:pce,[Symbol.iterator]:Po[Symbol.iterator]};function hce(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var mce={time:null,delay:0,duration:250,ease:hce};function yce(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function gce(e){var t,n;e instanceof Ao?(t=e._id,e=e._name):(t=M4(),(n=mce).time=d_(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&tm(c,e,t,l,i,n||yce(c,t));return new Ao(r,this._parents,e,t)}od.prototype.interrupt=hse,od.prototype.transition=gce;const rm=e=>()=>e;function vce(e,{sourceEvent:t,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function To(e,t,n){this.k=e,this.x=t,this.y=n}To.prototype={constructor:To,scale:function(e){return e===1?this:new To(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new To(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var am=new To(1,0,0);A4.prototype=To.prototype;function A4(e){for(;!e.__zoom;)if(!(e=e.parentNode))return am;return e.__zoom}function g_(e){e.stopImmediatePropagation()}function hd(e){e.preventDefault(),e.stopImmediatePropagation()}function bce(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function wce(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function P4(){return this.__zoom||am}function xce(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function _ce(){return navigator.maxTouchPoints||"ontouchstart"in this}function jce(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function T4(){var e=bce,t=wce,n=jce,r=xce,a=_ce,o=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,c=ose,l=$h("start","zoom","end"),u,d,p,f=500,m=150,y=0,v=10;function b(C){C.property("__zoom",P4).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",N).on("dblclick.zoom",M).filter(a).on("touchstart.zoom",k).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",P).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(C,T,I,R){var L=C.selection?C.selection():C;L.property("__zoom",P4),C!==L?j(C,T,I,R):L.interrupt().each(function(){E(this,arguments).event(R).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},b.scaleBy=function(C,T,I,R){b.scaleTo(C,function(){var L=this.__zoom.k,D=typeof T=="function"?T.apply(this,arguments):T;return L*D},I,R)},b.scaleTo=function(C,T,I,R){b.transform(C,function(){var L=t.apply(this,arguments),D=this.__zoom,z=I==null?x(L):typeof I=="function"?I.apply(this,arguments):I,U=D.invert(z),$=typeof T=="function"?T.apply(this,arguments):T;return n(_(w(D,$),z,U),L,i)},I,R)},b.translateBy=function(C,T,I,R){b.transform(C,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),i)},null,R)},b.translateTo=function(C,T,I,R,L){b.transform(C,function(){var D=t.apply(this,arguments),z=this.__zoom,U=R==null?x(D):typeof R=="function"?R.apply(this,arguments):R;return n(am.translate(U[0],U[1]).scale(z.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof I=="function"?-I.apply(this,arguments):-I),D,i)},R,L)};function w(C,T){return T=Math.max(o[0],Math.min(o[1],T)),T===C.k?C:new To(T,C.x,C.y)}function _(C,T,I){var R=T[0]-I[0]*C.k,L=T[1]-I[1]*C.k;return R===C.x&&L===C.y?C:new To(C.k,R,L)}function x(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function j(C,T,I,R){C.on("start.zoom",function(){E(this,arguments).event(R).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(R).end()}).tween("zoom",function(){var L=this,D=arguments,z=E(L,D).event(R),U=t.apply(L,D),$=I==null?x(U):typeof I=="function"?I.apply(L,D):I,V=Math.max(U[1][0]-U[0][0],U[1][1]-U[0][1]),F=L.__zoom,W=typeof T=="function"?T.apply(L,D):T,re=c(F.invert($).concat(V/F.k),W.invert($).concat(V/W.k));return function(ee){if(ee===1)ee=W;else{var G=re(ee),K=V/G[2];ee=new To(K,$[0]-G[0]*K,$[1]-G[1]*K)}z.zoom(null,ee)}})}function E(C,T,I){return!I&&C.__zooming||new S(C,T)}function S(C,T){this.that=C,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,T),this.taps=0}S.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,T){return this.mouse&&C!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var T=wr(this.that).datum();l.call(C,this.that,new vce(C,{sourceEvent:this.sourceEvent,target:b,type:C,transform:this.that.__zoom,dispatch:l}),T)}};function O(C,...T){if(!e.apply(this,arguments))return;var I=E(this,T).event(C),R=this.__zoom,L=Math.max(o[0],Math.min(o[1],R.k*Math.pow(2,r.apply(this,arguments)))),D=ta(C);if(I.wheel)(I.mouse[0][0]!==D[0]||I.mouse[0][1]!==D[1])&&(I.mouse[1]=R.invert(I.mouse[0]=D)),clearTimeout(I.wheel);else{if(R.k===L)return;I.mouse=[D,R.invert(D)],nm(this),I.start()}hd(C),I.wheel=setTimeout(z,m),I.zoom("mouse",n(_(w(R,L),I.mouse[0],I.mouse[1]),I.extent,i));function z(){I.wheel=null,I.end()}}function N(C,...T){if(p||!e.apply(this,arguments))return;var I=C.currentTarget,R=E(this,T,!0).event(C),L=wr(C.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",V,!0),D=ta(C,I),z=C.clientX,U=C.clientY;e4(C.view),g_(C),R.mouse=[D,this.__zoom.invert(D)],nm(this),R.start();function $(F){if(hd(F),!R.moved){var W=F.clientX-z,re=F.clientY-U;R.moved=W*W+re*re>y}R.event(F).zoom("mouse",n(_(R.that.__zoom,R.mouse[0]=ta(F,I),R.mouse[1]),R.extent,i))}function V(F){L.on("mousemove.zoom mouseup.zoom",null),t4(F.view,R.moved),hd(F),R.event(F).end()}}function M(C,...T){if(e.apply(this,arguments)){var I=this.__zoom,R=ta(C.changedTouches?C.changedTouches[0]:C,this),L=I.invert(R),D=I.k*(C.shiftKey?.5:2),z=n(_(w(I,D),R,L),t.apply(this,T),i);hd(C),s>0?wr(this).transition().duration(s).call(j,z,R,C):wr(this).call(b.transform,z,R,C)}}function k(C,...T){if(e.apply(this,arguments)){var I=C.touches,R=I.length,L=E(this,T,C.changedTouches.length===R).event(C),D,z,U,$;for(g_(C),z=0;z<R;++z)U=I[z],$=ta(U,this),$=[$,this.__zoom.invert($),U.identifier],L.touch0?!L.touch1&&L.touch0[2]!==$[2]&&(L.touch1=$,L.taps=0):(L.touch0=$,D=!0,L.taps=1+!!u);u&&(u=clearTimeout(u)),D&&(L.taps<2&&(d=$[0],u=setTimeout(function(){u=null},f)),nm(this),L.start())}}function A(C,...T){if(this.__zooming){var I=E(this,T).event(C),R=C.changedTouches,L=R.length,D,z,U,$;for(hd(C),D=0;D<L;++D)z=R[D],U=ta(z,this),I.touch0&&I.touch0[2]===z.identifier?I.touch0[0]=U:I.touch1&&I.touch1[2]===z.identifier&&(I.touch1[0]=U);if(z=I.that.__zoom,I.touch1){var V=I.touch0[0],F=I.touch0[1],W=I.touch1[0],re=I.touch1[1],ee=(ee=W[0]-V[0])*ee+(ee=W[1]-V[1])*ee,G=(G=re[0]-F[0])*G+(G=re[1]-F[1])*G;z=w(z,Math.sqrt(ee/G)),U=[(V[0]+W[0])/2,(V[1]+W[1])/2],$=[(F[0]+re[0])/2,(F[1]+re[1])/2]}else if(I.touch0)U=I.touch0[0],$=I.touch0[1];else return;I.zoom("touch",n(_(z,U,$),I.extent,i))}}function P(C,...T){if(this.__zooming){var I=E(this,T).event(C),R=C.changedTouches,L=R.length,D,z;for(g_(C),p&&clearTimeout(p),p=setTimeout(function(){p=null},f),D=0;D<L;++D)z=R[D],I.touch0&&I.touch0[2]===z.identifier?delete I.touch0:I.touch1&&I.touch1[2]===z.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(z=ta(z,this),Math.hypot(d[0]-z[0],d[1]-z[1])<v)){var U=wr(this).on("dblclick.zoom");U&&U.apply(this,arguments)}}}return b.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:rm(+C),b):r},b.filter=function(C){return arguments.length?(e=typeof C=="function"?C:rm(!!C),b):e},b.touchable=function(C){return arguments.length?(a=typeof C=="function"?C:rm(!!C),b):a},b.extent=function(C){return arguments.length?(t=typeof C=="function"?C:rm([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),b):t},b.scaleExtent=function(C){return arguments.length?(o[0]=+C[0],o[1]=+C[1],b):[o[0],o[1]]},b.translateExtent=function(C){return arguments.length?(i[0][0]=+C[0][0],i[1][0]=+C[1][0],i[0][1]=+C[0][1],i[1][1]=+C[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(C){return arguments.length?(n=C,b):n},b.duration=function(C){return arguments.length?(s=+C,b):s},b.interpolate=function(C){return arguments.length?(c=C,b):c},b.on=function(){var C=l.on.apply(l,arguments);return C===l?b:C},b.clickDistance=function(C){return arguments.length?(y=(C=+C)*C,b):Math.sqrt(y)},b.tapDistance=function(C){return arguments.length?(v=+C,b):v},b}const Io={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},md=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],I4=["Enter"," ","Escape"];var Ec;(function(e){e.Strict="strict",e.Loose="loose"})(Ec||(Ec={}));var yi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(yi||(yi={}));var yd;(function(e){e.Partial="partial",e.Full="full"})(yd||(yd={}));const R4={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var gi;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(gi||(gi={}));var om;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(om||(om={}));var he;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(he||(he={}));const D4={[he.Left]:he.Right,[he.Right]:he.Left,[he.Top]:he.Bottom,[he.Bottom]:he.Top};function Ece(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function L4(e,t,n){if(!n)return;const r=[];e.forEach((a,o)=>{t!=null&&t.has(o)||r.push(a)}),r.length&&n(r)}function $4(e){return e===null?null:e?"valid":"invalid"}const F4=e=>"id"in e&&"source"in e&&"target"in e,Sce=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),v_=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),gd=(e,t=[0,0])=>{const{width:n,height:r}=Ro(e),a=e.origin??t,o=n*a[0],i=r*a[1];return{x:e.position.x-o,y:e.position.y-i}},Oce=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,a)=>{const o=typeof a=="string";let i=!t.nodeLookup&&!o?a:void 0;t.nodeLookup&&(i=o?t.nodeLookup.get(a):v_(a)?a:t.nodeLookup.get(a.id));const s=i?cm(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return im(r,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return sm(n)},vd=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const a=cm(r);n=im(n,a)}}),sm(n)},B4=(e,t,[n,r,a]=[0,0,1],o=!1,i=!1)=>{const s={...wd(t,[n,r,a]),width:t.width/a,height:t.height/a},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:p=!1}=l;if(i&&!d||p)continue;const f=u.width??l.width??l.initialWidth??null,m=u.height??l.height??l.initialHeight??null,y=bd(s,Oc(l)),v=(f??0)*(m??0),b=o&&y>0;(!l.internals.handleBounds||b||y>=v||l.dragging)&&c.push(l)}return c},Cce=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function b_(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&(t!=null&&t.includeHiddenNodes||!a.hidden)&&(!r||r.has(a.id))&&n.set(a.id,a)}),n}async function w_({nodes:e,width:t,height:n,panZoom:r,minZoom:a,maxZoom:o},i){if(e.size===0)return Promise.resolve(!1);const s=vd(e),c=__(s,t,n,(i==null?void 0:i.minZoom)??a,(i==null?void 0:i.maxZoom)??o,(i==null?void 0:i.padding)??.1);return await r.setViewport(c,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function z4({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:a,onError:o}){const i=n.get(e),s=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=s?s.internals.positionAbsolute:{x:0,y:0},u=i.origin??r;let d=a;if(i.extent==="parent"&&!i.expandParent)if(!s)o==null||o("005",Io.error005());else{const f=s.measured.width,m=s.measured.height;f&&m&&(d=[[c,l],[c+f,l+m]])}else s&&Cc(i.extent)&&(d=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const p=Cc(d)?ds(t,d,i.measured):t;return{position:{x:p.x-c+i.measured.width*u[0],y:p.y-l+i.measured.height*u[1]},positionAbsolute:p}}async function Nce({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:a}){const o=new Set(e.map(d=>d.id)),i=[];for(const d of n){if(d.deletable===!1)continue;const p=o.has(d.id),f=!p&&d.parentId&&i.find(m=>m.id===d.parentId);(p||f)&&i.push(d)}const s=new Set(t.map(d=>d.id)),c=r.filter(d=>d.deletable!==!1),l=Cce(i,c);for(const d of c)s.has(d.id)&&!l.find(p=>p.id===d.id)&&l.push(d);if(!a)return{edges:l,nodes:i};const u=await a({nodes:i,edges:l});return typeof u=="boolean"?u?{edges:l,nodes:i}:{edges:[],nodes:[]}:u}const Sc=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),ds=(e={x:0,y:0},t,n)=>({x:Sc(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Sc(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function U4(e,t,n){const{width:r,height:a}=Ro(n),{x:o,y:i}=n.internals.positionAbsolute;return ds(e,[[o,i],[o+r,i+a]],t)}const V4=(e,t,n)=>e<t?Sc(Math.abs(e-t),1,t)/t:e>n?-Sc(Math.abs(e-n),1,t)/t:0,W4=(e,t,n=15,r=40)=>{const a=V4(e.x,r,t.width-r)*n,o=V4(e.y,r,t.height-r)*n;return[a,o]},im=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),x_=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),sm=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Oc=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=v_(e)?e.internals.positionAbsolute:gd(e,t);return{x:n,y:r,width:((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0,height:((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0}},cm=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=v_(e)?e.internals.positionAbsolute:gd(e,t);return{x:n,y:r,x2:n+(((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0),y2:r+(((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0)}},H4=(e,t)=>sm(im(x_(e),x_(t))),bd=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},q4=e=>oa(e.width)&&oa(e.height)&&oa(e.x)&&oa(e.y),oa=e=>!isNaN(e)&&isFinite(e),kce=(e,t)=>{},lm=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),wd=({x:e,y:t},[n,r,a],o=!1,i=[1,1])=>{const s={x:(e-n)/a,y:(t-r)/a};return o?lm(s,i):s},K4=({x:e,y:t},[n,r,a])=>({x:e*a+n,y:t*a+r}),__=(e,t,n,r,a,o)=>{const i=t/(e.width*(1+o)),s=n/(e.height*(1+o)),c=Math.min(i,s),l=Sc(c,r,a),u=e.x+e.width/2,d=e.y+e.height/2,p=t/2-u*l,f=n/2-d*l;return{x:p,y:f,zoom:l}},um=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Cc(e){return e!==void 0&&e!=="parent"}function Ro(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Z4(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function G4(e,t={width:0,height:0},n,r,a){const o={...e},i=r.get(n);if(i){const s=i.origin||a;o.x+=i.internals.positionAbsolute.x-(t.width??0)*s[0],o.y+=i.internals.positionAbsolute.y-(t.height??0)*s[1]}return o}function xd(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:a}){const{x:o,y:i}=Do(e),s=wd({x:o-((a==null?void 0:a.left)??0),y:i-((a==null?void 0:a.top)??0)},r),{x:c,y:l}=n?lm(s,t):s;return{xSnapped:c,ySnapped:l,...s}}const dm=e=>({width:e.offsetWidth,height:e.offsetHeight}),X4=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Mce=["INPUT","SELECT","TEXTAREA"];function j_(e){var n,r;const t=((r=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:r[0])||e.target;return Mce.includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}const J4=e=>"clientX"in e,Do=(e,t)=>{var o,i;const n=J4(e),r=n?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,a=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:a-((t==null?void 0:t.top)??0)}},Y4=(e,t,n,r,a)=>{const o=t.querySelectorAll(`.${e}`);return!o||!o.length?null:Array.from(o).map(i=>{const s=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:a,position:i.getAttribute("data-handlepos"),x:(s.left-n.left)/r,y:(s.top-n.top)/r,...dm(i)}})};function Q4({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:a,sourceControlY:o,targetControlX:i,targetControlY:s}){const c=e*.125+a*.375+i*.375+n*.125,l=t*.125+o*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function pm(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function e5({pos:e,x1:t,y1:n,x2:r,y2:a,c:o}){switch(e){case he.Left:return[t-pm(t-r,o),n];case he.Right:return[t+pm(r-t,o),n];case he.Top:return[t,n-pm(n-a,o)];case he.Bottom:return[t,n+pm(a-n,o)]}}function t5({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:o=he.Top,curvature:i=.25}){const[s,c]=e5({pos:n,x1:e,y1:t,x2:r,y2:a,c:i}),[l,u]=e5({pos:o,x1:r,y1:a,x2:e,y2:t,c:i}),[d,p,f,m]=Q4({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${a}`,d,p,f,m]}function n5({sourceX:e,sourceY:t,targetX:n,targetY:r}){const a=Math.abs(n-e)/2,o=n<e?n+a:n-a,i=Math.abs(r-t)/2,s=r<t?r+i:r-i;return[o,s,a,i]}function Ace({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:a=!1}){if(!a)return r;const o=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(o?i:0)}function Pce({sourceNode:e,targetNode:t,width:n,height:r,transform:a}){const o=im(cm(e),cm(t));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const i={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:r/a[2]};return bd(i,sm(o))>0}const Tce=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Ice=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),r5=(e,t)=>{if(!e.source||!e.target)return t;let n;return F4(e)?n={...e}:n={...e,id:Tce(e)},Ice(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function a5({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[a,o,i,s]=n5({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,a,o,i,s]}const o5={[he.Left]:{x:-1,y:0},[he.Right]:{x:1,y:0},[he.Top]:{x:0,y:-1},[he.Bottom]:{x:0,y:1}},Rce=({source:e,sourcePosition:t=he.Bottom,target:n})=>t===he.Left||t===he.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},i5=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Dce({source:e,sourcePosition:t=he.Bottom,target:n,targetPosition:r=he.Top,center:a,offset:o}){const i=o5[t],s=o5[r],c={x:e.x+i.x*o,y:e.y+i.y*o},l={x:n.x+s.x*o,y:n.y+s.y*o},u=Rce({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",p=u[d];let f=[],m,y;const v={x:0,y:0},b={x:0,y:0},[w,_,x,j]=n5({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[d]*s[d]===-1){m=a.x??w,y=a.y??_;const E=[{x:m,y:c.y},{x:m,y:l.y}],S=[{x:c.x,y},{x:l.x,y}];i[d]===p?f=d==="x"?E:S:f=d==="x"?S:E}else{const E=[{x:c.x,y:l.y}],S=[{x:l.x,y:c.y}];if(d==="x"?f=i.x===p?S:E:f=i.y===p?E:S,t===r){const A=Math.abs(e[d]-n[d]);if(A<=o){const P=Math.min(o-1,o-A);i[d]===p?v[d]=(c[d]>e[d]?-1:1)*P:b[d]=(l[d]>n[d]?-1:1)*P}}if(t!==r){const A=d==="x"?"y":"x",P=i[d]===s[A],C=c[A]>l[A],T=c[A]<l[A];(i[d]===1&&(!P&&C||P&&T)||i[d]!==1&&(!P&&T||P&&C))&&(f=d==="x"?E:S)}const O={x:c.x+v.x,y:c.y+v.y},N={x:l.x+b.x,y:l.y+b.y},M=Math.max(Math.abs(O.x-f[0].x),Math.abs(N.x-f[0].x)),k=Math.max(Math.abs(O.y-f[0].y),Math.abs(N.y-f[0].y));M>=k?(m=(O.x+N.x)/2,y=f[0].y):(m=f[0].x,y=(O.y+N.y)/2)}return[[e,{x:c.x+v.x,y:c.y+v.y},...f,{x:l.x+b.x,y:l.y+b.y},n],m,y,x,j]}function Lce(e,t,n,r){const a=Math.min(i5(e,t)/2,i5(t,n)/2,r),{x:o,y:i}=t;if(e.x===o&&o===n.x||e.y===i&&i===n.y)return`L${o} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${o+a*l},${i}Q ${o},${i} ${o},${i+a*u}`}const s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${o},${i+a*c}Q ${o},${i} ${o+a*s},${i}`}function E_({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:o=he.Top,borderRadius:i=5,centerX:s,centerY:c,offset:l=20}){const[u,d,p,f,m]=Dce({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:a},targetPosition:o,center:{x:s,y:c},offset:l});return[u.reduce((y,v,b)=>{let w="";return b>0&&b<u.length-1?w=Lce(u[b-1],v,u[b+1],i):w=`${b===0?"M":"L"}${v.x} ${v.y}`,y+=w,y},""),d,p,f,m]}function s5(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function $ce(e){var d;const{sourceNode:t,targetNode:n}=e;if(!s5(t)||!s5(n))return null;const r=t.internals.handleBounds||c5(t.handles),a=n.internals.handleBounds||c5(n.handles),o=l5((r==null?void 0:r.source)??[],e.sourceHandle),i=l5(e.connectionMode===Ec.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),e.targetHandle);if(!o||!i)return(d=e.onError)==null||d.call(e,"008",Io.error008(o?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=(o==null?void 0:o.position)||he.Bottom,c=(i==null?void 0:i.position)||he.Top,l=_d(t,o,s),u=_d(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:s,targetPosition:c}}function c5(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function _d(e,t,n=he.Left,r=!1){const a=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,o=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:s}=t??Ro(e);if(r)return{x:a+i/2,y:o+s/2};switch((t==null?void 0:t.position)??n){case he.Top:return{x:a+i/2,y:o};case he.Right:return{x:a+i,y:o+s/2};case he.Bottom:return{x:a+i/2,y:o+s};case he.Left:return{x:a,y:o+s/2}}}function l5(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function S_(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function Fce(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:a}){const o=new Set;return e.reduce((i,s)=>([s.markerStart||r,s.markerEnd||a].forEach(c=>{if(c&&typeof c=="object"){const l=S_(c,t);o.has(l)||(i.push({id:l,color:c.color||n,...c}),o.add(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))}const O_={nodeOrigin:[0,0],nodeExtent:md,elevateNodesOnSelect:!0,defaults:{}},Bce={...O_,checkEquality:!0};function C_(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function zce(e,t,n){const r=C_(O_,n);for(const a of e.values())if(a.parentId)k_(a,e,t,r);else{const o=gd(a,r.nodeOrigin),i=Cc(a.extent)?a.extent:r.nodeExtent,s=ds(o,i,Ro(a));a.internals.positionAbsolute=s}}function N_(e,t,n,r){var s,c;const a=C_(Bce,r),o=new Map(t),i=a!=null&&a.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let u=o.get(l.id);if(a.checkEquality&&l===(u==null?void 0:u.internals.userNode))t.set(l.id,u);else{const d=gd(l,a.nodeOrigin),p=Cc(l.extent)?l.extent:a.nodeExtent,f=ds(d,p,Ro(l));u={...a.defaults,...l,measured:{width:(s=l.measured)==null?void 0:s.width,height:(c=l.measured)==null?void 0:c.height},internals:{positionAbsolute:f,handleBounds:l.measured?u==null?void 0:u.internals.handleBounds:void 0,z:u5(l,i),userNode:l}},t.set(l.id,u)}l.parentId&&k_(u,t,n,r)}}function Uce(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function k_(e,t,n,r){const{elevateNodesOnSelect:a,nodeOrigin:o,nodeExtent:i}=C_(O_,r),s=e.parentId,c=t.get(s);if(!c){console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Uce(e,n);const l=a?1e3:0,{x:u,y:d,z:p}=Vce(e,c,o,i,l),{positionAbsolute:f}=e.internals,m=u!==f.x||d!==f.y;(m||p!==e.internals.z)&&(e.internals={...e.internals,positionAbsolute:m?{x:u,y:d}:f,z:p})}function u5(e,t){return(oa(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Vce(e,t,n,r,a){const{x:o,y:i}=t.internals.positionAbsolute,s=Ro(e),c=gd(e,n),l=Cc(e.extent)?ds(c,e.extent,s):c;let u=ds({x:o+l.x,y:i+l.y},r,s);e.extent==="parent"&&(u=U4(u,s,t));const d=u5(e,a),p=t.internals.z??0;return{x:u.x,y:u.y,z:p>d?p:d}}function M_(e,t,n,r=[0,0]){var i;const a=[],o=new Map;for(const s of e){const c=t.get(s.parentId);if(!c)continue;const l=((i=o.get(s.parentId))==null?void 0:i.expandedRect)??Oc(c),u=H4(l,s.rect);o.set(s.parentId,{expandedRect:u,parent:c})}return o.size>0&&o.forEach(({expandedRect:s,parent:c},l)=>{var _;const u=c.internals.positionAbsolute,d=Ro(c),p=c.origin??r,f=s.x<u.x?Math.round(Math.abs(u.x-s.x)):0,m=s.y<u.y?Math.round(Math.abs(u.y-s.y)):0,y=Math.max(d.width,Math.round(s.width)),v=Math.max(d.height,Math.round(s.height)),b=(y-d.width)*p[0],w=(v-d.height)*p[1];(f>0||m>0||b||w)&&(a.push({id:l,type:"position",position:{x:c.position.x-f+b,y:c.position.y-m+w}}),(_=n.get(l))==null||_.forEach(x=>{e.some(j=>j.id===x.id)||a.push({id:x.id,type:"position",position:{x:x.position.x+f,y:x.position.y+m}})})),(d.width<s.width||d.height<s.height||f||m)&&a.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:y+(f?p[0]*f-b:0),height:v+(m?p[1]*m-w:0)}})}),a}function Wce(e,t,n,r,a,o){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let s=!1;if(!i)return{changes:[],updatedInternals:s};const c=[],l=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const p of e.values()){const f=t.get(p.id);if(f)if(f.hidden)f.internals={...f.internals,handleBounds:void 0},s=!0;else{const m=dm(p.nodeElement),y=f.measured.width!==m.width||f.measured.height!==m.height;if(m.width&&m.height&&(y||!f.internals.handleBounds||p.force)){const v=p.nodeElement.getBoundingClientRect(),b=Cc(f.extent)?f.extent:o;let{positionAbsolute:w}=f.internals;f.parentId&&f.extent==="parent"?w=U4(w,m,t.get(f.parentId)):b&&(w=ds(w,b,m)),f.measured=m,f.internals={...f.internals,positionAbsolute:w,handleBounds:{source:Y4("source",p.nodeElement,v,u,f.id),target:Y4("target",p.nodeElement,v,u,f.id)}},f.parentId&&k_(f,t,n,{nodeOrigin:a}),s=!0,y&&(c.push({id:f.id,type:"dimensions",dimensions:m}),f.expandParent&&f.parentId&&d.push({id:f.id,parentId:f.parentId,rect:Oc(f,a)}))}}}if(d.length>0){const p=M_(d,t,n,a);c.push(...p)}return{changes:c,updatedInternals:s}}async function Hce({delta:e,panZoom:t,transform:n,translateExtent:r,width:a,height:o}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[a,o]],r),s=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(s)}function d5(e,t,n){e.clear(),t.clear();for(const r of n){const{source:a,target:o,sourceHandle:i=null,targetHandle:s=null}=r,c=`${a}-source-${i}`,l=`${o}-target-${s}`,u=e.get(c)||new Map,d=e.get(l)||new Map,p={edgeId:r.id,source:a,target:o,sourceHandle:i,targetHandle:s};t.set(r.id,r),e.set(c,u.set(`${o}-${s}`,p)),e.set(l,d.set(`${a}-${i}`,p))}}function p5(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:p5(n,t):!1}function f5(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n)return!1;r=r.parentElement}while(r);return!1}function qce(e,t,n,r){const a=new Map;for(const[o,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!p5(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const s=e.get(o);s&&a.set(o,{id:o,position:s.position||{x:0,y:0},distance:{x:n.x-s.internals.positionAbsolute.x,y:n.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return a}function A_({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,s,c;const a=[];for(const[l,u]of t){const d=(i=n.get(l))==null?void 0:i.internals.userNode;d&&a.push({...d,position:u.position,dragging:r})}if(!e)return[a[0],a];const o=(s=n.get(e))==null?void 0:s.internals.userNode;return[o?{...o,position:((c=t.get(e))==null?void 0:c.position)||o.position,dragging:r}:a[0],a]}function Kce({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:a}){let o={x:null,y:null},i=0,s=new Map,c=!1,l={x:0,y:0},u=null,d=!1,p=null,f=!1;function m({noDragClassName:v,handleSelector:b,domNode:w,isSelectable:_,nodeId:x,nodeClickDistance:j=0}){p=wr(w);function E({x:M,y:k},A){const{nodeLookup:P,nodeExtent:C,snapGrid:T,snapToGrid:I,nodeOrigin:R,onNodeDrag:L,onSelectionDrag:D,onError:z,updateNodePositions:U}=t();o={x:M,y:k};let $=!1,V={x:0,y:0,x2:0,y2:0};if(s.size>1&&C){const F=vd(s);V=x_(F)}for(const[F,W]of s){if(!P.has(F))continue;let re={x:M-W.distance.x,y:k-W.distance.y};I&&(re=lm(re,T));let ee=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(s.size>1&&C&&!W.extent){const{positionAbsolute:X}=W.internals,ne=X.x-V.x+C[0][0],B=X.x+W.measured.width-V.x2+C[1][0],ue=X.y-V.y+C[0][1],ae=X.y+W.measured.height-V.y2+C[1][1];ee=[[ne,ue],[B,ae]]}const{position:G,positionAbsolute:K}=z4({nodeId:F,nextPosition:re,nodeLookup:P,nodeExtent:ee,nodeOrigin:R,onError:z});$=$||W.position.x!==G.x||W.position.y!==G.y,W.position=G,W.internals.positionAbsolute=K}if($&&(U(s,!0),A&&(r||L||!x&&D))){const[F,W]=A_({nodeId:x,dragItems:s,nodeLookup:P});r==null||r(A,s,F,W),L==null||L(A,F,W),x||(D==null||D(A,W))}}async function S(){if(!u)return;const{transform:M,panBy:k,autoPanSpeed:A}=t(),[P,C]=W4(l,u,A);(P!==0||C!==0)&&(o.x=(o.x??0)-P/M[2],o.y=(o.y??0)-C/M[2],await k({x:P,y:C})&&E(o,null)),i=requestAnimationFrame(S)}function O(M){var $;const{nodeLookup:k,multiSelectionActive:A,nodesDraggable:P,transform:C,snapGrid:T,snapToGrid:I,selectNodesOnDrag:R,onNodeDragStart:L,onSelectionDragStart:D,unselectNodesAndEdges:z}=t();d=!0,(!R||!_)&&!A&&x&&(($=k.get(x))!=null&&$.selected||z()),_&&R&&x&&(e==null||e(x));const U=xd(M.sourceEvent,{transform:C,snapGrid:T,snapToGrid:I,containerBounds:u});if(o=U,s=qce(k,P,U,x),s.size>0&&(n||L||!x&&D)){const[V,F]=A_({nodeId:x,dragItems:s,nodeLookup:k});n==null||n(M.sourceEvent,s,V,F),L==null||L(M.sourceEvent,V,F),x||(D==null||D(M.sourceEvent,F))}}const N=n4().clickDistance(j).on("start",M=>{const{domNode:k,nodeDragThreshold:A,transform:P,snapGrid:C,snapToGrid:T}=t();u=(k==null?void 0:k.getBoundingClientRect())||null,f=!1,A===0&&O(M),o=xd(M.sourceEvent,{transform:P,snapGrid:C,snapToGrid:T,containerBounds:u}),l=Do(M.sourceEvent,u)}).on("drag",M=>{const{autoPanOnNodeDrag:k,transform:A,snapGrid:P,snapToGrid:C,nodeDragThreshold:T,nodeLookup:I}=t(),R=xd(M.sourceEvent,{transform:A,snapGrid:P,snapToGrid:C,containerBounds:u});if((M.sourceEvent.type==="touchmove"&&M.sourceEvent.touches.length>1||x&&!I.has(x))&&(f=!0),!f){if(!c&&k&&d&&(c=!0,S()),!d){const L=R.xSnapped-(o.x??0),D=R.ySnapped-(o.y??0);Math.sqrt(L*L+D*D)>T&&O(M)}(o.x!==R.xSnapped||o.y!==R.ySnapped)&&s&&d&&(l=Do(M.sourceEvent,u),E(R,M.sourceEvent))}}).on("end",M=>{if(!(!d||f)&&(c=!1,d=!1,cancelAnimationFrame(i),s.size>0)){const{nodeLookup:k,updateNodePositions:A,onNodeDragStop:P,onSelectionDragStop:C}=t();if(A(s,!1),a||P||!x&&C){const[T,I]=A_({nodeId:x,dragItems:s,nodeLookup:k,dragging:!1});a==null||a(M.sourceEvent,s,T,I),P==null||P(M.sourceEvent,T,I),x||(C==null||C(M.sourceEvent,I))}}}).filter(M=>{const k=M.target;return!M.button&&(!v||!f5(k,`.${v}`,w))&&(!b||f5(k,b,w))});p.call(N)}function y(){p==null||p.on(".drag",null)}return{update:m,destroy:y}}function Zce(e,t,n){const r=[],a={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const o of t.values())bd(a,Oc(o))>0&&r.push(o);return r}const Gce=250;function Xce(e,t,n,r){var s,c;let a=[],o=1/0;const i=Zce(e,n,t+Gce);for(const l of i){const u=[...((s=l.internals.handleBounds)==null?void 0:s.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:p,y:f}=_d(l,d,d.position,!0),m=Math.sqrt(Math.pow(p-e.x,2)+Math.pow(f-e.y,2));m>t||(m<o?(a=[{...d,x:p,y:f}],o=m):m===o&&a.push({...d,x:p,y:f}))}}if(!a.length)return null;if(a.length>1){const l=r.type==="source"?"target":"source";return a.find(u=>u.type===l)??a[0]}return a[0]}function h5(e,t,n,r,a,o=!1){var l,u,d;const i=r.get(e);if(!i)return null;const s=a==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((d=i.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?s==null?void 0:s.find(p=>p.id===n):s==null?void 0:s[0])??null;return c&&o?{...c,..._d(i,c,c.position,!0)}:c}function m5(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Jce(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const y5=()=>!0;function Yce(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:a,edgeUpdaterType:o,isTarget:i,domNode:s,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:p,cancelConnection:f,onConnectStart:m,onConnect:y,onConnectEnd:v,isValidConnection:b=y5,onReconnectEnd:w,updateConnection:_,getTransform:x,getFromHandle:j,autoPanSpeed:E}){const S=X4(e.target);let O=0,N;const{x:M,y:k}=Do(e),A=S==null?void 0:S.elementFromPoint(M,k),P=m5(o,A),C=s==null?void 0:s.getBoundingClientRect();if(!C||!P)return;const T=h5(a,P,r,c,t);if(!T)return;let I=Do(e,C),R=!1,L=null,D=!1,z=null;function U(){if(!u||!C)return;const[G,K]=W4(I,C,E);p({x:G,y:K}),O=requestAnimationFrame(U)}const $={...T,nodeId:a,type:P,position:T.position},V=c.get(a),F={inProgress:!0,isValid:null,from:_d(V,$,he.Left,!0),fromHandle:$,fromPosition:$.position,fromNode:V,to:I,toHandle:null,toPosition:D4[$.position],toNode:null};_(F);let W=F;m==null||m(e,{nodeId:a,handleId:r,handleType:P});function re(G){if(!j()||!$){ee(G);return}const K=x();I=Do(G,C),N=Xce(wd(I,K,!1,[1,1]),n,c,$),R||(U(),R=!0);const X=g5(G,{handle:N,connectionMode:t,fromNodeId:a,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:S,lib:l,flowId:d,nodeLookup:c});z=X.handleDomNode,L=X.connection,D=Jce(!!N,X.isValid);const ne={...W,isValid:D,to:N&&D?K4({x:N.x,y:N.y},K):I,toHandle:X.toHandle,toPosition:D&&X.toHandle?X.toHandle.position:D4[$.position],toNode:X.toHandle?c.get(X.toHandle.nodeId):null};D&&N&&W.toHandle&&ne.toHandle&&W.toHandle.type===ne.toHandle.type&&W.toHandle.nodeId===ne.toHandle.nodeId&&W.toHandle.id===ne.toHandle.id&&W.to.x===ne.to.x&&W.to.y===ne.to.y||(_(ne),W=ne)}function ee(G){(N||z)&&L&&D&&(y==null||y(L));const{inProgress:K,...X}=W,ne={...X,toPosition:W.toHandle?W.toPosition:null};v==null||v(G,ne),o&&(w==null||w(G,ne)),f(),cancelAnimationFrame(O),R=!1,D=!1,L=null,z=null,S.removeEventListener("mousemove",re),S.removeEventListener("mouseup",ee),S.removeEventListener("touchmove",re),S.removeEventListener("touchend",ee)}S.addEventListener("mousemove",re),S.addEventListener("mouseup",ee),S.addEventListener("touchmove",re),S.addEventListener("touchend",ee)}function g5(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:a,fromType:o,doc:i,lib:s,flowId:c,isValidConnection:l=y5,nodeLookup:u}){const d=o==="target",p=t?i.querySelector(`.${s}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:f,y:m}=Do(e),y=i.elementFromPoint(f,m),v=y!=null&&y.classList.contains(`${s}-flow__handle`)?y:p,b={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=m5(void 0,v),_=v.getAttribute("data-nodeid"),x=v.getAttribute("data-handleid"),j=v.classList.contains("connectable"),E=v.classList.contains("connectableend");if(!_||!w)return b;const S={source:d?_:r,sourceHandle:d?x:a,target:d?r:_,targetHandle:d?a:x};b.connection=S;const O=j&&E&&(n===Ec.Strict?d&&w==="source"||!d&&w==="target":_!==r||x!==a);b.isValid=O&&l(S),b.toHandle=h5(_,w,x,u,n,!1)}return b}const P_={onPointerDown:Yce,isValid:g5};function Qce({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const a=wr(e);function o({translateExtent:s,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:p=!0,inversePan:f=!1}){const m=_=>{const x=n();if(_.sourceEvent.type!=="wheel"||!t)return;const j=-_.sourceEvent.deltaY*(_.sourceEvent.deltaMode===1?.05:_.sourceEvent.deltaMode?1:.002)*u,E=x[2]*Math.pow(2,j);t.scaleTo(E)};let y=[0,0];const v=_=>{(_.sourceEvent.type==="mousedown"||_.sourceEvent.type==="touchstart")&&(y=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY])},b=_=>{const x=n();if(_.sourceEvent.type!=="mousemove"&&_.sourceEvent.type!=="touchmove"||!t)return;const j=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY],E=[j[0]-y[0],j[1]-y[1]];y=j;const S=r()*Math.max(x[2],Math.log(x[2]))*(f?-1:1),O={x:x[0]-E[0]*S,y:x[1]-E[1]*S},N=[[0,0],[c,l]];t.setViewportConstrained({x:O.x,y:O.y,zoom:x[2]},N,s)},w=T4().on("start",v).on("zoom",d?b:null).on("zoom.wheel",p?m:null);a.call(w,{})}function i(){a.on("zoom",null)}return{update:o,destroy:i,pointer:ta}}const ele=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,fm=e=>({x:e.x,y:e.y,zoom:e.k}),T_=({x:e,y:t,zoom:n})=>am.translate(e,t).scale(n),Nc=(e,t)=>e.target.closest(`.${t}`),v5=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),I_=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},b5=e=>{const t=e.ctrlKey&&um()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function tle({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:o,zoomOnPinch:i,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(Nc(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&i){const v=ta(u),b=b5(u),w=d*Math.pow(2,b);r.scaleTo(n,w,v,u);return}const p=u.deltaMode===1?20:1;let f=a===yi.Vertical?0:u.deltaX*p,m=a===yi.Horizontal?0:u.deltaY*p;!um()&&u.shiftKey&&a!==yi.Vertical&&(f=u.deltaY*p,m=0),r.translateBy(n,-(f/d)*o,-(m/d)*o,{internal:!0});const y=fm(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s==null||s(u,y)),e.isPanScrolling&&(c==null||c(u,y),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,y),e.isPanScrolling=!1},150))}}function nle({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,a){if(!t&&r.type==="wheel"&&!r.ctrlKey||Nc(r,e))return null;r.preventDefault(),n.call(this,r,a)}}function rle({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var o,i,s;if((o=r.sourceEvent)!=null&&o.internal)return;const a=fm(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=a,((s=r.sourceEvent)==null?void 0:s.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,a))}}function ale({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:a}){return o=>{var i,s;e.usedRightMouseButton=!!(n&&v5(t,e.mouseButton??0)),(i=o.sourceEvent)!=null&&i.sync||r([o.transform.x,o.transform.y,o.transform.k]),a&&!((s=o.sourceEvent)!=null&&s.internal)&&(a==null||a(o.sourceEvent,fm(o.transform)))}}function ole({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:a,onPaneContextMenu:o}){return i=>{var s;if(!((s=i.sourceEvent)!=null&&s.internal)&&(e.isZoomingOrPanning=!1,o&&v5(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&o(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),a&&ele(e.prevViewport,i.transform))){const c=fm(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a==null||a(i.sourceEvent,c)},n?150:0)}}}function ile({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:a,zoomOnDoubleClick:o,userSelectionActive:i,noWheelClassName:s,noPanClassName:c,lib:l}){return u=>{var m;const d=e||t,p=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Nc(u,`${l}-flow__node`)||Nc(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!a&&!o&&!n||i||Nc(u,s)&&u.type==="wheel"||Nc(u,c)&&(u.type!=="wheel"||a&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((m=u.touches)==null?void 0:m.length)>1)return u.preventDefault(),!1;if(!d&&!a&&!p&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const f=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&f}}function sle({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:a,viewport:o,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),p=T4().clickDistance(!oa(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(a),f=wr(e).call(p);_({x:o.x,y:o.y,zoom:Sc(o.zoom,t,n)},[[0,0],[d.width,d.height]],a);const m=f.on("wheel.zoom"),y=f.on("dblclick.zoom");p.wheelDelta(b5);function v(A,P){return f?new Promise(C=>{p==null||p.transform(I_(f,P==null?void 0:P.duration,()=>C(!0)),A)}):Promise.resolve(!1)}function b({noWheelClassName:A,noPanClassName:P,onPaneContextMenu:C,userSelectionActive:T,panOnScroll:I,panOnDrag:R,panOnScrollMode:L,panOnScrollSpeed:D,preventScrolling:z,zoomOnPinch:U,zoomOnScroll:$,zoomOnDoubleClick:V,zoomActivationKeyPressed:F,lib:W,onTransformChange:re}){T&&!u.isZoomingOrPanning&&w();const ee=I&&!F&&!T?tle({zoomPanValues:u,noWheelClassName:A,d3Selection:f,d3Zoom:p,panOnScrollMode:L,panOnScrollSpeed:D,zoomOnPinch:U,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:c}):nle({noWheelClassName:A,preventScrolling:z,d3ZoomHandler:m});if(f.on("wheel.zoom",ee,{passive:!1}),!T){const K=rle({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:s});p.on("start",K);const X=ale({zoomPanValues:u,panOnDrag:R,onPaneContextMenu:!!C,onPanZoom:i,onTransformChange:re});p.on("zoom",X);const ne=ole({zoomPanValues:u,panOnDrag:R,panOnScroll:I,onPaneContextMenu:C,onPanZoomEnd:c,onDraggingChange:l});p.on("end",ne)}const G=ile({zoomActivationKeyPressed:F,panOnDrag:R,zoomOnScroll:$,panOnScroll:I,zoomOnDoubleClick:V,zoomOnPinch:U,userSelectionActive:T,noPanClassName:P,noWheelClassName:A,lib:W});p.filter(G),V?f.on("dblclick.zoom",y):f.on("dblclick.zoom",null)}function w(){p.on("zoom",null)}async function _(A,P,C){const T=T_(A),I=p==null?void 0:p.constrain()(T,P,C);return I&&await v(I),new Promise(R=>R(I))}async function x(A,P){const C=T_(A);return await v(C,P),new Promise(T=>T(C))}function j(A){if(f){const P=T_(A),C=f.property("__zoom");(C.k!==A.zoom||C.x!==A.x||C.y!==A.y)&&(p==null||p.transform(f,P,null,{sync:!0}))}}function E(){const A=f?A4(f.node()):{x:0,y:0,k:1};return{x:A.x,y:A.y,zoom:A.k}}function S(A,P){return f?new Promise(C=>{p==null||p.scaleTo(I_(f,P==null?void 0:P.duration,()=>C(!0)),A)}):Promise.resolve(!1)}function O(A,P){return f?new Promise(C=>{p==null||p.scaleBy(I_(f,P==null?void 0:P.duration,()=>C(!0)),A)}):Promise.resolve(!1)}function N(A){p==null||p.scaleExtent(A)}function M(A){p==null||p.translateExtent(A)}function k(A){const P=!oa(A)||A<0?0:A;p==null||p.clickDistance(P)}return{update:b,destroy:w,setViewport:x,setViewportConstrained:_,getViewport:E,scaleTo:S,scaleBy:O,setScaleExtent:N,setTranslateExtent:M,syncViewport:j,setClickDistance:k}}var kc;(function(e){e.Line="line",e.Handle="handle"})(kc||(kc={}));const cle=["top-left","top-right","bottom-left","bottom-right"],lle=["top","right","bottom","left"];function ule({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:a,affectsY:o}){const i=e-t,s=n-r,c=[i>0?1:i<0?-1:0,s>0?1:s<0?-1:0];return i&&a&&(c[0]=c[0]*-1),s&&o&&(c[1]=c[1]*-1),c}function dle(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:a}}function vi(e,t){return Math.max(0,t-e)}function bi(e,t){return Math.max(0,e-t)}function hm(e,t,n){return Math.max(0,t-e,e-n)}function w5(e,t){return e?!t:t}function ple(e,t,n,r,a,o,i,s){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,p=u&&d,{xSnapped:f,ySnapped:m}=n,{minWidth:y,maxWidth:v,minHeight:b,maxHeight:w}=r,{x:_,y:x,width:j,height:E,aspectRatio:S}=e;let O=Math.floor(u?f-e.pointerX:0),N=Math.floor(d?m-e.pointerY:0);const M=j+(c?-O:O),k=E+(l?-N:N),A=-o[0]*j,P=-o[1]*E;let C=hm(M,y,v),T=hm(k,b,w);if(i){let L=0,D=0;c&&O<0?L=vi(_+O+A,i[0][0]):!c&&O>0&&(L=bi(_+M+A,i[1][0])),l&&N<0?D=vi(x+N+P,i[0][1]):!l&&N>0&&(D=bi(x+k+P,i[1][1])),C=Math.max(C,L),T=Math.max(T,D)}if(s){let L=0,D=0;c&&O>0?L=bi(_+O,s[0][0]):!c&&O<0&&(L=vi(_+M,s[1][0])),l&&N>0?D=bi(x+N,s[0][1]):!l&&N<0&&(D=vi(x+k,s[1][1])),C=Math.max(C,L),T=Math.max(T,D)}if(a){if(u){const L=hm(M/S,b,w)*S;if(C=Math.max(C,L),i){let D=0;!c&&!l||c&&!l&&p?D=bi(x+P+M/S,i[1][1])*S:D=vi(x+P+(c?O:-O)/S,i[0][1])*S,C=Math.max(C,D)}if(s){let D=0;!c&&!l||c&&!l&&p?D=vi(x+M/S,s[1][1])*S:D=bi(x+(c?O:-O)/S,s[0][1])*S,C=Math.max(C,D)}}if(d){const L=hm(k*S,y,v)/S;if(T=Math.max(T,L),i){let D=0;!c&&!l||l&&!c&&p?D=bi(_+k*S+A,i[1][0])/S:D=vi(_+(l?N:-N)*S+A,i[0][0])/S,T=Math.max(T,D)}if(s){let D=0;!c&&!l||l&&!c&&p?D=vi(_+k*S,s[1][0])/S:D=bi(_+(l?N:-N)*S,s[0][0])/S,T=Math.max(T,D)}}}N=N+(N<0?T:-T),O=O+(O<0?C:-C),a&&(p?M>k*S?N=(w5(c,l)?-O:O)/S:O=(w5(c,l)?-N:N)*S:u?(N=O/S,l=c):(O=N*S,c=l));const I=c?_+O:_,R=l?x+N:x;return{width:j+(c?-O:O),height:E+(l?-N:N),x:o[0]*O*(c?-1:1)+I,y:o[1]*N*(l?-1:1)+R}}const x5={width:0,height:0,x:0,y:0},fle={...x5,pointerX:0,pointerY:0,aspectRatio:1};function hle(e){return[[0,0],[e.measured.width,e.measured.height]]}function mle(e,t,n){const r=t.position.x+e.position.x,a=t.position.y+e.position.y,o=e.measured.width??0,i=e.measured.height??0,s=n[0]*o,c=n[1]*i;return[[r-s,a-c],[r+o-s,a+i-c]]}function yle({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:a}){const o=wr(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:u,onResizeStart:d,onResize:p,onResizeEnd:f,shouldResize:m}){let y={...x5},v={...fle};const b=dle(c);let w,_=null,x=[],j,E,S;const O=n4().on("start",N=>{const{nodeLookup:M,transform:k,snapGrid:A,snapToGrid:P,nodeOrigin:C,paneDomNode:T}=n();if(w=M.get(t),!w)return;_=(T==null?void 0:T.getBoundingClientRect())??null;const{xSnapped:I,ySnapped:R}=xd(N.sourceEvent,{transform:k,snapGrid:A,snapToGrid:P,containerBounds:_});y={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},v={...y,pointerX:I,pointerY:R,aspectRatio:y.width/y.height},j=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(j=M.get(w.parentId),E=j&&w.extent==="parent"?hle(j):void 0),x=[],S=void 0;for(const[L,D]of M)if(D.parentId===t&&(x.push({id:L,position:{...D.position},extent:D.extent}),D.extent==="parent"||D.expandParent)){const z=mle(D,w,D.origin??C);S?S=[[Math.min(z[0][0],S[0][0]),Math.min(z[0][1],S[0][1])],[Math.max(z[1][0],S[1][0]),Math.max(z[1][1],S[1][1])]]:S=z}d==null||d(N,{...y})}).on("drag",N=>{const{transform:M,snapGrid:k,snapToGrid:A,nodeOrigin:P}=n(),C=xd(N.sourceEvent,{transform:M,snapGrid:k,snapToGrid:A,containerBounds:_}),T=[];if(!w)return;const{x:I,y:R,width:L,height:D}=y,z={},U=w.origin??P,{width:$,height:V,x:F,y:W}=ple(v,b,C,l,u,U,E,S),re=$!==L,ee=V!==D,G=F!==I&&re,K=W!==R&&ee;if(!G&&!K&&!re&&!ee)return;if((G||K||U[0]===1||U[1]===1)&&(z.x=G?F:y.x,z.y=K?W:y.y,y.x=z.x,y.y=z.y,x.length>0)){const B=F-I,ue=W-R;for(const ae of x)ae.position={x:ae.position.x-B+U[0]*($-L),y:ae.position.y-ue+U[1]*(V-D)},T.push(ae)}if((re||ee)&&(z.width=re?$:y.width,z.height=ee?V:y.height,y.width=z.width,y.height=z.height),j&&w.expandParent){const B=U[0]*(z.width??0);z.x&&z.x<B&&(y.x=B,v.x=v.x-(z.x-B));const ue=U[1]*(z.height??0);z.y&&z.y<ue&&(y.y=ue,v.y=v.y-(z.y-ue))}const X=ule({width:y.width,prevWidth:L,height:y.height,prevHeight:D,affectsX:b.affectsX,affectsY:b.affectsY}),ne={...y,direction:X};(m==null?void 0:m(N,ne))!==!1&&(p==null||p(N,ne),r(z,T))}).on("end",N=>{f==null||f(N,{...y}),a==null||a()});o.call(O)}function s(){o.on(".drag",null)}return{update:i,destroy:s}}var _5={exports:{}},R_={},j5;function gle(){if(j5)return R_;j5=1;var e=zG(),t=$I();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:n,a=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return R_.useSyncExternalStoreWithSelector=function(l,u,d,p,f){var m=o(null);if(m.current===null){var y={hasValue:!1,value:null};m.current=y}else y=m.current;m=s(function(){function b(E){if(!w){if(w=!0,_=E,E=p(E),f!==void 0&&y.hasValue){var S=y.value;if(f(S,E))return x=S}return x=E}if(S=x,r(_,E))return S;var O=p(E);return f!==void 0&&f(S,O)?S:(_=E,x=O)}var w=!1,_,x,j=d===void 0?null:d;return[function(){return b(u())},j===null?void 0:function(){return b(j())}]},[u,d,p,f]);var v=a(l,m[0],m[1]);return i(function(){y.hasValue=!0,y.value=v},[v]),c(v),v},R_}var E5;function vle(){return E5||(E5=1,_5.exports=gle()),_5.exports}var ble=vle();let S5,D_,O5,C5,N5,k5;rM=ct(ble),S5={BASE_URL:"/NoLLMChat/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_URL:"/NoLLMChat/",VITE_ROUTE_MODE:"hash"},D_=e=>{let t;const n=new Set,r=(s,c)=>{const l=typeof s=="function"?s(t):s;if(!Object.is(l,t)){const u=t;t=c??(typeof l!="object"||l===null)?l:Object.assign({},t,l),n.forEach(d=>d(t,u))}},a=()=>t,o={setState:r,getState:a,getInitialState:()=>i,subscribe:s=>(n.add(s),()=>n.delete(s)),destroy:()=>{(S5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},i=t=e(r,a,o);return o},O5=e=>e?D_(e):D_,{useDebugValue:C5}=q,{useSyncExternalStoreWithSelector:N5}=rM,k5=e=>e;function M5(e,t=k5,n){const r=N5(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return C5(r),r}const A5=(e,t)=>{const n=O5(e),r=(a,o=t)=>M5(n,a,o);return Object.assign(r,n),r},wle=(e,t)=>e?A5(e,t):A5;function Ut(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const mm=g.createContext(null),xle=mm.Provider,P5=Io.error001();function tt(e,t){const n=g.useContext(mm);if(n===null)throw new Error(P5);return M5(n,e,t)}function Lt(){const e=g.useContext(mm);if(e===null)throw new Error(P5);return g.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const T5={display:"none"},_le={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},I5="react-flow__node-desc",R5="react-flow__edge-desc",jle="react-flow__aria-live",Ele=e=>e.ariaLiveMessage;function Sle({rfId:e}){const t=tt(Ele);return h.jsx("div",{id:`${jle}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:_le,children:t})}function Ole({rfId:e,disableKeyboardA11y:t}){return h.jsxs(h.Fragment,{children:[h.jsxs("div",{id:`${I5}-${e}`,style:T5,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),h.jsx("div",{id:`${R5}-${e}`,style:T5,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&h.jsx(Sle,{rfId:e})]})}const Cle=e=>e.userSelectionActive?"none":"all";function Mc({position:e="top-left",children:t,className:n,style:r,...a}){const o=tt(Cle),i=`${e}`.split("-");return h.jsx("div",{className:rn(["react-flow__panel",n,...i]),style:{...r,pointerEvents:o},...a,children:t})}function Nle({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:h.jsx(Mc,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:h.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const kle=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},ym=e=>e.id;function Mle(e,t){return Ut(e.selectedNodes.map(ym),t.selectedNodes.map(ym))&&Ut(e.selectedEdges.map(ym),t.selectedEdges.map(ym))}function Ale({onSelectionChange:e}){const t=Lt(),{selectedNodes:n,selectedEdges:r}=tt(kle,Mle);return g.useEffect(()=>{const a={nodes:n,edges:r};e==null||e(a),t.getState().onSelectionChangeHandlers.forEach(o=>o(a))},[n,r,e]),null}const Ple=e=>!!e.onSelectionChangeHandlers;function Tle({onSelectionChange:e}){const t=tt(Ple);return e||t?h.jsx(Ale,{onSelectionChange:e}):null}const D5=[0,0],Ile={x:0,y:0,zoom:1},Rle=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],L5=[...Rle,"rfId"],Dle=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),$5={translateExtent:md,nodeOrigin:D5,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Lle(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:a,setTranslateExtent:o,setNodeExtent:i,reset:s,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=tt(Dle,Ut),u=Lt();g.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=$5,s()}),[]);const d=g.useRef($5);return g.useEffect(()=>{for(const p of L5){const f=e[p],m=d.current[p];f!==m&&(typeof e[p]>"u"||(p==="nodes"?t(f):p==="edges"?n(f):p==="minZoom"?r(f):p==="maxZoom"?a(f):p==="translateExtent"?o(f):p==="nodeExtent"?i(f):p==="paneClickDistance"?l(f):p==="fitView"?u.setState({fitViewOnInit:f}):p==="fitViewOptions"?u.setState({fitViewOnInitOptions:f}):u.setState({[p]:f})))}d.current=e},L5.map(p=>e[p])),null}function F5(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function $le(e){var r;const[t,n]=g.useState(e==="system"?null:e);return g.useEffect(()=>{if(e!=="system"){n(e);return}const a=F5(),o=()=>n(a!=null&&a.matches?"dark":"light");return o(),a==null||a.addEventListener("change",o),()=>{a==null||a.removeEventListener("change",o)}},[e]),t!==null?t:(r=F5())!=null&&r.matches?"dark":"light"}const B5=typeof document<"u"?document:null;function jd(e=null,t={target:B5,actInsideInputWithModifier:!0}){const[n,r]=g.useState(!1),a=g.useRef(!1),o=g.useRef(new Set([])),[i,s]=g.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),l=c.reduce((u,d)=>u.concat(...d),[]);return[c,l]}return[[],[]]},[e]);return g.useEffect(()=>{const c=(t==null?void 0:t.target)||B5;if(e!==null){const l=p=>{if(a.current=p.ctrlKey||p.metaKey||p.shiftKey,(!a.current||a.current&&!t.actInsideInputWithModifier)&&j_(p))return!1;const f=U5(p.code,s);o.current.add(p[f]),z5(i,o.current,!1)&&(p.preventDefault(),r(!0))},u=p=>{if((!a.current||a.current&&!t.actInsideInputWithModifier)&&j_(p))return!1;const f=U5(p.code,s);z5(i,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(p[f]),p.key==="Meta"&&o.current.clear(),a.current=!1},d=()=>{o.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function z5(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(a=>t.has(a)))}function U5(e,t){return t.includes(e)?"code":"key"}const Fle=()=>{const e=Lt();return g.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,a,o],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??a,zoom:t.zoom??o},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:a,panZoom:o,domNode:i}=e.getState();if(!o||!i)return Promise.resolve(!1);const s=b_(n,t),{width:c,height:l}=dm(i);return w_({nodes:s,width:c,height:l,minZoom:r,maxZoom:a,panZoom:o},t)},setCenter:async(t,n,r)=>{const{width:a,height:o,maxZoom:i,panZoom:s}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,l=a/2-t*c,u=o/2-n*c;return s?(await s.setViewport({x:l,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:a,minZoom:o,maxZoom:i,panZoom:s}=e.getState(),c=__(t,r,a,o,i,(n==null?void 0:n.padding)??.1);return s?(await s.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:r,snapGrid:a,domNode:o}=e.getState();if(!o)return t;const{x:i,y:s}=o.getBoundingClientRect(),c={x:t.x-i,y:t.y-s};return wd(c,r,n.snapToGrid,a)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:a,y:o}=r.getBoundingClientRect(),i=K4(t,n);return{x:i.x+a,y:i.y+o}}}),[])};function V5(e,t){const n=[],r=new Map,a=[];for(const o of e)if(o.type==="add"){a.push(o);continue}else if(o.type==="remove"||o.type==="replace")r.set(o.id,[o]);else{const i=r.get(o.id);i?i.push(o):r.set(o.id,[o])}for(const o of t){const i=r.get(o.id);if(!i){n.push(o);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const s={...o};for(const c of i)Ble(c,s);n.push(s)}return a.length&&a.forEach(o=>{o.index!==void 0?n.splice(o.index,0,{...o.item}):n.push({...o.item})}),n}function Ble(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function ps(e,t){return V5(e,t)}function Ed(e,t){return V5(e,t)}function fs(e,t){return{id:e,type:"select",selected:t}}function Ac(e,t=new Set,n=!1){const r=[];for(const[a,o]of e){const i=t.has(a);!(o.selected===void 0&&!i)&&o.selected!==i&&(n&&(o.selected=i),r.push(fs(o.id,i)))}return r}function W5({items:e=[],lookup:t}){var a;const n=[],r=new Map(e.map(o=>[o.id,o]));for(const[o,i]of e.entries()){const s=t.get(i.id),c=((a=s==null?void 0:s.internals)==null?void 0:a.userNode)??s;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:o})}for(const[o]of t)r.get(o)===void 0&&n.push({id:o,type:"remove"});return n}function H5(e){return{id:e.id,type:"remove"}}const q5=e=>Sce(e),zle=e=>F4(e);function K5(e){return g.forwardRef(e)}const Ule=typeof window<"u"?g.useLayoutEffect:g.useEffect;function Z5(e){const[t,n]=g.useState(BigInt(0)),[r]=g.useState(()=>Vle(()=>n(a=>a+BigInt(1))));return Ule(()=>{const a=r.get();a.length&&(e(a),r.reset())},[t]),r}function Vle(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const G5=g.createContext(null);function Wle({children:e}){const t=Lt(),n=g.useCallback(s=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:p}=t.getState();let f=c;for(const m of s)f=typeof m=="function"?m(f):m;u?l(f):d&&d(W5({items:f,lookup:p}))},[]),r=Z5(n),a=g.useCallback(s=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:p}=t.getState();let f=c;for(const m of s)f=typeof m=="function"?m(f):m;u?l(f):d&&d(W5({items:f,lookup:p}))},[]),o=Z5(a),i=g.useMemo(()=>({nodeQueue:r,edgeQueue:o}),[]);return h.jsx(G5.Provider,{value:i,children:e})}function Hle(){const e=g.useContext(G5);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const qle=e=>!!e.panZoom;function tr(){const e=Fle(),t=Lt(),n=Hle(),r=tt(qle),a=g.useMemo(()=>{const o=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},s=d=>{n.edgeQueue.push(d)},c=d=>{var b,w;const{nodeLookup:p,nodeOrigin:f}=t.getState(),m=q5(d)?d:p.get(d.id),y=m.parentId?G4(m.position,m.measured,m.parentId,p,f):m.position,v={id:m.id,position:y,width:((b=m.measured)==null?void 0:b.width)??m.width,height:((w=m.measured)==null?void 0:w.height)??m.height,data:m.data};return Oc(v)},l=(d,p,f={replace:!1})=>{i(m=>m.map(y=>{if(y.id===d){const v=typeof p=="function"?p(y):p;return f.replace&&q5(v)?v:{...y,...v}}return y}))},u=(d,p,f={replace:!1})=>{s(m=>m.map(y=>{if(y.id===d){const v=typeof p=="function"?p(y):p;return f.replace&&zle(v)?v:{...y,...v}}return y}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var p;return(p=o(d))==null?void 0:p.internals.userNode},getInternalNode:o,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(p=>({...p}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:s,addNodes:d=>{const p=Array.isArray(d)?d:[d];n.nodeQueue.push(f=>[...f,...p])},addEdges:d=>{const p=Array.isArray(d)?d:[d];n.edgeQueue.push(f=>[...f,...p])},toObject:()=>{const{nodes:d=[],edges:p=[],transform:f}=t.getState(),[m,y,v]=f;return{nodes:d.map(b=>({...b})),edges:p.map(b=>({...b})),viewport:{x:m,y,zoom:v}}},deleteElements:async({nodes:d=[],edges:p=[]})=>{const{nodes:f,edges:m,onNodesDelete:y,onEdgesDelete:v,triggerNodeChanges:b,triggerEdgeChanges:w,onDelete:_,onBeforeDelete:x}=t.getState(),{nodes:j,edges:E}=await Nce({nodesToRemove:d,edgesToRemove:p,nodes:f,edges:m,onBeforeDelete:x}),S=E.length>0,O=j.length>0;if(S){const N=E.map(H5);v==null||v(E),w(N)}if(O){const N=j.map(H5);y==null||y(j),b(N)}return(O||S)&&(_==null||_({nodes:j,edges:E})),{deletedNodes:j,deletedEdges:E}},getIntersectingNodes:(d,p=!0,f)=>{const m=q4(d),y=m?d:c(d),v=f!==void 0;return y?(f||t.getState().nodes).filter(b=>{const w=t.getState().nodeLookup.get(b.id);if(w&&!m&&(b.id===d.id||!w.internals.positionAbsolute))return!1;const _=Oc(v?b:w),x=bd(_,y);return p&&x>0||x>=y.width*y.height}):[]},isNodeIntersecting:(d,p,f=!0)=>{const m=q4(d)?d:c(d);if(!m)return!1;const y=bd(m,p);return f&&y>0||y>=m.width*m.height},updateNode:l,updateNodeData:(d,p,f={replace:!1})=>{l(d,m=>{const y=typeof p=="function"?p(m):p;return f.replace?{...m,data:y}:{...m,data:{...m.data,...y}}},f)},updateEdge:u,updateEdgeData:(d,p,f={replace:!1})=>{u(d,m=>{const y=typeof p=="function"?p(m):p;return f.replace?{...m,data:y}:{...m,data:{...m.data,...y}}},f)},getNodesBounds:d=>{const{nodeLookup:p,nodeOrigin:f}=t.getState();return Oce(d,{nodeLookup:p,nodeOrigin:f})},getHandleConnections:({type:d,id:p,nodeId:f})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${f}-${d}-${p??null}`))==null?void 0:m.values())??[])}}},[]);return g.useMemo(()=>({...a,...e,viewportInitialized:r}),[r])}const X5=e=>e.selected,Kle={actInsideInputWithModifier:!1},Zle=typeof window<"u"?window:void 0;function Gle({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=Lt(),{deleteElements:r}=tr(),a=jd(e,Kle),o=jd(t,{target:Zle});g.useEffect(()=>{if(a){const{edges:i,nodes:s}=n.getState();r({nodes:s.filter(X5),edges:i.filter(X5)}),n.setState({nodesSelectionActive:!1})}},[a]),g.useEffect(()=>{n.setState({multiSelectionActive:o})},[o])}function Xle(e){const t=Lt();g.useEffect(()=>{const n=()=>{var a,o;if(!e.current)return!1;const r=dm(e.current);(r.height===0||r.width===0)&&((o=(a=t.getState()).onError)==null||o.call(a,"004",Io.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const gm={position:"absolute",width:"100%",height:"100%",top:0,left:0},Jle=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function Yle({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:a=.5,panOnScrollMode:o=yi.Free,zoomOnDoubleClick:i=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:p,preventScrolling:f=!0,children:m,noWheelClassName:y,noPanClassName:v,onViewportChange:b,isControlledViewport:w,paneClickDistance:_}){const x=Lt(),j=g.useRef(null),{userSelectionActive:E,lib:S}=tt(Jle,Ut),O=jd(p),N=g.useRef();Xle(j);const M=g.useCallback(k=>{b==null||b({x:k[0],y:k[1],zoom:k[2]}),w||x.setState({transform:k})},[b,w]);return g.useEffect(()=>{if(j.current){N.current=sle({domNode:j.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:_,onDraggingChange:C=>x.setState({paneDragging:C}),onPanZoomStart:(C,T)=>{const{onViewportChangeStart:I,onMoveStart:R}=x.getState();R==null||R(C,T),I==null||I(T)},onPanZoom:(C,T)=>{const{onViewportChange:I,onMove:R}=x.getState();R==null||R(C,T),I==null||I(T)},onPanZoomEnd:(C,T)=>{const{onViewportChangeEnd:I,onMoveEnd:R}=x.getState();R==null||R(C,T),I==null||I(T)}});const{x:k,y:A,zoom:P}=N.current.getViewport();return x.setState({panZoom:N.current,transform:[k,A,P],domNode:j.current.closest(".react-flow")}),()=>{var C;(C=N.current)==null||C.destroy()}}},[]),g.useEffect(()=>{var k;(k=N.current)==null||k.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:a,panOnScrollMode:o,zoomOnDoubleClick:i,panOnDrag:s,zoomActivationKeyPressed:O,preventScrolling:f,noPanClassName:v,userSelectionActive:E,noWheelClassName:y,lib:S,onTransformChange:M})},[e,t,n,r,a,o,i,s,O,f,v,E,y,S,M]),h.jsx("div",{className:"react-flow__renderer",ref:j,style:gm,children:m})}const Qle=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function eue(){const{userSelectionActive:e,userSelectionRect:t}=tt(Qle,Ut);return e&&t?h.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const L_=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},tue=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function nue({isSelecting:e,selectionKeyPressed:t,selectionMode:n=yd.Full,panOnDrag:r,selectionOnDrag:a,onSelectionStart:o,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:p,children:f}){const m=g.useRef(null),y=Lt(),v=g.useRef(0),b=g.useRef(0),w=g.useRef(),_=g.useRef(new Map),{userSelectionActive:x,elementsSelectable:j,dragging:E}=tt(tue,Ut),S=j&&(e||x),O=g.useRef(!1),N=g.useRef(!1),M=()=>{y.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,b.current=0},k=L=>{if(O.current){O.current=!1;return}s==null||s(L),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},A=L=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){L.preventDefault();return}c==null||c(L)},P=l?L=>l(L):void 0,C=L=>{var F,W,re,ee;const{resetSelectedElements:D,domNode:z,edgeLookup:U}=y.getState();if(w.current=z==null?void 0:z.getBoundingClientRect(),!j||!e||L.button!==0||L.target!==m.current||!w.current)return;(W=(F=L.target)==null?void 0:F.setPointerCapture)==null||W.call(F,L.pointerId),N.current=!0,O.current=!1,_.current=new Map;for(const[G,K]of U)_.current.set(K.source,((re=_.current.get(K.source))==null?void 0:re.add(G))||new Set([G])),_.current.set(K.target,((ee=_.current.get(K.target))==null?void 0:ee.add(G))||new Set([G]));const{x:$,y:V}=Do(L.nativeEvent,w.current);D(),y.setState({userSelectionRect:{width:0,height:0,startX:$,startY:V,x:$,y:V}}),o==null||o(L)},T=L=>{const{userSelectionRect:D,edgeLookup:z,transform:U,nodeLookup:$,triggerNodeChanges:V,triggerEdgeChanges:F}=y.getState();if(!w.current||!D)return;O.current=!0;const{x:W,y:re}=Do(L.nativeEvent,w.current),{startX:ee,startY:G}=D,K={startX:ee,startY:G,x:W<ee?W:ee,y:re<G?re:G,width:Math.abs(W-ee),height:Math.abs(re-G)},X=B4($,K,U,n===yd.Partial,!0),ne=new Set,B=new Set;for(const ue of X){B.add(ue.id);const ae=_.current.get(ue.id);if(ae)for(const de of ae)ne.add(de)}if(v.current!==B.size){v.current=B.size;const ue=Ac($,B,!0);V(ue)}if(b.current!==ne.size){b.current=ne.size;const ue=Ac(z,ne);F(ue)}y.setState({userSelectionRect:K,userSelectionActive:!0,nodesSelectionActive:!1})},I=L=>{var z,U;if(L.button!==0||!N.current)return;(U=(z=L.target)==null?void 0:z.releasePointerCapture)==null||U.call(z,L.pointerId);const{userSelectionRect:D}=y.getState();!x&&D&&L.target===m.current&&(k==null||k(L)),v.current>0&&y.setState({nodesSelectionActive:!0}),M(),i==null||i(L),(t||a)&&(O.current=!1),N.current=!1},R=r===!0||Array.isArray(r)&&r.includes(0);return h.jsxs("div",{className:rn(["react-flow__pane",{draggable:R,dragging:E,selection:e}]),onClick:S?void 0:L_(k,m),onContextMenu:L_(A,m),onWheel:L_(P,m),onPointerEnter:S?void 0:u,onPointerDown:S?C:d,onPointerMove:S?T:d,onPointerUp:S?I:void 0,onPointerLeave:p,ref:m,style:gm,children:[f,h.jsx(eue,{})]})}function $_({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:a,unselectNodesAndEdges:o,multiSelectionActive:i,nodeLookup:s,onError:c}=t.getState(),l=s.get(e);if(!l){c==null||c("012",Io.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(o({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):a([e])}function J5({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:a,isSelectable:o,nodeClickDistance:i}){const s=Lt(),[c,l]=g.useState(!1),u=g.useRef();return g.useEffect(()=>{u.current=Kce({getStoreItems:()=>s.getState(),onNodeMouseDown:d=>{$_({id:d,store:s,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),g.useEffect(()=>{var d,p;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(p=u.current)==null||p.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:o,nodeId:a,nodeClickDistance:i}),()=>{var f;(f=u.current)==null||f.destroy()}},[n,r,t,o,e,a]),c}const rue=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Y5(){const e=Lt();return g.useCallback(t=>{const{nodeExtent:n,snapToGrid:r,snapGrid:a,nodesDraggable:o,onError:i,updateNodePositions:s,nodeLookup:c,nodeOrigin:l}=e.getState(),u=new Map,d=rue(o),p=r?a[0]:5,f=r?a[1]:5,m=t.direction.x*p*t.factor,y=t.direction.y*f*t.factor;for(const[,v]of c){if(!d(v))continue;let b={x:v.internals.positionAbsolute.x+m,y:v.internals.positionAbsolute.y+y};r&&(b=lm(b,a));const{position:w,positionAbsolute:_}=z4({nodeId:v.id,nextPosition:b,nodeLookup:c,nodeExtent:n,nodeOrigin:l,onError:i});v.position=w,v.internals.positionAbsolute=_,u.set(v.id,v)}s(u)},[])}const F_=g.createContext(null),aue=F_.Provider;F_.Consumer;const B_=()=>g.useContext(F_),oue=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),iue=(e,t,n)=>r=>{const{connectionClickStartHandle:a,connectionMode:o,connection:i}=r,{fromHandle:s,toHandle:c,isValid:l}=i,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,connectingTo:u,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,isPossibleEndHandle:o===Ec.Strict?(s==null?void 0:s.type)!==n:e!==(s==null?void 0:s.nodeId)||t!==(s==null?void 0:s.id),connectionInProcess:!!s,valid:u&&l}};function sue({type:e="source",position:t=he.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:a=!0,isConnectableEnd:o=!0,id:i,onConnect:s,children:c,className:l,onMouseDown:u,onTouchStart:d,...p},f){var C,T;const m=i||null,y=e==="target",v=Lt(),b=B_(),{connectOnClick:w,noPanClassName:_,rfId:x}=tt(oue,Ut),{connectingFrom:j,connectingTo:E,clickConnecting:S,isPossibleEndHandle:O,connectionInProcess:N,valid:M}=tt(iue(b,m,e),Ut);b||((T=(C=v.getState()).onError)==null||T.call(C,"010",Io.error010()));const k=I=>{const{defaultEdgeOptions:R,onConnect:L,hasDefaultEdges:D}=v.getState(),z={...R,...I};if(D){const{edges:U,setEdges:$}=v.getState();$(r5(z,U))}L==null||L(z),s==null||s(z)},A=I=>{if(!b)return;const R=J4(I.nativeEvent);if(a&&(R&&I.button===0||!R)){const L=v.getState();P_.onPointerDown(I.nativeEvent,{autoPanOnConnect:L.autoPanOnConnect,connectionMode:L.connectionMode,connectionRadius:L.connectionRadius,domNode:L.domNode,nodeLookup:L.nodeLookup,lib:L.lib,isTarget:y,handleId:m,nodeId:b,flowId:L.rfId,panBy:L.panBy,cancelConnection:L.cancelConnection,onConnectStart:L.onConnectStart,onConnectEnd:L.onConnectEnd,updateConnection:L.updateConnection,onConnect:k,isValidConnection:n||L.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:L.autoPanSpeed})}R?u==null||u(I):d==null||d(I)},P=I=>{const{onClickConnectStart:R,onClickConnectEnd:L,connectionClickStartHandle:D,connectionMode:z,isValidConnection:U,lib:$,rfId:V,nodeLookup:F,connection:W}=v.getState();if(!b||!D&&!a)return;if(!D){R==null||R(I.nativeEvent,{nodeId:b,handleId:m,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:b,type:e,id:m}});return}const re=X4(I.target),ee=n||U,{connection:G,isValid:K}=P_.isValid(I.nativeEvent,{handle:{nodeId:b,id:m,type:e},connectionMode:z,fromNodeId:D.nodeId,fromHandleId:D.id||null,fromType:D.type,isValidConnection:ee,flowId:V,doc:re,lib:$,nodeLookup:F});K&&G&&k(G);const X=structuredClone(W);delete X.inProgress,X.toPosition=X.toHandle?X.toHandle.position:null,L==null||L(I,X),v.setState({connectionClickStartHandle:null})};return h.jsx("div",{"data-handleid":m,"data-nodeid":b,"data-handlepos":t,"data-id":`${x}-${b}-${m}-${e}`,className:rn(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",_,l,{source:!y,target:y,connectable:r,connectablestart:a,connectableend:o,clickconnecting:S,connectingfrom:j,connectingto:E,valid:M,connectionindicator:r&&(!N||O)&&(N?o:a)}]),onMouseDown:A,onTouchStart:A,onClick:w?P:void 0,ref:f,...p,children:c})}const Sd=g.memo(K5(sue));function cue({data:e,isConnectable:t,sourcePosition:n=he.Bottom}){return h.jsxs(h.Fragment,{children:[e==null?void 0:e.label,h.jsx(Sd,{type:"source",position:n,isConnectable:t})]})}function lue({data:e,isConnectable:t,targetPosition:n=he.Top,sourcePosition:r=he.Bottom}){return h.jsxs(h.Fragment,{children:[h.jsx(Sd,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,h.jsx(Sd,{type:"source",position:r,isConnectable:t})]})}function uue(){return null}function due({data:e,isConnectable:t,targetPosition:n=he.Top}){return h.jsxs(h.Fragment,{children:[h.jsx(Sd,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const vm={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Q5={input:cue,default:lue,output:due,group:uue};function pue(e){var t,n,r,a;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((a=e.style)==null?void 0:a.height)}}const fue=e=>{const{width:t,height:n,x:r,y:a}=vd(e.nodeLookup,{filter:o=>!!o.selected});return{width:oa(t)?t:null,height:oa(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`}};function hue({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Lt(),{width:a,height:o,transformString:i,userSelectionActive:s}=tt(fue,Ut),c=Y5(),l=g.useRef(null);if(g.useEffect(()=>{var p;n||((p=l.current)==null||p.focus({preventScroll:!0}))},[n]),J5({nodeRef:l}),s||!a||!o)return null;const u=e?p=>{const f=r.getState().nodes.filter(m=>m.selected);e(p,f)}:void 0,d=p=>{Object.prototype.hasOwnProperty.call(vm,p.key)&&c({direction:vm[p.key],factor:p.shiftKey?4:1})};return h.jsx("div",{className:rn(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:h.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:a,height:o}})})}const eL=typeof window<"u"?window:void 0,mue=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function tL({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:p,onSelectionEnd:f,multiSelectionKeyCode:m,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:_,panOnScroll:x,panOnScrollSpeed:j,panOnScrollMode:E,zoomOnDoubleClick:S,panOnDrag:O,defaultViewport:N,translateExtent:M,minZoom:k,maxZoom:A,preventScrolling:P,onSelectionContextMenu:C,noWheelClassName:T,noPanClassName:I,disableKeyboardA11y:R,onViewportChange:L,isControlledViewport:D}){const{nodesSelectionActive:z,userSelectionActive:U}=tt(mue),$=jd(l,{target:eL}),V=jd(y,{target:eL}),F=V||O,W=V||x,re=u&&F!==!0,ee=$||U||re;return Gle({deleteKeyCode:c,multiSelectionKeyCode:m}),h.jsx(Yle,{onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:_,panOnScroll:W,panOnScrollSpeed:j,panOnScrollMode:E,zoomOnDoubleClick:S,panOnDrag:!$&&F,defaultViewport:N,translateExtent:M,minZoom:k,maxZoom:A,zoomActivationKeyCode:v,preventScrolling:P,noWheelClassName:T,noPanClassName:I,onViewportChange:L,isControlledViewport:D,paneClickDistance:s,children:h.jsxs(nue,{onSelectionStart:p,onSelectionEnd:f,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,panOnDrag:F,isSelecting:!!ee,selectionMode:d,selectionKeyPressed:$,selectionOnDrag:re,children:[e,z&&h.jsx(hue,{onSelectionContextMenu:C,noPanClassName:I,disableKeyboardA11y:R})]})})}tL.displayName="FlowRenderer";const yue=g.memo(tL),gue=e=>t=>e?B4(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function vue(e){return tt(g.useCallback(gue(e),[e]),Ut)}const bue=e=>e.updateNodeInternals;function wue(){const e=tt(bue),[t]=g.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(a=>{const o=a.target.getAttribute("data-id");r.set(o,{id:o,nodeElement:a.target,force:!0})}),e(r)}));return g.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function xue({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const a=Lt(),o=g.useRef(null),i=g.useRef(null),s=g.useRef(e.sourcePosition),c=g.useRef(e.targetPosition),l=g.useRef(t),u=n&&!!e.internals.handleBounds;return g.useEffect(()=>{o.current&&!e.hidden&&(!u||i.current!==o.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(o.current),i.current=o.current)},[u,e.hidden]),g.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),g.useEffect(()=>{if(o.current){const d=l.current!==t,p=s.current!==e.sourcePosition,f=c.current!==e.targetPosition;(d||p||f)&&(l.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:o.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),o}function _ue({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:a,onContextMenu:o,onDoubleClick:i,nodesDraggable:s,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:p,noPanClassName:f,disableKeyboardA11y:m,rfId:y,nodeTypes:v,nodeExtent:b,nodeClickDistance:w,onError:_}){const{node:x,internals:j,isParent:E}=tt(G=>{const K=G.nodeLookup.get(e),X=G.parentLookup.has(e);return{node:K,internals:K.internals,isParent:X}},Ut);let S=x.type||"default",O=(v==null?void 0:v[S])||Q5[S];O===void 0&&(_==null||_("003",Io.error003(S)),S="default",O=Q5.default);const N=!!(x.draggable||s&&typeof x.draggable>"u"),M=!!(x.selectable||c&&typeof x.selectable>"u"),k=!!(x.connectable||l&&typeof x.connectable>"u"),A=!!(x.focusable||u&&typeof x.focusable>"u"),P=Lt(),C=Z4(x),T=xue({node:x,nodeType:S,hasDimensions:C,resizeObserver:d}),I=J5({nodeRef:T,disabled:x.hidden||!N,noDragClassName:p,handleSelector:x.dragHandle,nodeId:e,isSelectable:M,nodeClickDistance:w}),R=Y5();if(x.hidden)return null;const L=Ro(x),D=pue(x),z=M||N||t||n||r||a,U=n?G=>n(G,{...j.userNode}):void 0,$=r?G=>r(G,{...j.userNode}):void 0,V=a?G=>a(G,{...j.userNode}):void 0,F=o?G=>o(G,{...j.userNode}):void 0,W=i?G=>i(G,{...j.userNode}):void 0,re=G=>{const{selectNodesOnDrag:K,nodeDragThreshold:X}=P.getState();M&&(!K||!N||X>0)&&$_({id:e,store:P,nodeRef:T}),t&&t(G,{...j.userNode})},ee=G=>{if(!(j_(G.nativeEvent)||m))if(I4.includes(G.key)&&M){const K=G.key==="Escape";$_({id:e,store:P,unselect:K,nodeRef:T})}else N&&x.selected&&Object.prototype.hasOwnProperty.call(vm,G.key)&&(P.setState({ariaLiveMessage:`Moved selected node ${G.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~j.positionAbsolute.x}, y: ${~~j.positionAbsolute.y}`}),R({direction:vm[G.key],factor:G.shiftKey?4:1}))};return h.jsx("div",{className:rn(["react-flow__node",`react-flow__node-${S}`,{[f]:N},x.className,{selected:x.selected,selectable:M,parent:E,draggable:N,dragging:I}]),ref:T,style:{zIndex:j.z,transform:`translate(${j.positionAbsolute.x}px,${j.positionAbsolute.y}px)`,pointerEvents:z?"all":"none",visibility:C?"visible":"hidden",...x.style,...D},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:U,onMouseMove:$,onMouseLeave:V,onContextMenu:F,onClick:re,onDoubleClick:W,onKeyDown:A?ee:void 0,tabIndex:A?0:void 0,role:A?"button":void 0,"aria-describedby":m?void 0:`${I5}-${y}`,"aria-label":x.ariaLabel,children:h.jsx(aue,{value:e,children:h.jsx(O,{id:e,data:x.data,type:S,positionAbsoluteX:j.positionAbsolute.x,positionAbsoluteY:j.positionAbsolute.y,selected:x.selected,selectable:M,draggable:N,deletable:x.deletable??!0,isConnectable:k,sourcePosition:x.sourcePosition,targetPosition:x.targetPosition,dragging:I,dragHandle:x.dragHandle,zIndex:j.z,parentId:x.parentId,...L})})})}const jue=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function nL(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,onError:o}=tt(jue,Ut),i=vue(e.onlyRenderVisibleElements),s=wue();return h.jsx("div",{className:"react-flow__nodes",style:gm,children:i.map(c=>h.jsx(_ue,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:o},c))})}nL.displayName="NodeRenderer";const Eue=g.memo(nL);function Sue(e){return tt(g.useCallback(t=>{if(!e)return t.edges.map(r=>r.id);const n=[];if(t.width&&t.height)for(const r of t.edges){const a=t.nodeLookup.get(r.source),o=t.nodeLookup.get(r.target);a&&o&&Pce({sourceNode:a,targetNode:o,width:t.width,height:t.height,transform:t.transform})&&n.push(r.id)}return n},[e]),Ut)}const Oue=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Cue=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),rL={[om.Arrow]:Oue,[om.ArrowClosed]:Cue};function Nue(e){const t=Lt();return g.useMemo(()=>{var n,r;return Object.prototype.hasOwnProperty.call(rL,e)?rL[e]:((r=(n=t.getState()).onError)==null||r.call(n,"009",Io.error009(e)),null)},[e])}const kue=({id:e,type:t,color:n,width:r=12.5,height:a=12.5,markerUnits:o="strokeWidth",strokeWidth:i,orient:s="auto-start-reverse"})=>{const c=Nue(t);return c?h.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:h.jsx(c,{color:n,strokeWidth:i})}):null},aL=({defaultColor:e,rfId:t})=>{const n=tt(o=>o.edges),r=tt(o=>o.defaultEdgeOptions),a=g.useMemo(()=>Fce(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return a.length?h.jsx("svg",{className:"react-flow__marker",children:h.jsx("defs",{children:a.map(o=>h.jsx(kue,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})}):null};aL.displayName="MarkerDefinitions";var Mue=g.memo(aL);function oL({x:e,y:t,label:n,labelStyle:r={},labelShowBg:a=!0,labelBgStyle:o={},labelBgPadding:i=[2,4],labelBgBorderRadius:s=2,children:c,className:l,...u}){const[d,p]=g.useState({x:1,y:0,width:0,height:0}),f=rn(["react-flow__edge-textwrapper",l]),m=g.useRef(null);return g.useEffect(()=>{if(m.current){const y=m.current.getBBox();p({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),typeof n>"u"||!n?null:h.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:f,visibility:d.width?"visible":"hidden",...u,children:[a&&h.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),h.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:m,style:r,children:n}),c]})}oL.displayName="EdgeText";const Aue=g.memo(oL);function bm({id:e,path:t,labelX:n,labelY:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:p,className:f,interactionWidth:m=20}){return h.jsxs(h.Fragment,{children:[h.jsx("path",{id:e,style:u,d:t,fill:"none",className:rn(["react-flow__edge-path",f]),markerEnd:d,markerStart:p}),m&&h.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),a&&oa(n)&&oa(r)?h.jsx(Aue,{x:n,y:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l}):null]})}function iL({pos:e,x1:t,y1:n,x2:r,y2:a}){return e===he.Left||e===he.Right?[.5*(t+r),n]:[t,.5*(n+a)]}function sL({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:o=he.Top}){const[i,s]=iL({pos:n,x1:e,y1:t,x2:r,y2:a}),[c,l]=iL({pos:o,x1:r,y1:a,x2:e,y2:t}),[u,d,p,f]=Q4({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:i,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${s} ${c},${l} ${r},${a}`,u,d,p,f]}function cL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=he.Bottom,targetPosition:s=he.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:m,markerEnd:y,markerStart:v,interactionWidth:b})=>{const[w,_,x]=sL({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s}),j=e.isInternal?void 0:t;return h.jsx(bm,{id:j,path:w,labelX:_,labelY:x,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:m,markerEnd:y,markerStart:v,interactionWidth:b})})}const Pue=cL({isInternal:!1}),lL=cL({isInternal:!0});Pue.displayName="SimpleBezierEdge",lL.displayName="SimpleBezierEdgeInternal";function uL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,sourcePosition:f=he.Bottom,targetPosition:m=he.Top,markerEnd:y,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[_,x,j]=E_({sourceX:n,sourceY:r,sourcePosition:f,targetX:a,targetY:o,targetPosition:m,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset}),E=e.isInternal?void 0:t;return h.jsx(bm,{id:E,path:_,labelX:x,labelY:j,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:y,markerStart:v,interactionWidth:w})})}const dL=uL({isInternal:!1}),pL=uL({isInternal:!0});dL.displayName="SmoothStepEdge",pL.displayName="SmoothStepEdgeInternal";function fL(e){return g.memo(({id:t,...n})=>{var a;const r=e.isInternal?void 0:t;return h.jsx(dL,{...n,id:r,pathOptions:g.useMemo(()=>{var o;return{borderRadius:0,offset:(o=n.pathOptions)==null?void 0:o.offset}},[(a=n.pathOptions)==null?void 0:a.offset])})})}const Tue=fL({isInternal:!1}),hL=fL({isInternal:!0});Tue.displayName="StepEdge",hL.displayName="StepEdgeInternal";function mL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:m,interactionWidth:y})=>{const[v,b,w]=a5({sourceX:n,sourceY:r,targetX:a,targetY:o}),_=e.isInternal?void 0:t;return h.jsx(bm,{id:_,path:v,labelX:b,labelY:w,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:m,interactionWidth:y})})}const Iue=mL({isInternal:!1}),yL=mL({isInternal:!0});Iue.displayName="StraightEdge",yL.displayName="StraightEdgeInternal";function gL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=he.Bottom,targetPosition:s=he.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:m,markerEnd:y,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[_,x,j]=t5({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s,curvature:b==null?void 0:b.curvature}),E=e.isInternal?void 0:t;return h.jsx(bm,{id:E,path:_,labelX:x,labelY:j,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:m,markerEnd:y,markerStart:v,interactionWidth:w})})}const Rue=gL({isInternal:!1}),vL=gL({isInternal:!0});Rue.displayName="BezierEdge",vL.displayName="BezierEdgeInternal";const bL={default:vL,straight:yL,step:hL,smoothstep:pL,simplebezier:lL},wL={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Due=(e,t,n)=>n===he.Left?e-t:n===he.Right?e+t:e,Lue=(e,t,n)=>n===he.Top?e-t:n===he.Bottom?e+t:e,xL="react-flow__edgeupdater";function _L({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:a,onMouseEnter:o,onMouseOut:i,type:s}){return h.jsx("circle",{onMouseDown:a,onMouseEnter:o,onMouseOut:i,className:rn([xL,`${xL}-${s}`]),cx:Due(t,r,e),cy:Lue(n,r,e),r,stroke:"transparent",fill:"transparent"})}function $ue({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:a,targetX:o,targetY:i,sourcePosition:s,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:p,setUpdateHover:f}){const m=Lt(),y=(x,j)=>{if(x.button!==0)return;const{autoPanOnConnect:E,domNode:S,isValidConnection:O,connectionMode:N,connectionRadius:M,lib:k,onConnectStart:A,onConnectEnd:P,cancelConnection:C,nodeLookup:T,rfId:I,panBy:R,updateConnection:L}=m.getState(),D=j.type==="target";p(!0),u==null||u(x,n,j.type);const z=($,V)=>{p(!1),d==null||d($,n,j.type,V)},U=$=>l==null?void 0:l(n,$);P_.onPointerDown(x.nativeEvent,{autoPanOnConnect:E,connectionMode:N,connectionRadius:M,domNode:S,handleId:j.id,nodeId:j.nodeId,nodeLookup:T,isTarget:D,edgeUpdaterType:j.type,lib:k,flowId:I,cancelConnection:C,panBy:R,isValidConnection:O,onConnect:U,onConnectStart:A,onConnectEnd:P,onReconnectEnd:z,updateConnection:L,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle})},v=x=>y(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=x=>y(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>f(!0),_=()=>f(!1);return h.jsxs(h.Fragment,{children:[(e===!0||e==="source")&&h.jsx(_L,{position:s,centerX:r,centerY:a,radius:t,onMouseDown:v,onMouseEnter:w,onMouseOut:_,type:"source"}),(e===!0||e==="target")&&h.jsx(_L,{position:c,centerX:o,centerY:i,radius:t,onMouseDown:b,onMouseEnter:w,onMouseOut:_,type:"target"})]})}function Fue({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:a,onDoubleClick:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:p,onReconnectEnd:f,rfId:m,edgeTypes:y,noPanClassName:v,onError:b,disableKeyboardA11y:w}){let _=tt(B=>B.edgeLookup.get(e));const x=tt(B=>B.defaultEdgeOptions);_=x?{...x,..._}:_;let j=_.type||"default",E=(y==null?void 0:y[j])||bL[j];E===void 0&&(b==null||b("011",Io.error011(j)),j="default",E=bL.default);const S=!!(_.focusable||t&&typeof _.focusable>"u"),O=typeof d<"u"&&(_.reconnectable||n&&typeof _.reconnectable>"u"),N=!!(_.selectable||r&&typeof _.selectable>"u"),M=g.useRef(null),[k,A]=g.useState(!1),[P,C]=g.useState(!1),T=Lt(),{zIndex:I,sourceX:R,sourceY:L,targetX:D,targetY:z,sourcePosition:U,targetPosition:$}=tt(g.useCallback(B=>{const ue=B.nodeLookup.get(_.source),ae=B.nodeLookup.get(_.target);if(!ue||!ae)return{zIndex:_.zIndex,...wL};const de=$ce({id:e,sourceNode:ue,targetNode:ae,sourceHandle:_.sourceHandle||null,targetHandle:_.targetHandle||null,connectionMode:B.connectionMode,onError:b});return{zIndex:Ace({selected:_.selected,zIndex:_.zIndex,sourceNode:ue,targetNode:ae,elevateOnSelect:B.elevateEdgesOnSelect}),...de||wL}},[_.source,_.target,_.sourceHandle,_.targetHandle,_.selected,_.zIndex]),Ut),V=g.useMemo(()=>_.markerStart?`url('#${S_(_.markerStart,m)}')`:void 0,[_.markerStart,m]),F=g.useMemo(()=>_.markerEnd?`url('#${S_(_.markerEnd,m)}')`:void 0,[_.markerEnd,m]);if(_.hidden||R===null||L===null||D===null||z===null)return null;const W=B=>{var je;const{addSelectedEdges:ue,unselectNodesAndEdges:ae,multiSelectionActive:de}=T.getState();N&&(T.setState({nodesSelectionActive:!1}),_.selected&&de?(ae({nodes:[],edges:[_]}),(je=M.current)==null||je.blur()):ue([e])),a&&a(B,_)},re=o?B=>{o(B,{..._})}:void 0,ee=i?B=>{i(B,{..._})}:void 0,G=s?B=>{s(B,{..._})}:void 0,K=c?B=>{c(B,{..._})}:void 0,X=l?B=>{l(B,{..._})}:void 0,ne=B=>{var ue;if(!w&&I4.includes(B.key)&&N){const{unselectNodesAndEdges:ae,addSelectedEdges:de}=T.getState();B.key==="Escape"?((ue=M.current)==null||ue.blur(),ae({edges:[_]})):de([e])}};return h.jsx("svg",{style:{zIndex:I},children:h.jsxs("g",{className:rn(["react-flow__edge",`react-flow__edge-${j}`,_.className,v,{selected:_.selected,animated:_.animated,inactive:!N&&!a,updating:k,selectable:N}]),onClick:W,onDoubleClick:re,onContextMenu:ee,onMouseEnter:G,onMouseMove:K,onMouseLeave:X,onKeyDown:S?ne:void 0,tabIndex:S?0:void 0,role:S?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":_.ariaLabel===null?void 0:_.ariaLabel||`Edge from ${_.source} to ${_.target}`,"aria-describedby":S?`${R5}-${m}`:void 0,ref:M,children:[!P&&h.jsx(E,{id:e,source:_.source,target:_.target,type:_.type,selected:_.selected,animated:_.animated,selectable:N,deletable:_.deletable??!0,label:_.label,labelStyle:_.labelStyle,labelShowBg:_.labelShowBg,labelBgStyle:_.labelBgStyle,labelBgPadding:_.labelBgPadding,labelBgBorderRadius:_.labelBgBorderRadius,sourceX:R,sourceY:L,targetX:D,targetY:z,sourcePosition:U,targetPosition:$,data:_.data,style:_.style,sourceHandleId:_.sourceHandle,targetHandleId:_.targetHandle,markerStart:V,markerEnd:F,pathOptions:"pathOptions"in _?_.pathOptions:void 0,interactionWidth:_.interactionWidth}),O&&h.jsx($ue,{edge:_,isReconnectable:O,reconnectRadius:u,onReconnect:d,onReconnectStart:p,onReconnectEnd:f,sourceX:R,sourceY:L,targetX:D,targetY:z,sourcePosition:U,targetPosition:$,setUpdateHover:A,setReconnecting:C})]})})}const Bue=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function jL({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:a,onReconnect:o,onEdgeContextMenu:i,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:p,onReconnectStart:f,onReconnectEnd:m,disableKeyboardA11y:y}){const{edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,onError:_}=tt(Bue,Ut),x=Sue(t);return h.jsxs("div",{className:"react-flow__edges",children:[h.jsx(Mue,{defaultColor:e,rfId:n}),x.map(j=>h.jsx(Fue,{id:j,edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,noPanClassName:a,onReconnect:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:p,onReconnectStart:f,onReconnectEnd:m,rfId:n,onError:_,edgeTypes:r,disableKeyboardA11y:y},j))]})}jL.displayName="EdgeRenderer";const zue=g.memo(jL),Uue=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Vue({children:e}){const t=tt(Uue);return h.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Wue(e){const t=tr(),n=g.useRef(!1);g.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Hue=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function que(e){const t=tt(Hue),n=Lt();return g.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Kue(e){return e.connection.inProgress?{...e.connection,to:wd(e.connection.to,e.transform)}:{...e.connection}}function Zue(e){return Kue}function Gue(e){const t=Zue();return tt(t,Ut)}const Xue=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Jue({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:a,width:o,height:i,isValid:s,inProgress:c}=tt(Xue,Ut);return o&&a&&c?h.jsx("svg",{style:e,width:o,height:i,className:"react-flow__connectionline react-flow__container",children:h.jsx("g",{className:rn(["react-flow__connection",$4(s)]),children:h.jsx(EL,{style:t,type:n,CustomComponent:r,isValid:s})})}):null}const EL=({style:e,type:t=gi.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:a,from:o,fromNode:i,fromHandle:s,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:p}=Gue();if(!a)return;if(n)return h.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:s,fromX:o.x,fromY:o.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:p,connectionStatus:$4(r),toNode:u,toHandle:d});let f="";const m={sourceX:o.x,sourceY:o.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:p};switch(t){case gi.Bezier:[f]=t5(m);break;case gi.SimpleBezier:[f]=sL(m);break;case gi.Step:[f]=E_({...m,borderRadius:0});break;case gi.SmoothStep:[f]=E_(m);break;default:[f]=a5(m)}return h.jsx("path",{d:f,fill:"none",className:"react-flow__connection-path",style:e})};EL.displayName="ConnectionLine";const Yue={};function SL(e=Yue){g.useRef(e),Lt(),g.useEffect(()=>{},[e])}function Que(){Lt(),g.useRef(!1),g.useEffect(()=>{},[])}function OL({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:o,onEdgeDoubleClick:i,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:p,onSelectionEnd:f,connectionLineType:m,connectionLineStyle:y,connectionLineComponent:v,connectionLineContainerStyle:b,selectionKeyCode:w,selectionOnDrag:_,selectionMode:x,multiSelectionKeyCode:j,panActivationKeyCode:E,zoomActivationKeyCode:S,deleteKeyCode:O,onlyRenderVisibleElements:N,elementsSelectable:M,defaultViewport:k,translateExtent:A,minZoom:P,maxZoom:C,preventScrolling:T,defaultMarkerColor:I,zoomOnScroll:R,zoomOnPinch:L,panOnScroll:D,panOnScrollSpeed:z,panOnScrollMode:U,zoomOnDoubleClick:$,panOnDrag:V,onPaneClick:F,onPaneMouseEnter:W,onPaneMouseMove:re,onPaneMouseLeave:ee,onPaneScroll:G,onPaneContextMenu:K,paneClickDistance:X,nodeClickDistance:ne,onEdgeContextMenu:B,onEdgeMouseEnter:ue,onEdgeMouseMove:ae,onEdgeMouseLeave:de,reconnectRadius:je,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Ee,noDragClassName:We,noWheelClassName:qe,noPanClassName:Ke,disableKeyboardA11y:It,nodeExtent:lt,rfId:it,viewport:_t,onViewportChange:Qt}){return SL(e),SL(t),Que(),Wue(n),que(_t),h.jsx(yue,{onPaneClick:F,onPaneMouseEnter:W,onPaneMouseMove:re,onPaneMouseLeave:ee,onPaneContextMenu:K,onPaneScroll:G,paneClickDistance:X,deleteKeyCode:O,selectionKeyCode:w,selectionOnDrag:_,selectionMode:x,onSelectionStart:p,onSelectionEnd:f,multiSelectionKeyCode:j,panActivationKeyCode:E,zoomActivationKeyCode:S,elementsSelectable:M,zoomOnScroll:R,zoomOnPinch:L,zoomOnDoubleClick:$,panOnScroll:D,panOnScrollSpeed:z,panOnScrollMode:U,panOnDrag:V,defaultViewport:k,translateExtent:A,minZoom:P,maxZoom:C,onSelectionContextMenu:d,preventScrolling:T,noDragClassName:We,noWheelClassName:qe,noPanClassName:Ke,disableKeyboardA11y:It,onViewportChange:Qt,isControlledViewport:!!_t,children:h.jsxs(Vue,{children:[h.jsx(zue,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:i,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Ee,onlyRenderVisibleElements:N,onEdgeContextMenu:B,onEdgeMouseEnter:ue,onEdgeMouseMove:ae,onEdgeMouseLeave:de,reconnectRadius:je,defaultMarkerColor:I,noPanClassName:Ke,disableKeyboardA11y:It,rfId:it}),h.jsx(Jue,{style:y,type:m,component:v,containerStyle:b}),h.jsx("div",{className:"react-flow__edgelabel-renderer"}),h.jsx(Eue,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:ne,onlyRenderVisibleElements:N,noPanClassName:Ke,noDragClassName:We,disableKeyboardA11y:It,nodeExtent:lt,rfId:it}),h.jsx("div",{className:"react-flow__viewport-portal"})]})})}OL.displayName="GraphView";const ede=g.memo(OL),CL=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}={})=>{const l=new Map,u=new Map,d=new Map,p=new Map,f=r??t??[],m=n??e??[],y=s??[0,0],v=c??md;d5(d,p,f),N_(m,l,u,{nodeOrigin:y,nodeExtent:v,elevateNodesOnSelect:!1});let b=[0,0,1];if(i&&a&&o){const w=vd(l,{filter:E=>!!((E.width||E.initialWidth)&&(E.height||E.initialHeight))}),{x:_,y:x,zoom:j}=__(w,a,o,.5,2,.1);b=[_,x,j]}return{rfId:"1",width:0,height:0,transform:b,nodes:m,nodeLookup:l,parentLookup:u,edges:f,edgeLookup:p,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:md,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Ec.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:y,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...R4},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:kce,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},tde=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c})=>wle((l,u)=>({...CL({nodes:e,edges:t,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:d=>{const{nodeLookup:p,parentLookup:f,nodeOrigin:m,elevateNodesOnSelect:y}=u();N_(d,p,f,{nodeOrigin:m,nodeExtent:c,elevateNodesOnSelect:y,checkEquality:!0}),l({nodes:d})},setEdges:d=>{const{connectionLookup:p,edgeLookup:f}=u();d5(p,f,d),l({edges:d})},setDefaultNodesAndEdges:(d,p)=>{if(d){const{setNodes:f}=u();f(d),l({hasDefaultNodes:!0})}if(p){const{setEdges:f}=u();f(p),l({hasDefaultEdges:!0})}},updateNodeInternals:(d,p={triggerFitView:!0})=>{const{triggerNodeChanges:f,nodeLookup:m,parentLookup:y,fitViewOnInit:v,fitViewDone:b,fitViewOnInitOptions:w,domNode:_,nodeOrigin:x,nodeExtent:j,debug:E,fitViewSync:S}=u(),{changes:O,updatedInternals:N}=Wce(d,m,y,_,x,j);if(N){if(zce(m,y,{nodeOrigin:x,nodeExtent:j}),p.triggerFitView){let M=b;!b&&v&&(M=S({...w,nodes:w==null?void 0:w.nodes})),l({fitViewDone:M})}else l({});(O==null?void 0:O.length)>0&&(E&&console.log("React Flow: trigger node changes",O),f==null||f(O))}},updateNodePositions:(d,p=!1)=>{const f=[],m=[];for(const[y,v]of d){const b={id:y,type:"position",position:v.position,dragging:p};v!=null&&v.expandParent&&(v!=null&&v.parentId)&&b.position&&(f.push({id:y,parentId:v.parentId,rect:{...v.internals.positionAbsolute,width:v.measured.width,height:v.measured.height}}),b.position.x=Math.max(0,b.position.x),b.position.y=Math.max(0,b.position.y)),m.push(b)}if(f.length>0){const{nodeLookup:y,parentLookup:v,nodeOrigin:b}=u(),w=M_(f,y,v,b);m.push(...w)}u().triggerNodeChanges(m)},triggerNodeChanges:d=>{const{onNodesChange:p,setNodes:f,nodes:m,hasDefaultNodes:y,debug:v}=u();if(d!=null&&d.length){if(y){const b=ps(d,m);f(b)}v&&console.log("React Flow: trigger node changes",d),p==null||p(d)}},triggerEdgeChanges:d=>{const{onEdgesChange:p,setEdges:f,edges:m,hasDefaultEdges:y,debug:v}=u();if(d!=null&&d.length){if(y){const b=Ed(d,m);f(b)}v&&console.log("React Flow: trigger edge changes",d),p==null||p(d)}},addSelectedNodes:d=>{const{multiSelectionActive:p,edgeLookup:f,nodeLookup:m,triggerNodeChanges:y,triggerEdgeChanges:v}=u();if(p){const b=d.map(w=>fs(w,!0));y(b);return}y(Ac(m,new Set([...d]),!0)),v(Ac(f))},addSelectedEdges:d=>{const{multiSelectionActive:p,edgeLookup:f,nodeLookup:m,triggerNodeChanges:y,triggerEdgeChanges:v}=u();if(p){const b=d.map(w=>fs(w,!0));v(b);return}v(Ac(f,new Set([...d]))),y(Ac(m,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:p}={})=>{const{edges:f,nodes:m,nodeLookup:y,triggerNodeChanges:v,triggerEdgeChanges:b}=u(),w=d||m,_=p||f,x=w.map(E=>{const S=y.get(E.id);return S&&(S.selected=!1),fs(E.id,!1)}),j=_.map(E=>fs(E.id,!1));v(x),b(j)},setMinZoom:d=>{const{panZoom:p,maxZoom:f}=u();p==null||p.setScaleExtent([d,f]),l({minZoom:d})},setMaxZoom:d=>{const{panZoom:p,minZoom:f}=u();p==null||p.setScaleExtent([f,d]),l({maxZoom:d})},setTranslateExtent:d=>{var p;(p=u().panZoom)==null||p.setTranslateExtent(d),l({translateExtent:d})},setPaneClickDistance:d=>{var p;(p=u().panZoom)==null||p.setClickDistance(d)},resetSelectedElements:()=>{const{edges:d,nodes:p,triggerNodeChanges:f,triggerEdgeChanges:m}=u(),y=p.reduce((b,w)=>w.selected?[...b,fs(w.id,!1)]:b,[]),v=d.reduce((b,w)=>w.selected?[...b,fs(w.id,!1)]:b,[]);f(y),m(v)},setNodeExtent:d=>{const{nodes:p,nodeLookup:f,parentLookup:m,nodeOrigin:y,elevateNodesOnSelect:v,nodeExtent:b}=u();d[0][0]===b[0][0]&&d[0][1]===b[0][1]&&d[1][0]===b[1][0]&&d[1][1]===b[1][1]||(N_(p,f,m,{nodeOrigin:y,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!1}),l({nodeExtent:d}))},panBy:d=>{const{transform:p,width:f,height:m,panZoom:y,translateExtent:v}=u();return Hce({delta:d,panZoom:y,transform:p,translateExtent:v,width:f,height:m})},fitView:d=>{const{panZoom:p,width:f,height:m,minZoom:y,maxZoom:v,nodeLookup:b}=u();if(!p)return Promise.resolve(!1);const w=b_(b,d);return w_({nodes:w,width:f,height:m,panZoom:p,minZoom:y,maxZoom:v},d)},fitViewSync:d=>{const{panZoom:p,width:f,height:m,minZoom:y,maxZoom:v,nodeLookup:b}=u();if(!p)return!1;const w=b_(b,d);return w_({nodes:w,width:f,height:m,panZoom:p,minZoom:y,maxZoom:v},d),w.size>0},cancelConnection:()=>{l({connection:{...R4}})},updateConnection:d=>{l({connection:d})},reset:()=>l({...CL()})}),Object.is);function nde({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:a,initialHeight:o,fitView:i,nodeOrigin:s,nodeExtent:c,children:l}){const[u]=g.useState(()=>tde({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}));return h.jsx(xle,{value:u,children:h.jsx(Wle,{children:l})})}function rde({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:o,height:i,fitView:s,nodeOrigin:c,nodeExtent:l}){return g.useContext(mm)?h.jsx(h.Fragment,{children:e}):h.jsx(nde,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:o,initialHeight:i,fitView:s,nodeOrigin:c,nodeExtent:l,children:e})}const ade={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function ode({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:a,nodeTypes:o,edgeTypes:i,onNodeClick:s,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:p,onConnect:f,onConnectStart:m,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:b,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:x,onNodeContextMenu:j,onNodeDoubleClick:E,onNodeDragStart:S,onNodeDrag:O,onNodeDragStop:N,onNodesDelete:M,onEdgesDelete:k,onDelete:A,onSelectionChange:P,onSelectionDragStart:C,onSelectionDrag:T,onSelectionDragStop:I,onSelectionContextMenu:R,onSelectionStart:L,onSelectionEnd:D,onBeforeDelete:z,connectionMode:U,connectionLineType:$=gi.Bezier,connectionLineStyle:V,connectionLineComponent:F,connectionLineContainerStyle:W,deleteKeyCode:re="Backspace",selectionKeyCode:ee="Shift",selectionOnDrag:G=!1,selectionMode:K=yd.Full,panActivationKeyCode:X="Space",multiSelectionKeyCode:ne=um()?"Meta":"Control",zoomActivationKeyCode:B=um()?"Meta":"Control",snapToGrid:ue,snapGrid:ae,onlyRenderVisibleElements:de=!1,selectNodesOnDrag:je,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Ee,nodeOrigin:We=D5,edgesFocusable:qe,edgesReconnectable:Ke,elementsSelectable:It=!0,defaultViewport:lt=Ile,minZoom:it=.5,maxZoom:_t=2,translateExtent:Qt=md,preventScrolling:cr=!0,nodeExtent:io,defaultMarkerColor:lr="#b1b1b7",zoomOnScroll:so=!0,zoomOnPinch:J=!0,panOnScroll:te=!1,panOnScrollSpeed:ce=.5,panOnScrollMode:me=yi.Free,zoomOnDoubleClick:Te=!0,panOnDrag:Xt=!0,onPaneClick:Bt,onPaneMouseEnter:Ge,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Se,onPaneContextMenu:Oe,paneClickDistance:He=0,nodeClickDistance:kt=0,children:Wt,onReconnect:H,onReconnectStart:Y,onReconnectEnd:oe,onEdgeContextMenu:fe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:De,onEdgeMouseMove:ze,onEdgeMouseLeave:ke,reconnectRadius:Ae=10,onNodesChange:we,onEdgesChange:Ue,noDragClassName:nt="nodrag",noWheelClassName:Dt="nowheel",noPanClassName:zt="nopan",fitView:st,fitViewOptions:ur,connectOnClick:en,attributionPosition:Vs,proOptions:Aa,defaultEdgeOptions:Vi,elevateNodesOnSelect:co,elevateEdgesOnSelect:hf,disableKeyboardA11y:zr=!1,autoPanOnConnect:Gl,autoPanOnNodeDrag:Xl,autoPanSpeed:Jl,connectionRadius:ht,isValidConnection:dr,onError:Ws,style:Ht,id:ti,nodeDragThreshold:Ev,viewport:Fk,onViewportChange:vDe,width:bDe,height:wDe,colorMode:xDe="light",debug:_De,...jDe},EDe){const Bk=ti||"1",SDe=$le(xDe);return h.jsx("div",{...jDe,style:{...Ht,...ade},ref:EDe,className:rn(["react-flow",a,SDe]),"data-testid":"rf__wrapper",id:ti,children:h.jsxs(rde,{nodes:e,edges:t,width:bDe,height:wDe,fitView:st,nodeOrigin:We,nodeExtent:io,children:[h.jsx(ede,{onInit:l,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:x,onNodeContextMenu:j,onNodeDoubleClick:E,nodeTypes:o,edgeTypes:i,connectionLineType:$,connectionLineStyle:V,connectionLineComponent:F,connectionLineContainerStyle:W,selectionKeyCode:ee,selectionOnDrag:G,selectionMode:K,deleteKeyCode:re,multiSelectionKeyCode:ne,panActivationKeyCode:X,zoomActivationKeyCode:B,onlyRenderVisibleElements:de,defaultViewport:lt,translateExtent:Qt,minZoom:it,maxZoom:_t,preventScrolling:cr,zoomOnScroll:so,zoomOnPinch:J,zoomOnDoubleClick:Te,panOnScroll:te,panOnScrollSpeed:ce,panOnScrollMode:me,panOnDrag:Xt,onPaneClick:Bt,onPaneMouseEnter:Ge,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Se,onPaneContextMenu:Oe,paneClickDistance:He,nodeClickDistance:kt,onSelectionContextMenu:R,onSelectionStart:L,onSelectionEnd:D,onReconnect:H,onReconnectStart:Y,onReconnectEnd:oe,onEdgeContextMenu:fe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:De,onEdgeMouseMove:ze,onEdgeMouseLeave:ke,reconnectRadius:Ae,defaultMarkerColor:lr,noDragClassName:nt,noWheelClassName:Dt,noPanClassName:zt,rfId:Bk,disableKeyboardA11y:zr,nodeExtent:io,viewport:Fk,onViewportChange:vDe}),h.jsx(Lle,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:f,onConnectStart:m,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:b,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Ee,edgesFocusable:qe,edgesReconnectable:Ke,elementsSelectable:It,elevateNodesOnSelect:co,elevateEdgesOnSelect:hf,minZoom:it,maxZoom:_t,nodeExtent:io,onNodesChange:we,onEdgesChange:Ue,snapToGrid:ue,snapGrid:ae,connectionMode:U,translateExtent:Qt,connectOnClick:en,defaultEdgeOptions:Vi,fitView:st,fitViewOptions:ur,onNodesDelete:M,onEdgesDelete:k,onDelete:A,onNodeDragStart:S,onNodeDrag:O,onNodeDragStop:N,onSelectionDrag:T,onSelectionDragStart:C,onSelectionDragStop:I,onMove:u,onMoveStart:d,onMoveEnd:p,noPanClassName:zt,nodeOrigin:We,rfId:Bk,autoPanOnConnect:Gl,autoPanOnNodeDrag:Xl,autoPanSpeed:Jl,onError:Ws,connectionRadius:ht,isValidConnection:dr,selectNodesOnDrag:je,nodeDragThreshold:Ev,onBeforeDelete:z,paneClickDistance:He,debug:_De}),h.jsx(Tle,{onSelectionChange:P}),Wt,h.jsx(Nle,{proOptions:Aa,position:Vs}),h.jsx(Ole,{rfId:Bk,disableKeyboardA11y:zr})]})})}var ide=K5(ode);const sde=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__viewport-portal")};function cde({children:e}){const t=tt(sde);return t?Ql.createPortal(e,t):null}const lde=e=>e.nodes;function NL(){return tt(lde,Ut)}function wm({type:e,id:t=null,nodeId:n,onConnect:r,onDisconnect:a}){const o=B_(),i=n??o,s=g.useRef(null),c=tt(l=>l.connectionLookup.get(`${i}-${e}-${t}`),Ece);return g.useEffect(()=>{if(s.current&&s.current!==c){const l=c??new Map;L4(s.current,l,a),L4(l,s.current,r)}s.current=c??new Map},[c,r,a]),g.useMemo(()=>Array.from((c==null?void 0:c.values())??[]),[c])}Rn=function(e){return tt(g.useCallback(t=>t.nodeLookup.get(e),[e]),Ut)};function ude({dimensions:e,lineWidth:t,variant:n,className:r}){return h.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:rn(["react-flow__background-pattern",n,r])})}function dde({radius:e,className:t}){return h.jsx("circle",{cx:e,cy:e,r:e,className:rn(["react-flow__background-pattern","dots",t])})}var Lo;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Lo||(Lo={}));const pde={[Lo.Dots]:1,[Lo.Lines]:1,[Lo.Cross]:6},fde=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function kL({id:e,variant:t=Lo.Dots,gap:n=20,size:r,lineWidth:a=1,offset:o=0,color:i,bgColor:s,style:c,className:l,patternClassName:u}){const d=g.useRef(null),{transform:p,patternId:f}=tt(fde,Ut),m=r||pde[t],y=t===Lo.Dots,v=t===Lo.Cross,b=Array.isArray(n)?n:[n,n],w=[b[0]*p[2]||1,b[1]*p[2]||1],_=m*p[2],x=Array.isArray(o)?o:[o,o],j=v?[_,_]:w,E=[x[0]*p[2]||1+j[0]/2,x[1]*p[2]||1+j[1]/2],S=`${f}${e||""}`;return h.jsxs("svg",{className:rn(["react-flow__background",l]),style:{...c,...gm,"--xy-background-color-props":s,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[h.jsx("pattern",{id:S,x:p[0]%w[0],y:p[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:y?h.jsx(dde,{radius:_/2,className:u}):h.jsx(ude,{dimensions:j,lineWidth:a,variant:t,className:u})}),h.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${S})`})]})}kL.displayName="Background";const hde=g.memo(kL);function mde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:h.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function yde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:h.jsx("path",{d:"M0 0h32v4.2H0z"})})}function gde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:h.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function vde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function bde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function xm({children:e,className:t,...n}){return h.jsx("button",{type:"button",className:rn(["react-flow__controls-button",t]),...n,children:e})}const wde=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function ML({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:a,onZoomIn:o,onZoomOut:i,onFitView:s,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:p="vertical","aria-label":f="React Flow controls"}){const m=Lt(),{isInteractive:y,minZoomReached:v,maxZoomReached:b}=tt(wde,Ut),{zoomIn:w,zoomOut:_,fitView:x}=tr(),j=()=>{w(),o==null||o()},E=()=>{_(),i==null||i()},S=()=>{x(a),s==null||s()},O=()=>{m.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),c==null||c(!y)},N=p==="horizontal"?"horizontal":"vertical";return h.jsxs(Mc,{className:rn(["react-flow__controls",N,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":f,children:[t&&h.jsxs(h.Fragment,{children:[h.jsx(xm,{onClick:j,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b,children:h.jsx(mde,{})}),h.jsx(xm,{onClick:E,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:h.jsx(yde,{})})]}),n&&h.jsx(xm,{className:"react-flow__controls-fitview",onClick:S,title:"fit view","aria-label":"fit view",children:h.jsx(gde,{})}),r&&h.jsx(xm,{className:"react-flow__controls-interactive",onClick:O,title:"toggle interactivity","aria-label":"toggle interactivity",children:y?h.jsx(bde,{}):h.jsx(vde,{})}),u]})}ML.displayName="Controls";const xde=g.memo(ML);function _de({id:e,x:t,y:n,width:r,height:a,style:o,color:i,strokeColor:s,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:p,onClick:f}){const{background:m,backgroundColor:y}=o||{},v=i||m||y;return h.jsx("rect",{className:rn(["react-flow__minimap-node",{selected:p},l]),x:t,y:n,rx:u,ry:u,width:r,height:a,style:{fill:v,stroke:s,strokeWidth:c},shapeRendering:d,onClick:f?b=>f(b,e):void 0})}const jde=g.memo(_de),Ede=e=>e.nodes.map(t=>t.id),z_=e=>e instanceof Function?e:()=>e;function Sde({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:a,nodeComponent:o=jde,onClick:i}){const s=tt(Ede,Ut),c=z_(t),l=z_(e),u=z_(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return h.jsx(h.Fragment,{children:s.map(p=>h.jsx(Cde,{id:p,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:a,NodeComponent:o,onClick:i,shapeRendering:d},p))})}function Ode({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:a,nodeStrokeWidth:o,shapeRendering:i,NodeComponent:s,onClick:c}){const{node:l,x:u,y:d,width:p,height:f}=tt(m=>{const y=m.nodeLookup.get(e),{x:v,y:b}=y.internals.positionAbsolute,{width:w,height:_}=Ro(y);return{node:y,x:v,y:b,width:w,height:_}},Ut);return!l||l.hidden||!Z4(l)?null:h.jsx(s,{x:u,y:d,width:p,height:f,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:a,strokeColor:n(l),strokeWidth:o,shapeRendering:i,onClick:c,id:l.id})}const Cde=g.memo(Ode);var Nde=g.memo(Sde);const kde=200,Mde=150,Ade=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?H4(vd(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Pde="react-flow__minimap-desc";function AL({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:a="",nodeBorderRadius:o=5,nodeStrokeWidth:i,nodeComponent:s,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:p="bottom-right",onClick:f,onNodeClick:m,pannable:y=!1,zoomable:v=!1,ariaLabel:b="React Flow mini map",inversePan:w,zoomStep:_=10,offsetScale:x=5}){const j=Lt(),E=g.useRef(null),{boundingRect:S,viewBB:O,rfId:N,panZoom:M,translateExtent:k,flowWidth:A,flowHeight:P}=tt(Ade,Ut),C=(e==null?void 0:e.width)??kde,T=(e==null?void 0:e.height)??Mde,I=S.width/C,R=S.height/T,L=Math.max(I,R),D=L*C,z=L*T,U=x*L,$=S.x-(D-S.width)/2-U,V=S.y-(z-S.height)/2-U,F=D+U*2,W=z+U*2,re=`${Pde}-${N}`,ee=g.useRef(0),G=g.useRef();ee.current=L,g.useEffect(()=>{if(E.current&&M)return G.current=Qce({domNode:E.current,panZoom:M,getTransform:()=>j.getState().transform,getViewScale:()=>ee.current}),()=>{var ne;(ne=G.current)==null||ne.destroy()}},[M]),g.useEffect(()=>{var ne;(ne=G.current)==null||ne.update({translateExtent:k,width:A,height:P,inversePan:w,pannable:y,zoomStep:_,zoomable:v})},[y,v,w,_,k,A,P]);const K=f?ne=>{var ae;const[B,ue]=((ae=G.current)==null?void 0:ae.pointer(ne))||[0,0];f(ne,{x:B,y:ue})}:void 0,X=m?g.useCallback((ne,B)=>{const ue=j.getState().nodeLookup.get(B);m(ne,ue)},[]):void 0;return h.jsx(Mc,{position:p,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*L:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:rn(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:h.jsxs("svg",{width:C,height:T,viewBox:`${$} ${V} ${F} ${W}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":re,ref:E,onClick:K,children:[b&&h.jsx("title",{id:re,children:b}),h.jsx(Nde,{onClick:X,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:o,nodeClassName:a,nodeStrokeWidth:i,nodeComponent:s}),h.jsx("path",{className:"react-flow__minimap-mask",d:`M${$-U},${V-U}h${F+U*2}v${W+U*2}h${-F-U*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}AL.displayName="MiniMap";const Tde=g.memo(AL);function Ide({nodeId:e,position:t,variant:n=kc.Handle,className:r,style:a={},children:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:p,onResizeStart:f,onResize:m,onResizeEnd:y}){const v=B_(),b=typeof e=="string"?e:v,w=Lt(),_=g.useRef(null),x=n===kc.Line?"right":"bottom-right",j=t??x,E=g.useRef(null);g.useEffect(()=>{if(!(!_.current||!b))return E.current||(E.current=yle({domNode:_.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:M,transform:k,snapGrid:A,snapToGrid:P,nodeOrigin:C,domNode:T}=w.getState();return{nodeLookup:M,transform:k,snapGrid:A,snapToGrid:P,nodeOrigin:C,paneDomNode:T}},onChange:(M,k)=>{const{triggerNodeChanges:A,nodeLookup:P,parentLookup:C,nodeOrigin:T}=w.getState(),I=[],R={x:M.x,y:M.y},L=P.get(b);if(L&&L.expandParent&&L.parentId){const D=L.origin??T,z=M.width??L.measured.width,U=M.height??L.measured.height,$={id:L.id,parentId:L.parentId,rect:{width:z,height:U,...G4({x:M.x??L.position.x,y:M.y??L.position.y},{width:z,height:U},L.parentId,P,D)}},V=M_([$],P,C,T);I.push(...V),R.x=M.x?Math.max(D[0]*z,M.x):void 0,R.y=M.y?Math.max(D[1]*U,M.y):void 0}if(R.x!==void 0&&R.y!==void 0){const D={id:b,type:"position",position:{...R}};I.push(D)}if(M.width!==void 0&&M.height!==void 0){const D={id:b,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:M.width,height:M.height}};I.push(D)}for(const D of k){const z={...D,type:"position"};I.push(z)}A(I)},onEnd:()=>{const M={id:b,type:"dimensions",resizing:!1};w.getState().triggerNodeChanges([M])}})),E.current.update({controlPosition:j,boundaries:{minWidth:s,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,onResizeStart:f,onResize:m,onResizeEnd:y,shouldResize:p}),()=>{var M;(M=E.current)==null||M.destroy()}},[j,s,c,l,u,d,f,m,y,p]);const S=j.split("-"),O=n===kc.Line?"borderColor":"backgroundColor",N=i?{...a,[O]:i}:a;return h.jsx("div",{className:rn(["react-flow__resize-control","nodrag",...S,n,r]),ref:_,style:N,children:o})}const PL=g.memo(Ide);function Rde({nodeId:e,isVisible:t=!0,handleClassName:n,handleStyle:r,lineClassName:a,lineStyle:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:p,onResizeStart:f,onResize:m,onResizeEnd:y}){return t?h.jsxs(h.Fragment,{children:[lle.map(v=>h.jsx(PL,{className:a,style:o,nodeId:e,position:v,variant:kc.Line,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:f,keepAspectRatio:d,shouldResize:p,onResize:m,onResizeEnd:y},v)),cle.map(v=>h.jsx(PL,{className:n,style:r,nodeId:e,position:v,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:f,keepAspectRatio:d,shouldResize:p,onResize:m,onResizeEnd:y},v))]}):null}var U_,TL;function Dde(){if(TL)return U_;TL=1;var e=function(b){return t(b)&&!n(b)};function t(b){return!!b&&typeof b=="object"}function n(b){var w=Object.prototype.toString.call(b);return w==="[object RegExp]"||w==="[object Date]"||o(b)}var r=typeof Symbol=="function"&&Symbol.for,a=r?Symbol.for("react.element"):60103;function o(b){return b.$$typeof===a}function i(b){return Array.isArray(b)?[]:{}}function s(b,w){return w.clone!==!1&&w.isMergeableObject(b)?y(i(b),b,w):b}function c(b,w,_){return b.concat(w).map(function(x){return s(x,_)})}function l(b,w){if(!w.customMerge)return y;var _=w.customMerge(b);return typeof _=="function"?_:y}function u(b){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(b).filter(function(w){return Object.propertyIsEnumerable.call(b,w)}):[]}function d(b){return Object.keys(b).concat(u(b))}function p(b,w){try{return w in b}catch{return!1}}function f(b,w){return p(b,w)&&!(Object.hasOwnProperty.call(b,w)&&Object.propertyIsEnumerable.call(b,w))}function m(b,w,_){var x={};return _.isMergeableObject(b)&&d(b).forEach(function(j){x[j]=s(b[j],_)}),d(w).forEach(function(j){f(b,j)||(p(b,j)&&_.isMergeableObject(w[j])?x[j]=l(j,_)(b[j],w[j],_):x[j]=s(w[j],_))}),x}function y(b,w,_){_=_||{},_.arrayMerge=_.arrayMerge||c,_.isMergeableObject=_.isMergeableObject||e,_.cloneUnlessOtherwiseSpecified=s;var x=Array.isArray(w),j=Array.isArray(b),E=x===j;return E?x?_.arrayMerge(b,w,_):m(b,w,_):s(w,_)}y.all=function(b,w){if(!Array.isArray(b))throw new Error("first argument should be an array");return b.reduce(function(_,x){return y(_,x,w)},{})};var v=y;return U_=v,U_}var Lde=Dde();const _m=ct(Lde);var IL={},RL;function $de(){if(RL)return IL;RL=1;var e;return function(t){(function(n){var r=typeof globalThis=="object"?globalThis:typeof tu=="object"?tu:typeof self=="object"?self:typeof this=="object"?this:c(),a=o(t);typeof r.Reflect<"u"&&(a=o(r.Reflect,a)),n(a,r),typeof r.Reflect>"u"&&(r.Reflect=t);function o(l,u){return function(d,p){Object.defineProperty(l,d,{configurable:!0,writable:!0,value:p}),u&&u(d,p)}}function i(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function c(){return i()||s()}})(function(n,r){var a=Object.prototype.hasOwnProperty,o=typeof Symbol=="function",i=o&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=o&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,u=!c&&!l,d={create:c?function(){return so(Object.create(null))}:l?function(){return so({__proto__:null})}:function(){return so({})},has:u?function(J,te){return a.call(J,te)}:function(J,te){return te in J},get:u?function(J,te){return a.call(J,te)?J[te]:void 0}:function(J,te){return J[te]}},p=Object.getPrototypeOf(Function),f=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:cr(),m=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:io(),y=typeof WeakMap=="function"?WeakMap:lr(),v=o?Symbol.for("@reflect-metadata:registry"):void 0,b=lt(),w=it(b);function _(J,te,ce,me){if(V(ce)){if(!B(J))throw new TypeError;if(!ae(te))throw new TypeError;return P(J,te)}else{if(!B(J))throw new TypeError;if(!re(te))throw new TypeError;if(!re(me)&&!V(me)&&!F(me))throw new TypeError;return F(me)&&(me=void 0),ce=ne(ce),C(J,te,ce,me)}}n("decorate",_);function x(J,te){function ce(me,Te){if(!re(me))throw new TypeError;if(!V(Te)&&!de(Te))throw new TypeError;D(J,te,me,Te)}return ce}n("metadata",x);function j(J,te,ce,me){if(!re(ce))throw new TypeError;return V(me)||(me=ne(me)),D(J,te,ce,me)}n("defineMetadata",j);function E(J,te,ce){if(!re(te))throw new TypeError;return V(ce)||(ce=ne(ce)),T(J,te,ce)}n("hasMetadata",E);function S(J,te,ce){if(!re(te))throw new TypeError;return V(ce)||(ce=ne(ce)),I(J,te,ce)}n("hasOwnMetadata",S);function O(J,te,ce){if(!re(te))throw new TypeError;return V(ce)||(ce=ne(ce)),R(J,te,ce)}n("getMetadata",O);function N(J,te,ce){if(!re(te))throw new TypeError;return V(ce)||(ce=ne(ce)),L(J,te,ce)}n("getOwnMetadata",N);function M(J,te){if(!re(J))throw new TypeError;return V(te)||(te=ne(te)),z(J,te)}n("getMetadataKeys",M);function k(J,te){if(!re(J))throw new TypeError;return V(te)||(te=ne(te)),U(J,te)}n("getOwnMetadataKeys",k);function A(J,te,ce){if(!re(te))throw new TypeError;if(V(ce)||(ce=ne(ce)),!re(te))throw new TypeError;V(ce)||(ce=ne(ce));var me=Qt(te,ce,!1);return V(me)?!1:me.OrdinaryDeleteMetadata(J,te,ce)}n("deleteMetadata",A);function P(J,te){for(var ce=J.length-1;ce>=0;--ce){var me=J[ce],Te=me(te);if(!V(Te)&&!F(Te)){if(!ae(Te))throw new TypeError;te=Te}}return te}function C(J,te,ce,me){for(var Te=J.length-1;Te>=0;--Te){var Xt=J[Te],Bt=Xt(te,ce,me);if(!V(Bt)&&!F(Bt)){if(!re(Bt))throw new TypeError;me=Bt}}return me}function T(J,te,ce){var me=I(J,te,ce);if(me)return!0;var Te=Ke(te);return F(Te)?!1:T(J,Te,ce)}function I(J,te,ce){var me=Qt(te,ce,!1);return V(me)?!1:K(me.OrdinaryHasOwnMetadata(J,te,ce))}function R(J,te,ce){var me=I(J,te,ce);if(me)return L(J,te,ce);var Te=Ke(te);if(!F(Te))return R(J,Te,ce)}function L(J,te,ce){var me=Qt(te,ce,!1);if(!V(me))return me.OrdinaryGetOwnMetadata(J,te,ce)}function D(J,te,ce,me){var Te=Qt(ce,me,!0);Te.OrdinaryDefineOwnMetadata(J,te,ce,me)}function z(J,te){var ce=U(J,te),me=Ke(J);if(me===null)return ce;var Te=z(me,te);if(Te.length<=0)return ce;if(ce.length<=0)return Te;for(var Xt=new m,Bt=[],Ge=0,be=ce;Ge<be.length;Ge++){var _e=be[Ge],Se=Xt.has(_e);Se||(Xt.add(_e),Bt.push(_e))}for(var Oe=0,He=Te;Oe<He.length;Oe++){var _e=He[Oe],Se=Xt.has(_e);Se||(Xt.add(_e),Bt.push(_e))}return Bt}function U(J,te){var ce=Qt(J,te,!1);return ce?ce.OrdinaryOwnMetadataKeys(J,te):[]}function $(J){if(J===null)return 1;switch(typeof J){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return J===null?1:6;default:return 6}}function V(J){return J===void 0}function F(J){return J===null}function W(J){return typeof J=="symbol"}function re(J){return typeof J=="object"?J!==null:typeof J=="function"}function ee(J,te){switch($(J)){case 0:return J;case 1:return J;case 2:return J;case 3:return J;case 4:return J;case 5:return J}var ce="string",me=Le(J,i);if(me!==void 0){var Te=me.call(J,ce);if(re(Te))throw new TypeError;return Te}return G(J)}function G(J,te){var ce,me;{var Te=J.toString;if(ue(Te)){var me=Te.call(J);if(!re(me))return me}var ce=J.valueOf;if(ue(ce)){var me=ce.call(J);if(!re(me))return me}}throw new TypeError}function K(J){return!!J}function X(J){return""+J}function ne(J){var te=ee(J);return W(te)?te:X(te)}function B(J){return Array.isArray?Array.isArray(J):J instanceof Object?J instanceof Array:Object.prototype.toString.call(J)==="[object Array]"}function ue(J){return typeof J=="function"}function ae(J){return typeof J=="function"}function de(J){switch($(J)){case 3:return!0;case 4:return!0;default:return!1}}function je(J,te){return J===te||J!==J&&te!==te}function Le(J,te){var ce=J[te];if(ce!=null){if(!ue(ce))throw new TypeError;return ce}}function $e(J){var te=Le(J,s);if(!ue(te))throw new TypeError;var ce=te.call(J);if(!re(ce))throw new TypeError;return ce}function Ee(J){return J.value}function We(J){var te=J.next();return te.done?!1:te}function qe(J){var te=J.return;te&&te.call(J)}function Ke(J){var te=Object.getPrototypeOf(J);if(typeof J!="function"||J===p||te!==p)return te;var ce=J.prototype,me=ce&&Object.getPrototypeOf(ce);if(me==null||me===Object.prototype)return te;var Te=me.constructor;return typeof Te!="function"||Te===J?te:Te}function It(){var J;!V(v)&&typeof r.Reflect<"u"&&!(v in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(J=_t(r.Reflect));var te,ce,me,Te=new y,Xt={registerProvider:Bt,getProvider:be,setProvider:Se};return Xt;function Bt(Oe){if(!Object.isExtensible(Xt))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case J===Oe:break;case V(te):te=Oe;break;case te===Oe:break;case V(ce):ce=Oe;break;case ce===Oe:break;default:me===void 0&&(me=new m),me.add(Oe);break}}function Ge(Oe,He){if(!V(te)){if(te.isProviderFor(Oe,He))return te;if(!V(ce)){if(ce.isProviderFor(Oe,He))return te;if(!V(me))for(var kt=$e(me);;){var Wt=We(kt);if(!Wt)return;var H=Ee(Wt);if(H.isProviderFor(Oe,He))return qe(kt),H}}}if(!V(J)&&J.isProviderFor(Oe,He))return J}function be(Oe,He){var kt=Te.get(Oe),Wt;return V(kt)||(Wt=kt.get(He)),V(Wt)&&(Wt=Ge(Oe,He),V(Wt)||(V(kt)&&(kt=new f,Te.set(Oe,kt)),kt.set(He,Wt))),Wt}function _e(Oe){if(V(Oe))throw new TypeError;return te===Oe||ce===Oe||!V(me)&&me.has(Oe)}function Se(Oe,He,kt){if(!_e(kt))throw new Error("Metadata provider not registered.");var Wt=be(Oe,He);if(Wt!==kt){if(!V(Wt))return!1;var H=Te.get(Oe);V(H)&&(H=new f,Te.set(Oe,H)),H.set(He,kt)}return!0}}function lt(){var J;return!V(v)&&re(r.Reflect)&&Object.isExtensible(r.Reflect)&&(J=r.Reflect[v]),V(J)&&(J=It()),!V(v)&&re(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,v,{enumerable:!1,configurable:!1,writable:!1,value:J}),J}function it(J){var te=new y,ce={isProviderFor:function(_e,Se){var Oe=te.get(_e);return V(Oe)?!1:Oe.has(Se)},OrdinaryDefineOwnMetadata:Bt,OrdinaryHasOwnMetadata:Te,OrdinaryGetOwnMetadata:Xt,OrdinaryOwnMetadataKeys:Ge,OrdinaryDeleteMetadata:be};return b.registerProvider(ce),ce;function me(_e,Se,Oe){var He=te.get(_e),kt=!1;if(V(He)){if(!Oe)return;He=new f,te.set(_e,He),kt=!0}var Wt=He.get(Se);if(V(Wt)){if(!Oe)return;if(Wt=new f,He.set(Se,Wt),!J.setProvider(_e,Se,ce))throw He.delete(Se),kt&&te.delete(_e),new Error("Wrong provider for target.")}return Wt}function Te(_e,Se,Oe){var He=me(Se,Oe,!1);return V(He)?!1:K(He.has(_e))}function Xt(_e,Se,Oe){var He=me(Se,Oe,!1);if(!V(He))return He.get(_e)}function Bt(_e,Se,Oe,He){var kt=me(Oe,He,!0);kt.set(_e,Se)}function Ge(_e,Se){var Oe=[],He=me(_e,Se,!1);if(V(He))return Oe;for(var kt=He.keys(),Wt=$e(kt),H=0;;){var Y=We(Wt);if(!Y)return Oe.length=H,Oe;var oe=Ee(Y);try{Oe[H]=oe}catch(fe){try{qe(Wt)}finally{throw fe}}H++}}function be(_e,Se,Oe){var He=me(Se,Oe,!1);if(V(He)||!He.delete(_e))return!1;if(He.size===0){var kt=te.get(Se);V(kt)||(kt.delete(Oe),kt.size===0&&te.delete(kt))}return!0}}function _t(J){var te=J.defineMetadata,ce=J.hasOwnMetadata,me=J.getOwnMetadata,Te=J.getOwnMetadataKeys,Xt=J.deleteMetadata,Bt=new y,Ge={isProviderFor:function(be,_e){var Se=Bt.get(be);return!V(Se)&&Se.has(_e)?!0:Te(be,_e).length?(V(Se)&&(Se=new m,Bt.set(be,Se)),Se.add(_e),!0):!1},OrdinaryDefineOwnMetadata:te,OrdinaryHasOwnMetadata:ce,OrdinaryGetOwnMetadata:me,OrdinaryOwnMetadataKeys:Te,OrdinaryDeleteMetadata:Xt};return Ge}function Qt(J,te,ce){var me=b.getProvider(J,te);if(!V(me))return me;if(ce){if(b.setProvider(J,te,w))return w;throw new Error("Illegal state.")}}function cr(){var J={},te=[],ce=function(){function Ge(be,_e,Se){this._index=0,this._keys=be,this._values=_e,this._selector=Se}return Ge.prototype["@@iterator"]=function(){return this},Ge.prototype[s]=function(){return this},Ge.prototype.next=function(){var be=this._index;if(be>=0&&be<this._keys.length){var _e=this._selector(this._keys[be],this._values[be]);return be+1>=this._keys.length?(this._index=-1,this._keys=te,this._values=te):this._index++,{value:_e,done:!1}}return{value:void 0,done:!0}},Ge.prototype.throw=function(be){throw this._index>=0&&(this._index=-1,this._keys=te,this._values=te),be},Ge.prototype.return=function(be){return this._index>=0&&(this._index=-1,this._keys=te,this._values=te),{value:be,done:!0}},Ge}(),me=function(){function Ge(){this._keys=[],this._values=[],this._cacheKey=J,this._cacheIndex=-2}return Object.defineProperty(Ge.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Ge.prototype.has=function(be){return this._find(be,!1)>=0},Ge.prototype.get=function(be){var _e=this._find(be,!1);return _e>=0?this._values[_e]:void 0},Ge.prototype.set=function(be,_e){var Se=this._find(be,!0);return this._values[Se]=_e,this},Ge.prototype.delete=function(be){var _e=this._find(be,!1);if(_e>=0){for(var Se=this._keys.length,Oe=_e+1;Oe<Se;Oe++)this._keys[Oe-1]=this._keys[Oe],this._values[Oe-1]=this._values[Oe];return this._keys.length--,this._values.length--,je(be,this._cacheKey)&&(this._cacheKey=J,this._cacheIndex=-2),!0}return!1},Ge.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=J,this._cacheIndex=-2},Ge.prototype.keys=function(){return new ce(this._keys,this._values,Te)},Ge.prototype.values=function(){return new ce(this._keys,this._values,Xt)},Ge.prototype.entries=function(){return new ce(this._keys,this._values,Bt)},Ge.prototype["@@iterator"]=function(){return this.entries()},Ge.prototype[s]=function(){return this.entries()},Ge.prototype._find=function(be,_e){if(!je(this._cacheKey,be)){this._cacheIndex=-1;for(var Se=0;Se<this._keys.length;Se++)if(je(this._keys[Se],be)){this._cacheIndex=Se;break}}return this._cacheIndex<0&&_e&&(this._cacheIndex=this._keys.length,this._keys.push(be),this._values.push(void 0)),this._cacheIndex},Ge}();return me;function Te(Ge,be){return Ge}function Xt(Ge,be){return be}function Bt(Ge,be){return[Ge,be]}}function io(){var J=function(){function te(){this._map=new f}return Object.defineProperty(te.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),te.prototype.has=function(ce){return this._map.has(ce)},te.prototype.add=function(ce){return this._map.set(ce,ce),this},te.prototype.delete=function(ce){return this._map.delete(ce)},te.prototype.clear=function(){this._map.clear()},te.prototype.keys=function(){return this._map.keys()},te.prototype.values=function(){return this._map.keys()},te.prototype.entries=function(){return this._map.entries()},te.prototype["@@iterator"]=function(){return this.keys()},te.prototype[s]=function(){return this.keys()},te}();return J}function lr(){var J=16,te=d.create(),ce=me();return function(){function be(){this._key=me()}return be.prototype.has=function(_e){var Se=Te(_e,!1);return Se!==void 0?d.has(Se,this._key):!1},be.prototype.get=function(_e){var Se=Te(_e,!1);return Se!==void 0?d.get(Se,this._key):void 0},be.prototype.set=function(_e,Se){var Oe=Te(_e,!0);return Oe[this._key]=Se,this},be.prototype.delete=function(_e){var Se=Te(_e,!1);return Se!==void 0?delete Se[this._key]:!1},be.prototype.clear=function(){this._key=me()},be}();function me(){var be;do be="@@WeakMap@@"+Ge();while(d.has(te,be));return te[be]=!0,be}function Te(be,_e){if(!a.call(be,ce)){if(!_e)return;Object.defineProperty(be,ce,{value:d.create()})}return be[ce]}function Xt(be,_e){for(var Se=0;Se<_e;++Se)be[Se]=Math.random()*255|0;return be}function Bt(be){if(typeof Uint8Array=="function"){var _e=new Uint8Array(be);return typeof crypto<"u"?crypto.getRandomValues(_e):typeof msCrypto<"u"?msCrypto.getRandomValues(_e):Xt(_e,be),_e}return Xt(new Array(be),be)}function Ge(){var be=Bt(J);be[6]=be[6]&79|64,be[8]=be[8]&191|128;for(var _e="",Se=0;Se<J;++Se){var Oe=be[Se];(Se===4||Se===6||Se===8)&&(_e+="-"),Oe<16&&(_e+="0"),_e+=Oe.toString(16).toLowerCase()}return _e}}function so(J){return J.__=void 0,delete J.__,J}})}(e||(e={})),IL}$de(),typeof window<"u"&&(window.Buffer=$De),typeof Rv<"u"&&typeof require<"u"&&(Rv.Buffer=require("buffer/").Buffer);class an{static isObject(t){return t!==null&&typeof t=="object"}static isObjectWithName(t){return t!==null&&typeof t=="object"&&t.name!==void 0}static assign(t,...n){for(const r of n)for(const a of Object.getOwnPropertyNames(r))t[a]=r[a]}static mixedListToArray(t){return t!==null&&typeof t=="object"?Object.keys(t).map(n=>t[n]):t}}class xe extends Error{get name(){return this.constructor.name}constructor(t){super(t),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class Pc extends xe{constructor(){super("Locking not supported on given driver.")}}class V_ extends xe{constructor(){super('Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')}}class Pt{static isMssqlParameter(t){return this.check(t,"MssqlParameter")}static isEntityMetadata(t){return this.check(t,"EntityMetadata")}static isColumnMetadata(t){return this.check(t,"ColumnMetadata")}static isSelectQueryBuilder(t){return this.check(t,"SelectQueryBuilder")}static isInsertQueryBuilder(t){return this.check(t,"InsertQueryBuilder")}static isDeleteQueryBuilder(t){return this.check(t,"DeleteQueryBuilder")}static isUpdateQueryBuilder(t){return this.check(t,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(t){return this.check(t,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(t){return this.check(t,"RelationQueryBuilder")}static isBrackets(t){return this.check(t,"Brackets")||this.check(t,"NotBrackets")}static isNotBrackets(t){return this.check(t,"NotBrackets")}static isSubject(t){return this.check(t,"Subject")}static isRdbmsSchemaBuilder(t){return this.check(t,"RdbmsSchemaBuilder")}static isMongoEntityManager(t){return this.check(t,"MongoEntityManager")}static isSqljsEntityManager(t){return this.check(t,"SqljsEntityManager")}static isEntitySchema(t){return this.check(t,"EntitySchema")}static isBaseEntityConstructor(t){return typeof t=="function"&&typeof t.hasId=="function"&&typeof t.save=="function"&&typeof t.useDataSource=="function"}static isFindOperator(t){return this.check(t,"FindOperator")||this.check(t,"EqualOperator")}static isEqualOperator(t){return this.check(t,"EqualOperator")}static isQuery(t){return this.check(t,"Query")}static isTable(t){return this.check(t,"Table")}static isTableCheck(t){return this.check(t,"TableCheck")}static isTableColumn(t){return this.check(t,"TableColumn")}static isTableExclusion(t){return this.check(t,"TableExclusion")}static isTableForeignKey(t){return this.check(t,"TableForeignKey")}static isTableIndex(t){return this.check(t,"TableIndex")}static isTableUnique(t){return this.check(t,"TableUnique")}static isView(t){return this.check(t,"View")}static isDataSource(t){return this.check(t,"DataSource")}static check(t,n){return typeof t=="object"&&t!==null&&t["@instanceof"]===Symbol.for(n)}}class Fde extends xe{constructor(t,n){super(),this.entityClass=t,this.criteria=n,this.message=`Could not find any entity of type "${this.stringifyTarget(t)}" matching: ${this.stringifyCriteria(n)}`}stringifyTarget(t){return Pt.isEntitySchema(t)?t.options.name:typeof t=="function"||an.isObject(t)&&"name"in t?t.name:t}stringifyCriteria(t){try{return JSON.stringify(t,null,4)}catch{}return""+t}}class DL extends xe{constructor(t,n,r){super(`The optimistic lock on entity ${t} failed, version ${n} was expected, but is actually ${r}.`)}}class LL extends xe{constructor(){super("Your database does not support LIMIT on UPDATE statements.")}}class Bde extends xe{constructor(t){super(`Entity "${t.name}" does not have delete date columns.`)}}class jm extends xe{constructor(){super("OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL or MariaDB databases.")}}class Ha extends xe{constructor(t,n){super(t),Object.setPrototypeOf(this,Ha.prototype),this.message=`Property "${t}" was not found in "${n.targetName}". Make sure your query is correct.`}}class zde extends xe{constructor(t){super(`Entity ${t} does not have version or update date columns.`)}}class Ude extends xe{constructor(){super('Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')}}class Od extends xe{constructor(){super("The optimistic lock can be used only with getOne() method.")}}class Vde extends xe{constructor(t){super(),t.length===1?this.message=`Relation "${t[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${t.map(n=>`"${n}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class Wde extends xe{constructor(){super("An open transaction is required for pessimistic lock.")}}class Hde extends xe{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class $L{constructor(t){an.assign(this,t||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(t){this._metadata=t}get metadata(){if(!this._metadata)throw new xe(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class qa{static isAliasProperty(t){if(typeof t!="string"||t.indexOf(".")===-1)return!1;const[n,r]=t.split(".");return!(!n||!r||t.indexOf("(")!==-1||t.indexOf(")")!==-1)}}var W_={exports:{}},H_={exports:{}},FL;function Tc(){return FL||(FL=1,typeof Object.create=="function"?H_.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:H_.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),H_.exports}var q_={exports:{}},BL;function hs(){return BL||(BL=1,function(e,t){var n=FDe(),r=n.Buffer;function a(i,s){for(var c in i)s[c]=i[c]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o);function o(i,s,c){return r(i,s,c)}o.prototype=Object.create(r.prototype),a(r,o),o.from=function(i,s,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return r(i,s,c)},o.alloc=function(i,s,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var l=r(i);return s!==void 0?typeof c=="string"?l.fill(s,c):l.fill(s):l.fill(0),l},o.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r(i)},o.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(i)}}(q_,q_.exports)),q_.exports}var K_,zL;function Ic(){if(zL)return K_;zL=1;var e=hs().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var a=this._block,o=this._blockSize,i=n.length,s=this._len,c=0;c<i;){for(var l=s%o,u=Math.min(i-c,o-l),d=0;d<u;d++)a[l+d]=n[c+d];s+=u,c+=u,s%o===0&&this._update(a)}return this._len+=i,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var o=(a&4294967295)>>>0,i=(a-o)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(o,this._blockSize-4)}this._update(this._block);var s=this._hash();return n?s.toString(n):s},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},K_=t,K_}var Z_,UL;function qde(){if(UL)return Z_;UL=1;var e=Tc(),t=Ic(),n=hs().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(l){return l<<5|l>>>27}function s(l){return l<<30|l>>>2}function c(l,u,d,p){return l===0?u&d|~u&p:l===2?u&d|u&p|d&p:u^d^p}return o.prototype._update=function(l){for(var u=this._w,d=this._a|0,p=this._b|0,f=this._c|0,m=this._d|0,y=this._e|0,v=0;v<16;++v)u[v]=l.readInt32BE(v*4);for(;v<80;++v)u[v]=u[v-3]^u[v-8]^u[v-14]^u[v-16];for(var b=0;b<80;++b){var w=~~(b/20),_=i(d)+c(w,p,f,m)+y+u[b]+r[w]|0;y=m,m=f,f=s(p),p=d,d=_}this._a=d+this._a|0,this._b=p+this._b|0,this._c=f+this._c|0,this._d=m+this._d|0,this._e=y+this._e|0},o.prototype._hash=function(){var l=n.allocUnsafe(20);return l.writeInt32BE(this._a|0,0),l.writeInt32BE(this._b|0,4),l.writeInt32BE(this._c|0,8),l.writeInt32BE(this._d|0,12),l.writeInt32BE(this._e|0,16),l},Z_=o,Z_}var G_,VL;function Kde(){if(VL)return G_;VL=1;var e=Tc(),t=Ic(),n=hs().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(u){return u<<1|u>>>31}function s(u){return u<<5|u>>>27}function c(u){return u<<30|u>>>2}function l(u,d,p,f){return u===0?d&p|~d&f:u===2?d&p|d&f|p&f:d^p^f}return o.prototype._update=function(u){for(var d=this._w,p=this._a|0,f=this._b|0,m=this._c|0,y=this._d|0,v=this._e|0,b=0;b<16;++b)d[b]=u.readInt32BE(b*4);for(;b<80;++b)d[b]=i(d[b-3]^d[b-8]^d[b-14]^d[b-16]);for(var w=0;w<80;++w){var _=~~(w/20),x=s(p)+l(_,f,m,y)+v+d[w]+r[_]|0;v=y,y=m,m=c(f),f=p,p=x}this._a=p+this._a|0,this._b=f+this._b|0,this._c=m+this._c|0,this._d=y+this._d|0,this._e=v+this._e|0},o.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},G_=o,G_}var X_,WL;function HL(){if(WL)return X_;WL=1;var e=Tc(),t=Ic(),n=hs().Buffer,r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function i(p,f,m){return m^p&(f^m)}function s(p,f,m){return p&f|m&(p|f)}function c(p){return(p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10)}function l(p){return(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7)}function u(p){return(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3}function d(p){return(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10}return o.prototype._update=function(p){for(var f=this._w,m=this._a|0,y=this._b|0,v=this._c|0,b=this._d|0,w=this._e|0,_=this._f|0,x=this._g|0,j=this._h|0,E=0;E<16;++E)f[E]=p.readInt32BE(E*4);for(;E<64;++E)f[E]=d(f[E-2])+f[E-7]+u(f[E-15])+f[E-16]|0;for(var S=0;S<64;++S){var O=j+l(w)+i(w,_,x)+r[S]+f[S]|0,N=c(m)+s(m,y,v)|0;j=x,x=_,_=w,w=b+O|0,b=v,v=y,y=m,m=O+N|0}this._a=m+this._a|0,this._b=y+this._b|0,this._c=v+this._c|0,this._d=b+this._d|0,this._e=w+this._e|0,this._f=_+this._f|0,this._g=x+this._g|0,this._h=j+this._h|0},o.prototype._hash=function(){var p=n.allocUnsafe(32);return p.writeInt32BE(this._a,0),p.writeInt32BE(this._b,4),p.writeInt32BE(this._c,8),p.writeInt32BE(this._d,12),p.writeInt32BE(this._e,16),p.writeInt32BE(this._f,20),p.writeInt32BE(this._g,24),p.writeInt32BE(this._h,28),p},X_=o,X_}var J_,qL;function Zde(){if(qL)return J_;qL=1;var e=Tc(),t=HL(),n=Ic(),r=hs().Buffer,a=new Array(64);function o(){this.init(),this._w=a,n.call(this,64,56)}return e(o,t),o.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(28);return i.writeInt32BE(this._a,0),i.writeInt32BE(this._b,4),i.writeInt32BE(this._c,8),i.writeInt32BE(this._d,12),i.writeInt32BE(this._e,16),i.writeInt32BE(this._f,20),i.writeInt32BE(this._g,24),i},J_=o,J_}var Y_,KL;function ZL(){if(KL)return Y_;KL=1;var e=Tc(),t=Ic(),n=hs().Buffer,r=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function o(){this.init(),this._w=a,t.call(this,128,112)}e(o,t),o.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function i(y,v,b){return b^y&(v^b)}function s(y,v,b){return y&v|b&(y|v)}function c(y,v){return(y>>>28|v<<4)^(v>>>2|y<<30)^(v>>>7|y<<25)}function l(y,v){return(y>>>14|v<<18)^(y>>>18|v<<14)^(v>>>9|y<<23)}function u(y,v){return(y>>>1|v<<31)^(y>>>8|v<<24)^y>>>7}function d(y,v){return(y>>>1|v<<31)^(y>>>8|v<<24)^(y>>>7|v<<25)}function p(y,v){return(y>>>19|v<<13)^(v>>>29|y<<3)^y>>>6}function f(y,v){return(y>>>19|v<<13)^(v>>>29|y<<3)^(y>>>6|v<<26)}function m(y,v){return y>>>0<v>>>0?1:0}return o.prototype._update=function(y){for(var v=this._w,b=this._ah|0,w=this._bh|0,_=this._ch|0,x=this._dh|0,j=this._eh|0,E=this._fh|0,S=this._gh|0,O=this._hh|0,N=this._al|0,M=this._bl|0,k=this._cl|0,A=this._dl|0,P=this._el|0,C=this._fl|0,T=this._gl|0,I=this._hl|0,R=0;R<32;R+=2)v[R]=y.readInt32BE(R*4),v[R+1]=y.readInt32BE(R*4+4);for(;R<160;R+=2){var L=v[R-30],D=v[R-15*2+1],z=u(L,D),U=d(D,L);L=v[R-2*2],D=v[R-2*2+1];var $=p(L,D),V=f(D,L),F=v[R-7*2],W=v[R-7*2+1],re=v[R-16*2],ee=v[R-16*2+1],G=U+W|0,K=z+F+m(G,U)|0;G=G+V|0,K=K+$+m(G,V)|0,G=G+ee|0,K=K+re+m(G,ee)|0,v[R]=K,v[R+1]=G}for(var X=0;X<160;X+=2){K=v[X],G=v[X+1];var ne=s(b,w,_),B=s(N,M,k),ue=c(b,N),ae=c(N,b),de=l(j,P),je=l(P,j),Le=r[X],$e=r[X+1],Ee=i(j,E,S),We=i(P,C,T),qe=I+je|0,Ke=O+de+m(qe,I)|0;qe=qe+We|0,Ke=Ke+Ee+m(qe,We)|0,qe=qe+$e|0,Ke=Ke+Le+m(qe,$e)|0,qe=qe+G|0,Ke=Ke+K+m(qe,G)|0;var It=ae+B|0,lt=ue+ne+m(It,ae)|0;O=S,I=T,S=E,T=C,E=j,C=P,P=A+qe|0,j=x+Ke+m(P,A)|0,x=_,A=k,_=w,k=M,w=b,M=N,N=qe+It|0,b=Ke+lt+m(N,qe)|0}this._al=this._al+N|0,this._bl=this._bl+M|0,this._cl=this._cl+k|0,this._dl=this._dl+A|0,this._el=this._el+P|0,this._fl=this._fl+C|0,this._gl=this._gl+T|0,this._hl=this._hl+I|0,this._ah=this._ah+b+m(this._al,N)|0,this._bh=this._bh+w+m(this._bl,M)|0,this._ch=this._ch+_+m(this._cl,k)|0,this._dh=this._dh+x+m(this._dl,A)|0,this._eh=this._eh+j+m(this._el,P)|0,this._fh=this._fh+E+m(this._fl,C)|0,this._gh=this._gh+S+m(this._gl,T)|0,this._hh=this._hh+O+m(this._hl,I)|0},o.prototype._hash=function(){var y=n.allocUnsafe(64);function v(b,w,_){y.writeInt32BE(b,_),y.writeInt32BE(w,_+4)}return v(this._ah,this._al,0),v(this._bh,this._bl,8),v(this._ch,this._cl,16),v(this._dh,this._dl,24),v(this._eh,this._el,32),v(this._fh,this._fl,40),v(this._gh,this._gl,48),v(this._hh,this._hl,56),y},Y_=o,Y_}var Q_,GL;function Gde(){if(GL)return Q_;GL=1;var e=Tc(),t=ZL(),n=Ic(),r=hs().Buffer,a=new Array(160);function o(){this.init(),this._w=a,n.call(this,128,112)}return e(o,t),o.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(48);function s(c,l,u){i.writeInt32BE(c,u),i.writeInt32BE(l,u+4)}return s(this._ah,this._al,0),s(this._bh,this._bl,8),s(this._ch,this._cl,16),s(this._dh,this._dl,24),s(this._eh,this._el,32),s(this._fh,this._fl,40),i},Q_=o,Q_}var XL;function Xde(){if(XL)return W_.exports;XL=1;var e=W_.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n};return e.sha=qde(),e.sha1=Kde(),e.sha224=Zde(),e.sha256=HL(),e.sha384=Gde(),e.sha512=ZL(),W_.exports}var Jde=Xde();const Yde=ct(Jde);function Qde(e,t={}){const{segmentLength:n=4,separator:r="__",termLength:a=2}=t;return e.split(r).reduce((o,i)=>{const s=i.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),c=s.length>1?a:n,l=s.map(u=>u.substr(0,c)).join("");return o.push(l),o},[]).join(r)}function epe(e,t={}){const n=Yde("sha1");n.update(e,"utf8");const r=n.digest("hex");return t.length?r.slice(0,t.length):r}class tpe{static isGreaterOrEqual(t,n){const r=JL(t),a=JL(n);return r[0]>a[0]||r[0]===a[0]&&r[1]>a[1]||r[0]===a[0]&&r[1]===a[1]&&r[2]>=a[2]}}function JL(e=""){const t=[0,0,0];return e.split(".").forEach((n,r)=>t[r]=parseInt(n,10)),t}class ve{static isSQLiteFamily(t){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(t.options.type)}static isMySQLFamily(t){return["mysql","mariadb"].includes(t.options.type)}static isReleaseVersionOrGreater(t,n){return t.version!=null&&tpe.isGreaterOrEqual(t.version,n)}static isPostgresFamily(t){return["postgres","aurora-postgres","cockroachdb"].includes(t.options.type)}static buildDriverOptions(t,n){if(t.url){const r=this.parseConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildMongoDBDriverOptions(t,n){if(t.url){const r=this.parseMongoDBConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildAlias({maxAliasLength:t},n,...r){const a=n&&n.joiner?n.joiner:"_";let o=r.length===1?r[0]:r.join(a);if(t&&t>0&&o.length>t){if(n&&n.shorten===!0){const i=Qde(o);if(i.length<t)return i}return epe(o,{length:t})}return o}static buildColumnAlias({maxAliasLength:t},n,...r){return typeof n=="string"?(r.unshift(n),n={shorten:!1,joiner:"_"}):n=Object.assign({shorten:!1,joiner:"_"},n),this.buildAlias({maxAliasLength:t},n,...r)}static parseConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0;s&&s.indexOf("?")!==-1&&(s=s.substr(0,s.indexOf("?")));const c=i.lastIndexOf("@"),l=i.substr(0,c),u=i.substr(c+1);let d=l,p="";const f=l.indexOf(":");f!==-1&&(d=l.substr(0,f),p=l.substr(f+1));const[m,y]=u.split(":");return{type:n,host:m,username:decodeURIComponent(d),password:decodeURIComponent(p),port:y?parseInt(y):void 0,database:s||void 0}}static parseMongoDBConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0,c="",l,u,d,p,f={};if(s&&s.indexOf("?")!==-1){c=s.substr(s.indexOf("?")+1,s.length);const j=c.split("&");let E,S;j.forEach(O=>{E=O.split("=")[0],S=O.split("=")[1],f[E]=S}),p=f.replicaSet,s=s.substr(0,s.indexOf("?"))}const m=i.lastIndexOf("@"),y=i.substr(0,m),v=i.substr(m+1);let b=y,w="";const _=y.indexOf(":");_!==-1&&(b=y.substr(0,_),w=y.substr(_+1)),p?d=v:[l,u]=v.split(":");let x={type:n,host:l,hostReplicaSet:d,username:decodeURIComponent(b),password:decodeURIComponent(w),port:u?parseInt(u):void 0,database:s||void 0};for(const[j,E]of Object.entries(f))x[j]=E;return x}}class YL{constructor(t,n,r){this.connection=t,this.queryExpressionMap=n,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,r&&an.assign(this,r)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){let t=()=>{for(const n of this.queryExpressionMap.selects)if(n.selection===this.alias.name||this.metadata&&this.metadata.columns.find(r=>n.selection===this.alias.name+"."+r.propertyPath))return!0;return!1};this.isSelectedCache=t(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(qa.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(qa.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let t=()=>{if(!qa.isAliasProperty(this.entityOrProperty))return;const n=this.queryExpressionMap.findAliasByName(this.parentAlias);let r=n.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(r||n.metadata.parentEntityMetadata&&(r=n.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),r))return r;throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=t.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new xe("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new xe("Junction property is not defined.");const t=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?ve.buildAlias(this.connection.driver,void 0,t,this.alias.name):ve.buildAlias(this.connection.driver,void 0,this.alias.name,t)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class ej{constructor(t,n){this.queryExpressionMap=t,this.disableMixedMap=!1,an.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!qa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!qa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!qa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");const t=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return t}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class tj{constructor(t,n){this.expressionMap=t,an.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!qa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!qa.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rc"}get relation(){if(!qa.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const[t,n]=this.relationName.split("."),r=this.expressionMap.findAliasByName(t).metadata.findRelationWithPropertyPath(n);if(!r)throw new xe(`Relation with property path ${n} in entity was not found.`);return r}get metadata(){if(!qa.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const t=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(t).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}class nj{constructor(t){var n;this.connection=t,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],t.options.relationLoadStrategy&&(this.relationLoadStrategy=t.options.relationLoadStrategy),this.timeTravel=((n=t.options)==null?void 0:n.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const t=this.mainAlias.metadata.orderBy||{};return Object.keys(t).reduce((n,r)=>(n[this.mainAlias.name+"."+r]=t[r],n),{})}return this.orderBys}setMainAlias(t){return this.mainAlias=t,t}createAlias(t){let n=t.name;!n&&t.tablePath&&(n=t.tablePath),!n&&typeof t.target=="function"&&(n=t.target.name),!n&&typeof t.target=="string"&&(n=t.target);const r=new $L;return r.type=t.type,n&&(r.name=n),t.metadata&&(r.metadata=t.metadata),t.target&&!r.hasMetadata&&(r.metadata=this.connection.getMetadata(t.target)),t.tablePath&&(r.tablePath=t.tablePath),t.subQuery&&(r.subQuery=t.subQuery),this.aliases.push(r),r}findAliasByName(t){const n=this.aliases.find(r=>r.name===t);if(!n)throw new xe(`"${t}" alias was not found. Maybe you forgot to join it?`);return n}findColumnByAliasExpression(t){const[n,r]=t.split(".");return this.findAliasByName(n).metadata.findColumnWithPropertyName(r)}get relationMetadata(){if(!this.mainAlias)throw new xe("Entity to work with is not specified!");const t=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return t}clone(){const t=new nj(this.connection);return t.queryType=this.queryType,t.selects=this.selects.map(n=>n),t.maxExecutionTime=this.maxExecutionTime,t.selectDistinct=this.selectDistinct,t.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(n=>t.aliases.push(new $L(n))),t.relationLoadStrategy=this.relationLoadStrategy,t.mainAlias=this.mainAlias,t.valuesSet=this.valuesSet,t.returning=this.returning,t.onConflict=this.onConflict,t.onIgnore=this.onIgnore,t.onUpdate=this.onUpdate,t.joinAttributes=this.joinAttributes.map(n=>new YL(this.connection,this,n)),t.relationIdAttributes=this.relationIdAttributes.map(n=>new ej(this,n)),t.relationCountAttributes=this.relationCountAttributes.map(n=>new tj(this,n)),t.wheres=this.wheres.map(n=>({...n})),t.havings=this.havings.map(n=>({...n})),t.orderBys=Object.assign({},this.orderBys),t.groupBys=this.groupBys.map(n=>n),t.limit=this.limit,t.offset=this.offset,t.skip=this.skip,t.take=this.take,t.lockMode=this.lockMode,t.onLocked=this.onLocked,t.lockVersion=this.lockVersion,t.lockTables=this.lockTables,t.withDeleted=this.withDeleted,t.parameters=Object.assign({},this.parameters),t.disableEscaping=this.disableEscaping,t.enableRelationIdValues=this.enableRelationIdValues,t.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,t.subQuery=this.subQuery,t.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,t.cache=this.cache,t.cacheId=this.cacheId,t.cacheDuration=this.cacheDuration,t.relationPropertyPath=this.relationPropertyPath,t.of=this.of,t.insertColumns=this.insertColumns,t.whereEntities=this.whereEntities,t.updateEntity=this.updateEntity,t.callListeners=this.callListeners,t.useTransaction=this.useTransaction,t.timeTravel=this.timeTravel,t.nativeParameters=Object.assign({},this.nativeParameters),t.comment=this.comment,t.commonTableExpressions=this.commonTableExpressions.map(n=>({alias:n.alias,queryBuilder:typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.clone(),options:n.options})),t}}class QL{constructor(t){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=t}}class rj{static transformFrom(t,n){return Array.isArray(t)?t.slice().reverse().reduce((r,a)=>a.from(r),n):t.from(n)}static transformTo(t,n){return Array.isArray(t)?t.reduce((r,a)=>a.to(r),n):t.to(n)}}class Cd{constructor(t,n,r=!0,a=!1,o,i){this["@instanceof"]=Symbol.for("FindOperator"),this._type=t,this._value=n,this._useParameter=r,this._multipleParameters=a,this._getSql=o,this._objectLiteralParameters=i}get useParameter(){return Pt.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return Pt.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return Pt.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return Pt.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(Pt.isFindOperator(this._value))return this._value}get getSql(){return Pt.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(t){this._value instanceof Cd?this._value.transformValue(t):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(n=>t&&rj.transformTo(t,n)):rj.transformTo(t,this._value)}}function Ka(e){return new Cd("in",e,!0,!0)}const npe=/[.*+\-?^${}()|[\]\\]/g,rpe=e=>e.replace(npe,"\\$&");class Jt{constructor(t,n){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,Pt.isDataSource(t)?(this.connection=t,this.queryRunner=n,this.expressionMap=new nj(this.connection)):(this.connection=t.connection,this.queryRunner=t.queryRunner,this.expressionMap=t.expressionMap.clone())}static registerQueryBuilderClass(t,n){Jt.queryBuilderRegistry[t]=n}get alias(){if(!this.expressionMap.mainAlias)throw new xe("Main alias is not set");return this.expressionMap.mainAlias.name}select(t,n){return this.expressionMap.queryType="select",Array.isArray(t)?this.expressionMap.selects=t.map(r=>({selection:r})):t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]),Pt.isSelectQueryBuilder(this)?this:Jt.queryBuilderRegistry.SelectQueryBuilder(this)}insert(){return this.expressionMap.queryType="insert",Pt.isInsertQueryBuilder(this)?this:Jt.queryBuilderRegistry.InsertQueryBuilder(this)}update(t,n){const r=n||t;if(t=Pt.isEntitySchema(t)?t.options.name:t,typeof t=="function"||typeof t=="string"){const a=this.createFromAlias(t);this.expressionMap.setMainAlias(a)}return this.expressionMap.queryType="update",this.expressionMap.valuesSet=r,Pt.isUpdateQueryBuilder(this)?this:Jt.queryBuilderRegistry.UpdateQueryBuilder(this)}delete(){return this.expressionMap.queryType="delete",Pt.isDeleteQueryBuilder(this)?this:Jt.queryBuilderRegistry.DeleteQueryBuilder(this)}softDelete(){return this.expressionMap.queryType="soft-delete",Pt.isSoftDeleteQueryBuilder(this)?this:Jt.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}restore(){return this.expressionMap.queryType="restore",Pt.isSoftDeleteQueryBuilder(this)?this:Jt.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}relation(t,n){const r=arguments.length===2?t:void 0,a=arguments.length===2?n:t;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=a,r){const o=this.createFromAlias(r);this.expressionMap.setMainAlias(o)}return Pt.isRelationQueryBuilder(this)?this:Jt.queryBuilderRegistry.RelationQueryBuilder(this)}hasRelation(t,n){const r=this.connection.getMetadata(t);return(Array.isArray(n)?n:[n]).every(a=>!!r.findRelationWithPropertyPath(a))}hasParameter(t){var n;return((n=this.parentQueryBuilder)==null?void 0:n.hasParameter(t))||t in this.expressionMap.parameters}setParameter(t,n){if(typeof n=="function")throw new xe(`Function parameter isn't supported in the parameters. Please check "${t}" parameter.`);if(!t.match(/^([A-Za-z0-9_.]+)$/))throw new xe("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(t,n),this.expressionMap.parameters[t]=n,this}setParameters(t){for(const[n,r]of Object.entries(t))this.setParameter(n,r);return this}createParameter(t){let n;do n=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(n));return this.setParameter(n,t),`:${n}`}setNativeParameters(t){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(t),Object.keys(t).forEach(n=>{this.expressionMap.nativeParameters[n]=t[n]}),this}getParameters(){const t=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const n=this.expressionMap.mainAlias.metadata;if(n.discriminatorColumn&&n.parentEntityMetadata){const r=n.childEntityMetadatas.filter(a=>a.discriminatorColumn).map(a=>a.discriminatorValue);r.push(n.discriminatorValue),t.discriminatorColumnValues=r}}return t}printSql(){const[t,n]=this.getQueryAndParameters();return this.connection.logger.logQuery(t,n),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const t=this.getQuery(),n=this.getParameters();return this.connection.driver.escapeQueryWithParameters(t,n,this.expressionMap.nativeParameters)}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();try{return await r.query(t,n)}finally{r!==this.queryRunner&&await r.release()}}createQueryBuilder(t){return new this.constructor(this.connection,t??this.queryRunner)}clone(){return new this.constructor(this)}comment(t){return this.expressionMap.comment=t,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(t){return this.expressionMap.disableEscaping?this.connection.driver.escape(t):t}setQueryRunner(t){return this.queryRunner=t,this}callListeners(t){return this.expressionMap.callListeners=t,this}useTransaction(t){return this.expressionMap.useTransaction=t,this}addCommonTableExpression(t,n,r){return this.expressionMap.commonTableExpressions.push({queryBuilder:t,alias:n,options:r||{}}),this}getTableName(t){return t.split(".").map(n=>n===""?n:this.escape(n)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new xe('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(t,n){if(this.connection.hasMetadata(t)){const r=this.connection.getMetadata(t);return this.expressionMap.createAlias({type:"from",name:n,metadata:this.connection.getMetadata(t),tablePath:r.tablePath})}else{if(typeof t=="string"){const o=t.substr(0,1)==="("&&t.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:n,tablePath:o?void 0:t,subQuery:o?t:void 0})}const r=t(this.subQuery());this.setParameters(r.getParameters());const a=r.getQuery();return this.expressionMap.createAlias({type:"from",name:n,subQuery:a})}}replacePropertyNames(t){return t}replacePropertyNamesForTheWholeQuery(t){const n={};for(const o of this.expressionMap.aliases){if(!o.hasMetadata)continue;const i=this.expressionMap.aliasNamePrefixingEnabled&&o.name?`${o.name}.`:"";n[i]||(n[i]={});for(const s of o.metadata.relations)s.joinColumns.length>0&&(n[i][s.propertyPath]=s.joinColumns[0].databaseName);for(const s of o.metadata.relations){const c=[...s.joinColumns,...s.inverseJoinColumns];for(const l of c){const u=`${s.propertyPath}.${l.referencedColumn.propertyPath}`;n[i][u]=l.databaseName}}for(const s of o.metadata.columns)n[i][s.databaseName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyPath]=s.databaseName}const r=Object.keys(n),a=r.map(o=>rpe(o)).join("|");return r.length>0&&(t=t.replace(new RegExp(`([ =(]|^.{0})${a?"("+a+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...o)=>{let i,s,c;if(a){if(i=o[0],s=o[1],c=o[3],n[o[2]][c])return`${s}${this.escape(o[2].substring(0,o[2].length-1))}.${this.escape(n[o[2]][c])}`}else if(i=o[0],s=o[1],c=o[2],n[""][c])return`${s}${this.escape(n[""][c])}`;return i})),t}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace(/\*\//g,"")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const t=[],n=this.createWhereClausesExpression(this.expressionMap.wheres);if(n.length>0&&n!=="1=1"&&t.push(this.replacePropertyNames(n)),this.expressionMap.mainAlias.hasMetadata){const a=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&a.deleteDateColumn){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.deleteDateColumn.propertyName:a.deleteDateColumn.propertyName,i=`${this.replacePropertyNames(o)} IS NULL`;t.push(i)}if(a.discriminatorColumn&&a.parentEntityMetadata){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.discriminatorColumn.databaseName:a.discriminatorColumn.databaseName,i=`${this.replacePropertyNames(o)} IN (:...discriminatorColumnValues)`;t.push(i)}}if(this.expressionMap.extraAppendedAndWhereCondition){const a=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);t.push(a)}let r="";return r+=this.createTimeTravelQuery(),t.length?t.length===1?r+=` WHERE ${t[0]}`:r+=` WHERE ( ${t.join(" ) AND ( ")} )`:r+="",r}createReturningExpression(t){const n=this.getReturningColumns(),r=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&r.isReturningSqlSupported(t)&&n.push(...this.expressionMap.extraReturningColumns.filter(a=>n.indexOf(a)===-1)),n.length){let a=n.map(o=>{const i=this.escape(o.databaseName);return r.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+i:this.escape(this.getMainTableName())+"."+i:i}).join(", ");return r.options.type==="oracle"&&(a+=" INTO "+n.map(o=>this.createParameter({type:r.columnTypeToNativeParameter(o.type),dir:r.oracle.BIND_OUT})).join(", ")),r.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(a+=" INTO @OutputTable"),a}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const t=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(n=>{this.expressionMap.mainAlias.hasMetadata&&t.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n))}),t}createWhereClausesExpression(t){return t.map((n,r)=>{const a=this.createWhereConditionExpression(n.condition);switch(n.type){case"and":return(r>0?"AND ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`;case"or":return(r>0?"OR ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`}return a}).join(" ").trim()}createWhereConditionExpression(t,n=!1){if(typeof t=="string")return t;if(Array.isArray(t))return t.length===0?"1=1":t.length===1&&!n?this.createWhereClausesExpression(t):"("+this.createWhereClausesExpression(t)+")";const{driver:r}=this.connection;switch(t.operator){case"lessThan":return`${t.parameters[0]} < ${t.parameters[1]}`;case"lessThanOrEqual":return`${t.parameters[0]} <= ${t.parameters[1]}`;case"arrayContains":return`${t.parameters[0]} @> ${t.parameters[1]}`;case"jsonContains":return`${t.parameters[0]} ::jsonb @> ${t.parameters[1]}`;case"arrayContainedBy":return`${t.parameters[0]} <@ ${t.parameters[1]}`;case"arrayOverlap":return`${t.parameters[0]} && ${t.parameters[1]}`;case"moreThan":return`${t.parameters[0]} > ${t.parameters[1]}`;case"moreThanOrEqual":return`${t.parameters[0]} >= ${t.parameters[1]}`;case"notEqual":return`${t.parameters[0]} != ${t.parameters[1]}`;case"equal":return`${t.parameters[0]} = ${t.parameters[1]}`;case"ilike":return r.options.type==="postgres"||r.options.type==="cockroachdb"?`${t.parameters[0]} ILIKE ${t.parameters[1]}`:`UPPER(${t.parameters[0]}) LIKE UPPER(${t.parameters[1]})`;case"like":return`${t.parameters[0]} LIKE ${t.parameters[1]}`;case"between":return`${t.parameters[0]} BETWEEN ${t.parameters[1]} AND ${t.parameters[2]}`;case"in":return t.parameters.length<=1?"0=1":`${t.parameters[0]} IN (${t.parameters.slice(1).join(", ")})`;case"any":return r.options.type==="cockroachdb"?`${t.parameters[0]}::STRING = ANY(${t.parameters[1]}::STRING[])`:`${t.parameters[0]} = ANY(${t.parameters[1]})`;case"isNull":return`${t.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(t.condition)})`;case"brackets":return`${this.createWhereConditionExpression(t.condition,!0)}`;case"and":return"("+t.parameters.join(" AND ")+")";case"or":return"("+t.parameters.join(" OR ")+")"}throw new TypeError(`Unsupported FindOperator ${Cd.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const t=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(n=>{const r=typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.getQuery();if(typeof n.queryBuilder!="string"){if(n.queryBuilder.hasCommonTableExpressions())throw new xe(`Nested CTEs aren't supported (CTE: ${n.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!Pt.isSelectQueryBuilder(n.queryBuilder))throw new xe(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${n.alias})`);this.setParameters(n.queryBuilder.getParameters())}let a=this.escape(n.alias);if(n.options.columnNames){const s=n.options.columnNames.map(c=>this.escape(c));if(Pt.isSelectQueryBuilder(n.queryBuilder)&&n.queryBuilder.expressionMap.selects.length&&n.options.columnNames.length!==n.queryBuilder.expressionMap.selects.length)throw new xe(`cte.options.columnNames length (${n.options.columnNames.length}) doesn't match subquery select list length ${n.queryBuilder.expressionMap.selects.length} (CTE: ${n.alias})`);a+=`(${s.join(", ")})`}const o=n.options.recursive&&t?"RECURSIVE":"";let i="";return this.connection.driver.cteCapabilities.materializedHint&&n.options.materialized!==void 0&&(i=n.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[o,a,"AS",i,`(${r})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(t){const n=this.expressionMap.mainAlias.metadata,r=(Array.isArray(t)?t:[t]).map(a=>n.ensureEntityIdMap(a));if(!n.hasMultiplePrimaryKeys){const a=n.primaryColumns[0];if(!a.transformer&&!a.relationMetadata&&!a.embeddedMetadata)return{[a.propertyName]:Ka(r.map(o=>a.getEntityValue(o,!1)))}}return new QL(a=>{for(const o of r)a.orWhere(new QL(i=>i.where(o)))})}getExistsCondition(t){const n=t.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${n.getQuery()})`,n.getParameters()]}findColumnsForPropertyPath(t){let n=this.expressionMap.mainAlias;const r=[],a=t.split(".");for(;a.length>1;){const s=a[0];if(!(n!=null&&n.hasMetadata))break;if(n.metadata.hasEmbeddedWithPropertyPath(s)){a.unshift(`${a.shift()}.${a.shift()}`);continue}if(n.metadata.hasRelationWithPropertyPath(s)){const c=this.expressionMap.joinAttributes.find(l=>l.relationPropertyPath===s);if(!(c!=null&&c.alias)){const l=r.length>0?`${r.join(".")}.${s}`:s;throw new Error(`Cannot find alias for relation at ${l}`)}n=c.alias,r.push(...s.split(".")),a.shift();continue}break}if(!n)throw new Error(`Cannot find alias for property ${t}`);const o=a.join("."),i=n.metadata.findColumnsWithPropertyPath(o);if(!i.length)throw new Ha(t,n.metadata);return[n,r,i]}createPropertyPath(t,n,r=""){const a=[];for(const o of Object.keys(n)){const i=r?`${r}.${o}`:o;if(n[o]===null||typeof n[o]!="object"||Pt.isFindOperator(n[o])){a.push(i);continue}if(t.hasEmbeddedWithPropertyPath(i)){const s=this.createPropertyPath(t,n[o],i);a.push(...s);continue}if(t.hasRelationWithPropertyPath(i)){const s=t.findRelationWithPropertyPath(i);if(s.relationType==="one-to-one"||s.relationType==="many-to-one"){const u=s.joinColumns.map(d=>d.referencedColumn).filter(d=>!!d);if(u.length>0&&u.every(d=>d.getEntityValue(n[o],!1))){a.push(i);continue}}if(s.relationType==="one-to-many"||s.relationType==="many-to-many")throw new Error(`Cannot query across ${s.relationType} for property ${i}`);const c=s.inverseEntityMetadata.primaryColumns;if(c.length>0&&c.every(u=>u.getEntityValue(n[o],!1))){const u=c.map(d=>`${i}.${d.propertyPath}`);a.push(...u);continue}const l=this.createPropertyPath(s.inverseEntityMetadata,n[o]).map(u=>`${i}.${u}`);a.push(...l);continue}a.push(i)}return a}*getPredicates(t){if(this.expressionMap.mainAlias.hasMetadata){const n=this.createPropertyPath(this.expressionMap.mainAlias.metadata,t);for(const r of n){const[a,o,i]=this.findColumnsForPropertyPath(r);for(const s of i){let c=t;for(const d of o){if(!c||!(d in c)){c={};break}c=c[d]}const l=this.expressionMap.aliasNamePrefixingEnabled?`${a.name}.${s.propertyPath}`:s.propertyPath,u=s.getEntityValue(c,!0);yield[l,u]}}}else for(const n of Object.keys(t)){const r=t[n];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${n}`:n,r]}}getWherePredicateCondition(t,n){if(Pt.isFindOperator(n)){let r=[];if(n.useParameter)if(n.objectLiteralParameters)this.setParameters(n.objectLiteralParameters);else if(n.multipleParameters)for(const a of n.value)r.push(this.createParameter(a));else r.push(this.createParameter(n.value));if(n.type==="raw")return n.getSql?n.getSql(t):{operator:"equal",parameters:[t,n.value]};if(n.type==="not")return n.child?{operator:n.type,condition:this.getWherePredicateCondition(t,n.child)}:{operator:"notEqual",parameters:[t,...r]};if(n.type==="and"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else if(n.type==="or"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else return{operator:n.type,parameters:[t,...r]}}else return{operator:"equal",parameters:[t,this.createParameter(n)]}}getWhereCondition(t){if(typeof t=="string")return t;if(Pt.isBrackets(t)){const a=this.createQueryBuilder();return a.parentQueryBuilder=this,a.expressionMap.mainAlias=this.expressionMap.mainAlias,a.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,a.expressionMap.parameters=this.expressionMap.parameters,a.expressionMap.nativeParameters=this.expressionMap.nativeParameters,a.expressionMap.wheres=[],t.whereFactory(a),{operator:Pt.isNotBrackets(t)?"not":"brackets",condition:a.expressionMap.wheres}}if(typeof t=="function")return t(this);const n=Array.isArray(t)?t:[t],r=[];for(const a of n){const o=[];for(const[i,s]of this.getPredicates(a))o.push({type:"and",condition:this.getWherePredicateCondition(i,s)});r.push({type:"or",condition:o})}return r.length===1?r[0].condition:r}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}Jt.queryBuilderRegistry={};class ape{static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class ope extends Jt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("DeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createDeleteExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("BeforeRemove",this.expressionMap.mainAlias.metadata);const o=await r.query(t,n,!0),i=ape.from(o);return this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("AfterRemove",this.expressionMap.mainAlias.metadata),a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}finally{r!==this.queryRunner&&await r.release()}}from(t,n){t=Pt.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("delete"))throw new jm;return this.expressionMap.returning=t,this}createDeleteExpression(){const t=this.getTableName(this.getMainTableName()),n=this.createWhereExpression(),r=this.createReturningExpression("delete");return r===""?`DELETE FROM ${t}${n}`:this.connection.driver.options.type==="mssql"?`DELETE FROM ${t} OUTPUT ${r}${n}`:`DELETE FROM ${t}${n} RETURNING ${r}`}}let Em;const ipe=new Uint8Array(16);function spe(){if(!Em&&(Em=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Em))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Em(ipe)}const Cn=[];for(let e=0;e<256;++e)Cn.push((e+256).toString(16).slice(1));function cpe(e,t=0){return Cn[e[t+0]]+Cn[e[t+1]]+Cn[e[t+2]]+Cn[e[t+3]]+"-"+Cn[e[t+4]]+Cn[e[t+5]]+"-"+Cn[e[t+6]]+Cn[e[t+7]]+"-"+Cn[e[t+8]]+Cn[e[t+9]]+"-"+Cn[e[t+10]]+Cn[e[t+11]]+Cn[e[t+12]]+Cn[e[t+13]]+Cn[e[t+14]]+Cn[e[t+15]]}const lpe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),e6={randomUUID:lpe};function upe(e,t,n){if(e6.randomUUID&&!t&&!e)return e6.randomUUID();e=e||{};const r=e.random||(e.rng||spe)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,cpe(r)}class t6{constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}class n6{constructor(){this.identifiers=[],this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.raw,n}}class aj{constructor(t,n){this.queryRunner=t,this.expressionMap=n}async update(t,n){const r=this.expressionMap.mainAlias.metadata;await Promise.all(n.map(async(a,o)=>{if(this.queryRunner.connection.driver.isReturningSqlSupported("update")){this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((c,l,u)=>(c[this.expressionMap.extraReturningColumns[u].databaseName]=l[0],c),{}));const i=Array.isArray(t.raw)?t.raw[o]:t.raw,s=this.queryRunner.connection.driver.createGeneratedMap(r,i);s&&(this.queryRunner.manager.merge(r.target,a,s),t.generatedMaps.push(s))}else{const i=this.expressionMap.extraReturningColumns;if(i.length>0){const s=this.expressionMap.mainAlias.metadata.getEntityIdMap(a);if(!s)throw new xe("Cannot update entity because entity id is not set in the entity.");const c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(i.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).withDeleted().setOption("create-pojo").getOne();c&&(this.queryRunner.manager.merge(r.target,a,c),t.generatedMaps.push(c))}}}))}async insert(t,n){const r=this.expressionMap.mainAlias.metadata;let a=r.getInsertionReturningColumns();const o=this.queryRunner.connection.driver.isReturningSqlSupported("insert");a=a.filter(s=>s.isGenerated?o===!0:!0);const i=n.map((s,c)=>{this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((d,p,f)=>(d[this.expressionMap.extraReturningColumns[f].databaseName]=p[0],d),{}));const l=Array.isArray(t.raw)?t.raw[c]:t.raw,u=this.queryRunner.connection.driver.createGeneratedMap(r,l,c,n.length)||{};return c in this.expressionMap.locallyGenerated&&this.queryRunner.manager.merge(r.target,u,this.expressionMap.locallyGenerated[c]),this.queryRunner.manager.merge(r.target,s,u),u});if(a.length>0&&!this.queryRunner.connection.driver.isReturningSqlSupported("insert")){const s=n.map(l=>{const u=r.getEntityIdMap(l);if(!u)throw new xe("Cannot update entity because entity id is not set in the entity.");return u}),c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(a.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).setOption("create-pojo").getMany();n.forEach((l,u)=>{this.queryRunner.manager.merge(r.target,i[u],c[u]),this.queryRunner.manager.merge(r.target,l,c[u])})}n.forEach((s,c)=>{const l=r.getEntityIdMap(s);t.identifiers.push(l),t.generatedMaps.push(i[c])})}getUpdationReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion)}getSoftDeletionReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion||t.isDeleteDate)}}class dpe extends Jt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("InsertQueryBuilder")}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createInsertExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.getValueSets();if(t.length===0)return new n6;const n=this.obtainQueryRunner();let r=!1;try{if(this.expressionMap.useTransaction===!0&&n.isTransactionActive===!1&&(await n.startTransaction(),r=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const f=new t6;t.forEach(m=>{n.broadcaster.broadcastBeforeInsertEvent(f,this.expressionMap.mainAlias.metadata,m)}),await f.wait()}let a=null,o=null;const i=new aj(n,this.expressionMap),s=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const f of this.expressionMap.returning)s.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(f));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&(t.length>1&&this.connection.driver.options.type==="oracle"||(this.expressionMap.extraReturningColumns=this.expressionMap.mainAlias.metadata.getInsertionReturningColumns()),s.push(...this.expressionMap.extraReturningColumns.filter(f=>!s.includes(f)))),s.length>0&&this.connection.driver.options.type==="mssql"&&(a=this.connection.driver.buildTableVariableDeclaration("@OutputTable",s),o="SELECT * FROM @OutputTable");const[c,l]=this.getQueryAndParameters(),u=[a,c,o].filter(f=>f!=null).join(`;

`),d=await n.query(u,l,!0),p=n6.from(d);if(this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&await i.insert(p,t),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const f=new t6;t.forEach(m=>{n.broadcaster.broadcastAfterInsertEvent(f,this.expressionMap.mainAlias.metadata,m)}),await f.wait()}return r&&await n.commitTransaction(),p}catch(a){if(r)try{await n.rollbackTransaction()}catch{}throw a}finally{n!==this.queryRunner&&await n.release()}}into(t,n){t=Pt.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t);return this.expressionMap.setMainAlias(r),this.expressionMap.insertColumns=n||[],this}values(t){return this.expressionMap.valuesSet=t,this}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("insert"))throw new jm;return this.expressionMap.returning=t,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}onConflict(t){return this.expressionMap.onConflict=t,this}orIgnore(t=!0){return this.expressionMap.onIgnore=!!t,this}orUpdate(t,n,r){return Array.isArray(t)?(this.expressionMap.onUpdate={overwrite:t,conflict:n,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,indexPredicate:r==null?void 0:r.indexPredicate,upsertType:r==null?void 0:r.upsertType},this):(this.expressionMap.onUpdate={conflict:t==null?void 0:t.conflict_target,columns:t==null?void 0:t.columns,overwrite:t==null?void 0:t.overwrite,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,upsertType:r==null?void 0:r.upsertType},this)}createInsertExpression(){var i,s;const t=this.getTableName(this.getMainTableName()),n=this.createValuesExpression(),r=this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1?null:this.createReturningExpression("insert"),a=this.createColumnNamesExpression();let o="INSERT ";if(((i=this.expressionMap.onUpdate)==null?void 0:i.upsertType)==="primary-key"&&(o="UPSERT "),(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+=`${this.expressionMap.onIgnore?" IGNORE ":""}`),o+=`INTO ${t}`,this.alias!==this.getMainTableName()&&ve.isPostgresFamily(this.connection.driver)&&(o+=` AS "${this.alias}"`),a?o+=`(${a})`:!n&&(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+="()"),r&&this.connection.driver.options.type==="mssql"&&(o+=` OUTPUT ${r}`),n?(this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="sap")&&this.getValueSets().length>1?o+=` ${n}`:o+=` VALUES ${n}`:ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"?o+=" VALUES ()":o+=" DEFAULT VALUES",((s=this.expressionMap.onUpdate)==null?void 0:s.upsertType)!=="primary-key"){if(this.connection.driver.supportedUpsertTypes.includes("on-conflict-do-update")){if(this.expressionMap.onIgnore)o+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)o+=` ON CONFLICT ${this.expressionMap.onConflict} `;else if(this.expressionMap.onUpdate){const{overwrite:c,columns:l,conflict:u,skipUpdateIfNoValuesChanged:d,indexPredicate:p}=this.expressionMap.onUpdate;let f="ON CONFLICT";if(Array.isArray(u)){if(f+=` ( ${u.map(y=>this.escape(y)).join(", ")} )`,p&&!ve.isPostgresFamily(this.connection.driver))throw new xe("indexPredicate option is not supported by the current database driver");p&&ve.isPostgresFamily(this.connection.driver)&&(f+=` WHERE ( ${p} )`)}else u&&(f+=` ON CONSTRAINT ${this.escape(u)}`);const m=[];Array.isArray(c)?m.push(...c.map(y=>`${this.escape(y)} = EXCLUDED.${this.escape(y)}`)):l&&m.push(...l.map(y=>`${this.escape(y)} = :${y}`)),m.length>0&&(o+=` ${f} DO UPDATE SET `,m.push(...this.expressionMap.mainAlias.metadata.columns.filter(y=>y.isUpdateDate&&!(c!=null&&c.includes(y.databaseName))&&!(this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")).map(y=>`${this.escape(y.databaseName)} = DEFAULT`)),o+=m.join(", "),o+=" "),Array.isArray(c)&&d&&ve.isPostgresFamily(this.connection.driver)&&(o+=" WHERE (",o+=c.map(y=>`${t}.${this.escape(y)} IS DISTINCT FROM EXCLUDED.${this.escape(y)}`).join(" OR "),o+=") ")}}else if(this.connection.driver.supportedUpsertTypes.includes("on-duplicate-key-update")){if(this.expressionMap.onUpdate){const{overwrite:c,columns:l}=this.expressionMap.onUpdate;Array.isArray(c)?(o+=" ON DUPLICATE KEY UPDATE ",o+=c.map(u=>`${this.escape(u)} = VALUES(${this.escape(u)})`).join(", "),o+=" "):Array.isArray(l)&&(o+=" ON DUPLICATE KEY UPDATE ",o+=l.map(u=>`${this.escape(u)} = :${u}`).join(", "),o+=" ")}}else if(this.expressionMap.onUpdate)throw new xe("onUpdate is not supported by the current database driver")}return r&&(ve.isPostgresFamily(this.connection.driver)||this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="cockroachdb"||ve.isMySQLFamily(this.connection.driver))&&(o+=` RETURNING ${r}`),this.connection.driver.options.type==="mssql"&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter(c=>this.expressionMap.insertColumns.length>0?this.expressionMap.insertColumns.indexOf(c.propertyPath)!==-1:c.isInsert).some(c=>this.isOverridingAutoIncrementBehavior(c))&&(o=`SET IDENTITY_INSERT ${t} ON; ${o}; SET IDENTITY_INSERT ${t} OFF`),o}getInsertedColumns(){return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter(t=>this.expressionMap.insertColumns.length?this.expressionMap.insertColumns.indexOf(t.propertyPath)!==-1:!(!t.isInsert||t.isGenerated&&t.generationStrategy==="increment"&&this.connection.driver.options.type!=="spanner"&&this.connection.driver.options.type!=="oracle"&&!ve.isSQLiteFamily(this.connection.driver)&&!ve.isMySQLFamily(this.connection.driver)&&this.connection.driver.options.type!=="aurora-mysql"&&!(this.connection.driver.options.type==="mssql"&&this.isOverridingAutoIncrementBehavior(t)))):[]}createColumnNamesExpression(){const t=this.getInsertedColumns();if(t.length>0)return t.map(n=>this.escape(n.databaseName)).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){const n=this.getValueSets();if(n.length===1)return Object.keys(n[0]).map(r=>this.escape(r)).join(", ")}return this.expressionMap.insertColumns.map(n=>this.escape(n)).join(", ")}createValuesExpression(){const t=this.getValueSets(),n=this.getInsertedColumns();if(n.length>0){let r="";return t.forEach((a,o)=>{n.forEach((i,s)=>{s===0&&(this.connection.driver.options.type==="oracle"&&t.length>1||this.connection.driver.options.type==="sap"&&t.length>1?r+=" SELECT ":r+="(");let c=i.getEntityValue(a);if(typeof c!="function"&&(c=this.connection.driver.preparePersistentValue(c,i)),i.isVersion&&c===void 0)r+="1";else if(i.isDiscriminator)r+=this.createParameter(this.expressionMap.mainAlias.metadata.discriminatorValue);else if(i.isGenerated&&i.generationStrategy==="uuid"&&!this.connection.driver.isUUIDGenerationSupported()&&c===void 0)c=upe(),r+=this.createParameter(c),o in this.expressionMap.locallyGenerated||(this.expressionMap.locallyGenerated[o]={}),i.setEntityValue(this.expressionMap.locallyGenerated[o],c);else if(c===void 0)this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?i.default!==void 0&&i.default!==null?r+=this.connection.driver.normalizeDefault(i):r+="NULL":r+="DEFAULT";else if(c===null&&this.connection.driver.options.type==="spanner")r+="NULL";else if(typeof c=="function")r+=c();else{this.connection.driver.options.type==="mssql"&&(c=this.connection.driver.parametrizeValue(i,c));const l=this.createParameter(c);if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1){const u=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";i.srid!=null?r+=`${u}(${l}, ${i.srid})`:r+=`${u}(${l})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?i.srid!=null?r+=`ST_SetSRID(ST_GeomFromGeoJSON(${l}), ${i.srid})::${i.type}`:r+=`ST_GeomFromGeoJSON(${l})::${i.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?r+=i.type+"::STGeomFromText("+l+", "+(i.srid||"0")+")":r+=l}s===n.length-1?o===t.length-1?this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy ":r+=")":this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL UNION ALL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy UNION ALL ":r+="), ":r+=", "})}),r==="()"?"":r}else{let r="";return t.forEach((a,o)=>{Object.keys(a).forEach((i,s)=>{s===0&&(r+="(");const c=a[i];typeof c=="function"?r+=c():c===void 0?this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?r+="NULL":r+="DEFAULT":c===null&&this.connection.driver.options.type==="spanner"||(r+=this.createParameter(c)),s===Object.keys(a).length-1?o===t.length-1?r+=")":r+="), ":r+=", "})}),r==="()"?"":r}}getValueSets(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(an.isObject(this.expressionMap.valuesSet))return[this.expressionMap.valuesSet];throw new Ude}isOverridingAutoIncrementBehavior(t){return t.isPrimary&&t.isGenerated&&t.generationStrategy==="increment"&&this.getValueSets().some(n=>t.getEntityValue(n)!==void 0&&t.getEntityValue(n)!==null)}}class r6{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async update(t){const n=this.expressionMap.relationMetadata;if(n.isManyToOne||n.isOneToOneOwner){const r=n.joinColumns.reduce((a,o)=>{const i=an.isObject(t)?o.referencedColumn.getEntityValue(t):t;return o.setEntityValue(a,i),a},{});if(!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length)return;await this.queryBuilder.createQueryBuilder().update(n.entityMetadata.target).set(r).whereInIds(this.expressionMap.of).execute()}else if((n.isOneToOneNotOwner||n.isOneToMany)&&t===null){const r={};n.inverseRelation.joinColumns.forEach(c=>{r[c.propertyName]=null});const a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o={},i=[];a.forEach((c,l)=>{n.inverseRelation.joinColumns.map((u,d)=>{const p="joinColumn_"+l+"_"+d;o[p]=an.isObject(c)?u.referencedColumn.getEntityValue(c):c,i.push(`${u.propertyPath} = :${p}`)})});const s=i.map(c=>"("+c+")").join(" OR ");if(!s)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(r).where(s).setParameters(o).execute()}else if(n.isOneToOneNotOwner||n.isOneToMany){if(Array.isArray(this.expressionMap.of))throw new xe("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");const r=this.expressionMap.of,a=n.inverseRelation.joinColumns.reduce((o,i)=>{const s=an.isObject(r)?i.referencedColumn.getEntityValue(r):r;return i.setEntityValue(o,s),o},{});if(!t||Array.isArray(t)&&!t.length)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(a).whereInIds(t).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c=[];if(i.forEach(l=>{s.forEach(u=>{const d={};r.ownerColumns.forEach(p=>{d[p.databaseName]=an.isObject(l)?p.referencedColumn.getEntityValue(l):l}),r.inverseColumns.forEach(p=>{d[p.databaseName]=an.isObject(u)?p.referencedColumn.getEntityValue(u):u}),c.push(d)})}),!c.length)return;this.queryBuilder.connection.driver.options.type==="oracle"||this.queryBuilder.connection.driver.options.type==="sap"?await Promise.all(c.map(l=>this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(l).execute())):await this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(c).execute()}}}class ppe{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async remove(t){const n=this.expressionMap.relationMetadata;if(n.isOneToMany){const r=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],a=Array.isArray(t)?t:[t],o={};n.inverseRelation.joinColumns.forEach(l=>{o[l.propertyName]=null});const i={},s=[];r.forEach((l,u)=>{s.push(...a.map((d,p)=>[...n.inverseRelation.joinColumns.map((f,m)=>{const y="joinColumn_"+u+"_"+p+"_"+m;return i[y]=an.isObject(l)?f.referencedColumn.getEntityValue(l):l,`${f.propertyPath} = :${y}`}),...n.inverseRelation.entityMetadata.primaryColumns.map((f,m)=>{const y="primaryColumn_"+p+"_"+p+"_"+m;return i[y]=an.isObject(d)?f.getEntityValue(d):d,`${f.propertyPath} = :${y}`})].join(" AND ")))});const c=s.map(l=>"("+l+")").join(" OR ");if(!c)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(o).where(c).setParameters(i).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c={},l=[];i.forEach((d,p)=>{l.push(...s.map((f,m)=>[...r.ownerColumns.map((y,v)=>{const b="firstValue_"+p+"_"+m+"_"+v;return c[b]=an.isObject(d)?y.referencedColumn.getEntityValue(d):d,`${y.databaseName} = :${b}`}),...r.inverseColumns.map((y,v)=>{const b="secondValue_"+p+"_"+m+"_"+v;return c[b]=an.isObject(f)?y.referencedColumn.getEntityValue(f):f,`${y.databaseName} = :${b}`})].join(" AND ")))});const u=l.map(d=>"("+d+")").join(" OR ");await this.queryBuilder.createQueryBuilder().delete().from(r.tableName).where(u).setParameters(c).execute()}}}class fpe extends Jt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("RelationQueryBuilder")}getQuery(){return""}of(t){return this.expressionMap.of=t,this}async set(t){const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToMany||n.isOneToMany)throw new xe(`Set operation is only supported for many-to-one and one-to-one relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .add() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!an.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new r6(this,this.expressionMap).update(t)}async add(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!an.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new r6(this,this.expressionMap).update(t)}async remove(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set(null) method instead.`);return new ppe(this,this.expressionMap).remove(t)}async addAndRemove(t,n){await this.remove(n),await this.add(t)}async loadOne(){return this.loadMany().then(t=>t[0])}async loadMany(){let t=this.expressionMap.of;if(!an.isObject(t)){const n=this.expressionMap.mainAlias.metadata;if(n.hasMultiplePrimaryKeys)throw new xe("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");t=n.primaryColumns[0].createValueMap(t)}return this.connection.relationLoader.load(this.expressionMap.relationMetadata,t,this.queryRunner)}}class Nn{static chunk(t,n){return Array.from(Array(Math.ceil(t.length/n)),(r,a)=>t.slice(a*n,a*n+n))}static splitClassesAndStrings(t){return[t.filter(n=>typeof n!="string"),t.filter(n=>typeof n=="string")]}static groupBy(t,n){return t.reduce((r,a)=>{const o=n(a);let i=r.find(s=>s.id===o);return i||(i={id:o,items:[]},r.push(i)),i.items.push(a),r},[])}static uniq(t,n){return t.reduce((r,a)=>{let o=!1;if(typeof n=="function"){const i=n(a);o=!!r.find(s=>n(s)===i)}else typeof n=="string"?o=!!r.find(i=>i[n]===a[n]):o=r.indexOf(a)!==-1;return o||r.push(a),r},[])}static isPlainObject(t){return t==null?!1:!t.constructor||t.constructor===Object}static mergeArrayKey(t,n,r,a){if(a.has(r)){t[n]=a.get(r);return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){t[n]=r;return}t[n]||(t[n]=Array.isArray(r)?[]:{}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static mergeObjectKey(t,n,r,a){if(a.has(r)){Object.assign(t,{[n]:a.get(r)});return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){Object.assign(t,{[n]:r});return}t[n]||Object.assign(t,{[n]:Array.isArray(r)?[]:{}}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static merge(t,n,r=new Map){if(this.isPlainObject(t)&&this.isPlainObject(n))for(const a of Object.keys(n))a!=="__proto__"&&this.mergeObjectKey(t,a,n[a],r);if(Array.isArray(t)&&Array.isArray(n))for(let a=0;a<n.length;a++)this.mergeArrayKey(t,a,n[a],r)}static mergeDeep(t,...n){if(!n.length)return t;for(const r of n)Nn.merge(t,r);return t}static deepCompare(...t){let n,r,a,o;if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(a=[],o=[],!this.compare2Objects(a,o,arguments[0],arguments[n]))return!1;return!0}static deepValue(t,n){const r=n.split(".");for(let a=0,o=r.length;a<o;a++)t=t[r[a]];return t}static replaceEmptyObjectsWithBooleans(t){for(let n in t)t[n]&&typeof t[n]=="object"&&(Object.keys(t[n]).length===0?t[n]=!0:this.replaceEmptyObjectsWithBooleans(t[n]))}static propertyPathsToTruthyObject(t){let n={};for(let r of t){const a=r.split(".");if(!a.length)continue;(!n[a[0]]||n[a[0]]===!0)&&(n[a[0]]={});let o=n[a[0]];for(let[i,s]of a.entries())i!==0&&(o[s]?o=o[s]:i===a.length-1?(o[s]={},o=null):(o[s]={},o=o[s]))}return this.replaceEmptyObjectsWithBooleans(n),n}static compareIds(t,n){return t==null||n===void 0||n===null?!1:(typeof t.id=="string"&&typeof n.id=="string"||typeof t.id=="number"&&typeof n.id=="number")&&Object.keys(t).length===1&&Object.keys(n).length===1?t.id===n.id:Nn.deepCompare(t,n)}static toBoolean(t){return typeof t=="boolean"?t:typeof t=="string"?t==="true"||t==="1":typeof t=="number"?t>0:!1}static zipObject(t,n){return t.reduce((r,a,o)=>(r[a]=n[o],r),{})}static isArraysEqual(t,n){return t.length!==n.length?!1:t.every(r=>n.indexOf(r)!==-1)}static areMutuallyExclusive(...t){return!t.some(n=>{const r=t.filter(a=>a!==n);return n.some(a=>r.some(o=>o.includes(a)))})}static parseSqlCheckExpression(t,n){const r=t.match(new RegExp(`"${n}" varchar CHECK\\s*\\(\\s*"${n}"\\s+IN\\s*`));if(r&&r.index){const a=t.substring(r.index+r[0].length);let o="",i="";const s=[];for(let c=0;c<a.length;c++){const l=a[c];switch(l){case",":o==""?(s.push(i),i=""):i+=l;break;case"'":o==l?a[c+1]===l?(i+=l,c+=1):o="":o=l;break;case")":if(o=="")return s.push(i),s;i+=l;break;default:o!=""&&(i+=l)}}}}static compare2Objects(t,n,r,a){let o;if(Number.isNaN(r)&&Number.isNaN(a)||r===a)return!0;if(r===null||a===null||r===void 0||a===void 0)return!1;if((typeof r.equals=="function"||typeof r.equals=="function")&&r.equals(a))return!0;if(typeof r=="function"&&typeof a=="function"||r instanceof Date&&a instanceof Date||r instanceof RegExp&&a instanceof RegExp||typeof r=="string"&&typeof a=="string"||typeof r=="number"&&typeof a=="number")return r.toString()===a.toString();if(!(typeof r=="object"&&typeof a=="object")||Object.prototype.isPrototypeOf.call(r,a)||Object.prototype.isPrototypeOf.call(a,r)||r.constructor!==a.constructor||r.prototype!==a.prototype||t.indexOf(r)>-1||n.indexOf(a)>-1)return!1;for(o in a)if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;for(o in r){if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;switch(typeof r[o]){case"object":case"function":if(t.push(r),n.push(a),!this.compare2Objects(t,n,r[o],a[o]))return!1;t.pop(),n.pop();break;default:if(r[o]!==a[o])return!1;break}}return!0}}class hpe{constructor(t,n,r,a,o){this.expressionMap=t,this.driver=n,this.rawRelationIdResults=r,this.rawRelationCountResults=a,this.queryRunner=o}transform(t,n){const r=this.group(t,n),a=[];return r.forEach(o=>{const i=this.transformRawResultsGroup(o,n);i!==void 0&&!Object.values(i).every(s=>s===null)&&a.push(i)}),a}group(t,n){const r=new Map,a=[];return n.metadata.tableType==="view"?a.push(...n.metadata.columns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))):a.push(...n.metadata.primaryColumns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))),t.forEach(o=>{const i=a.map(c=>{const l=o[c];return En.isBuffer(l)?l.toString("hex"):an.isObject(l)?JSON.stringify(l):l}).join("_"),s=r.get(i);s?s.push(o):r.set(i,[o])}),r}transformRawResultsGroup(t,n){let r=n.metadata;if(r.discriminatorColumn){const l=t.map(d=>d[ve.buildAlias(this.driver,void 0,n.name,n.metadata.discriminatorColumn.databaseName)]),u=r.childEntityMetadatas.find(d=>typeof l.find(p=>p===d.discriminatorValue)<"u");u&&(r=u)}let a=r.create(this.queryRunner,{fromDeserializer:!0,pojo:this.expressionMap.options.indexOf("create-pojo")!==-1});const o=this.transformColumns(t,n,a,r),i=this.transformJoins(t,a,n,r),s=this.transformRelationIds(t,n,a,r),c=this.transformRelationCounts(t,n,a);if(o||r.primaryColumns.filter(l=>l.isVirtual===!1).length===0&&(i||s||c))return a}transformColumns(t,n,r,a){let o=!1;return a.columns.forEach(i=>{if(a.childEntityMetadatas.length>0&&a.childEntityMetadatas.findIndex(c=>c.target===i.target)!==-1)return;const s=t[0][ve.buildAlias(this.driver,void 0,n.name,i.databaseName)];s===void 0||i.isVirtual||this.expressionMap.selects.find(c=>c.selection===n.name||c.selection===n.name+"."+i.propertyPath)&&(i.setEntityValue(r,this.driver.prepareHydratedValue(s,i)),s!==null&&(o=!0))}),o}transformJoins(t,n,r,a){let o=!1;return this.expressionMap.joinAttributes.forEach(i=>{if(!i.metadata||!i.isSelected||i.relation&&!a.relations.find(c=>c===i.relation))return;if(i.mapToProperty){if(i.mapToPropertyParentAlias!==r.name)return}else if(!i.relation||i.parentAlias!==r.name||i.relationPropertyPath!==i.relation.propertyPath)return;let s=this.transform(t,i.alias);s=i.isMany?s:s[0],s=!i.isMany&&s===void 0?null:s,s!==void 0&&(i.mapToPropertyPropertyName?n[i.mapToPropertyPropertyName]=s:i.relation.setEntityValue(n,s),o=!0)}),o}transformRelationIds(t,n,r,a){let o=!1;return this.rawRelationIdResults.forEach((i,s)=>{if(i.relationIdAttribute.parentAlias!==n.name)return;const c=i.relationIdAttribute.relation,l=this.createValueMapFromJoinColumns(c,i.relationIdAttribute.parentAlias,t);if(l==null)return;this.prepareDataForTransformRelationIds();const u=this.hashEntityIds(c,l),d=this.relationIdMaps[s][u]||[],p=i.relationIdAttribute.mapToPropertyPropertyPath.split("."),f=(m,y,v)=>{const b=m.shift();if(b&&m.length===0)return y[b]=v,y;if(b&&m.length>0)f(m,y[b],v);else return y};c.isOneToOne||c.isManyToOne?d[0]!==void 0&&(f(p,r,d[0]),o=!0):(f(p,r,d),o=o||d.length>0)}),o}transformRelationCounts(t,n,r){let a=!1;return this.rawRelationCountResults.filter(o=>o.relationCountAttribute.parentAlias===n.name).forEach(o=>{const i=o.relationCountAttribute.relation;let s;i.isOneToMany?s=i.inverseRelation.joinColumns[0].referencedColumn.databaseName:s=i.isOwning?i.joinColumns[0].referencedColumn.databaseName:i.inverseRelation.joinColumns[0].referencedColumn.databaseName;const c=t[0][ve.buildAlias(this.driver,void 0,n.name,s)];c!=null&&(r[o.relationCountAttribute.mapToPropertyPropertyName]=0,o.results.filter(l=>l.parentId===c).forEach(l=>{r[o.relationCountAttribute.mapToPropertyPropertyName]=parseInt(l.cnt),a=!0}))}),a}createValueMapFromJoinColumns(t,n,r){let a;return t.isManyToOne||t.isOneToOneOwner?a=t.entityMetadata.primaryColumns.map(o=>o):t.isOneToMany||t.isOneToOneNotOwner?a=t.inverseRelation.joinColumns.map(o=>o):t.isOwning?a=t.joinColumns.map(o=>o):a=t.inverseRelation.inverseJoinColumns.map(o=>o),a.reduce((o,i)=>(r.forEach(s=>{t.isManyToOne||t.isOneToOneOwner?o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.databaseName)],i):o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.referencedColumn.databaseName)],i.referencedColumn)}),o),{})}extractEntityPrimaryIds(t,n){let r;return t.isManyToOne||t.isOneToOneOwner?r=t.entityMetadata.primaryColumns.map(a=>a):t.isOneToMany||t.isOneToOneNotOwner?r=t.inverseRelation.joinColumns.map(a=>a):t.isOwning?r=t.joinColumns.map(a=>a):r=t.inverseRelation.inverseJoinColumns.map(a=>a),r.reduce((a,o)=>(a[o.databaseName]=n[o.databaseName],a),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(t=>{const n=t.relationIdAttribute.relation;let r;return n.isManyToOne||n.isOneToOneOwner?r=n.joinColumns:n.isOneToMany||n.isOneToOneNotOwner?r=n.inverseEntityMetadata.primaryColumns:n.isOwning?r=n.inverseJoinColumns:r=n.inverseRelation.joinColumns,t.results.reduce((a,o)=>{let i=r.reduce((s,c)=>{let l=o[c.databaseName];return n.isOneToMany||n.isOneToOneNotOwner?(c.isVirtual&&c.referencedColumn&&c.referencedColumn.propertyName!==c.propertyName&&(l=c.referencedColumn.createValueMap(l)),Nn.mergeDeep(s,c.createValueMap(l))):(!c.isPrimary&&c.referencedColumn.referencedColumn&&(l=c.referencedColumn.referencedColumn.createValueMap(l)),Nn.mergeDeep(s,c.referencedColumn.createValueMap(l)))},{});if(r.length===1&&!t.relationIdAttribute.disableMixedMap&&(n.isOneToMany||n.isOneToOneNotOwner?i=r[0].getEntityValue(i):i=r[0].referencedColumn.getEntityValue(i)),i!==void 0){const s=this.hashEntityIds(n,o);a[s]?a[s].push(i):a[s]=[i]}return a},{})}))}hashEntityIds(t,n){const r=this.extractEntityPrimaryIds(t,n);return JSON.stringify(r)}}let mpe=class{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}async load(e){const t=this.relationIdAttributes.map(async n=>{if(n.relation.isManyToOne||n.relation.isOneToOneOwner){if(n.queryBuilderFactory)throw new xe("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const r={},a=e.map(o=>{const i={},s=[];n.relation.joinColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l.referencedColumn);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),n.relation.entityMetadata.primaryColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),s.sort();const c=s.join("::");return r[c]?null:(r[c]=!0,i)}).filter(o=>o);return{relationIdAttribute:n,results:a}}else if(n.relation.isOneToMany||n.relation.isOneToOneNotOwner){const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.joinColumns,o=r.inverseEntityMetadata.target,i=r.inverseEntityMetadata.tableName,s=n.alias||i,c={},l={},u=e.map((f,m)=>{const y=[],v={},b=a.map(_=>{const x=_.databaseName+m,j=f[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,_.referencedColumn.databaseName)],E=`${s}:${_.propertyPath}:${j}`;return y.indexOf(E)!==-1?"":(y.push(E),v[x]=j,s+"."+_.propertyPath+" = :"+x)}).filter(_=>_).join(" AND ");y.sort();const w=y.join("::");return c[w]?"":(c[w]=!0,Object.assign(l,v),b)}).filter(f=>f).map(f=>"("+f+")").join(" OR ");if(!u)return{relationIdAttribute:n,results:[]};const d=this.connection.createQueryBuilder(this.queryRunner);Nn.uniq([...a,...r.inverseRelation.entityMetadata.primaryColumns],f=>f.propertyPath).forEach(f=>{d.addSelect(s+"."+f.propertyPath,f.databaseName)}),d.from(o,s).where("("+u+")").setParameters(l),n.queryBuilderFactory&&n.queryBuilderFactory(d);const p=await d.getRawMany();return p.forEach(f=>{a.forEach(m=>{f[m.databaseName]=this.connection.driver.prepareHydratedValue(f[m.databaseName],m.referencedColumn)}),r.inverseRelation.entityMetadata.primaryColumns.forEach(m=>{f[m.databaseName]=this.connection.driver.prepareHydratedValue(f[m.databaseName],m)})}),{relationIdAttribute:n,results:p}}else{const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.inverseJoinColumns,o=r.isOwning?r.inverseJoinColumns:r.inverseRelation.joinColumns,i=n.junctionAlias,s=n.joinInverseSideMetadata.tableName,c=n.alias||s,l=r.isOwning?r.junctionEntityMetadata.tableName:r.inverseRelation.junctionEntityMetadata.tableName,u=e.map(w=>a.reduce((_,x)=>(_[x.propertyPath]=w[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,x.referencedColumn.databaseName)],_),{}));if(u.length===0)return{relationIdAttribute:n,results:[]};const d={},p={},f=u.map((w,_)=>{const x=[],j={},E=Object.keys(w).map(O=>{const N=O+_,M=w[O],k=`${i}:${O}:${M}`;return x.indexOf(k)!==-1?"":(x.push(k),j[N]=M,i+"."+O+" = :"+N)}).filter(O=>O).join(" AND ");x.sort();const S=x.join("::");return p[S]?"":(p[S]=!0,Object.assign(d,j),E)}).filter(w=>w),m=o.map(w=>i+"."+w.propertyPath+" = "+c+"."+w.referencedColumn.propertyPath).join(" AND "),y=f.map(w=>"("+w+" AND "+m+")").join(" OR "),v=this.connection.createQueryBuilder(this.queryRunner);o.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),a.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),v.from(s,c).innerJoin(l,i,y).setParameters(d),n.queryBuilderFactory&&n.queryBuilderFactory(v);const b=await v.getRawMany();return b.forEach(w=>{[...a,...o].forEach(_=>{w[_.databaseName]=this.connection.driver.prepareHydratedValue(w[_.databaseName],_.referencedColumn)})}),{relationIdAttribute:n,results:b}}});return Promise.all(t)}};class ype{constructor(t,n){this.connection=t,this.queryRunner=n}load(t,n,r){const a=Array.isArray(n)?n:[n],o=Array.isArray(r)?r:r?[r]:void 0;return t.isManyToMany?this.loadForManyToMany(t,a,o):t.isManyToOne||t.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(t,a,o):this.loadForOneToManyAndOneToOneNotOwner(t,a,o)}async loadManyToManyRelationIdsAndGroup(t,n,r,a){const o=t.isManyToMany||t.isOneToMany,i=Array.isArray(n)?n:[n];if(!r&&(r=await this.connection.relationLoader.load(t,n,this.queryRunner,a),!r.length))return i.map(d=>({entity:d,related:o?[]:void 0}));const s=await this.load(t,n,r),c=Array.isArray(r)?r:[r];let l=[],u=[];return t.isManyToManyOwner?(l=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn)):t.isManyToManyNotOwner?(l=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn)):t.isManyToOne||t.isOneToOneOwner?(l=t.joinColumns.map(d=>d.referencedColumn),u=t.entityMetadata.primaryColumns):(t.isOneToMany||t.isOneToOneNotOwner)&&(l=t.inverseRelation.entityMetadata.primaryColumns,u=t.inverseRelation.joinColumns.map(d=>d.referencedColumn)),i.map(d=>{const p={entity:d,related:o?[]:void 0},f=s.filter(m=>u.every(y=>y.compareEntityValue(d,m[y.entityMetadata.name+"_"+y.propertyAliasName])));return f.length&&c.forEach(m=>{f.forEach(y=>{l.every(v=>v.compareEntityValue(m,y[ve.buildAlias(this.connection.driver,void 0,v.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+v.propertyPath.replace(".","_"))]))&&(o?p.related.push(m):p.related=m)})}),p})}loadForManyToMany(t,n,r){const a=t.junctionEntityMetadata,o=a.name,i=t.isOwning?a.ownerColumns:a.inverseColumns,s=t.isOwning?a.inverseColumns:a.ownerColumns,c=this.connection.createQueryBuilder(this.queryRunner);i.forEach(p=>{const f=ve.buildAlias(this.connection.driver,void 0,p.referencedColumn.entityMetadata.name+"_"+p.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+p.propertyPath,f)}),s.forEach(p=>{const f=ve.buildAlias(this.connection.driver,void 0,p.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+p.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+p.propertyPath,f)});let l="";if(i.length===1){const p=n.map(f=>i[0].referencedColumn.getEntityValue(f));p.every(f=>typeof f=="number")?l=`${o}.${i[0].propertyPath} IN (${p.join(", ")})`:(c.setParameter("values1",p),l=o+"."+i[0].propertyPath+" IN (:...values1)")}else l="("+n.map((p,f)=>i.map(m=>{const y="entity1_"+f+"_"+m.propertyName;return c.setParameter(y,m.referencedColumn.getEntityValue(p)),o+"."+m.propertyPath+" = :"+y}).join(" AND ")).map(p=>"("+p+")").join(" OR ")+")";let u="";if(r)if(s.length===1){const p=r.map(f=>s[0].referencedColumn.getEntityValue(f));p.every(f=>typeof f=="number")?u=`${o}.${s[0].propertyPath} IN (${p.join(", ")})`:(c.setParameter("values2",p),u=o+"."+s[0].propertyPath+" IN (:...values2)")}else u="("+r.map((p,f)=>s.map(m=>{const y="entity2_"+f+"_"+m.propertyName;return c.setParameter(y,m.referencedColumn.getEntityValue(p)),o+"."+m.propertyPath+" = :"+y}).join(" AND ")).map(p=>"("+p+")").join(" OR ")+")";const d=[l,u].filter(p=>p.length>0).join(" AND ");return c.from(a.target,o).where(d).getRawMany()}loadForManyToOneAndOneToOneOwner(t,n,r){const a=t.entityMetadata.targetName,o=t.joinColumns.every(c=>!!t.entityMetadata.nonVirtualColumns.find(l=>l===c));if(r&&o){let c=[];if(n.forEach(l=>{let u={};t.entityMetadata.primaryColumns.forEach(d=>{const p=d.entityMetadata.name+"_"+d.propertyPath.replace(".","_");u[p]=d.getEntityValue(l)}),r.forEach(d=>{t.joinColumns.forEach(p=>{const f=p.getEntityValue(l),m=p.referencedColumn.getEntityValue(d);if(!(f===void 0||m===void 0)&&f===m){const y=p.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+p.referencedColumn.propertyPath.replace(".","_");u[y]=m}})}),Object.keys(u).length===t.entityMetadata.primaryColumns.length+t.joinColumns.length&&c.push(u)}),c.length===n.length)return Promise.resolve(c)}const i=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.entityMetadata.name+"_"+c.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)}),t.joinColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+c.referencedColumn.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)});let s="";if(t.entityMetadata.primaryColumns.length===1){const c=n.map(l=>t.entityMetadata.primaryColumns[0].getEntityValue(l));c.every(l=>typeof l=="number")?s=`${a}.${t.entityMetadata.primaryColumns[0].propertyPath} IN (${c.join(", ")})`:(i.setParameter("values",c),s=a+"."+t.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else s=n.map((c,l)=>t.entityMetadata.primaryColumns.map((u,d)=>{const p="entity"+l+"_"+d;return i.setParameter(p,u.getEntityValue(c)),a+"."+u.propertyPath+" = :"+p}).join(" AND ")).map(c=>"("+c+")").join(" OR ");return i.from(t.entityMetadata.target,a).where(s).getRawMany()}loadForOneToManyAndOneToOneNotOwner(t,n,r){if(t=t.inverseRelation,t.entityMetadata.primaryColumns.length===t.joinColumns.length&&t.entityMetadata.primaryColumns.every(s=>t.joinColumns.indexOf(s)!==-1))return Promise.resolve(n.map(s=>{const c={};return t.joinColumns.forEach(function(l){const u=l.referencedColumn.getEntityValue(s),d=l.referencedColumn.entityMetadata.name+"_"+l.referencedColumn.propertyPath.replace(".","_"),p=l.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+l.propertyPath.replace(".","_");c[d]=u,c[p]=u}),c}));const a=t.entityMetadata.targetName,o=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+s.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)}),t.joinColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.referencedColumn.entityMetadata.name+"_"+s.referencedColumn.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)});let i="";if(t.joinColumns.length===1){const s=n.map(c=>t.joinColumns[0].referencedColumn.getEntityValue(c));s.every(c=>typeof c=="number")?i=`${a}.${t.joinColumns[0].propertyPath} IN (${s.join(", ")})`:(o.setParameter("values",s),i=a+"."+t.joinColumns[0].propertyPath+" IN (:...values)")}else i=n.map((s,c)=>t.joinColumns.map((l,u)=>{const d="entity"+c+"_"+u;return o.setParameter(d,l.referencedColumn.getEntityValue(s)),a+"."+l.propertyPath+" = :"+d}).join(" AND ")).map(s=>"("+s+")").join(" OR ");return o.from(t.entityMetadata.target,a).where(i).getRawMany()}}class gpe{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationIdAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationIds.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationIdAttributes.push(r)})})}metadataToAttribute(t,n){return new ej(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class vpe{constructor(t,n,r){this.connection=t,this.queryRunner=n,this.relationCountAttributes=r}async load(t){const n=(a,o,i)=>i.indexOf(a)===o,r=this.relationCountAttributes.map(async a=>{if(a.relation.isOneToMany){const o=a.relation,i=o.inverseRelation,s=i.joinColumns[0].referencedColumn.propertyName,c=o.inverseEntityMetadata.target,l=o.inverseEntityMetadata.tableName,u=a.alias||l,d=i.propertyName;let p=t.map(m=>m[a.parentAlias+"_"+s]).filter(m=>!!m);if(p=p.filter(n),p.length===0)return{relationCountAttribute:a,results:[]};const f=this.connection.createQueryBuilder(this.queryRunner);return f.select(u+"."+d,"parentId").addSelect("COUNT(*)","cnt").from(c,u).where(u+"."+d+" IN (:...ids)").addGroupBy(u+"."+d).setParameter("ids",p),a.queryBuilderFactory&&a.queryBuilderFactory(f),{relationCountAttribute:a,results:await f.getRawMany()}}else{let o,i,s,c;a.relation.isOwning?(o=a.relation.joinColumns[0].referencedColumn.databaseName,i=a.relation.inverseJoinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[0],c=a.relation.junctionEntityMetadata.columns[1]):(o=a.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,i=a.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[1],c=a.relation.junctionEntityMetadata.columns[0]);let l=t.map(v=>v[a.parentAlias+"_"+o]).filter(v=>!!v);if(l=l.filter(n),l.length===0)return{relationCountAttribute:a,results:[]};const u=a.junctionAlias,d=a.joinInverseSideMetadata.tableName,p=a.alias||d,f=a.relation.junctionEntityMetadata.tableName,m=u+"."+s.propertyName+" IN ("+l.map(v=>isNaN(v)?"'"+v+"'":v)+") AND "+u+"."+c.propertyName+" = "+p+"."+i,y=this.connection.createQueryBuilder(this.queryRunner);return y.select(u+"."+s.propertyName,"parentId").addSelect("COUNT("+y.escape(p)+"."+y.escape(i)+")","cnt").from(d,p).innerJoin(f,u,m).addGroupBy(u+"."+s.propertyName),a.queryBuilderFactory&&a.queryBuilderFactory(y),{relationCountAttribute:a,results:await y.getRawMany()}}});return Promise.all(r)}}class bpe{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationCountAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationCounts.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationCountAttributes.push(r)})})}metadataToAttribute(t,n){return new tj(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class oj{static isFindOneOptions(t){const n=t;return n&&(Array.isArray(n.select)||Array.isArray(n.relations)||typeof n.select=="object"||typeof n.relations=="object"||typeof n.where=="object"||typeof n.join=="object"||typeof n.order=="object"||typeof n.cache=="object"||typeof n.cache=="boolean"||typeof n.cache=="number"||typeof n.comment=="string"||typeof n.lock=="object"||typeof n.loadRelationIds=="object"||typeof n.loadRelationIds=="boolean"||typeof n.loadEagerRelations=="boolean"||typeof n.withDeleted=="boolean"||typeof n.relationLoadStrategy=="string"||typeof n.transaction=="boolean")}static isFindManyOptions(t){const n=t;return n&&(this.isFindOneOptions(n)||typeof n.skip=="number"||typeof n.take=="number"||typeof n.skip=="string"||typeof n.take=="string")}static extractFindManyOptionsAlias(t){if(this.isFindManyOptions(t)&&t.join)return t.join.alias}static applyOptionsToTreeQueryBuilder(t,n){if(n!=null&&n.relations){const r=[...n.relations];if(oj.applyRelationsRecursively(t,r,t.expressionMap.mainAlias.name,t.expressionMap.mainAlias.metadata,""),r.length>0)throw new Vde(r)}return t}static applyRelationsRecursively(t,n,r,a,o){let i=[];if(o){const s=new RegExp("^"+o.replace(".","\\.")+"\\.");i=n.filter(c=>c.match(s)).map(c=>a.findRelationWithPropertyPath(c.replace(s,""))).filter(c=>c)}else i=n.map(s=>a.findRelationWithPropertyPath(s)).filter(s=>s);i.forEach(s=>{let c=ve.buildAlias(t.connection.driver,{joiner:"__"},r,s.propertyPath);const l=r+"."+s.propertyPath;t.expressionMap.relationLoadStrategy==="query"?t.concatRelationMetadata(s):t.leftJoinAndSelect(l,c),n.splice(n.indexOf(o?o+"."+s.propertyPath:s.propertyPath),1);let u,d;if(t.expressionMap.relationLoadStrategy==="query")u=s.inverseEntityMetadata,d=c;else{const p=t.expressionMap.joinAttributes.find(f=>f.entityOrProperty===l);u=p.metadata,d=p.alias.name}if(!d||!u)throw new Ha(s.propertyPath,a);if(this.applyRelationsRecursively(t,n,d,u,o?o+"."+s.propertyPath:s.propertyPath),t.expressionMap.relationLoadStrategy==="join"){const p=a.relations.find(f=>f.propertyName===s.propertyPath);p&&this.joinEagerRelations(t,c,p.inverseEntityMetadata)}})}static joinEagerRelations(t,n,r){r.eagerRelations.forEach(a=>{let o=ve.buildAlias(t.connection.driver,{joiner:"__"},n,a.propertyName),i=!0;for(const l of t.expressionMap.joinAttributes)if(!(l.condition!==void 0||l.mapToProperty!==void 0||l.isMappingMany!==void 0||l.direction!=="LEFT"||l.entityOrProperty!==`${n}.${a.propertyPath}`)){i=!1,o=l.alias.name;break}const s=!!t.expressionMap.joinAttributes.find(l=>l.alias.name===o);i&&!s&&t.leftJoin(n+"."+a.propertyPath,o);let c=!0;for(const l of t.expressionMap.selects)if(!(l.aliasName!==void 0||l.virtual!==void 0||l.selection!==o)){c=!1;break}c&&t.addSelect(o),this.joinEagerRelations(t,o,a.inverseEntityMetadata)})}}class ij extends Jt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createSelectExpression(),t+=this.createJoinExpression(),t+=this.createWhereExpression(),t+=this.createGroupByExpression(),t+=this.createHavingExpression(),t+=this.createOrderByExpression(),t+=this.createLimitOffsetExpression(),t+=this.createLockExpression(),t=t.trim(),this.expressionMap.subQuery&&(t="("+t+")"),this.replacePropertyNamesForTheWholeQuery(t)}setFindOptions(t){return this.findOptions=t,this.applyFindOptions(),this}subQuery(){const t=this.createQueryBuilder();return t.expressionMap.subQuery=!0,t.parentQueryBuilder=this,t}select(t,n){if(this.expressionMap.queryType="select",Array.isArray(t))this.expressionMap.selects=t.map(r=>({selection:r}));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]);return this}addSelect(t,n){if(!t)return this;if(Array.isArray(t))this.expressionMap.selects=this.expressionMap.selects.concat(t.map(r=>({selection:r})));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&this.expressionMap.selects.push({selection:t,aliasName:n});return this}maxExecutionTime(t){return this.expressionMap.maxExecutionTime=t,this}distinct(t=!0){return this.expressionMap.selectDistinct=t,this}distinctOn(t){return this.expressionMap.selectDistinctOn=t,this}fromDummy(){return this.from(this.connection.driver.dummyTableName??"(SELECT 1 AS dummy_column)","dummy_table")}from(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}addFrom(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this}innerJoin(t,n,r,a){return this.join("INNER",t,n,r,a),this}leftJoin(t,n,r,a){return this.join("LEFT",t,n,r,a),this}innerJoinAndSelect(t,n,r,a){return this.addSelect(n),this.innerJoin(t,n,r,a),this}leftJoinAndSelect(t,n,r,a){return this.addSelect(n),this.leftJoin(t,n,r,a),this}innerJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!0),this}innerJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!1,i),this}leftJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!0),this}leftJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!1,i),this}loadRelationIdAndMap(t,n,r,a){const o=new ej(this.expressionMap);return o.mapToProperty=t,o.relationName=n,typeof r=="string"&&(o.alias=r),typeof r=="object"&&r.disableMixedMap&&(o.disableMixedMap=!0),o.queryBuilderFactory=a,this.expressionMap.relationIdAttributes.push(o),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(t,n,r,a){const o=new tj(this.expressionMap);return o.mapToProperty=t,o.relationName=n,o.alias=r,o.queryBuilderFactory=a,this.expressionMap.relationCountAttributes.push(o),this.expressionMap.createAlias({type:"other",name:o.junctionAlias}),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadAllRelationIds(t){return this.expressionMap.mainAlias.metadata.relations.forEach(n=>{t!==void 0&&t.relations!==void 0&&t.relations.indexOf(n.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+n.propertyPath,this.expressionMap.mainAlias.name+"."+n.propertyPath,t)}),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereExists(t){return this.where(...this.getExistsCondition(t))}andWhereExists(t){return this.andWhere(...this.getExistsCondition(t))}orWhereExists(t){return this.orWhere(...this.getExistsCondition(t))}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}having(t,n){return this.expressionMap.havings.push({type:"simple",condition:t}),n&&this.setParameters(n),this}andHaving(t,n){return this.expressionMap.havings.push({type:"and",condition:t}),n&&this.setParameters(n),this}orHaving(t,n){return this.expressionMap.havings.push({type:"or",condition:t}),n&&this.setParameters(n),this}groupBy(t){return t?this.expressionMap.groupBys=[t]:this.expressionMap.groupBys=[],this}addGroupBy(t){return this.expressionMap.groupBys.push(t),this}timeTravelQuery(t){return this.connection.driver.options.type==="cockroachdb"&&(t===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=t),this}orderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){if(this.expressionMap.limit=this.normalizeNumber(t),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new xe('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(t){if(this.expressionMap.offset=this.normalizeNumber(t),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new xe('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(t){if(this.expressionMap.take=this.normalizeNumber(t),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new xe('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(t){if(this.expressionMap.skip=this.normalizeNumber(t),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new xe('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(t){return this.expressionMap.useIndex=t,this}setLock(t,n,r){return this.expressionMap.lockMode=t,this.expressionMap.lockVersion=n,this.expressionMap.lockTables=r,this}setOnLocked(t){return this.expressionMap.onLocked=t,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if(this.expressionMap.lockMode==="optimistic")throw new Od;this.expressionMap.queryEntity=!1;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0);const r=await this.loadRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getRawAndEntities(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getOne(){const t=(await this.getRawAndEntities()).entities[0];if(t&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const n=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const r=n.updateDateColumn.getEntityValue(t);if(r.getTime()!==this.expressionMap.lockVersion.getTime())throw new DL(n.name,this.expressionMap.lockVersion,r)}else{const r=n.versionColumn.getEntityValue(t);if(r!==this.expressionMap.lockVersion)throw new DL(n.name,this.expressionMap.lockVersion,r)}}return t===void 0?null:t}async getOneOrFail(){const t=await this.getOne();if(!t)throw new Fde(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return t}async getMany(){if(this.expressionMap.lockMode==="optimistic")throw new Od;return(await this.getRawAndEntities()).entities}async getCount(){if(this.expressionMap.lockMode==="optimistic")throw new Od;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeCountQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getExists(){if(this.expressionMap.lockMode==="optimistic")throw new Od;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeExistsQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getManyAndCount(){if(this.expressionMap.lockMode==="optimistic")throw new Od;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);this.expressionMap.queryEntity=!1;const a=this.expressionMap.cacheId;this.expressionMap.cacheId=a&&`${a}-count`;const o=await this.executeCountQuery(t),i=[r.entities,o];return n&&await t.commitTransaction(),i}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async stream(){this.expressionMap.queryEntity=!1;const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0);const o=()=>{if(r!==this.queryRunner)return r.release()},i=r.stream(t,n,o,o);return a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}}cache(t,n){return typeof t=="boolean"?this.expressionMap.cache=t:typeof t=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=t):(typeof t=="string"||typeof t=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=t),n&&(this.expressionMap.cacheDuration=n),this}setOption(t){return this.expressionMap.options.push(t),this}join(t,n,r,a,o,i,s,c){o&&this.setParameters(o);const l=new YL(this.connection,this.expressionMap);l.direction=t,l.mapAsEntity=c,l.mapToProperty=i,l.isMappingMany=s,l.entityOrProperty=n,l.condition=a,this.expressionMap.joinAttributes.push(l);const u=l.metadata;if(u){if(u.deleteDateColumn&&!this.expressionMap.withDeleted){const d=`${r}.${u.deleteDateColumn.propertyName} IS NULL`;l.condition=l.condition?` ${l.condition} AND ${d}`:`${d}`}l.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:u}),l.relation&&l.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:l.junctionAlias,metadata:l.relation.junctionEntityMetadata})}else{let d="";if(typeof n=="function"){const f=n(this.subQuery());this.setParameters(f.getParameters()),d=f.getQuery()}else d=n;const p=typeof n=="function"||n.substr(0,1)==="("&&n.substr(-1)===")";l.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:p===!1?n:void 0,subQuery:p===!0?d:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new xe("Cannot build query because main alias is not set (call qb#from method)");const t=[],n=[];if(this.expressionMap.mainAlias.hasMetadata){const s=this.expressionMap.mainAlias.metadata;t.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,s)),n.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,s))}this.expressionMap.joinAttributes.forEach(s=>{if(s.metadata)t.push(...this.buildEscapedEntityColumnSelects(s.alias.name,s.metadata)),n.push(...this.findEntityColumnSelects(s.alias.name,s.metadata));else if(this.expressionMap.selects.some(c=>c.selection===s.alias.name)){t.push({selection:this.escape(s.alias.name)+".*"});const c=this.expressionMap.selects.find(l=>l.selection===s.alias.name);n.push(c)}}),this.expressionMap.selects.filter(s=>n.indexOf(s)===-1).forEach(s=>t.push({selection:this.replacePropertyNames(s.selection),aliasName:s.aliasName})),t.length===0&&t.push({selection:"*"});let r="";this.expressionMap.useIndex&&ve.isMySQLFamily(this.connection.driver)&&(r=` USE INDEX (${this.expressionMap.useIndex})`);const a=this.expressionMap.aliases.filter(s=>s.type==="from"&&(s.tablePath||s.subQuery)).map(s=>s.subQuery?s.subQuery+" "+this.escape(s.name):this.getTableName(s.tablePath)+" "+this.escape(s.name)),o=this.createSelectDistinctExpression(),i=t.map(s=>s.selection+(s.aliasName?" AS "+this.escape(s.aliasName):"")).join(", ");return o+i+" FROM "+a.join(", ")+this.createTableLockExpression()+r}createSelectDistinctExpression(){const{selectDistinct:t,selectDistinctOn:n,maxExecutionTime:r}=this.expressionMap,{driver:a}=this.connection;let o="SELECT ";return r>0&&ve.isMySQLFamily(a)&&(o+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),ve.isPostgresFamily(a)&&n.length>0?o=`SELECT DISTINCT ON (${n.map(i=>this.replacePropertyNames(i)).join(", ")}) `:t&&(o="SELECT DISTINCT "),o}createJoinExpression(){return this.expressionMap.joinAttributes.map(t=>{const n=t.relation,r=t.tablePath,a=t.alias.name;let o=t.condition?" AND ("+t.condition+")":"";const i=t.parentAlias;if(!i||!n){const s=t.alias.subQuery?t.alias.subQuery:this.getTableName(r);return" "+t.direction+" JOIN "+s+" "+this.escape(a)+this.createTableLockExpression()+(t.condition?" ON "+this.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){const s=n.joinColumns.map(c=>a+"."+c.referencedColumn.propertyPath+"="+i+"."+n.propertyPath+"."+c.referencedColumn.propertyPath).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else if(n.isOneToMany||n.isOneToOneNotOwner){const s=n.inverseRelation.joinColumns.map(c=>(n.inverseEntityMetadata.tableType==="entity-child"&&n.inverseEntityMetadata.discriminatorColumn&&(o+=" AND "+a+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),a+"."+n.inverseRelation.propertyPath+"."+c.referencedColumn.propertyPath+"="+i+"."+c.referencedColumn.propertyPath)).join(" AND ");if(!s)throw new xe(`Relation ${n.entityMetadata.name}.${n.propertyName} does not have join columns.`);return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else{const s=n.junctionEntityMetadata.tablePath,c=t.junctionAlias;let l="",u="";return n.isOwning?(l=n.joinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseJoinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND ")):(l=n.inverseRelation.inverseJoinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseRelation.joinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND "))," "+t.direction+" JOIN "+this.getTableName(s)+" "+this.escape(c)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l)+" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(u+o)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const t=this.expressionMap.allOrderBys;return Object.keys(t).length===0?"":" ORDER BY "+Object.keys(t).map(n=>{const r=typeof t[n]=="string"?t[n]:t[n].order+" "+t[n].nulls,a=this.expressionMap.selects.find(o=>o.selection===n);if(a&&!a.aliasName&&n.indexOf(".")!==-1){const o=n.split("."),i=o[0],s=o.slice(1).join("."),c=this.expressionMap.aliases.find(l=>l.name===i);if(c){const l=c.metadata.findColumnWithPropertyPath(s);if(l){const u=ve.buildAlias(this.connection.driver,void 0,i,l.databaseName);return this.escape(u)+" "+r}}}return this.replacePropertyNames(n)+" "+r}).join(", ")}createLimitOffsetExpression(){let t=this.expressionMap.offset,n=this.expressionMap.limit;if(!t&&!n&&this.expressionMap.joinAttributes.length===0&&(t=this.expressionMap.skip,n=this.expressionMap.take),this.connection.driver.options.type==="mssql"){let r="";if((n||t)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(r=" ORDER BY (SELECT NULL)"),n&&t)return r+" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return r+" OFFSET 0 ROWS FETCH NEXT "+n+" ROWS ONLY";if(t)return r+" OFFSET "+t+" ROWS"}else if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)throw new Hde}else if(ve.isSQLiteFamily(this.connection.driver)){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" LIMIT -1 OFFSET "+t}else if(this.connection.driver.options.type==="oracle"){if(n&&t)return" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return" FETCH NEXT "+n+" ROWS ONLY";if(t)return" OFFSET "+t+" ROWS"}else{if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" OFFSET "+t}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const t=this.connection.driver;let n="";if(this.expressionMap.lockTables){if(!(ve.isPostgresFamily(t)||t.options.type==="cockroachdb"))throw new xe("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new xe("lockTables cannot be an empty array");n=" OF "+this.expressionMap.lockTables.join(", ")}let r="";switch(this.expressionMap.onLocked==="nowait"?r=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(r=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(t.options.type==="mysql"||t.options.type==="aurora-mysql")return ve.isReleaseVersionOrGreater(t,"8.0.0")?" FOR SHARE"+n+r:" LOCK IN SHARE MODE";if(t.options.type==="mariadb")return" LOCK IN SHARE MODE";if(ve.isPostgresFamily(t))return" FOR SHARE"+n+r;if(t.options.type==="oracle")return" FOR UPDATE";if(t.options.type==="mssql")return"";throw new Pc;case"pessimistic_write":if(ve.isMySQLFamily(t)||t.options.type==="aurora-mysql"||t.options.type==="oracle")return" FOR UPDATE"+r;if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+r;if(t.options.type==="mssql")return"";throw new Pc;case"pessimistic_partial_write":if(ve.isPostgresFamily(t))return" FOR UPDATE"+n+" SKIP LOCKED";if(ve.isMySQLFamily(t))return" FOR UPDATE SKIP LOCKED";throw new Pc;case"pessimistic_write_or_fail":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+" NOWAIT";if(ve.isMySQLFamily(t))return" FOR UPDATE NOWAIT";throw new Pc;case"for_no_key_update":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+n+r;throw new Pc;case"for_key_share":if(ve.isPostgresFamily(t))return" FOR KEY SHARE"+n+r;throw new Pc;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const t=this.expressionMap.havings.map((n,r)=>{switch(n.type){case"and":return(r>0?"AND ":"")+this.replacePropertyNames(n.condition);case"or":return(r>0?"OR ":"")+this.replacePropertyNames(n.condition);default:return this.replacePropertyNames(n.condition)}}).join(" ");return t.length?" HAVING "+t:""}buildEscapedEntityColumnSelects(t,n){const r=this.expressionMap.selects.some(l=>l.selection===t),a=[];if(r&&a.push(...n.columns.filter(l=>l.isSelect===!0)),a.push(...n.columns.filter(l=>this.expressionMap.selects.some(u=>u.selection===t+"."+l.propertyPath))),a.length===0)return[];const o=this.expressionMap.queryEntity?n.primaryColumns.filter(l=>a.indexOf(l)===-1):[],i=[...a,...o],s=[],c=this.escape(t);return i.forEach(l=>{let u=c+"."+this.escape(l.databaseName);l.isVirtualProperty&&l.query&&(u=`(${l.query(c)})`),this.connection.driver.spatialTypes.indexOf(l.type)!==-1&&((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(u=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${u})`),ve.isPostgresFamily(this.connection.driver)&&(l.precision?u=`ST_AsGeoJSON(${u}, ${l.precision})::json`:u=`ST_AsGeoJSON(${u})::json`),this.connection.driver.options.type==="mssql"&&(u=`${u}.ToString()`));const d=this.expressionMap.selects.filter(p=>p.selection===t+"."+l.propertyPath);if(d.length)d.forEach(p=>{s.push({selection:u,aliasName:p.aliasName?p.aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:p.virtual})});else{if(l.isVirtualProperty)return;s.push({selection:u,aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:r})}}),s}findEntityColumnSelects(t,n){const r=this.expressionMap.selects.find(a=>a.selection===t);return r?[r]:this.expressionMap.selects.filter(a=>n.columns.some(o=>a.selection===t+"."+o.propertyPath))}computeCountExpression(){const t=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(t);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||ve.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+"))";if(ve.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const a=n.map(o=>`${r}.${this.escape(o.databaseName)}`).join(", '|;|', ");return n.length===1?`COUNT(DISTINCT(${a}))`:`COUNT(DISTINCT(CONCAT(${a})))`}return this.connection.driver.options.type==="spanner"?n.length===1?`COUNT(DISTINCT(${r}.${this.escape(n[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${n.map(a=>`CAST(${r}.${this.escape(a.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(" || '|;|' || ")+"))"}async executeCountQuery(t){const n=this.computeCountExpression(),r=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(n,"cnt").setOption("disable-global-order").loadRawResults(t);return!r||!r[0]||!r[0].cnt?0:parseInt(r[0].cnt)}async executeExistsQuery(t){return(await this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(t)).length>0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const t=Array.isArray(this.findOptions.select)?Nn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(t,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const t=Array.isArray(this.findOptions.relations)?Nn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(t=>{t.select&&!t.selection?t.type==="inner"?this.innerJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):t.type==="inner"?this.innerJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(t=>{this.leftJoin(this.findOptions.join.leftJoin[t],t)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(t=>{this.innerJoin(this.findOptions.join.innerJoin[t],t)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(t=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[t],t)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(t=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[t],t)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const t=this.findOptions.lock.tables?this.findOptions.lock.tables.map(n=>{const r=this.expressionMap.aliases.find(a=>a.metadata.tableNameWithoutPrefix===n);if(!r)throw new xe(`"${n}" is not part of this query`);return this.escape(r.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,t),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&oj.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(t){this.relationMetadatas.push(t)}async executeEntitiesAndRawResults(t){if(!this.expressionMap.mainAlias)throw new xe('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!t.isTransactionActive)throw new Wde;if(this.expressionMap.lockMode==="optimistic"){const i=this.expressionMap.mainAlias.metadata;if(!i.versionColumn&&!i.updateDateColumn)throw new zde(i.name)}const n=new mpe(this.connection,t,this.expressionMap.relationIdAttributes),r=new vpe(this.connection,t,this.expressionMap.relationCountAttributes);new gpe(this.expressionMap).transform(),new bpe(this.expressionMap).transform();let a=[],o=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[i,s]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),c=this.expressionMap.mainAlias.metadata,l=this.expressionMap.mainAlias.name,u=c.primaryColumns.map(f=>{const m=this.escape("distinctAlias"),y=this.escape(ve.buildAlias(this.connection.driver,void 0,l,f.databaseName));s[y]||(s[y]="ASC");const v=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,f.databaseName);return`${m}.${y} AS ${this.escape(v)}`}),d=this.clone(),p=d.expressionMap.timeTravel;if(a=await new ij(this.connection,t).select(`DISTINCT ${u.join(", ")}`).addSelect(i).from(`(${d.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(p).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(s).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),a.length>0){let f="";const m={};if(c.hasMultiplePrimaryKeys)f=a.map((y,v)=>c.primaryColumns.map(b=>{const w=`orm_distinct_ids_${v}_${b.databaseName}`,_=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,b.databaseName);return m[w]=y[_],`${l}.${b.propertyPath}=:${w}`}).join(" AND ")).join(" OR ");else{const y=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,c.primaryColumns[0].databaseName),v=a.map(b=>b[y]);v.every(b=>typeof b=="number")?f=`${l}.${c.primaryColumns[0].propertyPath} IN (${v.join(", ")})`:(m.orm_distinct_ids=v,f=l+"."+c.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}a=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:f}).setParameters(m).loadRawResults(t)}}else a=await this.loadRawResults(t);if(a.length>0){const i=await n.load(a),s=await r.load(a);o=new hpe(this.expressionMap,this.connection.driver,i,s,this.queryRunner).transform(a,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,o)}if(this.expressionMap.relationLoadStrategy==="query"){const i=new ype(this.connection,t);await Promise.all(this.relationMetadatas.map(async s=>{const c=s.inverseEntityMetadata.target,l=s.inverseEntityMetadata.targetName,u=Array.isArray(this.findOptions.select)?Nn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,d=Array.isArray(this.findOptions.relations)?Nn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,p=this.createQueryBuilder(t).select(l).from(c,l).setFindOptions({select:u?Nn.deepValue(u,s.propertyPath):void 0,order:this.findOptions.order?Nn.deepValue(this.findOptions.order,s.propertyPath):void 0,relations:d?Nn.deepValue(d,s.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(o.length>0){const f=await i.loadManyToManyRelationIdsAndGroup(s,o,void 0,p);o.forEach(m=>{const y=f.find(v=>v.entity===m);if(y){const v=y.related===void 0?null:y.related;s.setEntityValue(m,v)}})}}))}return{raw:a,entities:o}}createOrderByCombinedWithSelectExpression(t){const n=this.expressionMap.allOrderBys,r=Object.keys(n).map(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);return this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))}else return this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?this.escape(t)+"."+this.escape(o):""}).join(", "),a={};return Object.keys(n).forEach(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);a[this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))]=n[o]}else this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?a[this.escape(t)+"."+this.escape(o)]=n[o]:a[o]=n[o]}),[r,a]}async loadRawResults(t){const[n,r]=this.getQueryAndParameters(),a=n+" -- PARAMETERS: "+JSON.stringify(r,(u,d)=>typeof d=="bigint"?d.toString():d),o=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let i;const s=o.alwaysEnabled&&this.expressionMap.cache!==!1||this.expressionMap.cache===!0;let c=!1;if(this.connection.queryResultCache&&s)try{if(i=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:a,duration:this.expressionMap.cacheDuration||o.duration||1e3},t),i&&!this.connection.queryResultCache.isExpired(i))return JSON.parse(i.result)}catch(u){if(!o.ignoreErrors)throw u;c=!0}const l=await t.query(n,r,!0);if(!c&&this.connection.queryResultCache&&s)try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:a,time:new Date().getTime(),duration:this.expressionMap.cacheDuration||o.duration||1e3,result:JSON.stringify(l.records)},i,t)}catch(u){if(!o.ignoreErrors)throw u}return l.records}mergeExpressionMap(t){return an.assign(this.expressionMap,t),this}normalizeNumber(t){return typeof t=="number"||t===void 0||t===null?t:Number(t)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner(this.connection.defaultReplicationModeForReads())}buildSelect(t,n,r,a){for(let o in t){if(t[o]===void 0||t[o]===!1)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Ha(i,n);s?this.selects.push(r+"."+i):c&&this.buildSelect(t[o],n,r,i)}}buildRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Ha(c,r);if(l)this.buildRelations(s,typeof n=="object"?Nn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(u):(this.joins.push({type:"left",select:!0,selection:n&&typeof n[i]=="object"?n[i]:void 0,alias:d,parentAlias:a,relationMetadata:u}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d))),typeof s=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(s,typeof n=="object"?Nn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildEagerRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Ha(c,r);if(l)this.buildEagerRelations(s,typeof n=="object"?Nn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&u.inverseEntityMetadata.eagerRelations.forEach(p=>{let f=d+"_"+p.propertyPath.replace(".","_");f=ve.buildAlias(this.connection.driver,{joiner:"__"},d,f),this.joins.find(m=>m.alias===f)||this.joins.push({type:"left",select:!0,alias:f,parentAlias:d,selection:void 0,relationMetadata:p}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d)}),typeof s=="object"&&this.buildEagerRelations(s,typeof n=="object"?Nn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildOrder(t,n,r,a){for(let o in t){if(t[o]===void 0)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Ha(i,n);if(s){let u=typeof t[o]=="object"?t[o].direction:t[o];u=u==="DESC"||u==="desc"||u===-1?"DESC":"ASC";let d=typeof t[o]=="object"?t[o].nulls:void 0;d=(d==null?void 0:d.toLowerCase())==="first"?"NULLS FIRST":(d==null?void 0:d.toLowerCase())==="last"?"NULLS LAST":void 0;let p=`${r}.${i}`;this.addOrderBy(p,u,d)}else if(c)this.buildOrder(t[o],n,r,i);else if(l){let u=r+"_"+i.replace(".","_");u=ve.buildAlias(this.connection.driver,{joiner:"__"},r,u),this.joins.find(d=>d.alias===u)||this.joins.push({type:"left",select:!1,alias:u,parentAlias:r,selection:void 0,relationMetadata:l}),this.buildOrder(t[o],l.inverseEntityMetadata,u)}}}buildWhere(t,n,r,a){let o="";if(Array.isArray(t))t.length&&(o=t.map(i=>this.buildWhere(i,n,r,a)).filter(i=>!!i).map(i=>"("+i+")").join(" OR "));else{let i=[];for(let s in t){if(t[s]===void 0||t[s]===null)continue;const c=a?a+"."+s:s,l=n.findColumnWithPropertyPathStrict(c),u=n.findEmbeddedWithPropertyPath(c),d=n.findRelationWithPropertyPath(c);if(!u&&!l&&!d)throw new Ha(c,n);if(l){let p=`${r}.${c}`;l.isVirtualProperty&&l.query&&(p=`(${l.query(r)})`);let f=t[s];Pt.isEqualOperator(t[s])&&(f=t[s].value),l.transformer&&(f instanceof Cd?f.transformValue(l.transformer):f=rj.transformTo(l.transformer,f)),i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(p,f)))}else if(u){const p=this.buildWhere(t[s],n,r,c);p&&i.push(p)}else if(d){if(typeof t[s]=="object"&&Object.keys(t[s]).every(p=>t[s][p]===void 0))continue;if(Pt.isFindOperator(t[s]))if(t[s].type==="moreThan"||t[s].type==="lessThan"||t[s].type==="moreThanOrEqual"||t[s].type==="lessThanOrEqual"){let p="";t[s].type==="moreThan"?p=">":t[s].type==="lessThan"?p="<":t[s].type==="moreThanOrEqual"?p=">=":t[s].type==="lessThanOrEqual"&&(p="<=");const f=this.subQuery();if(d.isManyToManyOwner)f.select("COUNT(*)").from(d.joinTableName,d.joinTableName).where(d.joinColumns.map(m=>`${d.joinTableName}.${m.propertyName} = ${r}.${m.referencedColumn.propertyName}`).join(" AND "));else if(d.isManyToManyNotOwner)f.select("COUNT(*)").from(d.inverseRelation.joinTableName,d.inverseRelation.joinTableName).where(d.inverseRelation.inverseJoinColumns.map(m=>`${d.inverseRelation.joinTableName}.${m.propertyName} = ${r}.${m.referencedColumn.propertyName}`).join(" AND "));else if(d.isOneToMany)f.select("COUNT(*)").from(d.inverseEntityMetadata.target,d.inverseEntityMetadata.tableName).where(d.inverseRelation.joinColumns.map(m=>`${d.inverseEntityMetadata.tableName}.${m.propertyName} = ${r}.${m.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(f.getSql()+" "+p+" "+parseInt(t[s].value))}else if(d.isManyToOne||d.isOneToOne&&d.isOneToOneOwner){const p=`${r}.${c}`;i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(p,t[s])))}else throw new Error("This relation isn't supported by given find operator");else{let p=r+"_"+d.propertyPath.replace(".","_");p=ve.buildAlias(this.connection.driver,{joiner:"__"},r,p),this.joins.find(m=>m.alias===p)||this.joins.push({type:"left",select:!1,selection:void 0,alias:p,parentAlias:r,relationMetadata:d});const f=this.buildWhere(t[s],d.inverseEntityMetadata,p);f&&i.push(f)}}}o=i.length?"("+i.join(") AND (")+")":i.join(" AND ")}return o.length?"("+o+")":o}}class a6{constructor(){this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class wpe extends Jt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("SoftDeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createUpdateExpression();return t+=this.createCteExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("BeforeSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("BeforeRecover",this.expressionMap.mainAlias.metadata));const r=new aj(t,this.expressionMap);this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=r.getSoftDeletionReturningColumns());const[a,o]=this.getQueryAndParameters(),i=await t.query(a,o,!0),s=a6.from(i);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await r.update(s,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("AfterSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("AfterRecover",this.expressionMap.mainAlias.metadata)),n&&await t.commitTransaction(),s}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}from(t,n){t=Pt.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new jm;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!t)throw new xe(`Cannot get entity metadata for the given alias "${this.expressionMap.mainAlias}"`);if(!t.deleteDateColumn)throw new Bde(t);const n=[];switch(this.expressionMap.queryType){case"soft-delete":n.push(this.escape(t.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":n.push(this.escape(t.deleteDateColumn.databaseName)+" = NULL");break;default:throw new xe('The queryType must be "soft-delete" or "restore"')}if(t.versionColumn&&n.push(this.escape(t.versionColumn.databaseName)+" = "+this.escape(t.versionColumn.databaseName)+" + 1"),t.updateDateColumn&&n.push(this.escape(t.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),n.length<=0)throw new V_;const r=this.createWhereExpression(),a=this.createReturningExpression("update");return a===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")} OUTPUT ${a}${r}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r} RETURNING ${a}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver))return" LIMIT "+t;throw new LL}return""}}class xpe extends Jt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("UpdateQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createUpdateExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("BeforeUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet);let r=null,a=null;const o=new aj(t,this.expressionMap),i=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const p of this.expressionMap.returning)i.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(p));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=o.getUpdationReturningColumns(),i.push(...this.expressionMap.extraReturningColumns.filter(p=>!i.includes(p)))),i.length>0&&this.connection.driver.options.type==="mssql"&&(r=this.connection.driver.buildTableVariableDeclaration("@OutputTable",i),a="SELECT * FROM @OutputTable");const[s,c]=this.getQueryAndParameters(),l=[r,s,a],u=await t.query(l.filter(p=>p!=null).join(`;

`),c,!0),d=a6.from(u);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await o.update(d,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("AfterUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),n&&await t.commitTransaction(),d}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}set(t){return this.expressionMap.valuesSet=t,this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new jm;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.getValueSet(),n=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,r={};for(let c in t)t[c]!==void 0&&(r[c]=t[c]);const a=[],o=[];if(n?(this.createPropertyPath(n,r).forEach(c=>{const l=n.findColumnsWithPropertyPath(c);if(l.length<=0)throw new Ha(c,n);l.forEach(u=>{if(!u.isUpdate||o.includes(u))return;o.push(u);let d=u.getEntityValue(r);if(u.referencedColumn&&typeof d=="object"&&!(d instanceof Date)&&d!==null&&!En.isBuffer(d)?d=u.referencedColumn.getEntityValue(d):typeof d!="function"&&(d=this.connection.driver.preparePersistentValue(d,u)),typeof d=="function")a.push(this.escape(u.databaseName)+" = "+d());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&d===null)a.push(this.escape(u.databaseName)+" = NULL");else{this.connection.driver.options.type==="mssql"&&(d=this.connection.driver.parametrizeValue(u,d));const p=this.createParameter(d);let f=null;if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1){const m=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";u.srid!=null?f=`${m}(${p}, ${u.srid})`:f=`${m}(${p})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?u.srid!=null?f=`ST_SetSRID(ST_GeomFromGeoJSON(${p}), ${u.srid})::${u.type}`:f=`ST_GeomFromGeoJSON(${p})::${u.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?f=u.type+"::STGeomFromText("+p+", "+(u.srid||"0")+")":f=p;a.push(this.escape(u.databaseName)+" = "+f)}})}),(a.length>0||Object.keys(r).length===0)&&(n.versionColumn&&o.indexOf(n.versionColumn)===-1&&a.push(this.escape(n.versionColumn.databaseName)+" = "+this.escape(n.versionColumn.databaseName)+" + 1"),n.updateDateColumn&&o.indexOf(n.updateDateColumn)===-1&&a.push(this.escape(n.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"))):Object.keys(r).map(c=>{let l=r[c];if(typeof l=="function")a.push(this.escape(c)+" = "+l());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&l===null)a.push(this.escape(c)+" = NULL");else{const u=this.createParameter(l);a.push(this.escape(c)+" = "+u)}}),a.length<=0)throw new V_;const i=this.createWhereExpression(),s=this.createReturningExpression("update");return s===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")} OUTPUT ${s}${i}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i} RETURNING ${s}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")return" LIMIT "+t;throw new LL}return""}getValueSet(){if(typeof this.expressionMap.valuesSet=="object")return this.expressionMap.valuesSet;throw new V_}}function _pe(){Jt.registerQueryBuilderClass("DeleteQueryBuilder",e=>new ope(e)),Jt.registerQueryBuilderClass("InsertQueryBuilder",e=>new dpe(e)),Jt.registerQueryBuilderClass("RelationQueryBuilder",e=>new fpe(e)),Jt.registerQueryBuilderClass("SelectQueryBuilder",e=>new ij(e)),Jt.registerQueryBuilderClass("SoftDeleteQueryBuilder",e=>new wpe(e)),Jt.registerQueryBuilderClass("UpdateQueryBuilder",e=>new xpe(e))}var o6;(function(e){e.VIEW="VIEW",e.MATERIALIZED_VIEW="MATERIALIZED_VIEW",e.GENERATED_COLUMN="GENERATED_COLUMN"})(o6||(o6={}));var sj={exports:{}},cj,i6;function jpe(){if(i6)return cj;i6=1;var e=1e3,t=e*60,n=t*60,r=n*24,a=r*7,o=r*365.25;cj=function(u,d){d=d||{};var p=typeof u;if(p==="string"&&u.length>0)return i(u);if(p==="number"&&isFinite(u))return d.long?c(u):s(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function i(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var p=parseFloat(d[1]),f=(d[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return p*o;case"weeks":case"week":case"w":return p*a;case"days":case"day":case"d":return p*r;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*t;case"seconds":case"second":case"secs":case"sec":case"s":return p*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function s(u){var d=Math.abs(u);return d>=r?Math.round(u/r)+"d":d>=n?Math.round(u/n)+"h":d>=t?Math.round(u/t)+"m":d>=e?Math.round(u/e)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=r?l(u,d,r,"day"):d>=n?l(u,d,n,"hour"):d>=t?l(u,d,t,"minute"):d>=e?l(u,d,e,"second"):u+" ms"}function l(u,d,p,f){var m=d>=p*1.5;return Math.round(u/p)+" "+f+(m?"s":"")}return cj}var lj,s6;function Epe(){if(s6)return lj;s6=1;function e(t){r.debug=r,r.default=r,r.coerce=l,r.disable=i,r.enable=o,r.enabled=s,r.humanize=jpe(),r.destroy=u,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function n(d){let p=0;for(let f=0;f<d.length;f++)p=(p<<5)-p+d.charCodeAt(f),p|=0;return r.colors[Math.abs(p)%r.colors.length]}r.selectColor=n;function r(d){let p,f=null,m,y;function v(...b){if(!v.enabled)return;const w=v,_=Number(new Date),x=_-(p||_);w.diff=x,w.prev=p,w.curr=_,p=_,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let j=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(E,S)=>{if(E==="%%")return"%";j++;const O=r.formatters[S];if(typeof O=="function"){const N=b[j];E=O.call(w,N),b.splice(j,1),j--}return E}),r.formatArgs.call(w,b),(w.log||r.log).apply(w,b)}return v.namespace=d,v.useColors=r.useColors(),v.color=r.selectColor(d),v.extend=a,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(m!==r.namespaces&&(m=r.namespaces,y=r.enabled(d)),y),set:b=>{f=b}}),typeof r.init=="function"&&r.init(v),v}function a(d,p){const f=r(this.namespace+(typeof p>"u"?":":p)+d);return f.log=this.log,f}function o(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let p;const f=(typeof d=="string"?d:"").split(/[\s,]+/),m=f.length;for(p=0;p<m;p++)f[p]&&(d=f[p].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...r.names.map(c),...r.skips.map(c).map(p=>"-"+p)].join(",");return r.enable(""),d}function s(d){if(d[d.length-1]==="*")return!0;let p,f;for(p=0,f=r.skips.length;p<f;p++)if(r.skips[p].test(d))return!1;for(p=0,f=r.names.length;p<f;p++)if(r.names[p].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return lj=e,lj}var c6;function Spe(){return c6||(c6=1,function(e,t){var n={};t.formatArgs=a,t.save=o,t.load=i,t.useColors=r,t.storage=s(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,p=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(d++,f==="%c"&&(p=d))}),l.splice(p,0,u)}t.log=console.debug||console.log||(()=>{});function o(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function i(){let l;try{l=t.storage.getItem("debug")}catch{}return!l&&typeof Sn<"u"&&"env"in Sn&&(l=n.DEBUG),l}function s(){try{return localStorage}catch{}}e.exports=Epe()(t);const{formatters:c}=e.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(sj,sj.exports)),sj.exports}Spe(),_pe();const l6=(e,t)=>({id:e.id,type:e.node_type,position:{x:e.x||0,y:e.y||0},width:e.width||void 0,height:e.height||void 0,data:{loading:!1,flowNode:e,...t}}),Ope=e=>({id:e.id,target:e.target,source:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),u6=e=>({id:e.id,source:e.source,target:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),Cpe=e=>e.filter(t=>"edgeId"in t?`${t.edgeId}`.startsWith("xy-edge__"):!1),uj=(e,t,n)=>{const r=[];return{changes:e.map(a=>{var c;const o=t.find(l=>a.id===l.id);o||r.push(a.id);const i=(c=n==null?void 0:n[a.source_type])==null?void 0:c.find(l=>(l==null?void 0:l.id)===a.source_id),s=l6(a,{...o==null?void 0:o.data,entity:i});return{type:o?"replace":"add",id:a.id,item:o?_m({...o||{},data:void 0},rd(s,ad)):s}}),newIds:[]}},dj=(e,t)=>{const n=[],r=[],a=e.map(o=>{const i=t.find(s=>o.source===s.source&&o.target===s.target);return!i||i.id!==o.id?(i&&r.push(i.id),{type:"add",item:u6(o)}):(n.push(o.id),{type:"replace",item:u6(o)})});return t.forEach(o=>{n.includes(o.id)||r.push(o.id)}),{changes:a,updatedIds:n,deletedIds:r}},pj={width:440,height:360},Sm={width:380,height:650},wi={[ie.Toolbox]:"toolbox",[ie.SessionInfo]:"session-info",[ie.DefaultEmbeddingModel]:"default-embedding-model",[ie.ApplicationBar]:"application-bar"},Npe={id:wi[ie.Toolbox],type:ie.Toolbox,position:{x:10+Sm.width+20,y:10},measured:pj,data:{}},kpe={id:wi[ie.SessionInfo],type:ie.SessionInfo,position:{x:10,y:10},measured:Sm,data:{}},Mpe={id:wi[ie.DefaultEmbeddingModel],type:ie.DefaultEmbeddingModel,position:{x:10+Sm.width+pj.width+40,y:80},data:{model:UG}},Ape={id:wi[ie.ApplicationBar],type:ie.ApplicationBar,position:{x:10+Sm.width+pj.width+40,y:10},data:{}},Ppe=[Npe,kpe,Mpe,Ape],Tpe=[ie.Toolbox,ie.SessionInfo,ie.ApplicationBar,ie.EditorApp,ie.CodeContainerApp],d6={flowNodes:[],flowEdges:[],ready:!0,flowEdgeLoading:!1,flowNodeLoading:!1,syncedNodes:[],syncedEdges:[],syncNodeQueue:[],syncEdgeQueue:[],edges:[],nodes:Ppe},Om=async e=>{const t=await le("FlowNode").find(e),n=t.reduce((a,o)=>{var i;return a[o.source_type]||(a[o.source_type]=[]),(i=a[o.source_type])==null||i.push(o),a},{}),r={};return await Promise.all(Object.entries(n).map(async([a,o])=>{const i=a;r[i]=await le(i).find({where:{id:Ka(o.map(s=>s.source_id))}})})),{flowNodes:t,entityGroups:n,flowNodeDatas:r}},Ipe=(e,t)=>({reset:()=>{e(d6)},setNodes:n=>{if(typeof n=="function"){e({nodes:n(t().nodes)});return}e({nodes:n})},setEdges:n=>{if(typeof n=="function"){e({edges:n(t().edges)});return}e({edges:n})},updateNodes:n=>{const r=t().nodes;e({nodes:ps(n,r)})},updateEdges:n=>{const r=t().edges;e({edges:Ed(n,r)})},addConnectionToEdges:n=>{const r=t().edges;e({edges:r5(n,r)})},flowNodesToNodes:(n,r={})=>{const a=t().nodes,{changes:o}=uj(n,a,r);e({nodes:ps(o,a)})},flowEdgesToEdges:n=>{const r=t().edges,{changes:a,updatedIds:o,deletedIds:i}=dj(n,r);r.forEach(s=>{o.includes(s.id)||i.push(s.id)}),i.forEach(s=>{a.push({type:"remove",id:s})}),e({edges:Ed(a,r)})},getNodes:n=>t().nodes.filter(r=>n.includes(r.id)),removeSyncNodeQueue:n=>{const{syncNodeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncNodeQueue:r})},removeSyncEdgeQueue:n=>{const{syncEdgeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncEdgeQueue:r})},pushSyncNodeQueue:(n,r)=>{const{syncNodeQueue:a}=t();e({syncNodeQueue:[...a,{query:r,timestamp:Date.now(),syncType:n}]})},pushSyncEdgeQueue:()=>{const{syncEdgeQueue:n}=t();e({syncEdgeQueue:[...n,{timestamp:Date.now()}]})},findFlowNodesWithSource:async(n,r)=>{try{e({flowNodeLoading:!0});const{flowNodes:a,flowNodeDatas:o}=await Om(n);if(r!=null&&r.clean)e({flowNodes:a,nodes:a.map(i=>{var c;const s=(c=o==null?void 0:o[i.source_type])==null?void 0:c.find(l=>l.id===i.source_id);return l6(i,{data:s})})});else{const i=t().flowNodes,s=a.map(u=>u.id),c=t().nodes,{changes:l}=uj(a,c,o);e({flowNodes:[...i.filter(u=>!s.includes(u.id)),...a],nodes:ps(l,c)})}return a}finally{e({flowNodeLoading:!1})}},findFlowEdges:async(n,r)=>{try{e({flowEdgeLoading:!0});const a=await le("FlowEdge").find(n),o=t().flowEdges,i=a.map(s=>s.id);if(r!=null&&r.clean)e({flowEdges:a,edges:a.map(s=>Ope(s))});else{const s=t().edges,{changes:c}=dj(a,s);e({flowEdges:[...o.filter(l=>!i.includes(l.id)),...a],edges:Ed(c,s)})}return a}finally{e({flowEdgeLoading:!1})}},deleteFlowNode:async n=>{try{if(!n.id&&!n.source_type&&!n.source_id)throw new Error("Missing flow node indentify");const r=await le("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}});if(r){await le("FlowNode").delete(r.id);const a=t().flowNodes;r.source_type&&r.source_id&&await le(r.source_type).delete(r.source_id).catch(i=>{ni("Failed to delete source entity",r.source_type,r.source_id,i)});const o=t().nodes;e({flowNodes:a.filter(i=>i.id!==r.id),nodes:ps([{type:"remove",id:r.id}],o)})}}catch(r){ni("Failed to delete flow node",r)}},deleteFlowEdge:async n=>{try{if(!n.id&&!n.source&&!n.target)throw new Error("Missing flow edge indentify");const r=await le("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}});if(r){await le("FlowEdge").delete(r.id);const a=t().flowEdges;e({flowEdges:a.filter(o=>o.id!==r.id)})}}catch(r){ni("Failed to delete flow edge",r)}},updateFlowNode:async(n,r)=>{var a;try{if(!((a=Je.getState().currentSession)!=null&&a.id))throw new Error("Session not found");if(!n.id)throw new Error("Missing flow node indentify");await le("FlowNode").update(n.id,n);const o=t().flowNodes.map(i=>i.id===n.id?{...i,...n}:i);e({flowNodes:r!=null&&r.silent?o:[...o]})}catch(o){ni("Failed to create or update flow node",o,n)}},createOrUpdateFlowNode:async(n,r)=>{var a;try{const o=Je.getState().currentSession;if(!(o!=null&&o.id))throw new Error("Session not found");if(!n.id&&(!n.source_type||!n.source_id))throw new Error("Missing flow node indentify");let i,s=n!=null&&n.id?t().flowNodes.find(f=>f.id===n.id):void 0;if(!s&&(n.id||n.source_type&&n.source_id)&&(s=await le("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}})),s)i=_m(s,rd(n,ad)),r!=null&&r.lazy?le("FlowNode").update(s.id,i):await le("FlowNode").update(s.id,i);else if(n.source_id&&n.source_type)i={...n,source_id:`${n.source_id}`,source_type:`${n.source_type}`,node_type:n.node_type||"NEW_MESSAGE",session_id:n.session_id||(o==null?void 0:o.id)},r!=null&&r.lazy?(i.id=Hi(),le("FlowNode").save(i)):i=await le("FlowNode").save(i);else throw new Error("Missing source id and type");let c;const l=t().nodes.find(f=>f.id===i.id);i.source_type&&!l?c=await le(i.source_type).findOne({where:{id:n.source_id}}):i.source_type&&l&&(c=(a=l==null?void 0:l.data)==null?void 0:a.entity);const u=t().flowNodes,d=t().nodes,{changes:p}=uj([i],d,{[i.source_type]:[c]});return e({flowNodes:[...u.filter(f=>f.id!==i.id),i],nodes:ps(p,d)}),i}catch(o){ni("Failed to create or update flow node",o,n)}},createOrUpdateFlowEdge:async(n,r)=>{try{const a=Je.getState().currentSession;if(!(a!=null&&a.id))throw new Error("Session not found");if(!n.id&&(!n.source||!n.target))throw new Error("Missing flow node indentify");let o,i=n!=null&&n.id?t().flowEdges.find(l=>l.id===n.id):void 0;if(i&&(n.id||n.source&&n.target)&&(i=await le("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}})),i)o=_m(i,rd(n,ad)),r!=null&&r.lazy?le("FlowEdge").update(i.id,o):await le("FlowEdge").update(i.id,o);else if(n.source&&n.target)o={...n,source:`${n.source}`,target:`${n.target}`,session_id:n.session_id||(a==null?void 0:a.id)},r!=null&&r.lazy?(o.id=Hi(),le("FlowEdge").save(o)):o=await le("FlowEdge").save(o);else throw new Error("Missing source and target");const s=t().flowEdges,c=t().edges;return e({flowEdges:[...s.filter(l=>l.id!==o.id),o],edges:Ed(dj([o],c).changes,c)}),o}catch(a){ni("Failed to create or update flow node",a)}}}),Cm=()=>{const e=lo(t=>t.loadModel);return{loadModel:g.useCallback(async(t,...n)=>{switch(t){case Ve.WebLLM:return e(...n);default:return}},[e])}};var Rpe=Object.defineProperty,Dpe=Object.defineProperties,Lpe=Object.getOwnPropertyDescriptors,Nm=Object.getOwnPropertySymbols,p6=Object.prototype.hasOwnProperty,f6=Object.prototype.propertyIsEnumerable,h6=(e,t,n)=>t in e?Rpe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$pe=(e,t)=>{for(var n in t||(t={}))p6.call(t,n)&&h6(e,n,t[n]);if(Nm)for(var n of Nm(t))f6.call(t,n)&&h6(e,n,t[n]);return e},Fpe=(e,t)=>Dpe(e,Lpe(t)),Bpe=(e,t)=>{var n={};for(var r in e)p6.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Nm)for(var r of Nm(e))t.indexOf(r)<0&&f6.call(e,r)&&(n[r]=e[r]);return n};function zpe(e){let t=setTimeout(e,0),n=setTimeout(e,10),r=setTimeout(e,50);return[t,n,r]}function Upe(e){let t=g.useRef();return g.useEffect(()=>{t.current=e}),t.current}var Vpe=18,m6=40,Wpe=`${m6}px`,Hpe=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function qpe({containerRef:e,inputRef:t,pushPasswordManagerStrategy:n,isFocused:r}){let[a,o]=g.useState(!1),[i,s]=g.useState(!1),[c,l]=g.useState(!1),u=g.useMemo(()=>n==="none"?!1:(n==="increase-width"||n==="experimental-no-flickering")&&a&&i,[a,i,n]),d=g.useCallback(()=>{let p=e.current,f=t.current;if(!p||!f||c||n==="none")return;let m=p,y=m.getBoundingClientRect().left+m.offsetWidth,v=m.getBoundingClientRect().top+m.offsetHeight/2,b=y-Vpe,w=v;document.querySelectorAll(Hpe).length===0&&document.elementFromPoint(b,w)===p||(o(!0),l(!0))},[e,t,c,n]);return g.useEffect(()=>{let p=e.current;if(!p||n==="none")return;function f(){let y=window.innerWidth-p.getBoundingClientRect().right;s(y>=m6)}f();let m=setInterval(f,1e3);return()=>{clearInterval(m)}},[e,n]),g.useEffect(()=>{let p=r||document.activeElement===t.current;if(n==="none"||!p)return;let f=setTimeout(d,0),m=setTimeout(d,2e3),y=setTimeout(d,5e3),v=setTimeout(()=>{l(!0)},6e3);return()=>{clearTimeout(f),clearTimeout(m),clearTimeout(y),clearTimeout(v)}},[t,r,n,d]),{hasPWMBadge:a,willPushPWMBadge:u,PWM_BADGE_SPACE_WIDTH:Wpe}}var y6=g.createContext({}),g6=g.forwardRef((e,t)=>{var n=e,{value:r,onChange:a,maxLength:o,textAlign:i="left",pattern:s,placeholder:c,inputMode:l="numeric",onComplete:u,pushPasswordManagerStrategy:d="increase-width",pasteTransformer:p,containerClassName:f,noScriptCSSFallback:m=Kpe,render:y,children:v}=n,b=Bpe(n,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),w,_,x,j,E;let[S,O]=g.useState(typeof b.defaultValue=="string"?b.defaultValue:""),N=r??S,M=Upe(N),k=g.useCallback(ae=>{a==null||a(ae),O(ae)},[a]),A=g.useMemo(()=>s?typeof s=="string"?new RegExp(s):s:null,[s]),P=g.useRef(null),C=g.useRef(null),T=g.useRef({value:N,onChange:k,isIOS:typeof window<"u"&&((_=(w=window==null?void 0:window.CSS)==null?void 0:w.supports)==null?void 0:_.call(w,"-webkit-touch-callout","none"))}),I=g.useRef({prev:[(x=P.current)==null?void 0:x.selectionStart,(j=P.current)==null?void 0:j.selectionEnd,(E=P.current)==null?void 0:E.selectionDirection]});g.useImperativeHandle(t,()=>P.current,[]),g.useEffect(()=>{let ae=P.current,de=C.current;if(!ae||!de)return;T.current.value!==ae.value&&T.current.onChange(ae.value),I.current.prev=[ae.selectionStart,ae.selectionEnd,ae.selectionDirection];function je(){if(document.activeElement!==ae){$(null),F(null);return}let Ee=ae.selectionStart,We=ae.selectionEnd,qe=ae.selectionDirection,Ke=ae.maxLength,It=ae.value,lt=I.current.prev,it=-1,_t=-1,Qt;if(It.length!==0&&Ee!==null&&We!==null){let so=Ee===We,J=Ee===It.length&&It.length<Ke;if(so&&!J){let te=Ee;if(te===0)it=0,_t=1,Qt="forward";else if(te===Ke)it=te-1,_t=te,Qt="backward";else if(Ke>1&&It.length>1){let ce=0;if(lt[0]!==null&&lt[1]!==null){Qt=te<lt[1]?"backward":"forward";let me=lt[0]===lt[1]&&lt[0]<Ke;Qt==="backward"&&!me&&(ce=-1)}it=ce+te,_t=ce+te+1}}it!==-1&&_t!==-1&&it!==_t&&P.current.setSelectionRange(it,_t,Qt)}let cr=it!==-1?it:Ee,io=_t!==-1?_t:We,lr=Qt??qe;$(cr),F(io),I.current.prev=[cr,io,lr]}if(document.addEventListener("selectionchange",je,{capture:!0}),je(),document.activeElement===ae&&z(!0),!document.getElementById("input-otp-style")){let Ee=document.createElement("style");if(Ee.id="input-otp-style",document.head.appendChild(Ee),Ee.sheet){let We="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";Nd(Ee.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),Nd(Ee.sheet,`[data-input-otp]:autofill { ${We} }`),Nd(Ee.sheet,`[data-input-otp]:-webkit-autofill { ${We} }`),Nd(Ee.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),Nd(Ee.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let Le=()=>{de&&de.style.setProperty("--root-height",`${ae.clientHeight}px`)};Le();let $e=new ResizeObserver(Le);return $e.observe(ae),()=>{document.removeEventListener("selectionchange",je,{capture:!0}),$e.disconnect()}},[]);let[R,L]=g.useState(!1),[D,z]=g.useState(!1),[U,$]=g.useState(null),[V,F]=g.useState(null);g.useEffect(()=>{zpe(()=>{var ae,de,je,Le;(ae=P.current)==null||ae.dispatchEvent(new Event("input"));let $e=(de=P.current)==null?void 0:de.selectionStart,Ee=(je=P.current)==null?void 0:je.selectionEnd,We=(Le=P.current)==null?void 0:Le.selectionDirection;$e!==null&&Ee!==null&&($($e),F(Ee),I.current.prev=[$e,Ee,We])})},[N,D]),g.useEffect(()=>{M!==void 0&&N!==M&&M.length<o&&N.length===o&&(u==null||u(N))},[o,u,M,N]);let W=qpe({containerRef:C,inputRef:P,pushPasswordManagerStrategy:d,isFocused:D}),re=g.useCallback(ae=>{let de=ae.currentTarget.value.slice(0,o);if(de.length>0&&A&&!A.test(de)){ae.preventDefault();return}typeof M=="string"&&de.length<M.length&&document.dispatchEvent(new Event("selectionchange")),k(de)},[o,k,M,A]),ee=g.useCallback(()=>{var ae;if(P.current){let de=Math.min(P.current.value.length,o-1),je=P.current.value.length;(ae=P.current)==null||ae.setSelectionRange(de,je),$(de),F(je)}z(!0)},[o]),G=g.useCallback(ae=>{var de,je;let Le=P.current;if(!p&&(!T.current.isIOS||!ae.clipboardData||!Le))return;let $e=ae.clipboardData.getData("text/plain"),Ee=p?p($e):$e;ae.preventDefault();let We=(de=P.current)==null?void 0:de.selectionStart,qe=(je=P.current)==null?void 0:je.selectionEnd,Ke=(We!==qe?N.slice(0,We)+Ee+N.slice(qe):N.slice(0,We)+Ee+N.slice(We)).slice(0,o);if(Ke.length>0&&A&&!A.test(Ke))return;Le.value=Ke,k(Ke);let It=Math.min(Ke.length,o-1),lt=Ke.length;Le.setSelectionRange(It,lt),$(It),F(lt)},[o,k,A,N]),K=g.useMemo(()=>({position:"relative",cursor:b.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[b.disabled]),X=g.useMemo(()=>({position:"absolute",inset:0,width:W.willPushPWMBadge?`calc(100% + ${W.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:W.willPushPWMBadge?`inset(0 ${W.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:i,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[W.PWM_BADGE_SPACE_WIDTH,W.willPushPWMBadge,i]),ne=g.useMemo(()=>g.createElement("input",Fpe($pe({autoComplete:b.autoComplete||"one-time-code"},b),{"data-input-otp":!0,"data-input-otp-placeholder-shown":N.length===0||void 0,"data-input-otp-mss":U,"data-input-otp-mse":V,inputMode:l,pattern:A==null?void 0:A.source,"aria-placeholder":c,style:X,maxLength:o,value:N,ref:P,onPaste:ae=>{var de;G(ae),(de=b.onPaste)==null||de.call(b,ae)},onChange:re,onMouseOver:ae=>{var de;L(!0),(de=b.onMouseOver)==null||de.call(b,ae)},onMouseLeave:ae=>{var de;L(!1),(de=b.onMouseLeave)==null||de.call(b,ae)},onFocus:ae=>{var de;ee(),(de=b.onFocus)==null||de.call(b,ae)},onBlur:ae=>{var de;z(!1),(de=b.onBlur)==null||de.call(b,ae)}})),[re,ee,G,l,X,o,V,U,b,A==null?void 0:A.source,N]),B=g.useMemo(()=>({slots:Array.from({length:o}).map((ae,de)=>{var je;let Le=D&&U!==null&&V!==null&&(U===V&&de===U||de>=U&&de<V),$e=N[de]!==void 0?N[de]:null,Ee=N[0]!==void 0?null:(je=c==null?void 0:c[de])!=null?je:null;return{char:$e,placeholderChar:Ee,isActive:Le,hasFakeCaret:Le&&$e===null}}),isFocused:D,isHovering:!b.disabled&&R}),[D,R,o,V,U,b.disabled,N]),ue=g.useMemo(()=>y?y(B):g.createElement(y6.Provider,{value:B},v),[v,B,y]);return g.createElement(g.Fragment,null,m!==null&&g.createElement("noscript",null,g.createElement("style",null,m)),g.createElement("div",{ref:C,"data-input-otp-container":!0,style:K,className:f},ue,g.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},ne)))});g6.displayName="Input";function Nd(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var Kpe=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const fj=g.forwardRef(({className:e,containerClassName:t,...n},r)=>h.jsx(g6,{ref:r,containerClassName:Z("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:Z("disabled:cursor-not-allowed",e),...n}));fj.displayName="InputOTP";const kd=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex items-center",e),...t}));kd.displayName="InputOTPGroup";const xr=g.forwardRef(({index:e,className:t,hidden:n,...r},a)=>{const o=g.useContext(y6),{char:i,hasFakeCaret:s,isActive:c}=o.slots[e];return h.jsxs("div",{ref:a,className:Z("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",c&&"z-10 ring-2 ring-ring ring-offset-background",t),...r,children:[n&&i?h.jsx(nX,{}):i,s&&h.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});xr.displayName="InputOTPSlot";const hj=g.forwardRef(({...e},t)=>h.jsx("div",{ref:t,role:"separator",...e,children:h.jsx(nX,{})}));hj.displayName="InputOTPSeparator";const km=po(({onConfirm:e,onCancel:t})=>{const n=tn(),{t:r}=Me("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{(a==null?void 0:a.length)===6&&(await(e==null?void 0:e(a)),o(""),n.resolve(!0),n.hide())},c=async()=>{await(t==null?void 0:t()),o(""),n.resolve(!1),n.hide()};return h.jsx(hi,{open:n.visible,onOpenChange:c,children:h.jsxs(xo,{className:"w-[330px]",children:[h.jsxs(_o,{children:[h.jsx(jo,{children:r("session_passkey.title")}),h.jsx($u,{children:r("session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(fj,{onChange:i,maxLength:6,children:[h.jsxs(kd,{children:[h.jsx(xr,{index:0,hidden:!0}),h.jsx(xr,{index:1,hidden:!0}),h.jsx(xr,{index:2,hidden:!0})]}),h.jsx(hj,{}),h.jsxs(kd,{children:[h.jsx(xr,{index:3,hidden:!0}),h.jsx(xr,{index:4,hidden:!0}),h.jsx(xr,{index:5,hidden:!0})]})]})}),h.jsx(Lu,{children:h.jsx(Ye,{disabled:(a==null?void 0:a.length)!==6,onClick:s,type:"submit",children:r("session_passkey.confirm")})})]})})}),Md=e=>{const t=e.match(/.{1,2}/g);if(!t)throw new Error("Invalid hexString");return Uint8Array.from(t.map(n=>parseInt(n,16))).buffer},v6=e=>new TextEncoder().encode(e).buffer,Zpe=async e=>{const t=v6(e);return await crypto.subtle.digest("SHA-256",t)},mj=e=>[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join(""),Gpe=async()=>{const e=crypto.getRandomValues(new Uint8Array(32));return mj(e)},yj=async e=>{const t=await Zpe(e);return mj(t)},b6=async e=>(await yj(e)).substring(0,32),gj=async(e,t)=>{const n=await yj(t),r=await b6(t),a=v6(e),o=await Xpe(a,n,r);return mj(o)},Ad=async(e,t)=>{const n=await yj(t),r=await b6(t),a=Md(e),o=await Jpe(a,n,r);return new TextDecoder().decode(o)},Xpe=async(e,t,n)=>{const r=Md(n),a=Md(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.encrypt({name:"AES-CBC",iv:r},o,e)},Jpe=async(e,t,n)=>{const r=Md(n),a=Md(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.decrypt({name:"AES-CBC",iv:r},o,e)},Ype=async(e,t)=>{const n={};return await Promise.all(Object.entries(e||{}).map(async([r,a])=>{const o=await gj(a,t);n[r]=o})),n},vj=async(e,t)=>{let n;if(await new Promise((r,a)=>{t.show({onConfirm:async o=>{try{n=await Ad(e,o),await ai.set("passphrase",n),r(!0)}catch(i){a(i)}finally{t.hide()}},onCancel:()=>{a()}})}),!n)throw new Error("Passphrase is required");return n},Pd=e=>{const t=tn(e),n=g.useRef(t);return n.current=t,{modal:t,modalRef:n}},Qpe=()=>{var N,M;const[e,t]=g.useState(),[n,r]=g.useState(),[a,o]=g.useState(),[i,s]=g.useState(),[c,l]=g.useState([]),[u,d]=g.useState(),p=g.useRef(),f=g.useRef({}),m=Je(k=>k.currentSession),{loadModel:y}=Cm(),{modalRef:v}=Pd(km),b=g.useCallback(async k=>{var P;if(!m)return;const A=await le("JSONData").findOne({where:{id:k.source_id,session_id:m==null?void 0:m.id}});A&&((P=p.current)==null||P.call(p,A.data?A.data:[]),d({node:k,enity:A}))},[m]),w=g.useCallback(async k=>{var L;const A=(k==null?void 0:k.sessionId)||(m==null?void 0:m.id),P=(k==null?void 0:k.threadNode)||(a==null?void 0:a.threadNode),C=(k==null?void 0:k.prompts)||(e==null?void 0:e.prompts);if(!A||!(P!=null&&P.id))return;const T=C==null?void 0:C.map(D=>{if(D.type!=="few_shot_example")switch(D.role){case"ai":case"assistant":case"tool":return{id:D.id,content:D.content,role:"assistant"};case"system":return{id:D.id,content:D.content,role:"system"};default:return{id:D.id,content:D.content,role:"user"}}}).filter(Boolean),I=await le("JSONData").save({headers:"item",session_id:A,json:"",data:T});if(!I)return;const R=await le("FlowNode").save({session_id:A,source_id:I.id,source_type:"JSONData",node_type:"JSON_DATA",x:0,y:0});if(R)return await le("FlowEdge").save({session_id:A,source:P.id,target:R.id}),(L=p.current)==null||L.call(p,T),d({node:R,enity:I}),{jsonData:I,jsonDataNode:R}},[e==null?void 0:e.prompts,m==null?void 0:m.id,a==null?void 0:a.threadNode]),_=g.useCallback(async(k,A)=>{if(!m)return;const P=await le("FlowEdge").findOne({where:{session_id:m.id,source:k.id},order:{id:"DESC"}});if(P){const C=await le("FlowNode").findOne({where:{id:P.target,session_id:m.id}});if(!C)return;await b(C)}else if(!await w({sessionId:m.id,threadNode:k,prompts:A||[]}))return},[w,m,b]),x=g.useCallback(async k=>{if(k!=null&&k.length&&(m!=null&&m.id)){const A=(await Promise.all(k.map(async P=>le("FlowEdge").find({where:{target:P.source.id}}).then(C=>Om({where:{session_id:m.id,id:Ka(C.map(T=>T.source))}}).then(T=>({...T,...P})))))).map(P=>{var L,D,z,U;const C=P.flowNodes.find($=>$.source_type==="Prompt"),T=P.flowNodes.find($=>$.source_type==="VectorDatabase");if(!T||!C)return;const I=(D=(L=P.flowNodeDatas)==null?void 0:L.Prompt)==null?void 0:D.find($=>$.id===C.source_id),R=(U=(z=P.flowNodeDatas)==null?void 0:z.VectorDatabase)==null?void 0:U.find($=>$.id===T.source_id);return{promptNode:C,vectorDatabaseNode:T,placeholderNode:P.source,placeholderEntity:P.entity,promptEntity:I,vectorDatabaseEntity:R}}).filter(Boolean);l(A)}},[m==null?void 0:m.id]),j=g.useCallback(async()=>{try{if(f.current.handling=m==null?void 0:m.id,!(m!=null&&m.id)||!(m!=null&&m.main_source_id)||(m==null?void 0:m.main_source_type)!=="Thread")return;const[k,A]=await Promise.all([le("Thread").findOne({where:{id:m.main_source_id,session_id:m.id}}),le("FlowNode").findOne({where:{id:m.main_node_id}})]);if(!k||!A)return;const P=await le("FlowEdge").find({where:{session_id:m.id,target:A.id}}),{flowNodes:C,flowNodeDatas:T}=await Om({where:{session_id:m.id,id:Ka(P.map(F=>F.source))}}),I=(await le("FlowEdge").find({where:{session_id:m.id}})).filter(F=>F.target===A.id).map(F=>{var re;const W=C.find(ee=>ee.id===F.source);return{connection:F,source:W,entity:(re=T==null?void 0:T[W.source_type])==null?void 0:re.find(ee=>ee.id===W.source_id)}}),R=I.find(F=>F.source.source_type==="LLM"),L=I.filter(F=>F.source.source_type==="Prompt"),D=I.find(F=>F.source.source_type==="Schema"),z=R==null?void 0:R.entity;if(!z)return;m.passphrase&&await vj(m.passphrase,v.current);const U=I.filter(F=>F.source.source_type==="FlowNodePlaceholder");await x(U),await _(A,(L==null?void 0:L.map(F=>F.entity))||[]);const $=await le("FlowNode").findOne({where:{node_type:ie.DefaultEmbeddingModel,source_type:"FlowNodePlaceholder"}});if($){const F=await le("FlowNodePlaceholder").findOne({where:{id:$.source_id}});r({embedding:F})}s({llm:z,status:z.status||et.Started,progress:""}),o({thread:k,threadNode:A});const V=D==null?void 0:D.entity;if(V){const F=await le("SchemaItem").find({where:{schema_id:V.id}});V.schema_items=F||[]}t({prompts:(L==null?void 0:L.map(F=>F.entity))||[],schema:V}),f.current.handled=m.id}finally{f.current.handling=void 0}},[m==null?void 0:m.id,m==null?void 0:m.main_node_id,m==null?void 0:m.main_source_id,m==null?void 0:m.main_source_type,m==null?void 0:m.passphrase,x,_,v]),E=g.useCallback(async()=>{var k;if((k=i==null?void 0:i.llm)!=null&&k.name)try{s(A=>A&&{...A,status:et.Loading}),await y(i.llm.provider,i==null?void 0:i.llm.name,A=>{s(P=>P&&{...P,progress:A.text})}),s(A=>A&&{...A,status:et.Loaded,progress:""})}catch{s(A=>A&&{...A,status:et.Started,progress:""})}},[(N=i==null?void 0:i.llm)==null?void 0:N.name,(M=i==null?void 0:i.llm)==null?void 0:M.provider,y]),S=g.useCallback(k=>(p.current=k,()=>{p.current=void 0}),[]),O=g.useCallback(async k=>{!(u!=null&&u.node)||!(u!=null&&u.enity)||await le("JSONData").save({...u.enity,data:k})},[u==null?void 0:u.enity,u==null?void 0:u.node]);return g.useEffect(()=>{f.current.handling||(f==null?void 0:f.current.handled)===(m==null?void 0:m.id)||j()},[m==null?void 0:m.id,j]),{...e,loadLLM:E,threadInfo:a,mainLLMInfo:i,mainEmbeddingInfo:n,retriverInfo:c,currentDataNode:u,updateMessagesData:O,addNewDataNode:w,selectDataNode:b,setLLMInfo:s,onThreadMessagesLoaded:S}};class efe extends gf{get lc_attributes(){return{partialVariables:void 0}}constructor(t){super(t),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:n}=t;if(n.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,t)}async mergePartialAndUserVariables(t){const n=this.partialVariables??{},r={};for(const[a,o]of Object.entries(n))typeof o=="string"?r[a]=o:r[a]=await o();return{...r,...t}}async invoke(t,n){return this._callWithConfig(r=>this.formatPromptValue(r),t,{...n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(t){switch(t._type){case"prompt":{const{PromptTemplate:n}=await qt(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>A6);return{PromptTemplate:r}},[]);return n.deserialize(t)}case void 0:{const{PromptTemplate:n}=await qt(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>A6);return{PromptTemplate:r}},void 0);return n.deserialize({...t,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:n}=await qt(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot-CZwYL6L7.js").then(async a=>(await a.__tla,a));return{FewShotPromptTemplate:r}},__vite__mapDeps([0,1,2,3,4]));return n.deserialize(t)}default:throw new Error(`Invalid prompt type in config: ${t._type}`)}}}class w6 extends BDe{}class x6 extends w6{static lc_name(){return"StringPromptValue"}constructor(t){super({value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=t}toString(){return this.value}toChatMessages(){return[new Vr(this.value)]}}class tfe extends w6{static lc_name(){return"ChatPromptValue"}constructor(t){Array.isArray(t)&&(t={messages:t}),super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=t.messages}toString(){return zDe(this.messages)}toChatMessages(){return this.messages}}PM=class extends efe{async formatPromptValue(e){const t=await this.format(e);return new x6(t)}};var nfe=Object.prototype.toString,Rc=Array.isArray||function(e){return nfe.call(e)==="[object Array]"};function bj(e){return typeof e=="function"}function rfe(e){return Rc(e)?"array":typeof e}function wj(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function _6(e,t){return e!=null&&typeof e=="object"&&t in e}function afe(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var ofe=RegExp.prototype.test;function ife(e,t){return ofe.call(e,t)}var sfe=/\S/;function cfe(e){return!ife(sfe,e)}var lfe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function ufe(e){return String(e).replace(/[&<>"'`=\/]/g,function(t){return lfe[t]})}var dfe=/\s*/,pfe=/\s+/,j6=/\s*=/,ffe=/\s*\}/,hfe=/#|\^|\/|>|\{|&|=|!/;function mfe(e,t){if(!e)return[];var n=!1,r=[],a=[],o=[],i=!1,s=!1,c="",l=0;function u(){if(i&&!s)for(;o.length;)delete a[o.pop()];else o=[];i=!1,s=!1}var d,p,f;function m(O){if(typeof O=="string"&&(O=O.split(pfe,2)),!Rc(O)||O.length!==2)throw new Error("Invalid tags: "+O);d=new RegExp(wj(O[0])+"\\s*"),p=new RegExp("\\s*"+wj(O[1])),f=new RegExp("\\s*"+wj("}"+O[1]))}m(t||nr.tags);for(var y=new Td(e),v,b,w,_,x,j;!y.eos();){if(v=y.pos,w=y.scanUntil(d),w)for(var E=0,S=w.length;E<S;++E)_=w.charAt(E),cfe(_)?(o.push(a.length),c+=_):(s=!0,n=!0,c+=" "),a.push(["text",_,v,v+1]),v+=1,_===`
`&&(u(),c="",l=0,n=!1);if(!y.scan(d))break;if(i=!0,b=y.scan(hfe)||"name",y.scan(dfe),b==="="?(w=y.scanUntil(j6),y.scan(j6),y.scanUntil(p)):b==="{"?(w=y.scanUntil(f),y.scan(ffe),y.scanUntil(p),b="&"):w=y.scanUntil(p),!y.scan(p))throw new Error("Unclosed tag at "+y.pos);if(b==">"?x=[b,w,v,y.pos,c,l,n]:x=[b,w,v,y.pos],l++,a.push(x),b==="#"||b==="^")r.push(x);else if(b==="/"){if(j=r.pop(),!j)throw new Error('Unopened section "'+w+'" at '+v);if(j[1]!==w)throw new Error('Unclosed section "'+j[1]+'" at '+v)}else b==="name"||b==="{"||b==="&"?s=!0:b==="="&&m(w)}if(u(),j=r.pop(),j)throw new Error('Unclosed section "'+j[1]+'" at '+y.pos);return gfe(yfe(a))}function yfe(e){for(var t=[],n,r,a=0,o=e.length;a<o;++a)n=e[a],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function gfe(e){for(var t=[],n=t,r=[],a,o,i=0,s=e.length;i<s;++i)switch(a=e[i],a[0]){case"#":case"^":n.push(a),r.push(a),n=a[4]=[];break;case"/":o=r.pop(),o[5]=a[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(a)}return t}function Td(e){this.string=e,this.tail=e,this.pos=0}Td.prototype.eos=function(){return this.tail===""},Td.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},Td.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n};function Dc(e,t){this.view=e,this.cache={".":this.view},this.parent=t}Dc.prototype.push=function(e){return new Dc(e,this)},Dc.prototype.lookup=function(e){var t=this.cache,n;if(t.hasOwnProperty(e))n=t[e];else{for(var r=this,a,o,i,s=!1;r;){if(e.indexOf(".")>0)for(a=r.view,o=e.split("."),i=0;a!=null&&i<o.length;)i===o.length-1&&(s=_6(a,o[i])||afe(a,o[i])),a=a[o[i++]];else a=r.view[e],s=_6(r.view,e);if(s){n=a;break}r=r.parent}t[e]=n}return bj(n)&&(n=n.call(this.view)),n};function Zn(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Zn.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()},Zn.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||nr.tags).join(":"),a=typeof n<"u",o=a?n.get(r):void 0;return o==null&&(o=mfe(e,t),a&&n.set(r,o)),o},Zn.prototype.render=function(e,t,n,r){var a=this.getConfigTags(r),o=this.parse(e,a),i=t instanceof Dc?t:new Dc(t,void 0);return this.renderTokens(o,i,n,e,r)},Zn.prototype.renderTokens=function(e,t,n,r,a){for(var o="",i,s,c,l=0,u=e.length;l<u;++l)c=void 0,i=e[l],s=i[0],s==="#"?c=this.renderSection(i,t,n,r,a):s==="^"?c=this.renderInverted(i,t,n,r,a):s===">"?c=this.renderPartial(i,t,n,a):s==="&"?c=this.unescapedValue(i,t):s==="name"?c=this.escapedValue(i,t,a):s==="text"&&(c=this.rawValue(i)),c!==void 0&&(o+=c);return o},Zn.prototype.renderSection=function(e,t,n,r,a){var o=this,i="",s=t.lookup(e[1]);function c(d){return o.render(d,t,n,a)}if(s){if(Rc(s))for(var l=0,u=s.length;l<u;++l)i+=this.renderTokens(e[4],t.push(s[l]),n,r,a);else if(typeof s=="object"||typeof s=="string"||typeof s=="number")i+=this.renderTokens(e[4],t.push(s),n,r,a);else if(bj(s)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");s=s.call(t.view,r.slice(e[3],e[5]),c),s!=null&&(i+=s)}else i+=this.renderTokens(e[4],t,n,r,a);return i}},Zn.prototype.renderInverted=function(e,t,n,r,a){var o=t.lookup(e[1]);if(!o||Rc(o)&&o.length===0)return this.renderTokens(e[4],t,n,r,a)},Zn.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),a=e.split(`
`),o=0;o<a.length;o++)a[o].length&&(o>0||!n)&&(a[o]=r+a[o]);return a.join(`
`)},Zn.prototype.renderPartial=function(e,t,n,r){if(n){var a=this.getConfigTags(r),o=bj(n)?n(e[1]):n[e[1]];if(o!=null){var i=e[6],s=e[5],c=e[4],l=o;s==0&&c&&(l=this.indentPartial(o,c,i));var u=this.parse(l,a);return this.renderTokens(u,t,n,l,r)}}},Zn.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(n!=null)return n},Zn.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||nr.escape,a=t.lookup(e[1]);if(a!=null)return typeof a=="number"&&r===nr.escape?String(a):r(a)},Zn.prototype.rawValue=function(e){return e[1]},Zn.prototype.getConfigTags=function(e){return Rc(e)?e:e&&typeof e=="object"?e.tags:void 0},Zn.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!Rc(e))return e.escape};var nr={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){Id.templateCache=e},get templateCache(){return Id.templateCache}},Id=new Zn;nr.clearCache=function(){return Id.clearCache()},nr.parse=function(e,t){return Id.parse(e,t)},nr.render=function(e,t,n,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+rfe(e)+'" was given as the first argument for mustache#render(template, view, partials)');return Id.render(e,t,n,r)},nr.escape=ufe,nr.Scanner=Td,nr.Context=Dc,nr.Writer=Zn;function E6(){nr.escape=e=>e}let xj,S6,O6,C6,N6,Mm,k6,M6;xj=e=>{const t=e.split(""),n=[],r=(o,i)=>{for(let s=i;s<t.length;s+=1)if(o.includes(t[s]))return s;return-1};let a=0;for(;a<t.length;)if(t[a]==="{"&&a+1<t.length&&t[a+1]==="{")n.push({type:"literal",text:"{"}),a+=2;else if(t[a]==="}"&&a+1<t.length&&t[a+1]==="}")n.push({type:"literal",text:"}"}),a+=2;else if(t[a]==="{"){const o=r("}",a);if(o<0)throw new Error("Unclosed '{' in template.");n.push({type:"variable",name:t.slice(a+1,o).join("")}),a=o+1}else{if(t[a]==="}")throw new Error("Single '}' in template.");{const o=r("{}",a),i=(o<0?t.slice(a):t.slice(a,o)).join("");n.push({type:"literal",text:i}),a=o<0?t.length:o}}return n},S6=e=>e.map(t=>t[0]==="name"?{type:"variable",name:t[1].includes(".")?t[1].split(".")[0]:t[1]}:["#","&","^",">"].includes(t[0])?{type:"variable",name:t[1]}:{type:"literal",text:t[1]}),O6=e=>{E6();const t=nr.parse(e);return S6(t)},C6=(e,t)=>xj(e).reduce((n,r)=>{if(r.type==="variable"){if(r.name in t)return n+t[r.name];throw new Error(`(f-string) Missing value for input ${r.name}`)}return n+r.text},""),N6=(e,t)=>(E6(),nr.render(e,t)),Mm={"f-string":C6,mustache:N6},k6={"f-string":xj,mustache:O6},Xs=(e,t,n)=>Mm[t](e,n),M6=(e,t)=>k6[t](e),TM=(e,t,n)=>{if(!(t in Mm)){const r=Object.keys(Mm);throw new Error(`Invalid template format. Got \`${t}\`;
                         should be one of ${r}`)}try{const r=n.reduce((a,o)=>(a[o]="foo",a),{});Array.isArray(e)?e.forEach(a=>{if(a.type==="text")Xs(a.text,t,r);else if(a.type==="image_url")if(typeof a.image_url=="string")Xs(a.image_url,t,r);else{const o=a.image_url.url;Xs(o,t,r)}else throw new Error(`Invalid message template received. ${JSON.stringify(a,null,2)}`)}):Xs(e,t,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}},ii=class extends PM{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),TM(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return Xs(this.template,this.templateFormat,t)}static fromExamples(e,t,n,r=`

`,a=""){const o=[a,...e,t].join(r);return new ii({inputVariables:n,template:o})}static fromTemplate(e,t){const{templateFormat:n="f-string",...r}=t??{},a=new Set;return M6(e,n).forEach(o=>{o.type==="variable"&&a.add(o.name)}),new ii({inputVariables:[...a],templateFormat:n,template:e,...r})}async partial(e){const t=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new ii(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new ii({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}};const A6=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:ii},Symbol.toStringTag,{value:"Module"})),_j="RFC3986",jj={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},vfe="RFC1738",bfe=Array.isArray,Za=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),Ej=1024,wfe=(e,t,n,r,a)=>{if(e.length===0)return e;let o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(s){return"%26%23"+parseInt(s.slice(2),16)+"%3B"});let i="";for(let s=0;s<o.length;s+=Ej){const c=o.length>=Ej?o.slice(s,s+Ej):o,l=[];for(let u=0;u<c.length;++u){let d=c.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||a===vfe&&(d===40||d===41)){l[l.length]=c.charAt(u);continue}if(d<128){l[l.length]=Za[d];continue}if(d<2048){l[l.length]=Za[192|d>>6]+Za[128|d&63];continue}if(d<55296||d>=57344){l[l.length]=Za[224|d>>12]+Za[128|d>>6&63]+Za[128|d&63];continue}u+=1,d=65536+((d&1023)<<10|c.charCodeAt(u)&1023),l[l.length]=Za[240|d>>18]+Za[128|d>>12&63]+Za[128|d>>6&63]+Za[128|d&63]}i+=l.join("")}return i};function xfe(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function P6(e,t){if(bfe(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const _fe=Object.prototype.hasOwnProperty,T6={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},Ga=Array.isArray,jfe=Array.prototype.push,I6=function(e,t){jfe.apply(e,Ga(t)?t:[t])},Efe=Date.prototype.toISOString,pn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:wfe,encodeValuesOnly:!1,format:_j,formatter:jj[_j],indices:!1,serializeDate(e){return Efe.call(e)},skipNulls:!1,strictNullHandling:!1};function Sfe(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const Sj={};function R6(e,t,n,r,a,o,i,s,c,l,u,d,p,f,m,y,v,b){let w=e,_=b,x=0,j=!1;for(;(_=_.get(Sj))!==void 0&&!j;){const M=_.get(e);if(x+=1,typeof M<"u"){if(M===x)throw new RangeError("Cyclic object value");j=!0}typeof _.get(Sj)>"u"&&(x=0)}if(typeof l=="function"?w=l(t,w):w instanceof Date?w=p==null?void 0:p(w):n==="comma"&&Ga(w)&&(w=P6(w,function(M){return M instanceof Date?p==null?void 0:p(M):M})),w===null){if(o)return c&&!y?c(t,pn.encoder,v,"key",f):t;w=""}if(Sfe(w)||xfe(w)){if(c){const M=y?t:c(t,pn.encoder,v,"key",f);return[(m==null?void 0:m(M))+"="+(m==null?void 0:m(c(w,pn.encoder,v,"value",f)))]}return[(m==null?void 0:m(t))+"="+(m==null?void 0:m(String(w)))]}const E=[];if(typeof w>"u")return E;let S;if(n==="comma"&&Ga(w))y&&c&&(w=P6(w,c)),S=[{value:w.length>0?w.join(",")||null:void 0}];else if(Ga(l))S=l;else{const M=Object.keys(w);S=u?M.sort(u):M}const O=s?String(t).replace(/\./g,"%2E"):String(t),N=r&&Ga(w)&&w.length===1?O+"[]":O;if(a&&Ga(w)&&w.length===0)return N+"[]";for(let M=0;M<S.length;++M){const k=S[M],A=typeof k=="object"&&typeof k.value<"u"?k.value:w[k];if(i&&A===null)continue;const P=d&&s?k.replace(/\./g,"%2E"):k,C=Ga(w)?typeof n=="function"?n(N,P):N:N+(d?"."+P:"["+P+"]");b.set(e,x);const T=new WeakMap;T.set(Sj,b),I6(E,R6(A,C,n,r,a,o,i,s,n==="comma"&&y&&Ga(w)?null:c,l,u,d,p,f,m,y,v,T))}return E}function Ofe(e=pn){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||pn.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=_j;if(typeof e.format<"u"){if(!_fe.call(jj,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=jj[n];let a=pn.filter;(typeof e.filter=="function"||Ga(e.filter))&&(a=e.filter);let o;if(e.arrayFormat&&e.arrayFormat in T6?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=pn.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:pn.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:pn.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:pn.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:pn.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?pn.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:pn.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:pn.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:pn.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:pn.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:pn.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:pn.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:pn.strictNullHandling}}function Cfe(e,t={}){let n=e;const r=Ofe(t);let a,o;typeof r.filter=="function"?(o=r.filter,n=o("",n)):Ga(r.filter)&&(o=r.filter,a=o);const i=[];if(typeof n!="object"||n===null)return"";const s=T6[r.arrayFormat],c=s==="comma"&&r.commaRoundTrip;a||(a=Object.keys(n)),r.sort&&a.sort(r.sort);const l=new WeakMap;for(let p=0;p<a.length;++p){const f=a[p];r.skipNulls&&n[f]===null||I6(i,R6(n[f],f,s,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const u=i.join(r.delimiter);let d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const Lc="4.78.1";let D6=!1,Rd,L6,$6,Oj,F6,B6,z6,U6,V6;function Nfe(e,t={auto:!1}){if(D6)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(Rd)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${Rd}'\``);D6=t.auto,Rd=e.kind,L6=e.fetch,$6=e.FormData,Oj=e.File,F6=e.ReadableStream,B6=e.getMultipartRequestOptions,z6=e.getDefaultAgent,U6=e.fileFromPath,V6=e.isFsReadStream}let kfe=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function Mfe({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new kfe(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}Rd||Nfe(Mfe(),{auto:!0});class rt extends Error{}let rr=class WM extends rt{constructor(t,n,r,a){super(`${WM.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=n;const o=n;this.code=o==null?void 0:o.code,this.param=o==null?void 0:o.param,this.type=o==null?void 0:o.type}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t||!a)return new Am({message:r,cause:Mj(n)});const o=n==null?void 0:n.error;return t===400?new W6(t,o,r,a):t===401?new H6(t,o,r,a):t===403?new q6(t,o,r,a):t===404?new K6(t,o,r,a):t===409?new Z6(t,o,r,a):t===422?new G6(t,o,r,a):t===429?new X6(t,o,r,a):t>=500?new J6(t,o,r,a):new WM(t,o,r,a)}},Pr=class extends rr{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},Am=class extends rr{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},Pm=class extends Am{constructor({message:e}={}){super({message:e??"Request timed out."})}},W6=class extends rr{},H6=class extends rr{},q6=class extends rr{},K6=class extends rr{},Z6=class extends rr{},G6=class extends rr{},X6=class extends rr{},J6=class extends rr{};class Y6 extends rt{constructor(){super("Could not parse response content as the length limit was reached")}}class Q6 extends rt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}let Tm=class HM{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=HM.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(HM.NEWLINE_REGEXP);return r&&a.pop(),a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof En<"u"){if(t instanceof En)return t.toString();if(t instanceof Uint8Array)return En.from(t).toString();throw new rt(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new rt(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new rt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}};Tm.NEWLINE_CHARS=new Set([`
`,"\r"]),Tm.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let Dd=class Cf{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const i of Afe(t,n))if(!o){if(i.data.startsWith("[DONE]")){o=!0;continue}if(i.event===null){let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(s&&s.error)throw new rr(void 0,s.error,void 0,void 0);yield s}else{let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new rr(void 0,s.error,s.message,void 0);yield{event:i.event,data:s}}}o=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{o||n.abort()}}return new Cf(a,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new Tm,s=e$(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new Cf(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new Cf(()=>a(t),this.controller),new Cf(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new F6({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}};async function*Afe(e,t){if(!e.body)throw t.abort(),new rt("Attempted to iterate over a response with no body");const n=new Ife,r=new Tm,a=e$(e.body);for await(const o of Pfe(a))for(const i of r.decode(o)){const s=n.decode(i);s&&(yield s)}for(const o of r.flush()){const i=n.decode(o);i&&(yield i)}}async function*Pfe(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let a=new Uint8Array(t.length+r.length);a.set(t),a.set(r,t.length),t=a;let o;for(;(o=Tfe(t))!==-1;)yield t.slice(0,o),t=t.slice(o)}t.length>0&&(yield t)}function Tfe(e){for(let t=0;t<e.length-2;t++){if(e[t]===10&&e[t+1]===10||e[t]===13&&e[t+1]===13)return t+2;if(e[t]===13&&e[t+1]===10&&t+3<e.length&&e[t+2]===13&&e[t+3]===10)return t+4}return-1}let Ife=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=Rfe(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}};function Rfe(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function e$(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const t$=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",n$=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Im(e),Im=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",Dfe=e=>n$(e)||t$(e)||V6(e);async function r$(e,t,n){var a;if(e=await e,n$(e))return e;if(t$(e)){const o=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=Im(o)?[await o.arrayBuffer()]:[o];return new Oj(i,t,n)}const r=await Lfe(e);if(t||(t=Ffe(e)??"unknown_file"),!(n!=null&&n.type)){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new Oj(r,t,n)}async function Lfe(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Im(e))t.push(await e.arrayBuffer());else if(Bfe(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${$fe(e)}`);return t}function $fe(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function Ffe(e){var t;return Cj(e.name)||Cj(e.filename)||((t=Cj(e.path))==null?void 0:t.split(/[\\/]/).pop())}const Cj=e=>{if(typeof e=="string")return e;if(typeof En<"u"&&e instanceof En)return String(e)},Bfe=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",a$=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",$c=async e=>{const t=await zfe(e.body);return B6(t,e)},zfe=async e=>{const t=new $6;return await Promise.all(Object.entries(e||{}).map(([n,r])=>Nj(t,n,r))),t},Nj=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(Dfe(n)){const r=await r$(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>Nj(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>Nj(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Fc={},Ufe=function(e,t,n,r,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n},Vfe=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Rm;async function o$(e){const{response:t}=e;if(e.options.stream)return Bc("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Dd.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return Bc("response",t.status,t.url,t.headers,a),i$(a,t)}const r=await t.text();return Bc("response",t.status,t.url,t.headers,r),r}function i$(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}let s$=class dX extends Promise{constructor(t,n=o$){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new dX(this.responsePromise,async n=>i$(t(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}},Wfe=class{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:a}){this.baseURL=e,this.maxRetries=kj("maxRetries",t),this.timeout=kj("timeout",n),this.httpAgent=r,this.fetch=a??L6}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Xfe(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${ehe()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async r=>{const a=r&&Im(r==null?void 0:r.body)?new DataView(await r.body.arrayBuffer()):(r==null?void 0:r.body)instanceof DataView?r.body:(r==null?void 0:r.body)instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r==null?void 0:r.body)?new DataView(r.body.buffer):r==null?void 0:r.body;return{method:e,path:t,...r,body:a}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof En<"u")return En.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var f;const{method:n,path:r,query:a,headers:o={}}=e,i=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:a$(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,s=this.calculateContentLength(i),c=this.buildURL(r,a);"timeout"in e&&kj("timeout",e.timeout);const l=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??z6(c),d=l+1e3;typeof((f=u==null?void 0:u.options)==null?void 0:f.timeout)=="number"&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const p=this.buildHeaders({options:e,headers:o,contentLength:s,retryCount:t});return{req:{method:n,...i&&{body:i},headers:p,...u&&{agent:u},signal:e.signal??null},url:c,timeout:l}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const a={};n&&(a["content-length"]=n);const o=this.defaultHeaders(e);return h$(a,o),h$(a,t),a$(e.body)&&Rd!=="node"&&delete a["content-type"],m$(o,"x-stainless-retry-count")===void 0&&m$(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(r)),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,r){return rr.generate(e,t,n,r)}request(e,t=null){return new s$(this.makeRequest(e,t))}async makeRequest(e,t){var u,d;const n=await e,r=n.maxRetries??this.maxRetries;t==null&&(t=r),await this.prepareOptions(n);const{req:a,url:o,timeout:i}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(a,{url:o,options:n}),Bc("request",o,n,a.headers),(u=n.signal)==null?void 0:u.aborted)throw new Pr;const s=new AbortController,c=await this.fetchWithTimeout(o,a,i,s).catch(Mj);if(c instanceof Error){if((d=n.signal)!=null&&d.aborted)throw new Pr;if(t)return this.retryRequest(n,t);throw c.name==="AbortError"?new Pm:new Am({cause:c})}const l=qfe(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const y=`retrying, ${t} attempts remaining`;return Bc(`response (error; ${y})`,c.status,o,l),this.retryRequest(n,t,l)}const p=await c.text().catch(y=>Mj(y).message),f=Jfe(p),m=f?void 0:p;throw Bc(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,l,m),this.makeStatusError(c.status,f,m,l)}return{response:c,options:n,controller:s}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new Hfe(this,n,e)}buildURL(e,t){const n=Qfe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return p$(r)||(t={...r,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new rt(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:a,...o}=t||{};a&&a.addEventListener("abort",()=>r.abort());const i=setTimeout(()=>r.abort(),n),s={signal:r.signal,...o};return s.method&&(s.method=s.method.toUpperCase()),this.fetch.call(void 0,e,s).finally(()=>{clearTimeout(i)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let r;const a=n==null?void 0:n["retry-after-ms"];if(a){const i=parseFloat(a);Number.isNaN(i)||(r=i)}const o=n==null?void 0:n["retry-after"];if(o&&!r){const i=parseFloat(o);Number.isNaN(i)?r=Date.parse(o)-Date.now():r=i*1e3}if(!(r&&0<=r&&r<60*1e3)){const i=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,i)}return await Ld(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e,r=Math.min(.5*Math.pow(2,n),8),a=1-Math.random()*.25;return r*a*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Lc}`}};class c${constructor(t,n,r,a){Rm.set(this,void 0),Ufe(this,Rm,t),this.options=a,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new rt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in t&&typeof n.query=="object")n.query={...n.query,...t.params};else if("url"in t){const r=[...Object.entries(n.query||{}),...t.url.searchParams.entries()];for(const[a,o]of r)t.url.searchParams.set(a,o);n.query=void 0,n.path=t.url.toString()}return await Vfe(this,Rm,"f").requestAPIList(this.constructor,n)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(Rm=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}let Hfe=class extends s${constructor(e,t,n){super(t,async r=>new n(e,r.response,await o$(r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}};const qfe=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),Kfe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ar=e=>typeof e=="object"&&e!==null&&!p$(e)&&Object.keys(e).every(t=>f$(Kfe,t)),Zfe=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Lc,"X-Stainless-OS":u$(Deno.build.os),"X-Stainless-Arch":l$(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Lc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":Sn.version};if(Object.prototype.toString.call(typeof Sn<"u"?Sn:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Lc,"X-Stainless-OS":u$(Sn.platform),"X-Stainless-Arch":l$(Sn.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":Sn.version};const e=Gfe();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Lc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Lc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Gfe(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const l$=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",u$=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let d$;const Xfe=()=>d$??(d$=Zfe()),Jfe=e=>{try{return JSON.parse(e)}catch{return}},Yfe=/^[a-z][a-z0-9+.-]*:/i,Qfe=e=>Yfe.test(e),Ld=e=>new Promise(t=>setTimeout(t,e)),kj=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new rt(`${e} must be an integer`);if(t<0)throw new rt(`${e} must be a positive integer`);return t},Mj=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},Dm=e=>{var t,n,r,a;if(typeof Sn<"u")return((t=Fc==null?void 0:Fc[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function p$(e){if(!e)return!0;for(const t in e)return!1;return!0}function f$(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function h$(e,t){for(const n in t){if(!f$(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function Bc(e,...t){typeof Sn<"u"&&(Fc==null?void 0:Fc.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${e}`,...t)}const ehe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),the=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",nhe=e=>typeof(e==null?void 0:e.get)=="function",m$=(e,t)=>{var r;const n=t.toLowerCase();if(nhe(e)){const a=((r=t[0])==null?void 0:r.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(o,i,s)=>i+s.toUpperCase());for(const o of[t,n,t.toUpperCase(),a]){const i=e.get(o);if(i)return i}}for(const[a,o]of Object.entries(e))if(a.toLowerCase()===n)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${t} header, using the first entry.`),o[0]):o};function Aj(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class rhe extends c${constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class ia extends c${constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const n=Object.fromEntries(t.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const t=this.getPaginatedItems();if(!t.length)return null;const n=(r=t[t.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}let mt=class{constructor(e){this._client=e}},y$=class extends mt{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},Pj=class extends mt{constructor(){super(...arguments),this.completions=new y$(this._client)}};Pj.Completions=y$;class g$ extends mt{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}let v$=class extends mt{create(e,t){return this._client.post("/audio/transcriptions",$c({body:e,...t}))}},b$=class extends mt{create(e,t){return this._client.post("/audio/translations",$c({body:e,...t}))}},$d=class extends mt{constructor(){super(...arguments),this.transcriptions=new v$(this._client),this.translations=new b$(this._client),this.speech=new g$(this._client)}};$d.Transcriptions=v$,$d.Translations=b$,$d.Speech=g$;class Tj extends mt{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(`/batches/${t}`,n)}list(t={},n){return ar(t)?this.list({},t):this._client.getAPIList("/batches",Ij,{query:t,...n})}cancel(t,n){return this._client.post(`/batches/${t}/cancel`,n)}}class Ij extends ia{}Tj.BatchesPage=Ij;class Rj extends mt{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/assistants/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return ar(t)?this.list({},t):this._client.getAPIList("/assistants",Dj,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Dj extends ia{}Rj.AssistantsPage=Dj;function w$(e){return typeof e.parse=="function"}const zc=e=>(e==null?void 0:e.role)==="assistant",x$=e=>(e==null?void 0:e.role)==="function",_$=e=>(e==null?void 0:e.role)==="tool";var sa=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Zt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Lj,Lm,$m,Fd,Bd,Fm,zd,$o,Ud,Bm,zm,Uc,j$;class E${constructor(){Lj.add(this),this.controller=new AbortController,Lm.set(this,void 0),$m.set(this,()=>{}),Fd.set(this,()=>{}),Bd.set(this,void 0),Fm.set(this,()=>{}),zd.set(this,()=>{}),$o.set(this,{}),Ud.set(this,!1),Bm.set(this,!1),zm.set(this,!1),Uc.set(this,!1),sa(this,Lm,new Promise((t,n)=>{sa(this,$m,t,"f"),sa(this,Fd,n,"f")}),"f"),sa(this,Bd,new Promise((t,n)=>{sa(this,Fm,t,"f"),sa(this,zd,n,"f")}),"f"),Zt(this,Lm,"f").catch(()=>{}),Zt(this,Bd,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},Zt(this,Lj,"m",j$).bind(this))},0)}_connected(){this.ended||(Zt(this,$m,"f").call(this),this._emit("connect"))}get ended(){return Zt(this,Ud,"f")}get errored(){return Zt(this,Bm,"f")}get aborted(){return Zt(this,zm,"f")}abort(){this.controller.abort()}on(t,n){return(Zt(this,$o,"f")[t]||(Zt(this,$o,"f")[t]=[])).push({listener:n}),this}off(t,n){const r=Zt(this,$o,"f")[t];if(!r)return this;const a=r.findIndex(o=>o.listener===n);return a>=0&&r.splice(a,1),this}once(t,n){return(Zt(this,$o,"f")[t]||(Zt(this,$o,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,r)=>{sa(this,Uc,!0,"f"),t!=="error"&&this.once("error",r),this.once(t,n)})}async done(){sa(this,Uc,!0,"f"),await Zt(this,Bd,"f")}_emit(t,...n){if(Zt(this,Ud,"f"))return;t==="end"&&(sa(this,Ud,!0,"f"),Zt(this,Fm,"f").call(this));const r=Zt(this,$o,"f")[t];if(r&&(Zt(this,$o,"f")[t]=r.filter(a=>!a.once),r.forEach(({listener:a})=>a(...n))),t==="abort"){const a=n[0];!Zt(this,Uc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Zt(this,Fd,"f").call(this,a),Zt(this,zd,"f").call(this,a),this._emit("end");return}if(t==="error"){const a=n[0];!Zt(this,Uc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Zt(this,Fd,"f").call(this,a),Zt(this,zd,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Lm=new WeakMap,$m=new WeakMap,Fd=new WeakMap,Bd=new WeakMap,Fm=new WeakMap,zd=new WeakMap,$o=new WeakMap,Ud=new WeakMap,Bm=new WeakMap,zm=new WeakMap,Uc=new WeakMap,Lj=new WeakSet,j$=function(e){if(sa(this,Bm,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Pr),e instanceof Pr)return sa(this,zm,!0,"f"),this._emit("abort",e);if(e instanceof rt)return this._emit("error",e);if(e instanceof Error){const t=new rt(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new rt(String(e)))};function ahe(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function S$(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function ohe(e,{parser:t,callback:n}){const r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function Vd(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function ihe(e,t){return!t||!O$(t)?{...e,choices:e.choices.map(n=>({...n,message:{...n.message,parsed:null,tool_calls:n.message.tool_calls??[]}}))}:$j(e,t)}function $j(e,t){const n=e.choices.map(r=>{var a;if(r.finish_reason==="length")throw new Y6;if(r.finish_reason==="content_filter")throw new Q6;return{...r,message:{...r.message,tool_calls:((a=r.message.tool_calls)==null?void 0:a.map(o=>che(t,o)))??[],parsed:r.message.content&&!r.message.refusal?she(t,r.message.content):null}}});return{...e,choices:n}}function she(e,t){var n,r;return((n=e.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=e.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function che(e,t){var r;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:Vd(n)?n.$parseRaw(t.function.arguments):n!=null&&n.function.strict?JSON.parse(t.function.arguments):null}}}function lhe(e,t){var r;if(!e)return!1;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return Vd(n)||(n==null?void 0:n.function.strict)||!1}function O$(e){var t;return S$(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(n=>Vd(n)||n.type==="function"&&n.function.strict===!0))??!1}function uhe(e){for(const t of e??[]){if(t.type!=="function")throw new rt(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new rt(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var or=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Ln,Fj,Um,Bj,zj,Uj,C$,Vj;const N$=10;class k$ extends E${constructor(){super(...arguments),Ln.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var r;this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=(r=t.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),(x$(t)||_$(t))&&t.content)this._emit("functionCallResult",t.content);else if(zc(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(zc(t)&&t.tool_calls)for(const r of t.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new rt("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),or(this,Ln,"m",Fj).call(this)}async finalMessage(){return await this.done(),or(this,Ln,"m",Um).call(this)}async finalFunctionCall(){return await this.done(),or(this,Ln,"m",Bj).call(this)}async finalFunctionCallResult(){return await this.done(),or(this,Ln,"m",zj).call(this)}async totalUsage(){return await this.done(),or(this,Ln,"m",Uj).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=or(this,Ln,"m",Um).call(this);n&&this._emit("finalMessage",n);const r=or(this,Ln,"m",Fj).call(this);r&&this._emit("finalContent",r);const a=or(this,Ln,"m",Bj).call(this);a&&this._emit("finalFunctionCall",a);const o=or(this,Ln,"m",zj).call(this);o!=null&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",or(this,Ln,"m",Uj).call(this))}async _createChatCompletion(t,n,r){const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),or(this,Ln,"m",C$).call(this,n);const o=await t.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion($j(o,n))}async _runChatCompletion(t,n,r){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(t,n,r)}async _runFunctions(t,n,r){var p;const a="function",{function_call:o="auto",stream:i,...s}=n,c=typeof o!="string"&&(o==null?void 0:o.name),{maxChatCompletions:l=N$}=r||{},u={};for(const f of n.functions)u[f.name||f.function.name]=f;const d=n.functions.map(f=>({name:f.name||f.function.name,parameters:f.parameters,description:f.description}));for(const f of n.messages)this._addMessage(f,!1);for(let f=0;f<l;++f){const m=(p=(await this._createChatCompletion(t,{...s,function_call:o,functions:d,messages:[...this.messages]},r)).choices[0])==null?void 0:p.message;if(!m)throw new rt("missing message in ChatCompletion response");if(!m.function_call)return;const{name:y,arguments:v}=m.function_call,b=u[y];if(b){if(c&&c!==y){const j=`Invalid function_call: ${JSON.stringify(y)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,name:y,content:j});continue}}else{const j=`Invalid function_call: ${JSON.stringify(y)}. Available options are: ${d.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:y,content:j});continue}let w;try{w=w$(b)?await b.parse(v):v}catch(j){this._addMessage({role:a,name:y,content:j instanceof Error?j.message:String(j)});continue}const _=await b.function(w,this),x=or(this,Ln,"m",Vj).call(this,_);if(this._addMessage({role:a,name:y,content:x}),c)return}}async _runTools(t,n,r){var f,m,y;const a="tool",{tool_choice:o="auto",stream:i,...s}=n,c=typeof o!="string"&&((f=o==null?void 0:o.function)==null?void 0:f.name),{maxChatCompletions:l=N$}=r||{},u=n.tools.map(v=>{if(Vd(v)){if(!v.$callback)throw new rt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),d={};for(const v of u)v.type==="function"&&(d[v.function.name||v.function.function.name]=v.function);const p="tools"in n?u.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<l;++v){const b=(m=(await this._createChatCompletion(t,{...s,tool_choice:o,tools:p,messages:[...this.messages]},r)).choices[0])==null?void 0:m.message;if(!b)throw new rt("missing message in ChatCompletion response");if(!((y=b.tool_calls)!=null&&y.length))return;for(const w of b.tool_calls){if(w.type!=="function")continue;const _=w.id,{name:x,arguments:j}=w.function,E=d[x];if(E){if(c&&c!==x){const M=`Invalid tool_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:_,content:M});continue}}else{const M=`Invalid tool_call: ${JSON.stringify(x)}. Available options are: ${Object.keys(d).map(k=>JSON.stringify(k)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:_,content:M});continue}let S;try{S=w$(E)?await E.parse(j):j}catch(M){const k=M instanceof Error?M.message:String(M);this._addMessage({role:a,tool_call_id:_,content:k});continue}const O=await E.function(S,this),N=or(this,Ln,"m",Vj).call(this,O);if(this._addMessage({role:a,tool_call_id:_,content:N}),c)return}}}}Ln=new WeakSet,Fj=function(){return or(this,Ln,"m",Um).call(this).content??null},Um=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(zc(t)){const{function_call:n,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new rt("stream ended without producing a ChatCompletionMessage with role=assistant")},Bj=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(zc(r)&&(r!=null&&r.function_call))return r.function_call;if(zc(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},zj=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(x$(t)&&t.content!=null||_$(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},Uj=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},C$=function(e){if(e.n!=null&&e.n>1)throw new rt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Vj=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Wd extends k${static runFunctions(t,n,r){const a=new Wd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new Wd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}_addMessage(t,n=!0){super._addMessage(t,n),zc(t)&&t.content&&this._emit("content",t.content)}}const M$=1,A$=2,P$=4,T$=8,I$=16,R$=32,D$=64,L$=128,$$=256,F$=L$|$$,B$=I$|R$|F$|D$,z$=M$|A$|B$,U$=P$|T$,dhe=z$|U$,vn={STR:M$,NUM:A$,ARR:P$,OBJ:T$,NULL:I$,BOOL:R$,NAN:D$,INFINITY:L$,MINUS_INFINITY:$$,INF:F$,SPECIAL:B$,ATOM:z$,COLLECTION:U$,ALL:dhe};class phe extends Error{}class fhe extends Error{}function hhe(e,t=vn.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return mhe(e.trim(),t)}const mhe=(e,t)=>{const n=e.length;let r=0;const a=p=>{throw new phe(`${p} at position ${r}`)},o=p=>{throw new fhe(`${p} at position ${r}`)},i=()=>(d(),r>=n&&a("Unexpected end of input"),e[r]==='"'?s():e[r]==="{"?c():e[r]==="["?l():e.substring(r,r+4)==="null"||vn.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):e.substring(r,r+4)==="true"||vn.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):e.substring(r,r+5)==="false"||vn.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):e.substring(r,r+8)==="Infinity"||vn.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):e.substring(r,r+9)==="-Infinity"||vn.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):e.substring(r,r+3)==="NaN"||vn.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),s=()=>{const p=r;let f=!1;for(r++;r<n&&(e[r]!=='"'||f&&e[r-1]==="\\");)f=e[r]==="\\"?!f:!1,r++;if(e.charAt(r)=='"')try{return JSON.parse(e.substring(p,++r-Number(f)))}catch(m){o(String(m))}else if(vn.STR&t)try{return JSON.parse(e.substring(p,r-Number(f))+'"')}catch{return JSON.parse(e.substring(p,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{r++,d();const p={};try{for(;e[r]!=="}";){if(d(),r>=n&&vn.OBJ&t)return p;const f=s();d(),r++;try{const m=i();Object.defineProperty(p,f,{value:m,writable:!0,enumerable:!0,configurable:!0})}catch(m){if(vn.OBJ&t)return p;throw m}d(),e[r]===","&&r++}}catch{if(vn.OBJ&t)return p;a("Expected '}' at end of object")}return r++,p},l=()=>{r++;const p=[];try{for(;e[r]!=="]";)p.push(i()),d(),e[r]===","&&r++}catch{if(vn.ARR&t)return p;a("Expected ']' at end of array")}return r++,p},u=()=>{if(r===0){e==="-"&&vn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(f){if(vn.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}o(String(f))}}const p=r;for(e[r]==="-"&&r++;e[r]&&!",]}".includes(e[r]);)r++;r==n&&!(vn.NUM&t)&&a("Unterminated number literal");try{return JSON.parse(e.substring(p,r))}catch{e.substring(p,r)==="-"&&vn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e.substring(p,e.lastIndexOf("e")))}catch(f){o(String(f))}}},d=()=>{for(;r<n&&` 
\r	`.includes(e[r]);)r++};return i()},V$=e=>hhe(e,vn.ALL^vn.NUM);var Vc=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Mt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},fn,Fo,Wc,xi,Wj,Vm,Hj,qj,Kj,Wm,Zj,W$;class Hd extends k${constructor(t){super(),fn.add(this),Fo.set(this,void 0),Wc.set(this,void 0),xi.set(this,void 0),Vc(this,Fo,t,"f"),Vc(this,Wc,[],"f")}get currentChatCompletionSnapshot(){return Mt(this,xi,"f")}static fromReadableStream(t){const n=new Hd(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,r){const a=new Hd(n);return a._run(()=>a._runChatCompletion(t,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(t,n,r){var i;super._createChatCompletion;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Mt(this,fn,"m",Wj).call(this);const o=await t.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const s of o)Mt(this,fn,"m",Hj).call(this,s);if((i=o.controller.signal)!=null&&i.aborted)throw new Pr;return this._addChatCompletion(Mt(this,fn,"m",Wm).call(this))}async _fromReadableStream(t,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Mt(this,fn,"m",Wj).call(this),this._connected();const a=Dd.fromReadableStream(t,this.controller);let o;for await(const s of a)o&&o!==s.id&&this._addChatCompletion(Mt(this,fn,"m",Wm).call(this)),Mt(this,fn,"m",Hj).call(this,s),o=s.id;if((i=a.controller.signal)!=null&&i.aborted)throw new Pr;return this._addChatCompletion(Mt(this,fn,"m",Wm).call(this))}[(Fo=new WeakMap,Wc=new WeakMap,xi=new WeakMap,fn=new WeakSet,Wj=function(){this.ended||Vc(this,xi,void 0,"f")},Vm=function(t){let n=Mt(this,Wc,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Mt(this,Wc,"f")[t.index]=n,n)},Hj=function(t){var r,a,o,i,s,c,l,u,d,p,f,m,y,v,b;if(this.ended)return;const n=Mt(this,fn,"m",W$).call(this,t);this._emit("chunk",t,n);for(const w of t.choices){const _=n.choices[w.index];w.delta.content!=null&&((r=_.message)==null?void 0:r.role)==="assistant"&&((a=_.message)!=null&&a.content)&&(this._emit("content",w.delta.content,_.message.content),this._emit("content.delta",{delta:w.delta.content,snapshot:_.message.content,parsed:_.message.parsed})),w.delta.refusal!=null&&((o=_.message)==null?void 0:o.role)==="assistant"&&((i=_.message)!=null&&i.refusal)&&this._emit("refusal.delta",{delta:w.delta.refusal,snapshot:_.message.refusal}),((s=w.logprobs)==null?void 0:s.content)!=null&&((c=_.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(l=w.logprobs)==null?void 0:l.content,snapshot:((u=_.logprobs)==null?void 0:u.content)??[]}),((d=w.logprobs)==null?void 0:d.refusal)!=null&&((p=_.message)==null?void 0:p.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(f=w.logprobs)==null?void 0:f.refusal,snapshot:((m=_.logprobs)==null?void 0:m.refusal)??[]});const x=Mt(this,fn,"m",Vm).call(this,_);_.finish_reason&&(Mt(this,fn,"m",Kj).call(this,_),x.current_tool_call_index!=null&&Mt(this,fn,"m",qj).call(this,_,x.current_tool_call_index));for(const j of w.delta.tool_calls??[])x.current_tool_call_index!==j.index&&(Mt(this,fn,"m",Kj).call(this,_),x.current_tool_call_index!=null&&Mt(this,fn,"m",qj).call(this,_,x.current_tool_call_index)),x.current_tool_call_index=j.index;for(const j of w.delta.tool_calls??[]){const E=(y=_.message.tool_calls)==null?void 0:y[j.index];E!=null&&E.type&&((E==null?void 0:E.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=E.function)==null?void 0:v.name,index:j.index,arguments:E.function.arguments,parsed_arguments:E.function.parsed_arguments,arguments_delta:((b=j.function)==null?void 0:b.arguments)??""}):E==null||E.type)}}},qj=function(t,n){var a,o,i;if(Mt(this,fn,"m",Vm).call(this,t).done_tool_calls.has(n))return;const r=(a=t.message.tool_calls)==null?void 0:a[n];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const s=(i=(o=Mt(this,Fo,"f"))==null?void 0:o.tools)==null?void 0:i.find(c=>c.type==="function"&&c.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:n,arguments:r.function.arguments,parsed_arguments:Vd(s)?s.$parseRaw(r.function.arguments):s!=null&&s.function.strict?JSON.parse(r.function.arguments):null})}else r.type},Kj=function(t){var r,a;const n=Mt(this,fn,"m",Vm).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const o=Mt(this,fn,"m",Zj).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Wm=function(){if(this.ended)throw new rt("stream has ended, this shouldn't happen");const t=Mt(this,xi,"f");if(!t)throw new rt("request ended without sending any chunks");return Vc(this,xi,void 0,"f"),Vc(this,Wc,[],"f"),yhe(t,Mt(this,Fo,"f"))},Zj=function(){var n;const t=(n=Mt(this,Fo,"f"))==null?void 0:n.response_format;return S$(t)?t:null},W$=function(t){var n,r,a,o;let i=Mt(this,xi,"f");const{choices:s,...c}=t;i?Object.assign(i,c):i=Vc(this,xi,{...c,choices:[]},"f");for(const{delta:l,finish_reason:u,index:d,logprobs:p=null,...f}of t.choices){let m=i.choices[d];if(m||(m=i.choices[d]={finish_reason:u,index:d,message:{},logprobs:p,...f}),p)if(!m.logprobs)m.logprobs=Object.assign({},p);else{const{content:j,refusal:E,...S}=p;Object.assign(m.logprobs,S),j&&((n=m.logprobs).content??(n.content=[]),m.logprobs.content.push(...j)),E&&((r=m.logprobs).refusal??(r.refusal=[]),m.logprobs.refusal.push(...E))}if(u&&(m.finish_reason=u,Mt(this,Fo,"f")&&O$(Mt(this,Fo,"f")))){if(u==="length")throw new Y6;if(u==="content_filter")throw new Q6}if(Object.assign(m,f),!l)continue;const{content:y,refusal:v,function_call:b,role:w,tool_calls:_,...x}=l;if(Object.assign(m.message,x),v&&(m.message.refusal=(m.message.refusal||"")+v),w&&(m.message.role=w),b&&(m.message.function_call?(b.name&&(m.message.function_call.name=b.name),b.arguments&&((a=m.message.function_call).arguments??(a.arguments=""),m.message.function_call.arguments+=b.arguments)):m.message.function_call=b),y&&(m.message.content=(m.message.content||"")+y,!m.message.refusal&&Mt(this,fn,"m",Zj).call(this)&&(m.message.parsed=V$(m.message.content))),_){m.message.tool_calls||(m.message.tool_calls=[]);for(const{index:j,id:E,type:S,function:O,...N}of _){const M=(o=m.message.tool_calls)[j]??(o[j]={});Object.assign(M,N),E&&(M.id=E),S&&(M.type=S),O&&(M.function??(M.function={name:O.name??"",arguments:""})),O!=null&&O.name&&(M.function.name=O.name),O!=null&&O.arguments&&(M.function.arguments+=O.arguments,lhe(Mt(this,Fo,"f"),M)&&(M.function.parsed_arguments=V$(M.function.arguments)))}}}return i},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("chunk",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Dd(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function yhe(e,t){const{id:n,choices:r,created:a,model:o,system_fingerprint:i,...s}=e,c={...s,id:n,choices:r.map(({message:l,finish_reason:u,index:d,logprobs:p,...f})=>{if(!u)throw new rt(`missing finish_reason for choice ${d}`);const{content:m=null,function_call:y,tool_calls:v,...b}=l,w=l.role;if(!w)throw new rt(`missing role for choice ${d}`);if(y){const{arguments:_,name:x}=y;if(_==null)throw new rt(`missing function_call.arguments for choice ${d}`);if(!x)throw new rt(`missing function_call.name for choice ${d}`);return{...f,message:{content:m,function_call:{arguments:_,name:x},role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:p}}return v?{...f,index:d,finish_reason:u,logprobs:p,message:{...b,role:w,content:m,refusal:l.refusal??null,tool_calls:v.map((_,x)=>{const{function:j,type:E,id:S,...O}=_,{arguments:N,name:M,...k}=j||{};if(S==null)throw new rt(`missing choices[${d}].tool_calls[${x}].id
${Hm(e)}`);if(E==null)throw new rt(`missing choices[${d}].tool_calls[${x}].type
${Hm(e)}`);if(M==null)throw new rt(`missing choices[${d}].tool_calls[${x}].function.name
${Hm(e)}`);if(N==null)throw new rt(`missing choices[${d}].tool_calls[${x}].function.arguments
${Hm(e)}`);return{...O,id:S,type:E,function:{...k,name:M,arguments:N}}})}}:{...f,message:{...b,content:m,role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:p}}),created:a,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return ihe(c,t)}function Hm(e){return JSON.stringify(e)}class Hc extends Hd{static fromReadableStream(t){const n=new Hc(null);return n._run(()=>n._fromReadableStream(t)),n}static runFunctions(t,n,r){const a=new Hc(null),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new Hc(n),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}}let H$=class extends mt{parse(e,t){return uhe(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>$j(n,e))}runFunctions(e,t){return e.stream?Hc.runFunctions(this._client,e,t):Wd.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Hc.runTools(this._client,e,t):Wd.runTools(this._client,e,t)}stream(e,t){return Hd.createChatCompletion(this._client,e,t)}},Gj=class extends mt{constructor(){super(...arguments),this.completions=new H$(this._client)}};(function(e){e.Completions=H$})(Gj||(Gj={}));class q$ extends mt{create(t,n){return this._client.post("/realtime/sessions",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Xj extends mt{constructor(){super(...arguments),this.sessions=new q$(this._client)}}Xj.Sessions=q$;var Re=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},_r=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},kn,Jj,Xa,qm,ca,ms,qc,ys,Km,jr,Zm,Gm,qd,Kd,Zd,K$,Z$,G$,X$,J$,Y$,Q$;class la extends E${constructor(){super(...arguments),kn.add(this),Jj.set(this,[]),Xa.set(this,{}),qm.set(this,{}),ca.set(this,void 0),ms.set(this,void 0),qc.set(this,void 0),ys.set(this,void 0),Km.set(this,void 0),jr.set(this,void 0),Zm.set(this,void 0),Gm.set(this,void 0),qd.set(this,void 0)}[(Jj=new WeakMap,Xa=new WeakMap,qm=new WeakMap,ca=new WeakMap,ms=new WeakMap,qc=new WeakMap,ys=new WeakMap,Km=new WeakMap,jr=new WeakMap,Zm=new WeakMap,Gm=new WeakMap,qd=new WeakMap,kn=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("event",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new la;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Dd.fromReadableStream(t,this.controller);for await(const i of a)Re(this,kn,"m",Kd).call(this,i);if((o=a.controller.signal)!=null&&o.aborted)throw new Pr;return this._addRun(Re(this,kn,"m",Zd).call(this))}toReadableStream(){return new Dd(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,r,a,o){const i=new la;return i._run(()=>i._runToolAssistantStream(t,n,r,a,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(t,n,r,a,o){var l;const i=o==null?void 0:o.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...a,stream:!0},c=await t.submitToolOutputs(n,r,s,{...o,signal:this.controller.signal});this._connected();for await(const u of c)Re(this,kn,"m",Kd).call(this,u);if((l=c.controller.signal)!=null&&l.aborted)throw new Pr;return this._addRun(Re(this,kn,"m",Zd).call(this))}static createThreadAssistantStream(t,n,r){const a=new la;return a._run(()=>a._threadAssistantStream(t,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(t,n,r,a){const o=new la;return o._run(()=>o._runAssistantStream(t,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return Re(this,Zm,"f")}currentRun(){return Re(this,Gm,"f")}currentMessageSnapshot(){return Re(this,ca,"f")}currentRunStepSnapshot(){return Re(this,qd,"f")}async finalRunSteps(){return await this.done(),Object.values(Re(this,Xa,"f"))}async finalMessages(){return await this.done(),Object.values(Re(this,qm,"f"))}async finalRun(){if(await this.done(),!Re(this,ms,"f"))throw Error("Final run was not received.");return Re(this,ms,"f")}async _createThreadAssistantStream(t,n,r){var s;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},i=await t.createAndRun(o,{...r,signal:this.controller.signal});this._connected();for await(const c of i)Re(this,kn,"m",Kd).call(this,c);if((s=i.controller.signal)!=null&&s.aborted)throw new Pr;return this._addRun(Re(this,kn,"m",Zd).call(this))}async _createAssistantStream(t,n,r,a){var c;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},s=await t.create(n,i,{...a,signal:this.controller.signal});this._connected();for await(const l of s)Re(this,kn,"m",Kd).call(this,l);if((c=s.controller.signal)!=null&&c.aborted)throw new Pr;return this._addRun(Re(this,kn,"m",Zd).call(this))}static accumulateDelta(t,n){for(const[r,a]of Object.entries(n)){if(!t.hasOwnProperty(r)){t[r]=a;continue}let o=t[r];if(o==null){t[r]=a;continue}if(r==="index"||r==="type"){t[r]=a;continue}if(typeof o=="string"&&typeof a=="string")o+=a;else if(typeof o=="number"&&typeof a=="number")o+=a;else if(Aj(o)&&Aj(a))o=this.accumulateDelta(o,a);else if(Array.isArray(o)&&Array.isArray(a)){if(o.every(i=>typeof i=="string"||typeof i=="number")){o.push(...a);continue}for(const i of a){if(!Aj(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const s=i.index;if(s==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof s!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const c=o[s];c==null?o.push(i):o[s]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${o}`);t[r]=o}return t}_addRun(t){return t}async _threadAssistantStream(t,n,r){return await this._createThreadAssistantStream(n,t,r)}async _runAssistantStream(t,n,r,a){return await this._createAssistantStream(n,t,r,a)}async _runToolAssistantStream(t,n,r,a,o){return await this._createToolAssistantStream(r,t,n,a,o)}}Kd=function(e){if(!this.ended)switch(_r(this,Zm,e,"f"),Re(this,kn,"m",G$).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Re(this,kn,"m",Q$).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Re(this,kn,"m",Z$).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Re(this,kn,"m",K$).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Zd=function(){if(this.ended)throw new rt("stream has ended, this shouldn't happen");if(!Re(this,ms,"f"))throw Error("Final run has not been received");return Re(this,ms,"f")},K$=function(e){const[t,n]=Re(this,kn,"m",J$).call(this,e,Re(this,ca,"f"));_r(this,ca,t,"f"),Re(this,qm,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,o=t.content[r.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=Re(this,qc,"f")){if(Re(this,ys,"f"))switch(Re(this,ys,"f").type){case"text":this._emit("textDone",Re(this,ys,"f").text,Re(this,ca,"f"));break;case"image_file":this._emit("imageFileDone",Re(this,ys,"f").image_file,Re(this,ca,"f"));break}_r(this,qc,r.index,"f")}_r(this,ys,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Re(this,qc,"f")!==void 0){const r=e.data.content[Re(this,qc,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,Re(this,ca,"f"));break;case"text":this._emit("textDone",r.text,Re(this,ca,"f"));break}}Re(this,ca,"f")&&this._emit("messageDone",e.data),_r(this,ca,void 0,"f")}},Z$=function(e){const t=Re(this,kn,"m",X$).call(this,e);switch(_r(this,qd,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const r of n.step_details.tool_calls)r.index==Re(this,Km,"f")?this._emit("toolCallDelta",r,t.step_details.tool_calls[r.index]):(Re(this,jr,"f")&&this._emit("toolCallDone",Re(this,jr,"f")),_r(this,Km,r.index,"f"),_r(this,jr,t.step_details.tool_calls[r.index],"f"),Re(this,jr,"f")&&this._emit("toolCallCreated",Re(this,jr,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":_r(this,qd,void 0,"f"),e.data.step_details.type=="tool_calls"&&Re(this,jr,"f")&&(this._emit("toolCallDone",Re(this,jr,"f")),_r(this,jr,void 0,"f")),this._emit("runStepDone",e.data,t);break}},G$=function(e){Re(this,Jj,"f").push(e),this._emit("event",e)},X$=function(e){switch(e.event){case"thread.run.step.created":return Re(this,Xa,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Re(this,Xa,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=la.accumulateDelta(t,n.delta);Re(this,Xa,"f")[e.data.id]=r}return Re(this,Xa,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Re(this,Xa,"f")[e.data.id]=e.data;break}if(Re(this,Xa,"f")[e.data.id])return Re(this,Xa,"f")[e.data.id];throw new Error("No snapshot available")},J$=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let o=t.content[a.index];t.content[a.index]=Re(this,kn,"m",Y$).call(this,a,o)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Y$=function(e,t){return la.accumulateDelta(t,e)},Q$=function(e){switch(_r(this,Gm,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":_r(this,ms,e.data,"f"),Re(this,jr,"f")&&(this._emit("toolCallDone",Re(this,jr,"f")),_r(this,jr,void 0,"f"));break}};class Yj extends mt{create(t,n,r){return this._client.post(`/threads/${t}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/messages/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return ar(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/messages`,Qj,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n,r){return this._client.delete(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Qj extends ia{}Yj.MessagesPage=Qj;class eE extends mt{retrieve(t,n,r,a={},o){return ar(a)?this.retrieve(t,n,r,{},a):this._client.get(`/threads/${t}/runs/${n}/steps/${r}`,{query:a,...o,headers:{"OpenAI-Beta":"assistants=v2",...o==null?void 0:o.headers}})}list(t,n,r={},a){return ar(r)?this.list(t,n,{},r):this._client.getAPIList(`/threads/${t}/runs/${n}/steps`,tE,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class tE extends ia{}eE.RunStepsPage=tE;class Gd extends mt{constructor(){super(...arguments),this.steps=new eE(this._client)}create(t,n,r){const{include:a,...o}=n;return this._client.post(`/threads/${t}/runs`,{query:{include:a},body:o,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(t,n,r){return this._client.get(`/threads/${t}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return ar(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/runs`,nE,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/threads/${t}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n,r);return await this.poll(t,a.id,r)}createAndStream(t,n,r){return la.createAssistantStream(t,this._client.beta.threads.runs,n,r)}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:{...r==null?void 0:r.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await Ld(s);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,n,r){return la.createAssistantStream(t,this._client.beta.threads.runs,n,r)}submitToolOutputs(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}/submit_tool_outputs`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(t,n,r,a){const o=await this.submitToolOutputs(t,n,r,a);return await this.poll(t,o.id,a)}submitToolOutputsStream(t,n,r,a){return la.createToolAssistantStream(t,n,this._client.beta.threads.runs,r,a)}}class nE extends ia{}Gd.RunsPage=nE,Gd.Steps=eE,Gd.RunStepsPage=tE;class Kc extends mt{constructor(){super(...arguments),this.runs=new Gd(this._client),this.messages=new Yj(this._client)}create(t={},n){return ar(t)?this.create({},t):this._client.post("/threads",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/threads/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n){return this._client.delete(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}async createAndRunPoll(t,n){const r=await this.createAndRun(t,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(t,n){return la.createThreadAssistantStream(t,this._client.beta.threads,n)}}Kc.Runs=Gd,Kc.RunsPage=nE,Kc.Messages=Yj,Kc.MessagesPage=Qj;const ghe=async e=>{const t=await Promise.allSettled(e),n=t.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const a of t)a.status==="fulfilled"&&r.push(a.value);return r};let rE=class extends mt{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return ar(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Xm,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for((n==null?void 0:n.pollIntervalMs)&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),o=a.data;switch(o.status){case"in_progress":let i=5e3;if(n!=null&&n.pollIntervalMs)i=n.pollIntervalMs;else{const s=a.response.headers.get("openai-poll-after-ms");if(s){const c=parseInt(s);isNaN(c)||(i=c)}}await Ld(i);break;case"failed":case"completed":return o}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}};class Xm extends ia{}rE.VectorStoreFilesPage=Xm;class e8 extends mt{create(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/vector_stores/${t}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n);return await this.poll(t,a.id,r)}listFiles(t,n,r={},a){return ar(r)?this.listFiles(t,n,{},r):this._client.getAPIList(`/vector_stores/${t}/file_batches/${n}/files`,Xm,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:a}).withResponse();switch(o.status){case"in_progress":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await Ld(s);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:n,fileIds:r=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=(a==null?void 0:a.maxConcurrency)??5,i=Math.min(o,n.length),s=this._client,c=n.values(),l=[...r];async function u(p){for(let f of p){const m=await s.files.create({file:f,purpose:"assistants"},a);l.push(m.id)}}const d=Array(i).fill(c).map(u);return await ghe(d),await this.createAndPoll(t,{file_ids:l})}}class Zc extends mt{constructor(){super(...arguments),this.files=new rE(this._client),this.fileBatches=new e8(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/vector_stores/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return ar(t)?this.list({},t):this._client.getAPIList("/vector_stores",aE,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class aE extends ia{}Zc.VectorStoresPage=aE,Zc.Files=rE,Zc.VectorStoreFilesPage=Xm,Zc.FileBatches=e8;class _i extends mt{constructor(){super(...arguments),this.realtime=new Xj(this._client),this.vectorStores=new Zc(this._client),this.chat=new Gj(this._client),this.assistants=new Rj(this._client),this.threads=new Kc(this._client)}}_i.Realtime=Xj,_i.VectorStores=Zc,_i.VectorStoresPage=aE,_i.Assistants=Rj,_i.AssistantsPage=Dj,_i.Threads=Kc;let t8=class extends mt{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}},n8=class extends mt{create(e,t){return this._client.post("/embeddings",{body:e,...t})}};class oE extends mt{create(t,n){return this._client.post("/files",$c({body:t,...n}))}retrieve(t,n){return this._client.get(`/files/${t}`,n)}list(t={},n){return ar(t)?this.list({},t):this._client.getAPIList("/files",iE,{query:t,...n})}del(t,n){return this._client.delete(`/files/${t}`,n)}content(t,n){return this._client.get(`/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(t,n){return this._client.get(`/files/${t}/content`,n)}async waitForProcessing(t,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),o=Date.now();let i=await this.retrieve(t);for(;!i.status||!a.has(i.status);)if(await Ld(n),i=await this.retrieve(t),Date.now()-o>r)throw new Pm({message:`Giving up on waiting for file ${t} to finish processing after ${r} milliseconds.`});return i}}class iE extends ia{}oE.FileObjectsPage=iE;class sE extends mt{list(t,n={},r){return ar(n)?this.list(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,cE,{query:n,...r})}}class cE extends ia{}sE.FineTuningJobCheckpointsPage=cE;class Gc extends mt{constructor(){super(...arguments),this.checkpoints=new sE(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(`/fine_tuning/jobs/${t}`,n)}list(t={},n){return ar(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",lE,{query:t,...n})}cancel(t,n){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},r){return ar(n)?this.listEvents(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,uE,{query:n,...r})}}class lE extends ia{}class uE extends ia{}Gc.FineTuningJobsPage=lE,Gc.FineTuningJobEventsPage=uE,Gc.Checkpoints=sE,Gc.FineTuningJobCheckpointsPage=cE;class Xd extends mt{constructor(){super(...arguments),this.jobs=new Gc(this._client)}}Xd.Jobs=Gc,Xd.FineTuningJobsPage=lE,Xd.FineTuningJobEventsPage=uE;class r8 extends mt{createVariation(t,n){return this._client.post("/images/variations",$c({body:t,...n}))}edit(t,n){return this._client.post("/images/edits",$c({body:t,...n}))}generate(t,n){return this._client.post("/images/generations",{body:t,...n})}}let dE=class extends mt{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",pE,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}};class pE extends rhe{}dE.ModelsPage=pE;class a8 extends mt{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class o8 extends mt{create(t,n,r){return this._client.post(`/uploads/${t}/parts`,$c({body:n,...r}))}}class fE extends mt{constructor(){super(...arguments),this.parts=new o8(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(`/uploads/${t}/cancel`,n)}complete(t,n,r){return this._client.post(`/uploads/${t}/complete`,{body:n,...r})}}fE.Parts=o8;var i8;let ot=class extends Wfe{constructor({baseURL:e=Dm("OPENAI_BASE_URL"),apiKey:t=Dm("OPENAI_API_KEY"),organization:n=Dm("OPENAI_ORG_ID")??null,project:r=Dm("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new rt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&the())throw new rt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new t8(this),this.chat=new Pj(this),this.embeddings=new n8(this),this.files=new oE(this),this.images=new r8(this),this.audio=new $d(this),this.moderations=new a8(this),this.models=new dE(this),this.fineTuning=new Xd(this),this.beta=new _i(this),this.batches=new Tj(this),this.uploads=new fE(this),this._options=o,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Cfe(e,{arrayFormat:"brackets"})}};i8=ot,ot.OpenAI=i8,ot.DEFAULT_TIMEOUT=6e5,ot.OpenAIError=rt,ot.APIError=rr,ot.APIConnectionError=Am,ot.APIConnectionTimeoutError=Pm,ot.APIUserAbortError=Pr,ot.NotFoundError=K6,ot.ConflictError=Z6,ot.RateLimitError=X6,ot.BadRequestError=W6,ot.AuthenticationError=H6,ot.InternalServerError=J6,ot.PermissionDeniedError=q6,ot.UnprocessableEntityError=G6,ot.toFile=r$,ot.fileFromPath=U6,ot.Completions=t8,ot.Chat=Pj,ot.Embeddings=n8,ot.Files=oE,ot.FileObjectsPage=iE,ot.Images=r8,ot.Audio=$d,ot.Moderations=a8,ot.Models=dE,ot.ModelsPage=pE,ot.FineTuning=Xd,ot.Beta=_i,ot.Batches=Tj,ot.BatchesPage=Ij,ot.Uploads=fE;var vhe=typeof window=="object"?window:{},Xe="0123456789abcdef".split(""),bhe=[-2147483648,8388608,32768,128],ua=[24,16,8,0],bn=[];function da(e){e?(bn[0]=bn[16]=bn[1]=bn[2]=bn[3]=bn[4]=bn[5]=bn[6]=bn[7]=bn[8]=bn[9]=bn[10]=bn[11]=bn[12]=bn[13]=bn[14]=bn[15]=0,this.blocks=bn):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}da.prototype.update=function(e){if(!this.finalized){var t=typeof e!="string";t&&e.constructor===vhe.ArrayBuffer&&(e=new Uint8Array(e));for(var n,r=0,a,o=e.length||0,i=this.blocks;r<o;){if(this.hashed&&(this.hashed=!1,i[0]=this.block,i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),t)for(a=this.start;r<o&&a<64;++r)i[a>>2]|=e[r]<<ua[a++&3];else for(a=this.start;r<o&&a<64;++r)n=e.charCodeAt(r),n<128?i[a>>2]|=n<<ua[a++&3]:n<2048?(i[a>>2]|=(192|n>>6)<<ua[a++&3],i[a>>2]|=(128|n&63)<<ua[a++&3]):n<55296||n>=57344?(i[a>>2]|=(224|n>>12)<<ua[a++&3],i[a>>2]|=(128|n>>6&63)<<ua[a++&3],i[a>>2]|=(128|n&63)<<ua[a++&3]):(n=65536+((n&1023)<<10|e.charCodeAt(++r)&1023),i[a>>2]|=(240|n>>18)<<ua[a++&3],i[a>>2]|=(128|n>>12&63)<<ua[a++&3],i[a>>2]|=(128|n>>6&63)<<ua[a++&3],i[a>>2]|=(128|n&63)<<ua[a++&3]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=i[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},da.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=bhe[t&3],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},da.prototype.hash=function(){var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4,o,i,s,c=this.blocks;for(i=16;i<80;++i)s=c[i-3]^c[i-8]^c[i-14]^c[i-16],c[i]=s<<1|s>>>31;for(i=0;i<20;i+=5)o=t&n|~t&r,s=e<<5|e>>>27,a=s+o+a+1518500249+c[i]<<0,t=t<<30|t>>>2,o=e&t|~e&n,s=a<<5|a>>>27,r=s+o+r+1518500249+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|~a&t,s=r<<5|r>>>27,n=s+o+n+1518500249+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|~r&e,s=n<<5|n>>>27,t=s+o+t+1518500249+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|~n&a,s=t<<5|t>>>27,e=s+o+e+1518500249+c[i+4]<<0,n=n<<30|n>>>2;for(;i<40;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a+1859775393+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r+1859775393+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n+1859775393+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t+1859775393+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e+1859775393+c[i+4]<<0,n=n<<30|n>>>2;for(;i<60;i+=5)o=t&n|t&r|n&r,s=e<<5|e>>>27,a=s+o+a-1894007588+c[i]<<0,t=t<<30|t>>>2,o=e&t|e&n|t&n,s=a<<5|a>>>27,r=s+o+r-1894007588+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|a&t|e&t,s=r<<5|r>>>27,n=s+o+n-1894007588+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|r&e|a&e,s=n<<5|n>>>27,t=s+o+t-1894007588+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|n&a|r&a,s=t<<5|t>>>27,e=s+o+e-1894007588+c[i+4]<<0,n=n<<30|n>>>2;for(;i<80;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a-899497514+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r-899497514+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n-899497514+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t-899497514+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e-899497514+c[i+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+a<<0},da.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return Xe[e>>28&15]+Xe[e>>24&15]+Xe[e>>20&15]+Xe[e>>16&15]+Xe[e>>12&15]+Xe[e>>8&15]+Xe[e>>4&15]+Xe[e&15]+Xe[t>>28&15]+Xe[t>>24&15]+Xe[t>>20&15]+Xe[t>>16&15]+Xe[t>>12&15]+Xe[t>>8&15]+Xe[t>>4&15]+Xe[t&15]+Xe[n>>28&15]+Xe[n>>24&15]+Xe[n>>20&15]+Xe[n>>16&15]+Xe[n>>12&15]+Xe[n>>8&15]+Xe[n>>4&15]+Xe[n&15]+Xe[r>>28&15]+Xe[r>>24&15]+Xe[r>>20&15]+Xe[r>>16&15]+Xe[r>>12&15]+Xe[r>>8&15]+Xe[r>>4&15]+Xe[r&15]+Xe[a>>28&15]+Xe[a>>24&15]+Xe[a>>20&15]+Xe[a>>16&15]+Xe[a>>12&15]+Xe[a>>8&15]+Xe[a>>4&15]+Xe[a&15]},da.prototype.toString=da.prototype.hex,da.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,a>>24&255,a>>16&255,a>>8&255,a&255]},da.prototype.array=da.prototype.digest,da.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};const whe=e=>new da(!0).update(e).hex(),s8=(...e)=>whe(e.join("_"));class xhe{}const _he=new Map;class hE extends xhe{constructor(t){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=t??new Map}lookup(t,n){return Promise.resolve(this.cache.get(s8(t,n))??null)}async update(t,n,r){this.cache.set(s8(t,n),r)}static global(){return new hE(_he)}}const jhe=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e;function mE(e){return typeof e!="object"||!e?!1:!!("type"in e&&e.type==="function"&&"function"in e&&typeof e.function=="object"&&e.function&&"name"in e.function&&"parameters"in e.function)}const Ehe=()=>!1;class She extends gf{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(t){super(t),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=t.verbose??Ehe(),this.callbacks=t.callbacks,this.tags=t.tags??[],this.metadata=t.metadata??{}}}class Ohe extends She{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:t,callbackManager:n,...r}){super({callbacks:t??n,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r.cache=="object"?this.cache=r.cache:r.cache?this.cache=hE.global():this.cache=void 0,this.caller=new UDe(r??{})}async getNumTokens(t){if(typeof t!="string")return 0;let n=Math.ceil(t.length/4);if(!this._encoding)try{this._encoding=await VDe("modelName"in this?jhe(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{n=this._encoding.encode(t).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return n}static _convertInputToPromptValue(t){return typeof t=="string"?new x6(t):Array.isArray(t)?new tfe(t.map(vf)):t}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:t,...n}){const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([a,o])=>o!==void 0).map(([a,o])=>`${a}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(t){throw new Error("Use .toJSON() instead")}}class ji extends gf{static lc_name(){return"RunnablePassthrough"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t&&(this.func=t.func)}async invoke(t,n){const r=VG(n);return this.func&&await this.func(t,r),this._callWithConfig(a=>Promise.resolve(a),t,r)}async*transform(t,n){const r=VG(n);let a,o=!0;for await(const i of this._transformStreamWithConfig(t,s=>s,r))if(yield i,o)if(a===void 0)a=i;else try{a=WG(a,i)}catch{a=void 0,o=!1}this.func&&a!==void 0&&await this.func(a,r)}static assign(t){return new WDe(new HDe({steps:t}))}}function Jd(e){return typeof(e==null?void 0:e.parse)=="function"}class Ja extends Ohe{constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(t){const[n,r]=super._separateRunnableConfigFromCallOptions(t);return r.signal=n.signal,[n,r]}async invoke(t,n){const r=Ja._convertInputToPromptValue(t);return(await this.generatePrompt([r],n,n==null?void 0:n.callbacks)).generations[0][0].message}async*_streamResponseChunks(t,n,r){throw new Error("Not implemented.")}async*_streamIterator(t,n){var r;if(this._streamResponseChunks===Ja.prototype._streamResponseChunks)yield this.invoke(t,n);else{const a=Ja._convertInputToPromptValue(t).toChatMessages(),[o,i]=this._separateRunnableConfigFromCallOptionsCompat(n),s={...o.metadata,...this.getLsParams(i)},c=await Wk.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),[a],o.runId,void 0,l,void 0,void 0,o.runName));let d;try{for await(const p of this._streamResponseChunks(a,i,u==null?void 0:u[0])){if(p.message.id==null){const f=(r=u==null?void 0:u.at(0))==null?void 0:r.runId;f!=null&&p.message._updateId(`run-${f}`)}p.message.response_metadata={...p.generationInfo,...p.message.response_metadata},yield p.message,d?d=d.concat(p):d=p}}catch(p){throw await Promise.all((u??[]).map(f=>f==null?void 0:f.handleLLMError(p))),p}await Promise.all((u??[]).map(p=>p==null?void 0:p.handleLLMEnd({generations:[[d]]})))}}getLsParams(t){return{ls_model_type:"chat",ls_stop:t.stop}}async _generateUncached(t,n,r){var p,f;const a=t.map(m=>m.map(vf)),o={...r.metadata,...this.getLsParams(n)},i=await Wk.configure(r.callbacks,this.callbacks,r.tags,this.tags,o,this.metadata,{verbose:this.verbose}),s={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:1},c=await(i==null?void 0:i.handleChatModelStart(this.toJSON(),a,r.runId,void 0,s,void 0,void 0,r.runName)),l=[],u=[];if(c!=null&&c[0].handlers.find(m=>qDe(m)||KDe(m))&&a.length===1&&this._streamResponseChunks!==Ja.prototype._streamResponseChunks)try{const m=await this._streamResponseChunks(a[0],n,c==null?void 0:c[0]);let y;for await(const v of m){if(v.message.id==null){const b=(p=c==null?void 0:c.at(0))==null?void 0:p.runId;b!=null&&v.message._updateId(`run-${b}`)}y===void 0?y=v:y=WG(y,v)}if(y===void 0)throw new Error("Received empty response from chat model call.");l.push([y]),await(c==null?void 0:c[0].handleLLMEnd({generations:l,llmOutput:{}}))}catch(m){throw await(c==null?void 0:c[0].handleLLMError(m)),m}else{const m=await Promise.allSettled(a.map((y,v)=>this._generate(y,{...n,promptIndex:v},c==null?void 0:c[v])));await Promise.all(m.map(async(y,v)=>{var b,w,_;if(y.status==="fulfilled"){const x=y.value;for(const j of x.generations){if(j.message.id==null){const E=(b=c==null?void 0:c.at(0))==null?void 0:b.runId;E!=null&&j.message._updateId(`run-${E}`)}j.message.response_metadata={...j.generationInfo,...j.message.response_metadata}}return x.generations.length===1&&(x.generations[0].message.response_metadata={...x.llmOutput,...x.generations[0].message.response_metadata}),l[v]=x.generations,u[v]=x.llmOutput,(w=c==null?void 0:c[v])==null?void 0:w.handleLLMEnd({generations:[x.generations],llmOutput:x.llmOutput})}else return await((_=c==null?void 0:c[v])==null?void 0:_.handleLLMError(y.reason)),Promise.reject(y.reason)}))}const d={generations:l,llmOutput:u.length?(f=this._combineLLMOutput)==null?void 0:f.call(this,...u):void 0};return Object.defineProperty(d,HG,{value:c?{runIds:c==null?void 0:c.map(m=>m.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:t,cache:n,llmStringKey:r,parsedOptions:a,handledOptions:o}){const i=t.map(y=>y.map(vf)),s={...o.metadata,...this.getLsParams(a)},c=await Wk.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1,cached:!0},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),i,o.runId,void 0,l,void 0,void 0,o.runName)),d=[],p=(await Promise.allSettled(i.map(async(y,v)=>{const b=Ja._convertInputToPromptValue(y).toString(),w=await n.lookup(b,r);return w==null&&d.push(v),w}))).map((y,v)=>({result:y,runManager:u==null?void 0:u[v]})).filter(({result:y})=>y.status==="fulfilled"&&y.value!=null||y.status==="rejected"),f=[];await Promise.all(p.map(async({result:y,runManager:v},b)=>{if(y.status==="fulfilled"){const w=y.value;return f[b]=w,w.length&&await(v==null?void 0:v.handleLLMNewToken(w[0].text)),v==null?void 0:v.handleLLMEnd({generations:[w]})}else return await(v==null?void 0:v.handleLLMError(y.reason)),Promise.reject(y.reason)}));const m={generations:f,missingPromptIndices:d};return Object.defineProperty(m,HG,{value:u?{runIds:u==null?void 0:u.map(y=>y.runId)}:void 0,configurable:!0}),m}async generate(t,n,r){let a;Array.isArray(n)?a={stop:n}:a=n;const o=t.map(f=>f.map(vf)),[i,s]=this._separateRunnableConfigFromCallOptionsCompat(a);if(i.callbacks=i.callbacks??r,!this.cache)return this._generateUncached(o,s,i);const{cache:c}=this,l=this._getSerializedCacheKeyParametersForCall(s),{generations:u,missingPromptIndices:d}=await this._generateCached({messages:o,cache:c,llmStringKey:l,parsedOptions:s,handledOptions:i});let p={};if(d.length>0){const f=await this._generateUncached(d.map(m=>o[m]),s,i);await Promise.all(f.generations.map(async(m,y)=>{const v=d[y];u[v]=m;const b=Ja._convertInputToPromptValue(o[v]).toString();return c.update(b,l,m)})),p=f.llmOutput??{}}return{generations:u,llmOutput:p}}invocationParams(t){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(t,n,r){const a=t.map(o=>o.toChatMessages());return this.generate(a,n,r)}async call(t,n,r){return(await this.generate([t.map(vf)],n,r)).generations[0][0].message}async callPrompt(t,n,r){const a=t.toChatMessages();return this.call(a,n,r)}async predictMessages(t,n,r){return this.call(t,n,r)}async predict(t,n,r){const a=new Vr(t),o=await this.call([a],n,r);if(typeof o.content!="string")throw new Error("Cannot use predict when output is not a string.");return o.content}withStructuredOutput(t,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');const r=t,a=n==null?void 0:n.name,o=r.description??"A function available to call.",i=n==null?void 0:n.method,s=n==null?void 0:n.includeRaw;if(i==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let c=a??"extract",l;Jd(r)?l=[{type:"function",function:{name:c,description:o,parameters:Hk(r)}}]:("name"in r&&(c=r.name),l=[{type:"function",function:{name:c,description:o,parameters:r}}]);const u=this.bindTools(l),d=ZDe.from(y=>{if(!y.tool_calls||y.tool_calls.length===0)throw new Error("No tool calls found in the response.");const v=y.tool_calls.find(b=>b.name===c);if(!v)throw new Error(`No tool call found with name ${c}.`);return v.args});if(!s)return u.pipe(d).withConfig({runName:"StructuredOutput"});const p=ji.assign({parsed:(y,v)=>d.invoke(y.raw,v)}),f=ji.assign({parsed:()=>null}),m=p.withFallbacks({fallbacks:[f]});return kv.from([{raw:u},m]).withConfig({runName:"StructuredOutputRunnable"})}}class c8 extends gf{parseResultWithPrompt(t,n,r){return this.parseResult(t,r)}_baseMessageToString(t){return typeof t.content=="string"?t.content:this._baseMessageContentToString(t.content)}_baseMessageContentToString(t){return JSON.stringify(t)}async invoke(t,n){return typeof t=="string"?this._callWithConfig(async(r,a)=>this.parseResult([{text:r}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"}):this._callWithConfig(async(r,a)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"})}}class l8 extends c8{parseResult(t,n){return this.parse(t[0].text,n)}async parseWithPrompt(t,n,r){return this.parse(t,r)}_type(){throw new Error("_type not implemented")}}class Jm extends Error{constructor(t,n,r,a=!1){if(super(t),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=r,this.sendToLLM=a,a&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}function yE(e,t){const n=typeof e;if(n!==typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;const r=e.length;if(r!==t.length)return!1;for(let a=0;a<r;a++)if(!yE(e[a],t[a]))return!1;return!0}if(n==="object"){if(!e||!t)return e===t;const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(const o of r)if(!yE(e[o],t[o]))return!1;return!0}return e===t}class Che extends l8{async*_transform(t){for await(const n of t)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:this._baseMessageToString(n)}])}async*transform(t,n){yield*this._transformStreamWithConfig(t,this._transform.bind(this),{...n,runType:"parser"})}}class u8 extends Che{constructor(t){super(t),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(t==null?void 0:t.diff)??this.diff}async*_transform(t){let n,r;for await(const a of t){if(typeof a!="string"&&typeof a.content!="string")throw new Error("Cannot handle non-string output.");let o;if(GDe(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new qi({message:a,text:a.content})}else if(qG(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new qi({message:XDe(a),text:a.content})}else o=new JDe({text:a});r===void 0?r=o:r=r.concat(o);const i=await this.parsePartialResult([r]);i!=null&&!yE(i,n)&&(this.diff?yield this._diff(n,i):yield i,n=i)}}getFormatInstructions(){return""}}class gE extends l8{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(t){super(t),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(t){return new this(t)}static fromNamesAndDescriptions(t){const n=Pa.object(Object.fromEntries(Object.entries(t).map(([r,a])=>[r,Pa.string().describe(a)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(Hk(this.schema))}
\`\`\`
`}async parse(t){try{const n=(t.includes("```")?t.trim().split(/```(?:json)?/)[1]:t.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(r,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(n){throw new Jm(`Failed to parse. Text: "${t}". Error: ${n}`,t)}}}class vE extends u8{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(t,n){if(n)return t?_X(t,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(t){return KG(t[0].text)}async parse(t){return KG(t,JSON.parse)}getFormatInstructions(){return""}}function bE(e,t){if(e.function===void 0)return;let n;if(t!=null&&t.partial)try{n=YDe(e.function.arguments??"{}")}catch{return}else try{n=JSON.parse(e.function.arguments)}catch(a){throw new Jm([`Function "${e.function.name}" arguments:`,"",e.function.arguments,"","are not valid JSON.",`Error: ${a.message}`].join(`
`))}const r={name:e.function.name,args:n,type:"tool_call"};return t!=null&&t.returnId&&(r.id=e.id),r}function d8(e){if(e.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}}function p8(e,t){var n,r;return{name:(n=e.function)==null?void 0:n.name,args:(r=e.function)==null?void 0:r.arguments,id:e.id,error:t,type:"invalid_tool_call"}}class Nhe extends u8{static lc_name(){return"JsonOutputToolsParser"}constructor(t){super(t),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(t==null?void 0:t.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(t){return await this.parsePartialResult(t,!1)}async parsePartialResult(t,n=!0){var i;const r=t[0].message;let a;if(Mv(r)&&((i=r.tool_calls)!=null&&i.length)?a=r.tool_calls.map(s=>{const{id:c,...l}=s;return this.returnId?{id:c,...l}:l}):r.additional_kwargs.tool_calls!==void 0&&(a=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(s=>bE(s,{returnId:this.returnId,partial:n}))),!a)return[];const o=[];for(const s of a)if(s!==void 0){const c={type:s.name,args:s.args,id:s.id};o.push(c)}return o}}class Ym extends Nhe{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=t.keyName,this.returnSingle=t.returnSingle??this.returnSingle,this.zodSchema=t.zodSchema}async _validateResult(t){if(this.zodSchema===void 0)return t;const n=await this.zodSchema.safeParseAsync(t);if(n.success)return n.data;throw new Jm(`Failed to parse. Text: "${JSON.stringify(t,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(t,null,2))}async parsePartialResult(t){const n=(await super.parsePartialResult(t)).filter(a=>a.type===this.keyName);let r=n;if(n.length)return this.returnId||(r=n.map(a=>a.args)),this.returnSingle?r[0]:r}async parseResult(t){const n=(await super.parsePartialResult(t,!1)).filter(a=>a.type===this.keyName);let r=n;return n.length?(this.returnId||(r=n.map(a=>a.args)),this.returnSingle?this._validateResult(r[0]):await Promise.all(r.map(a=>this._validateResult(a)))):void 0}}const khe=Symbol("Let zodToJsonSchema decide on which parser to use"),Mhe={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Ahe=e=>({...Mhe,...e}),Phe=e=>{const t=Ahe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function f8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function St(e,t,n,r,a){e[t]=n,f8(e,t,r,a)}function The(){return{}}function Ihe(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==Q.ZodAny&&(n.items=yt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&St(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&St(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(St(n,"minItems",e.exactLength.value,e.exactLength.message,t),St(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function Rhe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?St(n,"minimum",r.value,r.message,t):St(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),St(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?St(n,"maximum",r.value,r.message,t):St(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),St(n,"maximum",r.value,r.message,t));break;case"multipleOf":St(n,"multipleOf",r.value,r.message,t);break}return n}function Dhe(){return{type:"boolean"}}function Lhe(e,t){return yt(e.type._def,t)}const $he=(e,t)=>yt(e.innerType._def,t);function h8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>h8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Fhe(e,t)}}const Fhe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":St(n,"minimum",r.value,r.message,t);break;case"max":St(n,"maximum",r.value,r.message,t);break}return n};function Bhe(e,t){return{...yt(e.innerType._def,t),default:e.defaultValue()}}function zhe(e,t){return t.effectStrategy==="input"?yt(e.schema._def,t):{}}function Uhe(e){return{type:"string",enum:e.values}}const Vhe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Whe(e,t){const n=[yt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),yt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(Vhe(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Hhe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let wE;const gs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(wE===void 0&&(wE=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),wE),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function m8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?qhe(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":St(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":St(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":pa(n,"email",a.message,t);break;case"format:idn-email":pa(n,"idn-email",a.message,t);break;case"pattern:zod":fa(n,gs.email,a.message,t);break}break;case"url":pa(n,"uri",a.message,t);break;case"uuid":pa(n,"uuid",a.message,t);break;case"regex":fa(n,a.regex,a.message,t);break;case"cuid":fa(n,gs.cuid,a.message,t);break;case"cuid2":fa(n,gs.cuid2,a.message,t);break;case"startsWith":fa(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":fa(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":pa(n,"date-time",a.message,t);break;case"date":pa(n,"date",a.message,t);break;case"time":pa(n,"time",a.message,t);break;case"duration":pa(n,"duration",a.message,t);break;case"length":St(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),St(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{fa(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&pa(n,"ipv4",a.message,t),a.version!=="v4"&&pa(n,"ipv6",a.message,t);break}case"emoji":fa(n,gs.emoji,a.message,t);break;case"ulid":{fa(n,gs.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{pa(n,"binary",a.message,t);break}case"contentEncoding:base64":{St(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{fa(n,gs.base64,a.message,t);break}}break}case"nanoid":fa(n,gs.nanoid,a.message,t)}return n}const qhe=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),pa=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):St(e,"format",t,n,r)},fa=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:y8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):St(e,"pattern",y8(t,r),n,r)},y8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function g8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===Q.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===Q.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(m8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===Q.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Khe(e,t){if(t.mapStrategy==="record")return g8(e,t);const n=yt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Zhe(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Ghe(){return{not:{}}}function Xhe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Qm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Jhe(e,t){if(t.target==="openApi3")return v8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Qm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=Qm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return v8(e,t)}const v8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>yt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Yhe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:Qm[e.innerType._def.typeName],nullable:!0}:{type:[Qm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=yt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=yt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Qhe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",f8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?St(n,"minimum",r.value,r.message,t):St(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),St(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?St(n,"maximum",r.value,r.message,t):St(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),St(n,"maximum",r.value,r.message,t));break;case"multipleOf":St(n,"multipleOf",r.value,r.message,t);break}return n}function eme(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":yt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":yt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function tme(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=yt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:eme(e,t)};return n.required.length||delete n.required,n}const nme=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return yt(e.innerType._def,t);const n=yt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},rme=(e,t)=>{if(t.pipeStrategy==="input")return yt(e.in._def,t);if(t.pipeStrategy==="output")return yt(e.out._def,t);const n=yt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=yt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function ame(e,t){return yt(e.type._def,t)}function ome(e,t){const n={type:"array",uniqueItems:!0,items:yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&St(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&St(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function ime(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>yt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:yt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>yt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function sme(){return{not:{}}}function cme(){return{}}const lme=(e,t)=>yt(e.innerType._def,t);function yt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==khe)return s}if(r&&!n){const s=ume(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=pme(e,e.typeName,t);return o&&fme(e,t,o),a.jsonSchema=o,o}const ume=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:dme(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},dme=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},pme=(e,t,n)=>{switch(t){case Q.ZodString:return m8(e,n);case Q.ZodNumber:return Qhe(e,n);case Q.ZodObject:return tme(e,n);case Q.ZodBigInt:return Rhe(e,n);case Q.ZodBoolean:return Dhe();case Q.ZodDate:return h8(e,n);case Q.ZodUndefined:return sme();case Q.ZodNull:return Xhe(n);case Q.ZodArray:return Ihe(e,n);case Q.ZodUnion:case Q.ZodDiscriminatedUnion:return Jhe(e,n);case Q.ZodIntersection:return Whe(e,n);case Q.ZodTuple:return ime(e,n);case Q.ZodRecord:return g8(e,n);case Q.ZodLiteral:return Hhe(e,n);case Q.ZodEnum:return Uhe(e);case Q.ZodNativeEnum:return Zhe(e);case Q.ZodNullable:return Yhe(e,n);case Q.ZodOptional:return nme(e,n);case Q.ZodMap:return Khe(e,n);case Q.ZodSet:return ome(e,n);case Q.ZodLazy:return yt(e.getter()._def,n);case Q.ZodPromise:return ame(e,n);case Q.ZodNaN:case Q.ZodNever:return Ghe();case Q.ZodEffects:return zhe(e,n);case Q.ZodAny:return The();case Q.ZodUnknown:return cme();case Q.ZodDefault:return Bhe(e,n);case Q.ZodBranded:return Lhe(e,n);case Q.ZodReadonly:return lme(e,n);case Q.ZodCatch:return $he(e,n);case Q.ZodPipeline:return rme(e,n);case Q.ZodFunction:case Q.ZodVoid:case Q.ZodSymbol:return;default:return(r=>{})()}},fme=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),hme=(e,t)=>{const n=Phe(t),r=void 0,a=t==null?void 0:t.name,o=yt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},mme=Symbol("Let zodToJsonSchema decide on which parser to use"),b8={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},yme=e=>typeof e=="string"?{...b8,basePath:["#"],definitions:{},name:e}:{...b8,basePath:["#"],definitions:{},...e},xE=e=>"_def"in e?e._def:e;function gme(e){if(!e)return!0;for(const t in e)return!1;return!0}const vme=e=>{const t=yme(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[xE(a),{def:xE(a),path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function w8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Ot(e,t,n,r,a){e[t]=n,w8(e,t,r,a)}function bme(){return{}}function wme(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==Q.ZodAny&&(n.items=pt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Ot(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Ot(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Ot(n,"minItems",e.exactLength.value,e.exactLength.message,t),Ot(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function xme(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Ot(n,"minimum",r.value,r.message,t):Ot(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ot(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ot(n,"maximum",r.value,r.message,t):Ot(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ot(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ot(n,"multipleOf",r.value,r.message,t);break}return n}function _me(){return{type:"boolean"}}function jme(e,t){return pt(e.type._def,t)}const Eme=(e,t)=>pt(e.innerType._def,t);function x8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>x8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Sme(e,t)}}const Sme=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Ot(n,"minimum",r.value,r.message,t);break;case"max":Ot(n,"maximum",r.value,r.message,t);break}return n};function Ome(e,t){return{...pt(e.innerType._def,t),default:e.defaultValue()}}function Cme(e,t,n){return t.effectStrategy==="input"?pt(e.schema._def,t,n):{}}function Nme(e){return{type:"string",enum:[...e.values]}}const kme=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Mme(e,t){const n=[pt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),pt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(kme(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Ame(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let _E;const vs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(_E===void 0&&(_E=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),_E),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function _8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Pme(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":Ot(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":Ot(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ha(n,"email",a.message,t);break;case"format:idn-email":ha(n,"idn-email",a.message,t);break;case"pattern:zod":ma(n,vs.email,a.message,t);break}break;case"url":ha(n,"uri",a.message,t);break;case"uuid":ha(n,"uuid",a.message,t);break;case"regex":ma(n,a.regex,a.message,t);break;case"cuid":ma(n,vs.cuid,a.message,t);break;case"cuid2":ma(n,vs.cuid2,a.message,t);break;case"startsWith":ma(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":ma(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":ha(n,"date-time",a.message,t);break;case"date":ha(n,"date",a.message,t);break;case"time":ha(n,"time",a.message,t);break;case"duration":ha(n,"duration",a.message,t);break;case"length":Ot(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),Ot(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{ma(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&ha(n,"ipv4",a.message,t),a.version!=="v4"&&ha(n,"ipv6",a.message,t);break}case"emoji":ma(n,vs.emoji,a.message,t);break;case"ulid":{ma(n,vs.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ha(n,"binary",a.message,t);break}case"contentEncoding:base64":{Ot(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{ma(n,vs.base64,a.message,t);break}}break}case"nanoid":ma(n,vs.nanoid,a.message,t)}return n}const Pme=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),ha=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Ot(e,"format",t,n,r)},ma=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:j8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Ot(e,"pattern",j8(t,r),n,r)},j8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function E8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===Q.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:pt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:pt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===Q.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(_8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===Q.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Tme(e,t){if(t.mapStrategy==="record")return E8(e,t);const n=pt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=pt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Ime(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Rme(){return{not:{}}}function Dme(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const ey={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Lme(e,t){if(t.target==="openApi3")return S8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in ey&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=ey[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return S8(e,t)}const S8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>pt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function $me(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"||t.nullableStrategy==="property"?{type:ey[e.innerType._def.typeName],nullable:!0}:{type:[ey[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=pt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=pt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Fme(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",w8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Ot(n,"minimum",r.value,r.message,t):Ot(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ot(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ot(n,"maximum",r.value,r.message,t):Ot(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ot(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ot(n,"multipleOf",r.value,r.message,t);break}return n}function Bme(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":pt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":pt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function zme(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=pt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()&&!t.openaiStrictMode?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Bme(e,t)};return n.required.length||delete n.required,n}const Ume=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return pt(e.innerType._def,t);const n=pt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Vme=(e,t)=>{if(t.pipeStrategy==="input")return pt(e.in._def,t);if(t.pipeStrategy==="output")return pt(e.out._def,t);const n=pt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=pt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Wme(e,t){return pt(e.type._def,t)}function Hme(e,t){const n={type:"array",uniqueItems:!0,items:pt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Ot(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Ot(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function qme(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>pt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:pt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>pt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Kme(){return{not:{}}}function Zme(){return{}}const Gme=(e,t)=>pt(e.innerType._def,t);function pt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==mme)return s}if(r&&!n){const s=Xme(r,t);if(s!==void 0)return"$ref"in s&&t.seenRefs.add(s.$ref),s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=Yme(e,e.typeName,t,n);return o&&Qme(e,t,o),a.jsonSchema=o,o}const Xme=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":const n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&t.nameStrategy==="duplicate-ref"&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:Jme(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,a)=>t.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Jme=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Yme=(e,t,n,r)=>{switch(t){case Q.ZodString:return _8(e,n);case Q.ZodNumber:return Fme(e,n);case Q.ZodObject:return zme(e,n);case Q.ZodBigInt:return xme(e,n);case Q.ZodBoolean:return _me();case Q.ZodDate:return x8(e,n);case Q.ZodUndefined:return Kme();case Q.ZodNull:return Dme(n);case Q.ZodArray:return wme(e,n);case Q.ZodUnion:case Q.ZodDiscriminatedUnion:return Lme(e,n);case Q.ZodIntersection:return Mme(e,n);case Q.ZodTuple:return qme(e,n);case Q.ZodRecord:return E8(e,n);case Q.ZodLiteral:return Ame(e,n);case Q.ZodEnum:return Nme(e);case Q.ZodNativeEnum:return Ime(e);case Q.ZodNullable:return $me(e,n);case Q.ZodOptional:return Ume(e,n);case Q.ZodMap:return Tme(e,n);case Q.ZodSet:return Hme(e,n);case Q.ZodLazy:return pt(e.getter()._def,n);case Q.ZodPromise:return Wme(e,n);case Q.ZodNaN:case Q.ZodNever:return Rme();case Q.ZodEffects:return Cme(e,n,r);case Q.ZodAny:return bme();case Q.ZodUnknown:return Zme();case Q.ZodDefault:return Ome(e,n);case Q.ZodBranded:return jme(e,n);case Q.ZodReadonly:return Gme(e,n);case Q.ZodCatch:return Eme(e,n);case Q.ZodPipeline:return Vme(e,n);case Q.ZodFunction:case Q.ZodVoid:case Q.ZodSymbol:return;default:return(a=>{})()}},Qme=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),eye=(e,t)=>{const n=vme(t),r=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,a=pt(e._def,r===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},o=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;o!==void 0&&(a.title=o);const i=(()=>{if(gme(n.definitions))return;const c={},l=new Set;for(let u=0;u<500;u++){const d=Object.entries(n.definitions).filter(([p])=>!l.has(p));if(d.length===0)break;for(const[p,f]of d)c[p]=pt(xE(f),{...n,currentPath:[...n.basePath,n.definitionPath,p]},!0)??{},l.add(p)}return c})(),s=r===void 0?i?{...a,[n.definitionPath]:i}:a:n.nameStrategy==="duplicate-ref"?{...a,...i||n.seenRefs.size?{[n.definitionPath]:{...i,...n.seenRefs.size?{[r]:a}:void 0}}:void 0}:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...i,[r]:a}};return n.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s};function O8(e,t){return eye(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function tye(e,t,n){return ahe({type:"json_schema",json_schema:{...n,name:t,strict:!0,schema:O8(e,{name:t})}},r=>e.parse(JSON.parse(r)))}function nye(e){return ohe({type:"function",function:{name:e.name,parameters:O8(e.parameters,{name:e.name}),strict:!0,...e.description?{description:e.description}:void 0}},{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})}function C8(e){const{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:a,baseURL:o,azureADTokenProvider:i,azureOpenAIEndpoint:s}=e;if((r||i)&&a&&t)return`${a}/${t}`;if((r||i)&&s&&t)return`${s}/openai/deployments/${t}`;if(r||i){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${t}`}return o}function N8(e,t){const n=typeof t=="number"?void 0:t;return{name:e.name,description:e.description,parameters:Hk(e.schema),...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}}function rye(e,t){let n;return ty(e)?n={type:"function",function:N8(e)}:n=e,n}function aye(e){return e!==void 0&&Array.isArray(e.lc_namespace)}function oye(e){return e!==void 0&&gf.isRunnable(e)&&"lc_name"in e.constructor&&typeof e.constructor.lc_name=="function"&&e.constructor.lc_name()==="RunnableToolLike"}function iye(e){return!!e&&typeof e=="object"&&"name"in e&&"schema"in e&&Jd(e.schema)}function ty(e){return iye(e)||oye(e)||aye(e)}function ny(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/
`,e}function jE(e){let t;return e.constructor.name===Pm.name?(t=new Error(e.message),t.name="TimeoutError"):e.constructor.name===Pr.name?(t=new Error(e.message),t.name="AbortError"):e.status===400&&e.message.includes("tool_calls")?t=ny(e,"INVALID_TOOL_RESULTS"):e.status===401?t=ny(e,"MODEL_AUTHENTICATION"):e.status===429?t=ny(e,"MODEL_RATE_LIMIT"):e.status===404?t=ny(e,"MODEL_NOT_FOUND"):t=e,t}function sye(e){if(e)return e==="any"||e==="required"?"required":e==="auto"?"auto":e==="none"?"none":typeof e=="string"?{type:"function",function:{name:e}}:e}function cye(e){return e.anyOf!==void 0&&Array.isArray(e.anyOf)}function lye(e){const t=["namespace functions {",""];for(const n of e)n.description&&t.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(t.push(`type ${n.name} = (_: {`),t.push(k8(n.parameters,0)),t.push("}) => any;")):t.push(`type ${n.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join(`
`)}function k8(e,t){var r;const n=[];for(const[a,o]of Object.entries(e.properties??{}))o.description&&t<2&&n.push(`// ${o.description}`),(r=e.required)!=null&&r.includes(a)?n.push(`${a}: ${ry(o,t)},`):n.push(`${a}?: ${ry(o,t)},`);return n.map(a=>" ".repeat(t)+a).join(`
`)}function ry(e,t){if(cye(e))return e.anyOf.map(n=>ry(n,t)).join(" | ");switch(e.type){case"string":return e.enum?e.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",k8(e,t+2),"}"].join(`
`);case"array":return e.items?`${ry(e.items,t)}[]`:"any[]";default:return""}}function uye(e,t){let n;if(ty(e)){const r=nye({name:e.name,parameters:e.schema,description:e.description});r.function.parameters?n={type:r.type,function:{name:r.function.name,description:r.function.description,parameters:r.function.parameters,...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}}:n={type:"function",function:N8(e,t)}}else n=e;return(t==null?void 0:t.strict)!==void 0&&(n.function.strict=t.strict),n}function dye(e){return e.role!=="system"&&e.role!=="developer"&&e.role!=="assistant"&&e.role!=="user"&&e.role!=="function"&&e.role!=="tool"&&console.warn(`Unknown message role: ${e.role}`),e.role}function M8(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!Av.isInstance(e))throw new Error("Invalid generic chat message");return dye(e)}default:throw new Error(`Unknown message type: ${t}`)}}function pye(e,t,n){const r=e.tool_calls;switch(e.role){case"assistant":{const a=[],o=[];for(const c of r??[])try{a.push(bE(c,{returnId:!0}))}catch(l){o.push(p8(c,l.message))}const i={function_call:e.function_call,tool_calls:r};n!==void 0&&(i.__raw_response=t);const s={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(i.audio=e.audio),new Ta({content:e.content||"",tool_calls:a,invalid_tool_calls:o,additional_kwargs:i,response_metadata:s,id:t.id})}default:return new Av(e.content||"",e.role??"unknown")}}function fye(e,t,n,r){var c,l;const a=e.role??n,o=e.content??"";let i;e.function_call?i={function_call:e.function_call}:e.tool_calls?i={tool_calls:e.tool_calls}:i={},r&&(i.__raw_response=t),e.audio&&(i.audio={...e.audio,index:t.choices[0].index});const s={usage:{...t.usage}};if(a==="user")return new ZG({content:o,response_metadata:s});if(a==="assistant"){const u=[];if(Array.isArray(e.tool_calls))for(const d of e.tool_calls)u.push({name:(c=d.function)==null?void 0:c.name,args:(l=d.function)==null?void 0:l.arguments,id:d.id,index:d.index,type:"tool_call_chunk"});return new nu({content:o,tool_call_chunks:u,additional_kwargs:i,id:t.id,response_metadata:s})}else return a==="system"?new qk({content:o,response_metadata:s}):a==="developer"?new qk({content:o,response_metadata:s,additional_kwargs:{__openai_role__:"developer"}}):a==="function"?new QDe({content:o,additional_kwargs:i,name:e.name,response_metadata:s}):a==="tool"?new e3e({content:o,additional_kwargs:i,tool_call_id:e.tool_call_id,response_metadata:s}):new GG({content:o,role:a,response_metadata:s})}function A8(e,t){return e.flatMap(n=>{var o;let r=M8(n);r==="system"&&(t!=null&&t.startsWith("o1"))&&(r="developer");const a={role:r,content:n.content};if(n.name!=null&&(a.name=n.name),n.additional_kwargs.function_call!=null&&(a.function_call=n.additional_kwargs.function_call,a.content=null),Mv(n)&&((o=n.tool_calls)!=null&&o.length)?(a.tool_calls=n.tool_calls.map(d8),a.content=null):(n.additional_kwargs.tool_calls!=null&&(a.tool_calls=n.additional_kwargs.tool_calls),n.tool_call_id!=null&&(a.tool_call_id=n.tool_call_id)),n.additional_kwargs.audio&&typeof n.additional_kwargs.audio=="object"&&"id"in n.additional_kwargs.audio){const i={role:"assistant",audio:{id:n.additional_kwargs.audio.id}};return[a,i]}return a})}function P8(e,t){return mE(e)?(t==null?void 0:t.strict)!==void 0?{...e,function:{...e.function,strict:t.strict}}:e:uye(e,t)}class hye extends Ja{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(t,n){var r,a,o,i,s,c,l,u,d;if(super(t??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(t==null?void 0:t.apiKey)??(t==null?void 0:t.openAIApiKey)??((r=t==null?void 0:t.configuration)==null?void 0:r.apiKey)??gn("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(t==null?void 0:t.azureOpenAIApiKey)??gn("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(t==null?void 0:t.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(t==null?void 0:t.azureOpenAIApiInstanceName)??gn("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(t==null?void 0:t.azureOpenAIApiDeploymentName)??gn("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(t==null?void 0:t.azureOpenAIApiVersion)??gn("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(t==null?void 0:t.azureOpenAIBasePath)??gn("AZURE_OPENAI_BASE_PATH"),this.organization=((a=t==null?void 0:t.configuration)==null?void 0:a.organization)??gn("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=(t==null?void 0:t.azureOpenAIEndpoint)??gn("AZURE_OPENAI_ENDPOINT"),this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(t==null?void 0:t.modelKwargs)??{},this.timeout=t==null?void 0:t.timeout,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.topP=(t==null?void 0:t.topP)??this.topP,this.frequencyPenalty=(t==null?void 0:t.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(t==null?void 0:t.presencePenalty)??this.presencePenalty,this.maxTokens=t==null?void 0:t.maxTokens,this.logprobs=t==null?void 0:t.logprobs,this.topLogprobs=t==null?void 0:t.topLogprobs,this.n=(t==null?void 0:t.n)??this.n,this.logitBias=t==null?void 0:t.logitBias,this.stop=(t==null?void 0:t.stopSequences)??(t==null?void 0:t.stop),this.stopSequences=this==null?void 0:this.stop,this.user=t==null?void 0:t.user,this.__includeRawResponse=t==null?void 0:t.__includeRawResponse,this.audio=t==null?void 0:t.audio,this.modalities=t==null?void 0:t.modalities,this.reasoningEffort=t==null?void 0:t.reasoningEffort,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const p=this.azureOpenAIBasePath.split("/openai/deployments/");if(p.length===2){const[,f]=p;this.azureOpenAIApiDeploymentName=f}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.model==="o1"&&(this.disableStreaming=!0),this.streaming=(t==null?void 0:t.streaming)??!1,this.streamUsage=(t==null?void 0:t.streamUsage)??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(n==null?void 0:n.basePath)??((o=t==null?void 0:t.configuration)==null?void 0:o.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((i=n==null?void 0:n.baseOptions)==null?void 0:i.headers)??((c=(s=t==null?void 0:t.configuration)==null?void 0:s.baseOptions)==null?void 0:c.headers),defaultQuery:((l=n==null?void 0:n.baseOptions)==null?void 0:l.params)??((d=(u=t==null?void 0:t.configuration)==null?void 0:u.baseOptions)==null?void 0:d.params),...n,...t==null?void 0:t.configuration},(t==null?void 0:t.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=t.supportsStrictToolCalling)}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.max_tokens??void 0,ls_stop:t.stop}}bindTools(t,n){let r;return(n==null?void 0:n.strict)!==void 0?r=n.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:t.map(a=>P8(a,{strict:r})),...n})}createResponseFormat(t){return t&&t.type==="json_schema"&&t.json_schema.schema&&ay(t.json_schema.schema)?tye(t.json_schema.schema,t.json_schema.name,{description:t.json_schema.description}):t}invocationParams(t,n){var s;let r;(t==null?void 0:t.strict)!==void 0?r=t.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling);let a={};(t==null?void 0:t.stream_options)!==void 0?a={stream_options:t.stream_options}:this.streamUsage&&(this.streaming||n!=null&&n.streaming)&&(a={stream_options:{include_usage:!0}});const o={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(t==null?void 0:t.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:t==null?void 0:t.functions,function_call:t==null?void 0:t.function_call,tools:(s=t==null?void 0:t.tools)!=null&&s.length?t.tools.map(c=>P8(c,{strict:r})):void 0,tool_choice:sye(t==null?void 0:t.tool_choice),response_format:this.createResponseFormat(t==null?void 0:t.response_format),seed:t==null?void 0:t.seed,...a,parallel_tool_calls:t==null?void 0:t.parallel_tool_calls,...this.audio||t!=null&&t.audio?{audio:this.audio||(t==null?void 0:t.audio)}:{},...this.modalities||t!=null&&t.modalities?{modalities:this.modalities||(t==null?void 0:t.modalities)}:{},...this.modelKwargs};(t==null?void 0:t.prediction)!==void 0&&(o.prediction=t.prediction);const i=(t==null?void 0:t.reasoning_effort)??this.reasoningEffort;return i!==void 0&&(o.reasoning_effort=i),o}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(t,n,r){var l,u,d,p,f,m,y,v,b,w;const a=A8(t,this.model),o={...this.invocationParams(n,{streaming:!0}),messages:a,stream:!0};let i;const s=await this.completionWithRetry(o,n);let c;for await(const _ of s){const x=(l=_==null?void 0:_.choices)==null?void 0:l[0];if(_.usage&&(c=_.usage),!x)continue;const{delta:j}=x;if(!j)continue;const E=fye(j,_,i,this.__includeRawResponse);i=j.role??i;const S={prompt:n.promptIndex??0,completion:x.index??0};if(typeof E.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const O={...S};x.finish_reason!=null&&(O.finish_reason=x.finish_reason,O.system_fingerprint=_.system_fingerprint,O.model_name=_.model),this.logprobs&&(O.logprobs=x.logprobs);const N=new qi({message:E,text:E.content,generationInfo:O});yield N,await(r==null?void 0:r.handleLLMNewToken(N.text??"",S,void 0,void 0,void 0,{chunk:N}))}if(c){const _={...((u=c.prompt_tokens_details)==null?void 0:u.audio_tokens)!==null&&{audio:(d=c.prompt_tokens_details)==null?void 0:d.audio_tokens},...((p=c.prompt_tokens_details)==null?void 0:p.cached_tokens)!==null&&{cache_read:(f=c.prompt_tokens_details)==null?void 0:f.cached_tokens}},x={...((m=c.completion_tokens_details)==null?void 0:m.audio_tokens)!==null&&{audio:(y=c.completion_tokens_details)==null?void 0:y.audio_tokens},...((v=c.completion_tokens_details)==null?void 0:v.reasoning_tokens)!==null&&{reasoning:(b=c.completion_tokens_details)==null?void 0:b.reasoning_tokens}};yield new qi({message:new nu({content:"",response_metadata:{usage:{...c}},usage_metadata:{input_tokens:c.prompt_tokens,output_tokens:c.completion_tokens,total_tokens:c.total_tokens,...Object.keys(_).length>0&&{input_token_details:_},...Object.keys(x).length>0&&{output_token_details:x}}}),text:""})}if((w=n.signal)!=null&&w.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(t,n,r){var s,c;const a={},o=this.invocationParams(n),i=A8(t,this.model);if(o.stream){const l=this._streamResponseChunks(t,n,r),u={};for await(const v of l){v.message.response_metadata={...v.generationInfo,...v.message.response_metadata};const b=((s=v.generationInfo)==null?void 0:s.completion)??0;u[b]===void 0?u[b]=v:u[b]=u[b].concat(v)}const d=Object.entries(u).sort(([v],[b])=>parseInt(v,10)-parseInt(b,10)).map(([v,b])=>b),{functions:p,function_call:f}=this.invocationParams(n),m=await this.getEstimatedTokenCountFromPrompt(t,p,f),y=await this.getNumTokensFromGenerations(d);return a.input_tokens=m,a.output_tokens=y,a.total_tokens=m+y,{generations:d,llmOutput:{estimatedTokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}else{let l;n.response_format&&n.response_format.type==="json_schema"?l=await this.betaParsedCompletionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options}):l=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options});const{completion_tokens:u,prompt_tokens:d,total_tokens:p,prompt_tokens_details:f,completion_tokens_details:m}=(l==null?void 0:l.usage)??{};u&&(a.output_tokens=(a.output_tokens??0)+u),d&&(a.input_tokens=(a.input_tokens??0)+d),p&&(a.total_tokens=(a.total_tokens??0)+p),((f==null?void 0:f.audio_tokens)!==null||(f==null?void 0:f.cached_tokens)!==null)&&(a.input_token_details={...(f==null?void 0:f.audio_tokens)!==null&&{audio:f==null?void 0:f.audio_tokens},...(f==null?void 0:f.cached_tokens)!==null&&{cache_read:f==null?void 0:f.cached_tokens}}),((m==null?void 0:m.audio_tokens)!==null||(m==null?void 0:m.reasoning_tokens)!==null)&&(a.output_token_details={...(m==null?void 0:m.audio_tokens)!==null&&{audio:m==null?void 0:m.audio_tokens},...(m==null?void 0:m.reasoning_tokens)!==null&&{reasoning:m==null?void 0:m.reasoning_tokens}});const y=[];for(const v of(l==null?void 0:l.choices)??[]){const b={text:((c=v.message)==null?void 0:c.content)??"",message:pye(v.message??{role:"assistant"},l,this.__includeRawResponse)};b.generationInfo={...v.finish_reason?{finish_reason:v.finish_reason}:{},...v.logprobs?{logprobs:v.logprobs}:{}},Mv(b.message)&&(b.message.usage_metadata=a),b.message=new Ta(Object.fromEntries(Object.entries(b.message).filter(([w])=>!w.startsWith("lc_")))),y.push(b)}return{generations:y,llmOutput:{tokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(t,n,r){let a=(await this.getNumTokensFromMessages(t)).totalCount;if(n&&r!=="auto"){const o=lye(n);a+=await this.getNumTokens(o),a+=9}return n&&t.find(o=>o._getType()==="system")&&(a-=4),r==="none"?a+=1:typeof r=="object"&&(a+=await this.getNumTokens(r.name)+4),a}async getNumTokensFromGenerations(t){return(await Promise.all(t.map(async n=>{var r;return(r=n.message.additional_kwargs)!=null&&r.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)}))).reduce((n,r)=>n+r,0)}async getNumTokensFromMessages(t){let n=0,r=0,a=0;this.model==="gpt-3.5-turbo-0301"?(r=4,a=-1):(r=3,a=1);const o=await Promise.all(t.map(async i=>{var p,f,m,y,v,b;const s=await this.getNumTokens(i.content),c=await this.getNumTokens(M8(i)),l=i.name!==void 0?a+await this.getNumTokens(i.name):0;let u=s+r+c+l;const d=i;if(d._getType()==="function"&&(u-=2),(p=d.additional_kwargs)!=null&&p.function_call&&(u+=3),(f=d==null?void 0:d.additional_kwargs.function_call)!=null&&f.name&&(u+=await this.getNumTokens((m=d.additional_kwargs.function_call)==null?void 0:m.name)),(y=d.additional_kwargs.function_call)==null?void 0:y.arguments)try{u+=await this.getNumTokens(JSON.stringify(JSON.parse((v=d.additional_kwargs.function_call)==null?void 0:v.arguments)))}catch(w){console.error("Error parsing function arguments",w,JSON.stringify(d.additional_kwargs.function_call)),u+=await this.getNumTokens((b=d.additional_kwargs.function_call)==null?void 0:b.arguments)}return n+=u,u}));return n+=3,{totalCount:n,countPerMessage:o}}async completionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(t,r)}catch(a){throw jE(a)}})}async betaParsedCompletionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(t,r)}catch(a){throw jE(a)}})}_getClientOptions(t){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},a=C8(r),o={...this.clientConfig,baseURL:a,timeout:this.timeout,maxRetries:0};o.baseURL||delete o.baseURL,this.client=new ot(o)}const n={...this.clientConfig,...t};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),n}_llmType(){return"openai"}_combineLLMOutput(...t){return t.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(t,n){let r,a,o,i;mye(t)?(r=t.schema,a=t.name,o=t.method,i=t.includeRaw):(r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw);let s,c;if((n==null?void 0:n.strict)!==void 0&&o==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(o==="jsonMode")s=this.bind({response_format:{type:"json_object"}}),ay(r)?c=gE.fromZodSchema(r):c=new vE;else if(o==="jsonSchema")s=this.bind({response_format:{type:"json_schema",json_schema:{name:a??"extract",description:r.description,schema:r,strict:n==null?void 0:n.strict}}}),ay(r)?c=gE.fromZodSchema(r):c=new vE;else{let p=a??"extract";if(ay(r)){const f=hme(r);s=this.bind({tools:[{type:"function",function:{name:p,description:f.description,parameters:f}}],tool_choice:{type:"function",function:{name:p}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new Ym({returnSingle:!0,keyName:p,zodSchema:r})}else{let f;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(f=r,p=r.name):(p=r.title??p,f={name:p,description:r.description??"",parameters:r}),s=this.bind({tools:[{type:"function",function:f}],tool_choice:{type:"function",function:{name:p}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new Ym({returnSingle:!0,keyName:p})}}if(!i)return s.pipe(c);const l=ji.assign({parsed:(p,f)=>c.invoke(p.raw,f)}),u=ji.assign({parsed:()=>null}),d=l.withFallbacks({fallbacks:[u]});return kv.from([{raw:s},d])}}function ay(e){return typeof(e==null?void 0:e.parse)=="function"}function mye(e){return e!==void 0&&typeof e.schema=="object"}class yye extends XG{constructor(t,n){var l,u,d;const r={maxConcurrency:2,...t};super(r),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:512}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"dimensions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let a=(r==null?void 0:r.apiKey)??(r==null?void 0:r.openAIApiKey)??gn("OPENAI_API_KEY");const o=(r==null?void 0:r.azureOpenAIApiKey)??gn("AZURE_OPENAI_API_KEY");if(this.azureADTokenProvider=(t==null?void 0:t.azureADTokenProvider)??void 0,!o&&!a&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");const i=(r==null?void 0:r.azureOpenAIApiInstanceName)??gn("AZURE_OPENAI_API_INSTANCE_NAME"),s=((r==null?void 0:r.azureOpenAIApiEmbeddingsDeploymentName)||(r==null?void 0:r.azureOpenAIApiDeploymentName))??(gn("AZURE_OPENAI_API_EMBEDDINGS_DEPLOYMENT_NAME")||gn("AZURE_OPENAI_API_DEPLOYMENT_NAME")),c=(r==null?void 0:r.azureOpenAIApiVersion)??gn("AZURE_OPENAI_API_VERSION");if(this.azureOpenAIBasePath=(r==null?void 0:r.azureOpenAIBasePath)??gn("AZURE_OPENAI_BASE_PATH"),this.organization=((l=r==null?void 0:r.configuration)==null?void 0:l.organization)??gn("OPENAI_ORGANIZATION"),this.modelName=(r==null?void 0:r.model)??(r==null?void 0:r.modelName)??this.model,this.model=this.modelName,this.batchSize=(r==null?void 0:r.batchSize)??(o?1:this.batchSize),this.stripNewLines=(r==null?void 0:r.stripNewLines)??this.stripNewLines,this.timeout=r==null?void 0:r.timeout,this.dimensions=r==null?void 0:r.dimensions,this.azureOpenAIApiVersion=c,this.azureOpenAIApiKey=o,this.azureOpenAIApiInstanceName=i,this.azureOpenAIApiDeploymentName=s,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");a=a??""}this.clientConfig={apiKey:a,organization:this.organization,baseURL:n==null?void 0:n.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:(u=n==null?void 0:n.baseOptions)==null?void 0:u.headers,defaultQuery:(d=n==null?void 0:n.baseOptions)==null?void 0:d.params,...n,...t==null?void 0:t.configuration}}async embedDocuments(t){const n=JG(this.stripNewLines?t.map(i=>i.replace(/\n/g," ")):t,this.batchSize),r=n.map(i=>{const s={model:this.model,input:i};return this.dimensions&&(s.dimensions=this.dimensions),this.embeddingWithRetry(s)}),a=await Promise.all(r),o=[];for(let i=0;i<a.length;i+=1){const s=n[i],{data:c}=a[i];for(let l=0;l<s.length;l+=1)o.push(c[l].embedding)}return o}async embedQuery(t){const n={model:this.model,input:this.stripNewLines?t.replace(/\n/g," "):t};this.dimensions&&(n.dimensions=this.dimensions);const{data:r}=await this.embeddingWithRetry(n);return r[0].embedding}async embeddingWithRetry(t){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},a=C8(r),o={...this.clientConfig,baseURL:a,timeout:this.timeout,maxRetries:0};o.baseURL||delete o.baseURL,this.client=new ot(o)}const n={};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),this.caller.call(async()=>{try{return await this.client.embeddings.create(t,n)}catch(r){throw jE(r)}})}}const gye=Symbol("Let zodToJsonSchema decide on which parser to use"),vye={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},bye=e=>({...vye,...e}),wye=e=>{const t=bye(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function T8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Ct(e,t,n,r,a){e[t]=n,T8(e,t,r,a)}function xye(){return{}}function _ye(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==Q.ZodAny&&(n.items=gt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Ct(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Ct(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Ct(n,"minItems",e.exactLength.value,e.exactLength.message,t),Ct(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function jye(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Ct(n,"minimum",r.value,r.message,t):Ct(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ct(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ct(n,"maximum",r.value,r.message,t):Ct(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ct(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ct(n,"multipleOf",r.value,r.message,t);break}return n}function Eye(){return{type:"boolean"}}function Sye(e,t){return gt(e.type._def,t)}const Oye=(e,t)=>gt(e.innerType._def,t);function I8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>I8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Cye(e,t)}}const Cye=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Ct(n,"minimum",r.value,r.message,t);break;case"max":Ct(n,"maximum",r.value,r.message,t);break}return n};function Nye(e,t){return{...gt(e.innerType._def,t),default:e.defaultValue()}}function kye(e,t){return t.effectStrategy==="input"?gt(e.schema._def,t):{}}function Mye(e){return{type:"string",enum:e.values}}const Aye=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Pye(e,t){const n=[gt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),gt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(Aye(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Tye(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let EE;const bs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(EE===void 0&&(EE=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),EE),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function R8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Iye(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":Ct(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":Ct(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ya(n,"email",a.message,t);break;case"format:idn-email":ya(n,"idn-email",a.message,t);break;case"pattern:zod":ga(n,bs.email,a.message,t);break}break;case"url":ya(n,"uri",a.message,t);break;case"uuid":ya(n,"uuid",a.message,t);break;case"regex":ga(n,a.regex,a.message,t);break;case"cuid":ga(n,bs.cuid,a.message,t);break;case"cuid2":ga(n,bs.cuid2,a.message,t);break;case"startsWith":ga(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":ga(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":ya(n,"date-time",a.message,t);break;case"date":ya(n,"date",a.message,t);break;case"time":ya(n,"time",a.message,t);break;case"duration":ya(n,"duration",a.message,t);break;case"length":Ct(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),Ct(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{ga(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&ya(n,"ipv4",a.message,t),a.version!=="v4"&&ya(n,"ipv6",a.message,t);break}case"emoji":ga(n,bs.emoji,a.message,t);break;case"ulid":{ga(n,bs.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ya(n,"binary",a.message,t);break}case"contentEncoding:base64":{Ct(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{ga(n,bs.base64,a.message,t);break}}break}case"nanoid":ga(n,bs.nanoid,a.message,t)}return n}const Iye=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),ya=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Ct(e,"format",t,n,r)},ga=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:D8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Ct(e,"pattern",D8(t,r),n,r)},D8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function L8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===Q.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:gt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:gt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===Q.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(R8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===Q.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Rye(e,t){if(t.mapStrategy==="record")return L8(e,t);const n=gt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=gt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Dye(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Lye(){return{not:{}}}function $ye(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const oy={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Fye(e,t){if(t.target==="openApi3")return $8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in oy&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=oy[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return $8(e,t)}const $8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>gt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Bye(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:oy[e.innerType._def.typeName],nullable:!0}:{type:[oy[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=gt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=gt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function zye(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",T8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Ct(n,"minimum",r.value,r.message,t):Ct(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ct(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ct(n,"maximum",r.value,r.message,t):Ct(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ct(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ct(n,"multipleOf",r.value,r.message,t);break}return n}function Uye(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":gt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":gt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Vye(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=gt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Uye(e,t)};return n.required.length||delete n.required,n}const Wye=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return gt(e.innerType._def,t);const n=gt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Hye=(e,t)=>{if(t.pipeStrategy==="input")return gt(e.in._def,t);if(t.pipeStrategy==="output")return gt(e.out._def,t);const n=gt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=gt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function qye(e,t){return gt(e.type._def,t)}function Kye(e,t){const n={type:"array",uniqueItems:!0,items:gt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Ct(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Ct(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Zye(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>gt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:gt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>gt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Gye(){return{not:{}}}function Xye(){return{}}const Jye=(e,t)=>gt(e.innerType._def,t);function gt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==gye)return s}if(r&&!n){const s=Yye(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=ege(e,e.typeName,t);return o&&tge(e,t,o),a.jsonSchema=o,o}const Yye=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Qye(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Qye=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},ege=(e,t,n)=>{switch(t){case Q.ZodString:return R8(e,n);case Q.ZodNumber:return zye(e,n);case Q.ZodObject:return Vye(e,n);case Q.ZodBigInt:return jye(e,n);case Q.ZodBoolean:return Eye();case Q.ZodDate:return I8(e,n);case Q.ZodUndefined:return Gye();case Q.ZodNull:return $ye(n);case Q.ZodArray:return _ye(e,n);case Q.ZodUnion:case Q.ZodDiscriminatedUnion:return Fye(e,n);case Q.ZodIntersection:return Pye(e,n);case Q.ZodTuple:return Zye(e,n);case Q.ZodRecord:return L8(e,n);case Q.ZodLiteral:return Tye(e,n);case Q.ZodEnum:return Mye(e);case Q.ZodNativeEnum:return Dye(e);case Q.ZodNullable:return Bye(e,n);case Q.ZodOptional:return Wye(e,n);case Q.ZodMap:return Rye(e,n);case Q.ZodSet:return Kye(e,n);case Q.ZodLazy:return gt(e.getter()._def,n);case Q.ZodPromise:return qye(e,n);case Q.ZodNaN:case Q.ZodNever:return Lye();case Q.ZodEffects:return kye(e,n);case Q.ZodAny:return xye();case Q.ZodUnknown:return Xye();case Q.ZodDefault:return Nye(e,n);case Q.ZodBranded:return Sye(e,n);case Q.ZodReadonly:return Jye(e,n);case Q.ZodCatch:return Oye(e,n);case Q.ZodPipeline:return Hye(e,n);case Q.ZodFunction:case Q.ZodVoid:case Q.ZodSymbol:return;default:return(r=>{})()}},tge=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),nge=(e,t)=>{const n=wye(t),r=void 0,a=t==null?void 0:t.name,o=gt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},Xc="0.5.0";let F8=!1,Yd,B8,z8,SE,U8,V8,W8,H8,q8;function rge(e,t={auto:!1}){if(F8)throw new Error(`you must \`import 'groq-sdk/shims/${e.kind}'\` before importing anything else from groq-sdk`);if(Yd)throw new Error(`can't \`import 'groq-sdk/shims/${e.kind}'\` after \`import 'groq-sdk/shims/${Yd}'\``);F8=t.auto,Yd=e.kind,B8=e.fetch,z8=e.FormData,SE=e.File,U8=e.ReadableStream,V8=e.getMultipartRequestOptions,W8=e.getDefaultAgent,H8=e.fileFromPath,q8=e.isFsReadStream}class age{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function oge({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'groq-sdk'`:\n- `import 'groq-sdk/shims/node'` (if you're running on Node)\n- `import 'groq-sdk/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new age(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/groq/groq-typescript#file-uploads")},isFsReadStream:i=>!1}}Yd||rge(oge(),{auto:!0});class va extends Error{}class $n extends va{constructor(t,n,r,a){super(`${$n.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.error=n}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t)return new iy({cause:AE(n)});const o=n;return t===400?new Z8(t,o,r,a):t===401?new G8(t,o,r,a):t===403?new X8(t,o,r,a):t===404?new J8(t,o,r,a):t===409?new Y8(t,o,r,a):t===422?new Q8(t,o,r,a):t===429?new eF(t,o,r,a):t>=500?new tF(t,o,r,a):new $n(t,o,r,a)}}class OE extends $n{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class iy extends $n{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class K8 extends iy{constructor({message:t}={}){super({message:t??"Request timed out."})}}class Z8 extends $n{constructor(){super(...arguments),this.status=400}}class G8 extends $n{constructor(){super(...arguments),this.status=401}}class X8 extends $n{constructor(){super(...arguments),this.status=403}}class J8 extends $n{constructor(){super(...arguments),this.status=404}}class Y8 extends $n{constructor(){super(...arguments),this.status=409}}class Q8 extends $n{constructor(){super(...arguments),this.status=422}}class eF extends $n{constructor(){super(...arguments),this.status=429}}class tF extends $n{}class Jc{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;const a=new ige;async function*o(){if(!t.body)throw n.abort(),new va("Attempted to iterate over a response with no body");const s=new ws,c=nF(t.body);for await(const l of c)for(const u of s.decode(l)){const d=a.decode(u);d&&(yield d)}for(const l of s.flush()){const u=a.decode(l);u&&(yield u)}}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(const c of o())if(!s){if(c.data.startsWith("[DONE]")){s=!0;continue}if(c.event===null){let l;try{l=JSON.parse(c.data)}catch(u){throw console.error("Could not parse message into JSON:",c.data),console.error("From chunk:",c.raw),u}if(l&&l.error)throw new $n(void 0,l.error,void 0,void 0);yield l}}s=!0}catch(c){if(c instanceof Error&&c.name==="AbortError")return;throw c}finally{s||n.abort()}}return new Jc(i,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new ws,s=nF(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new Jc(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new Jc(()=>a(t),this.controller),new Jc(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new U8({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}}class ige{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,r,a]=sge(t,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}class ws{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=ws.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(ws.NEWLINE_REGEXP);return a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof En<"u"){if(t instanceof En)return t.toString();if(t instanceof Uint8Array)return En.from(t).toString();throw new va(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new va(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new va("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}ws.NEWLINE_CHARS=new Set([`
`,"\r","\v","\f","","","","\x85","\u2028","\u2029"]),ws.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function sge(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function nF(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const rF=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",aF=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&CE(e),CE=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",cge=e=>aF(e)||rF(e)||q8(e);async function oF(e,t,n){var a;if(e=await e,n??(n=aF(e)?{lastModified:e.lastModified,type:e.type}:{}),rF(e)){const o=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new SE([o],t,n)}const r=await lge(e);if(t||(t=dge(e)??"unknown_file"),!n.type){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new SE(r,t,n)}async function lge(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(CE(e))t.push(await e.arrayBuffer());else if(pge(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${uge(e)}`);return t}function uge(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function dge(e){var t;return NE(e.name)||NE(e.filename)||((t=NE(e.path))==null?void 0:t.split(/[\\/]/).pop())}const NE=e=>{if(typeof e=="string")return e;if(typeof En<"u"&&e instanceof En)return String(e)},pge=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",iF=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",sF=async e=>{const t=await fge(e.body);return V8(t,e)},fge=async e=>{const t=new z8;return await Promise.all(Object.entries(e||{}).map(([n,r])=>kE(t,n,r))),t},kE=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(cge(n)){const r=await oF(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>kE(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>kE(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Yc={};async function cF(e){const{response:t}=e;if(e.options.stream)return Qc("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Jc.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return Qc("response",t.status,t.url,t.headers,a),a}const r=await t.text();return Qc("response",t.status,t.url,t.headers,r),r}class sy extends Promise{constructor(t,n=cF){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new sy(this.responsePromise,async n=>t(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class hge{constructor({baseURL:t,maxRetries:n=2,timeout:r=6e4,httpAgent:a,fetch:o}){this.baseURL=t,this.maxRetries=ME("maxRetries",n),this.timeout=ME("timeout",r),this.httpAgent=a,this.fetch=o??B8}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...bge(),...this.authHeaders(t)}}validateHeaders(t,n){}defaultIdempotencyKey(){return`stainless-node-retry-${Oge()}`}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,r){return this.request(Promise.resolve(r).then(async a=>{const o=a&&CE(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:t,path:n,...a,body:o}}))}getAPIList(t,n,r){return this.requestAPIList(n,{method:"get",path:t,...r})}calculateContentLength(t){if(typeof t=="string"){if(typeof En<"u")return En.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t){var f;const{method:n,path:r,query:a,headers:o={}}=t,i=ArrayBuffer.isView(t.body)||t.__binaryRequest&&typeof t.body=="string"?t.body:iF(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,s=this.calculateContentLength(i),c=this.buildURL(r,a);"timeout"in t&&ME("timeout",t.timeout);const l=t.timeout??this.timeout,u=t.httpAgent??this.httpAgent??W8(c),d=l+1e3;typeof((f=u==null?void 0:u.options)==null?void 0:f.timeout)=="number"&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const p=this.buildHeaders({options:t,headers:o,contentLength:s});return{req:{method:n,...i&&{body:i},headers:p,...u&&{agent:u},signal:t.signal??null},url:c,timeout:l}}buildHeaders({options:t,headers:n,contentLength:r}){const a={};r&&(a["content-length"]=r);const o=this.defaultHeaders(t);return fF(a,o),fF(a,n),iF(t.body)&&Yd!=="node"&&delete a["content-type"],this.validateHeaders(a,n),a}async prepareOptions(t){}async prepareRequest(t,{url:n,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(n=>[...n])):{...t}:{}}makeStatusError(t,n,r,a){return $n.generate(t,n,r,a)}request(t,n=null){return new sy(this.makeRequest(t,n))}async makeRequest(t,n){var u,d;const r=await t;n==null&&(n=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:a,url:o,timeout:i}=this.buildRequest(r);if(await this.prepareRequest(a,{url:o,options:r}),Qc("request",o,r,a.headers),(u=r.signal)==null?void 0:u.aborted)throw new OE;const s=new AbortController,c=await this.fetchWithTimeout(o,a,i,s).catch(AE);if(c instanceof Error){if((d=r.signal)!=null&&d.aborted)throw new OE;if(n)return this.retryRequest(r,n);throw c.name==="AbortError"?new K8:new iy({cause:c})}const l=yge(c.headers);if(!c.ok){if(n&&this.shouldRetry(c)){const y=`retrying, ${n} attempts remaining`;return Qc(`response (error; ${y})`,c.status,o,l),this.retryRequest(r,n,l)}const p=await c.text().catch(y=>AE(y).message),f=wge(p),m=f?void 0:p;throw Qc(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,l,m),this.makeStatusError(c.status,f,m,l)}return{response:c,options:r,controller:s}}requestAPIList(t,n){const r=this.makeRequest(n,null);return new mge(this,r,t)}buildURL(t,n){const r=_ge(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return Ege(a)||(n={...a,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(t){return Object.entries(t).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new va(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,n,r,a){const{signal:o,...i}=n||{};o&&o.addEventListener("abort",()=>a.abort());const s=setTimeout(()=>a.abort(),r);return this.getRequestClient().fetch.call(void 0,t,{signal:a.signal,...i}).finally(()=>{clearTimeout(s)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,r){let a;const o=r==null?void 0:r["retry-after-ms"];if(o){const s=parseFloat(o);Number.isNaN(s)||(a=s)}const i=r==null?void 0:r["retry-after"];if(i&&!a){const s=parseFloat(i);Number.isNaN(s)?a=Date.parse(i)-Date.now():a=s*1e3}if(!(a&&0<=a&&a<60*1e3)){const s=t.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,s)}return await jge(a),this.makeRequest(t,n-1)}calculateDefaultRetryTimeoutMillis(t,n){const r=n-t,a=Math.min(.5*Math.pow(2,r),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Xc}`}}class mge extends sy{constructor(t,n,r){super(n,async a=>new r(t,a.response,await cF(a),a.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}const yge=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),gge=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xc,"X-Stainless-OS":uF(Deno.build.os),"X-Stainless-Arch":lF(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":Sn.version};if(Object.prototype.toString.call(typeof Sn<"u"?Sn:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xc,"X-Stainless-OS":uF(Sn.platform),"X-Stainless-Arch":lF(Sn.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":Sn.version};const e=vge();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function vge(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const lF=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",uF=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let dF;const bge=()=>dF??(dF=gge()),wge=e=>{try{return JSON.parse(e)}catch{return}},xge=new RegExp("^(?:[a-z]+:)?//","i"),_ge=e=>xge.test(e),jge=e=>new Promise(t=>setTimeout(t,e)),ME=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new va(`${e} must be an integer`);if(t<0)throw new va(`${e} must be a positive integer`);return t},AE=e=>e instanceof Error?e:new Error(e),pF=e=>{var t,n,r,a;if(typeof Sn<"u")return((t=Yc==null?void 0:Yc[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function Ege(e){if(!e)return!0;for(const t in e)return!1;return!0}function Sge(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function fF(e,t){for(const n in t){if(!Sge(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function Qc(e,...t){typeof Sn<"u"&&(Yc==null?void 0:Yc.DEBUG)==="true"&&console.log(`Groq:DEBUG:${e}`,...t)}const Oge=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),Cge=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class Ei{constructor(t){this._client=t}}class cy extends Ei{create(t,n){return this._client.post("/openai/v1/audio/transcriptions",sF({body:t,...n}))}}cy||(cy={});class ly extends Ei{create(t,n){return this._client.post("/openai/v1/audio/translations",sF({body:t,...n}))}}ly||(ly={});class uy extends Ei{constructor(){super(...arguments),this.transcriptions=new cy(this._client),this.translations=new ly(this._client)}}(function(e){e.Transcriptions=cy,e.Translations=ly})(uy||(uy={}));let dy=class extends Ei{create(e,t){return this._client.post("/openai/v1/chat/completions",{body:e,...t,stream:e.stream??!1})}};dy||(dy={});class py extends Ei{constructor(){super(...arguments),this.completions=new dy(this._client)}}(function(e){e.Completions=dy})(py||(py={}));class fy extends Ei{}fy||(fy={});class hy extends Ei{create(t,n){return this._client.post("/openai/v1/embeddings",{body:t,...n})}}hy||(hy={});class my extends Ei{retrieve(t,n){return this._client.get(`/openai/v1/models/${t}`,n)}list(t){return this._client.get("/openai/v1/models",t)}delete(t,n){return this._client.delete(`/openai/v1/models/${t}`,n)}}my||(my={});var hF;class on extends hge{constructor({baseURL:t=pF("GROQ_BASE_URL"),apiKey:n=pF("GROQ_API_KEY"),...r}={}){if(n===void 0)throw new va("The GROQ_API_KEY environment variable is missing or empty; either provide it, or instantiate the Groq client with an apiKey option, like new Groq({ apiKey: 'My API Key' }).");const a={apiKey:n,...r,baseURL:t||"https://api.groq.com"};if(!a.dangerouslyAllowBrowser&&Cge())throw new va(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Groq({ apiKey, dangerouslyAllowBrowser: true })`);super({baseURL:a.baseURL,timeout:a.timeout??6e4,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new fy(this),this.chat=new py(this),this.embeddings=new hy(this),this.audio=new uy(this),this.models=new my(this),this._options=a,this.apiKey=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}}hF=on,on.Groq=hF,on.GroqError=va,on.APIError=$n,on.APIConnectionError=iy,on.APIConnectionTimeoutError=K8,on.APIUserAbortError=OE,on.NotFoundError=J8,on.ConflictError=Y8,on.RateLimitError=eF,on.BadRequestError=Z8,on.AuthenticationError=G8,on.InternalServerError=tF,on.PermissionDeniedError=X8,on.UnprocessableEntityError=Q8,on.toFile=oF,on.fileFromPath=H8,function(e){e.Completions=fy,e.Chat=py,e.Embeddings=hy,e.Audio=uy,e.Models=my}(on||(on={}));function Nge(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";default:throw new Error(`Unknown message type: ${t}`)}}function mF(e){return e.map(t=>{var r;if(typeof t.content!="string")throw new Error("Non string message content not supported");const n={role:Nge(t),content:t.content,name:t.name,function_call:t.additional_kwargs.function_call,tool_calls:t.additional_kwargs.tool_calls,tool_call_id:t.tool_call_id};return Mv(t)&&((r=t.tool_calls)!=null&&r.length)?n.tool_calls=t.tool_calls.map(d8):(t.additional_kwargs.tool_calls!=null&&(n.tool_calls=t.additional_kwargs.tool_calls),t.tool_call_id!=null&&(n.tool_call_id=t.tool_call_id)),n})}function kge(e,t){const n=e.tool_calls;switch(e.role){case"assistant":{const r=[],a=[];for(const o of n??[])try{r.push(bE(o,{returnId:!0}))}catch(i){a.push(p8(o,i.message))}return new Ta({content:e.content||"",additional_kwargs:{tool_calls:n},tool_calls:r,invalid_tool_calls:a,usage_metadata:t})}default:return new Av(e.content||"",e.role??"unknown")}}function Mge(e,t){if(e!=null&&e.length)return e.map(n=>{var r,a;return{id:n.id,name:(r=n.function)==null?void 0:r.name,args:(a=n.function)==null?void 0:a.arguments,type:"tool_call_chunk",index:t}})}function Age(e,t,n){const{role:r}=e,a=e.content??"";let o;e.function_call?o={function_call:e.function_call}:e.tool_calls?o={tool_calls:e.tool_calls}:o={};let i,s;if(n!=null&&n.usage&&(i={input_tokens:n.usage.prompt_tokens,output_tokens:n.usage.completion_tokens,total_tokens:n.usage.total_tokens},s=n.id),r==="user")return{message:new ZG({content:a})};if(r==="assistant"){const c=Mge(e.tool_calls,t);return{message:new nu({content:a,additional_kwargs:o,tool_call_chunks:c?c.map(l=>({type:l.type,args:l.args,index:l.index})):void 0,usage_metadata:i,id:s}),toolCallData:c?c.map(l=>({id:l.id??"",name:l.name??"",index:l.index??t,type:"tool_call_chunk"})):void 0}}else return r==="system"?{message:new qk({content:a})}:{message:new GG({content:a,role:r})}}class Pge extends Ja{static lc_name(){return"ChatGroq"}_llmType(){return"groq"}get lc_secrets(){return{apiKey:"GROQ_API_KEY"}}constructor(t){super(t??{}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","groq"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0});const n=(t==null?void 0:t.apiKey)||gn("GROQ_API_KEY");if(!n)throw new Error('Groq API key not found. Please set the GROQ_API_KEY environment variable or provide the key into "apiKey"');const r={"User-Agent":"langchainjs",...(t==null?void 0:t.defaultHeaders)??{}};this.client=new on({apiKey:n,dangerouslyAllowBrowser:!0,baseURL:t==null?void 0:t.baseUrl,timeout:t==null?void 0:t.timeout,httpAgent:t==null?void 0:t.httpAgent,fetch:t==null?void 0:t.fetch,maxRetries:0,defaultHeaders:r,defaultQuery:t==null?void 0:t.defaultQuery}),this.apiKey=n,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.streaming=(t==null?void 0:t.streaming)??this.streaming,this.stop=(t==null?void 0:t.stopSequences)??(typeof(t==null?void 0:t.stop)=="string"?[t.stop]:t==null?void 0:t.stop)??[],this.stopSequences=this.stop,this.maxTokens=t==null?void 0:t.maxTokens}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"groq",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??this.temperature,ls_max_tokens:n.max_tokens??this.maxTokens,ls_stop:t.stop}}async completionWithRetry(t,n){return this.caller.call(async()=>this.client.chat.completions.create(t,n))}invocationParams(t){const n=super.invocationParams(t);return t.tool_choice!==void 0&&(n.tool_choice=t.tool_choice),t.tools!==void 0&&(n.tools=t.tools),t.response_format!==void 0&&(n.response_format=t.response_format),{...n,stop:t.stop??this.stopSequences,model:this.model,temperature:this.temperature,max_tokens:this.maxTokens}}bindTools(t,n){return this.bind({tools:t.map(r=>rye(r)),...n})}async*_streamResponseChunks(t,n,r){var u,d;const a=this.invocationParams(n),o=mF(t),i=await this.completionWithRetry({...a,messages:o,stream:!0},{signal:n==null?void 0:n.signal,headers:n==null?void 0:n.headers});let s="";const c=[];let l;for await(const p of i){l=p;const f=p==null?void 0:p.choices[0];if(!f)continue;(u=f.delta)!=null&&u.role&&(s=f.delta.role);const{message:m,toolCallData:y}=Age({...f.delta,role:s},f.index,p.x_groq);if(y){const b=y.filter(w=>c.every(_=>_.id!==w.id));c.push(...b),yield new qi({message:new nu({content:"",tool_call_chunks:b}),text:""})}const v=new qi({message:m,text:f.delta.content??"",generationInfo:{finishReason:f.finish_reason}});yield v,r==null||r.handleLLMNewToken(v.text??"")}if(l&&("choices"in l&&delete l.choices,yield new qi({message:new nu({content:"",response_metadata:l}),text:""})),(d=n.signal)==null?void 0:d.aborted)throw new Error("AbortError")}async _generate(t,n,r){var a;if(this.streaming){const o={},i=this._streamResponseChunks(t,n,r),s={};for await(const c of i){const l=((a=c.generationInfo)==null?void 0:a.completion)??0;s[l]===void 0?s[l]=c:s[l]=s[l].concat(c)}return{generations:Object.entries(s).sort(([c],[l])=>parseInt(c,10)-parseInt(l,10)).map(([c,l])=>l),llmOutput:{estimatedTokenUsage:o}}}else return this._generateNonStreaming(t,n,r)}async _generateNonStreaming(t,n,r){var l;const a={},o=this.invocationParams(n),i=mF(t),s=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,headers:n==null?void 0:n.headers});if("usage"in s&&s.usage){const{completion_tokens:u,prompt_tokens:d,total_tokens:p}=s.usage;u&&(a.completionTokens=(a.completionTokens??0)+u),d&&(a.promptTokens=(a.promptTokens??0)+d),p&&(a.totalTokens=(a.totalTokens??0)+p)}const c=[];if("choices"in s&&s.choices)for(const u of s.choices){const d=((l=u.message)==null?void 0:l.content)??"";let p;a.totalTokens!==void 0&&(p={input_tokens:a.promptTokens??0,output_tokens:a.completionTokens??0,total_tokens:a.totalTokens});const f={text:d,message:kge(u.message??{role:"assistant"},p)};f.generationInfo={...u.finish_reason?{finish_reason:u.finish_reason}:{},...u.logprobs?{logprobs:u.logprobs}:{}},c.push(f)}return{generations:c,llmOutput:{tokenUsage:a}}}withStructuredOutput(t,n){const r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw;let s=a??"extract",c,l;if(o==="jsonMode")l=this.bind({response_format:{type:"json_object"}}),Jd(r)?c=gE.fromZodSchema(r):c=new vE;else if(Jd(r)){const f=nge(r);l=this.bind({tools:[{type:"function",function:{name:s,description:f.description,parameters:f}}],tool_choice:{type:"function",function:{name:s}}}),c=new Ym({returnSingle:!0,keyName:s,zodSchema:r})}else{let f;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(f=r,s=r.name):(s=r.title??s,f={name:s,description:r.description??"",parameters:r}),l=this.bind({tools:[{type:"function",function:f}],tool_choice:{type:"function",function:{name:s}}}),c=new Ym({returnSingle:!0,keyName:s})}if(!i)return l.pipe(c).withConfig({runName:"ChatGroqStructuredOutput"});const u=ji.assign({parsed:(f,m)=>c.invoke(f.raw,m)}),d=ji.assign({parsed:()=>null}),p=u.withFallbacks({fallbacks:[d]});return kv.from([{raw:l},p]).withConfig({runName:"ChatGroqStructuredOutput"})}}var yF;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(yF||(yF={}));var gF;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(gF||(gF={}));var vF;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(vF||(vF={}));const bF=["user","model","function","system"];var wF;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(wF||(wF={}));var xF;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(xF||(xF={}));var _F;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(_F||(_F={}));var jF;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(jF||(jF={}));var Qd;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER"})(Qd||(Qd={}));var EF;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(EF||(EF={}));var el;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(el||(el={}));var SF;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(SF||(SF={}));class ir extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class tl extends ir{constructor(t,n){super(t),this.response=n}}class OF extends ir{constructor(t,n,r,a){super(t),this.status=n,this.statusText=r,this.errorDetails=a}}class Si extends ir{}const Tge="https://generativelanguage.googleapis.com",Ige="v1beta",Rge="0.21.0",Dge="genai-js";var xs;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(xs||(xs={}));class Lge{constructor(t,n,r,a,o){this.model=t,this.task=n,this.apiKey=r,this.stream=a,this.requestOptions=o}toString(){var t,n;const r=((t=this.requestOptions)===null||t===void 0?void 0:t.apiVersion)||Ige;let a=`${((n=this.requestOptions)===null||n===void 0?void 0:n.baseUrl)||Tge}/${r}/${this.model}:${this.task}`;return this.stream&&(a+="?alt=sse"),a}}function $ge(e){const t=[];return e!=null&&e.apiClient&&t.push(e.apiClient),t.push(`${Dge}/${Rge}`),t.join(" ")}async function Fge(e){var t;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",$ge(e.requestOptions)),n.append("x-goog-api-key",e.apiKey);let r=(t=e.requestOptions)===null||t===void 0?void 0:t.customHeaders;if(r){if(!(r instanceof Headers))try{r=new Headers(r)}catch(a){throw new Si(`unable to convert customHeaders value ${JSON.stringify(r)} to Headers: ${a.message}`)}for(const[a,o]of r.entries()){if(a==="x-goog-api-key")throw new Si(`Cannot set reserved header name ${a}`);if(a==="x-goog-api-client")throw new Si(`Header name ${a} can only be set using the apiClient field`);n.append(a,o)}}return n}async function Bge(e,t,n,r,a,o){const i=new Lge(e,t,n,r,o);return{url:i.toString(),fetchOptions:Object.assign(Object.assign({},Wge(o)),{method:"POST",headers:await Fge(i),body:a})}}async function ep(e,t,n,r,a,o={},i=fetch){const{url:s,fetchOptions:c}=await Bge(e,t,n,r,a,o);return zge(s,c,i)}async function zge(e,t,n=fetch){let r;try{r=await n(e,t)}catch(a){Uge(a,e)}return r.ok||await Vge(r,e),r}function Uge(e,t){let n=e;throw e instanceof OF||e instanceof Si||(n=new ir(`Error fetching from ${t.toString()}: ${e.message}`),n.stack=e.stack),n}async function Vge(e,t){let n="",r;try{const a=await e.json();n=a.error.message,a.error.details&&(n+=` ${JSON.stringify(a.error.details)}`,r=a.error.details)}catch{}throw new OF(`Error fetching from ${t.toString()}: [${e.status} ${e.statusText}] ${n}`,e.status,e.statusText,r)}function Wge(e){const t={};if((e==null?void 0:e.signal)!==void 0||(e==null?void 0:e.timeout)>=0){const n=new AbortController;(e==null?void 0:e.timeout)>=0&&setTimeout(()=>n.abort(),e.timeout),e!=null&&e.signal&&e.signal.addEventListener("abort",()=>{n.abort()}),t.signal=n.signal}return t}function PE(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),yy(e.candidates[0]))throw new tl(`${Oi(e)}`,e);return Hge(e)}else if(e.promptFeedback)throw new tl(`Text not available. ${Oi(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),yy(e.candidates[0]))throw new tl(`${Oi(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),CF(e)[0]}else if(e.promptFeedback)throw new tl(`Function call not available. ${Oi(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),yy(e.candidates[0]))throw new tl(`${Oi(e)}`,e);return CF(e)}else if(e.promptFeedback)throw new tl(`Function call not available. ${Oi(e)}`,e)},e}function Hge(e){var t,n,r,a;const o=[];if(!((n=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||n===void 0)&&n.parts)for(const i of(a=(r=e.candidates)===null||r===void 0?void 0:r[0].content)===null||a===void 0?void 0:a.parts)i.text&&o.push(i.text),i.executableCode&&o.push("\n```"+i.executableCode.language+`
`+i.executableCode.code+"\n```\n"),i.codeExecutionResult&&o.push("\n```\n"+i.codeExecutionResult.output+"\n```\n");return o.length>0?o.join(""):""}function CF(e){var t,n,r,a;const o=[];if(!((n=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||n===void 0)&&n.parts)for(const i of(a=(r=e.candidates)===null||r===void 0?void 0:r[0].content)===null||a===void 0?void 0:a.parts)i.functionCall&&o.push(i.functionCall);if(o.length>0)return o}const qge=[Qd.RECITATION,Qd.SAFETY,Qd.LANGUAGE];function yy(e){return!!e.finishReason&&qge.includes(e.finishReason)}function Oi(e){var t,n,r;let a="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)a+="Response was blocked",!((t=e.promptFeedback)===null||t===void 0)&&t.blockReason&&(a+=` due to ${e.promptFeedback.blockReason}`),!((n=e.promptFeedback)===null||n===void 0)&&n.blockReasonMessage&&(a+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((r=e.candidates)===null||r===void 0)&&r[0]){const o=e.candidates[0];yy(o)&&(a+=`Candidate was blocked due to ${o.finishReason}`,o.finishMessage&&(a+=`: ${o.finishMessage}`))}return a}function tp(e){return this instanceof tp?(this.v=e,this):new tp(e)}function Kge(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),a,o=[];return a={},i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(p){r[p]&&(a[p]=function(f){return new Promise(function(m,y){o.push([p,f,m,y])>1||s(p,f)})})}function s(p,f){try{c(r[p](f))}catch(m){d(o[0][3],m)}}function c(p){p.value instanceof tp?Promise.resolve(p.value.v).then(l,u):d(o[0][2],p)}function l(p){s("next",p)}function u(p){s("throw",p)}function d(p,f){p(f),o.shift(),o.length&&s(o[0][0],o[0][1])}}const NF=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Zge(e){const t=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=Jge(t),[r,a]=n.tee();return{stream:Xge(r),response:Gge(a)}}async function Gge(e){const t=[],n=e.getReader();for(;;){const{done:r,value:a}=await n.read();if(r)return PE(Yge(t));t.push(a)}}function Xge(e){return Kge(this,arguments,function*(){const t=e.getReader();for(;;){const{value:n,done:r}=yield tp(t.read());if(r)break;yield yield tp(PE(n))}})}function Jge(e){const t=e.getReader();return new ReadableStream({start(n){let r="";return a();function a(){return t.read().then(({value:o,done:i})=>{if(i){if(r.trim()){n.error(new ir("Failed to parse stream"));return}n.close();return}r+=o;let s=r.match(NF),c;for(;s;){try{c=JSON.parse(s[1])}catch{n.error(new ir(`Error parsing JSON response: "${s[1]}"`));return}n.enqueue(c),r=r.substring(s[0].length),s=r.match(NF)}return a()})}}})}function Yge(e){const t=e[e.length-1],n={promptFeedback:t==null?void 0:t.promptFeedback};for(const r of e){if(r.candidates)for(const a of r.candidates){const o=a.index;if(n.candidates||(n.candidates=[]),n.candidates[o]||(n.candidates[o]={index:a.index}),n.candidates[o].citationMetadata=a.citationMetadata,n.candidates[o].groundingMetadata=a.groundingMetadata,n.candidates[o].finishReason=a.finishReason,n.candidates[o].finishMessage=a.finishMessage,n.candidates[o].safetyRatings=a.safetyRatings,a.content&&a.content.parts){n.candidates[o].content||(n.candidates[o].content={role:a.content.role||"user",parts:[]});const i={};for(const s of a.content.parts)s.text&&(i.text=s.text),s.functionCall&&(i.functionCall=s.functionCall),s.executableCode&&(i.executableCode=s.executableCode),s.codeExecutionResult&&(i.codeExecutionResult=s.codeExecutionResult),Object.keys(i).length===0&&(i.text=""),n.candidates[o].content.parts.push(i)}}r.usageMetadata&&(n.usageMetadata=r.usageMetadata)}return n}async function kF(e,t,n,r){const a=await ep(t,xs.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(n),r);return Zge(a)}async function MF(e,t,n,r){const a=await(await ep(t,xs.GENERATE_CONTENT,e,!1,JSON.stringify(n),r)).json();return{response:PE(a)}}function AF(e){if(e!=null){if(typeof e=="string")return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function np(e){let t=[];if(typeof e=="string")t=[{text:e}];else for(const n of e)typeof n=="string"?t.push({text:n}):t.push(n);return Qge(t)}function Qge(e){const t={role:"user",parts:[]},n={role:"function",parts:[]};let r=!1,a=!1;for(const o of e)"functionResponse"in o?(n.parts.push(o),a=!0):(t.parts.push(o),r=!0);if(r&&a)throw new ir("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!r&&!a)throw new ir("No content is provided for sending chat message.");return r?t:n}function eve(e,t){var n;let r={model:t==null?void 0:t.model,generationConfig:t==null?void 0:t.generationConfig,safetySettings:t==null?void 0:t.safetySettings,tools:t==null?void 0:t.tools,toolConfig:t==null?void 0:t.toolConfig,systemInstruction:t==null?void 0:t.systemInstruction,cachedContent:(n=t==null?void 0:t.cachedContent)===null||n===void 0?void 0:n.name,contents:[]};const a=e.generateContentRequest!=null;if(e.contents){if(a)throw new Si("CountTokensRequest must have one of contents or generateContentRequest, not both.");r.contents=e.contents}else if(a)r=Object.assign(Object.assign({},r),e.generateContentRequest);else{const o=np(e);r.contents=[o]}return{generateContentRequest:r}}function PF(e){let t;return e.contents?t=e:t={contents:[np(e)]},e.systemInstruction&&(t.systemInstruction=AF(e.systemInstruction)),t}function tve(e){return typeof e=="string"||Array.isArray(e)?{content:np(e)}:e}const TF=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],nve={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function rve(e){let t=!1;for(const n of e){const{role:r,parts:a}=n;if(!t&&r!=="user")throw new ir(`First content should be with role 'user', got ${r}`);if(!bF.includes(r))throw new ir(`Each item should include role field. Got ${r} but valid roles are: ${JSON.stringify(bF)}`);if(!Array.isArray(a))throw new ir("Content should have 'parts' property with an array of Parts");if(a.length===0)throw new ir("Each Content should have at least one part");const o={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const s of a)for(const c of TF)c in s&&(o[c]+=1);const i=nve[r];for(const s of TF)if(!i.includes(s)&&o[s]>0)throw new ir(`Content with role '${r}' can't contain '${s}' part`);t=!0}}const IF="SILENT_ERROR";class ave{constructor(t,n,r,a={}){this.model=n,this.params=r,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,r!=null&&r.history&&(rve(r.history),this._history=r.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t,n={}){var r,a,o,i,s,c;await this._sendPromise;const l=np(t),u={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(i=this.params)===null||i===void 0?void 0:i.toolConfig,systemInstruction:(s=this.params)===null||s===void 0?void 0:s.systemInstruction,cachedContent:(c=this.params)===null||c===void 0?void 0:c.cachedContent,contents:[...this._history,l]},d=Object.assign(Object.assign({},this._requestOptions),n);let p;return this._sendPromise=this._sendPromise.then(()=>MF(this._apiKey,this.model,u,d)).then(f=>{var m;if(f.response.candidates&&f.response.candidates.length>0){this._history.push(l);const y=Object.assign({parts:[],role:"model"},(m=f.response.candidates)===null||m===void 0?void 0:m[0].content);this._history.push(y)}else{const y=Oi(f.response);y&&console.warn(`sendMessage() was unsuccessful. ${y}. Inspect response object for details.`)}p=f}),await this._sendPromise,p}async sendMessageStream(t,n={}){var r,a,o,i,s,c;await this._sendPromise;const l=np(t),u={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(i=this.params)===null||i===void 0?void 0:i.toolConfig,systemInstruction:(s=this.params)===null||s===void 0?void 0:s.systemInstruction,cachedContent:(c=this.params)===null||c===void 0?void 0:c.cachedContent,contents:[...this._history,l]},d=Object.assign(Object.assign({},this._requestOptions),n),p=kF(this._apiKey,this.model,u,d);return this._sendPromise=this._sendPromise.then(()=>p).catch(f=>{throw new Error(IF)}).then(f=>f.response).then(f=>{if(f.candidates&&f.candidates.length>0){this._history.push(l);const m=Object.assign({},f.candidates[0].content);m.role||(m.role="model"),this._history.push(m)}else{const m=Oi(f);m&&console.warn(`sendMessageStream() was unsuccessful. ${m}. Inspect response object for details.`)}}).catch(f=>{f.message!==IF&&console.error(f)}),p}}async function ove(e,t,n,r){return(await ep(t,xs.COUNT_TOKENS,e,!1,JSON.stringify(n),r)).json()}async function ive(e,t,n,r){return(await ep(t,xs.EMBED_CONTENT,e,!1,JSON.stringify(n),r)).json()}async function sve(e,t,n,r){const a=n.requests.map(o=>Object.assign(Object.assign({},o),{model:t}));return(await ep(t,xs.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:a}),r)).json()}class RF{constructor(t,n,r={}){this.apiKey=t,this._requestOptions=r,n.model.includes("/")?this.model=n.model:this.model=`models/${n.model}`,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=AF(n.systemInstruction),this.cachedContent=n.cachedContent}async generateContent(t,n={}){var r;const a=PF(t),o=Object.assign(Object.assign({},this._requestOptions),n);return MF(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},a),o)}async generateContentStream(t,n={}){var r;const a=PF(t),o=Object.assign(Object.assign({},this._requestOptions),n);return kF(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},a),o)}startChat(t){var n;return new ave(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},t),this._requestOptions)}async countTokens(t,n={}){const r=eve(t,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),n);return ove(this.apiKey,this.model,r,a)}async embedContent(t,n={}){const r=tve(t),a=Object.assign(Object.assign({},this._requestOptions),n);return ive(this.apiKey,this.model,r,a)}async batchEmbedContents(t,n={}){const r=Object.assign(Object.assign({},this._requestOptions),n);return sve(this.apiKey,this.model,t,r)}}class TE{constructor(t){this.apiKey=t}getGenerativeModel(t,n){if(!t.model)throw new ir("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new RF(this.apiKey,t,n)}getGenerativeModelFromCachedContent(t,n,r){if(!t.name)throw new Si("Cached content must contain a `name` field.");if(!t.model)throw new Si("Cached content must contain a `model` field.");const a=["model","systemInstruction"];for(const i of a)if(n!=null&&n[i]&&t[i]&&(n==null?void 0:n[i])!==t[i]){if(i==="model"){const s=n.model.startsWith("models/")?n.model.replace("models/",""):n.model,c=t.model.startsWith("models/")?t.model.replace("models/",""):t.model;if(s===c)continue}throw new Si(`Different value for "${i}" specified in modelParams (${n[i]}) and cachedContent (${t[i]})`)}const o=Object.assign(Object.assign({},n),{model:t.model,tools:t.tools,toolConfig:t.toolConfig,systemInstruction:t.systemInstruction,cachedContent:t});return new RF(this.apiKey,o,r)}}const cve=Symbol("Let zodToJsonSchema decide on which parser to use"),lve={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},uve=e=>({...lve,...e}),dve=e=>{const t=uve(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function DF(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Nt(e,t,n,r,a){e[t]=n,DF(e,t,r,a)}function pve(){return{}}function fve(e,t){var r,a,o;const n={type:"array"};return(r=e.type)!=null&&r._def&&((o=(a=e.type)==null?void 0:a._def)==null?void 0:o.typeName)!==Q.ZodAny&&(n.items=vt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Nt(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Nt(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Nt(n,"minItems",e.exactLength.value,e.exactLength.message,t),Nt(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function hve(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Nt(n,"minimum",r.value,r.message,t):Nt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Nt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Nt(n,"maximum",r.value,r.message,t):Nt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Nt(n,"maximum",r.value,r.message,t));break;case"multipleOf":Nt(n,"multipleOf",r.value,r.message,t);break}return n}function mve(){return{type:"boolean"}}function LF(e,t){return vt(e.type._def,t)}const yve=(e,t)=>vt(e.innerType._def,t);function $F(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>$F(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return gve(e,t)}}const gve=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Nt(n,"minimum",r.value,r.message,t);break;case"max":Nt(n,"maximum",r.value,r.message,t);break}return n};function vve(e,t){return{...vt(e.innerType._def,t),default:e.defaultValue()}}function bve(e,t){return t.effectStrategy==="input"?vt(e.schema._def,t):{}}function wve(e){return{type:"string",enum:Array.from(e.values)}}const xve=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function _ve(e,t){const n=[vt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),vt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(xve(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function jve(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let IE;const ba={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(IE===void 0&&(IE=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),IE),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function FF(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":Nt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":Nt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":wa(n,"email",r.message,t);break;case"format:idn-email":wa(n,"idn-email",r.message,t);break;case"pattern:zod":Gn(n,ba.email,r.message,t);break}break;case"url":wa(n,"uri",r.message,t);break;case"uuid":wa(n,"uuid",r.message,t);break;case"regex":Gn(n,r.regex,r.message,t);break;case"cuid":Gn(n,ba.cuid,r.message,t);break;case"cuid2":Gn(n,ba.cuid2,r.message,t);break;case"startsWith":Gn(n,RegExp(`^${RE(r.value,t)}`),r.message,t);break;case"endsWith":Gn(n,RegExp(`${RE(r.value,t)}$`),r.message,t);break;case"datetime":wa(n,"date-time",r.message,t);break;case"date":wa(n,"date",r.message,t);break;case"time":wa(n,"time",r.message,t);break;case"duration":wa(n,"duration",r.message,t);break;case"length":Nt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),Nt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{Gn(n,RegExp(RE(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&wa(n,"ipv4",r.message,t),r.version!=="v4"&&wa(n,"ipv6",r.message,t);break}case"base64url":Gn(n,ba.base64url,r.message,t);break;case"jwt":Gn(n,ba.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&Gn(n,ba.ipv4Cidr,r.message,t),r.version!=="v4"&&Gn(n,ba.ipv6Cidr,r.message,t);break}case"emoji":Gn(n,ba.emoji(),r.message,t);break;case"ulid":{Gn(n,ba.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{wa(n,"binary",r.message,t);break}case"contentEncoding:base64":{Nt(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{Gn(n,ba.base64,r.message,t);break}}break}case"nanoid":Gn(n,ba.nanoid,r.message,t)}return n}function RE(e,t){return t.patternStrategy==="escape"?Sve(e):e}const Eve=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Sve(e){let t="";for(let n=0;n<e.length;n++)Eve.has(e[n])||(t+="\\"),t+=e[n];return t}function wa(e,t,n,r){var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Nt(e,"format",t,n,r)}function Gn(e,t,n,r){var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:BF(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Nt(e,"pattern",BF(t,r),n,r)}function BF(e,t){var c;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let a="",o=!1,i=!1,s=!1;for(let l=0;l<r.length;l++){if(o){a+=r[l],o=!1;continue}if(n.i){if(i){if(r[l].match(/[a-z]/)){s?(a+=r[l],a+=`${r[l-2]}-${r[l]}`.toUpperCase(),s=!1):r[l+1]==="-"&&((c=r[l+2])!=null&&c.match(/[a-z]/))?(a+=r[l],s=!0):a+=`${r[l]}${r[l].toUpperCase()}`;continue}}else if(r[l].match(/[a-z]/)){a+=`[${r[l]}${r[l].toUpperCase()}]`;continue}}if(n.m){if(r[l]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(r[l]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&r[l]==="."){a+=i?`${r[l]}\r
`:`[${r[l]}\r
]`;continue}a+=r[l],r[l]==="\\"?o=!0:i&&r[l]==="]"?i=!1:!i&&r[l]==="["&&(i=!0)}try{new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return a}function zF(e,t){var r,a,o,i,s,c;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===Q.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((l,u)=>({...l,[u]:vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===Q.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const{type:l,...u}=FF(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((i=e.keyType)==null?void 0:i._def.typeName)===Q.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((s=e.keyType)==null?void 0:s._def.typeName)===Q.ZodBranded&&e.keyType._def.type._def.typeName===Q.ZodString&&((c=e.keyType._def.type._def.checks)!=null&&c.length)){const{type:l,...u}=LF(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function Ove(e,t){if(t.mapStrategy==="record")return zF(e,t);const n=vt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Cve(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Nve(){return{not:{}}}function kve(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const gy={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Mve(e,t){if(t.target==="openApi3")return UF(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in gy&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=gy[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return UF(e,t)}const UF=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>vt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Ave(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:gy[e.innerType._def.typeName],nullable:!0}:{type:[gy[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=vt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=vt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Pve(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",DF(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Nt(n,"minimum",r.value,r.message,t):Nt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Nt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Nt(n,"maximum",r.value,r.message,t):Nt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Nt(n,"maximum",r.value,r.message,t));break;case"multipleOf":Nt(n,"multipleOf",r.value,r.message,t);break}return n}function Tve(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":vt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":vt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Ive(e,t){const n=t.target==="openAi",r={type:"object",...Object.entries(e.shape()).reduce((a,[o,i])=>{if(i===void 0||i._def===void 0)return a;let s=i.isOptional();s&&n&&(i instanceof t3e&&(i=i._def.innerType),i.isNullable()||(i=i.nullable()),s=!1);const c=vt(i._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});return c===void 0?a:{properties:{...a.properties,[o]:c},required:s?a.required:[...a.required,o]}},{properties:{},required:[]}),additionalProperties:Tve(e,t)};return r.required.length||delete r.required,r}const Rve=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return vt(e.innerType._def,t);const n=vt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Dve=(e,t)=>{if(t.pipeStrategy==="input")return vt(e.in._def,t);if(t.pipeStrategy==="output")return vt(e.out._def,t);const n=vt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=vt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Lve(e,t){return vt(e.type._def,t)}function $ve(e,t){const n={type:"array",uniqueItems:!0,items:vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Nt(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Nt(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Fve(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>vt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:vt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>vt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Bve(){return{not:{}}}function zve(){return{}}const Uve=(e,t)=>vt(e.innerType._def,t);function vt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==cve)return s}if(r&&!n){const s=Vve(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=Hve(e,e.typeName,t);return o&&qve(e,t,o),a.jsonSchema=o,o}const Vve=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Wve(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Wve=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Hve=(e,t,n)=>{switch(t){case Q.ZodString:return FF(e,n);case Q.ZodNumber:return Pve(e,n);case Q.ZodObject:return Ive(e,n);case Q.ZodBigInt:return hve(e,n);case Q.ZodBoolean:return mve();case Q.ZodDate:return $F(e,n);case Q.ZodUndefined:return Bve();case Q.ZodNull:return kve(n);case Q.ZodArray:return fve(e,n);case Q.ZodUnion:case Q.ZodDiscriminatedUnion:return Mve(e,n);case Q.ZodIntersection:return _ve(e,n);case Q.ZodTuple:return Fve(e,n);case Q.ZodRecord:return zF(e,n);case Q.ZodLiteral:return jve(e,n);case Q.ZodEnum:return wve(e);case Q.ZodNativeEnum:return Cve(e);case Q.ZodNullable:return Ave(e,n);case Q.ZodOptional:return Rve(e,n);case Q.ZodMap:return Ove(e,n);case Q.ZodSet:return $ve(e,n);case Q.ZodLazy:return vt(e.getter()._def,n);case Q.ZodPromise:return Lve(e,n);case Q.ZodNaN:case Q.ZodNever:return Nve();case Q.ZodEffects:return bve(e,n);case Q.ZodAny:return pve();case Q.ZodUnknown:return zve();case Q.ZodDefault:return vve(e,n);case Q.ZodBranded:return LF(e,n);case Q.ZodReadonly:return Uve(e,n);case Q.ZodCatch:return yve(e,n);case Q.ZodPipeline:return Dve(e,n);case Q.ZodFunction:case Q.ZodVoid:case Q.ZodSymbol:return;default:return(r=>{})()}},qve=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),Kve=(e,t)=>{const n=dve(t),r=void 0,a=t==null?void 0:t.name,o=vt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i};function rp(e){if(typeof e=="object"&&e!==null){const t={...e};"additionalProperties"in t&&delete t.additionalProperties,"$schema"in t&&delete t.$schema;for(const n in t)n in t&&(Array.isArray(t[n])?t[n]=t[n].map(rp):typeof t[n]=="object"&&t[n]!==null&&(t[n]=rp(t[n])));return t}return e}function VF(e){const t=rp(Kve(e)),{$schema:n,...r}=t;return r}function Zve(e){const t=rp(e),{$schema:n,...r}=t;return r}function Gve(e){const t=e._getType();return Av.isInstance(e)?e.role:t==="tool"?t:e.name??t}function Xve(e){switch(e){case"ai":case"model":return"model";case"system":return"system";case"human":return"user";case"tool":case"function":return"function";default:throw new Error(`Unknown / unsupported author: ${e}`)}}function Jve(e){if("mimeType"in e&&"data"in e)return{inlineData:{mimeType:e.mimeType,data:e.data}};if("mimeType"in e&&"fileUri"in e)return{fileData:{mimeType:e.mimeType,fileUri:e.fileUri}};throw new Error("Invalid media content")}function Yve(e,t){if(typeof e.content=="string"&&e.content!=="")return[{text:e.content}];let n=[],r=[],a=[];return"tool_calls"in e&&Array.isArray(e.tool_calls)&&e.tool_calls.length>0?n=e.tool_calls.map(o=>({functionCall:{name:o.name,args:o.args}})):e.getType()==="tool"&&e.name&&e.content?r=[{functionResponse:{name:e.name,response:e.content}}]:Array.isArray(e.content)&&(a=e.content.map(o=>{var i;if(o.type==="text")return{text:o.text};if(o.type==="executableCode")return{executableCode:o.executableCode};if(o.type==="codeExecutionResult")return{codeExecutionResult:o.codeExecutionResult};if(o.type==="image_url"){if(!t)throw new Error("This model does not support images");let s;if(typeof o.image_url=="string")s=o.image_url;else if(typeof o.image_url=="object"&&"url"in o.image_url)s=o.image_url.url;else throw new Error("Please provide image as base64 encoded data URL");const[c,l]=s.split(",");if(!c.startsWith("data:"))throw new Error("Please provide image as base64 encoded data URL");const[u,d]=c.replace(/^data:/,"").split(";");if(d!=="base64")throw new Error("Please provide image as base64 encoded data URL");return{inlineData:{data:l,mimeType:u}}}else{if(o.type==="media")return Jve(o);if(o.type==="tool_use")return{functionCall:{name:o.name,args:o.input}};if((i=o.type)!=null&&i.includes("/")&&o.type.split("/").length===2&&"data"in o&&typeof o.data=="string")return{inlineData:{mimeType:o.type,data:o.data}}}throw new Error(`Unknown content type ${o.type}`)})),[...a,...n,...r]}function WF(e,t,n=!1){return e.reduce((r,a,o)=>{if(!qG(a))throw new Error("Unsupported message input");const i=Gve(a);if(i==="system"&&o!==0)throw new Error("System message should be the first one");const s=Xve(i),c=r.content[r.content.length];if(!r.mergeWithPreviousContent&&c&&c.role===s)throw new Error("Google Generative AI requires alternate messages between authors");const l=Yve(a,t);if(r.mergeWithPreviousContent){const p=r.content[r.content.length-1];if(!p)throw new Error("There was a problem parsing your system message. Please try a prompt without one.");return p.parts.push(...l),{mergeWithPreviousContent:!1,content:r.content}}let u=s;(u==="function"||u==="system"&&!n)&&(u="user");const d={role:u,parts:l};return{mergeWithPreviousContent:i==="system"&&!n,content:[...r.content,d]}},{content:[],mergeWithPreviousContent:!1}).content}function Qve(e,t){if(!e.candidates||e.candidates.length===0||!e.candidates[0])return{generations:[],llmOutput:{filters:e.promptFeedback}};const n=e.functionCalls(),[r]=e.candidates,{content:a,...o}=r;let i;(a==null?void 0:a.parts.length)===1&&a.parts[0].text?i=a.parts[0].text:i=a.parts.map(c=>"text"in c?{type:"text",text:c.text}:"executableCode"in c?{type:"executableCode",executableCode:c.executableCode}:"codeExecutionResult"in c?{type:"codeExecutionResult",codeExecutionResult:c.codeExecutionResult}:c);let s="";return typeof i=="string"?s=i:"text"in i[0]&&(s=i[0].text),{generations:[{text:s,message:new Ta({content:i,tool_calls:n==null?void 0:n.map(c=>({...c,type:"tool_call"})),additional_kwargs:{...o},usage_metadata:t==null?void 0:t.usageMetadata}),generationInfo:o}]}}function e0e(e,t){if(!e.candidates||e.candidates.length===0)return null;const n=e.functionCalls(),[r]=e.candidates,{content:a,...o}=r;let i;a!=null&&a.parts&&a.parts.every(l=>"text"in l)?i=a.parts.map(l=>l.text).join(""):a.parts&&(i=a.parts.map(l=>"text"in l?{type:"text",text:l.text}:"executableCode"in l?{type:"executableCode",executableCode:l.executableCode}:"codeExecutionResult"in l?{type:"codeExecutionResult",codeExecutionResult:l.codeExecutionResult}:l));let s="";i&&typeof i=="string"?s=i:i&&typeof i=="object"&&"text"in i[0]&&(s=i[0].text);const c=[];return n&&c.push(...n.map(l=>({...l,args:JSON.stringify(l.args),index:t.index,type:"tool_call_chunk"}))),new qi({text:s,message:new nu({content:i||"",name:a?a.role:void 0,tool_call_chunks:c,additional_kwargs:{},usage_metadata:t.usageMetadata}),generationInfo:o})}function t0e(e){return e.every(t=>"functionDeclarations"in t&&Array.isArray(t.functionDeclarations))?e:[{functionDeclarations:e.map(t=>{if(ty(t)){const n=VF(t.schema);return{name:t.name,description:t.description,parameters:n}}return mE(t)?{name:t.function.name,description:t.function.description??"A function available to call.",parameters:Zve(t.function.parameters)}:t})}]}class HF extends c8{static lc_name(){return"GoogleGenerativeAIToolsOutputParser"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","google_genai","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=t.keyName,this.returnSingle=t.returnSingle??this.returnSingle,this.zodSchema=t.zodSchema}async _validateResult(t){if(this.zodSchema===void 0)return t;const n=await this.zodSchema.safeParseAsync(t);if(n.success)return n.data;throw new Jm(`Failed to parse. Text: "${JSON.stringify(t,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(t,null,2))}async parseResult(t){const n=t.flatMap(a=>{const{message:o}=a;return!("tool_calls"in o)||!Array.isArray(o.tool_calls)?[]:o.tool_calls});if(n[0]===void 0)throw new Error("No parseable tool calls provided to GoogleGenerativeAIToolsOutputParser.");const[r]=n;return await this._validateResult(r.args)}}function qF(e,t){const n=n0e(e),r=a0e(n,t);return{tools:n,toolConfig:r}}function n0e(e){let t=[];const n=[];return e.forEach(r=>{if(ty(r)){const[a]=t0e([r]);a.functionDeclarations&&t.push(...a.functionDeclarations)}else if(mE(r)){const{functionDeclarations:a}=r0e(r);if(a)t.push(...a);else throw new Error("Failed to convert OpenAI structured tool to GenerativeAI tool")}else n.push(r)}),n.find(r=>"functionDeclarations"in r)?n.map(r=>{if((t==null?void 0:t.length)>0&&"functionDeclarations"in r){const a={functionDeclarations:[...r.functionDeclarations||[],...t]};return t=[],a}return r}):[...n,...t.length>0?[{functionDeclarations:t}]:[]]}function r0e(e){return{functionDeclarations:[{name:e.function.name,description:e.function.description,parameters:rp(e.function.parameters)}]}}function a0e(e,t){if(!e.length||!t)return;const{toolChoice:n,allowedFunctionNames:r}=t,a={any:el.ANY,auto:el.AUTO,none:el.NONE};if(n&&["any","auto","none"].includes(n))return{functionCallingConfig:{mode:a[n]??"MODE_UNSPECIFIED",allowedFunctionNames:r}};if(typeof n=="string"||r)return{functionCallingConfig:{mode:el.ANY,allowedFunctionNames:[...r??[],...n&&typeof n=="string"?[n]:[]]}}}class o0e extends Ja{static lc_name(){return"ChatGoogleGenerativeAI"}get lc_secrets(){return{apiKey:"GOOGLE_API_KEY"}}get lc_aliases(){return{apiKey:"google_api_key"}}get _isMultimodalModel(){return this.model.includes("vision")||this.model.startsWith("gemini-1.5")||this.model.startsWith("gemini-2")}constructor(t){var n,r;if(super(t??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","google_genai"]}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxOutputTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"safetySettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"convertSystemMessageToHumanContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.modelName=((n=t==null?void 0:t.model)==null?void 0:n.replace(/^models\//,""))??((r=t==null?void 0:t.modelName)==null?void 0:r.replace(/^models\//,""))??this.model,this.model=this.modelName,this.maxOutputTokens=(t==null?void 0:t.maxOutputTokens)??this.maxOutputTokens,this.maxOutputTokens&&this.maxOutputTokens<0)throw new Error("`maxOutputTokens` must be a positive integer");if(this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.temperature&&(this.temperature<0||this.temperature>1))throw new Error("`temperature` must be in the range of [0.0,1.0]");if(this.topP=(t==null?void 0:t.topP)??this.topP,this.topP&&this.topP<0)throw new Error("`topP` must be a positive integer");if(this.topP&&this.topP>1)throw new Error("`topP` must be below 1.");if(this.topK=(t==null?void 0:t.topK)??this.topK,this.topK&&this.topK<0)throw new Error("`topK` must be a positive integer");if(this.stopSequences=(t==null?void 0:t.stopSequences)??this.stopSequences,this.apiKey=(t==null?void 0:t.apiKey)??gn("GOOGLE_API_KEY"),!this.apiKey)throw new Error("Please set an API key for Google GenerativeAI in the environment variable GOOGLE_API_KEY or in the `apiKey` field of the ChatGoogleGenerativeAI constructor");if(this.safetySettings=(t==null?void 0:t.safetySettings)??this.safetySettings,this.safetySettings&&this.safetySettings.length>0&&new Set(this.safetySettings.map(a=>a.category)).size!==this.safetySettings.length)throw new Error("The categories in `safetySettings` array must be unique");this.streaming=(t==null?void 0:t.streaming)??this.streaming,this.client=new TE(this.apiKey).getGenerativeModel({model:this.model,safetySettings:this.safetySettings,generationConfig:{candidateCount:1,stopSequences:this.stopSequences,maxOutputTokens:this.maxOutputTokens,temperature:this.temperature,topP:this.topP,topK:this.topK,...t!=null&&t.json?{responseMimeType:"application/json"}:{}}},{apiVersion:t==null?void 0:t.apiVersion,baseUrl:t==null?void 0:t.baseUrl}),this.streamUsage=(t==null?void 0:t.streamUsage)??this.streamUsage}useCachedContent(t,n,r){this.apiKey&&(this.client=new TE(this.apiKey).getGenerativeModelFromCachedContent(t,n,r))}get useSystemInstruction(){return typeof this.convertSystemMessageToHumanContent=="boolean"?!this.convertSystemMessageToHumanContent:this.computeUseSystemInstruction}get computeUseSystemInstruction(){return this.modelName==="gemini-1.0-pro-001"||this.modelName.startsWith("gemini-pro-vision")||this.modelName.startsWith("gemini-1.0-pro-vision")?!1:this.modelName!=="gemini-pro"}getLsParams(t){return{ls_provider:"google_genai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:this.client.generationConfig.temperature,ls_max_tokens:this.client.generationConfig.maxOutputTokens,ls_stop:t.stop}}_combineLLMOutput(){return[]}_llmType(){return"googlegenerativeai"}bindTools(t,n){var r;return this.bind({tools:(r=qF(t))==null?void 0:r.tools,...n})}invocationParams(t){var r;const n=(r=t==null?void 0:t.tools)!=null&&r.length?qF(t.tools,{toolChoice:t.tool_choice,allowedFunctionNames:t.allowedFunctionNames}):void 0;return{...n!=null&&n.tools?{tools:n.tools}:{},...n!=null&&n.toolConfig?{toolConfig:n.toolConfig}:{}}}async _generate(t,n,r){var u;const a=WF(t,this._isMultimodalModel,this.useSystemInstruction);let o=a;if(a[0].role==="system"){const[d]=a;this.client.systemInstruction=d,o=a.slice(1)}const i=this.invocationParams(n);if(this.streaming){const d={},p=this._streamResponseChunks(t,n,r),f={};for await(const m of p){const y=((u=m.generationInfo)==null?void 0:u.completion)??0;f[y]===void 0?f[y]=m:f[y]=f[y].concat(m)}return{generations:Object.entries(f).sort(([m],[y])=>parseInt(m,10)-parseInt(y,10)).map(([m,y])=>y),llmOutput:{estimatedTokenUsage:d}}}const s=await this.completionWithRetry({...i,contents:o});let c;if("usageMetadata"in s.response){const d=s.response.usageMetadata;c={input_tokens:d.promptTokenCount??0,output_tokens:d.candidatesTokenCount??0,total_tokens:d.totalTokenCount??0}}const l=Qve(s.response,{usageMetadata:c});return await(r==null?void 0:r.handleLLMNewToken(l.generations[0].text??"")),l}async*_streamResponseChunks(t,n,r){const a=WF(t,this._isMultimodalModel,this.useSystemInstruction);let o=a;if(a[0].role==="system"){const[u]=a;this.client.systemInstruction=u,o=a.slice(1)}const i={...this.invocationParams(n),contents:o},s=await this.caller.callWithOptions({signal:n==null?void 0:n.signal},async()=>{const{stream:u}=await this.client.generateContentStream(i);return u});let c,l=0;for await(const u of s){if("usageMetadata"in u&&this.streamUsage!==!1&&n.streamUsage!==!1){const p=u.usageMetadata;if(!c)c={input_tokens:p.promptTokenCount,output_tokens:p.candidatesTokenCount,total_tokens:p.totalTokenCount};else{const f=p.candidatesTokenCount-c.output_tokens;c={input_tokens:0,output_tokens:f,total_tokens:f}}}const d=e0e(u,{usageMetadata:c,index:l});l+=1,d&&(yield d,await(r==null?void 0:r.handleLLMNewToken(d.text??"")))}}async completionWithRetry(t,n){return this.caller.callWithOptions({signal:n==null?void 0:n.signal},async()=>{var r;try{return await this.client.generateContent(t)}catch(a){throw(r=a.message)!=null&&r.includes("400 Bad Request")&&(a.status=400),a}})}withStructuredOutput(t,n){const r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw;if(o==="jsonMode")throw new Error('ChatGoogleGenerativeAI only supports "functionCalling" as a method.');let s=a??"extract",c,l;if(Jd(r)){const m=VF(r);l=[{functionDeclarations:[{name:s,description:m.description??"A function available to call.",parameters:m}]}],c=new HF({returnSingle:!0,keyName:s,zodSchema:r})}else{let m;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(m=r,s=r.name):m={name:s,description:r.description??"",parameters:r},l=[{functionDeclarations:[m]}],c=new HF({returnSingle:!0,keyName:s})}const u=this.bind({tools:l,tool_choice:s});if(!i)return u.pipe(c).withConfig({runName:"ChatGoogleGenerativeAIStructuredOutput"});const d=ji.assign({parsed:(m,y)=>c.invoke(m.raw,y)}),p=ji.assign({parsed:()=>null}),f=d.withFallbacks({fallbacks:[p]});return kv.from([{raw:u},f]).withConfig({runName:"StructuredOutputRunnable"})}}class i0e extends XG{constructor(t){var n,r;if(super(t??{}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"embedding-001"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"embedding-001"}),Object.defineProperty(this,"taskType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"title",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxBatchSize",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.modelName=((n=t==null?void 0:t.model)==null?void 0:n.replace(/^models\//,""))??((r=t==null?void 0:t.modelName)==null?void 0:r.replace(/^models\//,""))??this.modelName,this.model=this.modelName,this.taskType=(t==null?void 0:t.taskType)??this.taskType,this.title=(t==null?void 0:t.title)??this.title,this.title&&this.taskType!=="RETRIEVAL_DOCUMENT")throw new Error("title can only be sepcified with TaskType.RETRIEVAL_DOCUMENT");if(this.apiKey=(t==null?void 0:t.apiKey)??gn("GOOGLE_API_KEY"),!this.apiKey)throw new Error("Please set an API key for Google GenerativeAI in the environmentb variable GOOGLE_API_KEY or in the `apiKey` field of the GoogleGenerativeAIEmbeddings constructor");this.client=new TE(this.apiKey).getGenerativeModel({model:this.model})}_convertToContent(t){return{content:{role:"user",parts:[{text:this.stripNewLines?t.replace(/\n/g," "):t}]},taskType:this.taskType,title:this.title}}async _embedQueryContent(t){const n=this._convertToContent(t);return(await this.client.embedContent(n)).embedding.values??[]}async _embedDocumentsContent(t){const n=JG(t,this.maxBatchSize),r=n.map(a=>({requests:a.map(o=>this._convertToContent(o))}));return(await Promise.allSettled(r.map(a=>this.client.batchEmbedContents(a)))).flatMap((a,o)=>a.status==="fulfilled"?a.value.embeddings.map(i=>i.values||[]):Array(n[o].length).fill([]))}embedQuery(t){return this.caller.call(this._embedQueryContent.bind(this),t)}embedDocuments(t){return this.caller.call(this._embedDocumentsContent.bind(this),t)}}const s0e=e=>{const t=(n,r=null)=>{let a=`{
`;return n.filter(o=>o.parent_id===r).forEach(o=>{if(o.type==="object"){const i=e.filter(c=>c.parent_id===o.id),s=t(i,o.id);a+=`  ${o.name}${o.required?"":"?"}: ${s}
`}else a+=`  // ${o.description||""}
  ${o.name}${o.required?"":"?"}: ${o.type};
`}),a+="}",a};return t(e)},KF=e=>{const t=(r,a=null)=>{let o="";return r.filter(i=>i.parent_id===a).forEach(i=>{if(i.type==="object"){const s=t(r,i.id);o+=`    ${i.name}: z.object({
${s}    })${i.required?"":".optional()"}.describe('${i.description||""}'),
`}else o+=`    ${i.name}: z.${i.type}()${i.required?"":".optional()"}.describe('${i.description||""}'),
`}),o};let n=`const schema = z.object({
`;return n+=t(e),n+="});",n},c0e=e=>{const t={},n={string:Pa.string,number:Pa.number,boolean:Pa.boolean,enum:()=>Pa.enum([""])};return e.forEach(r=>{if(!r.parent_id)if(r.type==="object"){const a=e.filter(i=>i.parent_id===r.id),o={};a.forEach(i=>{i.type==="object"||i.type==="array"||(o[i.name]=n[i.type](),i.required||(o[i.name]=o[i.name].optional()))}),t[r.name]=Pa.object(o),r.required||(t[r.name]=t[r.name].optional())}else r.type==="array"?(t[r.name]=Pa.array(Pa.string()),r.required||(t[r.name]=t[r.name].optional())):r.type==="enum"?(t[r.name]=Pa.enum((r.enum||"").split(",")),r.required||(t[r.name]=t[r.name].optional())):(t[r.name]=n[r.type](),r.required||(t[r.name]=t[r.name].optional()))}),Pa.object(t)},vy=()=>{const{toast:e}=nn(),{t}=Me("errors"),n=Je(a=>a.currentSession),{modalRef:r}=Pd(km);return{confirmPassphrase:g.useCallback(async()=>{if(!(n!=null&&n.passphrase))throw new Error("Session is not found");await ai.exists("passphrase")||await new Promise((a,o)=>{r.current.show({onConfirm:async i=>{try{const s=await Ad(n.passphrase,i);await ai.set("passphrase",s),a()}catch(s){e({content:t("invalid_passphrase"),variant:"destructive"}),o(s)}finally{r.current.hide()}},onCancel:()=>{o()}})})},[n==null?void 0:n.passphrase,r,t,e])}},DE=async(e,t,{schemas:n,onMessageUpdate:r})=>{let a="",o;if(n!=null&&n.length){const i=n.filter(c=>{var l;return(l=c.schema_items)==null?void 0:l.length}).flatMap(c=>c.schema_items),s=await e.withStructuredOutput(c0e(i)).stream(t);for await(const c of s)a=JSON.stringify(c),r==null||r({content:a})}else{const i=await e.stream(t);for await(const s of i)a+=`${s.content}`,o=s,r==null||r({content:a,chunk:s})}return{lastChunk:o,content:a}},l0e=()=>{const{confirmPassphrase:e}=vy();return{stream:g.useCallback(async(t,n)=>{var p,f,m,y,v;const{schemas:r,onMessageUpdate:a,onMessageFinish:o}=n||{};await e();const i=(p=n==null?void 0:n.llm)==null?void 0:p.encrypted,s=((f=n==null?void 0:n.llm)==null?void 0:f.options)||{};if(!(i!=null&&i.key)||typeof i.key!="string")throw new Error("API Key is not found");const c=await ai.get("passphrase");if(!c)throw new Error("Passphrase is not found");const l=await Ad(i.key,c);if(!l)throw new Error("API Key is not found");let u="",d;switch(n==null?void 0:n.provider){case Ve.GoogleGenerativeAI:{const b=new o0e({apiKey:l,model:(m=n==null?void 0:n.llm)==null?void 0:m.name,temperature:s!=null&&s.temperature?+s.temperature:void 0,topK:s!=null&&s.topK?+s.topK:void 0,topP:s!=null&&s.topP?+s.topP:void 0,stopSequences:s!=null&&s.stop?s.stop:void 0,maxOutputTokens:s!=null&&s.maxTokens?+s.maxTokens:void 0});if(i!=null&&i.enabled_google_search_retrieval){const _={googleSearchRetrieval:{dynamicRetrievalConfig:{mode:"MODE_DYNAMIC",dynamicThreshold:.7}}};b.bindTools([_])}const w=await DE(b,t,{schemas:r,onMessageUpdate:a});u=w.content,d=w.lastChunk}break;case Ve.Groq:{const b=new Pge({apiKey:l,model:(y=n==null?void 0:n.llm)==null?void 0:y.name,temperature:s!=null&&s.temperature?+s.temperature:void 0,stopSequences:s!=null&&s.stop?s.stop:void 0,maxTokens:s!=null&&s.maxTokens?+s.maxTokens:void 0}),w=await DE(b,t,{schemas:r,onMessageUpdate:a});u=w.content,d=w.lastChunk}break;case Ve.OpenAI:{const b=new hye({apiKey:l,model:(v=n==null?void 0:n.llm)==null?void 0:v.name,temperature:s!=null&&s.temperature?+s.temperature:void 0,topP:s!=null&&s.topP?+s.topP:void 0,stopSequences:s!=null&&s.stop?s.stop:void 0,maxTokens:s!=null&&s.maxTokens?+s.maxTokens:void 0}),w=await DE(b,t,{schemas:r,onMessageUpdate:a});u=w.content,d=w.lastChunk}break;default:throw new Error("Provider is not supported")}return o==null||o({content:u,lastChunk:d}),{lastChunk:d,content:u}},[e])}},nl=()=>{const e=QM(),t=l0e();return{stream:g.useCallback((n,r,a)=>{switch(n){case Ve.WebLLM:return e.stream(r,a);case Ve.GoogleGenerativeAI:case Ve.Groq:case Ve.OpenAI:return t.stream(r,{...a,provider:n});default:throw new Error("Provider is not supported")}},[t,e])}},u0e=()=>{const{confirmPassphrase:e}=vy();return{getEmbedding:g.useCallback(async t=>{var i;const n=t==null?void 0:t.encrypted,r=(i=t.data)==null?void 0:i.provider;if(await e(),!(n!=null&&n.provider)&&!(n!=null&&n.key))throw new Error("API Key is not found.");const a=await ai.get("passphrase");if(!a)throw new Error("Passphrase is not found");const o=await Ad(`${n.key}`,a);if(!o||!r)throw new Error("API Key or provider is not found.");switch(r){case Ve.OpenAI:return new yye({apiKey:o,model:"text-embedding-3-small"});case Ve.GoogleGenerativeAI:return new i0e({apiKey:o,model:"text-embedding-004"});default:throw new Error("Provider is not supported")}},[e])}},ap=()=>{const[e,t]=g.useState(!1),n=YG(s=>s.index),r=YG(s=>s.similaritySearchWithScore),{getEmbedding:a}=u0e(),o=g.useCallback(async(s,...c)=>{var l,u;try{const[d,p]=c;if(t(!0),!s||!((l=s.data)!=null&&l.provider)||((u=s.data)==null?void 0:u.provider)==="local_transformers")return r(d,p);const f=await a(s);return r({...d,embedding:f},p)}finally{t(!1)}},[a,r]),i=g.useCallback(async(s,...c)=>{var l,u;try{const[d,p]=c;if(t(!0),!s||!((l=s.data)!=null&&l.provider)||((u=s.data)==null?void 0:u.provider)==="local_transformers")return n(d,p);const f=await a(s);return n({...d,embedding:f},p)}finally{t(!1)}},[a,n]);return{loading:e,index:i,similaritySearchWithScore:o}},d0e=e=>{var i;const[t]=g.useState(!1),{similaritySearchWithScore:n}=ap(),{stream:r}=nl(),a=g.useCallback(async(s,c)=>{if(!(c!=null&&c.length))return[];const l=[];return await Promise.all(c.map(async u=>{var p,f,m,y,v;const d=u.placeholderEntity;if(d)switch(d.placeholder_type){case Xi.VECTOR_DATABASE_RETREIVER:{if(!u.promptNode||!u.promptEntity||!u.vectorDatabaseNode||!u.vectorDatabaseEntity)return;const b=(p=d.metadata)!=null&&p.k?+((f=d.metadata)==null?void 0:f.k):1;let w=(m=d.metadata)!=null&&m.minimalScore?+((y=d.metadata)==null?void 0:y.minimalScore):void 0;w&&w>1&&(w=w/100);const _=await n((v=e==null?void 0:e.mainEmbeddingInfo)==null?void 0:v.embedding,{database:{databaseId:u.vectorDatabaseEntity.id}},s,b);if(!_)return[];const x=new ii({template:u.promptEntity.content,inputVariables:["context"]});l.push(new Ta(await x.format({context:w?_.filter(([,j])=>j>=w).map(([j])=>j.pageContent).join(`
`):_.map(([j])=>j.pageContent).join(`
`)})))}}})),l},[n,(i=e==null?void 0:e.mainEmbeddingInfo)==null?void 0:i.embedding]),o=g.useCallback(async(s,c,{retriverInfo:l},{schema:u,onMessageUpdate:d,onResponseMessageCreate:p,onInjectedMessages:f})=>{var b,w;if(!((b=e.mainLLMInfo)!=null&&b.llm)||((w=e.mainLLMInfo)==null?void 0:w.status)!==et.Loaded)throw new Error("LLM not found");const m=[];l!=null&&l.length&&(m.push(...await a(s,l)),f==null||f(m));const y=c.map(_=>_.role==="system"?new Pv(_.content):_.role==="user"?new Vr(_.content):new Ta(_.content));p==null||p();const{content:v}=await r(e.mainLLMInfo.llm.provider,[...m,...y],{schemas:u?[u]:void 0,onMessageUpdate:({content:_})=>{d==null||d({nodeData:{loading:!0,content:_}})},llm:e.mainLLMInfo.llm});return d==null||d({nodeData:{content:v}}),v},[a,r,e.mainLLMInfo]);return{loading:t,sendMessage:o}},p0e=po(({onDelete:e})=>{const{t}=Me("dialogs"),[n,r]=g.useState(!1),a=tn(),{toast:o}=nn(),i=async()=>{try{r(!0),await e(),a.hide()}catch{o({variant:"destructive",description:t("delete_chat_data_node.errors.delete_failed")})}finally{r(!1)}};return h.jsx(J2,{open:a.visible,onOpenChange:a.hide,children:h.jsxs(Hb,{children:[h.jsxs(qb,{children:[h.jsx(Zb,{children:t("delete_chat_data_node.title")}),h.jsx(Gb,{children:t("delete_chat_data_node.description")})]}),h.jsxs(Kb,{children:[h.jsx(Jb,{onClick:a.hide,children:t("delete_chat_data_node.cancel")}),h.jsx(Xb,{disabled:n,onClick:i,children:t("delete_chat_data_node.delete")})]})]})})});function by(){return h.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"text-foreground",children:[h.jsx("circle",{cx:"4",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_qFRN",begin:"0;spinner_OcgL.end+0.25s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{begin:"spinner_qFRN.begin+0.1s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"20",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_OcgL",begin:"spinner_qFRN.begin+0.2s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})})]})}const f0e=g.lazy(()=>qt(()=>import("./index-dyTZNkZk.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([5,6,1,2,7,8]))),LE=g.memo(({source:e,className:t,...n})=>{const r=eu(o=>o.theme),a=g.useMemo(()=>({pre:({children:o,className:i,...s})=>h.jsx("pre",{...s,className:Z(i,"nowheel"),children:o}),think:({children:o})=>h.jsxs(h.Fragment,{children:[h.jsx("code",{className:"!rounded-none",children:"Think: "}),h.jsx("blockquote",{className:"think",children:o})]})}),[]);return h.jsx(g.Suspense,{children:h.jsx(f0e,{className:Z("!text-sm [&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans",t),source:e,wrapperElement:{"data-color-mode":r==="dark"?"dark":"light"},components:a,...n})})},(e,t)=>e.source===t.source),Gt=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Gt.displayName="Card";const Mn=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex flex-col space-y-1.5 p-6",e),...t}));Mn.displayName="CardHeader";const Fn=g.forwardRef(({className:e,...t},n)=>h.jsx("h3",{ref:n,className:Z("text-2xl font-semibold leading-none tracking-tight",e),...t}));Fn.displayName="CardTitle";const ZF=g.forwardRef(({className:e,...t},n)=>h.jsx("p",{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));ZF.displayName="CardDescription";const An=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("p-6 pt-0",e),...t}));An.displayName="CardContent";const Ya=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex items-center p-6 pt-0",e),...t}));Ya.displayName="CardFooter";function Ci(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e==null||e(r),n===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function GF(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function XF(...e){return t=>{let n=!1;const r=e.map(a=>{const o=GF(a,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let a=0;a<r.length;a++){const o=r[a];typeof o=="function"?o():GF(e[a],null)}}}}function Ni(...e){return g.useCallback(XF(...e),e)}var $E=g.forwardRef((e,t)=>{const{children:n,...r}=e,a=g.Children.toArray(n),o=a.find(m0e);if(o){const i=o.props.children,s=a.map(c=>c===o?g.Children.count(i)>1?g.Children.only(null):g.isValidElement(i)?i.props.children:null:c);return h.jsx(FE,{...r,ref:t,children:g.isValidElement(i)?g.cloneElement(i,void 0,s):null})}return h.jsx(FE,{...r,ref:t,children:n})});$E.displayName="Slot";var FE=g.forwardRef((e,t)=>{const{children:n,...r}=e;if(g.isValidElement(n)){const a=g0e(n);return g.cloneElement(n,{...y0e(r,n.props),ref:t?XF(t,a):a})}return g.Children.count(n)>1?g.Children.only(null):null});FE.displayName="SlotClone";var h0e=({children:e})=>h.jsx(h.Fragment,{children:e});function m0e(e){return g.isValidElement(e)&&e.type===h0e}function y0e(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...i)=>{o(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function g0e(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var v0e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Bo=v0e.reduce((e,t)=>{const n=g.forwardRef((r,a)=>{const{asChild:o,...i}=r,s=o?$E:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(s,{...i,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function b0e(e,t){e&&Ql.flushSync(()=>e.dispatchEvent(t))}var w0e="DismissableLayer",BE="dismissableLayer.update",x0e="dismissableLayer.pointerDownOutside",_0e="dismissableLayer.focusOutside",JF,YF=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),QF=g.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:i,onDismiss:s,...c}=e,l=g.useContext(YF),[u,d]=g.useState(null),p=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=g.useState({}),m=Ni(t,S=>d(S)),y=Array.from(l.layers),[v]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),b=y.indexOf(v),w=u?y.indexOf(u):-1,_=l.layersWithOutsidePointerEventsDisabled.size>0,x=w>=b,j=S0e(S=>{const O=S.target,N=[...l.branches].some(M=>M.contains(O));!x||N||(a==null||a(S),i==null||i(S),S.defaultPrevented||(s==null||s()))},p),E=O0e(S=>{const O=S.target;[...l.branches].some(N=>N.contains(O))||(o==null||o(S),i==null||i(S),S.defaultPrevented||(s==null||s()))},p);return n3e(S=>{w===l.layers.size-1&&(r==null||r(S),!S.defaultPrevented&&s&&(S.preventDefault(),s()))},p),g.useEffect(()=>{if(u)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(JF=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(u)),l.layers.add(u),e9(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=JF)}},[u,p,n,l]),g.useEffect(()=>()=>{u&&(l.layers.delete(u),l.layersWithOutsidePointerEventsDisabled.delete(u),e9())},[u,l]),g.useEffect(()=>{const S=()=>f({});return document.addEventListener(BE,S),()=>document.removeEventListener(BE,S)},[]),h.jsx(Bo.div,{...c,ref:m,style:{pointerEvents:_?x?"auto":"none":void 0,...e.style},onFocusCapture:Ci(e.onFocusCapture,E.onFocusCapture),onBlurCapture:Ci(e.onBlurCapture,E.onBlurCapture),onPointerDownCapture:Ci(e.onPointerDownCapture,j.onPointerDownCapture)})});QF.displayName=w0e;var j0e="DismissableLayerBranch",E0e=g.forwardRef((e,t)=>{const n=g.useContext(YF),r=g.useRef(null),a=Ni(t,r);return g.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),h.jsx(Bo.div,{...e,ref:a})});E0e.displayName=j0e;function S0e(e,t=globalThis==null?void 0:globalThis.document){const n=fr(e),r=g.useRef(!1),a=g.useRef(()=>{});return g.useEffect(()=>{const o=s=>{if(s.target&&!r.current){let c=function(){t9(x0e,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function O0e(e,t=globalThis==null?void 0:globalThis.document){const n=fr(e),r=g.useRef(!1);return g.useEffect(()=>{const a=o=>{o.target&&!r.current&&t9(_0e,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function e9(){const e=new CustomEvent(BE);document.dispatchEvent(e)}function t9(e,t,n,{discrete:r}){const a=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?b0e(a,o):a.dispatchEvent(o)}var zE="focusScope.autoFocusOnMount",UE="focusScope.autoFocusOnUnmount",n9={bubbles:!1,cancelable:!0},C0e="FocusScope",r9=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=fr(a),u=fr(o),d=g.useRef(null),p=Ni(t,y=>c(y)),f=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let y=function(_){if(f.paused||!s)return;const x=_.target;s.contains(x)?d.current=x:ki(d.current,{select:!0})},v=function(_){if(f.paused||!s)return;const x=_.relatedTarget;x!==null&&(s.contains(x)||ki(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const x of _)x.removedNodes.length>0&&ki(s)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,f.paused]),g.useEffect(()=>{if(s){i9.add(f);const y=document.activeElement;if(!s.contains(y)){const v=new CustomEvent(zE,n9);s.addEventListener(zE,l),s.dispatchEvent(v),v.defaultPrevented||(N0e(T0e(a9(s)),{select:!0}),document.activeElement===y&&ki(s))}return()=>{s.removeEventListener(zE,l),setTimeout(()=>{const v=new CustomEvent(UE,n9);s.addEventListener(UE,u),s.dispatchEvent(v),v.defaultPrevented||ki(y??document.body,{select:!0}),s.removeEventListener(UE,u),i9.remove(f)},0)}}},[s,l,u,f]);const m=g.useCallback(y=>{if(!n&&!r||f.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,b=document.activeElement;if(v&&b){const w=y.currentTarget,[_,x]=k0e(w);_&&x?!y.shiftKey&&b===x?(y.preventDefault(),n&&ki(_,{select:!0})):y.shiftKey&&b===_&&(y.preventDefault(),n&&ki(x,{select:!0})):b===w&&y.preventDefault()}},[n,r,f.paused]);return h.jsx(Bo.div,{tabIndex:-1,...i,ref:p,onKeyDown:m})});r9.displayName=C0e;function N0e(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(ki(r,{select:t}),document.activeElement!==n)return}function k0e(e){const t=a9(e),n=o9(t,e),r=o9(t.reverse(),e);return[n,r]}function a9(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function o9(e,t){for(const n of e)if(!M0e(n,{upTo:t}))return n}function M0e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function A0e(e){return e instanceof HTMLInputElement&&"select"in e}function ki(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&A0e(e)&&t&&e.select()}}var i9=P0e();function P0e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=s9(e,t),e.unshift(t)},remove(t){var n;e=s9(e,t),(n=e[0])==null||n.resume()}}}function s9(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function T0e(e){return e.filter(t=>t.tagName!=="A")}var I0e="Arrow",c9=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Bo.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});c9.displayName=I0e;var R0e=c9,VE="Popper",[l9,u9]=pr(VE),[D0e,d9]=l9(VE),p9=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(D0e,{scope:t,anchor:r,onAnchorChange:a,children:n})};p9.displayName=VE;var f9="PopperAnchor",h9=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=d9(f9,n),i=g.useRef(null),s=Ni(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Bo.div,{...a,ref:s})});h9.displayName=f9;var WE="PopperContent",[L0e,$0e]=l9(WE),m9=g.forwardRef((e,t)=>{var ee,G,K,X,ne,B;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:m,...y}=e,v=d9(WE,n),[b,w]=g.useState(null),_=Ni(t,ue=>w(ue)),[x,j]=g.useState(null),E=jf(x),S=(E==null?void 0:E.width)??0,O=(E==null?void 0:E.height)??0,N=r+(o!=="center"?"-"+o:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},k=Array.isArray(l)?l:[l],A=k.length>0,P={padding:M,boundary:k.filter(B0e),altBoundary:A},{refs:C,floatingStyles:T,placement:I,isPositioned:R,middlewareData:L}=Yv({strategy:"fixed",placement:N,whileElementsMounted:(...ue)=>$v(...ue,{animationFrame:f==="always"}),elements:{reference:v.anchor},middleware:[Qv({mainAxis:a+O,alignmentAxis:i}),c&&e0({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?t0():void 0,...P}),c&&n0({...P}),Bv({...P,apply:({elements:ue,rects:ae,availableWidth:de,availableHeight:je})=>{const{width:Le,height:$e}=ae.reference,Ee=ue.floating.style;Ee.setProperty("--radix-popper-available-width",`${de}px`),Ee.setProperty("--radix-popper-available-height",`${je}px`),Ee.setProperty("--radix-popper-anchor-width",`${Le}px`),Ee.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&m0({element:x,padding:s}),z0e({arrowWidth:S,arrowHeight:O}),p&&y0({strategy:"referenceHidden",...P})]}),[D,z]=v9(I),U=fr(m);ln(()=>{R&&(U==null||U())},[R,U]);const $=(ee=L.arrow)==null?void 0:ee.x,V=(G=L.arrow)==null?void 0:G.y,F=((K=L.arrow)==null?void 0:K.centerOffset)!==0,[W,re]=g.useState();return ln(()=>{b&&re(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:R?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:W,"--radix-popper-transform-origin":[(X=L.transformOrigin)==null?void 0:X.x,(ne=L.transformOrigin)==null?void 0:ne.y].join(" "),...((B=L.hide)==null?void 0:B.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(L0e,{scope:n,placedSide:D,onArrowChange:j,arrowX:$,arrowY:V,shouldHideArrow:F,children:h.jsx(Bo.div,{"data-side":D,"data-align":z,...y,ref:_,style:{...y.style,animation:R?void 0:"none"}})})})});m9.displayName=WE;var y9="PopperArrow",F0e={top:"bottom",right:"left",bottom:"top",left:"right"},g9=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=$0e(y9,n),o=F0e[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(R0e,{...r,ref:t,style:{...r.style,display:"block"}})})});g9.displayName=y9;function B0e(e){return e!==null}var z0e=e=>({name:"transformOrigin",options:e,fn(t){var y,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((y=a.arrow)==null?void 0:y.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=v9(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,p=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let f="",m="";return c==="bottom"?(f=o?u:`${d}px`,m=`${-s}px`):c==="top"?(f=o?u:`${d}px`,m=`${r.floating.height+s}px`):c==="right"?(f=`${-s}px`,m=o?u:`${p}px`):c==="left"&&(f=`${r.floating.width+s}px`,m=o?u:`${p}px`),{data:{x:f,y:m}}}});function v9(e){const[t,n="center"]=e.split("-");return[t,n]}var U0e=p9,b9=h9,V0e=m9,W0e=g9,H0e="Portal",w9=g.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[a,o]=g.useState(!1);ln(()=>o(!0),[]);const i=n||a&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return i?r3e.createPortal(h.jsx(Bo.div,{...r,ref:t}),i):null});w9.displayName=H0e;function q0e(e,t){return g.useReducer((n,r)=>t[n][r]??n,e)}var HE=e=>{const{present:t,children:n}=e,r=K0e(t),a=typeof n=="function"?n({present:r.isPresent}):g.Children.only(n),o=Ni(r.ref,Z0e(a));return typeof n=="function"||r.isPresent?g.cloneElement(a,{ref:o}):null};HE.displayName="Presence";function K0e(e){const[t,n]=g.useState(),r=g.useRef({}),a=g.useRef(e),o=g.useRef("none"),i=e?"mounted":"unmounted",[s,c]=q0e(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const l=wy(r.current);o.current=s==="mounted"?l:"none"},[s]),ln(()=>{const l=r.current,u=a.current;if(u!==e){const d=o.current,p=wy(l);e?c("MOUNT"):p==="none"||(l==null?void 0:l.display)==="none"?c("UNMOUNT"):c(u&&d!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),ln(()=>{if(t){let l;const u=t.ownerDocument.defaultView??window,d=f=>{const m=wy(r.current).includes(f.animationName);if(f.target===t&&m&&(c("ANIMATION_END"),!a.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",l=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},p=f=>{f.target===t&&(o.current=wy(r.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(l),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:g.useCallback(l=>{l&&(r.current=getComputedStyle(l)),n(l)},[])}}function wy(e){return(e==null?void 0:e.animationName)||"none"}function Z0e(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var xy="right-scroll-bar-position",_y="width-before-scroll-bar",G0e="with-scroll-bars-hidden",X0e="--removed-body-scroll-bar-size";function qE(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function J0e(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var Y0e=typeof window<"u"?g.useLayoutEffect:g.useEffect,x9=new WeakMap;function Q0e(e,t){var n=J0e(null,function(r){return e.forEach(function(a){return qE(a,r)})});return Y0e(function(){var r=x9.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||qE(s,null)}),o.forEach(function(s){a.has(s)||qE(s,i)})}x9.set(n,e)},[e]),n}var _9=g0(),KE=function(){},jy=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:KE,onWheelCapture:KE,onTouchMoveCapture:KE}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,p=e.sideCar,f=e.noIsolation,m=e.inert,y=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,_=Ef(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=p,j=Q0e([n,t]),E=On(On({},_),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:_9,removeScrollBar:l,shards:d,noIsolation:f,inert:m,setCallbacks:o,allowPinchZoom:!!y,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),On(On({},E),{ref:j})):g.createElement(b,On({},E,{className:c,ref:j}),s))});jy.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},jy.classNames={fullWidth:_y,zeroRight:xy};function ebe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=v0();return t&&e.setAttribute("nonce",t),e}function tbe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function nbe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var rbe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=ebe())&&(tbe(t,n),nbe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},abe=function(){var e=rbe();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},obe=function(){var e=abe(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},ibe={left:0,top:0,right:0,gap:0},ZE=function(e){return parseInt(e||"",10)||0},sbe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[ZE(n),ZE(r),ZE(a)]},cbe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return ibe;var t=sbe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},lbe=obe(),rl="data-scroll-locked",ube=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(G0e,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(rl,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(xy,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(_y,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(xy," .").concat(xy,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(_y," .").concat(_y,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(rl,`] {
    `).concat(X0e,": ").concat(s,`px;
  }
`)},j9=function(){var e=parseInt(document.body.getAttribute(rl)||"0",10);return isFinite(e)?e:0},dbe=function(){g.useEffect(function(){return document.body.setAttribute(rl,(j9()+1).toString()),function(){var e=j9()-1;e<=0?document.body.removeAttribute(rl):document.body.setAttribute(rl,e.toString())}},[])},pbe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;dbe();var o=g.useMemo(function(){return cbe(a)},[a]);return g.createElement(lbe,{styles:ube(o,!t,a,n?"":"!important")})},GE=!1;if(typeof window<"u")try{var Ey=Object.defineProperty({},"passive",{get:function(){return GE=!0,!0}});window.addEventListener("test",Ey,Ey),window.removeEventListener("test",Ey,Ey)}catch{GE=!1}var al=GE?{passive:!1}:!1,fbe=function(e){return e.tagName==="TEXTAREA"},E9=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!fbe(e)&&n[t]==="visible")},hbe=function(e){return E9(e,"overflowY")},mbe=function(e){return E9(e,"overflowX")},S9=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=O9(e,r);if(a){var o=C9(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},ybe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},gbe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},O9=function(e,t){return e==="v"?hbe(t):mbe(t)},C9=function(e,t){return e==="v"?ybe(t):gbe(t)},vbe=function(e,t){return e==="h"&&t==="rtl"?-1:1},bbe=function(e,t,n,r,a){var o=vbe(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,p=0;do{var f=C9(e,s),m=f[0],y=f[1],v=f[2],b=y-v-o*m;(m||b)&&O9(e,s)&&(d+=b,p+=m),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(p)<1||!a))&&(l=!0),l},Sy=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},N9=function(e){return[e.deltaX,e.deltaY]},k9=function(e){return e&&"current"in e?e.current:e},wbe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},xbe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},_be=0,ol=[];function jbe(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(_be++)[0],o=g.useState(Sf)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var y=b0([e.lockRef.current],(e.shards||[]).map(k9),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!i.current.allowPinchZoom;var b=Sy(y),w=n.current,_="deltaX"in y?y.deltaX:w[0]-b[0],x="deltaY"in y?y.deltaY:w[1]-b[1],j,E=y.target,S=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in y&&S==="h"&&E.type==="range")return!1;var O=S9(S,E);if(!O)return!0;if(O?j=S:(j=S==="v"?"h":"v",O=S9(S,E)),!O)return!1;if(!r.current&&"changedTouches"in y&&(_||x)&&(r.current=j),!j)return!0;var N=r.current||j;return bbe(N,v,y,N==="h"?_:x,!0)},[]),c=g.useCallback(function(y){var v=y;if(!(!ol.length||ol[ol.length-1]!==o)){var b="deltaY"in v?N9(v):Sy(v),w=t.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&wbe(j.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(k9).filter(Boolean).filter(function(j){return j.contains(v.target)}),x=_.length>0?s(v,_[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(y,v,b,w){var _={name:y,delta:v,target:b,should:w,shadowParent:Ebe(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(x){return x!==_})},1)},[]),u=g.useCallback(function(y){n.current=Sy(y),r.current=void 0},[]),d=g.useCallback(function(y){l(y.type,N9(y),y.target,s(y,e.lockRef.current))},[]),p=g.useCallback(function(y){l(y.type,Sy(y),y.target,s(y,e.lockRef.current))},[]);g.useEffect(function(){return ol.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:p}),document.addEventListener("wheel",c,al),document.addEventListener("touchmove",c,al),document.addEventListener("touchstart",u,al),function(){ol=ol.filter(function(y){return y!==o}),document.removeEventListener("wheel",c,al),document.removeEventListener("touchmove",c,al),document.removeEventListener("touchstart",u,al)}},[]);var f=e.removeScrollBar,m=e.inert;return g.createElement(g.Fragment,null,m?g.createElement(o,{styles:xbe(a)}):null,f?g.createElement(pbe,{gapMode:e.gapMode}):null)}function Ebe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Sbe=w0(_9,jbe);var M9=g.forwardRef(function(e,t){return g.createElement(jy,On({},e,{ref:t,sideCar:Sbe}))});M9.classNames=jy.classNames;var XE="Popover",[A9,S3e]=pr(XE,[u9]),op=u9(),[Obe,Mi]=A9(XE),P9=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!1}=e,s=op(t),c=g.useRef(null),[l,u]=g.useState(!1),[d=!1,p]=In({prop:r,defaultProp:a,onChange:o});return h.jsx(U0e,{...s,children:h.jsx(Obe,{scope:t,contentId:Rt(),triggerRef:c,open:d,onOpenChange:p,onOpenToggle:g.useCallback(()=>p(f=>!f),[p]),hasCustomAnchor:l,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:i,children:n})})};P9.displayName=XE;let JE;JE="PopoverAnchor",h0=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Mi(JE,n),o=op(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:s}=a;return g.useEffect(()=>(i(),()=>s()),[i,s]),h.jsx(b9,{...o,...r,ref:t})}),h0.displayName=JE;var T9="PopoverTrigger",YE=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Mi(T9,n),o=op(n),i=Ni(t,a.triggerRef),s=h.jsx(Bo.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":$9(a.open),...r,ref:i,onClick:Ci(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?s:h.jsx(b9,{asChild:!0,...o,children:s})});YE.displayName=T9;var QE="PopoverPortal",[Cbe,Nbe]=A9(QE,{forceMount:void 0}),I9=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,o=Mi(QE,t);return h.jsx(Cbe,{scope:t,forceMount:n,children:h.jsx(HE,{present:n||o.open,children:h.jsx(w9,{asChild:!0,container:a,children:r})})})};I9.displayName=QE;var il="PopoverContent",R9=g.forwardRef((e,t)=>{const n=Nbe(il,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,o=Mi(il,e.__scopePopover);return h.jsx(HE,{present:r||o.open,children:o.modal?h.jsx(kbe,{...a,ref:t}):h.jsx(Mbe,{...a,ref:t})})});R9.displayName=il;var kbe=g.forwardRef((e,t)=>{const n=Mi(il,e.__scopePopover),r=g.useRef(null),a=Ni(t,r),o=g.useRef(!1);return g.useEffect(()=>{const i=r.current;if(i)return fu(i)},[]),h.jsx(M9,{as:$E,allowPinchZoom:!0,children:h.jsx(D9,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ci(e.onCloseAutoFocus,i=>{var s;i.preventDefault(),o.current||((s=n.triggerRef.current)==null||s.focus())}),onPointerDownOutside:Ci(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,c=s.button===0&&s.ctrlKey===!0,l=s.button===2||c;o.current=l},{checkForDefaultPrevented:!1}),onFocusOutside:Ci(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Mbe=g.forwardRef((e,t)=>{const n=Mi(il,e.__scopePopover),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(D9,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),D9=g.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onInteractOutside:u,...d}=e,p=Mi(il,n),f=op(n);return hu(),h.jsx(r9,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(QF,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onDismiss:()=>p.onOpenChange(!1),children:h.jsx(V0e,{"data-state":$9(p.open),role:"dialog",id:p.contentId,...f,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),L9="PopoverClose",Abe=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Mi(L9,n);return h.jsx(Bo.button,{type:"button",...r,ref:t,onClick:Ci(e.onClick,()=>a.onOpenChange(!1))})});Abe.displayName=L9;var Pbe="PopoverArrow",Tbe=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=op(n);return h.jsx(W0e,{...a,...r,ref:t})});Tbe.displayName=Pbe;function $9(e){return e?"open":"closed"}pM=P9,oX=h0,vM=YE,dM=I9,zv=R9,Of=pM,x0=vM,mu=g.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},a)=>h.jsx(dM,{children:h.jsx(zv,{ref:a,align:t,sideOffset:n,className:Z("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})})),mu.displayName=zv.displayName;const F9=g.memo(e=>{const[t,n]=g.useState(!1),[r,a]=g.useState(e.options||{}),{t:o}=Me("atoms"),i=()=>{t||a(e.options||{}),n(!t)},s=()=>{var c;(c=e.onChangeOptions)==null||c.call(e,r||{}),n(!1)};return h.jsx("div",{className:e.className,children:h.jsxs(Of,{open:t,onOpenChange:n,children:[h.jsx(x0,{asChild:!0,children:h.jsx("div",{className:"flex justify-end gap-2",children:h.jsxs(Ye,{onClick:i,variant:"link",className:"flex items-center px-0",children:[h.jsx(pe,{name:"settings"}),h.jsx(Be,{children:o("llm_setting.title")})]})})}),h.jsx(mu,{className:"w-full p-0",children:t?h.jsxs(Gt,{className:"!border-none",children:[h.jsx(Mn,{children:h.jsx(Fn,{children:o("llm_setting.title")})}),h.jsxs(An,{children:[h.jsxs("div",{children:[h.jsxs(Be,{children:[o("llm_setting.temperature"),":"]}),h.jsx(Kt,{type:"number",value:r.temperature?`${r.temperature}`:"",onChange:c=>a(l=>({...l,temperature:c.target.value}))})]}),h.jsxs("div",{children:[h.jsxs(Be,{children:[o("llm_setting.top_p"),":"]}),h.jsx(Kt,{type:"number",value:r.topP?`${r.topP}`:"",onChange:c=>a(l=>({...l,topP:c.target.value}))})]}),h.jsxs("div",{children:[h.jsxs(Be,{children:[o("llm_setting.top_k"),":"]}),h.jsx(Kt,{type:"number",value:r.topK?`${r.topK}`:"",onChange:c=>a(l=>({...l,topK:c.target.value}))})]}),h.jsxs("div",{children:[h.jsxs(Be,{children:[o("llm_setting.max_tokens"),":"]}),h.jsx(Kt,{type:"number",value:r.maxTokens?`${r.maxTokens}`:"",onChange:c=>a(l=>({...l,maxTokens:c.target.value}))})]}),h.jsxs("div",{children:[h.jsxs(Be,{children:[o("llm_setting.stop_sequences"),":"]}),h.jsx(Kt,{placeholder:o("llm_setting.stop_sequences_placeholder"),value:r.stop?`${r.stop}`:"",onChange:c=>a(l=>({...l,stop:c.target.value}))})]})]}),h.jsx(Ya,{className:"flex justify-end",children:h.jsx(Ye,{variant:"secondary",onClick:s,children:o("llm_setting.save")})})]}):void 0})]})})}),Ibe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",height:192,viewBox:"0 0 150 150",width:192,...e},g.createElement("clipPath",{id:"a"},g.createElement("path",{d:"m0 0h150v150h-150z"})),g.createElement("g",{clipPath:"url(#a)"},g.createElement("path",{d:"m150 0h-150v150h150z",fill:"#29b5e8"}),g.createElement("path",{clipRule:"evenodd",d:"m130.375 67.2532-14.096 8.1221 14.096 8.0536c.843.4872 1.581 1.1357 2.174 1.9084.592.7727 1.026 1.6545 1.278 2.5951.251.9406.315 1.9215.188 2.8867-.128.9652-.444 1.8959-.931 2.7388-.488.843-1.136 1.5817-1.909 2.174s-1.654 1.0267-2.595 1.2782-1.921.3154-2.887.1878c-.965-.1275-1.896-.444-2.739-.9312l-25.2559-14.5496c-1.1575-.6696-2.1128-1.6394-2.765-2.8068-.6523-1.1674-.9773-2.4893-.9408-3.826.0198-.5792.1089-1.1538.2653-1.7117.517-1.8711 1.7458-3.4654 3.4234-4.4419l25.256-14.4983c.847-.4892 1.782-.8067 2.751-.9343.97-.1275 1.955-.0627 2.899.1909.945.2536 1.83.6909 2.605 1.287.775.596 1.425 1.3391 1.913 2.1866.49.8402.808 1.7693.935 2.7334.128.964.063 1.9439-.191 2.8826-.254.9388-.692 1.8177-1.288 2.5859-.597.7681-1.34 1.4101-2.186 1.8887zm-13.343 39.3698-25.2478-14.5243c-1.1296-.6483-2.4091-.9896-3.7115-.9902s-2.5823.3397-3.7124.987c-1.1301.6472-2.0712 1.579-2.7297 2.7026-.6585 1.1237-1.0115 2.4001-1.0239 3.7024v29.0135c.0654 1.928.8772 3.755 2.264 5.095 1.3869 1.341 3.2403 2.09 5.1691 2.09 1.9289 0 3.7823-.749 5.1691-2.09 1.3868-1.34 2.1986-3.167 2.264-5.095v-16.261l14.1301 8.122c.843.488 1.774.805 2.739.933.966.128 1.947.064 2.888-.187s1.823-.685 2.596-1.277c.774-.592 1.423-1.331 1.91-2.174.488-.843.805-1.773.933-2.739.128-.965.065-1.946-.186-2.887s-.685-1.824-1.277-2.597-1.331-1.422-2.174-1.91zm-29.0992-28.3806-10.527 10.3986c-.3601.3349-.8269.5319-1.318.5563h-3.0897c-.49-.0294-.9551-.2257-1.318-.5563l-10.4671-10.4329c-.3274-.3573-.521-.817-.5478-1.3009v-3.081c.0283-.4861.2215-.9481.5478-1.3095l10.4671-10.4329c.3637-.3281.829-.5214 1.318-.5477h3.0897c.4899.0228.9562.2166 1.318.5477l10.4928 10.4329c.3237.3623.514.8243.5392 1.3095v3.081c-.0237.483-.2143.9428-.5392 1.3009zm-8.3874-2.8928c-.0404-.499-.2485-.9696-.5905-1.3352l-3.0383-3.004c-.3641-.3275-.8291-.5207-1.318-.5478h-.1113c-.4867.0255-.9495.2191-1.3094.5478l-3.0383 3.004c-.3262.3676-.5165.8358-.5392 1.3266v.1113c.0215.4834.2124.9439.5392 1.3009l3.0554 2.9955c.3607.3274.823.5208 1.3094.5477h.1113c.4889-.027.9539-.2203 1.318-.5477l3.0383-3.0212c.3282-.3576.5244-.8166.5563-1.3009zm-47.4914-31.2217 25.2563 14.4811c1.1308.648 2.4115.989 3.7149.9889 1.3033 0 2.584-.3409 3.7148-.989 1.1309-.648 2.0725-1.5806 2.7314-2.7051.659-1.1245 1.0123-2.4018 1.0249-3.7051v-28.9879c-.0654-1.9277-.8772-3.7546-2.264-5.0952s-3.2402-2.0899-5.1691-2.0899c-1.9288 0-3.7822.7493-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v16.2613l-14.1473-8.1307c-.8429-.4877-1.7737-.8047-2.7392-.9328-.9654-.1281-1.9466-.0647-2.8876.1864s-1.8232.6852-2.5965 1.2773c-.7732.5921-1.4222 1.3307-1.91 2.1736-.4878.843-.8048 1.7738-.9329 2.7392-.128.9655-.0647 1.9467.1864 2.8876.2512.941.6852 1.8233 1.2773 2.5965.5921.7733 1.3307 1.4223 2.1737 1.9101zm55.4252 15.4739c1.4914.118 2.9836-.2193 4.2793-.9671l25.2475-14.5496c.843-.4877 1.582-1.1368 2.174-1.91s1.026-1.6555 1.277-2.5965.315-1.9222.187-2.8876c-.128-.9655-.445-1.8962-.933-2.7392-.488-.8429-1.137-1.5816-1.91-2.1737-.774-.5921-1.656-1.0261-2.597-1.2772-1.9-.5072-3.924-.2387-5.627.7464l-14.1298 8.1991v-16.2613c-.0654-1.9277-.8772-3.7546-2.264-5.0952-1.3868-1.3405-3.2402-2.0899-5.1691-2.0899-1.9288 0-3.7822.7494-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v29.0136c-.0023 1.8784.7086 3.6876 1.9892 5.0619 1.2805 1.3743 3.0351 2.2111 4.909 2.3412zm-25.8554 31.5298c-1.4916-.1213-2.9847.2162-4.2793.9671l-25.2905 14.4893c-1.7024.985-2.9438 2.607-3.451 4.507s-.2387 3.924.7465 5.627c.9851 1.702 2.6061 2.943 4.5065 3.451 1.9004.507 3.9244.238 5.6268-.747l14.1473-8.122v16.261c.0654 1.928.8772 3.755 2.2641 5.096 1.3868 1.34 3.2402 2.09 5.169 2.09 1.9289 0 3.7823-.75 5.1691-2.09 1.3868-1.341 2.1986-3.168 2.264-5.096v-29.0645c-.0038-1.869-.7144-3.6673-1.9891-5.0341s-3.0192-2.2009-4.8834-2.3348zm-6.8468-13.5825c.4875-1.6032.414-3.3247-.2083-4.8806-.6224-1.5559-1.7564-2.8532-3.2152-3.6779l-25.2306-14.541c-1.704-.976-3.7248-1.2385-5.6216-.7303-1.8968.5083-3.5155 1.7461-4.5032 3.4433-.4889.84-.8065 1.7686-.9343 2.732-.1278.9635-.0632 1.9428.1899 2.8811.2531.9384.6897 1.8173 1.2846 2.5858.595.7686 1.3364 1.4115 2.1814 1.8917l14.096 8.1221-14.096 8.0536c-.8429.4861-1.5819 1.1334-2.1746 1.9051-.5928.7717-1.0277 1.6526-1.2801 2.5923-.2523.9398-.317 1.9201-.1905 2.8849s.4418 1.8952.9279 2.7382c.4861.8429 1.1335 1.5819 1.9051 2.1746.7717.5928 1.6526 1.0277 2.5924 1.2801.9397.2523 1.92.317 2.8848.1905s1.8952-.4418 2.7382-.9279l25.2306-14.5496c1.6248-.9071 2.8451-2.3965 3.4149-4.168z",fill:"#fff",fillRule:"evenodd"}))),Rbe=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:48,height:48,...e},g.createElement("path",{fill:"#fbc02d",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20 s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),g.createElement("path",{fill:"#e53935",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039 l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),g.createElement("path",{fill:"#4caf50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36 c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),g.createElement("path",{fill:"#1565c0",d:"M43.611,20.083L43.595,20L42,20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571 c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),Dbe=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:1024,height:1024,viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M44.522 44.5217H489.739V489.739H44.522V44.5217Z",fill:"#F35325"}),g.createElement("path",{d:"M534.261 44.5217H979.478V489.739H534.261V44.5217Z",fill:"#81BC06"}),g.createElement("path",{d:"M44.522 534.261H489.739V979.478H44.522V534.261Z",fill:"#05A6F0"}),g.createElement("path",{d:"M534.261 534.261H979.478V979.478H534.261V534.261Z",fill:"#FFBA08"})),Lbe=e=>g.createElement("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 287.56 191",...e},g.createElement("defs",null,g.createElement("style",null,".cls-1{fill:#0081fb;}.cls-2{fill:url(#linear-gradient);}.cls-3{fill:url(#linear-gradient-2);}"),g.createElement("linearGradient",{id:"linear-gradient",x1:62.34,y1:101.45,x2:260.34,y2:91.45,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0064e1"}),g.createElement("stop",{offset:.4,stopColor:"#0064e1"}),g.createElement("stop",{offset:.83,stopColor:"#0073ee"}),g.createElement("stop",{offset:1,stopColor:"#0082fb"})),g.createElement("linearGradient",{id:"linear-gradient-2",x1:41.42,y1:53,x2:41.42,y2:126,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0082fb"}),g.createElement("stop",{offset:1,stopColor:"#0064e0"}))),g.createElement("title",null,"facebook-meta"),g.createElement("path",{className:"cls-1",d:"M31.06,126c0,11,2.41,19.41,5.56,24.51A19,19,0,0,0,53.19,160c8.1,0,15.51-2,29.79-21.76,11.44-15.83,24.92-38,34-52l15.36-23.6c10.67-16.39,23-34.61,37.18-47C181.07,5.6,193.54,0,206.09,0c21.07,0,41.14,12.21,56.5,35.11,16.81,25.08,25,56.67,25,89.27,0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191V160c17.63,0,22-16.2,22-34.74,0-26.42-6.16-55.74-19.73-76.69-9.63-14.86-22.11-23.94-35.84-23.94-14.85,0-26.8,11.2-40.23,31.17-7.14,10.61-14.47,23.54-22.7,38.13l-9.06,16c-18.2,32.27-22.81,39.62-31.91,51.75C84.74,183,71.12,191,53.19,191c-21.27,0-34.72-9.21-43-23.09C3.34,156.6,0,141.76,0,124.85Z"}),g.createElement("path",{className:"cls-2",d:"M24.49,37.3C38.73,15.35,59.28,0,82.85,0c13.65,0,27.22,4,41.39,15.61,15.5,12.65,32,33.48,52.63,67.81l7.39,12.32c17.84,29.72,28,45,33.93,52.22,7.64,9.26,13,12,19.94,12,17.63,0,22-16.2,22-34.74l27.4-.86c0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191c-12.8,0-24.14-2.78-36.68-14.61-9.64-9.08-20.91-25.21-29.58-39.71L146.08,93.6c-12.94-21.62-24.81-37.74-31.68-45C107,40.71,97.51,31.23,82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78Z"}),g.createElement("path",{className:"cls-3",d:"M82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78C38.61,71.62,31.06,99.34,31.06,126c0,11,2.41,19.41,5.56,24.51L10.14,167.91C3.34,156.6,0,141.76,0,124.85,0,94.1,8.44,62.05,24.49,37.3,38.73,15.35,59.28,0,82.85,0Z"})),$be=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:256,height:233,viewBox:"0 0 256 233",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M186.182 0h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#f7d046",d:"M209.455 0H256v46.545h-46.545z"}),g.createElement("path",{d:"M0 0h46.545v46.545H0zm0 46.545h46.545V93.09H0zm0 46.546h46.545v46.545H0zm0 46.545h46.545v46.545H0zm0 46.546h46.545v46.545H0z"}),g.createElement("path",{fill:"#f7d046",d:"M23.273 0h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#f2a73b",d:"M209.455 46.545H256V93.09h-46.545zm-186.182 0h46.545V93.09H23.273z"}),g.createElement("path",{d:"M139.636 46.545h46.545V93.09h-46.545z"}),g.createElement("path",{fill:"#f2a73b",d:"M162.909 46.545h46.545V93.09h-46.545zm-93.091 0h46.545V93.09H69.818z"}),g.createElement("path",{fill:"#ee792f",d:"M116.364 93.091h46.545v46.545h-46.545zm46.545 0h46.545v46.545h-46.545zm-93.091 0h46.545v46.545H69.818z"}),g.createElement("path",{d:"M93.091 139.636h46.545v46.545H93.091z"}),g.createElement("path",{fill:"#eb5829",d:"M116.364 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#ee792f",d:"M209.455 93.091H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"}),g.createElement("path",{d:"M186.182 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M209.455 139.636H256v46.545h-46.545z"}),g.createElement("path",{d:"M186.182 186.182h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M23.273 139.636h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#ea3326",d:"M209.455 186.182H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"})),Fbe="/NoLLMChat/assets/qwen-B-gSh3_v.webp",Bbe="/NoLLMChat/assets/smollm-CikBjd4F.png",zbe="/NoLLMChat/assets/stablelm-BquePdQ7.png",Ube="/NoLLMChat/assets/nomic-BjJqoFji.webp",Vbe="/NoLLMChat/assets/joshua-ByaReJuI.webp",Wbe="/NoLLMChat/assets/deepseek-CRqFMahi.png",Hbe="/NoLLMChat/assets/redpajama-CmUGqSQW.png",qbe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{fill:"#fff",d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),Kbe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),Tr=g.memo(({name:e,className:t,...n})=>{const r=eu(a=>a.theme);return e=e.toLowerCase(),e.includes("gpt")?r==="dark"?h.jsx(qbe,{className:Z("w-5 h-5",t),...n}):h.jsx(Kbe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("deepseek")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:Wbe,alt:"deepseek",...n}):e!=null&&e.includes("redpajama")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:Hbe,alt:"deepseek",...n}):e.includes("gemma")||e.includes("gemini")?h.jsx(Rbe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("qwen")?h.jsx("img",{className:Z("w-5 h-5",t),src:Fbe,alt:"qwen",...n}):e!=null&&e.includes("phi")?h.jsx(Dbe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("llama")?h.jsx(Lbe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("smollm")?h.jsx("img",{className:Z("w-5 h-5",t),src:Bbe,alt:"smollm",...n}):e!=null&&e.includes("mistral")?h.jsx($be,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("snowflake")?h.jsx(Ibe,{className:Z("w-5 h-5 rounded-full",t),...n}):e!=null&&e.includes("stablelm")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:zbe,alt:"stablelm",...n}):e!=null&&e.includes("nomic")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:Ube,alt:"nomic",...n}):e!=null&&e.includes("Xenova")||e!=null&&e.includes("janus")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:Vbe,alt:"Xenova",...n}):h.jsx(pe,{className:Z("w-5 h-5",t),name:"brain"})}),eS=["Qwen2.5-1.5B-Instruct-q4f32_1-MLC","Qwen2.5-Coder-1.5B-Instruct-q4f16_1-MLC","stablelm-2-zephyr-1_6b-q4f16_1-MLC-1k","Phi-3.5-mini-instruct-q4f16_1-MLC-1k","Llama-3.2-3B-Instruct-q4f32_1-MLC","DeepSeek-R1-Distill-Qwen-7B-q4f16_1-MLC"],Zbe=uo("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function wn({className:e,variant:t,...n}){return h.jsx("div",{className:Z(Zbe({variant:t}),e),...n})}const ip=g.memo(e=>{var l;const{cloud:t,name:n,model:r,isCached:a,isFunctionCalling:o}=e,{t:i}=Me("atoms"),s=g.useCallback(u=>u===1?"llm_info.model_types.embedding":u===2?"llm_info.model_types.vlm":"llm_info.model_types.llm",[]),c=g.useMemo(()=>{if(r)switch(r.model_type){case 0:case 1:return h.jsx(wn,{className:"",children:i(s(r.model_type))});case 2:return h.jsxs(h.Fragment,{children:[h.jsx(wn,{className:"",children:i(s(0))}),h.jsx(wn,{className:"",children:i(s(r.model_type))})]})}},[r,s,i]);if(r)return h.jsxs(h.Fragment,{children:[c,eS.some(u=>n&&u.includes(n))?h.jsx(wn,{className:"",variant:"outline",children:i("llm_info.recommended")}):null,a?h.jsx(wn,{className:"",variant:"outline",children:i("llm_info.cached")}):null,t?h.jsx(wn,{className:"",variant:"outline",children:i("llm_info.cloud")}):null,o?h.jsx(wn,{className:"",variant:"outline",children:i("llm_info.function_calling")}):null,r!=null&&r.low_resource_required?h.jsx(wn,{className:"",variant:"outline",children:i("llm_info.low_resource_required")}):null,(l=r==null?void 0:r.overrides)!=null&&l.context_window_size?h.jsxs(wn,{className:"",variant:"outline",children:[r.overrides.context_window_size.toLocaleString("en-US")," Tokens"]}):null,r!=null&&r.vram_required_MB?h.jsxs(wn,{className:"",variant:"outline",children:["VRAM: ",r.vram_required_MB.toLocaleString("en-US")," MB"]}):null]})}),Gbe=g.memo(({llm:e,status:t,loadLLM:n,progress:r})=>{const{t:a}=Me("flows"),[o,i]=g.useState();g.useEffect(()=>{if(!(o||!(e!=null&&e.name))){if((e==null?void 0:e.provider)!=="WebLLM"){i({hasCache:!1,cloud:!0,isFunctionCalling:!0,info:{model_id:e==null?void 0:e.name,model:e==null?void 0:e.name,model_lib:e==null?void 0:e.provider,model_type:2}});return}qt(()=>import("./index-C6S3C89h.js").then(async l=>(await l.__tla,l)),__vite__mapDeps([9,1,2,3,4])).then(async({hasModelInCache:l,functionCallingModelIds:u,prebuiltAppConfig:d})=>{const p=await l(e==null?void 0:e.name);i({hasCache:p,isFunctionCalling:u.includes(e==null?void 0:e.name),info:d.model_list.find(f=>f.model_id===(e==null?void 0:e.name))})})}},[e==null?void 0:e.name,o]);const s=g.useCallback(async()=>{await(n==null?void 0:n())},[n]),c=g.useMemo(()=>{switch(t){case et.Downloading:return h.jsx(pe,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case et.Loaded:return h.jsx(Tr,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"});default:return h.jsx(Tr,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"})}},[e==null?void 0:e.name,t]);return h.jsx(Gt,{className:"flex justify-center !bg-inherit !p-2 max-w-full overflow-y-hidden !mb-2 m-2 !mt-0",children:h.jsxs("div",{className:"ml-2 pt-1 max-w-full",children:[h.jsxs("p",{className:"flex gap-2 items-center pr-6 !text-sm font-semibold",children:[c,`${(e==null?void 0:e.name)||""}`]}),h.jsxs("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:[h.jsx(ip,{model:o==null?void 0:o.info,isFunctionCalling:(o==null?void 0:o.isFunctionCalling)||!1,name:e==null?void 0:e.name,isCached:(o==null?void 0:o.hasCache)||!1,cloud:(o==null?void 0:o.cloud)||!1}),t!==et.Loaded?r?h.jsx("div",{className:"text-sm break-words flex-wrap",children:r}):h.jsx(Ye,{disabled:t===et.Loading,onClick:s,className:"mt-4 w-full",children:a(o!=null&&o.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")}):void 0]})]})})});class Xbe{async loadAndSplit(t){if(t===void 0)throw new Error("You must pass a text splitter to use this method.");const n=await this.load();return t.invoke(n)}}class B9 extends Xbe{constructor(t,{splitPages:n=!0,pdfjs:r=Jbe,parsedItemSeparator:a=""}={}){super(),Object.defineProperty(this,"blob",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"splitPages",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"pdfjs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parsedItemSeparator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.blob=t,this.splitPages=n??this.splitPages,this.pdfjs=r,this.parsedItemSeparator=a}async load(){const{getDocument:t,version:n}=await this.pdfjs(),r=await t({data:new Uint8Array(await this.blob.arrayBuffer()),useWorkerFetch:!1,isEvalSupported:!1,useSystemFonts:!0}).promise,a=await r.getMetadata().catch(()=>null),o=[];for(let i=1;i<=r.numPages;i+=1){const s=await(await r.getPage(i)).getTextContent();if(s.items.length===0)continue;let c;const l=[];for(const d of s.items)"str"in d&&(c===d.transform[5]||!c?l.push(d.str):l.push(`
${d.str}`),c=d.transform[5]);const u=l.join(this.parsedItemSeparator);o.push(new bf({pageContent:u,metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages},loc:{pageNumber:i}}}))}return this.splitPages?o:o.length===0?[]:[new bf({pageContent:o.map(i=>i.pageContent).join(`

`),metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages}}})]}}async function Jbe(){try{const{default:e}=await qt(async()=>{const{default:r}=await import("./pdf-2QNsmwQ-.js").then(async a=>(await a.__tla,a)).then(a=>a.p);return{default:r}},__vite__mapDeps([10,1,2])),{getDocument:t,version:n}=e;return{getDocument:t,version:n}}catch(e){throw console.error(e),new Error("Failed to load pdf-parse. Please install it with eg. `npm install pdf-parse`.")}}var tS="Tabs",[Ybe,O3e]=pr(tS,[fo]),z9=fo(),[Qbe,nS]=Ybe(tS),U9=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:o,orientation:i="horizontal",dir:s,activationMode:c="automatic",...l}=e,u=oi(s),[d,p]=In({prop:r,onChange:a,defaultProp:o});return h.jsx(Qbe,{scope:n,baseId:Rt(),value:d,onValueChange:p,orientation:i,dir:u,activationMode:c,children:h.jsx(Pe.div,{dir:u,"data-orientation":i,...l,ref:t})})});U9.displayName=tS;var V9="TabsList",W9=g.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,o=nS(V9,n),i=z9(n);return h.jsx(uu,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:r,children:h.jsx(Pe.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:t})})});W9.displayName=V9;var H9="TabsTrigger",q9=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...o}=e,i=nS(H9,n),s=z9(n),c=G9(i.baseId,r),l=X9(i.baseId,r),u=r===i.value;return h.jsx(du,{asChild:!0,...s,focusable:!a,active:u,children:h.jsx(Pe.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":l,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:t,onMouseDown:ge(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?i.onValueChange(r):d.preventDefault()}),onKeyDown:ge(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(r)}),onFocus:ge(e.onFocus,()=>{const d=i.activationMode!=="manual";!u&&!a&&d&&i.onValueChange(r)})})})});q9.displayName=H9;var K9="TabsContent",Z9=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:o,...i}=e,s=nS(K9,n),c=G9(s.baseId,r),l=X9(s.baseId,r),u=r===s.value,d=g.useRef(u);return g.useEffect(()=>{const p=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(p)},[]),h.jsx(Ur,{present:a||u,children:({present:p})=>h.jsx(Pe.div,{"data-state":u?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":c,hidden:!p,id:l,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:p&&o})})});Z9.displayName=K9;function G9(e,t){return`${e}-trigger-${t}`}function X9(e,t){return`${e}-content-${t}`}var ewe=U9,J9=W9,Y9=q9,Q9=Z9;const rS=ewe,Oy=g.forwardRef(({className:e,...t},n)=>h.jsx(J9,{ref:n,className:Z("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Oy.displayName=J9.displayName;const xa=g.forwardRef(({className:e,...t},n)=>h.jsx(Y9,{ref:n,className:Z("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));xa.displayName=Y9.displayName;const _a=g.forwardRef(({className:e,...t},n)=>h.jsx(Q9,{ref:n,className:Z("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));_a.displayName=Q9.displayName,E0=function(e,[t,n]){return Math.min(n,Math.max(t,e))};function eB(e){const t=g.useRef({value:e,previous:e});return g.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var twe=[" ","Enter","ArrowUp","ArrowDown"],nwe=[" ","Enter"],sp="Select",[Cy,Ny,rwe]=yf(sp),[sl,C3e]=pr(sp,[rwe,cc]),ky=cc(),[awe,Ai]=sl(sp),[owe,iwe]=sl(sp),tB=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:o,value:i,defaultValue:s,onValueChange:c,dir:l,name:u,autoComplete:d,disabled:p,required:f,form:m}=e,y=ky(t),[v,b]=g.useState(null),[w,_]=g.useState(null),[x,j]=g.useState(!1),E=oi(l),[S=!1,O]=In({prop:r,defaultProp:a,onChange:o}),[N,M]=In({prop:i,defaultProp:s,onChange:c}),k=g.useRef(null),A=v?m||!!v.closest("form"):!0,[P,C]=g.useState(new Set),T=Array.from(P).map(I=>I.props.value).join(";");return h.jsx(uh,{...y,children:h.jsxs(awe,{required:f,scope:t,trigger:v,onTriggerChange:b,valueNode:w,onValueNodeChange:_,valueNodeHasChildren:x,onValueNodeHasChildrenChange:j,contentId:Rt(),value:N,onValueChange:M,open:S,onOpenChange:O,dir:E,triggerPointerDownPosRef:k,disabled:p,children:[h.jsx(Cy.Provider,{scope:t,children:h.jsx(owe,{scope:e.__scopeSelect,onNativeOptionAdd:g.useCallback(I=>{C(R=>new Set(R).add(I))},[]),onNativeOptionRemove:g.useCallback(I=>{C(R=>{const L=new Set(R);return L.delete(I),L})},[]),children:n})}),A?h.jsxs(OB,{"aria-hidden":!0,required:f,tabIndex:-1,name:u,autoComplete:d,value:N,onChange:I=>M(I.target.value),disabled:p,form:m,children:[N===void 0?h.jsx("option",{value:""}):null,Array.from(P)]},T):null]})})};tB.displayName=sp;var nB="SelectTrigger",rB=g.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,o=ky(n),i=Ai(nB,n),s=i.disabled||r,c=jt(t,i.onTriggerChange),l=Ny(n),u=g.useRef("touch"),[d,p,f]=CB(y=>{const v=l().filter(_=>!_.disabled),b=v.find(_=>_.value===i.value),w=NB(v,y,b);w!==void 0&&i.onValueChange(w.value)}),m=y=>{s||(i.onOpenChange(!0),f()),y&&(i.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return h.jsx(Ib,{asChild:!0,...o,children:h.jsx(Pe.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":SB(i.value)?"":void 0,...a,ref:c,onClick:ge(a.onClick,y=>{y.currentTarget.focus(),u.current!=="mouse"&&m(y)}),onPointerDown:ge(a.onPointerDown,y=>{u.current=y.pointerType;const v=y.target;v.hasPointerCapture(y.pointerId)&&v.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(m(y),y.preventDefault())}),onKeyDown:ge(a.onKeyDown,y=>{const v=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&p(y.key),!(v&&y.key===" ")&&twe.includes(y.key)&&(m(),y.preventDefault())})})})});rB.displayName=nB;var aB="SelectValue",oB=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:o,placeholder:i="",...s}=e,c=Ai(aB,n),{onValueNodeHasChildrenChange:l}=c,u=o!==void 0,d=jt(t,c.onValueNodeChange);return ln(()=>{l(u)},[l,u]),h.jsx(Pe.span,{...s,ref:d,style:{pointerEvents:"none"},children:SB(c.value)?h.jsx(h.Fragment,{children:i}):o})});oB.displayName=aB;var swe="SelectIcon",iB=g.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return h.jsx(Pe.span,{"aria-hidden":!0,...a,ref:t,children:r||"\u25BC"})});iB.displayName=swe;var cwe="SelectPortal",sB=e=>h.jsx(Nv,{asChild:!0,...e});sB.displayName=cwe;var _s="SelectContent",cB=g.forwardRef((e,t)=>{const n=Ai(_s,e.__scopeSelect),[r,a]=g.useState();if(ln(()=>{a(new DocumentFragment)},[]),!n.open){const o=r;return o?Ql.createPortal(h.jsx(lB,{scope:e.__scopeSelect,children:h.jsx(Cy.Slot,{scope:e.__scopeSelect,children:h.jsx("div",{children:e.children})})}),o):null}return h.jsx(uB,{...e,ref:t})});cB.displayName=_s;var ja=10,[lB,Pi]=sl(_s),lwe="SelectContentImpl",uB=g.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:i,side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:p,collisionPadding:f,sticky:m,hideWhenDetached:y,avoidCollisions:v,...b}=e,w=Ai(_s,n),[_,x]=g.useState(null),[j,E]=g.useState(null),S=jt(t,ee=>x(ee)),[O,N]=g.useState(null),[M,k]=g.useState(null),A=Ny(n),[P,C]=g.useState(!1),T=g.useRef(!1);g.useEffect(()=>{if(_)return fu(_)},[_]),hu();const I=g.useCallback(ee=>{const[G,...K]=A().map(B=>B.ref.current),[X]=K.slice(-1),ne=document.activeElement;for(const B of ee)if(B===ne||(B==null||B.scrollIntoView({block:"nearest"}),B===G&&j&&(j.scrollTop=0),B===X&&j&&(j.scrollTop=j.scrollHeight),B==null||B.focus(),document.activeElement!==ne))return},[A,j]),R=g.useCallback(()=>I([O,_]),[I,O,_]);g.useEffect(()=>{P&&R()},[P,R]);const{onOpenChange:L,triggerPointerDownPosRef:D}=w;g.useEffect(()=>{if(_){let ee={x:0,y:0};const G=X=>{var ne,B;ee={x:Math.abs(Math.round(X.pageX)-(((ne=D.current)==null?void 0:ne.x)??0)),y:Math.abs(Math.round(X.pageY)-(((B=D.current)==null?void 0:B.y)??0))}},K=X=>{ee.x<=10&&ee.y<=10?X.preventDefault():_.contains(X.target)||L(!1),document.removeEventListener("pointermove",G),D.current=null};return D.current!==null&&(document.addEventListener("pointermove",G),document.addEventListener("pointerup",K,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",G),document.removeEventListener("pointerup",K,{capture:!0})}}},[_,L,D]),g.useEffect(()=>{const ee=()=>L(!1);return window.addEventListener("blur",ee),window.addEventListener("resize",ee),()=>{window.removeEventListener("blur",ee),window.removeEventListener("resize",ee)}},[L]);const[z,U]=CB(ee=>{const G=A().filter(ne=>!ne.disabled),K=G.find(ne=>ne.ref.current===document.activeElement),X=NB(G,ee,K);X&&setTimeout(()=>X.ref.current.focus())}),$=g.useCallback((ee,G,K)=>{const X=!T.current&&!K;(w.value!==void 0&&w.value===G||X)&&(N(ee),X&&(T.current=!0))},[w.value]),V=g.useCallback(()=>_==null?void 0:_.focus(),[_]),F=g.useCallback((ee,G,K)=>{const X=!T.current&&!K;(w.value!==void 0&&w.value===G||X)&&k(ee)},[w.value]),W=r==="popper"?aS:dB,re=W===aS?{side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:p,collisionPadding:f,sticky:m,hideWhenDetached:y,avoidCollisions:v}:{};return h.jsx(lB,{scope:n,content:_,viewport:j,onViewportChange:E,itemRefCallback:$,selectedItem:O,onItemLeave:V,itemTextRefCallback:F,focusSelectedItem:R,selectedItemText:M,position:r,isPositioned:P,searchRef:z,children:h.jsx(Yf,{as:ri,allowPinchZoom:!0,children:h.jsx(Wf,{asChild:!0,trapped:w.open,onMountAutoFocus:ee=>{ee.preventDefault()},onUnmountAutoFocus:ge(a,ee=>{var G;(G=w.trigger)==null||G.focus({preventScroll:!0}),ee.preventDefault()}),children:h.jsx(Cv,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:ee=>ee.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:h.jsx(W,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:ee=>ee.preventDefault(),...b,...re,onPlaced:()=>C(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:ge(b.onKeyDown,ee=>{const G=ee.ctrlKey||ee.altKey||ee.metaKey;if(ee.key==="Tab"&&ee.preventDefault(),!G&&ee.key.length===1&&U(ee.key),["ArrowUp","ArrowDown","Home","End"].includes(ee.key)){let K=A().filter(X=>!X.disabled).map(X=>X.ref.current);if(["ArrowUp","End"].includes(ee.key)&&(K=K.slice().reverse()),["ArrowUp","ArrowDown"].includes(ee.key)){const X=ee.target,ne=K.indexOf(X);K=K.slice(ne+1)}setTimeout(()=>I(K)),ee.preventDefault()}})})})})})})});uB.displayName=lwe;var uwe="SelectItemAlignedPosition",dB=g.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,o=Ai(_s,n),i=Pi(_s,n),[s,c]=g.useState(null),[l,u]=g.useState(null),d=jt(t,S=>u(S)),p=Ny(n),f=g.useRef(!1),m=g.useRef(!0),{viewport:y,selectedItem:v,selectedItemText:b,focusSelectedItem:w}=i,_=g.useCallback(()=>{if(o.trigger&&o.valueNode&&s&&l&&y&&v&&b){const S=o.trigger.getBoundingClientRect(),O=l.getBoundingClientRect(),N=o.valueNode.getBoundingClientRect(),M=b.getBoundingClientRect();if(o.dir!=="rtl"){const X=M.left-O.left,ne=N.left-X,B=S.left-ne,ue=S.width+B,ae=Math.max(ue,O.width),de=window.innerWidth-ja,je=E0(ne,[ja,Math.max(ja,de-ae)]);s.style.minWidth=ue+"px",s.style.left=je+"px"}else{const X=O.right-M.right,ne=window.innerWidth-N.right-X,B=window.innerWidth-S.right-ne,ue=S.width+B,ae=Math.max(ue,O.width),de=window.innerWidth-ja,je=E0(ne,[ja,Math.max(ja,de-ae)]);s.style.minWidth=ue+"px",s.style.right=je+"px"}const k=p(),A=window.innerHeight-ja*2,P=y.scrollHeight,C=window.getComputedStyle(l),T=parseInt(C.borderTopWidth,10),I=parseInt(C.paddingTop,10),R=parseInt(C.borderBottomWidth,10),L=parseInt(C.paddingBottom,10),D=T+I+P+L+R,z=Math.min(v.offsetHeight*5,D),U=window.getComputedStyle(y),$=parseInt(U.paddingTop,10),V=parseInt(U.paddingBottom,10),F=S.top+S.height/2-ja,W=A-F,re=v.offsetHeight/2,ee=v.offsetTop+re,G=T+I+ee,K=D-G;if(G<=F){const X=k.length>0&&v===k[k.length-1].ref.current;s.style.bottom="0px";const ne=l.clientHeight-y.offsetTop-y.offsetHeight,B=Math.max(W,re+(X?V:0)+ne+R),ue=G+B;s.style.height=ue+"px"}else{const X=k.length>0&&v===k[0].ref.current;s.style.top="0px";const ne=Math.max(F,T+y.offsetTop+(X?$:0)+re)+K;s.style.height=ne+"px",y.scrollTop=G-F+y.offsetTop}s.style.margin=`${ja}px 0`,s.style.minHeight=z+"px",s.style.maxHeight=A+"px",r==null||r(),requestAnimationFrame(()=>f.current=!0)}},[p,o.trigger,o.valueNode,s,l,y,v,b,o.dir,r]);ln(()=>_(),[_]);const[x,j]=g.useState();ln(()=>{l&&j(window.getComputedStyle(l).zIndex)},[l]);const E=g.useCallback(S=>{S&&m.current===!0&&(_(),w==null||w(),m.current=!1)},[_,w]);return h.jsx(pwe,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:f,onScrollButtonChange:E,children:h.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:x},children:h.jsx(Pe.div,{...a,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});dB.displayName=uwe;var dwe="SelectPopperPosition",aS=g.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=ja,...o}=e,i=ky(n);return h.jsx(Rb,{...i,...o,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});aS.displayName=dwe;var[pwe,oS]=sl(_s,{}),iS="SelectViewport",pB=g.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,o=Pi(iS,n),i=oS(iS,n),s=jt(t,o.onViewportChange),c=g.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),h.jsx(Cy.Slot,{scope:n,children:h.jsx(Pe.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ge(a.onScroll,l=>{const u=l.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:p}=i;if(p!=null&&p.current&&d){const f=Math.abs(c.current-u.scrollTop);if(f>0){const m=window.innerHeight-ja*2,y=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),b=Math.max(y,v);if(b<m){const w=b+f,_=Math.min(m,w),x=w-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=x>0?x:0,d.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});pB.displayName=iS;var fB="SelectGroup",[fwe,hwe]=sl(fB),mwe=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Rt();return h.jsx(fwe,{scope:n,id:a,children:h.jsx(Pe.div,{role:"group","aria-labelledby":a,...r,ref:t})})});mwe.displayName=fB;var hB="SelectLabel",mB=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=hwe(hB,n);return h.jsx(Pe.div,{id:a.id,...r,ref:t})});mB.displayName=hB;var My="SelectItem",[ywe,yB]=sl(My),gB=g.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:o,...i}=e,s=Ai(My,n),c=Pi(My,n),l=s.value===r,[u,d]=g.useState(o??""),[p,f]=g.useState(!1),m=jt(t,w=>{var _;return(_=c.itemRefCallback)==null?void 0:_.call(c,w,r,a)}),y=Rt(),v=g.useRef("touch"),b=()=>{a||(s.onValueChange(r),s.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(ywe,{scope:n,value:r,disabled:a,textId:y,isSelected:l,onItemTextChange:g.useCallback(w=>{d(_=>_||((w==null?void 0:w.textContent)??"").trim())},[]),children:h.jsx(Cy.ItemSlot,{scope:n,value:r,disabled:a,textValue:u,children:h.jsx(Pe.div,{role:"option","aria-labelledby":y,"data-highlighted":p?"":void 0,"aria-selected":l&&p,"data-state":l?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:m,onFocus:ge(i.onFocus,()=>f(!0)),onBlur:ge(i.onBlur,()=>f(!1)),onClick:ge(i.onClick,()=>{v.current!=="mouse"&&b()}),onPointerUp:ge(i.onPointerUp,()=>{v.current==="mouse"&&b()}),onPointerDown:ge(i.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:ge(i.onPointerMove,w=>{var _;v.current=w.pointerType,a?(_=c.onItemLeave)==null||_.call(c):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ge(i.onPointerLeave,w=>{var _;w.currentTarget===document.activeElement&&((_=c.onItemLeave)==null||_.call(c))}),onKeyDown:ge(i.onKeyDown,w=>{var _;((_=c.searchRef)==null?void 0:_.current)!==""&&w.key===" "||(nwe.includes(w.key)&&b(),w.key===" "&&w.preventDefault())})})})})});gB.displayName=My;var cp="SelectItemText",vB=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...o}=e,i=Ai(cp,n),s=Pi(cp,n),c=yB(cp,n),l=iwe(cp,n),[u,d]=g.useState(null),p=jt(t,b=>d(b),c.onItemTextChange,b=>{var w;return(w=s.itemTextRefCallback)==null?void 0:w.call(s,b,c.value,c.disabled)}),f=u==null?void 0:u.textContent,m=g.useMemo(()=>h.jsx("option",{value:c.value,disabled:c.disabled,children:f},c.value),[c.disabled,c.value,f]),{onNativeOptionAdd:y,onNativeOptionRemove:v}=l;return ln(()=>(y(m),()=>v(m)),[y,v,m]),h.jsxs(h.Fragment,{children:[h.jsx(Pe.span,{id:c.textId,...o,ref:p}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Ql.createPortal(o.children,i.valueNode):null]})});vB.displayName=cp;var bB="SelectItemIndicator",wB=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return yB(bB,n).isSelected?h.jsx(Pe.span,{"aria-hidden":!0,...r,ref:t}):null});wB.displayName=bB;var sS="SelectScrollUpButton",xB=g.forwardRef((e,t)=>{const n=Pi(sS,e.__scopeSelect),r=oS(sS,e.__scopeSelect),[a,o]=g.useState(!1),i=jt(t,r.onScrollButtonChange);return ln(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollTop>0;o(l)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(jB,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop-c.offsetHeight)}}):null});xB.displayName=sS;var cS="SelectScrollDownButton",_B=g.forwardRef((e,t)=>{const n=Pi(cS,e.__scopeSelect),r=oS(cS,e.__scopeSelect),[a,o]=g.useState(!1),i=jt(t,r.onScrollButtonChange);return ln(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<l;o(u)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(jB,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop+c.offsetHeight)}}):null});_B.displayName=cS;var jB=g.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,o=Pi("SelectScrollButton",n),i=g.useRef(null),s=Ny(n),c=g.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return g.useEffect(()=>()=>c(),[c]),ln(()=>{var l,u;(u=(l=s().find(d=>d.ref.current===document.activeElement))==null?void 0:l.ref.current)==null||u.scrollIntoView({block:"nearest"})},[s]),h.jsx(Pe.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ge(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:ge(a.onPointerMove,()=>{var l;(l=o.onItemLeave)==null||l.call(o),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:ge(a.onPointerLeave,()=>{c()})})}),gwe="SelectSeparator",EB=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return h.jsx(Pe.div,{"aria-hidden":!0,...r,ref:t})});EB.displayName=gwe;var lS="SelectArrow",vwe=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=ky(n),o=Ai(lS,n),i=Pi(lS,n);return o.open&&i.position==="popper"?h.jsx(Db,{...a,...r,ref:t}):null});vwe.displayName=lS;function SB(e){return e===""||e===void 0}var OB=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=g.useRef(null),o=jt(t,a),i=eB(n);return g.useEffect(()=>{const s=a.current,c=window.HTMLSelectElement.prototype,l=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==n&&l){const u=new Event("change",{bubbles:!0});l.call(s,n),s.dispatchEvent(u)}},[i,n]),h.jsx(a3e,{asChild:!0,children:h.jsx("select",{...r,ref:o,defaultValue:n})})});OB.displayName="BubbleSelect";function CB(e){const t=fr(e),n=g.useRef(""),r=g.useRef(0),a=g.useCallback(i=>{const s=n.current+i;t(s),function c(l){n.current=l,window.clearTimeout(r.current),l!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(s)},[t]),o=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,o]}function NB(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=bwe(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.textValue.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function bwe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var wwe=tB,kB=rB,xwe=oB,_we=iB,jwe=sB,MB=cB,Ewe=pB,AB=mB,PB=gB,Swe=vB,Owe=wB,TB=xB,IB=_B,RB=EB;const Qa=wwe,eo=xwe,Ea=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(kB,{ref:r,className:Z("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,h.jsx(_we,{asChild:!0,children:h.jsx(pe,{name:"chevron-down",className:"h-4 w-4 opacity-50"})})]}));Ea.displayName=kB.displayName;const DB=g.forwardRef(({className:e,...t},n)=>h.jsx(TB,{ref:n,className:Z("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(pe,{name:"chevron-up",className:"h-4 w-4"})}));DB.displayName=TB.displayName;const LB=g.forwardRef(({className:e,...t},n)=>h.jsx(IB,{ref:n,className:Z("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(pe,{name:"chevron-down",className:"h-4 w-4"})}));LB.displayName=IB.displayName;const Sa=g.forwardRef(({className:e,children:t,position:n="popper",...r},a)=>h.jsx(jwe,{children:h.jsxs(MB,{ref:a,className:Z("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[h.jsx(DB,{}),h.jsx(Ewe,{className:Z("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),h.jsx(LB,{})]})}));Sa.displayName=MB.displayName;const Cwe=g.forwardRef(({className:e,...t},n)=>h.jsx(AB,{ref:n,className:Z("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Cwe.displayName=AB.displayName;const Bn=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(PB,{ref:r,className:Z("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(Owe,{children:h.jsx(pe,{name:"check",className:"h-4 w-4"})})}),h.jsx(Swe,{children:t})]}));Bn.displayName=PB.displayName;const Nwe=g.forwardRef(({className:e,...t},n)=>h.jsx(RB,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));Nwe.displayName=RB.displayName;var zo="Accordion",kwe=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[uS,Mwe,Awe]=yf(zo),[Ay,N3e]=pr(zo,[Awe,WA]),dS=WA(),$B=q.forwardRef((e,t)=>{const{type:n,...r}=e,a=r,o=r;return h.jsx(uS.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?h.jsx(Rwe,{...o,ref:t}):h.jsx(Iwe,{...a,ref:t})})});$B.displayName=zo;var[FB,Pwe]=Ay(zo),[BB,Twe]=Ay(zo,{collapsible:!1}),Iwe=q.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:o=!1,...i}=e,[s,c]=In({prop:n,defaultProp:r,onChange:a});return h.jsx(FB,{scope:e.__scopeAccordion,value:s?[s]:[],onItemOpen:c,onItemClose:q.useCallback(()=>o&&c(""),[o,c]),children:h.jsx(BB,{scope:e.__scopeAccordion,collapsible:o,children:h.jsx(zB,{...i,ref:t})})})}),Rwe=q.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=In({prop:n,defaultProp:r,onChange:a}),c=q.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=q.useCallback(u=>s((d=[])=>d.filter(p=>p!==u)),[s]);return h.jsx(FB,{scope:e.__scopeAccordion,value:i,onItemOpen:c,onItemClose:l,children:h.jsx(BB,{scope:e.__scopeAccordion,collapsible:!0,children:h.jsx(zB,{...o,ref:t})})})}),[Dwe,Py]=Ay(zo),zB=q.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:o="vertical",...i}=e,s=q.useRef(null),c=jt(s,t),l=Mwe(n),u=oi(a)==="ltr",d=ge(e.onKeyDown,p=>{var S;if(!kwe.includes(p.key))return;const f=p.target,m=l().filter(O=>{var N;return!((N=O.ref.current)!=null&&N.disabled)}),y=m.findIndex(O=>O.ref.current===f),v=m.length;if(y===-1)return;p.preventDefault();let b=y;const w=0,_=v-1,x=()=>{b=y+1,b>_&&(b=w)},j=()=>{b=y-1,b<w&&(b=_)};switch(p.key){case"Home":b=w;break;case"End":b=_;break;case"ArrowRight":o==="horizontal"&&(u?x():j());break;case"ArrowDown":o==="vertical"&&x();break;case"ArrowLeft":o==="horizontal"&&(u?j():x());break;case"ArrowUp":o==="vertical"&&j();break}const E=b%v;(S=m[E].ref.current)==null||S.focus()});return h.jsx(Dwe,{scope:n,disabled:r,direction:a,orientation:o,children:h.jsx(uS.Slot,{scope:n,children:h.jsx(Pe.div,{...i,"data-orientation":o,ref:c,onKeyDown:r?void 0:d})})})}),Ty="AccordionItem",[Lwe,pS]=Ay(Ty),UB=q.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...a}=e,o=Py(Ty,n),i=Pwe(Ty,n),s=dS(n),c=Rt(),l=r&&i.value.includes(r)||!1,u=o.disabled||e.disabled;return h.jsx(Lwe,{scope:n,open:l,disabled:u,triggerId:c,children:h.jsx(KA,{"data-orientation":o.orientation,"data-state":ZB(l),...s,...a,ref:t,disabled:u,open:l,onOpenChange:d=>{d?i.onItemOpen(r):i.onItemClose(r)}})})});UB.displayName=Ty;var VB="AccordionHeader",WB=q.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Py(zo,n),o=pS(VB,n);return h.jsx(Pe.h3,{"data-orientation":a.orientation,"data-state":ZB(o.open),"data-disabled":o.disabled?"":void 0,...r,ref:t})});WB.displayName=VB;var fS="AccordionTrigger",HB=q.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Py(zo,n),o=pS(fS,n),i=Twe(fS,n),s=dS(n);return h.jsx(uS.ItemSlot,{scope:n,children:h.jsx(NY,{"aria-disabled":o.open&&!i.collapsible||void 0,"data-orientation":a.orientation,id:o.triggerId,...s,...r,ref:t})})});HB.displayName=fS;var qB="AccordionContent",KB=q.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Py(zo,n),o=pS(qB,n),i=dS(n);return h.jsx(kY,{role:"region","aria-labelledby":o.triggerId,"data-orientation":a.orientation,...i,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});KB.displayName=qB;function ZB(e){return e?"open":"closed"}let GB;NM=$B,kM=UB,GB=WB,S0=HB,O0=KB;const XB=NM,hS=g.forwardRef(({className:e,...t},n)=>h.jsx(kM,{ref:n,className:Z("border-b",e),...t}));hS.displayName="AccordionItem";const mS=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(GB,{className:"flex",children:h.jsxs(S0,{ref:r,className:Z("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,h.jsx(pe,{name:"chevron-down",className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));mS.displayName=S0.displayName;const yS=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(O0,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:h.jsx("div",{className:Z("pb-4 pt-0",e),children:t})}));yS.displayName=O0.displayName;const $we=[1,2,3,4,5,6,7,8,9,10],JB=g.memo(e=>{const{t}=Me("flows"),[n,r]=g.useState(""),[a,o]=g.useState([]),[i,s]=g.useState("1"),{loading:c,onSimilaritySearch:l,onCreatePrompt:u,onCreateRetriever:d}=e,p=async()=>{o(await l(n,+i)),r("")},f=async m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),p())};return h.jsxs("div",{className:"mt-4 max-w-full",children:[h.jsx("div",{className:"bg-black/5 dark:bg-white/5 rounded-xl relative",children:h.jsxs("div",{className:"relative px-2 py-1 pb-2",children:[h.jsxs(Qa,{value:`${i}`,onValueChange:m=>s(m),children:[h.jsx(Ea,{className:"absolute left-0 !w-14 top-[2px] rounded-xl bg-transparent border-none focus:outline-none focus:ring-0 focus:border-opacity-0 focus:ring-transparent",children:h.jsx(eo,{placeholder:t("vector_database_node.k_select_placeholder")})}),h.jsx(Sa,{children:$we.map(m=>h.jsx(Bn,{value:`${m}`,children:m},`${m}`))})]}),h.jsx(ko,{value:n,disabled:c,placeholder:t("vector_database_node.similarity_search_placeholder"),className:Z("w-full rounded-xl px-2 pl-11 border-none resize-none bg-transparent","min-h-8 max-h-8"),onKeyDown:f,onChange:m=>{r(m.target.value)}}),h.jsx("button",{type:"button",disabled:c,onClick:p,className:"absolute right-3 top-5 -translate-y-1/2 rounded-xl bg-black/5 dark:bg-white/5 p-1",children:h.jsx(pe,{name:c?"loader-circle":"arrow-right",className:Z("w-4 h-4 dark:text-white",n?"opacity-100":"opacity-30",c?"animate-spin":"")})})]})}),h.jsx(XB,{type:"single",collapsible:!0,children:a==null?void 0:a.map(([m,y],v)=>h.jsxs(hS,{value:`${v}`,children:[h.jsxs(mS,{children:[`[${y.toFixed(2)}] ${m.pageContent}`.substring(0,32),"..."]}),h.jsx(yS,{children:m.pageContent})]},`${v}`))}),h.jsxs("div",{className:"w-full mt-4 flex flex-col gap-1",children:[d?h.jsx(Ye,{disabled:c,onClick:d,className:"w-full",children:t("vector_database_node.to_retriever")}):void 0,a!=null&&a.length&&u?h.jsx(Ye,{disabled:c,onClick:()=>u(a),className:"w-full",children:t("vector_database_node.create_prompt")}):void 0]})]})}),YB=g.memo(({loading:e,onCreateData:t})=>{const{t:n}=Me("flows"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=async()=>{o&&(await t({id:r,content:o}),a(""),i(""))};return h.jsxs("div",{className:"min-w-80",children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(Be,{htmlFor:"name",children:n("vector_database_node.add_text.id")}),h.jsx(Kt,{value:r,disabled:e,onChange:c=>a(c.target.value||""),placeholder:n("vector_database_node.add_text.id_placeholder"),className:"mb-4"}),h.jsxs(Be,{htmlFor:"name",children:[n("vector_database_node.add_text.content")," ",h.jsx("span",{className:"text-red-600",children:"*"})]}),h.jsx(ko,{value:o,disabled:e,onChange:c=>i(c.target.value||""),placeholder:n("vector_database_node.add_text.content_placeholder")})]}),h.jsx("div",{className:"flex justify-between mt-6",children:h.jsx(Qn,{loading:e,disabled:!(o!=null&&o.length),onClick:s,className:"w-full",children:n("vector_database_node.add_text.add")})})]})}),gS=({className:e,size:t=200,duration:n=15,anchor:r=90,borderWidth:a=1.5,colorFrom:o="#ffaa40",colorTo:i="#9c40ff",delay:s=0})=>h.jsx("div",{style:{"--size":t,"--duration":n,"--anchor":r,"--border-width":a,"--color-from":o,"--color-to":i,"--delay":`-${s}s`},className:Z("pointer-events-none absolute inset-0 rounded-[inherit] [border:calc(var(--border-width)*1px)_solid_transparent]","![mask-clip:padding-box,border-box] ![mask-composite:intersect] [mask:linear-gradient(transparent,transparent),linear-gradient(white,white)]","after:absolute after:aspect-square after:w-[calc(var(--size)*1px)] after:animate-border-beam after:[animation-delay:var(--delay)] after:[background:linear-gradient(to_left,var(--color-from),var(--color-to),transparent)] after:[offset-anchor:calc(var(--anchor)*1%)_50%] after:[offset-path:rect(0_auto_auto_0_round_calc(var(--size)*1px))]",e)});function Fwe({accept:e,maxSize:t}){const{t:n}=Me("atoms"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=g.useRef(null),[c,l]=g.useState(0),u=p=>{var m;const f=(m=p.target.files)==null?void 0:m[0];d(f)},d=p=>{if(i(""),p){if(t&&p.size>t*1024*1024){i(n("file_upload_input.errors.max_size",{maxSize:t,fileSize:(p.size/1024/1024).toFixed(2)}));return}const f=e==null?void 0:e.split(",").map(m=>m.replace(".","").trim());if(e&&!p.type.match(e.replace("/*",""))&&!(f!=null&&f.some(m=>p.type.includes(m)))){i(n("file_upload_input.errors.accept",{accept:e}));return}return l(p.size),a(p.name),p}};return{fileName:r,error:o,fileInputRef:s,handleFileSelect:u,validateAndSetFile:d,clearFile:()=>{a(""),i(""),l(0),s.current&&(s.current.value="")},fileSize:c}}function Bwe({file:e,setFile:t,loading:n,progress:r,fileOptions:a}){const{toast:o}=nn(),{t:i}=Me("atoms"),[s,c]=g.useState(!1),{fileName:l,fileInputRef:u,clearFile:d,error:p,validateAndSetFile:f,fileSize:m}=Fwe({accept:(a==null?void 0:a.accept)||"image/*",maxSize:(a==null?void 0:a.maxSize)||3});g.useEffect(()=>{e||d()},[d,e]),g.useEffect(()=>{p&&o({title:p,variant:"destructive"})},[p,o]);function y(x){const j=f(x);j&&t(j)}function v(x){x.preventDefault(),c(!1);const j=x.dataTransfer.files[0];j&&y(j)}function b(x){var E;const j=(E=x.target.files)==null?void 0:E[0];j&&y(j)}function w(){d(),t(void 0)}const _=g.useMemo(()=>{if(!e)return h.jsx("div",{className:"w-16 h-16 rounded-lg bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center",children:h.jsx(pe,{name:"file-text",className:"w-8 h-8 text-zinc-400"})});const x=e.type.startsWith("image/");return h.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:x?h.jsx("img",{src:URL.createObjectURL(e),alt:"Preview",className:"w-full h-full object-cover"}):h.jsx(pe,{className:"w-14 h-14",name:"file-text"})})},[e]);return h.jsx(h.Fragment,{children:h.jsxs("div",{className:Z("relative group cursor-pointer","rounded-lg border-2 border-dashed","transition-colors duration-200",s?"border-indigo-500 bg-indigo-50/50 dark:bg-indigo-500/10":"border-zinc-200 dark:border-zinc-800"),onDragOver:x=>{x.preventDefault(),c(!0)},onDragLeave:()=>c(!1),onDrop:v,onClick:()=>{var x;return(x=u.current)==null?void 0:x.click()},onKeyDown:x=>{var j;(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),(j=u.current)==null||j.click())},"aria-label":"Upload file",children:[h.jsx("input",{ref:u,type:"file",disabled:n||!!(r&&r<1),accept:(a==null?void 0:a.accept)||"image/*",onChange:b,className:"hidden"}),h.jsx("div",{className:"p-8 space-y-4",children:l?h.jsxs("div",{className:"flex items-center gap-4",children:[_,h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("p",{className:"text-sm font-medium truncate",children:[l||"No file selected"," ",h.jsx("span",{className:"text-xs text-zinc-500 leading-5",children:m?`(${(m/1024/1024).toFixed(2)} MB)`:""})]}),r&&r<1?h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsxs("p",{children:[(r*100).toFixed(2)," %"]}),h.jsx("div",{className:"h-1 flex-1 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden items-center flex",children:h.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-200",style:{width:`${r*100}%`}})})]}):void 0]}),h.jsx("button",{type:"button",disabled:n||!!(r&&r<1),onClick:x=>{x.stopPropagation(),w()},className:"p-1 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded",children:h.jsx(pe,{name:"x",className:"w-5 h-5 text-zinc-400"})}),r&&r<1?h.jsx(gS,{className:"rounded-lg"}):void 0]}):h.jsxs("div",{className:"flex flex-col items-center gap-2",children:[h.jsx(pe,{name:"upload",className:"w-8 h-8 text-zinc-400 dark:text-zinc-500"}),h.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:i("file_upload_input.drop_file")})]})})]})})}const zwe=uo("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Er=g.forwardRef(({className:e,variant:t,...n},r)=>h.jsx("div",{ref:r,role:"alert",className:Z(zwe({variant:t}),e),...n}));Er.displayName="Alert";const Uo=g.forwardRef(({className:e,...t},n)=>h.jsx("h5",{ref:n,className:Z("mb-1 font-medium leading-none tracking-tight",e),...t}));Uo.displayName="AlertTitle";const cl=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("text-sm [&_p]:leading-relaxed",e),...t}));cl.displayName="AlertDescription";function QB({onFileSubmit:e,fileOptions:t,progress:n,loading:r}){const{t:a}=Me("flows"),[o,i]=g.useState(),s=async()=>{o&&(await e(o),i(void 0))};return h.jsxs("div",{className:"w-full max-w-full space-y-2 mt-4",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx(Bwe,{progress:n,loading:r,fileOptions:t,setFile:i,file:o}),h.jsx(Er,{variant:"default",className:"mt-2 border-none max-w-96",children:a("vector_database_node.add_file.alert_file_size")})]}),h.jsx(Qn,{loading:r,disabled:!o,onClick:s,className:"w-full mt-4",children:a("vector_database_node.add_file.index")})]})}const Iy=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{className:"relative w-full overflow-auto",children:h.jsx("table",{ref:n,className:Z("w-full caption-bottom text-sm",e),...t})}));Iy.displayName="Table";const Ry=g.forwardRef(({className:e,...t},n)=>h.jsx("thead",{ref:n,className:Z("[&_tr]:border-b",e),...t}));Ry.displayName="TableHeader";const Dy=g.forwardRef(({className:e,...t},n)=>h.jsx("tbody",{ref:n,className:Z("[&_tr:last-child]:border-0",e),...t}));Dy.displayName="TableBody";const Uwe=g.forwardRef(({className:e,...t},n)=>h.jsx("tfoot",{ref:n,className:Z("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Uwe.displayName="TableFooter";const js=g.forwardRef(({className:e,...t},n)=>h.jsx("tr",{ref:n,className:Z("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));js.displayName="TableRow";const ll=g.forwardRef(({className:e,...t},n)=>h.jsx("th",{ref:n,className:Z("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));ll.displayName="TableHead";const ul=g.forwardRef(({className:e,...t},n)=>h.jsx("td",{ref:n,className:Z("align-middle [&:has([role=checkbox])]:pr-0",e),...t}));ul.displayName="TableCell";const Vwe=g.forwardRef(({className:e,...t},n)=>h.jsx("caption",{ref:n,className:Z("mt-4 text-sm text-muted-foreground",e),...t}));Vwe.displayName="TableCaption";const ez=({className:e,...t})=>h.jsx("nav",{role:"navigation","aria-label":"pagination",className:Z("mx-auto flex w-full justify-center",e),...t});ez.displayName="Pagination";const tz=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,className:Z("flex flex-row items-center gap-1",e),...t}));tz.displayName="PaginationContent";const dl=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,className:Z("",e),...t}));dl.displayName="PaginationItem";const Ly=({className:e,isActive:t,size:n="icon",...r})=>h.jsx("a",{"aria-current":t?"page":void 0,className:Z(Ou({variant:t?"outline":"ghost",size:n}),e),...r});Ly.displayName="PaginationLink";const nz=({className:e,...t})=>{const{t:n}=Me("atoms");return h.jsxs(Ly,{"aria-label":"Go to previous page",size:"default",className:Z("gap-1 pl-2.5",e),...t,children:[h.jsx(pe,{name:"chevron-left",className:"h-4 w-4"}),h.jsx("span",{children:n("pagination.previous")})]})};nz.displayName="PaginationPrevious";const rz=({className:e,...t})=>{const{t:n}=Me("atoms");return h.jsxs(Ly,{"aria-label":"Go to next page",size:"default",className:Z("gap-1 pr-2.5",e),...t,children:[h.jsx("span",{children:n("pagination.next")}),h.jsx(pe,{name:"chevron-right",className:"h-4 w-4"})]})};rz.displayName="PaginationNext";const vS=({className:e,...t})=>{const{t:n}=Me("atoms");return h.jsxs("span",{"aria-hidden":!0,className:Z("flex h-9 w-9 items-center justify-center",e),...t,children:[h.jsx(pe,{name:"ellipsis",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:n("pagination.more_pages")})]})};vS.displayName="PaginationEllipsis";const az=po(({title:e,content:t})=>{const n=tn();return h.jsx(hi,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(xo,{className:"sm:max-w-2xl",children:[h.jsx(_o,{children:h.jsxs("div",{className:"flex",children:[h.jsx(pe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(jo,{children:e})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-96 overflow-hidden",children:h.jsx("div",{className:"relative w-full h-full overflow-hidden rounded-xl p-1 border border-border",children:h.jsx("pre",{className:"break-all h-full overflow-y-auto bg-background font-mono text-xs w-full",children:t})})})]})})}),$y=g.memo(e=>{const{data:t,headers:n,limitLengthByColumns:r,showPerPage:a=7,paginationShowLimit:o=1,contentLengthLimit:i=64}=e,[s,c]=g.useState({page:1,maxPage:1}),l=tn(az);g.useEffect(()=>{c(f=>({...f,maxPage:Math.ceil(t.length/a)}))},[t.length,a]);const u=g.useMemo(()=>t.slice((s.page-1)*a,s.page*a),[t,s.page,a]),d=g.useMemo(()=>{let f=!1,m=!1;return h.jsx(ez,{className:"mt-4 mb-4 ml-4 mr-4 w-full",children:h.jsxs(tz,{children:[s.page>1?h.jsx(dl,{onClick:()=>c(y=>({...y,page:y.page-1})),children:h.jsx(nz,{})}):null,Array.from({length:s.maxPage},(y,v)=>{const b=v+1,w=v===0||v===s.maxPage-1;return!w&&b>s.page+o&&m?null:!w&&b>s.page+o?(m=!0,h.jsx(dl,{children:h.jsx(vS,{})},v)):!w&&b<s.page-o&&f?null:!w&&b<s.page-o?(f=!0,h.jsx(dl,{children:h.jsx(vS,{})},v)):h.jsx(dl,{onClick:()=>c(_=>({..._,page:b})),children:h.jsx(Ly,{isActive:v+1===s.page,children:v+1})},v)}),s.page<s.maxPage?h.jsx(dl,{onClick:()=>c(y=>({...y,page:y.page+1})),children:h.jsx(rz,{})}):null]})})},[s.maxPage,s.page,o]),p=(f,m)=>{if(!f)return;const y=Array.isArray(f)?f:n.map(v=>f[v]);return h.jsxs(js,{children:[h.jsx(ul,{children:h.jsx("div",{className:"font-bold",children:m+1})}),y.map((v,b)=>{const w=typeof v=="string"?v:JSON.stringify(v),_=n[b],x=(r==null?void 0:r[_])||i,j=w.length>x;return h.jsx(ul,{className:"p-4",children:h.jsxs("div",{onClick:j?()=>l.show({title:_,content:w}):void 0,className:"flex gap-4",children:[j?`${w.substring(0,x)}...`:w,j?h.jsx(pe,{className:"w-6 mt-[-2px]",name:"chevron-right"}):null]})},`${b}`)})]},`${m}`)};return h.jsxs(h.Fragment,{children:[h.jsxs(Iy,{className:"w-full",children:[h.jsx(Ry,{children:h.jsxs(js,{children:[h.jsx(ll,{},"index"),n?n.map(f=>h.jsx(ll,{children:h.jsx("div",{className:"font-bold",children:f})},f)):void 0]})}),h.jsx(Dy,{children:u!=null&&u.length?u==null?void 0:u.map(p):void 0})]}),d]})});var bS,oz;R0=function(){if(oz)return bS;oz=1;function e(t,n,r){var a=-1,o=t.length;n<0&&(n=-n>o?0:o+n),r=r>o?o:r,r<0&&(r+=o),o=n>r?0:r-n>>>0,n>>>=0;for(var i=Array(o);++a<o;)i[a]=t[a+n];return i}return bS=e,bS};var wS,iz;qs=function(){if(iz)return wS;iz=1;var e=su(),t=Ki(),n=Dh(),r=qr();function a(o,i,s){if(!r(s))return!1;var c=typeof i;return(c=="number"?t(s)&&n(i,s.length):c=="string"&&i in s)?e(s[i],o):!1}return wS=a,wS};var xS,sz;function Wwe(){if(sz)return xS;sz=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return xS=t,xS}var _S,cz;function Hwe(){if(cz)return _S;cz=1;var e=Wwe(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return _S=n,_S}var jS,lz;function uz(){if(lz)return jS;lz=1;var e=Hwe(),t=qr(),n=gc(),r=NaN,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=o.test(l);return d||i.test(l)?s(l.slice(2),d?2:8):a.test(l)?r:+l}return jS=c,jS}var ES,dz;function pz(){if(dz)return ES;dz=1;var e=uz(),t=1/0,n=17976931348623157e292;function r(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var o=a<0?-1:1;return o*n}return a===a?a:0}return ES=r,ES}var SS,fz;function hz(){if(fz)return SS;fz=1;var e=pz();function t(n){var r=e(n),a=r%1;return r===r?a?r-a:r:0}return SS=t,SS}var OS,mz;function qwe(){if(mz)return OS;mz=1;var e=R0(),t=qs(),n=hz(),r=Math.ceil,a=Math.max;function o(i,s,c){(c?t(i,s,c):s===void 0)?s=1:s=a(n(s),0);var l=i==null?0:i.length;if(!l||s<1)return[];for(var u=0,d=0,p=Array(r(l/s));u<l;)p[d++]=e(i,u,u+=s);return p}return OS=o,OS}var Kwe=qwe();const CS=ct(Kwe),Zwe=e=>{const[t,n]=g.useState(!1),{t:r}=Me("flows"),{toast:a}=nn(),{index:o,similaritySearchWithScore:i}=ap(),s=g.useCallback(async(l,u)=>{try{if(!(u!=null&&u.vectorDatabase)){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if((u==null?void 0:u.vectorDatabase.storage)===Wr.DataNode)throw new Error("DataNode storage is not supported for similarity search");return n(!0),await i(e==null?void 0:e.embedding,{database:{databaseId:u.vectorDatabase.id}},l,u==null?void 0:u.k)}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[a,r,i,e==null?void 0:e.embedding]),c=g.useCallback(async(l,u)=>{var d;try{n(!0);const p=l.content?[new bf({pageContent:l.content,id:l.id,metadata:{id:l.id}})]:l.documents;if(!(p!=null&&p.length)){a({variant:"destructive",title:r("vector_database_node.errors.content_not_found")});return}if(!(u!=null&&u.vectorDatabase)){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if((u==null?void 0:u.vectorDatabase.storage)===Wr.DataNode)throw new Error("DataNode storage is not supported for indexing");{const f=CS(p,10);let m=0;for(const y of f)(d=u==null?void 0:u.onProgressReport)==null||d.call(u,{handling:y.length,handled:m,total:p.length}),await o(e==null?void 0:e.embedding,{database:{databaseId:u.vectorDatabase.id}},y),m+=y.length}}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[a,r,o,e==null?void 0:e.embedding]);return{loading:t,indexData:c,similaritySearchWithScore:s}},Gwe=po(({retriverInfo:e,mainEmbeddingInfo:t})=>{var v,b,w;const{t:n}=Me("applications"),{loading:r,similaritySearchWithScore:a,indexData:o}=Zwe(t),[i,s]=g.useState("search"),[c,l]=g.useState(0),u=tn(),d=g.useMemo(()=>{var j,E;if(!((j=e==null?void 0:e.vectorDatabaseEntity)!=null&&j.raw))return{headers:[],rows:[]};const _=["content","embedding","metadata"],x=Tv((E=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:E.raw);return{headers:_,rows:x.map(S=>{try{return JSON.parse(S)}catch{return[]}})}},[(v=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:v.raw]),p=g.useCallback(async(..._)=>{const[x,j]=_;await o(x,{...j,vectorDatabase:e.vectorDatabaseEntity})},[o,e.vectorDatabaseEntity]),f=g.useCallback(async(_,x)=>{const j=_.trim(),E=await a(j,{k:x,vectorDatabase:e.vectorDatabaseEntity});if(E!=null&&E.length)return E},[e.vectorDatabaseEntity,a]),m=g.useCallback(async _=>{if(_.type.includes("text")||_.type.includes("txt")){const x=new FileReader;x.onload=async j=>{var S;const E=(S=j.target)==null?void 0:S.result;await p({content:E},{vectorDatabase:e.vectorDatabaseEntity})},x.readAsText(_)}else if(_.type.endsWith("pdf")){const x=new Blob([_],{type:"application/pdf"}),j=await new B9(x,{pdfjs:async()=>{const E=await qt(()=>import("./pdf.min-l1GqQ9Q_.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([11,1,2,3,4]));return await qt(()=>import("./pdf.worker.min-BdOueeY8.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([12,1,2,3,4])),E.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),E},parsedItemSeparator:" "}).load();await p({documents:j},{vectorDatabase:e.vectorDatabaseEntity,onProgressReport:E=>{l((E.handled+E.handling)/E.total)}})}},[p,e.vectorDatabaseEntity]),y=g.useMemo(()=>{switch(i){case"search":return h.jsx(_a,{value:"search",children:h.jsx(JB,{loading:r,onSimilaritySearch:f})});case"new":return h.jsx(_a,{className:"min-w-80",value:"new",children:h.jsx(YB,{loading:r,onCreateData:p})});case"file":return h.jsx(_a,{value:"file",children:h.jsx(QB,{loading:r,progress:c,onFileSubmit:m,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(_a,{value:"view",className:"max-h-full overflow-auto",children:h.jsx($y,{data:d.rows,headers:d.headers,limitLengthByColumns:{embedding:32}})})}},[p,m,f,r,i,c,d]);return h.jsx(hi,{open:u.visible,onOpenChange:u.hide,children:h.jsxs(xo,{className:"max-w-3xl",children:[h.jsx(_o,{children:h.jsxs("div",{className:"flex",children:[h.jsx(pe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(jo,{children:n("chat.vector_database")})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-full overflow-hidden",children:h.jsx("div",{className:"w-full h-full",children:h.jsxs(rS,{value:i,onValueChange:s,defaultValue:"search",className:Z("w-full h-full mt-4"),children:[h.jsxs(Oy,{className:Z("grid w-full grid-cols-3",((b=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:b.storage)===Wr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(xa,{value:"search",children:n("chat.search")}),h.jsx(xa,{value:"new",children:n("chat.text")}),h.jsx(xa,{value:"file",children:n("chat.file")}),((w=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:w.storage)===Wr.DatabaseNode?h.jsx(xa,{value:"view",children:n("chat.view")}):void 0]}),y]})})})]})})}),Xwe=e=>{const[t,n]=g.useState([]),r=Je(i=>i.currentSession),a=g.useCallback(async()=>{if(!e||!(r!=null&&r.id))return;const i=await le("FlowEdge").find({where:{session_id:r.id,source:e.id},order:{id:"DESC"}}),{flowNodes:s,flowNodeDatas:c}=await Om({where:{session_id:r.id,id:Ka(i.map(l=>l.target)),source_type:"JSONData"},order:{updated_at:"DESC"},select:["id","source_id","source_type","updated_at"]});n(s.reduce((l,u)=>{var p;const d=(p=c[u.source_type])==null?void 0:p.find(f=>f.id===u.source_id);return d&&l.push({node:u,entity:d}),l},[]))},[r==null?void 0:r.id,e]),o=g.useCallback(async i=>{await le("FlowNode").delete(i.id),await le("JSONData").delete(i.source_id);const s=await le("FlowEdge").find({where:[{source:i.id},{target:i.id}]});await Promise.all(s.map(c=>le("FlowEdge").delete(c.id))),a()},[a]);return g.useEffect(()=>{e&&a()},[a,e]),{chatList:t,deleteChat:o,getChatList:a}};function Jwe({schema:e,mainLLMInfo:t,mainEmbeddingInfo:n,loadLLM:r,retriverInfo:a,threadNode:o,onSelectThread:i,onAddNewThread:s,currentDataNode:c,setLLMInfo:l,changeLLMOptions:u,...d}){var N,M;const{t:p}=Me("applications"),[f,m]=g.useState(!1),y=tn(p0e),v=tn(Gwe),{chatList:b,getChatList:w,deleteChat:_}=Xwe(o),x=g.useCallback(async()=>{try{m(!0),await(s==null?void 0:s()),w()}finally{m(!1)}},[w,s]),j=g.useCallback(()=>{v.show({retriverInfo:a[0],mainEmbeddingInfo:n})},[n,a,v]),E=g.useCallback(async(k,A)=>{k.stopPropagation(),y.show({onDelete:()=>_(A)})},[_,y]),S=g.useCallback(async k=>{t!=null&&t.llm&&(await u(t==null?void 0:t.llm,k),l(A=>A?{...A,llm:{...A.llm,options:k}}:void 0))},[u,t==null?void 0:t.llm,l]),O=g.useMemo(()=>{var k;return h.jsx(LE,{className:Z("overflow-hidden break-words whitespace-pre-wrap w-full rounded-lg"),source:(k=e==null?void 0:e.schema_items)!=null&&k.length?`\`\`\`javascript
${KF((e==null?void 0:e.schema_items)||[])}
\`\`\``:""})},[e==null?void 0:e.schema_items]);return h.jsxs(Ub,{variant:"sidebar",side:"right",collapsible:"none",...d,children:[h.jsx("div",{className:"h-1"}),h.jsxs(Du,{className:"justify-between",children:[h.jsx("div",{className:"text-sm pl-2",children:p("chat.history")}),h.jsx(Qn,{loading:f,onClick:x,variant:"link",className:"mr-[-6px]",children:h.jsx(pe,{name:"circle-plus"})})]}),h.jsxs(Wb,{children:[h.jsx(Ru,{className:"flex-1",children:h.jsx(uc,{children:b.map(({node:k},A)=>{var P;return h.jsx(bo,{onClick:()=>i(k),children:h.jsx(wo,{className:"cursor-pointer",children:h.jsxs("div",{className:"flex flex-row justify-between items-center w-full",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx(pe,{size:16,name:((P=c==null?void 0:c.node)==null?void 0:P.id)===k.id?"check":"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"}),h.jsx("span",{children:`Thread ${A+1}`})]}),h.jsx(pe,{onClick:C=>E(C,k),size:16,name:"trash-2"})]})})},k.id)})})}),a!=null&&a.length?h.jsxs(Gt,{className:"m-2 p-2 max-w-full",children:[h.jsx("pre",{className:"overflow-auto",children:a.map((k,A)=>{var P;return h.jsx("span",{children:((P=k.promptEntity)==null?void 0:P.content)||""},`${A}`)})}),h.jsx(Ye,{onClick:j,className:"w-full mt-4",children:p("chat.vector_database")})]}):void 0,(N=e==null?void 0:e.schema_items)!=null&&N.length?h.jsx("div",{className:"m-2 !mb-0",children:h.jsx(g.Suspense,{fallback:h.jsx(by,{}),children:O})}):void 0,h.jsx(F9,{options:(M=t==null?void 0:t.llm)==null?void 0:M.options,onChangeOptions:S,className:"p-2"}),h.jsx(Gbe,{llm:t==null?void 0:t.llm,status:t==null?void 0:t.status,progress:t==null?void 0:t.progress,loadLLM:r})]})]})}var NS="Avatar",[Ywe,k3e]=pr(NS),[Qwe,yz]=Ywe(NS),gz=g.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,o]=g.useState("idle");return h.jsx(Qwe,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:h.jsx(Pe.span,{...r,ref:t})})});gz.displayName=NS;var vz="AvatarImage",bz=g.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...o}=e,i=yz(vz,n),s=exe(r,o.referrerPolicy),c=fr(l=>{a(l),i.onImageLoadingStatusChange(l)});return ln(()=>{s!=="idle"&&c(s)},[s,c]),s==="loaded"?h.jsx(Pe.img,{...o,ref:t,src:r}):null});bz.displayName=vz;var wz="AvatarFallback",xz=g.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,o=yz(wz,n),[i,s]=g.useState(r===void 0);return g.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(c)}},[r]),i&&o.imageLoadingStatus!=="loaded"?h.jsx(Pe.span,{...a,ref:t}):null});xz.displayName=wz;function exe(e,t){const[n,r]=g.useState("idle");return ln(()=>{if(!e){r("error");return}let a=!0;const o=new window.Image,i=s=>()=>{a&&r(s)};return r("loading"),o.onload=i("loaded"),o.onerror=i("error"),o.src=e,t&&(o.referrerPolicy=t),()=>{a=!1}},[e,t]),n}var _z=gz,jz=bz,Ez=xz;const Sz=g.forwardRef(({className:e,...t},n)=>h.jsx(_z,{ref:n,className:Z("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));Sz.displayName=_z.displayName;const Oz=g.forwardRef(({className:e,...t},n)=>h.jsx(jz,{ref:n,className:Z("aspect-square h-full w-full",e),...t}));Oz.displayName=jz.displayName;const Cz=g.forwardRef(({className:e,...t},n)=>h.jsx(Ez,{ref:n,className:Z("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));Cz.displayName=Ez.displayName;const txe=uo("flex gap-2 max-w-[60%] items-end relative group",{variants:{variant:{received:"self-start",sent:"self-end flex-row-reverse"},layout:{default:"",ai:"max-w-full w-full items-center"}},defaultVariants:{variant:"received",layout:"default"}}),Nz=g.forwardRef(({className:e,variant:t,layout:n,children:r,...a},o)=>h.jsx("div",{className:Z(txe({variant:t,layout:n,className:e}),"relative group"),ref:o,...a,children:g.Children.map(r,i=>g.isValidElement(i)&&typeof i.type!="string"?g.cloneElement(i,{variant:t,layout:n,className:a==null?void 0:a.innerclassname}):i)}));Nz.displayName="ChatBubble";const nxe=({src:e,fallback:t,className:n})=>h.jsxs(Sz,{className:n,children:[h.jsx(Oz,{src:e,alt:"Avatar"}),h.jsx(Cz,{children:t})]}),rxe=uo("p-4",{variants:{variant:{received:"bg-secondary text-secondary-foreground rounded-r-lg rounded-tl-lg",sent:"border border-border rounded-l-lg rounded-tr-lg"},layout:{default:"",ai:"border-t w-full rounded-none bg-transparent"}},defaultVariants:{variant:"received",layout:"default"}}),kz=g.forwardRef(({className:e,variant:t,layout:n,isLoading:r=!1,children:a,...o},i)=>h.jsx("div",{className:Z(rxe({variant:t,layout:n,className:e}),"break-words max-w-full whitespace-pre-wrap"),ref:i,...o,children:r?h.jsx("div",{className:"flex items-center space-x-2",children:h.jsx(by,{})}):a}));kz.displayName="ChatBubbleMessage";const axe=({icon:e,onClick:t,className:n,variant:r="ghost",size:a="icon",...o})=>h.jsx(Ye,{variant:r,size:a,className:n,onClick:t,...o,children:e}),oxe=g.forwardRef(({variant:e,className:t,children:n,...r},a)=>h.jsx("div",{ref:a,className:Z("absolute top-1/2 -translate-y-1/2 flex opacity-0 group-hover:opacity-100 transition-opacity duration-200",e==="sent"?"-left-1 -translate-x-full flex-row-reverse":"-right-1 translate-x-full",t),...r,children:n}));oxe.displayName="ChatBubbleActionWrapper";const ixe=[{icon:"copy",label:"Copy"},{icon:"refresh-ccw",label:"Refresh"},{icon:"volume-2",label:"Volume"}],sxe=g.memo(({message:e,index:t,isLastMessage:n,isGenerating:r,isSchema:a,onActionClick:o})=>{const i=g.useMemo(()=>h.jsx(LE,{style:{color:"unset !important"},source:e.content?a?`\`\`\`json
${e.content}
\`\`\``:e.content:""}),[a,e.content]);return h.jsxs(Nz,{innerclassname:e.role=="system"?"!bg-transparent font-semibold":void 0,variant:e.role=="user"?"sent":"received",children:[e.role==="system"?h.jsx("div",{className:"w-10 h-10"}):e.role==="assistant"?h.jsx(nxe,{src:"",fallback:e.data&&typeof e.data=="object"&&"injectedMessage"in e.data?"\u{1F4C2}":"\u{1F916}"}):void 0,h.jsxs(kz,{children:[r&&n&&(!e.content||a)?h.jsx(by,{}):h.jsxs(g.Suspense,{fallback:h.jsx(by,{}),children:[e.role==="system"?h.jsx(wn,{className:"!text-sm mb-1",children:"System"}):void 0,i]}),e.role==="assistant"&&n&&h.jsx("div",{className:"flex items-center mt-1.5 gap-1",children:!r&&h.jsx(h.Fragment,{children:ixe.map((s,c)=>h.jsx(axe,{variant:"ghost",className:"size-5",icon:h.jsx(pe,{name:s.icon,className:"size-3"}),onClick:()=>o(s.label,e)},c))})})]})]},t)},()=>!1),cxe=()=>({changeLLMOptions:g.useCallback(async(e,t)=>{e&&await le("LLM").update(e.id,{options:t})},[])}),lxe=g.memo(()=>{const{t:e}=Me("applications"),t=g.useRef(!1),[n,r]=g.useState(!1),a=g.useCallback(()=>{setTimeout(()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},50)},[]),o=Qpe(),{schema:i,threadInfo:s,mainLLMInfo:c,retriverInfo:l,currentDataNode:u,loadLLM:d,setLLMInfo:p,addNewDataNode:f,selectDataNode:m,updateMessagesData:y,onThreadMessagesLoaded:v}=o,{changeLLMOptions:b}=cxe(),{sendMessage:w}=d0e(o),{input:_,messages:x,isLoading:j,reload:E,setInput:S,handleSubmit:O,handleInputChange:N,setMessages:M}=hM({fetch:async(I,R)=>{try{r(!0);const L=JSON.parse(R==null?void 0:R.body),D=Hi(),z=L.messages[L.messages.length-1];return t.current=!0,M(U=>[...U,{id:Hi(),content:z.content,role:"user"}]),await w(z.content,L.messages||[],{retriverInfo:l},{schema:i,onInjectedMessages:U=>{U.length&&M($=>[...$,...U.map(V=>V._getType()==="system"?{id:Hi(),content:`${V.content}`,role:"system",data:{injectedMessage:!0}}:V._getType()==="human"?{id:Hi(),content:`${V.content}`,role:"user",data:{injectedMessage:!0}}:{id:Hi(),content:`${V.content}`,role:"assistant",data:{injectedMessage:!0}})])},onResponseMessageCreate:U=>{M($=>[...$,{id:D,content:U||"",role:"assistant"}])},onMessageUpdate:U=>{M($=>{const V=[...$],F=V.findIndex(W=>W.id===D);return F!==-1&&(V[F]={...V[F],content:U.nodeData.content||""}),V}),t.current&&a()}}),M(U=>(y(U),U)),r(!1),S(""),t.current&&a(),new Response}finally{r(!1)}}}),k=g.useRef(null);g.useEffect(()=>{const I=v(R=>{M(R||[]),a()});return()=>{I()}},[M,v,a]);const A=async(I,R)=>(r(!0),await O(R),!0),P=g.useCallback(async(I,R)=>{if(I==="Refresh"){r(!0);try{await E()}finally{r(!1)}}I==="Copy"&&R&&R.role==="assistant"&&navigator.clipboard.writeText(R.content),I==="Volume"&&(R!=null&&R.content)&&await Kk.speak((R==null?void 0:R.content)||"")},[E]),C=g.useCallback(()=>t.current=!1,[]),T=g.useMemo(()=>x&&x.map((I,R)=>h.jsx(sxe,{message:I,index:R,isLastMessage:R===x.length-1,isGenerating:n,isSchema:!!i,onActionClick:P},I.id||`${R}`)),[x,n,i,P]);return h.jsxs(zb,{onClick:C,className:"max-h-full !overflow-hidden !min-h-full",style:{minHeight:"unset"},defaultOpen:!0,children:[h.jsx(Vb,{className:"!max-h-full !overflow-hidden",style:{minHeight:"unset"},children:h.jsxs("main",{className:"flex h-full w-full max-w-2xl flex-col items-center mx-auto overflow-hidden",children:[h.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-w-full max-w-full",children:h.jsx(gI,{className:"!max-h-full",ref:k,children:T})}),h.jsx(_0,{className:"!max-w-2xl px-4",onSubmit:A,disabled:j||n||(c==null?void 0:c.status)!==et.Loaded,placeholder:e("chat.input_message_placeholder"),maxHeight:72,value:_,onChange:N})]})}),h.jsx(Jwe,{schema:i,currentDataNode:u,threadNode:s==null?void 0:s.threadNode,loadLLM:d,mainLLMInfo:c,mainEmbeddingInfo:o.mainEmbeddingInfo,retriverInfo:l,onAddNewThread:f,onSelectThread:m,changeLLMOptions:b,setLLMInfo:p})]})}),uxe=()=>{const[e,t]=g.useState(),n=Je(u=>u.currentSession),{t:r}=Me("flows"),{toast:a}=nn(),{stream:o}=nl(),{loadModel:i}=Cm(),{modalRef:s}=Pd(km),c=g.useCallback(async(u,d)=>{if(n!=null&&n.main_node_id){if(!(e!=null&&e.llm))return a({variant:"destructive",description:r("editor_node.errors.llm_not_found")});(e==null?void 0:e.status)!==et.Loaded&&(await i(e.llm.provider,e.llm.name,p=>{t(f=>f&&{...f,progress:p.text})}),t(p=>p&&{...p,status:et.Loaded,progress:""}));try{return(await o(e==null?void 0:e.llm.provider,typeof u=="string"?[new Vr(u)]:u,{onMessageUpdate:p=>{d==null||d(p.content)},llm:e==null?void 0:e.llm})).content}catch(p){if(p instanceof Error&&p.message.includes("LLM_NOT_LOADED_YET"))return a({title:r("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:r("editor_node.errors.stream_message_failed")})}}},[n==null?void 0:n.main_node_id,e==null?void 0:e.llm,e==null?void 0:e.status,a,r,i,o]),l=g.useCallback(async()=>{if(!(n!=null&&n.main_node_id))return;const u=await le("FlowEdge").find({where:{target:n.main_node_id}}),d=(await le("FlowNode").find({where:{id:Ka(u.map(f=>f.source))}})).find(f=>f.source_type===ie.LLM);if(!d)return;const p=await le("LLM").findOne({where:{id:d.source_id}});p&&(n.passphrase&&await vj(n.passphrase,s.current),await i(p.provider,p.name,f=>{t(m=>m&&{...m,llm:p,progress:f.text})}),t({llm:p,status:et.Loaded}))},[n==null?void 0:n.main_node_id,n==null?void 0:n.passphrase,i,s]);return g.useEffect(()=>{n!=null&&n.main_node_id&&l()},[n==null?void 0:n.main_node_id,l]),{mainLLMInfo:e,createMessage:c}},dxe=()=>{const e=Je(o=>o.currentSession),t=g.useRef(null),[n,r]=g.useState(),a=g.useCallback(async o=>{e!=null&&e.main_node_id&&(clearTimeout(t.current),t.current=setTimeout(async()=>{e!=null&&e.main_node_id&&await le("FlowNode").update(e.main_node_id,{data:o})},150))},[e]);return g.useEffect(()=>{e!=null&&e.main_node_id&&le("FlowNode").findOne({where:{id:e.main_node_id}}).then(o=>{r(o)})},[e]),{flowNode:n,updateEditorContent:a}},pxe=g.lazy(()=>qt(()=>import("./index-Cy5cgpTB.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,7,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),fxe=g.memo(()=>{var o,i,s,c,l;const{flowNode:e,updateEditorContent:t}=dxe(),{mainLLMInfo:n,createMessage:r}=uxe(),a=g.useCallback(u=>{t(u)},[t]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(Tu,{children:h.jsx(Fa,{children:h.jsxs("div",{className:Z("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(n==null?void 0:n.status)===et.Loaded&&((o=n==null?void 0:n.llm)!=null&&o.name)?h.jsx(Tr,{name:(i=n==null?void 0:n.llm)==null?void 0:i.name,className:"w-5 h-5 mr-1"}):void 0,h.jsx(Ba,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:n!=null&&n.progress?n==null?void 0:n.progress:(n==null?void 0:n.status)===et.Loaded?(s=n==null?void 0:n.llm)==null?void 0:s.name:h.jsx(pe,{size:16,name:"loader-circle",className:"animate-spin ml-2"})}),h.jsx(Qr,{children:h.jsx("p",{children:(n==null?void 0:n.progress)||((c=n==null?void 0:n.llm)==null?void 0:c.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(ru,{simple:!0}),children:e?h.jsx(pxe,{defaultValue:e==null?void 0:e.data,onValueChange:a,copilotStream:r,hideDragIcon:!0,enableHistoryControl:!0},((l=n==null?void 0:n.llm)==null?void 0:l.name)||"default"):h.jsx(ru,{simple:!0})})]})}),hxe=()=>{const[e,t]=g.useState(!1),[n,r]=g.useState(),a=Je(f=>f.currentSession),{t:o}=Me("flows"),{toast:i}=nn(),{loadModel:s}=Cm(),{stream:c}=nl(),{modalRef:l}=Pd(km),u=g.useCallback(async(f,m,y)=>{if(a!=null&&a.main_node_id){if(!(n!=null&&n.llm)){i({variant:"destructive",description:o("editor_node.errors.llm_not_found")});return}(n==null?void 0:n.status)!==et.Loaded&&(await s(n.llm.provider,n.llm.name,v=>{r(b=>b&&{...b,progress:v.text})}),r(v=>v&&{...v,status:et.Loaded,progress:""}));try{const v=m.map(w=>w.role==="system"?new Pv(w.content):w.role==="assistant"?new Ta(w.content):new Vr(w.content)),{content:b}=await c(n.llm.provider,[...v,new Vr(f)],{onMessageUpdate:({content:w})=>{y==null||y(w)},llm:n.llm});return y==null||y(b),b}catch(v){if(v instanceof Error&&v.message.includes("LLM_NOT_LOADED_YET")){i({title:o("editor_node.errors.llm_not_loaded_yet")});return}i({variant:"destructive",title:o("editor_node.errors.stream_message_failed")})}}},[a==null?void 0:a.main_node_id,n==null?void 0:n.llm,n==null?void 0:n.status,i,o,s,c]),d=g.useCallback(async()=>{try{if(t(!0),!(a!=null&&a.main_node_id))return;const f=await le("FlowEdge").find({where:{target:a.main_node_id}}),m=(await le("FlowNode").find({where:{id:Ka(f.map(v=>v.source))}})).find(v=>v.source_type===ie.LLM);if(!m)return;const y=await le("LLM").findOne({where:{id:m.source_id}});if(!y)return;a.passphrase&&await vj(a.passphrase,l.current),await s(y.provider,y.name,v=>{r(b=>b&&{...b,llm:y,progress:v.text})}),r({llm:y,status:et.Loaded})}finally{t(!1)}},[a==null?void 0:a.main_node_id,a==null?void 0:a.passphrase,s,l]),p=g.useCallback(async()=>{try{if(t(!0),!(n!=null&&n.llm))return;await s(n.llm.provider,n.llm.name,f=>{r(m=>m&&{...m,progress:f.text})}),r(f=>f&&{...f,status:et.Loaded,progress:""})}finally{t(!1)}},[s,n==null?void 0:n.llm]);return g.useEffect(()=>{a!=null&&a.main_node_id&&d()},[a==null?void 0:a.main_node_id,d]),{loading:e,mainLLMInfo:n,createMessage:u,loadCurrentModel:p}};MM=function(e,t=""){const n=[];for(const[r,a]of Object.entries(e)){const o=Hi(),i=[t,r].filter(Boolean).join("/"),s="file"in a&&"contents"in a.file?a.file:void 0,c={id:o,isSelectable:!0,content:typeof(s==null?void 0:s.contents)=="string"?s.contents:void 0,file:i,name:r,children:[]};"directory"in a&&(c.children=MM(a.directory,i)),n.push(c)}return n},C0=function(e){const t=e.trim().split(`
`),n={};return t.forEach(r=>{const{file:a,content:o}=JSON.parse(r),i=a.split("/");let s=n;for(let c=0;c<i.length;c++){const l=i[c];c===i.length-1?s[l]={file:{contents:o}}:(s[l]||(s[l]={directory:{}}),s=s[l].directory)}}),n},j0=function(e){const t=[];function n(r,a=[]){for(const[o,i]of Object.entries(r))if("file"in i){const s=[...a,o].join("/");if("contents"in i.file){const c=i.file.contents;t.push(JSON.stringify({file:s,content:c}))}}else"directory"in i&&n(i.directory,[...a,o])}return n(e),t.join(`
`)},N0=function(e,t){return QG(`[UpdateCodeContainerFile] Changes ${t.map(n=>`${n.type||"create_or_update"}:${n.path}`).join(", ")}`),t.forEach(({path:n,content:r,type:a="create_or_update"})=>{const o=n.replace(/^\.\//,"").split("/");let i=e;for(let s=0;s<o.length;s++){const c=o[s];if(s===o.length-1)a==="delete"?c in i&&"file"in i[c]?delete i[c]:console.warn(`Path "${n}" is not a file or does not exist.`):c in i&&"file"in i[c]?i[c].file.contents=r:i[c]={file:{contents:r}};else if(c in i&&"directory"in i[c])i=i[c].directory;else if(a==="delete"){console.warn(`Path "${n}" does not exist.`);break}else i[c]={directory:{}},i=i[c].directory}}),e};const mxe=()=>{const e=Je(i=>i.currentSession),[t,n]=g.useState(),r=g.useCallback(async(i,s)=>{await le("FlowNode").update(i,{raw:j0(s)})},[]),a=g.useCallback(async i=>{e!=null&&e.main_node_id&&n(s=>{if(!(e!=null&&e.main_node_id))return s;const c=N0(s||{},i);return r(e==null?void 0:e.main_node_id,c),c})},[e==null?void 0:e.main_node_id,r]),o=g.useCallback(async()=>{if(!(e!=null&&e.main_node_id))return;const i=await le("FlowNode").findOne({where:{id:e==null?void 0:e.main_node_id}});i&&n(i.raw?C0(i.raw):{})},[e==null?void 0:e.main_node_id]);return g.useEffect(()=>{e!=null&&e.main_node_id&&o()},[e==null?void 0:e.main_node_id,o]),{fileSystemTree:t,updateCodeContainerFile:a,updateCodeContainerData:r}},yxe=g.lazy(()=>qt(()=>import("./index-C8I42w52.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),gxe=g.memo(()=>{var s,c,l,u;const{loading:e,mainLLMInfo:t,loadCurrentModel:n,createMessage:r}=hxe(),{fileSystemTree:a,updateCodeContainerFile:o}=mxe(),i=g.useCallback((d,p,f)=>r(d,p,f),[r]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(Tu,{children:h.jsx(Fa,{children:h.jsxs("div",{className:Z("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(t==null?void 0:t.status)===et.Loaded&&((s=t==null?void 0:t.llm)!=null&&s.name)?h.jsx(Tr,{name:(c=t==null?void 0:t.llm)==null?void 0:c.name,className:"w-5 h-5 mr-1"}):void 0,h.jsxs(Ba,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:[t!=null&&t.progress?t.progress:(t==null?void 0:t.status)===et.Loaded?((l=t==null?void 0:t.llm)==null?void 0:l.name)||"":e?h.jsx(pe,{size:16,name:"loader-circle",className:"animate-spin ml-2"}):void 0,t!=null&&t.llm&&(t==null?void 0:t.status)!==et.Loaded?h.jsx(pe,{size:16,name:"loader-circle",onClick:n,className:"animate-spin ml-2"}):void 0]}),h.jsx(Qr,{children:h.jsx("p",{children:(t==null?void 0:t.progress)||((u=t==null?void 0:t.llm)==null?void 0:u.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(ru,{simple:!0}),children:a!==void 0?h.jsx(yxe,{autoLoad:!0,hideAppName:!0,llm:t==null?void 0:t.llm,fileSystemTree:a,onUpdateFileContent:o,sendMessage:i}):void 0})]})});function vxe(){var t,n;const e=Je(r=>r.currentSession);if(!e)return h.jsx(ru,{simple:!0,className:"w-full h-full"});if(e.main_source_type==="Thread")return h.jsx(lxe,{});if(((t=e.main_node)==null?void 0:t.node_type)==="EDITOR_APP")return h.jsx(fxe,{});if(((n=e.main_node)==null?void 0:n.node_type)==="VSLITE_APP")return h.jsx(gxe,{})}var Fy="Menubar",[kS,bxe,wxe]=yf(Fy),[Mz,M3e]=pr(Fy,[wxe,fo]),Xn=vh(),Az=fo(),[xxe,MS]=Mz(Fy),Pz=g.forwardRef((e,t)=>{const{__scopeMenubar:n,value:r,onValueChange:a,defaultValue:o,loop:i=!0,dir:s,...c}=e,l=oi(s),u=Az(n),[d="",p]=In({prop:r,onChange:a,defaultProp:o}),[f,m]=g.useState(null);return h.jsx(xxe,{scope:n,value:d,onMenuOpen:g.useCallback(y=>{p(y),m(y)},[p]),onMenuClose:g.useCallback(()=>p(""),[p]),onMenuToggle:g.useCallback(y=>{p(v=>v?"":y),m(y)},[p]),dir:l,loop:i,children:h.jsx(kS.Provider,{scope:n,children:h.jsx(kS.Slot,{scope:n,children:h.jsx(uu,{asChild:!0,...u,orientation:"horizontal",loop:i,dir:l,currentTabStopId:f,onCurrentTabStopIdChange:m,children:h.jsx(Pe.div,{role:"menubar",...c,ref:t})})})})})});Pz.displayName=Fy;var AS="MenubarMenu",[_xe,Tz]=Mz(AS),Iz=e=>{const{__scopeMenubar:t,value:n,...r}=e,a=Rt(),o=n||a||"LEGACY_REACT_AUTO_VALUE",i=MS(AS,t),s=Xn(t),c=g.useRef(null),l=g.useRef(!1),u=i.value===o;return g.useEffect(()=>{u||(l.current=!1)},[u]),h.jsx(_xe,{scope:t,value:o,triggerId:Rt(),triggerRef:c,contentId:Rt(),wasKeyboardTriggerOpenRef:l,children:h.jsx(DT,{...s,open:u,onOpenChange:d=>{d||i.onMenuClose()},modal:!1,dir:i.dir,...r})})};Iz.displayName=AS;var PS="MenubarTrigger",Rz=g.forwardRef((e,t)=>{const{__scopeMenubar:n,disabled:r=!1,...a}=e,o=Az(n),i=Xn(n),s=MS(PS,n),c=Tz(PS,n),l=g.useRef(null),u=jt(t,l,c.triggerRef),[d,p]=g.useState(!1),f=s.value===c.value;return h.jsx(kS.ItemSlot,{scope:n,value:c.value,disabled:r,children:h.jsx(du,{asChild:!0,...o,focusable:!r,tabStopId:c.value,children:h.jsx(LT,{asChild:!0,...i,children:h.jsx(Pe.button,{type:"button",role:"menuitem",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":f,"aria-controls":f?c.contentId:void 0,"data-highlighted":d?"":void 0,"data-state":f?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:u,onPointerDown:ge(e.onPointerDown,m=>{!r&&m.button===0&&m.ctrlKey===!1&&(s.onMenuOpen(c.value),f||m.preventDefault())}),onPointerEnter:ge(e.onPointerEnter,()=>{var m;s.value&&!f&&(s.onMenuOpen(c.value),(m=l.current)==null||m.focus())}),onKeyDown:ge(e.onKeyDown,m=>{r||(["Enter"," "].includes(m.key)&&s.onMenuToggle(c.value),m.key==="ArrowDown"&&s.onMenuOpen(c.value),["Enter"," ","ArrowDown"].includes(m.key)&&(c.wasKeyboardTriggerOpenRef.current=!0,m.preventDefault()))}),onFocus:ge(e.onFocus,()=>p(!0)),onBlur:ge(e.onBlur,()=>p(!1))})})})})});Rz.displayName=PS;var jxe="MenubarPortal",Dz=e=>{const{__scopeMenubar:t,...n}=e,r=Xn(t);return h.jsx($T,{...r,...n})};Dz.displayName=jxe;var TS="MenubarContent",Lz=g.forwardRef((e,t)=>{const{__scopeMenubar:n,align:r="start",...a}=e,o=Xn(n),i=MS(TS,n),s=Tz(TS,n),c=bxe(n),l=g.useRef(!1);return h.jsx(FT,{id:s.contentId,"aria-labelledby":s.triggerId,"data-radix-menubar-content":"",...o,...a,ref:t,align:r,onCloseAutoFocus:ge(e.onCloseAutoFocus,u=>{var d;!i.value&&!l.current&&((d=s.triggerRef.current)==null||d.focus()),l.current=!1,u.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,u=>{const d=u.target;c().some(p=>{var f;return(f=p.ref.current)==null?void 0:f.contains(d)})&&u.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,()=>{l.current=!0}),onEntryFocus:u=>{s.wasKeyboardTriggerOpenRef.current||u.preventDefault()},onKeyDown:ge(e.onKeyDown,u=>{if(["ArrowRight","ArrowLeft"].includes(u.key)){const d=u.target,p=d.hasAttribute("data-radix-menubar-subtrigger"),f=d.closest("[data-radix-menubar-content]")!==u.currentTarget,m=(i.dir==="rtl"?"ArrowRight":"ArrowLeft")===u.key;if(!m&&p||f&&m)return;let y=c().filter(w=>!w.disabled).map(w=>w.value);m&&y.reverse();const v=y.indexOf(s.value);y=i.loop?$xe(y,v+1):y.slice(v+1);const[b]=y;b&&i.onMenuOpen(b)}},{checkForDefaultPrevented:!1}),style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});Lz.displayName=TS;var Exe="MenubarGroup",Sxe=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(BT,{...a,...r,ref:t})});Sxe.displayName=Exe;var Oxe="MenubarLabel",$z=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(zT,{...a,...r,ref:t})});$z.displayName=Oxe;var Cxe="MenubarItem",Fz=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(UT,{...a,...r,ref:t})});Fz.displayName=Cxe;var Nxe="MenubarCheckboxItem",Bz=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(VT,{...a,...r,ref:t})});Bz.displayName=Nxe;var kxe="MenubarRadioGroup",Mxe=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(WT,{...a,...r,ref:t})});Mxe.displayName=kxe;var Axe="MenubarRadioItem",zz=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(HT,{...a,...r,ref:t})});zz.displayName=Axe;var Pxe="MenubarItemIndicator",Uz=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(qT,{...a,...r,ref:t})});Uz.displayName=Pxe;var Txe="MenubarSeparator",Vz=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(KT,{...a,...r,ref:t})});Vz.displayName=Txe;var Ixe="MenubarArrow",Rxe=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(ZT,{...a,...r,ref:t})});Rxe.displayName=Ixe;var Dxe="MenubarSubTrigger",Wz=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(GT,{"data-radix-menubar-subtrigger":"",...a,...r,ref:t})});Wz.displayName=Dxe;var Lxe="MenubarSubContent",Hz=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Xn(n);return h.jsx(XT,{...a,"data-radix-menubar-content":"",...r,ref:t,style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});Hz.displayName=Lxe;function $xe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var qz=Pz,Fxe=Iz,Kz=Rz,Bxe=Dz,Zz=Lz,Gz=$z,Xz=Fz,Jz=Bz,Yz=zz,Qz=Uz,e7=Vz,t7=Wz,n7=Hz;const IS=Fxe,r7=g.forwardRef(({className:e,...t},n)=>h.jsx(qz,{ref:n,className:Z("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",e),...t}));r7.displayName=qz.displayName;const RS=g.forwardRef(({className:e,...t},n)=>h.jsx(Kz,{ref:n,className:Z("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",e),...t}));RS.displayName=Kz.displayName;const zxe=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(t7,{ref:a,className:Z("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...r,children:[n,h.jsx(pe,{name:"chevron-right",className:"ml-auto h-4 w-4"})]}));zxe.displayName=t7.displayName;const Uxe=g.forwardRef(({className:e,...t},n)=>h.jsx(n7,{ref:n,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Uxe.displayName=n7.displayName;const a7=g.forwardRef(({className:e,align:t="start",alignOffset:n=-4,sideOffset:r=8,...a},o)=>h.jsx(Bxe,{children:h.jsx(Zz,{ref:o,align:t,alignOffset:n,sideOffset:r,className:Z("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));a7.displayName=Zz.displayName;const o7=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(Xz,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));o7.displayName=Xz.displayName;const Vxe=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(Jz,{ref:a,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(Qz,{children:h.jsx(pe,{name:"check",className:"h-4 w-4"})})}),t]}));Vxe.displayName=Jz.displayName;const Wxe=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(Yz,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(Qz,{children:h.jsx(pe,{name:"circle",className:"h-2 w-2 fill-current"})})}),t]}));Wxe.displayName=Yz.displayName;const Hxe=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(Gz,{ref:r,className:Z("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));Hxe.displayName=Gz.displayName;const qxe=g.forwardRef(({className:e,...t},n)=>h.jsx(e7,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));qxe.displayName=e7.displayName;let i7;Ie=o3e()(i3e(s3e((e,t)=>({...d6,...Ipe(e,t)})))),i7=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ie(i=>i.pushSyncNodeQueue),a=Ie(i=>i.createOrUpdateFlowNode),o=g.useCallback(async(i,s)=>{try{if(!e)throw new Error("Session not found");if(!s.provider||!s.name)throw new Error("Provider and name are required");n(!0);const c=await le("LLM").findOne({where:{name:s.name,session_id:e}});return c?(r("LLM",{where:{source_type:"LLM",source_id:c.id}}),c):le("LLM").save({name:`${s.name}`,status:s.provider===Ve.WebLLM?et.Started:et.Loaded,session_id:e,provider:s.provider,metadata:JSON.stringify(s.metadata||{}),model_type:s.model_type||vu.LLM,parameters:s.parameters||void 0,encrypted:s.encrypted||void 0,...s}).then(async l=>{var u,d,p;return await a({source_id:l.id,source_type:"LLM",node_type:ie.LLM,x:(u=i.position)==null?void 0:u.x,y:((d=i.position)==null?void 0:d.y)+(((p=i.measured)==null?void 0:p.height)||0)+30}),l})}finally{n(!1)}},[a,r,e]);return{loading:t,createLLM:o}};var s7=1,Kxe=.9,Zxe=.8,Gxe=.17,DS=.1,LS=.999,Xxe=.9999,Jxe=.99,Yxe=/[\\\/_+.#"@\[\(\{&]/,Qxe=/[\\\/_+.#"@\[\(\{&]/g,e1e=/[\s-]/,c7=/[\s-]/g;function $S(e,t,n,r,a,o,i){if(o===t.length)return a===e.length?s7:Jxe;var s=`${a},${o}`;if(i[s]!==void 0)return i[s];for(var c=r.charAt(o),l=n.indexOf(c,a),u=0,d,p,f,m;l>=0;)d=$S(e,t,n,r,l+1,o+1,i),d>u&&(l===a?d*=s7:Yxe.test(e.charAt(l-1))?(d*=Zxe,f=e.slice(a,l-1).match(Qxe),f&&a>0&&(d*=Math.pow(LS,f.length))):e1e.test(e.charAt(l-1))?(d*=Kxe,m=e.slice(a,l-1).match(c7),m&&a>0&&(d*=Math.pow(LS,m.length))):(d*=Gxe,a>0&&(d*=Math.pow(LS,l-a))),e.charAt(l)!==t.charAt(o)&&(d*=Xxe)),(d<DS&&n.charAt(l-1)===r.charAt(o+1)||r.charAt(o+1)===r.charAt(o)&&n.charAt(l-1)!==r.charAt(o))&&(p=$S(e,t,n,r,l+1,o+2,i),p*DS>d&&(d=p*DS)),d>u&&(u=d),l=n.indexOf(c,l+1);return i[s]=u,u}function l7(e){return e.toLowerCase().replace(c7," ")}function t1e(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,$S(e,t,l7(e),l7(t),0,0,{})}var lp='[cmdk-group=""]',FS='[cmdk-group-items=""]',n1e='[cmdk-group-heading=""]',BS='[cmdk-item=""]',u7=`${BS}:not([aria-disabled="true"])`,zS="cmdk-item-select",Es="data-value",r1e=(e,t,n)=>t1e(e,t,n),d7=g.createContext(void 0),up=()=>g.useContext(d7),p7=g.createContext(void 0),US=()=>g.useContext(p7),f7=g.createContext(void 0),h7=g.forwardRef((e,t)=>{let n=pl(()=>{var $,V;return{search:"",value:(V=($=e.value)!=null?$:e.defaultValue)!=null?V:"",filtered:{count:0,items:new Map,groups:new Set}}}),r=pl(()=>new Set),a=pl(()=>new Map),o=pl(()=>new Map),i=pl(()=>new Set),s=m7(e),{label:c,children:l,value:u,onValueChange:d,filter:p,shouldFilter:f,loop:m,disablePointerSelection:y=!1,vimBindings:v=!0,...b}=e,w=Rt(),_=Rt(),x=Rt(),j=g.useRef(null),E=h1e();Ss(()=>{if(u!==void 0){let $=u.trim();n.current.value=$,S.emit()}},[u]),Ss(()=>{E(6,P)},[]);let S=g.useMemo(()=>({subscribe:$=>(i.current.add($),()=>i.current.delete($)),snapshot:()=>n.current,setState:($,V,F)=>{var W,re,ee;if(!Object.is(n.current[$],V)){if(n.current[$]=V,$==="search")A(),M(),E(1,k);else if($==="value"&&(F||E(5,P),((W=s.current)==null?void 0:W.value)!==void 0)){let G=V??"";(ee=(re=s.current).onValueChange)==null||ee.call(re,G);return}S.emit()}},emit:()=>{i.current.forEach($=>$())}}),[]),O=g.useMemo(()=>({value:($,V,F)=>{var W;V!==((W=o.current.get($))==null?void 0:W.value)&&(o.current.set($,{value:V,keywords:F}),n.current.filtered.items.set($,N(V,F)),E(2,()=>{M(),S.emit()}))},item:($,V)=>(r.current.add($),V&&(a.current.has(V)?a.current.get(V).add($):a.current.set(V,new Set([$]))),E(3,()=>{A(),M(),n.current.value||k(),S.emit()}),()=>{o.current.delete($),r.current.delete($),n.current.filtered.items.delete($);let F=C();E(4,()=>{A(),(F==null?void 0:F.getAttribute("id"))===$&&k(),S.emit()})}),group:$=>(a.current.has($)||a.current.set($,new Set),()=>{o.current.delete($),a.current.delete($)}),filter:()=>s.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>s.current.disablePointerSelection,listId:w,inputId:x,labelId:_,listInnerRef:j}),[]);function N($,V){var F,W;let re=(W=(F=s.current)==null?void 0:F.filter)!=null?W:r1e;return $?re($,n.current.search,V):0}function M(){if(!n.current.search||s.current.shouldFilter===!1)return;let $=n.current.filtered.items,V=[];n.current.filtered.groups.forEach(W=>{let re=a.current.get(W),ee=0;re.forEach(G=>{let K=$.get(G);ee=Math.max(K,ee)}),V.push([W,ee])});let F=j.current;T().sort((W,re)=>{var ee,G;let K=W.getAttribute("id"),X=re.getAttribute("id");return((ee=$.get(X))!=null?ee:0)-((G=$.get(K))!=null?G:0)}).forEach(W=>{let re=W.closest(FS);re?re.appendChild(W.parentElement===re?W:W.closest(`${FS} > *`)):F.appendChild(W.parentElement===F?W:W.closest(`${FS} > *`))}),V.sort((W,re)=>re[1]-W[1]).forEach(W=>{var re;let ee=(re=j.current)==null?void 0:re.querySelector(`${lp}[${Es}="${encodeURIComponent(W[0])}"]`);ee==null||ee.parentElement.appendChild(ee)})}function k(){let $=T().find(F=>F.getAttribute("aria-disabled")!=="true"),V=$==null?void 0:$.getAttribute(Es);S.setState("value",V||void 0)}function A(){var $,V,F,W;if(!n.current.search||s.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let re=0;for(let ee of r.current){let G=(V=($=o.current.get(ee))==null?void 0:$.value)!=null?V:"",K=(W=(F=o.current.get(ee))==null?void 0:F.keywords)!=null?W:[],X=N(G,K);n.current.filtered.items.set(ee,X),X>0&&re++}for(let[ee,G]of a.current)for(let K of G)if(n.current.filtered.items.get(K)>0){n.current.filtered.groups.add(ee);break}n.current.filtered.count=re}function P(){var $,V,F;let W=C();W&&((($=W.parentElement)==null?void 0:$.firstChild)===W&&((F=(V=W.closest(lp))==null?void 0:V.querySelector(n1e))==null||F.scrollIntoView({block:"nearest"})),W.scrollIntoView({block:"nearest"}))}function C(){var $;return($=j.current)==null?void 0:$.querySelector(`${BS}[aria-selected="true"]`)}function T(){var $;return Array.from((($=j.current)==null?void 0:$.querySelectorAll(u7))||[])}function I($){let V=T()[$];V&&S.setState("value",V.getAttribute(Es))}function R($){var V;let F=C(),W=T(),re=W.findIndex(G=>G===F),ee=W[re+$];(V=s.current)!=null&&V.loop&&(ee=re+$<0?W[W.length-1]:re+$===W.length?W[0]:W[re+$]),ee&&S.setState("value",ee.getAttribute(Es))}function L($){let V=C(),F=V==null?void 0:V.closest(lp),W;for(;F&&!W;)F=$>0?p1e(F,lp):f1e(F,lp),W=F==null?void 0:F.querySelector(u7);W?S.setState("value",W.getAttribute(Es)):R($)}let D=()=>I(T().length-1),z=$=>{$.preventDefault(),$.metaKey?D():$.altKey?L(1):R(1)},U=$=>{$.preventDefault(),$.metaKey?I(0):$.altKey?L(-1):R(-1)};return g.createElement(Pe.div,{ref:t,tabIndex:-1,...b,"cmdk-root":"",onKeyDown:$=>{var V;if((V=b.onKeyDown)==null||V.call(b,$),!$.defaultPrevented)switch($.key){case"n":case"j":{v&&$.ctrlKey&&z($);break}case"ArrowDown":{z($);break}case"p":case"k":{v&&$.ctrlKey&&U($);break}case"ArrowUp":{U($);break}case"Home":{$.preventDefault(),I(0);break}case"End":{$.preventDefault(),D();break}case"Enter":if(!$.nativeEvent.isComposing&&$.keyCode!==229){$.preventDefault();let F=C();if(F){let W=new Event(zS);F.dispatchEvent(W)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:y1e},c),By(e,$=>g.createElement(p7.Provider,{value:S},g.createElement(d7.Provider,{value:O},$))))}),a1e=g.forwardRef((e,t)=>{var n,r;let a=Rt(),o=g.useRef(null),i=g.useContext(f7),s=up(),c=m7(e),l=(r=(n=c.current)==null?void 0:n.forceMount)!=null?r:i==null?void 0:i.forceMount;Ss(()=>{if(!l)return s.item(a,i==null?void 0:i.id)},[l]);let u=y7(a,o,[e.value,e.children,o],e.keywords),d=US(),p=Os(E=>E.value&&E.value===u.current),f=Os(E=>l||s.filter()===!1?!0:E.search?E.filtered.items.get(a)>0:!0);g.useEffect(()=>{let E=o.current;if(!(!E||e.disabled))return E.addEventListener(zS,m),()=>E.removeEventListener(zS,m)},[f,e.onSelect,e.disabled]);function m(){var E,S;y(),(S=(E=c.current).onSelect)==null||S.call(E,u.current)}function y(){d.setState("value",u.current,!0)}if(!f)return null;let{disabled:v,value:b,onSelect:w,forceMount:_,keywords:x,...j}=e;return g.createElement(Pe.div,{ref:dp([o,t]),...j,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!p,"data-disabled":!!v,"data-selected":!!p,onPointerMove:v||s.getDisablePointerSelection()?void 0:y,onClick:v?void 0:m},e.children)}),o1e=g.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:a,...o}=e,i=Rt(),s=g.useRef(null),c=g.useRef(null),l=Rt(),u=up(),d=Os(f=>a||u.filter()===!1?!0:f.search?f.filtered.groups.has(i):!0);Ss(()=>u.group(i),[]),y7(i,s,[e.value,e.heading,c]);let p=g.useMemo(()=>({id:i,forceMount:a}),[a]);return g.createElement(Pe.div,{ref:dp([s,t]),...o,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&g.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:l},n),By(e,f=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?l:void 0},g.createElement(f7.Provider,{value:p},f))))}),i1e=g.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,a=g.useRef(null),o=Os(i=>!i.search);return!n&&!o?null:g.createElement(Pe.div,{ref:dp([a,t]),...r,"cmdk-separator":"",role:"separator"})}),s1e=g.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,a=e.value!=null,o=US(),i=Os(u=>u.search),s=Os(u=>u.value),c=up(),l=g.useMemo(()=>{var u;let d=(u=c.listInnerRef.current)==null?void 0:u.querySelector(`${BS}[${Es}="${encodeURIComponent(s)}"]`);return d==null?void 0:d.getAttribute("id")},[]);return g.useEffect(()=>{e.value!=null&&o.setState("search",e.value)},[e.value]),g.createElement(Pe.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:a?e.value:i,onChange:u=>{a||o.setState("search",u.target.value),n==null||n(u.target.value)}})}),c1e=g.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...a}=e,o=g.useRef(null),i=g.useRef(null),s=up();return g.useEffect(()=>{if(i.current&&o.current){let c=i.current,l=o.current,u,d=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let p=c.offsetHeight;l.style.setProperty("--cmdk-list-height",p.toFixed(1)+"px")})});return d.observe(c),()=>{cancelAnimationFrame(u),d.unobserve(c)}}},[]),g.createElement(Pe.div,{ref:dp([o,t]),...a,"cmdk-list":"",role:"listbox","aria-label":r,id:s.listId},By(e,c=>g.createElement("div",{ref:dp([i,s.listInnerRef]),"cmdk-list-sizer":""},c)))}),l1e=g.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:a,contentClassName:o,container:i,...s}=e;return g.createElement(ou,{open:n,onOpenChange:r},g.createElement(cu,{container:i},g.createElement(Zi,{"cmdk-overlay":"",className:a}),g.createElement(Gi,{"aria-label":e.label,"cmdk-dialog":"",className:o},g.createElement(h7,{ref:t,...s}))))}),u1e=g.forwardRef((e,t)=>Os(n=>n.filtered.count===0)?g.createElement(Pe.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),d1e=g.forwardRef((e,t)=>{let{progress:n,children:r,label:a="Loading...",...o}=e;return g.createElement(Pe.div,{ref:t,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},By(e,i=>g.createElement("div",{"aria-hidden":!0},i)))}),sr=Object.assign(h7,{List:c1e,Item:a1e,Input:s1e,Group:o1e,Separator:i1e,Dialog:l1e,Empty:u1e,Loading:d1e});function p1e(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function f1e(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function m7(e){let t=g.useRef(e);return Ss(()=>{t.current=e}),t}var Ss=typeof window>"u"?g.useEffect:g.useLayoutEffect;function pl(e){let t=g.useRef();return t.current===void 0&&(t.current=e()),t}function dp(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function Os(e){let t=US(),n=()=>e(t.snapshot());return _f.useSyncExternalStore(t.subscribe,n,n)}function y7(e,t,n,r=[]){let a=g.useRef(),o=up();return Ss(()=>{var i;let s=(()=>{var l;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():a.current}})(),c=r.map(l=>l.trim());o.value(e,s,c),(i=t.current)==null||i.setAttribute(Es,s),a.current=s}),a}var h1e=()=>{let[e,t]=g.useState(),n=pl(()=>new Map);return Ss(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,a)=>{n.current.set(r,a),t({})}};function m1e(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function By({asChild:e,children:t},n){return e&&g.isValidElement(t)?g.cloneElement(m1e(t),{ref:t.ref},n(t.props.children)):n(t)}var y1e={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const g7=g.forwardRef(({className:e,...t},n)=>h.jsx(sr,{ref:n,className:Z("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));g7.displayName=sr.displayName;const v7=g.forwardRef(({className:e,...t},n)=>h.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[h.jsx(pe,{name:"search",className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),h.jsx(sr.Input,{ref:n,className:Z("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));v7.displayName=sr.Input.displayName;const b7=g.forwardRef(({className:e,...t},n)=>h.jsx(sr.List,{ref:n,className:Z("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));b7.displayName=sr.List.displayName;const w7=g.forwardRef((e,t)=>h.jsx(sr.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));w7.displayName=sr.Empty.displayName;const x7=g.forwardRef(({className:e,...t},n)=>h.jsx(sr.Group,{ref:n,className:Z("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));x7.displayName=sr.Group.displayName;const g1e=g.forwardRef(({className:e,...t},n)=>h.jsx(sr.Separator,{ref:n,className:Z("-mx-1 h-px bg-border",e),...t}));g1e.displayName=sr.Separator.displayName;const pp=g.forwardRef(({className:e,...t},n)=>h.jsx(sr.Item,{ref:n,className:Z("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...t}));pp.displayName=sr.Item.displayName;var VS="Checkbox",[v1e,A3e]=pr(VS),[b1e,w1e]=v1e(VS),_7=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:o,required:i,disabled:s,value:c="on",onCheckedChange:l,form:u,...d}=e,[p,f]=g.useState(null),m=jt(t,x=>f(x)),y=g.useRef(!1),v=p?u||!!p.closest("form"):!0,[b=!1,w]=In({prop:a,defaultProp:o,onChange:l}),_=g.useRef(b);return g.useEffect(()=>{const x=p==null?void 0:p.form;if(x){const j=()=>w(_.current);return x.addEventListener("reset",j),()=>x.removeEventListener("reset",j)}},[p,w]),h.jsxs(b1e,{scope:n,state:b,disabled:s,children:[h.jsx(Pe.button,{type:"button",role:"checkbox","aria-checked":Ti(b)?"mixed":b,"aria-required":i,"data-state":S7(b),"data-disabled":s?"":void 0,disabled:s,value:c,...d,ref:m,onKeyDown:ge(e.onKeyDown,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:ge(e.onClick,x=>{w(j=>Ti(j)?!0:!j),v&&(y.current=x.isPropagationStopped(),y.current||x.stopPropagation())})}),v&&h.jsx(x1e,{control:p,bubbles:!y.current,name:r,value:c,checked:b,required:i,disabled:s,form:u,style:{transform:"translateX(-100%)"},defaultChecked:Ti(o)?!1:o})]})});_7.displayName=VS;var j7="CheckboxIndicator",E7=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,o=w1e(j7,n);return h.jsx(Ur,{present:r||Ti(o.state)||o.state===!0,children:h.jsx(Pe.span,{"data-state":S7(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});E7.displayName=j7;var x1e=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:a,...o}=e,i=g.useRef(null),s=eB(n),c=jf(t);g.useEffect(()=>{const u=i.current,d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(s!==n&&p){const f=new Event("click",{bubbles:r});u.indeterminate=Ti(n),p.call(u,Ti(n)?!1:n),u.dispatchEvent(f)}},[s,n,r]);const l=g.useRef(Ti(n)?!1:n);return h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??l.current,...o,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Ti(e){return e==="indeterminate"}function S7(e){return Ti(e)?"indeterminate":e?"checked":"unchecked"}Vv=_7,mM=E7;const WS=g.forwardRef(({className:e,...t},n)=>h.jsx(Vv,{ref:n,className:Z("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:h.jsx(mM,{className:Z("flex items-center justify-center text-current"),children:h.jsx(pe,{name:"check",className:"h-4 w-4"})})}));WS.displayName=Vv.displayName;const _1e=["gpt-4o","gpt-4o-mini","gpt-4-turbo","gpt-4","gpt-3.5-turbo"],j1e=["deepseek-r1-distill-llama-70b","llama-3.2-90b-vision-preview","llama-3.3-70b-versatile","llama-3.3-70b-specdec","llama3-70b-8192","gemma2-9b-it","llama3-8b-8192","mixtral-8x7b-32768"],E1e=["llama-3.2-90b-vision-preview"],S1e=["gemini-2.0-flash-exp","gemini-1.5-flash","gemini-1.5-pro","gemini-1.5-flash-8b"],zy="https://aistudio.google.com/app/apikey",Uy="https://platform.openai.com/api-keys",O7="https://console.groq.com/keys",O1e=[Ve.WebLLM,Ve.OpenAI,Ve.GoogleGenerativeAI,Ve.Groq],C1e=po(({onConfirm:e,onCancel:t})=>{const n=tn(),{t:r}=Me("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{try{if((a==null?void 0:a.length)!==6)return;await(e==null?void 0:e(a)),o(""),n.resolve(!0),n.hide()}catch(l){n.reject(l)}},c=()=>{t==null||t(),o(""),n.resolve(!1),n.hide()};return h.jsx(hi,{open:n.visible,onOpenChange:c,children:h.jsxs(xo,{className:"w-[330px]",children:[h.jsxs(_o,{children:[h.jsx(jo,{children:r("create_session_passkey.title")}),h.jsx($u,{children:r("create_session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(fj,{onChange:i,maxLength:6,children:[h.jsxs(kd,{children:[h.jsx(xr,{index:0,hidden:!0}),h.jsx(xr,{index:1,hidden:!0}),h.jsx(xr,{index:2,hidden:!0})]}),h.jsx(hj,{}),h.jsxs(kd,{children:[h.jsx(xr,{index:3,hidden:!0}),h.jsx(xr,{index:4,hidden:!0}),h.jsx(xr,{index:5,hidden:!0})]})]})}),h.jsx(Lu,{children:h.jsx(Ye,{disabled:(a==null?void 0:a.length)!==6,onClick:s,type:"submit",children:r("create_session_passkey.confirm")})})]})})}),N1e=()=>{const[e,t]=g.useState(!1),n=Je(o=>o.currentSession),r=Je(o=>o.setCurrentSession),a=g.useCallback(async o=>{if(!(!n||!o))try{t(!0);const i=await Gpe(),s=await gj(i,o);await le("Session").update(n.id,{passphrase:s});const c=await le("Session").findOne({where:{id:n.id}});return c&&r(c),{passphrase:i,encrypted:s}}finally{t(!1)}},[n,r]);return{loading:e,updateSessionPassphrase:a}},C7=()=>{const e=Je(a=>a.currentSession),{modalRef:t}=Pd(C1e),{updateSessionPassphrase:n}=N1e(),{confirmPassphrase:r}=vy();return{confirmOrCreatePassphrase:g.useCallback(async()=>{if(e!=null&&e.passphrase)await r();else{let a="";if(await t.current.show({onConfirm:async i=>{a=i}}),!a)throw new Error("Passphrase is required");const o=await n(a);if(!o)throw new Error("Failed to update session passphrase");await ai.set("passphrase",o.passphrase)}return ai.get("passphrase")},[r,t,e==null?void 0:e.passphrase,n])}};function k1e(e){var $,V;const{id:t,setDialog:n}=e,{t:r}=Me("components"),{toast:a}=nn(),o=Rn(t),[i,s]=g.useState(!1),[c,l]=g.useState(""),[u,d]=g.useState(!1),[p,f]=g.useState(""),[m,y]=g.useState(),[v,b]=g.useState(Ve.WebLLM),[w,_]=g.useState(!1),[x,j]=g.useState(),E=Je(F=>F.currentSession),S=lo(F=>F.syncCachedLLMURLs),O=lo(F=>F.cachedLLMURLs),{loading:N,createLLM:M}=i7(),{confirmOrCreatePassphrase:k}=C7();g.useEffect(()=>{qt(()=>import("./index-C6S3C89h.js").then(async F=>(await F.__tla,F)),__vite__mapDeps([9,1,2,3,4])).then(async({functionCallingModelIds:F,prebuiltAppConfig:W})=>{const re=W.model_list;j({modelList:re,functionCallingModelIds:F})})},[]),g.useEffect(()=>{S()},[S]);const A=g.useMemo(()=>c?v!==Ve.WebLLM:!1,[c,v]),P=g.useMemo(()=>!(x!=null&&x.functionCallingModelIds)||!(x!=null&&x.modelList)?[]:((p?x==null?void 0:x.modelList.filter(F=>F.model_id.toLowerCase().includes(p.toLowerCase())):x==null?void 0:x.modelList)||[]).sort((F,W)=>{const re=O.some(B=>B.includes(F.model_id)),ee=O.some(B=>B.includes(W.model_id));if(re&&!ee)return-1;if(!re&&ee)return 1;const G=eS.includes(F.model_id),K=eS.includes(W.model_id);if(G&&!K)return-1;if(!G&&K)return 1;const X=x==null?void 0:x.functionCallingModelIds.includes(F.model_id),ne=x==null?void 0:x.functionCallingModelIds.includes(W.model_id);return X&&!ne?-1:!X&&ne?1:F.vram_required_MB&&W.vram_required_MB&&F.vram_required_MB!==W.vram_required_MB?F.vram_required_MB-W.vram_required_MB:F.model_id.localeCompare(W.model_id)}),[x==null?void 0:x.modelList,x==null?void 0:x.functionCallingModelIds,p,O]),C=g.useMemo(()=>{if(c)switch(v){case Ve.WebLLM:return(x==null?void 0:x.modelList)&&P.find(F=>F.model_id===c);case Ve.Groq:return y({}),{model:c,model_id:c,model_type:E1e.includes(c)?2:0,overrides:{}};case Ve.OpenAI:return y({}),{model:c,model_id:c,model_type:2,overrides:{}};case Ve.GoogleGenerativeAI:return y({}),{model:c,model_id:c,model_type:2,overrides:{}}}},[c,x==null?void 0:x.modelList,P,v]);g.useEffect(()=>{!(C!=null&&C.model_id)||!O||_(O.some(F=>F.includes(C.model_id)))},[O,C==null?void 0:C.model_id]),g.useEffect(()=>{E!=null&&E.id&&(b(Ve.WebLLM),l(""),f(""),y({}))},[E==null?void 0:E.id]);const T=g.useCallback(F=>{l(F),d(!1)},[]),I=g.useCallback(F=>{f(F)},[]),R=g.useCallback(F=>{b(F),l(""),f(""),y({})},[]),L=async()=>{var F;if(!(!o||!E))try{s(!0);let W;if(A){const re=await k();if(!re)throw new Error("Passphrase is not found");W=await Ype(m||{},re)}await M(o,{name:c,model_type:D(C==null?void 0:C.model_type),function_calling:C!=null&&C.model_id?(F=x==null?void 0:x.functionCallingModelIds)==null?void 0:F.includes(C==null?void 0:C.model_id):!1,encrypted:W,provider:v}),n==null||n(!1)}catch(W){Hs(W),a({variant:"destructive",description:r("add_llm_card.errors.failed_to_create")})}finally{s(!1),b(Ve.WebLLM),y({}),l(""),f("")}},D=g.useCallback(F=>F===1?vu.embedding:F===2?vu.VLM:vu.LLM,[]),z=g.useMemo(()=>{switch(v){case Ve.WebLLM:return P.map(F=>{var W;return h.jsxs(pp,{value:F.model_id,onSelect:T,children:[c===F.model_id?h.jsx(pe,{name:"check",className:"mr-2 h-4 w-4"}):h.jsx("div",{className:"mr-2 h-4 w-4"}),h.jsxs("span",{className:"max-w-md",children:[h.jsxs("div",{className:"flex gap-2 mb-2",children:[h.jsx(Tr,{name:F.model_id}),F.model_id]}),h.jsx("div",{className:"flex max-w-full flex-wrap gap-1",children:h.jsx(ip,{model:F,isFunctionCalling:((W=x==null?void 0:x.functionCallingModelIds)==null?void 0:W.includes(F.model_id))||!1,name:F.model_id,isCached:O.some(re=>re.includes(F.model_id))||!1,cloud:v!==Ve.WebLLM})})]})]},F.model_id)});case Ve.OpenAI:return _1e.map(F=>h.jsxs(pp,{value:F,onSelect:T,children:[c===F?h.jsx(pe,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Tr,{name:F}),F]})})]},F));case Ve.GoogleGenerativeAI:return S1e.map(F=>h.jsxs(pp,{value:F,onSelect:T,children:[c===F?h.jsx(pe,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Tr,{name:F}),F]})})]},F));case Ve.Groq:return j1e.map(F=>h.jsxs(pp,{value:F,onSelect:T,children:[c===F?h.jsx(pe,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Tr,{name:F}),F]})})]},F))}},[O,T,c,x==null?void 0:x.functionCallingModelIds,P,v]),U=g.useMemo(()=>{if(A)switch(v){case Ve.Groq:case Ve.OpenAI:return h.jsxs(h.Fragment,{children:[h.jsx(Er,{variant:"destructive",className:"mt-4",children:r("add_llm_card.alert.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(Be,{children:r("add_llm_card.encrypted_fields.api_key")}),h.jsx(Ye,{variant:"link",className:"px-1",children:h.jsxs("a",{href:v===Ve.OpenAI?Uy:O7,target:"_blank",rel:"noreferrer",children:["(",v===Ve.OpenAI?Uy:O7,")"]})}),h.jsx(Kt,{type:"password",value:(m==null?void 0:m.key)||"",onChange:F=>y(W=>({...W,key:F.target.value}))})]})]});case Ve.GoogleGenerativeAI:return h.jsxs(h.Fragment,{children:[h.jsx(Er,{variant:"destructive",className:"mt-4",children:r("add_llm_card.alert.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(Be,{children:r("add_llm_card.encrypted_fields.api_key")}),h.jsx(Ye,{variant:"link",className:"px-1",children:h.jsxs("a",{href:zy,target:"_blank",rel:"noreferrer",children:["(",zy,")"]})}),h.jsx(Kt,{type:"password",value:(m==null?void 0:m.key)||"",onChange:F=>y(W=>({...W,key:F.target.value}))})]}),h.jsxs("div",{className:"mt-4 flex items-center",children:[h.jsx(Be,{children:r("add_llm_card.encrypted_fields.enabled_google_search_retreival")}),h.jsx(WS,{checked:!!(m!=null&&m.enabled_google_search_retreival),className:"ml-2",onCheckedChange:F=>{y(W=>({...W,enabled_google_search_retreival:F?"true":""}))}})]})]})}},[A,v,r,m]);return h.jsxs(Gt,{className:"max-w-lg",children:[h.jsx(Mn,{children:h.jsx(Fn,{children:r("add_llm_card.title")})}),h.jsxs(An,{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(Be,{children:r("add_llm_card.provider")}),h.jsxs(Qa,{value:v,onValueChange:R,children:[h.jsx(Ea,{className:"w-full mb-4",children:h.jsx(eo,{placeholder:r("add_llm_card.provider_select_placeholder")})}),h.jsx(Sa,{children:Object.values(O1e).map(F=>h.jsx(Bn,{value:F,children:r(`add_llm_card.providers.${F.toLowerCase()}`)},F))})]}),h.jsx(Be,{children:r("add_llm_card.model_name")}),h.jsxs(Of,{open:u,onOpenChange:d,children:[h.jsx(YE,{asChild:!0,children:h.jsxs(Ye,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between",children:[c?C==null?void 0:C.model_id:r("add_llm_card.select_model_placeholder"),h.jsx(pe,{name:"chevrons-up-down",className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),h.jsx(mu,{className:"w-full p-0",children:h.jsxs(g7,{children:[h.jsx(v7,{onValueChange:I,placeholder:r("add_llm_card.search_placeholder")}),h.jsxs(b7,{children:[h.jsx(w7,{children:r("add_llm_card.no_model")}),h.jsx(x7,{children:z})]})]})})]})]}),C?h.jsxs("div",{className:"mt-4",children:[h.jsxs("div",{className:"mt-4 text-sm text-muted-foreground center flex max-w-full flex-wrap gap-1",children:[h.jsx(Tr,{name:C.model_id,className:"mr-2"}),h.jsx(ip,{model:C,isFunctionCalling:(($=x==null?void 0:x.functionCallingModelIds)==null?void 0:$.includes(C.model_id))||!1,name:C.model_id,isCached:O.some(F=>F.includes(C.model_id))||!1,cloud:v!==Ve.WebLLM})]}),h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_url")}),C.model]}),C.model_lib?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_lib_url")}),C.model_lib]}):void 0,C.overrides&&((V=Object.keys(C.overrides))!=null&&V.length)?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.metadata")}),JSON.stringify(C.overrides)]}):void 0]}):null,U]}),h.jsx(Ya,{className:"flex justify-between",children:h.jsx(Qn,{loading:N||i,disabled:!(c!=null&&c.length),onClick:L,className:"w-full",children:r(w?"add_llm_card.button_add":"add_llm_card.button_download_and_add")})})]})}const N7=()=>{const e=Je(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=Ie(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i)=>{var s,c,l;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const u=((s=o.position)==null?void 0:s.x)||0,d=(((c=o.position)==null?void 0:c.y)||0)+(((l=o.measured)==null?void 0:l.height)||0),p=await le("Prompt").save({content:i.content,prefix:i.prefix,role:i.role||hr.System,status:Kr.Started,session_id:e,type:i.type||mr.Chat});if(!p)throw new Error("Failed to save prompt");if(!await r({source_id:p.id,source_type:"Prompt",node_type:ie.Prompt,x:u,y:d+20}))throw new Error("Failed to save prompt node")}finally{n(!1)}},[e,r]);return{loading:t,createPrompt:a}},M1e={[mr.Chat]:{label:"add_prompt_card.prompt_types.chat",value:mr.Chat},[mr.FewShotExample]:{label:"add_prompt_card.prompt_types.few_shot_example",value:mr.FewShotExample}},A1e={[hr.System]:{label:"add_prompt_card.prompt_roles.system",value:hr.System},[hr.Human]:{label:"add_prompt_card.prompt_roles.human",value:hr.Human},[hr.AI]:{label:"add_prompt_card.prompt_roles.ai",value:hr.AI}},HS=g.memo(({defaultPromptContent:e,defaultPromptRole:t,defaultPromptType:n,hidePromptRole:r,hidePromptType:a,loading:o,onSubmit:i})=>{const[s,c]=g.useState(e||""),[l,u]=g.useState(n||mr.Chat),[d,p]=g.useState(t),[f,m]=g.useState(""),{t:y}=Me("components"),v=g.useCallback(j=>{c(j.target.value)},[]),b=g.useCallback(j=>{m(j.target.value)},[]),w=g.useCallback(j=>{j===mr.FewShotExample&&c(`Question: {input}
Answer: {output}`),u(j)},[]),_=g.useCallback(j=>{p(j)},[]),x=async()=>{await i({content:s,role:d,prefix:f,type:l})&&(c(""),p(void 0),u("chat"),m(""))};return h.jsxs("div",{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[a?void 0:h.jsxs(h.Fragment,{children:[h.jsx(Be,{children:y("add_prompt_card.prompt_type")}),h.jsxs(Qa,{value:l,onValueChange:w,children:[h.jsx(Ea,{className:"w-full mb-4",children:h.jsx(eo,{placeholder:y("add_prompt_card.type_select_placeholder")})}),h.jsx(Sa,{children:Object.values(M1e).map(j=>h.jsx(Bn,{value:j.value,children:y(j.label)},j.value))})]})]}),r?void 0:h.jsxs(h.Fragment,{children:[h.jsx(Be,{children:y("add_prompt_card.prompt_role")}),h.jsxs(Qa,{value:d,onValueChange:_,children:[h.jsx(Ea,{className:"w-full mb-4",children:h.jsx(eo,{placeholder:y("add_prompt_card.role_select_placeholder")})}),h.jsx(Sa,{children:Object.values(A1e).map(j=>h.jsx(Bn,{value:j.value,children:y(j.label)},j.value))})]})]}),l===mr.FewShotExample&&h.jsxs(h.Fragment,{children:[h.jsx(Be,{children:y("add_prompt_card.prompt_prefix")}),h.jsx(ko,{value:f,onChange:b,disabled:!1,className:"h-20",placeholder:y("add_prompt_card.placeholder"),id:"message"}),h.jsx(Be,{children:y("add_prompt_card.prompt_content")}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm justify-end items-center",children:[h.jsx(pe,{name:"info",className:"mr-2",size:14}),y("add_prompt_card.few_shot_example_note")]})]}),h.jsx(ko,{value:s,onChange:v,disabled:!1,placeholder:y("add_prompt_card.placeholder"),id:"message"})]}),h.jsx("div",{children:h.jsx(Qn,{loading:o,disabled:!(s!=null&&s.length),onClick:x,className:"w-full mt-4",children:y("add_prompt_card.button")})})]})}),P1e=g.memo(e=>{const{id:t,thread:n,setDialog:r}=e,{t:a}=Me("components"),{toast:o}=nn(),i=Rn(t),{createPrompt:s,loading:c}=N7(),l=async u=>{if(i)try{if(!(u!=null&&u.content))throw new Error("Prompt data is missing");await s(i,{...u,content:u.content,thread:n}),r==null||r(!1)}catch(d){o({variant:"destructive",title:`${d}`})}};return h.jsxs(Gt,{className:"mw-full",children:[h.jsx(Mn,{children:h.jsx(Fn,{children:a("add_prompt_card.title")})}),h.jsx(An,{children:h.jsx(HS,{onSubmit:l,loading:c,defaultPromptRole:"system",defaultPromptType:"chat"})})]})}),T1e=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ie(i=>i.createOrUpdateFlowNode),a=g.useCallback((i,s,c,l)=>{var u;if(e){for(const d of s)(u=d.data)!=null&&u.length?a(i,d.data,c,d.id):c.push({name:d.name,type:d.type,enum:d.enum?JSON.stringify(d.enum):"",required:d.required,description:d.description,id:d.id||Uu(),parent_id:l,schema_id:i,session_id:e});return c}},[e]),o=g.useCallback(async(i,s)=>{var c,l,u;try{if(!i||!e)throw new Error("Source or Session not found");n(!0);const d=((c=i.position)==null?void 0:c.x)||0,p=(((l=i.position)==null?void 0:l.y)||0)+(((u=i.measured)==null?void 0:u.height)||0),f=await le("Schema").save({name:"Untitled Schema",session_id:e});if(!f)throw new Error("Failed to save schema");const m=a(f.id,s,[],void 0);if(!(m!=null&&m.length))throw new Error("Failed to convert schema items");if(await le("SchemaItem").save(m),!await r({source_id:f.id,source_type:"Schema",node_type:ie.Schema,x:d,y:p+20}))throw new Error("Failed to save schema node")}finally{n(!1)}},[e,a,r]);return{loading:t,createSchema:o}},k7=g.memo(({setData:e,data:t,id:n})=>{const{t:r}=Me("components"),[a,o]=g.useState({name:"",description:"",type:"string",required:!1,data:[]}),i=g.useMemo(()=>n&&t.find(y=>y.id===n)||a,[t,a,n]),s=g.useCallback(y=>{y.target.value&&!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(y.target.value)||(n?e(v=>[...v.map(b=>b.id===n?{...b,name:y.target.value||""}:b)]):o(v=>({...v,name:y.target.value||""})))},[n,e]),c=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,description:y.target.value||""}:b)]):o(v=>({...v,description:y.target.value||""}))},[n,e]),l=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,type:y||""}:b)]):o(v=>({...v,type:y||"string"}))},[n,e]),u=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,required:!!y||!1}:b)]):o(v=>({...v,required:!!y||!1}))},[n,e]),d=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,enum:y.target.value||""}:b)]):o(v=>({...v,enum:y.target.value||""}))},[n,e]),p=g.useCallback(()=>{if(t.find(y=>y.name===a.name))return au({variant:"destructive",content:"Name already exists"});a.id=Uu(),e(y=>[...y,{...a}]),o({name:"",description:"",type:"string",required:!1,id:Uu(),parent:n||void 0,data:[]})},[t,a,e,n]),f=g.useCallback(y=>{e(v=>[...v.map(b=>b.id===n?{...b,data:y(b.data||[])}:b)])},[n,e]),m=["object","array"].includes(i.type);return h.jsxs("div",{className:"w-full p-1",children:[h.jsxs("div",{children:[h.jsx(Be,{children:r("add_schema_card.field.name")}),h.jsx(Kt,{id:"name",onChange:s,placeholder:r("add_schema_card.field.name_placeholder"),value:(i==null?void 0:i.name)||""})]}),h.jsxs("div",{children:[h.jsx(Be,{children:r("add_schema_card.field.description")}),h.jsx(Kt,{id:"description",placeholder:r("add_schema_card.field.description_placeholder"),onChange:c,value:(i==null?void 0:i.description)||""})]}),h.jsxs("div",{children:[h.jsx(Be,{children:r("add_schema_card.field.type")}),h.jsxs(Qa,{onValueChange:l,value:(i==null?void 0:i.type)||"",children:[h.jsx(Ea,{children:h.jsx(eo,{placeholder:r("add_schema_card.field.type_placeholder")})}),h.jsxs(Sa,{children:[h.jsx(Bn,{value:"string",children:r("add_schema_card.types.string")}),h.jsx(Bn,{value:"boolean",children:r("add_schema_card.types.boolean")}),h.jsx(Bn,{value:"number",children:r("add_schema_card.types.number")}),h.jsx(Bn,{value:"object",children:r("add_schema_card.types.object")}),h.jsx(Bn,{value:"array",children:r("add_schema_card.types.array")})]})]})]}),h.jsxs("div",{className:"flex items-center h-10",children:[h.jsx(Be,{children:r("add_schema_card.field.required")}),h.jsx(WS,{className:"ml-2","aria-label":"Select row",onCheckedChange:u,checked:i==null?void 0:i.required})]}),m?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(Be,{children:r("add_schema_card.children")}),h.jsx(M7,{data:(i==null?void 0:i.data)||[],setData:f})]}):null,(i==null?void 0:i.type)==="enum"?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(Be,{children:r("add_schema_card.field.enum")}),h.jsx(Kt,{id:"enum",onChange:d,placeholder:"Enum"})]}):null,n?null:h.jsx("div",{className:"w-full flex justify-end mt-2",children:h.jsx(Ye,{variant:"secondary",disabled:!i.name||!i.description||!i.type,onClick:p,className:"w-full",children:r("add_schema_card.field.add_field")})})]})}),M7=g.memo(({data:e,setData:t})=>h.jsxs(XB,{type:"single",collapsible:!0,children:[e.map(n=>h.jsxs(hS,{value:`${n.id}`,children:[h.jsx(mS,{children:n.name}),h.jsx(yS,{children:h.jsx(k7,{setData:t,data:e,id:n.id})})]},n.id||"new")),h.jsx(Gt,{className:"p-2 mt-4",children:h.jsx(k7,{setData:t,data:e})})]})),I1e=g.memo(e=>{const{t}=Me("components"),{id:n}=e,r=Rn(n),[a,o]=g.useState([]),{createSchema:i,loading:s}=T1e(),c=async()=>{if(r&&(a!=null&&a.length))try{await i(r,a),o([])}catch(l){au({variant:"destructive",title:`${l}`})}};return h.jsxs(Gt,{className:"max-w-lg",children:[h.jsx(Mn,{children:h.jsx(Fn,{children:t("add_schema_card.title")})}),h.jsx(An,{className:"min-w-96",children:h.jsx(M7,{setData:o,data:a})}),h.jsx(Ya,{className:"flex justify-between",children:h.jsx(Qn,{loading:s,disabled:!(a!=null&&a.length),onClick:c,className:"w-full",children:t("add_schema_card.create")})})]})}),A7=()=>{const e=Je(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=Ie(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i,s)=>{var c,l,u;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const d=((c=o.position)==null?void 0:c.x)||0,p=(((l=o.position)==null?void 0:l.y)||0)+(((u=o.measured)==null?void 0:u.height)||0),f=c3e(i,s),m=await le("CSVData").save({headers:f.headers,csv:f.data,session_id:e});if(!m)throw new Error("Failed to save");if(!await r({source_id:m.id,source_type:"CSVData",node_type:ie.CSVData,x:d,y:p+20}))throw new Error("Failed to save node")}finally{n(!1)}},[e,r]);return{loading:t,createCSVData:a}};function R1e({data:e}){const{t}=Me("components");return h.jsxs(Iy,{className:"w-full",children:[h.jsx(Ry,{children:h.jsxs(js,{children:[h.jsx(ll,{children:t("add_few_shot_example_card.input")}),h.jsx(ll,{children:t("add_few_shot_example_card.output")})]})}),h.jsx(Dy,{children:e==null?void 0:e.map((n,r)=>h.jsxs(js,{children:[h.jsx(ul,{className:"p-4",children:n.input}),h.jsx(ul,{className:"p-4",children:n.output})]},`${n.input}_${n.output}_${r}`))})]})}const D1e=g.memo(e=>{const{id:t}=e,{t:n}=Me("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),[s,c]=g.useState(""),l=Rn(t),{createCSVData:u,loading:d}=A7(),p=()=>{a(m=>[...m,{input:o,output:s}]),i(""),c("")},f=async()=>{l&&await u(l,["input","output"],r.map(m=>[m.input,m.output]))};return h.jsxs(Gt,{className:"mw-full",children:[h.jsx(Mn,{children:h.jsx(Fn,{children:n("add_few_shot_example_card.title")})}),h.jsxs(An,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(Be,{htmlFor:"name",children:n("add_few_shot_example_card.input")}),h.jsx(Kt,{value:o,onChange:m=>i(m.target.value||""),id:"name",placeholder:n("add_few_shot_example_card.input_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(Be,{htmlFor:"name",children:n("add_few_shot_example_card.output")}),h.jsx(ko,{value:s,onChange:m=>c(m.target.value||""),placeholder:n("add_few_shot_example_card.output_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(Ye,{disabled:!o||!s,onClick:p,className:"w-40",children:n("add_few_shot_example_card.add")})}),h.jsx(R1e,{data:r||[]})]}),h.jsx(Ya,{className:"flex justify-between",children:h.jsx(Qn,{loading:d,disabled:!(r!=null&&r.length),onClick:f,className:"w-full",children:n("add_few_shot_example_card.create")})})]})}),L1e=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ie(i=>i.createOrUpdateFlowNode),a=Ie(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!i||!e)throw new Error("Source or Session not found");if(!s.name||!s.description)throw new Error("Name is required");n(!0);const p=((l=i.position)==null?void 0:l.x)||0,f=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),m=await le("ToolDefinition").save({...s,name:`${s.name}`,description:`${s.description}`,session_id:e});if(!m)throw new Error("Failed create tool.");const y=await r({source_id:m.id,source_type:"ToolDefinition",node_type:ie.ToolDefinition,x:p,y:f+20});if(!y)throw new Error("Failed to save node");c!=null&&c.schemaNode&&await a({source:c.schemaNode.id,target:y.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createTool:o}},$1e=g.memo(e=>{const{t}=Me("components"),{toast:n}=nn(),{id:r}=e,a=Rn(r),[o,i]=g.useState(""),[s,c]=g.useState(""),{createTool:l,loading:u}=L1e(),d=m=>{i(m.target.value)},p=m=>{c(m.target.value)},f=async()=>{if(a&&o&&s)try{await l(a,{name:o,description:s}),i(""),c("")}catch(m){ni(m),n({variant:"destructive",title:t("add_tool_card.errors.create_tool_failed")})}};return h.jsxs(Gt,{className:"mw-full",children:[h.jsx(Mn,{children:h.jsx(Fn,{children:t("add_tool_card.title")})}),h.jsxs(An,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(Be,{htmlFor:"name",children:t("add_tool_card.tool_name")}),h.jsx(Kt,{onChange:d,id:"name",placeholder:t("add_tool_card.name_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(Be,{htmlFor:"name",children:t("add_tool_card.tool_description")}),h.jsx(ko,{onChange:p,placeholder:t("add_tool_card.description_placeholder")})]})]}),h.jsx(Ya,{className:"flex justify-between",children:h.jsx(Qn,{loading:u,onClick:f,className:"w-full",children:t("add_tool_card.create")})})]})}),F1e=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ie(i=>i.createOrUpdateFlowNode),a=Ie(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!(s!=null&&s.name)||!i||!e)throw new Error("Source or Session not found");n(!0);const p=((l=i.position)==null?void 0:l.x)||0,f=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),m=await le("VectorDatabase").save({...s,name:`${s.name}`,type:s.type||l3e.Local,storage:s.storage||Wr.DatabaseNode,raw:"",provider:s.provider||eX.Memory,session_id:e,metadata:c?JSON.stringify({textSplitter:c}):void 0});if(!m)throw new Error("Failed to save vectorDatabase");const y=await r({source_id:m.id,source_type:"VectorDatabase",node_type:ie.VectorDatabase,x:p,y:f+30});if(!y)throw new Error("Failed to save vectorDatabase node");if(s.storage===Wr.DataNode){const v=await le("JSONLData").save({headers:u3e(["content","embedding","metadata"]),jsonl:"",session_id:e});if(!v)throw new Error("Failed to save databaseSource");const b=await r({source_id:v.id,source_type:"JSONLData",node_type:ie.JSONLData,x:p+80,y:f+30});if(!b)throw new Error("Failed to save databaseSource node");await a({source:b.id,target:y.id})}return{vectorDatabase:m,vectorDatabaseNode:y}}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabase:o}},fp=[eX.Memory],hp=[Wr.DatabaseNode],B1e=["TokenTextSplitter","CharacterTextSplitter","RecursiveCharacterTextSplitter"],z1e=g.memo(e=>{const{t}=Me("components"),{id:n}=e,r=Rn(n),{toast:a}=nn(),[o,i]=g.useState(""),[s,c]=g.useState(fp[0]),[l,u]=g.useState(hp[0]),[d,p]=g.useState({}),{loading:f,createVectorDatabase:m}=F1e(),y=g.useCallback(E=>{c(E)},[]),v=g.useCallback(E=>{u(E)},[]),b=g.useCallback(E=>{p(S=>({...S,type:E,chunkSize:500,chunkOverlap:40}))},[]),w=g.useCallback(E=>{i(E.target.value||"")},[]),_=g.useCallback(E=>{p(S=>({...S,chunkSize:Number(E.target.value)}))},[]),x=g.useCallback(E=>{p(S=>({...S,chunkOverlap:Number(E.target.value)}))},[]),j=async()=>{try{if(!r)return;await m(r,{name:o,provider:s,storage:l},d!=null&&d.type?{type:d.type,chunkSize:d.chunkSize||500,chunkOverlap:d.chunkOverlap||0}:void 0),i(""),p({})}catch{a({variant:"destructive",description:t("create_vector_database_card.errors.create_failed")})}};return h.jsxs(Gt,{className:"mw-full",children:[h.jsx(Mn,{children:h.jsx(Fn,{children:t("create_vector_database_card.title")})}),h.jsx(An,{children:h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(Be,{children:t("create_vector_database_card.name")}),h.jsx(Kt,{className:"mb-4",value:o,onChange:w}),(hp==null?void 0:hp.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(Be,{children:t("create_vector_database_card.storage_type")}),h.jsxs(Qa,{value:l,onValueChange:v,children:[h.jsx(Ea,{className:"w-full mb-4",children:h.jsx(eo,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(Sa,{children:Object.values(hp).map(E=>h.jsx(Bn,{value:E,children:t(`create_vector_database_card.storage_types.${E.toLowerCase()}`)},E))})]})]}):void 0,(fp==null?void 0:fp.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(Be,{children:t("create_vector_database_card.provider")}),h.jsxs(Qa,{value:s,onValueChange:y,children:[h.jsx(Ea,{className:"w-full mb-4",children:h.jsx(eo,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(Sa,{children:Object.values(fp).map(E=>h.jsx(Bn,{value:E,children:t(`create_vector_database_card.providers.${E.toLowerCase()}`)},E))})]})]}):void 0,h.jsx(Be,{children:t("create_vector_database_card.text_splitter")}),h.jsxs(Qa,{value:d.type,onValueChange:b,children:[h.jsx(Ea,{className:"w-full mb-4",children:h.jsx(eo,{placeholder:t("create_vector_database_card.text_splitter_select_placeholder")})}),h.jsx(Sa,{children:Object.values(B1e).map(E=>h.jsx(Bn,{value:E,children:t(`create_vector_database_card.text_splitters.${E.toLowerCase()}`)},E))})]}),d.type?h.jsxs(Gt,{children:[h.jsx(Mn,{children:h.jsx(Fn,{children:t("create_vector_database_card.text_splitter_configuration")})}),h.jsxs(An,{children:[h.jsx(Be,{children:t("create_vector_database_card.text_splitter_chunksize")}),h.jsx(Kt,{value:d.chunkSize,onChange:_,placeholder:t("create_vector_database_card.text_splitter_chunksize_placeholder")}),h.jsx(Be,{children:t("create_vector_database_card.text_splitter_chunkoverlap")}),h.jsx(Kt,{value:d.chunkOverlap,onChange:x,placeholder:t("create_vector_database_card.text_splitter_chunkoverlap_placeholder")})]})]}):void 0]})}),h.jsx(Ya,{className:"flex justify-between",children:h.jsx(Qn,{disabled:!d.type||!o,loading:f,onClick:j,className:"w-full",children:t("create_vector_database_card.create")})})]})});function U1e({data:e}){const{t}=Me("components");return h.jsxs(Iy,{className:"w-full",children:[h.jsx(Ry,{children:h.jsx(js,{children:h.jsx(ll,{children:t("add_text_data.text")})})}),h.jsx(Dy,{children:e==null?void 0:e.map((n,r)=>h.jsx(js,{children:h.jsx(ul,{className:"p-4",children:n.text})},`${n.text}_${r}`))})]})}const V1e=g.memo(e=>{const{id:t}=e,{t:n}=Me("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),s=Rn(t),{createCSVData:c,loading:l}=A7(),u=()=>{a(p=>[...p,{text:o}]),i("")},d=async()=>{s&&await c(s,["text"],r.map(p=>[p.text]))};return h.jsxs(Gt,{className:"mw-full",children:[h.jsx(Mn,{children:h.jsx(Fn,{children:n("add_text_data.title")})}),h.jsxs(An,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(Be,{htmlFor:"name",children:n("add_text_data.text")}),h.jsx(ko,{value:o,onChange:p=>i(p.target.value||""),placeholder:n("add_text_data.text_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(Ye,{disabled:!o,onClick:u,className:"w-40",children:n("add_text_data.add")})}),h.jsx(U1e,{data:r||[]})]}),h.jsx(Ya,{className:"flex justify-between",children:h.jsx(Qn,{loading:l,disabled:!(r!=null&&r.length),onClick:d,className:"w-full",children:n("add_text_data.create")})})]})});var Vo=(e=>(e.ADD_LLM="ADD_LLM",e.ADD_PROMPT="ADD_PROMPT",e.ADD_TOOL_DEFINITION="ADD_TOOL_DEFINITION",e.ADD_SCHEMA="ADD_SCHEMA",e.ADD_FEW_SHOT_EXAMPLE="ADD_FEW_SHOT_EXAMPLE",e.ADD_VECTOR_DATABASE="ADD_VECTOR_DATABASE",e.ADD_TEXT_DATA="ADD_TEXT_DATA",e))(Vo||{});const W1e=["ADD_LLM","ADD_PROMPT","ADD_SCHEMA","ADD_VECTOR_DATABASE",{key:"more",label:"more",icon:"ellipsis",children:["ADD_TOOL_DEFINITION","ADD_FEW_SHOT_EXAMPLE"]}],H1e=()=>{const e="_coolMode_effect",t=document.getElementById(e);if(t)return t;const n=document.createElement("div");return n.setAttribute("id",e),n.setAttribute("style","overflow:hidden; position:fixed; height:100%; top:0; left:0; right:0; bottom:0; pointer-events:none; z-index:2147483647"),document.body.appendChild(n),n};let P7=0,T7,I7,R7,D7,L7,$7,zn,dt,F7,B7,z7,U7,Vy,qS,KS,ZS,V7,W7,Wy,GS,H7,q7,K7;T7=(e,t)=>{P7++;const n=(t==null?void 0:t.particle)||"circle",r=[15,20,25,35,45],a=45;let o=[],i=!1,s=0,c=0;const l=H1e();function u(){const S=(t==null?void 0:t.size)||r[Math.floor(Math.random()*r.length)],O=(t==null?void 0:t.speedHorz)||Math.random()*10,N=(t==null?void 0:t.speedUp)||Math.random()*25,M=Math.random()*360,k=Math.random()*35*(Math.random()<=.5?-1:1),A=c-S/2,P=s-S/2,C=Math.random()<=.5?-1:1,T=document.createElement("div");if(n==="circle"){const I="http://www.w3.org/2000/svg",R=document.createElementNS(I,"svg"),L=document.createElementNS(I,"circle");L.setAttributeNS(null,"cx",(S/2).toString()),L.setAttributeNS(null,"cy",(S/2).toString()),L.setAttributeNS(null,"r",(S/2).toString()),L.setAttributeNS(null,"fill",`hsl(${Math.random()*360}, 70%, 50%)`),R.appendChild(L),R.setAttribute("width",S.toString()),R.setAttribute("height",S.toString()),T.appendChild(R)}else T.innerHTML=`<img src="${n}" width="${S}" height="${S}" style="border-radius: 50%">`;T.style.position="absolute",T.style.transform=`translate3d(${P}px, ${A}px, 0px) rotate(${M}deg)`,l.appendChild(T),o.push({direction:C,element:T,left:P,size:S,speedHorz:O,speedUp:N,spinSpeed:k,spinVal:M,top:A})}function d(){o.forEach(S=>{S.left=S.left-S.speedHorz*S.direction,S.top=S.top-S.speedUp,S.speedUp=Math.min(S.size,S.speedUp-1),S.spinVal=S.spinVal+S.spinSpeed,S.top>=Math.max(window.innerHeight,document.body.clientHeight)+S.size&&(o=o.filter(O=>O!==S),S.element.remove()),S.element.setAttribute("style",["position:absolute","will-change:transform",`top:${S.top}px`,`left:${S.left}px`,`transform:rotate(${S.spinVal}deg)`].join(";"))})}let p,f=0;const m=30;function y(){const S=performance.now();i&&o.length<a&&S-f>m&&(u(),f=S),d(),p=requestAnimationFrame(y)}y();const v="ontouchstart"in window,b=v?"touchstart":"mousedown",w=v?"touchend":"mouseup",_=v?"touchmove":"mousemove",x=S=>{var O,N;"touches"in S?(s=(O=S.touches)==null?void 0:O[0].clientX,c=(N=S.touches)==null?void 0:N[0].clientY):(s=S.clientX,c=S.clientY)},j=S=>{x(S),i=!0},E=()=>{i=!1};return e.addEventListener(_,x,{passive:!0}),e.addEventListener(b,j,{passive:!0}),e.addEventListener(w,E,{passive:!0}),e.addEventListener("mouseleave",E,{passive:!0}),()=>{e.removeEventListener(_,x),e.removeEventListener(b,j),e.removeEventListener(w,E),e.removeEventListener("mouseleave",E);const S=setInterval(()=>{p&&o.length===0&&(cancelAnimationFrame(p),clearInterval(S),--P7===0&&l.remove())},500)}},I7=({children:e,options:t})=>{const n=g.useRef(null);return g.useEffect(()=>{if(n.current)return T7(n.current,t)},[t]),q.cloneElement(e,{ref:n})},R7=g.memo(e=>{const{t}=Me("flows"),n=eu(s=>s.theme),[r,a]=g.useState(`${Vo.ADD_LLM}`),o=g.useMemo(()=>h.jsxs(r7,{children:[h.jsx(IS,{children:h.jsx(I7,{children:h.jsx(Ye,{variant:"link",className:"!p-0 !pl-3",children:h.jsx(d3e,{width:32,height:32,className:Z(n==="dark"?"fill-white":"fill-black")})})})}),W1e.map(s=>typeof s=="object"?h.jsxs(IS,{children:[h.jsx(RS,{children:s.icon?h.jsx(pe,{name:s.icon}):t(`supported_nodes.${s.label}`)}),h.jsx(a7,{children:s.children.map(c=>h.jsx(o7,{onClick:()=>a(c),children:t(`supported_nodes.${c.toLowerCase()}`)},c))})]},s.key):h.jsx(IS,{children:h.jsx(RS,{value:s,onClick:()=>a(s),children:t(`supported_nodes.${s.toLowerCase()}`)})},s))]}),[t,n]),i=g.useMemo(()=>{switch(r){case Vo.ADD_LLM:return h.jsx(k1e,{...e});case Vo.ADD_PROMPT:return h.jsx(P1e,{...e});case Vo.ADD_SCHEMA:return h.jsx(I1e,{...e});case Vo.ADD_FEW_SHOT_EXAMPLE:return h.jsx(D1e,{...e});case Vo.ADD_TOOL_DEFINITION:return h.jsx($1e,{...e});case Vo.ADD_VECTOR_DATABASE:return h.jsx(z1e,{...e});case Vo.ADD_TEXT_DATA:return h.jsx(V1e,{...e})}},[e,r]);return h.jsxs(h.Fragment,{children:[o,h.jsx("div",{className:"mt-4",children:i})]})}),D7=()=>{const[e,t]=g.useState(!1),n=es(),r=Je(s=>s.currentSession),a=Je(s=>s.getLatestApplications),o=g.useCallback(async(s,c,l,u)=>{var f;const d=(f=c.data)==null?void 0:f.entity;let p=c.type?p3e[c.type]:void 0;if(p&&d&&c&&typeof d=="object"&&"id"in d&&!l.has(`${d.id}`)&&!u.has(`${c.id}`)){p=p;const m=await le(p).save({...d,...d&&typeof d=="object"&&"session_id"in d?{session_id:s.id}:{}});l.set(`${d.id}`,m.id);const y=await le("FlowNode").findOne({where:{id:c.data.flowNode.id}}),v=await le("FlowNode").save({...y||c.data.flowNode,session_id:s.id,id:void 0,source_type:p,source_id:m.id});return u.set(`${c.id}`,v.id),{entityName:p,entity:m,node:v}}else if(!u.has(`${c.id}`)){const m=await le("FlowNode").findOne({where:{id:c.data.flowNode.id}}),y=await le("FlowNode").save({...m||c.data.flowNode,node_type:c.type,session_id:s.id,id:void 0});return u.set(`${c.id}`,y.id),{node:y}}},[]),i=g.useCallback(async(s,c)=>{try{if(!r)throw new Error("No current session");t(!0);const l=await le("Session").save({type:Wi.StandaloneApp,name:c.name||(r!=null&&r.name?`${r.name}`:"Standalone"),status:f3e.Started,passphrase:r.passphrase});if(!l)throw new Error("Failed create standalone session");const u=new Map,d=new Map,p=await o(l,s,u,d);if(!p)throw new Error("Failed to clone main node");await le("Session").update(l.id,{main_node_id:p.node.id,main_source_id:p!=null&&p.entity?p.entity.id:void 0,main_source_type:p.entityName?p.entityName:void 0});for(const{node:f,connectedNodes:m}of c.connections)if(await o(l,f,u,d),m)for(const y of m)await o(l,y,u,d);for(const{connections:f}of c.connections)for(const m of f){const y=d.get(`${m.source}`),v=d.get(`${m.target}`);if(!y||!v)throw new Error("Failed to get connected flow node id");await le("FlowEdge").save({source:y,target:v,sourceHandle:m.sourceHandle,targetHandle:m.targetHandle,session_id:l.id})}return a(),n(dn("application",{applicationId:l.id})),!0}finally{t(!1)}},[o,r,a,n]);return{loading:e,createStandaloneSession:i}},L7=()=>{const[e,t]=g.useState(!1),n=Ie(o=>o.updateNodes),r=Ie(o=>o.updateEdges),a=g.useCallback(async o=>{try{t(!0),await le("FlowNode").delete(o);const i=await le("FlowEdge").find({where:[{source:o},{target:o}]});return await Promise.all(i.map(s=>le("FlowEdge").delete(s.id))),await n([{id:o,type:"remove"}]),await r(i.map(s=>({id:s.id,type:"remove"}))),!0}catch{return!1}finally{t(!1)}},[r,n]);return{loading:e,deleteNodeFlow:a}},$7=po(({cloneStandaloneSession:e})=>{const t=tn(),{t:n}=Me("dialogs"),[r,a]=g.useState(""),{toast:o}=nn(),i=c=>{a(c.target.value)},s=async()=>{try{t.hide(),await e(r),a("")}catch{o({variant:"destructive",description:n("create_standalone_application.errors.create_failed")})}};return h.jsx(hi,{open:t.visible,onOpenChange:t.hide,children:h.jsxs(xo,{className:"sm:max-w-[425px]",children:[h.jsxs(_o,{children:[h.jsx(jo,{children:n("create_session.title")}),h.jsx($u,{children:n("create_standalone_application.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(Be,{className:"mb-2",htmlFor:"name",children:n("create_standalone_application.name")}),h.jsx(Kt,{onChange:i,id:"name",value:r,placeholder:n("create_standalone_application.name_placeholder")})]})}),h.jsx(Lu,{children:h.jsx(Ye,{onClick:s,disabled:!r,type:"submit",children:n("create_standalone_application.create")})})]})})}),zn=g.memo(({id:e,className:t,enableToStandalone:n,getLinkedConnections:r})=>{const{t:a}=Me("common"),{getNode:o}=tr(),{loading:i,deleteNodeFlow:s}=L7(),{createStandaloneSession:c}=D7(),{toast:l}=nn(),u=tn($7),d=g.useCallback(async()=>{try{await s(e),l({description:a("deleted")})}catch{l({description:a("errors.delete_failed"),variant:"destructive"})}},[s,e,l,a]),p=g.useCallback(async m=>{try{const y=o(e);if(!y)throw new Error("No current node");const v=(r==null?void 0:r(e))||[];await c(y,{name:m,connections:v}),l({description:a("standalone_session_created")})}catch(y){Hs(y),l({description:a("errors.create_standalone_session_failed"),variant:"destructive"})}},[o,e,r,c,l,a]),f=g.useCallback(()=>{u.show({cloneStandaloneSession:p})},[p,u]);return h.jsxs("div",{className:Z("flex absolute z-[51] right-0 top-0 h-10",t),children:[n?h.jsx(Ye,{className:"!rounded-none !px-2",onClick:f,variant:"ghost",children:h.jsx(pe,{name:"package-plus",size:16})}):void 0,h.jsx(Qn,{loading:i,className:"!rounded-none !px-2",onClick:d,variant:"ghost",children:h.jsx(pe,{name:"trash-2",size:16})})]})}),dt=g.memo(e=>{const{className:t,...n}=e;return h.jsx(Sd,{className:Z("!w-2 !h-2 !border-none !rounded-full !bg-slate-700",e.position===he.Top?"!top-[-2px]":"",t),...n})}),F7=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ie(i=>i.createOrUpdateFlowNode),a=Ie(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async i=>{var s,c;n(!0);try{const l=(s=i.data)==null?void 0:s.entity;if(!l||!e)throw new Error("LLM or Session not found");const u=i.position.x,d=i.position.y+(((c=i.measured)==null?void 0:c.height)||0),p=await le("Thread").save({initial_llm_id:l.id,title:`New thread with ${l.name}`,status:kf.Started,messages:[],session_id:e}),f=await r({source_id:p.id,source_type:"Thread",node_type:ie.Thread,x:u,y:d+60});if(!f)throw new Error("Failed to create thread node");const m=await a({source:i.id,target:f.id});return{thread:p,flowNode:f,flowEdge:m}}finally{n(!1)}},[a,r,e]);return{loading:t,createThread:o}},B7=(e,t)=>{var _;const{t:n}=Me("flows"),{toast:r}=nn(),[a,o]=g.useState(!1),[i,s]=g.useState(!1),c=Rn(e),{loadModel:l}=Cm(),{createThread:u,loading:d}=F7(),p=Ie(x=>x.updateNodes),f=Ie(x=>x.pushSyncNodeQueue),{getNodes:m}=tr(),y=g.useCallback(async()=>{try{if(s(!0),t.entity.id){const x=await le("Thread").find({where:{initial_llm_id:t.entity.id}});f("Thread",{where:{source_type:"Thread",source_id:Ka(x.map(j=>j.id))}})}}finally{s(!1)}},[(_=t==null?void 0:t.entity)==null?void 0:_.id,f]),v=g.useCallback(async()=>{try{if(o(!0),t.entity&&c){await(l==null?void 0:l(t.entity.provider,`${t.entity.name}`,j=>{c.data.status=j.progress===100?et.Loaded:et.Loading,c.data.label=j.text,p([{id:e,type:"replace",item:c}])}));const x=m().filter(j=>j.type===ie.LLM?j.data.entity.provider===Ve.WebLLM:!1).map(j=>(j.data.status=et.Started,{id:j.id,type:"replace",item:j}));c.data.label="",c.data.status=et.Loaded,x.push({id:e,type:"replace",item:c}),p(x),await y()}}catch(x){ni(x),r({variant:"destructive",description:n("llm_node.errors.loading_model")})}finally{o(!1)}},[t.entity,m,e,l,c,y,n,r,p]),b=g.useCallback(async()=>{t.entity&&c&&await(u==null?void 0:u(c))},[t.entity,c,u]),w=g.useCallback(async x=>{t.entity&&c&&(c.data.entity.options=x,await le("LLM").update(t.entity.id,{options:x}),p([{id:e,type:"replace",item:c}]))},[t.entity,e,c,p]);return g.useEffect(()=>{t.entity&&c&&t.entity.status!==t.status&&(c.data.status=t.entity.status,p([{id:e,type:"replace",item:c}]))},[]),{loadingModel:a,creatingThread:d,queringThreads:i,changeLLMOptions:w,loadModel:v,createThread:b,queryThreads:y}},Hn=(e,t)=>{const[n,r]=g.useState(!1),[a,o]=g.useState([]),{deleteElements:i,getNode:s}=tr();wm({type:"target",nodeId:e,onConnect:l=>{l!=null&&l.length&&o(u=>[...u,...Cpe(l)])}});const c=g.useCallback(async(l,u,d,p)=>{try{return await t({id:e,edgeId:l,source:u,target:d,connection:p})}catch{return{deleteEdgeId:l}}},[t,e]);g.useEffect(()=>{!(a!=null&&a.length)||n||(async()=>{try{r(!0);const l=[...a];o([]);const u=[],d=s(e);await Promise.all(l.map(async p=>{const f="edgeId"in p?p.edgeId:void 0,m=s(p.source);if(!m||!d)return;const y=await c(`${f}`,m,d,p);y!=null&&y.deleteEdgeId&&u.push(...Array.isArray(y.deleteEdgeId)?y.deleteEdgeId:[y.deleteEdgeId])})),u!=null&&u.length&&await i({edges:u.map(p=>({id:p}))})}finally{r(!1)}})()},[i,s,e,n,c,a])},z7=e=>{const t=g.useCallback(async()=>{},[]);Hn(e,t)},U7=g.memo(e=>{var b,w,_,x,j,E;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(),{t:i}=Me("flows"),{createThread:s,loadModel:c,queringThreads:l,queryThreads:u,loadingModel:d,changeLLMOptions:p}=B7(t,n);z7(t);const f=[et.Loading,et.Downloading].includes(n.status);g.useEffect(()=>{var S,O,N,M,k;if(!(a||!((S=n==null?void 0:n.entity)!=null&&S.name))){if(((O=n==null?void 0:n.entity)==null?void 0:O.provider)!==Ve.WebLLM){o({hasCache:!1,cloud:!0,isFunctionCalling:!0,info:{model_id:(N=n==null?void 0:n.entity)==null?void 0:N.name,model:(M=n==null?void 0:n.entity)==null?void 0:M.name,model_lib:(k=n==null?void 0:n.entity)==null?void 0:k.provider,model_type:2}});return}qt(()=>import("./index-C6S3C89h.js").then(async A=>(await A.__tla,A)),__vite__mapDeps([9,1,2,3,4])).then(async({hasModelInCache:A,functionCallingModelIds:P,prebuiltAppConfig:C})=>{var I,R;const T=await A((I=n==null?void 0:n.entity)==null?void 0:I.name);o({hasCache:T,isFunctionCalling:P.includes((R=n==null?void 0:n.entity)==null?void 0:R.name),info:C.model_list.find(L=>{var D;return L.model_id===((D=n==null?void 0:n.entity)==null?void 0:D.name)})})})}},[(b=n==null?void 0:n.entity)==null?void 0:b.name,(w=n==null?void 0:n.entity)==null?void 0:w.provider,a]);const m=g.useCallback(async S=>{await p(S)},[p]),y=g.useMemo(()=>{var S,O;switch(n.status){case et.Downloading:return h.jsx(pe,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case et.Loaded:return h.jsx(Tr,{name:((S=n.entity)==null?void 0:S.name)||"brain",className:"w-7 h-7"});case et.Loading:return h.jsx(pe,{className:"animate-spin w-7 h-7",name:"loader-circle"});default:return h.jsx(Tr,{name:((O=n.entity)==null?void 0:O.name)||"brain",className:"w-7 h-7"})}},[(_=n.entity)==null?void 0:_.name,n.status]),v=g.useMemo(()=>f?null:d?h.jsx(Ye,{disabled:!0,className:"w-full mt-4",children:h.jsx(pe,{className:"animate-spin",size:24,name:"loader-circle"})}):n.status===et.Loaded?h.jsx(Ye,{onClick:s,className:"mt-4 w-full",children:i("llm_node.create_thread_button")}):h.jsxs("div",{className:"flex gap-2 mt-4",children:[a!=null&&a.hasCache?h.jsx(Qn,{loading:l,onClick:u,children:h.jsx(pe,{size:24,name:"message-square-more"})}):null,h.jsx(Ye,{disabled:d,onClick:c,className:"w-full",children:i(a!=null&&a.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")})]}),[f,d,n.status,a==null?void 0:a.hasCache,l,u,c,i,s]);return h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(zn,{id:t}),h.jsxs(Er,{className:"flex justify-center",children:[y,h.jsxs("div",{className:"ml-2 pt-1 max-w-lg",children:[h.jsx(Uo,{className:"flex gap-2 items-center pr-6",children:`${((x=n==null?void 0:n.entity)==null?void 0:x.name)||""}`}),h.jsx(cl,{className:"max-w-full",children:`${n.label||""}`}),h.jsx("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:h.jsx(ip,{model:a==null?void 0:a.info,isFunctionCalling:(a==null?void 0:a.isFunctionCalling)||!1,name:(j=n==null?void 0:n.entity)==null?void 0:j.name,isCached:(a==null?void 0:a.hasCache)||!1,cloud:(a==null?void 0:a.cloud)||!1})}),h.jsx(F9,{options:(E=n==null?void 0:n.entity)==null?void 0:E.options,onChangeOptions:m,className:"mt-2"}),v]})]}),f?h.jsx(gS,{className:"rounded-lg"}):void 0]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),Vy=g.memo(({tags:e,disabled:t,loading:n,onSubmit:r})=>{const{t:a}=Me("components"),o=async i=>{try{return await r(i),!0}catch{return!1}};return h.jsxs(Gt,{className:"min-w-80",children:[h.jsx(Mn,{children:h.jsx(Fn,{children:a("add_message_card.title")})}),h.jsxs(An,{children:[h.jsx("div",{className:"grid w-full gap-1.5",children:h.jsx(_0,{onSubmit:o,disabled:t||n,placeholder:a("add_message_card.placeholder")})}),e?h.jsx("div",{className:"mt-2 gap-1 flex flex-wrap",children:e}):null]})]})}),qS=(e,t,n,r=[],a)=>{const o=e.map(i=>a.getNode(i));for(const i of o){if(!i)continue;const s=a.getHandleConnections({type:"target",nodeId:i.id});if(n.push(...s),i.type===ie.Thread){r.push(i.id),t.push(i);continue}else if(i.type!==ie.Message){r.push(i.id);continue}else if(r.includes(i.id))continue;r.push(i.id),t.push(i),s.length&&qS(s.map(c=>c.source),t,n,r,a)}return{nodes:t,connections:n}},KS=(e,t)=>{const n=t.getHandleConnections({nodeId:e.id,type:"target"}),r=n.map(d=>{const p=t.getNode(d.source);return p?{connections:t.getHandleConnections({nodeId:p.id,type:"target"}),node:p}:void 0}),a=r.filter(d=>{var p;return((p=d.node)==null?void 0:p.type)===ie.Prompt}),o=[];a!=null&&a.length&&a.forEach(d=>{var f;const p=(f=d.connections)==null?void 0:f.map(m=>t.getNode(m.source)).filter(Boolean);o.push({node:d.node,connections:d.connections,connectedNodes:p})});const i=r.filter(d=>{var p;return((p=d.node)==null?void 0:p.type)===ie.ToolDefinition}),s=[];i!=null&&i.length&&i.forEach(d=>{var f;const p=(f=d.connections)==null?void 0:f.map(m=>t.getNode(m.source)).filter(Boolean);p!=null&&p.find(m=>m.type===ie.Schema)&&s.push({node:d.node,connections:d.connections,connectedNodes:p})});const c=r.filter(d=>{var p;return((p=d.node)==null?void 0:p.type)===ie.PlaceHolder}),l=[];c!=null&&c.length&&c.forEach(d=>{var f;const p=(f=d.connections)==null?void 0:f.map(m=>t.getNode(m.source)).filter(Boolean);p&&l.push({node:d.node,connections:d.connections,connectedNodes:p})});const u=r.find(d=>{var p;return((p=d.node)==null?void 0:p.type)===ie.Schema});return{thread:{node:e,connections:n},llm:r.find(d=>{var p;return((p=d.node)==null?void 0:p.type)===ie.LLM}),schemas:u?[u]:[],prompts:o,tools:s,placeholders:l}},ZS=e=>{const t=[];return e.forEach(n=>{var o,i,s;const{node:r,connectedNodes:a}=n;if((o=r.data)!=null&&o.entity){if(r.type===ie.Message){const c=r.data.entity;switch(c.role){case"human":t.push(new Vr(c.content));break;case"ai":t.push(new Ta(c.content));break}}else if(r.type===ie.Prompt){const c=r.data.entity;let l=`${c.prefix?`${c.prefix}
`:""}`;if(c.type===mr.FewShotExample){const u=(s=(i=a.find(d=>d.type===ie.CSVData))==null?void 0:i.data)==null?void 0:s.entity;if(u){const{rows:d}=tX(u.headers,u.csv);d.forEach(p=>{l+=`${c.content.replace(/{([^{}]*)}/g,(f,m)=>`${p[m]}`)}
`})}}else l+=c.content;switch(c.suffix&&(l+=`
${c.suffix}`),c.role){case"human":t.push(new Vr(l));break;case"system":t.push(new Pv(l));break;default:t.push(new Ta(l));break}}}}),t},V7=(e,t)=>{const n=(e==null?void 0:e.filter(a=>a.type===ie.Message).map(a=>({node:a,connectedNodes:[]})).reverse())||[],r=[];return t.forEach(async a=>{r.unshift({node:a.node,connectedNodes:a.connectedNodes||[]})}),{history:ZS(n),systems:ZS(r)}},W7=e=>e?e.reduce((t,n)=>{var o,i,s,c,l;const r=(o=n.node.data)==null?void 0:o.entity,a=(c=(s=(i=n==null?void 0:n.connectedNodes)==null?void 0:i.find(u=>u.type===ie.Schema))==null?void 0:s.data)==null?void 0:c.entity;return r&&((l=a==null?void 0:a.schema_items)!=null&&l.length)&&t.push({name:r.name,description:r.description,schemaItems:a.schema_items}),t},[]):[],Wy=()=>{const{getNodes:e}=tr(),t=g.useCallback(()=>e().find(r=>r.type===ie.DefaultEmbeddingModel),[e]),n=g.useCallback(()=>{var r,a;return(a=(r=t())==null?void 0:r.data)==null?void 0:a.entity},[t]);return{getFlowEmbeddingNode:t,getFlowEmbeddingEntity:n}},GS=({getNode:e,getHandleConnections:t})=>{const{t:n}=Me("create_new_message"),[r,a]=g.useState(!1),o=Je(y=>y.currentSession),i=Ie(y=>y.createOrUpdateFlowNode),s=Ie(y=>y.createOrUpdateFlowEdge),{similaritySearchWithScore:c}=ap(),{getFlowEmbeddingEntity:l}=Wy(),{stream:u}=nl(),d=g.useCallback(async({content:y,threadId:v,sourceId:b,initialX:w,initialY:_,initialLLMId:x})=>{if(!o)throw new Error("Session is not found");const j=await le("Message").save({thread_id:v,content:y,role:hr.Human,status:Kr.Started,llm_id:x,session_id:o.id});if(!j)throw new Error("Failed to save message");const E=await i({source_id:j.id,source_type:"Message",node_type:ie.Message,x:w,y:_+80});if(!E)throw new Error("Failed to save human message node");await s({source:b,target:E.id});const S=await le("Message").save({thread_id:v,content:n("initial_ai_message"),role:hr.AI,status:Kr.Inprogress,llm_id:x,parent_message_id:j.id,session_id:o.id});if(!S)throw new Error("Failed to save message");const O=await i({source_id:S.id,source_type:"Message",node_type:ie.Message,x:w,y:_+250});if(!O)throw new Error("Failed to save ai message node");return await s({source:E.id,target:O.id}),{aiMessage:S,humanMessage:j,aiMessageNode:O,humanMessageNode:E}},[s,i,o,n]),p=g.useCallback(async(y,v)=>{const{placeholders:b}=v;if(!(b!=null&&b.length))return[];const w=[];return await Promise.all(b.map(async _=>{var j,E,S,O,N,M,k,A,P,C,T,I;const x=(j=_.node.data)==null?void 0:j.entity;if(x)switch(x.placeholder_type){case Xi.VECTOR_DATABASE_RETREIVER:{const R=(E=_.connectedNodes)==null?void 0:E.find(F=>F.type===ie.VectorDatabase),L=(S=R==null?void 0:R.data)==null?void 0:S.entity,D=(M=(N=(O=_.connectedNodes)==null?void 0:O.find(F=>F.type===ie.Prompt))==null?void 0:N.data)==null?void 0:M.entity;if(!D||!L||!R)return;const z=(k=x.metadata)!=null&&k.k?+((A=x.metadata)==null?void 0:A.k):1;let U=(P=x.metadata)!=null&&P.minimalScore?+((C=x.metadata)==null?void 0:C.minimalScore):void 0;U&&U>1&&(U=U/100);const $=[];if(L.storage===Wr.DataNode){const F=(I=(T=t({nodeId:R.id,type:"target"}).map(W=>e(W.source)).find(W=>(W==null?void 0:W.type)&&[ie.JSONLData,ie.CSVData].includes(W==null?void 0:W.type)))==null?void 0:T.data)==null?void 0:I.entity;if(!F)return;$.push(...await c(l(),{database:{databaseId:L.id,dataSourceId:F.id,dataSourceType:Zk(F)}},y.humanMessage.content,z)||[])}else $.push(...await c(l(),{database:{databaseId:L.id}},y.humanMessage.content,z)||[]);if(!$)return[];const V=new ii({template:D.content,inputVariables:["context"]});w.push(new Ta(await V.format({context:U?$.filter(([,F])=>F>=U).map(([F])=>F.pageContent).join(`
`):$.map(([F])=>F.pageContent).join(`
`)})))}}})),w},[l,t,e,c]),f=g.useCallback(async(y,v,b,{onMessageUpdate:w})=>{var I;const{prompts:_,tools:x,schemas:j,placeholders:E,llm:S}=v,O=(I=S==null?void 0:S.node.data)==null?void 0:I.entity;if(!O)throw new Error("LLM is not found");const N=[];E!=null&&E.length&&N.push(...await p(y,v));const{history:M,systems:k}=V7(b,_),A=[...k,...N,...M,new Vr(y.humanMessage.content)],P=j.map(R=>{var L;return(L=R.node.data)==null?void 0:L.entity}).filter(Boolean),{lastChunk:C,content:T}=await u(O.provider,A,{tools:W7(x),schemas:P,llm:O,onMessageUpdate:({content:R})=>{w==null||w({id:y.aiMessageNode.id,nodeData:{loading:!0,content:R}})}});return y.aiMessage.content=T,y.aiMessage.metadata=JSON.stringify({message:C}),w==null||w({id:y.aiMessageNode.id,nodeData:{content:T,loading:!1,entity:y.aiMessage}}),y.aiMessage.id&&await le("Message").update(y.aiMessage.id,{content:T,metadata:JSON.stringify({message:C})}),T},[p,u]),m=g.useCallback(async(y,v,b)=>{var S,O,N;const{nodes:w}=qS([y.id],[],[],[],{getNode:e,getHandleConnections:t}),_=w.find(M=>M.type===ie.Thread),x=_==null?void 0:_.data.entity;if(!y||!x||!_)throw new Error("Source or thread is not found");const j=KS(_,{getNode:e,getHandleConnections:t});if(!(j!=null&&j.thread))throw new Error("Thread node is not found");let E;try{a(!0);const M=((S=y.position)==null?void 0:S.x)||0,k=(((O=y.position)==null?void 0:O.y)||0)+(((N=y.measured)==null?void 0:N.height)||0);return E=await d({content:v,initialX:M,initialY:k,sourceId:y.id,threadId:x.id,initialLLMId:x.initial_llm_id}),await f(E,j,w,b),await le("Message").update(`${E.aiMessage.id}`,{status:Kr.Success}),E.aiMessage.status=Kr.Success,b.onMessageUpdate({id:E.aiMessageNode.id,nodeData:{entity:E.aiMessage,loading:!1}}),!0}catch(M){Hs(M),E!=null&&E.aiMessage&&await le("Message").update(`${E.aiMessage.id}`,{status:Kr.Failed,content:n("errors.ai_message_content_failed")}),E!=null&&E.aiMessageNode.id&&(b==null||b.onMessageUpdate({id:E.aiMessageNode.id,nodeData:{content:n("errors.ai_message_content_failed"),entity:{...E.aiMessage,status:Kr.Failed,content:n("errors.ai_message_content_failed")},loading:!1}}))}finally{a(!1)}},[t,e,d,f,n]);return{loading:r,createMessage:m}},H7=(e,t)=>{const n=Rn(e),{t:r}=Me("flows"),{getNode:a,getHandleConnections:o}=tr(),i=Ie(p=>p.updateNodes),{createMessage:s,loading:c}=GS({getNode:a,getHandleConnections:o}),l=g.useCallback(p=>{if(!p.id)return;const f=a(p.id);!f||!p.nodeData||i([{id:f.id,type:"replace",item:{...f,data:{...f.data,...rd(p.nodeData,ad)}}}])},[a,i]),u=g.useCallback(async p=>{if(n&&t.entity)try{await s(n,p,{onMessageUpdate:l})}catch(f){if(f instanceof Error&&f.message.includes("LLM_NOT_LOADED_YET"))return au({variant:"destructive",title:r("thread_node.errors.llm_not_loaded_yet")});au({variant:"destructive",title:`${f}`})}},[n,t.entity,s,l,r]),d=g.useCallback(p=>{const f=a(p);if(!f)return[];const m=[],y=KS(f,{getNode:a,getHandleConnections:o});return y.thread&&m.push({node:y.thread.node,connectedNodes:[],connections:y.thread.connections}),y.prompts&&m.push(...y.prompts.map(v=>({node:v.node,connectedNodes:v.connectedNodes,connections:v.connections}))),y.schemas&&m.push(...y.schemas.map(v=>({node:v.node,connectedNodes:[],connections:v.connections}))),y.placeholders&&y.placeholders.forEach(v=>{const b=v.connections.map(w=>a(w.source)).filter(Boolean);m.push({node:v.node,connectedNodes:b||[],connections:v.connections})}),y.llm&&m.push(y.llm),m},[o,a]);return{loading:c,createMessage:u,getLinkedConnections:d}},q7=e=>{const t=Ie(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ie.Prompt&&(o==null?void 0:o.type)===ie.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ie.LLM&&(o==null?void 0:o.type)===ie.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ie.Schema&&(o==null?void 0:o.type)===ie.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ie.ToolDefinition&&(o==null?void 0:o.type)===ie.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ie.VectorDatabase&&(o==null?void 0:o.type)===ie.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ie.PlaceHolder&&(o==null?void 0:o.type)===ie.Thread&&a.data.entity.placeholder_type===Xi.VECTOR_DATABASE_RETREIVER){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Hn(e,n)},K7=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e,{t:a}=Me("flows"),[o,i]=g.useState(!1),s=wm({type:"source"}),c=wm({type:"target"}),{getNode:l}=tr(),{loading:u,createMessage:d,getLinkedConnections:p}=H7(t,n);q7(t);const f=g.useCallback(async(...b)=>(i(!1),await d(...b)),[d]),m=g.useMemo(()=>s.length>0,[s]),y=g.useCallback(()=>{i(b=>!b)},[]),v=g.useMemo(()=>{var w,_;const b=c.map((x,j)=>{var S;const E=l(x.source);if((E==null?void 0:E.type)===ie.Schema)return h.jsx(wn,{children:a("thread_node.structured_output")},`${j}`);if((E==null?void 0:E.type)===ie.Prompt){const O=E.data.entity;return h.jsx(wn,{children:a(O.type===mr.FewShotExample?"thread_node.prompts.few_shot_example":`thread_node.prompts.${O.role.toLowerCase()}`)},`${j}`)}else if((E==null?void 0:E.type)===ie.PlaceHolder&&((S=E.data.entity)==null?void 0:S.placeholder_type)===Xi.VECTOR_DATABASE_RETREIVER)return h.jsx(wn,{children:a("thread_node.vector_database_retriever")},`${j}`)}).filter(Boolean);return e.data.entity&&!((_=(w=e.data.entity)==null?void 0:w.messages)!=null&&_.length)&&!m?h.jsx(Vy,{disabled:u,loading:u,onSubmit:f,tags:b}):b!=null&&b.length?h.jsxs(Gt,{className:"p-4 pt-2",children:[h.jsx(Fn,{className:"mb-2",children:a("thread_node.title")}),h.jsx("div",{className:"flex gap-1.5",children:b}),h.jsx("div",{className:"mt-4 w-full flex justify-end",children:h.jsxs(Ye,{onClick:y,variant:"outline",children:[h.jsx(pe,{name:o?"copy-minus":"copy-plus"}),a(o?"thread_node.hide":"thread_node.clone")]})})]}):h.jsx("div",{className:"w-12 h-10"})},[m,l,f,y,u,e.data.entity,o,a,c]);return h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(zn,{id:t,enableToStandalone:!0,getLinkedConnections:p}),v,o?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(Vy,{disabled:u,loading:u,onSubmit:f})})})]}):void 0]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})});function q1e({data:e,onNewThread:t,loading:n,showThread:r}){var o;const{t:a}=Me("flows");return h.jsxs(Er,{className:"flex min-w-52",children:[h.jsx(pe,{size:24,name:"user"}),h.jsxs("div",{className:"ml-2 max-w-full w-full",children:[h.jsx(Uo,{children:"Human"}),h.jsx(cl,{children:`${e.content||((o=e.entity)==null?void 0:o.content)||""}`}),t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(Ye,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(pe,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]})]})}function K1e({data:e,onNewThread:t,loading:n,showThread:r}){var c,l,u,d,p,f,m,y,v;const{t:a}=Me("flows"),o=g.useMemo(()=>{var b;try{return JSON.parse(((b=e==null?void 0:e.entity)==null?void 0:b.metadata)||"{}")}catch{return{}}},[(c=e==null?void 0:e.entity)==null?void 0:c.metadata]),i=e.entity.status===Kr.Failed,s=g.useMemo(()=>{var b;return h.jsx(LE,{source:`${e.content||((b=e.entity)==null?void 0:b.content)||""}`})},[e.content,(l=e.entity)==null?void 0:l.content]);return h.jsxs(Er,{className:Z("flex min-w-52",i?"bg-background":""),variant:i?"destructive":"default",children:[h.jsx(pe,{className:Z(e.loading?"animate-spin":void 0),size:24,name:e.loading?"loader-circle":"bot"}),h.jsx(pe,{name:r?"minus":"plus",size:24}),h.jsxs("div",{className:"ml-2 w-full max-w-full",children:[h.jsx(Uo,{children:a(`message_node.message_roles.${(d=(u=e.entity)==null?void 0:u.role)==null?void 0:d.toLowerCase()}`)}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(pe,{name:"loader-circle",className:"animate-spin"})}),children:i?e.content||((p=e.entity)==null?void 0:p.content)||"":s}),Array.isArray((f=o==null?void 0:o.message)==null?void 0:f.tool_calls)&&((y=(m=o==null?void 0:o.message)==null?void 0:m.tool_calls)!=null&&y.length)?(v=o==null?void 0:o.message)==null?void 0:v.tool_calls.map((b,w)=>h.jsx(wn,{children:a("message_node.tool_call",{name:b.name,args:Object.entries(b.args).map(([_,x])=>`"${_}": "${x}"`).join(", ")})},`${b.name}_${w}`)):null,t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(Ye,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(pe,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]}),e.loading?h.jsx(gS,{size:350,duration:10}):void 0]})}const Z1e=e=>{const{t}=Me("flows"),n=Rn(e),r=Ie(u=>u.updateNodes),{getNode:a,getHandleConnections:o}=tr(),{createMessage:i,loading:s}=GS({getNode:a,getHandleConnections:o}),c=g.useCallback(u=>{if(!u.id)return;const d=a(u.id);!d||!u.nodeData||r([{id:d.id,type:"replace",item:{...d,data:{...d.data,...rd(u.nodeData,ad)}}}])},[a,r]),l=g.useCallback(async u=>{if(n)try{await i(n,u,{onMessageUpdate:c})}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return au({variant:"destructive",title:t("message_node.errors.llm_not_loaded_yet")});au({variant:"destructive",title:t("message_node.errors.create_message")})}},[n,t,i,c]);return{loading:s,createMessage:l}},Z7=()=>{const e=Je(r=>r.currentSession),t=Ie(r=>r.createOrUpdateFlowNode),n=Ie(r=>r.createOrUpdateFlowEdge);return{createIdieMessage:g.useCallback(async(r,a,o,i)=>{var m,y,v,b,w;if(!r||!a||!e)return;const s=(y=(m=i==null?void 0:i.promptNode)==null?void 0:m.data)==null?void 0:y.entity,c=((v=r.position)==null?void 0:v.x)||0,l=(((b=r.position)==null?void 0:b.y)||0)+(((w=r.measured)==null?void 0:w.height)||0),u=await le("Message").save({thread_id:a.id,content:o,role:(s==null?void 0:s.role)||hr.Human,status:Kr.Started,llm_id:a.initial_llm_id,session_id:e.id});if(!u)throw new Error("Failed to save message");const d=await t({source_id:u.id,source_type:"Message",node_type:ie.Message,x:c,y:l});if(!d)throw new Error("Failed to save message node");const p=await n({source:r.id,target:d.id});let f;return i!=null&&i.promptNode&&(f=await n({source:i==null?void 0:i.promptNode.id,target:d.id})),{message:u,edgeToPrompt:f,messageNode:d,messageEdge:p}},[t,n])}},G1e=e=>{const{createIdieMessage:t}=Z7(),n=g.useCallback(async({edgeId:r,source:a,target:o})=>{var i,s;try{if((a==null?void 0:a.type)===ie.Prompt&&(o==null?void 0:o.type)===ie.Message){const c=(i=o==null?void 0:o.data)==null?void 0:i.entity,l=(s=a==null?void 0:a.data)==null?void 0:s.entity;if(!l||!c||!o)return{deleteEdgeId:r};await t(o,{id:c==null?void 0:c.thread_id,title:"",status:kf.Started,initial_llm_id:c.llm_id,session_id:l.session_id},l.content,{promptNode:a});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Hn(e,n)},X1e=g.memo(e=>{var _,x,j;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(!1),[i,s]=g.useState(!1),{t:c}=Me("common"),l=wm({type:"source"}),{loading:u,createMessage:d}=Z1e(t),{toast:p}=nn();G1e(t);const f=g.useCallback(async(...E)=>{const S=await d(...E);return o(!1),S},[d]),m=g.useMemo(()=>l.length===0,[l]),y=g.useCallback(()=>{var E;(E=n.entity)!=null&&E.content&&(navigator.clipboard.writeText(n.entity.content),p({description:c("copied")}))},[p,n,c]),v=g.useCallback(async()=>{var E;try{if(i)return await Kk.stop(),s(!1);s(!0),await Kk.speak(((E=n.entity)==null?void 0:E.content)||"")}catch{p({variant:"destructive",description:c("errors.speech_is_not_supported")})}finally{s(!1)}},[(_=n.entity)==null?void 0:_.content,i,c,p]),b=g.useCallback(()=>{o(E=>!E)},[]),w=g.useMemo(()=>{var E;if(!(!m&&!a||n.loading||u||((E=n==null?void 0:n.entity)==null?void 0:E.status)==="inprogress"))return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(Vy,{disabled:u,loading:u,onSubmit:f})})})]})},[(x=n==null?void 0:n.entity)==null?void 0:x.status,n.loading,f,m,u,a]);return h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{className:"max-w-sm min-w-64",children:[h.jsxs("div",{className:"w-auto",children:[h.jsx(zn,{id:t}),h.jsx("div",{children:((j=n.entity)==null?void 0:j.role)===hr.Human?h.jsx(q1e,{data:n,showThread:a,onNewThread:m?void 0:b}):h.jsx(K1e,{data:n,showThread:a,loading:u,onNewThread:m?void 0:b})}),h.jsx(Ye,{onClick:v,className:"absolute top-0 right-[68px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(pe,{name:i?"circle-stop":"speech",size:16})}),h.jsx(Ye,{onClick:y,className:"absolute top-0 right-[36px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(pe,{name:"copy",size:16})})]}),w]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),J1e=e=>{const t=Ie(a=>a.createOrUpdateFlowEdge),{createIdieMessage:n}=Z7(),r=g.useCallback(async({edgeId:a,source:o,target:i})=>{var s,c,l,u;try{const d=(s=i==null?void 0:i.data)==null?void 0:s.entity,p=(c=o==null?void 0:o.data)==null?void 0:c.entity;if((o==null?void 0:o.type)===ie.Message&&(i==null?void 0:i.type)===ie.Prompt){const f=(l=o==null?void 0:o.data)==null?void 0:l.entity,m=(u=i==null?void 0:i.data)==null?void 0:u.entity;if(!m||!f||!i)return{deleteEdgeId:a};await n(o,{id:f==null?void 0:f.thread_id,title:"",status:kf.Started,initial_llm_id:f.llm_id,session_id:m.session_id},m.content,{promptNode:i});return}else if((o==null?void 0:o.type)===ie.CSVData&&(i==null?void 0:i.type)===ie.Prompt&&(d==null?void 0:d.type)===mr.FewShotExample&&(p!=null&&p.headers.includes("input"))&&(p!=null&&p.headers.includes("output"))){await t({source:o.id,target:i.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[n,t]);Hn(e,r)},Y1e=g.memo(e=>{var l,u,d;const{id:t,data:n,isConnectable:r}=e;J1e(t);const a=tn(az),o=g.useMemo(()=>{var p,f,m;return`${(p=n.entity)!=null&&p.prefix?`${(f=n.entity)==null?void 0:f.prefix}
`:""}${((m=n.entity)==null?void 0:m.content)||""}`},[(l=n.entity)==null?void 0:l.prefix,(u=n.entity)==null?void 0:u.content]),i=g.useMemo(()=>{var f;const p=/{(.*?)}/g;return((f=o.match(p))==null?void 0:f.map(m=>m.replace("{","").replace("}","")))||[]},[o]),s=o.length>990,c=()=>{a.show({title:"Prompt",content:o})};return h.jsxs("div",{className:"min-w-56",children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(zn,{id:t}),h.jsxs(Er,{className:"flex justify-center max-w-72",variant:"default",children:[h.jsx(pe,{size:24,name:"notepad-text"}),h.jsxs("div",{className:"ml-2 max-w-full break-words break-all",children:[h.jsx(Uo,{children:`${((d=n.entity)==null?void 0:d.role)||""}`}),h.jsxs(cl,{onClick:s?c:void 0,children:[s?`${o.slice(0,990)}...`:o,s?h.jsx("span",{className:"float-right",children:h.jsx(pe,{name:"chevron-right"})}):void 0]}),i!=null&&i.length?i.map((p,f)=>h.jsx(wn,{className:"mt-2 mr-1",variant:"default",children:p},f)):void 0]})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})});var Q1e=h3();const Ir=ct(Q1e);var XS,G7;function e_e(){if(G7)return XS;G7=1;function e(t){return t==null}return XS=e,XS}var t_e=e_e();const wt=ct(t_e);var JS,X7;function n_e(){if(X7)return JS;X7=1;var e=Mo(),t=qn(),n=Ia(),r="[object String]";function a(o){return typeof o=="string"||!t(o)&&n(o)&&e(o)==r}return JS=a,JS}var r_e=n_e();const mp=ct(r_e);var a_e=xf();const at=ct(a_e);var o_e=qr();const fl=ct(o_e);var J7={exports:{}},xt={},Y7;function i_e(){if(Y7)return xt;Y7=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),i=Symbol.for("react.context"),s=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.for("react.offscreen"),m;m=Symbol.for("react.module.reference");function y(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case e:switch(v=v.type,v){case n:case a:case r:case l:case u:return v;default:switch(v=v&&v.$$typeof,v){case s:case i:case c:case p:case d:case o:return v;default:return b}}case t:return b}}}return xt.ContextConsumer=i,xt.ContextProvider=o,xt.Element=e,xt.ForwardRef=c,xt.Fragment=n,xt.Lazy=p,xt.Memo=d,xt.Portal=t,xt.Profiler=a,xt.StrictMode=r,xt.Suspense=l,xt.SuspenseList=u,xt.isAsyncMode=function(){return!1},xt.isConcurrentMode=function(){return!1},xt.isContextConsumer=function(v){return y(v)===i},xt.isContextProvider=function(v){return y(v)===o},xt.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===e},xt.isForwardRef=function(v){return y(v)===c},xt.isFragment=function(v){return y(v)===n},xt.isLazy=function(v){return y(v)===p},xt.isMemo=function(v){return y(v)===d},xt.isPortal=function(v){return y(v)===t},xt.isProfiler=function(v){return y(v)===a},xt.isStrictMode=function(v){return y(v)===r},xt.isSuspense=function(v){return y(v)===l},xt.isSuspenseList=function(v){return y(v)===u},xt.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===n||v===a||v===r||v===l||v===u||v===f||typeof v=="object"&&v!==null&&(v.$$typeof===p||v.$$typeof===d||v.$$typeof===o||v.$$typeof===i||v.$$typeof===c||v.$$typeof===m||v.getModuleId!==void 0)},xt.typeOf=y,xt}var Q7;function s_e(){return Q7||(Q7=1,J7.exports=i_e()),J7.exports}var c_e=s_e(),YS,eU;function tU(){if(eU)return YS;eU=1;var e=Mo(),t=Ia(),n="[object Number]";function r(a){return typeof a=="number"||t(a)&&e(a)==n}return YS=r,YS}var QS,nU;function l_e(){if(nU)return QS;nU=1;var e=tU();function t(n){return e(n)&&n!=+n}return QS=t,QS}var u_e=l_e();const yp=ct(u_e);var d_e=tU();const p_e=ct(d_e);var Oa=function(e){return e===0?0:e>0?1:-1},Cs=function(e){return mp(e)&&e.indexOf("%")===e.length-1},ye=function(e){return p_e(e)&&!yp(e)},hn=function(e){return ye(e)||mp(e)},f_e=0,Hy=function(e){var t=++f_e;return"".concat(e||"").concat(t)},Ns=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ye(e)&&!mp(e))return n;var a;if(Cs(e)){var o=e.indexOf("%");a=t*parseFloat(e.slice(0,o))/100}else a=+e;return yp(a)&&(a=n),r&&a>t&&(a=t),a},Ii=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},h_e=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1},hl=function(e,t){return ye(e)&&ye(t)?function(n){return e+n*(t-e)}:function(){return t}};function eO(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):Ir(r,t))===n})}function ml(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function tO(e){"@babel/helpers - typeof";return tO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tO(e)}var m_e=["viewBox","children"],y_e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],rU=["points","pathLength"],nO={svg:m_e,polygon:rU,polyline:rU},rO=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],qy=function(e,t){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),!fl(n))return null;var r={};return Object.keys(n).forEach(function(a){rO.includes(a)&&(r[a]=t||function(o){return n[a](n,o)})}),r},g_e=function(e,t,n){return function(r){return e(t,n,r),null}},Ky=function(e,t,n){if(!fl(e)||tO(e)!=="object")return null;var r=null;return Object.keys(e).forEach(function(a){var o=e[a];rO.includes(a)&&typeof o=="function"&&(r||(r={}),r[a]=g_e(o,t,n))}),r},v_e=["children"],b_e=["children"];function aU(e,t){if(e==null)return{};var n=w_e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function w_e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var oU={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Wo=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},iU=null,aO=null,oO=function e(t){if(t===iU&&Array.isArray(aO))return aO;var n=[];return g.Children.forEach(t,function(r){wt(r)||(c_e.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),aO=n,iU=t,n};function Ca(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(a){return Wo(a)}):r=[Wo(t)],oO(e).forEach(function(a){var o=Ir(a,"type.displayName")||Ir(a,"type.name");r.indexOf(o)!==-1&&n.push(a)}),n}function Sr(e,t){var n=Ca(e,t);return n&&n[0]}var sU=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!ye(n)||n<=0||!ye(r)||r<=0)},x_e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],__e=function(e){return e&&e.type&&mp(e.type)&&x_e.indexOf(e.type)>=0},j_e=function(e,t,n,r){var a,o=(a=nO==null?void 0:nO[r])!==null&&a!==void 0?a:[];return!at(e)&&(r&&o.includes(t)||y_e.includes(t))||n&&rO.includes(t)},bt=function(e,t,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(g.isValidElement(e)&&(r=e.props),!fl(r))return null;var a={};return Object.keys(r).forEach(function(o){var i;j_e((i=r)===null||i===void 0?void 0:i[o],o,t,n)&&(a[o]=r[o])}),a},iO=function e(t,n){if(t===n)return!0;var r=g.Children.count(t);if(r!==g.Children.count(n))return!1;if(r===0)return!0;if(r===1)return cU(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var o=t[a],i=n[a];if(Array.isArray(o)||Array.isArray(i)){if(!e(o,i))return!1}else if(!cU(o,i))return!1}return!0},cU=function(e,t){if(wt(e)&&wt(t))return!0;if(!wt(e)&&!wt(t)){var n=e.props||{},r=n.children,a=aU(n,v_e),o=t.props||{},i=o.children,s=aU(o,b_e);return r&&i?ml(a,s)&&iO(r,i):!r&&!i?ml(a,s):!1}return!1},lU=function(e,t){var n=[],r={};return oO(e).forEach(function(a,o){if(__e(a))n.push(a);else if(a){var i=Wo(a.type),s=t[i]||{},c=s.handler,l=s.once;if(c&&(!l||!r[i])){var u=c(a,i,o);n.push(u),r[i]=!0}}}),n},E_e=function(e){var t=e&&e.type;return t&&oU[t]?oU[t]:null},S_e=function(e,t){return oO(t).indexOf(e)},O_e=["children","width","height","viewBox","className","style","title","desc"];function sO(){return sO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sO.apply(this,arguments)}function C_e(e,t){if(e==null)return{};var n=N_e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function N_e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function cO(e){var t=e.children,n=e.width,r=e.height,a=e.viewBox,o=e.className,i=e.style,s=e.title,c=e.desc,l=C_e(e,O_e),u=a||{width:n,height:r,x:0,y:0},d=Et("recharts-surface",o);return q.createElement("svg",sO({},bt(l,!0,"svg"),{className:d,width:n,height:r,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),q.createElement("title",null,s),q.createElement("desc",null,c),t)}var k_e=["children","className"];function lO(){return lO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lO.apply(this,arguments)}function M_e(e,t){if(e==null)return{};var n=A_e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function A_e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var xn=q.forwardRef(function(e,t){var n=e.children,r=e.className,a=M_e(e,k_e),o=Et("recharts-layer",r);return q.createElement("g",lO({className:o},bt(a,!0),{ref:t}),n)}),Ho=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]},uO,uU;function P_e(){if(uU)return uO;uU=1;var e=R0();function t(n,r,a){var o=n.length;return a=a===void 0?o:a,!r&&a>=o?n:e(n,r,a)}return uO=t,uO}var dO,dU;function pU(){if(dU)return dO;dU=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="\\u200d",s=RegExp("["+i+e+a+o+"]");function c(l){return s.test(l)}return dO=c,dO}var pO,fU;function T_e(){if(fU)return pO;fU=1;function e(t){return t.split("")}return pO=e,pO}var fO,hU;function I_e(){if(hU)return fO;hU=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="["+e+"]",s="["+a+"]",c="\uD83C[\uDFFB-\uDFFF]",l="(?:"+s+"|"+c+")",u="[^"+e+"]",d="(?:\uD83C[\uDDE6-\uDDFF]){2}",p="[\uD800-\uDBFF][\uDC00-\uDFFF]",f="\\u200d",m=l+"?",y="["+o+"]?",v="(?:"+f+"(?:"+[u,d,p].join("|")+")"+y+m+")*",b=y+m+v,w="(?:"+[u+s+"?",s,d,p,i].join("|")+")",_=RegExp(c+"(?="+c+")|"+w+b,"g");function x(j){return j.match(_)||[]}return fO=x,fO}var hO,mU;function R_e(){if(mU)return hO;mU=1;var e=T_e(),t=pU(),n=I_e();function r(a){return t(a)?n(a):e(a)}return hO=r,hO}var mO,yU;function D_e(){if(yU)return mO;yU=1;var e=P_e(),t=pU(),n=R_e(),r=l3();function a(o){return function(i){i=r(i);var s=t(i)?n(i):void 0,c=s?s[0]:i.charAt(0),l=s?e(s,1).join(""):i.slice(1);return c[o]()+l}}return mO=a,mO}var yO,gU;function L_e(){if(gU)return yO;gU=1;var e=D_e(),t=e("toUpperCase");return yO=t,yO}var $_e=L_e();const Zy=ct($_e);function $t(e){return function(){return e}}const vU=Math.cos,Gy=Math.sin,Na=Math.sqrt,Xy=Math.PI,Jy=2*Xy,gO=Math.PI,vO=2*gO,ks=1e-6,F_e=vO-ks;function bU(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function B_e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return bU;const n=10**t;return function(r){this._+=r[0];for(let a=1,o=r.length;a<o;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class z_e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?bU:B_e(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,a){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(t,n,r,a,o,i){this._append`C${+t},${+n},${+r},${+a},${this._x1=+o},${this._y1=+i}`}arcTo(t,n,r,a,o){if(t=+t,n=+n,r=+r,a=+a,o=+o,o<0)throw new Error(`negative radius: ${o}`);let i=this._x1,s=this._y1,c=r-t,l=a-n,u=i-t,d=s-n,p=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(p>ks)if(!(Math.abs(d*c-l*u)>ks)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let f=r-i,m=a-s,y=c*c+l*l,v=f*f+m*m,b=Math.sqrt(y),w=Math.sqrt(p),_=o*Math.tan((gO-Math.acos((y+p-v)/(2*b*w)))/2),x=_/w,j=_/b;Math.abs(x-1)>ks&&this._append`L${t+x*u},${n+x*d}`,this._append`A${o},${o},0,0,${+(d*f>u*m)},${this._x1=t+j*c},${this._y1=n+j*l}`}}arc(t,n,r,a,o,i){if(t=+t,n=+n,r=+r,i=!!i,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(a),c=r*Math.sin(a),l=t+s,u=n+c,d=1^i,p=i?a-o:o-a;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>ks||Math.abs(this._y1-u)>ks)&&this._append`L${l},${u}`,r&&(p<0&&(p=p%vO+vO),p>F_e?this._append`A${r},${r},0,1,${d},${t-s},${n-c}A${r},${r},0,1,${d},${this._x1=l},${this._y1=u}`:p>ks&&this._append`A${r},${r},0,${+(p>=gO)},${d},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function bO(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new z_e(t)}function wO(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function wU(e){this._context=e}wU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Yy(e){return new wU(e)}function xU(e){return e[0]}function _U(e){return e[1]}function jU(e,t){var n=$t(!0),r=null,a=Yy,o=null,i=bO(s);e=typeof e=="function"?e:e===void 0?xU:$t(e),t=typeof t=="function"?t:t===void 0?_U:$t(t);function s(c){var l,u=(c=wO(c)).length,d,p=!1,f;for(r==null&&(o=a(f=i())),l=0;l<=u;++l)!(l<u&&n(d=c[l],l,c))===p&&((p=!p)?o.lineStart():o.lineEnd()),p&&o.point(+e(d,l,c),+t(d,l,c));if(f)return o=null,f+""||null}return s.x=function(c){return arguments.length?(e=typeof c=="function"?c:$t(+c),s):e},s.y=function(c){return arguments.length?(t=typeof c=="function"?c:$t(+c),s):t},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:$t(!!c),s):n},s.curve=function(c){return arguments.length?(a=c,r!=null&&(o=a(r)),s):a},s.context=function(c){return arguments.length?(c==null?r=o=null:o=a(r=c),s):r},s}function Qy(e,t,n){var r=null,a=$t(!0),o=null,i=Yy,s=null,c=bO(l);e=typeof e=="function"?e:e===void 0?xU:$t(+e),t=typeof t=="function"?t:$t(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?_U:$t(+n);function l(d){var p,f,m,y=(d=wO(d)).length,v,b=!1,w,_=new Array(y),x=new Array(y);for(o==null&&(s=i(w=c())),p=0;p<=y;++p){if(!(p<y&&a(v=d[p],p,d))===b)if(b=!b)f=p,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),m=p-1;m>=f;--m)s.point(_[m],x[m]);s.lineEnd(),s.areaEnd()}b&&(_[p]=+e(v,p,d),x[p]=+t(v,p,d),s.point(r?+r(v,p,d):_[p],n?+n(v,p,d):x[p]))}if(w)return s=null,w+""||null}function u(){return jU().defined(a).curve(i).context(o)}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:$t(+d),r=null,l):e},l.x0=function(d){return arguments.length?(e=typeof d=="function"?d:$t(+d),l):e},l.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:$t(+d),l):r},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:$t(+d),n=null,l):t},l.y0=function(d){return arguments.length?(t=typeof d=="function"?d:$t(+d),l):t},l.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:$t(+d),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(d){return arguments.length?(a=typeof d=="function"?d:$t(!!d),l):a},l.curve=function(d){return arguments.length?(i=d,o!=null&&(s=i(o)),l):i},l.context=function(d){return arguments.length?(d==null?o=s=null:s=i(o=d),l):o},l}class EU{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function U_e(e){return new EU(e,!0)}function V_e(e){return new EU(e,!1)}const xO={draw(e,t){const n=Na(t/Xy);e.moveTo(n,0),e.arc(0,0,n,0,Jy)}},W_e={draw(e,t){const n=Na(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},SU=Na(1/3),H_e=SU*2,q_e={draw(e,t){const n=Na(t/H_e),r=n*SU;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},K_e={draw(e,t){const n=Na(t),r=-n/2;e.rect(r,r,n,n)}},Z_e=.8908130915292852,OU=Gy(Xy/10)/Gy(7*Xy/10),G_e=Gy(Jy/10)*OU,X_e=-vU(Jy/10)*OU,J_e={draw(e,t){const n=Na(t*Z_e),r=G_e*n,a=X_e*n;e.moveTo(0,-n),e.lineTo(r,a);for(let o=1;o<5;++o){const i=Jy*o/5,s=vU(i),c=Gy(i);e.lineTo(c*n,-s*n),e.lineTo(s*r-c*a,c*r+s*a)}e.closePath()}},_O=Na(3),Y_e={draw(e,t){const n=-Na(t/(_O*3));e.moveTo(0,n*2),e.lineTo(-_O*n,-n),e.lineTo(_O*n,-n),e.closePath()}},Rr=-.5,Dr=Na(3)/2,jO=1/Na(12),Q_e=(jO/2+1)*3,eje={draw(e,t){const n=Na(t/Q_e),r=n/2,a=n*jO,o=r,i=n*jO+n,s=-o,c=i;e.moveTo(r,a),e.lineTo(o,i),e.lineTo(s,c),e.lineTo(Rr*r-Dr*a,Dr*r+Rr*a),e.lineTo(Rr*o-Dr*i,Dr*o+Rr*i),e.lineTo(Rr*s-Dr*c,Dr*s+Rr*c),e.lineTo(Rr*r+Dr*a,Rr*a-Dr*r),e.lineTo(Rr*o+Dr*i,Rr*i-Dr*o),e.lineTo(Rr*s+Dr*c,Rr*c-Dr*s),e.closePath()}};function tje(e,t){let n=null,r=bO(a);e=typeof e=="function"?e:$t(e||xO),t=typeof t=="function"?t:$t(t===void 0?64:+t);function a(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return a.type=function(o){return arguments.length?(e=typeof o=="function"?o:$t(o),a):e},a.size=function(o){return arguments.length?(t=typeof o=="function"?o:$t(+o),a):t},a.context=function(o){return arguments.length?(n=o??null,a):n},a}function eg(){}function tg(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function CU(e){this._context=e}CU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:tg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:tg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function nje(e){return new CU(e)}function NU(e){this._context=e}NU.prototype={areaStart:eg,areaEnd:eg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:tg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rje(e){return new NU(e)}function kU(e){this._context=e}kU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:tg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function aje(e){return new kU(e)}function MU(e){this._context=e}MU.prototype={areaStart:eg,areaEnd:eg,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function oje(e){return new MU(e)}function AU(e){return e<0?-1:1}function PU(e,t,n){var r=e._x1-e._x0,a=t-e._x1,o=(e._y1-e._y0)/(r||a<0&&-0),i=(n-e._y1)/(a||r<0&&-0),s=(o*a+i*r)/(r+a);return(AU(o)+AU(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(s))||0}function TU(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function EO(e,t,n){var r=e._x0,a=e._y0,o=e._x1,i=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,a+s*t,o-s,i-s*n,o,i)}function ng(e){this._context=e}ng.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:EO(this,this._t0,TU(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,EO(this,TU(this,n=PU(this,e,t)),n);break;default:EO(this,this._t0,n=PU(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function IU(e){this._context=new RU(e)}(IU.prototype=Object.create(ng.prototype)).point=function(e,t){ng.prototype.point.call(this,t,e)};function RU(e){this._context=e}RU.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,o){this._context.bezierCurveTo(t,e,r,n,o,a)}};function ije(e){return new ng(e)}function sje(e){return new IU(e)}function DU(e){this._context=e}DU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=LU(e),a=LU(t),o=0,i=1;i<n;++o,++i)this._context.bezierCurveTo(r[0][o],a[0][o],r[1][o],a[1][o],e[i],t[i]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function LU(e){var t,n=e.length-1,r,a=new Array(n),o=new Array(n),i=new Array(n);for(a[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,o[n-1]=7,i[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/o[t-1],o[t]-=r,i[t]-=r*i[t-1];for(a[n-1]=i[n-1]/o[n-1],t=n-2;t>=0;--t)a[t]=(i[t]-a[t+1])/o[t];for(o[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-a[t+1];return[a,o]}function cje(e){return new DU(e)}function rg(e,t){this._context=e,this._t=t}rg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function lje(e){return new rg(e,.5)}function uje(e){return new rg(e,0)}function dje(e){return new rg(e,1)}function yl(e,t){if((i=e.length)>1)for(var n=1,r,a,o=e[t[0]],i,s=o.length;n<i;++n)for(a=o,o=e[t[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function SO(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function pje(e,t){return e[t]}function fje(e){const t=[];return t.key=e,t}function hje(){var e=$t([]),t=SO,n=yl,r=pje;function a(o){var i=Array.from(e.apply(this,arguments),fje),s,c=i.length,l=-1,u;for(const d of o)for(s=0,++l;s<c;++s)(i[s][l]=[0,+r(d,i[s].key,l,o)]).data=d;for(s=0,u=wO(t(i));s<c;++s)i[u[s]].index=s;return n(i,u),i}return a.keys=function(o){return arguments.length?(e=typeof o=="function"?o:$t(Array.from(o)),a):e},a.value=function(o){return arguments.length?(r=typeof o=="function"?o:$t(+o),a):r},a.order=function(o){return arguments.length?(t=o==null?SO:typeof o=="function"?o:$t(Array.from(o)),a):t},a.offset=function(o){return arguments.length?(n=o??yl,a):n},a}function mje(e,t){if((r=e.length)>0){for(var n,r,a=0,o=e[0].length,i;a<o;++a){for(i=n=0;n<r;++n)i+=e[n][a][1]||0;if(i)for(n=0;n<r;++n)e[n][a][1]/=i}yl(e,t)}}function yje(e,t){if((a=e.length)>0){for(var n=0,r=e[t[0]],a,o=r.length;n<o;++n){for(var i=0,s=0;i<a;++i)s+=e[i][n][1]||0;r[n][1]+=r[n][0]=-s/2}yl(e,t)}}function gje(e,t){if(!(!((i=e.length)>0)||!((o=(a=e[t[0]]).length)>0))){for(var n=0,r=1,a,o,i;r<o;++r){for(var s=0,c=0,l=0;s<i;++s){for(var u=e[t[s]],d=u[r][1]||0,p=u[r-1][1]||0,f=(d-p)/2,m=0;m<s;++m){var y=e[t[m]],v=y[r][1]||0,b=y[r-1][1]||0;f+=v-b}c+=d,l+=f*d}a[r-1][1]+=a[r-1][0]=n,c&&(n-=l/c)}a[r-1][1]+=a[r-1][0]=n,yl(e,t)}}function gp(e){"@babel/helpers - typeof";return gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gp(e)}var vje=["type","size","sizeType"];function OO(){return OO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},OO.apply(this,arguments)}function $U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function FU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$U(Object(n),!0).forEach(function(r){bje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$U(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function bje(e,t,n){return t=wje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wje(e){var t=xje(e,"string");return gp(t)=="symbol"?t:t+""}function xje(e,t){if(gp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(gp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _je(e,t){if(e==null)return{};var n=jje(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function jje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var BU={symbolCircle:xO,symbolCross:W_e,symbolDiamond:q_e,symbolSquare:K_e,symbolStar:J_e,symbolTriangle:Y_e,symbolWye:eje},Eje=Math.PI/180,Sje=function(e){var t="symbol".concat(Zy(e));return BU[t]||xO},Oje=function(e,t,n){if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*Eje;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.pow(Math.tan(r),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},Cje=function(e,t){BU["symbol".concat(Zy(e))]=t},CO=function(e){var t=e.type,n=t===void 0?"circle":t,r=e.size,a=r===void 0?64:r,o=e.sizeType,i=o===void 0?"area":o,s=_je(e,vje),c=FU(FU({},s),{},{type:n,size:a,sizeType:i}),l=function(){var m=Sje(n),y=tje().type(m).size(Oje(a,i,n));return y()},u=c.className,d=c.cx,p=c.cy,f=bt(c,!0);return d===+d&&p===+p&&a===+a?q.createElement("path",OO({},f,{className:Et("recharts-symbols",u),transform:"translate(".concat(d,", ").concat(p,")"),d:l()})):null};CO.registerSymbol=Cje;function gl(e){"@babel/helpers - typeof";return gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gl(e)}function NO(){return NO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},NO.apply(this,arguments)}function zU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Nje(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zU(Object(n),!0).forEach(function(r){vp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function kje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mje(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,VU(r.key),r)}}function Aje(e,t,n){return t&&Mje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pje(e,t,n){return t=ag(t),Tje(e,UU()?Reflect.construct(t,n||[],ag(e).constructor):t.apply(e,n))}function Tje(e,t){if(t&&(gl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ije(e)}function Ije(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UU=function(){return!!e})()}function ag(e){return ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ag(e)}function Rje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kO(e,t)}function kO(e,t){return kO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},kO(e,t)}function vp(e,t,n){return t=VU(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VU(e){var t=Dje(e,"string");return gl(t)=="symbol"?t:t+""}function Dje(e,t){if(gl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(gl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lr=32,MO=function(e){function t(){return kje(this,t),Pje(this,t,arguments)}return Rje(t,e),Aje(t,[{key:"renderIcon",value:function(n){var r=this.props.inactiveColor,a=Lr/2,o=Lr/6,i=Lr/3,s=n.inactive?r:n.color;if(n.type==="plainline")return q.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:a,x2:Lr,y2:a,className:"recharts-legend-icon"});if(n.type==="line")return q.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(a,"h").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*i,",").concat(a,`
            H`).concat(Lr,"M").concat(2*i,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(i,",").concat(a),className:"recharts-legend-icon"});if(n.type==="rect")return q.createElement("path",{stroke:"none",fill:s,d:"M0,".concat(Lr/8,"h").concat(Lr,"v").concat(Lr*3/4,"h").concat(-Lr,"z"),className:"recharts-legend-icon"});if(q.isValidElement(n.legendIcon)){var c=Nje({},n);return delete c.legendIcon,q.cloneElement(n.legendIcon,c)}return q.createElement(CO,{fill:s,cx:a,cy:a,size:Lr,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,r=this.props,a=r.payload,o=r.iconSize,i=r.layout,s=r.formatter,c=r.inactiveColor,l={x:0,y:0,width:Lr,height:Lr},u={display:i==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(p,f){var m=p.formatter||s,y=Et(vp(vp({"recharts-legend-item":!0},"legend-item-".concat(f),!0),"inactive",p.inactive));if(p.type==="none")return null;var v=at(p.value)?null:p.value;Ho(!at(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=p.inactive?c:p.color;return q.createElement("li",NO({className:y,style:u,key:"legend-item-".concat(f)},Ky(n.props,p,f)),q.createElement(cO,{width:o,height:o,viewBox:l,style:d},n.renderIcon(p)),q.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},m?m(v,p,f):v))})}},{key:"render",value:function(){var n=this.props,r=n.payload,a=n.layout,o=n.align;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return q.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(g.PureComponent);vp(MO,"displayName","Legend"),vp(MO,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var AO,WU;function HU(){if(WU)return AO;WU=1;function e(t,n,r,a){for(var o=t.length,i=r+(a?1:-1);a?i--:++i<o;)if(n(t[i],i,t))return i;return-1}return AO=e,AO}var PO,qU;function Lje(){if(qU)return PO;qU=1;function e(t){return t!==t}return PO=e,PO}var TO,KU;function $je(){if(KU)return TO;KU=1;function e(t,n,r){for(var a=r-1,o=t.length;++a<o;)if(t[a]===n)return a;return-1}return TO=e,TO}var IO,ZU;function Fje(){if(ZU)return IO;ZU=1;var e=HU(),t=Lje(),n=$je();function r(a,o,i){return o===o?n(a,o,i):e(a,t,i)}return IO=r,IO}var RO,GU;function Bje(){if(GU)return RO;GU=1;var e=Fje();function t(n,r){var a=n==null?0:n.length;return!!a&&e(n,r,0)>-1}return RO=t,RO}var DO,XU;function zje(){if(XU)return DO;XU=1;function e(t,n,r){for(var a=-1,o=t==null?0:t.length;++a<o;)if(r(n,t[a]))return!0;return!1}return DO=e,DO}var LO,JU;function Uje(){if(JU)return LO;JU=1;function e(){}return LO=e,LO}var $O,YU;function Vje(){if(YU)return $O;YU=1;var e=UD(),t=Uje(),n=Nx(),r=1/0,a=e&&1/n(new e([,-0]))[1]==r?function(o){return new e(o)}:t;return $O=a,$O}var FO,QU;function Wje(){if(QU)return FO;QU=1;var e=JR(),t=Bje(),n=zje(),r=tD(),a=Vje(),o=Nx(),i=200;function s(c,l,u){var d=-1,p=t,f=c.length,m=!0,y=[],v=y;if(u)m=!1,p=n;else if(f>=i){var b=l?null:a(c);if(b)return o(b);m=!1,p=r,v=new e}else v=l?[]:y;e:for(;++d<f;){var w=c[d],_=l?l(w):w;if(w=u||w!==0?w:0,m&&_===_){for(var x=v.length;x--;)if(v[x]===_)continue e;l&&v.push(_),y.push(w)}else p(v,_,u)||(v!==y&&v.push(_),y.push(w))}return y}return FO=s,FO}var BO,eV;function Hje(){if(eV)return BO;eV=1;var e=Ua(),t=Wje();function n(r,a){return r&&r.length?t(r,e(a,2)):[]}return BO=n,BO}var qje=Hje();const tV=ct(qje);function nV(e,t,n){return t===!0?tV(e,n):at(t)?tV(e,t):e}function vl(e){"@babel/helpers - typeof";return vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vl(e)}var Kje=["ref"];function rV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rV(Object(n),!0).forEach(function(r){ig(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Zje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,iV(r.key),r)}}function Gje(e,t,n){return t&&aV(e.prototype,t),n&&aV(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xje(e,t,n){return t=og(t),Jje(e,oV()?Reflect.construct(t,n||[],og(e).constructor):t.apply(e,n))}function Jje(e,t){if(t&&(vl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yje(e)}function Yje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oV=function(){return!!e})()}function og(e){return og=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},og(e)}function Qje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},zO(e,t)}function ig(e,t,n){return t=iV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iV(e){var t=eEe(e,"string");return vl(t)=="symbol"?t:t+""}function eEe(e,t){if(vl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(vl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tEe(e,t){if(e==null)return{};var n=nEe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function nEe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function rEe(e){return e.value}function aEe(e,t){if(q.isValidElement(e))return q.cloneElement(e,t);if(typeof e=="function")return q.createElement(e,t);t.ref;var n=tEe(t,Kje);return q.createElement(MO,n)}var sV=1,bl=function(e){function t(){var n;Zje(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=Xje(this,t,[].concat(a)),ig(n,"lastBoundingBox",{width:-1,height:-1}),n}return Qje(t,e),Gje(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,r=this.getBBox();r?(Math.abs(r.width-this.lastBoundingBox.width)>sV||Math.abs(r.height-this.lastBoundingBox.height)>sV)&&(this.lastBoundingBox.width=r.width,this.lastBoundingBox.height=r.height,n&&n(r)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?qo({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var r=this.props,a=r.layout,o=r.align,i=r.verticalAlign,s=r.margin,c=r.chartWidth,l=r.chartHeight,u,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&a==="vertical"){var p=this.getBBoxSnapshot();u={left:((c||0)-p.width)/2}}else u=o==="right"?{right:s&&s.right||0}:{left:s&&s.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var f=this.getBBoxSnapshot();d={top:((l||0)-f.height)/2}}else d=i==="bottom"?{bottom:s&&s.bottom||0}:{top:s&&s.top||0};return qo(qo({},u),d)}},{key:"render",value:function(){var n=this,r=this.props,a=r.content,o=r.width,i=r.height,s=r.wrapperStyle,c=r.payloadUniqBy,l=r.payload,u=qo(qo({position:"absolute",width:o||"auto",height:i||"auto"},this.getDefaultPosition(s)),s);return q.createElement("div",{className:"recharts-legend-wrapper",style:u,ref:function(d){n.wrapperNode=d}},aEe(a,qo(qo({},this.props),{},{payload:nV(l,c,rEe)})))}}],[{key:"getWithHeight",value:function(n,r){var a=qo(qo({},this.defaultProps),n.props),o=a.layout;return o==="vertical"&&ye(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||r}:null}}])}(g.PureComponent);ig(bl,"displayName","Legend"),ig(bl,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var UO,cV;function oEe(){if(cV)return UO;cV=1;var e=Js(),t=wf(),n=qn(),r=e?e.isConcatSpreadable:void 0;function a(o){return n(o)||t(o)||!!(r&&o&&o[r])}return UO=a,UO}var VO,lV;Iv=function(){if(lV)return VO;lV=1;var e=Ax(),t=oEe();function n(r,a,o,i,s){var c=-1,l=r.length;for(o||(o=t),s||(s=[]);++c<l;){var u=r[c];a>0&&o(u)?a>1?n(u,a-1,o,i,s):e(s,u):i||(s[s.length]=u)}return s}return VO=n,VO};var WO,uV;function iEe(){if(uV)return WO;uV=1;function e(t){return function(n,r,a){for(var o=-1,i=Object(n),s=a(n),c=s.length;c--;){var l=s[t?c:++o];if(r(i[l],l,i)===!1)break}return n}}return WO=e,WO}var HO,dV;Qk=function(){if(dV)return HO;dV=1;var e=iEe(),t=e();return HO=t,HO};var qO,pV;function fV(){if(pV)return qO;pV=1;var e=Qk(),t=pu();function n(r,a){return r&&e(r,a,t)}return qO=n,qO}var KO,hV;function sEe(){if(hV)return KO;hV=1;var e=Ki();function t(n,r){return function(a,o){if(a==null)return a;if(!e(a))return n(a,o);for(var i=a.length,s=r?i:-1,c=Object(a);(r?s--:++s<i)&&o(c[s],s,c)!==!1;);return a}}return KO=t,KO}var ZO,mV;function GO(){if(mV)return ZO;mV=1;var e=fV(),t=sEe(),n=t(e);return ZO=n,ZO}var XO,yV;function gV(){if(yV)return XO;yV=1;var e=GO(),t=Ki();function n(r,a){var o=-1,i=t(r)?Array(r.length):[];return e(r,function(s,c,l){i[++o]=a(s,c,l)}),i}return XO=n,XO}var JO,vV;function cEe(){if(vV)return JO;vV=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return JO=e,JO}var YO,bV;function lEe(){if(bV)return YO;bV=1;var e=gc();function t(n,r){if(n!==r){var a=n!==void 0,o=n===null,i=n===n,s=e(n),c=r!==void 0,l=r===null,u=r===r,d=e(r);if(!l&&!d&&!s&&n>r||s&&c&&u&&!l&&!d||o&&c&&u||!a&&u||!i)return 1;if(!o&&!s&&!d&&n<r||d&&a&&i&&!o&&!s||l&&a&&i||!c&&i||!u)return-1}return 0}return YO=t,YO}var QO,wV;function uEe(){if(wV)return QO;wV=1;var e=lEe();function t(n,r,a){for(var o=-1,i=n.criteria,s=r.criteria,c=i.length,l=a.length;++o<c;){var u=e(i[o],s[o]);if(u){if(o>=l)return u;var d=a[o];return u*(d=="desc"?-1:1)}}return n.index-r.index}return QO=t,QO}var eC,xV;function dEe(){if(xV)return eC;xV=1;var e=iu(),t=yu(),n=Ua(),r=gV(),a=cEe(),o=P0(),i=uEe(),s=vc(),c=qn();function l(u,d,p){d.length?d=e(d,function(y){return c(y)?function(v){return t(v,y.length===1?y[0]:y)}:y}):d=[s];var f=-1;d=e(d,o(n));var m=r(u,function(y,v,b){var w=e(d,function(_){return _(y)});return{criteria:w,index:++f,value:y}});return a(m,function(y,v){return i(y,v,p)})}return eC=l,eC}var tC,_V;sM=function(){if(_V)return tC;_V=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return tC=e,tC};var nC,jV;Yk=function(){if(jV)return nC;jV=1;var e=sM(),t=Math.max;function n(r,a,o){return a=t(a===void 0?r.length-1:a,0),function(){for(var i=arguments,s=-1,c=t(i.length-a,0),l=Array(c);++s<c;)l[s]=i[a+s];s=-1;for(var u=Array(a+1);++s<a;)u[s]=i[s];return u[a]=o(l),e(r,this,u)}}return nC=n,nC};var rC,EV;function pEe(){if(EV)return rC;EV=1;function e(t){return function(){return t}}return rC=e,rC}var aC,SV;function fEe(){if(SV)return aC;SV=1;var e=pEe(),t=O3(),n=vc(),r=t?function(a,o){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:n;return aC=r,aC}var oC,OV;function hEe(){if(OV)return oC;OV=1;var e=800,t=16,n=Date.now;function r(a){var o=0,i=0;return function(){var s=n(),c=t-(s-i);if(i=s,c>0){if(++o>=e)return arguments[0]}else o=0;return a.apply(void 0,arguments)}}return oC=r,oC}var iC,CV;Jk=function(){if(CV)return iC;CV=1;var e=fEe(),t=hEe(),n=t(e);return iC=n,iC};var sC,NV;eM=function(){if(NV)return sC;NV=1;var e=vc(),t=Yk(),n=Jk();function r(a,o){return n(t(a,o,e),a+"")}return sC=r,sC};var cC,kV;function mEe(){if(kV)return cC;kV=1;var e=Iv(),t=dEe(),n=eM(),r=qs(),a=n(function(o,i){if(o==null)return[];var s=i.length;return s>1&&r(o,i[0],i[1])?i=[]:s>2&&r(i[0],i[1],i[2])&&(i=[i[0]]),t(o,e(i,1),[])});return cC=a,cC}var yEe=mEe();const lC=ct(yEe);function bp(e){"@babel/helpers - typeof";return bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bp(e)}function uC(){return uC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uC.apply(this,arguments)}function gEe(e,t){return xEe(e)||wEe(e,t)||bEe(e,t)||vEe()}function vEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bEe(e,t){if(e){if(typeof e=="string")return MV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MV(e,t)}}function MV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function xEe(e){if(Array.isArray(e))return e}function AV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function dC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AV(Object(n),!0).forEach(function(r){_Ee(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _Ee(e,t,n){return t=jEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jEe(e){var t=EEe(e,"string");return bp(t)=="symbol"?t:t+""}function EEe(e,t){if(bp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SEe(e){return Array.isArray(e)&&hn(e[0])&&hn(e[1])?e.join(" ~ "):e}var OEe=function(e){var t=e.separator,n=t===void 0?" : ":t,r=e.contentStyle,a=r===void 0?{}:r,o=e.itemStyle,i=o===void 0?{}:o,s=e.labelStyle,c=s===void 0?{}:s,l=e.payload,u=e.formatter,d=e.itemSorter,p=e.wrapperClassName,f=e.labelClassName,m=e.label,y=e.labelFormatter,v=e.accessibilityLayer,b=v===void 0?!1:v,w=function(){if(l&&l.length){var M={padding:0,margin:0},k=(d?lC(l,d):l).map(function(A,P){if(A.type==="none")return null;var C=dC({display:"block",paddingTop:4,paddingBottom:4,color:A.color||"#000"},i),T=A.formatter||u||SEe,I=A.value,R=A.name,L=I,D=R;if(T&&L!=null&&D!=null){var z=T(I,R,A,P,l);if(Array.isArray(z)){var U=gEe(z,2);L=U[0],D=U[1]}else L=z}return q.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(P),style:C},hn(D)?q.createElement("span",{className:"recharts-tooltip-item-name"},D):null,hn(D)?q.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,q.createElement("span",{className:"recharts-tooltip-item-value"},L),q.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return q.createElement("ul",{className:"recharts-tooltip-item-list",style:M},k)}return null},_=dC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),x=dC({margin:0},c),j=!wt(m),E=j?m:"",S=Et("recharts-default-tooltip",p),O=Et("recharts-tooltip-label",f);j&&y&&l!==void 0&&l!==null&&(E=y(m,l));var N=b?{role:"status","aria-live":"assertive"}:{};return q.createElement("div",uC({className:S,style:_},N),q.createElement("p",{className:O,style:x},q.isValidElement(E)?E:"".concat(E)),w())};function wp(e){"@babel/helpers - typeof";return wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wp(e)}function sg(e,t,n){return t=CEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CEe(e){var t=NEe(e,"string");return wp(t)=="symbol"?t:t+""}function NEe(e,t){if(wp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xp="recharts-tooltip-wrapper",kEe={visibility:"hidden"};function MEe(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return Et(xp,sg(sg(sg(sg({},"".concat(xp,"-right"),ye(n)&&t&&ye(t.x)&&n>=t.x),"".concat(xp,"-left"),ye(n)&&t&&ye(t.x)&&n<t.x),"".concat(xp,"-bottom"),ye(r)&&t&&ye(t.y)&&r>=t.y),"".concat(xp,"-top"),ye(r)&&t&&ye(t.y)&&r<t.y))}function PV(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,a=e.offsetTopLeft,o=e.position,i=e.reverseDirection,s=e.tooltipDimension,c=e.viewBox,l=e.viewBoxDimension;if(o&&ye(o[r]))return o[r];var u=n[r]-s-a,d=n[r]+a;if(t[r])return i[r]?u:d;if(i[r]){var p=u,f=c[r];return p<f?Math.max(d,c[r]):Math.max(u,c[r])}var m=d+s,y=c[r]+l;return m>y?Math.max(u,c[r]):Math.max(d,c[r])}function AEe(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function PEe(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,a=e.position,o=e.reverseDirection,i=e.tooltipBox,s=e.useTranslate3d,c=e.viewBox,l,u,d;return i.height>0&&i.width>0&&n?(u=PV({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),d=PV({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),l=AEe({translateX:u,translateY:d,useTranslate3d:s})):l=kEe,{cssProperties:l,cssClasses:MEe({translateX:u,translateY:d,coordinate:n})}}function wl(e){"@babel/helpers - typeof";return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wl(e)}function TV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function IV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TV(Object(n),!0).forEach(function(r){fC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function TEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IEe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,DV(r.key),r)}}function REe(e,t,n){return t&&IEe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function DEe(e,t,n){return t=cg(t),LEe(e,RV()?Reflect.construct(t,n||[],cg(e).constructor):t.apply(e,n))}function LEe(e,t){if(t&&(wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ee(e)}function $Ee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RV=function(){return!!e})()}function cg(e){return cg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cg(e)}function FEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pC(e,t)}function pC(e,t){return pC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},pC(e,t)}function fC(e,t,n){return t=DV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DV(e){var t=BEe(e,"string");return wl(t)=="symbol"?t:t+""}function BEe(e,t){if(wl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LV=1,zEe=function(e){function t(){var n;TEe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=DEe(this,t,[].concat(a)),fC(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),fC(n,"handleKeyDown",function(i){if(i.key==="Escape"){var s,c,l,u;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&s!==void 0?s:0,y:(l=(u=n.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0}})}}),n}return FEe(t,e),REe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>LV||Math.abs(n.height-this.state.lastBoundingBox.height)>LV)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,r;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.children,l=r.coordinate,u=r.hasPayload,d=r.isAnimationActive,p=r.offset,f=r.position,m=r.reverseDirection,y=r.useTranslate3d,v=r.viewBox,b=r.wrapperStyle,w=PEe({allowEscapeViewBox:o,coordinate:l,offsetTopLeft:p,position:f,reverseDirection:m,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:v}),_=w.cssClasses,x=w.cssProperties,j=IV(IV({transition:d&&a?"transform ".concat(i,"ms ").concat(s):void 0},x),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&u?"visible":"hidden",position:"absolute",top:0,left:0},b);return q.createElement("div",{tabIndex:-1,className:_,style:j,ref:function(E){n.wrapperNode=E}},c)}}])}(g.PureComponent),UEe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ri={isSsr:UEe(),get:function(e){return Ri[e]},set:function(e,t){if(typeof e=="string")Ri[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(r){Ri[r]=e[r]})}}};function xl(e){"@babel/helpers - typeof";return xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xl(e)}function $V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function FV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$V(Object(n),!0).forEach(function(r){mC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$V(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function VEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WEe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zV(r.key),r)}}function HEe(e,t,n){return t&&WEe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qEe(e,t,n){return t=lg(t),KEe(e,BV()?Reflect.construct(t,n||[],lg(e).constructor):t.apply(e,n))}function KEe(e,t){if(t&&(xl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZEe(e)}function ZEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BV=function(){return!!e})()}function lg(e){return lg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lg(e)}function GEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hC(e,t)}function hC(e,t){return hC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},hC(e,t)}function mC(e,t,n){return t=zV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zV(e){var t=XEe(e,"string");return xl(t)=="symbol"?t:t+""}function XEe(e,t){if(xl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JEe(e){return e.dataKey}function YEe(e,t){return q.isValidElement(e)?q.cloneElement(e,t):typeof e=="function"?q.createElement(e,t):q.createElement(OEe,t)}var to=function(e){function t(){return VEe(this,t),qEe(this,t,arguments)}return GEe(t,e),HEe(t,[{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.content,l=r.coordinate,u=r.filterNull,d=r.isAnimationActive,p=r.offset,f=r.payload,m=r.payloadUniqBy,y=r.position,v=r.reverseDirection,b=r.useTranslate3d,w=r.viewBox,_=r.wrapperStyle,x=f??[];u&&x.length&&(x=nV(f.filter(function(E){return E.value!=null&&(E.hide!==!0||n.props.includeHidden)}),m,JEe));var j=x.length>0;return q.createElement(zEe,{allowEscapeViewBox:o,animationDuration:i,animationEasing:s,isAnimationActive:d,active:a,coordinate:l,hasPayload:j,offset:p,position:y,reverseDirection:v,useTranslate3d:b,viewBox:w,wrapperStyle:_},YEe(c,FV(FV({},this.props),{},{payload:x})))}}])}(g.PureComponent);mC(to,"displayName","Tooltip"),mC(to,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Ri.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var yC,UV;function QEe(){if(UV)return yC;UV=1;var e=Hr(),t=function(){return e.Date.now()};return yC=t,yC}var gC,VV;aM=function(){if(VV)return gC;VV=1;var e=qr(),t=QEe(),n=uz(),r="Expected a function",a=Math.max,o=Math.min;function i(s,c,l){var u,d,p,f,m,y,v=0,b=!1,w=!1,_=!0;if(typeof s!="function")throw new TypeError(r);c=n(c)||0,e(l)&&(b=!!l.leading,w="maxWait"in l,p=w?a(n(l.maxWait)||0,c):p,_="trailing"in l?!!l.trailing:_);function x(P){var C=u,T=d;return u=d=void 0,v=P,f=s.apply(T,C),f}function j(P){return v=P,m=setTimeout(O,c),b?x(P):f}function E(P){var C=P-y,T=P-v,I=c-C;return w?o(I,p-T):I}function S(P){var C=P-y,T=P-v;return y===void 0||C>=c||C<0||w&&T>=p}function O(){var P=t();if(S(P))return N(P);m=setTimeout(O,E(P))}function N(P){return m=void 0,_&&u?x(P):(u=d=void 0,f)}function M(){m!==void 0&&clearTimeout(m),v=0,u=y=d=m=void 0}function k(){return m===void 0?f:N(t())}function A(){var P=t(),C=S(P);if(u=arguments,d=this,y=P,C){if(m===void 0)return j(y);if(w)return clearTimeout(m),m=setTimeout(O,c),x(y)}return m===void 0&&(m=setTimeout(O,c)),f}return A.cancel=M,A.flush=k,A}return gC=i,gC};var vC,WV;function eSe(){if(WV)return vC;WV=1;var e=aM(),t=qr(),n="Expected a function";function r(a,o,i){var s=!0,c=!0;if(typeof a!="function")throw new TypeError(n);return t(i)&&(s="leading"in i?!!i.leading:s,c="trailing"in i?!!i.trailing:c),e(a,o,{leading:s,maxWait:o,trailing:c})}return vC=r,vC}var tSe=eSe();Lv=ct(tSe);function _p(e){"@babel/helpers - typeof";return _p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_p(e)}function HV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ug(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?HV(Object(n),!0).forEach(function(r){nSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nSe(e,t,n){return t=rSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rSe(e){var t=aSe(e,"string");return _p(t)=="symbol"?t:t+""}function aSe(e,t){if(_p(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_p(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oSe(e,t){return lSe(e)||cSe(e,t)||sSe(e,t)||iSe()}function iSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sSe(e,t){if(e){if(typeof e=="string")return qV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qV(e,t)}}function qV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cSe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function lSe(e){if(Array.isArray(e))return e}var uSe=g.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,a=r===void 0?{width:-1,height:-1}:r,o=e.width,i=o===void 0?"100%":o,s=e.height,c=s===void 0?"100%":s,l=e.minWidth,u=l===void 0?0:l,d=e.minHeight,p=e.maxHeight,f=e.children,m=e.debounce,y=m===void 0?0:m,v=e.id,b=e.className,w=e.onResize,_=e.style,x=_===void 0?{}:_,j=g.useRef(null),E=g.useRef();E.current=w,g.useImperativeHandle(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var S=g.useState({containerWidth:a.width,containerHeight:a.height}),O=oSe(S,2),N=O[0],M=O[1],k=g.useCallback(function(P,C){M(function(T){var I=Math.round(P),R=Math.round(C);return T.containerWidth===I&&T.containerHeight===R?T:{containerWidth:I,containerHeight:R}})},[]);g.useEffect(function(){var P=function(L){var D,z=L[0].contentRect,U=z.width,$=z.height;k(U,$),(D=E.current)===null||D===void 0||D.call(E,U,$)};y>0&&(P=Lv(P,y,{trailing:!0,leading:!1}));var C=new ResizeObserver(P),T=j.current.getBoundingClientRect(),I=T.width,R=T.height;return k(I,R),C.observe(j.current),function(){C.disconnect()}},[k,y]);var A=g.useMemo(function(){var P=N.containerWidth,C=N.containerHeight;if(P<0||C<0)return null;Ho(Cs(i)||Cs(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),Ho(!n||n>0,"The aspect(%s) must be greater than zero.",n);var T=Cs(i)?P:i,I=Cs(c)?C:c;n&&n>0&&(T?I=T/n:I&&(T=I*n),p&&I>p&&(I=p)),Ho(T>0||I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,T,I,i,c,u,d,n);var R=!Array.isArray(f)&&Wo(f.type).endsWith("Chart");return q.Children.map(f,function(L){return q.isValidElement(L)?g.cloneElement(L,ug({width:T,height:I},R?{style:ug({height:"100%",width:"100%",maxHeight:I,maxWidth:T},L.props.style)}:{})):L})},[n,f,c,p,d,u,N,i]);return q.createElement("div",{id:v?"".concat(v):void 0,className:Et("recharts-responsive-container",b),style:ug(ug({},x),{},{width:i,height:c,minWidth:u,minHeight:d,maxHeight:p}),ref:j},A)}),KV=function(e){return null};KV.displayName="Cell";function jp(e){"@babel/helpers - typeof";return jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(e)}function ZV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function bC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ZV(Object(n),!0).forEach(function(r){dSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dSe(e,t,n){return t=pSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pSe(e){var t=fSe(e,"string");return jp(t)=="symbol"?t:t+""}function fSe(e,t){if(jp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(jp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _l={widthCache:{},cacheCount:0},hSe=2e3,mSe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},GV="recharts_measurement_span";function ySe(e){var t=bC({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var Ep=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Ri.isSsr)return{width:0,height:0};var n=ySe(t),r=JSON.stringify({text:e,copyStyle:n});if(_l.widthCache[r])return _l.widthCache[r];try{var a=document.getElementById(GV);a||(a=document.createElement("span"),a.setAttribute("id",GV),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=bC(bC({},mSe),n);Object.assign(a.style,o),a.textContent="".concat(e);var i=a.getBoundingClientRect(),s={width:i.width,height:i.height};return _l.widthCache[r]=s,++_l.cacheCount>hSe&&(_l.cacheCount=0,_l.widthCache={}),s}catch{return{width:0,height:0}}},gSe=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function Sp(e){"@babel/helpers - typeof";return Sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sp(e)}function dg(e,t){return xSe(e)||wSe(e,t)||bSe(e,t)||vSe()}function vSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bSe(e,t){if(e){if(typeof e=="string")return XV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XV(e,t)}}function XV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wSe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function xSe(e){if(Array.isArray(e))return e}function _Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ESe(r.key),r)}}function jSe(e,t,n){return t&&JV(e.prototype,t),n&&JV(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ESe(e){var t=SSe(e,"string");return Sp(t)=="symbol"?t:t+""}function SSe(e,t){if(Sp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Sp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var YV=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,QV=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,OSe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,CSe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,eW={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},NSe=Object.keys(eW),jl="NaN";function kSe(e,t){return e*eW[t]}var pg=function(){function e(t,n){_Se(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!OSe.test(n)&&(this.num=NaN,this.unit=""),NSe.includes(n)&&(this.num=kSe(t,n),this.unit="px")}return jSe(e,[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(t){var n,r=(n=CSe.exec(t))!==null&&n!==void 0?n:[],a=dg(r,3),o=a[1],i=a[2];return new e(parseFloat(o),i??"")}}])}();function tW(e){if(e.includes(jl))return jl;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=YV.exec(t))!==null&&n!==void 0?n:[],a=dg(r,4),o=a[1],i=a[2],s=a[3],c=pg.parse(o??""),l=pg.parse(s??""),u=i==="*"?c.multiply(l):c.divide(l);if(u.isNaN())return jl;t=t.replace(YV,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,p=(d=QV.exec(t))!==null&&d!==void 0?d:[],f=dg(p,4),m=f[1],y=f[2],v=f[3],b=pg.parse(m??""),w=pg.parse(v??""),_=y==="+"?b.add(w):b.subtract(w);if(_.isNaN())return jl;t=t.replace(QV,_.toString())}return t}var nW=/\(([^()]*)\)/;function MSe(e){for(var t=e;t.includes("(");){var n=nW.exec(t),r=dg(n,2),a=r[1];t=t.replace(nW,tW(a))}return t}function ASe(e){var t=e.replace(/\s+/g,"");return t=MSe(t),t=tW(t),t}function PSe(e){try{return ASe(e)}catch{return jl}}function wC(e){var t=PSe(e.slice(5,-1));return t===jl?"":t}var TSe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],ISe=["dx","dy","angle","className","breakAll"];function xC(){return xC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xC.apply(this,arguments)}function rW(e,t){if(e==null)return{};var n=RSe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function RSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function aW(e,t){return FSe(e)||$Se(e,t)||LSe(e,t)||DSe()}function DSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LSe(e,t){if(e){if(typeof e=="string")return oW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oW(e,t)}}function oW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $Se(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function FSe(e){if(Array.isArray(e))return e}var iW=/[ \f\n\r\t\v\u2028\u2029]+/,sW=function(e){var t=e.children,n=e.breakAll,r=e.style;try{var a=[];wt(t)||(n?a=t.toString().split(""):a=t.toString().split(iW));var o=a.map(function(s){return{word:s,width:Ep(s,r).width}}),i=n?0:Ep("\xA0",r).width;return{wordsWithComputedWidth:o,spaceWidth:i}}catch{return null}},BSe=function(e,t,n,r,a){var o=e.maxLines,i=e.children,s=e.style,c=e.breakAll,l=ye(o),u=i,d=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return P.reduce(function(C,T){var I=T.word,R=T.width,L=C[C.length-1];if(L&&(r==null||a||L.width+R+n<Number(r)))L.words.push(I),L.width+=R+n;else{var D={words:[I],width:R};C.push(D)}return C},[])},p=d(t),f=function(P){return P.reduce(function(C,T){return C.width>T.width?C:T})};if(!l)return p;for(var m="\u2026",y=function(P){var C=u.slice(0,P),T=sW({breakAll:c,style:s,children:C+m}).wordsWithComputedWidth,I=d(T),R=I.length>o||f(I).width>Number(r);return[R,I]},v=0,b=u.length-1,w=0,_;v<=b&&w<=u.length-1;){var x=Math.floor((v+b)/2),j=x-1,E=y(j),S=aW(E,2),O=S[0],N=S[1],M=y(x),k=aW(M,1),A=k[0];if(!O&&!A&&(v=x+1),O&&A&&(b=x-1),!O&&A){_=N;break}w++}return _||p},cW=function(e){var t=wt(e)?[]:e.toString().split(iW);return[{words:t}]},zSe=function(e){var t=e.width,n=e.scaleToFit,r=e.children,a=e.style,o=e.breakAll,i=e.maxLines;if((t||n)&&!Ri.isSsr){var s,c,l=sW({breakAll:o,children:r,style:a});if(l){var u=l.wordsWithComputedWidth,d=l.spaceWidth;s=u,c=d}else return cW(r);return BSe({breakAll:o,children:r,maxLines:i,style:a},s,c,t,n)}return cW(r)},lW="#808080",fg=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.lineHeight,i=o===void 0?"1em":o,s=e.capHeight,c=s===void 0?"0.71em":s,l=e.scaleToFit,u=l===void 0?!1:l,d=e.textAnchor,p=d===void 0?"start":d,f=e.verticalAnchor,m=f===void 0?"end":f,y=e.fill,v=y===void 0?lW:y,b=rW(e,TSe),w=g.useMemo(function(){return zSe({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:u,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,u,b.style,b.width]),_=b.dx,x=b.dy,j=b.angle,E=b.className,S=b.breakAll,O=rW(b,ISe);if(!hn(n)||!hn(a))return null;var N=n+(ye(_)?_:0),M=a+(ye(x)?x:0),k;switch(m){case"start":k=wC("calc(".concat(c,")"));break;case"middle":k=wC("calc(".concat((w.length-1)/2," * -").concat(i," + (").concat(c," / 2))"));break;default:k=wC("calc(".concat(w.length-1," * -").concat(i,")"));break}var A=[];if(u){var P=w[0].width,C=b.width;A.push("scale(".concat((ye(C)?C/P:1)/P,")"))}return j&&A.push("rotate(".concat(j,", ").concat(N,", ").concat(M,")")),A.length&&(O.transform=A.join(" ")),q.createElement("text",xC({},bt(O,!0),{x:N,y:M,className:Et("recharts-text",E),textAnchor:p,fill:v.includes("url")?lW:v}),w.map(function(T,I){var R=T.words.join(S?"":" ");return q.createElement("tspan",{x:N,dy:I===0?k:i,key:"".concat(R,"-").concat(I)},R)}))};function Di(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function USe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _C(e){let t,n,r;e.length!==2?(t=Di,n=(s,c)=>Di(e(s),c),r=(s,c)=>e(s)-c):(t=e===Di||e===USe?e:VSe,n=e,r=e);function a(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<0?l=d+1:u=d}while(l<u)}return l}function o(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<=0?l=d+1:u=d}while(l<u)}return l}function i(s,c,l=0,u=s.length){const d=a(s,c,l,u-1);return d>l&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:a,center:i,right:o}}function VSe(){return 0}function uW(e){return e===null?NaN:+e}function*WSe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const HSe=_C(Di),Op=HSe.right;_C(uW).center;class dW extends Map{constructor(t,n=ZSe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,a]of t)this.set(r,a)}get(t){return super.get(pW(this,t))}has(t){return super.has(pW(this,t))}set(t,n){return super.set(qSe(this,t),n)}delete(t){return super.delete(KSe(this,t))}}function pW({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function qSe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function KSe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function ZSe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function GSe(e=Di){if(e===Di)return fW;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function fW(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const XSe=Math.sqrt(50),JSe=Math.sqrt(10),YSe=Math.sqrt(2);function hg(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),o=r/Math.pow(10,a),i=o>=XSe?10:o>=JSe?5:o>=YSe?2:1;let s,c,l;return a<0?(l=Math.pow(10,-a)/i,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=Math.pow(10,a)*i,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?hg(e,t,n*2):[s,c,l]}function jC(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,o,i]=r?hg(t,e,n):hg(e,t,n);if(!(o>=a))return[];const s=o-a+1,c=new Array(s);if(r)if(i<0)for(let l=0;l<s;++l)c[l]=(o-l)/-i;else for(let l=0;l<s;++l)c[l]=(o-l)*i;else if(i<0)for(let l=0;l<s;++l)c[l]=(a+l)/-i;else for(let l=0;l<s;++l)c[l]=(a+l)*i;return c}function EC(e,t,n){return t=+t,e=+e,n=+n,hg(e,t,n)[2]}function SC(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?EC(t,e,n):EC(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function hW(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function mW(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function yW(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=a===void 0?fW:GSe(a);r>n;){if(r-n>600){const c=r-n+1,l=t-n+1,u=Math.log(c),d=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*d*(c-d)/c)*(l-c/2<0?-1:1),f=Math.max(n,Math.floor(t-l*d/c+p)),m=Math.min(r,Math.floor(t+(c-l)*d/c+p));yW(e,t,f,m,a)}const o=e[t];let i=n,s=r;for(Cp(e,n,t),a(e[r],o)>0&&Cp(e,n,r);i<s;){for(Cp(e,i,s),++i,--s;a(e[i],o)<0;)++i;for(;a(e[s],o)>0;)--s}a(e[n],o)===0?Cp(e,n,s):(++s,Cp(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Cp(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function QSe(e,t,n){if(e=Float64Array.from(WSe(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return mW(e);if(t>=1)return hW(e);var r,a=(r-1)*t,o=Math.floor(a),i=hW(yW(e,o).subarray(0,o+1)),s=mW(e.subarray(o+1));return i+(s-i)*(a-o)}}function eOe(e,t,n=uW){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,o=Math.floor(a),i=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return i+(s-i)*(a-o)}}function tOe(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(a);++r<a;)o[r]=e+r*n;return o}function $r(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ko(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const OC=Symbol("implicit");function CC(){var e=new dW,t=[],n=[],r=OC;function a(o){let i=e.get(o);if(i===void 0){if(r!==OC)return r;e.set(o,i=t.push(o)-1)}return n[i%n.length]}return a.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new dW;for(const i of o)e.has(i)||e.set(i,t.push(i)-1);return a},a.range=function(o){return arguments.length?(n=Array.from(o),a):n.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return CC(t,n).unknown(r)},$r.apply(a,arguments),a}function Np(){var e=CC().unknown(void 0),t=e.domain,n=e.range,r=0,a=1,o,i,s=!1,c=0,l=0,u=.5;delete e.unknown;function d(){var p=t().length,f=a<r,m=f?a:r,y=f?r:a;o=(y-m)/Math.max(1,p-c+l*2),s&&(o=Math.floor(o)),m+=(y-m-o*(p-c))*u,i=o*(1-c),s&&(m=Math.round(m),i=Math.round(i));var v=tOe(p).map(function(b){return m+o*b});return n(f?v.reverse():v)}return e.domain=function(p){return arguments.length?(t(p),d()):t()},e.range=function(p){return arguments.length?([r,a]=p,r=+r,a=+a,d()):[r,a]},e.rangeRound=function(p){return[r,a]=p,r=+r,a=+a,s=!0,d()},e.bandwidth=function(){return i},e.step=function(){return o},e.round=function(p){return arguments.length?(s=!!p,d()):s},e.padding=function(p){return arguments.length?(c=Math.min(1,l=+p),d()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),d()):c},e.paddingOuter=function(p){return arguments.length?(l=+p,d()):l},e.align=function(p){return arguments.length?(u=Math.max(0,Math.min(1,p)),d()):u},e.copy=function(){return Np(t(),[r,a]).round(s).paddingInner(c).paddingOuter(l).align(u)},$r.apply(d(),arguments)}function gW(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return gW(t())},e}function kp(){return gW(Np.apply(null,arguments).paddingInner(1))}function nOe(e){return function(){return e}}function mg(e){return+e}var vW=[0,1];function Jn(e){return e}function NC(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:nOe(isNaN(t)?NaN:.5)}function rOe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function aOe(e,t,n){var r=e[0],a=e[1],o=t[0],i=t[1];return a<r?(r=NC(a,r),o=n(i,o)):(r=NC(r,a),o=n(o,i)),function(s){return o(r(s))}}function oOe(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),o=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)a[i]=NC(e[i],e[i+1]),o[i]=n(t[i],t[i+1]);return function(s){var c=Op(e,s,1,r)-1;return o[c](a[c](s))}}function Mp(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function yg(){var e=vW,t=vW,n=_c,r,a,o,i=Jn,s,c,l;function u(){var p=Math.min(e.length,t.length);return i!==Jn&&(i=rOe(e[0],e[p-1])),s=p>2?oOe:aOe,c=l=null,d}function d(p){return p==null||isNaN(p=+p)?o:(c||(c=s(e.map(r),t,n)))(r(i(p)))}return d.invert=function(p){return i(a((l||(l=s(t,e.map(r),ra)))(p)))},d.domain=function(p){return arguments.length?(e=Array.from(p,mg),u()):e.slice()},d.range=function(p){return arguments.length?(t=Array.from(p),u()):t.slice()},d.rangeRound=function(p){return t=Array.from(p),n=u_,u()},d.clamp=function(p){return arguments.length?(i=p?!0:Jn,u()):i!==Jn},d.interpolate=function(p){return arguments.length?(n=p,u()):n},d.unknown=function(p){return arguments.length?(o=p,d):o},function(p,f){return r=p,a=f,u()}}function kC(){return yg()(Jn,Jn)}function iOe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function gg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function El(e){return e=gg(Math.abs(e)),e?e[1]:NaN}function sOe(e,t){return function(n,r){for(var a=n.length,o=[],i=0,s=e[0],c=0;a>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(n.substring(a-=s,a+s)),!((c+=s+1)>r));)s=e[i=(i+1)%e.length];return o.reverse().join(t)}}function cOe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var lOe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ap(e){if(!(t=lOe.exec(e)))throw new Error("invalid format: "+e);var t;return new MC({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Ap.prototype=MC.prototype;function MC(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}MC.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function uOe(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var bW;function dOe(e,t){var n=gg(e,t);if(!n)return e+"";var r=n[0],a=n[1],o=a-(bW=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+gg(e,Math.max(0,t+o-1))[0]}function wW(e,t){var n=gg(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const xW={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:iOe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>wW(e*100,t),r:wW,s:dOe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function _W(e){return e}var jW=Array.prototype.map,EW=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function pOe(e){var t=e.grouping===void 0||e.thousands===void 0?_W:sOe(jW.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?_W:cOe(jW.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(d){d=Ap(d);var p=d.fill,f=d.align,m=d.sign,y=d.symbol,v=d.zero,b=d.width,w=d.comma,_=d.precision,x=d.trim,j=d.type;j==="n"?(w=!0,j="g"):xW[j]||(_===void 0&&(_=12),x=!0,j="g"),(v||p==="0"&&f==="=")&&(v=!0,p="0",f="=");var E=y==="$"?n:y==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",S=y==="$"?r:/[%p]/.test(j)?i:"",O=xW[j],N=/[defgprs%]/.test(j);_=_===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function M(k){var A=E,P=S,C,T,I;if(j==="c")P=O(k)+P,k="";else{k=+k;var R=k<0||1/k<0;if(k=isNaN(k)?c:O(Math.abs(k),_),x&&(k=uOe(k)),R&&+k==0&&m!=="+"&&(R=!1),A=(R?m==="("?m:s:m==="-"||m==="("?"":m)+A,P=(j==="s"?EW[8+bW/3]:"")+P+(R&&m==="("?")":""),N){for(C=-1,T=k.length;++C<T;)if(I=k.charCodeAt(C),48>I||I>57){P=(I===46?a+k.slice(C+1):k.slice(C))+P,k=k.slice(0,C);break}}}w&&!v&&(k=t(k,1/0));var L=A.length+k.length+P.length,D=L<b?new Array(b-L+1).join(p):"";switch(w&&v&&(k=t(D+k,D.length?b-P.length:1/0),D=""),f){case"<":k=A+k+P+D;break;case"=":k=A+D+k+P;break;case"^":k=D.slice(0,L=D.length>>1)+A+k+P+D.slice(L);break;default:k=D+A+k+P;break}return o(k)}return M.toString=function(){return d+""},M}function u(d,p){var f=l((d=Ap(d),d.type="f",d)),m=Math.max(-8,Math.min(8,Math.floor(El(p)/3)))*3,y=Math.pow(10,-m),v=EW[8+m/3];return function(b){return f(y*b)+v}}return{format:l,formatPrefix:u}}var vg,AC,SW;fOe({thousands:",",grouping:[3],currency:["$",""]});function fOe(e){return vg=pOe(e),AC=vg.format,SW=vg.formatPrefix,vg}function hOe(e){return Math.max(0,-El(Math.abs(e)))}function mOe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(El(t)/3)))*3-El(Math.abs(e)))}function yOe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,El(t)-El(e))+1}function OW(e,t,n,r){var a=SC(e,t,n),o;switch(r=Ap(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=mOe(a,i))&&(r.precision=o),SW(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=yOe(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=hOe(a))&&(r.precision=o-(r.type==="%")*2);break}}return AC(r)}function Li(e){var t=e.domain;return e.ticks=function(n){var r=t();return jC(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return OW(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,o=r.length-1,i=r[a],s=r[o],c,l,u=10;for(s<i&&(l=i,i=s,s=l,l=a,a=o,o=l);u-- >0;){if(l=EC(i,s,n),l===c)return r[a]=i,r[o]=s,t(r);if(l>0)i=Math.floor(i/l)*l,s=Math.ceil(s/l)*l;else if(l<0)i=Math.ceil(i*l)/l,s=Math.floor(s*l)/l;else break;c=l}return e},e}function bg(){var e=kC();return e.copy=function(){return Mp(e,bg())},$r.apply(e,arguments),Li(e)}function CW(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,mg),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return CW(e).unknown(t)},e=arguments.length?Array.from(e,mg):[0,1],Li(n)}function NW(e,t){e=e.slice();var n=0,r=e.length-1,a=e[n],o=e[r],i;return o<a&&(i=n,n=r,r=i,i=a,a=o,o=i),e[n]=t.floor(a),e[r]=t.ceil(o),e}function kW(e){return Math.log(e)}function MW(e){return Math.exp(e)}function gOe(e){return-Math.log(-e)}function vOe(e){return-Math.exp(-e)}function bOe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function wOe(e){return e===10?bOe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function xOe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function AW(e){return(t,n)=>-e(-t,n)}function PC(e){const t=e(kW,MW),n=t.domain;let r=10,a,o;function i(){return a=xOe(r),o=wOe(r),n()[0]<0?(a=AW(a),o=AW(o),e(gOe,vOe)):e(kW,MW),t}return t.base=function(s){return arguments.length?(r=+s,i()):r},t.domain=function(s){return arguments.length?(n(s),i()):n()},t.ticks=s=>{const c=n();let l=c[0],u=c[c.length-1];const d=u<l;d&&([l,u]=[u,l]);let p=a(l),f=a(u),m,y;const v=s==null?10:+s;let b=[];if(!(r%1)&&f-p<v){if(p=Math.floor(p),f=Math.ceil(f),l>0){for(;p<=f;++p)for(m=1;m<r;++m)if(y=p<0?m/o(-p):m*o(p),!(y<l)){if(y>u)break;b.push(y)}}else for(;p<=f;++p)for(m=r-1;m>=1;--m)if(y=p>0?m/o(-p):m*o(p),!(y<l)){if(y>u)break;b.push(y)}b.length*2<v&&(b=jC(l,u,v))}else b=jC(p,f,Math.min(f-p,v)).map(o);return d?b.reverse():b},t.tickFormat=(s,c)=>{if(s==null&&(s=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=Ap(c)).precision==null&&(c.trim=!0),c=AC(c)),s===1/0)return c;const l=Math.max(1,r*s/t.ticks().length);return u=>{let d=u/o(Math.round(a(u)));return d*r<r-.5&&(d*=r),d<=l?c(u):""}},t.nice=()=>n(NW(n(),{floor:s=>o(Math.floor(a(s))),ceil:s=>o(Math.ceil(a(s)))})),t}function PW(){const e=PC(yg()).domain([1,10]);return e.copy=()=>Mp(e,PW()).base(e.base()),$r.apply(e,arguments),e}function TW(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function IW(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function TC(e){var t=1,n=e(TW(t),IW(t));return n.constant=function(r){return arguments.length?e(TW(t=+r),IW(t)):t},Li(n)}function RW(){var e=TC(yg());return e.copy=function(){return Mp(e,RW()).constant(e.constant())},$r.apply(e,arguments)}function DW(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function _Oe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function jOe(e){return e<0?-e*e:e*e}function IC(e){var t=e(Jn,Jn),n=1;function r(){return n===1?e(Jn,Jn):n===.5?e(_Oe,jOe):e(DW(n),DW(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,r()):n},Li(t)}function RC(){var e=IC(yg());return e.copy=function(){return Mp(e,RC()).exponent(e.exponent())},$r.apply(e,arguments),e}function EOe(){return RC.apply(null,arguments).exponent(.5)}function LW(e){return Math.sign(e)*e*e}function SOe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function $W(){var e=kC(),t=[0,1],n=!1,r;function a(o){var i=SOe(e(o));return isNaN(i)?r:n?Math.round(i):i}return a.invert=function(o){return e.invert(LW(o))},a.domain=function(o){return arguments.length?(e.domain(o),a):e.domain()},a.range=function(o){return arguments.length?(e.range((t=Array.from(o,mg)).map(LW)),a):t.slice()},a.rangeRound=function(o){return a.range(o).round(!0)},a.round=function(o){return arguments.length?(n=!!o,a):n},a.clamp=function(o){return arguments.length?(e.clamp(o),a):e.clamp()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return $W(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},$r.apply(a,arguments),Li(a)}function FW(){var e=[],t=[],n=[],r;function a(){var i=0,s=Math.max(1,t.length);for(n=new Array(s-1);++i<s;)n[i-1]=eOe(e,i/s);return o}function o(i){return i==null||isNaN(i=+i)?r:t[Op(n,i)]}return o.invertExtent=function(i){var s=t.indexOf(i);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Di),a()},o.range=function(i){return arguments.length?(t=Array.from(i),a()):t.slice()},o.unknown=function(i){return arguments.length?(r=i,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return FW().domain(e).range(t).unknown(r)},$r.apply(o,arguments)}function BW(){var e=0,t=1,n=1,r=[.5],a=[0,1],o;function i(c){return c!=null&&c<=c?a[Op(r,c,0,n)]:o}function s(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,s()):[e,t]},i.range=function(c){return arguments.length?(n=(a=Array.from(c)).length-1,s()):a.slice()},i.invertExtent=function(c){var l=a.indexOf(c);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},i.unknown=function(c){return arguments.length&&(o=c),i},i.thresholds=function(){return r.slice()},i.copy=function(){return BW().domain([e,t]).range(a).unknown(o)},$r.apply(Li(i),arguments)}function zW(){var e=[.5],t=[0,1],n,r=1;function a(o){return o!=null&&o<=o?t[Op(e,o,0,r)]:n}return a.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(o){var i=t.indexOf(o);return[e[i-1],e[i]]},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return zW().domain(e).range(t).unknown(n)},$r.apply(a,arguments)}const DC=new Date,LC=new Date;function mn(e,t,n,r){function a(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return a.floor=o=>(e(o=new Date(+o)),o),a.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),a.round=o=>{const i=a(o),s=a.ceil(o);return o-i<s-o?i:s},a.offset=(o,i)=>(t(o=new Date(+o),i==null?1:Math.floor(i)),o),a.range=(o,i,s)=>{const c=[];if(o=a.ceil(o),s=s==null?1:Math.floor(s),!(o<i)||!(s>0))return c;let l;do c.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<i);return c},a.filter=o=>mn(i=>{if(i>=i)for(;e(i),!o(i);)i.setTime(i-1)},(i,s)=>{if(i>=i)if(s<0)for(;++s<=0;)for(;t(i,-1),!o(i););else for(;--s>=0;)for(;t(i,1),!o(i););}),n&&(a.count=(o,i)=>(DC.setTime(+o),LC.setTime(+i),e(DC),e(LC),Math.floor(n(DC,LC))),a.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?a.filter(r?i=>r(i)%o===0:i=>a.count(0,i)%o===0):a)),a}const wg=mn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);wg.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?mn(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):wg),wg.range;const Zo=1e3,Fr=Zo*60,Go=Fr*60,Xo=Go*24,$C=Xo*7,UW=Xo*30,FC=Xo*365,Ms=mn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Zo)},(e,t)=>(t-e)/Zo,e=>e.getUTCSeconds());Ms.range;const BC=mn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zo)},(e,t)=>{e.setTime(+e+t*Fr)},(e,t)=>(t-e)/Fr,e=>e.getMinutes());BC.range;const zC=mn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Fr)},(e,t)=>(t-e)/Fr,e=>e.getUTCMinutes());zC.range;const UC=mn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zo-e.getMinutes()*Fr)},(e,t)=>{e.setTime(+e+t*Go)},(e,t)=>(t-e)/Go,e=>e.getHours());UC.range;const VC=mn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Go)},(e,t)=>(t-e)/Go,e=>e.getUTCHours());VC.range;const Pp=mn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Fr)/Xo,e=>e.getDate()-1);Pp.range;const xg=mn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Xo,e=>e.getUTCDate()-1);xg.range;const VW=mn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Xo,e=>Math.floor(e/Xo));VW.range;function As(e){return mn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Fr)/$C)}const _g=As(0),jg=As(1),OOe=As(2),COe=As(3),Sl=As(4),NOe=As(5),kOe=As(6);_g.range,jg.range,OOe.range,COe.range,Sl.range,NOe.range,kOe.range;function Ps(e){return mn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/$C)}const Eg=Ps(0),Sg=Ps(1),MOe=Ps(2),AOe=Ps(3),Ol=Ps(4),POe=Ps(5),TOe=Ps(6);Eg.range,Sg.range,MOe.range,AOe.range,Ol.range,POe.range,TOe.range;const WC=mn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());WC.range;const HC=mn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());HC.range;const Jo=mn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Jo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:mn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}),Jo.range;const Yo=mn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Yo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:mn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}),Yo.range;function WW(e,t,n,r,a,o){const i=[[Ms,1,Zo],[Ms,5,5*Zo],[Ms,15,15*Zo],[Ms,30,30*Zo],[o,1,Fr],[o,5,5*Fr],[o,15,15*Fr],[o,30,30*Fr],[a,1,Go],[a,3,3*Go],[a,6,6*Go],[a,12,12*Go],[r,1,Xo],[r,2,2*Xo],[n,1,$C],[t,1,UW],[t,3,3*UW],[e,1,FC]];function s(l,u,d){const p=u<l;p&&([l,u]=[u,l]);const f=d&&typeof d.range=="function"?d:c(l,u,d),m=f?f.range(l,+u+1):[];return p?m.reverse():m}function c(l,u,d){const p=Math.abs(u-l)/d,f=_C(([,,v])=>v).right(i,p);if(f===i.length)return e.every(SC(l/FC,u/FC,d));if(f===0)return wg.every(Math.max(SC(l,u,d),1));const[m,y]=i[p/i[f-1][2]<i[f][2]/p?f-1:f];return m.every(y)}return[s,c]}const[IOe,ROe]=WW(Yo,HC,Eg,VW,VC,zC),[DOe,LOe]=WW(Jo,WC,_g,Pp,UC,BC);function qC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function KC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Tp(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function $Oe(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,o=e.days,i=e.shortDays,s=e.months,c=e.shortMonths,l=Ip(a),u=Rp(a),d=Ip(o),p=Rp(o),f=Ip(i),m=Rp(i),y=Ip(s),v=Rp(s),b=Ip(c),w=Rp(c),_={a:R,A:L,b:D,B:z,c:null,d:XW,e:XW,f:sCe,g:gCe,G:bCe,H:aCe,I:oCe,j:iCe,L:JW,m:cCe,M:lCe,p:U,q:$,Q:rH,s:aH,S:uCe,u:dCe,U:pCe,V:fCe,w:hCe,W:mCe,x:null,X:null,y:yCe,Y:vCe,Z:wCe,"%":nH},x={a:V,A:F,b:W,B:re,c:null,d:QW,e:QW,f:ECe,g:ICe,G:DCe,H:xCe,I:_Ce,j:jCe,L:eH,m:SCe,M:OCe,p:ee,q:G,Q:rH,s:aH,S:CCe,u:NCe,U:kCe,V:MCe,w:ACe,W:PCe,x:null,X:null,y:TCe,Y:RCe,Z:LCe,"%":nH},j={a:M,A:k,b:A,B:P,c:C,d:ZW,e:ZW,f:eCe,g:KW,G:qW,H:GW,I:GW,j:XOe,L:QOe,m:GOe,M:JOe,p:N,q:ZOe,Q:nCe,s:rCe,S:YOe,u:VOe,U:WOe,V:HOe,w:UOe,W:qOe,x:T,X:I,y:KW,Y:qW,Z:KOe,"%":tCe};_.x=E(n,_),_.X=E(r,_),_.c=E(t,_),x.x=E(n,x),x.X=E(r,x),x.c=E(t,x);function E(K,X){return function(ne){var B=[],ue=-1,ae=0,de=K.length,je,Le,$e;for(ne instanceof Date||(ne=new Date(+ne));++ue<de;)K.charCodeAt(ue)===37&&(B.push(K.slice(ae,ue)),(Le=HW[je=K.charAt(++ue)])!=null?je=K.charAt(++ue):Le=je==="e"?" ":"0",($e=X[je])&&(je=$e(ne,Le)),B.push(je),ae=ue+1);return B.push(K.slice(ae,ue)),B.join("")}}function S(K,X){return function(ne){var B=Tp(1900,void 0,1),ue=O(B,K,ne+="",0),ae,de;if(ue!=ne.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(X&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(ae=KC(Tp(B.y,0,1)),de=ae.getUTCDay(),ae=de>4||de===0?Sg.ceil(ae):Sg(ae),ae=xg.offset(ae,(B.V-1)*7),B.y=ae.getUTCFullYear(),B.m=ae.getUTCMonth(),B.d=ae.getUTCDate()+(B.w+6)%7):(ae=qC(Tp(B.y,0,1)),de=ae.getDay(),ae=de>4||de===0?jg.ceil(ae):jg(ae),ae=Pp.offset(ae,(B.V-1)*7),B.y=ae.getFullYear(),B.m=ae.getMonth(),B.d=ae.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),de="Z"in B?KC(Tp(B.y,0,1)).getUTCDay():qC(Tp(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(de+5)%7:B.w+B.U*7-(de+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,KC(B)):qC(B)}}function O(K,X,ne,B){for(var ue=0,ae=X.length,de=ne.length,je,Le;ue<ae;){if(B>=de)return-1;if(je=X.charCodeAt(ue++),je===37){if(je=X.charAt(ue++),Le=j[je in HW?X.charAt(ue++):je],!Le||(B=Le(K,ne,B))<0)return-1}else if(je!=ne.charCodeAt(B++))return-1}return B}function N(K,X,ne){var B=l.exec(X.slice(ne));return B?(K.p=u.get(B[0].toLowerCase()),ne+B[0].length):-1}function M(K,X,ne){var B=f.exec(X.slice(ne));return B?(K.w=m.get(B[0].toLowerCase()),ne+B[0].length):-1}function k(K,X,ne){var B=d.exec(X.slice(ne));return B?(K.w=p.get(B[0].toLowerCase()),ne+B[0].length):-1}function A(K,X,ne){var B=b.exec(X.slice(ne));return B?(K.m=w.get(B[0].toLowerCase()),ne+B[0].length):-1}function P(K,X,ne){var B=y.exec(X.slice(ne));return B?(K.m=v.get(B[0].toLowerCase()),ne+B[0].length):-1}function C(K,X,ne){return O(K,t,X,ne)}function T(K,X,ne){return O(K,n,X,ne)}function I(K,X,ne){return O(K,r,X,ne)}function R(K){return i[K.getDay()]}function L(K){return o[K.getDay()]}function D(K){return c[K.getMonth()]}function z(K){return s[K.getMonth()]}function U(K){return a[+(K.getHours()>=12)]}function $(K){return 1+~~(K.getMonth()/3)}function V(K){return i[K.getUTCDay()]}function F(K){return o[K.getUTCDay()]}function W(K){return c[K.getUTCMonth()]}function re(K){return s[K.getUTCMonth()]}function ee(K){return a[+(K.getUTCHours()>=12)]}function G(K){return 1+~~(K.getUTCMonth()/3)}return{format:function(K){var X=E(K+="",_);return X.toString=function(){return K},X},parse:function(K){var X=S(K+="",!1);return X.toString=function(){return K},X},utcFormat:function(K){var X=E(K+="",x);return X.toString=function(){return K},X},utcParse:function(K){var X=S(K+="",!0);return X.toString=function(){return K},X}}}var HW={"-":"",_:" ",0:"0"},_n=/^\s*\d+/,FOe=/^%/,BOe=/[\\^$*+?|[\]().{}]/g;function ft(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",o=a.length;return r+(o<n?new Array(n-o+1).join(t)+a:a)}function zOe(e){return e.replace(BOe,"\\$&")}function Ip(e){return new RegExp("^(?:"+e.map(zOe).join("|")+")","i")}function Rp(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function UOe(e,t,n){var r=_n.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function VOe(e,t,n){var r=_n.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function WOe(e,t,n){var r=_n.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function HOe(e,t,n){var r=_n.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function qOe(e,t,n){var r=_n.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function qW(e,t,n){var r=_n.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function KW(e,t,n){var r=_n.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function KOe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ZOe(e,t,n){var r=_n.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function GOe(e,t,n){var r=_n.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function ZW(e,t,n){var r=_n.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function XOe(e,t,n){var r=_n.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function GW(e,t,n){var r=_n.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function JOe(e,t,n){var r=_n.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function YOe(e,t,n){var r=_n.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function QOe(e,t,n){var r=_n.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function eCe(e,t,n){var r=_n.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function tCe(e,t,n){var r=FOe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function nCe(e,t,n){var r=_n.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function rCe(e,t,n){var r=_n.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function XW(e,t){return ft(e.getDate(),t,2)}function aCe(e,t){return ft(e.getHours(),t,2)}function oCe(e,t){return ft(e.getHours()%12||12,t,2)}function iCe(e,t){return ft(1+Pp.count(Jo(e),e),t,3)}function JW(e,t){return ft(e.getMilliseconds(),t,3)}function sCe(e,t){return JW(e,t)+"000"}function cCe(e,t){return ft(e.getMonth()+1,t,2)}function lCe(e,t){return ft(e.getMinutes(),t,2)}function uCe(e,t){return ft(e.getSeconds(),t,2)}function dCe(e){var t=e.getDay();return t===0?7:t}function pCe(e,t){return ft(_g.count(Jo(e)-1,e),t,2)}function YW(e){var t=e.getDay();return t>=4||t===0?Sl(e):Sl.ceil(e)}function fCe(e,t){return e=YW(e),ft(Sl.count(Jo(e),e)+(Jo(e).getDay()===4),t,2)}function hCe(e){return e.getDay()}function mCe(e,t){return ft(jg.count(Jo(e)-1,e),t,2)}function yCe(e,t){return ft(e.getFullYear()%100,t,2)}function gCe(e,t){return e=YW(e),ft(e.getFullYear()%100,t,2)}function vCe(e,t){return ft(e.getFullYear()%1e4,t,4)}function bCe(e,t){var n=e.getDay();return e=n>=4||n===0?Sl(e):Sl.ceil(e),ft(e.getFullYear()%1e4,t,4)}function wCe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ft(t/60|0,"0",2)+ft(t%60,"0",2)}function QW(e,t){return ft(e.getUTCDate(),t,2)}function xCe(e,t){return ft(e.getUTCHours(),t,2)}function _Ce(e,t){return ft(e.getUTCHours()%12||12,t,2)}function jCe(e,t){return ft(1+xg.count(Yo(e),e),t,3)}function eH(e,t){return ft(e.getUTCMilliseconds(),t,3)}function ECe(e,t){return eH(e,t)+"000"}function SCe(e,t){return ft(e.getUTCMonth()+1,t,2)}function OCe(e,t){return ft(e.getUTCMinutes(),t,2)}function CCe(e,t){return ft(e.getUTCSeconds(),t,2)}function NCe(e){var t=e.getUTCDay();return t===0?7:t}function kCe(e,t){return ft(Eg.count(Yo(e)-1,e),t,2)}function tH(e){var t=e.getUTCDay();return t>=4||t===0?Ol(e):Ol.ceil(e)}function MCe(e,t){return e=tH(e),ft(Ol.count(Yo(e),e)+(Yo(e).getUTCDay()===4),t,2)}function ACe(e){return e.getUTCDay()}function PCe(e,t){return ft(Sg.count(Yo(e)-1,e),t,2)}function TCe(e,t){return ft(e.getUTCFullYear()%100,t,2)}function ICe(e,t){return e=tH(e),ft(e.getUTCFullYear()%100,t,2)}function RCe(e,t){return ft(e.getUTCFullYear()%1e4,t,4)}function DCe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Ol(e):Ol.ceil(e),ft(e.getUTCFullYear()%1e4,t,4)}function LCe(){return"+0000"}function nH(){return"%"}function rH(e){return+e}function aH(e){return Math.floor(+e/1e3)}var Cl,oH,iH;$Ce({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function $Ce(e){return Cl=$Oe(e),oH=Cl.format,Cl.parse,iH=Cl.utcFormat,Cl.utcParse,Cl}function FCe(e){return new Date(e)}function BCe(e){return e instanceof Date?+e:+new Date(+e)}function ZC(e,t,n,r,a,o,i,s,c,l){var u=kC(),d=u.invert,p=u.domain,f=l(".%L"),m=l(":%S"),y=l("%I:%M"),v=l("%I %p"),b=l("%a %d"),w=l("%b %d"),_=l("%B"),x=l("%Y");function j(E){return(c(E)<E?f:s(E)<E?m:i(E)<E?y:o(E)<E?v:r(E)<E?a(E)<E?b:w:n(E)<E?_:x)(E)}return u.invert=function(E){return new Date(d(E))},u.domain=function(E){return arguments.length?p(Array.from(E,BCe)):p().map(FCe)},u.ticks=function(E){var S=p();return e(S[0],S[S.length-1],E??10)},u.tickFormat=function(E,S){return S==null?j:l(S)},u.nice=function(E){var S=p();return(!E||typeof E.range!="function")&&(E=t(S[0],S[S.length-1],E??10)),E?p(NW(S,E)):u},u.copy=function(){return Mp(u,ZC(e,t,n,r,a,o,i,s,c,l))},u}function zCe(){return $r.apply(ZC(DOe,LOe,Jo,WC,_g,Pp,UC,BC,Ms,oH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function UCe(){return $r.apply(ZC(IOe,ROe,Yo,HC,Eg,xg,VC,zC,Ms,iH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Og(){var e=0,t=1,n,r,a,o,i=Jn,s=!1,c;function l(d){return d==null||isNaN(d=+d)?c:i(a===0?.5:(d=(o(d)-n)*a,s?Math.max(0,Math.min(1,d)):d))}l.domain=function(d){return arguments.length?([e,t]=d,n=o(e=+e),r=o(t=+t),a=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(d){return arguments.length?(s=!!d,l):s},l.interpolator=function(d){return arguments.length?(i=d,l):i};function u(d){return function(p){var f,m;return arguments.length?([f,m]=p,i=d(f,m),l):[i(0),i(1)]}}return l.range=u(_c),l.rangeRound=u(u_),l.unknown=function(d){return arguments.length?(c=d,l):c},function(d){return o=d,n=d(e),r=d(t),a=n===r?0:1/(r-n),l}}function $i(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function sH(){var e=Li(Og()(Jn));return e.copy=function(){return $i(e,sH())},Ko.apply(e,arguments)}function cH(){var e=PC(Og()).domain([1,10]);return e.copy=function(){return $i(e,cH()).base(e.base())},Ko.apply(e,arguments)}function lH(){var e=TC(Og());return e.copy=function(){return $i(e,lH()).constant(e.constant())},Ko.apply(e,arguments)}function GC(){var e=IC(Og());return e.copy=function(){return $i(e,GC()).exponent(e.exponent())},Ko.apply(e,arguments)}function VCe(){return GC.apply(null,arguments).exponent(.5)}function uH(){var e=[],t=Jn;function n(r){if(r!=null&&!isNaN(r=+r))return t((Op(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let a of r)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Di),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,o)=>QSe(e,o/r))},n.copy=function(){return uH(t).domain(e)},Ko.apply(n,arguments)}function Cg(){var e=0,t=.5,n=1,r=1,a,o,i,s,c,l=Jn,u,d=!1,p;function f(y){return isNaN(y=+y)?p:(y=.5+((y=+u(y))-o)*(r*y<r*o?s:c),l(d?Math.max(0,Math.min(1,y)):y))}f.domain=function(y){return arguments.length?([e,t,n]=y,a=u(e=+e),o=u(t=+t),i=u(n=+n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,f):[e,t,n]},f.clamp=function(y){return arguments.length?(d=!!y,f):d},f.interpolator=function(y){return arguments.length?(l=y,f):l};function m(y){return function(v){var b,w,_;return arguments.length?([b,w,_]=v,l=ise(y,[b,w,_]),f):[l(0),l(.5),l(1)]}}return f.range=m(_c),f.rangeRound=m(u_),f.unknown=function(y){return arguments.length?(p=y,f):p},function(y){return u=y,a=y(e),o=y(t),i=y(n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,f}}function dH(){var e=Li(Cg()(Jn));return e.copy=function(){return $i(e,dH())},Ko.apply(e,arguments)}function pH(){var e=PC(Cg()).domain([.1,1,10]);return e.copy=function(){return $i(e,pH()).base(e.base())},Ko.apply(e,arguments)}function fH(){var e=TC(Cg());return e.copy=function(){return $i(e,fH()).constant(e.constant())},Ko.apply(e,arguments)}function XC(){var e=IC(Cg());return e.copy=function(){return $i(e,XC()).exponent(e.exponent())},Ko.apply(e,arguments)}function WCe(){return XC.apply(null,arguments).exponent(.5)}const hH=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Np,scaleDiverging:dH,scaleDivergingLog:pH,scaleDivergingPow:XC,scaleDivergingSqrt:WCe,scaleDivergingSymlog:fH,scaleIdentity:CW,scaleImplicit:OC,scaleLinear:bg,scaleLog:PW,scaleOrdinal:CC,scalePoint:kp,scalePow:RC,scaleQuantile:FW,scaleQuantize:BW,scaleRadial:$W,scaleSequential:sH,scaleSequentialLog:cH,scaleSequentialPow:GC,scaleSequentialQuantile:uH,scaleSequentialSqrt:VCe,scaleSequentialSymlog:lH,scaleSqrt:EOe,scaleSymlog:RW,scaleThreshold:zW,scaleTime:zCe,scaleUtc:UCe,tickFormat:OW},Symbol.toStringTag,{value:"Module"}));var JC,mH;function yH(){if(mH)return JC;mH=1;var e=gc();function t(n,r,a){for(var o=-1,i=n.length;++o<i;){var s=n[o],c=r(s);if(c!=null&&(l===void 0?c===c&&!e(c):a(c,l)))var l=c,u=s}return u}return JC=t,JC}var YC,gH;function HCe(){if(gH)return YC;gH=1;function e(t,n){return t>n}return YC=e,YC}var QC,vH;function qCe(){if(vH)return QC;vH=1;var e=yH(),t=HCe(),n=vc();function r(a){return a&&a.length?e(a,n,t):void 0}return QC=r,QC}var KCe=qCe();const Ng=ct(KCe);var eN,bH;function ZCe(){if(bH)return eN;bH=1;function e(t,n){return t<n}return eN=e,eN}var tN,wH;function GCe(){if(wH)return tN;wH=1;var e=yH(),t=ZCe(),n=vc();function r(a){return a&&a.length?e(a,n,t):void 0}return tN=r,tN}var XCe=GCe();const kg=ct(XCe);var nN,xH;tM=function(){if(xH)return nN;xH=1;var e=iu(),t=Ua(),n=gV(),r=qn();function a(o,i){var s=r(o)?e:n;return s(o,t(i,3))}return nN=a,nN};var rN,_H;function JCe(){if(_H)return rN;_H=1;var e=Iv(),t=tM();function n(r,a){return e(t(r,a),1)}return rN=n,rN}var YCe=JCe();const QCe=ct(YCe);var aN,jH;function eNe(){if(jH)return aN;jH=1;var e=u1();function t(n,r){return e(n,r)}return aN=t,aN}var tNe=eNe();const oN=ct(tNe);var Nl=1e9,nNe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},cN,Vt=!0,Br="[DecimalError] ",Ts=Br+"Invalid argument: ",iN=Br+"Exponent out of range: ",kl=Math.floor,Is=Math.pow,rNe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Or,jn=1e7,Ft=7,EH=9007199254740991,Mg=kl(EH/Ft),Ce={};Ce.absoluteValue=Ce.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},Ce.comparedTo=Ce.cmp=function(e){var t,n,r,a,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(r=o.d.length,a=e.d.length,t=0,n=r<a?r:a;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===a?0:r>a^o.s<0?1:-1},Ce.decimalPlaces=Ce.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Ft;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n},Ce.dividedBy=Ce.div=function(e){return Qo(this,new this.constructor(e))},Ce.dividedToIntegerBy=Ce.idiv=function(e){var t=this,n=t.constructor;return Tt(Qo(t,new n(e),0,1),n.precision)},Ce.equals=Ce.eq=function(e){return!this.cmp(e)},Ce.exponent=function(){return sn(this)},Ce.greaterThan=Ce.gt=function(e){return this.cmp(e)>0},Ce.greaterThanOrEqualTo=Ce.gte=function(e){return this.cmp(e)>=0},Ce.isInteger=Ce.isint=function(){return this.e>this.d.length-2},Ce.isNegative=Ce.isneg=function(){return this.s<0},Ce.isPositive=Ce.ispos=function(){return this.s>0},Ce.isZero=function(){return this.s===0},Ce.lessThan=Ce.lt=function(e){return this.cmp(e)<0},Ce.lessThanOrEqualTo=Ce.lte=function(e){return this.cmp(e)<1},Ce.logarithm=Ce.log=function(e){var t,n=this,r=n.constructor,a=r.precision,o=a+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(Or))throw Error(Br+"NaN");if(n.s<1)throw Error(Br+(n.s?"NaN":"-Infinity"));return n.eq(Or)?new r(0):(Vt=!1,t=Qo(Dp(n,o),Dp(e,o),o),Vt=!0,Tt(t,a))},Ce.minus=Ce.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?NH(t,e):SH(t,(e.s=-e.s,e))},Ce.modulo=Ce.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(e=new r(e),!e.s)throw Error(Br+"NaN");return n.s?(Vt=!1,t=Qo(n,e,0,1).times(e),Vt=!0,n.minus(t)):Tt(new r(n),a)},Ce.naturalExponential=Ce.exp=function(){return OH(this)},Ce.naturalLogarithm=Ce.ln=function(){return Dp(this)},Ce.negated=Ce.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},Ce.plus=Ce.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?SH(t,e):NH(t,(e.s=-e.s,e))},Ce.precision=Ce.sd=function(e){var t,n,r,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ts+e);if(t=sn(a)+1,r=a.d.length-1,n=r*Ft+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},Ce.squareRoot=Ce.sqrt=function(){var e,t,n,r,a,o,i,s=this,c=s.constructor;if(s.s<1){if(!s.s)return new c(0);throw Error(Br+"NaN")}for(e=sn(s),Vt=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=ro(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=kl((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(a.toString()),n=c.precision,a=i=n+3;;)if(o=r,r=o.plus(Qo(s,o,i+2)).times(.5),ro(o.d).slice(0,i)===(t=ro(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&t=="4999"){if(Tt(o,n+1,0),o.times(o).eq(s)){r=o;break}}else if(t!="9999")break;i+=4}return Vt=!0,Tt(r,n)},Ce.times=Ce.mul=function(e){var t,n,r,a,o,i,s,c,l,u=this,d=u.constructor,p=u.d,f=(e=new d(e)).d;if(!u.s||!e.s)return new d(0);for(e.s*=u.s,n=u.e+e.e,c=p.length,l=f.length,c<l&&(o=p,p=f,f=o,i=c,c=l,l=i),o=[],i=c+l,r=i;r--;)o.push(0);for(r=l;--r>=0;){for(t=0,a=c+r;a>r;)s=o[a]+f[r]*p[a-r-1]+t,o[a--]=s%jn|0,t=s/jn|0;o[a]=(o[a]+t)%jn|0}for(;!o[--i];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,Vt?Tt(e,d.precision):e},Ce.toDecimalPlaces=Ce.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(no(e,0,Nl),t===void 0?t=r.rounding:no(t,0,8),Tt(n,e+sn(n)+1,t))},Ce.toExponential=function(e,t){var n,r=this,a=r.constructor;return e===void 0?n=Rs(r,!0):(no(e,0,Nl),t===void 0?t=a.rounding:no(t,0,8),r=Tt(new a(r),e+1,t),n=Rs(r,!0,e+1)),n},Ce.toFixed=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?Rs(a):(no(e,0,Nl),t===void 0?t=o.rounding:no(t,0,8),r=Tt(new o(a),e+sn(a)+1,t),n=Rs(r.abs(),!1,e+sn(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},Ce.toInteger=Ce.toint=function(){var e=this,t=e.constructor;return Tt(new t(e),sn(e)+1,t.rounding)},Ce.toNumber=function(){return+this},Ce.toPower=Ce.pow=function(e){var t,n,r,a,o,i,s=this,c=s.constructor,l=12,u=+(e=new c(e));if(!e.s)return new c(Or);if(s=new c(s),!s.s){if(e.s<1)throw Error(Br+"Infinity");return s}if(s.eq(Or))return s;if(r=c.precision,e.eq(Or))return Tt(s,r);if(t=e.e,n=e.d.length-1,i=t>=n,o=s.s,i){if((n=u<0?-u:u)<=EH){for(a=new c(Or),t=Math.ceil(r/Ft+4),Vt=!1;n%2&&(a=a.times(s),kH(a.d,t)),n=kl(n/2),n!==0;)s=s.times(s),kH(s.d,t);return Vt=!0,e.s<0?new c(Or).div(a):Tt(a,r)}}else if(o<0)throw Error(Br+"NaN");return o=o<0&&e.d[Math.max(t,n)]&1?-1:1,s.s=1,Vt=!1,a=e.times(Dp(s,r+l)),Vt=!0,a=OH(a),a.s=o,a},Ce.toPrecision=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?(n=sn(a),r=Rs(a,n<=o.toExpNeg||n>=o.toExpPos)):(no(e,1,Nl),t===void 0?t=o.rounding:no(t,0,8),a=Tt(new o(a),e,t),n=sn(a),r=Rs(a,e<=n||n<=o.toExpNeg,e)),r},Ce.toSignificantDigits=Ce.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(no(e,1,Nl),t===void 0?t=r.rounding:no(t,0,8)),Tt(new r(n),e,t)},Ce.toString=Ce.valueOf=Ce.val=Ce.toJSON=Ce[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=sn(e),n=e.constructor;return Rs(e,t<=n.toExpNeg||t>=n.toExpPos)};function SH(e,t){var n,r,a,o,i,s,c,l,u=e.constructor,d=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Vt?Tt(t,d):t;if(c=e.d,l=t.d,i=e.e,a=t.e,c=c.slice(),o=i-a,o){for(o<0?(r=c,o=-o,s=l.length):(r=l,a=i,s=c.length),i=Math.ceil(d/Ft),s=i>s?i+1:s+1,o>s&&(o=s,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(s=c.length,o=l.length,s-o<0&&(o=s,r=l,l=c,c=r),n=0;o;)n=(c[--o]=c[o]+l[o]+n)/jn|0,c[o]%=jn;for(n&&(c.unshift(n),++a),s=c.length;c[--s]==0;)c.pop();return t.d=c,t.e=a,Vt?Tt(t,d):t}function no(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Ts+e)}function ro(e){var t,n,r,a=e.length-1,o="",i=e[0];if(a>0){for(o+=i,t=1;t<a;t++)r=e[t]+"",n=Ft-r.length,n&&(o+=Fi(n)),o+=r;i=e[t],r=i+"",n=Ft-r.length,n&&(o+=Fi(n))}else if(i===0)return"0";for(;i%10===0;)i/=10;return o+i}var Qo=function(){function e(r,a){var o,i=0,s=r.length;for(r=r.slice();s--;)o=r[s]*a+i,r[s]=o%jn|0,i=o/jn|0;return i&&r.unshift(i),r}function t(r,a,o,i){var s,c;if(o!=i)c=o>i?1:-1;else for(s=c=0;s<o;s++)if(r[s]!=a[s]){c=r[s]>a[s]?1:-1;break}return c}function n(r,a,o){for(var i=0;o--;)r[o]-=i,i=r[o]<a[o]?1:0,r[o]=i*jn+r[o]-a[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,o,i){var s,c,l,u,d,p,f,m,y,v,b,w,_,x,j,E,S,O,N=r.constructor,M=r.s==a.s?1:-1,k=r.d,A=a.d;if(!r.s)return new N(r);if(!a.s)throw Error(Br+"Division by zero");for(c=r.e-a.e,S=A.length,j=k.length,f=new N(M),m=f.d=[],l=0;A[l]==(k[l]||0);)++l;if(A[l]>(k[l]||0)&&--c,o==null?w=o=N.precision:i?w=o+(sn(r)-sn(a))+1:w=o,w<0)return new N(0);if(w=w/Ft+2|0,l=0,S==1)for(u=0,A=A[0],w++;(l<j||u)&&w--;l++)_=u*jn+(k[l]||0),m[l]=_/A|0,u=_%A|0;else{for(u=jn/(A[0]+1)|0,u>1&&(A=e(A,u),k=e(k,u),S=A.length,j=k.length),x=S,y=k.slice(0,S),v=y.length;v<S;)y[v++]=0;O=A.slice(),O.unshift(0),E=A[0],A[1]>=jn/2&&++E;do u=0,s=t(A,y,S,v),s<0?(b=y[0],S!=v&&(b=b*jn+(y[1]||0)),u=b/E|0,u>1?(u>=jn&&(u=jn-1),d=e(A,u),p=d.length,v=y.length,s=t(d,y,p,v),s==1&&(u--,n(d,S<p?O:A,p))):(u==0&&(s=u=1),d=A.slice()),p=d.length,p<v&&d.unshift(0),n(y,d,v),s==-1&&(v=y.length,s=t(A,y,S,v),s<1&&(u++,n(y,S<v?O:A,v))),v=y.length):s===0&&(u++,y=[0]),m[l++]=u,s&&y[0]?y[v++]=k[x]||0:(y=[k[x]],v=1);while((x++<j||y[0]!==void 0)&&w--)}return m[0]||m.shift(),f.e=c,Tt(f,i?o+sn(f)+1:o)}}();function OH(e,t){var n,r,a,o,i,s,c=0,l=0,u=e.constructor,d=u.precision;if(sn(e)>16)throw Error(iN+sn(e));if(!e.s)return new u(Or);for(t==null?(Vt=!1,s=d):s=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),l+=5;for(r=Math.log(Is(2,l))/Math.LN10*2+5|0,s+=r,n=a=o=new u(Or),u.precision=s;;){if(a=Tt(a.times(e),s),n=n.times(++c),i=o.plus(Qo(a,n,s)),ro(i.d).slice(0,s)===ro(o.d).slice(0,s)){for(;l--;)o=Tt(o.times(o),s);return u.precision=d,t==null?(Vt=!0,Tt(o,d)):o}o=i}}function sn(e){for(var t=e.e*Ft,n=e.d[0];n>=10;n/=10)t++;return t}function sN(e,t,n){if(t>e.LN10.sd())throw Vt=!0,n&&(e.precision=n),Error(Br+"LN10 precision limit exceeded");return Tt(new e(e.LN10),t)}function Fi(e){for(var t="";e--;)t+="0";return t}function Dp(e,t){var n,r,a,o,i,s,c,l,u,d=1,p=10,f=e,m=f.d,y=f.constructor,v=y.precision;if(f.s<1)throw Error(Br+(f.s?"NaN":"-Infinity"));if(f.eq(Or))return new y(0);if(t==null?(Vt=!1,l=v):l=t,f.eq(10))return t==null&&(Vt=!0),sN(y,l);if(l+=p,y.precision=l,n=ro(m),r=n.charAt(0),o=sn(f),Math.abs(o)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)f=f.times(e),n=ro(f.d),r=n.charAt(0),d++;o=sn(f),r>1?(f=new y("0."+n),o++):f=new y(r+"."+n.slice(1))}else return c=sN(y,l+2,v).times(o+""),f=Dp(new y(r+"."+n.slice(1)),l-p).plus(c),y.precision=v,t==null?(Vt=!0,Tt(f,v)):f;for(s=i=f=Qo(f.minus(Or),f.plus(Or),l),u=Tt(f.times(f),l),a=3;;){if(i=Tt(i.times(u),l),c=s.plus(Qo(i,new y(a),l)),ro(c.d).slice(0,l)===ro(s.d).slice(0,l))return s=s.times(2),o!==0&&(s=s.plus(sN(y,l+2,v).times(o+""))),s=Qo(s,new y(d),l),y.precision=v,t==null?(Vt=!0,Tt(s,v)):s;s=c,a+=2}}function CH(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=kl(n/Ft),e.d=[],r=(n+1)%Ft,n<0&&(r+=Ft),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=Ft;r<a;)e.d.push(+t.slice(r,r+=Ft));t=t.slice(r),r=Ft-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),Vt&&(e.e>Mg||e.e<-Mg))throw Error(iN+n)}else e.s=0,e.e=0,e.d=[0];return e}function Tt(e,t,n){var r,a,o,i,s,c,l,u,d=e.d;for(i=1,o=d[0];o>=10;o/=10)i++;if(r=t-i,r<0)r+=Ft,a=t,l=d[u=0];else{if(u=Math.ceil((r+1)/Ft),o=d.length,u>=o)return e;for(l=o=d[u],i=1;o>=10;o/=10)i++;r%=Ft,a=r-Ft+i}if(n!==void 0&&(o=Is(10,i-a-1),s=l/o%10|0,c=t<0||d[u+1]!==void 0||l%o,c=n<4?(s||c)&&(n==0||n==(e.s<0?3:2)):s>5||s==5&&(n==4||c||n==6&&(r>0?a>0?l/Is(10,i-a):0:d[u-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return c?(o=sn(e),d.length=1,t=t-o-1,d[0]=Is(10,(Ft-t%Ft)%Ft),e.e=kl(-t/Ft)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=u,o=1,u--):(d.length=u+1,o=Is(10,Ft-r),d[u]=a>0?(l/Is(10,i-a)%Is(10,a)|0)*o:0),c)for(;;)if(u==0){(d[0]+=o)==jn&&(d[0]=1,++e.e);break}else{if(d[u]+=o,d[u]!=jn)break;d[u--]=0,o=1}for(r=d.length;d[--r]===0;)d.pop();if(Vt&&(e.e>Mg||e.e<-Mg))throw Error(iN+sn(e));return e}function NH(e,t){var n,r,a,o,i,s,c,l,u,d,p=e.constructor,f=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),Vt?Tt(t,f):t;if(c=e.d,d=t.d,r=t.e,l=e.e,c=c.slice(),i=l-r,i){for(u=i<0,u?(n=c,i=-i,s=d.length):(n=d,r=l,s=c.length),a=Math.max(Math.ceil(f/Ft),s)+2,i>a&&(i=a,n.length=1),n.reverse(),a=i;a--;)n.push(0);n.reverse()}else{for(a=c.length,s=d.length,u=a<s,u&&(s=a),a=0;a<s;a++)if(c[a]!=d[a]){u=c[a]<d[a];break}i=0}for(u&&(n=c,c=d,d=n,t.s=-t.s),s=c.length,a=d.length-s;a>0;--a)c[s++]=0;for(a=d.length;a>i;){if(c[--a]<d[a]){for(o=a;o&&c[--o]===0;)c[o]=jn-1;--c[o],c[a]+=jn}c[a]-=d[a]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,Vt?Tt(t,f):t):new p(0)}function Rs(e,t,n){var r,a=sn(e),o=ro(e.d),i=o.length;return t?(n&&(r=n-i)>0?o=o.charAt(0)+"."+o.slice(1)+Fi(r):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(a<0?"e":"e+")+a):a<0?(o="0."+Fi(-a-1)+o,n&&(r=n-i)>0&&(o+=Fi(r))):a>=i?(o+=Fi(a+1-i),n&&(r=n-a-1)>0&&(o=o+"."+Fi(r))):((r=a+1)<i&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-i)>0&&(a+1===i&&(o+="."),o+=Fi(r))),e.s<0?"-"+o:o}function kH(e,t){if(e.length>t)return e.length=t,!0}function MH(e){var t,n,r;function a(o){var i=this;if(!(i instanceof a))return new a(o);if(i.constructor=a,o instanceof a){i.s=o.s,i.e=o.e,i.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(Ts+o);if(o>0)i.s=1;else if(o<0)o=-o,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(o===~~o&&o<1e7){i.e=0,i.d=[o];return}return CH(i,o.toString())}else if(typeof o!="string")throw Error(Ts+o);if(o.charCodeAt(0)===45?(o=o.slice(1),i.s=-1):i.s=1,rNe.test(o))CH(i,o);else throw Error(Ts+o)}if(a.prototype=Ce,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=MH,a.config=a.set=aNe,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return a.config(e),a}function aNe(e){if(!e||typeof e!="object")throw Error(Br+"Object expected");var t,n,r,a=["precision",1,Nl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((r=e[n=a[t]])!==void 0)if(kl(r)===r&&r>=a[t+1]&&r<=a[t+2])this[n]=r;else throw Error(Ts+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Ts+n+": "+r);return this}var cN=MH(nNe);Or=new cN(1);const At=cN;function oNe(e){return lNe(e)||cNe(e)||sNe(e)||iNe()}function iNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sNe(e,t){if(e){if(typeof e=="string")return lN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lN(e,t)}}function cNe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function lNe(e){if(Array.isArray(e))return lN(e)}function lN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var uNe=function(e){return e},AH={"@@functional/placeholder":!0},PH=function(e){return e===AH},TH=function(e){return function t(){return arguments.length===0||arguments.length===1&&PH(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},dNe=function e(t,n){return t===1?n:TH(function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var i=a.filter(function(s){return s!==AH}).length;return i>=t?n.apply(void 0,a):e(t-i,TH(function(){for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=a.map(function(d){return PH(d)?c.shift():d});return n.apply(void 0,oNe(u).concat(c))}))})},Ag=function(e){return dNe(e.length,e)},uN=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},pNe=Ag(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),fNe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return uNe;var r=t.reverse(),a=r[0],o=r.slice(1);return function(){return o.reduce(function(i,s){return s(i)},a.apply(void 0,arguments))}},dN=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},IH=function(e){var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t&&a.every(function(i,s){return i===t[s]})||(t=a,n=e.apply(void 0,a)),n}};function hNe(e){var t;return e===0?t=1:t=Math.floor(new At(e).abs().log(10).toNumber())+1,t}function mNe(e,t,n){for(var r=new At(e),a=0,o=[];r.lt(t)&&a<1e5;)o.push(r.toNumber()),r=r.add(n),a++;return o}var yNe=Ag(function(e,t,n){var r=+e,a=+t;return r+n*(a-r)}),gNe=Ag(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),vNe=Ag(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const Pg={rangeStep:mNe,getDigitCount:hNe,interpolateNumber:yNe,uninterpolateNumber:gNe,uninterpolateTruncation:vNe};function pN(e){return xNe(e)||wNe(e)||RH(e)||bNe()}function bNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wNe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function xNe(e){if(Array.isArray(e))return fN(e)}function Lp(e,t){return ENe(e)||jNe(e,t)||RH(e,t)||_Ne()}function _Ne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RH(e,t){if(e){if(typeof e=="string")return fN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fN(e,t)}}function fN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jNe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),s;!(r=(s=i.next()).done)&&(n.push(s.value),!(t&&n.length===t));r=!0);}catch(c){a=!0,o=c}finally{try{!r&&i.return!=null&&i.return()}finally{if(a)throw o}}return n}}function ENe(e){if(Array.isArray(e))return e}function DH(e){var t=Lp(e,2),n=t[0],r=t[1],a=n,o=r;return n>r&&(a=r,o=n),[a,o]}function LH(e,t,n){if(e.lte(0))return new At(0);var r=Pg.getDigitCount(e.toNumber()),a=new At(10).pow(r),o=e.div(a),i=r!==1?.05:.1,s=new At(Math.ceil(o.div(i).toNumber())).add(n).mul(i),c=s.mul(a);return t?c:new At(Math.ceil(c))}function SNe(e,t,n){var r=1,a=new At(e);if(!a.isint()&&n){var o=Math.abs(e);o<1?(r=new At(10).pow(Pg.getDigitCount(e)-1),a=new At(Math.floor(a.div(r).toNumber())).mul(r)):o>1&&(a=new At(Math.floor(e)))}else e===0?a=new At(Math.floor((t-1)/2)):n||(a=new At(Math.floor(e)));var i=Math.floor((t-1)/2),s=fNe(pNe(function(c){return a.add(new At(c-i).mul(r)).toNumber()}),uN);return s(0,t)}function $H(e,t,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new At(0),tickMin:new At(0),tickMax:new At(0)};var o=LH(new At(t).sub(e).div(n-1),r,a),i;e<=0&&t>=0?i=new At(0):(i=new At(e).add(t).div(2),i=i.sub(new At(i).mod(o)));var s=Math.ceil(i.sub(e).div(o).toNumber()),c=Math.ceil(new At(t).sub(i).div(o).toNumber()),l=s+c+1;return l>n?$H(e,t,n,r,a+1):(l<n&&(c=t>0?c+(n-l):c,s=t>0?s:s+(n-l)),{step:o,tickMin:i.sub(new At(s).mul(o)),tickMax:i.add(new At(c).mul(o))})}function ONe(e){var t=Lp(e,2),n=t[0],r=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),s=DH([n,r]),c=Lp(s,2),l=c[0],u=c[1];if(l===-1/0||u===1/0){var d=u===1/0?[l].concat(pN(uN(0,a-1).map(function(){return 1/0}))):[].concat(pN(uN(0,a-1).map(function(){return-1/0})),[u]);return n>r?dN(d):d}if(l===u)return SNe(l,a,o);var p=$H(l,u,i,o),f=p.step,m=p.tickMin,y=p.tickMax,v=Pg.rangeStep(m,y.add(new At(.1).mul(f)),f);return n>r?dN(v):v}function CNe(e,t){var n=Lp(e,2),r=n[0],a=n[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=DH([r,a]),s=Lp(i,2),c=s[0],l=s[1];if(c===-1/0||l===1/0)return[r,a];if(c===l)return[c];var u=Math.max(t,2),d=LH(new At(l).sub(c).div(u-1),o,0),p=[].concat(pN(Pg.rangeStep(new At(c),new At(l).sub(new At(.99).mul(d)),d)),[l]);return r>a?dN(p):p}var NNe=IH(ONe),kNe=IH(CNe),MNe="Invariant failed";function Ds(e,t){throw new Error(MNe)}var ANe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ml(e){"@babel/helpers - typeof";return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ml(e)}function Tg(){return Tg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tg.apply(this,arguments)}function PNe(e,t){return DNe(e)||RNe(e,t)||INe(e,t)||TNe()}function TNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function INe(e,t){if(e){if(typeof e=="string")return FH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FH(e,t)}}function FH(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function RNe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function DNe(e){if(Array.isArray(e))return e}function LNe(e,t){if(e==null)return{};var n=$Ne(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function $Ne(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function FNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BNe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,UH(r.key),r)}}function zNe(e,t,n){return t&&BNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function UNe(e,t,n){return t=Ig(t),VNe(e,BH()?Reflect.construct(t,n||[],Ig(e).constructor):t.apply(e,n))}function VNe(e,t){if(t&&(Ml(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WNe(e)}function WNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BH=function(){return!!e})()}function Ig(e){return Ig=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ig(e)}function HNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hN(e,t)}function hN(e,t){return hN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},hN(e,t)}function zH(e,t,n){return t=UH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UH(e){var t=qNe(e,"string");return Ml(t)=="symbol"?t:t+""}function qNe(e,t){if(Ml(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ml(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rg=function(e){function t(){return FNe(this,t),UNe(this,t,arguments)}return HNe(t,e),zNe(t,[{key:"render",value:function(){var n=this.props,r=n.offset,a=n.layout,o=n.width,i=n.dataKey,s=n.data,c=n.dataPointFormatter,l=n.xAxis,u=n.yAxis,d=LNe(n,ANe),p=bt(d,!1);this.props.direction==="x"&&l.type!=="number"&&Ds();var f=s.map(function(m){var y=c(m,i),v=y.x,b=y.y,w=y.value,_=y.errorVal;if(!_)return null;var x=[],j,E;if(Array.isArray(_)){var S=PNe(_,2);j=S[0],E=S[1]}else j=E=_;if(a==="vertical"){var O=l.scale,N=b+r,M=N+o,k=N-o,A=O(w-j),P=O(w+E);x.push({x1:P,y1:M,x2:P,y2:k}),x.push({x1:A,y1:N,x2:P,y2:N}),x.push({x1:A,y1:M,x2:A,y2:k})}else if(a==="horizontal"){var C=u.scale,T=v+r,I=T-o,R=T+o,L=C(w-j),D=C(w+E);x.push({x1:I,y1:D,x2:R,y2:D}),x.push({x1:T,y1:L,x2:T,y2:D}),x.push({x1:I,y1:L,x2:R,y2:L})}return q.createElement(xn,Tg({className:"recharts-errorBar",key:"bar-".concat(x.map(function(z){return"".concat(z.x1,"-").concat(z.x2,"-").concat(z.y1,"-").concat(z.y2)}))},p),x.map(function(z){return q.createElement("line",Tg({},z,{key:"line-".concat(z.x1,"-").concat(z.x2,"-").concat(z.y1,"-").concat(z.y2)}))}))});return q.createElement(xn,{className:"recharts-errorBars"},f)}}])}(q.Component);zH(Rg,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),zH(Rg,"displayName","ErrorBar");function $p(e){"@babel/helpers - typeof";return $p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$p(e)}function VH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ls(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VH(Object(n),!0).forEach(function(r){KNe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function KNe(e,t,n){return t=ZNe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZNe(e){var t=GNe(e,"string");return $p(t)=="symbol"?t:t+""}function GNe(e,t){if($p(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($p(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WH=function(e){var t=e.children,n=e.formattedGraphicalItems,r=e.legendWidth,a=e.legendContent,o=Sr(t,bl);if(!o)return null;var i=bl.defaultProps,s=i!==void 0?Ls(Ls({},i),o.props):{},c;return o.props&&o.props.payload?c=o.props&&o.props.payload:a==="children"?c=(n||[]).reduce(function(l,u){var d=u.item,p=u.props,f=p.sectors||p.data||[];return l.concat(f.map(function(m){return{type:o.props.iconType||d.props.legendType,value:m.name,color:m.fill,payload:m}}))},[]):c=(n||[]).map(function(l){var u=l.item,d=u.type.defaultProps,p=d!==void 0?Ls(Ls({},d),u.props):{},f=p.dataKey,m=p.name,y=p.legendType,v=p.hide;return{inactive:v,dataKey:f,type:s.iconType||y||"square",color:yN(u),value:m||f,payload:p}}),Ls(Ls(Ls({},s),bl.getWithHeight(o,r)),{},{payload:c,item:o})};function Fp(e){"@babel/helpers - typeof";return Fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fp(e)}function HH(e){return QNe(e)||YNe(e)||JNe(e)||XNe()}function XNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JNe(e,t){if(e){if(typeof e=="string")return mN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mN(e,t)}}function YNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QNe(e){if(Array.isArray(e))return mN(e)}function mN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qH(Object(n),!0).forEach(function(r){Al(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Al(e,t,n){return t=eke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eke(e){var t=tke(e,"string");return Fp(t)=="symbol"?t:t+""}function tke(e,t){if(Fp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Fp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ao(e,t,n){return wt(e)||wt(t)?n:hn(t)?Ir(e,t,n):at(t)?t(e):n}function Dg(e,t,n,r){var a=QCe(e,function(s){return ao(s,t)});if(n==="number"){var o=a.filter(function(s){return ye(s)||parseFloat(s)});return o.length?[kg(o),Ng(o)]:[1/0,-1/0]}var i=r?a.filter(function(s){return!wt(s)}):a;return i.map(function(s){return hn(s)||s instanceof Date?s:""})}var nke=function(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,i=(t=n==null?void 0:n.length)!==null&&t!==void 0?t:0;if(i<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var s=a.range,c=0;c<i;c++){var l=c>0?r[c-1].coordinate:r[i-1].coordinate,u=r[c].coordinate,d=c>=i-1?r[0].coordinate:r[c+1].coordinate,p=void 0;if(Oa(u-l)!==Oa(d-u)){var f=[];if(Oa(d-u)===Oa(s[1]-s[0])){p=d;var m=u+s[1]-s[0];f[0]=Math.min(m,(m+l)/2),f[1]=Math.max(m,(m+l)/2)}else{p=l;var y=d+s[1]-s[0];f[0]=Math.min(u,(y+u)/2),f[1]=Math.max(u,(y+u)/2)}var v=[Math.min(u,(p+u)/2),Math.max(u,(p+u)/2)];if(e>v[0]&&e<=v[1]||e>=f[0]&&e<=f[1]){o=r[c].index;break}}else{var b=Math.min(l,d),w=Math.max(l,d);if(e>(b+u)/2&&e<=(w+u)/2){o=r[c].index;break}}}else for(var _=0;_<i;_++)if(_===0&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_>0&&_<i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_===i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2){o=n[_].index;break}return o},yN=function(e){var t,n=e,r=n.type.displayName,a=(t=e.type)!==null&&t!==void 0&&t.defaultProps?Yt(Yt({},e.type.defaultProps),e.props):e.props,o=a.stroke,i=a.fill,s;switch(r){case"Line":s=o;break;case"Area":case"Radar":s=o&&o!=="none"?o:i;break;default:s=i;break}return s},rke=function(e){var t=e.barSize,n=e.totalSize,r=e.stackGroups,a=r===void 0?{}:r;if(!a)return{};for(var o={},i=Object.keys(a),s=0,c=i.length;s<c;s++)for(var l=a[i[s]].stackGroups,u=Object.keys(l),d=0,p=u.length;d<p;d++){var f=l[u[d]],m=f.items,y=f.cateAxisId,v=m.filter(function(E){return Wo(E.type).indexOf("Bar")>=0});if(v&&v.length){var b=v[0].type.defaultProps,w=b!==void 0?Yt(Yt({},b),v[0].props):v[0].props,_=w.barSize,x=w[y];o[x]||(o[x]=[]);var j=wt(_)?t:_;o[x].push({item:v[0],stackList:v.slice(1),barSize:wt(j)?void 0:Ns(j,n,0)})}}return o},ake=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,a=e.sizeList,o=a===void 0?[]:a,i=e.maxBarSize,s=o.length;if(s<1)return null;var c=Ns(t,r,0,!0),l,u=[];if(o[0].barSize===+o[0].barSize){var d=!1,p=r/s,f=o.reduce(function(_,x){return _+x.barSize||0},0);f+=(s-1)*c,f>=r&&(f-=(s-1)*c,c=0),f>=r&&p>0&&(d=!0,p*=.9,f=s*p);var m=(r-f)/2>>0,y={offset:m-c,size:0};l=o.reduce(function(_,x){var j={item:x.item,position:{offset:y.offset+y.size+c,size:d?p:x.barSize}},E=[].concat(HH(_),[j]);return y=E[E.length-1].position,x.stackList&&x.stackList.length&&x.stackList.forEach(function(S){E.push({item:S,position:y})}),E},u)}else{var v=Ns(n,r,0,!0);r-2*v-(s-1)*c<=0&&(c=0);var b=(r-2*v-(s-1)*c)/s;b>1&&(b>>=0);var w=i===+i?Math.min(b,i):b;l=o.reduce(function(_,x,j){var E=[].concat(HH(_),[{item:x.item,position:{offset:v+(b+c)*j+(b-w)/2,size:w}}]);return x.stackList&&x.stackList.length&&x.stackList.forEach(function(S){E.push({item:S,position:E[E.length-1].position})}),E},u)}return l},oke=function(e,t,n,r){var a=n.children,o=n.width,i=n.margin,s=o-(i.left||0)-(i.right||0),c=WH({children:a,legendWidth:s});if(c){var l=r||{},u=l.width,d=l.height,p=c.align,f=c.verticalAlign,m=c.layout;if((m==="vertical"||m==="horizontal"&&f==="middle")&&p!=="center"&&ye(e[p]))return Yt(Yt({},e),{},Al({},p,e[p]+(u||0)));if((m==="horizontal"||m==="vertical"&&p==="center")&&f!=="middle"&&ye(e[f]))return Yt(Yt({},e),{},Al({},f,e[f]+(d||0)))}return e},ike=function(e,t,n){return wt(t)?!0:e==="horizontal"?t==="yAxis":e==="vertical"||n==="x"?t==="xAxis":n==="y"?t==="yAxis":!0},KH=function(e,t,n,r,a){var o=t.props.children,i=Ca(o,Rg).filter(function(c){return ike(r,a,c.props.direction)});if(i&&i.length){var s=i.map(function(c){return c.props.dataKey});return e.reduce(function(c,l){var u=ao(l,n);if(wt(u))return c;var d=Array.isArray(u)?[kg(u),Ng(u)]:[u,u],p=s.reduce(function(f,m){var y=ao(l,m,0),v=d[0]-Math.abs(Array.isArray(y)?y[0]:y),b=d[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(v,f[0]),Math.max(b,f[1])]},[1/0,-1/0]);return[Math.min(p[0],c[0]),Math.max(p[1],c[1])]},[1/0,-1/0])}return null},ske=function(e,t,n,r,a){var o=t.map(function(i){return KH(e,i,n,a,r)}).filter(function(i){return!wt(i)});return o&&o.length?o.reduce(function(i,s){return[Math.min(i[0],s[0]),Math.max(i[1],s[1])]},[1/0,-1/0]):null},ZH=function(e,t,n,r,a){var o=t.map(function(s){var c=s.props.dataKey;return n==="number"&&c&&KH(e,s,c,r)||Dg(e,c,n,a)});if(n==="number")return o.reduce(function(s,c){return[Math.min(s[0],c[0]),Math.max(s[1],c[1])]},[1/0,-1/0]);var i={};return o.reduce(function(s,c){for(var l=0,u=c.length;l<u;l++)i[c[l]]||(i[c[l]]=!0,s.push(c[l]));return s},[])},GH=function(e,t){return e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis"},XH=function(e,t,n,r){if(r)return e.map(function(s){return s.coordinate});var a,o,i=e.map(function(s){return s.coordinate===t&&(a=!0),s.coordinate===n&&(o=!0),s.coordinate});return a||i.push(t),o||i.push(n),i},ei=function(e,t,n){if(!e)return null;var r=e.scale,a=e.duplicateDomain,o=e.type,i=e.range,s=e.realScaleType==="scaleBand"?r.bandwidth()/2:2,c=(t||n)&&o==="category"&&r.bandwidth?r.bandwidth()/s:0;if(c=e.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?Oa(i[0]-i[1])*2*c:c,t&&(e.ticks||e.niceTicks)){var l=(e.ticks||e.niceTicks).map(function(u){var d=a?a.indexOf(u):u;return{coordinate:r(d)+c,value:u,offset:c}});return l.filter(function(u){return!yp(u.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(u,d){return{coordinate:r(u)+c,value:u,index:d,offset:c}}):r.ticks&&!n?r.ticks(e.tickCount).map(function(u){return{coordinate:r(u)+c,value:u,offset:c}}):r.domain().map(function(u,d){return{coordinate:r(u)+c,value:a?a[u]:u,index:d,offset:c}})},gN=new WeakMap,Lg=function(e,t){if(typeof t!="function")return e;gN.has(e)||gN.set(e,new WeakMap);var n=gN.get(e);if(n.has(t))return n.get(t);var r=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return n.set(t,r),r},cke=function(e,t,n){var r=e.scale,a=e.type,o=e.layout,i=e.axisType;if(r==="auto")return o==="radial"&&i==="radiusAxis"?{scale:Np(),realScaleType:"band"}:o==="radial"&&i==="angleAxis"?{scale:bg(),realScaleType:"linear"}:a==="category"&&t&&(t.indexOf("LineChart")>=0||t.indexOf("AreaChart")>=0||t.indexOf("ComposedChart")>=0&&!n)?{scale:kp(),realScaleType:"point"}:a==="category"?{scale:Np(),realScaleType:"band"}:{scale:bg(),realScaleType:"linear"};if(mp(r)){var s="scale".concat(Zy(r));return{scale:(hH[s]||kp)(),realScaleType:hH[s]?s:"point"}}return at(r)?{scale:r}:{scale:kp(),realScaleType:"point"}},JH=1e-4,lke=function(e){var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-JH,o=Math.max(r[0],r[1])+JH,i=e(t[0]),s=e(t[n-1]);(i<a||i>o||s<a||s>o)&&e.domain([t[0],t[n-1]])}},uke=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null},dke=function(e,t){if(!t||t.length!==2||!ye(t[0])||!ye(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!ye(e[0])||e[0]<n)&&(a[0]=n),(!ye(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a},pke=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0,i=0;i<t;++i){var s=yp(e[i][n][1])?e[i][n][0]:e[i][n][1];s>=0?(e[i][n][0]=a,e[i][n][1]=a+s,a=e[i][n][1]):(e[i][n][0]=o,e[i][n][1]=o+s,o=e[i][n][1])}},fke=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0;o<t;++o){var i=yp(e[o][n][1])?e[o][n][0]:e[o][n][1];i>=0?(e[o][n][0]=a,e[o][n][1]=a+i,a=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}},hke={sign:pke,expand:mje,none:yl,silhouette:yje,wiggle:gje,positive:fke},mke=function(e,t,n){var r=t.map(function(i){return i.props.dataKey}),a=hke[n],o=hje().keys(r).value(function(i,s){return+ao(i,s,0)}).order(SO).offset(a);return o(e)},yke=function(e,t,n,r,a,o){if(!e)return null;var i=o?t.reverse():t,s={},c=i.reduce(function(u,d){var p,f=(p=d.type)!==null&&p!==void 0&&p.defaultProps?Yt(Yt({},d.type.defaultProps),d.props):d.props,m=f.stackId,y=f.hide;if(y)return u;var v=f[n],b=u[v]||{hasStack:!1,stackGroups:{}};if(hn(m)){var w=b.stackGroups[m]||{numericAxisId:n,cateAxisId:r,items:[]};w.items.push(d),b.hasStack=!0,b.stackGroups[m]=w}else b.stackGroups[Hy("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[d]};return Yt(Yt({},u),{},Al({},v,b))},s),l={};return Object.keys(c).reduce(function(u,d){var p=c[d];if(p.hasStack){var f={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(m,y){var v=p.stackGroups[y];return Yt(Yt({},m),{},Al({},y,{numericAxisId:n,cateAxisId:r,items:v.items,stackedData:mke(e,v.items,a)}))},f)}return Yt(Yt({},u),{},Al({},d,p))},l)},gke=function(e,t){var n=t.realScaleType,r=t.type,a=t.tickCount,o=t.originalDomain,i=t.allowDecimals,s=n||t.scale;if(s!=="auto"&&s!=="linear")return null;if(a&&r==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=e.domain();if(!c.length)return null;var l=NNe(c,a,i);return e.domain([kg(l),Ng(l)]),{niceTicks:l}}if(a&&r==="number"){var u=e.domain(),d=kNe(u,a,i);return{niceTicks:d}}return null},YH=function(e){var t=e.axis,n=e.ticks,r=e.offset,a=e.bandSize,o=e.entry,i=e.index;if(t.type==="category")return n[i]?n[i].coordinate+r:null;var s=ao(o,t.dataKey,t.domain[i]);return wt(s)?null:t.scale(s)-a/2+r},vke=function(e){var t=e.numericAxis,n=t.scale.domain();if(t.type==="number"){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]},bke=function(e,t){var n,r=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Yt(Yt({},e.type.defaultProps),e.props):e.props,a=r.stackId;if(hn(a)){var o=t[a];if(o){var i=o.items.indexOf(e);return i>=0?o.stackedData[i]:null}}return null},wke=function(e){return e.reduce(function(t,n){return[kg(n.concat([t[0]]).filter(ye)),Ng(n.concat([t[1]]).filter(ye))]},[1/0,-1/0])},QH=function(e,t,n){return Object.keys(e).reduce(function(r,a){var o=e[a],i=o.stackedData,s=i.reduce(function(c,l){var u=wke(l.slice(t,n+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]).map(function(r){return r===1/0||r===-1/0?0:r})},eq=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,tq=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,vN=function(e,t,n){if(at(e))return e(t,n);if(!Array.isArray(e))return t;var r=[];if(ye(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(eq.test(e[0])){var a=+eq.exec(e[0])[1];r[0]=t[0]-a}else at(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(ye(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(tq.test(e[1])){var o=+tq.exec(e[1])[1];r[1]=t[1]+o}else at(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},$g=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=lC(t,function(u){return u.coordinate}),o=1/0,i=1,s=a.length;i<s;i++){var c=a[i],l=a[i-1];o=Math.min((c.coordinate||0)-(l.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},nq=function(e,t,n){return!e||!e.length||oN(e,Ir(n,"type.defaultProps.domain"))?t:e},rq=function(e,t){var n=e.type.defaultProps?Yt(Yt({},e.type.defaultProps),e.props):e.props,r=n.dataKey,a=n.name,o=n.unit,i=n.formatter,s=n.tooltipType,c=n.chartType,l=n.hide;return Yt(Yt({},bt(e,!1)),{},{dataKey:r,unit:o,formatter:i,name:a||r,color:yN(e),value:ao(t,r),type:s,payload:t,chartType:c,hide:l})};function Bp(e){"@babel/helpers - typeof";return Bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bp(e)}function aq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function oq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aq(Object(n),!0).forEach(function(r){xke(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xke(e,t,n){return t=_ke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _ke(e){var t=jke(e,"string");return Bp(t)=="symbol"?t:t+""}function jke(e,t){if(Bp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fg=Math.PI/180,Eke=function(e){return e*180/Math.PI},Pn=function(e,t,n,r){return{x:e+Math.cos(-Fg*r)*n,y:t+Math.sin(-Fg*r)*n}},Ske=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-o,2))},Oke=function(e,t){var n=e.x,r=e.y,a=t.cx,o=t.cy,i=Ske({x:n,y:r},{x:a,y:o});if(i<=0)return{radius:i};var s=(n-a)/i,c=Math.acos(s);return r>o&&(c=2*Math.PI-c),{radius:i,angle:Eke(c),angleInRadian:c}},Cke=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),a=Math.floor(n/360),o=Math.min(r,a);return{startAngle:t-o*360,endAngle:n-o*360}},Nke=function(e,t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),o=Math.floor(r/360),i=Math.min(a,o);return e+i*360},iq=function(e,t){var n=e.x,r=e.y,a=Oke({x:n,y:r},t),o=a.radius,i=a.angle,s=t.innerRadius,c=t.outerRadius;if(o<s||o>c)return!1;if(o===0)return!0;var l=Cke(t),u=l.startAngle,d=l.endAngle,p=i,f;if(u<=d){for(;p>d;)p-=360;for(;p<u;)p+=360;f=p>=u&&p<=d}else{for(;p>u;)p-=360;for(;p<d;)p+=360;f=p>=d&&p<=u}return f?oq(oq({},t),{},{radius:o,angle:Nke(p,t)}):null};function zp(e){"@babel/helpers - typeof";return zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zp(e)}var kke=["offset"];function Mke(e){return Ike(e)||Tke(e)||Pke(e)||Ake()}function Ake(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pke(e,t){if(e){if(typeof e=="string")return bN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bN(e,t)}}function Tke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ike(e){if(Array.isArray(e))return bN(e)}function bN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rke(e,t){if(e==null)return{};var n=Dke(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Dke(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function sq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function yn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sq(Object(n),!0).forEach(function(r){Lke(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Lke(e,t,n){return t=$ke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $ke(e){var t=Fke(e,"string");return zp(t)=="symbol"?t:t+""}function Fke(e,t){if(zp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(zp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Up(){return Up=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Up.apply(this,arguments)}var Bke=function(e){var t=e.value,n=e.formatter,r=wt(e.children)?t:e.children;return at(n)?n(r):r},zke=function(e,t){var n=Oa(t-e),r=Math.min(Math.abs(t-e),360);return n*r},Uke=function(e,t,n){var r=e.position,a=e.viewBox,o=e.offset,i=e.className,s=a,c=s.cx,l=s.cy,u=s.innerRadius,d=s.outerRadius,p=s.startAngle,f=s.endAngle,m=s.clockWise,y=(u+d)/2,v=zke(p,f),b=v>=0?1:-1,w,_;r==="insideStart"?(w=p+b*o,_=m):r==="insideEnd"?(w=f-b*o,_=!m):r==="end"&&(w=f+b*o,_=m),_=v<=0?_:!_;var x=Pn(c,l,y,w),j=Pn(c,l,y,w+(_?1:-1)*359),E="M".concat(x.x,",").concat(x.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(_?0:1,`,
    `).concat(j.x,",").concat(j.y),S=wt(e.id)?Hy("recharts-radial-line-"):e.id;return q.createElement("text",Up({},n,{dominantBaseline:"central",className:Et("recharts-radial-bar-label",i)}),q.createElement("defs",null,q.createElement("path",{id:S,d:E})),q.createElement("textPath",{xlinkHref:"#".concat(S)},t))},Vke=function(e){var t=e.viewBox,n=e.offset,r=e.position,a=t,o=a.cx,i=a.cy,s=a.innerRadius,c=a.outerRadius,l=a.startAngle,u=a.endAngle,d=(l+u)/2;if(r==="outside"){var p=Pn(o,i,c+n,d),f=p.x,m=p.y;return{x:f,y:m,textAnchor:f>=o?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"end"};var y=(s+c)/2,v=Pn(o,i,y,d),b=v.x,w=v.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},Wke=function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,a=e.position,o=t,i=o.x,s=o.y,c=o.width,l=o.height,u=l>=0?1:-1,d=u*r,p=u>0?"end":"start",f=u>0?"start":"end",m=c>=0?1:-1,y=m*r,v=m>0?"end":"start",b=m>0?"start":"end";if(a==="top"){var w={x:i+c/2,y:s-u*r,textAnchor:"middle",verticalAnchor:p};return yn(yn({},w),n?{height:Math.max(s-n.y,0),width:c}:{})}if(a==="bottom"){var _={x:i+c/2,y:s+l+d,textAnchor:"middle",verticalAnchor:f};return yn(yn({},_),n?{height:Math.max(n.y+n.height-(s+l),0),width:c}:{})}if(a==="left"){var x={x:i-y,y:s+l/2,textAnchor:v,verticalAnchor:"middle"};return yn(yn({},x),n?{width:Math.max(x.x-n.x,0),height:l}:{})}if(a==="right"){var j={x:i+c+y,y:s+l/2,textAnchor:b,verticalAnchor:"middle"};return yn(yn({},j),n?{width:Math.max(n.x+n.width-j.x,0),height:l}:{})}var E=n?{width:c,height:l}:{};return a==="insideLeft"?yn({x:i+y,y:s+l/2,textAnchor:b,verticalAnchor:"middle"},E):a==="insideRight"?yn({x:i+c-y,y:s+l/2,textAnchor:v,verticalAnchor:"middle"},E):a==="insideTop"?yn({x:i+c/2,y:s+d,textAnchor:"middle",verticalAnchor:f},E):a==="insideBottom"?yn({x:i+c/2,y:s+l-d,textAnchor:"middle",verticalAnchor:p},E):a==="insideTopLeft"?yn({x:i+y,y:s+d,textAnchor:b,verticalAnchor:f},E):a==="insideTopRight"?yn({x:i+c-y,y:s+d,textAnchor:v,verticalAnchor:f},E):a==="insideBottomLeft"?yn({x:i+y,y:s+l-d,textAnchor:b,verticalAnchor:p},E):a==="insideBottomRight"?yn({x:i+c-y,y:s+l-d,textAnchor:v,verticalAnchor:p},E):fl(a)&&(ye(a.x)||Cs(a.x))&&(ye(a.y)||Cs(a.y))?yn({x:i+Ns(a.x,c),y:s+Ns(a.y,l),textAnchor:"end",verticalAnchor:"end"},E):yn({x:i+c/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},E)},Hke=function(e){return"cx"in e&&ye(e.cx)};function Un(e){var t=e.offset,n=t===void 0?5:t,r=Rke(e,kke),a=yn({offset:n},r),o=a.viewBox,i=a.position,s=a.value,c=a.children,l=a.content,u=a.className,d=u===void 0?"":u,p=a.textBreakAll;if(!o||wt(s)&&wt(c)&&!g.isValidElement(l)&&!at(l))return null;if(g.isValidElement(l))return g.cloneElement(l,a);var f;if(at(l)){if(f=g.createElement(l,a),g.isValidElement(f))return f}else f=Bke(a);var m=Hke(o),y=bt(a,!0);if(m&&(i==="insideStart"||i==="insideEnd"||i==="end"))return Uke(a,f,y);var v=m?Vke(a):Wke(a);return q.createElement(fg,Up({className:Et("recharts-label",d)},y,v,{breakAll:p}),f)}Un.displayName="Label";var cq=function(e){var t=e.cx,n=e.cy,r=e.angle,a=e.startAngle,o=e.endAngle,i=e.r,s=e.radius,c=e.innerRadius,l=e.outerRadius,u=e.x,d=e.y,p=e.top,f=e.left,m=e.width,y=e.height,v=e.clockWise,b=e.labelViewBox;if(b)return b;if(ye(m)&&ye(y)){if(ye(u)&&ye(d))return{x:u,y:d,width:m,height:y};if(ye(p)&&ye(f))return{x:p,y:f,width:m,height:y}}return ye(u)&&ye(d)?{x:u,y:d,width:0,height:0}:ye(t)&&ye(n)?{cx:t,cy:n,startAngle:a||r||0,endAngle:o||r||0,innerRadius:c||0,outerRadius:l||s||i||0,clockWise:v}:e.viewBox?e.viewBox:{}},qke=function(e,t){return e?e===!0?q.createElement(Un,{key:"label-implicit",viewBox:t}):hn(e)?q.createElement(Un,{key:"label-implicit",viewBox:t,value:e}):g.isValidElement(e)?e.type===Un?g.cloneElement(e,{key:"label-implicit",viewBox:t}):q.createElement(Un,{key:"label-implicit",content:e,viewBox:t}):at(e)?q.createElement(Un,{key:"label-implicit",content:e,viewBox:t}):fl(e)?q.createElement(Un,Up({viewBox:t},e,{key:"label-implicit"})):null:null},Kke=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=cq(e),o=Ca(r,Un).map(function(s,c){return g.cloneElement(s,{viewBox:t||a,key:"label-".concat(c)})});if(!n)return o;var i=qke(e.label,t||a);return[i].concat(Mke(o))};Un.parseViewBox=cq,Un.renderCallByParent=Kke;var wN,lq;UM=function(){if(lq)return wN;lq=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return wN=e,wN};var Zke=UM();nM=ct(Zke);function Vp(e){"@babel/helpers - typeof";return Vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vp(e)}var Gke=["valueAccessor"],Xke=["data","dataKey","clockWise","id","textBreakAll"];function Jke(e){return tMe(e)||eMe(e)||Qke(e)||Yke()}function Yke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qke(e,t){if(e){if(typeof e=="string")return xN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xN(e,t)}}function eMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tMe(e){if(Array.isArray(e))return xN(e)}function xN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bg(){return Bg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bg.apply(this,arguments)}function uq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function dq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uq(Object(n),!0).forEach(function(r){nMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nMe(e,t,n){return t=rMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rMe(e){var t=aMe(e,"string");return Vp(t)=="symbol"?t:t+""}function aMe(e,t){if(Vp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Vp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pq(e,t){if(e==null)return{};var n=oMe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var iMe=function(e){return Array.isArray(e.value)?nM(e.value):e.value};function $s(e){var t=e.valueAccessor,n=t===void 0?iMe:t,r=pq(e,Gke),a=r.data,o=r.dataKey,i=r.clockWise,s=r.id,c=r.textBreakAll,l=pq(r,Xke);return!a||!a.length?null:q.createElement(xn,{className:"recharts-label-list"},a.map(function(u,d){var p=wt(o)?n(u,d):ao(u&&u.payload,o),f=wt(s)?{}:{id:"".concat(s,"-").concat(d)};return q.createElement(Un,Bg({},bt(u,!0),l,f,{parentViewBox:u.parentViewBox,value:p,textBreakAll:c,viewBox:Un.parseViewBox(wt(i)?u:dq(dq({},u),{},{clockWise:i})),key:"label-".concat(d),index:d}))}))}$s.displayName="LabelList";function sMe(e,t){return e?e===!0?q.createElement($s,{key:"labelList-implicit",data:t}):q.isValidElement(e)||at(e)?q.createElement($s,{key:"labelList-implicit",data:t,content:e}):fl(e)?q.createElement($s,Bg({data:t},e,{key:"labelList-implicit"})):null:null}function cMe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=Ca(r,$s).map(function(i,s){return g.cloneElement(i,{data:t,key:"labelList-".concat(s)})});if(!n)return a;var o=sMe(e.label,t);return[o].concat(Jke(a))}$s.renderCallByParent=cMe;function Wp(e){"@babel/helpers - typeof";return Wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wp(e)}function _N(){return _N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_N.apply(this,arguments)}function fq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function hq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fq(Object(n),!0).forEach(function(r){lMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function lMe(e,t,n){return t=uMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uMe(e){var t=dMe(e,"string");return Wp(t)=="symbol"?t:t+""}function dMe(e,t){if(Wp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Wp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pMe=function(e,t){var n=Oa(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},zg=function(e){var t=e.cx,n=e.cy,r=e.radius,a=e.angle,o=e.sign,i=e.isExternal,s=e.cornerRadius,c=e.cornerIsExternal,l=s*(i?1:-1)+r,u=Math.asin(s/l)/Fg,d=c?a:a+o*u,p=Pn(t,n,l,d),f=Pn(t,n,r,d),m=c?a-o*u:a,y=Pn(t,n,l*Math.cos(u*Fg),m);return{center:p,circleTangency:f,lineTangency:y,theta:u}},mq=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.startAngle,i=e.endAngle,s=pMe(o,i),c=o+s,l=Pn(t,n,a,o),u=Pn(t,n,a,c),d="M ".concat(l.x,",").concat(l.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(o>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(r>0){var p=Pn(t,n,r,o),f=Pn(t,n,r,c);d+="L ".concat(f.x,",").concat(f.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(o<=c),`,
            `).concat(p.x,",").concat(p.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},fMe=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.cornerRadius,i=e.forceCornerRadius,s=e.cornerIsExternal,c=e.startAngle,l=e.endAngle,u=Oa(l-c),d=zg({cx:t,cy:n,radius:a,angle:c,sign:u,cornerRadius:o,cornerIsExternal:s}),p=d.circleTangency,f=d.lineTangency,m=d.theta,y=zg({cx:t,cy:n,radius:a,angle:l,sign:-u,cornerRadius:o,cornerIsExternal:s}),v=y.circleTangency,b=y.lineTangency,w=y.theta,_=s?Math.abs(c-l):Math.abs(c-l)-m-w;if(_<0)return i?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):mq({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:c,endAngle:l});var x="M ".concat(f.x,",").concat(f.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(_>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(r>0){var j=zg({cx:t,cy:n,radius:r,angle:c,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),E=j.circleTangency,S=j.lineTangency,O=j.theta,N=zg({cx:t,cy:n,radius:r,angle:l,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),M=N.circleTangency,k=N.lineTangency,A=N.theta,P=s?Math.abs(c-l):Math.abs(c-l)-O-A;if(P<0&&o===0)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(k.x,",").concat(k.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(M.x,",").concat(M.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(P>180),",").concat(+(u>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(S.x,",").concat(S.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x},hMe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},yq=function(e){var t=hq(hq({},hMe),e),n=t.cx,r=t.cy,a=t.innerRadius,o=t.outerRadius,i=t.cornerRadius,s=t.forceCornerRadius,c=t.cornerIsExternal,l=t.startAngle,u=t.endAngle,d=t.className;if(o<a||l===u)return null;var p=Et("recharts-sector",d),f=o-a,m=Ns(i,f,0,!0),y;return m>0&&Math.abs(l-u)<360?y=fMe({cx:n,cy:r,innerRadius:a,outerRadius:o,cornerRadius:Math.min(m,f/2),forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u}):y=mq({cx:n,cy:r,innerRadius:a,outerRadius:o,startAngle:l,endAngle:u}),q.createElement("path",_N({},bt(t,!0),{className:p,d:y,role:"img"}))};function Hp(e){"@babel/helpers - typeof";return Hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hp(e)}function jN(){return jN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jN.apply(this,arguments)}function gq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function vq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gq(Object(n),!0).forEach(function(r){mMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function mMe(e,t,n){return t=yMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yMe(e){var t=gMe(e,"string");return Hp(t)=="symbol"?t:t+""}function gMe(e,t){if(Hp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Hp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bq={curveBasisClosed:rje,curveBasisOpen:aje,curveBasis:nje,curveBumpX:U_e,curveBumpY:V_e,curveLinearClosed:oje,curveLinear:Yy,curveMonotoneX:ije,curveMonotoneY:sje,curveNatural:cje,curveStep:lje,curveStepAfter:dje,curveStepBefore:uje},Ug=function(e){return e.x===+e.x&&e.y===+e.y},qp=function(e){return e.x},Kp=function(e){return e.y},vMe=function(e,t){if(at(e))return e;var n="curve".concat(Zy(e));return(n==="curveMonotone"||n==="curveBump")&&t?bq["".concat(n).concat(t==="vertical"?"Y":"X")]:bq[n]||Yy},bMe=function(e){var t=e.type,n=t===void 0?"linear":t,r=e.points,a=r===void 0?[]:r,o=e.baseLine,i=e.layout,s=e.connectNulls,c=s===void 0?!1:s,l=vMe(n,i),u=c?a.filter(function(m){return Ug(m)}):a,d;if(Array.isArray(o)){var p=c?o.filter(function(m){return Ug(m)}):o,f=u.map(function(m,y){return vq(vq({},m),{},{base:p[y]})});return i==="vertical"?d=Qy().y(Kp).x1(qp).x0(function(m){return m.base.x}):d=Qy().x(qp).y1(Kp).y0(function(m){return m.base.y}),d.defined(Ug).curve(l),d(f)}return i==="vertical"&&ye(o)?d=Qy().y(Kp).x1(qp).x0(o):ye(o)?d=Qy().x(qp).y1(Kp).y0(o):d=jU().x(qp).y(Kp),d.defined(Ug).curve(l),d(u)},wq=function(e){var t=e.className,n=e.points,r=e.path,a=e.pathRef;if((!n||!n.length)&&!r)return null;var o=n&&n.length?bMe(e):r;return q.createElement("path",jN({},bt(e,!1),qy(e),{className:Et("recharts-curve",t),d:o,ref:a}))},xq={exports:{}},EN,_q;function wMe(){if(_q)return EN;_q=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return EN=e,EN}var SN,jq;function xMe(){if(jq)return SN;jq=1;var e=wMe();function t(){}function n(){}return n.resetWarningCache=t,SN=function(){function r(i,s,c,l,u,d){if(d!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o},SN}var Eq;function _Me(){return Eq||(Eq=1,xq.exports=xMe()()),xq.exports}var jMe=_Me();const Ze=ct(jMe);var EMe=Object.getOwnPropertyNames,SMe=Object.getOwnPropertySymbols,OMe=Object.prototype.hasOwnProperty;function Sq(e,t){return function(n,r,a){return e(n,r,a)&&t(n,r,a)}}function Vg(e){return function(t,n,r){if(!t||!n||typeof t!="object"||typeof n!="object")return e(t,n,r);var a=r.cache,o=a.get(t),i=a.get(n);if(o&&i)return o===n&&i===t;a.set(t,n),a.set(n,t);var s=e(t,n,r);return a.delete(t),a.delete(n),s}}function Oq(e){return EMe(e).concat(SMe(e))}var Cq=Object.hasOwn||function(e,t){return OMe.call(e,t)};function Pl(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var Nq="_owner",kq=Object.getOwnPropertyDescriptor,Mq=Object.keys;function CMe(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function NMe(e,t){return Pl(e.getTime(),t.getTime())}function Aq(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.entries(),o=0,i,s;(i=a.next())&&!i.done;){for(var c=t.entries(),l=!1,u=0;(s=c.next())&&!s.done;){var d=i.value,p=d[0],f=d[1],m=s.value,y=m[0],v=m[1];!l&&!r[u]&&(l=n.equals(p,y,o,u,e,t,n)&&n.equals(f,v,p,y,e,t,n))&&(r[u]=!0),u++}if(!l)return!1;o++}return!0}function kMe(e,t,n){var r=Mq(e),a=r.length;if(Mq(t).length!==a)return!1;for(var o;a-- >0;)if(o=r[a],o===Nq&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Cq(t,o)||!n.equals(e[o],t[o],o,o,e,t,n))return!1;return!0}function Zp(e,t,n){var r=Oq(e),a=r.length;if(Oq(t).length!==a)return!1;for(var o,i,s;a-- >0;)if(o=r[a],o===Nq&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Cq(t,o)||!n.equals(e[o],t[o],o,o,e,t,n)||(i=kq(e,o),s=kq(t,o),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return!1;return!0}function MMe(e,t){return Pl(e.valueOf(),t.valueOf())}function AMe(e,t){return e.source===t.source&&e.flags===t.flags}function Pq(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.values(),o,i;(o=a.next())&&!o.done;){for(var s=t.values(),c=!1,l=0;(i=s.next())&&!i.done;)!c&&!r[l]&&(c=n.equals(o.value,i.value,o.value,i.value,e,t,n))&&(r[l]=!0),l++;if(!c)return!1}return!0}function PMe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var TMe="[object Arguments]",IMe="[object Boolean]",RMe="[object Date]",DMe="[object Map]",LMe="[object Number]",$Me="[object Object]",FMe="[object RegExp]",BMe="[object Set]",zMe="[object String]",UMe=Array.isArray,Tq=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Iq=Object.assign,VMe=Object.prototype.toString.call.bind(Object.prototype.toString);function WMe(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,a=e.areObjectsEqual,o=e.arePrimitiveWrappersEqual,i=e.areRegExpsEqual,s=e.areSetsEqual,c=e.areTypedArraysEqual;return function(l,u,d){if(l===u)return!0;if(l==null||u==null||typeof l!="object"||typeof u!="object")return l!==l&&u!==u;var p=l.constructor;if(p!==u.constructor)return!1;if(p===Object)return a(l,u,d);if(UMe(l))return t(l,u,d);if(Tq!=null&&Tq(l))return c(l,u,d);if(p===Date)return n(l,u,d);if(p===RegExp)return i(l,u,d);if(p===Map)return r(l,u,d);if(p===Set)return s(l,u,d);var f=VMe(l);return f===RMe?n(l,u,d):f===FMe?i(l,u,d):f===DMe?r(l,u,d):f===BMe?s(l,u,d):f===$Me?typeof l.then!="function"&&typeof u.then!="function"&&a(l,u,d):f===TMe?a(l,u,d):f===IMe||f===LMe||f===zMe?o(l,u,d):!1}}function HMe(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,a={areArraysEqual:r?Zp:CMe,areDatesEqual:NMe,areMapsEqual:r?Sq(Aq,Zp):Aq,areObjectsEqual:r?Zp:kMe,arePrimitiveWrappersEqual:MMe,areRegExpsEqual:AMe,areSetsEqual:r?Sq(Pq,Zp):Pq,areTypedArraysEqual:r?Zp:PMe};if(n&&(a=Iq({},a,n(a))),t){var o=Vg(a.areArraysEqual),i=Vg(a.areMapsEqual),s=Vg(a.areObjectsEqual),c=Vg(a.areSetsEqual);a=Iq({},a,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c})}return a}function qMe(e){return function(t,n,r,a,o,i,s){return e(t,n,s)}}function KMe(e){var t=e.circular,n=e.comparator,r=e.createState,a=e.equals,o=e.strict;if(r)return function(s,c){var l=r(),u=l.cache,d=u===void 0?t?new WeakMap:void 0:u,p=l.meta;return n(s,c,{cache:d,equals:a,meta:p,strict:o})};if(t)return function(s,c){return n(s,c,{cache:new WeakMap,equals:a,meta:void 0,strict:o})};var i={cache:void 0,equals:a,meta:void 0,strict:o};return function(s,c){return n(s,c,i)}}var ZMe=Bi();Bi({strict:!0}),Bi({circular:!0}),Bi({circular:!0,strict:!0}),Bi({createInternalComparator:function(){return Pl}}),Bi({strict:!0,createInternalComparator:function(){return Pl}}),Bi({circular:!0,createInternalComparator:function(){return Pl}}),Bi({circular:!0,createInternalComparator:function(){return Pl},strict:!0});function Bi(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,a=e.createState,o=e.strict,i=o===void 0?!1:o,s=HMe(e),c=WMe(s),l=r?r(c):qMe(c);return KMe({circular:n,comparator:c,createState:a,equals:l,strict:i})}function GMe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Rq(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function a(o){n<0&&(n=o),o-n>t?(e(o),n=-1):GMe(a)};requestAnimationFrame(r)}function ON(e){"@babel/helpers - typeof";return ON=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ON(e)}function XMe(e){return eAe(e)||QMe(e)||YMe(e)||JMe()}function JMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YMe(e,t){if(e){if(typeof e=="string")return Dq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dq(e,t)}}function Dq(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function QMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eAe(e){if(Array.isArray(e))return e}function tAe(){var e={},t=function(){return null},n=!1,r=function a(o){if(!n){if(Array.isArray(o)){if(!o.length)return;var i=o,s=XMe(i),c=s[0],l=s.slice(1);if(typeof c=="number"){Rq(a.bind(null,l),c);return}a(c),Rq(a.bind(null,l));return}ON(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){n=!0},start:function(a){n=!1,r(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function Gp(e){"@babel/helpers - typeof";return Gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gp(e)}function Lq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function $q(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Lq(Object(n),!0).forEach(function(r){Fq(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fq(e,t,n){return t=nAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nAe(e){var t=rAe(e,"string");return Gp(t)==="symbol"?t:String(t)}function rAe(e,t){if(Gp(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Gp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aAe=function(e,t){return[Object.keys(e),Object.keys(t)].reduce(function(n,r){return n.filter(function(a){return r.includes(a)})})},oAe=function(e){return e},iAe=function(e){return e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})},Xp=function(e,t){return Object.keys(t).reduce(function(n,r){return $q($q({},n),{},Fq({},r,e(r,t[r])))},{})},Bq=function(e,t,n){return e.map(function(r){return"".concat(iAe(r)," ").concat(t,"ms ").concat(n)}).join(",")};function sAe(e,t){return uAe(e)||lAe(e,t)||zq(e,t)||cAe()}function cAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function uAe(e){if(Array.isArray(e))return e}function dAe(e){return hAe(e)||fAe(e)||zq(e)||pAe()}function pAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zq(e,t){if(e){if(typeof e=="string")return CN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CN(e,t)}}function fAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hAe(e){if(Array.isArray(e))return CN(e)}function CN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wg=1e-4,Uq=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},Vq=function(e,t){return e.map(function(n,r){return n*Math.pow(t,r)}).reduce(function(n,r){return n+r})},Wq=function(e,t){return function(n){var r=Uq(e,t);return Vq(r,n)}},mAe=function(e,t){return function(n){var r=Uq(e,t),a=[].concat(dAe(r.map(function(o,i){return o*i}).slice(1)),[0]);return Vq(a,n)}},Hq=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],o=t[2],i=t[3];if(t.length===1)switch(t[0]){case"linear":r=0,a=0,o=1,i=1;break;case"ease":r=.25,a=.1,o=.25,i=1;break;case"ease-in":r=.42,a=0,o=1,i=1;break;case"ease-out":r=.42,a=0,o=.58,i=1;break;case"ease-in-out":r=0,a=0,o=.58,i=1;break;default:{var s=t[0].split("(");if(s[0]==="cubic-bezier"&&s[1].split(")")[0].split(",").length===4){var c=s[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),l=sAe(c,4);r=l[0],a=l[1],o=l[2],i=l[3]}}}var u=Wq(r,o),d=Wq(a,i),p=mAe(r,o),f=function(y){return y>1?1:y<0?0:y},m=function(y){for(var v=y>1?1:y,b=v,w=0;w<8;++w){var _=u(b)-v,x=p(b);if(Math.abs(_-v)<Wg||x<Wg)return d(b);b=f(b-_/x)}return d(b)};return m.isStepper=!1,m},yAe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.stiff,n=t===void 0?100:t,r=e.damping,a=r===void 0?8:r,o=e.dt,i=o===void 0?17:o,s=function(c,l,u){var d=-(c-l)*n,p=u*a,f=u+(d-p)*i/1e3,m=u*i/1e3+c;return Math.abs(m-l)<Wg&&Math.abs(f)<Wg?[l,0]:[m,f]};return s.isStepper=!0,s.dt=i,s},gAe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if(typeof r=="string")switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Hq(r);case"spring":return yAe();default:if(r.split("(")[0]==="cubic-bezier")return Hq(r)}return typeof r=="function"?r:null};function Jp(e){"@babel/helpers - typeof";return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jp(e)}function qq(e){return wAe(e)||bAe(e)||Zq(e)||vAe()}function vAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wAe(e){if(Array.isArray(e))return kN(e)}function Kq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Tn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Kq(Object(n),!0).forEach(function(r){NN(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function NN(e,t,n){return t=xAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xAe(e){var t=_Ae(e,"string");return Jp(t)==="symbol"?t:String(t)}function _Ae(e,t){if(Jp(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Jp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jAe(e,t){return OAe(e)||SAe(e,t)||Zq(e,t)||EAe()}function EAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zq(e,t){if(e){if(typeof e=="string")return kN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kN(e,t)}}function kN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function SAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function OAe(e){if(Array.isArray(e))return e}var Hg=function(e,t,n){return e+(t-e)*n},MN=function(e){var t=e.from,n=e.to;return t!==n},CAe=function e(t,n,r){var a=Xp(function(o,i){if(MN(i)){var s=t(i.from,i.to,i.velocity),c=jAe(s,2),l=c[0],u=c[1];return Tn(Tn({},i),{},{from:l,velocity:u})}return i},n);return r<1?Xp(function(o,i){return MN(i)?Tn(Tn({},i),{},{velocity:Hg(i.velocity,a[o].velocity,r),from:Hg(i.from,a[o].from,r)}):i},n):e(t,a,r-1)};const NAe=function(e,t,n,r,a){var o=aAe(e,t),i=o.reduce(function(v,b){return Tn(Tn({},v),{},NN({},b,[e[b],t[b]]))},{}),s=o.reduce(function(v,b){return Tn(Tn({},v),{},NN({},b,{from:e[b],velocity:0,to:t[b]}))},{}),c=-1,l,u,d=function(){return null},p=function(){return Xp(function(v,b){return b.from},s)},f=function(){return!Object.values(s).filter(MN).length},m=function(v){l||(l=v);var b=v-l,w=b/n.dt;s=CAe(n,s,w),a(Tn(Tn(Tn({},e),t),p())),l=v,f()||(c=requestAnimationFrame(d))},y=function(v){u||(u=v);var b=(v-u)/r,w=Xp(function(x,j){return Hg.apply(void 0,qq(j).concat([n(b)]))},i);if(a(Tn(Tn(Tn({},e),t),w)),b<1)c=requestAnimationFrame(d);else{var _=Xp(function(x,j){return Hg.apply(void 0,qq(j).concat([n(1)]))},i);a(Tn(Tn(Tn({},e),t),_))}};return d=n.isStepper?m:y,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(c)}}};function Tl(e){"@babel/helpers - typeof";return Tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tl(e)}var kAe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function MAe(e,t){if(e==null)return{};var n=AAe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function AAe(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,o;for(o=0;o<r.length;o++)a=r[o],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function AN(e){return RAe(e)||IAe(e)||TAe(e)||PAe()}function PAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TAe(e,t){if(e){if(typeof e=="string")return PN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PN(e,t)}}function IAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RAe(e){if(Array.isArray(e))return PN(e)}function PN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ka(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Gq(Object(n),!0).forEach(function(r){Yp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Yp(e,t,n){return t=Xq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LAe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Xq(r.key),r)}}function $Ae(e,t,n){return t&&LAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xq(e){var t=FAe(e,"string");return Tl(t)==="symbol"?t:String(t)}function FAe(e,t){if(Tl(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Tl(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TN(e,t)}function TN(e,t){return TN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},TN(e,t)}function zAe(e){var t=UAe();return function(){var n=qg(e),r;if(t){var a=qg(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return IN(this,r)}}function IN(e,t){if(t&&(Tl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RN(e)}function RN(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qg(e){return qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qg(e)}var zi=function(e){BAe(n,e);var t=zAe(n);function n(r,a){var o;DAe(this,n),o=t.call(this,r,a);var i=o.props,s=i.isActive,c=i.attributeName,l=i.from,u=i.to,d=i.steps,p=i.children,f=i.duration;if(o.handleStyleChange=o.handleStyleChange.bind(RN(o)),o.changeStyle=o.changeStyle.bind(RN(o)),!s||f<=0)return o.state={style:{}},typeof p=="function"&&(o.state={style:u}),IN(o);if(d&&d.length)o.state={style:d[0].style};else if(l){if(typeof p=="function")return o.state={style:l},IN(o);o.state={style:c?Yp({},c,l):l}}else o.state={style:{}};return o}return $Ae(n,[{key:"componentDidMount",value:function(){var r=this.props,a=r.isActive,o=r.canBegin;this.mounted=!0,!(!a||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(r){var a=this.props,o=a.isActive,i=a.canBegin,s=a.attributeName,c=a.shouldReAnimate,l=a.to,u=a.from,d=this.state.style;if(i){if(!o){var p={style:s?Yp({},s,l):l};this.state&&d&&(s&&d[s]!==l||!s&&d!==l)&&this.setState(p);return}if(!(ZMe(r.to,l)&&r.canBegin&&r.isActive)){var f=!r.canBegin||!r.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var m=f||c?u:r.to;if(this.state&&d){var y={style:s?Yp({},s,m):m};(s&&d[s]!==m||!s&&d!==m)&&this.setState(y)}this.runAnimation(ka(ka({},this.props),{},{from:m,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var r=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),r&&r()}},{key:"handleStyleChange",value:function(r){this.changeStyle(r)}},{key:"changeStyle",value:function(r){this.mounted&&this.setState({style:r})}},{key:"runJSAnimation",value:function(r){var a=this,o=r.from,i=r.to,s=r.duration,c=r.easing,l=r.begin,u=r.onAnimationEnd,d=r.onAnimationStart,p=NAe(o,i,gAe(c),s,this.changeStyle),f=function(){a.stopJSAnimation=p()};this.manager.start([d,l,f,s,u])}},{key:"runStepAnimation",value:function(r){var a=this,o=r.steps,i=r.begin,s=r.onAnimationStart,c=o[0],l=c.style,u=c.duration,d=u===void 0?0:u,p=function(f,m,y){if(y===0)return f;var v=m.duration,b=m.easing,w=b===void 0?"ease":b,_=m.style,x=m.properties,j=m.onAnimationEnd,E=y>0?o[y-1]:m,S=x||Object.keys(_);if(typeof w=="function"||w==="spring")return[].concat(AN(f),[a.runJSAnimation.bind(a,{from:E.style,to:_,duration:v,easing:w}),v]);var O=Bq(S,v,w),N=ka(ka(ka({},E.style),_),{},{transition:O});return[].concat(AN(f),[N,v,j]).filter(oAe)};return this.manager.start([s].concat(AN(o.reduce(p,[l,Math.max(d,i)])),[r.onAnimationEnd]))}},{key:"runAnimation",value:function(r){this.manager||(this.manager=tAe());var a=r.begin,o=r.duration,i=r.attributeName,s=r.to,c=r.easing,l=r.onAnimationStart,u=r.onAnimationEnd,d=r.steps,p=r.children,f=this.manager;if(this.unSubscribe=f.subscribe(this.handleStyleChange),typeof c=="function"||typeof p=="function"||c==="spring"){this.runJSAnimation(r);return}if(d.length>1){this.runStepAnimation(r);return}var m=i?Yp({},i,s):s,y=Bq(Object.keys(m),o,c);f.start([l,a,ka(ka({},m),{},{transition:y}),o,u])}},{key:"render",value:function(){var r=this.props,a=r.children;r.begin;var o=r.duration;r.attributeName,r.easing;var i=r.isActive;r.steps,r.from,r.to,r.canBegin,r.onAnimationEnd,r.shouldReAnimate,r.onAnimationReStart;var s=MAe(r,kAe),c=g.Children.count(a),l=this.state.style;if(typeof a=="function")return a(l);if(!i||c===0||o<=0)return a;var u=function(d){var p=d.props,f=p.style,m=f===void 0?{}:f,y=p.className,v=g.cloneElement(d,ka(ka({},s),{},{style:ka(ka({},m),l),className:y}));return v};return c===1?u(g.Children.only(a)):q.createElement("div",null,g.Children.map(a,function(d){return u(d)}))}}]),n}(g.PureComponent);zi.displayName="Animate",zi.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},zi.propTypes={from:Ze.oneOfType([Ze.object,Ze.string]),to:Ze.oneOfType([Ze.object,Ze.string]),attributeName:Ze.string,duration:Ze.number,begin:Ze.number,easing:Ze.oneOfType([Ze.string,Ze.func]),steps:Ze.arrayOf(Ze.shape({duration:Ze.number.isRequired,style:Ze.object.isRequired,easing:Ze.oneOfType([Ze.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Ze.func]),properties:Ze.arrayOf("string"),onAnimationEnd:Ze.func})),children:Ze.oneOfType([Ze.node,Ze.func]),isActive:Ze.bool,canBegin:Ze.bool,onAnimationEnd:Ze.func,shouldReAnimate:Ze.bool,onAnimationStart:Ze.func,onAnimationReStart:Ze.func},Ze.object,Ze.object,Ze.object,Ze.element,Ze.object,Ze.object,Ze.object,Ze.oneOfType([Ze.array,Ze.element]),Ze.any;function Qp(e){"@babel/helpers - typeof";return Qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qp(e)}function Kg(){return Kg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kg.apply(this,arguments)}function VAe(e,t){return KAe(e)||qAe(e,t)||HAe(e,t)||WAe()}function WAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HAe(e,t){if(e){if(typeof e=="string")return Jq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jq(e,t)}}function Jq(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function KAe(e){if(Array.isArray(e))return e}function Yq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Qq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yq(Object(n),!0).forEach(function(r){ZAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ZAe(e,t,n){return t=GAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GAe(e){var t=XAe(e,"string");return Qp(t)=="symbol"?t:t+""}function XAe(e,t){if(Qp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Qp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eK=function(e,t,n,r,a){var o=Math.min(Math.abs(n)/2,Math.abs(r)/2),i=r>=0?1:-1,s=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0,l;if(o>0&&a instanceof Array){for(var u=[0,0,0,0],d=0,p=4;d<p;d++)u[d]=a[d]>o?o:a[d];l="M".concat(e,",").concat(t+i*u[0]),u[0]>0&&(l+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+s*u[0],",").concat(t)),l+="L ".concat(e+n-s*u[1],",").concat(t),u[1]>0&&(l+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+n,",").concat(t+i*u[1])),l+="L ".concat(e+n,",").concat(t+r-i*u[2]),u[2]>0&&(l+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+n-s*u[2],",").concat(t+r)),l+="L ".concat(e+s*u[3],",").concat(t+r),u[3]>0&&(l+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+r-i*u[3])),l+="Z"}else if(o>0&&a===+a&&a>0){var f=Math.min(o,a);l="M ".concat(e,",").concat(t+i*f,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e+s*f,",").concat(t,`
            L `).concat(e+n-s*f,",").concat(t,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e+n,",").concat(t+i*f,`
            L `).concat(e+n,",").concat(t+r-i*f,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e+n-s*f,",").concat(t+r,`
            L `).concat(e+s*f,",").concat(t+r,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e,",").concat(t+r-i*f," Z")}else l="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return l},JAe=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,a=t.x,o=t.y,i=t.width,s=t.height;if(Math.abs(i)>0&&Math.abs(s)>0){var c=Math.min(a,a+i),l=Math.max(a,a+i),u=Math.min(o,o+s),d=Math.max(o,o+s);return n>=c&&n<=l&&r>=u&&r<=d}return!1},YAe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},DN=function(e){var t=Qq(Qq({},YAe),e),n=g.useRef(),r=g.useState(-1),a=VAe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var _=n.current.getTotalLength();_&&i(_)}catch{}},[]);var s=t.x,c=t.y,l=t.width,u=t.height,d=t.radius,p=t.className,f=t.animationEasing,m=t.animationDuration,y=t.animationBegin,v=t.isAnimationActive,b=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||l===0||u===0)return null;var w=Et("recharts-rectangle",p);return b?q.createElement(zi,{canBegin:o>0,from:{width:l,height:u,x:s,y:c},to:{width:l,height:u,x:s,y:c},duration:m,animationEasing:f,isActive:b},function(_){var x=_.width,j=_.height,E=_.x,S=_.y;return q.createElement(zi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:m,isActive:v,easing:f},q.createElement("path",Kg({},bt(t,!0),{className:w,d:eK(E,S,x,j,d),ref:n})))}):q.createElement("path",Kg({},bt(t,!0),{className:w,d:eK(s,c,l,u,d)}))};function LN(){return LN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},LN.apply(this,arguments)}var tK=function(e){var t=e.cx,n=e.cy,r=e.r,a=e.className,o=Et("recharts-dot",a);return t===+t&&n===+n&&r===+r?q.createElement("circle",LN({},bt(e,!1),qy(e),{className:o,cx:t,cy:n,r})):null};function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}var QAe=["x","y","top","left","width","height","className"];function $N(){return $N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$N.apply(this,arguments)}function nK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ePe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nK(Object(n),!0).forEach(function(r){tPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function tPe(e,t,n){return t=nPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nPe(e){var t=rPe(e,"string");return ef(t)=="symbol"?t:t+""}function rPe(e,t){if(ef(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ef(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aPe(e,t){if(e==null)return{};var n=oPe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oPe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var iPe=function(e,t,n,r,a,o){return"M".concat(e,",").concat(a,"v").concat(r,"M").concat(o,",").concat(t,"h").concat(n)},sPe=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.top,i=o===void 0?0:o,s=e.left,c=s===void 0?0:s,l=e.width,u=l===void 0?0:l,d=e.height,p=d===void 0?0:d,f=e.className,m=aPe(e,QAe),y=ePe({x:n,y:a,top:i,left:c,width:u,height:p},m);return!ye(n)||!ye(a)||!ye(u)||!ye(p)||!ye(i)||!ye(c)?null:q.createElement("path",$N({},bt(y,!0),{className:Et("recharts-cross",f),d:iPe(n,a,u,p,i,c)}))},FN,rK;Xk=function(){if(rK)return FN;rK=1;var e=Mo(),t=M0(),n=Ia(),r="[object Object]",a=Function.prototype,o=Object.prototype,i=a.toString,s=o.hasOwnProperty,c=i.call(Object);function l(u){if(!n(u)||e(u)!=r)return!1;var d=t(u);if(d===null)return!0;var p=s.call(d,"constructor")&&d.constructor;return typeof p=="function"&&p instanceof p&&i.call(p)==c}return FN=l,FN};var cPe=Xk();const lPe=ct(cPe);var BN,aK;function uPe(){if(aK)return BN;aK=1;var e=Mo(),t=Ia(),n="[object Boolean]";function r(a){return a===!0||a===!1||t(a)&&e(a)==n}return BN=r,BN}var dPe=uPe();const pPe=ct(dPe);function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function Zg(){return Zg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zg.apply(this,arguments)}function fPe(e,t){return gPe(e)||yPe(e,t)||mPe(e,t)||hPe()}function hPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mPe(e,t){if(e){if(typeof e=="string")return oK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oK(e,t)}}function oK(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yPe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function gPe(e){if(Array.isArray(e))return e}function iK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function sK(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iK(Object(n),!0).forEach(function(r){vPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function vPe(e,t,n){return t=bPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bPe(e){var t=wPe(e,"string");return tf(t)=="symbol"?t:t+""}function wPe(e,t){if(tf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(tf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cK=function(e,t,n,r,a){var o=n-r,i;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+n,",").concat(t),i+="L ".concat(e+n-o/2,",").concat(t+a),i+="L ".concat(e+n-o/2-r,",").concat(t+a),i+="L ".concat(e,",").concat(t," Z"),i},xPe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},_Pe=function(e){var t=sK(sK({},xPe),e),n=g.useRef(),r=g.useState(-1),a=fPe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&i(w)}catch{}},[]);var s=t.x,c=t.y,l=t.upperWidth,u=t.lowerWidth,d=t.height,p=t.className,f=t.animationEasing,m=t.animationDuration,y=t.animationBegin,v=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||d!==+d||l===0&&u===0||d===0)return null;var b=Et("recharts-trapezoid",p);return v?q.createElement(zi,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:d,x:s,y:c},to:{upperWidth:l,lowerWidth:u,height:d,x:s,y:c},duration:m,animationEasing:f,isActive:v},function(w){var _=w.upperWidth,x=w.lowerWidth,j=w.height,E=w.x,S=w.y;return q.createElement(zi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:m,easing:f},q.createElement("path",Zg({},bt(t,!0),{className:b,d:cK(E,S,_,x,j),ref:n})))}):q.createElement("g",null,q.createElement("path",Zg({},bt(t,!0),{className:b,d:cK(s,c,l,u,d)})))},jPe=["option","shapeType","propTransformer","activeClassName","isActive"];function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function EPe(e,t){if(e==null)return{};var n=SPe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function SPe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function lK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Gg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lK(Object(n),!0).forEach(function(r){OPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function OPe(e,t,n){return t=CPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CPe(e){var t=NPe(e,"string");return nf(t)=="symbol"?t:t+""}function NPe(e,t){if(nf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(nf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kPe(e,t){return Gg(Gg({},t),e)}function MPe(e,t){return e==="symbols"}function uK(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return q.createElement(DN,n);case"trapezoid":return q.createElement(_Pe,n);case"sector":return q.createElement(yq,n);case"symbols":if(MPe(t))return q.createElement(CO,n);break;default:return null}}function APe(e){return g.isValidElement(e)?e.props:e}function PPe(e){var t=e.option,n=e.shapeType,r=e.propTransformer,a=r===void 0?kPe:r,o=e.activeClassName,i=o===void 0?"recharts-active-shape":o,s=e.isActive,c=EPe(e,jPe),l;if(g.isValidElement(t))l=g.cloneElement(t,Gg(Gg({},c),APe(t)));else if(at(t))l=t(c);else if(lPe(t)&&!pPe(t)){var u=a(t,c);l=q.createElement(uK,{shapeType:n,elementProps:u})}else{var d=c;l=q.createElement(uK,{shapeType:n,elementProps:d})}return s?q.createElement(xn,{className:i},l):l}function Xg(e,t){return t!=null&&"trapezoids"in e.props}function Jg(e,t){return t!=null&&"sectors"in e.props}function rf(e,t){return t!=null&&"points"in e.props}function TPe(e,t){var n,r,a=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,o=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return a&&o}function IPe(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function RPe(e,t){var n=e.x===t.x,r=e.y===t.y,a=e.z===t.z;return n&&r&&a}function DPe(e,t){var n;return Xg(e,t)?n=TPe:Jg(e,t)?n=IPe:rf(e,t)&&(n=RPe),n}function LPe(e,t){var n;return Xg(e,t)?n="trapezoids":Jg(e,t)?n="sectors":rf(e,t)&&(n="points"),n}function $Pe(e,t){if(Xg(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(Jg(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return rf(e,t)?t.payload:{}}function FPe(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,a=LPe(n,t),o=$Pe(n,t),i=r.filter(function(c,l){var u=oN(o,c),d=n.props[a].filter(function(m){var y=DPe(n,t);return y(m,t)}),p=n.props[a].indexOf(d[d.length-1]),f=l===p;return u&&f}),s=r.indexOf(i[i.length-1]);return s}var zN,dK;function BPe(){if(dK)return zN;dK=1;var e=Math.ceil,t=Math.max;function n(r,a,o,i){for(var s=-1,c=t(e((a-r)/(o||1)),0),l=Array(c);c--;)l[i?c:++s]=r,r+=o;return l}return zN=n,zN}var UN,pK;function zPe(){if(pK)return UN;pK=1;var e=BPe(),t=qs(),n=pz();function r(a){return function(o,i,s){return s&&typeof s!="number"&&t(o,i,s)&&(i=s=void 0),o=n(o),i===void 0?(i=o,o=0):i=n(i),s=s===void 0?o<i?1:-1:n(s),e(o,i,s,a)}}return UN=r,UN}var VN,fK;function UPe(){if(fK)return VN;fK=1;var e=zPe(),t=e();return VN=t,VN}var VPe=UPe();const Yg=ct(VPe);function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function hK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function mK(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hK(Object(n),!0).forEach(function(r){yK(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yK(e,t,n){return t=WPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WPe(e){var t=HPe(e,"string");return af(t)=="symbol"?t:t+""}function HPe(e,t){if(af(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(af(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qPe=["Webkit","Moz","O","ms"],KPe=function(e,t){var n=e.replace(/(\w)/,function(a){return a.toUpperCase()}),r=qPe.reduce(function(a,o){return mK(mK({},a),{},yK({},o+n,t))},{});return r[e]=t,r};function Il(e){"@babel/helpers - typeof";return Il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Il(e)}function Qg(){return Qg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qg.apply(this,arguments)}function gK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function WN(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gK(Object(n),!0).forEach(function(r){Cr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ZPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,wK(r.key),r)}}function GPe(e,t,n){return t&&vK(e.prototype,t),n&&vK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function XPe(e,t,n){return t=ev(t),JPe(e,bK()?Reflect.construct(t,n||[],ev(e).constructor):t.apply(e,n))}function JPe(e,t){if(t&&(Il(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YPe(e)}function YPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bK=function(){return!!e})()}function ev(e){return ev=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ev(e)}function QPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HN(e,t)}function HN(e,t){return HN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},HN(e,t)}function Cr(e,t,n){return t=wK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wK(e){var t=e2e(e,"string");return Il(t)=="symbol"?t:t+""}function e2e(e,t){if(Il(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Il(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t2e=function(e){var t=e.data,n=e.startIndex,r=e.endIndex,a=e.x,o=e.width,i=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,c=kp().domain(Yg(0,s)).range([a,a+o-i]),l=c.domain().map(function(u){return c(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(n),endX:c(r),scale:c,scaleValues:l}},xK=function(e){return e.changedTouches&&!!e.changedTouches.length},Rl=function(e){function t(n){var r;return ZPe(this,t),r=XPe(this,t,[n]),Cr(r,"handleDrag",function(a){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(a):r.state.isSlideMoving&&r.handleSlideDrag(a)}),Cr(r,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&r.handleDrag(a.changedTouches[0])}),Cr(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=r.props,o=a.endIndex,i=a.onDragEnd,s=a.startIndex;i==null||i({endIndex:o,startIndex:s})}),r.detachDragEndListener()}),Cr(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),Cr(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),Cr(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),Cr(r,"handleSlideDragStart",function(a){var o=xK(a)?a.changedTouches[0]:a;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return QPe(t,e),GPe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var r=n.startX,a=n.endX,o=this.state.scaleValues,i=this.props,s=i.gap,c=i.data,l=c.length-1,u=Math.min(r,a),d=Math.max(r,a),p=t.getIndexInRange(o,u),f=t.getIndexInRange(o,d);return{startIndex:p-p%s,endIndex:f===l?l:f-f%s}}},{key:"getTextOfTick",value:function(n){var r=this.props,a=r.data,o=r.tickFormatter,i=r.dataKey,s=ao(a[n],i,n);return at(o)?o(s,n):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var r=this.state,a=r.slideMoveStartX,o=r.startX,i=r.endX,s=this.props,c=s.x,l=s.width,u=s.travellerWidth,d=s.startIndex,p=s.endIndex,f=s.onChange,m=n.pageX-a;m>0?m=Math.min(m,c+l-u-i,c+l-u-o):m<0&&(m=Math.max(m,c-o,c-i));var y=this.getIndex({startX:o+m,endX:i+m});(y.startIndex!==d||y.endIndex!==p)&&f&&f(y),this.setState({startX:o+m,endX:i+m,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,r){var a=xK(r)?r.changedTouches[0]:r;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var r=this.state,a=r.brushMoveStartX,o=r.movingTravellerId,i=r.endX,s=r.startX,c=this.state[o],l=this.props,u=l.x,d=l.width,p=l.travellerWidth,f=l.onChange,m=l.gap,y=l.data,v={startX:this.state.startX,endX:this.state.endX},b=n.pageX-a;b>0?b=Math.min(b,u+d-p-c):b<0&&(b=Math.max(b,u-c)),v[o]=c+b;var w=this.getIndex(v),_=w.startIndex,x=w.endIndex,j=function(){var E=y.length-1;return o==="startX"&&(i>s?_%m===0:x%m===0)||i<s&&x===E||o==="endX"&&(i>s?x%m===0:_%m===0)||i>s&&x===E};this.setState(Cr(Cr({},o,c+b),"brushMoveStartX",n.pageX),function(){f&&j()&&f(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,r){var a=this,o=this.state,i=o.scaleValues,s=o.startX,c=o.endX,l=this.state[r],u=i.indexOf(l);if(u!==-1){var d=u+n;if(!(d===-1||d>=i.length)){var p=i[d];r==="startX"&&p>=c||r==="endX"&&p<=s||this.setState(Cr({},r,p),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.fill,c=n.stroke;return q.createElement("rect",{stroke:c,fill:s,x:r,y:a,width:o,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.data,c=n.children,l=n.padding,u=g.Children.only(c);return u?q.cloneElement(u,{x:r,y:a,width:o,height:i,margin:l,compact:!0,data:s}):null}},{key:"renderTravellerLayer",value:function(n,r){var a,o,i=this,s=this.props,c=s.y,l=s.travellerWidth,u=s.height,d=s.traveller,p=s.ariaLabel,f=s.data,m=s.startIndex,y=s.endIndex,v=Math.max(n,this.props.x),b=WN(WN({},bt(this.props,!1)),{},{x:v,y:c,width:l,height:u}),w=p||"Min value: ".concat((a=f[m])===null||a===void 0?void 0:a.name,", Max value: ").concat((o=f[y])===null||o===void 0?void 0:o.name);return q.createElement(xn,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),i.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,r))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(d,b))}},{key:"renderSlide",value:function(n,r){var a=this.props,o=a.y,i=a.height,s=a.stroke,c=a.travellerWidth,l=Math.min(n,r)+c,u=Math.max(Math.abs(r-n)-c,0);return q.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:s,fillOpacity:.2,x:l,y:o,width:u,height:i})}},{key:"renderText",value:function(){var n=this.props,r=n.startIndex,a=n.endIndex,o=n.y,i=n.height,s=n.travellerWidth,c=n.stroke,l=this.state,u=l.startX,d=l.endX,p=5,f={pointerEvents:"none",fill:c};return q.createElement(xn,{className:"recharts-brush-texts"},q.createElement(fg,Qg({textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,d)-p,y:o+i/2},f),this.getTextOfTick(r)),q.createElement(fg,Qg({textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,d)+s+p,y:o+i/2},f),this.getTextOfTick(a)))}},{key:"render",value:function(){var n=this.props,r=n.data,a=n.className,o=n.children,i=n.x,s=n.y,c=n.width,l=n.height,u=n.alwaysShowText,d=this.state,p=d.startX,f=d.endX,m=d.isTextActive,y=d.isSlideMoving,v=d.isTravellerMoving,b=d.isTravellerFocused;if(!r||!r.length||!ye(i)||!ye(s)||!ye(c)||!ye(l)||c<=0||l<=0)return null;var w=Et("recharts-brush",a),_=q.Children.count(o)===1,x=KPe("userSelect","none");return q.createElement(xn,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:x},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(p,f),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(f,"endX"),(m||y||v||b||u)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var r=n.x,a=n.y,o=n.width,i=n.height,s=n.stroke,c=Math.floor(a+i/2)-1;return q.createElement(q.Fragment,null,q.createElement("rect",{x:r,y:a,width:o,height:i,fill:s,stroke:"none"}),q.createElement("line",{x1:r+1,y1:c,x2:r+o-1,y2:c,fill:"none",stroke:"#fff"}),q.createElement("line",{x1:r+1,y1:c+2,x2:r+o-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,r){var a;return q.isValidElement(n)?a=q.cloneElement(n,r):at(n)?a=n(r):a=t.renderDefaultTraveller(r),a}},{key:"getDerivedStateFromProps",value:function(n,r){var a=n.data,o=n.width,i=n.x,s=n.travellerWidth,c=n.updateId,l=n.startIndex,u=n.endIndex;if(a!==r.prevData||c!==r.prevUpdateId)return WN({prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o},a&&a.length?t2e({data:a,width:o,x:i,travellerWidth:s,startIndex:l,endIndex:u}):{scale:null,scaleValues:null});if(r.scale&&(o!==r.prevWidth||i!==r.prevX||s!==r.prevTravellerWidth)){r.scale.range([i,i+o-s]);var d=r.scale.domain().map(function(p){return r.scale(p)});return{prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o,startX:r.scale(n.startIndex),endX:r.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,r){for(var a=n.length,o=0,i=a-1;i-o>1;){var s=Math.floor((o+i)/2);n[s]>r?i=s:o=s}return r>=n[i]?i:o}}])}(g.PureComponent);Cr(Rl,"displayName","Brush"),Cr(Rl,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var qN,_K;function n2e(){if(_K)return qN;_K=1;var e=GO();function t(n,r){var a;return e(n,function(o,i,s){return a=r(o,i,s),!a}),!!a}return qN=t,qN}var KN,jK;function r2e(){if(jK)return KN;jK=1;var e=QR(),t=Ua(),n=n2e(),r=qn(),a=qs();function o(i,s,c){var l=r(i)?e:n;return c&&a(i,s,c)&&(s=void 0),l(i,t(s,3))}return KN=o,KN}var a2e=r2e();const o2e=ct(a2e);var oo=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},ZN,EK;function i2e(){if(EK)return ZN;EK=1;var e=Fv(),t=fV(),n=Ua();function r(a,o){var i={};return o=n(o,3),t(a,function(s,c,l){e(i,c,o(s,c,l))}),i}return ZN=r,ZN}var s2e=i2e();const c2e=ct(s2e);var GN,SK;function l2e(){if(SK)return GN;SK=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(!n(t[r],r,t))return!1;return!0}return GN=e,GN}var XN,OK;function u2e(){if(OK)return XN;OK=1;var e=GO();function t(n,r){var a=!0;return e(n,function(o,i,s){return a=!!r(o,i,s),a}),a}return XN=t,XN}var JN,CK;function d2e(){if(CK)return JN;CK=1;var e=l2e(),t=u2e(),n=Ua(),r=qn(),a=qs();function o(i,s,c){var l=r(i)?e:t;return c&&a(i,s,c)&&(s=void 0),l(i,n(s,3))}return JN=o,JN}var p2e=d2e();const NK=ct(p2e);var f2e=["x","y"];function of(e){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},of(e)}function YN(){return YN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YN.apply(this,arguments)}function kK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function sf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kK(Object(n),!0).forEach(function(r){h2e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function h2e(e,t,n){return t=m2e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m2e(e){var t=y2e(e,"string");return of(t)=="symbol"?t:t+""}function y2e(e,t){if(of(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(of(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g2e(e,t){if(e==null)return{};var n=v2e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function v2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function b2e(e,t){var n=e.x,r=e.y,a=g2e(e,f2e),o="".concat(n),i=parseInt(o,10),s="".concat(r),c=parseInt(s,10),l="".concat(t.height||a.height),u=parseInt(l,10),d="".concat(t.width||a.width),p=parseInt(d,10);return sf(sf(sf(sf(sf({},t),a),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:p,name:t.name,radius:t.radius})}function MK(e){return q.createElement(PPe,YN({shapeType:"rectangle",propTransformer:b2e,activeClassName:"recharts-active-bar"},e))}var w2e=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,r){if(typeof e=="number")return e;var a=typeof n=="number";return a?e(n,r):(a||Ds(),t)}},x2e=["value","background"],AK;function Dl(e){"@babel/helpers - typeof";return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dl(e)}function _2e(e,t){if(e==null)return{};var n=j2e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function j2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function tv(){return tv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tv.apply(this,arguments)}function PK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function cn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?PK(Object(n),!0).forEach(function(r){Ui(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function E2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,RK(r.key),r)}}function S2e(e,t,n){return t&&TK(e.prototype,t),n&&TK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function O2e(e,t,n){return t=nv(t),C2e(e,IK()?Reflect.construct(t,n||[],nv(e).constructor):t.apply(e,n))}function C2e(e,t){if(t&&(Dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return N2e(e)}function N2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IK=function(){return!!e})()}function nv(e){return nv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nv(e)}function k2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QN(e,t)}function QN(e,t){return QN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},QN(e,t)}function Ui(e,t,n){return t=RK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RK(e){var t=M2e(e,"string");return Dl(t)=="symbol"?t:t+""}function M2e(e,t){if(Dl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Dl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fs=function(e){function t(){var n;E2e(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=O2e(this,t,[].concat(a)),Ui(n,"state",{isAnimationFinished:!1}),Ui(n,"id",Hy("recharts-bar-")),Ui(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),i&&i()}),Ui(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),i&&i()}),n}return k2e(t,e),S2e(t,[{key:"renderRectanglesStatically",value:function(n){var r=this,a=this.props,o=a.shape,i=a.dataKey,s=a.activeIndex,c=a.activeBar,l=bt(this.props,!1);return n&&n.map(function(u,d){var p=d===s,f=p?c:o,m=cn(cn(cn({},l),u),{},{isActive:p,option:f,index:d,dataKey:i,onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd});return q.createElement(xn,tv({className:"recharts-bar-rectangle"},Ky(r.props,u,d),{key:"rectangle-".concat(u==null?void 0:u.x,"-").concat(u==null?void 0:u.y,"-").concat(u==null?void 0:u.value)}),q.createElement(MK,m))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,r=this.props,a=r.data,o=r.layout,i=r.isAnimationActive,s=r.animationBegin,c=r.animationDuration,l=r.animationEasing,u=r.animationId,d=this.state.prevData;return q.createElement(zi,{begin:s,duration:c,isActive:i,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var f=p.t,m=a.map(function(y,v){var b=d&&d[v];if(b){var w=hl(b.x,y.x),_=hl(b.y,y.y),x=hl(b.width,y.width),j=hl(b.height,y.height);return cn(cn({},y),{},{x:w(f),y:_(f),width:x(f),height:j(f)})}if(o==="horizontal"){var E=hl(0,y.height),S=E(f);return cn(cn({},y),{},{y:y.y+y.height-S,height:S})}var O=hl(0,y.width),N=O(f);return cn(cn({},y),{},{width:N})});return q.createElement(xn,null,n.renderRectanglesStatically(m))})}},{key:"renderRectangles",value:function(){var n=this.props,r=n.data,a=n.isAnimationActive,o=this.state.prevData;return a&&r&&r.length&&(!o||!oN(o,r))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(r)}},{key:"renderBackground",value:function(){var n=this,r=this.props,a=r.data,o=r.dataKey,i=r.activeIndex,s=bt(this.props.background,!1);return a.map(function(c,l){c.value;var u=c.background,d=_2e(c,x2e);if(!u)return null;var p=cn(cn(cn(cn(cn({},d),{},{fill:"#eee"},u),s),Ky(n.props,c,l)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:l,className:"recharts-bar-background-rectangle"});return q.createElement(MK,tv({key:"background-bar-".concat(l),option:n.props.background,isActive:l===i},p))})}},{key:"renderErrorBar",value:function(n,r){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.data,i=a.xAxis,s=a.yAxis,c=a.layout,l=a.children,u=Ca(l,Rg);if(!u)return null;var d=c==="vertical"?o[0].height/2:o[0].width/2,p=function(m,y){var v=Array.isArray(m.value)?m.value[1]:m.value;return{x:m.x,y:m.y,value:v,errorVal:ao(m,y)}},f={clipPath:n?"url(#clipPath-".concat(r,")"):null};return q.createElement(xn,f,u.map(function(m){return q.cloneElement(m,{key:"error-bar-".concat(r,"-").concat(m.props.dataKey),data:o,xAxis:i,yAxis:s,layout:c,offset:d,dataPointFormatter:p})}))}},{key:"render",value:function(){var n=this.props,r=n.hide,a=n.data,o=n.className,i=n.xAxis,s=n.yAxis,c=n.left,l=n.top,u=n.width,d=n.height,p=n.isAnimationActive,f=n.background,m=n.id;if(r||!a||!a.length)return null;var y=this.state.isAnimationFinished,v=Et("recharts-bar",o),b=i&&i.allowDataOverflow,w=s&&s.allowDataOverflow,_=b||w,x=wt(m)?this.id:m;return q.createElement(xn,{className:v},b||w?q.createElement("defs",null,q.createElement("clipPath",{id:"clipPath-".concat(x)},q.createElement("rect",{x:b?c:c-u/2,y:w?l:l-d/2,width:b?u:u*2,height:w?d:d*2}))):null,q.createElement(xn,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(x,")"):null},f?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,x),(!p||y)&&$s.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,r){return n.animationId!==r.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:r.curData}:n.data!==r.curData?{curData:n.data}:null}}])}(g.PureComponent);AK=Fs,Ui(Fs,"displayName","Bar"),Ui(Fs,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Ri.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),Ui(Fs,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,o=e.xAxis,i=e.yAxis,s=e.xAxisTicks,c=e.yAxisTicks,l=e.stackedData,u=e.dataStartIndex,d=e.displayedData,p=e.offset,f=uke(r,n);if(!f)return null;var m=t.layout,y=n.type.defaultProps,v=y!==void 0?cn(cn({},y),n.props):n.props,b=v.dataKey,w=v.children,_=v.minPointSize,x=m==="horizontal"?i:o,j=l?x.scale.domain():null,E=vke({numericAxis:x}),S=Ca(w,KV),O=d.map(function(N,M){var k,A,P,C,T,I;l?k=dke(l[u+M],j):(k=ao(N,b),Array.isArray(k)||(k=[E,k]));var R=w2e(_,AK.defaultProps.minPointSize)(k[1],M);if(m==="horizontal"){var L,D=[i.scale(k[0]),i.scale(k[1])],z=D[0],U=D[1];A=YH({axis:o,ticks:s,bandSize:a,offset:f.offset,entry:N,index:M}),P=(L=U??z)!==null&&L!==void 0?L:void 0,C=f.size;var $=z-U;if(T=Number.isNaN($)?0:$,I={x:A,y:i.y,width:C,height:i.height},Math.abs(R)>0&&Math.abs(T)<Math.abs(R)){var V=Oa(T||R)*(Math.abs(R)-Math.abs(T));P-=V,T+=V}}else{var F=[o.scale(k[0]),o.scale(k[1])],W=F[0],re=F[1];if(A=W,P=YH({axis:i,ticks:c,bandSize:a,offset:f.offset,entry:N,index:M}),C=re-W,T=f.size,I={x:o.x,y:P,width:o.width,height:T},Math.abs(R)>0&&Math.abs(C)<Math.abs(R)){var ee=Oa(C||R)*(Math.abs(R)-Math.abs(C));C+=ee}}return cn(cn(cn({},N),{},{x:A,y:P,width:C,height:T,value:l?k:k[1],payload:N,background:I},S&&S[M]&&S[M].props),{},{tooltipPayload:[rq(n,N)],tooltipPosition:{x:A+C/2,y:P+T/2}})});return cn({data:O,layout:m},p)});function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}function A2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$K(r.key),r)}}function P2e(e,t,n){return t&&DK(e.prototype,t),n&&DK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function LK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ma(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?LK(Object(n),!0).forEach(function(r){rv(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function rv(e,t,n){return t=$K(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $K(e){var t=T2e(e,"string");return cf(t)=="symbol"?t:t+""}function T2e(e,t){if(cf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I2e=function(e,t,n,r,a){var o=e.width,i=e.height,s=e.layout,c=e.children,l=Object.keys(t),u={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},d=!!Sr(c,Fs);return l.reduce(function(p,f){var m=t[f],y=m.orientation,v=m.domain,b=m.padding,w=b===void 0?{}:b,_=m.mirror,x=m.reversed,j="".concat(y).concat(_?"Mirror":""),E,S,O,N,M;if(m.type==="number"&&(m.padding==="gap"||m.padding==="no-gap")){var k=v[1]-v[0],A=1/0,P=m.categoricalDomain.sort();if(P.forEach(function(V,F){F>0&&(A=Math.min((V||0)-(P[F-1]||0),A))}),Number.isFinite(A)){var C=A/k,T=m.layout==="vertical"?n.height:n.width;if(m.padding==="gap"&&(E=C*T/2),m.padding==="no-gap"){var I=Ns(e.barCategoryGap,C*T),R=C*T/2;E=R-I-(R-I)/T*I}}}r==="xAxis"?S=[n.left+(w.left||0)+(E||0),n.left+n.width-(w.right||0)-(E||0)]:r==="yAxis"?S=s==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(E||0),n.top+n.height-(w.bottom||0)-(E||0)]:S=m.range,x&&(S=[S[1],S[0]]);var L=cke(m,a,d),D=L.scale,z=L.realScaleType;D.domain(v).range(S),lke(D);var U=gke(D,Ma(Ma({},m),{},{realScaleType:z}));r==="xAxis"?(M=y==="top"&&!_||y==="bottom"&&_,O=n.left,N=u[j]-M*m.height):r==="yAxis"&&(M=y==="left"&&!_||y==="right"&&_,O=u[j]-M*m.width,N=n.top);var $=Ma(Ma(Ma({},m),U),{},{realScaleType:z,x:O,y:N,scale:D,width:r==="xAxis"?n.width:m.width,height:r==="yAxis"?n.height:m.height});return $.bandSize=$g($,U),!m.hide&&r==="xAxis"?u[j]+=(M?-1:1)*$.height:m.hide||(u[j]+=(M?-1:1)*$.width),Ma(Ma({},p),{},rv({},f,$))},{})},FK=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return{x:Math.min(n,a),y:Math.min(r,o),width:Math.abs(a-n),height:Math.abs(o-r)}},R2e=function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return FK({x:t,y:n},{x:r,y:a})},BK=function(){function e(t){A2e(this,e),this.scale=t}return P2e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.bandAware,a=n.position;if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}},{key:"isInRange",value:function(t){var n=this.range(),r=n[0],a=n[n.length-1];return r<=a?t>=r&&t<=a:t>=a&&t<=r}}],[{key:"create",value:function(t){return new e(t)}}])}();rv(BK,"EPS",1e-4);var ek=function(e){var t=Object.keys(e).reduce(function(n,r){return Ma(Ma({},n),{},rv({},r,BK.create(e[r])))},{});return Ma(Ma({},t),{},{apply:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.bandAware,o=r.position;return c2e(n,function(i,s){return t[s].apply(i,{bandAware:a,position:o})})},isInRange:function(n){return NK(n,function(r,a){return t[a].isInRange(r)})}})};function D2e(e){return(e%180+180)%180}var L2e=function(e){var t=e.width,n=e.height,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=D2e(r),o=a*Math.PI/180,i=Math.atan(n/t),s=o>i&&o<Math.PI-i?n/Math.sin(o):t/Math.cos(o);return Math.abs(s)},tk,zK;function $2e(){if(zK)return tk;zK=1;var e=Ua(),t=Ki(),n=pu();function r(a){return function(o,i,s){var c=Object(o);if(!t(o)){var l=e(i,3);o=n(o),i=function(d){return l(c[d],d,c)}}var u=a(o,i,s);return u>-1?c[l?o[u]:u]:void 0}}return tk=r,tk}var nk,UK;function F2e(){if(UK)return nk;UK=1;var e=HU(),t=Ua(),n=hz(),r=Math.max;function a(o,i,s){var c=o==null?0:o.length;if(!c)return-1;var l=s==null?0:n(s);return l<0&&(l=r(c+l,0)),e(o,t(i,3),l)}return nk=a,nk}var rk,VK;function B2e(){if(VK)return rk;VK=1;var e=$2e(),t=F2e(),n=e(t);return rk=n,rk}var z2e=B2e();const U2e=ct(z2e);var V2e=r3(),W2e=ct(V2e)(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),ak=g.createContext(void 0),ok=g.createContext(void 0),WK=g.createContext(void 0),HK=g.createContext({}),qK=g.createContext(void 0),KK=g.createContext(0),ZK=g.createContext(0),GK=function(e){var t=e.state,n=t.xAxisMap,r=t.yAxisMap,a=t.offset,o=e.clipPathId,i=e.children,s=e.width,c=e.height,l=W2e(a);return q.createElement(ak.Provider,{value:n},q.createElement(ok.Provider,{value:r},q.createElement(HK.Provider,{value:a},q.createElement(WK.Provider,{value:l},q.createElement(qK.Provider,{value:o},q.createElement(KK.Provider,{value:c},q.createElement(ZK.Provider,{value:s},i)))))))},H2e=function(){return g.useContext(qK)},XK=function(e){var t=g.useContext(ak);t==null&&Ds();var n=t[e];return n==null&&Ds(),n},q2e=function(){var e=g.useContext(ak);return Ii(e)},K2e=function(){var e=g.useContext(ok),t=U2e(e,function(n){return NK(n.domain,Number.isFinite)});return t||Ii(e)},JK=function(e){var t=g.useContext(ok);t==null&&Ds();var n=t[e];return n==null&&Ds(),n},Z2e=function(){var e=g.useContext(WK);return e},G2e=function(){return g.useContext(HK)},ik=function(){return g.useContext(ZK)},sk=function(){return g.useContext(KK)};function Ll(e){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ll(e)}function X2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J2e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tZ(r.key),r)}}function Y2e(e,t,n){return t&&J2e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q2e(e,t,n){return t=av(t),eTe(e,YK()?Reflect.construct(t,n||[],av(e).constructor):t.apply(e,n))}function eTe(e,t){if(t&&(Ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tTe(e)}function tTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(YK=function(){return!!e})()}function av(e){return av=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},av(e)}function nTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ck(e,t)}function ck(e,t){return ck=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},ck(e,t)}function QK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function eZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?QK(Object(n),!0).forEach(function(r){lk(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function lk(e,t,n){return t=tZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tZ(e){var t=rTe(e,"string");return Ll(t)=="symbol"?t:t+""}function rTe(e,t){if(Ll(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ll(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aTe(e,t){return cTe(e)||sTe(e,t)||iTe(e,t)||oTe()}function oTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iTe(e,t){if(e){if(typeof e=="string")return nZ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nZ(e,t)}}function nZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sTe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function cTe(e){if(Array.isArray(e))return e}function uk(){return uk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uk.apply(this,arguments)}var lTe=function(e,t){var n;return q.isValidElement(e)?n=q.cloneElement(e,t):at(e)?n=e(t):n=q.createElement("line",uk({},t,{className:"recharts-reference-line-line"})),n},uTe=function(e,t,n,r,a,o,i,s,c){var l=a.x,u=a.y,d=a.width,p=a.height;if(n){var f=c.y,m=e.y.apply(f,{position:o});if(oo(c,"discard")&&!e.y.isInRange(m))return null;var y=[{x:l+d,y:m},{x:l,y:m}];return s==="left"?y.reverse():y}if(t){var v=c.x,b=e.x.apply(v,{position:o});if(oo(c,"discard")&&!e.x.isInRange(b))return null;var w=[{x:b,y:u+p},{x:b,y:u}];return i==="top"?w.reverse():w}if(r){var _=c.segment,x=_.map(function(j){return e.apply(j,{position:o})});return oo(c,"discard")&&o2e(x,function(j){return!e.isInRange(j)})?null:x}return null};function dTe(e){var t=e.x,n=e.y,r=e.segment,a=e.xAxisId,o=e.yAxisId,i=e.shape,s=e.className,c=e.alwaysShow,l=H2e(),u=XK(a),d=JK(o),p=Z2e();if(!l||!p)return null;Ho(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=ek({x:u.scale,y:d.scale}),m=hn(t),y=hn(n),v=r&&r.length===2,b=uTe(f,m,y,v,p,e.position,u.orientation,d.orientation,e);if(!b)return null;var w=aTe(b,2),_=w[0],x=_.x,j=_.y,E=w[1],S=E.x,O=E.y,N=oo(e,"hidden")?"url(#".concat(l,")"):void 0,M=eZ(eZ({clipPath:N},bt(e,!0)),{},{x1:x,y1:j,x2:S,y2:O});return q.createElement(xn,{className:Et("recharts-reference-line",s)},lTe(i,M),Un.renderCallByParent(e,R2e({x1:x,y1:j,x2:S,y2:O})))}var dk=function(e){function t(){return X2e(this,t),Q2e(this,t,arguments)}return nTe(t,e),Y2e(t,[{key:"render",value:function(){return q.createElement(dTe,this.props)}}])}(q.Component);lk(dk,"displayName","ReferenceLine"),lk(dk,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function pk(){return pk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pk.apply(this,arguments)}function $l(e){"@babel/helpers - typeof";return $l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$l(e)}function rZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function aZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rZ(Object(n),!0).forEach(function(r){iv(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function pTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fTe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,iZ(r.key),r)}}function hTe(e,t,n){return t&&fTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mTe(e,t,n){return t=ov(t),yTe(e,oZ()?Reflect.construct(t,n||[],ov(e).constructor):t.apply(e,n))}function yTe(e,t){if(t&&($l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gTe(e)}function gTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oZ=function(){return!!e})()}function ov(e){return ov=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ov(e)}function vTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fk(e,t)}function fk(e,t){return fk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},fk(e,t)}function iv(e,t,n){return t=iZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iZ(e){var t=bTe(e,"string");return $l(t)=="symbol"?t:t+""}function bTe(e,t){if($l(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($l(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wTe=function(e){var t=e.x,n=e.y,r=e.xAxis,a=e.yAxis,o=ek({x:r.scale,y:a.scale}),i=o.apply({x:t,y:n},{bandAware:!0});return oo(e,"discard")&&!o.isInRange(i)?null:i},sv=function(e){function t(){return pTe(this,t),mTe(this,t,arguments)}return vTe(t,e),hTe(t,[{key:"render",value:function(){var n=this.props,r=n.x,a=n.y,o=n.r,i=n.alwaysShow,s=n.clipPathId,c=hn(r),l=hn(a);if(Ho(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!l)return null;var u=wTe(this.props);if(!u)return null;var d=u.x,p=u.y,f=this.props,m=f.shape,y=f.className,v=oo(this.props,"hidden")?"url(#".concat(s,")"):void 0,b=aZ(aZ({clipPath:v},bt(this.props,!0)),{},{cx:d,cy:p});return q.createElement(xn,{className:Et("recharts-reference-dot",y)},t.renderDot(m,b),Un.renderCallByParent(this.props,{x:d-o,y:p-o,width:2*o,height:2*o}))}}])}(q.Component);iv(sv,"displayName","ReferenceDot"),iv(sv,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),iv(sv,"renderDot",function(e,t){var n;return q.isValidElement(e)?n=q.cloneElement(e,t):at(e)?n=e(t):n=q.createElement(tK,pk({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function hk(){return hk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hk.apply(this,arguments)}function Fl(e){"@babel/helpers - typeof";return Fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(e)}function sZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function cZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sZ(Object(n),!0).forEach(function(r){lv(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uZ(r.key),r)}}function jTe(e,t,n){return t&&_Te(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ETe(e,t,n){return t=cv(t),STe(e,lZ()?Reflect.construct(t,n||[],cv(e).constructor):t.apply(e,n))}function STe(e,t){if(t&&(Fl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OTe(e)}function OTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lZ=function(){return!!e})()}function cv(e){return cv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cv(e)}function CTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mk(e,t)}function mk(e,t){return mk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},mk(e,t)}function lv(e,t,n){return t=uZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uZ(e){var t=NTe(e,"string");return Fl(t)=="symbol"?t:t+""}function NTe(e,t){if(Fl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Fl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kTe=function(e,t,n,r,a){var o=a.x1,i=a.x2,s=a.y1,c=a.y2,l=a.xAxis,u=a.yAxis;if(!l||!u)return null;var d=ek({x:l.scale,y:u.scale}),p={x:e?d.x.apply(o,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(s,{position:"start"}):d.y.rangeMin},f={x:t?d.x.apply(i,{position:"end"}):d.x.rangeMax,y:r?d.y.apply(c,{position:"end"}):d.y.rangeMax};return oo(a,"discard")&&(!d.isInRange(p)||!d.isInRange(f))?null:FK(p,f)},uv=function(e){function t(){return xTe(this,t),ETe(this,t,arguments)}return CTe(t,e),jTe(t,[{key:"render",value:function(){var n=this.props,r=n.x1,a=n.x2,o=n.y1,i=n.y2,s=n.className,c=n.alwaysShow,l=n.clipPathId;Ho(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=hn(r),d=hn(a),p=hn(o),f=hn(i),m=this.props.shape;if(!u&&!d&&!p&&!f&&!m)return null;var y=kTe(u,d,p,f,this.props);if(!y&&!m)return null;var v=oo(this.props,"hidden")?"url(#".concat(l,")"):void 0;return q.createElement(xn,{className:Et("recharts-reference-area",s)},t.renderRect(m,cZ(cZ({clipPath:v},bt(this.props,!0)),y)),Un.renderCallByParent(this.props,y))}}])}(q.Component);lv(uv,"displayName","ReferenceArea"),lv(uv,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),lv(uv,"renderRect",function(e,t){var n;return q.isValidElement(e)?n=q.cloneElement(e,t):at(e)?n=e(t):n=q.createElement(DN,hk({},t,{className:"recharts-reference-area-rect"})),n});function dZ(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function MTe(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return L2e(r,n)}function ATe(e,t,n){var r=n==="width",a=e.x,o=e.y,i=e.width,s=e.height;return t===1?{start:r?a:o,end:r?a+i:o+s}:{start:r?a+i:o+s,end:r?a:o}}function dv(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var o=n();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-a)<=0}function PTe(e,t){return dZ(e,t+1)}function TTe(e,t,n,r,a){for(var o=(r||[]).slice(),i=t.start,s=t.end,c=0,l=1,u=i,d=function(){var f=r==null?void 0:r[c];if(f===void 0)return{v:dZ(r,l)};var m=c,y,v=function(){return y===void 0&&(y=n(f,m)),y},b=f.coordinate,w=c===0||dv(e,b,v,u,s);w||(c=0,u=i,l+=1),w&&(u=b+e*(v()/2+a),c+=l)},p;l<=o.length;)if(p=d(),p)return p.v;return[]}function lf(e){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}function pZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Vn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pZ(Object(n),!0).forEach(function(r){ITe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ITe(e,t,n){return t=RTe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RTe(e){var t=DTe(e,"string");return lf(t)=="symbol"?t:t+""}function DTe(e,t){if(lf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(lf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LTe(e,t,n,r,a){for(var o=(r||[]).slice(),i=o.length,s=t.start,c=t.end,l=function(d){var p=o[d],f,m=function(){return f===void 0&&(f=n(p,d)),f};if(d===i-1){var y=e*(p.coordinate+e*m()/2-c);o[d]=p=Vn(Vn({},p),{},{tickCoord:y>0?p.coordinate-y*e:p.coordinate})}else o[d]=p=Vn(Vn({},p),{},{tickCoord:p.coordinate});var v=dv(e,p.tickCoord,m,s,c);v&&(c=p.tickCoord-e*(m()/2+a),o[d]=Vn(Vn({},p),{},{isShow:!0}))},u=i-1;u>=0;u--)l(u);return o}function $Te(e,t,n,r,a,o){var i=(r||[]).slice(),s=i.length,c=t.start,l=t.end;if(o){var u=r[s-1],d=n(u,s-1),p=e*(u.coordinate+e*d/2-l);i[s-1]=u=Vn(Vn({},u),{},{tickCoord:p>0?u.coordinate-p*e:u.coordinate});var f=dv(e,u.tickCoord,function(){return d},c,l);f&&(l=u.tickCoord-e*(d/2+a),i[s-1]=Vn(Vn({},u),{},{isShow:!0}))}for(var m=o?s-1:s,y=function(b){var w=i[b],_,x=function(){return _===void 0&&(_=n(w,b)),_};if(b===0){var j=e*(w.coordinate-e*x()/2-c);i[b]=w=Vn(Vn({},w),{},{tickCoord:j<0?w.coordinate-j*e:w.coordinate})}else i[b]=w=Vn(Vn({},w),{},{tickCoord:w.coordinate});var E=dv(e,w.tickCoord,x,c,l);E&&(c=w.tickCoord+e*(x()/2+a),i[b]=Vn(Vn({},w),{},{isShow:!0}))},v=0;v<m;v++)y(v);return i}function yk(e,t,n){var r=e.tick,a=e.ticks,o=e.viewBox,i=e.minTickGap,s=e.orientation,c=e.interval,l=e.tickFormatter,u=e.unit,d=e.angle;if(!a||!a.length||!r)return[];if(ye(c)||Ri.isSsr)return PTe(a,typeof c=="number"&&ye(c)?c:0);var p=[],f=s==="top"||s==="bottom"?"width":"height",m=u&&f==="width"?Ep(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},y=function(w,_){var x=at(l)?l(w.value,_):w.value;return f==="width"?MTe(Ep(x,{fontSize:t,letterSpacing:n}),m,d):Ep(x,{fontSize:t,letterSpacing:n})[f]},v=a.length>=2?Oa(a[1].coordinate-a[0].coordinate):1,b=ATe(o,v,f);return c==="equidistantPreserveStart"?TTe(v,b,y,a,i):(c==="preserveStart"||c==="preserveStartEnd"?p=$Te(v,b,y,a,i,c==="preserveStartEnd"):p=LTe(v,b,y,a,i),p.filter(function(w){return w.isShow}))}var FTe=["viewBox"],BTe=["viewBox"],zTe=["ticks"];function Bl(e){"@babel/helpers - typeof";return Bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bl(e)}function zl(){return zl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zl.apply(this,arguments)}function fZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Yn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fZ(Object(n),!0).forEach(function(r){bk(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gk(e,t){if(e==null)return{};var n=UTe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function UTe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function VTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yZ(r.key),r)}}function WTe(e,t,n){return t&&hZ(e.prototype,t),n&&hZ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function HTe(e,t,n){return t=pv(t),qTe(e,mZ()?Reflect.construct(t,n||[],pv(e).constructor):t.apply(e,n))}function qTe(e,t){if(t&&(Bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KTe(e)}function KTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mZ=function(){return!!e})()}function pv(e){return pv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pv(e)}function ZTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vk(e,t)}function vk(e,t){return vk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},vk(e,t)}function bk(e,t,n){return t=yZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yZ(e){var t=GTe(e,"string");return Bl(t)=="symbol"?t:t+""}function GTe(e,t){if(Bl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ul=function(e){function t(n){var r;return VTe(this,t),r=HTe(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return ZTe(t,e),WTe(t,[{key:"shouldComponentUpdate",value:function(n,r){var a=n.viewBox,o=gk(n,FTe),i=this.props,s=i.viewBox,c=gk(i,BTe);return!ml(a,s)||!ml(o,c)||!ml(r,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var r=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];r&&this.setState({fontSize:window.getComputedStyle(r).fontSize,letterSpacing:window.getComputedStyle(r).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var r=this.props,a=r.x,o=r.y,i=r.width,s=r.height,c=r.orientation,l=r.tickSize,u=r.mirror,d=r.tickMargin,p,f,m,y,v,b,w=u?-1:1,_=n.tickSize||l,x=ye(n.tickCoord)?n.tickCoord:n.coordinate;switch(c){case"top":p=f=n.coordinate,y=o+ +!u*s,m=y-w*_,b=m-w*d,v=x;break;case"left":m=y=n.coordinate,f=a+ +!u*i,p=f-w*_,v=p-w*d,b=x;break;case"right":m=y=n.coordinate,f=a+ +u*i,p=f+w*_,v=p+w*d,b=x;break;default:p=f=n.coordinate,y=o+ +u*s,m=y+w*_,b=m+w*d,v=x;break}return{line:{x1:p,y1:m,x2:f,y2:y},tick:{x:v,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o;switch(r){case"left":o=a?"start":"end";break;case"right":o=a?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o="end";switch(r){case"left":case"right":o="middle";break;case"top":o=a?"start":"end";break;default:o=a?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.orientation,c=n.mirror,l=n.axisLine,u=Yn(Yn(Yn({},bt(this.props,!1)),bt(l,!1)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!c||s==="bottom"&&c);u=Yn(Yn({},u),{},{x1:r,y1:a+d*i,x2:r+o,y2:a+d*i})}else{var p=+(s==="left"&&!c||s==="right"&&c);u=Yn(Yn({},u),{},{x1:r+p*o,y1:a,x2:r+p*o,y2:a+i})}return q.createElement("line",zl({},u,{className:Et("recharts-cartesian-axis-line",Ir(l,"className"))}))}},{key:"renderTicks",value:function(n,r,a){var o=this,i=this.props,s=i.tickLine,c=i.stroke,l=i.tick,u=i.tickFormatter,d=i.unit,p=yk(Yn(Yn({},this.props),{},{ticks:n}),r,a),f=this.getTickTextAnchor(),m=this.getTickVerticalAnchor(),y=bt(this.props,!1),v=bt(l,!1),b=Yn(Yn({},y),{},{fill:"none"},bt(s,!1)),w=p.map(function(_,x){var j=o.getTickLineCoord(_),E=j.line,S=j.tick,O=Yn(Yn(Yn(Yn({textAnchor:f,verticalAnchor:m},y),{},{stroke:"none",fill:c},v),S),{},{index:x,payload:_,visibleTicksCount:p.length,tickFormatter:u});return q.createElement(xn,zl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},Ky(o.props,_,x)),s&&q.createElement("line",zl({},b,E,{className:Et("recharts-cartesian-axis-tick-line",Ir(s,"className"))})),l&&t.renderTickItem(l,O,"".concat(at(u)?u(_.value,x):_.value).concat(d||"")))});return q.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,r=this.props,a=r.axisLine,o=r.width,i=r.height,s=r.ticksGenerator,c=r.className,l=r.hide;if(l)return null;var u=this.props,d=u.ticks,p=gk(u,zTe),f=d;return at(s)&&(f=d&&d.length>0?s(this.props):s(p)),o<=0||i<=0||!f||!f.length?null:q.createElement(xn,{className:Et("recharts-cartesian-axis",c),ref:function(m){n.layerReference=m}},a&&this.renderAxisLine(),this.renderTicks(f,this.state.fontSize,this.state.letterSpacing),Un.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,r,a){var o;return q.isValidElement(n)?o=q.cloneElement(n,r):at(n)?o=n(r):o=q.createElement(fg,zl({},r,{className:"recharts-cartesian-axis-tick-value"}),a),o}}])}(g.Component);bk(Ul,"displayName","CartesianAxis"),bk(Ul,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var XTe=["x1","y1","x2","y2","key"],JTe=["offset"];function Bs(e){"@babel/helpers - typeof";return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}function gZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Wn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gZ(Object(n),!0).forEach(function(r){YTe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function YTe(e,t,n){return t=QTe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QTe(e){var t=eIe(e,"string");return Bs(t)=="symbol"?t:t+""}function eIe(e,t){if(Bs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zs(){return zs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zs.apply(this,arguments)}function vZ(e,t){if(e==null)return{};var n=tIe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tIe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var nIe=function(e){var t=e.fill;if(!t||t==="none")return null;var n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.ry;return q.createElement("rect",{x:r,y:a,ry:s,width:o,height:i,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function bZ(e,t){var n;if(q.isValidElement(e))n=q.cloneElement(e,t);else if(at(e))n=e(t);else{var r=t.x1,a=t.y1,o=t.x2,i=t.y2,s=t.key,c=vZ(t,XTe),l=bt(c,!1);l.offset;var u=vZ(l,JTe);n=q.createElement("line",zs({},u,{x1:r,y1:a,x2:o,y2:i,fill:"none",key:s}))}return n}function rIe(e){var t=e.x,n=e.width,r=e.horizontal,a=r===void 0?!0:r,o=e.horizontalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=Wn(Wn({},e),{},{x1:t,y1:s,x2:t+n,y2:s,key:"line-".concat(c),index:c});return bZ(a,l)});return q.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function aIe(e){var t=e.y,n=e.height,r=e.vertical,a=r===void 0?!0:r,o=e.verticalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=Wn(Wn({},e),{},{x1:s,y1:t,x2:s,y2:t+n,key:"line-".concat(c),index:c});return bZ(a,l)});return q.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function oIe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.horizontalPoints,c=e.horizontal,l=c===void 0?!0:c;if(!l||!t||!t.length)return null;var u=s.map(function(p){return Math.round(p+a-a)}).sort(function(p,f){return p-f});a!==u[0]&&u.unshift(0);var d=u.map(function(p,f){var m=!u[f+1],y=m?a+i-p:u[f+1]-p;if(y<=0)return null;var v=f%t.length;return q.createElement("rect",{key:"react-".concat(f),y:p,x:r,height:y,width:o,stroke:"none",fill:t[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return q.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function iIe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,a=e.fillOpacity,o=e.x,i=e.y,s=e.width,c=e.height,l=e.verticalPoints;if(!n||!r||!r.length)return null;var u=l.map(function(p){return Math.round(p+o-o)}).sort(function(p,f){return p-f});o!==u[0]&&u.unshift(0);var d=u.map(function(p,f){var m=!u[f+1],y=m?o+s-p:u[f+1]-p;if(y<=0)return null;var v=f%r.length;return q.createElement("rect",{key:"react-".concat(f),x:p,y:i,width:y,height:c,stroke:"none",fill:r[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return q.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var sIe=function(e,t){var n=e.xAxis,r=e.width,a=e.height,o=e.offset;return XH(yk(Wn(Wn(Wn({},Ul.defaultProps),n),{},{ticks:ei(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.left,o.left+o.width,t)},cIe=function(e,t){var n=e.yAxis,r=e.width,a=e.height,o=e.offset;return XH(yk(Wn(Wn(Wn({},Ul.defaultProps),n),{},{ticks:ei(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.top,o.top+o.height,t)},Vl={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function wZ(e){var t,n,r,a,o,i,s=ik(),c=sk(),l=G2e(),u=Wn(Wn({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Vl.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Vl.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:Vl.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Vl.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:Vl.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:Vl.verticalFill,x:ye(e.x)?e.x:l.left,y:ye(e.y)?e.y:l.top,width:ye(e.width)?e.width:l.width,height:ye(e.height)?e.height:l.height}),d=u.x,p=u.y,f=u.width,m=u.height,y=u.syncWithTicks,v=u.horizontalValues,b=u.verticalValues,w=q2e(),_=K2e();if(!ye(f)||f<=0||!ye(m)||m<=0||!ye(d)||d!==+d||!ye(p)||p!==+p)return null;var x=u.verticalCoordinatesGenerator||sIe,j=u.horizontalCoordinatesGenerator||cIe,E=u.horizontalPoints,S=u.verticalPoints;if((!E||!E.length)&&at(j)){var O=v&&v.length,N=j({yAxis:_?Wn(Wn({},_),{},{ticks:O?v:_.ticks}):void 0,width:s,height:c,offset:l},O?!0:y);Ho(Array.isArray(N),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Bs(N),"]")),Array.isArray(N)&&(E=N)}if((!S||!S.length)&&at(x)){var M=b&&b.length,k=x({xAxis:w?Wn(Wn({},w),{},{ticks:M?b:w.ticks}):void 0,width:s,height:c,offset:l},M?!0:y);Ho(Array.isArray(k),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Bs(k),"]")),Array.isArray(k)&&(S=k)}return q.createElement("g",{className:"recharts-cartesian-grid"},q.createElement(nIe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),q.createElement(rIe,zs({},u,{offset:l,horizontalPoints:E,xAxis:w,yAxis:_})),q.createElement(aIe,zs({},u,{offset:l,verticalPoints:S,xAxis:w,yAxis:_})),q.createElement(oIe,zs({},u,{horizontalPoints:E})),q.createElement(iIe,zs({},u,{verticalPoints:S})))}wZ.displayName="CartesianGrid";function Wl(e){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(e)}function lIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jZ(r.key),r)}}function dIe(e,t,n){return t&&uIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pIe(e,t,n){return t=fv(t),fIe(e,xZ()?Reflect.construct(t,n||[],fv(e).constructor):t.apply(e,n))}function fIe(e,t){if(t&&(Wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hIe(e)}function hIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xZ=function(){return!!e})()}function fv(e){return fv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fv(e)}function mIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wk(e,t)}function wk(e,t){return wk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},wk(e,t)}function _Z(e,t,n){return t=jZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jZ(e){var t=yIe(e,"string");return Wl(t)=="symbol"?t:t+""}function yIe(e,t){if(Wl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Wl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xk(){return xk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xk.apply(this,arguments)}function gIe(e){var t=e.xAxisId,n=ik(),r=sk(),a=XK(t);return a==null?null:q.createElement(Ul,xk({},a,{className:Et("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return ei(o,!0)}}))}var hv=function(e){function t(){return lIe(this,t),pIe(this,t,arguments)}return mIe(t,e),dIe(t,[{key:"render",value:function(){return q.createElement(gIe,this.props)}}])}(q.Component);_Z(hv,"displayName","XAxis"),_Z(hv,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Hl(e){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hl(e)}function vIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,OZ(r.key),r)}}function wIe(e,t,n){return t&&bIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function xIe(e,t,n){return t=mv(t),_Ie(e,EZ()?Reflect.construct(t,n||[],mv(e).constructor):t.apply(e,n))}function _Ie(e,t){if(t&&(Hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jIe(e)}function jIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EZ=function(){return!!e})()}function mv(e){return mv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mv(e)}function EIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_k(e,t)}function _k(e,t){return _k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},_k(e,t)}function SZ(e,t,n){return t=OZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OZ(e){var t=SIe(e,"string");return Hl(t)=="symbol"?t:t+""}function SIe(e,t){if(Hl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Hl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jk(){return jk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jk.apply(this,arguments)}var OIe=function(e){var t=e.yAxisId,n=ik(),r=sk(),a=JK(t);return a==null?null:q.createElement(Ul,jk({},a,{className:Et("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return ei(o,!0)}}))},Ek=function(e){function t(){return vIe(this,t),xIe(this,t,arguments)}return EIe(t,e),wIe(t,[{key:"render",value:function(){return q.createElement(OIe,this.props)}}])}(q.Component);SZ(Ek,"displayName","YAxis"),SZ(Ek,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function CZ(e){return MIe(e)||kIe(e)||NIe(e)||CIe()}function CIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NIe(e,t){if(e){if(typeof e=="string")return Sk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sk(e,t)}}function kIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MIe(e){if(Array.isArray(e))return Sk(e)}function Sk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ok=function(e,t,n,r,a){var o=Ca(e,dk),i=Ca(e,sv),s=[].concat(CZ(o),CZ(i)),c=Ca(e,uv),l="".concat(r,"Id"),u=r[0],d=t;if(s.length&&(d=s.reduce(function(m,y){if(y.props[l]===n&&oo(y.props,"extendDomain")&&ye(y.props[u])){var v=y.props[u];return[Math.min(m[0],v),Math.max(m[1],v)]}return m},d)),c.length){var p="".concat(u,"1"),f="".concat(u,"2");d=c.reduce(function(m,y){if(y.props[l]===n&&oo(y.props,"extendDomain")&&ye(y.props[p])&&ye(y.props[f])){var v=y.props[p],b=y.props[f];return[Math.min(m[0],v,b),Math.max(m[1],v,b)]}return m},d)}return a&&a.length&&(d=a.reduce(function(m,y){return ye(y)?[Math.min(m[0],y),Math.max(m[1],y)]:m},d)),d},NZ={exports:{}},kZ;function AIe(){return kZ||(kZ=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,p){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new a(u,d||c,p),m=n?n+l:l;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],f]:c._events[m].push(f):(c._events[m]=f,c._eventsCount++),c}function i(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)t.call(l,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},s.prototype.listeners=function(c){var l=n?n+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,p=u.length,f=new Array(p);d<p;d++)f[d]=u[d].fn;return f},s.prototype.listenerCount=function(c){var l=n?n+c:c,u=this._events[l];return u?u.fn?1:u.length:0},s.prototype.emit=function(c,l,u,d,p,f){var m=n?n+c:c;if(!this._events[m])return!1;var y=this._events[m],v=arguments.length,b,w;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),v){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,l),!0;case 3:return y.fn.call(y.context,l,u),!0;case 4:return y.fn.call(y.context,l,u,d),!0;case 5:return y.fn.call(y.context,l,u,d,p),!0;case 6:return y.fn.call(y.context,l,u,d,p,f),!0}for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];y.fn.apply(y.context,b)}else{var _=y.length,x;for(w=0;w<_;w++)switch(y[w].once&&this.removeListener(c,y[w].fn,void 0,!0),v){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,l);break;case 3:y[w].fn.call(y[w].context,l,u);break;case 4:y[w].fn.call(y[w].context,l,u,d);break;default:if(!b)for(x=1,b=new Array(v-1);x<v;x++)b[x-1]=arguments[x];y[w].fn.apply(y[w].context,b)}}return!0},s.prototype.on=function(c,l,u){return o(this,c,l,u,!1)},s.prototype.once=function(c,l,u){return o(this,c,l,u,!0)},s.prototype.removeListener=function(c,l,u,d){var p=n?n+c:c;if(!this._events[p])return this;if(!l)return i(this,p),this;var f=this._events[p];if(f.fn)f.fn===l&&(!d||f.once)&&(!u||f.context===u)&&i(this,p);else{for(var m=0,y=[],v=f.length;m<v;m++)(f[m].fn!==l||d&&!f[m].once||u&&f[m].context!==u)&&y.push(f[m]);y.length?this._events[p]=y.length===1?y[0]:y:i(this,p)}return this},s.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&i(this,l)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(NZ)),NZ.exports}var PIe=AIe();const TIe=ct(PIe);var Ck=new TIe,Nk="recharts.syncMouseEvents";function uf(e){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(e)}function IIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,MZ(r.key),r)}}function DIe(e,t,n){return t&&RIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function kk(e,t,n){return t=MZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MZ(e){var t=LIe(e,"string");return uf(t)=="symbol"?t:t+""}function LIe(e,t){if(uf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(uf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var $Ie=function(){function e(){IIe(this,e),kk(this,"activeIndex",0),kk(this,"coordinateList",[]),kk(this,"layout","horizontal")}return DIe(e,[{key:"setDetails",value:function(t){var n,r=t.coordinateList,a=r===void 0?null:r,o=t.container,i=o===void 0?null:o,s=t.layout,c=s===void 0?null:s,l=t.offset,u=l===void 0?null:l,d=t.mouseHandlerCallback,p=d===void 0?null:d;this.coordinateList=(n=a??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=c??this.layout,this.offset=u??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(t){if(this.coordinateList.length!==0)switch(t.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(t){this.activeIndex=t}},{key:"spoofMouse",value:function(){var t,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var r=this.container.getBoundingClientRect(),a=r.x,o=r.y,i=r.height,s=this.coordinateList[this.activeIndex].coordinate,c=((t=window)===null||t===void 0?void 0:t.scrollX)||0,l=((n=window)===null||n===void 0?void 0:n.scrollY)||0,u=a+s+c,d=o+this.offset.top+i/2+l;this.mouseHandlerCallback({pageX:u,pageY:d})}}}])}();function FIe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],a=e==null?void 0:e[1];if(r&&a&&ye(r)&&ye(a))return!0}return!1}function BIe(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function AZ(e){var t=e.cx,n=e.cy,r=e.radius,a=e.startAngle,o=e.endAngle,i=Pn(t,n,r,a),s=Pn(t,n,r,o);return{points:[i,s],cx:t,cy:n,radius:r,startAngle:a,endAngle:o}}function zIe(e,t,n){var r,a,o,i;if(e==="horizontal")r=t.x,o=r,a=n.top,i=n.top+n.height;else if(e==="vertical")a=t.y,i=a,r=n.left,o=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,c=t.cy,l=t.innerRadius,u=t.outerRadius,d=t.angle,p=Pn(s,c,l,d),f=Pn(s,c,u,d);r=p.x,a=p.y,o=f.x,i=f.y}else return AZ(t);return[{x:r,y:a},{x:o,y:i}]}function df(e){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}function PZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function yv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?PZ(Object(n),!0).forEach(function(r){UIe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function UIe(e,t,n){return t=VIe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VIe(e){var t=WIe(e,"string");return df(t)=="symbol"?t:t+""}function WIe(e,t){if(df(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(df(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HIe(e){var t,n,r=e.element,a=e.tooltipEventType,o=e.isActive,i=e.activeCoordinate,s=e.activePayload,c=e.offset,l=e.activeTooltipIndex,u=e.tooltipAxisBandSize,d=e.layout,p=e.chartName,f=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!f||!o||!i||p!=="ScatterChart"&&a!=="axis")return null;var m,y=wq;if(p==="ScatterChart")m=i,y=sPe;else if(p==="BarChart")m=BIe(d,i,c,u),y=DN;else if(d==="radial"){var v=AZ(i),b=v.cx,w=v.cy,_=v.radius,x=v.startAngle,j=v.endAngle;m={cx:b,cy:w,startAngle:x,endAngle:j,innerRadius:_,outerRadius:_},y=yq}else m={points:zIe(d,i,c)},y=wq;var E=yv(yv(yv(yv({stroke:"#ccc",pointerEvents:"none"},c),m),bt(f,!1)),{},{payload:s,payloadIndex:l,className:Et("recharts-tooltip-cursor",f.className)});return g.isValidElement(f)?g.cloneElement(f,E):g.createElement(y,E)}var qIe=["item"],KIe=["children","className","width","height","style","compact","title","desc"];function ql(e){"@babel/helpers - typeof";return ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(e)}function Kl(){return Kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kl.apply(this,arguments)}function TZ(e,t){return XIe(e)||GIe(e,t)||DZ(e,t)||ZIe()}function ZIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GIe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function XIe(e){if(Array.isArray(e))return e}function IZ(e,t){if(e==null)return{};var n=JIe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function JIe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function YIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$Z(r.key),r)}}function eRe(e,t,n){return t&&QIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tRe(e,t,n){return t=gv(t),nRe(e,RZ()?Reflect.construct(t,n||[],gv(e).constructor):t.apply(e,n))}function nRe(e,t){if(t&&(ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rRe(e)}function rRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RZ=function(){return!!e})()}function gv(e){return gv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gv(e)}function aRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mk(e,t)}function Mk(e,t){return Mk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Mk(e,t)}function Zl(e){return sRe(e)||iRe(e)||DZ(e)||oRe()}function oRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DZ(e,t){if(e){if(typeof e=="string")return Ak(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ak(e,t)}}function iRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sRe(e){if(Array.isArray(e))return Ak(e)}function Ak(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function LZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?LZ(Object(n),!0).forEach(function(r){Fe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fe(e,t,n){return t=$Z(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $Z(e){var t=cRe(e,"string");return ql(t)=="symbol"?t:t+""}function cRe(e,t){if(ql(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ql(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lRe={xAxis:["bottom","top"],yAxis:["left","right"]},uRe={width:"100%",height:"100%"},FZ={x:0,y:0};function vv(e){return e}var dRe=function(e,t){return t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius},pRe=function(e,t,n,r){var a=t.find(function(l){return l&&l.index===n});if(a){if(e==="horizontal")return{x:a.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:a.coordinate};if(e==="centric"){var o=a.coordinate,i=r.radius;return se(se(se({},r),Pn(r.cx,r.cy,i,o)),{},{angle:o,radius:i})}var s=a.coordinate,c=r.angle;return se(se(se({},r),Pn(r.cx,r.cy,s,c)),{},{angle:c,radius:s})}return FZ},bv=function(e,t){var n=t.graphicalItems,r=t.dataStartIndex,a=t.dataEndIndex,o=(n??[]).reduce(function(i,s){var c=s.props.data;return c&&c.length?[].concat(Zl(i),Zl(c)):i},[]);return o.length>0?o:e&&e.length&&ye(r)&&ye(a)?e.slice(r,a+1):[]};function BZ(e){return e==="number"?[0,"auto"]:void 0}var Pk=function(e,t,n,r){var a=e.graphicalItems,o=e.tooltipAxis,i=bv(t,e);return n<0||!a||!a.length||n>=i.length?null:a.reduce(function(s,c){var l,u=(l=c.props.data)!==null&&l!==void 0?l:t;u&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(u=u.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(o.dataKey&&!o.allowDuplicatedCategory){var p=u===void 0?i:u;d=eO(p,o.dataKey,r)}else d=u&&u[n]||i[n];return d?[].concat(Zl(s),[rq(c,d)]):s},[])},zZ=function(e,t,n,r){var a=r||{x:e.chartX,y:e.chartY},o=dRe(a,n),i=e.orderedTooltipTicks,s=e.tooltipAxis,c=e.tooltipTicks,l=nke(o,i,c,s);if(l>=0&&c){var u=c[l]&&c[l].value,d=Pk(e,t,l,u),p=pRe(n,i,l,a);return{activeTooltipIndex:l,activeLabel:u,activePayload:d,activeCoordinate:p}}return null},fRe=function(e,t){var n=t.axes,r=t.graphicalItems,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=e.stackOffset,p=GH(l,a);return n.reduce(function(f,m){var y,v=m.type.defaultProps!==void 0?se(se({},m.type.defaultProps),m.props):m.props,b=v.type,w=v.dataKey,_=v.allowDataOverflow,x=v.allowDuplicatedCategory,j=v.scale,E=v.ticks,S=v.includeHidden,O=v[o];if(f[O])return f;var N=bv(e.data,{graphicalItems:r.filter(function(U){var $,V=o in U.props?U.props[o]:($=U.type.defaultProps)===null||$===void 0?void 0:$[o];return V===O}),dataStartIndex:s,dataEndIndex:c}),M=N.length,k,A,P;FIe(v.domain,_,b)&&(k=vN(v.domain,null,_),p&&(b==="number"||j!=="auto")&&(P=Dg(N,w,"category")));var C=BZ(b);if(!k||k.length===0){var T,I=(T=v.domain)!==null&&T!==void 0?T:C;if(w){if(k=Dg(N,w,b),b==="category"&&p){var R=h_e(k);x&&R?(A=k,k=Yg(0,M)):x||(k=nq(I,k,m).reduce(function(U,$){return U.indexOf($)>=0?U:[].concat(Zl(U),[$])},[]))}else if(b==="category")x?k=k.filter(function(U){return U!==""&&!wt(U)}):k=nq(I,k,m).reduce(function(U,$){return U.indexOf($)>=0||$===""||wt($)?U:[].concat(Zl(U),[$])},[]);else if(b==="number"){var L=ske(N,r.filter(function(U){var $,V,F=o in U.props?U.props[o]:($=U.type.defaultProps)===null||$===void 0?void 0:$[o],W="hide"in U.props?U.props.hide:(V=U.type.defaultProps)===null||V===void 0?void 0:V.hide;return F===O&&(S||!W)}),w,a,l);L&&(k=L)}p&&(b==="number"||j!=="auto")&&(P=Dg(N,w,"category"))}else p?k=Yg(0,M):i&&i[O]&&i[O].hasStack&&b==="number"?k=d==="expand"?[0,1]:QH(i[O].stackGroups,s,c):k=ZH(N,r.filter(function(U){var $=o in U.props?U.props[o]:U.type.defaultProps[o],V="hide"in U.props?U.props.hide:U.type.defaultProps.hide;return $===O&&(S||!V)}),b,l,!0);if(b==="number")k=Ok(u,k,O,a,E),I&&(k=vN(I,k,_));else if(b==="category"&&I){var D=I,z=k.every(function(U){return D.indexOf(U)>=0});z&&(k=D)}}return se(se({},f),{},Fe({},O,se(se({},v),{},{axisType:a,domain:k,categoricalDomain:P,duplicateDomain:A,originalDomain:(y=v.domain)!==null&&y!==void 0?y:C,isCategorical:p,layout:l})))},{})},hRe=function(e,t){var n=t.graphicalItems,r=t.Axis,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=bv(e.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:c}),p=d.length,f=GH(l,a),m=-1;return n.reduce(function(y,v){var b=v.type.defaultProps!==void 0?se(se({},v.type.defaultProps),v.props):v.props,w=b[o],_=BZ("number");if(!y[w]){m++;var x;return f?x=Yg(0,p):i&&i[w]&&i[w].hasStack?(x=QH(i[w].stackGroups,s,c),x=Ok(u,x,w,a)):(x=vN(_,ZH(d,n.filter(function(j){var E,S,O=o in j.props?j.props[o]:(E=j.type.defaultProps)===null||E===void 0?void 0:E[o],N="hide"in j.props?j.props.hide:(S=j.type.defaultProps)===null||S===void 0?void 0:S.hide;return O===w&&!N}),"number",l),r.defaultProps.allowDataOverflow),x=Ok(u,x,w,a)),se(se({},y),{},Fe({},w,se(se({axisType:a},r.defaultProps),{},{hide:!0,orientation:Ir(lRe,"".concat(a,".").concat(m%2),null),domain:x,originalDomain:_,isCategorical:f,layout:l})))}return y},{})},mRe=function(e,t){var n=t.axisType,r=n===void 0?"xAxis":n,a=t.AxisComp,o=t.graphicalItems,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.children,u="".concat(r,"Id"),d=Ca(l,a),p={};return d&&d.length?p=fRe(e,{axes:d,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c}):o&&o.length&&(p=hRe(e,{Axis:a,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c})),p},yRe=function(e){var t=Ii(e),n=ei(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:lC(n,function(r){return r.coordinate}),tooltipAxis:t,tooltipAxisBandSize:$g(t,n)}},UZ=function(e){var t=e.children,n=e.defaultShowTooltip,r=Sr(t,Rl),a=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(a=r.props.startIndex),r.props.endIndex>=0&&(o=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},gRe=function(e){return!e||!e.length?!1:e.some(function(t){var n=Wo(t&&t.type);return n&&n.indexOf("Bar")>=0})},VZ=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},vRe=function(e,t){var n=e.props,r=e.graphicalItems,a=e.xAxisMap,o=a===void 0?{}:a,i=e.yAxisMap,s=i===void 0?{}:i,c=n.width,l=n.height,u=n.children,d=n.margin||{},p=Sr(u,Rl),f=Sr(u,bl),m=Object.keys(s).reduce(function(x,j){var E=s[j],S=E.orientation;return!E.mirror&&!E.hide?se(se({},x),{},Fe({},S,x[S]+E.width)):x},{left:d.left||0,right:d.right||0}),y=Object.keys(o).reduce(function(x,j){var E=o[j],S=E.orientation;return!E.mirror&&!E.hide?se(se({},x),{},Fe({},S,Ir(x,"".concat(S))+E.height)):x},{top:d.top||0,bottom:d.bottom||0}),v=se(se({},y),m),b=v.bottom;p&&(v.bottom+=p.props.height||Rl.defaultProps.height),f&&t&&(v=oke(v,r,n,t));var w=c-v.left-v.right,_=l-v.top-v.bottom;return se(se({brushBottom:b},v),{},{width:Math.max(w,0),height:Math.max(_,0)})},bRe=function(e,t){if(t==="xAxis")return e[t].width;if(t==="yAxis")return e[t].height},wRe=function(e){var t=e.chartName,n=e.GraphicalChild,r=e.defaultTooltipEventType,a=r===void 0?"axis":r,o=e.validateTooltipEventTypes,i=o===void 0?["axis"]:o,s=e.axisComponents,c=e.legendContent,l=e.formatAxisMap,u=e.defaultProps,d=function(y,v){var b=v.graphicalItems,w=v.stackGroups,_=v.offset,x=v.updateId,j=v.dataStartIndex,E=v.dataEndIndex,S=y.barSize,O=y.layout,N=y.barGap,M=y.barCategoryGap,k=y.maxBarSize,A=VZ(O),P=A.numericAxisName,C=A.cateAxisName,T=gRe(b),I=[];return b.forEach(function(R,L){var D=bv(y.data,{graphicalItems:[R],dataStartIndex:j,dataEndIndex:E}),z=R.type.defaultProps!==void 0?se(se({},R.type.defaultProps),R.props):R.props,U=z.dataKey,$=z.maxBarSize,V=z["".concat(P,"Id")],F=z["".concat(C,"Id")],W={},re=s.reduce(function(Ee,We){var qe=v["".concat(We.axisType,"Map")],Ke=z["".concat(We.axisType,"Id")];qe&&qe[Ke]||We.axisType==="zAxis"||Ds();var It=qe[Ke];return se(se({},Ee),{},Fe(Fe({},We.axisType,It),"".concat(We.axisType,"Ticks"),ei(It)))},W),ee=re[C],G=re["".concat(C,"Ticks")],K=w&&w[V]&&w[V].hasStack&&bke(R,w[V].stackGroups),X=Wo(R.type).indexOf("Bar")>=0,ne=$g(ee,G),B=[],ue=T&&rke({barSize:S,stackGroups:w,totalSize:bRe(re,C)});if(X){var ae,de,je=wt($)?k:$,Le=(ae=(de=$g(ee,G,!0))!==null&&de!==void 0?de:je)!==null&&ae!==void 0?ae:0;B=ake({barGap:N,barCategoryGap:M,bandSize:Le!==ne?Le:ne,sizeList:ue[F],maxBarSize:je}),Le!==ne&&(B=B.map(function(Ee){return se(se({},Ee),{},{position:se(se({},Ee.position),{},{offset:Ee.position.offset-Le/2})})}))}var $e=R&&R.type&&R.type.getComposedData;$e&&I.push({props:se(se({},$e(se(se({},re),{},{displayedData:D,props:y,dataKey:U,item:R,bandSize:ne,barPosition:B,offset:_,stackedData:K,layout:O,dataStartIndex:j,dataEndIndex:E}))),{},Fe(Fe(Fe({key:R.key||"item-".concat(L)},P,re[P]),C,re[C]),"animationId",x)),childIndex:S_e(R,y.children),item:R})}),I},p=function(y,v){var b=y.props,w=y.dataStartIndex,_=y.dataEndIndex,x=y.updateId;if(!sU({props:b}))return null;var j=b.children,E=b.layout,S=b.stackOffset,O=b.data,N=b.reverseStackOrder,M=VZ(E),k=M.numericAxisName,A=M.cateAxisName,P=Ca(j,n),C=yke(O,P,"".concat(k,"Id"),"".concat(A,"Id"),S,N),T=s.reduce(function(z,U){var $="".concat(U.axisType,"Map");return se(se({},z),{},Fe({},$,mRe(b,se(se({},U),{},{graphicalItems:P,stackGroups:U.axisType===k&&C,dataStartIndex:w,dataEndIndex:_}))))},{}),I=vRe(se(se({},T),{},{props:b,graphicalItems:P}),v==null?void 0:v.legendBBox);Object.keys(T).forEach(function(z){T[z]=l(b,T[z],I,z.replace("Map",""),t)});var R=T["".concat(A,"Map")],L=yRe(R),D=d(b,se(se({},T),{},{dataStartIndex:w,dataEndIndex:_,updateId:x,graphicalItems:P,stackGroups:C,offset:I}));return se(se({formattedGraphicalItems:D,graphicalItems:P,offset:I,stackGroups:C},L),T)},f=function(y){function v(b){var w,_,x;return YIe(this,v),x=tRe(this,v,[b]),Fe(x,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Fe(x,"accessibilityManager",new $Ie),Fe(x,"handleLegendBBoxUpdate",function(j){if(j){var E=x.state,S=E.dataStartIndex,O=E.dataEndIndex,N=E.updateId;x.setState(se({legendBBox:j},p({props:x.props,dataStartIndex:S,dataEndIndex:O,updateId:N},se(se({},x.state),{},{legendBBox:j}))))}}),Fe(x,"handleReceiveSyncEvent",function(j,E,S){if(x.props.syncId===j){if(S===x.eventEmitterSymbol&&typeof x.props.syncMethod!="function")return;x.applySyncEvent(E)}}),Fe(x,"handleBrushChange",function(j){var E=j.startIndex,S=j.endIndex;if(E!==x.state.dataStartIndex||S!==x.state.dataEndIndex){var O=x.state.updateId;x.setState(function(){return se({dataStartIndex:E,dataEndIndex:S},p({props:x.props,dataStartIndex:E,dataEndIndex:S,updateId:O},x.state))}),x.triggerSyncEvent({dataStartIndex:E,dataEndIndex:S})}}),Fe(x,"handleMouseEnter",function(j){var E=x.getMouseInfo(j);if(E){var S=se(se({},E),{},{isTooltipActive:!0});x.setState(S),x.triggerSyncEvent(S);var O=x.props.onMouseEnter;at(O)&&O(S,j)}}),Fe(x,"triggeredAfterMouseMove",function(j){var E=x.getMouseInfo(j),S=E?se(se({},E),{},{isTooltipActive:!0}):{isTooltipActive:!1};x.setState(S),x.triggerSyncEvent(S);var O=x.props.onMouseMove;at(O)&&O(S,j)}),Fe(x,"handleItemMouseEnter",function(j){x.setState(function(){return{isTooltipActive:!0,activeItem:j,activePayload:j.tooltipPayload,activeCoordinate:j.tooltipPosition||{x:j.cx,y:j.cy}}})}),Fe(x,"handleItemMouseLeave",function(){x.setState(function(){return{isTooltipActive:!1}})}),Fe(x,"handleMouseMove",function(j){j.persist(),x.throttleTriggeredAfterMouseMove(j)}),Fe(x,"handleMouseLeave",function(j){x.throttleTriggeredAfterMouseMove.cancel();var E={isTooltipActive:!1};x.setState(E),x.triggerSyncEvent(E);var S=x.props.onMouseLeave;at(S)&&S(E,j)}),Fe(x,"handleOuterEvent",function(j){var E=E_e(j),S=Ir(x.props,"".concat(E));if(E&&at(S)){var O,N;/.*touch.*/i.test(E)?N=x.getMouseInfo(j.changedTouches[0]):N=x.getMouseInfo(j),S((O=N)!==null&&O!==void 0?O:{},j)}}),Fe(x,"handleClick",function(j){var E=x.getMouseInfo(j);if(E){var S=se(se({},E),{},{isTooltipActive:!0});x.setState(S),x.triggerSyncEvent(S);var O=x.props.onClick;at(O)&&O(S,j)}}),Fe(x,"handleMouseDown",function(j){var E=x.props.onMouseDown;if(at(E)){var S=x.getMouseInfo(j);E(S,j)}}),Fe(x,"handleMouseUp",function(j){var E=x.props.onMouseUp;if(at(E)){var S=x.getMouseInfo(j);E(S,j)}}),Fe(x,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.throttleTriggeredAfterMouseMove(j.changedTouches[0])}),Fe(x,"handleTouchStart",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.handleMouseDown(j.changedTouches[0])}),Fe(x,"handleTouchEnd",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.handleMouseUp(j.changedTouches[0])}),Fe(x,"triggerSyncEvent",function(j){x.props.syncId!==void 0&&Ck.emit(Nk,x.props.syncId,j,x.eventEmitterSymbol)}),Fe(x,"applySyncEvent",function(j){var E=x.props,S=E.layout,O=E.syncMethod,N=x.state.updateId,M=j.dataStartIndex,k=j.dataEndIndex;if(j.dataStartIndex!==void 0||j.dataEndIndex!==void 0)x.setState(se({dataStartIndex:M,dataEndIndex:k},p({props:x.props,dataStartIndex:M,dataEndIndex:k,updateId:N},x.state)));else if(j.activeTooltipIndex!==void 0){var A=j.chartX,P=j.chartY,C=j.activeTooltipIndex,T=x.state,I=T.offset,R=T.tooltipTicks;if(!I)return;if(typeof O=="function")C=O(R,j);else if(O==="value"){C=-1;for(var L=0;L<R.length;L++)if(R[L].value===j.activeLabel){C=L;break}}var D=se(se({},I),{},{x:I.left,y:I.top}),z=Math.min(A,D.x+D.width),U=Math.min(P,D.y+D.height),$=R[C]&&R[C].value,V=Pk(x.state,x.props.data,C),F=R[C]?{x:S==="horizontal"?R[C].coordinate:z,y:S==="horizontal"?U:R[C].coordinate}:FZ;x.setState(se(se({},j),{},{activeLabel:$,activeCoordinate:F,activePayload:V,activeTooltipIndex:C}))}else x.setState(j)}),Fe(x,"renderCursor",function(j){var E,S=x.state,O=S.isTooltipActive,N=S.activeCoordinate,M=S.activePayload,k=S.offset,A=S.activeTooltipIndex,P=S.tooltipAxisBandSize,C=x.getTooltipEventType(),T=(E=j.props.active)!==null&&E!==void 0?E:O,I=x.props.layout,R=j.key||"_recharts-cursor";return q.createElement(HIe,{key:R,activeCoordinate:N,activePayload:M,activeTooltipIndex:A,chartName:t,element:j,isActive:T,layout:I,offset:k,tooltipAxisBandSize:P,tooltipEventType:C})}),Fe(x,"renderPolarAxis",function(j,E,S){var O=Ir(j,"type.axisType"),N=Ir(x.state,"".concat(O,"Map")),M=j.type.defaultProps,k=M!==void 0?se(se({},M),j.props):j.props,A=N&&N[k["".concat(O,"Id")]];return g.cloneElement(j,se(se({},A),{},{className:Et(O,A.className),key:j.key||"".concat(E,"-").concat(S),ticks:ei(A,!0)}))}),Fe(x,"renderPolarGrid",function(j){var E=j.props,S=E.radialLines,O=E.polarAngles,N=E.polarRadius,M=x.state,k=M.radiusAxisMap,A=M.angleAxisMap,P=Ii(k),C=Ii(A),T=C.cx,I=C.cy,R=C.innerRadius,L=C.outerRadius;return g.cloneElement(j,{polarAngles:Array.isArray(O)?O:ei(C,!0).map(function(D){return D.coordinate}),polarRadius:Array.isArray(N)?N:ei(P,!0).map(function(D){return D.coordinate}),cx:T,cy:I,innerRadius:R,outerRadius:L,key:j.key||"polar-grid",radialLines:S})}),Fe(x,"renderLegend",function(){var j=x.state.formattedGraphicalItems,E=x.props,S=E.children,O=E.width,N=E.height,M=x.props.margin||{},k=O-(M.left||0)-(M.right||0),A=WH({children:S,formattedGraphicalItems:j,legendWidth:k,legendContent:c});if(!A)return null;var P=A.item,C=IZ(A,qIe);return g.cloneElement(P,se(se({},C),{},{chartWidth:O,chartHeight:N,margin:M,onBBoxUpdate:x.handleLegendBBoxUpdate}))}),Fe(x,"renderTooltip",function(){var j,E=x.props,S=E.children,O=E.accessibilityLayer,N=Sr(S,to);if(!N)return null;var M=x.state,k=M.isTooltipActive,A=M.activeCoordinate,P=M.activePayload,C=M.activeLabel,T=M.offset,I=(j=N.props.active)!==null&&j!==void 0?j:k;return g.cloneElement(N,{viewBox:se(se({},T),{},{x:T.left,y:T.top}),active:I,label:C,payload:I?P:[],coordinate:A,accessibilityLayer:O})}),Fe(x,"renderBrush",function(j){var E=x.props,S=E.margin,O=E.data,N=x.state,M=N.offset,k=N.dataStartIndex,A=N.dataEndIndex,P=N.updateId;return g.cloneElement(j,{key:j.key||"_recharts-brush",onChange:Lg(x.handleBrushChange,j.props.onChange),data:O,x:ye(j.props.x)?j.props.x:M.left,y:ye(j.props.y)?j.props.y:M.top+M.height+M.brushBottom-(S.bottom||0),width:ye(j.props.width)?j.props.width:M.width,startIndex:k,endIndex:A,updateId:"brush-".concat(P)})}),Fe(x,"renderReferenceElement",function(j,E,S){if(!j)return null;var O=x,N=O.clipPathId,M=x.state,k=M.xAxisMap,A=M.yAxisMap,P=M.offset,C=j.type.defaultProps||{},T=j.props,I=T.xAxisId,R=I===void 0?C.xAxisId:I,L=T.yAxisId,D=L===void 0?C.yAxisId:L;return g.cloneElement(j,{key:j.key||"".concat(E,"-").concat(S),xAxis:k[R],yAxis:A[D],viewBox:{x:P.left,y:P.top,width:P.width,height:P.height},clipPathId:N})}),Fe(x,"renderActivePoints",function(j){var E=j.item,S=j.activePoint,O=j.basePoint,N=j.childIndex,M=j.isRange,k=[],A=E.props.key,P=E.item.type.defaultProps!==void 0?se(se({},E.item.type.defaultProps),E.item.props):E.item.props,C=P.activeDot,T=P.dataKey,I=se(se({index:N,dataKey:T,cx:S.x,cy:S.y,r:4,fill:yN(E.item),strokeWidth:2,stroke:"#fff",payload:S.payload,value:S.value},bt(C,!1)),qy(C));return k.push(v.renderActiveDot(C,I,"".concat(A,"-activePoint-").concat(N))),O?k.push(v.renderActiveDot(C,se(se({},I),{},{cx:O.x,cy:O.y}),"".concat(A,"-basePoint-").concat(N))):M&&k.push(null),k}),Fe(x,"renderGraphicChild",function(j,E,S){var O=x.filterFormatItem(j,E,S);if(!O)return null;var N=x.getTooltipEventType(),M=x.state,k=M.isTooltipActive,A=M.tooltipAxis,P=M.activeTooltipIndex,C=M.activeLabel,T=x.props.children,I=Sr(T,to),R=O.props,L=R.points,D=R.isRange,z=R.baseLine,U=O.item.type.defaultProps!==void 0?se(se({},O.item.type.defaultProps),O.item.props):O.item.props,$=U.activeDot,V=U.hide,F=U.activeBar,W=U.activeShape,re=!!(!V&&k&&I&&($||F||W)),ee={};N!=="axis"&&I&&I.props.trigger==="click"?ee={onClick:Lg(x.handleItemMouseEnter,j.props.onClick)}:N!=="axis"&&(ee={onMouseLeave:Lg(x.handleItemMouseLeave,j.props.onMouseLeave),onMouseEnter:Lg(x.handleItemMouseEnter,j.props.onMouseEnter)});var G=g.cloneElement(j,se(se({},O.props),ee));function K(qe){return typeof A.dataKey=="function"?A.dataKey(qe.payload):null}if(re)if(P>=0){var X,ne;if(A.dataKey&&!A.allowDuplicatedCategory){var B=typeof A.dataKey=="function"?K:"payload.".concat(A.dataKey.toString());X=eO(L,B,C),ne=D&&z&&eO(z,B,C)}else X=L==null?void 0:L[P],ne=D&&z&&z[P];if(W||F){var ue=j.props.activeIndex!==void 0?j.props.activeIndex:P;return[g.cloneElement(j,se(se(se({},O.props),ee),{},{activeIndex:ue})),null,null]}if(!wt(X))return[G].concat(Zl(x.renderActivePoints({item:O,activePoint:X,basePoint:ne,childIndex:P,isRange:D})))}else{var ae,de=(ae=x.getItemByXY(x.state.activeCoordinate))!==null&&ae!==void 0?ae:{graphicalItem:G},je=de.graphicalItem,Le=je.item,$e=Le===void 0?j:Le,Ee=je.childIndex,We=se(se(se({},O.props),ee),{},{activeIndex:Ee});return[g.cloneElement($e,We),null,null]}return D?[G,null,null]:[G,null]}),Fe(x,"renderCustomized",function(j,E,S){return g.cloneElement(j,se(se({key:"recharts-customized-".concat(S)},x.props),x.state))}),Fe(x,"renderMap",{CartesianGrid:{handler:vv,once:!0},ReferenceArea:{handler:x.renderReferenceElement},ReferenceLine:{handler:vv},ReferenceDot:{handler:x.renderReferenceElement},XAxis:{handler:vv},YAxis:{handler:vv},Brush:{handler:x.renderBrush,once:!0},Bar:{handler:x.renderGraphicChild},Line:{handler:x.renderGraphicChild},Area:{handler:x.renderGraphicChild},Radar:{handler:x.renderGraphicChild},RadialBar:{handler:x.renderGraphicChild},Scatter:{handler:x.renderGraphicChild},Pie:{handler:x.renderGraphicChild},Funnel:{handler:x.renderGraphicChild},Tooltip:{handler:x.renderCursor,once:!0},PolarGrid:{handler:x.renderPolarGrid,once:!0},PolarAngleAxis:{handler:x.renderPolarAxis},PolarRadiusAxis:{handler:x.renderPolarAxis},Customized:{handler:x.renderCustomized}}),x.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:Hy("recharts"),"-clip"),x.throttleTriggeredAfterMouseMove=Lv(x.triggeredAfterMouseMove,(_=b.throttleDelay)!==null&&_!==void 0?_:1e3/60),x.state={},x}return aRe(v,y),eRe(v,[{key:"componentDidMount",value:function(){var b,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,w=b.children,_=b.data,x=b.height,j=b.layout,E=Sr(w,to);if(E){var S=E.props.defaultIndex;if(!(typeof S!="number"||S<0||S>this.state.tooltipTicks.length-1)){var O=this.state.tooltipTicks[S]&&this.state.tooltipTicks[S].value,N=Pk(this.state,_,S,O),M=this.state.tooltipTicks[S].coordinate,k=(this.state.offset.top+x)/2,A=j==="horizontal",P=A?{x:M,y:k}:{y:M,x:k},C=this.state.formattedGraphicalItems.find(function(I){var R=I.item;return R.type.name==="Scatter"});C&&(P=se(se({},P),C.props.points[S].tooltipPosition),N=C.props.points[S].tooltipPayload);var T={activeTooltipIndex:S,isTooltipActive:!0,activeLabel:O,activePayload:N,activeCoordinate:P};this.setState(T),this.renderCursor(E),this.accessibilityManager.setIndex(S)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var _,x;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(x=this.props.margin.top)!==null&&x!==void 0?x:0}})}return null}},{key:"componentDidUpdate",value:function(b){iO([Sr(b.children,to)],[Sr(this.props.children,to)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=Sr(this.props.children,to);if(b&&typeof b.props.shared=="boolean"){var w=b.props.shared?"axis":"item";return i.indexOf(w)>=0?w:a}return a}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var w=this.container,_=w.getBoundingClientRect(),x=gSe(_),j={chartX:Math.round(b.pageX-x.left),chartY:Math.round(b.pageY-x.top)},E=_.width/w.offsetWidth||1,S=this.inRange(j.chartX,j.chartY,E);if(!S)return null;var O=this.state,N=O.xAxisMap,M=O.yAxisMap,k=this.getTooltipEventType();if(k!=="axis"&&N&&M){var A=Ii(N).scale,P=Ii(M).scale,C=A&&A.invert?A.invert(j.chartX):null,T=P&&P.invert?P.invert(j.chartY):null;return se(se({},j),{},{xValue:C,yValue:T})}var I=zZ(this.state,this.props.data,this.props.layout,S);return I?se(se({},j),I):null}},{key:"inRange",value:function(b,w){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=this.props.layout,j=b/_,E=w/_;if(x==="horizontal"||x==="vertical"){var S=this.state.offset,O=j>=S.left&&j<=S.left+S.width&&E>=S.top&&E<=S.top+S.height;return O?{x:j,y:E}:null}var N=this.state,M=N.angleAxisMap,k=N.radiusAxisMap;if(M&&k){var A=Ii(M);return iq({x:j,y:E},A)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,w=this.getTooltipEventType(),_=Sr(b,to),x={};_&&w==="axis"&&(_.props.trigger==="click"?x={onClick:this.handleClick}:x={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var j=qy(this.props,this.handleOuterEvent);return se(se({},j),x)}},{key:"addListener",value:function(){Ck.on(Nk,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Ck.removeListener(Nk,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,w,_){for(var x=this.state.formattedGraphicalItems,j=0,E=x.length;j<E;j++){var S=x[j];if(S.item===b||S.props.key===b.key||w===Wo(S.item.type)&&_===S.childIndex)return S}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,w=this.state.offset,_=w.left,x=w.top,j=w.height,E=w.width;return q.createElement("defs",null,q.createElement("clipPath",{id:b},q.createElement("rect",{x:_,y:x,height:j,width:E})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(w,_){var x=TZ(_,2),j=x[0],E=x[1];return se(se({},w),{},Fe({},j,E.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(w,_){var x=TZ(_,2),j=x[0],E=x[1];return se(se({},w),{},Fe({},j,E.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(b){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(b){var w=this.state,_=w.formattedGraphicalItems,x=w.activeItem;if(_&&_.length)for(var j=0,E=_.length;j<E;j++){var S=_[j],O=S.props,N=S.item,M=N.type.defaultProps!==void 0?se(se({},N.type.defaultProps),N.props):N.props,k=Wo(N.type);if(k==="Bar"){var A=(O.data||[]).find(function(I){return JAe(b,I)});if(A)return{graphicalItem:S,payload:A}}else if(k==="RadialBar"){var P=(O.data||[]).find(function(I){return iq(b,I)});if(P)return{graphicalItem:S,payload:P}}else if(Xg(S,x)||Jg(S,x)||rf(S,x)){var C=FPe({graphicalItem:S,activeTooltipItem:x,itemData:M.data}),T=M.activeIndex===void 0?C:M.activeIndex;return{graphicalItem:se(se({},S),{},{childIndex:T}),payload:rf(S,x)?M.data[C]:S.props.data[C]}}}return null}},{key:"render",value:function(){var b=this;if(!sU(this))return null;var w=this.props,_=w.children,x=w.className,j=w.width,E=w.height,S=w.style,O=w.compact,N=w.title,M=w.desc,k=IZ(w,KIe),A=bt(k,!1);if(O)return q.createElement(GK,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},q.createElement(cO,Kl({},A,{width:j,height:E,title:N,desc:M}),this.renderClipPath(),lU(_,this.renderMap)));if(this.props.accessibilityLayer){var P,C;A.tabIndex=(P=this.props.tabIndex)!==null&&P!==void 0?P:0,A.role=(C=this.props.role)!==null&&C!==void 0?C:"application",A.onKeyDown=function(I){b.accessibilityManager.keyboardEvent(I)},A.onFocus=function(){b.accessibilityManager.focus()}}var T=this.parseEventsOfWrapper();return q.createElement(GK,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},q.createElement("div",Kl({className:Et("recharts-wrapper",x),style:se({position:"relative",cursor:"default",width:j,height:E},S)},T,{ref:function(I){b.container=I}}),q.createElement(cO,Kl({},A,{width:j,height:E,title:N,desc:M,style:uRe}),this.renderClipPath(),lU(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(g.Component);Fe(f,"displayName",t),Fe(f,"defaultProps",se({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),Fe(f,"getDerivedStateFromProps",function(y,v){var b=y.dataKey,w=y.data,_=y.children,x=y.width,j=y.height,E=y.layout,S=y.stackOffset,O=y.margin,N=v.dataStartIndex,M=v.dataEndIndex;if(v.updateId===void 0){var k=UZ(y);return se(se(se({},k),{},{updateId:0},p(se(se({props:y},k),{},{updateId:0}),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:j,prevLayout:E,prevStackOffset:S,prevMargin:O,prevChildren:_})}if(b!==v.prevDataKey||w!==v.prevData||x!==v.prevWidth||j!==v.prevHeight||E!==v.prevLayout||S!==v.prevStackOffset||!ml(O,v.prevMargin)){var A=UZ(y),P={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},C=se(se({},zZ(v,w,E)),{},{updateId:v.updateId+1}),T=se(se(se({},A),P),C);return se(se(se({},T),p(se({props:y},T),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:j,prevLayout:E,prevStackOffset:S,prevMargin:O,prevChildren:_})}if(!iO(_,v.prevChildren)){var I,R,L,D,z=Sr(_,Rl),U=z&&(I=(R=z.props)===null||R===void 0?void 0:R.startIndex)!==null&&I!==void 0?I:N,$=z&&(L=(D=z.props)===null||D===void 0?void 0:D.endIndex)!==null&&L!==void 0?L:M,V=U!==N||$!==M,F=!wt(w),W=F&&!V?v.updateId:v.updateId+1;return se(se({updateId:W},p(se(se({props:y},v),{},{updateId:W,dataStartIndex:U,dataEndIndex:$}),v)),{},{prevChildren:_,dataStartIndex:U,dataEndIndex:$})}return null}),Fe(f,"renderActiveDot",function(y,v,b){var w;return g.isValidElement(y)?w=g.cloneElement(y,v):at(y)?w=y(v):w=q.createElement(tK,v),q.createElement(xn,{className:"recharts-active-dot",key:b},w)});var m=g.forwardRef(function(y,v){return q.createElement(f,Kl({},y,{ref:v}))});return m.displayName=f.displayName,m},xRe=wRe({chartName:"BarChart",GraphicalChild:Fs,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:hv},{axisType:"yAxis",AxisComp:Ek}],formatAxisMap:I2e});const _Re={light:"",dark:".dark"},WZ=g.createContext(null);function HZ(){const e=g.useContext(WZ);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const qZ=g.forwardRef(({id:e,className:t,children:n,config:r,...a},o)=>{const i=g.useId(),s=`chart-${e||i.replace(/:/g,"")}`;return h.jsx(WZ.Provider,{value:{config:r},children:h.jsxs("div",{"data-chart":s,ref:o,className:Z("flex aspect-video justify-center text-xs",t),...a,children:[h.jsx(jRe,{id:s,config:r}),h.jsx(uSe,{children:n})]})})});qZ.displayName="Chart";const jRe=({id:e,config:t})=>{const n=Object.entries(t).filter(([r,a])=>a.theme||a.color);return n.length?h.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(_Re).map(([r,a])=>`
${a} [data-chart=${e}] {
${n.map(([o,i])=>{var c;const s=((c=i.theme)==null?void 0:c[r])||i.color;return s?`  --color-${o}: ${s};`:null}).join(`
`)}
}
`).join(`
`)}}):null},ERe=to,KZ=g.forwardRef(({active:e,payload:t,className:n,indicator:r="dot",hideLabel:a=!1,hideIndicator:o=!1,label:i,labelFormatter:s,labelClassName:c,formatter:l,color:u,nameKey:d,labelKey:p},f)=>{const{config:m}=HZ(),y=g.useMemo(()=>{var j;if(a||!(t!=null&&t.length))return null;const[b]=t,w=`${p||b.dataKey||b.name||"value"}`,_=Tk(m,b,w),x=!p&&typeof i=="string"?((j=m[i])==null?void 0:j.label)||i:_==null?void 0:_.label;return s?h.jsx("div",{className:Z("font-medium",c),children:s(x,t)}):x?h.jsx("div",{className:Z("font-medium",c),children:x}):null},[i,s,t,a,c,m,p]);if(!e||!(t!=null&&t.length))return null;const v=t.length===1&&r!=="dot";return h.jsxs("div",{ref:f,className:Z("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[v?null:y,h.jsx("div",{className:"grid gap-1.5",children:t.map((b,w)=>{const _=`${d||b.name||b.dataKey||"value"}`,x=Tk(m,b,_),j=u||b.payload.fill||b.color;return h.jsx("div",{className:Z("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",r==="dot"&&"items-center"),children:l&&(b==null?void 0:b.value)!==void 0&&b.name?l(b.value,b.name,b,w,b.payload):h.jsxs(h.Fragment,{children:[x!=null&&x.icon?h.jsx(x.icon,{}):!o&&h.jsx("div",{className:Z("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":v&&r==="dashed"}),style:{"--color-bg":j,"--color-border":j}}),h.jsxs("div",{className:Z("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[h.jsxs("div",{className:"grid gap-1.5",children:[v?y:null,h.jsx("span",{className:"text-muted-foreground",children:(x==null?void 0:x.label)||b.name})]}),b.value&&h.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:b.value.toLocaleString()})]})]})},b.dataKey)})})]})});KZ.displayName="ChartTooltip";const SRe=g.forwardRef(({className:e,hideIcon:t=!1,payload:n,verticalAlign:r="bottom",nameKey:a},o)=>{const{config:i}=HZ();return n!=null&&n.length?h.jsx("div",{ref:o,className:Z("flex items-center justify-center gap-4",r==="top"?"pb-3":"pt-3",e),children:n.map(s=>{const c=`${a||s.dataKey||"value"}`,l=Tk(i,s,c);return h.jsxs("div",{className:Z("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[l!=null&&l.icon&&!t?h.jsx(l.icon,{}):h.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:s.color}}),l==null?void 0:l.label]},s.value)})}):null});SRe.displayName="ChartLegend";function Tk(e,t,n){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=n;return n in t&&typeof t[n]=="string"?a=t[n]:r&&n in r&&typeof r[n]=="string"&&(a=r[n]),a in e?e[a]:e[n]}const ZZ=e=>{const t=["Bytes","KB","MB","GB","TB"];if(e===void 0)return"Unknown size";if(e===0)return"0 Byte";const n=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,n))} ${t[n]}`},ORe=g.memo(()=>{const{t:e}=Me("flows"),[t,n]=g.useState(),r=lo(m=>m.cachedLLMURLs),a=Je(m=>m.currentSession),[o,i]=g.useState(),[s,c]=g.useState(""),[l,u]=g.useState(),d=g.useMemo(()=>({nodes:{label:e("session_info_node.entities.nodes"),color:"#2563eb"},edges:{label:e("session_info_node.entities.edges"),color:"#34d399"},threads:{label:e("session_info_node.entities.threads"),color:"#fbbf24"},llms:{label:e("session_info_node.entities.llms"),color:"#f87171"},prompts:{label:e("session_info_node.entities.prompts"),color:"#a78bfa"},tools:{label:e("session_info_node.entities.tools"),color:"#ffcccb"},schemas:{label:e("session_info_node.entities.schemas"),color:"#ffb6c1"},vectorDatabases:{label:e("session_info_node.entities.vector_databases"),color:"#ff69b4"},jsonlDatas:{label:e("session_info_node.entities.jsonl_data"),color:"#ff1493"},csvDatas:{label:e("session_info_node.entities.csv_data"),color:"#db7093"}}),[e]);g.useEffect(()=>{qt(async()=>{const{functionCallingModelIds:m,prebuiltAppConfig:y}=await import("./index-C6S3C89h.js").then(async v=>(await v.__tla,v));return{functionCallingModelIds:m,prebuiltAppConfig:y}},__vite__mapDeps([9,1,2,3,4])).then(({functionCallingModelIds:m,prebuiltAppConfig:y})=>{n(r==null?void 0:r.map(v=>{const b=y.model_list.find(w=>v.includes(w.model));if(b)return{model_id:(b==null?void 0:b.model_id)||"",info:b,isFunctionCalling:m.includes((b==null?void 0:b.model_id)||"")}}))})},[r,a==null?void 0:a.id]);const p=g.useCallback(async()=>{navigator.storage.estimate().then(m=>{m&&c(e("session_info_node.used_bytes",{used:ZZ(m.usage),total:ZZ(m==null?void 0:m.quota)}))}),a!=null&&a.id&&(Promise.all([le("FlowNode").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),le("FlowEdge").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),le("Thread").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),le("Prompt").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),le("LLM").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),le("Schema").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),le("ToolDefinition").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),le("VectorDatabase").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),le("JSONLData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),le("CSVData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}})]).then(m=>{const y=m.reduce((v,b)=>b!=null&&b.updated_at&&(!v||new Date(b.updated_at)>v)?new Date(b.updated_at):v,a.updated_at?new Date(a.updated_at):void 0);i(y)}),Promise.all([le("FlowNode").count({where:{session_id:a==null?void 0:a.id}}),le("FlowEdge").count({where:{session_id:a==null?void 0:a.id}}),le("Thread").count({where:{session_id:a==null?void 0:a.id}}),le("Prompt").count({where:{session_id:a==null?void 0:a.id}}),le("LLM").count({where:{session_id:a==null?void 0:a.id}}),le("ToolDefinition").count({where:{session_id:a==null?void 0:a.id}}),le("Schema").count({where:{session_id:a==null?void 0:a.id}}),le("VectorDatabase").count({where:{session_id:a==null?void 0:a.id}}),le("JSONLData").count({where:{session_id:a==null?void 0:a.id}}),le("CSVData").count({where:{session_id:a==null?void 0:a.id}})]).then(([m,y,v,b,w,_,x,j,E,S])=>{u([{name:e("session_info_node.count_info.title"),nodes:m||0,edges:y||0,threads:v||0,prompts:b||0,llms:w||0,tools:_||0,schemas:x||0,vectorDatabases:j||0,jsonlDatas:E||0,csvDatas:S||0}])}))},[a==null?void 0:a.id,a==null?void 0:a.updated_at,e]),f=g.useCallback(()=>{p()},[p]);return g.useEffect(()=>{p()},[p]),h.jsxs(Gt,{className:"w-96",children:[h.jsxs(Mn,{children:[h.jsx(Fn,{children:e("session_info_node.title")}),h.jsx(ZF,{children:o||a!=null&&a.updated_at?h3e(o||(a==null?void 0:a.updated_at)).fromNow():""})]}),h.jsxs(An,{className:"grid gap-4",children:[h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsx("p",{className:"text-sm font-medium leading-none",children:e("session_info_node.disk_size")}),h.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})}),h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsxs("div",{className:"text-sm font-medium leading-none",children:[e("session_info_node.cached_llms"),h.jsx(wn,{className:"ml-2",children:(t==null?void 0:t.length)||0})]}),t==null?void 0:t.map(m=>h.jsxs("div",{className:"text-sm text-muted-foreground gap-1",children:[m==null?void 0:m.model_id,h.jsx("div",{className:"max-w-full gap-1 flex flex-wrap mt-1",children:h.jsx(ip,{model:m==null?void 0:m.info,isFunctionCalling:(m==null?void 0:m.isFunctionCalling)||!1,isCached:!0,cloud:!1})})]},m==null?void 0:m.model_id))]})}),h.jsx("div",{children:h.jsx(qZ,{config:d,className:"min-h-28 w-full",children:h.jsxs(xRe,{accessibilityLayer:!0,data:l,children:[h.jsx(wZ,{vertical:!1}),h.jsx(hv,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),h.jsx(ERe,{content:h.jsx(KZ,{})}),Object.entries(d).map(([m,y])=>h.jsx(Fs,{dataKey:m,fill:y.color,radius:4},m))]})})})]}),h.jsx(Ya,{children:h.jsxs(Ye,{className:"w-full",onClick:f,children:[h.jsx(pe,{size:24,name:"refresh-ccw"}),e("session_info_node.reload")]})})]})}),CRe=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);Hn(e,t)},NRe=g.memo(e=>{var c,l;const{t}=Me("flows"),{id:n,data:r,isConnectable:a}=e,o=g.useRef(!1),i=Rn(n),s=Ie(u=>u.updateNodes);return CRe(n),g.useEffect(()=>{var d;const u=r==null?void 0:r.entity;!u||!i||o.current||(d=u==null?void 0:u.schema_items)!=null&&d.length||r.loaded||(o.current=!0,le("SchemaItem").find({where:{schema_id:u.id}}).then(p=>{s([{id:i.id,type:"replace",item:{...i,data:{...(i==null?void 0:i.data)||{},loaded:!0,entity:{...r.entity,schema_items:p}}}}])}).finally(()=>{o.current=!1}))},[r.entity,r.loaded,i,s]),h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(zn,{id:n}),h.jsxs(rS,{defaultValue:"account",className:"w-[400px]",children:[h.jsxs(Oy,{className:"grid w-full grid-cols-2",children:[h.jsx(xa,{value:"account",children:t("schema_node.typescript")}),h.jsx(xa,{value:"password",children:t("schema_node.zod")})]}),h.jsx(_a,{value:"account",children:h.jsx(Gt,{className:"p-4",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:s0e(((c=r==null?void 0:r.entity)==null?void 0:c.schema_items)||[])})})}),h.jsx(_a,{value:"password",children:h.jsx(Gt,{className:"p-4 max-w-full",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:KF(((l=r==null?void 0:r.entity)==null?void 0:l.schema_items)||[])})})})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:a})]})}),kRe=g.memo(e=>{var o,i;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{if(!(n!=null&&n.entity))return{headers:[],rows:[]};const s=Tv(n.entity.csv);return{headers:Gk(n.entity.headers),rows:s.map(c=>Gk(c))}},[n==null?void 0:n.entity]);return h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(zn,{id:t}),h.jsxs(Gt,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Mn,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(pe,{name:"file-spreadsheet",className:"mr-2"}),h.jsxs(Be,{className:"!font-medium leading-none tracking-tight pr-8",children:[ie.CSVData," ",(o=a==null?void 0:a.rows)!=null&&o.length?`(${((i=a==null?void 0:a.rows)==null?void 0:i.length)||0})`:""]})]})}),h.jsx(An,{className:"pb-0",children:h.jsx($y,{data:a.rows,headers:a.headers})})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),MRe=e=>{const t=Ie(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ie.Schema&&(o==null?void 0:o.type)===ie.ToolDefinition){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Hn(e,n)},ARe=g.memo(({id:e,data:t,isConnectable:n})=>{var r,a;return MRe(e),h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:n}),h.jsx("div",{children:h.jsxs(Er,{className:"flex justify-center",children:[h.jsx(pe,{size:24,name:"wrench"}),h.jsxs("div",{className:"ml-2",children:[h.jsx(Uo,{children:`${((r=t.entity)==null?void 0:r.name)||""}`}),h.jsx(cl,{children:`${((a=t.entity)==null?void 0:a.description)||""}`})]})]})}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:n})]})}),PRe=g.memo(e=>{var d,p;const[t,n]=g.useState(!1),[r,a]=g.useState({}),[o,i]=g.useState({}),{confirmPassphrase:s}=vy(),{t:c}=Me("atoms"),l=async()=>{var f;if(t)a({}),i({});else{if((f=Object.keys(e.encrypted||{}))!=null&&f.length){await s();const m={},y=await ai.get("passphrase");if(!y)throw new Error("Passphrase is not found");await Promise.all(Object.keys(e.encrypted||{}).map(async v=>{var b,w;(b=e.encrypted)!=null&&b[v]&&(m[v]=await Ad((w=e.encrypted)==null?void 0:w[v],y))})),i(m||{})}a({...e.options})}n(!t)},u=()=>{var f;(f=e.onChangeOptions)==null||f.call(e,r||{},o||{}),n(!1)};return h.jsx("div",{className:Z("min-w-20 flex justify-end",e.className),children:h.jsxs(Of,{open:t,onOpenChange:n,children:[h.jsx(x0,{children:h.jsx("div",{className:"flex justify-end gap-2 !cursor-pointer",children:h.jsxs(Ye,{onClick:l,variant:"link",className:"flex items-center px-0 !cursor-pointer",children:[h.jsx(pe,{name:"settings"}),h.jsx(Be,{children:c("embedding_setting.title")})]})})}),h.jsx(mu,{className:"w-full p-0",children:t?h.jsxs(Gt,{className:"!border-none max-w-96 min-w-56",children:[h.jsx(Mn,{children:h.jsx(Fn,{children:c("embedding_setting.title")})}),h.jsxs(An,{children:[h.jsxs(Be,{children:[c("embedding_setting.provider"),":"]}),h.jsxs(Qa,{value:r!=null&&r.provider?`${r==null?void 0:r.provider}`:"local_transformers",onValueChange:f=>a({provider:f}),children:[h.jsx(Ea,{className:"",children:h.jsx(eo,{placeholder:c("embedding_setting.provider_placeholder")})}),h.jsxs(Sa,{children:[h.jsx(Bn,{value:"local_transformers",children:c("embedding_setting.providers.local_transformers")},"local_transformers"),(d=e.supportedProviders)==null?void 0:d.map(f=>h.jsx(Bn,{value:f,children:c(`embedding_setting.providers.${f.toLowerCase()}`)},f))]})]}),(p=e.supportedProviders)!=null&&p.length?void 0:h.jsx(Be,{className:"text-red-500 !pt-2",children:c("embedding_setting.alerts.no_provider")}),h.jsx(h.Fragment,{children:r.provider&&r.provider!=="local_transformers"?h.jsxs(h.Fragment,{children:[h.jsx(Er,{variant:"destructive",className:"mt-4",children:c("embedding_setting.alerts.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(Be,{children:c("embedding_setting.encrypted_fields.api_key")}),h.jsx(Ye,{variant:"link",className:"px-1",children:h.jsxs("a",{href:r.provider===Ve.OpenAI?Uy:zy,target:"_blank",rel:"noreferrer",children:["(",r.provider===Ve.OpenAI?Uy:zy,")"]})}),h.jsx(Kt,{type:"password",value:o!=null&&o.key?`${o==null?void 0:o.key}`:"",onChange:f=>i(m=>({...m,key:f.target.value}))})]})]}):void 0})]}),h.jsx(Ya,{className:"flex justify-end",children:h.jsx(Ye,{variant:"secondary",onClick:u,children:c("embedding_setting.save")})})]}):void 0})]})})}),TRe=e=>{const t=g.useCallback(async({edgeId:n})=>({deleteEdgeId:n}),[]);Hn(e,t)},IRe=e=>{const t=Je(s=>{var c;return(c=s.currentSession)==null?void 0:c.id}),n=Rn(e),r=NL(),a=Ie(s=>s.updateNodes),{confirmOrCreatePassphrase:o}=C7(),i=g.useCallback(async(s,c)=>{var l;if(n&&t){let u=e!==wi.DEFAULT_EMBEDDING_MODEL?await le("FlowNode").findOne({where:{id:e}}):void 0;const d={};if((l=Object.keys(c||{}))!=null&&l.length){await o();const m=await ai.get("passphrase");if(!m)throw new Error("Passphrase is not found");await Promise.all(Object.keys(c||{}).map(async y=>{c!=null&&c[y]&&(d[y]=await gj(c[y],m))}))}let p;const f=[];u?(await le("FlowNodePlaceholder").update(u.source_id,{encrypted:d,data:s}),p=await le("FlowNodePlaceholder").findOne({where:{id:u.source_id}}),f.push({id:u.id,type:"replace",item:n})):(f.push({id:e,type:"remove"}),p=await le("FlowNodePlaceholder").save({placeholder_type:Xi.DEFAULT_EMBEDDING_MODEL,encrypted:d,data:s,session_id:t}),u=await le("FlowNode").save({node_type:ie.DefaultEmbeddingModel,session_id:t,source_type:"FlowNodePlaceholder",source_id:p.id,x:n.position.x,y:n.position.y}),f.push({type:"add",item:n})),n.data.entity=p,n.data.flowNode=u,a(f)}},[o,t,e,n,a]);return g.useEffect(()=>{e===wi.DEFAULT_EMBEDDING_MODEL&&r.find(s=>s.type===ie.DefaultEmbeddingModel&&s.id!==wi.DEFAULT_EMBEDDING_MODEL)&&a([{id:e,type:"remove"}])},[e,r,a]),{changeLLMOptions:i}},RRe=g.memo(e=>{var s,c,l,u;const{id:t,data:n,isConnectable:r}=e,{changeLLMOptions:a}=IRe(t);TRe(t);let o="brain",i=UG;switch(`${(c=(s=n==null?void 0:n.entity)==null?void 0:s.data)==null?void 0:c.provider}`){case Ve.OpenAI:o="gpt",i="text-embedding-3-small";break;case Ve.GoogleGenerativeAI:o="gemma",i="text-embedding-004";break}return h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsx("div",{children:h.jsxs(Er,{className:"flex justify-center max-w-auto",variant:"default",children:[h.jsx(Tr,{name:o,className:"w-7 h-7"}),h.jsxs("div",{className:"ml-2 pr-4 flex justify-center gap-1 flex-col",children:[h.jsx("div",{className:"min-h-8 flex items-center",children:h.jsx(Uo,{children:`${i||""}`})}),h.jsx(PRe,{supportedProviders:[Ve.OpenAI,Ve.GoogleGenerativeAI],onChangeOptions:a,encrypted:(l=n.entity)==null?void 0:l.encrypted,options:(u=n.entity)==null?void 0:u.data})]})]})}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),DRe=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
Use three sentences maximum and keep the answer as concise as possible.

{context}
`,LRe=po(e=>{const{source:t,documents:n}=e,r=tn(),{toast:a}=nn(),{t:o}=Me("dialogs"),{loading:i,createPrompt:s}=N7(),c=async l=>{try{if(!l.content||!l.content.includes("{context}")){a({title:o("create_vector_database_prompt.errors.fill_context"),variant:"destructive"});return}const u=l.content.replace("{context}",n.map(d=>`<document>${d.pageContent}</document>`).join(`
`));return await s(t,{...l,content:u}),r.hide(),!0}catch{a({title:o("create_vector_database_prompt.errors.create_failed"),variant:"destructive"})}};return h.jsx(hi,{open:r.visible,onOpenChange:r.hide,children:h.jsxs(xo,{className:"sm:max-w-[425px]",children:[h.jsx(_o,{children:h.jsxs("div",{className:"flex",children:[h.jsx(pe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(jo,{children:o("create_vector_database_prompt.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(HS,{onSubmit:c,loading:i,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:DRe}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(pe,{name:"info",className:"mr-2",size:14}),o("create_vector_database_prompt.fill_content_note")]})]})]})})}),$Re=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=Ie(i=>i.createOrUpdateFlowNode),a=Ie(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async({prompt:i,source:s,metadata:c})=>{var l,u,d,p;try{const f=(l=s==null?void 0:s.data)==null?void 0:l.entity;if(!f||!e)throw new Error("Source or Session not found");n(!0);const m=((u=s.position)==null?void 0:u.x)||0,y=(((d=s.position)==null?void 0:d.y)||0)+(((p=s.measured)==null?void 0:p.height)||0),v=await le("Prompt").save({...i,status:(i==null?void 0:i.status)||Kr.Started,role:(i==null?void 0:i.role)||hr.System,type:(i==null?void 0:i.type)||mr.Chat,content:(i==null?void 0:i.content)||"{context}",session_id:e});if(!v)throw new Error("Failed to save prompt");const b=await r({source_id:v.id,source_type:"Prompt",node_type:ie.Prompt,x:m,y:y+20});if(!b)throw new Error("Failed to save prompt node");const w=await le("FlowNodePlaceholder").save({placeholder:`Retriever for ${f.name}`,placeholder_type:Xi.VECTOR_DATABASE_RETREIVER,session_id:e,metadata:c});if(!w)throw new Error("Failed to save node placeholder");const _=await r({source_id:w.id,source_type:"FlowNodePlaceholder",node_type:ie.PlaceHolder,x:m,y:y+40});if(!_)throw new Error("Failed to save node placeholder node");await a({source:b.id,target:_.id}),await a({source:s.id,target:_.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabaseRetriever:o}},FRe=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}
`,BRe=po(e=>{const{source:t}=e,n=tn(),{toast:r}=nn(),{t:a}=Me("dialogs"),[o,i]=g.useState(1),[s,c]=g.useState(void 0),{loading:l,createVectorDatabaseRetriever:u}=$Re(),d=async m=>{try{const y=m.content;if(!y||!y.includes("{context}")){r({title:a("create_vector_database_retriever.errors.fill_context"),variant:"destructive"});return}return await u({source:t,prompt:{content:y},metadata:{k:o,minimalScore:s}}),i(1),c(void 0),n.hide(),!0}catch{r({title:a("create_vector_database_retriever.errors.create_failed"),variant:"destructive"})}},p=m=>{i(m.target.value?Number(m.target.value):void 0)},f=m=>{c(m.target.value?Number(m.target.value):void 0)};return h.jsx(hi,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(xo,{className:"sm:max-w-[425px]",children:[h.jsx(_o,{children:h.jsxs("div",{className:"flex",children:[h.jsx(pe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(jo,{children:a("create_vector_database_retriever.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(HS,{onSubmit:d,loading:l,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:FRe}),h.jsxs(Gt,{children:[h.jsx(Mn,{children:h.jsx(Fn,{children:a("create_vector_database_retriever.retriever_settings")})}),h.jsxs(An,{children:[h.jsx(Be,{children:a("create_vector_database_retriever.retriever_k")}),h.jsx(Kt,{value:o||"",type:"number",onChange:p,placeholder:a("create_vector_database_retriever.retriever_k_placeholder")}),h.jsx(Be,{children:a("create_vector_database_retriever.retriever_minimum_score")}),h.jsx(Kt,{value:s||"",type:"number",onChange:f,placeholder:a("create_vector_database_retriever.retriever_minimum_score_placeholder")})]})]}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(pe,{name:"info",className:"mr-2",size:14}),a("create_vector_database_retriever.fill_content_note")]})]})]})})}),zRe=e=>{const t=Ie(o=>o.createOrUpdateFlowEdge),{getFlowEmbeddingEntity:n}=Wy(),{index:r}=ap(),a=g.useCallback(async({edgeId:o,target:i,source:s})=>{var c,l;try{const u=(c=i==null?void 0:i.data)==null?void 0:c.entity;if((s==null?void 0:s.type)===ie.CSVData&&(i==null?void 0:i.type)===ie.VectorDatabase){const d=(l=s==null?void 0:s.data)==null?void 0:l.entity;if(!d||!u)return{deleteEdgeId:o};const{rows:p}=tX(d.headers,d.csv),f=p.map(m=>new bf({pageContent:`${m.text}`}));await r(n(),{database:{databaseId:u.id,dataSourceId:d.id,dataSourceType:"CSVData"}},f),await t({source:s.id,target:i.id});return}return{deleteEdgeId:o}}catch{return{deleteEdgeId:o}}},[t,n,r]);Hn(e,a)},URe=e=>{const[t,n]=g.useState(!1),{t:r}=Me("flows"),{toast:a}=nn(),{getNode:o,getHandleConnections:i}=tr(),s=Ie(f=>f.updateNodes),{getFlowEmbeddingEntity:c}=Wy(),{index:l,similaritySearchWithScore:u}=ap(),d=g.useCallback(async(f,m)=>{var y,v,b;try{const w=o(e);if(!w)return;const _=(y=w.data)==null?void 0:y.entity;if(!_){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}const x=c();if(_.storage===Wr.DataNode){const j=(b=(v=i({nodeId:e,type:"target"}).map(E=>o(E.source)).find(E=>(E==null?void 0:E.type)&&[ie.JSONLData,ie.CSVData].includes(E==null?void 0:E.type)))==null?void 0:v.data)==null?void 0:b.entity;if(!j){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}return n(!0),await u(x,{database:{databaseId:_.id,dataSourceId:j.id,dataSourceType:Zk(j)}},f,m==null?void 0:m.k)}else return n(!0),await u(x,{database:{databaseId:_.id}},f,m==null?void 0:m.k)}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[o,e,c,a,r,i,u]),p=g.useCallback(async(f,m)=>{var y,v,b,w;try{const _=o(e);if(!_)return;n(!0);const x=f.content?[new bf({pageContent:f.content,id:f.id,metadata:{id:f.id}})]:f.documents;if(!(x!=null&&x.length)){a({variant:"destructive",title:r("vector_database_node.errors.content_not_found")});return}const j=(y=_.data)==null?void 0:y.entity;if(!j||!_){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}const E=c();if(j.storage===Wr.DataNode){const S=i({nodeId:e,type:"target"}).map(A=>o(A.source)).find(A=>(A==null?void 0:A.type)&&[ie.JSONLData,ie.CSVData].includes(A==null?void 0:A.type)),O=(v=S==null?void 0:S.data)==null?void 0:v.entity;if(!O){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}const N=Zk(O),M=CS(x,10);let k=0;for(const A of M){if((b=m==null?void 0:m.onProgressReport)==null||b.call(m,{handling:A.length,handled:k,total:x.length}),await l(E,{database:{databaseId:j.id,dataSourceId:O.id,dataSourceType:N}},A),N&&S){const P=await le(N).findOne({where:{id:O.id}});s([{type:"replace",id:S.id,item:{...S,data:{...S.data,entity:P}}}])}k+=A.length}}else{const S=CS(x,10);let O=0;for(const N of S){(w=m==null?void 0:m.onProgressReport)==null||w.call(m,{handling:N.length,handled:O,total:x.length}),await l(E,{database:{databaseId:j.id}},N);const M=await le("VectorDatabase").findOne({where:{id:`${j.id}`}});s([{type:"replace",id:_.id,item:{..._,data:{..._.data,entity:M}}}]),O+=N.length}}}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[o,e,c,a,r,i,l,s]);return{loading:t,indexData:p,similaritySearchWithScore:d}},VRe=g.memo(e=>{var E,S,O,N;const{t}=Me("flows"),[n,r]=g.useState(0),[a,o]=g.useState("search"),i=Rn(e.id),{id:s,data:c,isConnectable:l}=e,{loading:u,similaritySearchWithScore:d,indexData:p}=URe(s),f=tn(LRe),m=tn(BRe);zRe(s);const y=g.useCallback(async(...M)=>{i&&await p(...M)},[p,i]),v=g.useCallback(async(M,k)=>{const A=M.trim(),P=await d(A,{k});if(P!=null&&P.length)return P},[d]),b=g.useCallback(M=>{f.show({source:i,documents:M.map(([k])=>k)})},[f,i]),w=g.useCallback(async()=>{m.show({source:i})},[m,i]),_=g.useCallback(async M=>{if(M.type.includes("text")||M.type.includes("txt")){const k=new FileReader;k.onload=async A=>{var C;const P=(C=A.target)==null?void 0:C.result;await y({content:P})},k.readAsText(M)}else if(M.type.endsWith("pdf")){const k=new Blob([M],{type:"application/pdf"}),A=await new B9(k,{pdfjs:async()=>{const P=await qt(()=>import("./pdf.min-l1GqQ9Q_.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([11,1,2,3,4]));return await qt(()=>import("./pdf.worker.min-BdOueeY8.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([12,1,2,3,4])),P.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),P},parsedItemSeparator:" "}).load();await y({documents:A},{onProgressReport:P=>{r((P.handled+P.handling)/P.total)}})}},[y]),x=g.useMemo(()=>{var A,P;if(!((A=c==null?void 0:c.entity)!=null&&A.raw))return{headers:[],rows:[]};const M=["content","embedding","metadata"],k=Tv((P=c==null?void 0:c.entity)==null?void 0:P.raw);return{headers:M,rows:k.map(C=>{try{return JSON.parse(C)}catch{return[]}})}},[(E=c==null?void 0:c.entity)==null?void 0:E.raw]),j=g.useMemo(()=>{switch(a){case"search":return h.jsx(_a,{value:"search",children:h.jsx(JB,{loading:u,onSimilaritySearch:v,onCreatePrompt:b,onCreateRetriever:w})});case"new":return h.jsx(_a,{className:"min-w-80",value:"new",children:h.jsx(YB,{loading:u,onCreateData:y})});case"file":return h.jsx(_a,{value:"file",children:h.jsx(QB,{loading:u,progress:n,onFileSubmit:_,fileOptions:{accept:".pdf,.txt,.text",maxSize:15}})});case"view":return h.jsx(_a,{value:"view",children:h.jsx($y,{data:x.rows,headers:x.headers,limitLengthByColumns:{embedding:32}})})}},[y,b,w,_,v,u,a,n,x]);return h.jsxs("div",{className:"min-w-72",children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:l}),h.jsxs("div",{className:"max-w-full",children:[h.jsx(zn,{id:s}),h.jsxs(Er,{className:"flex justify-center",variant:"default",children:[h.jsx(pe,{size:24,name:"database-zap"}),h.jsxs("div",{className:"ml-2 max-w-full",children:[h.jsx(Uo,{children:`${((S=c.entity)==null?void 0:S.name)||""}`}),h.jsxs(rS,{value:a,onValueChange:o,defaultValue:"search",className:Z("w-full mt-4"),children:[h.jsxs(Oy,{className:Z("grid w-full grid-cols-3",((O=c.entity)==null?void 0:O.storage)===Wr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(xa,{value:"search",children:t("vector_database_node.search")}),h.jsx(xa,{value:"new",children:t("vector_database_node.text")}),h.jsx(xa,{value:"file",children:t("vector_database_node.file")}),((N=c.entity)==null?void 0:N.storage)===Wr.DatabaseNode?h.jsx(xa,{value:"view",children:t("vector_database_node.view")}):void 0]}),j]})]})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:l})]})}),WRe={embedding:32},HRe=g.memo(e=>{var o,i,s;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{var u;if(!((u=n==null?void 0:n.entity)!=null&&u.jsonl))return{headers:[],rows:[]};const c=Gk(n.entity.headers||""),l=Tv(n.entity.jsonl);return{headers:c,rows:l.map(d=>{try{return JSON.parse(d)}catch{return[]}})}},[(o=n==null?void 0:n.entity)==null?void 0:o.jsonl,n.entity.headers]);return h.jsxs("div",{className:"min-w-80",children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(zn,{id:t}),h.jsxs(Gt,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Mn,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(pe,{name:"file-json",className:"mr-2"}),h.jsxs(Be,{className:"!font-medium leading-none tracking-tight pr-8",children:[ie.JSONLData," ",(i=a==null?void 0:a.rows)!=null&&i.length?`(${((s=a==null?void 0:a.rows)==null?void 0:s.length)||0})`:""]})]})}),h.jsx(An,{className:"pb-0",children:h.jsx($y,{data:a.rows,headers:a.headers,limitLengthByColumns:WRe})})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),GZ=60,XZ=140,qRe=uo("supports-backdrop-blur:bg-white/10 supports-backdrop-blur:dark:bg-black/10 mx-auto flex h-[58px] w-max gap-2 rounded-lg border p-2 backdrop-blur-md"),JZ=q.forwardRef(({className:e,children:t,magnification:n=GZ,distance:r=XZ,direction:a="bottom",...o},i)=>{const s=D0(1/0),c=()=>q.Children.map(t,l=>q.isValidElement(l)&&l.type===pf?q.cloneElement(l,{...l.props,mouseX:s,magnification:n,distance:r}):l);return h.jsx(mf.div,{ref:i,onMouseMove:l=>s.set(l.pageX),onMouseLeave:()=>s.set(1/0),...o,className:Z(qRe({className:e}),{"items-start":a==="top","items-center":a==="middle","items-end":a==="bottom"}),children:c()})});JZ.displayName="Dock";const pf=({magnification:e=GZ,distance:t=XZ,mouseX:n,className:r,children:a,...o})=>{const i=g.useRef(null),s=ZM(n||new m3e,u=>{var p;const d=((p=i.current)==null?void 0:p.getBoundingClientRect())??{x:0,width:0};return u-d.x-d.width/2}),c=ZM(s,[-t,0,t],[40,e,40]),l=xX(c,{mass:.1,stiffness:150,damping:12});return h.jsx(mf.div,{ref:i,style:{width:l},className:Z("flex aspect-square cursor-pointer items-center justify-center rounded-full",r),...o,children:a})};pf.displayName="DockIcon";let YZ,QZ,eG,tG,wv,nG,ff,rG,aG,oG,iG,sG,cG,lG,uG,dG,pG,fG,hG,mG,yG,gG,vG,bG,wG,xG,_G,jG;YZ=e=>g.createElement("svg",{viewBox:"0 0 256 254",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:256,height:254,preserveAspectRatio:"xMidYMid",...e},g.createElement("defs",null,g.createElement("linearGradient",{id:"c",x1:"50%",x2:"50%",y1:"0%",y2:"100%"},g.createElement("stop",{offset:"0%",stopColor:"#FFF"}),g.createElement("stop",{offset:"100%",stopColor:"#FFF",stopOpacity:0})),g.createElement("path",{id:"a",d:"M180.828 252.605a15.872 15.872 0 0 0 12.65-.486l52.501-25.262a15.94 15.94 0 0 0 9.025-14.364V41.197a15.939 15.939 0 0 0-9.025-14.363l-52.5-25.263a15.877 15.877 0 0 0-18.115 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.507 91.695a15.853 15.853 0 0 0 5.464 3.571Zm10.464-183.649-76.262 57.889 76.262 57.888V68.956Z"})),g.createElement("mask",{id:"b",fill:"#fff"},g.createElement("use",{xlinkHref:"#a"})),g.createElement("path",{fill:"#0065A9",d:"M246.135 26.873 193.593 1.575a15.885 15.885 0 0 0-18.123 3.08L3.466 161.482c-4.626 4.219-4.62 11.502.012 15.714l14.05 12.772a10.625 10.625 0 0 0 13.569.604L238.229 33.436c6.949-5.271 16.93-.315 16.93 8.407v-.61a15.938 15.938 0 0 0-9.024-14.36Z"}),g.createElement("path",{fill:"#007ACC",d:"m246.135 226.816-52.542 25.298a15.887 15.887 0 0 1-18.123-3.08L3.466 92.207c-4.626-4.218-4.62-11.502.012-15.713l14.05-12.773a10.625 10.625 0 0 1 13.569-.603l207.132 157.135c6.949 5.271 16.93.315 16.93-8.408v.611a15.939 15.939 0 0 1-9.024 14.36Z"}),g.createElement("path",{fill:"#1F9CF0",d:"M193.428 252.134a15.892 15.892 0 0 1-18.125-3.083c5.881 5.88 15.938 1.715 15.938-6.603V11.273c0-8.318-10.057-12.483-15.938-6.602a15.892 15.892 0 0 1 18.125-3.084l52.533 25.263a15.937 15.937 0 0 1 9.03 14.363V212.51c0 6.125-3.51 11.709-9.03 14.363l-52.533 25.262Z"}),g.createElement("path",{fill:"url(#c)",fillOpacity:.25,d:"M180.828 252.605a15.874 15.874 0 0 0 12.65-.486l52.5-25.263a15.938 15.938 0 0 0 9.026-14.363V41.197a15.939 15.939 0 0 0-9.025-14.363L193.477 1.57a15.877 15.877 0 0 0-18.114 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.506 91.695a15.857 15.857 0 0 0 5.465 3.571Zm10.464-183.65-76.262 57.89 76.262 57.888V68.956Z"})),QZ="/NoLLMChat/assets/plate-editor-C1jTW62C.png",eG={[ie.Shape]:{width:100,height:100},[ie.CircleShape]:{width:100,height:100},[ie.TriangleShape]:{width:100,height:100},[ie.EditorApp]:{width:1240,height:400}},tG=e=>{const t=Rn(e),n=Je(s=>s.currentSession),[r,a]=g.useState(!1),o=Ie(s=>s.createOrUpdateFlowNode),i=g.useCallback(async s=>{var c,l,u;try{if(a(!0),t&&(n==null?void 0:n.id)){const d=((c=t.position)==null?void 0:c.x)||0,p=(((l=t.position)==null?void 0:l.y)||0)+(((u=t.measured)==null?void 0:u.height)||0),f=await le("FlowNodeData").save({data:{},session_id:n.id});if(!f)throw new Error("Failed to save node data");if(!await o({node_type:s,data:{},source_id:f.id,source_type:"FlowNodeData",x:d,y:p+20,...eG[s]||{}}))throw new Error("Failed to save node")}}finally{a(!1)}},[o,n==null?void 0:n.id,t]);return{loading:r,createNode:i}},wv={applications:[{key:ie.EditorApp,image:QZ,label:"application_bar.editor"},{key:ie.VSLiteApp,icon:YZ,label:"application_bar.vslite"}],shapes:[{key:ie.Shape,icon:"square",label:"application_bar.square"},{key:ie.CircleShape,icon:"circle",label:"application_bar.circle"},{key:ie.TriangleShape,icon:"triangle",label:"application_bar.triangle"}],old:[{key:ie.CodeContainerApp,icon:"file-code-2",label:"application_bar.code_editor"}]},nG=g.memo(e=>{const{t}=Me("flows"),{toast:n}=nn(),{loading:r,createNode:a}=tG(e.id),o=async i=>{try{if(r)return;await a(i)}catch{n({description:t("application_bar.errors.add_node_failed"),variant:"destructive"})}};return h.jsx(Tu,{children:h.jsxs(JZ,{direction:"middle",children:[wv.applications.map(i=>{const s=i.icon;return h.jsx(pf,{children:h.jsxs(Fa,{children:[h.jsxs(Ba,{children:[s?h.jsx(s,{width:20,height:20,onClick:()=>o(i.key)}):void 0,i.image?h.jsx("img",{src:i.image,alt:t(i.label),className:"w-8 h-8 rounded-md",onClick:()=>o(i.key)}):void 0]}),h.jsx(Qr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)}),h.jsx(Gs,{orientation:"vertical",className:"h-full"}),wv.shapes.map(i=>h.jsx(pf,{children:h.jsxs(Fa,{children:[h.jsx(Ba,{children:h.jsx(pe,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Qr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)),h.jsx(Gs,{orientation:"vertical",className:"h-full"}),wv.old.map(i=>h.jsx(pf,{children:h.jsxs(Fa,{children:[h.jsx(Ba,{children:h.jsx(pe,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Qr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label))]})})}),ff=g.memo(e=>{const{lineClassName:t,handleClassName:n,...r}=e;return h.jsx(Rde,{lineClassName:Z("!border-1.5",t),handleClassName:Z("!w-2 !h-2 !border-2 !rounded-full",n),...r})}),rG=e=>{const t=Ie(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([ie.CircleShape,ie.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===ie.Shape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Hn(e,n)},aG=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return rG(t),h.jsxs(h.Fragment,{children:[h.jsx(ff,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border border",children:h.jsx(zn,{id:t})}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:r})]})}),oG=e=>{const t=Ie(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([ie.Shape,ie.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===ie.CircleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Hn(e,n)},iG=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return oG(t),h.jsxs(h.Fragment,{children:[h.jsx(ff,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border rounded-full border",children:h.jsx(zn,{id:t})}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:r})]})}),sG=e=>{const t=Ie(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([ie.CircleShape,ie.Shape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===ie.TriangleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Hn(e,n)},cG=g.memo(e=>{const{id:t,selected:n,width:r,height:a,isConnectable:o}=e;return sG(t),h.jsxs(h.Fragment,{children:[h.jsx(ff,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(dt,{type:"target",position:he.Top,isConnectable:o}),h.jsx("div",{className:"w-0 h-0 border-l-transparent border-r-transparent border-b-border",style:{borderLeftWidth:(r||0)/2,borderRightWidth:(r||0)/2,borderBottomWidth:a||0}}),h.jsx(zn,{id:t,className:"absolute top-0 right-0"}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:o})]})}),lG=e=>{const t=Ie(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ie.LLM&&(o==null?void 0:o.type)===ie.EditorApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Hn(e,n)},uG=e=>{const t=Rn(e),{t:n}=Me("flows"),r=g.useRef(null),{toast:a}=nn(),{getNode:o,getHandleConnections:i}=tr(),{stream:s}=nl(),c=g.useCallback(async d=>{t&&(clearTimeout(r.current),r.current=setTimeout(async()=>{await le("FlowNode").update(t.id,{data:d})},150))},[t]),l=g.useCallback(async(d,p)=>{var f;if(t){const m=i({nodeId:e,type:"target"}).find(b=>{var w;return((w=o(b.source))==null?void 0:w.type)===ie.LLM}),y=m?o(m==null?void 0:m.source):void 0,v=(f=y==null?void 0:y.data)==null?void 0:f.entity;if(!y||!v)return a({variant:"destructive",description:n("editor_node.errors.llm_not_found")});if(y.data.status!==et.Loaded)return a({variant:"destructive",description:n("editor_node.errors.llm_not_loaded_yet")});try{return(await s(v.provider,typeof d=="string"?[new Vr(d)]:d,{onMessageUpdate:b=>{p==null||p(b.content)},llm:v})).content}catch(b){if(b instanceof Error&&b.message.includes("LLM_NOT_LOADED_YET"))return a({title:n("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:n("editor_node.errors.stream_message_failed")})}}},[t,i,e,o,a,n,s]),u=g.useCallback(d=>{if(!o(d))return[];const p=[];return i({nodeId:d,type:"target"}).forEach(f=>{const m=o(f.source);!m||m.type!==ie.LLM||p.push({node:m,connections:[f]})}),p},[i,o]);return{createMessage:l,updateEditorContent:c,getLinkedConnections:u}},dG=g.lazy(()=>qt(()=>import("./index-Cy5cgpTB.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,7,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),pG=g.memo(e=>{var l;const{id:t,data:n,selected:r,isConnectable:a}=e;lG(t);const{createMessage:o,updateEditorContent:i,getLinkedConnections:s}=uG(t),c=g.useCallback(u=>{i(u)},[i]);return h.jsxs("div",{className:"w-full min-w-[1240px] h-full",children:[h.jsx(ff,{isVisible:!!r,minWidth:1240,minHeight:400}),h.jsx(dt,{type:"target",position:he.Top,isConnectable:a}),h.jsxs("div",{className:"min-w-10 min-h-10 w-full h-full rounded-lg border bg-background",children:[h.jsx(zn,{className:"!z-[100]",id:t,enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(pe,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx("div",{className:"h-full w-ful rounded-lg","data-registry":"plate",children:h.jsx(dG,{defaultValue:(l=n==null?void 0:n.flowNode)==null?void 0:l.data,onValueChange:c,copilotStream:o})})})]}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:a})]})}),fG=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);Hn(e,t)},hG=g.memo(e=>{var i,s;const{id:t,data:n,isConnectable:r}=e,{t:a}=Me("flows");fG(t);let o="";switch((i=n.entity)==null?void 0:i.placeholder_type){case"VECTOR_DATABASE_RETREIVER":o=a("placeholder_node.vector_database_retriever");break}return h.jsxs("div",{children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs(Er,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(zn,{id:t}),h.jsx(pe,{name:"land-plot",className:"w-7 h-7"}),h.jsxs("div",{className:"ml-2 pr-4",children:[h.jsx(Uo,{children:`${((s=n.entity)==null?void 0:s.placeholder)||""}`}),h.jsx(cl,{children:o?h.jsx(wn,{children:o}):void 0})]})]}),h.jsx(dt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),mG=g.lazy(()=>qt(()=>import("./CodeContainerApp-C8e8kkPq.js").then(async e=>(await e.__tla,e)).then(e=>e.C),__vite__mapDeps([62,1,2,14,60,6]))),yG=g.memo(e=>{const{id:t,isConnectable:n}=e;return h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(zn,{id:t}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(pe,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(mG,{...e})})]}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:n})]})}),gG=["empty-source","vite-vue","shadcn-react-vite","todo-app-react-vite","porfolio-nextjs"],vG=async e=>{switch(e){case"empty-source":return qt(()=>import("./empty-source-Dw1dvL8s.js"),[]).then(t=>t.BASE);case"vite-vue":return qt(()=>import("./vite-vue-Bmz2z3Fo.js"),[]).then(t=>t.BASE);case"shadcn-react-vite":return qt(()=>import("./shadcn-react-vite-CDJ9BaE9.js"),[]).then(t=>t.BASE);case"todo-app-react-vite":return qt(()=>import("./todo-app-react-vite-BBWBkRjR.js"),[]).then(t=>t.BASE);case"porfolio-nextjs":return qt(()=>import("./porfolio-nextjs-DCkli5iW.js"),[]).then(t=>t.BASE);default:throw new Error(`Unknown source base: ${e}`)}},AM=g.memo(({className:e,onUpdateSourceBase:t})=>{const{t:n}=Me("components"),[r,a]=g.useState();return h.jsxs(Gt,{className:Z("mw-full",e),children:[h.jsx(Mn,{className:"p-4",children:h.jsx(Fn,{children:n("add_source_base.title")})}),h.jsx(An,{className:"p-4",children:h.jsxs("div",{className:"flex items-center justify-center w-full h-full flex-col",children:[h.jsxs(Qa,{onValueChange:o=>a(o),children:[h.jsx(Ea,{className:"w-full mb-4",children:h.jsx(eo,{placeholder:n("add_source_base.source_base_select_placeholder")})}),h.jsx(Sa,{children:gG.map(o=>h.jsx(Bn,{value:`${o}`,children:n(`add_source_base.sourcebases.${o.toLowerCase()}`)},`${o}`))})]}),h.jsx(Ye,{className:"w-full",onClick:async()=>r&&t(await vG(r)),children:n("add_source_base.update_source")})]})})]})}),bG=()=>{const{getNode:e,getHandleConnections:t}=tr(),{stream:n}=nl(),r=g.useCallback(async(o,i)=>{await le("FlowNode").update(o,{raw:j0(i)})},[]),a=g.useCallback(o=>{if(!e(o))return[];const i=[];return t({nodeId:o,type:"target"}).forEach(s=>{const c=e(s.source);!c||c.type!==ie.LLM||i.push({node:c,connections:[s]})}),i},[t,e]);return{sendMessage:g.useCallback(async(o,i,{onMessageUpdate:s,onResponseMessageCreate:c}={})=>{const l=i.map(d=>d.role==="system"?new Pv(d.content):d.role==="user"?new Vr(d.content):new Ta(d.content));c==null||c();const{content:u}=await n(Ve.WebLLM,[...l,new Vr(o)],{onMessageUpdate:({content:d})=>{s==null||s({nodeData:{loading:!0,content:d}})},llm:void 0});return s==null||s({nodeData:{loading:!1,content:u}}),u},[n]),getLinkedConnections:a,updateCodeContainerData:r}},wG=e=>{const t=Ie(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ie.LLM&&(o==null?void 0:o.type)===ie.VSLiteApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Hn(e,n)},xG=g.lazy(()=>qt(()=>import("./index-C8I42w52.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),_G=g.memo(e=>{var p,f,m,y;const{id:t,isConnectable:n,data:r}=e,[a,o]=g.useState((p=r==null?void 0:r.flowNode)!=null&&p.raw?C0(r.flowNode.raw):void 0),{updateCodeContainerData:i,getLinkedConnections:s,sendMessage:c}=bG();wG(t);const l=g.useCallback(async v=>{var b,w;(b=r==null?void 0:r.flowNode)!=null&&b.id&&(await i((w=r==null?void 0:r.flowNode)==null?void 0:w.id,v),o(v))},[(f=r==null?void 0:r.flowNode)==null?void 0:f.id,i]),u=g.useCallback(async(v,b)=>{var w;return(w=r==null?void 0:r.flowNode)!=null&&w.id?await c(v,b):void 0},[(m=r==null?void 0:r.flowNode)==null?void 0:m.id,c]),d=g.useCallback(async v=>{o(b=>{var _;const w=N0(b||{},v);return i((_=r==null?void 0:r.flowNode)==null?void 0:_.id,w),w})},[(y=r==null?void 0:r.flowNode)==null?void 0:y.id,i]);return a?h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(dt,{type:"target",position:he.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(zn,{id:t,className:"z-50",enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(pe,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(xG,{fileSystemTree:a,onUpdateFileContent:d,sendMessage:u})})]}),h.jsx(dt,{type:"source",position:he.Bottom,isConnectable:n})]}):h.jsx("div",{className:"h-full flex justify-center items-center",children:h.jsx(AM,{className:"w-64",onUpdateSourceBase:l})})}),jG={[ie.LLM]:U7,[ie.Toolbox]:R7,[ie.Thread]:K7,[ie.Message]:X1e,[ie.Prompt]:Y1e,[ie.SessionInfo]:ORe,[ie.Schema]:NRe,[ie.CSVData]:kRe,[ie.ToolDefinition]:ARe,[ie.DefaultEmbeddingModel]:RRe,[ie.VectorDatabase]:VRe,[ie.JSONLData]:HRe,[ie.ApplicationBar]:nG,[ie.Shape]:aG,[ie.CircleShape]:iG,[ie.TriangleShape]:cG,[ie.EditorApp]:pG,[ie.PlaceHolder]:hG,[ie.CodeContainerApp]:yG,[ie.VSLiteApp]:_G};function KRe(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:p,children:f,...m}=d,y=(p==null?void 0:p[e][c])||s,v=g.useMemo(()=>m,Object.values(m));return h.jsx(y.Provider,{value:v,children:f})}function u(d,p){const f=(p==null?void 0:p[e][c])||s,m=g.useContext(f);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,ZRe(a,...t)]}function ZRe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var GRe="Toggle",Ik=g.forwardRef((e,t)=>{const{pressed:n,defaultPressed:r=!1,onPressedChange:a,...o}=e,[i=!1,s]=In({prop:n,onChange:a,defaultProp:r});return h.jsx(Pe.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":e.disabled?"":void 0,...o,ref:t,onClick:ge(e.onClick,()=>{e.disabled||s(!i)})})});Ik.displayName=GRe;let Rk,Us,Dk,Lk,xv;Rk=Ik,Us="ToggleGroup",[Dk,aX]=KRe(Us,[fo]),Lk=fo(),xv=q.forwardRef((e,t)=>{const{type:n,...r}=e;if(n==="single"){const a=r;return h.jsx(XRe,{...a,ref:t})}if(n==="multiple"){const a=r;return h.jsx(JRe,{...a,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${Us}\``)}),xv.displayName=Us;var[EG,SG]=Dk(Us),XRe=q.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i,s]=In({prop:n,defaultProp:r,onChange:a});return h.jsx(EG,{scope:e.__scopeToggleGroup,type:"single",value:i?[i]:[],onItemActivate:s,onItemDeactivate:q.useCallback(()=>s(""),[s]),children:h.jsx(OG,{...o,ref:t})})}),JRe=q.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=In({prop:n,defaultProp:r,onChange:a}),c=q.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=q.useCallback(u=>s((d=[])=>d.filter(p=>p!==u)),[s]);return h.jsx(EG,{scope:e.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:c,onItemDeactivate:l,children:h.jsx(OG,{...o,ref:t})})});xv.displayName=Us;var[YRe,QRe]=Dk(Us),OG=q.forwardRef((e,t)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:a=!0,orientation:o,dir:i,loop:s=!0,...c}=e,l=Lk(n),u=oi(i),d={role:"group",dir:u,...c};return h.jsx(YRe,{scope:n,rovingFocus:a,disabled:r,children:a?h.jsx(uu,{asChild:!0,...l,orientation:o,dir:u,loop:s,children:h.jsx(Pe.div,{...d,ref:t})}):h.jsx(Pe.div,{...d,ref:t})})}),_v="ToggleGroupItem",CG=q.forwardRef((e,t)=>{const n=SG(_v,e.__scopeToggleGroup),r=QRe(_v,e.__scopeToggleGroup),a=Lk(e.__scopeToggleGroup),o=n.value.includes(e.value),i=r.disabled||e.disabled,s={...e,pressed:o,disabled:i},c=q.useRef(null);return r.rovingFocus?h.jsx(du,{asChild:!0,...a,focusable:!i,active:o,ref:c,children:h.jsx($k,{...s,ref:t})}):h.jsx($k,{...s,ref:t})});CG.displayName=_v;let $k;$k=q.forwardRef((e,t)=>{const{__scopeToggleGroup:n,value:r,...a}=e,o=SG(_v,n),i={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},s=o.type==="single"?i:void 0;return h.jsx(Ik,{...s,...a,ref:t,onPressedChange:c=>{c?o.onItemActivate(r):o.onItemDeactivate(r)}})}),Wv=xv,Hv=CG;const NG=uo("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),eDe=g.forwardRef(({className:e,variant:t,size:n,...r},a)=>h.jsx(Rk,{ref:a,className:Z(NG({variant:t,size:n,className:e})),...r}));eDe.displayName=Rk.displayName;const kG=g.createContext({size:"default",variant:"default"}),MG=g.forwardRef(({className:e,variant:t,size:n,children:r,...a},o)=>h.jsx(Wv,{ref:o,className:Z("flex items-center justify-center gap-1",e),...a,children:h.jsx(kG.Provider,{value:{variant:t,size:n},children:r})}));MG.displayName=Wv.displayName;const AG=g.forwardRef(({className:e,children:t,variant:n,size:r,...a},o)=>{const i=g.useContext(kG);return h.jsx(Hv,{ref:o,className:Z(NG({variant:i.variant||n,size:i.size||r}),e),...a,children:t})});AG.displayName=Hv.displayName;function tDe(){const e=tt(t=>`x: ${t.transform[0].toFixed(2)}, y: ${t.transform[1].toFixed(2)}, zoom: ${t.transform[2].toFixed(2)}`);return h.jsx("div",{children:e})}function nDe({change:e}){var r,a,o,i;const t="id"in e?e.id:"-",{type:n}=e;return h.jsxs("div",{className:"mb-3",children:[h.jsxs("div",{children:["node id: ",t]}),h.jsxs("div",{children:[n==="add"?JSON.stringify(e.item,null,2):null,n==="dimensions"?`dimensions: ${(r=e.dimensions)==null?void 0:r.width} \xD7 ${(a=e.dimensions)==null?void 0:a.height}`:null,n==="position"?`position: ${(o=e.position)==null?void 0:o.x.toFixed(1)}, ${(i=e.position)==null?void 0:i.y.toFixed(1)}`:null,n==="remove"?"remove":null,n==="select"?e.selected?"select":"unselect":null]})]})}function rDe({limit:e=20}){const[t,n]=g.useState([]),r=Lt(),a=g.useCallback(i=>{n(s=>[...i,...s].slice(0,e))},[e]);g.useEffect(()=>(r.setState({onNodesChange:a}),()=>r.setState({onNodesChange:void 0})),[a,r]);const o=()=>h.jsx("div",{children:"No Changes Triggered"});return h.jsx(h.Fragment,{children:t.length===0?h.jsx(o,{}):t.map((i,s)=>h.jsx(nDe,{change:i},s))})}function aDe(){const{getInternalNode:e}=tr(),t=NL();return h.jsx(cde,{children:h.jsx("div",{className:"text-secondary-foreground",children:t.map(n=>{var o,i;const r=e(n.id);if(!r)return null;const a=r==null?void 0:r.internals.positionAbsolute;return h.jsx(oDe,{id:n.id,selected:!!n.selected,type:n.type||"default",position:n.position,absPosition:a,width:((o=n.measured)==null?void 0:o.width)??0,height:((i=n.measured)==null?void 0:i.height)??0,data:n.data},n.id)})})})}function oDe({id:e,type:t,selected:n,position:r,absPosition:a,width:o,height:i,data:s}){if(!o||!i)return null;const c=`translate(${a.x}px, ${a.y+i}px)`,l=`${r.x.toFixed(1)}, ${r.y.toFixed(1)}`,u=`${o} \xD7 ${i}`,d=n?"Selected":"Not Selected";return h.jsxs("div",{style:{position:"absolute",transform:c,width:o*2},className:"text-xs",children:[h.jsxs("div",{children:["id: ",e]}),h.jsxs("div",{children:["type: ",t]}),h.jsxs("div",{children:["selected: ",d]}),h.jsxs("div",{children:["position: ",l]}),h.jsxs("div",{children:["dimensions: ",u]}),h.jsxs("div",{children:["data: ",JSON.stringify(s,null,2)]})]})}function iDe({tools:e}){return h.jsx(Mc,{position:"top-left",className:"bg-card p-1 border rounded shadow-sm",children:h.jsx(MG,{type:"multiple",children:e.map(({active:t,setActive:n,label:r,value:a})=>h.jsx(AG,{value:a,onClick:()=>n(o=>!o),"aria-pressed":t,className:"bg-card text-card-foreground transition-colors duration-300 hover:bg-secondary hover:text-secondary-foreground",children:r},a))})})}function PG(){const[e,t]=g.useState(!1),[n,r]=g.useState(!1),[a,o]=g.useState(!1),i=[{active:e,setActive:t,label:"Node Inspector",value:"node-inspector"},{active:n,setActive:r,label:"Change Logger",value:"change-logger"},{active:a,setActive:o,label:"Viewport Logger",value:"viewport-logger"}];return h.jsxs(h.Fragment,{children:[h.jsx(iDe,{tools:i}),n&&h.jsx(Mc,{className:"text-xs p-5 bg-white rounded shadow-md overflow-y-auto max-h-[50%] mt-20",position:"bottom-right",children:h.jsx(rDe,{})}),e&&h.jsx(aDe,{}),a&&h.jsx(Mc,{position:"bottom-left",className:"text-secondary-foreground",children:h.jsx(tDe,{})})]})}PG.displayName="DevTools";const sDe=()=>{const e=g.useRef({}),t=g.useRef({}),n=Ie(N=>N.flowEdges),r=Je(N=>N.currentSession),a=Ie(N=>N.setNodes),o=Ie(N=>N.updateNodes),i=Ie(N=>N.updateEdges),s=Ie(N=>N.addConnectionToEdges),c=Ie(N=>N.reset),l=Ie(N=>N.findFlowEdges),u=Ie(N=>N.deleteFlowNode),d=Ie(N=>N.deleteFlowEdge),p=Ie(N=>N.updateFlowNode),f=Ie(N=>N.getNodes),m=Ie(N=>N.findFlowNodesWithSource),y=g.useRef(n),v=g.useRef(),[b,w]=g.useState({loading:!1});y.current=n;const _=g.useCallback(async(N,M)=>{try{v.current=N,c(),await(M==null?void 0:M())}catch{v.current=void 0}},[c]),x=g.useCallback(async N=>{try{if(!(r!=null&&r.id))return;w(A=>({...A,loading:!0}));const M=await m({...N,where:{...N.where,session_id:r.id}}),k=await l({where:[{source:Ka(M.map(A=>A.id))},{target:Ka(M.map(A=>A.id))}]});return{flowNodes:M,flowEdges:k}}finally{w(M=>({...M,loading:!1}))}},[m,l,r==null?void 0:r.id]),j=g.useCallback(async N=>{var M,k;for(const A of N)if("id"in A&&Object.values(wi).includes(A.id)&&A.type!=="remove")o([A]);else if(A.type==="position"&&A.position&&!isNaN(A.position.x)&&!isNaN(A.position.y)){o([A]);const P=A.position.x,C=A.position.y;clearTimeout(e.current[A.id]),e.current[A.id]=setTimeout(async()=>{e.current[A.id]=void 0,await p({id:A.id,x:P,y:C},{silent:!0})},200)}else if(A.type==="remove"){const P=(M=f([A.id]))==null?void 0:M[0];if(!(P!=null&&P.type)||Tpe.includes(P.type))return;await u({id:A.id})}else if(A.type==="dimensions"&&A.dimensions&&!isNaN(A.dimensions.width)&&!isNaN(A.dimensions.height)){const P=(k=f([A.id]))==null?void 0:k[0];if(!(P!=null&&P.width)&&!(P!=null&&P.height))return;o([A]),clearTimeout(t.current[A.id]);const C=A.dimensions.width,T=A.dimensions.height;t.current[A.id]=setTimeout(async()=>{await p({id:A.id,width:C,height:T},{silent:!0})},200)}else A.type==="select"&&o([A])},[o,p,f,u]),E=g.useCallback(N=>{Promise.all(N.map(async M=>{if(M.type==="remove")return d({id:M.id})})),i(N)},[d,i]),S=g.useCallback(N=>{s(N)},[s]),O=g.useCallback(N=>{a(M=>{var C,T;let k;if(typeof N=="function"?k=N(M):k=N,!k)return M;const A=M==null?void 0:M.find(I=>I.id===k.id),P={id:k.id,item:A?_m(A,k):{...k,position:{x:((C=k.position)==null?void 0:C.x)||0,y:((T=k.position)==null?void 0:T.y)||0}},type:A?"replace":"add"};return ps([P],M)})},[a]);return{initialFlow:_,loadingState:b,prepareFlowInfo:x,updateNodeChanges:j,updateEdgeChanges:E,updateOrCreateNode:O,currentSessionIdRef:v,updateEdgeConnection:S}},cDe=e=>{const t=Je(l=>{var u;return(u=l.currentSession)==null?void 0:u.id}),{loadingState:n,prepareFlowInfo:r,initialFlow:a,currentSessionIdRef:o}=e,i=Ie(l=>l.ready),s=Ie(l=>l.removeSyncNodeQueue),c=Ie(l=>l.removeSyncEdgeQueue);g.useLayoutEffect(()=>{},[t]),g.useEffect(()=>{n.loading||!i||!t||o.current===t||a(t,async()=>{await r({where:{session_id:t}})})},[a,r,n.loading,o,i,t]),g.useEffect(()=>{const l=Ie.subscribe(d=>d.syncNodeQueue,async(d,p)=>{const f=p.map(y=>y.timestamp),m=d.filter(y=>!f.includes(y.timestamp));m.length&&s(m.map(y=>y.timestamp))}),u=Ie.subscribe(d=>d.syncEdgeQueue,async(d,p)=>{const f=p.map(y=>y.timestamp),m=d.filter(y=>!f.includes(y.timestamp));m.length&&c(m.map(y=>y.timestamp))});return()=>{l(),u()}},[r,c,s])},lDe=()=>{const[e,t]=g.useState(!0),n=sDe(),r=lo(u=>u.selectedModel),a=g.useRef(r),o=lo(u=>u.setInitProgressCallback),{updateOrCreateNode:i,updateNodeChanges:s,updateEdgeChanges:c,updateEdgeConnection:l}=n;return cDe(n),a.current=r,g.useEffect(()=>{const u=o==null?void 0:o(d=>{if(!a.current)return;const p=`${a.current}`;i(f=>{const m=f==null?void 0:f.find(y=>{var v;return(v=y.data)!=null&&v.entity&&typeof y.data.entity=="object"&&"name"in y.data.entity?y.data.entity.name===p:!1});if(m)return m.data.label=d.text,m.data.status=et.Loading,d.progress===100&&(m.data.label="",m.data.status=et.Loaded),m})});return()=>{u==null||u()}},[o,i]),g.useMemo(()=>({updateNodeChanges:s,updateEdgeChanges:c,initializing:e,setInitializing:t,updateEdgeConnection:l}),[s,c,e,t,l])},uDe=()=>{const e=eu(l=>l.theme),t=Ie(l=>l.nodes),n=Ie(l=>l.edges),{updateNodeChanges:r,updateEdgeChanges:a,updateEdgeConnection:o}=lDe(),i=g.useCallback(l=>{r(l)},[r]),s=g.useCallback(l=>{a(l)},[a]),c=g.useCallback(l=>{o(l)},[o]);return h.jsxs(ide,{nodes:t,edges:n,nodeTypes:jG,onNodesChange:i,onEdgesChange:s,onConnect:c,panOnScroll:!0,panOnScrollMode:yi.Free,colorMode:e,fitView:!0,children:[h.jsx(hde,{variant:Lo.Dots,gap:24,size:1}),h.jsx(xde,{}),h.jsx(Tde,{}),y3e?h.jsx(PG,{}):void 0]})},dDe=g.memo(uDe);function pDe(){return h.jsx(dDe,{})}const fDe=g.lazy(()=>qt(()=>import("./DocumentViewer-C4YKHCkB.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([63,1,2,15]))),hDe=()=>{const{documentId:e}=Ff();return h.jsx(g.Suspense,{fallback:h.jsx(ru,{flickeringGrid:!0,className:"w-full h-full"}),children:h.jsx(fDe,{name:e||""})})};function jv(){const e=AA();return Hs(e),h.jsx(g3e,{})}const mDe=zJ(h.jsxs(li,{errorElement:h.jsx(jv,{}),children:[h.jsxs(li,{element:h.jsx(yI,{requiredSession:!0}),children:[h.jsx(li,{path:hh.whiteboard,Component:pDe,errorElement:h.jsx(jv,{})}),h.jsx(li,{path:hh.application,errorElement:h.jsx(jv,{}),Component:vxe}),h.jsx(li,{path:"*",element:h.jsx($J,{to:dn("whiteboard")})})]}),h.jsx(li,{element:h.jsx(yI,{}),children:h.jsx(li,{path:hh.document,errorElement:h.jsx(jv,{}),Component:hDe})})]})),yDe=(e,t)=>{switch(Uee){case"browser":return BA(e,t);case"hash":return dY(e);default:return BA(e,t)}},gDe=yDe(mDe,{basename:"/NoLLMChat/"});QG("[BASE_URL]","/NoLLMChat/");let TG;TG=g.memo(()=>{const e=!window.location.pathname.includes("/NoLLMChat/");return g.useLayoutEffect(()=>{e&&(window.location.href="/NoLLMChat/".replace("//","/"))},[e]),e?h.jsx(ru,{className:"w-screen h-screen",simple:!0}):h.jsx(_Y,{router:gDe})},()=>!0),lX=Object.freeze(Object.defineProperty({__proto__:null,default:TG},Symbol.toStringTag,{value:"Module"}))});export{ou as $,Xk as A,Iv as B,Jk as C,Yk as D,iu as E,Rv as F,su as G,Ki as H,wf as I,xf as J,Dv as K,Qk as L,eM as M,qs as N,tM as O,nM as P,rM as Q,aM as R,Lv as S,oM as T,iM as U,sM as V,cM as W,lM as X,uM as Y,$v as Z,Rt as _,w3e as __tla,Fv as a,Bv as a$,cu as a0,Zi as a1,Gi as a2,_f as a3,lu as a4,Ks as a5,Zs as a6,dM as a7,zv as a8,pM as a9,fM as aA,rX as aB,Uv as aC,hM as aD,Vv as aE,mM as aF,fo as aG,aX as aH,oi as aI,uu as aJ,du as aK,Wv as aL,Hv as aM,qv as aN,Kv as aO,Zv as aP,Gv as aQ,Xv as aR,Jv as aS,yM as aT,gM as aU,jf as aV,Yv as aW,Qv as aX,e0 as aY,t0 as aZ,n0 as a_,vM as aa,oX as ab,r0 as ac,iX as ad,bM as ae,wM as af,xM as ag,a0 as ah,_M as ai,sX as aj,o0 as ak,i0 as al,s0 as am,jM as an,c0 as ao,l0 as ap,u0 as aq,d0 as ar,p0 as as,f0 as at,EM as au,SM as av,cX as aw,h0 as ax,OM as ay,CM as az,pu as b,m0 as b0,y0 as b1,g0 as b2,Ef as b3,On as b4,v0 as b5,Sf as b6,b0 as b7,w0 as b8,fu as b9,lX as bA,hu as ba,x0 as bb,Of as bc,Be as bd,Gs as be,mu as bf,_0 as bg,Qn as bh,Ie as bi,Hn as bj,Rn as bk,j0 as bl,E0 as bm,NM as bn,kM as bo,S0 as bp,O0 as bq,Ye as br,MM as bs,C0 as bt,N0 as bu,AM as bv,PM as bw,TM as bx,Xs as by,ii as bz,IM as c,Hr as d,k0 as e,RM as f,DM as g,Js as h,qr as i,M0 as j,A0 as k,LM as l,Ia as m,$M as n,P0 as o,T0 as p,FM as q,BM as r,zM as s,I0 as t,qn as u,yu as v,R0 as w,gu as x,Ys as y,UM as z};
