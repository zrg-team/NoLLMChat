const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/few_shot-BQNhP7Zr.js","assets/index-CWwRKoNd.js","assets/index-DbmpG02v.css","assets/dot-B5uZdBUi.js","assets/createLucideIcon-CE1R4NpC.js","assets/index-xilbYyvr.js","assets/objectWithoutPropertiesLoose-BjXSgPXB.js","assets/index-DKUwdraP.js","assets/index-Cr8Tc6mT.css","assets/index-D2o0-Nmt.js","assets/pdf-DlLEmhiY.js","assets/pdf.min-T3SIQZZM.js","assets/pdf.worker.min-CB1tp3fD.js","assets/index-BnMUIC5-.js","assets/use-prevent-pitch-zoom-CjlNeCIW.js","assets/index-CECUnfrR.js","assets/link-DRNgG66W.js","assets/trash-2-cEAAALf_.js","assets/text-BS_1beb5.js","assets/external-link-DFCCiN55.js","assets/unlink-JSyhEuG8.js","assets/index-DMs_wcns.js","assets/list-CXkumdX7.js","assets/list-ordered-Bo-Z0y19.js","assets/list-todo-EvPHPjwV.js","assets/indent-increase-CpQ-KZ4I.js","assets/pilcrow-c0N8yXSI.js","assets/heading-1-D7hvxk2X.js","assets/heading-2-Ck4hJZir.js","assets/heading-3-CTeYH-GR.js","assets/table-Bd6YB-M_.js","assets/file-code-dZl_zn03.js","assets/quote-D91x--lO.js","assets/minus-CRT6FnB7.js","assets/square-D7eJGaic.js","assets/chevron-right-0qKH4wAn.js","assets/image-ChNHJySY.js","assets/table-of-contents-D7tUKZKA.js","assets/columns-3-CqYAp1Os.js","assets/link-2-ZoldvNrA.js","assets/calendar-Bqz9bfnr.js","assets/plus-OKn05WHt.js","assets/wrap-text-7NJvvlTH.js","assets/pen-16S3Y4I_.js","assets/eye-DQTf3Y7b.js","assets/indent-decrease-va9HYOek.js","assets/pointer-CUVQgjqi.js","assets/wand-sparkles-BmGwh-vC.js","assets/bold-BPbGsiF_.js","assets/italic-WZY_ZhDB.js","assets/underline-BWMH9qiC.js","assets/strikethrough-DtxafwQm.js","assets/code-xml-IgWlPA0K.js","assets/baseline-REYrUAdd.js","assets/paint-bucket-Ch1h6fCL.js","assets/arrow-up-to-line-Df_TLN-O.js","assets/index-BCYu3EnN.css","assets/index-DIi5WtnO.js","assets/check-B49iI1Bp.js","assets/circle-DXRwpEYi.js","assets/index-DldhddYT.js","assets/index-HSnfLTSA.css","assets/CodeContainerApp-DvxCEJM4.js","assets/DocumentViewer-DJlSnUKu.js"])))=>i.map(i=>d[i]);
import{r as g,M as oM,j as h,u as Yg,P as DTe,a as iM,L as LTe,m as $Te,c as FTe,f as jK,i as BTe,b as sM,d as SK,e as zTe,g as VTe,_ as EK,h as OK,k as zl,l as ev,n as Qa,o as Ko,p as Vl,q as on,R as qTe,s as ir,t as Nn,v as Ae,w as ge,x as Ir,y as xt,z as K,A as Ja,S as Xo,B as sr,D as tv,C as UTe,E as nv,F as fe,G as CK,H as WTe,I as Pe,J as Kf,K as Ye,N as Ps,O as Ya,Q as Jt,T as Yt,U as de,V as ks,W as Xf,X as NK,Y as HTe,Z as ZTe,$ as MK,a0 as ql,a1 as vn,a2 as ot,a3 as PK,a4 as W,a5 as Ul,a6 as KTe,a7 as XTe,a8 as bn,a9 as oe,aa as GTe,ab as Ti,ac as Gf,ad as Qf,ae as Ut,af as Dr,ag as QTe,ah as JTe,ai as YTe,aj as eRe,ak as Jf,al as kK,am as tRe,an as nRe,ao as AK,ap as cM,aq as rRe,ar as aRe,as as TK,at as lM,au as oRe,av as uM,aw as iRe,ax as As,ay as sRe,az as cRe,aA as lRe,aB as _a,aC as RK,aD as uRe,aE as rv,aF as le,aG as Go,aH as Yf,aI as eo,aJ as dM,aK as IK,aL as fM,aM as dRe,aN as fRe,aO as DK,aP as Ts,aQ as av,aR as ep,aS as pRe,aT as Lr,aU as ov,aV as pM,aW as Wl,aX as LK,aY as hRe,aZ as mRe,a_ as yRe,a$ as gRe,b0 as vRe,b1 as Hl,b2 as bRe,b3 as wRe,b4 as $K,b5 as xRe,b6 as _Re,b7 as jRe,b8 as SRe,b9 as FK,ba as hM,bb as _t,bc as ERe,bd as mM,be as ORe,bf as CRe,bg as NRe,__tla as MRe}from"./index-CWwRKoNd.js";import BK,{__tla as PRe}from"./dot-B5uZdBUi.js";let Zl,yM,iv,gM,vM,Kl,sv,Xl,Ri,tp,np,cv,bM,wM,Rs,xM,_M,jM,SM,lv,EM,OM,CM,NM,MM,PM,uv,Tt,dv,fv,Gl,Ii,Di,rp,Ql,Is,Ds,kM,pv,AM,TM,zK,hv,RM,mv,IM,to,VK,Qo,Jl,Yl,yv,gv,vv,bv,wv,xv,_v,jv,DM,LM,ap,Sv,Ev,Ov,Cv,Nv,$M,qK,Mv,UK,FM,BM,zM,Pv,VM,WK,kv,Av,Tv,qM,Rv,Iv,Dv,Lv,$v,Fv,UM,WM,HK,Bv,HM,ZM,eu,zv,Vv,qv,op,wn,Uv,ip,Wv,Hv,tu,ZK,nu,KK,KM,nt,Ls,Zv,Kv,Zn,De,Ln,$n,Xv,Gv,XM,GM,Qv,Jv,ut,QM,Yv,e0,JM,YM,eP,$s,Jo,tP,$r,t0,nP,rP,Fs,Fr,n0,r0,aP,ja,oP,a0,o0,iP,sP,cP,i0,Fn,ru,s0,au,Bs,lP,kRe=Promise.all([(()=>{try{return MRe}catch{}})(),(()=>{try{return PRe}catch{}})()]).then(async()=>{class QK extends g.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function JK({children:e,isPresent:t}){const n=g.useId(),r=g.useRef(null),a=g.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=g.useContext(oM);return g.useInsertionEffect(()=>{const{width:i,height:s,top:c,left:l}=a.current;if(t||!r.current||!i||!s)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return o&&(u.nonce=o),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${c}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),h.jsx(QK,{isPresent:t,childRef:r,sizeRef:a,children:g.cloneElement(e,{ref:r})})}const YK=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:o,mode:i})=>{const s=Yg(eX),c=g.useId(),l=g.useCallback(d=>{s.set(d,!0);for(const f of s.values())if(!f)return;r&&r()},[s,r]),u=g.useMemo(()=>({id:c,initial:t,isPresent:n,custom:a,onExitComplete:l,register:d=>(s.set(d,!1),()=>s.delete(d))}),o?[Math.random(),l]:[n,l]);return g.useMemo(()=>{s.forEach((d,f)=>s.set(f,!1))},[n]),g.useEffect(()=>{!n&&!s.size&&r&&r()},[n]),i==="popLayout"&&(e=h.jsx(JK,{isPresent:n,children:e})),h.jsx(DTe.Provider,{value:u,children:e})};function eX(){return new Map}const cp=e=>e.key||"";function pP(e){const t=[];return g.Children.forEach(e,n=>{g.isValidElement(n)&&t.push(n)}),t}const tX=({children:e,exitBeforeEnter:t,custom:n,initial:r=!0,onExitComplete:a,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const s=g.useMemo(()=>pP(e),[e]),c=s.map(cp),l=g.useRef(!0),u=g.useRef(s),d=Yg(()=>new Map),[f,p]=g.useState(s),[y,m]=g.useState(s);iM(()=>{l.current=!1,u.current=s;for(let w=0;w<y.length;w++){const _=cp(y[w]);c.includes(_)?d.delete(_):d.get(_)!==!0&&d.set(_,!1)}},[y,c.length,c.join("-")]);const v=[];if(s!==f){let w=[...s];for(let _=0;_<y.length;_++){const x=y[_],j=cp(x);c.includes(j)||(w.splice(_,0,x),v.push(x))}i==="wait"&&v.length&&(w=v),m(pP(w)),p(s);return}const{forceRender:b}=g.useContext(LTe);return h.jsx(h.Fragment,{children:y.map(w=>{const _=cp(w),x=s===y||c.includes(_),j=()=>{if(d.has(_))d.set(_,!0);else return;let S=!0;d.forEach(E=>{E||(S=!1)}),S&&(b==null||b(),m(u.current),a&&a())};return h.jsx(YK,{isPresent:x,initial:!l.current||r?void 0:!1,custom:x?void 0:n,presenceAffectsLayout:o,mode:i,onExitComplete:x?void 0:j,children:w},_)})})};function c0(e){const t=Yg(()=>$Te(e)),{isStatic:n}=g.useContext(oM);if(n){const[,r]=g.useState(e);g.useEffect(()=>t.on("change",r),[])}return t}function hP(e,t){const n=c0(t()),r=()=>n.set(t());return r(),iM(()=>{const a=()=>jK.preRender(r,!1,!0),o=e.map(i=>i.on("change",a));return()=>{o.forEach(i=>i()),FTe(r)}}),n}const nX=e=>e&&typeof e=="object"&&e.mix,rX=e=>nX(e)?e.mix:void 0;function aX(...e){const t=!Array.isArray(e[0]),n=t?0:-1,r=e[0+n],a=e[1+n],o=e[2+n],i=e[3+n],s=BTe(a,o,{mixer:rX(o[0]),...i});return t?s(r):s}function oX(e){sM.current=[],e();const t=hP(sM.current,e);return sM.current=void 0,t}function mP(e,t,n,r){if(typeof e=="function")return oX(e);const a=typeof t=="function"?t:aX(t,n,r);return Array.isArray(e)?yP(e,a):yP([e],([o])=>a(o))}function yP(e,t){const n=Yg(()=>[]);return hP(e,()=>{n.length=0;const r=e.length;for(let a=0;a<r;a++)n[a]=e[a].get();return t(n)})}function gP(e){return typeof e=="number"?e:parseFloat(e)}function iX(e,t={}){const{isStatic:n}=g.useContext(oM),r=g.useRef(null),a=c0(SK(e)?gP(e.get()):e),o=g.useRef(a.get()),i=g.useRef(()=>{}),s=()=>{const l=r.current;l&&l.time===0&&l.sample(zTe.delta),c(),r.current=VTe({keyframes:[a.get(),o.current],velocity:a.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:i.current})},c=()=>{r.current&&r.current.stop()};return g.useInsertionEffect(()=>a.attach((l,u)=>n?u(l):(o.current=l,i.current=u,jK.update(s),a.get()),c),[JSON.stringify(t)]),iM(()=>{if(SK(e))return e.on("change",l=>a.set(gP(l)))},[a]),a}var Ge=(e=>(e.Started="started",e.Downloading="downloading",e.Downloaded="downloaded",e.Loading="loading",e.Loaded="loaded",e))(Ge||{}),ou=(e=>(e.LLM="LLM",e.embedding="embedding",e.VLM="VLM",e))(ou||{}),Ct=(e=>(e.WebLLM="WebLLM",e.OpenAI="OpenAI",e.Groq="Groq",e))(Ct||{}),Br=(e=>(e.Started="started",e.Inprogress="inprogress",e.Success="success",e.Failed="failed",e))(Br||{}),cr=(e=>(e.Human="human",e.User="user",e.AI="ai",e.System="system",e.Assistant="assistant",e.Tool="tool",e.FewShotExample="few_shot_example",e))(cr||{}),lp=(e=>(e.Started="started",e.Inprogress="inprogress",e.Done="done",e))(lp||{}),lr=(e=>(e.Chat="chat",e.FewShotExample="few_shot_example",e))(lr||{}),zs=(e=>(e.VECTOR_DATABASE_RETREIVER="VECTOR_DATABASE_RETREIVER",e))(zs||{});function vP(e,t,n,r,a){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=EK(t),i=EK(e),s=!1,c=i.length-1;c>=0;c--){var l=i[c],u=e[l];if(OK(t,l)&&!(t[l]===void 0&&u!==void 0&&Array.isArray(t)===!1)){var d=t[l];typeof u=="object"&&u!=null&&typeof d=="object"&&d!=null&&Array.isArray(u)===Array.isArray(d)?vP(u,d,n,r+"/"+zl(l),a):u!==d&&(a&&n.push({op:"test",path:r+"/"+zl(l),value:ev(u)}),n.push({op:"replace",path:r+"/"+zl(l),value:ev(d)}))}else Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+zl(l),value:ev(u)}),n.push({op:"remove",path:r+"/"+zl(l)}),s=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&o.length==i.length))for(var c=0;c<o.length;c++){var l=o[c];!OK(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+zl(l),value:ev(t[l])})}}}function sX(e,t,n=!1){var r=[];return vP(e,t,r,"",n),r}let bP,wP;bP=async(e,t)=>{let n="",r="",a;const o=[];await e;for await(const i of e)i&&(Array.isArray(i)?(o.push(...i.map(s=>s.content)),o!=null&&o.length&&(r=o.join(""),t==null||t({chunk:i,content:r}))):(n=typeof i=="object"&&"content"in i?`${i.content}`:`${i}`,t==null||t({chunk:i,content:n})),a=i);return{lastChunk:a,content:n}},wP=()=>{const e=Qa(a=>a.toolsCallingStream),t=Qa(a=>a.structuredStream),n=Qa(a=>a.stream),r=Qa(a=>a.getCurrentModelInfo);return{stream:g.useCallback(async(a,o)=>{var p;const{tools:i,schemas:s,onMessageUpdate:c,onMessageFinish:l}=o||{};let u;if(!await r())throw new Error("Model is not found");if(s!=null&&s.length?(s&&(s==null?void 0:s.length)>1&&Ko("Multiple schemas are not supported. Only the first schema will be used."),u=t(((p=s==null?void 0:s[0])==null?void 0:p.schema_items)||[],a)):i!=null&&i.length?u=e(i,a):u=n(a),!u)throw new Error("Stream is not supported");const{lastChunk:d,content:f}=await bP(u,c);return l==null||l({content:f,lastChunk:d}),{lastChunk:d,content:f}},[r,n,t,e])}},sv=globalThis||void 0||self;var iu={},xP;function cX(){if(xP)return iu;xP=1,Object.defineProperty(iu,"__esModule",{value:!0}),iu.parse=i,iu.serialize=l;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const f=function(){};return f.prototype=Object.create(null),f})();function i(f,p){const y=new o,m=f.length;if(m<2)return y;const v=(p==null?void 0:p.decode)||u;let b=0;do{const w=f.indexOf("=",b);if(w===-1)break;const _=f.indexOf(";",b),x=_===-1?m:_;if(w>x){b=f.lastIndexOf(";",w-1)+1;continue}const j=s(f,b,w),S=c(f,w,j),E=f.slice(j,S);if(y[E]===void 0){let O=s(f,w+1,x),M=c(f,x,O);const N=v(f.slice(O,M));y[E]=N}b=x+1}while(b<m);return y}function s(f,p,y){do{const m=f.charCodeAt(p);if(m!==32&&m!==9)return p}while(++p<y);return y}function c(f,p,y){for(;p>y;){const m=f.charCodeAt(--p);if(m!==32&&m!==9)return p+1}return y}function l(f,p,y){const m=(y==null?void 0:y.encode)||encodeURIComponent;if(!e.test(f))throw new TypeError(`argument name is invalid: ${f}`);const v=m(p);if(!t.test(v))throw new TypeError(`argument val is invalid: ${p}`);let b=f+"="+v;if(!y)return b;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);b+="; Max-Age="+y.maxAge}if(y.domain){if(!n.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);b+="; Domain="+y.domain}if(y.path){if(!r.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);b+="; Path="+y.path}if(y.expires){if(!d(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);b+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(b+="; HttpOnly"),y.secure&&(b+="; Secure"),y.partitioned&&(b+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return b}function u(f){if(f.indexOf("%")===-1)return f;try{return decodeURIComponent(f)}catch{return f}}function d(f){return a.call(f)==="[object Date]"}return iu}cX();var _P="popstate";function lX(e={}){function t(r,a){let{pathname:o,search:i,hash:s}=r.location;return Vs("",{pathname:o,search:i,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:no(a)}return SP(t,n,null,e)}function uX(e={}){function t(a,o){let{pathname:i="/",search:s="",hash:c=""}=ro(a.location.hash.substring(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),Vs("",{pathname:i,search:s,hash:c},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(a,o){let i=a.document.querySelector("base"),s="";if(i&&i.getAttribute("href")){let c=a.location.href,l=c.indexOf("#");s=l===-1?c:c.slice(0,l)}return s+"#"+(typeof o=="string"?o:no(o))}function r(a,o){sn(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return SP(t,n,r,e)}function Xe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function sn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function dX(){return Math.random().toString(36).substring(2,10)}function jP(e,t){return{usr:e.state,key:e.key,idx:t}}function Vs(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?ro(t):t,state:n,key:t&&t.key||r||dX()}}function no({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ro(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function SP(e,t,n,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,i=a.history,s="POP",c=null,l=u();l==null&&(l=0,i.replaceState({...i.state,idx:l},""));function u(){return(i.state||{idx:null}).idx}function d(){s="POP";let v=u(),b=v==null?null:v-l;l=v,c&&c({action:s,location:m.location,delta:b})}function f(v,b){s="PUSH";let w=Vs(m.location,v,b);n&&n(w,v),l=u()+1;let _=jP(w,l),x=m.createHref(w);try{i.pushState(_,"",x)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(x)}o&&c&&c({action:s,location:m.location,delta:1})}function p(v,b){s="REPLACE";let w=Vs(m.location,v,b);n&&n(w,v),l=u();let _=jP(w,l),x=m.createHref(w);i.replaceState(_,"",x),o&&c&&c({action:s,location:m.location,delta:0})}function y(v){let b=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof v=="string"?v:no(v);return w=w.replace(/ $/,"%20"),Xe(b,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,b)}let m={get action(){return s},get location(){return e(a,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(_P,d),c=v,()=>{a.removeEventListener(_P,d),c=null}},createHref(v){return t(a,v)},createURL:y,encodeLocation(v){let b=y(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:p,go(v){return i.go(v)}};return m}var fX=new Set(["lazy","caseSensitive","path","id","index","children"]);function pX(e){return e.index===!0}function up(e,t,n=[],r={}){return e.map((a,o)=>{let i=[...n,String(o)],s=typeof a.id=="string"?a.id:i.join("-");if(Xe(a.index!==!0||!a.children,"Cannot specify children on an index route"),Xe(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),pX(a)){let c={...a,...t(a),id:s};return r[s]=c,c}else{let c={...a,...t(a),id:s,children:void 0};return r[s]=c,a.children&&(c.children=up(a.children,t,i,r)),c}})}function Yo(e,t,n="/"){return dp(e,t,n,!1)}function dp(e,t,n,r){let a=typeof t=="string"?ro(t):t,o=zr(a.pathname||"/",n);if(o==null)return null;let i=EP(e);mX(i);let s=null;for(let c=0;s==null&&c<i.length;++c){let l=OX(o);s=SX(i[c],l,r)}return s}function hX(e,t){let{route:n,pathname:r,params:a}=e;return{id:n.id,pathname:r,params:a,data:t[n.id],handle:n.handle}}function EP(e,t=[],n=[],r=""){let a=(o,i,s)=>{let c={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(Xe(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let l=Sa([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(Xe(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),EP(o.children,t,u,l)),!(o.path==null&&!o.index)&&t.push({path:l,score:_X(l,o.index),routesMeta:u})};return e.forEach((o,i)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))a(o,i);else for(let c of OP(o.path))a(o,i,c)}),t}function OP(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let i=OP(r.join("/")),s=[];return s.push(...i.map(c=>c===""?o:[o,c].join("/"))),a&&s.push(...i),s.map(c=>e.startsWith("/")&&c===""?"/":c)}function mX(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:jX(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var yX=/^:[\w-]+$/,gX=3,vX=2,bX=1,wX=10,xX=-2,CP=e=>e==="*";function _X(e,t){let n=e.split("/"),r=n.length;return n.some(CP)&&(r+=xX),t&&(r+=vX),n.filter(a=>!CP(a)).reduce((a,o)=>a+(yX.test(o)?gX:o===""?bX:wX),r)}function jX(e,t){return e.length===t.length&&e.slice(0,-1).every((n,r)=>n===t[r])?e[e.length-1]-t[t.length-1]:0}function SX(e,t,n=!1){let{routesMeta:r}=e,a={},o="/",i=[];for(let s=0;s<r.length;++s){let c=r[s],l=s===r.length-1,u=o==="/"?t:t.slice(o.length)||"/",d=fp({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),f=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=fp({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Sa([o,d.pathname]),pathnameBase:MX(Sa([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=Sa([o,d.pathnameBase]))}return i}function fp(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=EX(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((c,{paramName:l,isOptional:u},d)=>{if(l==="*"){let p=s[d]||"";i=o.slice(0,o.length-p.length).replace(/(.)\/+$/,"$1")}const f=s[d];return u&&!f?c[l]=void 0:c[l]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:i,pattern:e}}function EX(e,t=!1,n=!0){sn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,i,s)=>(r.push({paramName:i,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function OX(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return sn(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function zr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function CX(e,t="/"){let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?ro(e):e;return{pathname:n?n.startsWith("/")?n:NX(n,t):t,search:PX(r),hash:kX(a)}}function NX(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function l0(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function NP(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function pp(e){let t=NP(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function hp(e,t,n,r=!1){let a;typeof e=="string"?a=ro(e):(a={...e},Xe(!a.pathname||!a.pathname.includes("?"),l0("?","pathname","search",a)),Xe(!a.pathname||!a.pathname.includes("#"),l0("#","pathname","hash",a)),Xe(!a.search||!a.search.includes("#"),l0("#","search","hash",a)));let o=e===""||a.pathname==="",i=o?"/":a.pathname,s;if(i==null)s=n;else{let d=t.length-1;if(!r&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),d-=1;a.pathname=f.join("/")}s=d>=0?t[d]:"/"}let c=CX(a,s),l=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}var Sa=e=>e.join("/").replace(/\/\/+/g,"/"),MX=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),PX=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,kX=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,mp=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function yp(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var MP=["POST","PUT","PATCH","DELETE"],AX=new Set(MP),TX=["GET",...MP],RX=new Set(TX),IX=new Set([301,302,303,307,308]),DX=new Set([307,308]),u0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},LX={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},su={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},d0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$X=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),PP="remix-router-transitions",kP=Symbol("ResetLoaderData");function AP(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";Xe(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.mapRouteProperties||$X,a={},o=up(e.routes,r,void 0,a),i,s=e.basename||"/",c=e.dataStrategy||qX,l=e.patchRoutesOnNavigation,u={...e.future},d=null,f=new Set,p=null,y=null,m=null,v=e.hydrationData!=null,b=Yo(o,e.history.location,s),w=null;if(b==null&&!l){let q=_r(404,{pathname:e.history.location.pathname}),{matches:ee,route:ae}=UP(o);b=ee,w={[ae.id]:q}}b&&!e.hydrationData&&Oe(b,o,e.history.location.pathname).active&&(b=null);let _;if(b)if(b.some(q=>q.route.lazy))_=!1;else if(!b.some(q=>q.route.loader))_=!0;else{let q=e.hydrationData?e.hydrationData.loaderData:null,ee=e.hydrationData?e.hydrationData.errors:null;if(ee){let ae=b.findIndex(pe=>ee[pe.route.id]!==void 0);_=b.slice(0,ae+1).every(pe=>!p0(pe.route,q,ee))}else _=b.every(ae=>!p0(ae.route,q,ee))}else{_=!1,b=[];let q=Oe(null,o,e.history.location.pathname);q.active&&q.matches&&(b=q.matches)}let x,j={historyAction:e.history.action,location:e.history.location,matches:b,initialized:_,navigation:u0,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||w,fetchers:new Map,blockers:new Map},S="POP",E=!1,O,M=!1,N=new Map,P=null,R=!1,k=!1,C=new Set,T=new Map,A=0,I=-1,L=new Map,D=new Set,B=new Map,F=new Map,$=new Set,V=new Map,G,X=null;function H(){if(d=e.history.listen(({action:q,location:ee,delta:ae})=>{if(G){G(),G=void 0;return}sn(V.size===0||ae!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let pe=Ht({currentLocation:j.location,nextLocation:ee,historyAction:q});if(pe&&ae!=null){let Ne=new Promise(Ie=>{G=Ie});e.history.go(ae*-1),Te(pe,{state:"blocked",location:ee,proceed(){Te(pe,{state:"proceeding",proceed:void 0,reset:void 0,location:ee}),Ne.then(()=>e.history.go(ae))},reset(){let Ie=new Map(j.blockers);Ie.set(pe,su),U({blockers:Ie})}});return}return se(q,ee)}),n){eG(t,N);let q=()=>tG(t,N);t.addEventListener("pagehide",q),P=()=>t.removeEventListener("pagehide",q)}return j.initialized||se("POP",j.location,{initialHydration:!0}),x}function J(){d&&d(),P&&P(),f.clear(),O&&O.abort(),j.fetchers.forEach((q,ee)=>nr(ee)),j.blockers.forEach((q,ee)=>me(ee))}function Z(q){return f.add(q),()=>f.delete(q)}function U(q,ee={}){j={...j,...q};let ae=[],pe=[];j.fetchers.forEach((Ne,Ie)=>{Ne.state==="idle"&&($.has(Ie)?ae.push(Ie):pe.push(Ie))}),[...f].forEach(Ne=>Ne(j,{deletedFetchers:ae,viewTransitionOpts:ee.viewTransitionOpts,flushSync:ee.flushSync===!0})),ae.forEach(Ne=>nr(Ne)),pe.forEach(Ne=>j.fetchers.delete(Ne))}function Q(q,ee,{flushSync:ae}={}){var we,ze;let pe=j.actionData!=null&&j.navigation.formMethod!=null&&Vr(j.navigation.formMethod)&&j.navigation.state==="loading"&&((we=q.state)==null?void 0:we._isRedirect)!==!0,Ne;ee.actionData?Object.keys(ee.actionData).length>0?Ne=ee.actionData:Ne=null:pe?Ne=j.actionData:Ne=null;let Ie=ee.loaderData?VP(j.loaderData,ee.loaderData,ee.matches||[],ee.errors):j.loaderData,Be=j.blockers;Be.size>0&&(Be=new Map(Be),Be.forEach((Je,Rt)=>Be.set(Rt,su)));let Me=E===!0||j.navigation.formMethod!=null&&Vr(j.navigation.formMethod)&&((ze=q.state)==null?void 0:ze._isRedirect)!==!0;i&&(o=i,i=void 0),R||S==="POP"||(S==="PUSH"?e.history.push(q,q.state):S==="REPLACE"&&e.history.replace(q,q.state));let ke;if(S==="POP"){let Je=N.get(j.location.pathname);Je&&Je.has(q.pathname)?ke={currentLocation:j.location,nextLocation:q}:N.has(q.pathname)&&(ke={currentLocation:q,nextLocation:j.location})}else if(M){let Je=N.get(j.location.pathname);Je?Je.add(q.pathname):(Je=new Set([q.pathname]),N.set(j.location.pathname,Je)),ke={currentLocation:j.location,nextLocation:q}}U({...ee,actionData:Ne,loaderData:Ie,historyAction:S,location:q,initialized:!0,navigation:u0,revalidation:"idle",restoreScrollPosition:Ee(q,ee.matches||j.matches),preventScrollReset:Me,blockers:Be},{viewTransitionOpts:ke,flushSync:ae===!0}),S="POP",E=!1,M=!1,R=!1,k=!1,X==null||X.resolve(),X=null}async function ne(q,ee){if(typeof q=="number"){e.history.go(q);return}let ae=f0(j.location,j.matches,s,q,ee==null?void 0:ee.fromRouteId,ee==null?void 0:ee.relative),{path:pe,submission:Ne,error:Ie}=TP(!1,ae,ee),Be=j.location,Me=Vs(j.location,pe,ee&&ee.state);Me={...Me,...e.history.encodeLocation(Me)};let ke=ee&&ee.replace!=null?ee.replace:void 0,we="PUSH";ke===!0?we="REPLACE":ke===!1||Ne!=null&&Vr(Ne.formMethod)&&Ne.formAction===j.location.pathname+j.location.search&&(we="REPLACE");let ze=ee&&"preventScrollReset"in ee?ee.preventScrollReset===!0:void 0,Je=(ee&&ee.flushSync)===!0,Rt=Ht({currentLocation:Be,nextLocation:Me,historyAction:we});if(Rt){Te(Rt,{state:"blocked",location:Me,proceed(){Te(Rt,{state:"proceeding",proceed:void 0,reset:void 0,location:Me}),ne(q,ee)},reset(){let Ft=new Map(j.blockers);Ft.set(Rt,su),U({blockers:Ft})}});return}await se(we,Me,{submission:Ne,pendingError:Ie,preventScrollReset:ze,replace:ee&&ee.replace,enableViewTransition:ee&&ee.viewTransition,flushSync:Je})}function z(){X||(X=nG()),st(),U({revalidation:"loading"});let q=X.promise;return j.navigation.state==="submitting"?q:j.navigation.state==="idle"?(se(j.historyAction,j.location,{startUninterruptedRevalidation:!0}),q):(se(S||j.historyAction,j.navigation.location,{overrideNavigation:j.navigation,enableViewTransition:M===!0}),q)}async function se(q,ee,ae){O&&O.abort(),O=null,S=q,R=(ae&&ae.startUninterruptedRevalidation)===!0,_e(j.location,j.matches),E=(ae&&ae.preventScrollReset)===!0,M=(ae&&ae.enableViewTransition)===!0;let pe=i||o,Ne=ae&&ae.overrideNavigation,Ie=Yo(pe,ee,s),Be=(ae&&ae.flushSync)===!0,Me=Oe(Ie,pe,ee.pathname);if(Me.active&&Me.matches&&(Ie=Me.matches),!Ie){let{error:at,notFoundMatches:ar,route:Gt}=$t(ee.pathname);Q(ee,{matches:ar,loaderData:{},errors:{[Gt.id]:at}},{flushSync:Be});return}if(j.initialized&&!k&&XX(j.location,ee)&&!(ae&&ae.submission&&Vr(ae.submission.formMethod))){Q(ee,{matches:Ie},{flushSync:Be});return}O=new AbortController;let ke=qs(e.history,ee,O.signal,ae&&ae.submission),we;if(ae&&ae.pendingError)we=[Li(Ie).route.id,{type:"error",error:ae.pendingError}];else if(ae&&ae.submission&&Vr(ae.submission.formMethod)){let at=await re(ke,ee,ae.submission,Ie,Me.active,{replace:ae.replace,flushSync:Be});if(at.shortCircuited)return;if(at.pendingActionResult){let[ar,Gt]=at.pendingActionResult;if(ur(Gt)&&yp(Gt.error)&&Gt.error.status===404){O=null,Q(ee,{matches:at.matches,loaderData:{},errors:{[ar]:Gt.error}});return}}Ie=at.matches||Ie,we=at.pendingActionResult,Ne=y0(ee,ae.submission),Be=!1,Me.active=!1,ke=qs(e.history,ke.url,ke.signal)}let{shortCircuited:ze,matches:Je,loaderData:Rt,errors:Ft}=await ue(ke,ee,Ie,Me.active,Ne,ae&&ae.submission,ae&&ae.fetcherSubmission,ae&&ae.replace,ae&&ae.initialHydration===!0,Be,we);ze||(O=null,Q(ee,{matches:Je||Ie,...qP(we),loaderData:Rt,errors:Ft}))}async function re(q,ee,ae,pe,Ne,Ie={}){st();let Be=JX(ee,ae);if(U({navigation:Be},{flushSync:Ie.flushSync===!0}),Ne){let we=await qe(pe,ee.pathname,q.signal);if(we.type==="aborted")return{shortCircuited:!0};if(we.type==="error"){let ze=Li(we.partialMatches).route.id;return{matches:we.partialMatches,pendingActionResult:[ze,{type:"error",error:we.error}]}}else if(we.matches)pe=we.matches;else{let{notFoundMatches:ze,error:Je,route:Rt}=$t(ee.pathname);return{matches:ze,pendingActionResult:[Rt.id,{type:"error",error:Je}]}}}let Me,ke=cu(pe,ee);if(!ke.route.action&&!ke.route.lazy)Me={type:"error",error:_r(405,{method:q.method,pathname:ee.pathname,routeId:ke.route.id})};else if(Me=(await We("action",j,q,[ke],pe,null))[ke.route.id],q.signal.aborted)return{shortCircuited:!0};if($i(Me)){let we;return Ie&&Ie.replace!=null?we=Ie.replace:we=FP(Me.response.headers.get("Location"),new URL(q.url),s)===j.location.pathname+j.location.search,await Ue(q,Me,!0,{submission:ae,replace:we}),{shortCircuited:!0}}if(ur(Me)){let we=Li(pe,ke.route.id);return(Ie&&Ie.replace)!==!0&&(S="PUSH"),{matches:pe,pendingActionResult:[we.route.id,Me]}}return{matches:pe,pendingActionResult:[ke.route.id,Me]}}async function ue(q,ee,ae,pe,Ne,Ie,Be,Me,ke,we,ze){let Je=Ne||y0(ee,Ie),Rt=Ie||Be||KP(Je),Ft=!R&&!ke;if(pe){if(Ft){let or=je(ze);U({navigation:Je,...or!==void 0?{actionData:or}:{}},{flushSync:we})}let pt=await qe(ae,ee.pathname,q.signal);if(pt.type==="aborted")return{shortCircuited:!0};if(pt.type==="error"){let or=Li(pt.partialMatches).route.id;return{matches:pt.partialMatches,loaderData:{},errors:{[or]:pt.error}}}else if(pt.matches)ae=pt.matches;else{let{error:or,notFoundMatches:Ms,route:qt}=$t(ee.pathname);return{matches:Ms,loaderData:{},errors:{[qt.id]:or}}}}let at=i||o,[ar,Gt]=IP(e.history,j,ae,Rt,ee,ke===!0,k,C,$,B,D,at,s,ze);if(I=++A,ar.length===0&&Gt.length===0){let pt=Y();return Q(ee,{matches:ae,loaderData:{},errors:ze&&ur(ze[1])?{[ze[0]]:ze[1].error}:null,...qP(ze),...pt?{fetchers:new Map(j.fetchers)}:{}},{flushSync:we}),{shortCircuited:!0}}if(Ft){let pt={};if(!pe){pt.navigation=Je;let or=je(ze);or!==void 0&&(pt.actionData=or)}Gt.length>0&&(pt.fetchers=Le(Gt)),U(pt,{flushSync:we})}Gt.forEach(pt=>{rr(pt.key),pt.controller&&T.set(pt.key,pt.controller)});let Ns=()=>Gt.forEach(pt=>rr(pt.key));O&&O.signal.addEventListener("abort",Ns);let{loaderResults:xa,fetcherResults:Ai}=await At(j,ae,ar,Gt,q);if(q.signal.aborted)return{shortCircuited:!0};O&&O.signal.removeEventListener("abort",Ns),Gt.forEach(pt=>T.delete(pt.key));let Ga=gp(xa);if(Ga)return await Ue(q,Ga.result,!0,{replace:Me}),{shortCircuited:!0};if(Ga=gp(Ai),Ga)return D.add(Ga.key),await Ue(q,Ga.result,!0,{replace:Me}),{shortCircuited:!0};let{loaderData:Zf,errors:Rr}=zP(j,ae,xa,ze,Gt,Ai);ke&&j.errors&&(Rr={...j.errors,...Rr});let $l=Y(),Fl=te(I),Bl=$l||Fl||Gt.length>0;return{matches:ae,loaderData:Zf,errors:Rr,...Bl?{fetchers:new Map(j.fetchers)}:{}}}function je(q){if(q&&!ur(q[1]))return{[q[0]]:q[1].data};if(j.actionData)return Object.keys(j.actionData).length===0?null:j.actionData}function Le(q){return q.forEach(ee=>{let ae=j.fetchers.get(ee.key),pe=lu(void 0,ae?ae.data:void 0);j.fetchers.set(ee.key,pe)}),new Map(j.fetchers)}async function $e(q,ee,ae,pe){rr(q);let Ne=(pe&&pe.flushSync)===!0,Ie=i||o,Be=f0(j.location,j.matches,s,ae,ee,pe==null?void 0:pe.relative),Me=Yo(Ie,Be,s),ke=Oe(Me,Ie,Be);if(ke.active&&ke.matches&&(Me=ke.matches),!Me){wt(q,ee,_r(404,{pathname:Be}),{flushSync:Ne});return}let{path:we,submission:ze,error:Je}=TP(!0,Be,pe);if(Je){wt(q,ee,Je,{flushSync:Ne});return}let Rt=cu(Me,we),Ft=(pe&&pe.preventScrollReset)===!0;if(ze&&Vr(ze.formMethod)){await Se(q,ee,we,Rt,Me,ke.active,Ne,Ft,ze);return}B.set(q,{routeId:ee,path:we}),await Ve(q,ee,we,Rt,Me,ke.active,Ne,Ft,ze)}async function Se(q,ee,ae,pe,Ne,Ie,Be,Me,ke){st(),B.delete(q);function we(qt){if(!qt.route.action&&!qt.route.lazy){let Zo=_r(405,{method:ke.formMethod,pathname:ae,routeId:ee});return wt(q,ee,Zo,{flushSync:Be}),!0}return!1}if(!Ie&&we(pe))return;let ze=j.fetchers.get(q);rt(q,YX(ke,ze),{flushSync:Be});let Je=new AbortController,Rt=qs(e.history,ae,Je.signal,ke);if(Ie){let qt=await qe(Ne,ae,Rt.signal);if(qt.type==="aborted")return;if(qt.type==="error"){wt(q,ee,qt.error,{flushSync:Be});return}else if(qt.matches){if(Ne=qt.matches,pe=cu(Ne,ae),we(pe))return}else{wt(q,ee,_r(404,{pathname:ae}),{flushSync:Be});return}}T.set(q,Je);let Ft=A,at=(await We("action",j,Rt,[pe],Ne,q))[pe.route.id];if(Rt.signal.aborted){T.get(q)===Je&&T.delete(q);return}if($.has(q)){if($i(at)||ur(at)){rt(q,ei(void 0));return}}else{if($i(at))if(T.delete(q),I>Ft){rt(q,ei(void 0));return}else return D.add(q),rt(q,lu(ke)),Ue(Rt,at,!1,{fetcherSubmission:ke,preventScrollReset:Me});if(ur(at)){wt(q,ee,at.error);return}}let ar=j.navigation.location||j.location,Gt=qs(e.history,ar,Je.signal),Ns=i||o,xa=j.navigation.state!=="idle"?Yo(Ns,j.navigation.location,s):j.matches;Xe(xa,"Didn't find any matches after fetcher action");let Ai=++A;L.set(q,Ai);let Ga=lu(ke,at.data);j.fetchers.set(q,Ga);let[Zf,Rr]=IP(e.history,j,xa,ke,ar,!1,k,C,$,B,D,Ns,s,[pe.route.id,at]);Rr.filter(qt=>qt.key!==q).forEach(qt=>{let Zo=qt.key,Jg=j.fetchers.get(Zo),rM=lu(void 0,Jg?Jg.data:void 0);j.fetchers.set(Zo,rM),rr(Zo),qt.controller&&T.set(Zo,qt.controller)}),U({fetchers:new Map(j.fetchers)});let $l=()=>Rr.forEach(qt=>rr(qt.key));Je.signal.addEventListener("abort",$l);let{loaderResults:Fl,fetcherResults:Bl}=await At(j,xa,Zf,Rr,Gt);if(Je.signal.aborted)return;Je.signal.removeEventListener("abort",$l),L.delete(q),T.delete(q),Rr.forEach(qt=>T.delete(qt.key));let pt=gp(Fl);if(pt)return Ue(Gt,pt.result,!1,{preventScrollReset:Me});if(pt=gp(Bl),pt)return D.add(pt.key),Ue(Gt,pt.result,!1,{preventScrollReset:Me});let{loaderData:or,errors:Ms}=zP(j,xa,Fl,void 0,Rr,Bl);if(j.fetchers.has(q)){let qt=ei(at.data);j.fetchers.set(q,qt)}te(Ai),j.navigation.state==="loading"&&Ai>I?(Xe(S,"Expected pending action"),O&&O.abort(),Q(j.navigation.location,{matches:xa,loaderData:or,errors:Ms,fetchers:new Map(j.fetchers)})):(U({errors:Ms,loaderData:VP(j.loaderData,or,xa,Ms),fetchers:new Map(j.fetchers)}),k=!1)}async function Ve(q,ee,ae,pe,Ne,Ie,Be,Me,ke){let we=j.fetchers.get(q);rt(q,lu(ke,we?we.data:void 0),{flushSync:Be});let ze=new AbortController,Je=qs(e.history,ae,ze.signal);if(Ie){let at=await qe(Ne,ae,Je.signal);if(at.type==="aborted")return;if(at.type==="error"){wt(q,ee,at.error,{flushSync:Be});return}else if(at.matches)Ne=at.matches,pe=cu(Ne,ae);else{wt(q,ee,_r(404,{pathname:ae}),{flushSync:Be});return}}T.set(q,ze);let Rt=A,Ft=(await We("loader",j,Je,[pe],Ne,q))[pe.route.id];if(T.get(q)===ze&&T.delete(q),!Je.signal.aborted){if($.has(q)){rt(q,ei(void 0));return}if($i(Ft))if(I>Rt){rt(q,ei(void 0));return}else{D.add(q),await Ue(Je,Ft,!1,{preventScrollReset:Me});return}if(ur(Ft)){wt(q,ee,Ft.error);return}rt(q,ei(Ft.data))}}async function Ue(q,ee,ae,{submission:pe,fetcherSubmission:Ne,preventScrollReset:Ie,replace:Be}={}){ee.response.headers.has("X-Remix-Revalidate")&&(k=!0);let Me=ee.response.headers.get("Location");Xe(Me,"Expected a Location header on the redirect Response"),Me=FP(Me,new URL(q.url),s);let ke=Vs(j.location,Me,{_isRedirect:!0});if(n){let at=!1;if(ee.response.headers.has("X-Remix-Reload-Document"))at=!0;else if(d0.test(Me)){const ar=e.history.createURL(Me);at=ar.origin!==t.location.origin||zr(ar.pathname,s)==null}if(at){Be?t.location.replace(Me):t.location.assign(Me);return}}O=null;let we=Be===!0||ee.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:ze,formAction:Je,formEncType:Rt}=j.navigation;!pe&&!Ne&&ze&&Je&&Rt&&(pe=KP(j.navigation));let Ft=pe||Ne;if(DX.has(ee.response.status)&&Ft&&Vr(Ft.formMethod))await se(we,ke,{submission:{...Ft,formAction:Me},preventScrollReset:Ie||E,enableViewTransition:ae?M:void 0});else{let at=y0(ke,pe);await se(we,ke,{overrideNavigation:at,fetcherSubmission:Ne,preventScrollReset:Ie||E,enableViewTransition:ae?M:void 0})}}async function We(q,ee,ae,pe,Ne,Ie){let Be,Me={};try{Be=await UX(c,q,ee,ae,pe,Ne,Ie,a,r)}catch(ke){return pe.forEach(we=>{Me[we.route.id]={type:"error",error:ke}}),Me}for(let[ke,we]of Object.entries(Be))if(GX(we)){let ze=we.result;Me[ke]={type:"redirect",response:ZX(ze,ae,ke,Ne,s)}}else Me[ke]=await HX(we);return Me}async function At(q,ee,ae,pe,Ne){let Ie=We("loader",q,Ne,ae,ee,null),Be=Promise.all(pe.map(async we=>{if(we.matches&&we.match&&we.controller){let ze=(await We("loader",q,qs(e.history,we.path,we.controller.signal),[we.match],we.matches,we.key))[we.match.route.id];return{[we.key]:ze}}else return Promise.resolve({[we.key]:{type:"error",error:_r(404,{pathname:we.path})}})})),Me=await Ie,ke=(await Be).reduce((we,ze)=>Object.assign(we,ze),{});return{loaderResults:Me,fetcherResults:ke}}function st(){k=!0,B.forEach((q,ee)=>{T.has(ee)&&C.add(ee),rr(ee)})}function rt(q,ee,ae={}){j.fetchers.set(q,ee),U({fetchers:new Map(j.fetchers)},{flushSync:(ae&&ae.flushSync)===!0})}function wt(q,ee,ae,pe={}){let Ne=Li(j.matches,ee);nr(q),U({errors:{[Ne.route.id]:ae},fetchers:new Map(j.fetchers)},{flushSync:(pe&&pe.flushSync)===!0})}function Xt(q){return F.set(q,(F.get(q)||0)+1),$.has(q)&&$.delete(q),j.fetchers.get(q)||LX}function nr(q){let ee=j.fetchers.get(q);T.has(q)&&!(ee&&ee.state==="loading"&&L.has(q))&&rr(q),B.delete(q),L.delete(q),D.delete(q),$.delete(q),C.delete(q),j.fetchers.delete(q)}function Ka(q){let ee=(F.get(q)||0)-1;ee<=0?(F.delete(q),$.add(q)):F.set(q,ee),U({fetchers:new Map(j.fetchers)})}function rr(q){let ee=T.get(q);ee&&(ee.abort(),T.delete(q))}function Xa(q){for(let ee of q){let ae=Xt(ee),pe=ei(ae.data);j.fetchers.set(ee,pe)}}function Y(){let q=[],ee=!1;for(let ae of D){let pe=j.fetchers.get(ae);Xe(pe,`Expected fetcher: ${ae}`),pe.state==="loading"&&(D.delete(ae),q.push(ae),ee=!0)}return Xa(q),ee}function te(q){let ee=[];for(let[ae,pe]of L)if(pe<q){let Ne=j.fetchers.get(ae);Xe(Ne,`Expected fetcher: ${ae}`),Ne.state==="loading"&&(rr(ae),L.delete(ae),ee.push(ae))}return Xa(ee),ee.length>0}function ce(q,ee){let ae=j.blockers.get(q)||su;return V.get(q)!==ee&&V.set(q,ee),ae}function me(q){j.blockers.delete(q),V.delete(q)}function Te(q,ee){let ae=j.blockers.get(q)||su;Xe(ae.state==="unblocked"&&ee.state==="blocked"||ae.state==="blocked"&&ee.state==="blocked"||ae.state==="blocked"&&ee.state==="proceeding"||ae.state==="blocked"&&ee.state==="unblocked"||ae.state==="proceeding"&&ee.state==="unblocked",`Invalid blocker state transition: ${ae.state} -> ${ee.state}`);let pe=new Map(j.blockers);pe.set(q,ee),U({blockers:pe})}function Ht({currentLocation:q,nextLocation:ee,historyAction:ae}){if(V.size===0)return;V.size>1&&sn(!1,"A router only supports one blocker at a time");let pe=Array.from(V.entries()),[Ne,Ie]=pe[pe.length-1],Be=j.blockers.get(Ne);if(!(Be&&Be.state==="proceeding")&&Ie({currentLocation:q,nextLocation:ee,historyAction:ae}))return Ne}function $t(q){let ee=_r(404,{pathname:q}),ae=i||o,{matches:pe,route:Ne}=UP(ae);return{notFoundMatches:pe,route:Ne,error:ee}}function Ze(q,ee,ae){if(p=q,m=ee,y=ae||null,!v&&j.navigation===u0){v=!0;let pe=Ee(j.location,j.matches);pe!=null&&U({restoreScrollPosition:pe})}return()=>{p=null,m=null,y=null}}function be(q,ee){return y&&y(q,ee.map(ae=>hX(ae,j.loaderData)))||q.key}function _e(q,ee){if(p&&m){let ae=be(q,ee);p[ae]=m()}}function Ee(q,ee){if(p){let ae=be(q,ee),pe=p[ae];if(typeof pe=="number")return pe}return null}function Oe(q,ee,ae){if(l)if(q){if(Object.keys(q[0].params).length>0)return{active:!0,matches:dp(ee,ae,s,!0)}}else return{active:!0,matches:dp(ee,ae,s,!0)||[]};return{active:!1,matches:null}}async function qe(q,ee,ae){if(!l)return{type:"success",matches:q};let pe=q;for(;;){let Ne=i==null,Ie=i||o,Be=a;try{await l({path:ee,matches:pe,patch:(we,ze)=>{ae.aborted||LP(we,ze,Ie,Be,r)}})}catch(we){return{type:"error",error:we,partialMatches:pe}}finally{Ne&&!ae.aborted&&(o=[...o])}if(ae.aborted)return{type:"aborted"};let Me=Yo(Ie,ee,s);if(Me)return{type:"success",matches:Me};let ke=dp(Ie,ee,s,!0);if(!ke||pe.length===ke.length&&pe.every((we,ze)=>we.route.id===ke[ze].route.id))return{type:"success",matches:null};pe=ke}}function Ot(q){a={},i=up(q,r,void 0,a)}function Vt(q,ee){let ae=i==null;LP(q,ee,i||o,a,r),ae&&(o=[...o],U({}))}return x={get basename(){return s},get future(){return u},get state(){return j},get routes(){return o},get window(){return t},initialize:H,subscribe:Z,enableScrollRestoration:Ze,navigate:ne,fetch:$e,revalidate:z,createHref:q=>e.history.createHref(q),encodeLocation:q=>e.history.encodeLocation(q),getFetcher:Xt,deleteFetcher:Ka,dispose:J,getBlocker:ce,deleteBlocker:me,patchRoutes:Vt,_internalFetchControllers:T,_internalSetRoutes:Ot},x}function FX(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function f0(e,t,n,r,a,o){let i,s;if(a){i=[];for(let l of t)if(i.push(l),l.route.id===a){s=l;break}}else i=t,s=t[t.length-1];let c=hp(r||".",pp(i),zr(e.pathname,n)||e.pathname,o==="path");if(r==null&&(c.search=e.search,c.hash=e.hash),(r==null||r===""||r===".")&&s){let l=m0(c.search);if(s.route.index&&!l)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&l){let u=new URLSearchParams(c.search),d=u.getAll("index");u.delete("index"),d.filter(p=>p).forEach(p=>u.append("index",p));let f=u.toString();c.search=f?`?${f}`:""}}return n!=="/"&&(c.pathname=c.pathname==="/"?n:Sa([n,c.pathname])),no(c)}function TP(e,t,n){if(!n||!FX(n))return{path:t};if(n.formMethod&&!QX(n.formMethod))return{path:t,error:_r(405,{method:n.formMethod})};let r=()=>({path:t,error:_r(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),o=WP(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Vr(a))return r();let u=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((d,[f,p])=>`${d}${f}=${p}
`,""):String(n.body);return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:u}}}else if(n.formEncType==="application/json"){if(!Vr(a))return r();try{let u=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:u,text:void 0}}}catch{return r()}}}Xe(typeof FormData=="function","FormData is not available in this environment");let i,s;if(n.formData)i=h0(n.formData),s=n.formData;else if(n.body instanceof FormData)i=h0(n.body),s=n.body;else if(n.body instanceof URLSearchParams)i=n.body,s=BP(i);else if(n.body==null)i=new URLSearchParams,s=new FormData;else try{i=new URLSearchParams(n.body),s=BP(i)}catch{return r()}let c={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:s,json:void 0,text:void 0};if(Vr(c.formMethod))return{path:t,submission:c};let l=ro(t);return e&&l.search&&m0(l.search)&&i.append("index",""),l.search=`?${i}`,{path:no(l),submission:c}}function RP(e,t,n=!1){let r=e.findIndex(a=>a.route.id===t);return r>=0?e.slice(0,n?r+1:r):e}function IP(e,t,n,r,a,o,i,s,c,l,u,d,f,p){let y=p?ur(p[1])?p[1].error:p[1].data:void 0,m=e.createURL(t.location),v=e.createURL(a),b=n;o&&t.errors?b=RP(n,Object.keys(t.errors)[0],!0):p&&ur(p[1])&&(b=RP(n,p[0]));let w=p?p[1].statusCode:void 0,_=w&&w>=400,x=b.filter((S,E)=>{let{route:O}=S;if(O.lazy)return!0;if(O.loader==null)return!1;if(o)return p0(O,t.loaderData,t.errors);if(BX(t.loaderData,t.matches[E],S))return!0;let M=t.matches[E],N=S;return DP(S,{currentUrl:m,currentParams:M.params,nextUrl:v,nextParams:N.params,...r,actionResult:y,actionStatus:w,defaultShouldRevalidate:_?!1:i||m.pathname+m.search===v.pathname+v.search||m.search!==v.search||zX(M,N)})}),j=[];return l.forEach((S,E)=>{if(o||!n.some(R=>R.route.id===S.routeId)||c.has(E))return;let O=Yo(d,S.path,f);if(!O){j.push({key:E,routeId:S.routeId,path:S.path,matches:null,match:null,controller:null});return}let M=t.fetchers.get(E),N=cu(O,S.path),P=!1;u.has(E)?P=!1:s.has(E)?(s.delete(E),P=!0):M&&M.state!=="idle"&&M.data===void 0?P=i:P=DP(N,{currentUrl:m,currentParams:t.matches[t.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params,...r,actionResult:y,actionStatus:w,defaultShouldRevalidate:_?!1:i}),P&&j.push({key:E,routeId:S.routeId,path:S.path,matches:O,match:N,controller:new AbortController})}),[x,j]}function p0(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&t[e.id]!==void 0,a=n!=null&&n[e.id]!==void 0;return!r&&a?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!a}function BX(e,t,n){let r=!t||n.route.id!==t.route.id,a=!e.hasOwnProperty(n.route.id);return r||a}function zX(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function DP(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function LP(e,t,n,r,a){let o;if(e){let c=r[e];Xe(c,`No route found to patch children into: routeId = ${e}`),c.children||(c.children=[]),o=c.children}else o=n;let i=t.filter(c=>!o.some(l=>$P(c,l))),s=up(i,a,[e||"_","patch",String((o==null?void 0:o.length)||"0")],r);o.push(...s)}function $P(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var a;return(a=t.children)==null?void 0:a.some(o=>$P(n,o))}):!1}async function VX(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let a=n[e.id];Xe(a,"No route found in manifest");let o={};for(let i in r){let s=a[i]!==void 0&&i!=="hasErrorBoundary";sn(!s,`Route "${a.id}" has a static property "${i}" defined but its lazy function is also returning a value for this property. The lazy route property "${i}" will be ignored.`),!s&&!fX.has(i)&&(o[i]=r[i])}Object.assign(a,o),Object.assign(a,{...t(a),lazy:void 0})}async function qX({matches:e}){let t=e.filter(n=>n.shouldLoad);return(await Promise.all(t.map(n=>n.resolve()))).reduce((n,r,a)=>Object.assign(n,{[t[a].route.id]:r}),{})}async function UX(e,t,n,r,a,o,i,s,c,l){let u=o.map(p=>p.route.lazy?VX(p.route,c,s):void 0),d=o.map((p,y)=>{let m=u[y],v=a.some(b=>b.route.id===p.route.id);return{...p,shouldLoad:v,resolve:async b=>(b&&r.method==="GET"&&(p.route.lazy||p.route.loader)&&(v=!0),v?WX(t,r,p,m,b,l):Promise.resolve({type:"data",result:void 0}))}}),f=await e({matches:d,request:r,params:o[0].params,fetcherKey:i,context:l});try{await Promise.all(u)}catch{}return f}async function WX(e,t,n,r,a,o){let i,s,c=l=>{let u,d=new Promise((y,m)=>u=m);s=()=>u(),t.signal.addEventListener("abort",s);let f=y=>typeof l!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${e}" [routeId: ${n.route.id}]`)):l({request:t,params:n.params,context:o},...y!==void 0?[y]:[]),p=(async()=>{try{return{type:"data",result:await(a?a(y=>f(y)):f())}}catch(y){return{type:"error",result:y}}})();return Promise.race([p,d])};try{let l=n.route[e];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(f=>{u=f}),r]);if(u!==void 0)throw u;i=d}else if(await r,l=n.route[e],l)i=await c(l);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw _r(405,{method:t.method,pathname:d,routeId:n.route.id})}else return{type:"data",result:void 0};else if(l)i=await c(l);else{let u=new URL(t.url),d=u.pathname+u.search;throw _r(404,{pathname:d})}}catch(l){return{type:"error",result:l}}finally{s&&t.signal.removeEventListener("abort",s)}return i}async function HX(e){var r,a,o,i;let{result:t,type:n}=e;if(ZP(t)){let s;try{let c=t.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?t.body==null?s=null:s=await t.json():s=await t.text()}catch(c){return{type:"error",error:c}}return n==="error"?{type:"error",error:new mp(t.status,t.statusText,s),statusCode:t.status,headers:t.headers}:{type:"data",data:s,statusCode:t.status,headers:t.headers}}if(n==="error"){if(HP(t)){if(t.data instanceof Error)return{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status};t=new mp(((a=t.init)==null?void 0:a.status)||500,void 0,t.data)}return{type:"error",error:t,statusCode:yp(t)?t.status:void 0}}return HP(t)?{type:"data",data:t.data,statusCode:(o=t.init)==null?void 0:o.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function ZX(e,t,n,r,a){let o=e.headers.get("Location");if(Xe(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!d0.test(o)){let i=r.slice(0,r.findIndex(s=>s.route.id===n)+1);o=f0(new URL(t.url),i,a,o),e.headers.set("Location",o)}return e}function FP(e,t,n){if(d0.test(e)){let r=e,a=r.startsWith("//")?new URL(t.protocol+r):new URL(r),o=zr(a.pathname,n)!=null;if(a.origin===t.origin&&o)return a.pathname+a.search+a.hash}return e}function qs(e,t,n,r){let a=e.createURL(WP(t)).toString(),o={signal:n};if(r&&Vr(r.formMethod)){let{formMethod:i,formEncType:s}=r;o.method=i.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=h0(r.formData):o.body=r.formData}return new Request(a,o)}function h0(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function BP(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function KX(e,t,n,r=!1,a=!1){let o={},i=null,s,c=!1,l={},u=n&&ur(n[1])?n[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let f=d.route.id,p=t[f];if(Xe(!$i(p),"Cannot handle redirect results in processLoaderData"),ur(p)){let y=p.error;if(u!==void 0&&(y=u,u=void 0),i=i||{},a)i[f]=y;else{let m=Li(e,f);i[m.route.id]==null&&(i[m.route.id]=y)}r||(o[f]=kP),c||(c=!0,s=yp(p.error)?p.error.status:500),p.headers&&(l[f]=p.headers)}else o[f]=p.data,p.statusCode&&p.statusCode!==200&&!c&&(s=p.statusCode),p.headers&&(l[f]=p.headers)}),u!==void 0&&n&&(i={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:i,statusCode:s||200,loaderHeaders:l}}function zP(e,t,n,r,a,o){let{loaderData:i,errors:s}=KX(t,n,r);return a.forEach(c=>{let{key:l,match:u,controller:d}=c,f=o[l];if(Xe(f,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(ur(f)){let p=Li(e.matches,u==null?void 0:u.route.id);s&&s[p.route.id]||(s={...s,[p.route.id]:f.error}),e.fetchers.delete(l)}else if($i(f))Xe(!1,"Unhandled fetcher revalidation redirect");else{let p=ei(f.data);e.fetchers.set(l,p)}}),{loaderData:i,errors:s}}function VP(e,t,n,r){let a=Object.entries(t).filter(([,o])=>o!==kP).reduce((o,[i,s])=>(o[i]=s,o),{});for(let o of n){let i=o.route.id;if(!t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&o.route.loader&&(a[i]=e[i]),r&&r.hasOwnProperty(i))break}return a}function qP(e){return e?ur(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Li(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function UP(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function _r(e,{pathname:t,routeId:n,method:r,type:a,message:o}={}){let i="Unknown Server Error",s="Unknown @remix-run/router error";return e===400?(i="Bad Request",r&&t&&n?s=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:a==="invalid-body"&&(s="Unable to encode submission body")):e===403?(i="Forbidden",s=`Route "${n}" does not match URL "${t}"`):e===404?(i="Not Found",s=`No route matches URL "${t}"`):e===405&&(i="Method Not Allowed",r&&t&&n?s=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new mp(e||500,i,new Error(s),!0)}function gp(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,a]=t[n];if($i(a))return{key:r,result:a}}}function WP(e){let t=typeof e=="string"?ro(e):e;return no({...t,hash:""})}function XX(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function GX(e){return ZP(e.result)&&IX.has(e.result.status)}function ur(e){return e.type==="error"}function $i(e){return(e&&e.type)==="redirect"}function HP(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function ZP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function QX(e){return RX.has(e.toUpperCase())}function Vr(e){return AX.has(e.toUpperCase())}function m0(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function cu(e,t){let n=typeof t=="string"?ro(t).search:t.search;if(e[e.length-1].route.index&&m0(n||""))return e[e.length-1];let r=NP(e);return r[r.length-1]}function KP(e){let{formMethod:t,formAction:n,formEncType:r,text:a,formData:o,json:i}=e;if(!(!t||!n||!r)){if(a!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:a};if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:i,text:void 0}}}function y0(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function JX(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function lu(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function YX(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function ei(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function eG(e,t){try{let n=e.sessionStorage.getItem(PP);if(n){let r=JSON.parse(n);for(let[a,o]of Object.entries(r||{}))o&&Array.isArray(o)&&t.set(a,new Set(o||[]))}}catch{}}function tG(e,t){if(t.size>0){let n={};for(let[r,a]of t)n[r]=[...a];try{e.sessionStorage.setItem(PP,JSON.stringify(n))}catch(r){sn(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function nG(){let e,t,n=new Promise((r,a)=>{e=async o=>{r(o);try{await n}catch{}},t=async o=>{a(o);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var Fi=g.createContext(null);Fi.displayName="DataRouter";var uu=g.createContext(null);uu.displayName="DataRouterState";var g0=g.createContext({isTransitioning:!1});g0.displayName="ViewTransition";var XP=g.createContext(new Map);XP.displayName="Fetchers";var rG=g.createContext(null);rG.displayName="Await";var qr=g.createContext(null);qr.displayName="Navigation";var vp=g.createContext(null);vp.displayName="Location";var jr=g.createContext({outlet:null,matches:[],isDataRoute:!1});jr.displayName="Route";var v0=g.createContext(null);v0.displayName="RouteError";function aG(e,{relative:t}={}){Xe(Us(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=g.useContext(qr),{hash:a,pathname:o,search:i}=du(e,{relative:t}),s=o;return n!=="/"&&(s=o==="/"?n:Sa([n,o])),r.createHref({pathname:s,search:i,hash:a})}function Us(){return g.useContext(vp)!=null}function Ea(){return Xe(Us(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(vp).location}var GP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function QP(e){g.useContext(qr).static||g.useLayoutEffect(e)}function Bi(){let{isDataRoute:e}=g.useContext(jr);return e?vG():oG()}function oG(){Xe(Us(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(Fi),{basename:t,navigator:n}=g.useContext(qr),{matches:r}=g.useContext(jr),{pathname:a}=Ea(),o=JSON.stringify(pp(r)),i=g.useRef(!1);return QP(()=>{i.current=!0}),g.useCallback((s,c={})=>{if(sn(i.current,GP),!i.current)return;if(typeof s=="number"){n.go(s);return}let l=hp(s,JSON.parse(o),a,c.relative==="path");e==null&&t!=="/"&&(l.pathname=l.pathname==="/"?t:Sa([t,l.pathname])),(c.replace?n.replace:n.push)(l,c.state,c)},[t,n,o,a,e])}var iG=g.createContext(null);function sG(e){let t=g.useContext(jr).outlet;return t&&g.createElement(iG.Provider,{value:e},t)}function bp(){let{matches:e}=g.useContext(jr),t=e[e.length-1];return t?t.params:{}}function du(e,{relative:t}={}){let{matches:n}=g.useContext(jr),{pathname:r}=Ea(),a=JSON.stringify(pp(n));return g.useMemo(()=>hp(e,JSON.parse(a),r,t==="path"),[e,a,r,t])}function cG(e,t,n,r){Xe(Us(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(qr),{matches:o}=g.useContext(jr),i=o[o.length-1],s=i?i.params:{},c=i?i.pathname:"/",l=i?i.pathnameBase:"/",u=i&&i.route;{let v=u&&u.path||"";ek(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=Ea(),f;f=d;let p=f.pathname||"/",y=p;if(l!=="/"){let v=l.replace(/^\//,"").split("/");y="/"+p.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=Yo(e,{pathname:y});return sn(u||m!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),sn(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),pG(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},s,v.params),pathname:Sa([l,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Sa([l,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r)}function lG(){let e=JP(),t=yp(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=g.createElement(g.Fragment,null,g.createElement("p",null,"\u{1F4BF} Hey developer \u{1F44B}"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:o},"ErrorBoundary")," or"," ",g.createElement("code",{style:o},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),n?g.createElement("pre",{style:a},n):null,i)}var uG=g.createElement(lG,null),dG=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?g.createElement(jr.Provider,{value:this.props.routeContext},g.createElement(v0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function fG({routeContext:e,match:t,children:n}){let r=g.useContext(Fi);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(jr.Provider,{value:e},n)}function pG(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,o=n==null?void 0:n.errors;if(o!=null){let c=a.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id])!==void 0);Xe(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let i=!1,s=-1;if(n)for(let c=0;c<a.length;c++){let l=a[c];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(s=c),l.route.id){let{loaderData:u,errors:d}=n,f=l.route.loader&&!u.hasOwnProperty(l.route.id)&&(!d||d[l.route.id]===void 0);if(l.route.lazy||f){i=!0,s>=0?a=a.slice(0,s+1):a=[a[0]];break}}}return a.reduceRight((c,l,u)=>{let d,f=!1,p=null,y=null;n&&(d=o&&l.route.id?o[l.route.id]:void 0,p=l.route.errorElement||uG,i&&(s<0&&u===0?(ek("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,y=null):s===u&&(f=!0,y=l.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,u+1)),v=()=>{let b;return d?b=p:f?b=y:l.route.Component?b=g.createElement(l.route.Component,null):l.route.element?b=l.route.element:b=c,g.createElement(fG,{match:l,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:b})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?g.createElement(dG,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:v(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):v()},null)}function b0(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hG(e){let t=g.useContext(Fi);return Xe(t,b0(e)),t}function mG(e){let t=g.useContext(uu);return Xe(t,b0(e)),t}function yG(e){let t=g.useContext(jr);return Xe(t,b0(e)),t}function w0(e){let t=yG(e),n=t.matches[t.matches.length-1];return Xe(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function gG(){return w0("useRouteId")}function JP(){var r;let e=g.useContext(v0),t=mG("useRouteError"),n=w0("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function vG(){let{router:e}=hG("useNavigate"),t=w0("useNavigate"),n=g.useRef(!1);return QP(()=>{n.current=!0}),g.useCallback(async(r,a={})=>{sn(n.current,GP),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...a}))},[e,t])}var YP={};function ek(e,t,n){!t&&!YP[e]&&(YP[e]=!0,sn(!1,n))}var tk={};function nk(e,t){!e&&!tk[t]&&(tk[t]=!0,console.warn(t))}function rk(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&sn(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:g.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&sn(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:g.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&sn(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:g.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var bG=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function wG({router:e,flushSync:t}){let[n,r]=g.useState(e.state),[a,o]=g.useState(),[i,s]=g.useState({isTransitioning:!1}),[c,l]=g.useState(),[u,d]=g.useState(),[f,p]=g.useState(),y=g.useRef(new Map),m=g.useCallback((_,{deletedFetchers:x,flushSync:j,viewTransitionOpts:S})=>{x.forEach(O=>y.current.delete(O)),_.fetchers.forEach((O,M)=>{O.data!==void 0&&y.current.set(M,O.data)}),nk(j===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let E=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(nk(S==null||E,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!S||!E){t&&j?t(()=>r(_)):g.startTransition(()=>r(_));return}if(t&&j){t(()=>{u&&(c&&c.resolve(),u.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:S.currentLocation,nextLocation:S.nextLocation})});let O=e.window.document.startViewTransition(()=>{t(()=>r(_))});O.finished.finally(()=>{t(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})})}),t(()=>d(O));return}u?(c&&c.resolve(),u.skipTransition(),p({state:_,currentLocation:S.currentLocation,nextLocation:S.nextLocation})):(o(_),s({isTransitioning:!0,flushSync:!1,currentLocation:S.currentLocation,nextLocation:S.nextLocation}))},[e.window,t,u,c]);g.useLayoutEffect(()=>e.subscribe(m),[e,m]),g.useEffect(()=>{i.isTransitioning&&!i.flushSync&&l(new bG)},[i]),g.useEffect(()=>{if(c&&a&&e.window){let _=a,x=c.promise,j=e.window.document.startViewTransition(async()=>{g.startTransition(()=>r(_)),await x});j.finished.finally(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})}),d(j)}},[a,c,e.window]),g.useEffect(()=>{c&&a&&n.location.key===a.location.key&&c.resolve()},[c,u,n.location,a]),g.useEffect(()=>{!i.isTransitioning&&f&&(o(f.state),s({isTransitioning:!0,flushSync:!1,currentLocation:f.currentLocation,nextLocation:f.nextLocation}),p(void 0))},[i.isTransitioning,f]);let v=g.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:_=>e.navigate(_),push:(_,x,j)=>e.navigate(_,{state:x,preventScrollReset:j==null?void 0:j.preventScrollReset}),replace:(_,x,j)=>e.navigate(_,{replace:!0,state:x,preventScrollReset:j==null?void 0:j.preventScrollReset})}),[e]),b=e.basename||"/",w=g.useMemo(()=>({router:e,navigator:v,static:!1,basename:b}),[e,v,b]);return g.createElement(g.Fragment,null,g.createElement(Fi.Provider,{value:w},g.createElement(uu.Provider,{value:n},g.createElement(XP.Provider,{value:y.current},g.createElement(g0.Provider,{value:i},g.createElement(EG,{basename:b,location:n.location,navigationType:n.historyAction,navigator:v},g.createElement(xG,{routes:e.routes,future:e.future,state:n})))))),null)}var xG=g.memo(_G);function _G({routes:e,future:t,state:n}){return cG(e,void 0,n,t)}function jG({to:e,replace:t,state:n,relative:r}){Xe(Us(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(qr);sn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=g.useContext(jr),{pathname:i}=Ea(),s=Bi(),c=hp(e,pp(o),i,r==="path"),l=JSON.stringify(c);return g.useEffect(()=>{s(JSON.parse(l),{replace:t,state:n,relative:r})},[s,l,r,t,n]),null}function SG(e){return sG(e.context)}function ti(e){Xe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function EG({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:a,static:o=!1}){Xe(!Us(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),s=g.useMemo(()=>({basename:i,navigator:a,static:o,future:{}}),[i,a,o]);typeof n=="string"&&(n=ro(n));let{pathname:c="/",search:l="",hash:u="",state:d=null,key:f="default"}=n,p=g.useMemo(()=>{let y=zr(c,i);return y==null?null:{location:{pathname:y,search:l,hash:u,state:d,key:f},navigationType:r}},[i,c,l,u,d,f,r]);return sn(p!=null,`<Router basename="${i}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:g.createElement(qr.Provider,{value:s},g.createElement(vp.Provider,{children:t,value:p}))}function x0(e,t=[]){let n=[];return g.Children.forEach(e,(r,a)=>{if(!g.isValidElement(r))return;let o=[...t,a];if(r.type===g.Fragment){n.push.apply(n,x0(r.props.children,o));return}Xe(r.type===ti,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xe(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=x0(r.props.children,o)),n.push(i)}),n}var OG=x0,wp="get",xp="application/x-www-form-urlencoded";function _p(e){return e!=null&&typeof e.tagName=="string"}function CG(e){return _p(e)&&e.tagName.toLowerCase()==="button"}function NG(e){return _p(e)&&e.tagName.toLowerCase()==="form"}function MG(e){return _p(e)&&e.tagName.toLowerCase()==="input"}function PG(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function kG(e,t){return e.button===0&&(!t||t==="_self")&&!PG(e)}var jp=null;function AG(){if(jp===null)try{new FormData(document.createElement("form"),0),jp=!1}catch{jp=!0}return jp}var TG=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _0(e){return e!=null&&!TG.has(e)?(sn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${xp}"`),null):e}function RG(e,t){let n,r,a,o,i;if(NG(e)){let s=e.getAttribute("action");r=s?zr(s,t):null,n=e.getAttribute("method")||wp,a=_0(e.getAttribute("enctype"))||xp,o=new FormData(e)}else if(CG(e)||MG(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||s.getAttribute("action");if(r=c?zr(c,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||wp,a=_0(e.getAttribute("formenctype"))||_0(s.getAttribute("enctype"))||xp,o=new FormData(s,e),!AG()){let{name:l,type:u,value:d}=e;if(u==="image"){let f=l?`${l}.`:"";o.append(`${f}x`,"0"),o.append(`${f}y`,"0")}else l&&o.append(l,d)}}else{if(_p(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=wp,r=null,a=xp,i=e}return o&&a==="text/plain"&&(i=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:i}}function j0(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function IG(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module).then(async r=>(await r.__tla,r));return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function DG(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function LG(e,t,n){let r=await Promise.all(e.map(async a=>{let o=t.routes[a.route.id];if(o){let i=await IG(o,n);return i.links?i.links():[]}return[]}));return zG(r.flat(1).filter(DG).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function ak(e,t,n,r,a,o){let i=(c,l)=>n[l]?c.route.id!==n[l].route.id:!0,s=(c,l)=>{var u;return n[l].pathname!==c.pathname||((u=n[l].route.path)==null?void 0:u.endsWith("*"))&&n[l].params["*"]!==c.params["*"]};return o==="assets"?t.filter((c,l)=>i(c,l)||s(c,l)):o==="data"?t.filter((c,l)=>{var d;let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(i(c,l)||s(c,l))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function $G(e,t){return FG(e.map(n=>{let r=t.routes[n.route.id];if(!r)return[];let a=[r.module];return r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function FG(e){return[...new Set(e)]}function BG(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function zG(e,t){let n=new Set;return new Set(t),e.reduce((r,a)=>{let o=JSON.stringify(BG(a));return n.has(o)||(n.add(o),r.push({key:o,link:a})),r},[])}function VG(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function qG(){let e=g.useContext(Fi);return j0(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function UG(){let e=g.useContext(uu);return j0(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var S0=g.createContext(void 0);S0.displayName="FrameworkContext";function ok(){let e=g.useContext(S0);return j0(e,"You must render this element inside a <HydratedRouter> element"),e}function WG(e,t){let n=g.useContext(S0),[r,a]=g.useState(!1),[o,i]=g.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=t,f=g.useRef(null);g.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let m=b=>{b.forEach(w=>{i(w.isIntersecting)})},v=new IntersectionObserver(m,{threshold:.5});return f.current&&v.observe(f.current),()=>{v.disconnect()}}},[e]),g.useEffect(()=>{if(r){let m=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(m)}}},[r]);let p=()=>{a(!0)},y=()=>{a(!1),i(!1)};return n?e!=="intent"?[o,f,{}]:[o,f,{onFocus:fu(s,p),onBlur:fu(c,y),onMouseEnter:fu(l,p),onMouseLeave:fu(u,y),onTouchStart:fu(d,p)}]:[!1,f,{}]}function fu(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function HG({page:e,...t}){let{router:n}=qG(),r=g.useMemo(()=>Yo(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?g.createElement(KG,{page:e,matches:r,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function ZG(e){let{manifest:t,routeModules:n}=ok(),[r,a]=g.useState([]);return g.useEffect(()=>{let o=!1;return LG(e,t,n).then(i=>{o||a(i)}),()=>{o=!0}},[e,t,n]),r}function KG({page:e,matches:t,...n}){let r=Ea(),{manifest:a,routeModules:o}=ok(),{loaderData:i,matches:s}=UG(),c=g.useMemo(()=>ak(e,t,s,a,r,"data"),[e,t,s,a,r]),l=g.useMemo(()=>ak(e,t,s,a,r,"assets"),[e,t,s,a,r]),u=g.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let p=new Set,y=!1;if(t.forEach(v=>{var w;let b=a.routes[v.route.id];!b||!b.hasLoader||(!c.some(_=>_.route.id===v.route.id)&&v.route.id in i&&((w=o[v.route.id])!=null&&w.shouldRevalidate)||b.hasClientLoader?y=!0:p.add(v.route.id))}),p.size===0)return[];let m=VG(e);return y&&p.size>0&&m.searchParams.set("_routes",t.filter(v=>p.has(v.route.id)).map(v=>v.route.id).join(",")),[m.pathname+m.search]},[i,r,a,c,t,e,o]),d=g.useMemo(()=>$G(l,a),[l,a]),f=ZG(l);return g.createElement(g.Fragment,null,u.map(p=>g.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),d.map(p=>g.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),f.map(({key:p,link:y})=>g.createElement("link",{key:p,...y})))}function XG(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var ik=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ik&&(window.__reactRouterVersion="7.0.2")}catch{}function sk(e,t){return AP({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:lX({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||ck(),routes:e,mapRouteProperties:rk,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function GG(e,t){return AP({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:uX({window:t==null?void 0:t.window}),hydrationData:ck(),routes:e,mapRouteProperties:rk,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function ck(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:QG(e.errors)}),e}function QG(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,a]of t)if(a&&a.__type==="RouteErrorResponse")n[r]=new mp(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let o=window[a.__subType];if(typeof o=="function")try{let i=new o(a.message);i.stack="",n[r]=i}catch{}}if(n[r]==null){let o=new Error(a.message);o.stack="",n[r]=o}}else n[r]=a;return n}var lk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,E0=g.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:a,replace:o,state:i,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},f){let{basename:p}=g.useContext(qr),y=typeof c=="string"&&lk.test(c),m,v=!1;if(typeof c=="string"&&y&&(m=c,ik))try{let O=new URL(window.location.href),M=c.startsWith("//")?new URL(O.protocol+c):new URL(c),N=zr(M.pathname,p);M.origin===O.origin&&N!=null?c=N+M.search+M.hash:v=!0}catch{sn(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=aG(c,{relative:r}),[w,_,x]=WG(n,d),j=tQ(c,{replace:o,state:i,target:s,preventScrollReset:l,relative:r,viewTransition:u});function S(O){e&&e(O),O.defaultPrevented||j(O)}let E=g.createElement("a",{...d,...x,href:m||b,onClick:v||a?e:S,ref:XG(f,_),target:s,"data-discover":!y&&t==="render"?"true":void 0});return w&&!y?g.createElement(g.Fragment,null,E,g.createElement(HG,{page:b})):E});E0.displayName="Link";var JG=g.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:a,to:o,viewTransition:i,children:s,...c},l){let u=du(o,{relative:c.relative}),d=Ea(),f=g.useContext(uu),{navigator:p,basename:y}=g.useContext(qr),m=f!=null&&iQ(u)&&i===!0,v=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,b=d.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&y&&(w=zr(w,y)||w);const _=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let x=b===v||!r&&b.startsWith(v)&&b.charAt(_)==="/",j=w!=null&&(w===v||!r&&w.startsWith(v)&&w.charAt(v.length)==="/"),S={isActive:x,isPending:j,isTransitioning:m},E=x?e:void 0,O;typeof n=="function"?O=n(S):O=[n,x?"active":null,j?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(S):a;return g.createElement(E0,{...c,"aria-current":E,className:O,ref:l,style:M,to:o,viewTransition:i},typeof s=="function"?s(S):s)});JG.displayName="NavLink";var YG=g.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:a,state:o,method:i=wp,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...f},p)=>{let y=aQ(),m=oQ(s,{relative:l}),v=i.toLowerCase()==="get"?"get":"post",b=typeof s=="string"&&lk.test(s),w=_=>{if(c&&c(_),_.defaultPrevented)return;_.preventDefault();let x=_.nativeEvent.submitter,j=(x==null?void 0:x.getAttribute("formmethod"))||i;y(x||_.currentTarget,{fetcherKey:t,method:j,navigate:n,replace:a,state:o,relative:l,preventScrollReset:u,viewTransition:d})};return g.createElement("form",{ref:p,method:v,action:m,onSubmit:r?c:w,...f,"data-discover":!b&&e==="render"?"true":void 0})});YG.displayName="Form";function eQ(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function uk(e){let t=g.useContext(Fi);return Xe(t,eQ(e)),t}function tQ(e,{target:t,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:i}={}){let s=Bi(),c=Ea(),l=du(e,{relative:o});return g.useCallback(u=>{if(kG(u,t)){u.preventDefault();let d=n!==void 0?n:no(c)===no(l);s(e,{replace:d,state:r,preventScrollReset:a,relative:o,viewTransition:i})}},[c,s,l,n,r,t,e,a,o,i])}var nQ=0,rQ=()=>`__${String(++nQ)}__`;function aQ(){let{router:e}=uk("useSubmit"),{basename:t}=g.useContext(qr),n=gG();return g.useCallback(async(r,a={})=>{let{action:o,method:i,encType:s,formData:c,body:l}=RG(r,t);if(a.navigate===!1){let u=a.fetcherKey||rQ();await e.fetch(u,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}function oQ(e,{relative:t}={}){let{basename:n}=g.useContext(qr),r=g.useContext(jr);Xe(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...du(e||".",{relative:t})},i=Ea();if(e==null){o.search=i.search;let s=new URLSearchParams(o.search),c=s.getAll("index");if(c.some(l=>l==="")){s.delete("index"),c.filter(u=>u).forEach(u=>s.append("index",u));let l=s.toString();o.search=l?`?${l}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:Sa([n,o.pathname])),no(o)}function iQ(e,t={}){let n=g.useContext(g0);Xe(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=uk("useViewTransitionState"),a=du(e,{relative:t.relative});if(!n.isTransitioning)return!1;let o=zr(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=zr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return fp(a.pathname,i)!=null||fp(a.pathname,o)!=null}new TextEncoder;function sQ(e){return g.createElement(wG,{flushSync:Vl.flushSync,...e})}var cQ=qTe.useId||(()=>{}),lQ=0;Tt=function(e){const[t,n]=g.useState(cQ());return on(()=>{e||n(r=>r??String(lQ++))},[e]),e||(t?`radix-${t}`:"")};var O0="Collapsible",[uQ,dk]=ir(O0),[dQ,C0]=uQ(O0),fk=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:o,onOpenChange:i,...s}=e,[c=!1,l]=Nn({prop:r,defaultProp:a,onChange:i});return h.jsx(dQ,{scope:n,disabled:o,contentId:Tt(),open:c,onOpenToggle:g.useCallback(()=>l(u=>!u),[l]),children:h.jsx(Ae.div,{"data-state":k0(c),"data-disabled":o?"":void 0,...s,ref:t})})});fk.displayName=O0;var pk="CollapsibleTrigger",N0=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=C0(pk,n);return h.jsx(Ae.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":k0(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:ge(e.onClick,a.onOpenToggle)})});N0.displayName=pk;var M0="CollapsibleContent",P0=g.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=C0(M0,e.__scopeCollapsible);return h.jsx(Ir,{present:n||a.open,children:({present:o})=>h.jsx(fQ,{...r,ref:t,present:o})})});P0.displayName=M0;var fQ=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...o}=e,i=C0(M0,n),[s,c]=g.useState(r),l=g.useRef(null),u=xt(t,l),d=g.useRef(0),f=d.current,p=g.useRef(0),y=p.current,m=i.open||s,v=g.useRef(m),b=g.useRef();return g.useEffect(()=>{const w=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(w)},[]),on(()=>{const w=l.current;if(w){b.current=b.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const _=w.getBoundingClientRect();d.current=_.height,p.current=_.width,v.current||(w.style.transitionDuration=b.current.transitionDuration,w.style.animationName=b.current.animationName),c(r)}},[i.open,r]),h.jsx(Ae.div,{"data-state":k0(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!m,...o,ref:u,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...e.style},children:m&&a})});function k0(e){return e?"open":"closed"}var hk=fk,pQ=N0,hQ=P0;const mQ=hk,yQ=N0,gQ=P0,A0=768;function vQ(){const[e,t]=g.useState(void 0);return g.useEffect(()=>{const n=window.matchMedia(`(max-width: ${A0-1}px)`),r=()=>{t(window.innerWidth<A0)};return n.addEventListener("change",r),t(window.innerWidth<A0),()=>n.removeEventListener("change",r)},[]),!!e}let pu;pu=Ja("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ut=g.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...a},o)=>{const i=r?Xo:"button";return h.jsx(i,{className:K(pu({variant:t,size:n,className:e})),ref:o,...a})}),ut.displayName="Button";const Mn=g.forwardRef(({className:e,type:t,...n},r)=>h.jsx("input",{type:t,className:K("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));Mn.displayName="Input";var bQ="Separator",mk="horizontal",wQ=["horizontal","vertical"],yk=g.forwardRef((e,t)=>{const{decorative:n,orientation:r=mk,...a}=e,o=xQ(r)?r:mk,i=n?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return h.jsx(Ae.div,{"data-orientation":o,...i,...a,ref:t})});yk.displayName=bQ;function xQ(e){return wQ.includes(e)}Mv=yk,Ls=g.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},a)=>h.jsx(Mv,{ref:a,decorative:n,orientation:t,className:K("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r})),Ls.displayName=Mv.displayName;var T0="focusScope.autoFocusOnMount",R0="focusScope.autoFocusOnUnmount",gk={bubbles:!1,cancelable:!0},_Q="FocusScope",Sp=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=sr(a),u=sr(o),d=g.useRef(null),f=xt(t,m=>c(m)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let m=function(_){if(p.paused||!s)return;const x=_.target;s.contains(x)?d.current=x:ni(d.current,{select:!0})},v=function(_){if(p.paused||!s)return;const x=_.relatedTarget;x!==null&&(s.contains(x)||ni(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const x of _)x.removedNodes.length>0&&ni(s)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,p.paused]),g.useEffect(()=>{if(s){wk.add(p);const m=document.activeElement;if(!s.contains(m)){const v=new CustomEvent(T0,gk);s.addEventListener(T0,l),s.dispatchEvent(v),v.defaultPrevented||(jQ(NQ(vk(s)),{select:!0}),document.activeElement===m&&ni(s))}return()=>{s.removeEventListener(T0,l),setTimeout(()=>{const v=new CustomEvent(R0,gk);s.addEventListener(R0,u),s.dispatchEvent(v),v.defaultPrevented||ni(m??document.body,{select:!0}),s.removeEventListener(R0,u),wk.remove(p)},0)}}},[s,l,u,p]);const y=g.useCallback(m=>{if(!n&&!r||p.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,b=document.activeElement;if(v&&b){const w=m.currentTarget,[_,x]=SQ(w);_&&x?!m.shiftKey&&b===x?(m.preventDefault(),n&&ni(_,{select:!0})):m.shiftKey&&b===_&&(m.preventDefault(),n&&ni(x,{select:!0})):b===w&&m.preventDefault()}},[n,r,p.paused]);return h.jsx(Ae.div,{tabIndex:-1,...i,ref:f,onKeyDown:y})});Sp.displayName=_Q;function jQ(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(ni(r,{select:t}),document.activeElement!==n)return}function SQ(e){const t=vk(e),n=bk(t,e),r=bk(t.reverse(),e);return[n,r]}function vk(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function bk(e,t){for(const n of e)if(!EQ(n,{upTo:t}))return n}function EQ(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function OQ(e){return e instanceof HTMLInputElement&&"select"in e}function ni(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&OQ(e)&&t&&e.select()}}var wk=CQ();function CQ(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=xk(e,t),e.unshift(t)},remove(t){var n;e=xk(e,t),(n=e[0])==null||n.resume()}}}function xk(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function NQ(e){return e.filter(t=>t.tagName!=="A")}var I0=0;nu=function(){g.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??_k()),document.body.insertAdjacentElement("beforeend",e[1]??_k()),I0++,()=>{I0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),I0--}},[])};function _k(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}wn=function(){return wn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},wn.apply(this,arguments)},op=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},Wv=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};var Ep="right-scroll-bar-position",Op="width-before-scroll-bar",MQ="with-scroll-bars-hidden",PQ="--removed-body-scroll-bar-size";function D0(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function kQ(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var AQ=typeof window<"u"?g.useLayoutEffect:g.useEffect,jk=new WeakMap;function TQ(e,t){var n=kQ(null,function(r){return e.forEach(function(a){return D0(a,r)})});return AQ(function(){var r=jk.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||D0(s,null)}),o.forEach(function(s){a.has(s)||D0(s,i)})}jk.set(n,e)},[e]),n}function RQ(e){return e}function IQ(e,t){t===void 0&&(t=RQ);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var i=t(o,r);return n.push(i),function(){n=n.filter(function(s){return s!==i})}},assignSyncMedium:function(o){for(r=!0;n.length;){var i=n;n=[],i.forEach(o)}n={push:function(s){return o(s)},filter:function(){return n}}},assignMedium:function(o){r=!0;var i=[];if(n.length){var s=n;n=[],s.forEach(o),i=n}var c=function(){var u=i;i=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){i.push(u),l()},filter:function(u){return i=i.filter(u),n}}}};return a}qv=function(e){e===void 0&&(e={});var t=IQ(null);return t.options=wn({async:!0,ssr:!1},e),t};var Sk=function(e){var t=e.sideCar,n=op(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,wn({},n))};Sk.isSideCarExport=!0,Hv=function(e,t){return e.useMedium(t),Sk};var Ek=qv(),L0=function(){},Cp=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:L0,onWheelCapture:L0,onTouchMoveCapture:L0}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,p=e.noIsolation,y=e.inert,m=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,_=op(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=f,j=TQ([n,t]),S=wn(wn({},_),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:Ek,removeScrollBar:l,shards:d,noIsolation:p,inert:y,setCallbacks:o,allowPinchZoom:!!m,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),wn(wn({},S),{ref:j})):g.createElement(b,wn({},S,{className:c,ref:j}),s))});Cp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Cp.classNames={fullWidth:Op,zeroRight:Ep},Uv=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function DQ(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Uv();return t&&e.setAttribute("nonce",t),e}function LQ(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function $Q(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}let Ok,Ck,Nk,Np,Mk,Pk,kk,zi,Ak,$0,Tk,Rk,Mp;if(Ok=function(){var e=0,t=null;return{add:function(n){e==0&&(t=DQ())&&(LQ(t,n),$Q(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Ck=function(){var e=Ok();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},ip=function(){var e=Ck(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},Nk={left:0,top:0,right:0,gap:0},Np=function(e){return parseInt(e||"",10)||0},Mk=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[Np(n),Np(r),Np(a)]},Pk=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Nk;var t=Mk(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},kk=ip(),zi="data-scroll-locked",Ak=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(MQ,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(zi,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ep,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Op,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Ep," .").concat(Ep,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Op," .").concat(Op,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(zi,`] {
    `).concat(PQ,": ").concat(s,`px;
  }
`)},$0=function(){var e=parseInt(document.body.getAttribute(zi)||"0",10);return isFinite(e)?e:0},Tk=function(){g.useEffect(function(){return document.body.setAttribute(zi,($0()+1).toString()),function(){var e=$0()-1;e<=0?document.body.removeAttribute(zi):document.body.setAttribute(zi,e.toString())}},[])},Rk=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;Tk();var o=g.useMemo(function(){return Pk(a)},[a]);return g.createElement(kk,{styles:Ak(o,!t,a,n?"":"!important")})},Mp=!1,typeof window<"u")try{var Pp=Object.defineProperty({},"passive",{get:function(){return Mp=!0,!0}});window.addEventListener("test",Pp,Pp),window.removeEventListener("test",Pp,Pp)}catch{Mp=!1}var Ws=Mp?{passive:!1}:!1,FQ=function(e){return e.tagName==="TEXTAREA"},Ik=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!FQ(e)&&n[t]==="visible")},BQ=function(e){return Ik(e,"overflowY")},zQ=function(e){return Ik(e,"overflowX")},Dk=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=Lk(e,r);if(a){var o=$k(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},VQ=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},qQ=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Lk=function(e,t){return e==="v"?BQ(t):zQ(t)},$k=function(e,t){return e==="v"?VQ(t):qQ(t)},UQ=function(e,t){return e==="h"&&t==="rtl"?-1:1},WQ=function(e,t,n,r,a){var o=UQ(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,f=0;do{var p=$k(e,s),y=p[0],m=p[1],v=p[2],b=m-v-o*y;(y||b)&&Lk(e,s)&&(d+=b,f+=y),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(f)<1||!a))&&(l=!0),l},kp=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Fk=function(e){return[e.deltaX,e.deltaY]},Bk=function(e){return e&&"current"in e?e.current:e},HQ=function(e,t){return e[0]===t[0]&&e[1]===t[1]},ZQ=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},KQ=0,Hs=[];function XQ(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(KQ++)[0],o=g.useState(ip)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=Wv([e.lockRef.current],(e.shards||[]).map(Bk),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var b=kp(m),w=n.current,_="deltaX"in m?m.deltaX:w[0]-b[0],x="deltaY"in m?m.deltaY:w[1]-b[1],j,S=m.target,E=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in m&&E==="h"&&S.type==="range")return!1;var O=Dk(E,S);if(!O)return!0;if(O?j=E:(j=E==="v"?"h":"v",O=Dk(E,S)),!O)return!1;if(!r.current&&"changedTouches"in m&&(_||x)&&(r.current=j),!j)return!0;var M=r.current||j;return WQ(M,v,m,M==="h"?_:x,!0)},[]),c=g.useCallback(function(m){var v=m;if(!(!Hs.length||Hs[Hs.length-1]!==o)){var b="deltaY"in v?Fk(v):kp(v),w=t.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&HQ(j.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(Bk).filter(Boolean).filter(function(j){return j.contains(v.target)}),x=_.length>0?s(v,_[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(m,v,b,w){var _={name:m,delta:v,target:b,should:w,shadowParent:GQ(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(x){return x!==_})},1)},[]),u=g.useCallback(function(m){n.current=kp(m),r.current=void 0},[]),d=g.useCallback(function(m){l(m.type,Fk(m),m.target,s(m,e.lockRef.current))},[]),f=g.useCallback(function(m){l(m.type,kp(m),m.target,s(m,e.lockRef.current))},[]);g.useEffect(function(){return Hs.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Ws),document.addEventListener("touchmove",c,Ws),document.addEventListener("touchstart",u,Ws),function(){Hs=Hs.filter(function(m){return m!==o}),document.removeEventListener("wheel",c,Ws),document.removeEventListener("touchmove",c,Ws),document.removeEventListener("touchstart",u,Ws)}},[]);var p=e.removeScrollBar,y=e.inert;return g.createElement(g.Fragment,null,y?g.createElement(o,{styles:ZQ(a)}):null,p?g.createElement(Rk,{gapMode:e.gapMode}):null)}function GQ(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const QQ=Hv(Ek,XQ);var Ap=g.forwardRef(function(e,t){return g.createElement(Cp,wn({},e,{ref:t,sideCar:QQ}))});Ap.classNames=Cp.classNames;let zk,Vi,hu,mu,Tp,F0,Vk,qk,Rp,B0,z0,Uk,Sr,V0;zk=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Vi=new WeakMap,hu=new WeakMap,mu={},Tp=0,F0=function(e){return e&&(e.host||F0(e.parentNode))},Vk=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=F0(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},qk=function(e,t,n,r){var a=Vk(t,Array.isArray(e)?e:[e]);mu[n]||(mu[n]=new WeakMap);var o=mu[n],i=[],s=new Set,c=new Set(a),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};a.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(f){if(s.has(f))u(f);else try{var p=f.getAttribute(r),y=p!==null&&p!=="false",m=(Vi.get(f)||0)+1,v=(o.get(f)||0)+1;Vi.set(f,m),o.set(f,v),i.push(f),m===1&&y&&hu.set(f,!0),v===1&&f.setAttribute(n,"true"),y||f.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",f,b)}})};return u(t),s.clear(),Tp++,function(){i.forEach(function(d){var f=Vi.get(d)-1,p=o.get(d)-1;Vi.set(d,f),o.set(d,p),f||(hu.has(d)||d.removeAttribute(r),hu.delete(d)),p||d.removeAttribute(n)}),Tp--,Tp||(Vi=new WeakMap,Vi=new WeakMap,hu=new WeakMap,mu={})}},tu=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=zk(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),qk(r,a,n,"aria-hidden")):function(){return null}},Rp="Dialog",[B0,z0]=ir(Rp),[Uk,Sr]=B0(Rp),V0=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!0}=e,s=g.useRef(null),c=g.useRef(null),[l=!1,u]=Nn({prop:r,defaultProp:a,onChange:o});return h.jsx(Uk,{scope:t,triggerRef:s,contentRef:c,contentId:Tt(),titleId:Tt(),descriptionId:Tt(),open:l,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:i,children:n})},V0.displayName=Rp;var Wk="DialogTrigger",Hk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Sr(Wk,n),o=xt(t,a.triggerRef);return h.jsx(Ae.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":W0(a.open),...r,ref:o,onClick:ge(e.onClick,a.onOpenToggle)})});Hk.displayName=Wk;var q0="DialogPortal",[JQ,Zk]=B0(q0,{forceMount:void 0}),Kk=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,o=Sr(q0,t);return h.jsx(JQ,{scope:t,forceMount:n,children:g.Children.map(r,i=>h.jsx(Ir,{present:n||o.open,children:h.jsx(nv,{asChild:!0,container:a,children:i})}))})};Kk.displayName=q0;var Ip="DialogOverlay",Xk=g.forwardRef((e,t)=>{const n=Zk(Ip,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=Sr(Ip,e.__scopeDialog);return o.modal?h.jsx(Ir,{present:r||o.open,children:h.jsx(YQ,{...a,ref:t})}):null});Xk.displayName=Ip;var YQ=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Sr(Ip,n);return h.jsx(Ap,{as:Xo,allowPinchZoom:!0,shards:[a.contentRef],children:h.jsx(Ae.div,{"data-state":W0(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),qi="DialogContent",Gk=g.forwardRef((e,t)=>{const n=Zk(qi,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=Sr(qi,e.__scopeDialog);return h.jsx(Ir,{present:r||o.open,children:o.modal?h.jsx(eJ,{...a,ref:t}):h.jsx(tJ,{...a,ref:t})})});Gk.displayName=qi;var eJ=g.forwardRef((e,t)=>{const n=Sr(qi,e.__scopeDialog),r=g.useRef(null),a=xt(t,n.contentRef,r);return g.useEffect(()=>{const o=r.current;if(o)return tu(o)},[]),h.jsx(Qk,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(e.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ge(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,s=i.button===0&&i.ctrlKey===!0;(i.button===2||s)&&o.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault())})}),tJ=g.forwardRef((e,t)=>{const n=Sr(qi,e.__scopeDialog),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(Qk,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),Qk=g.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,...i}=e,s=Sr(qi,n),c=g.useRef(null),l=xt(t,c);return nu(),h.jsxs(h.Fragment,{children:[h.jsx(Sp,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(tv,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":W0(s.open),...i,ref:l,onDismiss:()=>s.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(aA,{titleId:s.titleId}),h.jsx(iA,{contentRef:c,descriptionId:s.descriptionId})]})]})}),U0="DialogTitle",Jk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Sr(U0,n);return h.jsx(Ae.h2,{id:a.titleId,...r,ref:t})});Jk.displayName=U0;var Yk="DialogDescription",eA=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Sr(Yk,n);return h.jsx(Ae.p,{id:a.descriptionId,...r,ref:t})});eA.displayName=Yk;var tA="DialogClose",nA=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Sr(tA,n);return h.jsx(Ae.button,{type:"button",...r,ref:t,onClick:ge(e.onClick,()=>a.onOpenChange(!1))})});nA.displayName=tA;function W0(e){return e?"open":"closed"}let H0,rA,Z0,aA,oA,iA,sA;H0="DialogTitleWarning",[rA,Z0]=UTe(H0,{contentName:qi,titleName:U0,docsSlug:"dialog"}),aA=({titleId:e})=>{const t=Z0(H0),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return g.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},oA="DialogDescriptionWarning",iA=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Z0(oA).contentName}}.`;return g.useEffect(()=>{var a;const r=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},Zl=V0,sA=Hk,Gl=Kk,Ii=Xk,Di=Gk,Is=Jk,Ds=eA,Ql=nA;const nJ=Zl,rJ=Gl,cA=g.forwardRef(({className:e,...t},n)=>h.jsx(Ii,{className:K("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));cA.displayName=Ii.displayName;const aJ=Ja("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),lA=g.forwardRef(({side:e="right",className:t,children:n,...r},a)=>h.jsxs(rJ,{children:[h.jsx(cA,{}),h.jsxs(Di,{ref:a,className:K(aJ({side:e}),t),...r,children:[n,h.jsxs(Ql,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[h.jsx(fe,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));lA.displayName=Di.displayName;const oJ=g.forwardRef(({className:e,...t},n)=>h.jsx(Is,{ref:n,className:K("text-lg font-semibold text-foreground",e),...t}));oJ.displayName=Is.displayName;const iJ=g.forwardRef(({className:e,...t},n)=>h.jsx(Ds,{ref:n,className:K("text-sm text-muted-foreground",e),...t}));iJ.displayName=Ds.displayName;function uA({className:e,...t}){return h.jsx("div",{className:K("animate-pulse rounded-md bg-muted",e),...t})}const sJ=["top","right","bottom","left"],Oa=Math.min,dr=Math.max,Dp=Math.round,Lp=Math.floor,ri=e=>({x:e,y:e}),cJ={left:"right",right:"left",bottom:"top",top:"bottom"},lJ={start:"end",end:"start"};function K0(e,t,n){return dr(e,Oa(t,n))}function ao(e,t){return typeof e=="function"?e(t):e}function oo(e){return e.split("-")[0]}function Zs(e){return e.split("-")[1]}function X0(e){return e==="x"?"y":"x"}function G0(e){return e==="y"?"height":"width"}function ai(e){return["top","bottom"].includes(oo(e))?"y":"x"}function Q0(e){return X0(ai(e))}function uJ(e,t,n){n===void 0&&(n=!1);const r=Zs(e),a=Q0(e),o=G0(a);let i=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=$p(i)),[i,$p(i)]}function dJ(e){const t=$p(e);return[J0(e),t,J0(t)]}function J0(e){return e.replace(/start|end/g,t=>lJ[t])}function fJ(e,t,n){const r=["left","right"],a=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?o:i;default:return[]}}function pJ(e,t,n,r){const a=Zs(e);let o=fJ(oo(e),n==="start",r);return a&&(o=o.map(i=>i+"-"+a),t&&(o=o.concat(o.map(J0)))),o}function $p(e){return e.replace(/left|right|bottom|top/g,t=>cJ[t])}function hJ(e){return{top:0,right:0,bottom:0,left:0,...e}}function dA(e){return typeof e!="number"?hJ(e):{top:e,right:e,bottom:e,left:e}}function Fp(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function fA(e,t,n){let{reference:r,floating:a}=e;const o=ai(t),i=Q0(t),s=G0(i),c=oo(t),l=o==="y",u=r.x+r.width/2-a.width/2,d=r.y+r.height/2-a.height/2,f=r[s]/2-a[s]/2;let p;switch(c){case"top":p={x:u,y:r.y-a.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-a.width,y:d};break;default:p={x:r.x,y:r.y}}switch(Zs(t)){case"start":p[i]-=f*(n&&l?-1:1);break;case"end":p[i]+=f*(n&&l?-1:1);break}return p}const mJ=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:i}=n,s=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let l=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:d}=fA(l,r,c),f=r,p={},y=0;for(let m=0;m<s.length;m++){const{name:v,fn:b}=s[m],{x:w,y:_,data:x,reset:j}=await b({x:u,y:d,initialPlacement:r,placement:f,strategy:a,middlewareData:p,rects:l,platform:i,elements:{reference:e,floating:t}});u=w??u,d=_??d,p={...p,[v]:{...p[v],...x}},j&&y<=50&&(y++,typeof j=="object"&&(j.placement&&(f=j.placement),j.rects&&(l=j.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):j.rects),{x:u,y:d}=fA(l,f,c)),m=-1)}return{x:u,y:d,placement:f,strategy:a,middlewareData:p}};async function yu(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:o,rects:i,elements:s,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=ao(t,e),y=dA(p),m=s[f?d==="floating"?"reference":"floating":d],v=Fp(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(m)))==null||n?m:m.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),b=d==="floating"?{x:r,y:a,width:i.floating.width,height:i.floating.height}:i.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),_=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},x=Fp(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:w,strategy:c}):b);return{top:(v.top-x.top+y.top)/_.y,bottom:(x.bottom-v.bottom+y.bottom)/_.y,left:(v.left-x.left+y.left)/_.x,right:(x.right-v.right+y.right)/_.x}}const yJ=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:o,platform:i,elements:s,middlewareData:c}=t,{element:l,padding:u=0}=ao(e,t)||{};if(l==null)return{};const d=dA(u),f={x:n,y:r},p=Q0(a),y=G0(p),m=await i.getDimensions(l),v=p==="y",b=v?"top":"left",w=v?"bottom":"right",_=v?"clientHeight":"clientWidth",x=o.reference[y]+o.reference[p]-f[p]-o.floating[y],j=f[p]-o.reference[p],S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l));let E=S?S[_]:0;(!E||!await(i.isElement==null?void 0:i.isElement(S)))&&(E=s.floating[_]||o.floating[y]);const O=x/2-j/2,M=E/2-m[y]/2-1,N=Oa(d[b],M),P=Oa(d[w],M),R=N,k=E-m[y]-P,C=E/2-m[y]/2+O,T=K0(R,C,k),A=!c.arrow&&Zs(a)!=null&&C!==T&&o.reference[y]/2-(C<R?N:P)-m[y]/2<0,I=A?C<R?C-R:C-k:0;return{[p]:f[p]+I,data:{[p]:T,centerOffset:C-T-I,...A&&{alignmentOffset:I}},reset:A}}}),gJ=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:i,initialPlacement:s,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:m=!0,...v}=ao(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const b=oo(a),w=ai(s),_=oo(s)===s,x=await(c.isRTL==null?void 0:c.isRTL(l.floating)),j=f||(_||!m?[$p(s)]:dJ(s)),S=y!=="none";!f&&S&&j.push(...pJ(s,m,y,x));const E=[s,...j],O=await yu(t,v),M=[];let N=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&M.push(O[b]),d){const C=uJ(a,i,x);M.push(O[C[0]],O[C[1]])}if(N=[...N,{placement:a,overflows:M}],!M.every(C=>C<=0)){var P,R;const C=(((P=o.flip)==null?void 0:P.index)||0)+1,T=E[C];if(T)return{data:{index:C,overflows:N},reset:{placement:T}};let A=(R=N.filter(I=>I.overflows[0]<=0).sort((I,L)=>I.overflows[1]-L.overflows[1])[0])==null?void 0:R.placement;if(!A)switch(p){case"bestFit":{var k;const I=(k=N.filter(L=>{if(S){const D=ai(L.placement);return D===w||D==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(D=>D>0).reduce((D,B)=>D+B,0)]).sort((L,D)=>L[1]-D[1])[0])==null?void 0:k[0];I&&(A=I);break}case"initialPlacement":A=s;break}if(a!==A)return{reset:{placement:A}}}return{}}}};function pA(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function hA(e){return sJ.some(t=>e[t]>=0)}const vJ=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=ao(e,t);switch(r){case"referenceHidden":{const o=await yu(t,{...a,elementContext:"reference"}),i=pA(o,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:hA(i)}}}case"escaped":{const o=await yu(t,{...a,altBoundary:!0}),i=pA(o,n.floating);return{data:{escapedOffsets:i,escaped:hA(i)}}}default:return{}}}}};async function bJ(e,t){const{placement:n,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),i=oo(n),s=Zs(n),c=ai(n)==="y",l=["left","top"].includes(i)?-1:1,u=o&&c?-1:1,d=ao(t,e);let{mainAxis:f,crossAxis:p,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof y=="number"&&(p=s==="end"?y*-1:y),c?{x:p*u,y:f*l}:{x:f*l,y:p*u}}const wJ=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:o,placement:i,middlewareData:s}=t,c=await bJ(t,e);return i===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:a+c.x,y:o+c.y,data:{...c,placement:i}}}}},xJ=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:s={fn:v=>{let{x:b,y:w}=v;return{x:b,y:w}}},...c}=ao(e,t),l={x:n,y:r},u=await yu(t,c),d=ai(oo(a)),f=X0(d);let p=l[f],y=l[d];if(o){const v=f==="y"?"top":"left",b=f==="y"?"bottom":"right",w=p+u[v],_=p-u[b];p=K0(w,p,_)}if(i){const v=d==="y"?"top":"left",b=d==="y"?"bottom":"right",w=y+u[v],_=y-u[b];y=K0(w,y,_)}const m=s.fn({...t,[f]:p,[d]:y});return{...m,data:{x:m.x-n,y:m.y-r}}}}},_J=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:o,middlewareData:i}=t,{offset:s=0,mainAxis:c=!0,crossAxis:l=!0}=ao(e,t),u={x:n,y:r},d=ai(a),f=X0(d);let p=u[f],y=u[d];const m=ao(s,t),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(c){const _=f==="y"?"height":"width",x=o.reference[f]-o.floating[_]+v.mainAxis,j=o.reference[f]+o.reference[_]-v.mainAxis;p<x?p=x:p>j&&(p=j)}if(l){var b,w;const _=f==="y"?"width":"height",x=["top","left"].includes(oo(a)),j=o.reference[d]-o.floating[_]+(x&&((b=i.offset)==null?void 0:b[d])||0)+(x?0:v.crossAxis),S=o.reference[d]+o.reference[_]+(x?0:((w=i.offset)==null?void 0:w[d])||0)-(x?v.crossAxis:0);y<j?y=j:y>S&&(y=S)}return{[f]:p,[d]:y}}}},jJ=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:a,elements:o}=t,{apply:i=()=>{},...s}=ao(e,t),c=await yu(t,s),l=oo(n),u=Zs(n),d=ai(n)==="y",{width:f,height:p}=r.floating;let y,m;l==="top"||l==="bottom"?(y=l,m=u===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(m=l,y=u==="end"?"top":"bottom");const v=p-c.top-c.bottom,b=f-c.left-c.right,w=Oa(p-c[y],v),_=Oa(f-c[m],b),x=!t.middlewareData.shift;let j=w,S=_;if(d?S=u||x?Oa(_,b):b:j=u||x?Oa(w,v):v,x&&!u){const O=dr(c.left,0),M=dr(c.right,0),N=dr(c.top,0),P=dr(c.bottom,0);d?S=f-2*(O!==0||M!==0?O+M:dr(c.left,c.right)):j=p-2*(N!==0||P!==0?N+P:dr(c.top,c.bottom))}await i({...t,availableWidth:S,availableHeight:j});const E=await a.getDimensions(o.floating);return f!==E.width||p!==E.height?{reset:{rects:!0}}:{}}}};function Ks(e){return mA(e)?(e.nodeName||"").toLowerCase():"#document"}function fr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function io(e){var t;return(t=(mA(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function mA(e){return e instanceof Node||e instanceof fr(e).Node}function Ur(e){return e instanceof Element||e instanceof fr(e).Element}function Ca(e){return e instanceof HTMLElement||e instanceof fr(e).HTMLElement}function yA(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof fr(e).ShadowRoot}function gu(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Wr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function SJ(e){return["table","td","th"].includes(Ks(e))}function Bp(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Y0(e){const t=eb(),n=Ur(e)?Wr(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function EJ(e){let t=oi(e);for(;Ca(t)&&!Xs(t);){if(Y0(t))return t;if(Bp(t))return null;t=oi(t)}return null}function eb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Xs(e){return["html","body","#document"].includes(Ks(e))}function Wr(e){return fr(e).getComputedStyle(e)}function zp(e){return Ur(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function oi(e){if(Ks(e)==="html")return e;const t=e.assignedSlot||e.parentNode||yA(e)&&e.host||io(e);return yA(t)?t.host:t}function gA(e){const t=oi(e);return Xs(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ca(t)&&gu(t)?t:gA(t)}function vu(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=gA(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),i=fr(a);if(o){const s=tb(i);return t.concat(i,i.visualViewport||[],gu(a)?a:[],s&&n?vu(s):[])}return t.concat(a,vu(a,[],n))}function tb(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function vA(e){const t=Wr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=Ca(e),o=a?e.offsetWidth:n,i=a?e.offsetHeight:r,s=Dp(n)!==o||Dp(r)!==i;return s&&(n=o,r=i),{width:n,height:r,$:s}}function nb(e){return Ur(e)?e:e.contextElement}function Gs(e){const t=nb(e);if(!Ca(t))return ri(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=vA(t);let i=(o?Dp(n.width):n.width)/r,s=(o?Dp(n.height):n.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const OJ=ri(0);function bA(e){const t=fr(e);return!eb()||!t.visualViewport?OJ:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function CJ(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==fr(e)?!1:t}function Ui(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=nb(e);let i=ri(1);t&&(r?Ur(r)&&(i=Gs(r)):i=Gs(e));const s=CJ(o,n,r)?bA(o):ri(0);let c=(a.left+s.x)/i.x,l=(a.top+s.y)/i.y,u=a.width/i.x,d=a.height/i.y;if(o){const f=fr(o),p=r&&Ur(r)?fr(r):r;let y=f,m=tb(y);for(;m&&r&&p!==y;){const v=Gs(m),b=m.getBoundingClientRect(),w=Wr(m),_=b.left+(m.clientLeft+parseFloat(w.paddingLeft))*v.x,x=b.top+(m.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,l*=v.y,u*=v.x,d*=v.y,c+=_,l+=x,y=fr(m),m=tb(y)}}return Fp({width:u,height:d,x:c,y:l})}function NJ(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const o=a==="fixed",i=io(r),s=t?Bp(t.floating):!1;if(r===i||s&&o)return n;let c={scrollLeft:0,scrollTop:0},l=ri(1);const u=ri(0),d=Ca(r);if((d||!d&&!o)&&((Ks(r)!=="body"||gu(i))&&(c=zp(r)),Ca(r))){const f=Ui(r);l=Gs(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function MJ(e){return Array.from(e.getClientRects())}function wA(e){return Ui(io(e)).left+zp(e).scrollLeft}function PJ(e){const t=io(e),n=zp(e),r=e.ownerDocument.body,a=dr(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=dr(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+wA(e);const s=-n.scrollTop;return Wr(r).direction==="rtl"&&(i+=dr(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:i,y:s}}function kJ(e,t){const n=fr(e),r=io(e),a=n.visualViewport;let o=r.clientWidth,i=r.clientHeight,s=0,c=0;if(a){o=a.width,i=a.height;const l=eb();(!l||l&&t==="fixed")&&(s=a.offsetLeft,c=a.offsetTop)}return{width:o,height:i,x:s,y:c}}function AJ(e,t){const n=Ui(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,o=Ca(e)?Gs(e):ri(1),i=e.clientWidth*o.x,s=e.clientHeight*o.y,c=a*o.x,l=r*o.y;return{width:i,height:s,x:c,y:l}}function xA(e,t,n){let r;if(t==="viewport")r=kJ(e,n);else if(t==="document")r=PJ(io(e));else if(Ur(t))r=AJ(t,n);else{const a=bA(e);r={...t,x:t.x-a.x,y:t.y-a.y}}return Fp(r)}function _A(e,t){const n=oi(e);return n===t||!Ur(n)||Xs(n)?!1:Wr(n).position==="fixed"||_A(n,t)}function TJ(e,t){const n=t.get(e);if(n)return n;let r=vu(e,[],!1).filter(s=>Ur(s)&&Ks(s)!=="body"),a=null;const o=Wr(e).position==="fixed";let i=o?oi(e):e;for(;Ur(i)&&!Xs(i);){const s=Wr(i),c=Y0(i);!c&&s.position==="fixed"&&(a=null),(o?!c&&!a:!c&&s.position==="static"&&a&&["absolute","fixed"].includes(a.position)||gu(i)&&!c&&_A(e,i))?r=r.filter(l=>l!==i):a=s,i=oi(i)}return t.set(e,r),r}function RJ(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const o=[...n==="clippingAncestors"?Bp(t)?[]:TJ(t,this._c):[].concat(n),r],i=o[0],s=o.reduce((c,l)=>{const u=xA(t,l,a);return c.top=dr(u.top,c.top),c.right=Oa(u.right,c.right),c.bottom=Oa(u.bottom,c.bottom),c.left=dr(u.left,c.left),c},xA(t,i,a));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function IJ(e){const{width:t,height:n}=vA(e);return{width:t,height:n}}function DJ(e,t,n){const r=Ca(t),a=io(t),o=n==="fixed",i=Ui(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const c=ri(0);if(r||!r&&!o)if((Ks(t)!=="body"||gu(a))&&(s=zp(t)),r){const d=Ui(t,!0,o,t);c.x=d.x+t.clientLeft,c.y=d.y+t.clientTop}else a&&(c.x=wA(a));const l=i.left+s.scrollLeft-c.x,u=i.top+s.scrollTop-c.y;return{x:l,y:u,width:i.width,height:i.height}}function rb(e){return Wr(e).position==="static"}function jA(e,t){return!Ca(e)||Wr(e).position==="fixed"?null:t?t(e):e.offsetParent}function SA(e,t){const n=fr(e);if(Bp(e))return n;if(!Ca(e)){let a=oi(e);for(;a&&!Xs(a);){if(Ur(a)&&!rb(a))return a;a=oi(a)}return n}let r=jA(e,t);for(;r&&SJ(r)&&rb(r);)r=jA(r,t);return r&&Xs(r)&&rb(r)&&!Y0(r)?n:r||EJ(e)||n}const LJ=async function(e){const t=this.getOffsetParent||SA,n=this.getDimensions,r=await n(e.floating);return{reference:DJ(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function $J(e){return Wr(e).direction==="rtl"}const FJ={convertOffsetParentRelativeRectToViewportRelativeRect:NJ,getDocumentElement:io,getClippingRect:RJ,getOffsetParent:SA,getElementRects:LJ,getClientRects:MJ,getDimensions:IJ,getScale:Gs,isElement:Ur,isRTL:$J};function BJ(e,t){let n=null,r;const a=io(e);function o(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),o();const{left:l,top:u,width:d,height:f}=e.getBoundingClientRect();if(s||t(),!d||!f)return;const p=Lp(u),y=Lp(a.clientWidth-(l+d)),m=Lp(a.clientHeight-(u+f)),v=Lp(l),b={rootMargin:-p+"px "+-y+"px "+-m+"px "+-v+"px",threshold:dr(0,Oa(1,c))||1};let w=!0;function _(x){const j=x[0].intersectionRatio;if(j!==c){if(!w)return i();j?i(!1,j):r=setTimeout(()=>{i(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(_,{...b,root:a.ownerDocument})}catch{n=new IntersectionObserver(_,b)}n.observe(e)}return i(!0),o}uv=function(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=nb(e),u=a||o?[...l?vu(l):[],...vu(t)]:[];u.forEach(b=>{a&&b.addEventListener("scroll",n,{passive:!0}),o&&b.addEventListener("resize",n)});const d=l&&s?BJ(l,n):null;let f=-1,p=null;i&&(p=new ResizeObserver(b=>{let[w]=b;w&&w.target===l&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var _;(_=p)==null||_.observe(t)})),n()}),l&&!c&&p.observe(l),p.observe(t));let y,m=c?Ui(e):null;c&&v();function v(){const b=Ui(e);m&&(b.x!==m.x||b.y!==m.y||b.width!==m.width||b.height!==m.height)&&n(),m=b,y=requestAnimationFrame(v)}return n(),()=>{var b;u.forEach(w=>{a&&w.removeEventListener("scroll",n),o&&w.removeEventListener("resize",n)}),d==null||d(),(b=p)==null||b.disconnect(),p=null,c&&cancelAnimationFrame(y)}};let EA;NM=wJ,FM=xJ,MM=gJ,zM=jJ,EA=vJ,Pv=yJ,BM=_J,PM=(e,t,n)=>{const r=new Map,a={platform:FJ,...n},o={...a.platform,_c:r};return mJ(e,t,{...a,platform:o})};var Vp=typeof document<"u"?g.useLayoutEffect:g.useEffect;function qp(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!qp(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!qp(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function OA(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function CA(e,t){const n=OA(e);return Math.round(t*n)/n}function NA(e){const t=g.useRef(e);return Vp(()=>{t.current=e}),t}Sv=function(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:i}={},transform:s=!0,whileElementsMounted:c,open:l}=e,[u,d]=g.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=g.useState(r);qp(f,r)||p(r);const[y,m]=g.useState(null),[v,b]=g.useState(null),w=g.useCallback(I=>{I!==S.current&&(S.current=I,m(I))},[]),_=g.useCallback(I=>{I!==E.current&&(E.current=I,b(I))},[]),x=o||y,j=i||v,S=g.useRef(null),E=g.useRef(null),O=g.useRef(u),M=c!=null,N=NA(c),P=NA(a),R=g.useCallback(()=>{if(!S.current||!E.current)return;const I={placement:t,strategy:n,middleware:f};P.current&&(I.platform=P.current),PM(S.current,E.current,I).then(L=>{const D={...L,isPositioned:!0};k.current&&!qp(O.current,D)&&(O.current=D,Vl.flushSync(()=>{d(D)}))})},[f,t,n,P]);Vp(()=>{l===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,d(I=>({...I,isPositioned:!1})))},[l]);const k=g.useRef(!1);Vp(()=>(k.current=!0,()=>{k.current=!1}),[]),Vp(()=>{if(x&&(S.current=x),j&&(E.current=j),x&&j){if(N.current)return N.current(x,j,R);R()}},[x,j,R,N,M]);const C=g.useMemo(()=>({reference:S,floating:E,setReference:w,setFloating:_}),[w,_]),T=g.useMemo(()=>({reference:x,floating:j}),[x,j]),A=g.useMemo(()=>{const I={position:n,left:0,top:0};if(!T.floating)return I;const L=CA(T.floating,u.x),D=CA(T.floating,u.y);return s?{...I,transform:"translate("+L+"px, "+D+"px)",...OA(T.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:L,top:D}},[n,s,T.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:R,refs:C,elements:T,floatingStyles:A}),[u,R,C,T,A])};let MA;MA=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Pv({element:r.current,padding:a}).fn(n):{}:r?Pv({element:r,padding:a}).fn(n):{}}}},Ev=(e,t)=>({...NM(e),options:[e,t]}),Ov=(e,t)=>({...FM(e),options:[e,t]}),Cv=(e,t)=>({...BM(e),options:[e,t]}),Nv=(e,t)=>({...MM(e),options:[e,t]}),fv=(e,t)=>({...zM(e),options:[e,t]}),Vv=(e,t)=>({...EA(e),options:[e,t]}),zv=(e,t)=>({...MA(e),options:[e,t]});var zJ="Arrow",PA=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Ae.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});PA.displayName=zJ;var VJ=PA;function qJ(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...y}=d,m=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,y=g.useContext(p);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,UJ(a,...t)]}function UJ(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}ap=function(e){const[t,n]=g.useState(void 0);return on(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let i,s;if("borderBoxSize"in o){const c=o.borderBoxSize,l=Array.isArray(c)?c[0]:c;i=l.inlineSize,s=l.blockSize}else i=e.offsetWidth,s=e.offsetHeight;n({width:i,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t};var ab="Popper",[kA,Qs]=qJ(ab),[WJ,AA]=kA(ab),TA=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(WJ,{scope:t,anchor:r,onAnchorChange:a,children:n})};TA.displayName=ab;var RA="PopperAnchor",IA=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=AA(RA,n),i=g.useRef(null),s=xt(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Ae.div,{...a,ref:s})});IA.displayName=RA;var ob="PopperContent",[HJ,ZJ]=kA(ob),DA=g.forwardRef((e,t)=>{var J,Z,U,Q,ne,z;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:y,...m}=e,v=AA(ob,n),[b,w]=g.useState(null),_=xt(t,se=>w(se)),[x,j]=g.useState(null),S=ap(x),E=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,M=r+(o!=="center"?"-"+o:""),N=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(l)?l:[l],R=P.length>0,k={padding:N,boundary:P.filter(XJ),altBoundary:R},{refs:C,floatingStyles:T,placement:A,isPositioned:I,middlewareData:L}=Sv({strategy:"fixed",placement:M,whileElementsMounted:(...se)=>uv(...se,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Ev({mainAxis:a+O,alignmentAxis:i}),c&&Ov({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Cv():void 0,...k}),c&&Nv({...k}),fv({...k,apply:({elements:se,rects:re,availableWidth:ue,availableHeight:je})=>{const{width:Le,height:$e}=re.reference,Se=se.floating.style;Se.setProperty("--radix-popper-available-width",`${ue}px`),Se.setProperty("--radix-popper-available-height",`${je}px`),Se.setProperty("--radix-popper-anchor-width",`${Le}px`),Se.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&zv({element:x,padding:s}),GJ({arrowWidth:E,arrowHeight:O}),f&&Vv({strategy:"referenceHidden",...k})]}),[D,B]=FA(A),F=sr(y);on(()=>{I&&(F==null||F())},[I,F]);const $=(J=L.arrow)==null?void 0:J.x,V=(Z=L.arrow)==null?void 0:Z.y,G=((U=L.arrow)==null?void 0:U.centerOffset)!==0,[X,H]=g.useState();return on(()=>{b&&H(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:I?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:X,"--radix-popper-transform-origin":[(Q=L.transformOrigin)==null?void 0:Q.x,(ne=L.transformOrigin)==null?void 0:ne.y].join(" "),...((z=L.hide)==null?void 0:z.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(HJ,{scope:n,placedSide:D,onArrowChange:j,arrowX:$,arrowY:V,shouldHideArrow:G,children:h.jsx(Ae.div,{"data-side":D,"data-align":B,...m,ref:_,style:{...m.style,animation:I?void 0:"none"}})})})});DA.displayName=ob;var LA="PopperArrow",KJ={top:"bottom",right:"left",bottom:"top",left:"right"},$A=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=ZJ(LA,n),o=KJ[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(VJ,{...r,ref:t,style:{...r.style,display:"block"}})})});$A.displayName=LA;function XJ(e){return e!==null}var GJ=e=>({name:"transformOrigin",options:e,fn(t){var m,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((m=a.arrow)==null?void 0:m.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=FA(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,f=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let p="",y="";return c==="bottom"?(p=o?u:`${d}px`,y=`${-s}px`):c==="top"?(p=o?u:`${d}px`,y=`${r.floating.height+s}px`):c==="right"?(p=`${-s}px`,y=o?u:`${f}px`):c==="left"&&(p=`${r.floating.width+s}px`,y=o?u:`${f}px`),{data:{x:p,y}}}});function FA(e){const[t,n="center"]=e.split("-");return[t,n]}var Up=TA,ib=IA,sb=DA,cb=$A,[Wp,ARe]=ir("Tooltip",[Qs]),Hp=Qs(),BA="TooltipProvider",QJ=700,lb="tooltip.open",[JJ,ub]=Wp(BA),zA=e=>{const{__scopeTooltip:t,delayDuration:n=QJ,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:o}=e,[i,s]=g.useState(!0),c=g.useRef(!1),l=g.useRef(0);return g.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),h.jsx(JJ,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:g.useCallback(u=>{c.current=u},[]),disableHoverableContent:a,children:o})};zA.displayName=BA;var Zp="Tooltip",[YJ,bu]=Wp(Zp),VA=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a=!1,onOpenChange:o,disableHoverableContent:i,delayDuration:s}=e,c=ub(Zp,e.__scopeTooltip),l=Hp(t),[u,d]=g.useState(null),f=Tt(),p=g.useRef(0),y=i??c.disableHoverableContent,m=s??c.delayDuration,v=g.useRef(!1),[b=!1,w]=Nn({prop:r,defaultProp:a,onChange:E=>{E?(c.onOpen(),document.dispatchEvent(new CustomEvent(lb))):c.onClose(),o==null||o(E)}}),_=g.useMemo(()=>b?v.current?"delayed-open":"instant-open":"closed",[b]),x=g.useCallback(()=>{window.clearTimeout(p.current),p.current=0,v.current=!1,w(!0)},[w]),j=g.useCallback(()=>{window.clearTimeout(p.current),p.current=0,w(!1)},[w]),S=g.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{v.current=!0,w(!0),p.current=0},m)},[m,w]);return g.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),h.jsx(Up,{...l,children:h.jsx(YJ,{scope:t,contentId:f,open:b,stateAttribute:_,trigger:u,onTriggerChange:d,onTriggerEnter:g.useCallback(()=>{c.isOpenDelayed?S():x()},[c.isOpenDelayed,S,x]),onTriggerLeave:g.useCallback(()=>{y?j():(window.clearTimeout(p.current),p.current=0)},[j,y]),onOpen:x,onClose:j,disableHoverableContent:y,children:n})})};VA.displayName=Zp;var db="TooltipTrigger",qA=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=bu(db,n),o=ub(db,n),i=Hp(n),s=g.useRef(null),c=xt(t,s,a.onTriggerChange),l=g.useRef(!1),u=g.useRef(!1),d=g.useCallback(()=>l.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),h.jsx(ib,{asChild:!0,...i,children:h.jsx(Ae.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:c,onPointerMove:ge(e.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!o.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:ge(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:ge(e.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ge(e.onFocus,()=>{l.current||a.onOpen()}),onBlur:ge(e.onBlur,a.onClose),onClick:ge(e.onClick,a.onClose)})})});qA.displayName=db;var fb="TooltipPortal",[eY,tY]=Wp(fb,{forceMount:void 0}),UA=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:a}=e,o=bu(fb,t);return h.jsx(eY,{scope:t,forceMount:n,children:h.jsx(Ir,{present:n||o.open,children:h.jsx(nv,{asChild:!0,container:a,children:r})})})};UA.displayName=fb;var Js="TooltipContent",WA=g.forwardRef((e,t)=>{const n=tY(Js,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...o}=e,i=bu(Js,e.__scopeTooltip);return h.jsx(Ir,{present:r||i.open,children:i.disableHoverableContent?h.jsx(HA,{side:a,...o,ref:t}):h.jsx(nY,{side:a,...o,ref:t})})}),nY=g.forwardRef((e,t)=>{const n=bu(Js,e.__scopeTooltip),r=ub(Js,e.__scopeTooltip),a=g.useRef(null),o=xt(t,a),[i,s]=g.useState(null),{trigger:c,onClose:l}=n,u=a.current,{onPointerInTransitChange:d}=r,f=g.useCallback(()=>{s(null),d(!1)},[d]),p=g.useCallback((y,m)=>{const v=y.currentTarget,b={x:y.clientX,y:y.clientY},w=iY(b,v.getBoundingClientRect()),_=sY(b,w),x=cY(m.getBoundingClientRect()),j=uY([..._,...x]);s(j),d(!0)},[d]);return g.useEffect(()=>()=>f(),[f]),g.useEffect(()=>{if(c&&u){const y=v=>p(v,u),m=v=>p(v,c);return c.addEventListener("pointerleave",y),u.addEventListener("pointerleave",m),()=>{c.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",m)}}},[c,u,p,f]),g.useEffect(()=>{if(i){const y=m=>{const v=m.target,b={x:m.clientX,y:m.clientY},w=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),_=!lY(b,i);w?f():_&&(f(),l())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[c,u,i,l,f]),h.jsx(HA,{...e,ref:o})}),[rY,aY]=Wp(Zp,{isInside:!1}),HA=g.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:o,onPointerDownOutside:i,...s}=e,c=bu(Js,n),l=Hp(n),{onClose:u}=c;return g.useEffect(()=>(document.addEventListener(lb,u),()=>document.removeEventListener(lb,u)),[u]),g.useEffect(()=>{if(c.trigger){const d=f=>{var p;(p=f.target)!=null&&p.contains(c.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[c.trigger,u]),h.jsx(tv,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:h.jsxs(sb,{"data-state":c.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[h.jsx(CK,{children:r}),h.jsx(rY,{scope:n,isInside:!0,children:h.jsx(WTe,{id:c.contentId,role:"tooltip",children:a||r})})]})})});WA.displayName=Js;var ZA="TooltipArrow",oY=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=Hp(n);return aY(ZA,n).isInside?null:h.jsx(cb,{...a,...r,ref:t})});oY.displayName=ZA;function iY(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(n,r,a,o)){case o:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function sY(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function cY(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function lY(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function uY(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),dY(t)}function dY(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const o=n[n.length-1],i=n[n.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}HM=zA,ZM=VA,TM=qA,zK=UA,hv=WA;const wu=HM,Na=ZM,Ma=TM,Hr=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(hv,{ref:r,sideOffset:t,className:K("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));Hr.displayName=hv.displayName;const fY="sidebar:state",pY=60*60*24*7,hY="16rem",mY="18rem",yY="3rem",gY="b",KA=g.createContext(null);function xu(){const e=g.useContext(KA);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const pb=g.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:a,children:o,...i},s)=>{const c=vQ(),[l,u]=g.useState(!1),[d,f]=g.useState(e),p=t??d,y=g.useCallback(w=>{const _=typeof w=="function"?w(p):w;n?n(_):f(_),document.cookie=`${fY}=${_}; path=/; max-age=${pY}`},[n,p]),m=g.useCallback(()=>c?u(w=>!w):y(w=>!w),[c,y,u]);g.useEffect(()=>{const w=_=>{_.key===gY&&(_.metaKey||_.ctrlKey)&&(_.preventDefault(),m())};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[m]);const v=p?"expanded":"collapsed",b=g.useMemo(()=>({state:v,open:p,setOpen:y,isMobile:c,openMobile:l,setOpenMobile:u,toggleSidebar:m}),[v,p,y,c,l,u,m]);return h.jsx(KA.Provider,{value:b,children:h.jsx(wu,{delayDuration:0,children:h.jsx("div",{style:{"--sidebar-width":hY,"--sidebar-width-icon":yY,...a},className:K("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:s,...i,children:o})})})});pb.displayName="SidebarProvider";const hb=g.forwardRef(({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:r,children:a,...o},i)=>{const{isMobile:s,state:c,openMobile:l,setOpenMobile:u}=xu();return n==="none"?h.jsx("div",{className:K("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:i,...o,children:a}):s?h.jsx(nJ,{open:l,onOpenChange:u,...o,children:h.jsx(lA,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":mY},side:e,children:h.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):h.jsxs("div",{ref:i,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?n:"","data-variant":t,"data-side":e,children:[h.jsx("div",{className:K("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),h.jsx("div",{className:K("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...o,children:h.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});hb.displayName="Sidebar";const XA=g.forwardRef(({className:e,onClick:t,...n},r)=>{const{toggleSidebar:a}=xu();return h.jsx(ut,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:K("h-7 w-7",e),onClick:o=>{t==null||t(o),a()},...n,children:h.jsx(fe,{size:32,name:"panel-left"})})});XA.displayName="SidebarTrigger";const GA=g.forwardRef(({className:e,...t},n)=>{const{toggleSidebar:r}=xu();return h.jsx("button",{ref:n,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:K("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});GA.displayName="SidebarRail";const mb=g.forwardRef(({className:e,...t},n)=>h.jsx("main",{ref:n,className:K("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));mb.displayName="SidebarInset";const vY=g.forwardRef(({className:e,...t},n)=>h.jsx(Mn,{ref:n,"data-sidebar":"input",className:K("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));vY.displayName="SidebarInput";const bY=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"header",className:K("flex flex-col gap-2 p-2",e),...t}));bY.displayName="SidebarHeader";const QA=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"footer",className:K("flex flex-col gap-2 p-2",e),...t}));QA.displayName="SidebarFooter";const wY=g.forwardRef(({className:e,...t},n)=>h.jsx(Ls,{ref:n,"data-sidebar":"separator",className:K("mx-2 w-auto bg-sidebar-border",e),...t}));wY.displayName="SidebarSeparator";const yb=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"content",className:K("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));yb.displayName="SidebarContent";const _u=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group",className:K("relative flex w-full min-w-0 flex-col p-2",e),...t}));_u.displayName="SidebarGroup";const ju=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?Xo:"div";return h.jsx(a,{ref:r,"data-sidebar":"group-label",className:K("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...n})});ju.displayName="SidebarGroupLabel";const xY=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?Xo:"button";return h.jsx(a,{ref:r,"data-sidebar":"group-action",className:K("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...n})});xY.displayName="SidebarGroupAction";const _Y=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group-content",className:K("w-full text-sm",e),...t}));_Y.displayName="SidebarGroupContent";const Ys=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu",className:K("flex w-full min-w-0 flex-col gap-1",e),...t}));Ys.displayName="SidebarMenu";const so=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,"data-sidebar":"menu-item",className:K("group/menu-item relative",e),...t}));so.displayName="SidebarMenuItem";const jY=Ja("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),co=g.forwardRef(({asChild:e=!1,isActive:t=!1,variant:n="default",size:r="default",tooltip:a,className:o,...i},s)=>{const c=e?Xo:"button",{isMobile:l,state:u}=xu(),d=h.jsx(c,{ref:s,"data-sidebar":"menu-button","data-size":r,"data-active":t,className:K(jY({variant:n,size:r}),o),...i});return a?(typeof a=="string"&&(a={children:a}),h.jsxs(Na,{children:[h.jsx(Ma,{asChild:!0,children:d}),h.jsx(Hr,{side:"right",align:"center",hidden:u!=="collapsed"||l,...a})]})):d});co.displayName="SidebarMenuButton";const SY=g.forwardRef(({className:e,asChild:t=!1,showOnHover:n=!1,...r},a)=>{const o=t?Xo:"button";return h.jsx(o,{ref:a,"data-sidebar":"menu-action",className:K("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})});SY.displayName="SidebarMenuAction";const EY=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"menu-badge",className:K("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));EY.displayName="SidebarMenuBadge";const OY=g.forwardRef(({className:e,showIcon:t=!1,...n},r)=>{const a=g.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return h.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:K("rounded-md h-8 flex gap-2 px-2 items-center",e),...n,children:[t&&h.jsx(uA,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),h.jsx(uA,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});OY.displayName="SidebarMenuSkeleton";const JA=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu-sub",className:K("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));JA.displayName="SidebarMenuSub";const YA=g.forwardRef(({...e},t)=>h.jsx("li",{ref:t,...e}));YA.displayName="SidebarMenuSubItem";const e2=g.forwardRef(({asChild:e=!1,size:t="md",isActive:n,className:r,...a},o)=>{const i=e?Xo:"a";return h.jsx(i,{ref:o,"data-sidebar":"menu-sub-button","data-size":t,"data-active":n,className:K("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...a})});e2.displayName="SidebarMenuSubButton";const CY="hash",Kp={application:"/application/:applicationId?",whiteboard:"/whiteboard/:sessionId?",document:"/document/:documentId?"},xn=(e,t)=>{let n=Kp[e];return t?n=Object.keys(t||{}).reduce((r,a)=>r.replace(`:${a}`,(t==null?void 0:t[a])||""),n):n=n.replace(/\/:[^/]+/g,""),n!=null&&n.endsWith("?")?n.slice(0,-1):n},NY=()=>{{const[,e]=window.location.hash.split("?");return new URLSearchParams(`?${e}`)}};function MY({items:e}){const{t}=Pe("documents");return h.jsxs(_u,{children:[h.jsx(ju,{children:h.jsx("div",{className:"text-sm",children:t("title")})}),h.jsx(Ys,{children:e.map(n=>{var r;return h.jsx(mQ,{asChild:!0,defaultOpen:n.isActive,className:"group/collapsible",children:h.jsxs(so,{children:[h.jsx(yQ,{asChild:!0,children:h.jsxs(co,{className:"cursor-pointer",tooltip:t(n.title),children:[n.icon,h.jsx("span",{children:t(n.title)}),h.jsx(fe,{name:"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),h.jsx(gQ,{children:h.jsx(JA,{children:(r=n.items)==null?void 0:r.map(a=>h.jsx(YA,{className:"cursor-pointer",children:h.jsx(e2,{asChild:!0,children:h.jsx(E0,{to:xn("document",{documentId:a.id}),children:h.jsx("span",{children:t(a.title)})})})},t(a.title)))})})]})},n.title)})})]})}const PY=g.memo(({text:e,colors:t={first:"#9E7AFF",second:"#FE8BBB"},className:n,sparklesCount:r=10,...a})=>{const[o,i]=g.useState([]);return g.useEffect(()=>{const s=()=>{const d=`${Math.random()*100}%`,f=`${Math.random()*100}%`,p=Math.random()>.5?t.first:t.second,y=Math.random()*2,m=Math.random()*1+.3,v=Math.random()*10+5;return{id:`${d}-${f}-${Date.now()}`,x:d,y:f,color:p,delay:y,scale:m,lifespan:v}},c=()=>{const d=Array.from({length:r},s);i(d)},l=()=>{i(d=>d.map(f=>f.lifespan<=0?s():{...f,lifespan:f.lifespan-.1}))};c();const u=setInterval(l,100);return()=>clearInterval(u)},[t.first,t.second]),h.jsx("div",{className:K("text-6xl font-bold",n),...a,style:{"--sparkles-first-color":`${t.first}`,"--sparkles-second-color":`${t.second}`},children:h.jsxs("span",{className:"relative inline-block",children:[o.map(s=>h.jsx(kY,{...s},s.id)),h.jsx("strong",{children:e})]})})},(e,t)=>e.text===t.text),kY=({id:e,x:t,y:n,color:r,delay:a,scale:o})=>h.jsx(Kf.svg,{className:"pointer-events-none absolute z-20",initial:{opacity:0,left:t,top:n},animate:{opacity:[0,1,0],scale:[0,o,0],rotate:[75,120,150]},transition:{duration:.8,repeat:1/0,delay:a},width:"21",height:"21",viewBox:"0 0 21 21",children:h.jsx("path",{d:"M9.82531 0.843845C10.0553 0.215178 10.9446 0.215178 11.1746 0.843845L11.8618 2.72026C12.4006 4.19229 12.3916 6.39157 13.5 7.5C14.6084 8.60843 16.8077 8.59935 18.2797 9.13822L20.1561 9.82534C20.7858 10.0553 20.7858 10.9447 20.1561 11.1747L18.2797 11.8618C16.8077 12.4007 14.6084 12.3916 13.5 13.5C12.3916 14.6084 12.4006 16.8077 11.8618 18.2798L11.1746 20.1562C10.9446 20.7858 10.0553 20.7858 9.82531 20.1562L9.13819 18.2798C8.59932 16.8077 8.60843 14.6084 7.5 13.5C6.39157 12.3916 4.19225 12.4007 2.72023 11.8618L0.843814 11.1747C0.215148 10.9447 0.215148 10.0553 0.843814 9.82534L2.72023 9.13822C4.19225 8.59935 6.39157 8.60843 7.5 7.5C8.60843 6.39157 8.59932 4.19229 9.13819 2.72026L9.82531 0.843845Z",fill:r})},e);function AY({className:e,onClick:t}){const{t:n}=Pe("sidebar");return h.jsxs(co,{className:K(e,"tw-w-full"),onClick:t,children:[h.jsx(fe,{name:"frame"}),h.jsx(PY,{text:n("new_session"),className:"text-sm",sparklesCount:3})]})}const TY=()=>{const[e,t]=g.useState(!1),n=Ye(i=>i.setCurrentSession),r=Ye(i=>i.createSession),a=Ps(i=>i.setSelectedSessionId),o=g.useCallback(async i=>{try{t(!0);const s=await r(i);n(s),a(s.id)}finally{t(!1)}},[r,n,a]);return{loading:e,createSession:o}},ii=Zl,RY=Gl,t2=g.forwardRef(({className:e,...t},n)=>h.jsx(Ii,{ref:n,className:K("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));t2.displayName=Ii.displayName;const lo=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(RY,{children:[h.jsx(t2,{}),h.jsxs(Di,{ref:r,className:K("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,h.jsxs(Ql,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(fe,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));lo.displayName=Di.displayName;const uo=({className:e,...t})=>h.jsx("div",{className:K("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});uo.displayName="DialogHeader";const Su=({className:e,...t})=>h.jsx("div",{className:K("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Su.displayName="DialogFooter";const fo=g.forwardRef(({className:e,...t},n)=>h.jsx(Is,{ref:n,className:K("text-lg font-semibold leading-none tracking-tight",e),...t}));fo.displayName=Is.displayName;const Eu=g.forwardRef(({className:e,...t},n)=>h.jsx(Ds,{ref:n,className:K("text-sm text-muted-foreground",e),...t}));Eu.displayName=Ds.displayName;var IY="Label",n2=g.forwardRef((e,t)=>h.jsx(Ae.label,{...e,ref:t,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=e.onMouseDown)==null||r.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));n2.displayName=IY;var r2=n2;let a2;a2=Ja("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),nt=g.forwardRef(({className:e,...t},n)=>h.jsx(r2,{ref:n,className:K(a2(),e),...t})),nt.displayName=r2.displayName;const DY=Ya(()=>{const e=Jt(),{t}=Pe("dialogs"),[n,r]=g.useState(""),{toast:a}=Yt(),{loading:o,createSession:i}=TY(),s=l=>{r(l.target.value)},c=async()=>{try{await i({name:n}),r(""),e.hide()}catch{a({variant:"destructive",description:t("create_session.errors.create_failed")})}};return h.jsx(ii,{open:e.visible,onOpenChange:e.hide,children:h.jsxs(lo,{className:"sm:max-w-[425px]",children:[h.jsxs(uo,{children:[h.jsx(fo,{children:t("create_session.title")}),h.jsx(Eu,{children:t("create_session.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{className:"mb-2",htmlFor:"name",children:t("create_session.name")}),h.jsx(Mn,{onChange:s,id:"name",value:n,placeholder:t("create_session.name_placeholder")})]})}),h.jsx(Su,{children:h.jsx(ut,{onClick:c,disabled:o||!n,type:"submit",children:t("create_session.create")})})]})})}),LY=()=>{const[e,t]=g.useState(!1),n=Ye(a=>a.deleteSession),r=g.useCallback(async a=>{try{t(!0),await n(a),await Promise.all([de("FlowEdge").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>de("FlowEdge").delete(i.id)))),de("FlowNode").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>de("FlowNode").delete(i.id))))])}finally{t(!1)}},[n]);return{loading:e,deleteSession:r}};var o2="AlertDialog",[$Y,TRe]=ir(o2,[z0]),po=z0(),i2=e=>{const{__scopeAlertDialog:t,...n}=e,r=po(t);return h.jsx(Zl,{...r,...n,modal:!0})};i2.displayName=o2;var FY="AlertDialogTrigger",BY=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=po(n);return h.jsx(sA,{...a,...r,ref:t})});BY.displayName=FY;var zY="AlertDialogPortal",s2=e=>{const{__scopeAlertDialog:t,...n}=e,r=po(t);return h.jsx(Gl,{...r,...n})};s2.displayName=zY;var VY="AlertDialogOverlay",c2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=po(n);return h.jsx(Ii,{...a,...r,ref:t})});c2.displayName=VY;var ec="AlertDialogContent",[qY,UY]=$Y(ec),l2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,o=po(n),i=g.useRef(null),s=xt(t,i),c=g.useRef(null);return h.jsx(rA,{contentName:ec,titleName:u2,docsSlug:"alert-dialog",children:h.jsx(qY,{scope:n,cancelRef:c,children:h.jsxs(Di,{role:"alertdialog",...o,...a,ref:s,onOpenAutoFocus:ge(a.onOpenAutoFocus,l=>{var u;l.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[h.jsx(CK,{children:r}),h.jsx(g2,{contentRef:i})]})})})});l2.displayName=ec;var u2="AlertDialogTitle",d2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=po(n);return h.jsx(Is,{...a,...r,ref:t})});d2.displayName=u2;var f2="AlertDialogDescription",p2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=po(n);return h.jsx(Ds,{...a,...r,ref:t})});p2.displayName=f2;var WY="AlertDialogAction",h2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=po(n);return h.jsx(Ql,{...a,...r,ref:t})});h2.displayName=WY;var m2="AlertDialogCancel",y2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=UY(m2,n),o=po(n),i=xt(t,a);return h.jsx(Ql,{...o,...r,ref:i})});y2.displayName=m2;let g2;g2=({contentRef:e})=>{const t=`\`${ec}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${ec}\` by passing a \`${f2}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${ec}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return g.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},LM=i2,DM=s2,vv=c2,bv=l2,_v=h2,jv=y2,wv=d2,xv=p2;const v2=LM,HY=DM,b2=g.forwardRef(({className:e,...t},n)=>h.jsx(vv,{className:K("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));b2.displayName=vv.displayName;const gb=g.forwardRef(({className:e,...t},n)=>h.jsxs(HY,{children:[h.jsx(b2,{}),h.jsx(bv,{ref:n,className:K("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));gb.displayName=bv.displayName;const vb=({className:e,...t})=>h.jsx("div",{className:K("flex flex-col space-y-2 text-center sm:text-left",e),...t});vb.displayName="AlertDialogHeader";const bb=({className:e,...t})=>h.jsx("div",{className:K("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});bb.displayName="AlertDialogFooter";const wb=g.forwardRef(({className:e,...t},n)=>h.jsx(wv,{ref:n,className:K("text-lg font-semibold",e),...t}));wb.displayName=wv.displayName;const xb=g.forwardRef(({className:e,...t},n)=>h.jsx(xv,{ref:n,className:K("text-sm text-muted-foreground",e),...t}));xb.displayName=xv.displayName;const _b=g.forwardRef(({className:e,...t},n)=>h.jsx(_v,{ref:n,className:K(pu(),e),...t}));_b.displayName=_v.displayName;const jb=g.forwardRef(({className:e,...t},n)=>h.jsx(jv,{ref:n,className:K(pu({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));jb.displayName=jv.displayName;const w2=Ya(({id:e})=>{const{t}=Pe("dialogs"),n=Jt(),{toast:r}=Yt(),{deleteSession:a,loading:o}=LY(),i=async()=>{try{await a(e),n.hide()}catch{r({variant:"destructive",description:t("delete_session.errors.delete_failed")})}};return h.jsx(v2,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(gb,{children:[h.jsxs(vb,{children:[h.jsx(wb,{children:t("delete_session.title")}),h.jsx(xb,{children:t("delete_session.description")})]}),h.jsxs(bb,{children:[h.jsx(jb,{onClick:n.hide,children:t("delete_session.cancel")}),h.jsx(_b,{disabled:o,onClick:i,children:t("delete_session.delete")})]})]})})});function ZY({sessions:e,currentSession:t,setCurrentSession:n}){const{t:r}=Pe("sidebar"),a=Bi(),{sessionId:o}=bp(),[i,s]=g.useState(),c=Jt(DY),l=Jt(w2),u=g.useCallback(()=>{c.show({})},[c]),d=g.useCallback((p,y)=>{p.preventDefault(),p.stopPropagation(),l.show({id:y})},[l]),f=async p=>{try{s(p.id),await n(p),a(xn("whiteboard",{sessionId:p.id}))}catch(y){ks(y),s(void 0)}};return g.useEffect(()=>{!i||i!==(t==null?void 0:t.id)||s(void 0)},[i,t==null?void 0:t.id]),h.jsxs(_u,{className:"group-data-[collapsible=icon]:hidden",children:[h.jsx(ju,{children:h.jsx("div",{className:"text-sm",children:r("sessions")})}),h.jsxs(Ys,{children:[h.jsx(so,{children:h.jsx(AY,{onClick:u,className:"w-full"})}),e.map(p=>h.jsx(so,{className:"cursor-pointer",children:h.jsx(co,{disabled:!!i,asChild:!0,onClick:()=>f(p),children:h.jsxs("div",{className:"flex flex-row justify-between items-center",children:[h.jsxs("div",{className:"flex gap-2",children:[p.id===i?h.jsx(fe,{size:16,name:"loader",className:"animate-spin"}):o===p.id?h.jsx(fe,{size:16,color:"green",name:"check"}):h.jsx(fe,{size:16,name:"chevron-right"}),h.jsx("span",{children:p.name})]}),h.jsx(fe,{onClick:y=>d(y,p.id),size:16,name:"trash-2",className:"!z-50"})]})})},p.id)),e!=null&&e.length?h.jsx(so,{children:h.jsxs(co,{className:"text-sidebar-foreground/70",children:[h.jsx(fe,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}var KY=g.createContext(void 0);Qo=function(e){const t=g.useContext(KY);return e||t||"ltr"};function XY(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...y}=d,m=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,y=g.useContext(p);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,GY(a,...t)]}function GY(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}let Xp,x2,Ou,Gp,Sb,_2,j2,S2,E2,Eb;Xp="rovingFocusGroup.onEntryFocus",x2={bubbles:!1,cancelable:!0},Ou="RovingFocusGroup",[Gp,Sb,_2]=Xf(Ou),[j2,to]=XY(Ou,[_2]),[S2,E2]=j2(Ou),Eb=g.forwardRef((e,t)=>h.jsx(Gp.Provider,{scope:e.__scopeRovingFocusGroup,children:h.jsx(Gp.Slot,{scope:e.__scopeRovingFocusGroup,children:h.jsx(QY,{...e,ref:t})})})),Eb.displayName=Ou;var QY=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=e,f=g.useRef(null),p=xt(t,f),y=Qo(o),[m=null,v]=Nn({prop:i,defaultProp:s,onChange:c}),[b,w]=g.useState(!1),_=sr(l),x=Sb(n),j=g.useRef(!1),[S,E]=g.useState(0);return g.useEffect(()=>{const O=f.current;if(O)return O.addEventListener(Xp,_),()=>O.removeEventListener(Xp,_)},[_]),h.jsx(S2,{scope:n,orientation:r,dir:y,loop:a,currentTabStopId:m,onItemFocus:g.useCallback(O=>v(O),[v]),onItemShiftTab:g.useCallback(()=>w(!0),[]),onFocusableItemAdd:g.useCallback(()=>E(O=>O+1),[]),onFocusableItemRemove:g.useCallback(()=>E(O=>O-1),[]),children:h.jsx(Ae.div,{tabIndex:b||S===0?-1:0,"data-orientation":r,...d,ref:p,style:{outline:"none",...e.style},onMouseDown:ge(e.onMouseDown,()=>{j.current=!0}),onFocus:ge(e.onFocus,O=>{const M=!j.current;if(O.target===O.currentTarget&&M&&!b){const N=new CustomEvent(Xp,x2);if(O.currentTarget.dispatchEvent(N),!N.defaultPrevented){const P=x().filter(T=>T.focusable),R=P.find(T=>T.active),k=P.find(T=>T.id===m),C=[R,k,...P].filter(Boolean).map(T=>T.ref.current);N2(C,u)}}j.current=!1}),onBlur:ge(e.onBlur,()=>w(!1))})})}),O2="RovingFocusGroupItem",C2=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,...i}=e,s=Tt(),c=o||s,l=E2(O2,n),u=l.currentTabStopId===c,d=Sb(n),{onFocusableItemAdd:f,onFocusableItemRemove:p}=l;return g.useEffect(()=>{if(r)return f(),()=>p()},[r,f,p]),h.jsx(Gp.ItemSlot,{scope:n,id:c,focusable:r,active:a,children:h.jsx(Ae.span,{tabIndex:u?0:-1,"data-orientation":l.orientation,...i,ref:t,onMouseDown:ge(e.onMouseDown,y=>{r?l.onItemFocus(c):y.preventDefault()}),onFocus:ge(e.onFocus,()=>l.onItemFocus(c)),onKeyDown:ge(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){l.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const m=eee(y,l.orientation,l.dir);if(m!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let v=d().filter(b=>b.focusable).map(b=>b.ref.current);if(m==="last")v.reverse();else if(m==="prev"||m==="next"){m==="prev"&&v.reverse();const b=v.indexOf(y.currentTarget);v=l.loop?tee(v,b+1):v.slice(b+1)}setTimeout(()=>N2(v))}})})})});C2.displayName=O2;var JY={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function YY(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function eee(e,t,n){const r=YY(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return JY[r]}function N2(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function tee(e,t){return e.map((n,r)=>e[(t+r)%e.length])}let Qp,M2,Ob,P2,k2,A2,tc,nc,T2,R2,si,Jp,rc,Cb,Nb,ho,I2,ac,Mb;Jl=Eb,Yl=C2,Qp=["Enter"," "],M2=["ArrowDown","PageUp","Home"],Ob=["ArrowUp","PageDown","End"],P2=[...M2,...Ob],k2={ltr:[...Qp,"ArrowRight"],rtl:[...Qp,"ArrowLeft"]},A2={ltr:["ArrowLeft"],rtl:["ArrowRight"]},tc="Menu",[nc,T2,R2]=Xf(tc),[si,Jp]=ir(tc,[R2,Qs,to]),rc=Qs(),Cb=to(),[Nb,ho]=si(tc),[I2,ac]=si(tc),Mb=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:o,modal:i=!0}=e,s=rc(t),[c,l]=g.useState(null),u=g.useRef(!1),d=sr(o),f=Qo(a);return g.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),h.jsx(Up,{...s,children:h.jsx(Nb,{scope:t,open:n,onOpenChange:d,content:c,onContentChange:l,children:h.jsx(I2,{scope:t,onClose:g.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:f,modal:i,children:r})})})},Mb.displayName=tc;var nee="MenuAnchor",Pb=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=rc(n);return h.jsx(ib,{...a,...r,ref:t})});Pb.displayName=nee;var kb="MenuPortal",[ree,D2]=si(kb,{forceMount:void 0}),L2=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,o=ho(kb,t);return h.jsx(ree,{scope:t,forceMount:n,children:h.jsx(Ir,{present:n||o.open,children:h.jsx(nv,{asChild:!0,container:a,children:r})})})};L2.displayName=kb;var Er="MenuContent",[aee,Ab]=si(Er),$2=g.forwardRef((e,t)=>{const n=D2(Er,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=ho(Er,e.__scopeMenu),i=ac(Er,e.__scopeMenu);return h.jsx(nc.Provider,{scope:e.__scopeMenu,children:h.jsx(Ir,{present:r||o.open,children:h.jsx(nc.Slot,{scope:e.__scopeMenu,children:i.modal?h.jsx(oee,{...a,ref:t}):h.jsx(iee,{...a,ref:t})})})})}),oee=g.forwardRef((e,t)=>{const n=ho(Er,e.__scopeMenu),r=g.useRef(null),a=xt(t,r);return g.useEffect(()=>{const o=r.current;if(o)return tu(o)},[]),h.jsx(Tb,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),iee=g.forwardRef((e,t)=>{const n=ho(Er,e.__scopeMenu);return h.jsx(Tb,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Tb=g.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,disableOutsideScroll:y,...m}=e,v=ho(Er,n),b=ac(Er,n),w=rc(n),_=Cb(n),x=T2(n),[j,S]=g.useState(null),E=g.useRef(null),O=xt(t,E,v.onContentChange),M=g.useRef(0),N=g.useRef(""),P=g.useRef(0),R=g.useRef(null),k=g.useRef("right"),C=g.useRef(0),T=y?Ap:g.Fragment,A=y?{as:Xo,allowPinchZoom:!0}:void 0,I=D=>{var J,Z;const B=N.current+D,F=x().filter(U=>!U.disabled),$=document.activeElement,V=(J=F.find(U=>U.ref.current===$))==null?void 0:J.textValue,G=F.map(U=>U.textValue),X=vee(G,B,V),H=(Z=F.find(U=>U.textValue===X))==null?void 0:Z.ref.current;(function U(Q){N.current=Q,window.clearTimeout(M.current),Q!==""&&(M.current=window.setTimeout(()=>U(""),1e3))})(B),H&&setTimeout(()=>H.focus())};g.useEffect(()=>()=>window.clearTimeout(M.current),[]),nu();const L=g.useCallback(D=>{var B,F;return k.current===((B=R.current)==null?void 0:B.side)&&wee(D,(F=R.current)==null?void 0:F.area)},[]);return h.jsx(aee,{scope:n,searchRef:N,onItemEnter:g.useCallback(D=>{L(D)&&D.preventDefault()},[L]),onItemLeave:g.useCallback(D=>{var B;L(D)||((B=E.current)==null||B.focus(),S(null))},[L]),onTriggerLeave:g.useCallback(D=>{L(D)&&D.preventDefault()},[L]),pointerGraceTimerRef:P,onPointerGraceIntentChange:g.useCallback(D=>{R.current=D},[]),children:h.jsx(T,{...A,children:h.jsx(Sp,{asChild:!0,trapped:a,onMountAutoFocus:ge(o,D=>{var B;D.preventDefault(),(B=E.current)==null||B.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:h.jsx(tv,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,children:h.jsx(Jl,{asChild:!0,..._,dir:b.dir,orientation:"vertical",loop:r,currentTabStopId:j,onCurrentTabStopIdChange:S,onEntryFocus:ge(c,D=>{b.isUsingKeyboardRef.current||D.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(sb,{role:"menu","aria-orientation":"vertical","data-state":nT(v.open),"data-radix-menu-content":"",dir:b.dir,...w,...m,ref:O,style:{outline:"none",...m.style},onKeyDown:ge(m.onKeyDown,D=>{const B=D.target.closest("[data-radix-menu-content]")===D.currentTarget,F=D.ctrlKey||D.altKey||D.metaKey,$=D.key.length===1;B&&(D.key==="Tab"&&D.preventDefault(),!F&&$&&I(D.key));const V=E.current;if(D.target!==V||!P2.includes(D.key))return;D.preventDefault();const G=x().filter(X=>!X.disabled).map(X=>X.ref.current);Ob.includes(D.key)&&G.reverse(),yee(G)}),onBlur:ge(e.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(M.current),N.current="")}),onPointerMove:ge(e.onPointerMove,Nu(D=>{const B=D.target,F=C.current!==D.clientX;if(D.currentTarget.contains(B)&&F){const $=D.clientX>C.current?"right":"left";k.current=$,C.current=D.clientX}}))})})})})})})});$2.displayName=Er;var see="MenuGroup",Rb=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{role:"group",...r,ref:t})});Rb.displayName=see;var cee="MenuLabel",F2=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{...r,ref:t})});F2.displayName=cee;var Yp="MenuItem",B2="menu.itemSelect",eh=g.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,o=g.useRef(null),i=ac(Yp,e.__scopeMenu),s=Ab(Yp,e.__scopeMenu),c=xt(t,o),l=g.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const f=new CustomEvent(B2,{bubbles:!0,cancelable:!0});d.addEventListener(B2,p=>r==null?void 0:r(p),{once:!0}),HTe(d,f),f.defaultPrevented?l.current=!1:i.onClose()}};return h.jsx(z2,{...a,ref:c,disabled:n,onClick:ge(e.onClick,u),onPointerDown:d=>{var f;(f=e.onPointerDown)==null||f.call(e,d),l.current=!0},onPointerUp:ge(e.onPointerUp,d=>{var f;l.current||((f=d.currentTarget)==null||f.click())}),onKeyDown:ge(e.onKeyDown,d=>{const f=s.searchRef.current!=="";n||f&&d.key===" "||Qp.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});eh.displayName=Yp;var z2=g.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...o}=e,i=Ab(Yp,n),s=Cb(n),c=g.useRef(null),l=xt(t,c),[u,d]=g.useState(!1),[f,p]=g.useState("");return g.useEffect(()=>{const y=c.current;y&&p((y.textContent??"").trim())},[o.children]),h.jsx(nc.ItemSlot,{scope:n,disabled:r,textValue:a??f,children:h.jsx(Yl,{asChild:!0,...s,focusable:!r,children:h.jsx(Ae.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:l,onPointerMove:ge(e.onPointerMove,Nu(y=>{r?i.onItemLeave(y):(i.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ge(e.onPointerLeave,Nu(y=>i.onItemLeave(y))),onFocus:ge(e.onFocus,()=>d(!0)),onBlur:ge(e.onBlur,()=>d(!1))})})})}),lee="MenuCheckboxItem",V2=g.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return h.jsx(Z2,{scope:e.__scopeMenu,checked:n,children:h.jsx(eh,{role:"menuitemcheckbox","aria-checked":th(n)?"mixed":n,...a,ref:t,"data-state":Lb(n),onSelect:ge(a.onSelect,()=>r==null?void 0:r(th(n)?!0:!n),{checkForDefaultPrevented:!1})})})});V2.displayName=lee;var q2="MenuRadioGroup",[uee,dee]=si(q2,{value:void 0,onValueChange:()=>{}}),U2=g.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,o=sr(r);return h.jsx(uee,{scope:e.__scopeMenu,value:n,onValueChange:o,children:h.jsx(Rb,{...a,ref:t})})});U2.displayName=q2;var W2="MenuRadioItem",H2=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=dee(W2,e.__scopeMenu),o=n===a.value;return h.jsx(Z2,{scope:e.__scopeMenu,checked:o,children:h.jsx(eh,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":Lb(o),onSelect:ge(r.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,n)},{checkForDefaultPrevented:!1})})})});H2.displayName=W2;var Ib="MenuItemIndicator",[Z2,fee]=si(Ib,{checked:!1}),K2=g.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,o=fee(Ib,n);return h.jsx(Ir,{present:r||th(o.checked)||o.checked===!0,children:h.jsx(Ae.span,{...a,ref:t,"data-state":Lb(o.checked)})})});K2.displayName=Ib;var pee="MenuSeparator",X2=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});X2.displayName=pee;var hee="MenuArrow",G2=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=rc(n);return h.jsx(cb,{...a,...r,ref:t})});G2.displayName=hee;var Db="MenuSub",[mee,Q2]=si(Db),J2=e=>{const{__scopeMenu:t,children:n,open:r=!1,onOpenChange:a}=e,o=ho(Db,t),i=rc(t),[s,c]=g.useState(null),[l,u]=g.useState(null),d=sr(a);return g.useEffect(()=>(o.open===!1&&d(!1),()=>d(!1)),[o.open,d]),h.jsx(Up,{...i,children:h.jsx(Nb,{scope:t,open:r,onOpenChange:d,content:l,onContentChange:u,children:h.jsx(mee,{scope:t,contentId:Tt(),triggerId:Tt(),trigger:s,onTriggerChange:c,children:n})})})};J2.displayName=Db;var Cu="MenuSubTrigger",Y2=g.forwardRef((e,t)=>{const n=ho(Cu,e.__scopeMenu),r=ac(Cu,e.__scopeMenu),a=Q2(Cu,e.__scopeMenu),o=Ab(Cu,e.__scopeMenu),i=g.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:c}=o,l={__scopeMenu:e.__scopeMenu},u=g.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return g.useEffect(()=>u,[u]),g.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),c(null)}},[s,c]),h.jsx(Pb,{asChild:!0,...l,children:h.jsx(z2,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":nT(n.open),...e,ref:NK(t,a.onTriggerChange),onClick:d=>{var f;(f=e.onClick)==null||f.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ge(e.onPointerMove,Nu(d=>{o.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ge(e.onPointerLeave,Nu(d=>{var p,y;u();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const m=(y=n.content)==null?void 0:y.dataset.side,v=m==="right",b=v?-5:5,w=f[v?"left":"right"],_=f[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+b,y:d.clientY},{x:w,y:f.top},{x:_,y:f.top},{x:_,y:f.bottom},{x:w,y:f.bottom}],side:m}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:ge(e.onKeyDown,d=>{var p;const f=o.searchRef.current!=="";e.disabled||f&&d.key===" "||k2[r.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});Y2.displayName=Cu;var eT="MenuSubContent",tT=g.forwardRef((e,t)=>{const n=D2(Er,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=ho(Er,e.__scopeMenu),i=ac(Er,e.__scopeMenu),s=Q2(eT,e.__scopeMenu),c=g.useRef(null),l=xt(t,c);return h.jsx(nc.Provider,{scope:e.__scopeMenu,children:h.jsx(Ir,{present:r||o.open,children:h.jsx(nc.Slot,{scope:e.__scopeMenu,children:h.jsx(Tb,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:l,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;i.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ge(e.onFocusOutside,u=>{u.target!==s.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:ge(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:ge(e.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),f=A2[i.dir].includes(u.key);d&&f&&(o.onOpenChange(!1),(p=s.trigger)==null||p.focus(),u.preventDefault())})})})})})});tT.displayName=eT;function nT(e){return e?"open":"closed"}function th(e){return e==="indeterminate"}function Lb(e){return th(e)?"indeterminate":e?"checked":"unchecked"}function yee(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function gee(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function vee(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=gee(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function bee(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function wee(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return bee(n,t)}function Nu(e){return t=>t.pointerType==="mouse"?e(t):void 0}var rT=Mb,aT=Pb,oT=L2,iT=$2,sT=Rb,cT=F2,lT=eh,uT=V2,dT=U2,fT=H2,pT=K2,hT=X2,mT=G2,xee=J2,yT=Y2,gT=tT,$b="DropdownMenu",[_ee,RRe]=ir($b,[Jp]),Pn=Jp(),[jee,vT]=_ee($b),bT=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:o,onOpenChange:i,modal:s=!0}=e,c=Pn(t),l=g.useRef(null),[u=!1,d]=Nn({prop:a,defaultProp:o,onChange:i});return h.jsx(jee,{scope:t,triggerId:Tt(),triggerRef:l,contentId:Tt(),open:u,onOpenChange:d,onOpenToggle:g.useCallback(()=>d(f=>!f),[d]),modal:s,children:h.jsx(rT,{...c,open:u,onOpenChange:d,dir:r,modal:s,children:n})})};bT.displayName=$b;var wT="DropdownMenuTrigger",xT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,o=vT(wT,n),i=Pn(n);return h.jsx(aT,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:NK(t,o.triggerRef),onPointerDown:ge(e.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(o.onOpenToggle(),o.open||s.preventDefault())}),onKeyDown:ge(e.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&o.onOpenToggle(),s.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});xT.displayName=wT;var See="DropdownMenuPortal",_T=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Pn(t);return h.jsx(oT,{...r,...n})};_T.displayName=See;var jT="DropdownMenuContent",ST=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=vT(jT,n),o=Pn(n),i=g.useRef(!1);return h.jsx(iT,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...r,ref:t,onCloseAutoFocus:ge(e.onCloseAutoFocus,s=>{var c;i.current||((c=a.triggerRef.current)==null||c.focus()),i.current=!1,s.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,s=>{const c=s.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!a.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});ST.displayName=jT;var Eee="DropdownMenuGroup",ET=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(sT,{...a,...r,ref:t})});ET.displayName=Eee;var Oee="DropdownMenuLabel",OT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(cT,{...a,...r,ref:t})});OT.displayName=Oee;var Cee="DropdownMenuItem",CT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(lT,{...a,...r,ref:t})});CT.displayName=Cee;var Nee="DropdownMenuCheckboxItem",NT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(uT,{...a,...r,ref:t})});NT.displayName=Nee;var Mee="DropdownMenuRadioGroup",MT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(dT,{...a,...r,ref:t})});MT.displayName=Mee;var Pee="DropdownMenuRadioItem",PT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(fT,{...a,...r,ref:t})});PT.displayName=Pee;var kee="DropdownMenuItemIndicator",kT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(pT,{...a,...r,ref:t})});kT.displayName=kee;var Aee="DropdownMenuSeparator",AT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(hT,{...a,...r,ref:t})});AT.displayName=Aee;var Tee="DropdownMenuArrow",Ree=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(mT,{...a,...r,ref:t})});Ree.displayName=Tee;var Iee=e=>{const{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:a,defaultOpen:o}=e,i=Pn(t),[s=!1,c]=Nn({prop:r,defaultProp:o,onChange:a});return h.jsx(xee,{...i,open:s,onOpenChange:c,children:n})},Dee="DropdownMenuSubTrigger",TT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(yT,{...a,...r,ref:t})});TT.displayName=Dee;var Lee="DropdownMenuSubContent",RT=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Pn(n);return h.jsx(gT,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});RT.displayName=Lee,UM=bT,WM=xT,qM=_T,kv=ST,VM=ET,$v=OT,Rv=CT,Iv=NT,WK=MT,Lv=PT,Dv=kT,Fv=AT,HK=Iee,Av=TT,Tv=RT;const $ee=UM,Fee=WM,Bee=VM,zee=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(Av,{ref:a,className:K("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r,children:[n,h.jsx(fe,{name:"chevron-right",className:"ml-auto"})]}));zee.displayName=Av.displayName;const Vee=g.forwardRef(({className:e,...t},n)=>h.jsx(Tv,{ref:n,className:K("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Vee.displayName=Tv.displayName;const IT=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(qM,{children:h.jsx(kv,{ref:r,sideOffset:t,className:K("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));IT.displayName=kv.displayName;const DT=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(Rv,{ref:r,className:K("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n}));DT.displayName=Rv.displayName;const qee=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(Iv,{ref:a,className:K("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(Dv,{children:h.jsx(fe,{name:"check",className:"h-4 w-4"})})}),t]}));qee.displayName=Iv.displayName;const Uee=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(Lv,{ref:r,className:K("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(Dv,{children:h.jsx(fe,{name:"circle",className:"h-4 w-4"})})}),t]}));Uee.displayName=Lv.displayName;const Wee=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx($v,{ref:r,className:K("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));Wee.displayName=$v.displayName;const Hee=g.forwardRef(({className:e,...t},n)=>h.jsx(Fv,{ref:n,className:K("-mx-1 my-1 h-px bg-muted",e),...t}));Hee.displayName=Fv.displayName;function Zee(){const{t:e}=Pe("sidebar"),{isMobile:t}=xu();return h.jsx(Ys,{children:h.jsx(so,{children:h.jsxs($ee,{children:[h.jsx(Fee,{asChild:!0,children:h.jsxs(co,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[h.jsx("div",{children:h.jsx(fe,{name:"settings",size:28,className:"pr-2"})}),h.jsx(fe,{name:"chevrons-up-down",className:"ml-auto size-4"})]})}),h.jsx(IT,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:t?"bottom":"right",align:"end",sideOffset:4,children:h.jsx(Bee,{children:h.jsxs(DT,{children:[h.jsx(fe,{name:"sparkles"}),e("contact")]})})})]})})})}function Kee({applications:e,currentSession:t,setCurrentSession:n}){const{t:r}=Pe("sidebar"),a=Bi(),{applicationId:o}=bp(),[i,s]=g.useState(),c=Jt(w2),l=g.useCallback((f,p)=>{f.preventDefault(),f.stopPropagation(),c.show({id:p})},[c]),u=async f=>{try{s(f.id),n(f),a(xn("application",{applicationId:f.id}))}catch(p){console.error(p),s(void 0)}},d=f=>{switch(f.main_source_type){case"Thread":return h.jsx(fe,{className:"inline-flex items-center ml-2",name:"message-circle-more",size:14});default:return null}};return g.useEffect(()=>{!i||i!==(t==null?void 0:t.id)||s(void 0)},[i,t==null?void 0:t.id]),h.jsxs(_u,{className:"group-data-[collapsible=icon]:hidden pt-0",children:[h.jsx(ju,{children:h.jsx("div",{className:"text-sm",children:r("applications")})}),h.jsxs(Ys,{children:[e==null?void 0:e.map(f=>h.jsx(so,{className:"cursor-pointer",children:h.jsx(co,{disabled:!!i,asChild:!0,onClick:()=>u(f),children:h.jsxs("div",{className:"flex flex-row justify-between items-center !h-auto",children:[h.jsxs("div",{className:"flex gap-2",children:[f.id===i?h.jsx(fe,{size:16,name:"loader",className:"animate-spin"}):o===f.id?h.jsx(fe,{size:16,color:"green",name:"check"}):h.jsx(fe,{size:16,name:"chevron-right"}),h.jsxs("span",{children:[f.name,d(f)]})]}),h.jsx(fe,{onClick:p=>l(p,f.id),size:16,className:"!z-50",name:"trash-2"})]})})},f.id)),e?h.jsx(so,{children:h.jsxs(co,{className:"text-sidebar-foreground/70",children:[h.jsx(fe,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}const Xee={navMain:[{title:"playground.title",icon:h.jsx(fe,{name:"square-terminal"}),isActive:!0,items:[{title:"playground.nodes",id:"nodes"},{title:"playground.connections",id:"connections"}]},{title:"model.title",url:"#",icon:h.jsx(fe,{name:"bot"}),items:[{title:"model.llm",id:"llm"},{title:"model.embedding",id:"embedding"}]},{title:"tutorial.title",icon:h.jsx(fe,{name:"book-open"}),items:[{title:"tutorial.get_started",id:"get-started"},{title:"tutorial.simple_workflow",id:"simple-workflow"},{title:"tutorial.ai_structured_output",id:"ai-structured-output"},{title:"tutorial.standalone_chat_application",id:"chat-application"},{title:"tutorial.standalone_editor_application",id:"editor-application"},{title:"tutorial.tool_calling",id:"tool-calling"},{title:"tutorial.vector_database",id:"vector-database"}]},{title:"application.title",icon:h.jsx(fe,{name:"settings-2"}),items:[{title:"application.chat",id:"chat"},{title:"application.editor",id:"editor"},{title:"application.vslite",id:"vslite"}]}]};function Gee({sessions:e,applications:t,currentSession:n,setCurrentSession:r,...a}){return h.jsxs(hb,{collapsible:"offcanvas",...a,children:[h.jsx("div",{className:"h-1"}),h.jsxs(yb,{children:[h.jsx(ZY,{sessions:e||[],currentSession:n,setCurrentSession:r}),h.jsx(Kee,{applications:t||[],currentSession:n,setCurrentSession:r}),h.jsx(MY,{items:Xee.navMain})]}),h.jsx(QA,{children:h.jsx(Zee,{})}),h.jsx(GA,{})]})}Zn=g.memo(e=>{const{loading:t,...n}=e;return h.jsx(ut,{...n,disabled:e.disabled||t,children:t?h.jsx(fe,{name:"loader-circle",className:"animate-spin"}):e.children})});function Qee({className:e,onProcess:t=async()=>(await new Promise(a=>setTimeout(a,2e3)),Math.random()>.5),processDuration:n=2e3,...r}){const[a,o]=g.useState(!1),[i,s]=g.useState(null),[c,l]=g.useState(!1),[,u]=g.useState(0);g.useEffect(()=>{if(a){const f=Date.now(),p=setInterval(()=>{const y=(Date.now()-f)/n*100;y>=100?(clearInterval(p),u(100)):u(y)},10);return()=>clearInterval(p)}},[a,n]);async function d(){if(a)return;o(!0),s(null),u(0),await new Promise(p=>setTimeout(p,n));const f=t?await t():!0;s(f),o(!1),l(!0),setTimeout(()=>{s(null),u(0),l(!1)},2e3)}return h.jsx(ut,{className:K("relative group","transition-all duration-300",a&&"cursor-wait",e),variant:"ghost",onClick:d,disabled:a,...r,children:h.jsx("div",{className:K("w-full flex items-center justify-center gap-2",c&&"animate-[scale_300ms_ease-in-out]"),children:i===null?h.jsx(h.Fragment,{children:h.jsx(fe,{name:"forward",className:K("w-4 h-4 transition-transform duration-200","group-hover:scale-110",a&&"animate-bounce")})}):i?h.jsx(h.Fragment,{children:h.jsx(fe,{name:"check",className:"w-4 h-4 text-green-500"})}):h.jsx(h.Fragment,{children:h.jsx(fe,{name:"x",className:"w-4 h-4 text-red-500"})})})})}const Pa="NOLLM",Jee="0123456789abcdef",Yee=[8,4,4,4,12];function Mu(){return Yee.map(e=>ZTe(Jee,e)()).join("-")}const ete=()=>{const e=Ye(t=>t.currentSession);return{exportSession:g.useCallback(async()=>{if(!(e!=null&&e.id))return;const t={},n={},r=Object.keys(MK).filter(c=>c!=="Session");await Promise.all(r.map(c=>de(c).find({where:{session_id:e.id}}).then(l=>{l.map(u=>{n[u.id]=u.id}),t[c]=l}))),Object.keys(n).forEach(c=>{n[c]=`[ID_${Mu()}]`});let a=JSON.stringify({[Pa]:{key:e.id,session:Object.entries(e).reduce((c,[l,u])=>((typeof u!="object"||u===null)&&(c[l]=u),u===void 0&&(c[l]=null),c),{}),ids:Object.keys(n)},...t});Object.keys(n).forEach(c=>{a=a.replace(new RegExp(c,"g"),n[c])}),a=a.replace(new RegExp(e.id,"g"),"[SESSION_ID]");const o=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=`${e.name}_${new Date}.json`,s.click()},[e])}},tte=()=>{const[e,t]=g.useState(!1),n=Bi(),r=g.useCallback((o,{idMap:i,newSessionId:s,replaceItem:c})=>{const l=o;return{...Object.keys(l).reduce((u,d)=>(l[d]&&typeof l[d]=="string"&&i[l[d]]?u[d]=i[l[d]]:d==="session_id"&&s?u[d]=s:u[d]=l[d],u),{}),...c||{}}},[]),a=g.useCallback(async o=>{try{t(!0);const i=Object.keys(MK).filter(d=>d!==Pa);if(!Object.keys(o[Pa]).length||typeof o[Pa]!="object")throw new Error("Missing Metadata");if(!("session"in o[Pa])||!o[Pa].session)throw new Error("Missing Session Metadata");const s=o[Pa].session;if(!("ids"in o[Pa]))throw new Error("Missing Session ID");const c=o[Pa].ids.reduce((d,f)=>(d[f]=Mu(),d),{}),l=Object.keys(o).filter(d=>d!==Pa);if(!l.every(d=>i.includes(d)))throw new Error("Invalid JSON keys");if(!l.every(d=>Array.isArray(o[d])))throw new Error("Invalid JSON values");l.forEach(d=>{o[d].forEach(f=>{if("session_id"in f&&f.session_id!=="[SESSION_ID]")throw new Error("Invalid JSON values")})});const u=await de("Session").save(r(s,{idMap:c,newSessionId:"",replaceItem:{id:void 0}}));if(!u)throw new Error("Failed to import session");await Promise.all(i.map(d=>{const f=o[d];if(!f||!f.length)return Promise.resolve();const p=f.map(y=>r(y,{idMap:c,newSessionId:u.id}));return de(d).save(p)})),u.type===ql.Whiteboard?n(xn("whiteboard",{sessionId:u.id})):u.type===ql.StandaloneApp&&n(xn("application",{applicationId:u.id}))}finally{t(!1)}},[n,r]);return{loading:e,importSession:a}};function nte(){const{t:e}=Pe("tooltips"),t=Ea(),n=Ps(f=>f.setTheme),r=Ps(f=>f.theme),{exportSession:a}=ete(),{loading:o,importSession:i}=tte(),s=g.useRef(null),c=g.useCallback(()=>{n(r==="dark"?"light":"dark")},[r,n]),l=g.useCallback(async()=>{try{return await a(),!0}catch(f){return ks(f),!1}},[a]),u=g.useCallback(async f=>{var p;try{const y=(p=f.target.files)==null?void 0:p[0];if(!y)return;const m=await new Promise((v,b)=>{const w=new FileReader;w.onload=_=>{var x;try{const j=(x=_.target)==null?void 0:x.result;v(JSON.parse(j))}catch(j){b(j)}},w.onerror=_=>{b(_)},w.readAsText(y)});await i(m)}catch(y){return ks(y),!1}},[i]),d=g.useMemo(()=>{if(t.pathname.includes(xn("whiteboard")))return e("whiteboard");if(t.pathname.includes(xn("application")))return e("apllication")},[t.pathname,e]);return h.jsxs("header",{className:"flex h-14 shrink-0 items-center gap-2 transition-[width,height] ease-linear justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2 px-4",children:[h.jsx(XA,{}),h.jsx(nt,{children:d})]}),h.jsx("div",{className:"flex items-center pl-4 pr-2",children:h.jsxs(wu,{children:[h.jsxs(Na,{children:[h.jsx(Ma,{children:h.jsxs(Zn,{loading:o,variant:"ghost",onClick:()=>{var f;return(f=s.current)==null?void 0:f.click()},children:[h.jsx(fe,{size:18,name:"import"}),h.jsx("input",{ref:s,type:"file",accept:".json",onChange:u,className:"hidden"},`${Date.now()}`)]})}),h.jsx(Hr,{children:h.jsx("p",{children:e("import")})})]}),h.jsxs(Na,{children:[h.jsx(Ma,{children:h.jsx(Qee,{onProcess:l})}),h.jsx(Hr,{children:h.jsx("p",{children:e("export")})})]}),h.jsxs(Na,{children:[h.jsx(Ma,{children:h.jsx(ut,{disabled:o,onClick:c,variant:"ghost",children:h.jsx(fe,{size:18,name:r==="dark"?"moon":"sun"})})}),h.jsx(Hr,{children:h.jsx("p",{children:e("theme")})})]}),h.jsxs(Na,{children:[h.jsx(Ma,{children:h.jsx(ut,{variant:"link",children:h.jsx("a",{referrerPolicy:"no-referrer",target:"_blank",href:"https://github.com/zrg-team/NoLLMChat",children:h.jsx(fe,{size:18,name:"github"})})})}),h.jsx(Hr,{children:h.jsx("p",{children:"https://github.com/zrg-team/NoLLMChat"})})]})]})})]})}function LT({requiredSession:e}){const t=bp(),n=Bi(),r=Ea(),a=g.useRef(r),o=Ye(l=>l.currentSession),i=Ye(l=>l.sessions),s=Ye(l=>l.applications),c=Ye(l=>l.setCurrentSession);return a.current=r,g.useEffect(()=>{!(o!=null&&o.id)||!e||(r.pathname.includes(xn("whiteboard"))?t.sessionId?t.sessionId&&t.sessionId!==(o==null?void 0:o.id)&&c(t.sessionId):n(xn("whiteboard",{sessionId:o==null?void 0:o.id})):r.pathname.includes(xn("application"))&&(t.applicationId?t.applicationId&&t.applicationId!==(o==null?void 0:o.id)&&c(t.applicationId):n(xn("application",{applicationId:o==null?void 0:o.id}))))},[o==null?void 0:o.id,r.pathname,n,t.applicationId,t.sessionId,e,c]),g.useEffect(()=>{e&&c(t.sessionId||t.applicationId).then(l=>{!l||NY().has("flow")&&l.type===ql.StandaloneApp||(l.type===ql.StandaloneApp&&a.current.pathname.includes(xn("whiteboard").replace("/",""))?n(xn("application",{applicationId:l.id})):l.type===ql.Whiteboard&&a.current.pathname.includes(xn("application").replace("/",""))&&n(xn("whiteboard",{sessionId:l.id})))})},[n,t.applicationId,t.sessionId,e,c]),h.jsxs(pb,{defaultOpen:!1,children:[h.jsx(Gee,{sessions:i,applications:s,currentSession:o,setCurrentSession:c}),h.jsxs(mb,{className:"max-h-screen overflow-hidden",children:[h.jsx(nte,{}),h.jsx(Ls,{className:"shrink-0"}),h.jsx("div",{className:"flex flex-1 flex-col p-0 m-0 overflow-y-auto",children:h.jsx(SG,{})})]})]})}const $T=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx("div",{className:K("flex flex-col w-full h-full p-4 gap-6 overflow-y-auto",e),ref:r,...n,children:t}));$T.displayName="ChatMessageList";var FT="vercel.ai.error",rte=Symbol.for(FT),BT,ate=class XK extends Error{constructor({name:t,message:n,cause:r}){super(n),this[BT]=!0,this.name=t,this.cause=r}static isInstance(t){return XK.hasMarker(t,FT)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};BT=rte;var oc=ate;function zT(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var VT="AI_InvalidArgumentError",qT=`vercel.ai.error.${VT}`,ote=Symbol.for(qT),UT,ite=class extends oc{constructor({message:e,cause:t,argument:n}){super({name:VT,message:e,cause:t}),this[UT]=!0,this.argument=n}static isInstance(e){return oc.hasMarker(e,qT)}};UT=ote;var WT="AI_JSONParseError",HT=`vercel.ai.error.${WT}`,ste=Symbol.for(HT),ZT,KT=class extends oc{constructor({text:e,cause:t}){super({name:WT,message:`JSON parsing failed: Text: ${e}.
Error message: ${zT(t)}`,cause:t}),this[ZT]=!0,this.text=e}static isInstance(e){return oc.hasMarker(e,HT)}};ZT=ste;var XT="AI_TypeValidationError",GT=`vercel.ai.error.${XT}`,cte=Symbol.for(GT),QT,lte=class uP extends oc{constructor({value:t,cause:n}){super({name:XT,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${zT(n)}`,cause:n}),this[QT]=!0,this.value=t}static isInstance(t){return oc.hasMarker(t,GT)}static wrap({value:t,cause:n}){return uP.isInstance(n)&&n.value===t?n:new uP({value:t,cause:n})}};QT=cte;var JT=lte;let ute=(e,t=21)=>(n=t)=>{let r="",a=n;for(;a--;)r+=e[Math.random()*e.length|0];return r};var Wi={exports:{}},YT;function dte(){if(YT)return Wi.exports;YT=1;const e=typeof vn<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(s,c,l){l==null&&c!==null&&typeof c=="object"&&(l=c,c=void 0),e&&vn.isBuffer(s)&&(s=s.toString()),s&&s.charCodeAt(0)===65279&&(s=s.slice(1));const u=JSON.parse(s,c);if(u===null||typeof u!="object")return u;const d=l&&l.protoAction||"error",f=l&&l.constructorAction||"error";if(d==="ignore"&&f==="ignore")return u;if(d!=="ignore"&&f!=="ignore"){if(t.test(s)===!1&&n.test(s)===!1)return u}else if(d!=="ignore"&&f==="ignore"){if(t.test(s)===!1)return u}else if(n.test(s)===!1)return u;return a(u,{protoAction:d,constructorAction:f,safe:l&&l.safe})}function a(s,{protoAction:c="error",constructorAction:l="error",safe:u}={}){let d=[s];for(;d.length;){const f=d;d=[];for(const p of f){if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"__proto__")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.__proto__}if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"constructor")&&Object.prototype.hasOwnProperty.call(p.constructor,"prototype")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.constructor}for(const y in p){const m=p[y];m&&typeof m=="object"&&d.push(m)}}}return s}function o(s,c,l){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,l)}finally{Error.stackTraceLimit=u}}function i(s,c){const l=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=l}}return Wi.exports=o,Wi.exports.default=o,Wi.exports.parse=o,Wi.exports.safeParse=i,Wi.exports.scan=a,Wi.exports}var fte=dte();const pte=ot(fte);var hte=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=ute(n,t);if(e==null)return a;if(n.includes(r))throw new ite({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return o=>`${e}${r}${a(o)}`},eR=hte(),Fb=Symbol.for("vercel.ai.validator");function mte(e){return{[Fb]:!0,validate:e}}function yte(e){return typeof e=="object"&&e!==null&&Fb in e&&e[Fb]===!0&&"validate"in e}function gte(e){return yte(e)?e:vte(e)}function vte(e){return mte(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function bte({value:e,schema:t}){const n=gte(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:JT.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:JT.wrap({value:e,cause:r})}}}function tR({text:e,schema:t}){try{const n=pte.parse(e);return t==null?{success:!0,value:n}:bte({value:n,schema:t})}catch(n){return{success:!1,error:KT.isInstance(n)?n:new KT({text:e,cause:n})}}}var nh={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},rh={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},ah={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},oh={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},ih={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},wte=[nh,rh,ah,oh,ih];nh.code+"",rh.code+"",ah.code+"",oh.code+"",ih.code+"",nh.name+"",nh.code,rh.name+"",rh.code,ah.name+"",ah.code,oh.name+"",oh.code,ih.name+"",ih.code,wte.map(e=>e.code);function xte(e){const t=["ROOT"];let n=-1,r=null;function a(c,l,u){switch(c){case'"':{n=l,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=l,r=l,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=l,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=l,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function o(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=l,t.pop();break}}}function i(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}}}for(let c=0;c<e.length;c++){const l=e[c];switch(t[t.length-1]){case"ROOT":a(l,c,"FINISH");break;case"INSIDE_OBJECT_START":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=c,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(l){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{a(l,c,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{o(l,c);break}case"INSIDE_STRING":{switch(l){case'"':{t.pop(),n=c;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=c}break}case"INSIDE_ARRAY_START":{switch(l){case"]":{n=c,t.pop();break}default:{n=c,a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}default:{n=c;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=c;break}case"INSIDE_NUMBER":{switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const u=e.substring(r,c+1);!"false".startsWith(u)&&!"true".startsWith(u)&&!"null".startsWith(u)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?o(l,c):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c)):n=c;break}}}let s=e.slice(0,n+1);for(let c=t.length-1;c>=0;c--)switch(t[c]){case"INSIDE_STRING":{s+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{s+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{s+="]";break}case"INSIDE_LITERAL":{const l=e.substring(r,e.length);"true".startsWith(l)?s+="true".slice(l.length):"false".startsWith(l)?s+="false".slice(l.length):"null".startsWith(l)&&(s+="null".slice(l.length))}}return s}function _te(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=tR({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=tR({text:xte(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var Pu={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},ku={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},Au={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Tu={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},Ru={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},Iu={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},Du={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},Lu={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},$u={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Fu={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},jte=[Pu,ku,Au,Tu,Ru,Iu,Du,Lu,$u,Fu],Ste={[Pu.code]:Pu,[ku.code]:ku,[Au.code]:Au,[Tu.code]:Tu,[Ru.code]:Ru,[Iu.code]:Iu,[Du.code]:Du,[Lu.code]:Lu,[$u.code]:$u,[Fu.code]:Fu};Pu.name+"",Pu.code,ku.name+"",ku.code,Au.name+"",Au.code,Tu.name+"",Tu.code,Ru.name+"",Ru.code,Iu.name+"",Iu.code,Du.name+"",Du.code,Lu.name+"",Lu.code,$u.name+"",$u.code,Fu.name+"",Fu.code;var Ete=jte.map(e=>e.code),Ote=e=>{const t=e.indexOf(":");if(t===-1)throw new Error("Failed to parse stream string. No separator found.");const n=e.slice(0,t);if(!Ete.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const r=n,a=e.slice(t+1),o=JSON.parse(a);return Ste[r].parse(o)},Cte=10;function Nte(e,t){const n=new Uint8Array(t);let r=0;for(const a of e)n.set(a,r),r+=a.length;return e.length=0,n}async function Mte({stream:e,onTextPart:t,onDataPart:n,onErrorPart:r,onToolCallStreamingStartPart:a,onToolCallDeltaPart:o,onToolCallPart:i,onToolResultPart:s,onMessageAnnotationsPart:c,onFinishMessagePart:l,onFinishStepPart:u}){const d=e.getReader(),f=new TextDecoder,p=[];let y=0;for(;;){const{value:m}=await d.read();if(m&&(p.push(m),y+=m.length,m[m.length-1]!==Cte))continue;if(p.length===0)break;const v=Nte(p,y);y=0;const b=f.decode(v,{stream:!0}).split(`
`).filter(w=>w!=="").map(Ote);for(const{type:w,value:_}of b)switch(w){case"text":await(t==null?void 0:t(_));break;case"data":await(n==null?void 0:n(_));break;case"error":await(r==null?void 0:r(_));break;case"message_annotations":await(c==null?void 0:c(_));break;case"tool_call_streaming_start":await(a==null?void 0:a(_));break;case"tool_call_delta":await(o==null?void 0:o(_));break;case"tool_call":await(i==null?void 0:i(_));break;case"tool_result":await(s==null?void 0:s(_));break;case"finish_message":await(l==null?void 0:l(_));break;case"finish_step":await(u==null?void 0:u(_));break;default:{const x=w;throw new Error(`Unknown stream part type: ${x}`)}}}}function Pte({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}async function kte({stream:e,update:t,onToolCall:n,onFinish:r,generateId:a=eR,getCurrentDate:o=()=>new Date}){const i=o();let s,c=!0;const l=[],u=[];let d;const f={};let p={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},y="unknown";function m(){const b=[...u];if(s==null){t(l,b);return}d!=null&&d.length&&(s.annotations=d);const w={...JSON.parse(JSON.stringify(s)),revisionId:a()};t([...l,w],b)}function v(){return(c||s==null)&&(s!=null&&l.push(s),c=!1,s={id:a(),role:"assistant",content:"",createdAt:i}),s}await Mte({stream:e,onTextPart(b){const w=v();s={...w,content:w.content+b},m()},onToolCallStreamingStartPart(b){const w=v();w.toolInvocations==null&&(w.toolInvocations=[]),f[b.toolCallId]={text:"",toolName:b.toolName,index:w.toolInvocations.length},w.toolInvocations.push({state:"partial-call",toolCallId:b.toolCallId,toolName:b.toolName,args:void 0}),m()},onToolCallDeltaPart(b){const w=v(),_=f[b.toolCallId];_.text+=b.argsTextDelta;const{value:x}=_te(_.text);w.toolInvocations[_.index]={state:"partial-call",toolCallId:b.toolCallId,toolName:_.toolName,args:x},m()},async onToolCallPart(b){const w=v();if(f[b.toolCallId]!=null?w.toolInvocations[f[b.toolCallId].index]={state:"call",...b}:(w.toolInvocations==null&&(w.toolInvocations=[]),w.toolInvocations.push({state:"call",...b})),n){const _=await n({toolCall:b});_!=null&&(w.toolInvocations[w.toolInvocations.length-1]={state:"result",...b,result:_})}m()},onToolResultPart(b){const w=v().toolInvocations;if(w==null)throw new Error("tool_result must be preceded by a tool_call");const _=w.findIndex(x=>x.toolCallId===b.toolCallId);if(_===-1)throw new Error("tool_result must be preceded by a tool_call with the same toolCallId");w[_]={...w[_],state:"result",...b},m()},onDataPart(b){u.push(...b),m()},onMessageAnnotationsPart(b){d==null?d=[...b]:d.push(...b),m()},onFinishStepPart(b){c=!b.isContinued},onFinishMessagePart(b){y=b.finishReason,b.usage!=null&&(p=Pte(b.usage))},onErrorPart(b){throw new Error(b)}}),r==null||r({message:s,finishReason:y,usage:p})}async function Ate({stream:e,onTextPart:t}){const n=e.pipeThrough(new TextDecoderStream).getReader();for(;;){const{done:r,value:a}=await n.read();if(r)break;await t(a)}}var Tte=()=>fetch;async function Rte({api:e,body:t,streamProtocol:n="data",credentials:r,headers:a,abortController:o,restoreMessagesOnFailure:i,onResponse:s,onUpdate:c,onFinish:l,onToolCall:u,generateId:d,fetch:f=Tte()}){var p,y;const m=await f(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",...a},signal:(p=o==null?void 0:o())==null?void 0:p.signal,credentials:r}).catch(v=>{throw i(),v});if(s)try{await s(m)}catch(v){throw v}if(!m.ok)throw i(),new Error((y=await m.text())!=null?y:"Failed to fetch the chat response.");if(!m.body)throw new Error("The response body is empty.");switch(n){case"text":{const v={id:d(),createdAt:new Date,role:"assistant",content:""};await Ate({stream:m.body,onTextPart:b=>{v.content+=b,c([{...v}],[])}}),l==null||l(v,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"});return}case"data":{await kte({stream:m.body,update:c,onToolCall:u,onFinish({message:v,finishReason:b,usage:w}){l&&v!=null&&l(v,{usage:w,finishReason:b})},generateId:d});return}default:{const v=n;throw new Error(`Unknown stream protocol: ${v}`)}}}var nR={exports:{}},Bb={},rR;function Ite(){if(rR)return Bb;rR=1;var e=PK();function t(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,a=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function s(d,f){var p=f(),y=r({inst:{value:p,getSnapshot:f}}),m=y[0].inst,v=y[1];return o(function(){m.value=p,m.getSnapshot=f,c(m)&&v({inst:m})},[d,p,f]),a(function(){return c(m)&&v({inst:m}),d(function(){c(m)&&v({inst:m})})},[d]),i(p),p}function c(d){var f=d.getSnapshot;d=d.value;try{var p=f();return!n(d,p)}catch{return!0}}function l(d,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:s;return Bb.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,Bb}var aR;function oR(){return aR||(aR=1,nR.exports=Ite()),nR.exports}rp=oR();let mo,Bn,sh,ct,Zr,yo,iR,Bu;UK=ot(rp),mo=()=>{},Bn=mo(),sh=Object,ct=e=>e===Bn,Zr=e=>typeof e=="function",yo=(e,t)=>({...e,...t}),iR=e=>Zr(e.then),Bu=new WeakMap;let Dte=0;const zu=e=>{const t=typeof e,n=e&&e.constructor,r=n==Date;let a,o;if(sh(e)===e&&!r&&n!=RegExp){if(a=Bu.get(e),a)return a;if(a=++Dte+"~",Bu.set(e,a),n==Array){for(a="@",o=0;o<e.length;o++)a+=zu(e[o])+",";Bu.set(e,a)}if(n==sh){a="#";const i=sh.keys(e).sort();for(;!ct(o=i.pop());)ct(e[o])||(a+=o+":"+zu(e[o])+",");Bu.set(e,a)}}else a=r?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return a},go=new WeakMap,zb={},ch={},Vb="undefined",lh=typeof window!=Vb,qb=typeof document!=Vb,Lte=()=>lh&&typeof window.requestAnimationFrame!=Vb,sR=(e,t)=>{const n=go.get(e);return[()=>!ct(t)&&e.get(t)||zb,r=>{if(!ct(t)){const a=e.get(t);t in ch||(ch[t]=a),n[5](t,yo(a,r),a||zb)}},n[6],()=>!ct(t)&&t in ch?ch[t]:!ct(t)&&e.get(t)||zb]};let Ub=!0;const $te=()=>Ub,[Wb,Hb]=lh&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[mo,mo],Fte=()=>{const e=qb&&document.visibilityState;return ct(e)||e!=="hidden"},Bte=e=>(qb&&document.addEventListener("visibilitychange",e),Wb("focus",e),()=>{qb&&document.removeEventListener("visibilitychange",e),Hb("focus",e)}),zte=e=>{const t=()=>{Ub=!0,e()},n=()=>{Ub=!1};return Wb("online",t),Wb("offline",n),()=>{Hb("online",t),Hb("offline",n)}},Vte={isOnline:$te,isVisible:Fte},qte={initFocus:Bte,initReconnect:zte},cR=!W.useId,Vu=!lh||"Deno"in window,Ute=e=>Lte()?window.requestAnimationFrame(e):setTimeout(e,1),Zb=Vu?g.useEffect:g.useLayoutEffect,Kb=typeof navigator<"u"&&navigator.connection,lR=!Vu&&Kb&&(["slow-2g","2g"].includes(Kb.effectiveType)||Kb.saveData),Xb=e=>{if(Zr(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?zu(e):"",[e,t]};let Wte=0;const Gb=()=>++Wte,uR=0,dR=1,fR=2;var qu={__proto__:null,ERROR_REVALIDATE_EVENT:3,FOCUS_EVENT:uR,MUTATE_EVENT:fR,RECONNECT_EVENT:dR};async function pR(...e){const[t,n,r,a]=e,o=yo({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let i=o.populateCache;const s=o.rollbackOnError;let c=o.optimisticData;const l=f=>typeof s=="function"?s(f):s!==!1,u=o.throwOnError;if(Zr(n)){const f=n,p=[],y=t.keys();for(const m of y)!/^\$(inf|sub)\$/.test(m)&&f(t.get(m)._k)&&p.push(m);return Promise.all(p.map(d))}return d(n);async function d(f){const[p]=Xb(f);if(!p)return;const[y,m]=sR(t,p),[v,b,w,_]=go.get(t),x=()=>{const k=v[p];return(Zr(o.revalidate)?o.revalidate(y().data,f):o.revalidate!==!1)&&(delete w[p],delete _[p],k&&k[0])?k[0](fR).then(()=>y().data):y().data};if(e.length<3)return x();let j=r,S;const E=Gb();b[p]=[E,0];const O=!ct(c),M=y(),N=M.data,P=M._c,R=ct(P)?N:P;if(O&&(c=Zr(c)?c(R,N):c,m({data:c,_c:R})),Zr(j))try{j=j(R)}catch(k){S=k}if(j&&iR(j))if(j=await j.catch(k=>{S=k}),E!==b[p][0]){if(S)throw S;return j}else S&&O&&l(S)&&(i=!0,m({data:R,_c:Bn}));if(i&&!S)if(Zr(i)){const k=i(j,R);m({data:k,error:Bn,_c:Bn})}else m({data:j,error:Bn,_c:Bn});if(b[p][1]=Gb(),Promise.resolve(x()).then(()=>{m({_c:Bn})}),S){if(u)throw S;return}return j}}const hR=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},Hte=(e,t)=>{if(!go.has(e)){const n=yo(qte,t),r={},a=pR.bind(Bn,e);let o=mo;const i={},s=(u,d)=>{const f=i[u]||[];return i[u]=f,f.push(d),()=>f.splice(f.indexOf(d),1)},c=(u,d,f)=>{e.set(u,d);const p=i[u];if(p)for(const y of p)y(d,f)},l=()=>{if(!go.has(e)&&(go.set(e,[r,{},{},{},a,c,s]),!Vu)){const u=n.initFocus(setTimeout.bind(Bn,hR.bind(Bn,r,uR))),d=n.initReconnect(setTimeout.bind(Bn,hR.bind(Bn,r,dR)));o=()=>{u&&u(),d&&d(),go.delete(e)}}};return l(),[e,a,l,o]}return[e,go.get(e)[4]]},Zte=(e,t,n,r,a)=>{const o=n.errorRetryCount,i=a.retryCount,s=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!ct(o)&&i>o||setTimeout(r,s,a)},Kte=(e,t)=>zu(e)==zu(t),[mR,Xte]=Hte(new Map),Gte=yo({onLoadingSlow:mo,onSuccess:mo,onError:mo,onErrorRetry:Zte,onDiscarded:mo,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:lR?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:lR?5e3:3e3,compare:Kte,isPaused:()=>!1,cache:mR,mutate:Xte,fallback:{}},Vte),Qte=(e,t)=>{const n=yo(e,t);if(t){const{use:r,fallback:a}=e,{use:o,fallback:i}=t;r&&o&&(n.use=r.concat(o)),a&&i&&(n.fallback=yo(a,i))}return n},Jte=g.createContext({}),Yte="$inf$",yR=lh&&window.__SWR_DEVTOOLS_USE__,ene=yR?window.__SWR_DEVTOOLS_USE__:[],tne=()=>{yR&&(window.__SWR_DEVTOOLS_REACT__=W)},nne=e=>Zr(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],rne=()=>yo(Gte,g.useContext(Jte)),ane=e=>(t,n,r)=>e(t,n&&((...a)=>{const[o]=Xb(t),[,,,i]=go.get(mR);if(o.startsWith(Yte))return n(...a);const s=i[o];return ct(s)?n(...a):(delete i[o],s)}),r),one=ene.concat(ane),ine=e=>function(...t){const n=rne(),[r,a,o]=nne(t),i=Qte(n,o);let s=e;const{use:c}=i,l=(c||[]).concat(one);for(let u=l.length;u--;)s=l[u](s);return s(r,a||i.fetcher||null,i)},sne=(e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const a=r.indexOf(n);a>=0&&(r[a]=r[r.length-1],r.pop())}};tne();const gR=W.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e)}),Qb={dedupe:!0},cne=(e,t,n)=>{const{cache:r,compare:a,suspense:o,fallbackData:i,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:l,refreshWhenHidden:u,refreshWhenOffline:d,keepPreviousData:f}=n,[p,y,m,v]=go.get(r),[b,w]=Xb(e),_=g.useRef(!1),x=g.useRef(!1),j=g.useRef(b),S=g.useRef(t),E=g.useRef(n),O=()=>E.current,M=()=>O().isVisible()&&O().isOnline(),[N,P,R,k]=sR(r,b),C=g.useRef({}).current,T=ct(i)?n.fallback[b]:i,A=(z,se)=>{for(const re in C){const ue=re;if(ue==="data"){if(!a(z[ue],se[ue])&&(!ct(z[ue])||!a(X,se[ue])))return!1}else if(se[ue]!==z[ue])return!1}return!0},I=g.useMemo(()=>{const z=!b||!t?!1:ct(s)?O().isPaused()||o?!1:ct(c)?!0:c:s,se=Se=>{const Ve=yo(Se);return delete Ve._k,z?{isValidating:!0,isLoading:!0,...Ve}:Ve},re=N(),ue=k(),je=se(re),Le=re===ue?je:se(ue);let $e=je;return[()=>{const Se=se(N());return A(Se,$e)?($e.data=Se.data,$e.isLoading=Se.isLoading,$e.isValidating=Se.isValidating,$e.error=Se.error,$e):($e=Se,Se)},()=>Le]},[r,b]),L=rp.useSyncExternalStore(g.useCallback(z=>R(b,(se,re)=>{A(re,se)||z()}),[r,b]),I[0],I[1]),D=!_.current,B=p[b]&&p[b].length>0,F=L.data,$=ct(F)?T:F,V=L.error,G=g.useRef($),X=f?ct(F)?G.current:F:$,H=B&&!ct(V)?!1:D&&!ct(s)?s:O().isPaused()?!1:o?ct($)?!1:c:ct($)||c,J=!!(b&&t&&D&&H),Z=ct(L.isValidating)?J:L.isValidating,U=ct(L.isLoading)?J:L.isLoading,Q=g.useCallback(async z=>{const se=S.current;if(!b||!se||x.current||O().isPaused())return!1;let re,ue,je=!0;const Le=z||{},$e=!m[b]||!Le.dedupe,Se=()=>cR?!x.current&&b===j.current&&_.current:b===j.current,Ve={isValidating:!1,isLoading:!1},Ue=()=>{P(Ve)},We=()=>{const st=m[b];st&&st[1]===ue&&delete m[b]},At={isValidating:!0};ct(N().data)&&(At.isLoading=!0);try{if($e&&(P(At),n.loadingTimeout&&ct(N().data)&&setTimeout(()=>{je&&Se()&&O().onLoadingSlow(b,n)},n.loadingTimeout),m[b]=[se(w),Gb()]),[re,ue]=m[b],re=await re,$e&&setTimeout(We,n.dedupingInterval),!m[b]||m[b][1]!==ue)return $e&&Se()&&O().onDiscarded(b),!1;Ve.error=Bn;const st=y[b];if(!ct(st)&&(ue<=st[0]||ue<=st[1]||st[1]===0))return Ue(),$e&&Se()&&O().onDiscarded(b),!1;const rt=N().data;Ve.data=a(rt,re)?rt:re,$e&&Se()&&O().onSuccess(re,b,n)}catch(st){We();const rt=O(),{shouldRetryOnError:wt}=rt;rt.isPaused()||(Ve.error=st,$e&&Se()&&(rt.onError(st,b,rt),(wt===!0||Zr(wt)&&wt(st))&&(!O().revalidateOnFocus||!O().revalidateOnReconnect||M())&&rt.onErrorRetry(st,b,rt,Xt=>{const nr=p[b];nr&&nr[0]&&nr[0](qu.ERROR_REVALIDATE_EVENT,Xt)},{retryCount:(Le.retryCount||0)+1,dedupe:!0})))}return je=!1,Ue(),!0},[b,r]),ne=g.useCallback((...z)=>pR(r,j.current,...z),[]);if(Zb(()=>{S.current=t,E.current=n,ct(F)||(G.current=F)}),Zb(()=>{if(!b)return;const z=Q.bind(Bn,Qb);let se=0;const re=sne(b,p,(ue,je={})=>{if(ue==qu.FOCUS_EVENT){const Le=Date.now();O().revalidateOnFocus&&Le>se&&M()&&(se=Le+O().focusThrottleInterval,z())}else if(ue==qu.RECONNECT_EVENT)O().revalidateOnReconnect&&M()&&z();else{if(ue==qu.MUTATE_EVENT)return Q();if(ue==qu.ERROR_REVALIDATE_EVENT)return Q(je)}});return x.current=!1,j.current=b,_.current=!0,P({_k:w}),H&&(ct($)||Vu?z():Ute(z)),()=>{x.current=!0,re()}},[b]),Zb(()=>{let z;function se(){const ue=Zr(l)?l(N().data):l;ue&&z!==-1&&(z=setTimeout(re,ue))}function re(){!N().error&&(u||O().isVisible())&&(d||O().isOnline())?Q(Qb).then(se):se()}return se(),()=>{z&&(clearTimeout(z),z=-1)}},[l,u,d,b]),g.useDebugValue(X),o&&ct($)&&b){if(!cR&&Vu)throw new Error("Fallback data is required when using suspense in SSR.");S.current=t,E.current=n,x.current=!1;const z=v[b];if(!ct(z)){const se=ne(z);gR(se)}if(ct(V)){const se=Q(Qb);ct(X)||(se.status="fulfilled",se.value=!0),gR(se)}else throw V}return{mutate:ne,get data(){return C.data=!0,X},get error(){return C.error=!0,V},get isValidating(){return C.isValidating=!0,Z},get isLoading(){return C.isLoading=!0,U}}},uh=ine(cne);var Jb,vR;function lne(){if(vR)return Jb;vR=1;function e(t,n){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let r,a=0;return function(...o){clearTimeout(r);const i=Date.now(),s=i-a,c=n-s;c<=0?(a=i,t.apply(this,o)):r=setTimeout(()=>{a=Date.now(),t.apply(this,o)},c)}}return Jb=e,Jb}var une=lne();const dne=ot(une);function bR(e,t){return t!=null?dne(e,t):e}var fne=async(e,t,n,r,a,o,i,s,c,l,u,d,f,p,y,m,v)=>{var b;const w=i.current;n(t.messages,!1);const _=p?t.messages:t.messages.map(({role:j,content:S,experimental_attachments:E,data:O,annotations:M,toolInvocations:N})=>({role:j,content:S,...E!==void 0&&{experimental_attachments:E},...O!==void 0&&{data:O},...M!==void 0&&{annotations:M},...N!==void 0&&{toolInvocations:N}})),x=a.current;return await Rte({api:e,body:(b=y==null?void 0:y({messages:t.messages,requestData:t.data,requestBody:t.body}))!=null?b:{messages:_,data:t.data,...o.current.body,...t.body},streamProtocol:l,credentials:o.current.credentials,headers:{...o.current.headers,...t.headers},abortController:()=>s.current,restoreMessagesOnFailure(){v||n(w,!1)},onResponse:d,onUpdate(j,S){n([...t.messages,...j],!1),S!=null&&S.length&&r([...x??[],...S],!1)},onToolCall:f,onFinish:u,generateId:c,fetch:m})};function pne({api:e="/api/chat",id:t,initialMessages:n,initialInput:r="",sendExtraMessageFields:a,onToolCall:o,experimental_prepareRequestBody:i,maxSteps:s=1,streamProtocol:c="data",onResponse:l,onFinish:u,onError:d,credentials:f,headers:p,body:y,generateId:m=eR,fetch:v,keepLastMessageOnError:b=!0,experimental_throttle:w}={}){const _=g.useId(),x=t??_,j=typeof e=="string"?[e,x]:x,[S]=g.useState([]),{data:E,mutate:O}=uh([j,"messages"],null,{fallbackData:n??S}),M=g.useRef(E||[]);g.useEffect(()=>{M.current=E||[]},[E]);const{data:N,mutate:P}=uh([j,"streamData"],null),R=g.useRef(N);g.useEffect(()=>{R.current=N},[N]);const{data:k=!1,mutate:C}=uh([j,"loading"],null),{data:T=void 0,mutate:A}=uh([j,"error"],null),I=g.useRef(null),L=g.useRef({credentials:f,headers:p,body:y});g.useEffect(()=>{L.current={credentials:f,headers:p,body:y}},[f,p,y]);const D=g.useCallback(async Z=>{const U=M.current.length;try{C(!0),A(void 0);const z=new AbortController;I.current=z,await fne(e,Z,bR(O,w),bR(P,w),R,L,M,I,m,c,u,l,o,a,i,v,b),I.current=null}catch(z){if(z.name==="AbortError")return I.current=null,null;d&&z instanceof Error&&d(z),A(z)}finally{C(!1)}const Q=M.current,ne=Q[Q.length-1];Q.length>U&&ne!=null&&s>1&&wR(ne)&&hne(Q)<s&&await D({messages:Q})},[O,C,e,L,l,u,d,A,P,R,c,a,i,o,s,M,I,m,v,b,w]),B=g.useCallback(async(Z,{data:U,headers:Q,body:ne,experimental_attachments:z}={})=>{var se,re;Z.id||(Z.id=m());const ue=await xR(z),je=M.current.concat({...Z,id:(se=Z.id)!=null?se:m(),createdAt:(re=Z.createdAt)!=null?re:new Date,experimental_attachments:ue.length>0?ue:void 0});return D({messages:je,headers:Q,body:ne,data:U})},[D,m]),F=g.useCallback(async({data:Z,headers:U,body:Q}={})=>{const ne=M.current;if(ne.length===0)return null;const z=ne[ne.length-1];return D({messages:z.role==="assistant"?ne.slice(0,-1):ne,headers:U,body:Q,data:Z})},[D]),$=g.useCallback(()=>{I.current&&(I.current.abort(),I.current=null)},[]),V=g.useCallback(Z=>{typeof Z=="function"&&(Z=Z(M.current)),O(Z,!1),M.current=Z},[O]),G=g.useCallback(Z=>{typeof Z=="function"&&(Z=Z(R.current)),P(Z,!1),R.current=Z},[P]),[X,H]=g.useState(r),J=g.useCallback(async(Z,U={},Q)=>{var ne;if((ne=Z==null?void 0:Z.preventDefault)==null||ne.call(Z),!X&&!U.allowEmptySubmit)return;Q&&(L.current={...L.current,...Q});const z=await xR(U.experimental_attachments),se={messages:!X&&!z.length&&U.allowEmptySubmit?M.current:M.current.concat({id:m(),createdAt:new Date,role:"user",content:X,experimental_attachments:z.length>0?z:void 0}),headers:U.headers,body:U.body,data:U.data};D(se),H("")},[X,m,D]);return{messages:E||[],setMessages:V,data:N,setData:G,error:T,append:B,reload:F,stop:$,input:X,setInput:H,handleInputChange:Z=>{H(Z.target.value)},handleSubmit:J,isLoading:k,addToolResult:({toolCallId:Z,result:U})=>{const Q=M.current.map((z,se,re)=>se===re.length-1&&z.role==="assistant"&&z.toolInvocations?{...z,toolInvocations:z.toolInvocations.map(ue=>ue.toolCallId===Z?{...ue,result:U,state:"result"}:ue)}:z);O(Q,!1);const ne=Q[Q.length-1];wR(ne)&&D({messages:Q})}}}function wR(e){return e.role==="assistant"&&e.toolInvocations&&e.toolInvocations.length>0&&e.toolInvocations.every(t=>"result"in t)}function hne(e){let t=0;for(let n=e.length-1;n>=0&&e[n].role==="assistant";n--)t++;return t}async function xR(e){if(e==null)return[];if(e instanceof FileList)return Promise.all(Array.from(e).map(async t=>{const{name:n,type:r}=t,a=await new Promise((o,i)=>{const s=new FileReader;s.onload=c=>{var l;o((l=c.target)==null?void 0:l.result)},s.onerror=c=>i(c),s.readAsDataURL(t)});return{name:n,contentType:r,url:a}}));if(Array.isArray(e))return e;throw new Error("Invalid attachments type")}RM=pne;const vo=g.forwardRef(({className:e,...t},n)=>h.jsx("textarea",{className:K("flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));vo.displayName="Textarea";function mne({minHeight:e,maxHeight:t}){const n=g.useRef(null),r=g.useCallback(a=>{const o=n.current;if(!o)return;if(a){o.style.height=`${e}px`;return}o.style.height=`${e}px`;const i=Math.max(e,Math.min(o.scrollHeight,t??Number.POSITIVE_INFINITY));o.style.height=`${i}px`},[e,t]);return g.useEffect(()=>{const a=n.current;a&&(a.style.height=`${e}px`)},[e]),g.useEffect(()=>{const a=()=>r();return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[r]),{textareaRef:n,adjustHeight:r}}const yne=48,_R=164;Kv=function({onSubmit:e,disabled:t,enableTool:n,enableFile:r,placeholder:a,minHeight:o,maxHeight:i,className:s,height:c,onChange:l,value:u}){const[d,f]=g.useState(!1),[p,y]=g.useState(""),{textareaRef:m,adjustHeight:v}=mne({minHeight:o||yne,maxHeight:i||_R}),[b,w]=g.useState(!0),_=g.useCallback(async j=>{try{f(!0),await e(p,j)&&y("")}finally{f(!1)}},[p,e]),x=g.useMemo(()=>({maxHeight:`${i||_R}px`,...c?{height:`${c}px`}:{}}),[i,c]);return h.jsx("div",{className:K("w-full py-4 max-w-xl",s),children:h.jsx("div",{className:"relative w-full mx-auto",children:h.jsxs("div",{className:"relative flex flex-col",children:[h.jsx("div",{className:"overflow-y-auto",style:x,children:h.jsx(vo,{id:"ai-input-04",value:(l?u:p)||"",disabled:t||d,placeholder:a,className:"w-full rounded-xl rounded-b-none px-4 py-3 bg-black/5 dark:bg-white/5 border-none dark:text-white placeholder:text-black/70 dark:placeholder:text-white/70 resize-none focus-visible:ring-0 leading-[1.2]",ref:m,onKeyDown:j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),_(j))},onChange:j=>{l||y(j.target.value),v(),l==null||l(j)}})}),h.jsxs("div",{className:"h-12 bg-black/5 dark:bg-white/5 rounded-b-xl",children:[h.jsxs("div",{className:"absolute left-3 bottom-3 flex items-center gap-2",children:[r?h.jsxs("label",{className:"cursor-pointer rounded-lg p-2 bg-black/5 dark:bg-white/5",children:[h.jsx("input",{type:"file",className:"hidden"}),h.jsx(fe,{name:"paperclip",className:"w-4 h-4 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white transition-colors"})]}):void 0,n?h.jsxs("button",{type:"button",onClick:()=>{w(!b)},className:K("rounded-full transition-all flex items-center gap-2 px-1.5 py-1 border h-8",b?"bg-sky-500/15 border-sky-400 text-sky-500":"bg-black/5 dark:bg-white/5 border-transparent text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:[h.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:h.jsx(Kf.div,{animate:{rotate:b?180:0,scale:b?1.1:1},whileHover:{rotate:b?180:15,scale:1.1,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:h.jsx(fe,{name:"globe",className:K("w-4 h-4",b?"text-sky-500":"text-inherit")})})}),h.jsx(tX,{children:b&&h.jsx(Kf.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-sm overflow-hidden whitespace-nowrap text-sky-500 flex-shrink-0",children:"Search"})})]}):void 0]}),h.jsx("div",{className:"absolute right-3 bottom-3",children:h.jsx("button",{type:"button",disabled:t||d,onClick:j=>{_(j)},className:K("rounded-lg p-2",l&&u||p?"bg-sky-500/15 text-sky-500":"bg-black/5 dark:bg-white/5 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:h.jsx(fe,{name:"send",className:"w-4 h-4"})})})]})]})})})};var Yb,jR;function gne(){if(jR)return Yb;jR=1;function e(){this.__data__=[],this.size=0}return Yb=e,Yb}var ew,SR;Xl=function(){if(SR)return ew;SR=1;function e(t,n){return t===n||t!==t&&n!==n}return ew=e,ew};var tw,ER;function dh(){if(ER)return tw;ER=1;var e=Xl();function t(n,r){for(var a=n.length;a--;)if(e(n[a][0],r))return a;return-1}return tw=t,tw}var nw,OR;function vne(){if(OR)return nw;OR=1;var e=dh(),t=Array.prototype,n=t.splice;function r(a){var o=this.__data__,i=e(o,a);if(i<0)return!1;var s=o.length-1;return i==s?o.pop():n.call(o,i,1),--this.size,!0}return nw=r,nw}var rw,CR;function bne(){if(CR)return rw;CR=1;var e=dh();function t(n){var r=this.__data__,a=e(r,n);return a<0?void 0:r[a][1]}return rw=t,rw}var aw,NR;function wne(){if(NR)return aw;NR=1;var e=dh();function t(n){return e(this.__data__,n)>-1}return aw=t,aw}var ow,MR;function xne(){if(MR)return ow;MR=1;var e=dh();function t(n,r){var a=this.__data__,o=e(a,n);return o<0?(++this.size,a.push([n,r])):a[o][1]=r,this}return ow=t,ow}var iw,PR;function fh(){if(PR)return iw;PR=1;var e=gne(),t=vne(),n=bne(),r=wne(),a=xne();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,iw=o,iw}var sw,kR;function _ne(){if(kR)return sw;kR=1;var e=fh();function t(){this.__data__=new e,this.size=0}return sw=t,sw}var cw,AR;function jne(){if(AR)return cw;AR=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return cw=e,cw}var lw,TR;function Sne(){if(TR)return lw;TR=1;function e(t){return this.__data__.get(t)}return lw=e,lw}var uw,RR;function Ene(){if(RR)return uw;RR=1;function e(t){return this.__data__.has(t)}return uw=e,uw}var dw,IR;function DR(){if(IR)return dw;IR=1;var e=typeof Ul=="object"&&Ul&&Ul.Object===Object&&Ul;return dw=e,dw}var fw,LR;$r=function(){if(LR)return fw;LR=1;var e=DR(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return fw=n,fw};var pw,$R;Fs=function(){if($R)return pw;$R=1;var e=$r(),t=e.Symbol;return pw=t,pw};var hw,FR;function One(){if(FR)return hw;FR=1;var e=Fs(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,a=e?e.toStringTag:void 0;function o(i){var s=n.call(i,a),c=i[a];try{i[a]=void 0;var l=!0}catch{}var u=r.call(i);return l&&(s?i[a]=c:delete i[a]),u}return hw=o,hw}var mw,BR;function Cne(){if(BR)return mw;BR=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return mw=n,mw}var yw,zR;function bo(){if(zR)return yw;zR=1;var e=Fs(),t=One(),n=Cne(),r="[object Null]",a="[object Undefined]",o=e?e.toStringTag:void 0;function i(s){return s==null?s===void 0?a:r:o&&o in Object(s)?t(s):n(s)}return yw=i,yw}var gw,VR;Fr=function(){if(VR)return gw;VR=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return gw=e,gw};var vw,qR;np=function(){if(qR)return vw;qR=1;var e=bo(),t=Fr(),n="[object AsyncFunction]",r="[object Function]",a="[object GeneratorFunction]",o="[object Proxy]";function i(s){if(!t(s))return!1;var c=e(s);return c==r||c==a||c==n||c==o}return vw=i,vw};var bw,UR;function Nne(){if(UR)return bw;UR=1;var e=$r(),t=e["__core-js_shared__"];return bw=t,bw}var ww,WR;function Mne(){if(WR)return ww;WR=1;var e=Nne(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return ww=n,ww}var xw,HR;function ZR(){if(HR)return xw;HR=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return xw=n,xw}var _w,KR;function Pne(){if(KR)return _w;KR=1;var e=np(),t=Mne(),n=Fr(),r=ZR(),a=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,i=Function.prototype,s=Object.prototype,c=i.toString,l=s.hasOwnProperty,u=RegExp("^"+c.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(f){if(!n(f)||t(f))return!1;var p=e(f)?u:o;return p.test(r(f))}return _w=d,_w}var jw,XR;function kne(){if(XR)return jw;XR=1;function e(t,n){return t==null?void 0:t[n]}return jw=e,jw}var Sw,GR;function Hi(){if(GR)return Sw;GR=1;var e=Pne(),t=kne();function n(r,a){var o=t(r,a);return e(o)?o:void 0}return Sw=n,Sw}var Ew,QR;function Ow(){if(QR)return Ew;QR=1;var e=Hi(),t=$r(),n=e(t,"Map");return Ew=n,Ew}var Cw,JR;function ph(){if(JR)return Cw;JR=1;var e=Hi(),t=e(Object,"create");return Cw=t,Cw}var Nw,YR;function Ane(){if(YR)return Nw;YR=1;var e=ph();function t(){this.__data__=e?e(null):{},this.size=0}return Nw=t,Nw}var Mw,eI;function Tne(){if(eI)return Mw;eI=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return Mw=e,Mw}var Pw,tI;function Rne(){if(tI)return Pw;tI=1;var e=ph(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function a(o){var i=this.__data__;if(e){var s=i[o];return s===t?void 0:s}return r.call(i,o)?i[o]:void 0}return Pw=a,Pw}var kw,nI;function Ine(){if(nI)return kw;nI=1;var e=ph(),t=Object.prototype,n=t.hasOwnProperty;function r(a){var o=this.__data__;return e?o[a]!==void 0:n.call(o,a)}return kw=r,kw}var Aw,rI;function Dne(){if(rI)return Aw;rI=1;var e=ph(),t="__lodash_hash_undefined__";function n(r,a){var o=this.__data__;return this.size+=this.has(r)?0:1,o[r]=e&&a===void 0?t:a,this}return Aw=n,Aw}var Tw,aI;function Lne(){if(aI)return Tw;aI=1;var e=Ane(),t=Tne(),n=Rne(),r=Ine(),a=Dne();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,Tw=o,Tw}var Rw,oI;function $ne(){if(oI)return Rw;oI=1;var e=Lne(),t=fh(),n=Ow();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return Rw=r,Rw}var Iw,iI;function Fne(){if(iI)return Iw;iI=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return Iw=e,Iw}var Dw,sI;function hh(){if(sI)return Dw;sI=1;var e=Fne();function t(n,r){var a=n.__data__;return e(r)?a[typeof r=="string"?"string":"hash"]:a.map}return Dw=t,Dw}var Lw,cI;function Bne(){if(cI)return Lw;cI=1;var e=hh();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return Lw=t,Lw}var $w,lI;function zne(){if(lI)return $w;lI=1;var e=hh();function t(n){return e(this,n).get(n)}return $w=t,$w}var Fw,uI;function Vne(){if(uI)return Fw;uI=1;var e=hh();function t(n){return e(this,n).has(n)}return Fw=t,Fw}var Bw,dI;function qne(){if(dI)return Bw;dI=1;var e=hh();function t(n,r){var a=e(this,n),o=a.size;return a.set(n,r),this.size+=a.size==o?0:1,this}return Bw=t,Bw}var zw,fI;function Vw(){if(fI)return zw;fI=1;var e=$ne(),t=Bne(),n=zne(),r=Vne(),a=qne();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,zw=o,zw}var qw,pI;function Une(){if(pI)return qw;pI=1;var e=fh(),t=Ow(),n=Vw(),r=200;function a(o,i){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<r-1)return c.push([o,i]),this.size=++s.size,this;s=this.__data__=new n(c)}return s.set(o,i),this.size=s.size,this}return qw=a,qw}var Uw,hI;o0=function(){if(hI)return Uw;hI=1;var e=fh(),t=_ne(),n=jne(),r=Sne(),a=Ene(),o=Une();function i(s){var c=this.__data__=new e(s);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=a,i.prototype.set=o,Uw=i,Uw};var Ww,mI;function Wne(){if(mI)return Ww;mI=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return Ww=t,Ww}var Hw,yI;function Hne(){if(yI)return Hw;yI=1;function e(t){return this.__data__.has(t)}return Hw=e,Hw}var Zw,gI;function vI(){if(gI)return Zw;gI=1;var e=Vw(),t=Wne(),n=Hne();function r(a){var o=-1,i=a==null?0:a.length;for(this.__data__=new e;++o<i;)this.add(a[o])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,Zw=r,Zw}var Kw,bI;function wI(){if(bI)return Kw;bI=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(n(t[r],r,t))return!0;return!1}return Kw=e,Kw}var Xw,xI;function _I(){if(xI)return Xw;xI=1;function e(t,n){return t.has(n)}return Xw=e,Xw}var Gw,jI;function SI(){if(jI)return Gw;jI=1;var e=vI(),t=wI(),n=_I(),r=1,a=2;function o(i,s,c,l,u,d){var f=c&r,p=i.length,y=s.length;if(p!=y&&!(f&&y>p))return!1;var m=d.get(i),v=d.get(s);if(m&&v)return m==s&&v==i;var b=-1,w=!0,_=c&a?new e:void 0;for(d.set(i,s),d.set(s,i);++b<p;){var x=i[b],j=s[b];if(l)var S=f?l(j,x,b,s,i,d):l(x,j,b,i,s,d);if(S!==void 0){if(S)continue;w=!1;break}if(_){if(!t(s,function(E,O){if(!n(_,O)&&(x===E||u(x,E,c,l,d)))return _.push(O)})){w=!1;break}}else if(!(x===j||u(x,j,c,l,d))){w=!1;break}}return d.delete(i),d.delete(s),w}return Gw=o,Gw}var Qw,EI;rP=function(){if(EI)return Qw;EI=1;var e=$r(),t=e.Uint8Array;return Qw=t,Qw};var Jw,OI;function Zne(){if(OI)return Jw;OI=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a,o){r[++n]=[o,a]}),r}return Jw=e,Jw}var Yw,CI;function ex(){if(CI)return Yw;CI=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a){r[++n]=a}),r}return Yw=e,Yw}var tx,NI;function Kne(){if(NI)return tx;NI=1;var e=Fs(),t=rP(),n=Xl(),r=SI(),a=Zne(),o=ex(),i=1,s=2,c="[object Boolean]",l="[object Date]",u="[object Error]",d="[object Map]",f="[object Number]",p="[object RegExp]",y="[object Set]",m="[object String]",v="[object Symbol]",b="[object ArrayBuffer]",w="[object DataView]",_=e?e.prototype:void 0,x=_?_.valueOf:void 0;function j(S,E,O,M,N,P,R){switch(O){case w:if(S.byteLength!=E.byteLength||S.byteOffset!=E.byteOffset)return!1;S=S.buffer,E=E.buffer;case b:return!(S.byteLength!=E.byteLength||!P(new t(S),new t(E)));case c:case l:case f:return n(+S,+E);case u:return S.name==E.name&&S.message==E.message;case p:case m:return S==E+"";case d:var k=a;case y:var C=M&i;if(k||(k=o),S.size!=E.size&&!C)return!1;var T=R.get(S);if(T)return T==E;M|=s,R.set(S,E);var A=r(k(S),k(E),M,N,P,R);return R.delete(S),A;case v:if(x)return x.call(S)==x.call(E)}return!1}return tx=j,tx}var nx,MI;function rx(){if(MI)return nx;MI=1;function e(t,n){for(var r=-1,a=n.length,o=t.length;++r<a;)t[o+r]=n[r];return t}return nx=e,nx}var ax,PI;Fn=function(){if(PI)return ax;PI=1;var e=Array.isArray;return ax=e,ax};var ox,kI;function AI(){if(kI)return ox;kI=1;var e=rx(),t=Fn();function n(r,a,o){var i=a(r);return t(r)?i:e(i,o(r))}return ox=n,ox}var ix,TI;function Xne(){if(TI)return ix;TI=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=0,i=[];++r<a;){var s=t[r];n(s,r,t)&&(i[o++]=s)}return i}return ix=e,ix}var sx,RI;function II(){if(RI)return sx;RI=1;function e(){return[]}return sx=e,sx}var cx,DI;t0=function(){if(DI)return cx;DI=1;var e=Xne(),t=II(),n=Object.prototype,r=n.propertyIsEnumerable,a=Object.getOwnPropertySymbols,o=a?function(i){return i==null?[]:(i=Object(i),e(a(i),function(s){return r.call(i,s)}))}:t;return cx=o,cx};var lx,LI;function Gne(){if(LI)return lx;LI=1;function e(t,n){for(var r=-1,a=Array(t);++r<t;)a[r]=n(r);return a}return lx=e,lx}var ux,$I;ja=function(){if($I)return ux;$I=1;function e(t){return t!=null&&typeof t=="object"}return ux=e,ux};var dx,FI;function Qne(){if(FI)return dx;FI=1;var e=bo(),t=ja(),n="[object Arguments]";function r(a){return t(a)&&e(a)==n}return dx=r,dx}var fx,BI;tp=function(){if(BI)return fx;BI=1;var e=Qne(),t=ja(),n=Object.prototype,r=n.hasOwnProperty,a=n.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(i){return t(i)&&r.call(i,"callee")&&!a.call(i,"callee")};return fx=o,fx};var mh={exports:{}},px,zI;function Jne(){if(zI)return px;zI=1;function e(){return!1}return px=e,px}mh.exports;var VI;i0=function(){return VI||(VI=1,function(e,t){var n=$r(),r=Jne(),a=t&&!t.nodeType&&t,o=a&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===a,s=i?n.Buffer:void 0,c=s?s.isBuffer:void 0,l=c||r;e.exports=l}(mh,mh.exports)),mh.exports};var hx,qI;function yh(){if(qI)return hx;qI=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,a){var o=typeof r;return a=a??e,!!a&&(o=="number"||o!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<a}return hx=n,hx}var mx,UI;function yx(){if(UI)return mx;UI=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return mx=t,mx}var gx,WI;function Yne(){if(WI)return gx;WI=1;var e=bo(),t=yx(),n=ja(),r="[object Arguments]",a="[object Array]",o="[object Boolean]",i="[object Date]",s="[object Error]",c="[object Function]",l="[object Map]",u="[object Number]",d="[object Object]",f="[object RegExp]",p="[object Set]",y="[object String]",m="[object WeakMap]",v="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",j="[object Int16Array]",S="[object Int32Array]",E="[object Uint8Array]",O="[object Uint8ClampedArray]",M="[object Uint16Array]",N="[object Uint32Array]",P={};P[w]=P[_]=P[x]=P[j]=P[S]=P[E]=P[O]=P[M]=P[N]=!0,P[r]=P[a]=P[v]=P[o]=P[b]=P[i]=P[s]=P[c]=P[l]=P[u]=P[d]=P[f]=P[p]=P[y]=P[m]=!1;function R(k){return n(k)&&t(k.length)&&!!P[e(k)]}return gx=R,gx}var vx,HI;a0=function(){if(HI)return vx;HI=1;function e(t){return function(n){return t(n)}}return vx=e,vx};var gh={exports:{}};gh.exports;var ZI;oP=function(){return ZI||(ZI=1,function(e,t){var n=DR(),r=t&&!t.nodeType&&t,a=r&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===r,i=o&&n.process,s=function(){try{var c=a&&a.require&&a.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=s}(gh,gh.exports)),gh.exports};var bx,KI;cv=function(){if(KI)return bx;KI=1;var e=Yne(),t=a0(),n=oP(),r=n&&n.isTypedArray,a=r?t(r):e;return bx=a,bx};var wx,XI;function GI(){if(XI)return wx;XI=1;var e=Gne(),t=tp(),n=Fn(),r=i0(),a=yh(),o=cv(),i=Object.prototype,s=i.hasOwnProperty;function c(l,u){var d=n(l),f=!d&&t(l),p=!d&&!f&&r(l),y=!d&&!f&&!p&&o(l),m=d||f||p||y,v=m?e(l.length,String):[],b=v.length;for(var w in l)(u||s.call(l,w))&&!(m&&(w=="length"||p&&(w=="offset"||w=="parent")||y&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||a(w,b)))&&v.push(w);return v}return wx=c,wx}var xx,QI;r0=function(){if(QI)return xx;QI=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,a=typeof r=="function"&&r.prototype||e;return n===a}return xx=t,xx};var _x,JI;function YI(){if(JI)return _x;JI=1;function e(t,n){return function(r){return t(n(r))}}return _x=e,_x}var jx,eD;function ere(){if(eD)return jx;eD=1;var e=YI(),t=e(Object.keys,Object);return jx=t,jx}var Sx,tD;function tre(){if(tD)return Sx;tD=1;var e=r0(),t=ere(),n=Object.prototype,r=n.hasOwnProperty;function a(o){if(!e(o))return t(o);var i=[];for(var s in Object(o))r.call(o,s)&&s!="constructor"&&i.push(s);return i}return Sx=a,Sx}var Ex,nD;Ri=function(){if(nD)return Ex;nD=1;var e=np(),t=yx();function n(r){return r!=null&&t(r.length)&&!e(r)}return Ex=n,Ex};var Ox,rD;eu=function(){if(rD)return Ox;rD=1;var e=GI(),t=tre(),n=Ri();function r(a){return n(a)?e(a):t(a)}return Ox=r,Ox};var Cx,aD;iP=function(){if(aD)return Cx;aD=1;var e=AI(),t=t0(),n=eu();function r(a){return e(a,n,t)}return Cx=r,Cx};var Nx,oD;function nre(){if(oD)return Nx;oD=1;var e=iP(),t=1,n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s,c,l,u){var d=s&t,f=e(o),p=f.length,y=e(i),m=y.length;if(p!=m&&!d)return!1;for(var v=p;v--;){var b=f[v];if(!(d?b in i:r.call(i,b)))return!1}var w=u.get(o),_=u.get(i);if(w&&_)return w==i&&_==o;var x=!0;u.set(o,i),u.set(i,o);for(var j=d;++v<p;){b=f[v];var S=o[b],E=i[b];if(c)var O=d?c(E,S,b,i,o,u):c(S,E,b,o,i,u);if(!(O===void 0?S===E||l(S,E,s,c,u):O)){x=!1;break}j||(j=b=="constructor")}if(x&&!j){var M=o.constructor,N=i.constructor;M!=N&&"constructor"in o&&"constructor"in i&&!(typeof M=="function"&&M instanceof M&&typeof N=="function"&&N instanceof N)&&(x=!1)}return u.delete(o),u.delete(i),x}return Nx=a,Nx}var Mx,iD;function rre(){if(iD)return Mx;iD=1;var e=Hi(),t=$r(),n=e(t,"DataView");return Mx=n,Mx}var Px,sD;function are(){if(sD)return Px;sD=1;var e=Hi(),t=$r(),n=e(t,"Promise");return Px=n,Px}var kx,cD;function lD(){if(cD)return kx;cD=1;var e=Hi(),t=$r(),n=e(t,"Set");return kx=n,kx}var Ax,uD;function ore(){if(uD)return Ax;uD=1;var e=Hi(),t=$r(),n=e(t,"WeakMap");return Ax=n,Ax}var Tx,dD;aP=function(){if(dD)return Tx;dD=1;var e=rre(),t=Ow(),n=are(),r=lD(),a=ore(),o=bo(),i=ZR(),s="[object Map]",c="[object Object]",l="[object Promise]",u="[object Set]",d="[object WeakMap]",f="[object DataView]",p=i(e),y=i(t),m=i(n),v=i(r),b=i(a),w=o;return(e&&w(new e(new ArrayBuffer(1)))!=f||t&&w(new t)!=s||n&&w(n.resolve())!=l||r&&w(new r)!=u||a&&w(new a)!=d)&&(w=function(_){var x=o(_),j=x==c?_.constructor:void 0,S=j?i(j):"";if(S)switch(S){case p:return f;case y:return s;case m:return l;case v:return u;case b:return d}return x}),Tx=w,Tx};var Rx,fD;function ire(){if(fD)return Rx;fD=1;var e=o0(),t=SI(),n=Kne(),r=nre(),a=aP(),o=Fn(),i=i0(),s=cv(),c=1,l="[object Arguments]",u="[object Array]",d="[object Object]",f=Object.prototype,p=f.hasOwnProperty;function y(m,v,b,w,_,x){var j=o(m),S=o(v),E=j?u:a(m),O=S?u:a(v);E=E==l?d:E,O=O==l?d:O;var M=E==d,N=O==d,P=E==O;if(P&&i(m)){if(!i(v))return!1;j=!0,M=!1}if(P&&!M)return x||(x=new e),j||s(m)?t(m,v,b,w,_,x):n(m,v,E,b,w,_,x);if(!(b&c)){var R=M&&p.call(m,"__wrapped__"),k=N&&p.call(v,"__wrapped__");if(R||k){var C=R?m.value():m,T=k?v.value():v;return x||(x=new e),_(C,T,b,w,x)}}return P?(x||(x=new e),r(m,v,b,w,_,x)):!1}return Rx=y,Rx}var Ix,pD;function Dx(){if(pD)return Ix;pD=1;var e=ire(),t=ja();function n(r,a,o,i,s){return r===a?!0:r==null||a==null||!t(r)&&!t(a)?r!==r&&a!==a:e(r,a,o,i,n,s)}return Ix=n,Ix}var Lx,hD;function sre(){if(hD)return Lx;hD=1;var e=o0(),t=Dx(),n=1,r=2;function a(o,i,s,c){var l=s.length,u=l,d=!c;if(o==null)return!u;for(o=Object(o);l--;){var f=s[l];if(d&&f[2]?f[1]!==o[f[0]]:!(f[0]in o))return!1}for(;++l<u;){f=s[l];var p=f[0],y=o[p],m=f[1];if(d&&f[2]){if(y===void 0&&!(p in o))return!1}else{var v=new e;if(c)var b=c(y,m,p,o,i,v);if(!(b===void 0?t(m,y,n|r,c,v):b))return!1}}return!0}return Lx=a,Lx}var $x,mD;function yD(){if(mD)return $x;mD=1;var e=Fr();function t(n){return n===n&&!e(n)}return $x=t,$x}var Fx,gD;function cre(){if(gD)return Fx;gD=1;var e=yD(),t=eu();function n(r){for(var a=t(r),o=a.length;o--;){var i=a[o],s=r[i];a[o]=[i,s,e(s)]}return a}return Fx=n,Fx}var Bx,vD;function bD(){if(vD)return Bx;vD=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return Bx=e,Bx}var zx,wD;function lre(){if(wD)return zx;wD=1;var e=sre(),t=cre(),n=bD();function r(a){var o=t(a);return o.length==1&&o[0][2]?n(o[0][0],o[0][1]):function(i){return i===a||e(i,a,o)}}return zx=r,zx}var Vx,xD;function ic(){if(xD)return Vx;xD=1;var e=bo(),t=ja(),n="[object Symbol]";function r(a){return typeof a=="symbol"||t(a)&&e(a)==n}return Vx=r,Vx}var qx,_D;function Ux(){if(_D)return qx;_D=1;var e=Fn(),t=ic(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function a(o,i){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:r.test(o)||!n.test(o)||i!=null&&o in Object(i)}return qx=a,qx}var Wx,jD;function SD(){if(jD)return Wx;jD=1;var e=Vw(),t="Expected a function";function n(r,a){if(typeof r!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var o=function(){var i=arguments,s=a?a.apply(this,i):i[0],c=o.cache;if(c.has(s))return c.get(s);var l=r.apply(this,i);return o.cache=c.set(s,l)||c,l};return o.cache=new(n.Cache||e),o}return n.Cache=e,Wx=n,Wx}var Hx,ED;function ure(){if(ED)return Hx;ED=1;var e=SD(),t=500;function n(r){var a=e(r,function(i){return o.size===t&&o.clear(),i}),o=a.cache;return a}return Hx=n,Hx}var Zx,OD;function dre(){if(OD)return Zx;OD=1;var e=ure(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(a){var o=[];return a.charCodeAt(0)===46&&o.push(""),a.replace(t,function(i,s,c,l){o.push(c?l.replace(n,"$1"):s||i)}),o});return Zx=r,Zx}var Kx,CD;Kl=function(){if(CD)return Kx;CD=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=Array(a);++r<a;)o[r]=n(t[r],r,t);return o}return Kx=e,Kx};var Xx,ND;function fre(){if(ND)return Xx;ND=1;var e=Fs(),t=Kl(),n=Fn(),r=ic(),a=1/0,o=e?e.prototype:void 0,i=o?o.toString:void 0;function s(c){if(typeof c=="string")return c;if(n(c))return t(c,s)+"";if(r(c))return i?i.call(c):"";var l=c+"";return l=="0"&&1/c==-a?"-0":l}return Xx=s,Xx}var Gx,MD;function PD(){if(MD)return Gx;MD=1;var e=fre();function t(n){return n==null?"":e(n)}return Gx=t,Gx}var Qx,kD;au=function(){if(kD)return Qx;kD=1;var e=Fn(),t=Ux(),n=dre(),r=PD();function a(o,i){return e(o)?o:t(o,i)?[o]:n(r(o))}return Qx=a,Qx};var Jx,AD;Bs=function(){if(AD)return Jx;AD=1;var e=ic(),t=1/0;function n(r){if(typeof r=="string"||e(r))return r;var a=r+"";return a=="0"&&1/r==-t?"-0":a}return Jx=n,Jx};var Yx,TD;ru=function(){if(TD)return Yx;TD=1;var e=au(),t=Bs();function n(r,a){a=e(a,r);for(var o=0,i=a.length;r!=null&&o<i;)r=r[t(a[o++])];return o&&o==i?r:void 0}return Yx=n,Yx};var e1,RD;function ID(){if(RD)return e1;RD=1;var e=ru();function t(n,r,a){var o=n==null?void 0:e(n,r);return o===void 0?a:o}return e1=t,e1}var t1,DD;function pre(){if(DD)return t1;DD=1;function e(t,n){return t!=null&&n in Object(t)}return t1=e,t1}var n1,LD;function hre(){if(LD)return n1;LD=1;var e=au(),t=tp(),n=Fn(),r=yh(),a=yx(),o=Bs();function i(s,c,l){c=e(c,s);for(var u=-1,d=c.length,f=!1;++u<d;){var p=o(c[u]);if(!(f=s!=null&&l(s,p)))break;s=s[p]}return f||++u!=d?f:(d=s==null?0:s.length,!!d&&a(d)&&r(p,d)&&(n(s)||t(s)))}return n1=i,n1}var r1,$D;OM=function(){if($D)return r1;$D=1;var e=pre(),t=hre();function n(r,a){return r!=null&&t(r,a,e)}return r1=n,r1};var a1,FD;function mre(){if(FD)return a1;FD=1;var e=Dx(),t=ID(),n=OM(),r=Ux(),a=yD(),o=bD(),i=Bs(),s=1,c=2;function l(u,d){return r(u)&&a(d)?o(i(u),d):function(f){var p=t(f,u);return p===void 0&&p===d?n(f,u):e(d,p,s|c)}}return a1=l,a1}var o1,BD;function sc(){if(BD)return o1;BD=1;function e(t){return t}return o1=e,o1}var i1,zD;function yre(){if(zD)return i1;zD=1;function e(t){return function(n){return n==null?void 0:n[t]}}return i1=e,i1}var s1,VD;function gre(){if(VD)return s1;VD=1;var e=ru();function t(n){return function(r){return e(r,n)}}return s1=t,s1}var c1,qD;function vre(){if(qD)return c1;qD=1;var e=yre(),t=gre(),n=Ux(),r=Bs();function a(o){return n(o)?e(r(o)):t(o)}return c1=a,c1}var l1,UD;function ka(){if(UD)return l1;UD=1;var e=lre(),t=mre(),n=sc(),r=Fn(),a=vre();function o(i){return typeof i=="function"?i:i==null?n:typeof i=="object"?r(i)?t(i[0],i[1]):e(i):a(i)}return l1=o,l1}var u1,WD;function bre(){if(WD)return u1;WD=1;var e="Expected a function";function t(n){if(typeof n!="function")throw new TypeError(e);return function(){var r=arguments;switch(r.length){case 0:return!n.call(this);case 1:return!n.call(this,r[0]);case 2:return!n.call(this,r[0],r[1]);case 3:return!n.call(this,r[0],r[1],r[2])}return!n.apply(this,r)}}return u1=t,u1}var d1,HD;function ZD(){if(HD)return d1;HD=1;var e=Hi(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return d1=t,d1}var f1,KD;dv=function(){if(KD)return f1;KD=1;var e=ZD();function t(n,r,a){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[r]=a}return f1=t,f1};var p1,XD;sP=function(){if(XD)return p1;XD=1;var e=dv(),t=Xl(),n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s){var c=o[i];(!(r.call(o,i)&&t(c,s))||s===void 0&&!(i in o))&&e(o,i,s)}return p1=a,p1};var h1,GD;function wre(){if(GD)return h1;GD=1;var e=sP(),t=au(),n=yh(),r=Fr(),a=Bs();function o(i,s,c,l){if(!r(i))return i;s=t(s,i);for(var u=-1,d=s.length,f=d-1,p=i;p!=null&&++u<d;){var y=a(s[u]),m=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return i;if(u!=f){var v=p[y];m=l?l(v,y,p):void 0,m===void 0&&(m=r(v)?v:n(s[u+1])?[]:{})}e(p,y,m),p=p[y]}return i}return h1=o,h1}var m1,QD;EM=function(){if(QD)return m1;QD=1;var e=ru(),t=wre(),n=au();function r(a,o,i){for(var s=-1,c=o.length,l={};++s<c;){var u=o[s],d=e(a,u);i(d,u)&&t(l,n(u,a),d)}return l}return m1=r,m1};var y1,JD;n0=function(){if(JD)return y1;JD=1;var e=YI(),t=e(Object.getPrototypeOf,Object);return y1=t,y1};var g1,YD;nP=function(){if(YD)return g1;YD=1;var e=rx(),t=n0(),n=t0(),r=II(),a=Object.getOwnPropertySymbols,o=a?function(i){for(var s=[];i;)e(s,n(i)),i=t(i);return s}:r;return g1=o,g1};var v1,e3;function xre(){if(e3)return v1;e3=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return v1=e,v1}var b1,t3;function _re(){if(t3)return b1;t3=1;var e=Fr(),t=r0(),n=xre(),r=Object.prototype,a=r.hasOwnProperty;function o(i){if(!e(i))return n(i);var s=t(i),c=[];for(var l in i)l=="constructor"&&(s||!a.call(i,l))||c.push(l);return c}return b1=o,b1}var w1,n3;tP=function(){if(n3)return w1;n3=1;var e=GI(),t=_re(),n=Ri();function r(a){return n(a)?e(a,!0):t(a)}return w1=r,w1};var x1,r3;cP=function(){if(r3)return x1;r3=1;var e=AI(),t=nP(),n=tP();function r(a){return e(a,n,t)}return x1=r,x1};var _1,a3;function jre(){if(a3)return _1;a3=1;var e=Kl(),t=ka(),n=EM(),r=cP();function a(o,i){if(o==null)return{};var s=e(r(o),function(c){return[c]});return i=t(i),n(o,s,function(c,l){return i(c,l[0])})}return _1=a,_1}var j1,o3;function Sre(){if(o3)return j1;o3=1;var e=ka(),t=bre(),n=jre();function r(a,o){return n(a,t(e(o)))}return j1=r,j1}var Ere=Sre();const Uu=ot(Ere);var S1,i3;function Ore(){if(i3)return S1;i3=1;function e(t){return t===void 0}return S1=e,S1}var Cre=Ore();const Wu=ot(Cre);function en(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=en(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Nre={value:()=>{}};function vh(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new bh(n)}function bh(e){this._=e}function Mre(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}bh.prototype=vh.prototype={constructor:bh,on:function(e,t){var n=this._,r=Mre(e+"",n),a,o=-1,i=r.length;if(arguments.length<2){for(;++o<i;)if((a=(e=r[o]).type)&&(a=Pre(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<i;)if(a=(e=r[o]).type)n[a]=s3(n[a],e.name,t);else if(t==null)for(a in n)n[a]=s3(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new bh(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,o;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,a=o.length;r<a;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,o=r.length;a<o;++a)r[a].value.apply(t,n)}};function Pre(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function s3(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=Nre,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var E1="http://www.w3.org/1999/xhtml";const c3={svg:"http://www.w3.org/2000/svg",xhtml:E1,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function wh(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),c3.hasOwnProperty(t)?{space:c3[t],local:e}:e}function kre(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===E1&&t.documentElement.namespaceURI===E1?t.createElement(e):t.createElementNS(n,e)}}function Are(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function l3(e){var t=wh(e);return(t.local?Are:kre)(t)}function Tre(){}function O1(e){return e==null?Tre:function(){return this.querySelector(e)}}function Rre(e){typeof e!="function"&&(e=O1(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=new Array(i),c,l,u=0;u<i;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),s[u]=l);return new pr(r,this._parents)}function Ire(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Dre(){return[]}function u3(e){return e==null?Dre:function(){return this.querySelectorAll(e)}}function Lre(e){return function(){return Ire(e.apply(this,arguments))}}function $re(e){typeof e=="function"?e=Lre(e):e=u3(e);for(var t=this._groups,n=t.length,r=[],a=[],o=0;o<n;++o)for(var i=t[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),a.push(c));return new pr(r,a)}function d3(e){return function(){return this.matches(e)}}function f3(e){return function(t){return t.matches(e)}}var Fre=Array.prototype.find;function Bre(e){return function(){return Fre.call(this.children,e)}}function zre(){return this.firstElementChild}function Vre(e){return this.select(e==null?zre:Bre(typeof e=="function"?e:f3(e)))}var qre=Array.prototype.filter;function Ure(){return Array.from(this.children)}function Wre(e){return function(){return qre.call(this.children,e)}}function Hre(e){return this.selectAll(e==null?Ure:Wre(typeof e=="function"?e:f3(e)))}function Zre(e){typeof e!="function"&&(e=d3(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new pr(r,this._parents)}function p3(e){return new Array(e.length)}function Kre(){return new pr(this._enter||this._groups.map(p3),this._parents)}function xh(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}xh.prototype={constructor:xh,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Xre(e){return function(){return e}}function Gre(e,t,n,r,a,o){for(var i=0,s,c=t.length,l=o.length;i<l;++i)(s=t[i])?(s.__data__=o[i],r[i]=s):n[i]=new xh(e,o[i]);for(;i<c;++i)(s=t[i])&&(a[i]=s)}function Qre(e,t,n,r,a,o,i){var s,c,l=new Map,u=t.length,d=o.length,f=new Array(u),p;for(s=0;s<u;++s)(c=t[s])&&(f[s]=p=i.call(c,c.__data__,s,t)+"",l.has(p)?a[s]=c:l.set(p,c));for(s=0;s<d;++s)p=i.call(e,o[s],s,o)+"",(c=l.get(p))?(r[s]=c,c.__data__=o[s],l.delete(p)):n[s]=new xh(e,o[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(f[s])===c&&(a[s]=c)}function Jre(e){return e.__data__}function Yre(e,t){if(!arguments.length)return Array.from(this,Jre);var n=t?Qre:Gre,r=this._parents,a=this._groups;typeof e!="function"&&(e=Xre(e));for(var o=a.length,i=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],d=a[l],f=d.length,p=eae(e.call(u,u&&u.__data__,l,r)),y=p.length,m=s[l]=new Array(y),v=i[l]=new Array(y),b=c[l]=new Array(f);n(u,d,m,v,b,p,t);for(var w=0,_=0,x,j;w<y;++w)if(x=m[w]){for(w>=_&&(_=w+1);!(j=v[_])&&++_<y;);x._next=j||null}}return i=new pr(i,r),i._enter=s,i._exit=c,i}function eae(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tae(){return new pr(this._exit||this._groups.map(p3),this._parents)}function nae(e,t,n){var r=this.enter(),a=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?o.remove():n(o),r&&a?r.merge(a).order():a}function rae(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,o=r.length,i=Math.min(a,o),s=new Array(a),c=0;c<i;++c)for(var l=n[c],u=r[c],d=l.length,f=s[c]=new Array(d),p,y=0;y<d;++y)(p=l[y]||u[y])&&(f[y]=p);for(;c<a;++c)s[c]=n[c];return new pr(s,this._parents)}function aae(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,o=r[a],i;--a>=0;)(i=r[a])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function oae(e){e||(e=iae);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,a=new Array(r),o=0;o<r;++o){for(var i=n[o],s=i.length,c=a[o]=new Array(s),l,u=0;u<s;++u)(l=i[u])&&(c[u]=l);c.sort(t)}return new pr(a,this._parents).order()}function iae(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function sae(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function cae(){return Array.from(this)}function lae(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length;a<o;++a){var i=r[a];if(i)return i}return null}function uae(){let e=0;for(const t of this)++e;return e}function dae(){return!this.node()}function fae(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],o=0,i=a.length,s;o<i;++o)(s=a[o])&&e.call(s,s.__data__,o,a);return this}function pae(e){return function(){this.removeAttribute(e)}}function hae(e){return function(){this.removeAttributeNS(e.space,e.local)}}function mae(e,t){return function(){this.setAttribute(e,t)}}function yae(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function gae(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function vae(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function bae(e,t){var n=wh(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?hae:pae:typeof t=="function"?n.local?vae:gae:n.local?yae:mae)(n,t))}function h3(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function wae(e){return function(){this.style.removeProperty(e)}}function xae(e,t,n){return function(){this.style.setProperty(e,t,n)}}function _ae(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function jae(e,t,n){return arguments.length>1?this.each((t==null?wae:typeof t=="function"?_ae:xae)(e,t,n??"")):cc(this.node(),e)}function cc(e,t){return e.style.getPropertyValue(t)||h3(e).getComputedStyle(e,null).getPropertyValue(t)}function Sae(e){return function(){delete this[e]}}function Eae(e,t){return function(){this[e]=t}}function Oae(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Cae(e,t){return arguments.length>1?this.each((t==null?Sae:typeof t=="function"?Oae:Eae)(e,t)):this.node()[e]}function m3(e){return e.trim().split(/^|\s+/)}function C1(e){return e.classList||new y3(e)}function y3(e){this._node=e,this._names=m3(e.getAttribute("class")||"")}y3.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function g3(e,t){for(var n=C1(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function v3(e,t){for(var n=C1(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function Nae(e){return function(){g3(this,e)}}function Mae(e){return function(){v3(this,e)}}function Pae(e,t){return function(){(t.apply(this,arguments)?g3:v3)(this,e)}}function kae(e,t){var n=m3(e+"");if(arguments.length<2){for(var r=C1(this.node()),a=-1,o=n.length;++a<o;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?Pae:t?Nae:Mae)(n,t))}function Aae(){this.textContent=""}function Tae(e){return function(){this.textContent=e}}function Rae(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Iae(e){return arguments.length?this.each(e==null?Aae:(typeof e=="function"?Rae:Tae)(e)):this.node().textContent}function Dae(){this.innerHTML=""}function Lae(e){return function(){this.innerHTML=e}}function $ae(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Fae(e){return arguments.length?this.each(e==null?Dae:(typeof e=="function"?$ae:Lae)(e)):this.node().innerHTML}function Bae(){this.nextSibling&&this.parentNode.appendChild(this)}function zae(){return this.each(Bae)}function Vae(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function qae(){return this.each(Vae)}function Uae(e){var t=typeof e=="function"?e:l3(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Wae(){return null}function Hae(e,t){var n=typeof e=="function"?e:l3(e),r=t==null?Wae:typeof t=="function"?t:O1(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Zae(){var e=this.parentNode;e&&e.removeChild(this)}function Kae(){return this.each(Zae)}function Xae(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Gae(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Qae(e){return this.select(e?Gae:Xae)}function Jae(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Yae(e){return function(t){e.call(this,t,this.__data__)}}function eoe(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function toe(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,o;n<a;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function noe(e,t,n){return function(){var r=this.__on,a,o=Yae(t);if(r){for(var i=0,s=r.length;i<s;++i)if((a=r[i]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=o,a.options=n),a.value=t;return}}this.addEventListener(e.type,o,n),a={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(a):this.__on=[a]}}function roe(e,t,n){var r=eoe(e+""),a,o=r.length,i;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(a=0,u=s[c];a<o;++a)if((i=r[a]).type===u.type&&i.name===u.name)return u.value}return}for(s=t?noe:toe,a=0;a<o;++a)this.each(s(r[a],t,n));return this}function b3(e,t,n){var r=h3(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function aoe(e,t){return function(){return b3(this,e,t)}}function ooe(e,t){return function(){return b3(this,e,t.apply(this,arguments))}}function ioe(e,t){return this.each((typeof t=="function"?ooe:aoe)(e,t))}function*soe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length,i;a<o;++a)(i=r[a])&&(yield i)}var w3=[null];function pr(e,t){this._groups=e,this._parents=t}function Hu(){return new pr([[document.documentElement]],w3)}function coe(){return this}pr.prototype=Hu.prototype={constructor:pr,select:Rre,selectAll:$re,selectChild:Vre,selectChildren:Hre,filter:Zre,data:Yre,enter:Kre,exit:tae,join:nae,merge:rae,selection:coe,order:aae,sort:oae,call:sae,nodes:cae,node:lae,size:uae,empty:dae,each:fae,attr:bae,style:jae,property:Cae,classed:kae,text:Iae,html:Fae,raise:zae,lower:qae,append:Uae,insert:Hae,remove:Kae,clone:Qae,datum:Jae,on:roe,dispatch:ioe,[Symbol.iterator]:soe};function hr(e){return typeof e=="string"?new pr([[document.querySelector(e)]],[document.documentElement]):new pr([[e]],w3)}function loe(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Kr(e,t){if(e=loe(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const uoe={passive:!1},Zu={capture:!0,passive:!1};function N1(e){e.stopImmediatePropagation()}function lc(e){e.preventDefault(),e.stopImmediatePropagation()}function x3(e){var t=e.document.documentElement,n=hr(e).on("dragstart.drag",lc,Zu);"onselectstart"in t?n.on("selectstart.drag",lc,Zu):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function _3(e,t){var n=e.document.documentElement,r=hr(e).on("dragstart.drag",null);t&&(r.on("click.drag",lc,Zu),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const _h=e=>()=>e;function M1(e,{sourceEvent:t,subject:n,target:r,identifier:a,active:o,x:i,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}M1.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function doe(e){return!e.ctrlKey&&!e.button}function foe(){return this.parentNode}function poe(e,t){return t??{x:e.x,y:e.y}}function hoe(){return navigator.maxTouchPoints||"ontouchstart"in this}function j3(){var e=doe,t=foe,n=poe,r=hoe,a={},o=vh("start","drag","end"),i=0,s,c,l,u,d=0;function f(x){x.on("mousedown.drag",p).filter(r).on("touchstart.drag",v).on("touchmove.drag",b,uoe).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(x,j){if(!(u||!e.call(this,x,j))){var S=_(this,t.call(this,x,j),x,j,"mouse");S&&(hr(x.view).on("mousemove.drag",y,Zu).on("mouseup.drag",m,Zu),x3(x.view),N1(x),l=!1,s=x.clientX,c=x.clientY,S("start",x))}}function y(x){if(lc(x),!l){var j=x.clientX-s,S=x.clientY-c;l=j*j+S*S>d}a.mouse("drag",x)}function m(x){hr(x.view).on("mousemove.drag mouseup.drag",null),_3(x.view,l),lc(x),a.mouse("end",x)}function v(x,j){if(e.call(this,x,j)){var S=x.changedTouches,E=t.call(this,x,j),O=S.length,M,N;for(M=0;M<O;++M)(N=_(this,E,x,j,S[M].identifier,S[M]))&&(N1(x),N("start",x,S[M]))}}function b(x){var j=x.changedTouches,S=j.length,E,O;for(E=0;E<S;++E)(O=a[j[E].identifier])&&(lc(x),O("drag",x,j[E]))}function w(x){var j=x.changedTouches,S=j.length,E,O;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),E=0;E<S;++E)(O=a[j[E].identifier])&&(N1(x),O("end",x,j[E]))}function _(x,j,S,E,O,M){var N=o.copy(),P=Kr(M||S,j),R,k,C;if((C=n.call(x,new M1("beforestart",{sourceEvent:S,target:f,identifier:O,active:i,x:P[0],y:P[1],dx:0,dy:0,dispatch:N}),E))!=null)return R=C.x-P[0]||0,k=C.y-P[1]||0,function T(A,I,L){var D=P,B;switch(A){case"start":a[O]=T,B=i++;break;case"end":delete a[O],--i;case"drag":P=Kr(L||I,j),B=i;break}N.call(A,x,new M1(A,{sourceEvent:I,subject:C,target:f,identifier:O,active:B,x:P[0]+R,y:P[1]+k,dx:P[0]-D[0],dy:P[1]-D[1],dispatch:N}),E)}}return f.filter=function(x){return arguments.length?(e=typeof x=="function"?x:_h(!!x),f):e},f.container=function(x){return arguments.length?(t=typeof x=="function"?x:_h(x),f):t},f.subject=function(x){return arguments.length?(n=typeof x=="function"?x:_h(x),f):n},f.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:_h(!!x),f):r},f.on=function(){var x=o.on.apply(o,arguments);return x===o?f:x},f.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,f):Math.sqrt(d)},f}function P1(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function S3(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ku(){}var Xu=.7,jh=1/Xu,uc="\\s*([+-]?\\d+)\\s*",Gu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Aa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",moe=/^#([0-9a-f]{3,8})$/,yoe=new RegExp(`^rgb\\(${uc},${uc},${uc}\\)$`),goe=new RegExp(`^rgb\\(${Aa},${Aa},${Aa}\\)$`),voe=new RegExp(`^rgba\\(${uc},${uc},${uc},${Gu}\\)$`),boe=new RegExp(`^rgba\\(${Aa},${Aa},${Aa},${Gu}\\)$`),woe=new RegExp(`^hsl\\(${Gu},${Aa},${Aa}\\)$`),xoe=new RegExp(`^hsla\\(${Gu},${Aa},${Aa},${Gu}\\)$`),E3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};P1(Ku,Zi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:O3,formatHex:O3,formatHex8:_oe,formatHsl:joe,formatRgb:C3,toString:C3});function O3(){return this.rgb().formatHex()}function _oe(){return this.rgb().formatHex8()}function joe(){return A3(this).formatHsl()}function C3(){return this.rgb().formatRgb()}function Zi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=moe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?N3(t):n===3?new Kn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Sh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Sh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=yoe.exec(e))?new Kn(t[1],t[2],t[3],1):(t=goe.exec(e))?new Kn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=voe.exec(e))?Sh(t[1],t[2],t[3],t[4]):(t=boe.exec(e))?Sh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=woe.exec(e))?k3(t[1],t[2]/100,t[3]/100,1):(t=xoe.exec(e))?k3(t[1],t[2]/100,t[3]/100,t[4]):E3.hasOwnProperty(e)?N3(E3[e]):e==="transparent"?new Kn(NaN,NaN,NaN,0):null}function N3(e){return new Kn(e>>16&255,e>>8&255,e&255,1)}function Sh(e,t,n,r){return r<=0&&(e=t=n=NaN),new Kn(e,t,n,r)}function Soe(e){return e instanceof Ku||(e=Zi(e)),e?(e=e.rgb(),new Kn(e.r,e.g,e.b,e.opacity)):new Kn}function k1(e,t,n,r){return arguments.length===1?Soe(e):new Kn(e,t,n,r??1)}function Kn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}P1(Kn,k1,S3(Ku,{brighter(e){return e=e==null?jh:Math.pow(jh,e),new Kn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Xu:Math.pow(Xu,e),new Kn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Kn(Ki(this.r),Ki(this.g),Ki(this.b),Eh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:M3,formatHex:M3,formatHex8:Eoe,formatRgb:P3,toString:P3}));function M3(){return`#${Xi(this.r)}${Xi(this.g)}${Xi(this.b)}`}function Eoe(){return`#${Xi(this.r)}${Xi(this.g)}${Xi(this.b)}${Xi((isNaN(this.opacity)?1:this.opacity)*255)}`}function P3(){const e=Eh(this.opacity);return`${e===1?"rgb(":"rgba("}${Ki(this.r)}, ${Ki(this.g)}, ${Ki(this.b)}${e===1?")":`, ${e})`}`}function Eh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ki(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Xi(e){return e=Ki(e),(e<16?"0":"")+e.toString(16)}function k3(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Xr(e,t,n,r)}function A3(e){if(e instanceof Xr)return new Xr(e.h,e.s,e.l,e.opacity);if(e instanceof Ku||(e=Zi(e)),!e)return new Xr;if(e instanceof Xr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,s=o-a,c=(o+a)/2;return s?(t===o?i=(n-r)/s+(n<r)*6:n===o?i=(r-t)/s+2:i=(t-n)/s+4,s/=c<.5?o+a:2-o-a,i*=60):s=c>0&&c<1?0:i,new Xr(i,s,c,e.opacity)}function Ooe(e,t,n,r){return arguments.length===1?A3(e):new Xr(e,t,n,r??1)}function Xr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}P1(Xr,Ooe,S3(Ku,{brighter(e){return e=e==null?jh:Math.pow(jh,e),new Xr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Xu:Math.pow(Xu,e),new Xr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Kn(A1(e>=240?e-240:e+120,a,r),A1(e,a,r),A1(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new Xr(T3(this.h),Oh(this.s),Oh(this.l),Eh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Eh(this.opacity);return`${e===1?"hsl(":"hsla("}${T3(this.h)}, ${Oh(this.s)*100}%, ${Oh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function T3(e){return e=(e||0)%360,e<0?e+360:e}function Oh(e){return Math.max(0,Math.min(1,e||0))}function A1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const T1=e=>()=>e;function Coe(e,t){return function(n){return e+n*t}}function Noe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Moe(e){return(e=+e)==1?R3:function(t,n){return n-t?Noe(t,n,e):T1(isNaN(t)?n:t)}}function R3(e,t){var n=t-e;return n?Coe(e,n):T1(isNaN(e)?t:e)}const Ch=function e(t){var n=Moe(t);function r(a,o){var i=n((a=k1(a)).r,(o=k1(o)).r),s=n(a.g,o.g),c=n(a.b,o.b),l=R3(a.opacity,o.opacity);return function(u){return a.r=i(u),a.g=s(u),a.b=c(u),a.opacity=l(u),a+""}}return r.gamma=e,r}(1);function Poe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(o){for(a=0;a<n;++a)r[a]=e[a]*(1-o)+t[a]*o;return r}}function koe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Aoe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),o=new Array(n),i;for(i=0;i<r;++i)a[i]=dc(e[i],t[i]);for(;i<n;++i)o[i]=t[i];return function(s){for(i=0;i<r;++i)o[i]=a[i](s);return o}}function Toe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Gr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Roe(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=dc(e[a],t[a]):r[a]=t[a];return function(o){for(a in n)r[a]=n[a](o);return r}}var R1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,I1=new RegExp(R1.source,"g");function Ioe(e){return function(){return e}}function Doe(e){return function(t){return e(t)+""}}function I3(e,t){var n=R1.lastIndex=I1.lastIndex=0,r,a,o,i=-1,s=[],c=[];for(e=e+"",t=t+"";(r=R1.exec(e))&&(a=I1.exec(t));)(o=a.index)>n&&(o=t.slice(n,o),s[i]?s[i]+=o:s[++i]=o),(r=r[0])===(a=a[0])?s[i]?s[i]+=a:s[++i]=a:(s[++i]=null,c.push({i,x:Gr(r,a)})),n=I1.lastIndex;return n<t.length&&(o=t.slice(n),s[i]?s[i]+=o:s[++i]=o),s.length<2?c[0]?Doe(c[0].x):Ioe(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)s[(d=c[u]).i]=d.x(l);return s.join("")})}function dc(e,t){var n=typeof t,r;return t==null||n==="boolean"?T1(t):(n==="number"?Gr:n==="string"?(r=Zi(t))?(t=r,Ch):I3:t instanceof Zi?Ch:t instanceof Date?Toe:koe(t)?Poe:Array.isArray(t)?Aoe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Roe:Gr)(e,t)}function D1(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var D3=180/Math.PI,L3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function $3(e,t,n,r,a,o){var i,s,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:a,translateY:o,rotate:Math.atan2(t,e)*D3,skewX:Math.atan(c)*D3,scaleX:i,scaleY:s}}var Nh;function Loe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?L3:$3(t.a,t.b,t.c,t.d,t.e,t.f)}function $oe(e){return e==null||(Nh||(Nh=document.createElementNS("http://www.w3.org/2000/svg","g")),Nh.setAttribute("transform",e),!(e=Nh.transform.baseVal.consolidate()))?L3:(e=e.matrix,$3(e.a,e.b,e.c,e.d,e.e,e.f))}function F3(e,t,n,r){function a(l){return l.length?l.pop()+" ":""}function o(l,u,d,f,p,y){if(l!==d||u!==f){var m=p.push("translate(",null,t,null,n);y.push({i:m-4,x:Gr(l,d)},{i:m-2,x:Gr(u,f)})}else(d||f)&&p.push("translate("+d+t+f+n)}function i(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(a(d)+"rotate(",null,r)-2,x:Gr(l,u)})):u&&d.push(a(d)+"rotate("+u+r)}function s(l,u,d,f){l!==u?f.push({i:d.push(a(d)+"skewX(",null,r)-2,x:Gr(l,u)}):u&&d.push(a(d)+"skewX("+u+r)}function c(l,u,d,f,p,y){if(l!==d||u!==f){var m=p.push(a(p)+"scale(",null,",",null,")");y.push({i:m-4,x:Gr(l,d)},{i:m-2,x:Gr(u,f)})}else(d!==1||f!==1)&&p.push(a(p)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,d,f),i(l.rotate,u.rotate,d,f),s(l.skewX,u.skewX,d,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(p){for(var y=-1,m=f.length,v;++y<m;)d[(v=f[y]).i]=v.x(p);return d.join("")}}}var Foe=F3(Loe,"px, ","px)","deg)"),Boe=F3($oe,", ",")",")"),zoe=1e-12;function B3(e){return((e=Math.exp(e))+1/e)/2}function Voe(e){return((e=Math.exp(e))-1/e)/2}function qoe(e){return((e=Math.exp(2*e))-1)/(e+1)}const Uoe=function e(t,n,r){function a(o,i){var s=o[0],c=o[1],l=o[2],u=i[0],d=i[1],f=i[2],p=u-s,y=d-c,m=p*p+y*y,v,b;if(m<zoe)b=Math.log(f/l)/t,v=function(E){return[s+E*p,c+E*y,l*Math.exp(t*E*b)]};else{var w=Math.sqrt(m),_=(f*f-l*l+r*m)/(2*l*n*w),x=(f*f-l*l-r*m)/(2*f*n*w),j=Math.log(Math.sqrt(_*_+1)-_),S=Math.log(Math.sqrt(x*x+1)-x);b=(S-j)/t,v=function(E){var O=E*b,M=B3(j),N=l/(n*w)*(M*qoe(t*O+j)-Voe(j));return[s+N*p,c+N*y,l*M/B3(t*O+j)]}}return v.duration=b*1e3*t/Math.SQRT2,v}return a.rho=function(o){var i=Math.max(.001,+o),s=i*i,c=s*s;return e(i,s,c)},a}(Math.SQRT2,2,4);function Woe(e,t){t===void 0&&(t=e,e=dc);for(var n=0,r=t.length-1,a=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(a,a=t[++n]);return function(i){var s=Math.max(0,Math.min(r-1,Math.floor(i*=r)));return o[s](i-s)}}var fc=0,Qu=0,Ju=0,z3=1e3,Mh,Yu,Ph=0,Gi=0,kh=0,ed=typeof performance=="object"&&performance.now?performance:Date,V3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function L1(){return Gi||(V3(Hoe),Gi=ed.now()+kh)}function Hoe(){Gi=0}function Ah(){this._call=this._time=this._next=null}Ah.prototype=q3.prototype={constructor:Ah,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?L1():+n)+(t==null?0:+t),!this._next&&Yu!==this&&(Yu?Yu._next=this:Mh=this,Yu=this),this._call=e,this._time=n,$1()},stop:function(){this._call&&(this._call=null,this._time=1/0,$1())}};function q3(e,t,n){var r=new Ah;return r.restart(e,t,n),r}function Zoe(){L1(),++fc;for(var e=Mh,t;e;)(t=Gi-e._time)>=0&&e._call.call(void 0,t),e=e._next;--fc}function U3(){Gi=(Ph=ed.now())+kh,fc=Qu=0;try{Zoe()}finally{fc=0,Xoe(),Gi=0}}function Koe(){var e=ed.now(),t=e-Ph;t>z3&&(kh-=t,Ph=e)}function Xoe(){for(var e,t=Mh,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Mh=n);Yu=e,$1(r)}function $1(e){if(!fc){Qu&&(Qu=clearTimeout(Qu));var t=e-Gi;t>24?(e<1/0&&(Qu=setTimeout(U3,e-ed.now()-kh)),Ju&&(Ju=clearInterval(Ju))):(Ju||(Ph=ed.now(),Ju=setInterval(Koe,z3)),fc=1,V3(U3))}}function W3(e,t,n){var r=new Ah;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var Goe=vh("start","end","cancel","interrupt"),Qoe=[],H3=0,Z3=1,F1=2,Th=3,K3=4,B1=5,Rh=6;function Ih(e,t,n,r,a,o){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;Joe(e,n,{name:t,index:r,group:a,on:Goe,tween:Qoe,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:H3})}function z1(e,t){var n=Qr(e,t);if(n.state>H3)throw new Error("too late; already scheduled");return n}function Ta(e,t){var n=Qr(e,t);if(n.state>Th)throw new Error("too late; already running");return n}function Qr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Joe(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=q3(o,0,n.time);function o(l){n.state=Z3,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var u,d,f,p;if(n.state!==Z3)return c();for(u in r)if(p=r[u],p.name===n.name){if(p.state===Th)return W3(i);p.state===K3?(p.state=Rh,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete r[u]):+u<t&&(p.state=Rh,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete r[u])}if(W3(function(){n.state===Th&&(n.state=K3,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=F1,n.on.call("start",e,e.__data__,n.index,n.group),n.state===F1){for(n.state=Th,a=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(p=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(a[++d]=p);a.length=d+1}}function s(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=B1,1),d=-1,f=a.length;++d<f;)a[d].call(e,u);n.state===B1&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Rh,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function Dh(e,t){var n=e.__transition,r,a,o=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){o=!1;continue}a=r.state>F1&&r.state<B1,r.state=Rh,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}o&&delete e.__transition}}function Yoe(e){return this.each(function(){Dh(this,e)})}function eie(e,t){var n,r;return function(){var a=Ta(this,e),o=a.tween;if(o!==n){r=n=o;for(var i=0,s=r.length;i<s;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}a.tween=r}}function tie(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var o=Ta(this,e),i=o.tween;if(i!==r){a=(r=i).slice();for(var s={name:t,value:n},c=0,l=a.length;c<l;++c)if(a[c].name===t){a[c]=s;break}c===l&&a.push(s)}o.tween=a}}function nie(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Qr(this.node(),n).tween,a=0,o=r.length,i;a<o;++a)if((i=r[a]).name===e)return i.value;return null}return this.each((t==null?eie:tie)(n,e,t))}function V1(e,t,n){var r=e._id;return e.each(function(){var a=Ta(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return Qr(a,r).value[t]}}function X3(e,t){var n;return(typeof t=="number"?Gr:t instanceof Zi?Ch:(n=Zi(t))?(t=n,Ch):I3)(e,t)}function rie(e){return function(){this.removeAttribute(e)}}function aie(e){return function(){this.removeAttributeNS(e.space,e.local)}}function oie(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttribute(e);return i===a?null:i===r?o:o=t(r=i,n)}}function iie(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===r?o:o=t(r=i,n)}}function sie(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function cie(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function lie(e,t){var n=wh(e),r=n==="transform"?Boe:X3;return this.attrTween(e,typeof t=="function"?(n.local?cie:sie)(n,r,V1(this,"attr."+e,t)):t==null?(n.local?aie:rie)(n):(n.local?iie:oie)(n,r,t))}function uie(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function die(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function fie(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&die(e,o)),n}return a._value=t,a}function pie(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&uie(e,o)),n}return a._value=t,a}function hie(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=wh(e);return this.tween(n,(r.local?fie:pie)(r,t))}function mie(e,t){return function(){z1(this,e).delay=+t.apply(this,arguments)}}function yie(e,t){return t=+t,function(){z1(this,e).delay=t}}function gie(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?mie:yie)(t,e)):Qr(this.node(),t).delay}function vie(e,t){return function(){Ta(this,e).duration=+t.apply(this,arguments)}}function bie(e,t){return t=+t,function(){Ta(this,e).duration=t}}function wie(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?vie:bie)(t,e)):Qr(this.node(),t).duration}function xie(e,t){if(typeof t!="function")throw new Error;return function(){Ta(this,e).ease=t}}function _ie(e){var t=this._id;return arguments.length?this.each(xie(t,e)):Qr(this.node(),t).ease}function jie(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ta(this,e).ease=n}}function Sie(e){if(typeof e!="function")throw new Error;return this.each(jie(this._id,e))}function Eie(e){typeof e!="function"&&(e=d3(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new wo(r,this._parents,this._name,this._id)}function Oie(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,o=Math.min(r,a),i=new Array(r),s=0;s<o;++s)for(var c=t[s],l=n[s],u=c.length,d=i[s]=new Array(u),f,p=0;p<u;++p)(f=c[p]||l[p])&&(d[p]=f);for(;s<r;++s)i[s]=t[s];return new wo(i,this._parents,this._name,this._id)}function Cie(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Nie(e,t,n){var r,a,o=Cie(t)?z1:Ta;return function(){var i=o(this,e),s=i.on;s!==r&&(a=(r=s).copy()).on(t,n),i.on=a}}function Mie(e,t){var n=this._id;return arguments.length<2?Qr(this.node(),n).on.on(e):this.each(Nie(n,e,t))}function Pie(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function kie(){return this.on("end.remove",Pie(this._id))}function Aie(e){var t=this._name,n=this._id;typeof e!="function"&&(e=O1(e));for(var r=this._groups,a=r.length,o=new Array(a),i=0;i<a;++i)for(var s=r[i],c=s.length,l=o[i]=new Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,Ih(l[f],t,n,f,l,Qr(u,n)));return new wo(o,this._parents,t,n)}function Tie(e){var t=this._name,n=this._id;typeof e!="function"&&(e=u3(e));for(var r=this._groups,a=r.length,o=[],i=[],s=0;s<a;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),p,y=Qr(u,n),m=0,v=f.length;m<v;++m)(p=f[m])&&Ih(p,t,n,m,f,y);o.push(f),i.push(u)}return new wo(o,i,t,n)}var Rie=Hu.prototype.constructor;function Iie(){return new Rie(this._groups,this._parents)}function Die(e,t){var n,r,a;return function(){var o=cc(this,e),i=(this.style.removeProperty(e),cc(this,e));return o===i?null:o===n&&i===r?a:a=t(n=o,r=i)}}function G3(e){return function(){this.style.removeProperty(e)}}function Lie(e,t,n){var r,a=n+"",o;return function(){var i=cc(this,e);return i===a?null:i===r?o:o=t(r=i,n)}}function $ie(e,t,n){var r,a,o;return function(){var i=cc(this,e),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),cc(this,e))),i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s))}}function Fie(e,t){var n,r,a,o="style."+t,i="end."+o,s;return function(){var c=Ta(this,e),l=c.on,u=c.value[o]==null?s||(s=G3(t)):void 0;(l!==n||a!==u)&&(r=(n=l).copy()).on(i,a=u),c.on=r}}function Bie(e,t,n){var r=(e+="")=="transform"?Foe:X3;return t==null?this.styleTween(e,Die(e,r)).on("end.style."+e,G3(e)):typeof t=="function"?this.styleTween(e,$ie(e,r,V1(this,"style."+e,t))).each(Fie(this._id,e)):this.styleTween(e,Lie(e,r,t),n).on("end.style."+e,null)}function zie(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Vie(e,t,n){var r,a;function o(){var i=t.apply(this,arguments);return i!==a&&(r=(a=i)&&zie(e,i,n)),r}return o._value=t,o}function qie(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Vie(e,t,n??""))}function Uie(e){return function(){this.textContent=e}}function Wie(e){return function(){var t=e(this);this.textContent=t??""}}function Hie(e){return this.tween("text",typeof e=="function"?Wie(V1(this,"text",e)):Uie(e==null?"":e+""))}function Zie(e){return function(t){this.textContent=e.call(this,t)}}function Kie(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&Zie(a)),t}return r._value=e,r}function Xie(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Kie(e))}function Gie(){for(var e=this._name,t=this._id,n=Q3(),r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)if(c=i[l]){var u=Qr(c,t);Ih(c,e,n,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new wo(r,this._parents,e,n)}function Qie(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(o,i){var s={value:i},c={value:function(){--a===0&&o()}};n.each(function(){var l=Ta(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),l.on=t}),a===0&&o()})}var Jie=0;function wo(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Q3(){return++Jie}var xo=Hu.prototype;wo.prototype={constructor:wo,select:Aie,selectAll:Tie,selectChild:xo.selectChild,selectChildren:xo.selectChildren,filter:Eie,merge:Oie,selection:Iie,transition:Gie,call:xo.call,nodes:xo.nodes,node:xo.node,size:xo.size,empty:xo.empty,each:xo.each,on:Mie,attr:lie,attrTween:hie,style:Bie,styleTween:qie,text:Hie,textTween:Xie,remove:kie,tween:nie,delay:gie,duration:wie,ease:_ie,easeVarying:Sie,end:Qie,[Symbol.iterator]:xo[Symbol.iterator]};function Yie(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var ese={time:null,delay:0,duration:250,ease:Yie};function tse(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function nse(e){var t,n;e instanceof wo?(t=e._id,e=e._name):(t=Q3(),(n=ese).time=L1(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&Ih(c,e,t,l,i,n||tse(c,t));return new wo(r,this._parents,e,t)}Hu.prototype.interrupt=Yoe,Hu.prototype.transition=nse;const Lh=e=>()=>e;function rse(e,{sourceEvent:t,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function _o(e,t,n){this.k=e,this.x=t,this.y=n}_o.prototype={constructor:_o,scale:function(e){return e===1?this:new _o(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new _o(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var $h=new _o(1,0,0);J3.prototype=_o.prototype;function J3(e){for(;!e.__zoom;)if(!(e=e.parentNode))return $h;return e.__zoom}function q1(e){e.stopImmediatePropagation()}function td(e){e.preventDefault(),e.stopImmediatePropagation()}function ase(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function ose(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Y3(){return this.__zoom||$h}function ise(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function sse(){return navigator.maxTouchPoints||"ontouchstart"in this}function cse(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function e5(){var e=ase,t=ose,n=cse,r=ise,a=sse,o=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,c=Uoe,l=vh("start","zoom","end"),u,d,f,p=500,y=150,m=0,v=10;function b(C){C.property("__zoom",Y3).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",N).filter(a).on("touchstart.zoom",P).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(C,T,A,I){var L=C.selection?C.selection():C;L.property("__zoom",Y3),C!==L?j(C,T,A,I):L.interrupt().each(function(){S(this,arguments).event(I).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},b.scaleBy=function(C,T,A,I){b.scaleTo(C,function(){var L=this.__zoom.k,D=typeof T=="function"?T.apply(this,arguments):T;return L*D},A,I)},b.scaleTo=function(C,T,A,I){b.transform(C,function(){var L=t.apply(this,arguments),D=this.__zoom,B=A==null?x(L):typeof A=="function"?A.apply(this,arguments):A,F=D.invert(B),$=typeof T=="function"?T.apply(this,arguments):T;return n(_(w(D,$),B,F),L,i)},A,I)},b.translateBy=function(C,T,A,I){b.transform(C,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),i)},null,I)},b.translateTo=function(C,T,A,I,L){b.transform(C,function(){var D=t.apply(this,arguments),B=this.__zoom,F=I==null?x(D):typeof I=="function"?I.apply(this,arguments):I;return n($h.translate(F[0],F[1]).scale(B.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof A=="function"?-A.apply(this,arguments):-A),D,i)},I,L)};function w(C,T){return T=Math.max(o[0],Math.min(o[1],T)),T===C.k?C:new _o(T,C.x,C.y)}function _(C,T,A){var I=T[0]-A[0]*C.k,L=T[1]-A[1]*C.k;return I===C.x&&L===C.y?C:new _o(C.k,I,L)}function x(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function j(C,T,A,I){C.on("start.zoom",function(){S(this,arguments).event(I).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(I).end()}).tween("zoom",function(){var L=this,D=arguments,B=S(L,D).event(I),F=t.apply(L,D),$=A==null?x(F):typeof A=="function"?A.apply(L,D):A,V=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),G=L.__zoom,X=typeof T=="function"?T.apply(L,D):T,H=c(G.invert($).concat(V/G.k),X.invert($).concat(V/X.k));return function(J){if(J===1)J=X;else{var Z=H(J),U=V/Z[2];J=new _o(U,$[0]-Z[0]*U,$[1]-Z[1]*U)}B.zoom(null,J)}})}function S(C,T,A){return!A&&C.__zooming||new E(C,T)}function E(C,T){this.that=C,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,T),this.taps=0}E.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,T){return this.mouse&&C!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var T=hr(this.that).datum();l.call(C,this.that,new rse(C,{sourceEvent:this.sourceEvent,target:b,type:C,transform:this.that.__zoom,dispatch:l}),T)}};function O(C,...T){if(!e.apply(this,arguments))return;var A=S(this,T).event(C),I=this.__zoom,L=Math.max(o[0],Math.min(o[1],I.k*Math.pow(2,r.apply(this,arguments)))),D=Kr(C);if(A.wheel)(A.mouse[0][0]!==D[0]||A.mouse[0][1]!==D[1])&&(A.mouse[1]=I.invert(A.mouse[0]=D)),clearTimeout(A.wheel);else{if(I.k===L)return;A.mouse=[D,I.invert(D)],Dh(this),A.start()}td(C),A.wheel=setTimeout(B,y),A.zoom("mouse",n(_(w(I,L),A.mouse[0],A.mouse[1]),A.extent,i));function B(){A.wheel=null,A.end()}}function M(C,...T){if(f||!e.apply(this,arguments))return;var A=C.currentTarget,I=S(this,T,!0).event(C),L=hr(C.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",V,!0),D=Kr(C,A),B=C.clientX,F=C.clientY;x3(C.view),q1(C),I.mouse=[D,this.__zoom.invert(D)],Dh(this),I.start();function $(G){if(td(G),!I.moved){var X=G.clientX-B,H=G.clientY-F;I.moved=X*X+H*H>m}I.event(G).zoom("mouse",n(_(I.that.__zoom,I.mouse[0]=Kr(G,A),I.mouse[1]),I.extent,i))}function V(G){L.on("mousemove.zoom mouseup.zoom",null),_3(G.view,I.moved),td(G),I.event(G).end()}}function N(C,...T){if(e.apply(this,arguments)){var A=this.__zoom,I=Kr(C.changedTouches?C.changedTouches[0]:C,this),L=A.invert(I),D=A.k*(C.shiftKey?.5:2),B=n(_(w(A,D),I,L),t.apply(this,T),i);td(C),s>0?hr(this).transition().duration(s).call(j,B,I,C):hr(this).call(b.transform,B,I,C)}}function P(C,...T){if(e.apply(this,arguments)){var A=C.touches,I=A.length,L=S(this,T,C.changedTouches.length===I).event(C),D,B,F,$;for(q1(C),B=0;B<I;++B)F=A[B],$=Kr(F,this),$=[$,this.__zoom.invert($),F.identifier],L.touch0?!L.touch1&&L.touch0[2]!==$[2]&&(L.touch1=$,L.taps=0):(L.touch0=$,D=!0,L.taps=1+!!u);u&&(u=clearTimeout(u)),D&&(L.taps<2&&(d=$[0],u=setTimeout(function(){u=null},p)),Dh(this),L.start())}}function R(C,...T){if(this.__zooming){var A=S(this,T).event(C),I=C.changedTouches,L=I.length,D,B,F,$;for(td(C),D=0;D<L;++D)B=I[D],F=Kr(B,this),A.touch0&&A.touch0[2]===B.identifier?A.touch0[0]=F:A.touch1&&A.touch1[2]===B.identifier&&(A.touch1[0]=F);if(B=A.that.__zoom,A.touch1){var V=A.touch0[0],G=A.touch0[1],X=A.touch1[0],H=A.touch1[1],J=(J=X[0]-V[0])*J+(J=X[1]-V[1])*J,Z=(Z=H[0]-G[0])*Z+(Z=H[1]-G[1])*Z;B=w(B,Math.sqrt(J/Z)),F=[(V[0]+X[0])/2,(V[1]+X[1])/2],$=[(G[0]+H[0])/2,(G[1]+H[1])/2]}else if(A.touch0)F=A.touch0[0],$=A.touch0[1];else return;A.zoom("touch",n(_(B,F,$),A.extent,i))}}function k(C,...T){if(this.__zooming){var A=S(this,T).event(C),I=C.changedTouches,L=I.length,D,B;for(q1(C),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),D=0;D<L;++D)B=I[D],A.touch0&&A.touch0[2]===B.identifier?delete A.touch0:A.touch1&&A.touch1[2]===B.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(B=Kr(B,this),Math.hypot(d[0]-B[0],d[1]-B[1])<v)){var F=hr(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return b.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:Lh(+C),b):r},b.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Lh(!!C),b):e},b.touchable=function(C){return arguments.length?(a=typeof C=="function"?C:Lh(!!C),b):a},b.extent=function(C){return arguments.length?(t=typeof C=="function"?C:Lh([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),b):t},b.scaleExtent=function(C){return arguments.length?(o[0]=+C[0],o[1]=+C[1],b):[o[0],o[1]]},b.translateExtent=function(C){return arguments.length?(i[0][0]=+C[0][0],i[1][0]=+C[1][0],i[0][1]=+C[0][1],i[1][1]=+C[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(C){return arguments.length?(n=C,b):n},b.duration=function(C){return arguments.length?(s=+C,b):s},b.interpolate=function(C){return arguments.length?(c=C,b):c},b.on=function(){var C=l.on.apply(l,arguments);return C===l?b:C},b.clickDistance=function(C){return arguments.length?(m=(C=+C)*C,b):Math.sqrt(m)},b.tapDistance=function(C){return arguments.length?(v=+C,b):v},b}const jo={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},nd=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],t5=["Enter"," ","Escape"];var pc;(function(e){e.Strict="strict",e.Loose="loose"})(pc||(pc={}));var ci;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ci||(ci={}));var rd;(function(e){e.Partial="partial",e.Full="full"})(rd||(rd={}));const n5={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var li;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(li||(li={}));var Fh;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Fh||(Fh={}));var he;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(he||(he={}));const r5={[he.Left]:he.Right,[he.Right]:he.Left,[he.Top]:he.Bottom,[he.Bottom]:he.Top};function lse(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function a5(e,t,n){if(!n)return;const r=[];e.forEach((a,o)=>{t!=null&&t.has(o)||r.push(a)}),r.length&&n(r)}function o5(e){return e===null?null:e?"valid":"invalid"}const i5=e=>"id"in e&&"source"in e&&"target"in e,use=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),U1=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),ad=(e,t=[0,0])=>{const{width:n,height:r}=So(e),a=e.origin??t,o=n*a[0],i=r*a[1];return{x:e.position.x-o,y:e.position.y-i}},dse=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,a)=>{const o=typeof a=="string";let i=!t.nodeLookup&&!o?a:void 0;t.nodeLookup&&(i=o?t.nodeLookup.get(a):U1(a)?a:t.nodeLookup.get(a.id));const s=i?Vh(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Bh(r,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return zh(n)},od=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const a=Vh(r);n=Bh(n,a)}}),zh(n)},s5=(e,t,[n,r,a]=[0,0,1],o=!1,i=!1)=>{const s={...sd(t,[n,r,a]),width:t.width/a,height:t.height/a},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:f=!1}=l;if(i&&!d||f)continue;const p=u.width??l.width??l.initialWidth??null,y=u.height??l.height??l.initialHeight??null,m=id(s,mc(l)),v=(p??0)*(y??0),b=o&&m>0;(!l.internals.handleBounds||b||m>=v||l.dragging)&&c.push(l)}return c},fse=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function W1(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&(t!=null&&t.includeHiddenNodes||!a.hidden)&&(!r||r.has(a.id))&&n.set(a.id,a)}),n}async function H1({nodes:e,width:t,height:n,panZoom:r,minZoom:a,maxZoom:o},i){if(e.size===0)return Promise.resolve(!1);const s=od(e),c=K1(s,t,n,(i==null?void 0:i.minZoom)??a,(i==null?void 0:i.maxZoom)??o,(i==null?void 0:i.padding)??.1);return await r.setViewport(c,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function c5({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:a,onError:o}){const i=n.get(e),s=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=s?s.internals.positionAbsolute:{x:0,y:0},u=i.origin??r;let d=a;if(i.extent==="parent"&&!i.expandParent)if(!s)o==null||o("005",jo.error005());else{const p=s.measured.width,y=s.measured.height;p&&y&&(d=[[c,l],[c+p,l+y]])}else s&&yc(i.extent)&&(d=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const f=yc(d)?Qi(t,d,i.measured):t;return{position:{x:f.x-c+i.measured.width*u[0],y:f.y-l+i.measured.height*u[1]},positionAbsolute:f}}async function pse({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:a}){const o=new Set(e.map(d=>d.id)),i=[];for(const d of n){if(d.deletable===!1)continue;const f=o.has(d.id),p=!f&&d.parentId&&i.find(y=>y.id===d.parentId);(f||p)&&i.push(d)}const s=new Set(t.map(d=>d.id)),c=r.filter(d=>d.deletable!==!1),l=fse(i,c);for(const d of c)s.has(d.id)&&!l.find(f=>f.id===d.id)&&l.push(d);if(!a)return{edges:l,nodes:i};const u=await a({nodes:i,edges:l});return typeof u=="boolean"?u?{edges:l,nodes:i}:{edges:[],nodes:[]}:u}const hc=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Qi=(e={x:0,y:0},t,n)=>({x:hc(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:hc(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function l5(e,t,n){const{width:r,height:a}=So(n),{x:o,y:i}=n.internals.positionAbsolute;return Qi(e,[[o,i],[o+r,i+a]],t)}const u5=(e,t,n)=>e<t?hc(Math.abs(e-t),1,t)/t:e>n?-hc(Math.abs(e-n),1,t)/t:0,d5=(e,t,n=15,r=40)=>{const a=u5(e.x,r,t.width-r)*n,o=u5(e.y,r,t.height-r)*n;return[a,o]},Bh=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Z1=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),zh=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),mc=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=U1(e)?e.internals.positionAbsolute:ad(e,t);return{x:n,y:r,width:((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0,height:((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0}},Vh=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=U1(e)?e.internals.positionAbsolute:ad(e,t);return{x:n,y:r,x2:n+(((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0),y2:r+(((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0)}},f5=(e,t)=>zh(Bh(Z1(e),Z1(t))),id=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},p5=e=>Jr(e.width)&&Jr(e.height)&&Jr(e.x)&&Jr(e.y),Jr=e=>!isNaN(e)&&isFinite(e),hse=(e,t)=>{},qh=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),sd=({x:e,y:t},[n,r,a],o=!1,i=[1,1])=>{const s={x:(e-n)/a,y:(t-r)/a};return o?qh(s,i):s},h5=({x:e,y:t},[n,r,a])=>({x:e*a+n,y:t*a+r}),K1=(e,t,n,r,a,o)=>{const i=t/(e.width*(1+o)),s=n/(e.height*(1+o)),c=Math.min(i,s),l=hc(c,r,a),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,p=n/2-d*l;return{x:f,y:p,zoom:l}},Uh=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function yc(e){return e!==void 0&&e!=="parent"}function So(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function m5(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function y5(e,t={width:0,height:0},n,r,a){const o={...e},i=r.get(n);if(i){const s=i.origin||a;o.x+=i.internals.positionAbsolute.x-(t.width??0)*s[0],o.y+=i.internals.positionAbsolute.y-(t.height??0)*s[1]}return o}function cd(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:a}){const{x:o,y:i}=Eo(e),s=sd({x:o-((a==null?void 0:a.left)??0),y:i-((a==null?void 0:a.top)??0)},r),{x:c,y:l}=n?qh(s,t):s;return{xSnapped:c,ySnapped:l,...s}}const Wh=e=>({width:e.offsetWidth,height:e.offsetHeight}),g5=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},mse=["INPUT","SELECT","TEXTAREA"];function X1(e){var n,r;const t=((r=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:r[0])||e.target;return mse.includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}const v5=e=>"clientX"in e,Eo=(e,t)=>{var o,i;const n=v5(e),r=n?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,a=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:a-((t==null?void 0:t.top)??0)}},b5=(e,t,n,r,a)=>{const o=t.querySelectorAll(`.${e}`);return!o||!o.length?null:Array.from(o).map(i=>{const s=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:a,position:i.getAttribute("data-handlepos"),x:(s.left-n.left)/r,y:(s.top-n.top)/r,...Wh(i)}})};function w5({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:a,sourceControlY:o,targetControlX:i,targetControlY:s}){const c=e*.125+a*.375+i*.375+n*.125,l=t*.125+o*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function Hh(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function x5({pos:e,x1:t,y1:n,x2:r,y2:a,c:o}){switch(e){case he.Left:return[t-Hh(t-r,o),n];case he.Right:return[t+Hh(r-t,o),n];case he.Top:return[t,n-Hh(n-a,o)];case he.Bottom:return[t,n+Hh(a-n,o)]}}function _5({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:o=he.Top,curvature:i=.25}){const[s,c]=x5({pos:n,x1:e,y1:t,x2:r,y2:a,c:i}),[l,u]=x5({pos:o,x1:r,y1:a,x2:e,y2:t,c:i}),[d,f,p,y]=w5({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${a}`,d,f,p,y]}function j5({sourceX:e,sourceY:t,targetX:n,targetY:r}){const a=Math.abs(n-e)/2,o=n<e?n+a:n-a,i=Math.abs(r-t)/2,s=r<t?r+i:r-i;return[o,s,a,i]}function yse({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:a=!1}){if(!a)return r;const o=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(o?i:0)}function gse({sourceNode:e,targetNode:t,width:n,height:r,transform:a}){const o=Bh(Vh(e),Vh(t));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const i={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:r/a[2]};return id(i,zh(o))>0}const vse=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,bse=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),S5=(e,t)=>{if(!e.source||!e.target)return t;let n;return i5(e)?n={...e}:n={...e,id:vse(e)},bse(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function E5({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[a,o,i,s]=j5({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,a,o,i,s]}const O5={[he.Left]:{x:-1,y:0},[he.Right]:{x:1,y:0},[he.Top]:{x:0,y:-1},[he.Bottom]:{x:0,y:1}},wse=({source:e,sourcePosition:t=he.Bottom,target:n})=>t===he.Left||t===he.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},C5=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function xse({source:e,sourcePosition:t=he.Bottom,target:n,targetPosition:r=he.Top,center:a,offset:o}){const i=O5[t],s=O5[r],c={x:e.x+i.x*o,y:e.y+i.y*o},l={x:n.x+s.x*o,y:n.y+s.y*o},u=wse({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let p=[],y,m;const v={x:0,y:0},b={x:0,y:0},[w,_,x,j]=j5({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[d]*s[d]===-1){y=a.x??w,m=a.y??_;const S=[{x:y,y:c.y},{x:y,y:l.y}],E=[{x:c.x,y:m},{x:l.x,y:m}];i[d]===f?p=d==="x"?S:E:p=d==="x"?E:S}else{const S=[{x:c.x,y:l.y}],E=[{x:l.x,y:c.y}];if(d==="x"?p=i.x===f?E:S:p=i.y===f?S:E,t===r){const R=Math.abs(e[d]-n[d]);if(R<=o){const k=Math.min(o-1,o-R);i[d]===f?v[d]=(c[d]>e[d]?-1:1)*k:b[d]=(l[d]>n[d]?-1:1)*k}}if(t!==r){const R=d==="x"?"y":"x",k=i[d]===s[R],C=c[R]>l[R],T=c[R]<l[R];(i[d]===1&&(!k&&C||k&&T)||i[d]!==1&&(!k&&T||k&&C))&&(p=d==="x"?S:E)}const O={x:c.x+v.x,y:c.y+v.y},M={x:l.x+b.x,y:l.y+b.y},N=Math.max(Math.abs(O.x-p[0].x),Math.abs(M.x-p[0].x)),P=Math.max(Math.abs(O.y-p[0].y),Math.abs(M.y-p[0].y));N>=P?(y=(O.x+M.x)/2,m=p[0].y):(y=p[0].x,m=(O.y+M.y)/2)}return[[e,{x:c.x+v.x,y:c.y+v.y},...p,{x:l.x+b.x,y:l.y+b.y},n],y,m,x,j]}function _se(e,t,n,r){const a=Math.min(C5(e,t)/2,C5(t,n)/2,r),{x:o,y:i}=t;if(e.x===o&&o===n.x||e.y===i&&i===n.y)return`L${o} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${o+a*l},${i}Q ${o},${i} ${o},${i+a*u}`}const s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${o},${i+a*c}Q ${o},${i} ${o+a*s},${i}`}function G1({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:o=he.Top,borderRadius:i=5,centerX:s,centerY:c,offset:l=20}){const[u,d,f,p,y]=xse({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:a},targetPosition:o,center:{x:s,y:c},offset:l});return[u.reduce((m,v,b)=>{let w="";return b>0&&b<u.length-1?w=_se(u[b-1],v,u[b+1],i):w=`${b===0?"M":"L"}${v.x} ${v.y}`,m+=w,m},""),d,f,p,y]}function N5(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function jse(e){var d;const{sourceNode:t,targetNode:n}=e;if(!N5(t)||!N5(n))return null;const r=t.internals.handleBounds||M5(t.handles),a=n.internals.handleBounds||M5(n.handles),o=P5((r==null?void 0:r.source)??[],e.sourceHandle),i=P5(e.connectionMode===pc.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),e.targetHandle);if(!o||!i)return(d=e.onError)==null||d.call(e,"008",jo.error008(o?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=(o==null?void 0:o.position)||he.Bottom,c=(i==null?void 0:i.position)||he.Top,l=ld(t,o,s),u=ld(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:s,targetPosition:c}}function M5(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function ld(e,t,n=he.Left,r=!1){const a=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,o=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:s}=t??So(e);if(r)return{x:a+i/2,y:o+s/2};switch((t==null?void 0:t.position)??n){case he.Top:return{x:a+i/2,y:o};case he.Right:return{x:a+i,y:o+s/2};case he.Bottom:return{x:a+i/2,y:o+s};case he.Left:return{x:a,y:o+s/2}}}function P5(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Q1(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function Sse(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:a}){const o=new Set;return e.reduce((i,s)=>([s.markerStart||r,s.markerEnd||a].forEach(c=>{if(c&&typeof c=="object"){const l=Q1(c,t);o.has(l)||(i.push({id:l,color:c.color||n,...c}),o.add(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))}const J1={nodeOrigin:[0,0],nodeExtent:nd,elevateNodesOnSelect:!0,defaults:{}},Ese={...J1,checkEquality:!0};function Y1(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function Ose(e,t,n){const r=Y1(J1,n);for(const a of e.values())if(a.parentId)t_(a,e,t,r);else{const o=ad(a,r.nodeOrigin),i=yc(a.extent)?a.extent:r.nodeExtent,s=Qi(o,i,So(a));a.internals.positionAbsolute=s}}function e_(e,t,n,r){var s,c;const a=Y1(Ese,r),o=new Map(t),i=a!=null&&a.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let u=o.get(l.id);if(a.checkEquality&&l===(u==null?void 0:u.internals.userNode))t.set(l.id,u);else{const d=ad(l,a.nodeOrigin),f=yc(l.extent)?l.extent:a.nodeExtent,p=Qi(d,f,So(l));u={...a.defaults,...l,measured:{width:(s=l.measured)==null?void 0:s.width,height:(c=l.measured)==null?void 0:c.height},internals:{positionAbsolute:p,handleBounds:l.measured?u==null?void 0:u.internals.handleBounds:void 0,z:k5(l,i),userNode:l}},t.set(l.id,u)}l.parentId&&t_(u,t,n,r)}}function Cse(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function t_(e,t,n,r){const{elevateNodesOnSelect:a,nodeOrigin:o,nodeExtent:i}=Y1(J1,r),s=e.parentId,c=t.get(s);if(!c){console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Cse(e,n);const l=a?1e3:0,{x:u,y:d,z:f}=Nse(e,c,o,i,l),{positionAbsolute:p}=e.internals,y=u!==p.x||d!==p.y;(y||f!==e.internals.z)&&(e.internals={...e.internals,positionAbsolute:y?{x:u,y:d}:p,z:f})}function k5(e,t){return(Jr(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Nse(e,t,n,r,a){const{x:o,y:i}=t.internals.positionAbsolute,s=So(e),c=ad(e,n),l=yc(e.extent)?Qi(c,e.extent,s):c;let u=Qi({x:o+l.x,y:i+l.y},r,s);e.extent==="parent"&&(u=l5(u,s,t));const d=k5(e,a),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>d?f:d}}function n_(e,t,n,r=[0,0]){var i;const a=[],o=new Map;for(const s of e){const c=t.get(s.parentId);if(!c)continue;const l=((i=o.get(s.parentId))==null?void 0:i.expandedRect)??mc(c),u=f5(l,s.rect);o.set(s.parentId,{expandedRect:u,parent:c})}return o.size>0&&o.forEach(({expandedRect:s,parent:c},l)=>{var _;const u=c.internals.positionAbsolute,d=So(c),f=c.origin??r,p=s.x<u.x?Math.round(Math.abs(u.x-s.x)):0,y=s.y<u.y?Math.round(Math.abs(u.y-s.y)):0,m=Math.max(d.width,Math.round(s.width)),v=Math.max(d.height,Math.round(s.height)),b=(m-d.width)*f[0],w=(v-d.height)*f[1];(p>0||y>0||b||w)&&(a.push({id:l,type:"position",position:{x:c.position.x-p+b,y:c.position.y-y+w}}),(_=n.get(l))==null||_.forEach(x=>{e.some(j=>j.id===x.id)||a.push({id:x.id,type:"position",position:{x:x.position.x+p,y:x.position.y+y}})})),(d.width<s.width||d.height<s.height||p||y)&&a.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:m+(p?f[0]*p-b:0),height:v+(y?f[1]*y-w:0)}})}),a}function Mse(e,t,n,r,a,o){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let s=!1;if(!i)return{changes:[],updatedInternals:s};const c=[],l=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const f of e.values()){const p=t.get(f.id);if(p)if(p.hidden)p.internals={...p.internals,handleBounds:void 0},s=!0;else{const y=Wh(f.nodeElement),m=p.measured.width!==y.width||p.measured.height!==y.height;if(y.width&&y.height&&(m||!p.internals.handleBounds||f.force)){const v=f.nodeElement.getBoundingClientRect(),b=yc(p.extent)?p.extent:o;let{positionAbsolute:w}=p.internals;p.parentId&&p.extent==="parent"?w=l5(w,y,t.get(p.parentId)):b&&(w=Qi(w,b,y)),p.measured=y,p.internals={...p.internals,positionAbsolute:w,handleBounds:{source:b5("source",f.nodeElement,v,u,p.id),target:b5("target",f.nodeElement,v,u,p.id)}},p.parentId&&t_(p,t,n,{nodeOrigin:a}),s=!0,m&&(c.push({id:p.id,type:"dimensions",dimensions:y}),p.expandParent&&p.parentId&&d.push({id:p.id,parentId:p.parentId,rect:mc(p,a)}))}}}if(d.length>0){const f=n_(d,t,n,a);c.push(...f)}return{changes:c,updatedInternals:s}}async function Pse({delta:e,panZoom:t,transform:n,translateExtent:r,width:a,height:o}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[a,o]],r),s=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(s)}function A5(e,t,n){e.clear(),t.clear();for(const r of n){const{source:a,target:o,sourceHandle:i=null,targetHandle:s=null}=r,c=`${a}-source-${i}`,l=`${o}-target-${s}`,u=e.get(c)||new Map,d=e.get(l)||new Map,f={edgeId:r.id,source:a,target:o,sourceHandle:i,targetHandle:s};t.set(r.id,r),e.set(c,u.set(`${o}-${s}`,f)),e.set(l,d.set(`${a}-${i}`,f))}}function T5(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:T5(n,t):!1}function R5(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n)return!1;r=r.parentElement}while(r);return!1}function kse(e,t,n,r){const a=new Map;for(const[o,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!T5(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const s=e.get(o);s&&a.set(o,{id:o,position:s.position||{x:0,y:0},distance:{x:n.x-s.internals.positionAbsolute.x,y:n.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return a}function r_({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,s,c;const a=[];for(const[l,u]of t){const d=(i=n.get(l))==null?void 0:i.internals.userNode;d&&a.push({...d,position:u.position,dragging:r})}if(!e)return[a[0],a];const o=(s=n.get(e))==null?void 0:s.internals.userNode;return[o?{...o,position:((c=t.get(e))==null?void 0:c.position)||o.position,dragging:r}:a[0],a]}function Ase({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:a}){let o={x:null,y:null},i=0,s=new Map,c=!1,l={x:0,y:0},u=null,d=!1,f=null,p=!1;function y({noDragClassName:v,handleSelector:b,domNode:w,isSelectable:_,nodeId:x,nodeClickDistance:j=0}){f=hr(w);function S({x:N,y:P},R){const{nodeLookup:k,nodeExtent:C,snapGrid:T,snapToGrid:A,nodeOrigin:I,onNodeDrag:L,onSelectionDrag:D,onError:B,updateNodePositions:F}=t();o={x:N,y:P};let $=!1,V={x:0,y:0,x2:0,y2:0};if(s.size>1&&C){const G=od(s);V=Z1(G)}for(const[G,X]of s){if(!k.has(G))continue;let H={x:N-X.distance.x,y:P-X.distance.y};A&&(H=qh(H,T));let J=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(s.size>1&&C&&!X.extent){const{positionAbsolute:Q}=X.internals,ne=Q.x-V.x+C[0][0],z=Q.x+X.measured.width-V.x2+C[1][0],se=Q.y-V.y+C[0][1],re=Q.y+X.measured.height-V.y2+C[1][1];J=[[ne,se],[z,re]]}const{position:Z,positionAbsolute:U}=c5({nodeId:G,nextPosition:H,nodeLookup:k,nodeExtent:J,nodeOrigin:I,onError:B});$=$||X.position.x!==Z.x||X.position.y!==Z.y,X.position=Z,X.internals.positionAbsolute=U}if($&&(F(s,!0),R&&(r||L||!x&&D))){const[G,X]=r_({nodeId:x,dragItems:s,nodeLookup:k});r==null||r(R,s,G,X),L==null||L(R,G,X),x||(D==null||D(R,X))}}async function E(){if(!u)return;const{transform:N,panBy:P,autoPanSpeed:R}=t(),[k,C]=d5(l,u,R);(k!==0||C!==0)&&(o.x=(o.x??0)-k/N[2],o.y=(o.y??0)-C/N[2],await P({x:k,y:C})&&S(o,null)),i=requestAnimationFrame(E)}function O(N){var $;const{nodeLookup:P,multiSelectionActive:R,nodesDraggable:k,transform:C,snapGrid:T,snapToGrid:A,selectNodesOnDrag:I,onNodeDragStart:L,onSelectionDragStart:D,unselectNodesAndEdges:B}=t();d=!0,(!I||!_)&&!R&&x&&(($=P.get(x))!=null&&$.selected||B()),_&&I&&x&&(e==null||e(x));const F=cd(N.sourceEvent,{transform:C,snapGrid:T,snapToGrid:A,containerBounds:u});if(o=F,s=kse(P,k,F,x),s.size>0&&(n||L||!x&&D)){const[V,G]=r_({nodeId:x,dragItems:s,nodeLookup:P});n==null||n(N.sourceEvent,s,V,G),L==null||L(N.sourceEvent,V,G),x||(D==null||D(N.sourceEvent,G))}}const M=j3().clickDistance(j).on("start",N=>{const{domNode:P,nodeDragThreshold:R,transform:k,snapGrid:C,snapToGrid:T}=t();u=(P==null?void 0:P.getBoundingClientRect())||null,p=!1,R===0&&O(N),o=cd(N.sourceEvent,{transform:k,snapGrid:C,snapToGrid:T,containerBounds:u}),l=Eo(N.sourceEvent,u)}).on("drag",N=>{const{autoPanOnNodeDrag:P,transform:R,snapGrid:k,snapToGrid:C,nodeDragThreshold:T,nodeLookup:A}=t(),I=cd(N.sourceEvent,{transform:R,snapGrid:k,snapToGrid:C,containerBounds:u});if((N.sourceEvent.type==="touchmove"&&N.sourceEvent.touches.length>1||x&&!A.has(x))&&(p=!0),!p){if(!c&&P&&d&&(c=!0,E()),!d){const L=I.xSnapped-(o.x??0),D=I.ySnapped-(o.y??0);Math.sqrt(L*L+D*D)>T&&O(N)}(o.x!==I.xSnapped||o.y!==I.ySnapped)&&s&&d&&(l=Eo(N.sourceEvent,u),S(I,N.sourceEvent))}}).on("end",N=>{if(!(!d||p)&&(c=!1,d=!1,cancelAnimationFrame(i),s.size>0)){const{nodeLookup:P,updateNodePositions:R,onNodeDragStop:k,onSelectionDragStop:C}=t();if(R(s,!1),a||k||!x&&C){const[T,A]=r_({nodeId:x,dragItems:s,nodeLookup:P,dragging:!1});a==null||a(N.sourceEvent,s,T,A),k==null||k(N.sourceEvent,T,A),x||(C==null||C(N.sourceEvent,A))}}}).filter(N=>{const P=N.target;return!N.button&&(!v||!R5(P,`.${v}`,w))&&(!b||R5(P,b,w))});f.call(M)}function m(){f==null||f.on(".drag",null)}return{update:y,destroy:m}}function Tse(e,t,n){const r=[],a={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const o of t.values())id(a,mc(o))>0&&r.push(o);return r}const Rse=250;function Ise(e,t,n,r){var s,c;let a=[],o=1/0;const i=Tse(e,n,t+Rse);for(const l of i){const u=[...((s=l.internals.handleBounds)==null?void 0:s.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:f,y:p}=ld(l,d,d.position,!0),y=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(p-e.y,2));y>t||(y<o?(a=[{...d,x:f,y:p}],o=y):y===o&&a.push({...d,x:f,y:p}))}}if(!a.length)return null;if(a.length>1){const l=r.type==="source"?"target":"source";return a.find(u=>u.type===l)??a[0]}return a[0]}function I5(e,t,n,r,a,o=!1){var l,u,d;const i=r.get(e);if(!i)return null;const s=a==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((d=i.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?s==null?void 0:s.find(f=>f.id===n):s==null?void 0:s[0])??null;return c&&o?{...c,...ld(i,c,c.position,!0)}:c}function D5(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Dse(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const L5=()=>!0;function Lse(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:a,edgeUpdaterType:o,isTarget:i,domNode:s,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:f,cancelConnection:p,onConnectStart:y,onConnect:m,onConnectEnd:v,isValidConnection:b=L5,onReconnectEnd:w,updateConnection:_,getTransform:x,getFromHandle:j,autoPanSpeed:S}){const E=g5(e.target);let O=0,M;const{x:N,y:P}=Eo(e),R=E==null?void 0:E.elementFromPoint(N,P),k=D5(o,R),C=s==null?void 0:s.getBoundingClientRect();if(!C||!k)return;const T=I5(a,k,r,c,t);if(!T)return;let A=Eo(e,C),I=!1,L=null,D=!1,B=null;function F(){if(!u||!C)return;const[Z,U]=d5(A,C,S);f({x:Z,y:U}),O=requestAnimationFrame(F)}const $={...T,nodeId:a,type:k,position:T.position},V=c.get(a),G={inProgress:!0,isValid:null,from:ld(V,$,he.Left,!0),fromHandle:$,fromPosition:$.position,fromNode:V,to:A,toHandle:null,toPosition:r5[$.position],toNode:null};_(G);let X=G;y==null||y(e,{nodeId:a,handleId:r,handleType:k});function H(Z){if(!j()||!$){J(Z);return}const U=x();A=Eo(Z,C),M=Ise(sd(A,U,!1,[1,1]),n,c,$),I||(F(),I=!0);const Q=$5(Z,{handle:M,connectionMode:t,fromNodeId:a,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:E,lib:l,flowId:d,nodeLookup:c});B=Q.handleDomNode,L=Q.connection,D=Dse(!!M,Q.isValid);const ne={...X,isValid:D,to:M&&D?h5({x:M.x,y:M.y},U):A,toHandle:Q.toHandle,toPosition:D&&Q.toHandle?Q.toHandle.position:r5[$.position],toNode:Q.toHandle?c.get(Q.toHandle.nodeId):null};D&&M&&X.toHandle&&ne.toHandle&&X.toHandle.type===ne.toHandle.type&&X.toHandle.nodeId===ne.toHandle.nodeId&&X.toHandle.id===ne.toHandle.id&&X.to.x===ne.to.x&&X.to.y===ne.to.y||(_(ne),X=ne)}function J(Z){(M||B)&&L&&D&&(m==null||m(L));const{inProgress:U,...Q}=X,ne={...Q,toPosition:X.toHandle?X.toPosition:null};v==null||v(Z,ne),o&&(w==null||w(Z,ne)),p(),cancelAnimationFrame(O),I=!1,D=!1,L=null,B=null,E.removeEventListener("mousemove",H),E.removeEventListener("mouseup",J),E.removeEventListener("touchmove",H),E.removeEventListener("touchend",J)}E.addEventListener("mousemove",H),E.addEventListener("mouseup",J),E.addEventListener("touchmove",H),E.addEventListener("touchend",J)}function $5(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:a,fromType:o,doc:i,lib:s,flowId:c,isValidConnection:l=L5,nodeLookup:u}){const d=o==="target",f=t?i.querySelector(`.${s}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:p,y}=Eo(e),m=i.elementFromPoint(p,y),v=m!=null&&m.classList.contains(`${s}-flow__handle`)?m:f,b={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=D5(void 0,v),_=v.getAttribute("data-nodeid"),x=v.getAttribute("data-handleid"),j=v.classList.contains("connectable"),S=v.classList.contains("connectableend");if(!_||!w)return b;const E={source:d?_:r,sourceHandle:d?x:a,target:d?r:_,targetHandle:d?a:x};b.connection=E;const O=j&&S&&(n===pc.Strict?d&&w==="source"||!d&&w==="target":_!==r||x!==a);b.isValid=O&&l(E),b.toHandle=I5(_,w,x,u,n,!1)}return b}const a_={onPointerDown:Lse,isValid:$5};function $se({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const a=hr(e);function o({translateExtent:s,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:f=!0,inversePan:p=!1}){const y=_=>{const x=n();if(_.sourceEvent.type!=="wheel"||!t)return;const j=-_.sourceEvent.deltaY*(_.sourceEvent.deltaMode===1?.05:_.sourceEvent.deltaMode?1:.002)*u,S=x[2]*Math.pow(2,j);t.scaleTo(S)};let m=[0,0];const v=_=>{(_.sourceEvent.type==="mousedown"||_.sourceEvent.type==="touchstart")&&(m=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY])},b=_=>{const x=n();if(_.sourceEvent.type!=="mousemove"&&_.sourceEvent.type!=="touchmove"||!t)return;const j=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY],S=[j[0]-m[0],j[1]-m[1]];m=j;const E=r()*Math.max(x[2],Math.log(x[2]))*(p?-1:1),O={x:x[0]-S[0]*E,y:x[1]-S[1]*E},M=[[0,0],[c,l]];t.setViewportConstrained({x:O.x,y:O.y,zoom:x[2]},M,s)},w=e5().on("start",v).on("zoom",d?b:null).on("zoom.wheel",f?y:null);a.call(w,{})}function i(){a.on("zoom",null)}return{update:o,destroy:i,pointer:Kr}}const Fse=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Zh=e=>({x:e.x,y:e.y,zoom:e.k}),o_=({x:e,y:t,zoom:n})=>$h.translate(e,t).scale(n),gc=(e,t)=>e.target.closest(`.${t}`),F5=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),i_=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},B5=e=>{const t=e.ctrlKey&&Uh()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Bse({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:o,zoomOnPinch:i,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(gc(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&i){const v=Kr(u),b=B5(u),w=d*Math.pow(2,b);r.scaleTo(n,w,v,u);return}const f=u.deltaMode===1?20:1;let p=a===ci.Vertical?0:u.deltaX*f,y=a===ci.Horizontal?0:u.deltaY*f;!Uh()&&u.shiftKey&&a!==ci.Vertical&&(p=u.deltaY*f,y=0),r.translateBy(n,-(p/d)*o,-(y/d)*o,{internal:!0});const m=Zh(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s==null||s(u,m)),e.isPanScrolling&&(c==null||c(u,m),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,m),e.isPanScrolling=!1},150))}}function zse({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,a){if(!t&&r.type==="wheel"&&!r.ctrlKey||gc(r,e))return null;r.preventDefault(),n.call(this,r,a)}}function Vse({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var o,i,s;if((o=r.sourceEvent)!=null&&o.internal)return;const a=Zh(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=a,((s=r.sourceEvent)==null?void 0:s.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,a))}}function qse({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:a}){return o=>{var i,s;e.usedRightMouseButton=!!(n&&F5(t,e.mouseButton??0)),(i=o.sourceEvent)!=null&&i.sync||r([o.transform.x,o.transform.y,o.transform.k]),a&&!((s=o.sourceEvent)!=null&&s.internal)&&(a==null||a(o.sourceEvent,Zh(o.transform)))}}function Use({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:a,onPaneContextMenu:o}){return i=>{var s;if(!((s=i.sourceEvent)!=null&&s.internal)&&(e.isZoomingOrPanning=!1,o&&F5(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&o(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),a&&Fse(e.prevViewport,i.transform))){const c=Zh(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a==null||a(i.sourceEvent,c)},n?150:0)}}}function Wse({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:a,zoomOnDoubleClick:o,userSelectionActive:i,noWheelClassName:s,noPanClassName:c,lib:l}){return u=>{var y;const d=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(gc(u,`${l}-flow__node`)||gc(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!a&&!o&&!n||i||gc(u,s)&&u.type==="wheel"||gc(u,c)&&(u.type!=="wheel"||a&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((y=u.touches)==null?void 0:y.length)>1)return u.preventDefault(),!1;if(!d&&!a&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const p=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&p}}function Hse({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:a,viewport:o,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=e5().clickDistance(!Jr(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(a),p=hr(e).call(f);_({x:o.x,y:o.y,zoom:hc(o.zoom,t,n)},[[0,0],[d.width,d.height]],a);const y=p.on("wheel.zoom"),m=p.on("dblclick.zoom");f.wheelDelta(B5);function v(R,k){return p?new Promise(C=>{f==null||f.transform(i_(p,k==null?void 0:k.duration,()=>C(!0)),R)}):Promise.resolve(!1)}function b({noWheelClassName:R,noPanClassName:k,onPaneContextMenu:C,userSelectionActive:T,panOnScroll:A,panOnDrag:I,panOnScrollMode:L,panOnScrollSpeed:D,preventScrolling:B,zoomOnPinch:F,zoomOnScroll:$,zoomOnDoubleClick:V,zoomActivationKeyPressed:G,lib:X,onTransformChange:H}){T&&!u.isZoomingOrPanning&&w();const J=A&&!G&&!T?Bse({zoomPanValues:u,noWheelClassName:R,d3Selection:p,d3Zoom:f,panOnScrollMode:L,panOnScrollSpeed:D,zoomOnPinch:F,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:c}):zse({noWheelClassName:R,preventScrolling:B,d3ZoomHandler:y});if(p.on("wheel.zoom",J,{passive:!1}),!T){const U=Vse({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:s});f.on("start",U);const Q=qse({zoomPanValues:u,panOnDrag:I,onPaneContextMenu:!!C,onPanZoom:i,onTransformChange:H});f.on("zoom",Q);const ne=Use({zoomPanValues:u,panOnDrag:I,panOnScroll:A,onPaneContextMenu:C,onPanZoomEnd:c,onDraggingChange:l});f.on("end",ne)}const Z=Wse({zoomActivationKeyPressed:G,panOnDrag:I,zoomOnScroll:$,panOnScroll:A,zoomOnDoubleClick:V,zoomOnPinch:F,userSelectionActive:T,noPanClassName:k,noWheelClassName:R,lib:X});f.filter(Z),V?p.on("dblclick.zoom",m):p.on("dblclick.zoom",null)}function w(){f.on("zoom",null)}async function _(R,k,C){const T=o_(R),A=f==null?void 0:f.constrain()(T,k,C);return A&&await v(A),new Promise(I=>I(A))}async function x(R,k){const C=o_(R);return await v(C,k),new Promise(T=>T(C))}function j(R){if(p){const k=o_(R),C=p.property("__zoom");(C.k!==R.zoom||C.x!==R.x||C.y!==R.y)&&(f==null||f.transform(p,k,null,{sync:!0}))}}function S(){const R=p?J3(p.node()):{x:0,y:0,k:1};return{x:R.x,y:R.y,zoom:R.k}}function E(R,k){return p?new Promise(C=>{f==null||f.scaleTo(i_(p,k==null?void 0:k.duration,()=>C(!0)),R)}):Promise.resolve(!1)}function O(R,k){return p?new Promise(C=>{f==null||f.scaleBy(i_(p,k==null?void 0:k.duration,()=>C(!0)),R)}):Promise.resolve(!1)}function M(R){f==null||f.scaleExtent(R)}function N(R){f==null||f.translateExtent(R)}function P(R){const k=!Jr(R)||R<0?0:R;f==null||f.clickDistance(k)}return{update:b,destroy:w,setViewport:x,setViewportConstrained:_,getViewport:S,scaleTo:E,scaleBy:O,setScaleExtent:M,setTranslateExtent:N,syncViewport:j,setClickDistance:P}}var vc;(function(e){e.Line="line",e.Handle="handle"})(vc||(vc={}));const Zse=["top-left","top-right","bottom-left","bottom-right"],Kse=["top","right","bottom","left"];function Xse({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:a,affectsY:o}){const i=e-t,s=n-r,c=[i>0?1:i<0?-1:0,s>0?1:s<0?-1:0];return i&&a&&(c[0]=c[0]*-1),s&&o&&(c[1]=c[1]*-1),c}function Gse(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:a}}function ui(e,t){return Math.max(0,t-e)}function di(e,t){return Math.max(0,e-t)}function Kh(e,t,n){return Math.max(0,t-e,e-n)}function z5(e,t){return e?!t:t}function Qse(e,t,n,r,a,o,i,s){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,f=u&&d,{xSnapped:p,ySnapped:y}=n,{minWidth:m,maxWidth:v,minHeight:b,maxHeight:w}=r,{x:_,y:x,width:j,height:S,aspectRatio:E}=e;let O=Math.floor(u?p-e.pointerX:0),M=Math.floor(d?y-e.pointerY:0);const N=j+(c?-O:O),P=S+(l?-M:M),R=-o[0]*j,k=-o[1]*S;let C=Kh(N,m,v),T=Kh(P,b,w);if(i){let L=0,D=0;c&&O<0?L=ui(_+O+R,i[0][0]):!c&&O>0&&(L=di(_+N+R,i[1][0])),l&&M<0?D=ui(x+M+k,i[0][1]):!l&&M>0&&(D=di(x+P+k,i[1][1])),C=Math.max(C,L),T=Math.max(T,D)}if(s){let L=0,D=0;c&&O>0?L=di(_+O,s[0][0]):!c&&O<0&&(L=ui(_+N,s[1][0])),l&&M>0?D=di(x+M,s[0][1]):!l&&M<0&&(D=ui(x+P,s[1][1])),C=Math.max(C,L),T=Math.max(T,D)}if(a){if(u){const L=Kh(N/E,b,w)*E;if(C=Math.max(C,L),i){let D=0;!c&&!l||c&&!l&&f?D=di(x+k+N/E,i[1][1])*E:D=ui(x+k+(c?O:-O)/E,i[0][1])*E,C=Math.max(C,D)}if(s){let D=0;!c&&!l||c&&!l&&f?D=ui(x+N/E,s[1][1])*E:D=di(x+(c?O:-O)/E,s[0][1])*E,C=Math.max(C,D)}}if(d){const L=Kh(P*E,m,v)/E;if(T=Math.max(T,L),i){let D=0;!c&&!l||l&&!c&&f?D=di(_+P*E+R,i[1][0])/E:D=ui(_+(l?M:-M)*E+R,i[0][0])/E,T=Math.max(T,D)}if(s){let D=0;!c&&!l||l&&!c&&f?D=ui(_+P*E,s[1][0])/E:D=di(_+(l?M:-M)*E,s[0][0])/E,T=Math.max(T,D)}}}M=M+(M<0?T:-T),O=O+(O<0?C:-C),a&&(f?N>P*E?M=(z5(c,l)?-O:O)/E:O=(z5(c,l)?-M:M)*E:u?(M=O/E,l=c):(O=M*E,c=l));const A=c?_+O:_,I=l?x+M:x;return{width:j+(c?-O:O),height:S+(l?-M:M),x:o[0]*O*(c?-1:1)+A,y:o[1]*M*(l?-1:1)+I}}const V5={width:0,height:0,x:0,y:0},Jse={...V5,pointerX:0,pointerY:0,aspectRatio:1};function Yse(e){return[[0,0],[e.measured.width,e.measured.height]]}function ece(e,t,n){const r=t.position.x+e.position.x,a=t.position.y+e.position.y,o=e.measured.width??0,i=e.measured.height??0,s=n[0]*o,c=n[1]*i;return[[r-s,a-c],[r+o-s,a+i-c]]}function tce({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:a}){const o=hr(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:u,onResizeStart:d,onResize:f,onResizeEnd:p,shouldResize:y}){let m={...V5},v={...Jse};const b=Gse(c);let w,_=null,x=[],j,S,E;const O=j3().on("start",M=>{const{nodeLookup:N,transform:P,snapGrid:R,snapToGrid:k,nodeOrigin:C,paneDomNode:T}=n();if(w=N.get(t),!w)return;_=(T==null?void 0:T.getBoundingClientRect())??null;const{xSnapped:A,ySnapped:I}=cd(M.sourceEvent,{transform:P,snapGrid:R,snapToGrid:k,containerBounds:_});m={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},v={...m,pointerX:A,pointerY:I,aspectRatio:m.width/m.height},j=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(j=N.get(w.parentId),S=j&&w.extent==="parent"?Yse(j):void 0),x=[],E=void 0;for(const[L,D]of N)if(D.parentId===t&&(x.push({id:L,position:{...D.position},extent:D.extent}),D.extent==="parent"||D.expandParent)){const B=ece(D,w,D.origin??C);E?E=[[Math.min(B[0][0],E[0][0]),Math.min(B[0][1],E[0][1])],[Math.max(B[1][0],E[1][0]),Math.max(B[1][1],E[1][1])]]:E=B}d==null||d(M,{...m})}).on("drag",M=>{const{transform:N,snapGrid:P,snapToGrid:R,nodeOrigin:k}=n(),C=cd(M.sourceEvent,{transform:N,snapGrid:P,snapToGrid:R,containerBounds:_}),T=[];if(!w)return;const{x:A,y:I,width:L,height:D}=m,B={},F=w.origin??k,{width:$,height:V,x:G,y:X}=Qse(v,b,C,l,u,F,S,E),H=$!==L,J=V!==D,Z=G!==A&&H,U=X!==I&&J;if(!Z&&!U&&!H&&!J)return;if((Z||U||F[0]===1||F[1]===1)&&(B.x=Z?G:m.x,B.y=U?X:m.y,m.x=B.x,m.y=B.y,x.length>0)){const z=G-A,se=X-I;for(const re of x)re.position={x:re.position.x-z+F[0]*($-L),y:re.position.y-se+F[1]*(V-D)},T.push(re)}if((H||J)&&(B.width=H?$:m.width,B.height=J?V:m.height,m.width=B.width,m.height=B.height),j&&w.expandParent){const z=F[0]*(B.width??0);B.x&&B.x<z&&(m.x=z,v.x=v.x-(B.x-z));const se=F[1]*(B.height??0);B.y&&B.y<se&&(m.y=se,v.y=v.y-(B.y-se))}const Q=Xse({width:m.width,prevWidth:L,height:m.height,prevHeight:D,affectsX:b.affectsX,affectsY:b.affectsY}),ne={...m,direction:Q};(y==null?void 0:y(M,ne))!==!1&&(f==null||f(M,ne),r(B,T))}).on("end",M=>{p==null||p(M,{...m}),a==null||a()});o.call(O)}function s(){o.on(".drag",null)}return{update:i,destroy:s}}var q5={exports:{}},s_={},U5;function nce(){if(U5)return s_;U5=1;var e=PK(),t=oR();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:n,a=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return s_.useSyncExternalStoreWithSelector=function(l,u,d,f,p){var y=o(null);if(y.current===null){var m={hasValue:!1,value:null};y.current=m}else m=y.current;y=s(function(){function b(S){if(!w){if(w=!0,_=S,S=f(S),p!==void 0&&m.hasValue){var E=m.value;if(p(E,S))return x=E}return x=S}if(E=x,r(_,S))return E;var O=f(S);return p!==void 0&&p(E,O)?E:(_=S,x=O)}var w=!1,_,x,j=d===void 0?null:d;return[function(){return b(u())},j===null?void 0:function(){return b(j())}]},[u,d,f,p]);var v=a(l,y[0],y[1]);return i(function(){m.hasValue=!0,m.value=v},[v]),c(v),v},s_}var W5;function rce(){return W5||(W5=1,q5.exports=nce()),q5.exports}var ace=rce();let H5,c_,Z5,K5,X5,G5;jM=ot(ace),H5={BASE_URL:"/NoLLMChat/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_URL:"/NoLLMChat/",VITE_ROUTE_MODE:"hash"},c_=e=>{let t;const n=new Set,r=(s,c)=>{const l=typeof s=="function"?s(t):s;if(!Object.is(l,t)){const u=t;t=c??(typeof l!="object"||l===null)?l:Object.assign({},t,l),n.forEach(d=>d(t,u))}},a=()=>t,o={setState:r,getState:a,getInitialState:()=>i,subscribe:s=>(n.add(s),()=>n.delete(s)),destroy:()=>{(H5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},i=t=e(r,a,o);return o},Z5=e=>e?c_(e):c_,{useDebugValue:K5}=W,{useSyncExternalStoreWithSelector:X5}=jM,G5=e=>e;function Q5(e,t=G5,n){const r=X5(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return K5(r),r}const J5=(e,t)=>{const n=Z5(e),r=(a,o=t)=>Q5(n,a,o);return Object.assign(r,n),r},oce=(e,t)=>e?J5(e,t):J5;function Bt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const Xh=g.createContext(null),ice=Xh.Provider,Y5=jo.error001();function Qe(e,t){const n=g.useContext(Xh);if(n===null)throw new Error(Y5);return Q5(n,e,t)}function It(){const e=g.useContext(Xh);if(e===null)throw new Error(Y5);return g.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const e4={display:"none"},sce={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},t4="react-flow__node-desc",n4="react-flow__edge-desc",cce="react-flow__aria-live",lce=e=>e.ariaLiveMessage;function uce({rfId:e}){const t=Qe(lce);return h.jsx("div",{id:`${cce}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:sce,children:t})}function dce({rfId:e,disableKeyboardA11y:t}){return h.jsxs(h.Fragment,{children:[h.jsxs("div",{id:`${t4}-${e}`,style:e4,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),h.jsx("div",{id:`${n4}-${e}`,style:e4,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&h.jsx(uce,{rfId:e})]})}const fce=e=>e.userSelectionActive?"none":"all";function bc({position:e="top-left",children:t,className:n,style:r,...a}){const o=Qe(fce),i=`${e}`.split("-");return h.jsx("div",{className:en(["react-flow__panel",n,...i]),style:{...r,pointerEvents:o},...a,children:t})}function pce({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:h.jsx(bc,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:h.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const hce=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Gh=e=>e.id;function mce(e,t){return Bt(e.selectedNodes.map(Gh),t.selectedNodes.map(Gh))&&Bt(e.selectedEdges.map(Gh),t.selectedEdges.map(Gh))}function yce({onSelectionChange:e}){const t=It(),{selectedNodes:n,selectedEdges:r}=Qe(hce,mce);return g.useEffect(()=>{const a={nodes:n,edges:r};e==null||e(a),t.getState().onSelectionChangeHandlers.forEach(o=>o(a))},[n,r,e]),null}const gce=e=>!!e.onSelectionChangeHandlers;function vce({onSelectionChange:e}){const t=Qe(gce);return e||t?h.jsx(yce,{onSelectionChange:e}):null}const r4=[0,0],bce={x:0,y:0,zoom:1},wce=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],a4=[...wce,"rfId"],xce=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),o4={translateExtent:nd,nodeOrigin:r4,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function _ce(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:a,setTranslateExtent:o,setNodeExtent:i,reset:s,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=Qe(xce,Bt),u=It();g.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=o4,s()}),[]);const d=g.useRef(o4);return g.useEffect(()=>{for(const f of a4){const p=e[f],y=d.current[f];p!==y&&(typeof e[f]>"u"||(f==="nodes"?t(p):f==="edges"?n(p):f==="minZoom"?r(p):f==="maxZoom"?a(p):f==="translateExtent"?o(p):f==="nodeExtent"?i(p):f==="paneClickDistance"?l(p):f==="fitView"?u.setState({fitViewOnInit:p}):f==="fitViewOptions"?u.setState({fitViewOnInitOptions:p}):u.setState({[f]:p})))}d.current=e},a4.map(f=>e[f])),null}function i4(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function jce(e){var r;const[t,n]=g.useState(e==="system"?null:e);return g.useEffect(()=>{if(e!=="system"){n(e);return}const a=i4(),o=()=>n(a!=null&&a.matches?"dark":"light");return o(),a==null||a.addEventListener("change",o),()=>{a==null||a.removeEventListener("change",o)}},[e]),t!==null?t:(r=i4())!=null&&r.matches?"dark":"light"}const s4=typeof document<"u"?document:null;function ud(e=null,t={target:s4,actInsideInputWithModifier:!0}){const[n,r]=g.useState(!1),a=g.useRef(!1),o=g.useRef(new Set([])),[i,s]=g.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),l=c.reduce((u,d)=>u.concat(...d),[]);return[c,l]}return[[],[]]},[e]);return g.useEffect(()=>{const c=(t==null?void 0:t.target)||s4;if(e!==null){const l=f=>{if(a.current=f.ctrlKey||f.metaKey||f.shiftKey,(!a.current||a.current&&!t.actInsideInputWithModifier)&&X1(f))return!1;const p=l4(f.code,s);o.current.add(f[p]),c4(i,o.current,!1)&&(f.preventDefault(),r(!0))},u=f=>{if((!a.current||a.current&&!t.actInsideInputWithModifier)&&X1(f))return!1;const p=l4(f.code,s);c4(i,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(f[p]),f.key==="Meta"&&o.current.clear(),a.current=!1},d=()=>{o.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function c4(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(a=>t.has(a)))}function l4(e,t){return t.includes(e)?"code":"key"}const Sce=()=>{const e=It();return g.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,a,o],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??a,zoom:t.zoom??o},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:a,panZoom:o,domNode:i}=e.getState();if(!o||!i)return Promise.resolve(!1);const s=W1(n,t),{width:c,height:l}=Wh(i);return H1({nodes:s,width:c,height:l,minZoom:r,maxZoom:a,panZoom:o},t)},setCenter:async(t,n,r)=>{const{width:a,height:o,maxZoom:i,panZoom:s}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,l=a/2-t*c,u=o/2-n*c;return s?(await s.setViewport({x:l,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:a,minZoom:o,maxZoom:i,panZoom:s}=e.getState(),c=K1(t,r,a,o,i,(n==null?void 0:n.padding)??.1);return s?(await s.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:r,snapGrid:a,domNode:o}=e.getState();if(!o)return t;const{x:i,y:s}=o.getBoundingClientRect(),c={x:t.x-i,y:t.y-s};return sd(c,r,n.snapToGrid,a)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:a,y:o}=r.getBoundingClientRect(),i=h5(t,n);return{x:i.x+a,y:i.y+o}}}),[])};function u4(e,t){const n=[],r=new Map,a=[];for(const o of e)if(o.type==="add"){a.push(o);continue}else if(o.type==="remove"||o.type==="replace")r.set(o.id,[o]);else{const i=r.get(o.id);i?i.push(o):r.set(o.id,[o])}for(const o of t){const i=r.get(o.id);if(!i){n.push(o);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const s={...o};for(const c of i)Ece(c,s);n.push(s)}return a.length&&a.forEach(o=>{o.index!==void 0?n.splice(o.index,0,{...o.item}):n.push({...o.item})}),n}function Ece(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Ji(e,t){return u4(e,t)}function dd(e,t){return u4(e,t)}function Yi(e,t){return{id:e,type:"select",selected:t}}function wc(e,t=new Set,n=!1){const r=[];for(const[a,o]of e){const i=t.has(a);!(o.selected===void 0&&!i)&&o.selected!==i&&(n&&(o.selected=i),r.push(Yi(o.id,i)))}return r}function d4({items:e=[],lookup:t}){var a;const n=[],r=new Map(e.map(o=>[o.id,o]));for(const[o,i]of e.entries()){const s=t.get(i.id),c=((a=s==null?void 0:s.internals)==null?void 0:a.userNode)??s;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:o})}for(const[o]of t)r.get(o)===void 0&&n.push({id:o,type:"remove"});return n}function f4(e){return{id:e.id,type:"remove"}}const p4=e=>use(e),Oce=e=>i5(e);function h4(e){return g.forwardRef(e)}const Cce=typeof window<"u"?g.useLayoutEffect:g.useEffect;function m4(e){const[t,n]=g.useState(BigInt(0)),[r]=g.useState(()=>Nce(()=>n(a=>a+BigInt(1))));return Cce(()=>{const a=r.get();a.length&&(e(a),r.reset())},[t]),r}function Nce(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const y4=g.createContext(null);function Mce({children:e}){const t=It(),n=g.useCallback(s=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:f}=t.getState();let p=c;for(const y of s)p=typeof y=="function"?y(p):y;u?l(p):d&&d(d4({items:p,lookup:f}))},[]),r=m4(n),a=g.useCallback(s=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:f}=t.getState();let p=c;for(const y of s)p=typeof y=="function"?y(p):y;u?l(p):d&&d(d4({items:p,lookup:f}))},[]),o=m4(a),i=g.useMemo(()=>({nodeQueue:r,edgeQueue:o}),[]);return h.jsx(y4.Provider,{value:i,children:e})}function Pce(){const e=g.useContext(y4);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const kce=e=>!!e.panZoom;function mr(){const e=Sce(),t=It(),n=Pce(),r=Qe(kce),a=g.useMemo(()=>{const o=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},s=d=>{n.edgeQueue.push(d)},c=d=>{var b,w;const{nodeLookup:f,nodeOrigin:p}=t.getState(),y=p4(d)?d:f.get(d.id),m=y.parentId?y5(y.position,y.measured,y.parentId,f,p):y.position,v={id:y.id,position:m,width:((b=y.measured)==null?void 0:b.width)??y.width,height:((w=y.measured)==null?void 0:w.height)??y.height,data:y.data};return mc(v)},l=(d,f,p={replace:!1})=>{i(y=>y.map(m=>{if(m.id===d){const v=typeof f=="function"?f(m):f;return p.replace&&p4(v)?v:{...m,...v}}return m}))},u=(d,f,p={replace:!1})=>{s(y=>y.map(m=>{if(m.id===d){const v=typeof f=="function"?f(m):f;return p.replace&&Oce(v)?v:{...m,...v}}return m}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=o(d))==null?void 0:f.internals.userNode},getInternalNode:o,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:s,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(p=>[...p,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(p=>[...p,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:p}=t.getState(),[y,m,v]=p;return{nodes:d.map(b=>({...b})),edges:f.map(b=>({...b})),viewport:{x:y,y:m,zoom:v}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:p,edges:y,onNodesDelete:m,onEdgesDelete:v,triggerNodeChanges:b,triggerEdgeChanges:w,onDelete:_,onBeforeDelete:x}=t.getState(),{nodes:j,edges:S}=await pse({nodesToRemove:d,edgesToRemove:f,nodes:p,edges:y,onBeforeDelete:x}),E=S.length>0,O=j.length>0;if(E){const M=S.map(f4);v==null||v(S),w(M)}if(O){const M=j.map(f4);m==null||m(j),b(M)}return(O||E)&&(_==null||_({nodes:j,edges:S})),{deletedNodes:j,deletedEdges:S}},getIntersectingNodes:(d,f=!0,p)=>{const y=p5(d),m=y?d:c(d),v=p!==void 0;return m?(p||t.getState().nodes).filter(b=>{const w=t.getState().nodeLookup.get(b.id);if(w&&!y&&(b.id===d.id||!w.internals.positionAbsolute))return!1;const _=mc(v?b:w),x=id(_,m);return f&&x>0||x>=m.width*m.height}):[]},isNodeIntersecting:(d,f,p=!0)=>{const y=p5(d)?d:c(d);if(!y)return!1;const m=id(y,f);return p&&m>0||m>=y.width*y.height},updateNode:l,updateNodeData:(d,f,p={replace:!1})=>{l(d,y=>{const m=typeof f=="function"?f(y):f;return p.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},p)},updateEdge:u,updateEdgeData:(d,f,p={replace:!1})=>{u(d,y=>{const m=typeof f=="function"?f(y):f;return p.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},p)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:p}=t.getState();return dse(d,{nodeLookup:f,nodeOrigin:p})},getHandleConnections:({type:d,id:f,nodeId:p})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${p}-${d}-${f??null}`))==null?void 0:y.values())??[])}}},[]);return g.useMemo(()=>({...a,...e,viewportInitialized:r}),[r])}const g4=e=>e.selected,Ace={actInsideInputWithModifier:!1},Tce=typeof window<"u"?window:void 0;function Rce({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=It(),{deleteElements:r}=mr(),a=ud(e,Ace),o=ud(t,{target:Tce});g.useEffect(()=>{if(a){const{edges:i,nodes:s}=n.getState();r({nodes:s.filter(g4),edges:i.filter(g4)}),n.setState({nodesSelectionActive:!1})}},[a]),g.useEffect(()=>{n.setState({multiSelectionActive:o})},[o])}function Ice(e){const t=It();g.useEffect(()=>{const n=()=>{var a,o;if(!e.current)return!1;const r=Wh(e.current);(r.height===0||r.width===0)&&((o=(a=t.getState()).onError)==null||o.call(a,"004",jo.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const Qh={position:"absolute",width:"100%",height:"100%",top:0,left:0},Dce=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function Lce({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:a=.5,panOnScrollMode:o=ci.Free,zoomOnDoubleClick:i=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:p=!0,children:y,noWheelClassName:m,noPanClassName:v,onViewportChange:b,isControlledViewport:w,paneClickDistance:_}){const x=It(),j=g.useRef(null),{userSelectionActive:S,lib:E}=Qe(Dce,Bt),O=ud(f),M=g.useRef();Ice(j);const N=g.useCallback(P=>{b==null||b({x:P[0],y:P[1],zoom:P[2]}),w||x.setState({transform:P})},[b,w]);return g.useEffect(()=>{if(j.current){M.current=Hse({domNode:j.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:_,onDraggingChange:C=>x.setState({paneDragging:C}),onPanZoomStart:(C,T)=>{const{onViewportChangeStart:A,onMoveStart:I}=x.getState();I==null||I(C,T),A==null||A(T)},onPanZoom:(C,T)=>{const{onViewportChange:A,onMove:I}=x.getState();I==null||I(C,T),A==null||A(T)},onPanZoomEnd:(C,T)=>{const{onViewportChangeEnd:A,onMoveEnd:I}=x.getState();I==null||I(C,T),A==null||A(T)}});const{x:P,y:R,zoom:k}=M.current.getViewport();return x.setState({panZoom:M.current,transform:[P,R,k],domNode:j.current.closest(".react-flow")}),()=>{var C;(C=M.current)==null||C.destroy()}}},[]),g.useEffect(()=>{var P;(P=M.current)==null||P.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:a,panOnScrollMode:o,zoomOnDoubleClick:i,panOnDrag:s,zoomActivationKeyPressed:O,preventScrolling:p,noPanClassName:v,userSelectionActive:S,noWheelClassName:m,lib:E,onTransformChange:N})},[e,t,n,r,a,o,i,s,O,p,v,S,m,E,N]),h.jsx("div",{className:"react-flow__renderer",ref:j,style:Qh,children:y})}const $ce=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Fce(){const{userSelectionActive:e,userSelectionRect:t}=Qe($ce,Bt);return e&&t?h.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const l_=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Bce=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function zce({isSelecting:e,selectionKeyPressed:t,selectionMode:n=rd.Full,panOnDrag:r,selectionOnDrag:a,onSelectionStart:o,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:f,children:p}){const y=g.useRef(null),m=It(),v=g.useRef(0),b=g.useRef(0),w=g.useRef(),_=g.useRef(new Map),{userSelectionActive:x,elementsSelectable:j,dragging:S}=Qe(Bce,Bt),E=j&&(e||x),O=g.useRef(!1),M=g.useRef(!1),N=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,b.current=0},P=L=>{if(O.current){O.current=!1;return}s==null||s(L),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},R=L=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){L.preventDefault();return}c==null||c(L)},k=l?L=>l(L):void 0,C=L=>{var G,X,H,J;const{resetSelectedElements:D,domNode:B,edgeLookup:F}=m.getState();if(w.current=B==null?void 0:B.getBoundingClientRect(),!j||!e||L.button!==0||L.target!==y.current||!w.current)return;(X=(G=L.target)==null?void 0:G.setPointerCapture)==null||X.call(G,L.pointerId),M.current=!0,O.current=!1,_.current=new Map;for(const[Z,U]of F)_.current.set(U.source,((H=_.current.get(U.source))==null?void 0:H.add(Z))||new Set([Z])),_.current.set(U.target,((J=_.current.get(U.target))==null?void 0:J.add(Z))||new Set([Z]));const{x:$,y:V}=Eo(L.nativeEvent,w.current);D(),m.setState({userSelectionRect:{width:0,height:0,startX:$,startY:V,x:$,y:V}}),o==null||o(L)},T=L=>{const{userSelectionRect:D,edgeLookup:B,transform:F,nodeLookup:$,triggerNodeChanges:V,triggerEdgeChanges:G}=m.getState();if(!w.current||!D)return;O.current=!0;const{x:X,y:H}=Eo(L.nativeEvent,w.current),{startX:J,startY:Z}=D,U={startX:J,startY:Z,x:X<J?X:J,y:H<Z?H:Z,width:Math.abs(X-J),height:Math.abs(H-Z)},Q=s5($,U,F,n===rd.Partial,!0),ne=new Set,z=new Set;for(const se of Q){z.add(se.id);const re=_.current.get(se.id);if(re)for(const ue of re)ne.add(ue)}if(v.current!==z.size){v.current=z.size;const se=wc($,z,!0);V(se)}if(b.current!==ne.size){b.current=ne.size;const se=wc(B,ne);G(se)}m.setState({userSelectionRect:U,userSelectionActive:!0,nodesSelectionActive:!1})},A=L=>{var B,F;if(L.button!==0||!M.current)return;(F=(B=L.target)==null?void 0:B.releasePointerCapture)==null||F.call(B,L.pointerId);const{userSelectionRect:D}=m.getState();!x&&D&&L.target===y.current&&(P==null||P(L)),v.current>0&&m.setState({nodesSelectionActive:!0}),N(),i==null||i(L),(t||a)&&(O.current=!1),M.current=!1},I=r===!0||Array.isArray(r)&&r.includes(0);return h.jsxs("div",{className:en(["react-flow__pane",{draggable:I,dragging:S,selection:e}]),onClick:E?void 0:l_(P,y),onContextMenu:l_(R,y),onWheel:l_(k,y),onPointerEnter:E?void 0:u,onPointerDown:E?C:d,onPointerMove:E?T:d,onPointerUp:E?A:void 0,onPointerLeave:f,ref:y,style:Qh,children:[p,h.jsx(Fce,{})]})}function u_({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:a,unselectNodesAndEdges:o,multiSelectionActive:i,nodeLookup:s,onError:c}=t.getState(),l=s.get(e);if(!l){c==null||c("012",jo.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(o({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):a([e])}function v4({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:a,isSelectable:o,nodeClickDistance:i}){const s=It(),[c,l]=g.useState(!1),u=g.useRef();return g.useEffect(()=>{u.current=Ase({getStoreItems:()=>s.getState(),onNodeMouseDown:d=>{u_({id:d,store:s,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),g.useEffect(()=>{var d,f;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:o,nodeId:a,nodeClickDistance:i}),()=>{var p;(p=u.current)==null||p.destroy()}},[n,r,t,o,e,a]),c}const Vce=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function b4(){const e=It();return g.useCallback(t=>{const{nodeExtent:n,snapToGrid:r,snapGrid:a,nodesDraggable:o,onError:i,updateNodePositions:s,nodeLookup:c,nodeOrigin:l}=e.getState(),u=new Map,d=Vce(o),f=r?a[0]:5,p=r?a[1]:5,y=t.direction.x*f*t.factor,m=t.direction.y*p*t.factor;for(const[,v]of c){if(!d(v))continue;let b={x:v.internals.positionAbsolute.x+y,y:v.internals.positionAbsolute.y+m};r&&(b=qh(b,a));const{position:w,positionAbsolute:_}=c5({nodeId:v.id,nextPosition:b,nodeLookup:c,nodeExtent:n,nodeOrigin:l,onError:i});v.position=w,v.internals.positionAbsolute=_,u.set(v.id,v)}s(u)},[])}const d_=g.createContext(null),qce=d_.Provider;d_.Consumer;const f_=()=>g.useContext(d_),Uce=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Wce=(e,t,n)=>r=>{const{connectionClickStartHandle:a,connectionMode:o,connection:i}=r,{fromHandle:s,toHandle:c,isValid:l}=i,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,connectingTo:u,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,isPossibleEndHandle:o===pc.Strict?(s==null?void 0:s.type)!==n:e!==(s==null?void 0:s.nodeId)||t!==(s==null?void 0:s.id),connectionInProcess:!!s,valid:u&&l}};function Hce({type:e="source",position:t=he.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:a=!0,isConnectableEnd:o=!0,id:i,onConnect:s,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},p){var C,T;const y=i||null,m=e==="target",v=It(),b=f_(),{connectOnClick:w,noPanClassName:_,rfId:x}=Qe(Uce,Bt),{connectingFrom:j,connectingTo:S,clickConnecting:E,isPossibleEndHandle:O,connectionInProcess:M,valid:N}=Qe(Wce(b,y,e),Bt);b||((T=(C=v.getState()).onError)==null||T.call(C,"010",jo.error010()));const P=A=>{const{defaultEdgeOptions:I,onConnect:L,hasDefaultEdges:D}=v.getState(),B={...I,...A};if(D){const{edges:F,setEdges:$}=v.getState();$(S5(B,F))}L==null||L(B),s==null||s(B)},R=A=>{if(!b)return;const I=v5(A.nativeEvent);if(a&&(I&&A.button===0||!I)){const L=v.getState();a_.onPointerDown(A.nativeEvent,{autoPanOnConnect:L.autoPanOnConnect,connectionMode:L.connectionMode,connectionRadius:L.connectionRadius,domNode:L.domNode,nodeLookup:L.nodeLookup,lib:L.lib,isTarget:m,handleId:y,nodeId:b,flowId:L.rfId,panBy:L.panBy,cancelConnection:L.cancelConnection,onConnectStart:L.onConnectStart,onConnectEnd:L.onConnectEnd,updateConnection:L.updateConnection,onConnect:P,isValidConnection:n||L.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:L.autoPanSpeed})}I?u==null||u(A):d==null||d(A)},k=A=>{const{onClickConnectStart:I,onClickConnectEnd:L,connectionClickStartHandle:D,connectionMode:B,isValidConnection:F,lib:$,rfId:V,nodeLookup:G,connection:X}=v.getState();if(!b||!D&&!a)return;if(!D){I==null||I(A.nativeEvent,{nodeId:b,handleId:y,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:b,type:e,id:y}});return}const H=g5(A.target),J=n||F,{connection:Z,isValid:U}=a_.isValid(A.nativeEvent,{handle:{nodeId:b,id:y,type:e},connectionMode:B,fromNodeId:D.nodeId,fromHandleId:D.id||null,fromType:D.type,isValidConnection:J,flowId:V,doc:H,lib:$,nodeLookup:G});U&&Z&&P(Z);const Q=structuredClone(X);delete Q.inProgress,Q.toPosition=Q.toHandle?Q.toHandle.position:null,L==null||L(A,Q),v.setState({connectionClickStartHandle:null})};return h.jsx("div",{"data-handleid":y,"data-nodeid":b,"data-handlepos":t,"data-id":`${x}-${b}-${y}-${e}`,className:en(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",_,l,{source:!m,target:m,connectable:r,connectablestart:a,connectableend:o,clickconnecting:E,connectingfrom:j,connectingto:S,valid:N,connectionindicator:r&&(!M||O)&&(M?o:a)}]),onMouseDown:R,onTouchStart:R,onClick:w?k:void 0,ref:p,...f,children:c})}const fd=g.memo(h4(Hce));function Zce({data:e,isConnectable:t,sourcePosition:n=he.Bottom}){return h.jsxs(h.Fragment,{children:[e==null?void 0:e.label,h.jsx(fd,{type:"source",position:n,isConnectable:t})]})}function Kce({data:e,isConnectable:t,targetPosition:n=he.Top,sourcePosition:r=he.Bottom}){return h.jsxs(h.Fragment,{children:[h.jsx(fd,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,h.jsx(fd,{type:"source",position:r,isConnectable:t})]})}function Xce(){return null}function Gce({data:e,isConnectable:t,targetPosition:n=he.Top}){return h.jsxs(h.Fragment,{children:[h.jsx(fd,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Jh={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},w4={input:Zce,default:Kce,output:Gce,group:Xce};function Qce(e){var t,n,r,a;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((a=e.style)==null?void 0:a.height)}}const Jce=e=>{const{width:t,height:n,x:r,y:a}=od(e.nodeLookup,{filter:o=>!!o.selected});return{width:Jr(t)?t:null,height:Jr(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`}};function Yce({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=It(),{width:a,height:o,transformString:i,userSelectionActive:s}=Qe(Jce,Bt),c=b4(),l=g.useRef(null);if(g.useEffect(()=>{var f;n||((f=l.current)==null||f.focus({preventScroll:!0}))},[n]),v4({nodeRef:l}),s||!a||!o)return null;const u=e?f=>{const p=r.getState().nodes.filter(y=>y.selected);e(f,p)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(Jh,f.key)&&c({direction:Jh[f.key],factor:f.shiftKey?4:1})};return h.jsx("div",{className:en(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:h.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:a,height:o}})})}const x4=typeof window<"u"?window:void 0,ele=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function _4({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:y,panActivationKeyCode:m,zoomActivationKeyCode:v,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:_,panOnScroll:x,panOnScrollSpeed:j,panOnScrollMode:S,zoomOnDoubleClick:E,panOnDrag:O,defaultViewport:M,translateExtent:N,minZoom:P,maxZoom:R,preventScrolling:k,onSelectionContextMenu:C,noWheelClassName:T,noPanClassName:A,disableKeyboardA11y:I,onViewportChange:L,isControlledViewport:D}){const{nodesSelectionActive:B,userSelectionActive:F}=Qe(ele),$=ud(l,{target:x4}),V=ud(m,{target:x4}),G=V||O,X=V||x,H=u&&G!==!0,J=$||F||H;return Rce({deleteKeyCode:c,multiSelectionKeyCode:y}),h.jsx(Lce,{onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:_,panOnScroll:X,panOnScrollSpeed:j,panOnScrollMode:S,zoomOnDoubleClick:E,panOnDrag:!$&&G,defaultViewport:M,translateExtent:N,minZoom:P,maxZoom:R,zoomActivationKeyCode:v,preventScrolling:k,noWheelClassName:T,noPanClassName:A,onViewportChange:L,isControlledViewport:D,paneClickDistance:s,children:h.jsxs(zce,{onSelectionStart:f,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,panOnDrag:G,isSelecting:!!J,selectionMode:d,selectionKeyPressed:$,selectionOnDrag:H,children:[e,B&&h.jsx(Yce,{onSelectionContextMenu:C,noPanClassName:A,disableKeyboardA11y:I})]})})}_4.displayName="FlowRenderer";const tle=g.memo(_4),nle=e=>t=>e?s5(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function rle(e){return Qe(g.useCallback(nle(e),[e]),Bt)}const ale=e=>e.updateNodeInternals;function ole(){const e=Qe(ale),[t]=g.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(a=>{const o=a.target.getAttribute("data-id");r.set(o,{id:o,nodeElement:a.target,force:!0})}),e(r)}));return g.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function ile({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const a=It(),o=g.useRef(null),i=g.useRef(null),s=g.useRef(e.sourcePosition),c=g.useRef(e.targetPosition),l=g.useRef(t),u=n&&!!e.internals.handleBounds;return g.useEffect(()=>{o.current&&!e.hidden&&(!u||i.current!==o.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(o.current),i.current=o.current)},[u,e.hidden]),g.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),g.useEffect(()=>{if(o.current){const d=l.current!==t,f=s.current!==e.sourcePosition,p=c.current!==e.targetPosition;(d||f||p)&&(l.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:o.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),o}function sle({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:a,onContextMenu:o,onDoubleClick:i,nodesDraggable:s,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:f,noPanClassName:p,disableKeyboardA11y:y,rfId:m,nodeTypes:v,nodeExtent:b,nodeClickDistance:w,onError:_}){const{node:x,internals:j,isParent:S}=Qe(Z=>{const U=Z.nodeLookup.get(e),Q=Z.parentLookup.has(e);return{node:U,internals:U.internals,isParent:Q}},Bt);let E=x.type||"default",O=(v==null?void 0:v[E])||w4[E];O===void 0&&(_==null||_("003",jo.error003(E)),E="default",O=w4.default);const M=!!(x.draggable||s&&typeof x.draggable>"u"),N=!!(x.selectable||c&&typeof x.selectable>"u"),P=!!(x.connectable||l&&typeof x.connectable>"u"),R=!!(x.focusable||u&&typeof x.focusable>"u"),k=It(),C=m5(x),T=ile({node:x,nodeType:E,hasDimensions:C,resizeObserver:d}),A=v4({nodeRef:T,disabled:x.hidden||!M,noDragClassName:f,handleSelector:x.dragHandle,nodeId:e,isSelectable:N,nodeClickDistance:w}),I=b4();if(x.hidden)return null;const L=So(x),D=Qce(x),B=N||M||t||n||r||a,F=n?Z=>n(Z,{...j.userNode}):void 0,$=r?Z=>r(Z,{...j.userNode}):void 0,V=a?Z=>a(Z,{...j.userNode}):void 0,G=o?Z=>o(Z,{...j.userNode}):void 0,X=i?Z=>i(Z,{...j.userNode}):void 0,H=Z=>{const{selectNodesOnDrag:U,nodeDragThreshold:Q}=k.getState();N&&(!U||!M||Q>0)&&u_({id:e,store:k,nodeRef:T}),t&&t(Z,{...j.userNode})},J=Z=>{if(!(X1(Z.nativeEvent)||y))if(t5.includes(Z.key)&&N){const U=Z.key==="Escape";u_({id:e,store:k,unselect:U,nodeRef:T})}else M&&x.selected&&Object.prototype.hasOwnProperty.call(Jh,Z.key)&&(k.setState({ariaLiveMessage:`Moved selected node ${Z.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~j.positionAbsolute.x}, y: ${~~j.positionAbsolute.y}`}),I({direction:Jh[Z.key],factor:Z.shiftKey?4:1}))};return h.jsx("div",{className:en(["react-flow__node",`react-flow__node-${E}`,{[p]:M},x.className,{selected:x.selected,selectable:N,parent:S,draggable:M,dragging:A}]),ref:T,style:{zIndex:j.z,transform:`translate(${j.positionAbsolute.x}px,${j.positionAbsolute.y}px)`,pointerEvents:B?"all":"none",visibility:C?"visible":"hidden",...x.style,...D},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:F,onMouseMove:$,onMouseLeave:V,onContextMenu:G,onClick:H,onDoubleClick:X,onKeyDown:R?J:void 0,tabIndex:R?0:void 0,role:R?"button":void 0,"aria-describedby":y?void 0:`${t4}-${m}`,"aria-label":x.ariaLabel,children:h.jsx(qce,{value:e,children:h.jsx(O,{id:e,data:x.data,type:E,positionAbsoluteX:j.positionAbsolute.x,positionAbsoluteY:j.positionAbsolute.y,selected:x.selected,selectable:N,draggable:M,deletable:x.deletable??!0,isConnectable:P,sourcePosition:x.sourcePosition,targetPosition:x.targetPosition,dragging:A,dragHandle:x.dragHandle,zIndex:j.z,parentId:x.parentId,...L})})})}const cle=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function j4(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,onError:o}=Qe(cle,Bt),i=rle(e.onlyRenderVisibleElements),s=ole();return h.jsx("div",{className:"react-flow__nodes",style:Qh,children:i.map(c=>h.jsx(sle,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:o},c))})}j4.displayName="NodeRenderer";const lle=g.memo(j4);function ule(e){return Qe(g.useCallback(t=>{if(!e)return t.edges.map(r=>r.id);const n=[];if(t.width&&t.height)for(const r of t.edges){const a=t.nodeLookup.get(r.source),o=t.nodeLookup.get(r.target);a&&o&&gse({sourceNode:a,targetNode:o,width:t.width,height:t.height,transform:t.transform})&&n.push(r.id)}return n},[e]),Bt)}const dle=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),fle=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),S4={[Fh.Arrow]:dle,[Fh.ArrowClosed]:fle};function ple(e){const t=It();return g.useMemo(()=>{var n,r;return Object.prototype.hasOwnProperty.call(S4,e)?S4[e]:((r=(n=t.getState()).onError)==null||r.call(n,"009",jo.error009(e)),null)},[e])}const hle=({id:e,type:t,color:n,width:r=12.5,height:a=12.5,markerUnits:o="strokeWidth",strokeWidth:i,orient:s="auto-start-reverse"})=>{const c=ple(t);return c?h.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:h.jsx(c,{color:n,strokeWidth:i})}):null},E4=({defaultColor:e,rfId:t})=>{const n=Qe(o=>o.edges),r=Qe(o=>o.defaultEdgeOptions),a=g.useMemo(()=>Sse(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return a.length?h.jsx("svg",{className:"react-flow__marker",children:h.jsx("defs",{children:a.map(o=>h.jsx(hle,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})}):null};E4.displayName="MarkerDefinitions";var mle=g.memo(E4);function O4({x:e,y:t,label:n,labelStyle:r={},labelShowBg:a=!0,labelBgStyle:o={},labelBgPadding:i=[2,4],labelBgBorderRadius:s=2,children:c,className:l,...u}){const[d,f]=g.useState({x:1,y:0,width:0,height:0}),p=en(["react-flow__edge-textwrapper",l]),y=g.useRef(null);return g.useEffect(()=>{if(y.current){const m=y.current.getBBox();f({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),typeof n>"u"||!n?null:h.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:p,visibility:d.width?"visible":"hidden",...u,children:[a&&h.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),h.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:y,style:r,children:n}),c]})}O4.displayName="EdgeText";const yle=g.memo(O4);function Yh({id:e,path:t,labelX:n,labelY:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,className:p,interactionWidth:y=20}){return h.jsxs(h.Fragment,{children:[h.jsx("path",{id:e,style:u,d:t,fill:"none",className:en(["react-flow__edge-path",p]),markerEnd:d,markerStart:f}),y&&h.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:y,className:"react-flow__edge-interaction"}),a&&Jr(n)&&Jr(r)?h.jsx(yle,{x:n,y:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l}):null]})}function C4({pos:e,x1:t,y1:n,x2:r,y2:a}){return e===he.Left||e===he.Right?[.5*(t+r),n]:[t,.5*(n+a)]}function N4({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:o=he.Top}){const[i,s]=C4({pos:n,x1:e,y1:t,x2:r,y2:a}),[c,l]=C4({pos:o,x1:r,y1:a,x2:e,y2:t}),[u,d,f,p]=w5({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:i,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${s} ${c},${l} ${r},${a}`,u,d,f,p]}function M4(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=he.Bottom,targetPosition:s=he.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:y,markerEnd:m,markerStart:v,interactionWidth:b})=>{const[w,_,x]=N4({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s}),j=e.isInternal?void 0:t;return h.jsx(Yh,{id:j,path:w,labelX:_,labelY:x,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:y,markerEnd:m,markerStart:v,interactionWidth:b})})}const gle=M4({isInternal:!1}),P4=M4({isInternal:!0});gle.displayName="SimpleBezierEdge",P4.displayName="SimpleBezierEdgeInternal";function k4(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,sourcePosition:p=he.Bottom,targetPosition:y=he.Top,markerEnd:m,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[_,x,j]=G1({sourceX:n,sourceY:r,sourcePosition:p,targetX:a,targetY:o,targetPosition:y,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset}),S=e.isInternal?void 0:t;return h.jsx(Yh,{id:S,path:_,labelX:x,labelY:j,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:m,markerStart:v,interactionWidth:w})})}const A4=k4({isInternal:!1}),T4=k4({isInternal:!0});A4.displayName="SmoothStepEdge",T4.displayName="SmoothStepEdgeInternal";function R4(e){return g.memo(({id:t,...n})=>{var a;const r=e.isInternal?void 0:t;return h.jsx(A4,{...n,id:r,pathOptions:g.useMemo(()=>{var o;return{borderRadius:0,offset:(o=n.pathOptions)==null?void 0:o.offset}},[(a=n.pathOptions)==null?void 0:a.offset])})})}const vle=R4({isInternal:!1}),I4=R4({isInternal:!0});vle.displayName="StepEdge",I4.displayName="StepEdgeInternal";function D4(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:y,interactionWidth:m})=>{const[v,b,w]=E5({sourceX:n,sourceY:r,targetX:a,targetY:o}),_=e.isInternal?void 0:t;return h.jsx(Yh,{id:_,path:v,labelX:b,labelY:w,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:y,interactionWidth:m})})}const ble=D4({isInternal:!1}),L4=D4({isInternal:!0});ble.displayName="StraightEdge",L4.displayName="StraightEdgeInternal";function $4(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=he.Bottom,targetPosition:s=he.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:y,markerEnd:m,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[_,x,j]=_5({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s,curvature:b==null?void 0:b.curvature}),S=e.isInternal?void 0:t;return h.jsx(Yh,{id:S,path:_,labelX:x,labelY:j,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:y,markerEnd:m,markerStart:v,interactionWidth:w})})}const wle=$4({isInternal:!1}),F4=$4({isInternal:!0});wle.displayName="BezierEdge",F4.displayName="BezierEdgeInternal";const B4={default:F4,straight:L4,step:I4,smoothstep:T4,simplebezier:P4},z4={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},xle=(e,t,n)=>n===he.Left?e-t:n===he.Right?e+t:e,_le=(e,t,n)=>n===he.Top?e-t:n===he.Bottom?e+t:e,V4="react-flow__edgeupdater";function q4({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:a,onMouseEnter:o,onMouseOut:i,type:s}){return h.jsx("circle",{onMouseDown:a,onMouseEnter:o,onMouseOut:i,className:en([V4,`${V4}-${s}`]),cx:xle(t,r,e),cy:_le(n,r,e),r,stroke:"transparent",fill:"transparent"})}function jle({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:a,targetX:o,targetY:i,sourcePosition:s,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:f,setUpdateHover:p}){const y=It(),m=(x,j)=>{if(x.button!==0)return;const{autoPanOnConnect:S,domNode:E,isValidConnection:O,connectionMode:M,connectionRadius:N,lib:P,onConnectStart:R,onConnectEnd:k,cancelConnection:C,nodeLookup:T,rfId:A,panBy:I,updateConnection:L}=y.getState(),D=j.type==="target";f(!0),u==null||u(x,n,j.type);const B=($,V)=>{f(!1),d==null||d($,n,j.type,V)},F=$=>l==null?void 0:l(n,$);a_.onPointerDown(x.nativeEvent,{autoPanOnConnect:S,connectionMode:M,connectionRadius:N,domNode:E,handleId:j.id,nodeId:j.nodeId,nodeLookup:T,isTarget:D,edgeUpdaterType:j.type,lib:P,flowId:A,cancelConnection:C,panBy:I,isValidConnection:O,onConnect:F,onConnectStart:R,onConnectEnd:k,onReconnectEnd:B,updateConnection:L,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle})},v=x=>m(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=x=>m(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>p(!0),_=()=>p(!1);return h.jsxs(h.Fragment,{children:[(e===!0||e==="source")&&h.jsx(q4,{position:s,centerX:r,centerY:a,radius:t,onMouseDown:v,onMouseEnter:w,onMouseOut:_,type:"source"}),(e===!0||e==="target")&&h.jsx(q4,{position:c,centerX:o,centerY:i,radius:t,onMouseDown:b,onMouseEnter:w,onMouseOut:_,type:"target"})]})}function Sle({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:a,onDoubleClick:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:p,rfId:y,edgeTypes:m,noPanClassName:v,onError:b,disableKeyboardA11y:w}){let _=Qe(z=>z.edgeLookup.get(e));const x=Qe(z=>z.defaultEdgeOptions);_=x?{...x,..._}:_;let j=_.type||"default",S=(m==null?void 0:m[j])||B4[j];S===void 0&&(b==null||b("011",jo.error011(j)),j="default",S=B4.default);const E=!!(_.focusable||t&&typeof _.focusable>"u"),O=typeof d<"u"&&(_.reconnectable||n&&typeof _.reconnectable>"u"),M=!!(_.selectable||r&&typeof _.selectable>"u"),N=g.useRef(null),[P,R]=g.useState(!1),[k,C]=g.useState(!1),T=It(),{zIndex:A,sourceX:I,sourceY:L,targetX:D,targetY:B,sourcePosition:F,targetPosition:$}=Qe(g.useCallback(z=>{const se=z.nodeLookup.get(_.source),re=z.nodeLookup.get(_.target);if(!se||!re)return{zIndex:_.zIndex,...z4};const ue=jse({id:e,sourceNode:se,targetNode:re,sourceHandle:_.sourceHandle||null,targetHandle:_.targetHandle||null,connectionMode:z.connectionMode,onError:b});return{zIndex:yse({selected:_.selected,zIndex:_.zIndex,sourceNode:se,targetNode:re,elevateOnSelect:z.elevateEdgesOnSelect}),...ue||z4}},[_.source,_.target,_.sourceHandle,_.targetHandle,_.selected,_.zIndex]),Bt),V=g.useMemo(()=>_.markerStart?`url('#${Q1(_.markerStart,y)}')`:void 0,[_.markerStart,y]),G=g.useMemo(()=>_.markerEnd?`url('#${Q1(_.markerEnd,y)}')`:void 0,[_.markerEnd,y]);if(_.hidden||I===null||L===null||D===null||B===null)return null;const X=z=>{var je;const{addSelectedEdges:se,unselectNodesAndEdges:re,multiSelectionActive:ue}=T.getState();M&&(T.setState({nodesSelectionActive:!1}),_.selected&&ue?(re({nodes:[],edges:[_]}),(je=N.current)==null||je.blur()):se([e])),a&&a(z,_)},H=o?z=>{o(z,{..._})}:void 0,J=i?z=>{i(z,{..._})}:void 0,Z=s?z=>{s(z,{..._})}:void 0,U=c?z=>{c(z,{..._})}:void 0,Q=l?z=>{l(z,{..._})}:void 0,ne=z=>{var se;if(!w&&t5.includes(z.key)&&M){const{unselectNodesAndEdges:re,addSelectedEdges:ue}=T.getState();z.key==="Escape"?((se=N.current)==null||se.blur(),re({edges:[_]})):ue([e])}};return h.jsx("svg",{style:{zIndex:A},children:h.jsxs("g",{className:en(["react-flow__edge",`react-flow__edge-${j}`,_.className,v,{selected:_.selected,animated:_.animated,inactive:!M&&!a,updating:P,selectable:M}]),onClick:X,onDoubleClick:H,onContextMenu:J,onMouseEnter:Z,onMouseMove:U,onMouseLeave:Q,onKeyDown:E?ne:void 0,tabIndex:E?0:void 0,role:E?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":_.ariaLabel===null?void 0:_.ariaLabel||`Edge from ${_.source} to ${_.target}`,"aria-describedby":E?`${n4}-${y}`:void 0,ref:N,children:[!k&&h.jsx(S,{id:e,source:_.source,target:_.target,type:_.type,selected:_.selected,animated:_.animated,selectable:M,deletable:_.deletable??!0,label:_.label,labelStyle:_.labelStyle,labelShowBg:_.labelShowBg,labelBgStyle:_.labelBgStyle,labelBgPadding:_.labelBgPadding,labelBgBorderRadius:_.labelBgBorderRadius,sourceX:I,sourceY:L,targetX:D,targetY:B,sourcePosition:F,targetPosition:$,data:_.data,style:_.style,sourceHandleId:_.sourceHandle,targetHandleId:_.targetHandle,markerStart:V,markerEnd:G,pathOptions:"pathOptions"in _?_.pathOptions:void 0,interactionWidth:_.interactionWidth}),O&&h.jsx(jle,{edge:_,isReconnectable:O,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:p,sourceX:I,sourceY:L,targetX:D,targetY:B,sourcePosition:F,targetPosition:$,setUpdateHover:R,setReconnecting:C})]})})}const Ele=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function U4({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:a,onReconnect:o,onEdgeContextMenu:i,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:p,onReconnectEnd:y,disableKeyboardA11y:m}){const{edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,onError:_}=Qe(Ele,Bt),x=ule(t);return h.jsxs("div",{className:"react-flow__edges",children:[h.jsx(mle,{defaultColor:e,rfId:n}),x.map(j=>h.jsx(Sle,{id:j,edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,noPanClassName:a,onReconnect:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:f,onReconnectStart:p,onReconnectEnd:y,rfId:n,onError:_,edgeTypes:r,disableKeyboardA11y:m},j))]})}U4.displayName="EdgeRenderer";const Ole=g.memo(U4),Cle=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Nle({children:e}){const t=Qe(Cle);return h.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Mle(e){const t=mr(),n=g.useRef(!1);g.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Ple=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function kle(e){const t=Qe(Ple),n=It();return g.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Ale(e){return e.connection.inProgress?{...e.connection,to:sd(e.connection.to,e.transform)}:{...e.connection}}function Tle(e){return Ale}function Rle(e){const t=Tle();return Qe(t,Bt)}const Ile=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Dle({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:a,width:o,height:i,isValid:s,inProgress:c}=Qe(Ile,Bt);return o&&a&&c?h.jsx("svg",{style:e,width:o,height:i,className:"react-flow__connectionline react-flow__container",children:h.jsx("g",{className:en(["react-flow__connection",o5(s)]),children:h.jsx(W4,{style:t,type:n,CustomComponent:r,isValid:s})})}):null}const W4=({style:e,type:t=li.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:a,from:o,fromNode:i,fromHandle:s,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:f}=Rle();if(!a)return;if(n)return h.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:s,fromX:o.x,fromY:o.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:o5(r),toNode:u,toHandle:d});let p="";const y={sourceX:o.x,sourceY:o.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case li.Bezier:[p]=_5(y);break;case li.SimpleBezier:[p]=N4(y);break;case li.Step:[p]=G1({...y,borderRadius:0});break;case li.SmoothStep:[p]=G1(y);break;default:[p]=E5(y)}return h.jsx("path",{d:p,fill:"none",className:"react-flow__connection-path",style:e})};W4.displayName="ConnectionLine";const Lle={};function H4(e=Lle){g.useRef(e),It(),g.useEffect(()=>{},[e])}function $le(){It(),g.useRef(!1),g.useEffect(()=>{},[])}function Z4({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:o,onEdgeDoubleClick:i,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:p,connectionLineType:y,connectionLineStyle:m,connectionLineComponent:v,connectionLineContainerStyle:b,selectionKeyCode:w,selectionOnDrag:_,selectionMode:x,multiSelectionKeyCode:j,panActivationKeyCode:S,zoomActivationKeyCode:E,deleteKeyCode:O,onlyRenderVisibleElements:M,elementsSelectable:N,defaultViewport:P,translateExtent:R,minZoom:k,maxZoom:C,preventScrolling:T,defaultMarkerColor:A,zoomOnScroll:I,zoomOnPinch:L,panOnScroll:D,panOnScrollSpeed:B,panOnScrollMode:F,zoomOnDoubleClick:$,panOnDrag:V,onPaneClick:G,onPaneMouseEnter:X,onPaneMouseMove:H,onPaneMouseLeave:J,onPaneScroll:Z,onPaneContextMenu:U,paneClickDistance:Q,nodeClickDistance:ne,onEdgeContextMenu:z,onEdgeMouseEnter:se,onEdgeMouseMove:re,onEdgeMouseLeave:ue,reconnectRadius:je,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Se,noDragClassName:Ve,noWheelClassName:Ue,noPanClassName:We,disableKeyboardA11y:At,nodeExtent:st,rfId:rt,viewport:wt,onViewportChange:Xt}){return H4(e),H4(t),$le(),Mle(n),kle(wt),h.jsx(tle,{onPaneClick:G,onPaneMouseEnter:X,onPaneMouseMove:H,onPaneMouseLeave:J,onPaneContextMenu:U,onPaneScroll:Z,paneClickDistance:Q,deleteKeyCode:O,selectionKeyCode:w,selectionOnDrag:_,selectionMode:x,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:j,panActivationKeyCode:S,zoomActivationKeyCode:E,elementsSelectable:N,zoomOnScroll:I,zoomOnPinch:L,zoomOnDoubleClick:$,panOnScroll:D,panOnScrollSpeed:B,panOnScrollMode:F,panOnDrag:V,defaultViewport:P,translateExtent:R,minZoom:k,maxZoom:C,onSelectionContextMenu:d,preventScrolling:T,noDragClassName:Ve,noWheelClassName:Ue,noPanClassName:We,disableKeyboardA11y:At,onViewportChange:Xt,isControlledViewport:!!wt,children:h.jsxs(Nle,{children:[h.jsx(Ole,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:i,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Se,onlyRenderVisibleElements:M,onEdgeContextMenu:z,onEdgeMouseEnter:se,onEdgeMouseMove:re,onEdgeMouseLeave:ue,reconnectRadius:je,defaultMarkerColor:A,noPanClassName:We,disableKeyboardA11y:At,rfId:rt}),h.jsx(Dle,{style:m,type:y,component:v,containerStyle:b}),h.jsx("div",{className:"react-flow__edgelabel-renderer"}),h.jsx(lle,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:ne,onlyRenderVisibleElements:M,noPanClassName:We,noDragClassName:Ve,disableKeyboardA11y:At,nodeExtent:st,rfId:rt}),h.jsx("div",{className:"react-flow__viewport-portal"})]})})}Z4.displayName="GraphView";const Fle=g.memo(Z4),K4=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}={})=>{const l=new Map,u=new Map,d=new Map,f=new Map,p=r??t??[],y=n??e??[],m=s??[0,0],v=c??nd;A5(d,f,p),e_(y,l,u,{nodeOrigin:m,nodeExtent:v,elevateNodesOnSelect:!1});let b=[0,0,1];if(i&&a&&o){const w=od(l,{filter:S=>!!((S.width||S.initialWidth)&&(S.height||S.initialHeight))}),{x:_,y:x,zoom:j}=K1(w,a,o,.5,2,.1);b=[_,x,j]}return{rfId:"1",width:0,height:0,transform:b,nodes:y,nodeLookup:l,parentLookup:u,edges:p,edgeLookup:f,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:nd,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:pc.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:m,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...n5},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:hse,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},Ble=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c})=>oce((l,u)=>({...K4({nodes:e,edges:t,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:d=>{const{nodeLookup:f,parentLookup:p,nodeOrigin:y,elevateNodesOnSelect:m}=u();e_(d,f,p,{nodeOrigin:y,nodeExtent:c,elevateNodesOnSelect:m,checkEquality:!0}),l({nodes:d})},setEdges:d=>{const{connectionLookup:f,edgeLookup:p}=u();A5(f,p,d),l({edges:d})},setDefaultNodesAndEdges:(d,f)=>{if(d){const{setNodes:p}=u();p(d),l({hasDefaultNodes:!0})}if(f){const{setEdges:p}=u();p(f),l({hasDefaultEdges:!0})}},updateNodeInternals:(d,f={triggerFitView:!0})=>{const{triggerNodeChanges:p,nodeLookup:y,parentLookup:m,fitViewOnInit:v,fitViewDone:b,fitViewOnInitOptions:w,domNode:_,nodeOrigin:x,nodeExtent:j,debug:S,fitViewSync:E}=u(),{changes:O,updatedInternals:M}=Mse(d,y,m,_,x,j);if(M){if(Ose(y,m,{nodeOrigin:x,nodeExtent:j}),f.triggerFitView){let N=b;!b&&v&&(N=E({...w,nodes:w==null?void 0:w.nodes})),l({fitViewDone:N})}else l({});(O==null?void 0:O.length)>0&&(S&&console.log("React Flow: trigger node changes",O),p==null||p(O))}},updateNodePositions:(d,f=!1)=>{const p=[],y=[];for(const[m,v]of d){const b={id:m,type:"position",position:v.position,dragging:f};v!=null&&v.expandParent&&(v!=null&&v.parentId)&&b.position&&(p.push({id:m,parentId:v.parentId,rect:{...v.internals.positionAbsolute,width:v.measured.width,height:v.measured.height}}),b.position.x=Math.max(0,b.position.x),b.position.y=Math.max(0,b.position.y)),y.push(b)}if(p.length>0){const{nodeLookup:m,parentLookup:v,nodeOrigin:b}=u(),w=n_(p,m,v,b);y.push(...w)}u().triggerNodeChanges(y)},triggerNodeChanges:d=>{const{onNodesChange:f,setNodes:p,nodes:y,hasDefaultNodes:m,debug:v}=u();if(d!=null&&d.length){if(m){const b=Ji(d,y);p(b)}v&&console.log("React Flow: trigger node changes",d),f==null||f(d)}},triggerEdgeChanges:d=>{const{onEdgesChange:f,setEdges:p,edges:y,hasDefaultEdges:m,debug:v}=u();if(d!=null&&d.length){if(m){const b=dd(d,y);p(b)}v&&console.log("React Flow: trigger edge changes",d),f==null||f(d)}},addSelectedNodes:d=>{const{multiSelectionActive:f,edgeLookup:p,nodeLookup:y,triggerNodeChanges:m,triggerEdgeChanges:v}=u();if(f){const b=d.map(w=>Yi(w,!0));m(b);return}m(wc(y,new Set([...d]),!0)),v(wc(p))},addSelectedEdges:d=>{const{multiSelectionActive:f,edgeLookup:p,nodeLookup:y,triggerNodeChanges:m,triggerEdgeChanges:v}=u();if(f){const b=d.map(w=>Yi(w,!0));v(b);return}v(wc(p,new Set([...d]))),m(wc(y,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:f}={})=>{const{edges:p,nodes:y,nodeLookup:m,triggerNodeChanges:v,triggerEdgeChanges:b}=u(),w=d||y,_=f||p,x=w.map(S=>{const E=m.get(S.id);return E&&(E.selected=!1),Yi(S.id,!1)}),j=_.map(S=>Yi(S.id,!1));v(x),b(j)},setMinZoom:d=>{const{panZoom:f,maxZoom:p}=u();f==null||f.setScaleExtent([d,p]),l({minZoom:d})},setMaxZoom:d=>{const{panZoom:f,minZoom:p}=u();f==null||f.setScaleExtent([p,d]),l({maxZoom:d})},setTranslateExtent:d=>{var f;(f=u().panZoom)==null||f.setTranslateExtent(d),l({translateExtent:d})},setPaneClickDistance:d=>{var f;(f=u().panZoom)==null||f.setClickDistance(d)},resetSelectedElements:()=>{const{edges:d,nodes:f,triggerNodeChanges:p,triggerEdgeChanges:y}=u(),m=f.reduce((b,w)=>w.selected?[...b,Yi(w.id,!1)]:b,[]),v=d.reduce((b,w)=>w.selected?[...b,Yi(w.id,!1)]:b,[]);p(m),y(v)},setNodeExtent:d=>{const{nodes:f,nodeLookup:p,parentLookup:y,nodeOrigin:m,elevateNodesOnSelect:v,nodeExtent:b}=u();d[0][0]===b[0][0]&&d[0][1]===b[0][1]&&d[1][0]===b[1][0]&&d[1][1]===b[1][1]||(e_(f,p,y,{nodeOrigin:m,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!1}),l({nodeExtent:d}))},panBy:d=>{const{transform:f,width:p,height:y,panZoom:m,translateExtent:v}=u();return Pse({delta:d,panZoom:m,transform:f,translateExtent:v,width:p,height:y})},fitView:d=>{const{panZoom:f,width:p,height:y,minZoom:m,maxZoom:v,nodeLookup:b}=u();if(!f)return Promise.resolve(!1);const w=W1(b,d);return H1({nodes:w,width:p,height:y,panZoom:f,minZoom:m,maxZoom:v},d)},fitViewSync:d=>{const{panZoom:f,width:p,height:y,minZoom:m,maxZoom:v,nodeLookup:b}=u();if(!f)return!1;const w=W1(b,d);return H1({nodes:w,width:p,height:y,panZoom:f,minZoom:m,maxZoom:v},d),w.size>0},cancelConnection:()=>{l({connection:{...n5}})},updateConnection:d=>{l({connection:d})},reset:()=>l({...K4()})}),Object.is);function zle({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:a,initialHeight:o,fitView:i,nodeOrigin:s,nodeExtent:c,children:l}){const[u]=g.useState(()=>Ble({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}));return h.jsx(ice,{value:u,children:h.jsx(Mce,{children:l})})}function Vle({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:o,height:i,fitView:s,nodeOrigin:c,nodeExtent:l}){return g.useContext(Xh)?h.jsx(h.Fragment,{children:e}):h.jsx(zle,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:o,initialHeight:i,fitView:s,nodeOrigin:c,nodeExtent:l,children:e})}const qle={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Ule({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:a,nodeTypes:o,edgeTypes:i,onNodeClick:s,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:p,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:x,onNodeContextMenu:j,onNodeDoubleClick:S,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:M,onNodesDelete:N,onEdgesDelete:P,onDelete:R,onSelectionChange:k,onSelectionDragStart:C,onSelectionDrag:T,onSelectionDragStop:A,onSelectionContextMenu:I,onSelectionStart:L,onSelectionEnd:D,onBeforeDelete:B,connectionMode:F,connectionLineType:$=li.Bezier,connectionLineStyle:V,connectionLineComponent:G,connectionLineContainerStyle:X,deleteKeyCode:H="Backspace",selectionKeyCode:J="Shift",selectionOnDrag:Z=!1,selectionMode:U=rd.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:ne=Uh()?"Meta":"Control",zoomActivationKeyCode:z=Uh()?"Meta":"Control",snapToGrid:se,snapGrid:re,onlyRenderVisibleElements:ue=!1,selectNodesOnDrag:je,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Se,nodeOrigin:Ve=r4,edgesFocusable:Ue,edgesReconnectable:We,elementsSelectable:At=!0,defaultViewport:st=bce,minZoom:rt=.5,maxZoom:wt=2,translateExtent:Xt=nd,preventScrolling:nr=!0,nodeExtent:Ka,defaultMarkerColor:rr="#b1b1b7",zoomOnScroll:Xa=!0,zoomOnPinch:Y=!0,panOnScroll:te=!1,panOnScrollSpeed:ce=.5,panOnScrollMode:me=ci.Free,zoomOnDoubleClick:Te=!0,panOnDrag:Ht=!0,onPaneClick:$t,onPaneMouseEnter:Ze,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Ee,onPaneContextMenu:Oe,paneClickDistance:qe=0,nodeClickDistance:Ot=0,children:Vt,onReconnect:q,onReconnectStart:ee,onReconnectEnd:ae,onEdgeContextMenu:pe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:Ie,onEdgeMouseMove:Be,onEdgeMouseLeave:Me,reconnectRadius:ke=10,onNodesChange:we,onEdgesChange:ze,noDragClassName:Je="nodrag",noWheelClassName:Rt="nowheel",noPanClassName:Ft="nopan",fitView:at,fitViewOptions:ar,connectOnClick:Gt,attributionPosition:Ns,proOptions:xa,defaultEdgeOptions:Ai,elevateNodesOnSelect:Ga,elevateEdgesOnSelect:Zf,disableKeyboardA11y:Rr=!1,autoPanOnConnect:$l,autoPanOnNodeDrag:Fl,autoPanSpeed:Bl,connectionRadius:pt,isValidConnection:or,onError:Ms,style:qt,id:Zo,nodeDragThreshold:Jg,viewport:rM,onViewportChange:NTe,width:MTe,height:PTe,colorMode:kTe="light",debug:ATe,...TTe},RTe){const aM=Zo||"1",ITe=jce(kTe);return h.jsx("div",{...TTe,style:{...qt,...qle},ref:RTe,className:en(["react-flow",a,ITe]),"data-testid":"rf__wrapper",id:Zo,children:h.jsxs(Vle,{nodes:e,edges:t,width:MTe,height:PTe,fitView:at,nodeOrigin:Ve,nodeExtent:Ka,children:[h.jsx(Fle,{onInit:l,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:x,onNodeContextMenu:j,onNodeDoubleClick:S,nodeTypes:o,edgeTypes:i,connectionLineType:$,connectionLineStyle:V,connectionLineComponent:G,connectionLineContainerStyle:X,selectionKeyCode:J,selectionOnDrag:Z,selectionMode:U,deleteKeyCode:H,multiSelectionKeyCode:ne,panActivationKeyCode:Q,zoomActivationKeyCode:z,onlyRenderVisibleElements:ue,defaultViewport:st,translateExtent:Xt,minZoom:rt,maxZoom:wt,preventScrolling:nr,zoomOnScroll:Xa,zoomOnPinch:Y,zoomOnDoubleClick:Te,panOnScroll:te,panOnScrollSpeed:ce,panOnScrollMode:me,panOnDrag:Ht,onPaneClick:$t,onPaneMouseEnter:Ze,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Ee,onPaneContextMenu:Oe,paneClickDistance:qe,nodeClickDistance:Ot,onSelectionContextMenu:I,onSelectionStart:L,onSelectionEnd:D,onReconnect:q,onReconnectStart:ee,onReconnectEnd:ae,onEdgeContextMenu:pe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:Ie,onEdgeMouseMove:Be,onEdgeMouseLeave:Me,reconnectRadius:ke,defaultMarkerColor:rr,noDragClassName:Je,noWheelClassName:Rt,noPanClassName:Ft,rfId:aM,disableKeyboardA11y:Rr,nodeExtent:Ka,viewport:rM,onViewportChange:NTe}),h.jsx(_ce,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:p,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Se,edgesFocusable:Ue,edgesReconnectable:We,elementsSelectable:At,elevateNodesOnSelect:Ga,elevateEdgesOnSelect:Zf,minZoom:rt,maxZoom:wt,nodeExtent:Ka,onNodesChange:we,onEdgesChange:ze,snapToGrid:se,snapGrid:re,connectionMode:F,translateExtent:Xt,connectOnClick:Gt,defaultEdgeOptions:Ai,fitView:at,fitViewOptions:ar,onNodesDelete:N,onEdgesDelete:P,onDelete:R,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:M,onSelectionDrag:T,onSelectionDragStart:C,onSelectionDragStop:A,onMove:u,onMoveStart:d,onMoveEnd:f,noPanClassName:Ft,nodeOrigin:Ve,rfId:aM,autoPanOnConnect:$l,autoPanOnNodeDrag:Fl,autoPanSpeed:Bl,onError:Ms,connectionRadius:pt,isValidConnection:or,selectNodesOnDrag:je,nodeDragThreshold:Jg,onBeforeDelete:B,paneClickDistance:qe,debug:ATe}),h.jsx(vce,{onSelectionChange:k}),Vt,h.jsx(pce,{proOptions:xa,position:Ns}),h.jsx(dce,{rfId:aM,disableKeyboardA11y:Rr})]})})}var Wle=h4(Ule);const Hle=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__viewport-portal")};function Zle({children:e}){const t=Qe(Hle);return t?Vl.createPortal(e,t):null}const Kle=e=>e.nodes;function Xle(){return Qe(Kle,Bt)}function em({type:e,id:t=null,nodeId:n,onConnect:r,onDisconnect:a}){const o=f_(),i=n??o,s=g.useRef(null),c=Qe(l=>l.connectionLookup.get(`${i}-${e}-${t}`),lse);return g.useEffect(()=>{if(s.current&&s.current!==c){const l=c??new Map;a5(s.current,l,a),a5(l,s.current,r)}s.current=c??new Map},[c,r,a]),g.useMemo(()=>Array.from((c==null?void 0:c.values())??[]),[c])}$n=function(e){return Qe(g.useCallback(t=>t.nodeLookup.get(e),[e]),Bt)};function Gle({dimensions:e,lineWidth:t,variant:n,className:r}){return h.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:en(["react-flow__background-pattern",n,r])})}function Qle({radius:e,className:t}){return h.jsx("circle",{cx:e,cy:e,r:e,className:en(["react-flow__background-pattern","dots",t])})}var Oo;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Oo||(Oo={}));const Jle={[Oo.Dots]:1,[Oo.Lines]:1,[Oo.Cross]:6},Yle=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function X4({id:e,variant:t=Oo.Dots,gap:n=20,size:r,lineWidth:a=1,offset:o=0,color:i,bgColor:s,style:c,className:l,patternClassName:u}){const d=g.useRef(null),{transform:f,patternId:p}=Qe(Yle,Bt),y=r||Jle[t],m=t===Oo.Dots,v=t===Oo.Cross,b=Array.isArray(n)?n:[n,n],w=[b[0]*f[2]||1,b[1]*f[2]||1],_=y*f[2],x=Array.isArray(o)?o:[o,o],j=v?[_,_]:w,S=[x[0]*f[2]||1+j[0]/2,x[1]*f[2]||1+j[1]/2],E=`${p}${e||""}`;return h.jsxs("svg",{className:en(["react-flow__background",l]),style:{...c,...Qh,"--xy-background-color-props":s,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[h.jsx("pattern",{id:E,x:f[0]%w[0],y:f[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`,children:m?h.jsx(Qle,{radius:_/2,className:u}):h.jsx(Gle,{dimensions:j,lineWidth:a,variant:t,className:u})}),h.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E})`})]})}X4.displayName="Background";const eue=g.memo(X4);function tue(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:h.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function nue(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:h.jsx("path",{d:"M0 0h32v4.2H0z"})})}function rue(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:h.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function aue(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function oue(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function tm({children:e,className:t,...n}){return h.jsx("button",{type:"button",className:en(["react-flow__controls-button",t]),...n,children:e})}const iue=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function G4({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:a,onZoomIn:o,onZoomOut:i,onFitView:s,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:f="vertical","aria-label":p="React Flow controls"}){const y=It(),{isInteractive:m,minZoomReached:v,maxZoomReached:b}=Qe(iue,Bt),{zoomIn:w,zoomOut:_,fitView:x}=mr(),j=()=>{w(),o==null||o()},S=()=>{_(),i==null||i()},E=()=>{x(a),s==null||s()},O=()=>{y.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c==null||c(!m)},M=f==="horizontal"?"horizontal":"vertical";return h.jsxs(bc,{className:en(["react-flow__controls",M,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":p,children:[t&&h.jsxs(h.Fragment,{children:[h.jsx(tm,{onClick:j,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b,children:h.jsx(tue,{})}),h.jsx(tm,{onClick:S,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:h.jsx(nue,{})})]}),n&&h.jsx(tm,{className:"react-flow__controls-fitview",onClick:E,title:"fit view","aria-label":"fit view",children:h.jsx(rue,{})}),r&&h.jsx(tm,{className:"react-flow__controls-interactive",onClick:O,title:"toggle interactivity","aria-label":"toggle interactivity",children:m?h.jsx(oue,{}):h.jsx(aue,{})}),u]})}G4.displayName="Controls";const sue=g.memo(G4);function cue({id:e,x:t,y:n,width:r,height:a,style:o,color:i,strokeColor:s,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:f,onClick:p}){const{background:y,backgroundColor:m}=o||{},v=i||y||m;return h.jsx("rect",{className:en(["react-flow__minimap-node",{selected:f},l]),x:t,y:n,rx:u,ry:u,width:r,height:a,style:{fill:v,stroke:s,strokeWidth:c},shapeRendering:d,onClick:p?b=>p(b,e):void 0})}const lue=g.memo(cue),uue=e=>e.nodes.map(t=>t.id),p_=e=>e instanceof Function?e:()=>e;function due({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:a,nodeComponent:o=lue,onClick:i}){const s=Qe(uue,Bt),c=p_(t),l=p_(e),u=p_(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return h.jsx(h.Fragment,{children:s.map(f=>h.jsx(pue,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:a,NodeComponent:o,onClick:i,shapeRendering:d},f))})}function fue({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:a,nodeStrokeWidth:o,shapeRendering:i,NodeComponent:s,onClick:c}){const{node:l,x:u,y:d,width:f,height:p}=Qe(y=>{const m=y.nodeLookup.get(e),{x:v,y:b}=m.internals.positionAbsolute,{width:w,height:_}=So(m);return{node:m,x:v,y:b,width:w,height:_}},Bt);return!l||l.hidden||!m5(l)?null:h.jsx(s,{x:u,y:d,width:f,height:p,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:a,strokeColor:n(l),strokeWidth:o,shapeRendering:i,onClick:c,id:l.id})}const pue=g.memo(fue);var hue=g.memo(due);const mue=200,yue=150,gue=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?f5(od(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},vue="react-flow__minimap-desc";function Q4({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:a="",nodeBorderRadius:o=5,nodeStrokeWidth:i,nodeComponent:s,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:f="bottom-right",onClick:p,onNodeClick:y,pannable:m=!1,zoomable:v=!1,ariaLabel:b="React Flow mini map",inversePan:w,zoomStep:_=10,offsetScale:x=5}){const j=It(),S=g.useRef(null),{boundingRect:E,viewBB:O,rfId:M,panZoom:N,translateExtent:P,flowWidth:R,flowHeight:k}=Qe(gue,Bt),C=(e==null?void 0:e.width)??mue,T=(e==null?void 0:e.height)??yue,A=E.width/C,I=E.height/T,L=Math.max(A,I),D=L*C,B=L*T,F=x*L,$=E.x-(D-E.width)/2-F,V=E.y-(B-E.height)/2-F,G=D+F*2,X=B+F*2,H=`${vue}-${M}`,J=g.useRef(0),Z=g.useRef();J.current=L,g.useEffect(()=>{if(S.current&&N)return Z.current=$se({domNode:S.current,panZoom:N,getTransform:()=>j.getState().transform,getViewScale:()=>J.current}),()=>{var ne;(ne=Z.current)==null||ne.destroy()}},[N]),g.useEffect(()=>{var ne;(ne=Z.current)==null||ne.update({translateExtent:P,width:R,height:k,inversePan:w,pannable:m,zoomStep:_,zoomable:v})},[m,v,w,_,P,R,k]);const U=p?ne=>{var re;const[z,se]=((re=Z.current)==null?void 0:re.pointer(ne))||[0,0];p(ne,{x:z,y:se})}:void 0,Q=y?g.useCallback((ne,z)=>{const se=j.getState().nodeLookup.get(z);y(ne,se)},[]):void 0;return h.jsx(bc,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*L:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:en(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:h.jsxs("svg",{width:C,height:T,viewBox:`${$} ${V} ${G} ${X}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":H,ref:S,onClick:U,children:[b&&h.jsx("title",{id:H,children:b}),h.jsx(hue,{onClick:Q,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:o,nodeClassName:a,nodeStrokeWidth:i,nodeComponent:s}),h.jsx("path",{className:"react-flow__minimap-mask",d:`M${$-F},${V-F}h${G+F*2}v${X+F*2}h${-G-F*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Q4.displayName="MiniMap";const bue=g.memo(Q4);function wue({nodeId:e,position:t,variant:n=vc.Handle,className:r,style:a={},children:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:p,onResize:y,onResizeEnd:m}){const v=f_(),b=typeof e=="string"?e:v,w=It(),_=g.useRef(null),x=n===vc.Line?"right":"bottom-right",j=t??x,S=g.useRef(null);g.useEffect(()=>{if(!(!_.current||!b))return S.current||(S.current=tce({domNode:_.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:N,transform:P,snapGrid:R,snapToGrid:k,nodeOrigin:C,domNode:T}=w.getState();return{nodeLookup:N,transform:P,snapGrid:R,snapToGrid:k,nodeOrigin:C,paneDomNode:T}},onChange:(N,P)=>{const{triggerNodeChanges:R,nodeLookup:k,parentLookup:C,nodeOrigin:T}=w.getState(),A=[],I={x:N.x,y:N.y},L=k.get(b);if(L&&L.expandParent&&L.parentId){const D=L.origin??T,B=N.width??L.measured.width,F=N.height??L.measured.height,$={id:L.id,parentId:L.parentId,rect:{width:B,height:F,...y5({x:N.x??L.position.x,y:N.y??L.position.y},{width:B,height:F},L.parentId,k,D)}},V=n_([$],k,C,T);A.push(...V),I.x=N.x?Math.max(D[0]*B,N.x):void 0,I.y=N.y?Math.max(D[1]*F,N.y):void 0}if(I.x!==void 0&&I.y!==void 0){const D={id:b,type:"position",position:{...I}};A.push(D)}if(N.width!==void 0&&N.height!==void 0){const D={id:b,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:N.width,height:N.height}};A.push(D)}for(const D of P){const B={...D,type:"position"};A.push(B)}R(A)},onEnd:()=>{const N={id:b,type:"dimensions",resizing:!1};w.getState().triggerNodeChanges([N])}})),S.current.update({controlPosition:j,boundaries:{minWidth:s,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,onResizeStart:p,onResize:y,onResizeEnd:m,shouldResize:f}),()=>{var N;(N=S.current)==null||N.destroy()}},[j,s,c,l,u,d,p,y,m,f]);const E=j.split("-"),O=n===vc.Line?"borderColor":"backgroundColor",M=i?{...a,[O]:i}:a;return h.jsx("div",{className:en(["react-flow__resize-control","nodrag",...E,n,r]),ref:_,style:M,children:o})}const J4=g.memo(wue);function xue({nodeId:e,isVisible:t=!0,handleClassName:n,handleStyle:r,lineClassName:a,lineStyle:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:p,onResize:y,onResizeEnd:m}){return t?h.jsxs(h.Fragment,{children:[Kse.map(v=>h.jsx(J4,{className:a,style:o,nodeId:e,position:v,variant:vc.Line,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:p,keepAspectRatio:d,shouldResize:f,onResize:y,onResizeEnd:m},v)),Zse.map(v=>h.jsx(J4,{className:n,style:r,nodeId:e,position:v,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:p,keepAspectRatio:d,shouldResize:f,onResize:y,onResizeEnd:m},v))]}):null}var h_,Y4;function _ue(){if(Y4)return h_;Y4=1;var e=function(b){return t(b)&&!n(b)};function t(b){return!!b&&typeof b=="object"}function n(b){var w=Object.prototype.toString.call(b);return w==="[object RegExp]"||w==="[object Date]"||o(b)}var r=typeof Symbol=="function"&&Symbol.for,a=r?Symbol.for("react.element"):60103;function o(b){return b.$$typeof===a}function i(b){return Array.isArray(b)?[]:{}}function s(b,w){return w.clone!==!1&&w.isMergeableObject(b)?m(i(b),b,w):b}function c(b,w,_){return b.concat(w).map(function(x){return s(x,_)})}function l(b,w){if(!w.customMerge)return m;var _=w.customMerge(b);return typeof _=="function"?_:m}function u(b){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(b).filter(function(w){return Object.propertyIsEnumerable.call(b,w)}):[]}function d(b){return Object.keys(b).concat(u(b))}function f(b,w){try{return w in b}catch{return!1}}function p(b,w){return f(b,w)&&!(Object.hasOwnProperty.call(b,w)&&Object.propertyIsEnumerable.call(b,w))}function y(b,w,_){var x={};return _.isMergeableObject(b)&&d(b).forEach(function(j){x[j]=s(b[j],_)}),d(w).forEach(function(j){p(b,j)||(f(b,j)&&_.isMergeableObject(w[j])?x[j]=l(j,_)(b[j],w[j],_):x[j]=s(w[j],_))}),x}function m(b,w,_){_=_||{},_.arrayMerge=_.arrayMerge||c,_.isMergeableObject=_.isMergeableObject||e,_.cloneUnlessOtherwiseSpecified=s;var x=Array.isArray(w),j=Array.isArray(b),S=x===j;return S?x?_.arrayMerge(b,w,_):y(b,w,_):s(w,_)}m.all=function(b,w){if(!Array.isArray(b))throw new Error("first argument should be an array");return b.reduce(function(_,x){return m(_,x,w)},{})};var v=m;return h_=v,h_}var jue=_ue();const nm=ot(jue);var eL={},tL;function Sue(){if(tL)return eL;tL=1;var e;return function(t){(function(n){var r=typeof globalThis=="object"?globalThis:typeof Ul=="object"?Ul:typeof self=="object"?self:typeof this=="object"?this:c(),a=o(t);typeof r.Reflect<"u"&&(a=o(r.Reflect,a)),n(a,r),typeof r.Reflect>"u"&&(r.Reflect=t);function o(l,u){return function(d,f){Object.defineProperty(l,d,{configurable:!0,writable:!0,value:f}),u&&u(d,f)}}function i(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function c(){return i()||s()}})(function(n,r){var a=Object.prototype.hasOwnProperty,o=typeof Symbol=="function",i=o&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=o&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,u=!c&&!l,d={create:c?function(){return Xa(Object.create(null))}:l?function(){return Xa({__proto__:null})}:function(){return Xa({})},has:u?function(Y,te){return a.call(Y,te)}:function(Y,te){return te in Y},get:u?function(Y,te){return a.call(Y,te)?Y[te]:void 0}:function(Y,te){return Y[te]}},f=Object.getPrototypeOf(Function),p=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:nr(),y=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Ka(),m=typeof WeakMap=="function"?WeakMap:rr(),v=o?Symbol.for("@reflect-metadata:registry"):void 0,b=st(),w=rt(b);function _(Y,te,ce,me){if(V(ce)){if(!z(Y))throw new TypeError;if(!re(te))throw new TypeError;return k(Y,te)}else{if(!z(Y))throw new TypeError;if(!H(te))throw new TypeError;if(!H(me)&&!V(me)&&!G(me))throw new TypeError;return G(me)&&(me=void 0),ce=ne(ce),C(Y,te,ce,me)}}n("decorate",_);function x(Y,te){function ce(me,Te){if(!H(me))throw new TypeError;if(!V(Te)&&!ue(Te))throw new TypeError;D(Y,te,me,Te)}return ce}n("metadata",x);function j(Y,te,ce,me){if(!H(ce))throw new TypeError;return V(me)||(me=ne(me)),D(Y,te,ce,me)}n("defineMetadata",j);function S(Y,te,ce){if(!H(te))throw new TypeError;return V(ce)||(ce=ne(ce)),T(Y,te,ce)}n("hasMetadata",S);function E(Y,te,ce){if(!H(te))throw new TypeError;return V(ce)||(ce=ne(ce)),A(Y,te,ce)}n("hasOwnMetadata",E);function O(Y,te,ce){if(!H(te))throw new TypeError;return V(ce)||(ce=ne(ce)),I(Y,te,ce)}n("getMetadata",O);function M(Y,te,ce){if(!H(te))throw new TypeError;return V(ce)||(ce=ne(ce)),L(Y,te,ce)}n("getOwnMetadata",M);function N(Y,te){if(!H(Y))throw new TypeError;return V(te)||(te=ne(te)),B(Y,te)}n("getMetadataKeys",N);function P(Y,te){if(!H(Y))throw new TypeError;return V(te)||(te=ne(te)),F(Y,te)}n("getOwnMetadataKeys",P);function R(Y,te,ce){if(!H(te))throw new TypeError;if(V(ce)||(ce=ne(ce)),!H(te))throw new TypeError;V(ce)||(ce=ne(ce));var me=Xt(te,ce,!1);return V(me)?!1:me.OrdinaryDeleteMetadata(Y,te,ce)}n("deleteMetadata",R);function k(Y,te){for(var ce=Y.length-1;ce>=0;--ce){var me=Y[ce],Te=me(te);if(!V(Te)&&!G(Te)){if(!re(Te))throw new TypeError;te=Te}}return te}function C(Y,te,ce,me){for(var Te=Y.length-1;Te>=0;--Te){var Ht=Y[Te],$t=Ht(te,ce,me);if(!V($t)&&!G($t)){if(!H($t))throw new TypeError;me=$t}}return me}function T(Y,te,ce){var me=A(Y,te,ce);if(me)return!0;var Te=We(te);return G(Te)?!1:T(Y,Te,ce)}function A(Y,te,ce){var me=Xt(te,ce,!1);return V(me)?!1:U(me.OrdinaryHasOwnMetadata(Y,te,ce))}function I(Y,te,ce){var me=A(Y,te,ce);if(me)return L(Y,te,ce);var Te=We(te);if(!G(Te))return I(Y,Te,ce)}function L(Y,te,ce){var me=Xt(te,ce,!1);if(!V(me))return me.OrdinaryGetOwnMetadata(Y,te,ce)}function D(Y,te,ce,me){var Te=Xt(ce,me,!0);Te.OrdinaryDefineOwnMetadata(Y,te,ce,me)}function B(Y,te){var ce=F(Y,te),me=We(Y);if(me===null)return ce;var Te=B(me,te);if(Te.length<=0)return ce;if(ce.length<=0)return Te;for(var Ht=new y,$t=[],Ze=0,be=ce;Ze<be.length;Ze++){var _e=be[Ze],Ee=Ht.has(_e);Ee||(Ht.add(_e),$t.push(_e))}for(var Oe=0,qe=Te;Oe<qe.length;Oe++){var _e=qe[Oe],Ee=Ht.has(_e);Ee||(Ht.add(_e),$t.push(_e))}return $t}function F(Y,te){var ce=Xt(Y,te,!1);return ce?ce.OrdinaryOwnMetadataKeys(Y,te):[]}function $(Y){if(Y===null)return 1;switch(typeof Y){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Y===null?1:6;default:return 6}}function V(Y){return Y===void 0}function G(Y){return Y===null}function X(Y){return typeof Y=="symbol"}function H(Y){return typeof Y=="object"?Y!==null:typeof Y=="function"}function J(Y,te){switch($(Y)){case 0:return Y;case 1:return Y;case 2:return Y;case 3:return Y;case 4:return Y;case 5:return Y}var ce="string",me=Le(Y,i);if(me!==void 0){var Te=me.call(Y,ce);if(H(Te))throw new TypeError;return Te}return Z(Y)}function Z(Y,te){var ce,me;{var Te=Y.toString;if(se(Te)){var me=Te.call(Y);if(!H(me))return me}var ce=Y.valueOf;if(se(ce)){var me=ce.call(Y);if(!H(me))return me}}throw new TypeError}function U(Y){return!!Y}function Q(Y){return""+Y}function ne(Y){var te=J(Y);return X(te)?te:Q(te)}function z(Y){return Array.isArray?Array.isArray(Y):Y instanceof Object?Y instanceof Array:Object.prototype.toString.call(Y)==="[object Array]"}function se(Y){return typeof Y=="function"}function re(Y){return typeof Y=="function"}function ue(Y){switch($(Y)){case 3:return!0;case 4:return!0;default:return!1}}function je(Y,te){return Y===te||Y!==Y&&te!==te}function Le(Y,te){var ce=Y[te];if(ce!=null){if(!se(ce))throw new TypeError;return ce}}function $e(Y){var te=Le(Y,s);if(!se(te))throw new TypeError;var ce=te.call(Y);if(!H(ce))throw new TypeError;return ce}function Se(Y){return Y.value}function Ve(Y){var te=Y.next();return te.done?!1:te}function Ue(Y){var te=Y.return;te&&te.call(Y)}function We(Y){var te=Object.getPrototypeOf(Y);if(typeof Y!="function"||Y===f||te!==f)return te;var ce=Y.prototype,me=ce&&Object.getPrototypeOf(ce);if(me==null||me===Object.prototype)return te;var Te=me.constructor;return typeof Te!="function"||Te===Y?te:Te}function At(){var Y;!V(v)&&typeof r.Reflect<"u"&&!(v in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(Y=wt(r.Reflect));var te,ce,me,Te=new m,Ht={registerProvider:$t,getProvider:be,setProvider:Ee};return Ht;function $t(Oe){if(!Object.isExtensible(Ht))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Y===Oe:break;case V(te):te=Oe;break;case te===Oe:break;case V(ce):ce=Oe;break;case ce===Oe:break;default:me===void 0&&(me=new y),me.add(Oe);break}}function Ze(Oe,qe){if(!V(te)){if(te.isProviderFor(Oe,qe))return te;if(!V(ce)){if(ce.isProviderFor(Oe,qe))return te;if(!V(me))for(var Ot=$e(me);;){var Vt=Ve(Ot);if(!Vt)return;var q=Se(Vt);if(q.isProviderFor(Oe,qe))return Ue(Ot),q}}}if(!V(Y)&&Y.isProviderFor(Oe,qe))return Y}function be(Oe,qe){var Ot=Te.get(Oe),Vt;return V(Ot)||(Vt=Ot.get(qe)),V(Vt)&&(Vt=Ze(Oe,qe),V(Vt)||(V(Ot)&&(Ot=new p,Te.set(Oe,Ot)),Ot.set(qe,Vt))),Vt}function _e(Oe){if(V(Oe))throw new TypeError;return te===Oe||ce===Oe||!V(me)&&me.has(Oe)}function Ee(Oe,qe,Ot){if(!_e(Ot))throw new Error("Metadata provider not registered.");var Vt=be(Oe,qe);if(Vt!==Ot){if(!V(Vt))return!1;var q=Te.get(Oe);V(q)&&(q=new p,Te.set(Oe,q)),q.set(qe,Ot)}return!0}}function st(){var Y;return!V(v)&&H(r.Reflect)&&Object.isExtensible(r.Reflect)&&(Y=r.Reflect[v]),V(Y)&&(Y=At()),!V(v)&&H(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,v,{enumerable:!1,configurable:!1,writable:!1,value:Y}),Y}function rt(Y){var te=new m,ce={isProviderFor:function(_e,Ee){var Oe=te.get(_e);return V(Oe)?!1:Oe.has(Ee)},OrdinaryDefineOwnMetadata:$t,OrdinaryHasOwnMetadata:Te,OrdinaryGetOwnMetadata:Ht,OrdinaryOwnMetadataKeys:Ze,OrdinaryDeleteMetadata:be};return b.registerProvider(ce),ce;function me(_e,Ee,Oe){var qe=te.get(_e),Ot=!1;if(V(qe)){if(!Oe)return;qe=new p,te.set(_e,qe),Ot=!0}var Vt=qe.get(Ee);if(V(Vt)){if(!Oe)return;if(Vt=new p,qe.set(Ee,Vt),!Y.setProvider(_e,Ee,ce))throw qe.delete(Ee),Ot&&te.delete(_e),new Error("Wrong provider for target.")}return Vt}function Te(_e,Ee,Oe){var qe=me(Ee,Oe,!1);return V(qe)?!1:U(qe.has(_e))}function Ht(_e,Ee,Oe){var qe=me(Ee,Oe,!1);if(!V(qe))return qe.get(_e)}function $t(_e,Ee,Oe,qe){var Ot=me(Oe,qe,!0);Ot.set(_e,Ee)}function Ze(_e,Ee){var Oe=[],qe=me(_e,Ee,!1);if(V(qe))return Oe;for(var Ot=qe.keys(),Vt=$e(Ot),q=0;;){var ee=Ve(Vt);if(!ee)return Oe.length=q,Oe;var ae=Se(ee);try{Oe[q]=ae}catch(pe){try{Ue(Vt)}finally{throw pe}}q++}}function be(_e,Ee,Oe){var qe=me(Ee,Oe,!1);if(V(qe)||!qe.delete(_e))return!1;if(qe.size===0){var Ot=te.get(Ee);V(Ot)||(Ot.delete(Oe),Ot.size===0&&te.delete(Ot))}return!0}}function wt(Y){var te=Y.defineMetadata,ce=Y.hasOwnMetadata,me=Y.getOwnMetadata,Te=Y.getOwnMetadataKeys,Ht=Y.deleteMetadata,$t=new m,Ze={isProviderFor:function(be,_e){var Ee=$t.get(be);return!V(Ee)&&Ee.has(_e)?!0:Te(be,_e).length?(V(Ee)&&(Ee=new y,$t.set(be,Ee)),Ee.add(_e),!0):!1},OrdinaryDefineOwnMetadata:te,OrdinaryHasOwnMetadata:ce,OrdinaryGetOwnMetadata:me,OrdinaryOwnMetadataKeys:Te,OrdinaryDeleteMetadata:Ht};return Ze}function Xt(Y,te,ce){var me=b.getProvider(Y,te);if(!V(me))return me;if(ce){if(b.setProvider(Y,te,w))return w;throw new Error("Illegal state.")}}function nr(){var Y={},te=[],ce=function(){function Ze(be,_e,Ee){this._index=0,this._keys=be,this._values=_e,this._selector=Ee}return Ze.prototype["@@iterator"]=function(){return this},Ze.prototype[s]=function(){return this},Ze.prototype.next=function(){var be=this._index;if(be>=0&&be<this._keys.length){var _e=this._selector(this._keys[be],this._values[be]);return be+1>=this._keys.length?(this._index=-1,this._keys=te,this._values=te):this._index++,{value:_e,done:!1}}return{value:void 0,done:!0}},Ze.prototype.throw=function(be){throw this._index>=0&&(this._index=-1,this._keys=te,this._values=te),be},Ze.prototype.return=function(be){return this._index>=0&&(this._index=-1,this._keys=te,this._values=te),{value:be,done:!0}},Ze}(),me=function(){function Ze(){this._keys=[],this._values=[],this._cacheKey=Y,this._cacheIndex=-2}return Object.defineProperty(Ze.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Ze.prototype.has=function(be){return this._find(be,!1)>=0},Ze.prototype.get=function(be){var _e=this._find(be,!1);return _e>=0?this._values[_e]:void 0},Ze.prototype.set=function(be,_e){var Ee=this._find(be,!0);return this._values[Ee]=_e,this},Ze.prototype.delete=function(be){var _e=this._find(be,!1);if(_e>=0){for(var Ee=this._keys.length,Oe=_e+1;Oe<Ee;Oe++)this._keys[Oe-1]=this._keys[Oe],this._values[Oe-1]=this._values[Oe];return this._keys.length--,this._values.length--,je(be,this._cacheKey)&&(this._cacheKey=Y,this._cacheIndex=-2),!0}return!1},Ze.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Y,this._cacheIndex=-2},Ze.prototype.keys=function(){return new ce(this._keys,this._values,Te)},Ze.prototype.values=function(){return new ce(this._keys,this._values,Ht)},Ze.prototype.entries=function(){return new ce(this._keys,this._values,$t)},Ze.prototype["@@iterator"]=function(){return this.entries()},Ze.prototype[s]=function(){return this.entries()},Ze.prototype._find=function(be,_e){if(!je(this._cacheKey,be)){this._cacheIndex=-1;for(var Ee=0;Ee<this._keys.length;Ee++)if(je(this._keys[Ee],be)){this._cacheIndex=Ee;break}}return this._cacheIndex<0&&_e&&(this._cacheIndex=this._keys.length,this._keys.push(be),this._values.push(void 0)),this._cacheIndex},Ze}();return me;function Te(Ze,be){return Ze}function Ht(Ze,be){return be}function $t(Ze,be){return[Ze,be]}}function Ka(){var Y=function(){function te(){this._map=new p}return Object.defineProperty(te.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),te.prototype.has=function(ce){return this._map.has(ce)},te.prototype.add=function(ce){return this._map.set(ce,ce),this},te.prototype.delete=function(ce){return this._map.delete(ce)},te.prototype.clear=function(){this._map.clear()},te.prototype.keys=function(){return this._map.keys()},te.prototype.values=function(){return this._map.keys()},te.prototype.entries=function(){return this._map.entries()},te.prototype["@@iterator"]=function(){return this.keys()},te.prototype[s]=function(){return this.keys()},te}();return Y}function rr(){var Y=16,te=d.create(),ce=me();return function(){function be(){this._key=me()}return be.prototype.has=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?d.has(Ee,this._key):!1},be.prototype.get=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?d.get(Ee,this._key):void 0},be.prototype.set=function(_e,Ee){var Oe=Te(_e,!0);return Oe[this._key]=Ee,this},be.prototype.delete=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?delete Ee[this._key]:!1},be.prototype.clear=function(){this._key=me()},be}();function me(){var be;do be="@@WeakMap@@"+Ze();while(d.has(te,be));return te[be]=!0,be}function Te(be,_e){if(!a.call(be,ce)){if(!_e)return;Object.defineProperty(be,ce,{value:d.create()})}return be[ce]}function Ht(be,_e){for(var Ee=0;Ee<_e;++Ee)be[Ee]=Math.random()*255|0;return be}function $t(be){if(typeof Uint8Array=="function"){var _e=new Uint8Array(be);return typeof crypto<"u"?crypto.getRandomValues(_e):typeof msCrypto<"u"?msCrypto.getRandomValues(_e):Ht(_e,be),_e}return Ht(new Array(be),be)}function Ze(){var be=$t(Y);be[6]=be[6]&79|64,be[8]=be[8]&191|128;for(var _e="",Ee=0;Ee<Y;++Ee){var Oe=be[Ee];(Ee===4||Ee===6||Ee===8)&&(_e+="-"),Oe<16&&(_e+="0"),_e+=Oe.toString(16).toLowerCase()}return _e}}function Xa(Y){return Y.__=void 0,delete Y.__,Y}})}(e||(e={})),eL}Sue(),typeof window<"u"&&(window.Buffer=KTe),typeof sv<"u"&&typeof require<"u"&&(sv.Buffer=require("buffer/").Buffer);class tn{static isObject(t){return t!==null&&typeof t=="object"}static isObjectWithName(t){return t!==null&&typeof t=="object"&&t.name!==void 0}static assign(t,...n){for(const r of n)for(const a of Object.getOwnPropertyNames(r))t[a]=r[a]}static mixedListToArray(t){return t!==null&&typeof t=="object"?Object.keys(t).map(n=>t[n]):t}}class xe extends Error{get name(){return this.constructor.name}constructor(t){super(t),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class xc extends xe{constructor(){super("Locking not supported on given driver.")}}class m_ extends xe{constructor(){super('Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')}}class Pt{static isMssqlParameter(t){return this.check(t,"MssqlParameter")}static isEntityMetadata(t){return this.check(t,"EntityMetadata")}static isColumnMetadata(t){return this.check(t,"ColumnMetadata")}static isSelectQueryBuilder(t){return this.check(t,"SelectQueryBuilder")}static isInsertQueryBuilder(t){return this.check(t,"InsertQueryBuilder")}static isDeleteQueryBuilder(t){return this.check(t,"DeleteQueryBuilder")}static isUpdateQueryBuilder(t){return this.check(t,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(t){return this.check(t,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(t){return this.check(t,"RelationQueryBuilder")}static isBrackets(t){return this.check(t,"Brackets")||this.check(t,"NotBrackets")}static isNotBrackets(t){return this.check(t,"NotBrackets")}static isSubject(t){return this.check(t,"Subject")}static isRdbmsSchemaBuilder(t){return this.check(t,"RdbmsSchemaBuilder")}static isMongoEntityManager(t){return this.check(t,"MongoEntityManager")}static isSqljsEntityManager(t){return this.check(t,"SqljsEntityManager")}static isEntitySchema(t){return this.check(t,"EntitySchema")}static isBaseEntityConstructor(t){return typeof t=="function"&&typeof t.hasId=="function"&&typeof t.save=="function"&&typeof t.useDataSource=="function"}static isFindOperator(t){return this.check(t,"FindOperator")||this.check(t,"EqualOperator")}static isEqualOperator(t){return this.check(t,"EqualOperator")}static isQuery(t){return this.check(t,"Query")}static isTable(t){return this.check(t,"Table")}static isTableCheck(t){return this.check(t,"TableCheck")}static isTableColumn(t){return this.check(t,"TableColumn")}static isTableExclusion(t){return this.check(t,"TableExclusion")}static isTableForeignKey(t){return this.check(t,"TableForeignKey")}static isTableIndex(t){return this.check(t,"TableIndex")}static isTableUnique(t){return this.check(t,"TableUnique")}static isView(t){return this.check(t,"View")}static isDataSource(t){return this.check(t,"DataSource")}static check(t,n){return typeof t=="object"&&t!==null&&t["@instanceof"]===Symbol.for(n)}}class Eue extends xe{constructor(t,n){super(),this.entityClass=t,this.criteria=n,this.message=`Could not find any entity of type "${this.stringifyTarget(t)}" matching: ${this.stringifyCriteria(n)}`}stringifyTarget(t){return Pt.isEntitySchema(t)?t.options.name:typeof t=="function"||tn.isObject(t)&&"name"in t?t.name:t}stringifyCriteria(t){try{return JSON.stringify(t,null,4)}catch{}return""+t}}class nL extends xe{constructor(t,n,r){super(`The optimistic lock on entity ${t} failed, version ${n} was expected, but is actually ${r}.`)}}class rL extends xe{constructor(){super("Your database does not support LIMIT on UPDATE statements.")}}class Oue extends xe{constructor(t){super(`Entity "${t.name}" does not have delete date columns.`)}}class rm extends xe{constructor(){super("OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL or MariaDB databases.")}}class Ra extends xe{constructor(t,n){super(t),Object.setPrototypeOf(this,Ra.prototype),this.message=`Property "${t}" was not found in "${n.targetName}". Make sure your query is correct.`}}class Cue extends xe{constructor(t){super(`Entity ${t} does not have version or update date columns.`)}}class Nue extends xe{constructor(){super('Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')}}class pd extends xe{constructor(){super("The optimistic lock can be used only with getOne() method.")}}class Mue extends xe{constructor(t){super(),t.length===1?this.message=`Relation "${t[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${t.map(n=>`"${n}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class Pue extends xe{constructor(){super("An open transaction is required for pessimistic lock.")}}class kue extends xe{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class aL{constructor(t){tn.assign(this,t||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(t){this._metadata=t}get metadata(){if(!this._metadata)throw new xe(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class Ia{static isAliasProperty(t){if(typeof t!="string"||t.indexOf(".")===-1)return!1;const[n,r]=t.split(".");return!(!n||!r||t.indexOf("(")!==-1||t.indexOf(")")!==-1)}}var y_={exports:{}},g_={exports:{}},oL;function _c(){return oL||(oL=1,typeof Object.create=="function"?g_.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:g_.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),g_.exports}var v_={exports:{}},iL;function es(){return iL||(iL=1,function(e,t){var n=XTe(),r=n.Buffer;function a(i,s){for(var c in i)s[c]=i[c]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o);function o(i,s,c){return r(i,s,c)}o.prototype=Object.create(r.prototype),a(r,o),o.from=function(i,s,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return r(i,s,c)},o.alloc=function(i,s,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var l=r(i);return s!==void 0?typeof c=="string"?l.fill(s,c):l.fill(s):l.fill(0),l},o.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r(i)},o.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(i)}}(v_,v_.exports)),v_.exports}var b_,sL;function jc(){if(sL)return b_;sL=1;var e=es().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var a=this._block,o=this._blockSize,i=n.length,s=this._len,c=0;c<i;){for(var l=s%o,u=Math.min(i-c,o-l),d=0;d<u;d++)a[l+d]=n[c+d];s+=u,c+=u,s%o===0&&this._update(a)}return this._len+=i,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var o=(a&4294967295)>>>0,i=(a-o)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(o,this._blockSize-4)}this._update(this._block);var s=this._hash();return n?s.toString(n):s},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},b_=t,b_}var w_,cL;function Aue(){if(cL)return w_;cL=1;var e=_c(),t=jc(),n=es().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(l){return l<<5|l>>>27}function s(l){return l<<30|l>>>2}function c(l,u,d,f){return l===0?u&d|~u&f:l===2?u&d|u&f|d&f:u^d^f}return o.prototype._update=function(l){for(var u=this._w,d=this._a|0,f=this._b|0,p=this._c|0,y=this._d|0,m=this._e|0,v=0;v<16;++v)u[v]=l.readInt32BE(v*4);for(;v<80;++v)u[v]=u[v-3]^u[v-8]^u[v-14]^u[v-16];for(var b=0;b<80;++b){var w=~~(b/20),_=i(d)+c(w,f,p,y)+m+u[b]+r[w]|0;m=y,y=p,p=s(f),f=d,d=_}this._a=d+this._a|0,this._b=f+this._b|0,this._c=p+this._c|0,this._d=y+this._d|0,this._e=m+this._e|0},o.prototype._hash=function(){var l=n.allocUnsafe(20);return l.writeInt32BE(this._a|0,0),l.writeInt32BE(this._b|0,4),l.writeInt32BE(this._c|0,8),l.writeInt32BE(this._d|0,12),l.writeInt32BE(this._e|0,16),l},w_=o,w_}var x_,lL;function Tue(){if(lL)return x_;lL=1;var e=_c(),t=jc(),n=es().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(u){return u<<1|u>>>31}function s(u){return u<<5|u>>>27}function c(u){return u<<30|u>>>2}function l(u,d,f,p){return u===0?d&f|~d&p:u===2?d&f|d&p|f&p:d^f^p}return o.prototype._update=function(u){for(var d=this._w,f=this._a|0,p=this._b|0,y=this._c|0,m=this._d|0,v=this._e|0,b=0;b<16;++b)d[b]=u.readInt32BE(b*4);for(;b<80;++b)d[b]=i(d[b-3]^d[b-8]^d[b-14]^d[b-16]);for(var w=0;w<80;++w){var _=~~(w/20),x=s(f)+l(_,p,y,m)+v+d[w]+r[_]|0;v=m,m=y,y=c(p),p=f,f=x}this._a=f+this._a|0,this._b=p+this._b|0,this._c=y+this._c|0,this._d=m+this._d|0,this._e=v+this._e|0},o.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},x_=o,x_}var __,uL;function dL(){if(uL)return __;uL=1;var e=_c(),t=jc(),n=es().Buffer,r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function i(f,p,y){return y^f&(p^y)}function s(f,p,y){return f&p|y&(f|p)}function c(f){return(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10)}function l(f){return(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7)}function u(f){return(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3}function d(f){return(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10}return o.prototype._update=function(f){for(var p=this._w,y=this._a|0,m=this._b|0,v=this._c|0,b=this._d|0,w=this._e|0,_=this._f|0,x=this._g|0,j=this._h|0,S=0;S<16;++S)p[S]=f.readInt32BE(S*4);for(;S<64;++S)p[S]=d(p[S-2])+p[S-7]+u(p[S-15])+p[S-16]|0;for(var E=0;E<64;++E){var O=j+l(w)+i(w,_,x)+r[E]+p[E]|0,M=c(y)+s(y,m,v)|0;j=x,x=_,_=w,w=b+O|0,b=v,v=m,m=y,y=O+M|0}this._a=y+this._a|0,this._b=m+this._b|0,this._c=v+this._c|0,this._d=b+this._d|0,this._e=w+this._e|0,this._f=_+this._f|0,this._g=x+this._g|0,this._h=j+this._h|0},o.prototype._hash=function(){var f=n.allocUnsafe(32);return f.writeInt32BE(this._a,0),f.writeInt32BE(this._b,4),f.writeInt32BE(this._c,8),f.writeInt32BE(this._d,12),f.writeInt32BE(this._e,16),f.writeInt32BE(this._f,20),f.writeInt32BE(this._g,24),f.writeInt32BE(this._h,28),f},__=o,__}var j_,fL;function Rue(){if(fL)return j_;fL=1;var e=_c(),t=dL(),n=jc(),r=es().Buffer,a=new Array(64);function o(){this.init(),this._w=a,n.call(this,64,56)}return e(o,t),o.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(28);return i.writeInt32BE(this._a,0),i.writeInt32BE(this._b,4),i.writeInt32BE(this._c,8),i.writeInt32BE(this._d,12),i.writeInt32BE(this._e,16),i.writeInt32BE(this._f,20),i.writeInt32BE(this._g,24),i},j_=o,j_}var S_,pL;function hL(){if(pL)return S_;pL=1;var e=_c(),t=jc(),n=es().Buffer,r=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function o(){this.init(),this._w=a,t.call(this,128,112)}e(o,t),o.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function i(m,v,b){return b^m&(v^b)}function s(m,v,b){return m&v|b&(m|v)}function c(m,v){return(m>>>28|v<<4)^(v>>>2|m<<30)^(v>>>7|m<<25)}function l(m,v){return(m>>>14|v<<18)^(m>>>18|v<<14)^(v>>>9|m<<23)}function u(m,v){return(m>>>1|v<<31)^(m>>>8|v<<24)^m>>>7}function d(m,v){return(m>>>1|v<<31)^(m>>>8|v<<24)^(m>>>7|v<<25)}function f(m,v){return(m>>>19|v<<13)^(v>>>29|m<<3)^m>>>6}function p(m,v){return(m>>>19|v<<13)^(v>>>29|m<<3)^(m>>>6|v<<26)}function y(m,v){return m>>>0<v>>>0?1:0}return o.prototype._update=function(m){for(var v=this._w,b=this._ah|0,w=this._bh|0,_=this._ch|0,x=this._dh|0,j=this._eh|0,S=this._fh|0,E=this._gh|0,O=this._hh|0,M=this._al|0,N=this._bl|0,P=this._cl|0,R=this._dl|0,k=this._el|0,C=this._fl|0,T=this._gl|0,A=this._hl|0,I=0;I<32;I+=2)v[I]=m.readInt32BE(I*4),v[I+1]=m.readInt32BE(I*4+4);for(;I<160;I+=2){var L=v[I-30],D=v[I-15*2+1],B=u(L,D),F=d(D,L);L=v[I-2*2],D=v[I-2*2+1];var $=f(L,D),V=p(D,L),G=v[I-7*2],X=v[I-7*2+1],H=v[I-16*2],J=v[I-16*2+1],Z=F+X|0,U=B+G+y(Z,F)|0;Z=Z+V|0,U=U+$+y(Z,V)|0,Z=Z+J|0,U=U+H+y(Z,J)|0,v[I]=U,v[I+1]=Z}for(var Q=0;Q<160;Q+=2){U=v[Q],Z=v[Q+1];var ne=s(b,w,_),z=s(M,N,P),se=c(b,M),re=c(M,b),ue=l(j,k),je=l(k,j),Le=r[Q],$e=r[Q+1],Se=i(j,S,E),Ve=i(k,C,T),Ue=A+je|0,We=O+ue+y(Ue,A)|0;Ue=Ue+Ve|0,We=We+Se+y(Ue,Ve)|0,Ue=Ue+$e|0,We=We+Le+y(Ue,$e)|0,Ue=Ue+Z|0,We=We+U+y(Ue,Z)|0;var At=re+z|0,st=se+ne+y(At,re)|0;O=E,A=T,E=S,T=C,S=j,C=k,k=R+Ue|0,j=x+We+y(k,R)|0,x=_,R=P,_=w,P=N,w=b,N=M,M=Ue+At|0,b=We+st+y(M,Ue)|0}this._al=this._al+M|0,this._bl=this._bl+N|0,this._cl=this._cl+P|0,this._dl=this._dl+R|0,this._el=this._el+k|0,this._fl=this._fl+C|0,this._gl=this._gl+T|0,this._hl=this._hl+A|0,this._ah=this._ah+b+y(this._al,M)|0,this._bh=this._bh+w+y(this._bl,N)|0,this._ch=this._ch+_+y(this._cl,P)|0,this._dh=this._dh+x+y(this._dl,R)|0,this._eh=this._eh+j+y(this._el,k)|0,this._fh=this._fh+S+y(this._fl,C)|0,this._gh=this._gh+E+y(this._gl,T)|0,this._hh=this._hh+O+y(this._hl,A)|0},o.prototype._hash=function(){var m=n.allocUnsafe(64);function v(b,w,_){m.writeInt32BE(b,_),m.writeInt32BE(w,_+4)}return v(this._ah,this._al,0),v(this._bh,this._bl,8),v(this._ch,this._cl,16),v(this._dh,this._dl,24),v(this._eh,this._el,32),v(this._fh,this._fl,40),v(this._gh,this._gl,48),v(this._hh,this._hl,56),m},S_=o,S_}var E_,mL;function Iue(){if(mL)return E_;mL=1;var e=_c(),t=hL(),n=jc(),r=es().Buffer,a=new Array(160);function o(){this.init(),this._w=a,n.call(this,128,112)}return e(o,t),o.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(48);function s(c,l,u){i.writeInt32BE(c,u),i.writeInt32BE(l,u+4)}return s(this._ah,this._al,0),s(this._bh,this._bl,8),s(this._ch,this._cl,16),s(this._dh,this._dl,24),s(this._eh,this._el,32),s(this._fh,this._fl,40),i},E_=o,E_}var yL;function Due(){if(yL)return y_.exports;yL=1;var e=y_.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n};return e.sha=Aue(),e.sha1=Tue(),e.sha224=Rue(),e.sha256=dL(),e.sha384=Iue(),e.sha512=hL(),y_.exports}var Lue=Due();const $ue=ot(Lue);function Fue(e,t={}){const{segmentLength:n=4,separator:r="__",termLength:a=2}=t;return e.split(r).reduce((o,i)=>{const s=i.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),c=s.length>1?a:n,l=s.map(u=>u.substr(0,c)).join("");return o.push(l),o},[]).join(r)}function Bue(e,t={}){const n=$ue("sha1");n.update(e,"utf8");const r=n.digest("hex");return t.length?r.slice(0,t.length):r}class zue{static isGreaterOrEqual(t,n){const r=gL(t),a=gL(n);return r[0]>a[0]||r[0]===a[0]&&r[1]>a[1]||r[0]===a[0]&&r[1]===a[1]&&r[2]>=a[2]}}function gL(e=""){const t=[0,0,0];return e.split(".").forEach((n,r)=>t[r]=parseInt(n,10)),t}class ve{static isSQLiteFamily(t){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(t.options.type)}static isMySQLFamily(t){return["mysql","mariadb"].includes(t.options.type)}static isReleaseVersionOrGreater(t,n){return t.version!=null&&zue.isGreaterOrEqual(t.version,n)}static isPostgresFamily(t){return["postgres","aurora-postgres","cockroachdb"].includes(t.options.type)}static buildDriverOptions(t,n){if(t.url){const r=this.parseConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildMongoDBDriverOptions(t,n){if(t.url){const r=this.parseMongoDBConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildAlias({maxAliasLength:t},n,...r){const a=n&&n.joiner?n.joiner:"_";let o=r.length===1?r[0]:r.join(a);if(t&&t>0&&o.length>t){if(n&&n.shorten===!0){const i=Fue(o);if(i.length<t)return i}return Bue(o,{length:t})}return o}static buildColumnAlias({maxAliasLength:t},n,...r){return typeof n=="string"?(r.unshift(n),n={shorten:!1,joiner:"_"}):n=Object.assign({shorten:!1,joiner:"_"},n),this.buildAlias({maxAliasLength:t},n,...r)}static parseConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0;s&&s.indexOf("?")!==-1&&(s=s.substr(0,s.indexOf("?")));const c=i.lastIndexOf("@"),l=i.substr(0,c),u=i.substr(c+1);let d=l,f="";const p=l.indexOf(":");p!==-1&&(d=l.substr(0,p),f=l.substr(p+1));const[y,m]=u.split(":");return{type:n,host:y,username:decodeURIComponent(d),password:decodeURIComponent(f),port:m?parseInt(m):void 0,database:s||void 0}}static parseMongoDBConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0,c="",l,u,d,f,p={};if(s&&s.indexOf("?")!==-1){c=s.substr(s.indexOf("?")+1,s.length);const j=c.split("&");let S,E;j.forEach(O=>{S=O.split("=")[0],E=O.split("=")[1],p[S]=E}),f=p.replicaSet,s=s.substr(0,s.indexOf("?"))}const y=i.lastIndexOf("@"),m=i.substr(0,y),v=i.substr(y+1);let b=m,w="";const _=m.indexOf(":");_!==-1&&(b=m.substr(0,_),w=m.substr(_+1)),f?d=v:[l,u]=v.split(":");let x={type:n,host:l,hostReplicaSet:d,username:decodeURIComponent(b),password:decodeURIComponent(w),port:u?parseInt(u):void 0,database:s||void 0};for(const[j,S]of Object.entries(p))x[j]=S;return x}}class vL{constructor(t,n,r){this.connection=t,this.queryExpressionMap=n,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,r&&tn.assign(this,r)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){let t=()=>{for(const n of this.queryExpressionMap.selects)if(n.selection===this.alias.name||this.metadata&&this.metadata.columns.find(r=>n.selection===this.alias.name+"."+r.propertyPath))return!0;return!1};this.isSelectedCache=t(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(Ia.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(Ia.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let t=()=>{if(!Ia.isAliasProperty(this.entityOrProperty))return;const n=this.queryExpressionMap.findAliasByName(this.parentAlias);let r=n.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(r||n.metadata.parentEntityMetadata&&(r=n.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),r))return r;throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=t.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new xe("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new xe("Junction property is not defined.");const t=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?ve.buildAlias(this.connection.driver,void 0,t,this.alias.name):ve.buildAlias(this.connection.driver,void 0,this.alias.name,t)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class O_{constructor(t,n){this.queryExpressionMap=t,this.disableMixedMap=!1,tn.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Ia.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!Ia.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!Ia.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");const t=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return t}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class C_{constructor(t,n){this.expressionMap=t,tn.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Ia.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!Ia.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rc"}get relation(){if(!Ia.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const[t,n]=this.relationName.split("."),r=this.expressionMap.findAliasByName(t).metadata.findRelationWithPropertyPath(n);if(!r)throw new xe(`Relation with property path ${n} in entity was not found.`);return r}get metadata(){if(!Ia.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const t=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(t).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}class N_{constructor(t){var n;this.connection=t,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],t.options.relationLoadStrategy&&(this.relationLoadStrategy=t.options.relationLoadStrategy),this.timeTravel=((n=t.options)==null?void 0:n.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const t=this.mainAlias.metadata.orderBy||{};return Object.keys(t).reduce((n,r)=>(n[this.mainAlias.name+"."+r]=t[r],n),{})}return this.orderBys}setMainAlias(t){return this.mainAlias=t,t}createAlias(t){let n=t.name;!n&&t.tablePath&&(n=t.tablePath),!n&&typeof t.target=="function"&&(n=t.target.name),!n&&typeof t.target=="string"&&(n=t.target);const r=new aL;return r.type=t.type,n&&(r.name=n),t.metadata&&(r.metadata=t.metadata),t.target&&!r.hasMetadata&&(r.metadata=this.connection.getMetadata(t.target)),t.tablePath&&(r.tablePath=t.tablePath),t.subQuery&&(r.subQuery=t.subQuery),this.aliases.push(r),r}findAliasByName(t){const n=this.aliases.find(r=>r.name===t);if(!n)throw new xe(`"${t}" alias was not found. Maybe you forgot to join it?`);return n}findColumnByAliasExpression(t){const[n,r]=t.split(".");return this.findAliasByName(n).metadata.findColumnWithPropertyName(r)}get relationMetadata(){if(!this.mainAlias)throw new xe("Entity to work with is not specified!");const t=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return t}clone(){const t=new N_(this.connection);return t.queryType=this.queryType,t.selects=this.selects.map(n=>n),t.maxExecutionTime=this.maxExecutionTime,t.selectDistinct=this.selectDistinct,t.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(n=>t.aliases.push(new aL(n))),t.relationLoadStrategy=this.relationLoadStrategy,t.mainAlias=this.mainAlias,t.valuesSet=this.valuesSet,t.returning=this.returning,t.onConflict=this.onConflict,t.onIgnore=this.onIgnore,t.onUpdate=this.onUpdate,t.joinAttributes=this.joinAttributes.map(n=>new vL(this.connection,this,n)),t.relationIdAttributes=this.relationIdAttributes.map(n=>new O_(this,n)),t.relationCountAttributes=this.relationCountAttributes.map(n=>new C_(this,n)),t.wheres=this.wheres.map(n=>({...n})),t.havings=this.havings.map(n=>({...n})),t.orderBys=Object.assign({},this.orderBys),t.groupBys=this.groupBys.map(n=>n),t.limit=this.limit,t.offset=this.offset,t.skip=this.skip,t.take=this.take,t.lockMode=this.lockMode,t.onLocked=this.onLocked,t.lockVersion=this.lockVersion,t.lockTables=this.lockTables,t.withDeleted=this.withDeleted,t.parameters=Object.assign({},this.parameters),t.disableEscaping=this.disableEscaping,t.enableRelationIdValues=this.enableRelationIdValues,t.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,t.subQuery=this.subQuery,t.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,t.cache=this.cache,t.cacheId=this.cacheId,t.cacheDuration=this.cacheDuration,t.relationPropertyPath=this.relationPropertyPath,t.of=this.of,t.insertColumns=this.insertColumns,t.whereEntities=this.whereEntities,t.updateEntity=this.updateEntity,t.callListeners=this.callListeners,t.useTransaction=this.useTransaction,t.timeTravel=this.timeTravel,t.nativeParameters=Object.assign({},this.nativeParameters),t.comment=this.comment,t.commonTableExpressions=this.commonTableExpressions.map(n=>({alias:n.alias,queryBuilder:typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.clone(),options:n.options})),t}}class bL{constructor(t){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=t}}class M_{static transformFrom(t,n){return Array.isArray(t)?t.slice().reverse().reduce((r,a)=>a.from(r),n):t.from(n)}static transformTo(t,n){return Array.isArray(t)?t.reduce((r,a)=>a.to(r),n):t.to(n)}}class hd{constructor(t,n,r=!0,a=!1,o,i){this["@instanceof"]=Symbol.for("FindOperator"),this._type=t,this._value=n,this._useParameter=r,this._multipleParameters=a,this._getSql=o,this._objectLiteralParameters=i}get useParameter(){return Pt.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return Pt.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return Pt.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return Pt.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(Pt.isFindOperator(this._value))return this._value}get getSql(){return Pt.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(t){this._value instanceof hd?this._value.transformValue(t):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(n=>t&&M_.transformTo(t,n)):M_.transformTo(t,this._value)}}function Da(e){return new hd("in",e,!0,!0)}const Vue=/[.*+\-?^${}()|[\]\\]/g,que=e=>e.replace(Vue,"\\$&");class Zt{constructor(t,n){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,Pt.isDataSource(t)?(this.connection=t,this.queryRunner=n,this.expressionMap=new N_(this.connection)):(this.connection=t.connection,this.queryRunner=t.queryRunner,this.expressionMap=t.expressionMap.clone())}static registerQueryBuilderClass(t,n){Zt.queryBuilderRegistry[t]=n}get alias(){if(!this.expressionMap.mainAlias)throw new xe("Main alias is not set");return this.expressionMap.mainAlias.name}select(t,n){return this.expressionMap.queryType="select",Array.isArray(t)?this.expressionMap.selects=t.map(r=>({selection:r})):t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]),Pt.isSelectQueryBuilder(this)?this:Zt.queryBuilderRegistry.SelectQueryBuilder(this)}insert(){return this.expressionMap.queryType="insert",Pt.isInsertQueryBuilder(this)?this:Zt.queryBuilderRegistry.InsertQueryBuilder(this)}update(t,n){const r=n||t;if(t=Pt.isEntitySchema(t)?t.options.name:t,typeof t=="function"||typeof t=="string"){const a=this.createFromAlias(t);this.expressionMap.setMainAlias(a)}return this.expressionMap.queryType="update",this.expressionMap.valuesSet=r,Pt.isUpdateQueryBuilder(this)?this:Zt.queryBuilderRegistry.UpdateQueryBuilder(this)}delete(){return this.expressionMap.queryType="delete",Pt.isDeleteQueryBuilder(this)?this:Zt.queryBuilderRegistry.DeleteQueryBuilder(this)}softDelete(){return this.expressionMap.queryType="soft-delete",Pt.isSoftDeleteQueryBuilder(this)?this:Zt.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}restore(){return this.expressionMap.queryType="restore",Pt.isSoftDeleteQueryBuilder(this)?this:Zt.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}relation(t,n){const r=arguments.length===2?t:void 0,a=arguments.length===2?n:t;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=a,r){const o=this.createFromAlias(r);this.expressionMap.setMainAlias(o)}return Pt.isRelationQueryBuilder(this)?this:Zt.queryBuilderRegistry.RelationQueryBuilder(this)}hasRelation(t,n){const r=this.connection.getMetadata(t);return(Array.isArray(n)?n:[n]).every(a=>!!r.findRelationWithPropertyPath(a))}hasParameter(t){var n;return((n=this.parentQueryBuilder)==null?void 0:n.hasParameter(t))||t in this.expressionMap.parameters}setParameter(t,n){if(typeof n=="function")throw new xe(`Function parameter isn't supported in the parameters. Please check "${t}" parameter.`);if(!t.match(/^([A-Za-z0-9_.]+)$/))throw new xe("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(t,n),this.expressionMap.parameters[t]=n,this}setParameters(t){for(const[n,r]of Object.entries(t))this.setParameter(n,r);return this}createParameter(t){let n;do n=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(n));return this.setParameter(n,t),`:${n}`}setNativeParameters(t){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(t),Object.keys(t).forEach(n=>{this.expressionMap.nativeParameters[n]=t[n]}),this}getParameters(){const t=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const n=this.expressionMap.mainAlias.metadata;if(n.discriminatorColumn&&n.parentEntityMetadata){const r=n.childEntityMetadatas.filter(a=>a.discriminatorColumn).map(a=>a.discriminatorValue);r.push(n.discriminatorValue),t.discriminatorColumnValues=r}}return t}printSql(){const[t,n]=this.getQueryAndParameters();return this.connection.logger.logQuery(t,n),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const t=this.getQuery(),n=this.getParameters();return this.connection.driver.escapeQueryWithParameters(t,n,this.expressionMap.nativeParameters)}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();try{return await r.query(t,n)}finally{r!==this.queryRunner&&await r.release()}}createQueryBuilder(t){return new this.constructor(this.connection,t??this.queryRunner)}clone(){return new this.constructor(this)}comment(t){return this.expressionMap.comment=t,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(t){return this.expressionMap.disableEscaping?this.connection.driver.escape(t):t}setQueryRunner(t){return this.queryRunner=t,this}callListeners(t){return this.expressionMap.callListeners=t,this}useTransaction(t){return this.expressionMap.useTransaction=t,this}addCommonTableExpression(t,n,r){return this.expressionMap.commonTableExpressions.push({queryBuilder:t,alias:n,options:r||{}}),this}getTableName(t){return t.split(".").map(n=>n===""?n:this.escape(n)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new xe('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(t,n){if(this.connection.hasMetadata(t)){const r=this.connection.getMetadata(t);return this.expressionMap.createAlias({type:"from",name:n,metadata:this.connection.getMetadata(t),tablePath:r.tablePath})}else{if(typeof t=="string"){const o=t.substr(0,1)==="("&&t.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:n,tablePath:o?void 0:t,subQuery:o?t:void 0})}const r=t(this.subQuery());this.setParameters(r.getParameters());const a=r.getQuery();return this.expressionMap.createAlias({type:"from",name:n,subQuery:a})}}replacePropertyNames(t){return t}replacePropertyNamesForTheWholeQuery(t){const n={};for(const o of this.expressionMap.aliases){if(!o.hasMetadata)continue;const i=this.expressionMap.aliasNamePrefixingEnabled&&o.name?`${o.name}.`:"";n[i]||(n[i]={});for(const s of o.metadata.relations)s.joinColumns.length>0&&(n[i][s.propertyPath]=s.joinColumns[0].databaseName);for(const s of o.metadata.relations){const c=[...s.joinColumns,...s.inverseJoinColumns];for(const l of c){const u=`${s.propertyPath}.${l.referencedColumn.propertyPath}`;n[i][u]=l.databaseName}}for(const s of o.metadata.columns)n[i][s.databaseName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyPath]=s.databaseName}const r=Object.keys(n),a=r.map(o=>que(o)).join("|");return r.length>0&&(t=t.replace(new RegExp(`([ =(]|^.{0})${a?"("+a+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...o)=>{let i,s,c;if(a){if(i=o[0],s=o[1],c=o[3],n[o[2]][c])return`${s}${this.escape(o[2].substring(0,o[2].length-1))}.${this.escape(n[o[2]][c])}`}else if(i=o[0],s=o[1],c=o[2],n[""][c])return`${s}${this.escape(n[""][c])}`;return i})),t}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace(/\*\//g,"")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const t=[],n=this.createWhereClausesExpression(this.expressionMap.wheres);if(n.length>0&&n!=="1=1"&&t.push(this.replacePropertyNames(n)),this.expressionMap.mainAlias.hasMetadata){const a=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&a.deleteDateColumn){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.deleteDateColumn.propertyName:a.deleteDateColumn.propertyName,i=`${this.replacePropertyNames(o)} IS NULL`;t.push(i)}if(a.discriminatorColumn&&a.parentEntityMetadata){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.discriminatorColumn.databaseName:a.discriminatorColumn.databaseName,i=`${this.replacePropertyNames(o)} IN (:...discriminatorColumnValues)`;t.push(i)}}if(this.expressionMap.extraAppendedAndWhereCondition){const a=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);t.push(a)}let r="";return r+=this.createTimeTravelQuery(),t.length?t.length===1?r+=` WHERE ${t[0]}`:r+=` WHERE ( ${t.join(" ) AND ( ")} )`:r+="",r}createReturningExpression(t){const n=this.getReturningColumns(),r=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&r.isReturningSqlSupported(t)&&n.push(...this.expressionMap.extraReturningColumns.filter(a=>n.indexOf(a)===-1)),n.length){let a=n.map(o=>{const i=this.escape(o.databaseName);return r.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+i:this.escape(this.getMainTableName())+"."+i:i}).join(", ");return r.options.type==="oracle"&&(a+=" INTO "+n.map(o=>this.createParameter({type:r.columnTypeToNativeParameter(o.type),dir:r.oracle.BIND_OUT})).join(", ")),r.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(a+=" INTO @OutputTable"),a}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const t=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(n=>{this.expressionMap.mainAlias.hasMetadata&&t.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n))}),t}createWhereClausesExpression(t){return t.map((n,r)=>{const a=this.createWhereConditionExpression(n.condition);switch(n.type){case"and":return(r>0?"AND ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`;case"or":return(r>0?"OR ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`}return a}).join(" ").trim()}createWhereConditionExpression(t,n=!1){if(typeof t=="string")return t;if(Array.isArray(t))return t.length===0?"1=1":t.length===1&&!n?this.createWhereClausesExpression(t):"("+this.createWhereClausesExpression(t)+")";const{driver:r}=this.connection;switch(t.operator){case"lessThan":return`${t.parameters[0]} < ${t.parameters[1]}`;case"lessThanOrEqual":return`${t.parameters[0]} <= ${t.parameters[1]}`;case"arrayContains":return`${t.parameters[0]} @> ${t.parameters[1]}`;case"jsonContains":return`${t.parameters[0]} ::jsonb @> ${t.parameters[1]}`;case"arrayContainedBy":return`${t.parameters[0]} <@ ${t.parameters[1]}`;case"arrayOverlap":return`${t.parameters[0]} && ${t.parameters[1]}`;case"moreThan":return`${t.parameters[0]} > ${t.parameters[1]}`;case"moreThanOrEqual":return`${t.parameters[0]} >= ${t.parameters[1]}`;case"notEqual":return`${t.parameters[0]} != ${t.parameters[1]}`;case"equal":return`${t.parameters[0]} = ${t.parameters[1]}`;case"ilike":return r.options.type==="postgres"||r.options.type==="cockroachdb"?`${t.parameters[0]} ILIKE ${t.parameters[1]}`:`UPPER(${t.parameters[0]}) LIKE UPPER(${t.parameters[1]})`;case"like":return`${t.parameters[0]} LIKE ${t.parameters[1]}`;case"between":return`${t.parameters[0]} BETWEEN ${t.parameters[1]} AND ${t.parameters[2]}`;case"in":return t.parameters.length<=1?"0=1":`${t.parameters[0]} IN (${t.parameters.slice(1).join(", ")})`;case"any":return r.options.type==="cockroachdb"?`${t.parameters[0]}::STRING = ANY(${t.parameters[1]}::STRING[])`:`${t.parameters[0]} = ANY(${t.parameters[1]})`;case"isNull":return`${t.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(t.condition)})`;case"brackets":return`${this.createWhereConditionExpression(t.condition,!0)}`;case"and":return"("+t.parameters.join(" AND ")+")";case"or":return"("+t.parameters.join(" OR ")+")"}throw new TypeError(`Unsupported FindOperator ${hd.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const t=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(n=>{const r=typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.getQuery();if(typeof n.queryBuilder!="string"){if(n.queryBuilder.hasCommonTableExpressions())throw new xe(`Nested CTEs aren't supported (CTE: ${n.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!Pt.isSelectQueryBuilder(n.queryBuilder))throw new xe(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${n.alias})`);this.setParameters(n.queryBuilder.getParameters())}let a=this.escape(n.alias);if(n.options.columnNames){const s=n.options.columnNames.map(c=>this.escape(c));if(Pt.isSelectQueryBuilder(n.queryBuilder)&&n.queryBuilder.expressionMap.selects.length&&n.options.columnNames.length!==n.queryBuilder.expressionMap.selects.length)throw new xe(`cte.options.columnNames length (${n.options.columnNames.length}) doesn't match subquery select list length ${n.queryBuilder.expressionMap.selects.length} (CTE: ${n.alias})`);a+=`(${s.join(", ")})`}const o=n.options.recursive&&t?"RECURSIVE":"";let i="";return this.connection.driver.cteCapabilities.materializedHint&&n.options.materialized!==void 0&&(i=n.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[o,a,"AS",i,`(${r})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(t){const n=this.expressionMap.mainAlias.metadata,r=(Array.isArray(t)?t:[t]).map(a=>n.ensureEntityIdMap(a));if(!n.hasMultiplePrimaryKeys){const a=n.primaryColumns[0];if(!a.transformer&&!a.relationMetadata&&!a.embeddedMetadata)return{[a.propertyName]:Da(r.map(o=>a.getEntityValue(o,!1)))}}return new bL(a=>{for(const o of r)a.orWhere(new bL(i=>i.where(o)))})}getExistsCondition(t){const n=t.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${n.getQuery()})`,n.getParameters()]}findColumnsForPropertyPath(t){let n=this.expressionMap.mainAlias;const r=[],a=t.split(".");for(;a.length>1;){const s=a[0];if(!(n!=null&&n.hasMetadata))break;if(n.metadata.hasEmbeddedWithPropertyPath(s)){a.unshift(`${a.shift()}.${a.shift()}`);continue}if(n.metadata.hasRelationWithPropertyPath(s)){const c=this.expressionMap.joinAttributes.find(l=>l.relationPropertyPath===s);if(!(c!=null&&c.alias)){const l=r.length>0?`${r.join(".")}.${s}`:s;throw new Error(`Cannot find alias for relation at ${l}`)}n=c.alias,r.push(...s.split(".")),a.shift();continue}break}if(!n)throw new Error(`Cannot find alias for property ${t}`);const o=a.join("."),i=n.metadata.findColumnsWithPropertyPath(o);if(!i.length)throw new Ra(t,n.metadata);return[n,r,i]}createPropertyPath(t,n,r=""){const a=[];for(const o of Object.keys(n)){const i=r?`${r}.${o}`:o;if(n[o]===null||typeof n[o]!="object"||Pt.isFindOperator(n[o])){a.push(i);continue}if(t.hasEmbeddedWithPropertyPath(i)){const s=this.createPropertyPath(t,n[o],i);a.push(...s);continue}if(t.hasRelationWithPropertyPath(i)){const s=t.findRelationWithPropertyPath(i);if(s.relationType==="one-to-one"||s.relationType==="many-to-one"){const u=s.joinColumns.map(d=>d.referencedColumn).filter(d=>!!d);if(u.length>0&&u.every(d=>d.getEntityValue(n[o],!1))){a.push(i);continue}}if(s.relationType==="one-to-many"||s.relationType==="many-to-many")throw new Error(`Cannot query across ${s.relationType} for property ${i}`);const c=s.inverseEntityMetadata.primaryColumns;if(c.length>0&&c.every(u=>u.getEntityValue(n[o],!1))){const u=c.map(d=>`${i}.${d.propertyPath}`);a.push(...u);continue}const l=this.createPropertyPath(s.inverseEntityMetadata,n[o]).map(u=>`${i}.${u}`);a.push(...l);continue}a.push(i)}return a}*getPredicates(t){if(this.expressionMap.mainAlias.hasMetadata){const n=this.createPropertyPath(this.expressionMap.mainAlias.metadata,t);for(const r of n){const[a,o,i]=this.findColumnsForPropertyPath(r);for(const s of i){let c=t;for(const d of o){if(!c||!(d in c)){c={};break}c=c[d]}const l=this.expressionMap.aliasNamePrefixingEnabled?`${a.name}.${s.propertyPath}`:s.propertyPath,u=s.getEntityValue(c,!0);yield[l,u]}}}else for(const n of Object.keys(t)){const r=t[n];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${n}`:n,r]}}getWherePredicateCondition(t,n){if(Pt.isFindOperator(n)){let r=[];if(n.useParameter)if(n.objectLiteralParameters)this.setParameters(n.objectLiteralParameters);else if(n.multipleParameters)for(const a of n.value)r.push(this.createParameter(a));else r.push(this.createParameter(n.value));if(n.type==="raw")return n.getSql?n.getSql(t):{operator:"equal",parameters:[t,n.value]};if(n.type==="not")return n.child?{operator:n.type,condition:this.getWherePredicateCondition(t,n.child)}:{operator:"notEqual",parameters:[t,...r]};if(n.type==="and"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else if(n.type==="or"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else return{operator:n.type,parameters:[t,...r]}}else return{operator:"equal",parameters:[t,this.createParameter(n)]}}getWhereCondition(t){if(typeof t=="string")return t;if(Pt.isBrackets(t)){const a=this.createQueryBuilder();return a.parentQueryBuilder=this,a.expressionMap.mainAlias=this.expressionMap.mainAlias,a.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,a.expressionMap.parameters=this.expressionMap.parameters,a.expressionMap.nativeParameters=this.expressionMap.nativeParameters,a.expressionMap.wheres=[],t.whereFactory(a),{operator:Pt.isNotBrackets(t)?"not":"brackets",condition:a.expressionMap.wheres}}if(typeof t=="function")return t(this);const n=Array.isArray(t)?t:[t],r=[];for(const a of n){const o=[];for(const[i,s]of this.getPredicates(a))o.push({type:"and",condition:this.getWherePredicateCondition(i,s)});r.push({type:"or",condition:o})}return r.length===1?r[0].condition:r}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}Zt.queryBuilderRegistry={};class Uue{static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class Wue extends Zt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("DeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createDeleteExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("BeforeRemove",this.expressionMap.mainAlias.metadata);const o=await r.query(t,n,!0),i=Uue.from(o);return this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("AfterRemove",this.expressionMap.mainAlias.metadata),a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}finally{r!==this.queryRunner&&await r.release()}}from(t,n){t=Pt.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("delete"))throw new rm;return this.expressionMap.returning=t,this}createDeleteExpression(){const t=this.getTableName(this.getMainTableName()),n=this.createWhereExpression(),r=this.createReturningExpression("delete");return r===""?`DELETE FROM ${t}${n}`:this.connection.driver.options.type==="mssql"?`DELETE FROM ${t} OUTPUT ${r}${n}`:`DELETE FROM ${t}${n} RETURNING ${r}`}}let am;const Hue=new Uint8Array(16);function Zue(){if(!am&&(am=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!am))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return am(Hue)}const _n=[];for(let e=0;e<256;++e)_n.push((e+256).toString(16).slice(1));function Kue(e,t=0){return _n[e[t+0]]+_n[e[t+1]]+_n[e[t+2]]+_n[e[t+3]]+"-"+_n[e[t+4]]+_n[e[t+5]]+"-"+_n[e[t+6]]+_n[e[t+7]]+"-"+_n[e[t+8]]+_n[e[t+9]]+"-"+_n[e[t+10]]+_n[e[t+11]]+_n[e[t+12]]+_n[e[t+13]]+_n[e[t+14]]+_n[e[t+15]]}const Xue=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),wL={randomUUID:Xue};function Gue(e,t,n){if(wL.randomUUID&&!t&&!e)return wL.randomUUID();e=e||{};const r=e.random||(e.rng||Zue)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Kue(r)}class xL{constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}class _L{constructor(){this.identifiers=[],this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.raw,n}}class P_{constructor(t,n){this.queryRunner=t,this.expressionMap=n}async update(t,n){const r=this.expressionMap.mainAlias.metadata;await Promise.all(n.map(async(a,o)=>{if(this.queryRunner.connection.driver.isReturningSqlSupported("update")){this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((c,l,u)=>(c[this.expressionMap.extraReturningColumns[u].databaseName]=l[0],c),{}));const i=Array.isArray(t.raw)?t.raw[o]:t.raw,s=this.queryRunner.connection.driver.createGeneratedMap(r,i);s&&(this.queryRunner.manager.merge(r.target,a,s),t.generatedMaps.push(s))}else{const i=this.expressionMap.extraReturningColumns;if(i.length>0){const s=this.expressionMap.mainAlias.metadata.getEntityIdMap(a);if(!s)throw new xe("Cannot update entity because entity id is not set in the entity.");const c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(i.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).withDeleted().setOption("create-pojo").getOne();c&&(this.queryRunner.manager.merge(r.target,a,c),t.generatedMaps.push(c))}}}))}async insert(t,n){const r=this.expressionMap.mainAlias.metadata;let a=r.getInsertionReturningColumns();const o=this.queryRunner.connection.driver.isReturningSqlSupported("insert");a=a.filter(s=>s.isGenerated?o===!0:!0);const i=n.map((s,c)=>{this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((d,f,p)=>(d[this.expressionMap.extraReturningColumns[p].databaseName]=f[0],d),{}));const l=Array.isArray(t.raw)?t.raw[c]:t.raw,u=this.queryRunner.connection.driver.createGeneratedMap(r,l,c,n.length)||{};return c in this.expressionMap.locallyGenerated&&this.queryRunner.manager.merge(r.target,u,this.expressionMap.locallyGenerated[c]),this.queryRunner.manager.merge(r.target,s,u),u});if(a.length>0&&!this.queryRunner.connection.driver.isReturningSqlSupported("insert")){const s=n.map(l=>{const u=r.getEntityIdMap(l);if(!u)throw new xe("Cannot update entity because entity id is not set in the entity.");return u}),c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(a.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).setOption("create-pojo").getMany();n.forEach((l,u)=>{this.queryRunner.manager.merge(r.target,i[u],c[u]),this.queryRunner.manager.merge(r.target,l,c[u])})}n.forEach((s,c)=>{const l=r.getEntityIdMap(s);t.identifiers.push(l),t.generatedMaps.push(i[c])})}getUpdationReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion)}getSoftDeletionReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion||t.isDeleteDate)}}class Que extends Zt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("InsertQueryBuilder")}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createInsertExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.getValueSets();if(t.length===0)return new _L;const n=this.obtainQueryRunner();let r=!1;try{if(this.expressionMap.useTransaction===!0&&n.isTransactionActive===!1&&(await n.startTransaction(),r=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const p=new xL;t.forEach(y=>{n.broadcaster.broadcastBeforeInsertEvent(p,this.expressionMap.mainAlias.metadata,y)}),await p.wait()}let a=null,o=null;const i=new P_(n,this.expressionMap),s=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const p of this.expressionMap.returning)s.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(p));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&(t.length>1&&this.connection.driver.options.type==="oracle"||(this.expressionMap.extraReturningColumns=this.expressionMap.mainAlias.metadata.getInsertionReturningColumns()),s.push(...this.expressionMap.extraReturningColumns.filter(p=>!s.includes(p)))),s.length>0&&this.connection.driver.options.type==="mssql"&&(a=this.connection.driver.buildTableVariableDeclaration("@OutputTable",s),o="SELECT * FROM @OutputTable");const[c,l]=this.getQueryAndParameters(),u=[a,c,o].filter(p=>p!=null).join(`;

`),d=await n.query(u,l,!0),f=_L.from(d);if(this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&await i.insert(f,t),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const p=new xL;t.forEach(y=>{n.broadcaster.broadcastAfterInsertEvent(p,this.expressionMap.mainAlias.metadata,y)}),await p.wait()}return r&&await n.commitTransaction(),f}catch(a){if(r)try{await n.rollbackTransaction()}catch{}throw a}finally{n!==this.queryRunner&&await n.release()}}into(t,n){t=Pt.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t);return this.expressionMap.setMainAlias(r),this.expressionMap.insertColumns=n||[],this}values(t){return this.expressionMap.valuesSet=t,this}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("insert"))throw new rm;return this.expressionMap.returning=t,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}onConflict(t){return this.expressionMap.onConflict=t,this}orIgnore(t=!0){return this.expressionMap.onIgnore=!!t,this}orUpdate(t,n,r){return Array.isArray(t)?(this.expressionMap.onUpdate={overwrite:t,conflict:n,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,indexPredicate:r==null?void 0:r.indexPredicate,upsertType:r==null?void 0:r.upsertType},this):(this.expressionMap.onUpdate={conflict:t==null?void 0:t.conflict_target,columns:t==null?void 0:t.columns,overwrite:t==null?void 0:t.overwrite,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,upsertType:r==null?void 0:r.upsertType},this)}createInsertExpression(){var i,s;const t=this.getTableName(this.getMainTableName()),n=this.createValuesExpression(),r=this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1?null:this.createReturningExpression("insert"),a=this.createColumnNamesExpression();let o="INSERT ";if(((i=this.expressionMap.onUpdate)==null?void 0:i.upsertType)==="primary-key"&&(o="UPSERT "),(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+=`${this.expressionMap.onIgnore?" IGNORE ":""}`),o+=`INTO ${t}`,this.alias!==this.getMainTableName()&&ve.isPostgresFamily(this.connection.driver)&&(o+=` AS "${this.alias}"`),a?o+=`(${a})`:!n&&(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+="()"),r&&this.connection.driver.options.type==="mssql"&&(o+=` OUTPUT ${r}`),n?(this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="sap")&&this.getValueSets().length>1?o+=` ${n}`:o+=` VALUES ${n}`:ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"?o+=" VALUES ()":o+=" DEFAULT VALUES",((s=this.expressionMap.onUpdate)==null?void 0:s.upsertType)!=="primary-key"){if(this.connection.driver.supportedUpsertTypes.includes("on-conflict-do-update")){if(this.expressionMap.onIgnore)o+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)o+=` ON CONFLICT ${this.expressionMap.onConflict} `;else if(this.expressionMap.onUpdate){const{overwrite:c,columns:l,conflict:u,skipUpdateIfNoValuesChanged:d,indexPredicate:f}=this.expressionMap.onUpdate;let p="ON CONFLICT";if(Array.isArray(u)){if(p+=` ( ${u.map(m=>this.escape(m)).join(", ")} )`,f&&!ve.isPostgresFamily(this.connection.driver))throw new xe("indexPredicate option is not supported by the current database driver");f&&ve.isPostgresFamily(this.connection.driver)&&(p+=` WHERE ( ${f} )`)}else u&&(p+=` ON CONSTRAINT ${this.escape(u)}`);const y=[];Array.isArray(c)?y.push(...c.map(m=>`${this.escape(m)} = EXCLUDED.${this.escape(m)}`)):l&&y.push(...l.map(m=>`${this.escape(m)} = :${m}`)),y.length>0&&(o+=` ${p} DO UPDATE SET `,y.push(...this.expressionMap.mainAlias.metadata.columns.filter(m=>m.isUpdateDate&&!(c!=null&&c.includes(m.databaseName))&&!(this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")).map(m=>`${this.escape(m.databaseName)} = DEFAULT`)),o+=y.join(", "),o+=" "),Array.isArray(c)&&d&&ve.isPostgresFamily(this.connection.driver)&&(o+=" WHERE (",o+=c.map(m=>`${t}.${this.escape(m)} IS DISTINCT FROM EXCLUDED.${this.escape(m)}`).join(" OR "),o+=") ")}}else if(this.connection.driver.supportedUpsertTypes.includes("on-duplicate-key-update")){if(this.expressionMap.onUpdate){const{overwrite:c,columns:l}=this.expressionMap.onUpdate;Array.isArray(c)?(o+=" ON DUPLICATE KEY UPDATE ",o+=c.map(u=>`${this.escape(u)} = VALUES(${this.escape(u)})`).join(", "),o+=" "):Array.isArray(l)&&(o+=" ON DUPLICATE KEY UPDATE ",o+=l.map(u=>`${this.escape(u)} = :${u}`).join(", "),o+=" ")}}else if(this.expressionMap.onUpdate)throw new xe("onUpdate is not supported by the current database driver")}return r&&(ve.isPostgresFamily(this.connection.driver)||this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="cockroachdb"||ve.isMySQLFamily(this.connection.driver))&&(o+=` RETURNING ${r}`),this.connection.driver.options.type==="mssql"&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter(c=>this.expressionMap.insertColumns.length>0?this.expressionMap.insertColumns.indexOf(c.propertyPath)!==-1:c.isInsert).some(c=>this.isOverridingAutoIncrementBehavior(c))&&(o=`SET IDENTITY_INSERT ${t} ON; ${o}; SET IDENTITY_INSERT ${t} OFF`),o}getInsertedColumns(){return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter(t=>this.expressionMap.insertColumns.length?this.expressionMap.insertColumns.indexOf(t.propertyPath)!==-1:!(!t.isInsert||t.isGenerated&&t.generationStrategy==="increment"&&this.connection.driver.options.type!=="spanner"&&this.connection.driver.options.type!=="oracle"&&!ve.isSQLiteFamily(this.connection.driver)&&!ve.isMySQLFamily(this.connection.driver)&&this.connection.driver.options.type!=="aurora-mysql"&&!(this.connection.driver.options.type==="mssql"&&this.isOverridingAutoIncrementBehavior(t)))):[]}createColumnNamesExpression(){const t=this.getInsertedColumns();if(t.length>0)return t.map(n=>this.escape(n.databaseName)).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){const n=this.getValueSets();if(n.length===1)return Object.keys(n[0]).map(r=>this.escape(r)).join(", ")}return this.expressionMap.insertColumns.map(n=>this.escape(n)).join(", ")}createValuesExpression(){const t=this.getValueSets(),n=this.getInsertedColumns();if(n.length>0){let r="";return t.forEach((a,o)=>{n.forEach((i,s)=>{s===0&&(this.connection.driver.options.type==="oracle"&&t.length>1||this.connection.driver.options.type==="sap"&&t.length>1?r+=" SELECT ":r+="(");let c=i.getEntityValue(a);if(typeof c!="function"&&(c=this.connection.driver.preparePersistentValue(c,i)),i.isVersion&&c===void 0)r+="1";else if(i.isDiscriminator)r+=this.createParameter(this.expressionMap.mainAlias.metadata.discriminatorValue);else if(i.isGenerated&&i.generationStrategy==="uuid"&&!this.connection.driver.isUUIDGenerationSupported()&&c===void 0)c=Gue(),r+=this.createParameter(c),o in this.expressionMap.locallyGenerated||(this.expressionMap.locallyGenerated[o]={}),i.setEntityValue(this.expressionMap.locallyGenerated[o],c);else if(c===void 0)this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?i.default!==void 0&&i.default!==null?r+=this.connection.driver.normalizeDefault(i):r+="NULL":r+="DEFAULT";else if(c===null&&this.connection.driver.options.type==="spanner")r+="NULL";else if(typeof c=="function")r+=c();else{this.connection.driver.options.type==="mssql"&&(c=this.connection.driver.parametrizeValue(i,c));const l=this.createParameter(c);if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1){const u=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";i.srid!=null?r+=`${u}(${l}, ${i.srid})`:r+=`${u}(${l})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?i.srid!=null?r+=`ST_SetSRID(ST_GeomFromGeoJSON(${l}), ${i.srid})::${i.type}`:r+=`ST_GeomFromGeoJSON(${l})::${i.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?r+=i.type+"::STGeomFromText("+l+", "+(i.srid||"0")+")":r+=l}s===n.length-1?o===t.length-1?this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy ":r+=")":this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL UNION ALL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy UNION ALL ":r+="), ":r+=", "})}),r==="()"?"":r}else{let r="";return t.forEach((a,o)=>{Object.keys(a).forEach((i,s)=>{s===0&&(r+="(");const c=a[i];typeof c=="function"?r+=c():c===void 0?this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?r+="NULL":r+="DEFAULT":c===null&&this.connection.driver.options.type==="spanner"||(r+=this.createParameter(c)),s===Object.keys(a).length-1?o===t.length-1?r+=")":r+="), ":r+=", "})}),r==="()"?"":r}}getValueSets(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(tn.isObject(this.expressionMap.valuesSet))return[this.expressionMap.valuesSet];throw new Nue}isOverridingAutoIncrementBehavior(t){return t.isPrimary&&t.isGenerated&&t.generationStrategy==="increment"&&this.getValueSets().some(n=>t.getEntityValue(n)!==void 0&&t.getEntityValue(n)!==null)}}class jL{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async update(t){const n=this.expressionMap.relationMetadata;if(n.isManyToOne||n.isOneToOneOwner){const r=n.joinColumns.reduce((a,o)=>{const i=tn.isObject(t)?o.referencedColumn.getEntityValue(t):t;return o.setEntityValue(a,i),a},{});if(!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length)return;await this.queryBuilder.createQueryBuilder().update(n.entityMetadata.target).set(r).whereInIds(this.expressionMap.of).execute()}else if((n.isOneToOneNotOwner||n.isOneToMany)&&t===null){const r={};n.inverseRelation.joinColumns.forEach(c=>{r[c.propertyName]=null});const a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o={},i=[];a.forEach((c,l)=>{n.inverseRelation.joinColumns.map((u,d)=>{const f="joinColumn_"+l+"_"+d;o[f]=tn.isObject(c)?u.referencedColumn.getEntityValue(c):c,i.push(`${u.propertyPath} = :${f}`)})});const s=i.map(c=>"("+c+")").join(" OR ");if(!s)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(r).where(s).setParameters(o).execute()}else if(n.isOneToOneNotOwner||n.isOneToMany){if(Array.isArray(this.expressionMap.of))throw new xe("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");const r=this.expressionMap.of,a=n.inverseRelation.joinColumns.reduce((o,i)=>{const s=tn.isObject(r)?i.referencedColumn.getEntityValue(r):r;return i.setEntityValue(o,s),o},{});if(!t||Array.isArray(t)&&!t.length)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(a).whereInIds(t).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c=[];if(i.forEach(l=>{s.forEach(u=>{const d={};r.ownerColumns.forEach(f=>{d[f.databaseName]=tn.isObject(l)?f.referencedColumn.getEntityValue(l):l}),r.inverseColumns.forEach(f=>{d[f.databaseName]=tn.isObject(u)?f.referencedColumn.getEntityValue(u):u}),c.push(d)})}),!c.length)return;this.queryBuilder.connection.driver.options.type==="oracle"||this.queryBuilder.connection.driver.options.type==="sap"?await Promise.all(c.map(l=>this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(l).execute())):await this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(c).execute()}}}class Jue{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async remove(t){const n=this.expressionMap.relationMetadata;if(n.isOneToMany){const r=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],a=Array.isArray(t)?t:[t],o={};n.inverseRelation.joinColumns.forEach(l=>{o[l.propertyName]=null});const i={},s=[];r.forEach((l,u)=>{s.push(...a.map((d,f)=>[...n.inverseRelation.joinColumns.map((p,y)=>{const m="joinColumn_"+u+"_"+f+"_"+y;return i[m]=tn.isObject(l)?p.referencedColumn.getEntityValue(l):l,`${p.propertyPath} = :${m}`}),...n.inverseRelation.entityMetadata.primaryColumns.map((p,y)=>{const m="primaryColumn_"+f+"_"+f+"_"+y;return i[m]=tn.isObject(d)?p.getEntityValue(d):d,`${p.propertyPath} = :${m}`})].join(" AND ")))});const c=s.map(l=>"("+l+")").join(" OR ");if(!c)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(o).where(c).setParameters(i).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c={},l=[];i.forEach((d,f)=>{l.push(...s.map((p,y)=>[...r.ownerColumns.map((m,v)=>{const b="firstValue_"+f+"_"+y+"_"+v;return c[b]=tn.isObject(d)?m.referencedColumn.getEntityValue(d):d,`${m.databaseName} = :${b}`}),...r.inverseColumns.map((m,v)=>{const b="secondValue_"+f+"_"+y+"_"+v;return c[b]=tn.isObject(p)?m.referencedColumn.getEntityValue(p):p,`${m.databaseName} = :${b}`})].join(" AND ")))});const u=l.map(d=>"("+d+")").join(" OR ");await this.queryBuilder.createQueryBuilder().delete().from(r.tableName).where(u).setParameters(c).execute()}}}class Yue extends Zt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("RelationQueryBuilder")}getQuery(){return""}of(t){return this.expressionMap.of=t,this}async set(t){const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToMany||n.isOneToMany)throw new xe(`Set operation is only supported for many-to-one and one-to-one relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .add() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!tn.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new jL(this,this.expressionMap).update(t)}async add(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!tn.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new jL(this,this.expressionMap).update(t)}async remove(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set(null) method instead.`);return new Jue(this,this.expressionMap).remove(t)}async addAndRemove(t,n){await this.remove(n),await this.add(t)}async loadOne(){return this.loadMany().then(t=>t[0])}async loadMany(){let t=this.expressionMap.of;if(!tn.isObject(t)){const n=this.expressionMap.mainAlias.metadata;if(n.hasMultiplePrimaryKeys)throw new xe("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");t=n.primaryColumns[0].createValueMap(t)}return this.connection.relationLoader.load(this.expressionMap.relationMetadata,t,this.queryRunner)}}class jn{static chunk(t,n){return Array.from(Array(Math.ceil(t.length/n)),(r,a)=>t.slice(a*n,a*n+n))}static splitClassesAndStrings(t){return[t.filter(n=>typeof n!="string"),t.filter(n=>typeof n=="string")]}static groupBy(t,n){return t.reduce((r,a)=>{const o=n(a);let i=r.find(s=>s.id===o);return i||(i={id:o,items:[]},r.push(i)),i.items.push(a),r},[])}static uniq(t,n){return t.reduce((r,a)=>{let o=!1;if(typeof n=="function"){const i=n(a);o=!!r.find(s=>n(s)===i)}else typeof n=="string"?o=!!r.find(i=>i[n]===a[n]):o=r.indexOf(a)!==-1;return o||r.push(a),r},[])}static isPlainObject(t){return t==null?!1:!t.constructor||t.constructor===Object}static mergeArrayKey(t,n,r,a){if(a.has(r)){t[n]=a.get(r);return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){t[n]=r;return}t[n]||(t[n]=Array.isArray(r)?[]:{}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static mergeObjectKey(t,n,r,a){if(a.has(r)){Object.assign(t,{[n]:a.get(r)});return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){Object.assign(t,{[n]:r});return}t[n]||Object.assign(t,{[n]:Array.isArray(r)?[]:{}}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static merge(t,n,r=new Map){if(this.isPlainObject(t)&&this.isPlainObject(n))for(const a of Object.keys(n))a!=="__proto__"&&this.mergeObjectKey(t,a,n[a],r);if(Array.isArray(t)&&Array.isArray(n))for(let a=0;a<n.length;a++)this.mergeArrayKey(t,a,n[a],r)}static mergeDeep(t,...n){if(!n.length)return t;for(const r of n)jn.merge(t,r);return t}static deepCompare(...t){let n,r,a,o;if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(a=[],o=[],!this.compare2Objects(a,o,arguments[0],arguments[n]))return!1;return!0}static deepValue(t,n){const r=n.split(".");for(let a=0,o=r.length;a<o;a++)t=t[r[a]];return t}static replaceEmptyObjectsWithBooleans(t){for(let n in t)t[n]&&typeof t[n]=="object"&&(Object.keys(t[n]).length===0?t[n]=!0:this.replaceEmptyObjectsWithBooleans(t[n]))}static propertyPathsToTruthyObject(t){let n={};for(let r of t){const a=r.split(".");if(!a.length)continue;(!n[a[0]]||n[a[0]]===!0)&&(n[a[0]]={});let o=n[a[0]];for(let[i,s]of a.entries())i!==0&&(o[s]?o=o[s]:i===a.length-1?(o[s]={},o=null):(o[s]={},o=o[s]))}return this.replaceEmptyObjectsWithBooleans(n),n}static compareIds(t,n){return t==null||n===void 0||n===null?!1:(typeof t.id=="string"&&typeof n.id=="string"||typeof t.id=="number"&&typeof n.id=="number")&&Object.keys(t).length===1&&Object.keys(n).length===1?t.id===n.id:jn.deepCompare(t,n)}static toBoolean(t){return typeof t=="boolean"?t:typeof t=="string"?t==="true"||t==="1":typeof t=="number"?t>0:!1}static zipObject(t,n){return t.reduce((r,a,o)=>(r[a]=n[o],r),{})}static isArraysEqual(t,n){return t.length!==n.length?!1:t.every(r=>n.indexOf(r)!==-1)}static areMutuallyExclusive(...t){return!t.some(n=>{const r=t.filter(a=>a!==n);return n.some(a=>r.some(o=>o.includes(a)))})}static parseSqlCheckExpression(t,n){const r=t.match(new RegExp(`"${n}" varchar CHECK\\s*\\(\\s*"${n}"\\s+IN\\s*`));if(r&&r.index){const a=t.substring(r.index+r[0].length);let o="",i="";const s=[];for(let c=0;c<a.length;c++){const l=a[c];switch(l){case",":o==""?(s.push(i),i=""):i+=l;break;case"'":o==l?a[c+1]===l?(i+=l,c+=1):o="":o=l;break;case")":if(o=="")return s.push(i),s;i+=l;break;default:o!=""&&(i+=l)}}}}static compare2Objects(t,n,r,a){let o;if(Number.isNaN(r)&&Number.isNaN(a)||r===a)return!0;if(r===null||a===null||r===void 0||a===void 0)return!1;if((typeof r.equals=="function"||typeof r.equals=="function")&&r.equals(a))return!0;if(typeof r=="function"&&typeof a=="function"||r instanceof Date&&a instanceof Date||r instanceof RegExp&&a instanceof RegExp||typeof r=="string"&&typeof a=="string"||typeof r=="number"&&typeof a=="number")return r.toString()===a.toString();if(!(typeof r=="object"&&typeof a=="object")||Object.prototype.isPrototypeOf.call(r,a)||Object.prototype.isPrototypeOf.call(a,r)||r.constructor!==a.constructor||r.prototype!==a.prototype||t.indexOf(r)>-1||n.indexOf(a)>-1)return!1;for(o in a)if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;for(o in r){if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;switch(typeof r[o]){case"object":case"function":if(t.push(r),n.push(a),!this.compare2Objects(t,n,r[o],a[o]))return!1;t.pop(),n.pop();break;default:if(r[o]!==a[o])return!1;break}}return!0}}class ede{constructor(t,n,r,a,o){this.expressionMap=t,this.driver=n,this.rawRelationIdResults=r,this.rawRelationCountResults=a,this.queryRunner=o}transform(t,n){const r=this.group(t,n),a=[];return r.forEach(o=>{const i=this.transformRawResultsGroup(o,n);i!==void 0&&!Object.values(i).every(s=>s===null)&&a.push(i)}),a}group(t,n){const r=new Map,a=[];return n.metadata.tableType==="view"?a.push(...n.metadata.columns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))):a.push(...n.metadata.primaryColumns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))),t.forEach(o=>{const i=a.map(c=>{const l=o[c];return vn.isBuffer(l)?l.toString("hex"):tn.isObject(l)?JSON.stringify(l):l}).join("_"),s=r.get(i);s?s.push(o):r.set(i,[o])}),r}transformRawResultsGroup(t,n){let r=n.metadata;if(r.discriminatorColumn){const l=t.map(d=>d[ve.buildAlias(this.driver,void 0,n.name,n.metadata.discriminatorColumn.databaseName)]),u=r.childEntityMetadatas.find(d=>typeof l.find(f=>f===d.discriminatorValue)<"u");u&&(r=u)}let a=r.create(this.queryRunner,{fromDeserializer:!0,pojo:this.expressionMap.options.indexOf("create-pojo")!==-1});const o=this.transformColumns(t,n,a,r),i=this.transformJoins(t,a,n,r),s=this.transformRelationIds(t,n,a,r),c=this.transformRelationCounts(t,n,a);if(o||r.primaryColumns.filter(l=>l.isVirtual===!1).length===0&&(i||s||c))return a}transformColumns(t,n,r,a){let o=!1;return a.columns.forEach(i=>{if(a.childEntityMetadatas.length>0&&a.childEntityMetadatas.findIndex(c=>c.target===i.target)!==-1)return;const s=t[0][ve.buildAlias(this.driver,void 0,n.name,i.databaseName)];s===void 0||i.isVirtual||this.expressionMap.selects.find(c=>c.selection===n.name||c.selection===n.name+"."+i.propertyPath)&&(i.setEntityValue(r,this.driver.prepareHydratedValue(s,i)),s!==null&&(o=!0))}),o}transformJoins(t,n,r,a){let o=!1;return this.expressionMap.joinAttributes.forEach(i=>{if(!i.metadata||!i.isSelected||i.relation&&!a.relations.find(c=>c===i.relation))return;if(i.mapToProperty){if(i.mapToPropertyParentAlias!==r.name)return}else if(!i.relation||i.parentAlias!==r.name||i.relationPropertyPath!==i.relation.propertyPath)return;let s=this.transform(t,i.alias);s=i.isMany?s:s[0],s=!i.isMany&&s===void 0?null:s,s!==void 0&&(i.mapToPropertyPropertyName?n[i.mapToPropertyPropertyName]=s:i.relation.setEntityValue(n,s),o=!0)}),o}transformRelationIds(t,n,r,a){let o=!1;return this.rawRelationIdResults.forEach((i,s)=>{if(i.relationIdAttribute.parentAlias!==n.name)return;const c=i.relationIdAttribute.relation,l=this.createValueMapFromJoinColumns(c,i.relationIdAttribute.parentAlias,t);if(l==null)return;this.prepareDataForTransformRelationIds();const u=this.hashEntityIds(c,l),d=this.relationIdMaps[s][u]||[],f=i.relationIdAttribute.mapToPropertyPropertyPath.split("."),p=(y,m,v)=>{const b=y.shift();if(b&&y.length===0)return m[b]=v,m;if(b&&y.length>0)p(y,m[b],v);else return m};c.isOneToOne||c.isManyToOne?d[0]!==void 0&&(p(f,r,d[0]),o=!0):(p(f,r,d),o=o||d.length>0)}),o}transformRelationCounts(t,n,r){let a=!1;return this.rawRelationCountResults.filter(o=>o.relationCountAttribute.parentAlias===n.name).forEach(o=>{const i=o.relationCountAttribute.relation;let s;i.isOneToMany?s=i.inverseRelation.joinColumns[0].referencedColumn.databaseName:s=i.isOwning?i.joinColumns[0].referencedColumn.databaseName:i.inverseRelation.joinColumns[0].referencedColumn.databaseName;const c=t[0][ve.buildAlias(this.driver,void 0,n.name,s)];c!=null&&(r[o.relationCountAttribute.mapToPropertyPropertyName]=0,o.results.filter(l=>l.parentId===c).forEach(l=>{r[o.relationCountAttribute.mapToPropertyPropertyName]=parseInt(l.cnt),a=!0}))}),a}createValueMapFromJoinColumns(t,n,r){let a;return t.isManyToOne||t.isOneToOneOwner?a=t.entityMetadata.primaryColumns.map(o=>o):t.isOneToMany||t.isOneToOneNotOwner?a=t.inverseRelation.joinColumns.map(o=>o):t.isOwning?a=t.joinColumns.map(o=>o):a=t.inverseRelation.inverseJoinColumns.map(o=>o),a.reduce((o,i)=>(r.forEach(s=>{t.isManyToOne||t.isOneToOneOwner?o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.databaseName)],i):o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.referencedColumn.databaseName)],i.referencedColumn)}),o),{})}extractEntityPrimaryIds(t,n){let r;return t.isManyToOne||t.isOneToOneOwner?r=t.entityMetadata.primaryColumns.map(a=>a):t.isOneToMany||t.isOneToOneNotOwner?r=t.inverseRelation.joinColumns.map(a=>a):t.isOwning?r=t.joinColumns.map(a=>a):r=t.inverseRelation.inverseJoinColumns.map(a=>a),r.reduce((a,o)=>(a[o.databaseName]=n[o.databaseName],a),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(t=>{const n=t.relationIdAttribute.relation;let r;return n.isManyToOne||n.isOneToOneOwner?r=n.joinColumns:n.isOneToMany||n.isOneToOneNotOwner?r=n.inverseEntityMetadata.primaryColumns:n.isOwning?r=n.inverseJoinColumns:r=n.inverseRelation.joinColumns,t.results.reduce((a,o)=>{let i=r.reduce((s,c)=>{let l=o[c.databaseName];return n.isOneToMany||n.isOneToOneNotOwner?(c.isVirtual&&c.referencedColumn&&c.referencedColumn.propertyName!==c.propertyName&&(l=c.referencedColumn.createValueMap(l)),jn.mergeDeep(s,c.createValueMap(l))):(!c.isPrimary&&c.referencedColumn.referencedColumn&&(l=c.referencedColumn.referencedColumn.createValueMap(l)),jn.mergeDeep(s,c.referencedColumn.createValueMap(l)))},{});if(r.length===1&&!t.relationIdAttribute.disableMixedMap&&(n.isOneToMany||n.isOneToOneNotOwner?i=r[0].getEntityValue(i):i=r[0].referencedColumn.getEntityValue(i)),i!==void 0){const s=this.hashEntityIds(n,o);a[s]?a[s].push(i):a[s]=[i]}return a},{})}))}hashEntityIds(t,n){const r=this.extractEntityPrimaryIds(t,n);return JSON.stringify(r)}}let tde=class{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}async load(e){const t=this.relationIdAttributes.map(async n=>{if(n.relation.isManyToOne||n.relation.isOneToOneOwner){if(n.queryBuilderFactory)throw new xe("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const r={},a=e.map(o=>{const i={},s=[];n.relation.joinColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l.referencedColumn);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),n.relation.entityMetadata.primaryColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),s.sort();const c=s.join("::");return r[c]?null:(r[c]=!0,i)}).filter(o=>o);return{relationIdAttribute:n,results:a}}else if(n.relation.isOneToMany||n.relation.isOneToOneNotOwner){const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.joinColumns,o=r.inverseEntityMetadata.target,i=r.inverseEntityMetadata.tableName,s=n.alias||i,c={},l={},u=e.map((p,y)=>{const m=[],v={},b=a.map(_=>{const x=_.databaseName+y,j=p[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,_.referencedColumn.databaseName)],S=`${s}:${_.propertyPath}:${j}`;return m.indexOf(S)!==-1?"":(m.push(S),v[x]=j,s+"."+_.propertyPath+" = :"+x)}).filter(_=>_).join(" AND ");m.sort();const w=m.join("::");return c[w]?"":(c[w]=!0,Object.assign(l,v),b)}).filter(p=>p).map(p=>"("+p+")").join(" OR ");if(!u)return{relationIdAttribute:n,results:[]};const d=this.connection.createQueryBuilder(this.queryRunner);jn.uniq([...a,...r.inverseRelation.entityMetadata.primaryColumns],p=>p.propertyPath).forEach(p=>{d.addSelect(s+"."+p.propertyPath,p.databaseName)}),d.from(o,s).where("("+u+")").setParameters(l),n.queryBuilderFactory&&n.queryBuilderFactory(d);const f=await d.getRawMany();return f.forEach(p=>{a.forEach(y=>{p[y.databaseName]=this.connection.driver.prepareHydratedValue(p[y.databaseName],y.referencedColumn)}),r.inverseRelation.entityMetadata.primaryColumns.forEach(y=>{p[y.databaseName]=this.connection.driver.prepareHydratedValue(p[y.databaseName],y)})}),{relationIdAttribute:n,results:f}}else{const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.inverseJoinColumns,o=r.isOwning?r.inverseJoinColumns:r.inverseRelation.joinColumns,i=n.junctionAlias,s=n.joinInverseSideMetadata.tableName,c=n.alias||s,l=r.isOwning?r.junctionEntityMetadata.tableName:r.inverseRelation.junctionEntityMetadata.tableName,u=e.map(w=>a.reduce((_,x)=>(_[x.propertyPath]=w[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,x.referencedColumn.databaseName)],_),{}));if(u.length===0)return{relationIdAttribute:n,results:[]};const d={},f={},p=u.map((w,_)=>{const x=[],j={},S=Object.keys(w).map(O=>{const M=O+_,N=w[O],P=`${i}:${O}:${N}`;return x.indexOf(P)!==-1?"":(x.push(P),j[M]=N,i+"."+O+" = :"+M)}).filter(O=>O).join(" AND ");x.sort();const E=x.join("::");return f[E]?"":(f[E]=!0,Object.assign(d,j),S)}).filter(w=>w),y=o.map(w=>i+"."+w.propertyPath+" = "+c+"."+w.referencedColumn.propertyPath).join(" AND "),m=p.map(w=>"("+w+" AND "+y+")").join(" OR "),v=this.connection.createQueryBuilder(this.queryRunner);o.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),a.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),v.from(s,c).innerJoin(l,i,m).setParameters(d),n.queryBuilderFactory&&n.queryBuilderFactory(v);const b=await v.getRawMany();return b.forEach(w=>{[...a,...o].forEach(_=>{w[_.databaseName]=this.connection.driver.prepareHydratedValue(w[_.databaseName],_.referencedColumn)})}),{relationIdAttribute:n,results:b}}});return Promise.all(t)}};class nde{constructor(t,n){this.connection=t,this.queryRunner=n}load(t,n,r){const a=Array.isArray(n)?n:[n],o=Array.isArray(r)?r:r?[r]:void 0;return t.isManyToMany?this.loadForManyToMany(t,a,o):t.isManyToOne||t.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(t,a,o):this.loadForOneToManyAndOneToOneNotOwner(t,a,o)}async loadManyToManyRelationIdsAndGroup(t,n,r,a){const o=t.isManyToMany||t.isOneToMany,i=Array.isArray(n)?n:[n];if(!r&&(r=await this.connection.relationLoader.load(t,n,this.queryRunner,a),!r.length))return i.map(d=>({entity:d,related:o?[]:void 0}));const s=await this.load(t,n,r),c=Array.isArray(r)?r:[r];let l=[],u=[];return t.isManyToManyOwner?(l=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn)):t.isManyToManyNotOwner?(l=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn)):t.isManyToOne||t.isOneToOneOwner?(l=t.joinColumns.map(d=>d.referencedColumn),u=t.entityMetadata.primaryColumns):(t.isOneToMany||t.isOneToOneNotOwner)&&(l=t.inverseRelation.entityMetadata.primaryColumns,u=t.inverseRelation.joinColumns.map(d=>d.referencedColumn)),i.map(d=>{const f={entity:d,related:o?[]:void 0},p=s.filter(y=>u.every(m=>m.compareEntityValue(d,y[m.entityMetadata.name+"_"+m.propertyAliasName])));return p.length&&c.forEach(y=>{p.forEach(m=>{l.every(v=>v.compareEntityValue(y,m[ve.buildAlias(this.connection.driver,void 0,v.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+v.propertyPath.replace(".","_"))]))&&(o?f.related.push(y):f.related=y)})}),f})}loadForManyToMany(t,n,r){const a=t.junctionEntityMetadata,o=a.name,i=t.isOwning?a.ownerColumns:a.inverseColumns,s=t.isOwning?a.inverseColumns:a.ownerColumns,c=this.connection.createQueryBuilder(this.queryRunner);i.forEach(f=>{const p=ve.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+f.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+f.propertyPath,p)}),s.forEach(f=>{const p=ve.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+f.propertyPath,p)});let l="";if(i.length===1){const f=n.map(p=>i[0].referencedColumn.getEntityValue(p));f.every(p=>typeof p=="number")?l=`${o}.${i[0].propertyPath} IN (${f.join(", ")})`:(c.setParameter("values1",f),l=o+"."+i[0].propertyPath+" IN (:...values1)")}else l="("+n.map((f,p)=>i.map(y=>{const m="entity1_"+p+"_"+y.propertyName;return c.setParameter(m,y.referencedColumn.getEntityValue(f)),o+"."+y.propertyPath+" = :"+m}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";let u="";if(r)if(s.length===1){const f=r.map(p=>s[0].referencedColumn.getEntityValue(p));f.every(p=>typeof p=="number")?u=`${o}.${s[0].propertyPath} IN (${f.join(", ")})`:(c.setParameter("values2",f),u=o+"."+s[0].propertyPath+" IN (:...values2)")}else u="("+r.map((f,p)=>s.map(y=>{const m="entity2_"+p+"_"+y.propertyName;return c.setParameter(m,y.referencedColumn.getEntityValue(f)),o+"."+y.propertyPath+" = :"+m}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";const d=[l,u].filter(f=>f.length>0).join(" AND ");return c.from(a.target,o).where(d).getRawMany()}loadForManyToOneAndOneToOneOwner(t,n,r){const a=t.entityMetadata.targetName,o=t.joinColumns.every(c=>!!t.entityMetadata.nonVirtualColumns.find(l=>l===c));if(r&&o){let c=[];if(n.forEach(l=>{let u={};t.entityMetadata.primaryColumns.forEach(d=>{const f=d.entityMetadata.name+"_"+d.propertyPath.replace(".","_");u[f]=d.getEntityValue(l)}),r.forEach(d=>{t.joinColumns.forEach(f=>{const p=f.getEntityValue(l),y=f.referencedColumn.getEntityValue(d);if(!(p===void 0||y===void 0)&&p===y){const m=f.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_");u[m]=y}})}),Object.keys(u).length===t.entityMetadata.primaryColumns.length+t.joinColumns.length&&c.push(u)}),c.length===n.length)return Promise.resolve(c)}const i=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.entityMetadata.name+"_"+c.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)}),t.joinColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+c.referencedColumn.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)});let s="";if(t.entityMetadata.primaryColumns.length===1){const c=n.map(l=>t.entityMetadata.primaryColumns[0].getEntityValue(l));c.every(l=>typeof l=="number")?s=`${a}.${t.entityMetadata.primaryColumns[0].propertyPath} IN (${c.join(", ")})`:(i.setParameter("values",c),s=a+"."+t.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else s=n.map((c,l)=>t.entityMetadata.primaryColumns.map((u,d)=>{const f="entity"+l+"_"+d;return i.setParameter(f,u.getEntityValue(c)),a+"."+u.propertyPath+" = :"+f}).join(" AND ")).map(c=>"("+c+")").join(" OR ");return i.from(t.entityMetadata.target,a).where(s).getRawMany()}loadForOneToManyAndOneToOneNotOwner(t,n,r){if(t=t.inverseRelation,t.entityMetadata.primaryColumns.length===t.joinColumns.length&&t.entityMetadata.primaryColumns.every(s=>t.joinColumns.indexOf(s)!==-1))return Promise.resolve(n.map(s=>{const c={};return t.joinColumns.forEach(function(l){const u=l.referencedColumn.getEntityValue(s),d=l.referencedColumn.entityMetadata.name+"_"+l.referencedColumn.propertyPath.replace(".","_"),f=l.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+l.propertyPath.replace(".","_");c[d]=u,c[f]=u}),c}));const a=t.entityMetadata.targetName,o=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+s.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)}),t.joinColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.referencedColumn.entityMetadata.name+"_"+s.referencedColumn.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)});let i="";if(t.joinColumns.length===1){const s=n.map(c=>t.joinColumns[0].referencedColumn.getEntityValue(c));s.every(c=>typeof c=="number")?i=`${a}.${t.joinColumns[0].propertyPath} IN (${s.join(", ")})`:(o.setParameter("values",s),i=a+"."+t.joinColumns[0].propertyPath+" IN (:...values)")}else i=n.map((s,c)=>t.joinColumns.map((l,u)=>{const d="entity"+c+"_"+u;return o.setParameter(d,l.referencedColumn.getEntityValue(s)),a+"."+l.propertyPath+" = :"+d}).join(" AND ")).map(s=>"("+s+")").join(" OR ");return o.from(t.entityMetadata.target,a).where(i).getRawMany()}}class rde{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationIdAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationIds.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationIdAttributes.push(r)})})}metadataToAttribute(t,n){return new O_(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class ade{constructor(t,n,r){this.connection=t,this.queryRunner=n,this.relationCountAttributes=r}async load(t){const n=(a,o,i)=>i.indexOf(a)===o,r=this.relationCountAttributes.map(async a=>{if(a.relation.isOneToMany){const o=a.relation,i=o.inverseRelation,s=i.joinColumns[0].referencedColumn.propertyName,c=o.inverseEntityMetadata.target,l=o.inverseEntityMetadata.tableName,u=a.alias||l,d=i.propertyName;let f=t.map(y=>y[a.parentAlias+"_"+s]).filter(y=>!!y);if(f=f.filter(n),f.length===0)return{relationCountAttribute:a,results:[]};const p=this.connection.createQueryBuilder(this.queryRunner);return p.select(u+"."+d,"parentId").addSelect("COUNT(*)","cnt").from(c,u).where(u+"."+d+" IN (:...ids)").addGroupBy(u+"."+d).setParameter("ids",f),a.queryBuilderFactory&&a.queryBuilderFactory(p),{relationCountAttribute:a,results:await p.getRawMany()}}else{let o,i,s,c;a.relation.isOwning?(o=a.relation.joinColumns[0].referencedColumn.databaseName,i=a.relation.inverseJoinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[0],c=a.relation.junctionEntityMetadata.columns[1]):(o=a.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,i=a.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[1],c=a.relation.junctionEntityMetadata.columns[0]);let l=t.map(v=>v[a.parentAlias+"_"+o]).filter(v=>!!v);if(l=l.filter(n),l.length===0)return{relationCountAttribute:a,results:[]};const u=a.junctionAlias,d=a.joinInverseSideMetadata.tableName,f=a.alias||d,p=a.relation.junctionEntityMetadata.tableName,y=u+"."+s.propertyName+" IN ("+l.map(v=>isNaN(v)?"'"+v+"'":v)+") AND "+u+"."+c.propertyName+" = "+f+"."+i,m=this.connection.createQueryBuilder(this.queryRunner);return m.select(u+"."+s.propertyName,"parentId").addSelect("COUNT("+m.escape(f)+"."+m.escape(i)+")","cnt").from(d,f).innerJoin(p,u,y).addGroupBy(u+"."+s.propertyName),a.queryBuilderFactory&&a.queryBuilderFactory(m),{relationCountAttribute:a,results:await m.getRawMany()}}});return Promise.all(r)}}class ode{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationCountAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationCounts.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationCountAttributes.push(r)})})}metadataToAttribute(t,n){return new C_(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class k_{static isFindOneOptions(t){const n=t;return n&&(Array.isArray(n.select)||Array.isArray(n.relations)||typeof n.select=="object"||typeof n.relations=="object"||typeof n.where=="object"||typeof n.join=="object"||typeof n.order=="object"||typeof n.cache=="object"||typeof n.cache=="boolean"||typeof n.cache=="number"||typeof n.comment=="string"||typeof n.lock=="object"||typeof n.loadRelationIds=="object"||typeof n.loadRelationIds=="boolean"||typeof n.loadEagerRelations=="boolean"||typeof n.withDeleted=="boolean"||typeof n.relationLoadStrategy=="string"||typeof n.transaction=="boolean")}static isFindManyOptions(t){const n=t;return n&&(this.isFindOneOptions(n)||typeof n.skip=="number"||typeof n.take=="number"||typeof n.skip=="string"||typeof n.take=="string")}static extractFindManyOptionsAlias(t){if(this.isFindManyOptions(t)&&t.join)return t.join.alias}static applyOptionsToTreeQueryBuilder(t,n){if(n!=null&&n.relations){const r=[...n.relations];if(k_.applyRelationsRecursively(t,r,t.expressionMap.mainAlias.name,t.expressionMap.mainAlias.metadata,""),r.length>0)throw new Mue(r)}return t}static applyRelationsRecursively(t,n,r,a,o){let i=[];if(o){const s=new RegExp("^"+o.replace(".","\\.")+"\\.");i=n.filter(c=>c.match(s)).map(c=>a.findRelationWithPropertyPath(c.replace(s,""))).filter(c=>c)}else i=n.map(s=>a.findRelationWithPropertyPath(s)).filter(s=>s);i.forEach(s=>{let c=ve.buildAlias(t.connection.driver,{joiner:"__"},r,s.propertyPath);const l=r+"."+s.propertyPath;t.expressionMap.relationLoadStrategy==="query"?t.concatRelationMetadata(s):t.leftJoinAndSelect(l,c),n.splice(n.indexOf(o?o+"."+s.propertyPath:s.propertyPath),1);let u,d;if(t.expressionMap.relationLoadStrategy==="query")u=s.inverseEntityMetadata,d=c;else{const f=t.expressionMap.joinAttributes.find(p=>p.entityOrProperty===l);u=f.metadata,d=f.alias.name}if(!d||!u)throw new Ra(s.propertyPath,a);if(this.applyRelationsRecursively(t,n,d,u,o?o+"."+s.propertyPath:s.propertyPath),t.expressionMap.relationLoadStrategy==="join"){const f=a.relations.find(p=>p.propertyName===s.propertyPath);f&&this.joinEagerRelations(t,c,f.inverseEntityMetadata)}})}static joinEagerRelations(t,n,r){r.eagerRelations.forEach(a=>{let o=ve.buildAlias(t.connection.driver,{joiner:"__"},n,a.propertyName),i=!0;for(const l of t.expressionMap.joinAttributes)if(!(l.condition!==void 0||l.mapToProperty!==void 0||l.isMappingMany!==void 0||l.direction!=="LEFT"||l.entityOrProperty!==`${n}.${a.propertyPath}`)){i=!1,o=l.alias.name;break}const s=!!t.expressionMap.joinAttributes.find(l=>l.alias.name===o);i&&!s&&t.leftJoin(n+"."+a.propertyPath,o);let c=!0;for(const l of t.expressionMap.selects)if(!(l.aliasName!==void 0||l.virtual!==void 0||l.selection!==o)){c=!1;break}c&&t.addSelect(o),this.joinEagerRelations(t,o,a.inverseEntityMetadata)})}}class A_ extends Zt{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createSelectExpression(),t+=this.createJoinExpression(),t+=this.createWhereExpression(),t+=this.createGroupByExpression(),t+=this.createHavingExpression(),t+=this.createOrderByExpression(),t+=this.createLimitOffsetExpression(),t+=this.createLockExpression(),t=t.trim(),this.expressionMap.subQuery&&(t="("+t+")"),this.replacePropertyNamesForTheWholeQuery(t)}setFindOptions(t){return this.findOptions=t,this.applyFindOptions(),this}subQuery(){const t=this.createQueryBuilder();return t.expressionMap.subQuery=!0,t.parentQueryBuilder=this,t}select(t,n){if(this.expressionMap.queryType="select",Array.isArray(t))this.expressionMap.selects=t.map(r=>({selection:r}));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]);return this}addSelect(t,n){if(!t)return this;if(Array.isArray(t))this.expressionMap.selects=this.expressionMap.selects.concat(t.map(r=>({selection:r})));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&this.expressionMap.selects.push({selection:t,aliasName:n});return this}maxExecutionTime(t){return this.expressionMap.maxExecutionTime=t,this}distinct(t=!0){return this.expressionMap.selectDistinct=t,this}distinctOn(t){return this.expressionMap.selectDistinctOn=t,this}fromDummy(){return this.from(this.connection.driver.dummyTableName??"(SELECT 1 AS dummy_column)","dummy_table")}from(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}addFrom(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this}innerJoin(t,n,r,a){return this.join("INNER",t,n,r,a),this}leftJoin(t,n,r,a){return this.join("LEFT",t,n,r,a),this}innerJoinAndSelect(t,n,r,a){return this.addSelect(n),this.innerJoin(t,n,r,a),this}leftJoinAndSelect(t,n,r,a){return this.addSelect(n),this.leftJoin(t,n,r,a),this}innerJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!0),this}innerJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!1,i),this}leftJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!0),this}leftJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!1,i),this}loadRelationIdAndMap(t,n,r,a){const o=new O_(this.expressionMap);return o.mapToProperty=t,o.relationName=n,typeof r=="string"&&(o.alias=r),typeof r=="object"&&r.disableMixedMap&&(o.disableMixedMap=!0),o.queryBuilderFactory=a,this.expressionMap.relationIdAttributes.push(o),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(t,n,r,a){const o=new C_(this.expressionMap);return o.mapToProperty=t,o.relationName=n,o.alias=r,o.queryBuilderFactory=a,this.expressionMap.relationCountAttributes.push(o),this.expressionMap.createAlias({type:"other",name:o.junctionAlias}),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadAllRelationIds(t){return this.expressionMap.mainAlias.metadata.relations.forEach(n=>{t!==void 0&&t.relations!==void 0&&t.relations.indexOf(n.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+n.propertyPath,this.expressionMap.mainAlias.name+"."+n.propertyPath,t)}),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereExists(t){return this.where(...this.getExistsCondition(t))}andWhereExists(t){return this.andWhere(...this.getExistsCondition(t))}orWhereExists(t){return this.orWhere(...this.getExistsCondition(t))}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}having(t,n){return this.expressionMap.havings.push({type:"simple",condition:t}),n&&this.setParameters(n),this}andHaving(t,n){return this.expressionMap.havings.push({type:"and",condition:t}),n&&this.setParameters(n),this}orHaving(t,n){return this.expressionMap.havings.push({type:"or",condition:t}),n&&this.setParameters(n),this}groupBy(t){return t?this.expressionMap.groupBys=[t]:this.expressionMap.groupBys=[],this}addGroupBy(t){return this.expressionMap.groupBys.push(t),this}timeTravelQuery(t){return this.connection.driver.options.type==="cockroachdb"&&(t===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=t),this}orderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){if(this.expressionMap.limit=this.normalizeNumber(t),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new xe('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(t){if(this.expressionMap.offset=this.normalizeNumber(t),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new xe('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(t){if(this.expressionMap.take=this.normalizeNumber(t),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new xe('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(t){if(this.expressionMap.skip=this.normalizeNumber(t),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new xe('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(t){return this.expressionMap.useIndex=t,this}setLock(t,n,r){return this.expressionMap.lockMode=t,this.expressionMap.lockVersion=n,this.expressionMap.lockTables=r,this}setOnLocked(t){return this.expressionMap.onLocked=t,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if(this.expressionMap.lockMode==="optimistic")throw new pd;this.expressionMap.queryEntity=!1;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0);const r=await this.loadRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getRawAndEntities(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getOne(){const t=(await this.getRawAndEntities()).entities[0];if(t&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const n=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const r=n.updateDateColumn.getEntityValue(t);if(r.getTime()!==this.expressionMap.lockVersion.getTime())throw new nL(n.name,this.expressionMap.lockVersion,r)}else{const r=n.versionColumn.getEntityValue(t);if(r!==this.expressionMap.lockVersion)throw new nL(n.name,this.expressionMap.lockVersion,r)}}return t===void 0?null:t}async getOneOrFail(){const t=await this.getOne();if(!t)throw new Eue(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return t}async getMany(){if(this.expressionMap.lockMode==="optimistic")throw new pd;return(await this.getRawAndEntities()).entities}async getCount(){if(this.expressionMap.lockMode==="optimistic")throw new pd;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeCountQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getExists(){if(this.expressionMap.lockMode==="optimistic")throw new pd;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeExistsQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getManyAndCount(){if(this.expressionMap.lockMode==="optimistic")throw new pd;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);this.expressionMap.queryEntity=!1;const a=this.expressionMap.cacheId;this.expressionMap.cacheId=a&&`${a}-count`;const o=await this.executeCountQuery(t),i=[r.entities,o];return n&&await t.commitTransaction(),i}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async stream(){this.expressionMap.queryEntity=!1;const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0);const o=()=>{if(r!==this.queryRunner)return r.release()},i=r.stream(t,n,o,o);return a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}}cache(t,n){return typeof t=="boolean"?this.expressionMap.cache=t:typeof t=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=t):(typeof t=="string"||typeof t=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=t),n&&(this.expressionMap.cacheDuration=n),this}setOption(t){return this.expressionMap.options.push(t),this}join(t,n,r,a,o,i,s,c){o&&this.setParameters(o);const l=new vL(this.connection,this.expressionMap);l.direction=t,l.mapAsEntity=c,l.mapToProperty=i,l.isMappingMany=s,l.entityOrProperty=n,l.condition=a,this.expressionMap.joinAttributes.push(l);const u=l.metadata;if(u){if(u.deleteDateColumn&&!this.expressionMap.withDeleted){const d=`${r}.${u.deleteDateColumn.propertyName} IS NULL`;l.condition=l.condition?` ${l.condition} AND ${d}`:`${d}`}l.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:u}),l.relation&&l.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:l.junctionAlias,metadata:l.relation.junctionEntityMetadata})}else{let d="";if(typeof n=="function"){const p=n(this.subQuery());this.setParameters(p.getParameters()),d=p.getQuery()}else d=n;const f=typeof n=="function"||n.substr(0,1)==="("&&n.substr(-1)===")";l.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:f===!1?n:void 0,subQuery:f===!0?d:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new xe("Cannot build query because main alias is not set (call qb#from method)");const t=[],n=[];if(this.expressionMap.mainAlias.hasMetadata){const s=this.expressionMap.mainAlias.metadata;t.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,s)),n.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,s))}this.expressionMap.joinAttributes.forEach(s=>{if(s.metadata)t.push(...this.buildEscapedEntityColumnSelects(s.alias.name,s.metadata)),n.push(...this.findEntityColumnSelects(s.alias.name,s.metadata));else if(this.expressionMap.selects.some(c=>c.selection===s.alias.name)){t.push({selection:this.escape(s.alias.name)+".*"});const c=this.expressionMap.selects.find(l=>l.selection===s.alias.name);n.push(c)}}),this.expressionMap.selects.filter(s=>n.indexOf(s)===-1).forEach(s=>t.push({selection:this.replacePropertyNames(s.selection),aliasName:s.aliasName})),t.length===0&&t.push({selection:"*"});let r="";this.expressionMap.useIndex&&ve.isMySQLFamily(this.connection.driver)&&(r=` USE INDEX (${this.expressionMap.useIndex})`);const a=this.expressionMap.aliases.filter(s=>s.type==="from"&&(s.tablePath||s.subQuery)).map(s=>s.subQuery?s.subQuery+" "+this.escape(s.name):this.getTableName(s.tablePath)+" "+this.escape(s.name)),o=this.createSelectDistinctExpression(),i=t.map(s=>s.selection+(s.aliasName?" AS "+this.escape(s.aliasName):"")).join(", ");return o+i+" FROM "+a.join(", ")+this.createTableLockExpression()+r}createSelectDistinctExpression(){const{selectDistinct:t,selectDistinctOn:n,maxExecutionTime:r}=this.expressionMap,{driver:a}=this.connection;let o="SELECT ";return r>0&&ve.isMySQLFamily(a)&&(o+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),ve.isPostgresFamily(a)&&n.length>0?o=`SELECT DISTINCT ON (${n.map(i=>this.replacePropertyNames(i)).join(", ")}) `:t&&(o="SELECT DISTINCT "),o}createJoinExpression(){return this.expressionMap.joinAttributes.map(t=>{const n=t.relation,r=t.tablePath,a=t.alias.name;let o=t.condition?" AND ("+t.condition+")":"";const i=t.parentAlias;if(!i||!n){const s=t.alias.subQuery?t.alias.subQuery:this.getTableName(r);return" "+t.direction+" JOIN "+s+" "+this.escape(a)+this.createTableLockExpression()+(t.condition?" ON "+this.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){const s=n.joinColumns.map(c=>a+"."+c.referencedColumn.propertyPath+"="+i+"."+n.propertyPath+"."+c.referencedColumn.propertyPath).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else if(n.isOneToMany||n.isOneToOneNotOwner){const s=n.inverseRelation.joinColumns.map(c=>(n.inverseEntityMetadata.tableType==="entity-child"&&n.inverseEntityMetadata.discriminatorColumn&&(o+=" AND "+a+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),a+"."+n.inverseRelation.propertyPath+"."+c.referencedColumn.propertyPath+"="+i+"."+c.referencedColumn.propertyPath)).join(" AND ");if(!s)throw new xe(`Relation ${n.entityMetadata.name}.${n.propertyName} does not have join columns.`);return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else{const s=n.junctionEntityMetadata.tablePath,c=t.junctionAlias;let l="",u="";return n.isOwning?(l=n.joinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseJoinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND ")):(l=n.inverseRelation.inverseJoinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseRelation.joinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND "))," "+t.direction+" JOIN "+this.getTableName(s)+" "+this.escape(c)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l)+" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(u+o)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const t=this.expressionMap.allOrderBys;return Object.keys(t).length===0?"":" ORDER BY "+Object.keys(t).map(n=>{const r=typeof t[n]=="string"?t[n]:t[n].order+" "+t[n].nulls,a=this.expressionMap.selects.find(o=>o.selection===n);if(a&&!a.aliasName&&n.indexOf(".")!==-1){const o=n.split("."),i=o[0],s=o.slice(1).join("."),c=this.expressionMap.aliases.find(l=>l.name===i);if(c){const l=c.metadata.findColumnWithPropertyPath(s);if(l){const u=ve.buildAlias(this.connection.driver,void 0,i,l.databaseName);return this.escape(u)+" "+r}}}return this.replacePropertyNames(n)+" "+r}).join(", ")}createLimitOffsetExpression(){let t=this.expressionMap.offset,n=this.expressionMap.limit;if(!t&&!n&&this.expressionMap.joinAttributes.length===0&&(t=this.expressionMap.skip,n=this.expressionMap.take),this.connection.driver.options.type==="mssql"){let r="";if((n||t)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(r=" ORDER BY (SELECT NULL)"),n&&t)return r+" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return r+" OFFSET 0 ROWS FETCH NEXT "+n+" ROWS ONLY";if(t)return r+" OFFSET "+t+" ROWS"}else if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)throw new kue}else if(ve.isSQLiteFamily(this.connection.driver)){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" LIMIT -1 OFFSET "+t}else if(this.connection.driver.options.type==="oracle"){if(n&&t)return" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return" FETCH NEXT "+n+" ROWS ONLY";if(t)return" OFFSET "+t+" ROWS"}else{if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" OFFSET "+t}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const t=this.connection.driver;let n="";if(this.expressionMap.lockTables){if(!(ve.isPostgresFamily(t)||t.options.type==="cockroachdb"))throw new xe("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new xe("lockTables cannot be an empty array");n=" OF "+this.expressionMap.lockTables.join(", ")}let r="";switch(this.expressionMap.onLocked==="nowait"?r=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(r=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(t.options.type==="mysql"||t.options.type==="aurora-mysql")return ve.isReleaseVersionOrGreater(t,"8.0.0")?" FOR SHARE"+n+r:" LOCK IN SHARE MODE";if(t.options.type==="mariadb")return" LOCK IN SHARE MODE";if(ve.isPostgresFamily(t))return" FOR SHARE"+n+r;if(t.options.type==="oracle")return" FOR UPDATE";if(t.options.type==="mssql")return"";throw new xc;case"pessimistic_write":if(ve.isMySQLFamily(t)||t.options.type==="aurora-mysql"||t.options.type==="oracle")return" FOR UPDATE"+r;if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+r;if(t.options.type==="mssql")return"";throw new xc;case"pessimistic_partial_write":if(ve.isPostgresFamily(t))return" FOR UPDATE"+n+" SKIP LOCKED";if(ve.isMySQLFamily(t))return" FOR UPDATE SKIP LOCKED";throw new xc;case"pessimistic_write_or_fail":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+" NOWAIT";if(ve.isMySQLFamily(t))return" FOR UPDATE NOWAIT";throw new xc;case"for_no_key_update":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+n+r;throw new xc;case"for_key_share":if(ve.isPostgresFamily(t))return" FOR KEY SHARE"+n+r;throw new xc;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const t=this.expressionMap.havings.map((n,r)=>{switch(n.type){case"and":return(r>0?"AND ":"")+this.replacePropertyNames(n.condition);case"or":return(r>0?"OR ":"")+this.replacePropertyNames(n.condition);default:return this.replacePropertyNames(n.condition)}}).join(" ");return t.length?" HAVING "+t:""}buildEscapedEntityColumnSelects(t,n){const r=this.expressionMap.selects.some(l=>l.selection===t),a=[];if(r&&a.push(...n.columns.filter(l=>l.isSelect===!0)),a.push(...n.columns.filter(l=>this.expressionMap.selects.some(u=>u.selection===t+"."+l.propertyPath))),a.length===0)return[];const o=this.expressionMap.queryEntity?n.primaryColumns.filter(l=>a.indexOf(l)===-1):[],i=[...a,...o],s=[],c=this.escape(t);return i.forEach(l=>{let u=c+"."+this.escape(l.databaseName);l.isVirtualProperty&&l.query&&(u=`(${l.query(c)})`),this.connection.driver.spatialTypes.indexOf(l.type)!==-1&&((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(u=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${u})`),ve.isPostgresFamily(this.connection.driver)&&(l.precision?u=`ST_AsGeoJSON(${u}, ${l.precision})::json`:u=`ST_AsGeoJSON(${u})::json`),this.connection.driver.options.type==="mssql"&&(u=`${u}.ToString()`));const d=this.expressionMap.selects.filter(f=>f.selection===t+"."+l.propertyPath);if(d.length)d.forEach(f=>{s.push({selection:u,aliasName:f.aliasName?f.aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:f.virtual})});else{if(l.isVirtualProperty)return;s.push({selection:u,aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:r})}}),s}findEntityColumnSelects(t,n){const r=this.expressionMap.selects.find(a=>a.selection===t);return r?[r]:this.expressionMap.selects.filter(a=>n.columns.some(o=>a.selection===t+"."+o.propertyPath))}computeCountExpression(){const t=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(t);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||ve.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+"))";if(ve.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const a=n.map(o=>`${r}.${this.escape(o.databaseName)}`).join(", '|;|', ");return n.length===1?`COUNT(DISTINCT(${a}))`:`COUNT(DISTINCT(CONCAT(${a})))`}return this.connection.driver.options.type==="spanner"?n.length===1?`COUNT(DISTINCT(${r}.${this.escape(n[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${n.map(a=>`CAST(${r}.${this.escape(a.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(" || '|;|' || ")+"))"}async executeCountQuery(t){const n=this.computeCountExpression(),r=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(n,"cnt").setOption("disable-global-order").loadRawResults(t);return!r||!r[0]||!r[0].cnt?0:parseInt(r[0].cnt)}async executeExistsQuery(t){return(await this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(t)).length>0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const t=Array.isArray(this.findOptions.select)?jn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(t,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const t=Array.isArray(this.findOptions.relations)?jn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(t=>{t.select&&!t.selection?t.type==="inner"?this.innerJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):t.type==="inner"?this.innerJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(t=>{this.leftJoin(this.findOptions.join.leftJoin[t],t)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(t=>{this.innerJoin(this.findOptions.join.innerJoin[t],t)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(t=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[t],t)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(t=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[t],t)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const t=this.findOptions.lock.tables?this.findOptions.lock.tables.map(n=>{const r=this.expressionMap.aliases.find(a=>a.metadata.tableNameWithoutPrefix===n);if(!r)throw new xe(`"${n}" is not part of this query`);return this.escape(r.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,t),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&k_.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(t){this.relationMetadatas.push(t)}async executeEntitiesAndRawResults(t){if(!this.expressionMap.mainAlias)throw new xe('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!t.isTransactionActive)throw new Pue;if(this.expressionMap.lockMode==="optimistic"){const i=this.expressionMap.mainAlias.metadata;if(!i.versionColumn&&!i.updateDateColumn)throw new Cue(i.name)}const n=new tde(this.connection,t,this.expressionMap.relationIdAttributes),r=new ade(this.connection,t,this.expressionMap.relationCountAttributes);new rde(this.expressionMap).transform(),new ode(this.expressionMap).transform();let a=[],o=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[i,s]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),c=this.expressionMap.mainAlias.metadata,l=this.expressionMap.mainAlias.name,u=c.primaryColumns.map(p=>{const y=this.escape("distinctAlias"),m=this.escape(ve.buildAlias(this.connection.driver,void 0,l,p.databaseName));s[m]||(s[m]="ASC");const v=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,p.databaseName);return`${y}.${m} AS ${this.escape(v)}`}),d=this.clone(),f=d.expressionMap.timeTravel;if(a=await new A_(this.connection,t).select(`DISTINCT ${u.join(", ")}`).addSelect(i).from(`(${d.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(f).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(s).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),a.length>0){let p="";const y={};if(c.hasMultiplePrimaryKeys)p=a.map((m,v)=>c.primaryColumns.map(b=>{const w=`orm_distinct_ids_${v}_${b.databaseName}`,_=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,b.databaseName);return y[w]=m[_],`${l}.${b.propertyPath}=:${w}`}).join(" AND ")).join(" OR ");else{const m=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,c.primaryColumns[0].databaseName),v=a.map(b=>b[m]);v.every(b=>typeof b=="number")?p=`${l}.${c.primaryColumns[0].propertyPath} IN (${v.join(", ")})`:(y.orm_distinct_ids=v,p=l+"."+c.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}a=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:p}).setParameters(y).loadRawResults(t)}}else a=await this.loadRawResults(t);if(a.length>0){const i=await n.load(a),s=await r.load(a);o=new ede(this.expressionMap,this.connection.driver,i,s,this.queryRunner).transform(a,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,o)}if(this.expressionMap.relationLoadStrategy==="query"){const i=new nde(this.connection,t);await Promise.all(this.relationMetadatas.map(async s=>{const c=s.inverseEntityMetadata.target,l=s.inverseEntityMetadata.targetName,u=Array.isArray(this.findOptions.select)?jn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,d=Array.isArray(this.findOptions.relations)?jn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,f=this.createQueryBuilder(t).select(l).from(c,l).setFindOptions({select:u?jn.deepValue(u,s.propertyPath):void 0,order:this.findOptions.order?jn.deepValue(this.findOptions.order,s.propertyPath):void 0,relations:d?jn.deepValue(d,s.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(o.length>0){const p=await i.loadManyToManyRelationIdsAndGroup(s,o,void 0,f);o.forEach(y=>{const m=p.find(v=>v.entity===y);if(m){const v=m.related===void 0?null:m.related;s.setEntityValue(y,v)}})}}))}return{raw:a,entities:o}}createOrderByCombinedWithSelectExpression(t){const n=this.expressionMap.allOrderBys,r=Object.keys(n).map(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);return this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))}else return this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?this.escape(t)+"."+this.escape(o):""}).join(", "),a={};return Object.keys(n).forEach(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);a[this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))]=n[o]}else this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?a[this.escape(t)+"."+this.escape(o)]=n[o]:a[o]=n[o]}),[r,a]}async loadRawResults(t){const[n,r]=this.getQueryAndParameters(),a=n+" -- PARAMETERS: "+JSON.stringify(r,(u,d)=>typeof d=="bigint"?d.toString():d),o=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let i;const s=o.alwaysEnabled&&this.expressionMap.cache!==!1||this.expressionMap.cache===!0;let c=!1;if(this.connection.queryResultCache&&s)try{if(i=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:a,duration:this.expressionMap.cacheDuration||o.duration||1e3},t),i&&!this.connection.queryResultCache.isExpired(i))return JSON.parse(i.result)}catch(u){if(!o.ignoreErrors)throw u;c=!0}const l=await t.query(n,r,!0);if(!c&&this.connection.queryResultCache&&s)try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:a,time:new Date().getTime(),duration:this.expressionMap.cacheDuration||o.duration||1e3,result:JSON.stringify(l.records)},i,t)}catch(u){if(!o.ignoreErrors)throw u}return l.records}mergeExpressionMap(t){return tn.assign(this.expressionMap,t),this}normalizeNumber(t){return typeof t=="number"||t===void 0||t===null?t:Number(t)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner(this.connection.defaultReplicationModeForReads())}buildSelect(t,n,r,a){for(let o in t){if(t[o]===void 0||t[o]===!1)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Ra(i,n);s?this.selects.push(r+"."+i):c&&this.buildSelect(t[o],n,r,i)}}buildRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Ra(c,r);if(l)this.buildRelations(s,typeof n=="object"?jn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(u):(this.joins.push({type:"left",select:!0,selection:n&&typeof n[i]=="object"?n[i]:void 0,alias:d,parentAlias:a,relationMetadata:u}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d))),typeof s=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(s,typeof n=="object"?jn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildEagerRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Ra(c,r);if(l)this.buildEagerRelations(s,typeof n=="object"?jn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&u.inverseEntityMetadata.eagerRelations.forEach(f=>{let p=d+"_"+f.propertyPath.replace(".","_");p=ve.buildAlias(this.connection.driver,{joiner:"__"},d,p),this.joins.find(y=>y.alias===p)||this.joins.push({type:"left",select:!0,alias:p,parentAlias:d,selection:void 0,relationMetadata:f}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d)}),typeof s=="object"&&this.buildEagerRelations(s,typeof n=="object"?jn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildOrder(t,n,r,a){for(let o in t){if(t[o]===void 0)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Ra(i,n);if(s){let u=typeof t[o]=="object"?t[o].direction:t[o];u=u==="DESC"||u==="desc"||u===-1?"DESC":"ASC";let d=typeof t[o]=="object"?t[o].nulls:void 0;d=(d==null?void 0:d.toLowerCase())==="first"?"NULLS FIRST":(d==null?void 0:d.toLowerCase())==="last"?"NULLS LAST":void 0;let f=`${r}.${i}`;this.addOrderBy(f,u,d)}else if(c)this.buildOrder(t[o],n,r,i);else if(l){let u=r+"_"+i.replace(".","_");u=ve.buildAlias(this.connection.driver,{joiner:"__"},r,u),this.joins.find(d=>d.alias===u)||this.joins.push({type:"left",select:!1,alias:u,parentAlias:r,selection:void 0,relationMetadata:l}),this.buildOrder(t[o],l.inverseEntityMetadata,u)}}}buildWhere(t,n,r,a){let o="";if(Array.isArray(t))t.length&&(o=t.map(i=>this.buildWhere(i,n,r,a)).filter(i=>!!i).map(i=>"("+i+")").join(" OR "));else{let i=[];for(let s in t){if(t[s]===void 0||t[s]===null)continue;const c=a?a+"."+s:s,l=n.findColumnWithPropertyPathStrict(c),u=n.findEmbeddedWithPropertyPath(c),d=n.findRelationWithPropertyPath(c);if(!u&&!l&&!d)throw new Ra(c,n);if(l){let f=`${r}.${c}`;l.isVirtualProperty&&l.query&&(f=`(${l.query(r)})`);let p=t[s];Pt.isEqualOperator(t[s])&&(p=t[s].value),l.transformer&&(p instanceof hd?p.transformValue(l.transformer):p=M_.transformTo(l.transformer,p)),i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(f,p)))}else if(u){const f=this.buildWhere(t[s],n,r,c);f&&i.push(f)}else if(d){if(typeof t[s]=="object"&&Object.keys(t[s]).every(f=>t[s][f]===void 0))continue;if(Pt.isFindOperator(t[s]))if(t[s].type==="moreThan"||t[s].type==="lessThan"||t[s].type==="moreThanOrEqual"||t[s].type==="lessThanOrEqual"){let f="";t[s].type==="moreThan"?f=">":t[s].type==="lessThan"?f="<":t[s].type==="moreThanOrEqual"?f=">=":t[s].type==="lessThanOrEqual"&&(f="<=");const p=this.subQuery();if(d.isManyToManyOwner)p.select("COUNT(*)").from(d.joinTableName,d.joinTableName).where(d.joinColumns.map(y=>`${d.joinTableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else if(d.isManyToManyNotOwner)p.select("COUNT(*)").from(d.inverseRelation.joinTableName,d.inverseRelation.joinTableName).where(d.inverseRelation.inverseJoinColumns.map(y=>`${d.inverseRelation.joinTableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else if(d.isOneToMany)p.select("COUNT(*)").from(d.inverseEntityMetadata.target,d.inverseEntityMetadata.tableName).where(d.inverseRelation.joinColumns.map(y=>`${d.inverseEntityMetadata.tableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(p.getSql()+" "+f+" "+parseInt(t[s].value))}else if(d.isManyToOne||d.isOneToOne&&d.isOneToOneOwner){const f=`${r}.${c}`;i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(f,t[s])))}else throw new Error("This relation isn't supported by given find operator");else{let f=r+"_"+d.propertyPath.replace(".","_");f=ve.buildAlias(this.connection.driver,{joiner:"__"},r,f),this.joins.find(y=>y.alias===f)||this.joins.push({type:"left",select:!1,selection:void 0,alias:f,parentAlias:r,relationMetadata:d});const p=this.buildWhere(t[s],d.inverseEntityMetadata,f);p&&i.push(p)}}}o=i.length?"("+i.join(") AND (")+")":i.join(" AND ")}return o.length?"("+o+")":o}}class SL{constructor(){this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class ide extends Zt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("SoftDeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createUpdateExpression();return t+=this.createCteExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("BeforeSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("BeforeRecover",this.expressionMap.mainAlias.metadata));const r=new P_(t,this.expressionMap);this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=r.getSoftDeletionReturningColumns());const[a,o]=this.getQueryAndParameters(),i=await t.query(a,o,!0),s=SL.from(i);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await r.update(s,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("AfterSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("AfterRecover",this.expressionMap.mainAlias.metadata)),n&&await t.commitTransaction(),s}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}from(t,n){t=Pt.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new rm;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!t)throw new xe(`Cannot get entity metadata for the given alias "${this.expressionMap.mainAlias}"`);if(!t.deleteDateColumn)throw new Oue(t);const n=[];switch(this.expressionMap.queryType){case"soft-delete":n.push(this.escape(t.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":n.push(this.escape(t.deleteDateColumn.databaseName)+" = NULL");break;default:throw new xe('The queryType must be "soft-delete" or "restore"')}if(t.versionColumn&&n.push(this.escape(t.versionColumn.databaseName)+" = "+this.escape(t.versionColumn.databaseName)+" + 1"),t.updateDateColumn&&n.push(this.escape(t.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),n.length<=0)throw new m_;const r=this.createWhereExpression(),a=this.createReturningExpression("update");return a===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")} OUTPUT ${a}${r}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r} RETURNING ${a}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver))return" LIMIT "+t;throw new rL}return""}}class sde extends Zt{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("UpdateQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createUpdateExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("BeforeUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet);let r=null,a=null;const o=new P_(t,this.expressionMap),i=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const f of this.expressionMap.returning)i.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(f));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=o.getUpdationReturningColumns(),i.push(...this.expressionMap.extraReturningColumns.filter(f=>!i.includes(f)))),i.length>0&&this.connection.driver.options.type==="mssql"&&(r=this.connection.driver.buildTableVariableDeclaration("@OutputTable",i),a="SELECT * FROM @OutputTable");const[s,c]=this.getQueryAndParameters(),l=[r,s,a],u=await t.query(l.filter(f=>f!=null).join(`;

`),c,!0),d=SL.from(u);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await o.update(d,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("AfterUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),n&&await t.commitTransaction(),d}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}set(t){return this.expressionMap.valuesSet=t,this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new rm;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.getValueSet(),n=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,r={};for(let c in t)t[c]!==void 0&&(r[c]=t[c]);const a=[],o=[];if(n?(this.createPropertyPath(n,r).forEach(c=>{const l=n.findColumnsWithPropertyPath(c);if(l.length<=0)throw new Ra(c,n);l.forEach(u=>{if(!u.isUpdate||o.includes(u))return;o.push(u);let d=u.getEntityValue(r);if(u.referencedColumn&&typeof d=="object"&&!(d instanceof Date)&&d!==null&&!vn.isBuffer(d)?d=u.referencedColumn.getEntityValue(d):typeof d!="function"&&(d=this.connection.driver.preparePersistentValue(d,u)),typeof d=="function")a.push(this.escape(u.databaseName)+" = "+d());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&d===null)a.push(this.escape(u.databaseName)+" = NULL");else{this.connection.driver.options.type==="mssql"&&(d=this.connection.driver.parametrizeValue(u,d));const f=this.createParameter(d);let p=null;if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1){const y=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";u.srid!=null?p=`${y}(${f}, ${u.srid})`:p=`${y}(${f})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?u.srid!=null?p=`ST_SetSRID(ST_GeomFromGeoJSON(${f}), ${u.srid})::${u.type}`:p=`ST_GeomFromGeoJSON(${f})::${u.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?p=u.type+"::STGeomFromText("+f+", "+(u.srid||"0")+")":p=f;a.push(this.escape(u.databaseName)+" = "+p)}})}),(a.length>0||Object.keys(r).length===0)&&(n.versionColumn&&o.indexOf(n.versionColumn)===-1&&a.push(this.escape(n.versionColumn.databaseName)+" = "+this.escape(n.versionColumn.databaseName)+" + 1"),n.updateDateColumn&&o.indexOf(n.updateDateColumn)===-1&&a.push(this.escape(n.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"))):Object.keys(r).map(c=>{let l=r[c];if(typeof l=="function")a.push(this.escape(c)+" = "+l());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&l===null)a.push(this.escape(c)+" = NULL");else{const u=this.createParameter(l);a.push(this.escape(c)+" = "+u)}}),a.length<=0)throw new m_;const i=this.createWhereExpression(),s=this.createReturningExpression("update");return s===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")} OUTPUT ${s}${i}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i} RETURNING ${s}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")return" LIMIT "+t;throw new rL}return""}getValueSet(){if(typeof this.expressionMap.valuesSet=="object")return this.expressionMap.valuesSet;throw new m_}}function cde(){Zt.registerQueryBuilderClass("DeleteQueryBuilder",e=>new Wue(e)),Zt.registerQueryBuilderClass("InsertQueryBuilder",e=>new Que(e)),Zt.registerQueryBuilderClass("RelationQueryBuilder",e=>new Yue(e)),Zt.registerQueryBuilderClass("SelectQueryBuilder",e=>new A_(e)),Zt.registerQueryBuilderClass("SoftDeleteQueryBuilder",e=>new ide(e)),Zt.registerQueryBuilderClass("UpdateQueryBuilder",e=>new sde(e))}var EL;(function(e){e.VIEW="VIEW",e.MATERIALIZED_VIEW="MATERIALIZED_VIEW",e.GENERATED_COLUMN="GENERATED_COLUMN"})(EL||(EL={}));var T_={exports:{}},R_,OL;function lde(){if(OL)return R_;OL=1;var e=1e3,t=e*60,n=t*60,r=n*24,a=r*7,o=r*365.25;R_=function(u,d){d=d||{};var f=typeof u;if(f==="string"&&u.length>0)return i(u);if(f==="number"&&isFinite(u))return d.long?c(u):s(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function i(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var f=parseFloat(d[1]),p=(d[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return f*o;case"weeks":case"week":case"w":return f*a;case"days":case"day":case"d":return f*r;case"hours":case"hour":case"hrs":case"hr":case"h":return f*n;case"minutes":case"minute":case"mins":case"min":case"m":return f*t;case"seconds":case"second":case"secs":case"sec":case"s":return f*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function s(u){var d=Math.abs(u);return d>=r?Math.round(u/r)+"d":d>=n?Math.round(u/n)+"h":d>=t?Math.round(u/t)+"m":d>=e?Math.round(u/e)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=r?l(u,d,r,"day"):d>=n?l(u,d,n,"hour"):d>=t?l(u,d,t,"minute"):d>=e?l(u,d,e,"second"):u+" ms"}function l(u,d,f,p){var y=d>=f*1.5;return Math.round(u/f)+" "+p+(y?"s":"")}return R_}var I_,CL;function ude(){if(CL)return I_;CL=1;function e(t){r.debug=r,r.default=r,r.coerce=l,r.disable=i,r.enable=o,r.enabled=s,r.humanize=lde(),r.destroy=u,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function n(d){let f=0;for(let p=0;p<d.length;p++)f=(f<<5)-f+d.charCodeAt(p),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=n;function r(d){let f,p=null,y,m;function v(...b){if(!v.enabled)return;const w=v,_=Number(new Date),x=_-(f||_);w.diff=x,w.prev=f,w.curr=_,f=_,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let j=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(S,E)=>{if(S==="%%")return"%";j++;const O=r.formatters[E];if(typeof O=="function"){const M=b[j];S=O.call(w,M),b.splice(j,1),j--}return S}),r.formatArgs.call(w,b),(w.log||r.log).apply(w,b)}return v.namespace=d,v.useColors=r.useColors(),v.color=r.selectColor(d),v.extend=a,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(y!==r.namespaces&&(y=r.namespaces,m=r.enabled(d)),m),set:b=>{p=b}}),typeof r.init=="function"&&r.init(v),v}function a(d,f){const p=r(this.namespace+(typeof f>"u"?":":f)+d);return p.log=this.log,p}function o(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let f;const p=(typeof d=="string"?d:"").split(/[\s,]+/),y=p.length;for(f=0;f<y;f++)p[f]&&(d=p[f].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...r.names.map(c),...r.skips.map(c).map(f=>"-"+f)].join(",");return r.enable(""),d}function s(d){if(d[d.length-1]==="*")return!0;let f,p;for(f=0,p=r.skips.length;f<p;f++)if(r.skips[f].test(d))return!1;for(f=0,p=r.names.length;f<p;f++)if(r.names[f].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return I_=e,I_}var NL;function dde(){return NL||(NL=1,function(e,t){var n={};t.formatArgs=a,t.save=o,t.load=i,t.useColors=r,t.storage=s(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,f=0;l[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(f=d))}),l.splice(f,0,u)}t.log=console.debug||console.log||(()=>{});function o(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function i(){let l;try{l=t.storage.getItem("debug")}catch{}return!l&&typeof bn<"u"&&"env"in bn&&(l=n.DEBUG),l}function s(){try{return localStorage}catch{}}e.exports=ude()(t);const{formatters:c}=e.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(T_,T_.exports)),T_.exports}dde(),cde();const ML=(e,t)=>({id:e.id,type:e.node_type,position:{x:e.x||0,y:e.y||0},width:e.width||void 0,height:e.height||void 0,data:{loading:!1,flowNode:e,...t}}),fde=e=>({id:e.id,target:e.target,source:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),PL=e=>({id:e.id,source:e.source,target:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),pde=e=>e.filter(t=>"edgeId"in t?`${t.edgeId}`.startsWith("xy-edge__"):!1),D_=(e,t,n)=>{const r=[];return{changes:e.map(a=>{var c;const o=t.find(l=>a.id===l.id);o||r.push(a.id);const i=(c=n==null?void 0:n[a.source_type])==null?void 0:c.find(l=>(l==null?void 0:l.id)===a.source_id),s=ML(a,{...o==null?void 0:o.data,entity:i});return{type:o?"replace":"add",id:a.id,item:o?nm({...o||{},data:void 0},Uu(s,Wu)):s}}),newIds:[]}},L_=(e,t)=>{const n=[],r=[],a=e.map(o=>{const i=t.find(s=>o.source===s.source&&o.target===s.target);return!i||i.id!==o.id?(i&&r.push(i.id),{type:"add",item:PL(o)}):(n.push(o.id),{type:"replace",item:PL(o)})});return t.forEach(o=>{n.includes(o.id)||r.push(o.id)}),{changes:a,updatedIds:n,deletedIds:r}},$_={width:440,height:360},om={width:380,height:650},md={[oe.Toolbox]:"toolbox",[oe.SessionInfo]:"session-info",[oe.DefaultEmbeddingModel]:"default-embedding-model",[oe.ApplicationBar]:"application-bar"},hde={id:md[oe.Toolbox],type:oe.Toolbox,position:{x:10+om.width+20,y:10},measured:$_,data:{}},mde={id:md[oe.SessionInfo],type:oe.SessionInfo,position:{x:10,y:10},measured:om,data:{}},yde={id:md[oe.DefaultEmbeddingModel],type:oe.DefaultEmbeddingModel,position:{x:10+om.width+$_.width+40,y:10},data:{model:GTe}},gde={id:md[oe.ApplicationBar],type:oe.ApplicationBar,position:{x:10+om.width+$_.width+40,y:80},data:{}},vde=[hde,mde,yde,gde],bde=[oe.Toolbox,oe.SessionInfo,oe.ApplicationBar,oe.EditorApp,oe.CodeContainerApp],kL={flowNodes:[],flowEdges:[],ready:!0,flowEdgeLoading:!1,flowNodeLoading:!1,syncedNodes:[],syncedEdges:[],syncNodeQueue:[],syncEdgeQueue:[],edges:[],nodes:vde},im=async e=>{const t=await de("FlowNode").find(e),n=t.reduce((a,o)=>{var i;return a[o.source_type]||(a[o.source_type]=[]),(i=a[o.source_type])==null||i.push(o),a},{}),r={};return await Promise.all(Object.entries(n).map(async([a,o])=>{const i=a;r[i]=await de(i).find({where:{id:Da(o.map(s=>s.source_id))}})})),{flowNodes:t,entityGroups:n,flowNodeDatas:r}},wde=(e,t)=>({reset:()=>{e(kL)},setNodes:n=>{if(typeof n=="function"){e({nodes:n(t().nodes)});return}e({nodes:n})},setEdges:n=>{if(typeof n=="function"){e({edges:n(t().edges)});return}e({edges:n})},updateNodes:n=>{const r=t().nodes;e({nodes:Ji(n,r)})},updateEdges:n=>{const r=t().edges;e({edges:dd(n,r)})},addConnectionToEdges:n=>{const r=t().edges;e({edges:S5(n,r)})},flowNodesToNodes:(n,r={})=>{const a=t().nodes,{changes:o}=D_(n,a,r);e({nodes:Ji(o,a)})},flowEdgesToEdges:n=>{const r=t().edges,{changes:a,updatedIds:o,deletedIds:i}=L_(n,r);r.forEach(s=>{o.includes(s.id)||i.push(s.id)}),i.forEach(s=>{a.push({type:"remove",id:s})}),e({edges:dd(a,r)})},getNodes:n=>t().nodes.filter(r=>n.includes(r.id)),removeSyncNodeQueue:n=>{const{syncNodeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncNodeQueue:r})},removeSyncEdgeQueue:n=>{const{syncEdgeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncEdgeQueue:r})},pushSyncNodeQueue:(n,r)=>{const{syncNodeQueue:a}=t();e({syncNodeQueue:[...a,{query:r,timestamp:Date.now(),syncType:n}]})},pushSyncEdgeQueue:()=>{const{syncEdgeQueue:n}=t();e({syncEdgeQueue:[...n,{timestamp:Date.now()}]})},findFlowNodesWithSource:async(n,r)=>{try{e({flowNodeLoading:!0});const{flowNodes:a,flowNodeDatas:o}=await im(n);if(r!=null&&r.clean)e({flowNodes:a,nodes:a.map(i=>{var c;const s=(c=o==null?void 0:o[i.source_type])==null?void 0:c.find(l=>l.id===i.source_id);return ML(i,{data:s})})});else{const i=t().flowNodes,s=a.map(u=>u.id),c=t().nodes,{changes:l}=D_(a,c,o);e({flowNodes:[...i.filter(u=>!s.includes(u.id)),...a],nodes:Ji(l,c)})}return a}finally{e({flowNodeLoading:!1})}},findFlowEdges:async(n,r)=>{try{e({flowEdgeLoading:!0});const a=await de("FlowEdge").find(n),o=t().flowEdges,i=a.map(s=>s.id);if(r!=null&&r.clean)e({flowEdges:a,edges:a.map(s=>fde(s))});else{const s=t().edges,{changes:c}=L_(a,s);e({flowEdges:[...o.filter(l=>!i.includes(l.id)),...a],edges:dd(c,s)})}return a}finally{e({flowEdgeLoading:!1})}},deleteFlowNode:async n=>{try{if(!n.id&&!n.source_type&&!n.source_id)throw new Error("Missing flow node indentify");const r=await de("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}});if(r){await de("FlowNode").delete(r.id);const a=t().flowNodes;r.source_type&&r.source_id&&await de(r.source_type).delete(r.source_id).catch(i=>{Ko("Failed to delete source entity",r.source_type,r.source_id,i)});const o=t().nodes;e({flowNodes:a.filter(i=>i.id!==r.id),nodes:Ji([{type:"remove",id:r.id}],o)})}}catch(r){Ko("Failed to delete flow node",r)}},deleteFlowEdge:async n=>{try{if(!n.id&&!n.source&&!n.target)throw new Error("Missing flow edge indentify");const r=await de("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}});if(r){await de("FlowEdge").delete(r.id);const a=t().flowEdges;e({flowEdges:a.filter(o=>o.id!==r.id)})}}catch(r){Ko("Failed to delete flow edge",r)}},updateFlowNode:async(n,r)=>{var a;try{if(!((a=Ye.getState().currentSession)!=null&&a.id))throw new Error("Session not found");if(!n.id)throw new Error("Missing flow node indentify");await de("FlowNode").update(n.id,n);const o=t().flowNodes.map(i=>i.id===n.id?{...i,...n}:i);e({flowNodes:r!=null&&r.silent?o:[...o]})}catch(o){Ko("Failed to create or update flow node",o,n)}},createOrUpdateFlowNode:async(n,r)=>{var a;try{const o=Ye.getState().currentSession;if(!(o!=null&&o.id))throw new Error("Session not found");if(!n.id&&(!n.source_type||!n.source_id))throw new Error("Missing flow node indentify");let i,s=n!=null&&n.id?t().flowNodes.find(p=>p.id===n.id):void 0;if(!s&&(n.id||n.source_type&&n.source_id)&&(s=await de("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}})),s)i=nm(s,Uu(n,Wu)),r!=null&&r.lazy?de("FlowNode").update(s.id,i):await de("FlowNode").update(s.id,i);else if(n.source_id&&n.source_type)i={...n,source_id:`${n.source_id}`,source_type:`${n.source_type}`,node_type:n.node_type||"NEW_MESSAGE",session_id:n.session_id||(o==null?void 0:o.id)},r!=null&&r.lazy?(i.id=Ti(),de("FlowNode").save(i)):i=await de("FlowNode").save(i);else throw new Error("Missing source id and type");let c;const l=t().nodes.find(p=>p.id===i.id);i.source_type&&!l?c=await de(i.source_type).findOne({where:{id:n.source_id}}):i.source_type&&l&&(c=(a=l==null?void 0:l.data)==null?void 0:a.entity);const u=t().flowNodes,d=t().nodes,{changes:f}=D_([i],d,{[i.source_type]:[c]});return e({flowNodes:[...u.filter(p=>p.id!==i.id),i],nodes:Ji(f,d)}),i}catch(o){Ko("Failed to create or update flow node",o,n)}},createOrUpdateFlowEdge:async(n,r)=>{try{const a=Ye.getState().currentSession;if(!(a!=null&&a.id))throw new Error("Session not found");if(!n.id&&(!n.source||!n.target))throw new Error("Missing flow node indentify");let o,i=n!=null&&n.id?t().flowEdges.find(l=>l.id===n.id):void 0;if(i&&(n.id||n.source&&n.target)&&(i=await de("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}})),i)o=nm(i,Uu(n,Wu)),r!=null&&r.lazy?de("FlowEdge").update(i.id,o):await de("FlowEdge").update(i.id,o);else if(n.source&&n.target)o={...n,source:`${n.source}`,target:`${n.target}`,session_id:n.session_id||(a==null?void 0:a.id)},r!=null&&r.lazy?(o.id=Ti(),de("FlowEdge").save(o)):o=await de("FlowEdge").save(o);else throw new Error("Missing source and target");const s=t().flowEdges,c=t().edges;return e({flowEdges:[...s.filter(l=>l.id!==o.id),o],edges:dd(L_([o],c).changes,c)}),o}catch(a){Ko("Failed to create or update flow node",a)}}}),sm=()=>{const e=Qa(t=>t.loadModel);return{loadModel:g.useCallback(async(t,...n)=>{switch(t){case Ct.WebLLM:return e(...n);default:return}},[e])}};var xde=Object.defineProperty,_de=Object.defineProperties,jde=Object.getOwnPropertyDescriptors,cm=Object.getOwnPropertySymbols,AL=Object.prototype.hasOwnProperty,TL=Object.prototype.propertyIsEnumerable,RL=(e,t,n)=>t in e?xde(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Sde=(e,t)=>{for(var n in t||(t={}))AL.call(t,n)&&RL(e,n,t[n]);if(cm)for(var n of cm(t))TL.call(t,n)&&RL(e,n,t[n]);return e},Ede=(e,t)=>_de(e,jde(t)),Ode=(e,t)=>{var n={};for(var r in e)AL.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&cm)for(var r of cm(e))t.indexOf(r)<0&&TL.call(e,r)&&(n[r]=e[r]);return n};function Cde(e){let t=setTimeout(e,0),n=setTimeout(e,10),r=setTimeout(e,50);return[t,n,r]}function Nde(e){let t=g.useRef();return g.useEffect(()=>{t.current=e}),t.current}var Mde=18,IL=40,Pde=`${IL}px`,kde=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function Ade({containerRef:e,inputRef:t,pushPasswordManagerStrategy:n,isFocused:r}){let[a,o]=g.useState(!1),[i,s]=g.useState(!1),[c,l]=g.useState(!1),u=g.useMemo(()=>n==="none"?!1:(n==="increase-width"||n==="experimental-no-flickering")&&a&&i,[a,i,n]),d=g.useCallback(()=>{let f=e.current,p=t.current;if(!f||!p||c||n==="none")return;let y=f,m=y.getBoundingClientRect().left+y.offsetWidth,v=y.getBoundingClientRect().top+y.offsetHeight/2,b=m-Mde,w=v;document.querySelectorAll(kde).length===0&&document.elementFromPoint(b,w)===f||(o(!0),l(!0))},[e,t,c,n]);return g.useEffect(()=>{let f=e.current;if(!f||n==="none")return;function p(){let m=window.innerWidth-f.getBoundingClientRect().right;s(m>=IL)}p();let y=setInterval(p,1e3);return()=>{clearInterval(y)}},[e,n]),g.useEffect(()=>{let f=r||document.activeElement===t.current;if(n==="none"||!f)return;let p=setTimeout(d,0),y=setTimeout(d,2e3),m=setTimeout(d,5e3),v=setTimeout(()=>{l(!0)},6e3);return()=>{clearTimeout(p),clearTimeout(y),clearTimeout(m),clearTimeout(v)}},[t,r,n,d]),{hasPWMBadge:a,willPushPWMBadge:u,PWM_BADGE_SPACE_WIDTH:Pde}}var DL=g.createContext({}),LL=g.forwardRef((e,t)=>{var n=e,{value:r,onChange:a,maxLength:o,textAlign:i="left",pattern:s,placeholder:c,inputMode:l="numeric",onComplete:u,pushPasswordManagerStrategy:d="increase-width",pasteTransformer:f,containerClassName:p,noScriptCSSFallback:y=Tde,render:m,children:v}=n,b=Ode(n,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),w,_,x,j,S;let[E,O]=g.useState(typeof b.defaultValue=="string"?b.defaultValue:""),M=r??E,N=Nde(M),P=g.useCallback(re=>{a==null||a(re),O(re)},[a]),R=g.useMemo(()=>s?typeof s=="string"?new RegExp(s):s:null,[s]),k=g.useRef(null),C=g.useRef(null),T=g.useRef({value:M,onChange:P,isIOS:typeof window<"u"&&((_=(w=window==null?void 0:window.CSS)==null?void 0:w.supports)==null?void 0:_.call(w,"-webkit-touch-callout","none"))}),A=g.useRef({prev:[(x=k.current)==null?void 0:x.selectionStart,(j=k.current)==null?void 0:j.selectionEnd,(S=k.current)==null?void 0:S.selectionDirection]});g.useImperativeHandle(t,()=>k.current,[]),g.useEffect(()=>{let re=k.current,ue=C.current;if(!re||!ue)return;T.current.value!==re.value&&T.current.onChange(re.value),A.current.prev=[re.selectionStart,re.selectionEnd,re.selectionDirection];function je(){if(document.activeElement!==re){$(null),G(null);return}let Se=re.selectionStart,Ve=re.selectionEnd,Ue=re.selectionDirection,We=re.maxLength,At=re.value,st=A.current.prev,rt=-1,wt=-1,Xt;if(At.length!==0&&Se!==null&&Ve!==null){let Xa=Se===Ve,Y=Se===At.length&&At.length<We;if(Xa&&!Y){let te=Se;if(te===0)rt=0,wt=1,Xt="forward";else if(te===We)rt=te-1,wt=te,Xt="backward";else if(We>1&&At.length>1){let ce=0;if(st[0]!==null&&st[1]!==null){Xt=te<st[1]?"backward":"forward";let me=st[0]===st[1]&&st[0]<We;Xt==="backward"&&!me&&(ce=-1)}rt=ce+te,wt=ce+te+1}}rt!==-1&&wt!==-1&&rt!==wt&&k.current.setSelectionRange(rt,wt,Xt)}let nr=rt!==-1?rt:Se,Ka=wt!==-1?wt:Ve,rr=Xt??Ue;$(nr),G(Ka),A.current.prev=[nr,Ka,rr]}if(document.addEventListener("selectionchange",je,{capture:!0}),je(),document.activeElement===re&&B(!0),!document.getElementById("input-otp-style")){let Se=document.createElement("style");if(Se.id="input-otp-style",document.head.appendChild(Se),Se.sheet){let Ve="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";yd(Se.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),yd(Se.sheet,`[data-input-otp]:autofill { ${Ve} }`),yd(Se.sheet,`[data-input-otp]:-webkit-autofill { ${Ve} }`),yd(Se.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),yd(Se.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let Le=()=>{ue&&ue.style.setProperty("--root-height",`${re.clientHeight}px`)};Le();let $e=new ResizeObserver(Le);return $e.observe(re),()=>{document.removeEventListener("selectionchange",je,{capture:!0}),$e.disconnect()}},[]);let[I,L]=g.useState(!1),[D,B]=g.useState(!1),[F,$]=g.useState(null),[V,G]=g.useState(null);g.useEffect(()=>{Cde(()=>{var re,ue,je,Le;(re=k.current)==null||re.dispatchEvent(new Event("input"));let $e=(ue=k.current)==null?void 0:ue.selectionStart,Se=(je=k.current)==null?void 0:je.selectionEnd,Ve=(Le=k.current)==null?void 0:Le.selectionDirection;$e!==null&&Se!==null&&($($e),G(Se),A.current.prev=[$e,Se,Ve])})},[M,D]),g.useEffect(()=>{N!==void 0&&M!==N&&N.length<o&&M.length===o&&(u==null||u(M))},[o,u,N,M]);let X=Ade({containerRef:C,inputRef:k,pushPasswordManagerStrategy:d,isFocused:D}),H=g.useCallback(re=>{let ue=re.currentTarget.value.slice(0,o);if(ue.length>0&&R&&!R.test(ue)){re.preventDefault();return}typeof N=="string"&&ue.length<N.length&&document.dispatchEvent(new Event("selectionchange")),P(ue)},[o,P,N,R]),J=g.useCallback(()=>{var re;if(k.current){let ue=Math.min(k.current.value.length,o-1),je=k.current.value.length;(re=k.current)==null||re.setSelectionRange(ue,je),$(ue),G(je)}B(!0)},[o]),Z=g.useCallback(re=>{var ue,je;let Le=k.current;if(!f&&(!T.current.isIOS||!re.clipboardData||!Le))return;let $e=re.clipboardData.getData("text/plain"),Se=f?f($e):$e;re.preventDefault();let Ve=(ue=k.current)==null?void 0:ue.selectionStart,Ue=(je=k.current)==null?void 0:je.selectionEnd,We=(Ve!==Ue?M.slice(0,Ve)+Se+M.slice(Ue):M.slice(0,Ve)+Se+M.slice(Ve)).slice(0,o);if(We.length>0&&R&&!R.test(We))return;Le.value=We,P(We);let At=Math.min(We.length,o-1),st=We.length;Le.setSelectionRange(At,st),$(At),G(st)},[o,P,R,M]),U=g.useMemo(()=>({position:"relative",cursor:b.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[b.disabled]),Q=g.useMemo(()=>({position:"absolute",inset:0,width:X.willPushPWMBadge?`calc(100% + ${X.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:X.willPushPWMBadge?`inset(0 ${X.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:i,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[X.PWM_BADGE_SPACE_WIDTH,X.willPushPWMBadge,i]),ne=g.useMemo(()=>g.createElement("input",Ede(Sde({autoComplete:b.autoComplete||"one-time-code"},b),{"data-input-otp":!0,"data-input-otp-placeholder-shown":M.length===0||void 0,"data-input-otp-mss":F,"data-input-otp-mse":V,inputMode:l,pattern:R==null?void 0:R.source,"aria-placeholder":c,style:Q,maxLength:o,value:M,ref:k,onPaste:re=>{var ue;Z(re),(ue=b.onPaste)==null||ue.call(b,re)},onChange:H,onMouseOver:re=>{var ue;L(!0),(ue=b.onMouseOver)==null||ue.call(b,re)},onMouseLeave:re=>{var ue;L(!1),(ue=b.onMouseLeave)==null||ue.call(b,re)},onFocus:re=>{var ue;J(),(ue=b.onFocus)==null||ue.call(b,re)},onBlur:re=>{var ue;B(!1),(ue=b.onBlur)==null||ue.call(b,re)}})),[H,J,Z,l,Q,o,V,F,b,R==null?void 0:R.source,M]),z=g.useMemo(()=>({slots:Array.from({length:o}).map((re,ue)=>{var je;let Le=D&&F!==null&&V!==null&&(F===V&&ue===F||ue>=F&&ue<V),$e=M[ue]!==void 0?M[ue]:null,Se=M[0]!==void 0?null:(je=c==null?void 0:c[ue])!=null?je:null;return{char:$e,placeholderChar:Se,isActive:Le,hasFakeCaret:Le&&$e===null}}),isFocused:D,isHovering:!b.disabled&&I}),[D,I,o,V,F,b.disabled,M]),se=g.useMemo(()=>m?m(z):g.createElement(DL.Provider,{value:z},v),[v,z,m]);return g.createElement(g.Fragment,null,y!==null&&g.createElement("noscript",null,g.createElement("style",null,y)),g.createElement("div",{ref:C,"data-input-otp-container":!0,style:U,className:p},se,g.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},ne)))});LL.displayName="Input";function yd(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var Tde=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const F_=g.forwardRef(({className:e,containerClassName:t,...n},r)=>h.jsx(LL,{ref:r,containerClassName:K("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:K("disabled:cursor-not-allowed",e),...n}));F_.displayName="InputOTP";const gd=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:K("flex items-center",e),...t}));gd.displayName="InputOTPGroup";const yr=g.forwardRef(({index:e,className:t,hidden:n,...r},a)=>{const o=g.useContext(DL),{char:i,hasFakeCaret:s,isActive:c}=o.slots[e];return h.jsxs("div",{ref:a,className:K("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",c&&"z-10 ring-2 ring-ring ring-offset-background",t),...r,children:[n&&i?h.jsx(BK,{}):i,s&&h.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});yr.displayName="InputOTPSlot";const B_=g.forwardRef(({...e},t)=>h.jsx("div",{ref:t,role:"separator",...e,children:h.jsx(BK,{})}));B_.displayName="InputOTPSeparator";const vd=Ya(({onConfirm:e,onCancel:t})=>{const n=Jt(),{t:r}=Pe("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{e(a),o("")},c=()=>{t(),n.hide(),o("")};return h.jsx(ii,{open:n.visible,onOpenChange:c,children:h.jsxs(lo,{className:"w-[330px]",children:[h.jsxs(uo,{children:[h.jsx(fo,{children:r("session_passkey.title")}),h.jsx(Eu,{children:r("session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(F_,{onChange:i,maxLength:6,children:[h.jsxs(gd,{children:[h.jsx(yr,{index:0,hidden:!0}),h.jsx(yr,{index:1,hidden:!0}),h.jsx(yr,{index:2,hidden:!0})]}),h.jsx(B_,{}),h.jsxs(gd,{children:[h.jsx(yr,{index:3,hidden:!0}),h.jsx(yr,{index:4,hidden:!0}),h.jsx(yr,{index:5,hidden:!0})]})]})}),h.jsx(Su,{children:h.jsx(ut,{onClick:s,type:"submit",children:r("session_passkey.confirm")})})]})})}),bd=e=>{const t=e.match(/.{1,2}/g);if(!t)throw new Error("Invalid hexString");return Uint8Array.from(t.map(n=>parseInt(n,16))).buffer},$L=e=>new TextEncoder().encode(e).buffer,Rde=async e=>{const t=$L(e);return await crypto.subtle.digest("SHA-256",t)},z_=e=>[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join(""),Ide=async()=>{const e=crypto.getRandomValues(new Uint8Array(32));return z_(e)},V_=async e=>{const t=await Rde(e);return z_(t)},FL=async e=>(await V_(e)).substring(0,32),BL=async(e,t)=>{const n=await V_(t),r=await FL(t),a=$L(e),o=await Dde(a,n,r);return z_(o)},q_=async(e,t)=>{const n=await V_(t),r=await FL(t),a=bd(e),o=await Lde(a,n,r);return new TextDecoder().decode(o)},Dde=async(e,t,n)=>{const r=bd(n),a=bd(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.encrypt({name:"AES-CBC",iv:r},o,e)},Lde=async(e,t,n)=>{const r=bd(n),a=bd(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.decrypt({name:"AES-CBC",iv:r},o,e)},zL=async(e,t)=>{const n={};return await Promise.all(Object.entries(e||{}).map(async([r,a])=>{const o=await BL(a,t);n[r]=o})),n},lm=async(e,t)=>{let n;if(await new Promise((r,a)=>{t.show({onConfirm:async o=>{try{n=await q_(e,o),await Gf.set("passphrase",n),r(!0)}catch(i){a(i)}finally{t.hide()}},onCancel:()=>{a()}})}),!n)throw new Error("Passphrase is required");return n},Sc=e=>{const t=Jt(e),n=g.useRef(t);return n.current=t,{modal:t,modalRef:n}},$de=()=>{var E,O;const[e,t]=g.useState(),[n,r]=g.useState(),[a,o]=g.useState(),[i,s]=g.useState([]),[c,l]=g.useState(),u=g.useRef(),d=g.useRef({}),f=Ye(M=>M.currentSession),{loadModel:p}=sm(),{modalRef:y}=Sc(vd),m=g.useCallback(async M=>{var P;if(!f)return;const N=await de("JSONData").findOne({where:{id:M.source_id,session_id:f==null?void 0:f.id}});N&&((P=u.current)==null||P.call(u,N.data?N.data:[]),l({node:M,enity:N}))},[f]),v=g.useCallback(async M=>{var A;const N=(M==null?void 0:M.sessionId)||(f==null?void 0:f.id),P=(M==null?void 0:M.threadNode)||(n==null?void 0:n.threadNode),R=(M==null?void 0:M.prompts)||(e==null?void 0:e.prompts);if(!N||!(P!=null&&P.id))return;const k=R==null?void 0:R.map(I=>{if(I.type!=="few_shot_example")switch(I.role){case"ai":case"assistant":case"tool":return{id:I.id,content:I.content,role:"assistant"};case"system":return{id:I.id,content:I.content,role:"system"};default:return{id:I.id,content:I.content,role:"user"}}}).filter(Boolean),C=await de("JSONData").save({headers:"item",session_id:N,json:"",data:k});if(!C)return;const T=await de("FlowNode").save({session_id:N,source_id:C.id,source_type:"JSONData",node_type:"JSON_DATA",x:0,y:0});if(T)return await de("FlowEdge").save({session_id:N,source:P.id,target:T.id}),(A=u.current)==null||A.call(u,k),l({node:T,enity:C}),{jsonData:C,jsonDataNode:T}},[e==null?void 0:e.prompts,f==null?void 0:f.id,n==null?void 0:n.threadNode]),b=g.useCallback(async(M,N)=>{if(!f)return;const P=await de("FlowEdge").findOne({where:{session_id:f.id,source:M.id},order:{id:"DESC"}});if(P){const R=await de("FlowNode").findOne({where:{id:P.target,session_id:f.id}});if(!R)return;await m(R)}else if(!await v({sessionId:f.id,threadNode:M,prompts:N||[]}))return},[v,f,m]),w=g.useCallback(async M=>{if(M!=null&&M.length&&(f!=null&&f.id)){const N=(await Promise.all(M.map(async P=>de("FlowEdge").find({where:{target:P.source.id}}).then(R=>im({where:{session_id:f.id,id:Da(R.map(k=>k.source))}}).then(k=>({...k,...P})))))).map(P=>{var A,I,L,D;const R=P.flowNodes.find(B=>B.source_type==="Prompt"),k=P.flowNodes.find(B=>B.source_type==="VectorDatabase");if(!k||!R)return;const C=(I=(A=P.flowNodeDatas)==null?void 0:A.Prompt)==null?void 0:I.find(B=>B.id===R.source_id),T=(D=(L=P.flowNodeDatas)==null?void 0:L.VectorDatabase)==null?void 0:D.find(B=>B.id===k.source_id);return{promptNode:R,vectorDatabaseNode:k,placeholderNode:P.source,placeholderEntity:P.entity,promptEntity:C,vectorDatabaseEntity:T}}).filter(Boolean);s(N)}},[f==null?void 0:f.id]),_=g.useCallback(async()=>{try{if(d.current.handling=f==null?void 0:f.id,!(f!=null&&f.id)||!(f!=null&&f.main_source_id)||(f==null?void 0:f.main_source_type)!=="Thread")return;const[M,N]=await Promise.all([de("Thread").findOne({where:{id:f.main_source_id,session_id:f.id}}),de("FlowNode").findOne({where:{id:f.main_node_id}})]);if(!M||!N)return;const P=await de("FlowEdge").find({where:{session_id:f.id,target:N.id}}),{flowNodes:R,flowNodeDatas:k}=await im({where:{session_id:f.id,id:Da(P.map(F=>F.source))}}),C=(await de("FlowEdge").find({where:{session_id:f.id}})).filter(F=>F.target===N.id).map(F=>{var V;const $=R.find(G=>G.id===F.source);return{connection:F,source:$,entity:(V=k==null?void 0:k[$.source_type])==null?void 0:V.find(G=>G.id===$.source_id)}}),T=C.find(F=>F.source.source_type==="LLM"),A=C.filter(F=>F.source.source_type==="Prompt"),I=C.find(F=>F.source.source_type==="Schema"),L=T==null?void 0:T.entity;if(!L)return;f.passphrase&&await lm(f.passphrase,y.current);const D=C.filter(F=>F.source.source_type==="FlowNodePlaceholder");await w(D),await b(N,(A==null?void 0:A.map(F=>F.entity))||[]),o({llm:L,status:L.status||Ge.Started,progress:""}),r({thread:M,threadNode:N});const B=I==null?void 0:I.entity;if(B){const F=await de("SchemaItem").find({where:{schema_id:B.id}});B.schema_items=F||[]}t({prompts:(A==null?void 0:A.map(F=>F.entity))||[],schema:B}),d.current.handled=f.id}finally{d.current.handling=void 0}},[f==null?void 0:f.id,f==null?void 0:f.main_node_id,f==null?void 0:f.main_source_id,f==null?void 0:f.main_source_type,f==null?void 0:f.passphrase,w,b,y]),x=g.useCallback(async()=>{var M;if((M=a==null?void 0:a.llm)!=null&&M.name)try{o(N=>N&&{...N,status:Ge.Loading}),await p(a.llm.provider,a==null?void 0:a.llm.name,N=>{o(P=>P&&{...P,progress:N.text})}),o(N=>N&&{...N,status:Ge.Loaded,progress:""})}catch{o(N=>N&&{...N,status:Ge.Started,progress:""})}},[(E=a==null?void 0:a.llm)==null?void 0:E.name,(O=a==null?void 0:a.llm)==null?void 0:O.provider,p]),j=g.useCallback(M=>(u.current=M,()=>{u.current=void 0}),[]),S=g.useCallback(async M=>{!(c!=null&&c.node)||!(c!=null&&c.enity)||await de("JSONData").save({...c.enity,data:M})},[c==null?void 0:c.enity,c==null?void 0:c.node]);return g.useEffect(()=>{d.current.handling||(d==null?void 0:d.current.handled)===(f==null?void 0:f.id)||_()},[f==null?void 0:f.id,_]),{...e,loadLLM:x,threadInfo:n,mainLLMInfo:a,retriverInfo:i,currentDataNode:c,updateMessagesData:S,addNewDataNode:v,selectDataNode:m,onThreadMessagesLoaded:j}};class Fde extends Qf{get lc_attributes(){return{partialVariables:void 0}}constructor(t){super(t),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:n}=t;if(n.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,t)}async mergePartialAndUserVariables(t){const n=this.partialVariables??{},r={};for(const[a,o]of Object.entries(n))typeof o=="string"?r[a]=o:r[a]=await o();return{...r,...t}}async invoke(t,n){return this._callWithConfig(r=>this.formatPromptValue(r),t,{...n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(t){switch(t._type){case"prompt":{const{PromptTemplate:n}=await Ut(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>YL);return{PromptTemplate:r}},[]);return n.deserialize(t)}case void 0:{const{PromptTemplate:n}=await Ut(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>YL);return{PromptTemplate:r}},void 0);return n.deserialize({...t,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:n}=await Ut(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot-BQNhP7Zr.js").then(async a=>(await a.__tla,a));return{FewShotPromptTemplate:r}},__vite__mapDeps([0,1,2,3,4]));return n.deserialize(t)}default:throw new Error(`Invalid prompt type in config: ${t._type}`)}}}class VL extends QTe{}class qL extends VL{static lc_name(){return"StringPromptValue"}constructor(t){super({value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=t}toString(){return this.value}toChatMessages(){return[new Dr(this.value)]}}class Bde extends VL{static lc_name(){return"ChatPromptValue"}constructor(t){Array.isArray(t)&&(t={messages:t}),super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=t.messages}toString(){return JTe(this.messages)}toChatMessages(){return this.messages}}YM=class extends Fde{async formatPromptValue(e){const t=await this.format(e);return new qL(t)}};var zde=Object.prototype.toString,Ec=Array.isArray||function(e){return zde.call(e)==="[object Array]"};function U_(e){return typeof e=="function"}function Vde(e){return Ec(e)?"array":typeof e}function W_(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function UL(e,t){return e!=null&&typeof e=="object"&&t in e}function qde(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var Ude=RegExp.prototype.test;function Wde(e,t){return Ude.call(e,t)}var Hde=/\S/;function Zde(e){return!Wde(Hde,e)}var Kde={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Xde(e){return String(e).replace(/[&<>"'`=\/]/g,function(t){return Kde[t]})}var Gde=/\s*/,Qde=/\s+/,WL=/\s*=/,Jde=/\s*\}/,Yde=/#|\^|\/|>|\{|&|=|!/;function efe(e,t){if(!e)return[];var n=!1,r=[],a=[],o=[],i=!1,s=!1,c="",l=0;function u(){if(i&&!s)for(;o.length;)delete a[o.pop()];else o=[];i=!1,s=!1}var d,f,p;function y(O){if(typeof O=="string"&&(O=O.split(Qde,2)),!Ec(O)||O.length!==2)throw new Error("Invalid tags: "+O);d=new RegExp(W_(O[0])+"\\s*"),f=new RegExp("\\s*"+W_(O[1])),p=new RegExp("\\s*"+W_("}"+O[1]))}y(t||Xn.tags);for(var m=new wd(e),v,b,w,_,x,j;!m.eos();){if(v=m.pos,w=m.scanUntil(d),w)for(var S=0,E=w.length;S<E;++S)_=w.charAt(S),Zde(_)?(o.push(a.length),c+=_):(s=!0,n=!0,c+=" "),a.push(["text",_,v,v+1]),v+=1,_===`
`&&(u(),c="",l=0,n=!1);if(!m.scan(d))break;if(i=!0,b=m.scan(Yde)||"name",m.scan(Gde),b==="="?(w=m.scanUntil(WL),m.scan(WL),m.scanUntil(f)):b==="{"?(w=m.scanUntil(p),m.scan(Jde),m.scanUntil(f),b="&"):w=m.scanUntil(f),!m.scan(f))throw new Error("Unclosed tag at "+m.pos);if(b==">"?x=[b,w,v,m.pos,c,l,n]:x=[b,w,v,m.pos],l++,a.push(x),b==="#"||b==="^")r.push(x);else if(b==="/"){if(j=r.pop(),!j)throw new Error('Unopened section "'+w+'" at '+v);if(j[1]!==w)throw new Error('Unclosed section "'+j[1]+'" at '+v)}else b==="name"||b==="{"||b==="&"?s=!0:b==="="&&y(w)}if(u(),j=r.pop(),j)throw new Error('Unclosed section "'+j[1]+'" at '+m.pos);return nfe(tfe(a))}function tfe(e){for(var t=[],n,r,a=0,o=e.length;a<o;++a)n=e[a],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function nfe(e){for(var t=[],n=t,r=[],a,o,i=0,s=e.length;i<s;++i)switch(a=e[i],a[0]){case"#":case"^":n.push(a),r.push(a),n=a[4]=[];break;case"/":o=r.pop(),o[5]=a[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(a)}return t}function wd(e){this.string=e,this.tail=e,this.pos=0}wd.prototype.eos=function(){return this.tail===""},wd.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},wd.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n};function Oc(e,t){this.view=e,this.cache={".":this.view},this.parent=t}Oc.prototype.push=function(e){return new Oc(e,this)},Oc.prototype.lookup=function(e){var t=this.cache,n;if(t.hasOwnProperty(e))n=t[e];else{for(var r=this,a,o,i,s=!1;r;){if(e.indexOf(".")>0)for(a=r.view,o=e.split("."),i=0;a!=null&&i<o.length;)i===o.length-1&&(s=UL(a,o[i])||qde(a,o[i])),a=a[o[i++]];else a=r.view[e],s=UL(r.view,e);if(s){n=a;break}r=r.parent}t[e]=n}return U_(n)&&(n=n.call(this.view)),n};function zn(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}zn.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()},zn.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||Xn.tags).join(":"),a=typeof n<"u",o=a?n.get(r):void 0;return o==null&&(o=efe(e,t),a&&n.set(r,o)),o},zn.prototype.render=function(e,t,n,r){var a=this.getConfigTags(r),o=this.parse(e,a),i=t instanceof Oc?t:new Oc(t,void 0);return this.renderTokens(o,i,n,e,r)},zn.prototype.renderTokens=function(e,t,n,r,a){for(var o="",i,s,c,l=0,u=e.length;l<u;++l)c=void 0,i=e[l],s=i[0],s==="#"?c=this.renderSection(i,t,n,r,a):s==="^"?c=this.renderInverted(i,t,n,r,a):s===">"?c=this.renderPartial(i,t,n,a):s==="&"?c=this.unescapedValue(i,t):s==="name"?c=this.escapedValue(i,t,a):s==="text"&&(c=this.rawValue(i)),c!==void 0&&(o+=c);return o},zn.prototype.renderSection=function(e,t,n,r,a){var o=this,i="",s=t.lookup(e[1]);function c(d){return o.render(d,t,n,a)}if(s){if(Ec(s))for(var l=0,u=s.length;l<u;++l)i+=this.renderTokens(e[4],t.push(s[l]),n,r,a);else if(typeof s=="object"||typeof s=="string"||typeof s=="number")i+=this.renderTokens(e[4],t.push(s),n,r,a);else if(U_(s)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");s=s.call(t.view,r.slice(e[3],e[5]),c),s!=null&&(i+=s)}else i+=this.renderTokens(e[4],t,n,r,a);return i}},zn.prototype.renderInverted=function(e,t,n,r,a){var o=t.lookup(e[1]);if(!o||Ec(o)&&o.length===0)return this.renderTokens(e[4],t,n,r,a)},zn.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),a=e.split(`
`),o=0;o<a.length;o++)a[o].length&&(o>0||!n)&&(a[o]=r+a[o]);return a.join(`
`)},zn.prototype.renderPartial=function(e,t,n,r){if(n){var a=this.getConfigTags(r),o=U_(n)?n(e[1]):n[e[1]];if(o!=null){var i=e[6],s=e[5],c=e[4],l=o;s==0&&c&&(l=this.indentPartial(o,c,i));var u=this.parse(l,a);return this.renderTokens(u,t,n,l,r)}}},zn.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(n!=null)return n},zn.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||Xn.escape,a=t.lookup(e[1]);if(a!=null)return typeof a=="number"&&r===Xn.escape?String(a):r(a)},zn.prototype.rawValue=function(e){return e[1]},zn.prototype.getConfigTags=function(e){return Ec(e)?e:e&&typeof e=="object"?e.tags:void 0},zn.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!Ec(e))return e.escape};var Xn={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){xd.templateCache=e},get templateCache(){return xd.templateCache}},xd=new zn;Xn.clearCache=function(){return xd.clearCache()},Xn.parse=function(e,t){return xd.parse(e,t)},Xn.render=function(e,t,n,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+Vde(e)+'" was given as the first argument for mustache#render(template, view, partials)');return xd.render(e,t,n,r)},Xn.escape=Xde,Xn.Scanner=wd,Xn.Context=Oc,Xn.Writer=zn;function HL(){Xn.escape=e=>e}let H_,ZL,KL,XL,GL,um,QL,JL;H_=e=>{const t=e.split(""),n=[],r=(o,i)=>{for(let s=i;s<t.length;s+=1)if(o.includes(t[s]))return s;return-1};let a=0;for(;a<t.length;)if(t[a]==="{"&&a+1<t.length&&t[a+1]==="{")n.push({type:"literal",text:"{"}),a+=2;else if(t[a]==="}"&&a+1<t.length&&t[a+1]==="}")n.push({type:"literal",text:"}"}),a+=2;else if(t[a]==="{"){const o=r("}",a);if(o<0)throw new Error("Unclosed '{' in template.");n.push({type:"variable",name:t.slice(a+1,o).join("")}),a=o+1}else{if(t[a]==="}")throw new Error("Single '}' in template.");{const o=r("{}",a),i=(o<0?t.slice(a):t.slice(a,o)).join("");n.push({type:"literal",text:i}),a=o<0?t.length:o}}return n},ZL=e=>e.map(t=>t[0]==="name"?{type:"variable",name:t[1].includes(".")?t[1].split(".")[0]:t[1]}:["#","&","^",">"].includes(t[0])?{type:"variable",name:t[1]}:{type:"literal",text:t[1]}),KL=e=>{HL();const t=Xn.parse(e);return ZL(t)},XL=(e,t)=>H_(e).reduce((n,r)=>{if(r.type==="variable"){if(r.name in t)return n+t[r.name];throw new Error(`(f-string) Missing value for input ${r.name}`)}return n+r.text},""),GL=(e,t)=>(HL(),Xn.render(e,t)),um={"f-string":XL,mustache:GL},QL={"f-string":H_,mustache:KL},$s=(e,t,n)=>um[t](e,n),JL=(e,t)=>QL[t](e),eP=(e,t,n)=>{if(!(t in um)){const r=Object.keys(um);throw new Error(`Invalid template format. Got \`${t}\`;
                         should be one of ${r}`)}try{const r=n.reduce((a,o)=>(a[o]="foo",a),{});Array.isArray(e)?e.forEach(a=>{if(a.type==="text")$s(a.text,t,r);else if(a.type==="image_url")if(typeof a.image_url=="string")$s(a.image_url,t,r);else{const o=a.image_url.url;$s(o,t,r)}else throw new Error(`Invalid message template received. ${JSON.stringify(a,null,2)}`)}):$s(e,t,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}},Jo=class extends YM{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),eP(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return $s(this.template,this.templateFormat,t)}static fromExamples(e,t,n,r=`

`,a=""){const o=[a,...e,t].join(r);return new Jo({inputVariables:n,template:o})}static fromTemplate(e,t){const{templateFormat:n="f-string",...r}=t??{},a=new Set;return JL(e,n).forEach(o=>{o.type==="variable"&&a.add(o.name)}),new Jo({inputVariables:[...a],templateFormat:n,template:e,...r})}async partial(e){const t=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new Jo(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new Jo({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}};const YL=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:Jo},Symbol.toStringTag,{value:"Module"})),Z_="RFC3986",K_={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},rfe="RFC1738",afe=Array.isArray,La=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),X_=1024,ofe=(e,t,n,r,a)=>{if(e.length===0)return e;let o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(s){return"%26%23"+parseInt(s.slice(2),16)+"%3B"});let i="";for(let s=0;s<o.length;s+=X_){const c=o.length>=X_?o.slice(s,s+X_):o,l=[];for(let u=0;u<c.length;++u){let d=c.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||a===rfe&&(d===40||d===41)){l[l.length]=c.charAt(u);continue}if(d<128){l[l.length]=La[d];continue}if(d<2048){l[l.length]=La[192|d>>6]+La[128|d&63];continue}if(d<55296||d>=57344){l[l.length]=La[224|d>>12]+La[128|d>>6&63]+La[128|d&63];continue}u+=1,d=65536+((d&1023)<<10|c.charCodeAt(u)&1023),l[l.length]=La[240|d>>18]+La[128|d>>12&63]+La[128|d>>6&63]+La[128|d&63]}i+=l.join("")}return i};function ife(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function e6(e,t){if(afe(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const sfe=Object.prototype.hasOwnProperty,t6={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},$a=Array.isArray,cfe=Array.prototype.push,n6=function(e,t){cfe.apply(e,$a(t)?t:[t])},lfe=Date.prototype.toISOString,cn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:ofe,encodeValuesOnly:!1,format:Z_,formatter:K_[Z_],indices:!1,serializeDate(e){return lfe.call(e)},skipNulls:!1,strictNullHandling:!1};function ufe(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const G_={};function r6(e,t,n,r,a,o,i,s,c,l,u,d,f,p,y,m,v,b){let w=e,_=b,x=0,j=!1;for(;(_=_.get(G_))!==void 0&&!j;){const N=_.get(e);if(x+=1,typeof N<"u"){if(N===x)throw new RangeError("Cyclic object value");j=!0}typeof _.get(G_)>"u"&&(x=0)}if(typeof l=="function"?w=l(t,w):w instanceof Date?w=f==null?void 0:f(w):n==="comma"&&$a(w)&&(w=e6(w,function(N){return N instanceof Date?f==null?void 0:f(N):N})),w===null){if(o)return c&&!m?c(t,cn.encoder,v,"key",p):t;w=""}if(ufe(w)||ife(w)){if(c){const N=m?t:c(t,cn.encoder,v,"key",p);return[(y==null?void 0:y(N))+"="+(y==null?void 0:y(c(w,cn.encoder,v,"value",p)))]}return[(y==null?void 0:y(t))+"="+(y==null?void 0:y(String(w)))]}const S=[];if(typeof w>"u")return S;let E;if(n==="comma"&&$a(w))m&&c&&(w=e6(w,c)),E=[{value:w.length>0?w.join(",")||null:void 0}];else if($a(l))E=l;else{const N=Object.keys(w);E=u?N.sort(u):N}const O=s?String(t).replace(/\./g,"%2E"):String(t),M=r&&$a(w)&&w.length===1?O+"[]":O;if(a&&$a(w)&&w.length===0)return M+"[]";for(let N=0;N<E.length;++N){const P=E[N],R=typeof P=="object"&&typeof P.value<"u"?P.value:w[P];if(i&&R===null)continue;const k=d&&s?P.replace(/\./g,"%2E"):P,C=$a(w)?typeof n=="function"?n(M,k):M:M+(d?"."+k:"["+k+"]");b.set(e,x);const T=new WeakMap;T.set(G_,b),n6(S,r6(R,C,n,r,a,o,i,s,n==="comma"&&m&&$a(w)?null:c,l,u,d,f,p,y,m,v,T))}return S}function dfe(e=cn){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||cn.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=Z_;if(typeof e.format<"u"){if(!sfe.call(K_,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=K_[n];let a=cn.filter;(typeof e.filter=="function"||$a(e.filter))&&(a=e.filter);let o;if(e.arrayFormat&&e.arrayFormat in t6?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=cn.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:cn.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:cn.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:cn.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:cn.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?cn.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:cn.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:cn.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:cn.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:cn.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:cn.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:cn.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:cn.strictNullHandling}}function ffe(e,t={}){let n=e;const r=dfe(t);let a,o;typeof r.filter=="function"?(o=r.filter,n=o("",n)):$a(r.filter)&&(o=r.filter,a=o);const i=[];if(typeof n!="object"||n===null)return"";const s=t6[r.arrayFormat],c=s==="comma"&&r.commaRoundTrip;a||(a=Object.keys(n)),r.sort&&a.sort(r.sort);const l=new WeakMap;for(let f=0;f<a.length;++f){const p=a[f];r.skipNulls&&n[p]===null||n6(i,r6(n[p],p,s,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const u=i.join(r.delimiter);let d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const Cc="4.78.1";let a6=!1,_d,o6,i6,Q_,s6,c6,l6,u6,d6;function pfe(e,t={auto:!1}){if(a6)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(_d)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${_d}'\``);a6=t.auto,_d=e.kind,o6=e.fetch,i6=e.FormData,Q_=e.File,s6=e.ReadableStream,c6=e.getMultipartRequestOptions,l6=e.getDefaultAgent,u6=e.fileFromPath,d6=e.isFsReadStream}let hfe=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function mfe({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new hfe(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}_d||pfe(mfe(),{auto:!0});class et extends Error{}let Gn=class dP extends et{constructor(t,n,r,a){super(`${dP.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=n;const o=n;this.code=o==null?void 0:o.code,this.param=o==null?void 0:o.param,this.type=o==null?void 0:o.type}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t||!a)return new dm({message:r,cause:tj(n)});const o=n==null?void 0:n.error;return t===400?new f6(t,o,r,a):t===401?new p6(t,o,r,a):t===403?new h6(t,o,r,a):t===404?new m6(t,o,r,a):t===409?new y6(t,o,r,a):t===422?new g6(t,o,r,a):t===429?new v6(t,o,r,a):t>=500?new b6(t,o,r,a):new dP(t,o,r,a)}},Or=class extends Gn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},dm=class extends Gn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},fm=class extends dm{constructor({message:e}={}){super({message:e??"Request timed out."})}},f6=class extends Gn{},p6=class extends Gn{},h6=class extends Gn{},m6=class extends Gn{},y6=class extends Gn{},g6=class extends Gn{},v6=class extends Gn{},b6=class extends Gn{};class w6 extends et{constructor(){super("Could not parse response content as the length limit was reached")}}class x6 extends et{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}let pm=class fP{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=fP.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(fP.NEWLINE_REGEXP);return r&&a.pop(),a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof vn<"u"){if(t instanceof vn)return t.toString();if(t instanceof Uint8Array)return vn.from(t).toString();throw new et(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new et(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new et("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}};pm.NEWLINE_CHARS=new Set([`
`,"\r"]),pm.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let jd=class sp{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const i of yfe(t,n))if(!o){if(i.data.startsWith("[DONE]")){o=!0;continue}if(i.event===null){let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(s&&s.error)throw new Gn(void 0,s.error,void 0,void 0);yield s}else{let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new Gn(void 0,s.error,s.message,void 0);yield{event:i.event,data:s}}}o=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{o||n.abort()}}return new sp(a,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new pm,s=_6(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new sp(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new sp(()=>a(t),this.controller),new sp(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new s6({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}};async function*yfe(e,t){if(!e.body)throw t.abort(),new et("Attempted to iterate over a response with no body");const n=new bfe,r=new pm,a=_6(e.body);for await(const o of gfe(a))for(const i of r.decode(o)){const s=n.decode(i);s&&(yield s)}for(const o of r.flush()){const i=n.decode(o);i&&(yield i)}}async function*gfe(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let a=new Uint8Array(t.length+r.length);a.set(t),a.set(r,t.length),t=a;let o;for(;(o=vfe(t))!==-1;)yield t.slice(0,o),t=t.slice(o)}t.length>0&&(yield t)}function vfe(e){for(let t=0;t<e.length-2;t++){if(e[t]===10&&e[t+1]===10||e[t]===13&&e[t+1]===13)return t+2;if(e[t]===13&&e[t+1]===10&&t+3<e.length&&e[t+2]===13&&e[t+3]===10)return t+4}return-1}let bfe=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=wfe(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}};function wfe(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function _6(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const j6=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",S6=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&hm(e),hm=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",xfe=e=>S6(e)||j6(e)||d6(e);async function E6(e,t,n){var a;if(e=await e,S6(e))return e;if(j6(e)){const o=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=hm(o)?[await o.arrayBuffer()]:[o];return new Q_(i,t,n)}const r=await _fe(e);if(t||(t=Sfe(e)??"unknown_file"),!(n!=null&&n.type)){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new Q_(r,t,n)}async function _fe(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(hm(e))t.push(await e.arrayBuffer());else if(Efe(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${jfe(e)}`);return t}function jfe(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function Sfe(e){var t;return J_(e.name)||J_(e.filename)||((t=J_(e.path))==null?void 0:t.split(/[\\/]/).pop())}const J_=e=>{if(typeof e=="string")return e;if(typeof vn<"u"&&e instanceof vn)return String(e)},Efe=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",O6=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",Nc=async e=>{const t=await Ofe(e.body);return c6(t,e)},Ofe=async e=>{const t=new i6;return await Promise.all(Object.entries(e||{}).map(([n,r])=>Y_(t,n,r))),t},Y_=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(xfe(n)){const r=await E6(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>Y_(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>Y_(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Mc={},Cfe=function(e,t,n,r,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n},Nfe=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},mm;async function C6(e){const{response:t}=e;if(e.options.stream)return Pc("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):jd.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return Pc("response",t.status,t.url,t.headers,a),N6(a,t)}const r=await t.text();return Pc("response",t.status,t.url,t.headers,r),r}function N6(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}let M6=class GK extends Promise{constructor(t,n=C6){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new GK(this.responsePromise,async n=>N6(t(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}},Mfe=class{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:a}){this.baseURL=e,this.maxRetries=ej("maxRetries",t),this.timeout=ej("timeout",n),this.httpAgent=r,this.fetch=a??o6}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Ife(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Ffe()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async r=>{const a=r&&hm(r==null?void 0:r.body)?new DataView(await r.body.arrayBuffer()):(r==null?void 0:r.body)instanceof DataView?r.body:(r==null?void 0:r.body)instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r==null?void 0:r.body)?new DataView(r.body.buffer):r==null?void 0:r.body;return{method:e,path:t,...r,body:a}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof vn<"u")return vn.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var p;const{method:n,path:r,query:a,headers:o={}}=e,i=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:O6(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,s=this.calculateContentLength(i),c=this.buildURL(r,a);"timeout"in e&&ej("timeout",e.timeout);const l=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??l6(c),d=l+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const f=this.buildHeaders({options:e,headers:o,contentLength:s,retryCount:t});return{req:{method:n,...i&&{body:i},headers:f,...u&&{agent:u},signal:e.signal??null},url:c,timeout:l}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const a={};n&&(a["content-length"]=n);const o=this.defaultHeaders(e);return D6(a,o),D6(a,t),O6(e.body)&&_d!=="node"&&delete a["content-type"],L6(o,"x-stainless-retry-count")===void 0&&L6(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(r)),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,r){return Gn.generate(e,t,n,r)}request(e,t=null){return new M6(this.makeRequest(e,t))}async makeRequest(e,t){var u,d;const n=await e,r=n.maxRetries??this.maxRetries;t==null&&(t=r),await this.prepareOptions(n);const{req:a,url:o,timeout:i}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(a,{url:o,options:n}),Pc("request",o,n,a.headers),(u=n.signal)==null?void 0:u.aborted)throw new Or;const s=new AbortController,c=await this.fetchWithTimeout(o,a,i,s).catch(tj);if(c instanceof Error){if((d=n.signal)!=null&&d.aborted)throw new Or;if(t)return this.retryRequest(n,t);throw c.name==="AbortError"?new fm:new dm({cause:c})}const l=kfe(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const m=`retrying, ${t} attempts remaining`;return Pc(`response (error; ${m})`,c.status,o,l),this.retryRequest(n,t,l)}const f=await c.text().catch(m=>tj(m).message),p=Dfe(f),y=p?void 0:f;throw Pc(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,l,y),this.makeStatusError(c.status,p,y,l)}return{response:c,options:n,controller:s}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new Pfe(this,n,e)}buildURL(e,t){const n=$fe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return R6(r)||(t={...r,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new et(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:a,...o}=t||{};a&&a.addEventListener("abort",()=>r.abort());const i=setTimeout(()=>r.abort(),n),s={signal:r.signal,...o};return s.method&&(s.method=s.method.toUpperCase()),this.fetch.call(void 0,e,s).finally(()=>{clearTimeout(i)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let r;const a=n==null?void 0:n["retry-after-ms"];if(a){const i=parseFloat(a);Number.isNaN(i)||(r=i)}const o=n==null?void 0:n["retry-after"];if(o&&!r){const i=parseFloat(o);Number.isNaN(i)?r=Date.parse(o)-Date.now():r=i*1e3}if(!(r&&0<=r&&r<60*1e3)){const i=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,i)}return await Sd(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e,r=Math.min(.5*Math.pow(2,n),8),a=1-Math.random()*.25;return r*a*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Cc}`}};class P6{constructor(t,n,r,a){mm.set(this,void 0),Cfe(this,mm,t),this.options=a,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new et("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in t&&typeof n.query=="object")n.query={...n.query,...t.params};else if("url"in t){const r=[...Object.entries(n.query||{}),...t.url.searchParams.entries()];for(const[a,o]of r)t.url.searchParams.set(a,o);n.query=void 0,n.path=t.url.toString()}return await Nfe(this,mm,"f").requestAPIList(this.constructor,n)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(mm=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}let Pfe=class extends M6{constructor(e,t,n){super(t,async r=>new n(e,r.response,await C6(r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}};const kfe=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),Afe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Qn=e=>typeof e=="object"&&e!==null&&!R6(e)&&Object.keys(e).every(t=>I6(Afe,t)),Tfe=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Cc,"X-Stainless-OS":A6(Deno.build.os),"X-Stainless-Arch":k6(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Cc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":bn.version};if(Object.prototype.toString.call(typeof bn<"u"?bn:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Cc,"X-Stainless-OS":A6(bn.platform),"X-Stainless-Arch":k6(bn.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":bn.version};const e=Rfe();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Cc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Cc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Rfe(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const k6=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",A6=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let T6;const Ife=()=>T6??(T6=Tfe()),Dfe=e=>{try{return JSON.parse(e)}catch{return}},Lfe=/^[a-z][a-z0-9+.-]*:/i,$fe=e=>Lfe.test(e),Sd=e=>new Promise(t=>setTimeout(t,e)),ej=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new et(`${e} must be an integer`);if(t<0)throw new et(`${e} must be a positive integer`);return t},tj=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},ym=e=>{var t,n,r,a;if(typeof bn<"u")return((t=Mc==null?void 0:Mc[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function R6(e){if(!e)return!0;for(const t in e)return!1;return!0}function I6(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function D6(e,t){for(const n in t){if(!I6(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function Pc(e,...t){typeof bn<"u"&&(Mc==null?void 0:Mc.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${e}`,...t)}const Ffe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),Bfe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",zfe=e=>typeof(e==null?void 0:e.get)=="function",L6=(e,t)=>{var r;const n=t.toLowerCase();if(zfe(e)){const a=((r=t[0])==null?void 0:r.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(o,i,s)=>i+s.toUpperCase());for(const o of[t,n,t.toUpperCase(),a]){const i=e.get(o);if(i)return i}}for(const[a,o]of Object.entries(e))if(a.toLowerCase()===n)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${t} header, using the first entry.`),o[0]):o};function nj(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class Vfe extends P6{constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Yr extends P6{constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const n=Object.fromEntries(t.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const t=this.getPaginatedItems();if(!t.length)return null;const n=(r=t[t.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}let ht=class{constructor(e){this._client=e}},$6=class extends ht{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},rj=class extends ht{constructor(){super(...arguments),this.completions=new $6(this._client)}};rj.Completions=$6;class F6 extends ht{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}let B6=class extends ht{create(e,t){return this._client.post("/audio/transcriptions",Nc({body:e,...t}))}},z6=class extends ht{create(e,t){return this._client.post("/audio/translations",Nc({body:e,...t}))}},Ed=class extends ht{constructor(){super(...arguments),this.transcriptions=new B6(this._client),this.translations=new z6(this._client),this.speech=new F6(this._client)}};Ed.Transcriptions=B6,Ed.Translations=z6,Ed.Speech=F6;class aj extends ht{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(`/batches/${t}`,n)}list(t={},n){return Qn(t)?this.list({},t):this._client.getAPIList("/batches",oj,{query:t,...n})}cancel(t,n){return this._client.post(`/batches/${t}/cancel`,n)}}class oj extends Yr{}aj.BatchesPage=oj;class ij extends ht{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/assistants/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return Qn(t)?this.list({},t):this._client.getAPIList("/assistants",sj,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class sj extends Yr{}ij.AssistantsPage=sj;function V6(e){return typeof e.parse=="function"}const kc=e=>(e==null?void 0:e.role)==="assistant",q6=e=>(e==null?void 0:e.role)==="function",U6=e=>(e==null?void 0:e.role)==="tool";var ea=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Wt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},cj,gm,vm,Od,Cd,bm,Nd,Co,Md,wm,xm,Ac,W6;class H6{constructor(){cj.add(this),this.controller=new AbortController,gm.set(this,void 0),vm.set(this,()=>{}),Od.set(this,()=>{}),Cd.set(this,void 0),bm.set(this,()=>{}),Nd.set(this,()=>{}),Co.set(this,{}),Md.set(this,!1),wm.set(this,!1),xm.set(this,!1),Ac.set(this,!1),ea(this,gm,new Promise((t,n)=>{ea(this,vm,t,"f"),ea(this,Od,n,"f")}),"f"),ea(this,Cd,new Promise((t,n)=>{ea(this,bm,t,"f"),ea(this,Nd,n,"f")}),"f"),Wt(this,gm,"f").catch(()=>{}),Wt(this,Cd,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},Wt(this,cj,"m",W6).bind(this))},0)}_connected(){this.ended||(Wt(this,vm,"f").call(this),this._emit("connect"))}get ended(){return Wt(this,Md,"f")}get errored(){return Wt(this,wm,"f")}get aborted(){return Wt(this,xm,"f")}abort(){this.controller.abort()}on(t,n){return(Wt(this,Co,"f")[t]||(Wt(this,Co,"f")[t]=[])).push({listener:n}),this}off(t,n){const r=Wt(this,Co,"f")[t];if(!r)return this;const a=r.findIndex(o=>o.listener===n);return a>=0&&r.splice(a,1),this}once(t,n){return(Wt(this,Co,"f")[t]||(Wt(this,Co,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,r)=>{ea(this,Ac,!0,"f"),t!=="error"&&this.once("error",r),this.once(t,n)})}async done(){ea(this,Ac,!0,"f"),await Wt(this,Cd,"f")}_emit(t,...n){if(Wt(this,Md,"f"))return;t==="end"&&(ea(this,Md,!0,"f"),Wt(this,bm,"f").call(this));const r=Wt(this,Co,"f")[t];if(r&&(Wt(this,Co,"f")[t]=r.filter(a=>!a.once),r.forEach(({listener:a})=>a(...n))),t==="abort"){const a=n[0];!Wt(this,Ac,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Wt(this,Od,"f").call(this,a),Wt(this,Nd,"f").call(this,a),this._emit("end");return}if(t==="error"){const a=n[0];!Wt(this,Ac,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Wt(this,Od,"f").call(this,a),Wt(this,Nd,"f").call(this,a),this._emit("end")}}_emitFinal(){}}gm=new WeakMap,vm=new WeakMap,Od=new WeakMap,Cd=new WeakMap,bm=new WeakMap,Nd=new WeakMap,Co=new WeakMap,Md=new WeakMap,wm=new WeakMap,xm=new WeakMap,Ac=new WeakMap,cj=new WeakSet,W6=function(e){if(ea(this,wm,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Or),e instanceof Or)return ea(this,xm,!0,"f"),this._emit("abort",e);if(e instanceof et)return this._emit("error",e);if(e instanceof Error){const t=new et(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new et(String(e)))};function qfe(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function Z6(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function Ufe(e,{parser:t,callback:n}){const r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function Pd(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function Wfe(e,t){return!t||!K6(t)?{...e,choices:e.choices.map(n=>({...n,message:{...n.message,parsed:null,tool_calls:n.message.tool_calls??[]}}))}:lj(e,t)}function lj(e,t){const n=e.choices.map(r=>{var a;if(r.finish_reason==="length")throw new w6;if(r.finish_reason==="content_filter")throw new x6;return{...r,message:{...r.message,tool_calls:((a=r.message.tool_calls)==null?void 0:a.map(o=>Zfe(t,o)))??[],parsed:r.message.content&&!r.message.refusal?Hfe(t,r.message.content):null}}});return{...e,choices:n}}function Hfe(e,t){var n,r;return((n=e.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=e.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function Zfe(e,t){var r;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:Pd(n)?n.$parseRaw(t.function.arguments):n!=null&&n.function.strict?JSON.parse(t.function.arguments):null}}}function Kfe(e,t){var r;if(!e)return!1;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return Pd(n)||(n==null?void 0:n.function.strict)||!1}function K6(e){var t;return Z6(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(n=>Pd(n)||n.type==="function"&&n.function.strict===!0))??!1}function Xfe(e){for(const t of e??[]){if(t.type!=="function")throw new et(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new et(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Jn=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},kn,uj,_m,dj,fj,pj,X6,hj;const G6=10;class Q6 extends H6{constructor(){super(...arguments),kn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var r;this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=(r=t.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),(q6(t)||U6(t))&&t.content)this._emit("functionCallResult",t.content);else if(kc(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(kc(t)&&t.tool_calls)for(const r of t.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new et("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),Jn(this,kn,"m",uj).call(this)}async finalMessage(){return await this.done(),Jn(this,kn,"m",_m).call(this)}async finalFunctionCall(){return await this.done(),Jn(this,kn,"m",dj).call(this)}async finalFunctionCallResult(){return await this.done(),Jn(this,kn,"m",fj).call(this)}async totalUsage(){return await this.done(),Jn(this,kn,"m",pj).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=Jn(this,kn,"m",_m).call(this);n&&this._emit("finalMessage",n);const r=Jn(this,kn,"m",uj).call(this);r&&this._emit("finalContent",r);const a=Jn(this,kn,"m",dj).call(this);a&&this._emit("finalFunctionCall",a);const o=Jn(this,kn,"m",fj).call(this);o!=null&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",Jn(this,kn,"m",pj).call(this))}async _createChatCompletion(t,n,r){const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Jn(this,kn,"m",X6).call(this,n);const o=await t.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(lj(o,n))}async _runChatCompletion(t,n,r){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(t,n,r)}async _runFunctions(t,n,r){var f;const a="function",{function_call:o="auto",stream:i,...s}=n,c=typeof o!="string"&&(o==null?void 0:o.name),{maxChatCompletions:l=G6}=r||{},u={};for(const p of n.functions)u[p.name||p.function.name]=p;const d=n.functions.map(p=>({name:p.name||p.function.name,parameters:p.parameters,description:p.description}));for(const p of n.messages)this._addMessage(p,!1);for(let p=0;p<l;++p){const y=(f=(await this._createChatCompletion(t,{...s,function_call:o,functions:d,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!y)throw new et("missing message in ChatCompletion response");if(!y.function_call)return;const{name:m,arguments:v}=y.function_call,b=u[m];if(b){if(c&&c!==m){const j=`Invalid function_call: ${JSON.stringify(m)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,name:m,content:j});continue}}else{const j=`Invalid function_call: ${JSON.stringify(m)}. Available options are: ${d.map(S=>JSON.stringify(S.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:m,content:j});continue}let w;try{w=V6(b)?await b.parse(v):v}catch(j){this._addMessage({role:a,name:m,content:j instanceof Error?j.message:String(j)});continue}const _=await b.function(w,this),x=Jn(this,kn,"m",hj).call(this,_);if(this._addMessage({role:a,name:m,content:x}),c)return}}async _runTools(t,n,r){var p,y,m;const a="tool",{tool_choice:o="auto",stream:i,...s}=n,c=typeof o!="string"&&((p=o==null?void 0:o.function)==null?void 0:p.name),{maxChatCompletions:l=G6}=r||{},u=n.tools.map(v=>{if(Pd(v)){if(!v.$callback)throw new et("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),d={};for(const v of u)v.type==="function"&&(d[v.function.name||v.function.function.name]=v.function);const f="tools"in n?u.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<l;++v){const b=(y=(await this._createChatCompletion(t,{...s,tool_choice:o,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:y.message;if(!b)throw new et("missing message in ChatCompletion response");if(!((m=b.tool_calls)!=null&&m.length))return;for(const w of b.tool_calls){if(w.type!=="function")continue;const _=w.id,{name:x,arguments:j}=w.function,S=d[x];if(S){if(c&&c!==x){const N=`Invalid tool_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:_,content:N});continue}}else{const N=`Invalid tool_call: ${JSON.stringify(x)}. Available options are: ${Object.keys(d).map(P=>JSON.stringify(P)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:_,content:N});continue}let E;try{E=V6(S)?await S.parse(j):j}catch(N){const P=N instanceof Error?N.message:String(N);this._addMessage({role:a,tool_call_id:_,content:P});continue}const O=await S.function(E,this),M=Jn(this,kn,"m",hj).call(this,O);if(this._addMessage({role:a,tool_call_id:_,content:M}),c)return}}}}kn=new WeakSet,uj=function(){return Jn(this,kn,"m",_m).call(this).content??null},_m=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(kc(t)){const{function_call:n,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new et("stream ended without producing a ChatCompletionMessage with role=assistant")},dj=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(kc(r)&&(r!=null&&r.function_call))return r.function_call;if(kc(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},fj=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(q6(t)&&t.content!=null||U6(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},pj=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},X6=function(e){if(e.n!=null&&e.n>1)throw new et("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},hj=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class kd extends Q6{static runFunctions(t,n,r){const a=new kd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new kd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}_addMessage(t,n=!0){super._addMessage(t,n),kc(t)&&t.content&&this._emit("content",t.content)}}const J6=1,Y6=2,e$=4,t$=8,n$=16,r$=32,a$=64,o$=128,i$=256,s$=o$|i$,c$=n$|r$|s$|a$,l$=J6|Y6|c$,u$=e$|t$,Gfe=l$|u$,pn={STR:J6,NUM:Y6,ARR:e$,OBJ:t$,NULL:n$,BOOL:r$,NAN:a$,INFINITY:o$,MINUS_INFINITY:i$,INF:s$,SPECIAL:c$,ATOM:l$,COLLECTION:u$,ALL:Gfe};class Qfe extends Error{}class Jfe extends Error{}function Yfe(e,t=pn.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return epe(e.trim(),t)}const epe=(e,t)=>{const n=e.length;let r=0;const a=f=>{throw new Qfe(`${f} at position ${r}`)},o=f=>{throw new Jfe(`${f} at position ${r}`)},i=()=>(d(),r>=n&&a("Unexpected end of input"),e[r]==='"'?s():e[r]==="{"?c():e[r]==="["?l():e.substring(r,r+4)==="null"||pn.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):e.substring(r,r+4)==="true"||pn.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):e.substring(r,r+5)==="false"||pn.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):e.substring(r,r+8)==="Infinity"||pn.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):e.substring(r,r+9)==="-Infinity"||pn.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):e.substring(r,r+3)==="NaN"||pn.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),s=()=>{const f=r;let p=!1;for(r++;r<n&&(e[r]!=='"'||p&&e[r-1]==="\\");)p=e[r]==="\\"?!p:!1,r++;if(e.charAt(r)=='"')try{return JSON.parse(e.substring(f,++r-Number(p)))}catch(y){o(String(y))}else if(pn.STR&t)try{return JSON.parse(e.substring(f,r-Number(p))+'"')}catch{return JSON.parse(e.substring(f,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{r++,d();const f={};try{for(;e[r]!=="}";){if(d(),r>=n&&pn.OBJ&t)return f;const p=s();d(),r++;try{const y=i();Object.defineProperty(f,p,{value:y,writable:!0,enumerable:!0,configurable:!0})}catch(y){if(pn.OBJ&t)return f;throw y}d(),e[r]===","&&r++}}catch{if(pn.OBJ&t)return f;a("Expected '}' at end of object")}return r++,f},l=()=>{r++;const f=[];try{for(;e[r]!=="]";)f.push(i()),d(),e[r]===","&&r++}catch{if(pn.ARR&t)return f;a("Expected ']' at end of array")}return r++,f},u=()=>{if(r===0){e==="-"&&pn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(p){if(pn.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}o(String(p))}}const f=r;for(e[r]==="-"&&r++;e[r]&&!",]}".includes(e[r]);)r++;r==n&&!(pn.NUM&t)&&a("Unterminated number literal");try{return JSON.parse(e.substring(f,r))}catch{e.substring(f,r)==="-"&&pn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e.substring(f,e.lastIndexOf("e")))}catch(p){o(String(p))}}},d=()=>{for(;r<n&&` 
\r	`.includes(e[r]);)r++};return i()},d$=e=>Yfe(e,pn.ALL^pn.NUM);var Tc=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Nt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},ln,No,Rc,fi,mj,jm,yj,gj,vj,Sm,bj,f$;class Ad extends Q6{constructor(t){super(),ln.add(this),No.set(this,void 0),Rc.set(this,void 0),fi.set(this,void 0),Tc(this,No,t,"f"),Tc(this,Rc,[],"f")}get currentChatCompletionSnapshot(){return Nt(this,fi,"f")}static fromReadableStream(t){const n=new Ad(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,r){const a=new Ad(n);return a._run(()=>a._runChatCompletion(t,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(t,n,r){var i;super._createChatCompletion;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Nt(this,ln,"m",mj).call(this);const o=await t.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const s of o)Nt(this,ln,"m",yj).call(this,s);if((i=o.controller.signal)!=null&&i.aborted)throw new Or;return this._addChatCompletion(Nt(this,ln,"m",Sm).call(this))}async _fromReadableStream(t,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Nt(this,ln,"m",mj).call(this),this._connected();const a=jd.fromReadableStream(t,this.controller);let o;for await(const s of a)o&&o!==s.id&&this._addChatCompletion(Nt(this,ln,"m",Sm).call(this)),Nt(this,ln,"m",yj).call(this,s),o=s.id;if((i=a.controller.signal)!=null&&i.aborted)throw new Or;return this._addChatCompletion(Nt(this,ln,"m",Sm).call(this))}[(No=new WeakMap,Rc=new WeakMap,fi=new WeakMap,ln=new WeakSet,mj=function(){this.ended||Tc(this,fi,void 0,"f")},jm=function(t){let n=Nt(this,Rc,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Nt(this,Rc,"f")[t.index]=n,n)},yj=function(t){var r,a,o,i,s,c,l,u,d,f,p,y,m,v,b;if(this.ended)return;const n=Nt(this,ln,"m",f$).call(this,t);this._emit("chunk",t,n);for(const w of t.choices){const _=n.choices[w.index];w.delta.content!=null&&((r=_.message)==null?void 0:r.role)==="assistant"&&((a=_.message)!=null&&a.content)&&(this._emit("content",w.delta.content,_.message.content),this._emit("content.delta",{delta:w.delta.content,snapshot:_.message.content,parsed:_.message.parsed})),w.delta.refusal!=null&&((o=_.message)==null?void 0:o.role)==="assistant"&&((i=_.message)!=null&&i.refusal)&&this._emit("refusal.delta",{delta:w.delta.refusal,snapshot:_.message.refusal}),((s=w.logprobs)==null?void 0:s.content)!=null&&((c=_.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(l=w.logprobs)==null?void 0:l.content,snapshot:((u=_.logprobs)==null?void 0:u.content)??[]}),((d=w.logprobs)==null?void 0:d.refusal)!=null&&((f=_.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(p=w.logprobs)==null?void 0:p.refusal,snapshot:((y=_.logprobs)==null?void 0:y.refusal)??[]});const x=Nt(this,ln,"m",jm).call(this,_);_.finish_reason&&(Nt(this,ln,"m",vj).call(this,_),x.current_tool_call_index!=null&&Nt(this,ln,"m",gj).call(this,_,x.current_tool_call_index));for(const j of w.delta.tool_calls??[])x.current_tool_call_index!==j.index&&(Nt(this,ln,"m",vj).call(this,_),x.current_tool_call_index!=null&&Nt(this,ln,"m",gj).call(this,_,x.current_tool_call_index)),x.current_tool_call_index=j.index;for(const j of w.delta.tool_calls??[]){const S=(m=_.message.tool_calls)==null?void 0:m[j.index];S!=null&&S.type&&((S==null?void 0:S.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=S.function)==null?void 0:v.name,index:j.index,arguments:S.function.arguments,parsed_arguments:S.function.parsed_arguments,arguments_delta:((b=j.function)==null?void 0:b.arguments)??""}):S==null||S.type)}}},gj=function(t,n){var a,o,i;if(Nt(this,ln,"m",jm).call(this,t).done_tool_calls.has(n))return;const r=(a=t.message.tool_calls)==null?void 0:a[n];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const s=(i=(o=Nt(this,No,"f"))==null?void 0:o.tools)==null?void 0:i.find(c=>c.type==="function"&&c.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:n,arguments:r.function.arguments,parsed_arguments:Pd(s)?s.$parseRaw(r.function.arguments):s!=null&&s.function.strict?JSON.parse(r.function.arguments):null})}else r.type},vj=function(t){var r,a;const n=Nt(this,ln,"m",jm).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const o=Nt(this,ln,"m",bj).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Sm=function(){if(this.ended)throw new et("stream has ended, this shouldn't happen");const t=Nt(this,fi,"f");if(!t)throw new et("request ended without sending any chunks");return Tc(this,fi,void 0,"f"),Tc(this,Rc,[],"f"),tpe(t,Nt(this,No,"f"))},bj=function(){var n;const t=(n=Nt(this,No,"f"))==null?void 0:n.response_format;return Z6(t)?t:null},f$=function(t){var n,r,a,o;let i=Nt(this,fi,"f");const{choices:s,...c}=t;i?Object.assign(i,c):i=Tc(this,fi,{...c,choices:[]},"f");for(const{delta:l,finish_reason:u,index:d,logprobs:f=null,...p}of t.choices){let y=i.choices[d];if(y||(y=i.choices[d]={finish_reason:u,index:d,message:{},logprobs:f,...p}),f)if(!y.logprobs)y.logprobs=Object.assign({},f);else{const{content:j,refusal:S,...E}=f;Object.assign(y.logprobs,E),j&&((n=y.logprobs).content??(n.content=[]),y.logprobs.content.push(...j)),S&&((r=y.logprobs).refusal??(r.refusal=[]),y.logprobs.refusal.push(...S))}if(u&&(y.finish_reason=u,Nt(this,No,"f")&&K6(Nt(this,No,"f")))){if(u==="length")throw new w6;if(u==="content_filter")throw new x6}if(Object.assign(y,p),!l)continue;const{content:m,refusal:v,function_call:b,role:w,tool_calls:_,...x}=l;if(Object.assign(y.message,x),v&&(y.message.refusal=(y.message.refusal||"")+v),w&&(y.message.role=w),b&&(y.message.function_call?(b.name&&(y.message.function_call.name=b.name),b.arguments&&((a=y.message.function_call).arguments??(a.arguments=""),y.message.function_call.arguments+=b.arguments)):y.message.function_call=b),m&&(y.message.content=(y.message.content||"")+m,!y.message.refusal&&Nt(this,ln,"m",bj).call(this)&&(y.message.parsed=d$(y.message.content))),_){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:j,id:S,type:E,function:O,...M}of _){const N=(o=y.message.tool_calls)[j]??(o[j]={});Object.assign(N,M),S&&(N.id=S),E&&(N.type=E),O&&(N.function??(N.function={name:O.name??"",arguments:""})),O!=null&&O.name&&(N.function.name=O.name),O!=null&&O.arguments&&(N.function.arguments+=O.arguments,Kfe(Nt(this,No,"f"),N)&&(N.function.parsed_arguments=d$(N.function.arguments)))}}}return i},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("chunk",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new jd(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function tpe(e,t){const{id:n,choices:r,created:a,model:o,system_fingerprint:i,...s}=e,c={...s,id:n,choices:r.map(({message:l,finish_reason:u,index:d,logprobs:f,...p})=>{if(!u)throw new et(`missing finish_reason for choice ${d}`);const{content:y=null,function_call:m,tool_calls:v,...b}=l,w=l.role;if(!w)throw new et(`missing role for choice ${d}`);if(m){const{arguments:_,name:x}=m;if(_==null)throw new et(`missing function_call.arguments for choice ${d}`);if(!x)throw new et(`missing function_call.name for choice ${d}`);return{...p,message:{content:y,function_call:{arguments:_,name:x},role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:f}}return v?{...p,index:d,finish_reason:u,logprobs:f,message:{...b,role:w,content:y,refusal:l.refusal??null,tool_calls:v.map((_,x)=>{const{function:j,type:S,id:E,...O}=_,{arguments:M,name:N,...P}=j||{};if(E==null)throw new et(`missing choices[${d}].tool_calls[${x}].id
${Em(e)}`);if(S==null)throw new et(`missing choices[${d}].tool_calls[${x}].type
${Em(e)}`);if(N==null)throw new et(`missing choices[${d}].tool_calls[${x}].function.name
${Em(e)}`);if(M==null)throw new et(`missing choices[${d}].tool_calls[${x}].function.arguments
${Em(e)}`);return{...O,id:E,type:S,function:{...P,name:N,arguments:M}}})}}:{...p,message:{...b,content:y,role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:f}}),created:a,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Wfe(c,t)}function Em(e){return JSON.stringify(e)}class Ic extends Ad{static fromReadableStream(t){const n=new Ic(null);return n._run(()=>n._fromReadableStream(t)),n}static runFunctions(t,n,r){const a=new Ic(null),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new Ic(n),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}}let p$=class extends ht{parse(e,t){return Xfe(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>lj(n,e))}runFunctions(e,t){return e.stream?Ic.runFunctions(this._client,e,t):kd.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Ic.runTools(this._client,e,t):kd.runTools(this._client,e,t)}stream(e,t){return Ad.createChatCompletion(this._client,e,t)}},wj=class extends ht{constructor(){super(...arguments),this.completions=new p$(this._client)}};(function(e){e.Completions=p$})(wj||(wj={}));class h$ extends ht{create(t,n){return this._client.post("/realtime/sessions",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class xj extends ht{constructor(){super(...arguments),this.sessions=new h$(this._client)}}xj.Sessions=h$;var Re=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},gr=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Sn,_j,Fa,Om,ta,ts,Dc,ns,Cm,vr,Nm,Mm,Td,Rd,Id,m$,y$,g$,v$,b$,w$,x$;class na extends H6{constructor(){super(...arguments),Sn.add(this),_j.set(this,[]),Fa.set(this,{}),Om.set(this,{}),ta.set(this,void 0),ts.set(this,void 0),Dc.set(this,void 0),ns.set(this,void 0),Cm.set(this,void 0),vr.set(this,void 0),Nm.set(this,void 0),Mm.set(this,void 0),Td.set(this,void 0)}[(_j=new WeakMap,Fa=new WeakMap,Om=new WeakMap,ta=new WeakMap,ts=new WeakMap,Dc=new WeakMap,ns=new WeakMap,Cm=new WeakMap,vr=new WeakMap,Nm=new WeakMap,Mm=new WeakMap,Td=new WeakMap,Sn=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("event",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new na;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=jd.fromReadableStream(t,this.controller);for await(const i of a)Re(this,Sn,"m",Rd).call(this,i);if((o=a.controller.signal)!=null&&o.aborted)throw new Or;return this._addRun(Re(this,Sn,"m",Id).call(this))}toReadableStream(){return new jd(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,r,a,o){const i=new na;return i._run(()=>i._runToolAssistantStream(t,n,r,a,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(t,n,r,a,o){var l;const i=o==null?void 0:o.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...a,stream:!0},c=await t.submitToolOutputs(n,r,s,{...o,signal:this.controller.signal});this._connected();for await(const u of c)Re(this,Sn,"m",Rd).call(this,u);if((l=c.controller.signal)!=null&&l.aborted)throw new Or;return this._addRun(Re(this,Sn,"m",Id).call(this))}static createThreadAssistantStream(t,n,r){const a=new na;return a._run(()=>a._threadAssistantStream(t,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(t,n,r,a){const o=new na;return o._run(()=>o._runAssistantStream(t,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return Re(this,Nm,"f")}currentRun(){return Re(this,Mm,"f")}currentMessageSnapshot(){return Re(this,ta,"f")}currentRunStepSnapshot(){return Re(this,Td,"f")}async finalRunSteps(){return await this.done(),Object.values(Re(this,Fa,"f"))}async finalMessages(){return await this.done(),Object.values(Re(this,Om,"f"))}async finalRun(){if(await this.done(),!Re(this,ts,"f"))throw Error("Final run was not received.");return Re(this,ts,"f")}async _createThreadAssistantStream(t,n,r){var s;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},i=await t.createAndRun(o,{...r,signal:this.controller.signal});this._connected();for await(const c of i)Re(this,Sn,"m",Rd).call(this,c);if((s=i.controller.signal)!=null&&s.aborted)throw new Or;return this._addRun(Re(this,Sn,"m",Id).call(this))}async _createAssistantStream(t,n,r,a){var c;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},s=await t.create(n,i,{...a,signal:this.controller.signal});this._connected();for await(const l of s)Re(this,Sn,"m",Rd).call(this,l);if((c=s.controller.signal)!=null&&c.aborted)throw new Or;return this._addRun(Re(this,Sn,"m",Id).call(this))}static accumulateDelta(t,n){for(const[r,a]of Object.entries(n)){if(!t.hasOwnProperty(r)){t[r]=a;continue}let o=t[r];if(o==null){t[r]=a;continue}if(r==="index"||r==="type"){t[r]=a;continue}if(typeof o=="string"&&typeof a=="string")o+=a;else if(typeof o=="number"&&typeof a=="number")o+=a;else if(nj(o)&&nj(a))o=this.accumulateDelta(o,a);else if(Array.isArray(o)&&Array.isArray(a)){if(o.every(i=>typeof i=="string"||typeof i=="number")){o.push(...a);continue}for(const i of a){if(!nj(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const s=i.index;if(s==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof s!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const c=o[s];c==null?o.push(i):o[s]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${o}`);t[r]=o}return t}_addRun(t){return t}async _threadAssistantStream(t,n,r){return await this._createThreadAssistantStream(n,t,r)}async _runAssistantStream(t,n,r,a){return await this._createAssistantStream(n,t,r,a)}async _runToolAssistantStream(t,n,r,a,o){return await this._createToolAssistantStream(r,t,n,a,o)}}Rd=function(e){if(!this.ended)switch(gr(this,Nm,e,"f"),Re(this,Sn,"m",g$).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Re(this,Sn,"m",x$).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Re(this,Sn,"m",y$).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Re(this,Sn,"m",m$).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Id=function(){if(this.ended)throw new et("stream has ended, this shouldn't happen");if(!Re(this,ts,"f"))throw Error("Final run has not been received");return Re(this,ts,"f")},m$=function(e){const[t,n]=Re(this,Sn,"m",b$).call(this,e,Re(this,ta,"f"));gr(this,ta,t,"f"),Re(this,Om,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,o=t.content[r.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=Re(this,Dc,"f")){if(Re(this,ns,"f"))switch(Re(this,ns,"f").type){case"text":this._emit("textDone",Re(this,ns,"f").text,Re(this,ta,"f"));break;case"image_file":this._emit("imageFileDone",Re(this,ns,"f").image_file,Re(this,ta,"f"));break}gr(this,Dc,r.index,"f")}gr(this,ns,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Re(this,Dc,"f")!==void 0){const r=e.data.content[Re(this,Dc,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,Re(this,ta,"f"));break;case"text":this._emit("textDone",r.text,Re(this,ta,"f"));break}}Re(this,ta,"f")&&this._emit("messageDone",e.data),gr(this,ta,void 0,"f")}},y$=function(e){const t=Re(this,Sn,"m",v$).call(this,e);switch(gr(this,Td,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const r of n.step_details.tool_calls)r.index==Re(this,Cm,"f")?this._emit("toolCallDelta",r,t.step_details.tool_calls[r.index]):(Re(this,vr,"f")&&this._emit("toolCallDone",Re(this,vr,"f")),gr(this,Cm,r.index,"f"),gr(this,vr,t.step_details.tool_calls[r.index],"f"),Re(this,vr,"f")&&this._emit("toolCallCreated",Re(this,vr,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":gr(this,Td,void 0,"f"),e.data.step_details.type=="tool_calls"&&Re(this,vr,"f")&&(this._emit("toolCallDone",Re(this,vr,"f")),gr(this,vr,void 0,"f")),this._emit("runStepDone",e.data,t);break}},g$=function(e){Re(this,_j,"f").push(e),this._emit("event",e)},v$=function(e){switch(e.event){case"thread.run.step.created":return Re(this,Fa,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Re(this,Fa,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=na.accumulateDelta(t,n.delta);Re(this,Fa,"f")[e.data.id]=r}return Re(this,Fa,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Re(this,Fa,"f")[e.data.id]=e.data;break}if(Re(this,Fa,"f")[e.data.id])return Re(this,Fa,"f")[e.data.id];throw new Error("No snapshot available")},b$=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let o=t.content[a.index];t.content[a.index]=Re(this,Sn,"m",w$).call(this,a,o)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},w$=function(e,t){return na.accumulateDelta(t,e)},x$=function(e){switch(gr(this,Mm,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":gr(this,ts,e.data,"f"),Re(this,vr,"f")&&(this._emit("toolCallDone",Re(this,vr,"f")),gr(this,vr,void 0,"f"));break}};class jj extends ht{create(t,n,r){return this._client.post(`/threads/${t}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/messages/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return Qn(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/messages`,Sj,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n,r){return this._client.delete(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Sj extends Yr{}jj.MessagesPage=Sj;class Ej extends ht{retrieve(t,n,r,a={},o){return Qn(a)?this.retrieve(t,n,r,{},a):this._client.get(`/threads/${t}/runs/${n}/steps/${r}`,{query:a,...o,headers:{"OpenAI-Beta":"assistants=v2",...o==null?void 0:o.headers}})}list(t,n,r={},a){return Qn(r)?this.list(t,n,{},r):this._client.getAPIList(`/threads/${t}/runs/${n}/steps`,Oj,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class Oj extends Yr{}Ej.RunStepsPage=Oj;class Dd extends ht{constructor(){super(...arguments),this.steps=new Ej(this._client)}create(t,n,r){const{include:a,...o}=n;return this._client.post(`/threads/${t}/runs`,{query:{include:a},body:o,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(t,n,r){return this._client.get(`/threads/${t}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return Qn(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/runs`,Cj,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/threads/${t}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n,r);return await this.poll(t,a.id,r)}createAndStream(t,n,r){return na.createAssistantStream(t,this._client.beta.threads.runs,n,r)}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:{...r==null?void 0:r.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await Sd(s);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,n,r){return na.createAssistantStream(t,this._client.beta.threads.runs,n,r)}submitToolOutputs(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}/submit_tool_outputs`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(t,n,r,a){const o=await this.submitToolOutputs(t,n,r,a);return await this.poll(t,o.id,a)}submitToolOutputsStream(t,n,r,a){return na.createToolAssistantStream(t,n,this._client.beta.threads.runs,r,a)}}class Cj extends Yr{}Dd.RunsPage=Cj,Dd.Steps=Ej,Dd.RunStepsPage=Oj;class Lc extends ht{constructor(){super(...arguments),this.runs=new Dd(this._client),this.messages=new jj(this._client)}create(t={},n){return Qn(t)?this.create({},t):this._client.post("/threads",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/threads/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n){return this._client.delete(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}async createAndRunPoll(t,n){const r=await this.createAndRun(t,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(t,n){return na.createThreadAssistantStream(t,this._client.beta.threads,n)}}Lc.Runs=Dd,Lc.RunsPage=Cj,Lc.Messages=jj,Lc.MessagesPage=Sj;const npe=async e=>{const t=await Promise.allSettled(e),n=t.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const a of t)a.status==="fulfilled"&&r.push(a.value);return r};let Nj=class extends ht{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return Qn(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Pm,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for((n==null?void 0:n.pollIntervalMs)&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),o=a.data;switch(o.status){case"in_progress":let i=5e3;if(n!=null&&n.pollIntervalMs)i=n.pollIntervalMs;else{const s=a.response.headers.get("openai-poll-after-ms");if(s){const c=parseInt(s);isNaN(c)||(i=c)}}await Sd(i);break;case"failed":case"completed":return o}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}};class Pm extends Yr{}Nj.VectorStoreFilesPage=Pm;class _$ extends ht{create(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/vector_stores/${t}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n);return await this.poll(t,a.id,r)}listFiles(t,n,r={},a){return Qn(r)?this.listFiles(t,n,{},r):this._client.getAPIList(`/vector_stores/${t}/file_batches/${n}/files`,Pm,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:a}).withResponse();switch(o.status){case"in_progress":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await Sd(s);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:n,fileIds:r=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=(a==null?void 0:a.maxConcurrency)??5,i=Math.min(o,n.length),s=this._client,c=n.values(),l=[...r];async function u(f){for(let p of f){const y=await s.files.create({file:p,purpose:"assistants"},a);l.push(y.id)}}const d=Array(i).fill(c).map(u);return await npe(d),await this.createAndPoll(t,{file_ids:l})}}class $c extends ht{constructor(){super(...arguments),this.files=new Nj(this._client),this.fileBatches=new _$(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/vector_stores/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return Qn(t)?this.list({},t):this._client.getAPIList("/vector_stores",Mj,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Mj extends Yr{}$c.VectorStoresPage=Mj,$c.Files=Nj,$c.VectorStoreFilesPage=Pm,$c.FileBatches=_$;class pi extends ht{constructor(){super(...arguments),this.realtime=new xj(this._client),this.vectorStores=new $c(this._client),this.chat=new wj(this._client),this.assistants=new ij(this._client),this.threads=new Lc(this._client)}}pi.Realtime=xj,pi.VectorStores=$c,pi.VectorStoresPage=Mj,pi.Assistants=ij,pi.AssistantsPage=sj,pi.Threads=Lc;let j$=class extends ht{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}},S$=class extends ht{create(e,t){return this._client.post("/embeddings",{body:e,...t})}};class Pj extends ht{create(t,n){return this._client.post("/files",Nc({body:t,...n}))}retrieve(t,n){return this._client.get(`/files/${t}`,n)}list(t={},n){return Qn(t)?this.list({},t):this._client.getAPIList("/files",kj,{query:t,...n})}del(t,n){return this._client.delete(`/files/${t}`,n)}content(t,n){return this._client.get(`/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(t,n){return this._client.get(`/files/${t}/content`,n)}async waitForProcessing(t,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),o=Date.now();let i=await this.retrieve(t);for(;!i.status||!a.has(i.status);)if(await Sd(n),i=await this.retrieve(t),Date.now()-o>r)throw new fm({message:`Giving up on waiting for file ${t} to finish processing after ${r} milliseconds.`});return i}}class kj extends Yr{}Pj.FileObjectsPage=kj;class Aj extends ht{list(t,n={},r){return Qn(n)?this.list(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,Tj,{query:n,...r})}}class Tj extends Yr{}Aj.FineTuningJobCheckpointsPage=Tj;class Fc extends ht{constructor(){super(...arguments),this.checkpoints=new Aj(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(`/fine_tuning/jobs/${t}`,n)}list(t={},n){return Qn(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",Rj,{query:t,...n})}cancel(t,n){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},r){return Qn(n)?this.listEvents(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,Ij,{query:n,...r})}}class Rj extends Yr{}class Ij extends Yr{}Fc.FineTuningJobsPage=Rj,Fc.FineTuningJobEventsPage=Ij,Fc.Checkpoints=Aj,Fc.FineTuningJobCheckpointsPage=Tj;class Ld extends ht{constructor(){super(...arguments),this.jobs=new Fc(this._client)}}Ld.Jobs=Fc,Ld.FineTuningJobsPage=Rj,Ld.FineTuningJobEventsPage=Ij;class E$ extends ht{createVariation(t,n){return this._client.post("/images/variations",Nc({body:t,...n}))}edit(t,n){return this._client.post("/images/edits",Nc({body:t,...n}))}generate(t,n){return this._client.post("/images/generations",{body:t,...n})}}let Dj=class extends ht{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Lj,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}};class Lj extends Vfe{}Dj.ModelsPage=Lj;class O$ extends ht{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class C$ extends ht{create(t,n,r){return this._client.post(`/uploads/${t}/parts`,Nc({body:n,...r}))}}class $j extends ht{constructor(){super(...arguments),this.parts=new C$(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(`/uploads/${t}/cancel`,n)}complete(t,n,r){return this._client.post(`/uploads/${t}/complete`,{body:n,...r})}}$j.Parts=C$;var N$;let it=class extends Mfe{constructor({baseURL:e=ym("OPENAI_BASE_URL"),apiKey:t=ym("OPENAI_API_KEY"),organization:n=ym("OPENAI_ORG_ID")??null,project:r=ym("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new et("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&Bfe())throw new et(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new j$(this),this.chat=new rj(this),this.embeddings=new S$(this),this.files=new Pj(this),this.images=new E$(this),this.audio=new Ed(this),this.moderations=new O$(this),this.models=new Dj(this),this.fineTuning=new Ld(this),this.beta=new pi(this),this.batches=new aj(this),this.uploads=new $j(this),this._options=o,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return ffe(e,{arrayFormat:"brackets"})}};N$=it,it.OpenAI=N$,it.DEFAULT_TIMEOUT=6e5,it.OpenAIError=et,it.APIError=Gn,it.APIConnectionError=dm,it.APIConnectionTimeoutError=fm,it.APIUserAbortError=Or,it.NotFoundError=m6,it.ConflictError=y6,it.RateLimitError=v6,it.BadRequestError=f6,it.AuthenticationError=p6,it.InternalServerError=b6,it.PermissionDeniedError=h6,it.UnprocessableEntityError=g6,it.toFile=E6,it.fileFromPath=u6,it.Completions=j$,it.Chat=rj,it.Embeddings=S$,it.Files=Pj,it.FileObjectsPage=kj,it.Images=E$,it.Audio=Ed,it.Moderations=O$,it.Models=Dj,it.ModelsPage=Lj,it.FineTuning=Ld,it.Beta=pi,it.Batches=aj,it.BatchesPage=oj,it.Uploads=$j;var rpe=typeof window=="object"?window:{},Ke="0123456789abcdef".split(""),ape=[-2147483648,8388608,32768,128],ra=[24,16,8,0],hn=[];function aa(e){e?(hn[0]=hn[16]=hn[1]=hn[2]=hn[3]=hn[4]=hn[5]=hn[6]=hn[7]=hn[8]=hn[9]=hn[10]=hn[11]=hn[12]=hn[13]=hn[14]=hn[15]=0,this.blocks=hn):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}aa.prototype.update=function(e){if(!this.finalized){var t=typeof e!="string";t&&e.constructor===rpe.ArrayBuffer&&(e=new Uint8Array(e));for(var n,r=0,a,o=e.length||0,i=this.blocks;r<o;){if(this.hashed&&(this.hashed=!1,i[0]=this.block,i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),t)for(a=this.start;r<o&&a<64;++r)i[a>>2]|=e[r]<<ra[a++&3];else for(a=this.start;r<o&&a<64;++r)n=e.charCodeAt(r),n<128?i[a>>2]|=n<<ra[a++&3]:n<2048?(i[a>>2]|=(192|n>>6)<<ra[a++&3],i[a>>2]|=(128|n&63)<<ra[a++&3]):n<55296||n>=57344?(i[a>>2]|=(224|n>>12)<<ra[a++&3],i[a>>2]|=(128|n>>6&63)<<ra[a++&3],i[a>>2]|=(128|n&63)<<ra[a++&3]):(n=65536+((n&1023)<<10|e.charCodeAt(++r)&1023),i[a>>2]|=(240|n>>18)<<ra[a++&3],i[a>>2]|=(128|n>>12&63)<<ra[a++&3],i[a>>2]|=(128|n>>6&63)<<ra[a++&3],i[a>>2]|=(128|n&63)<<ra[a++&3]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=i[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},aa.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=ape[t&3],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},aa.prototype.hash=function(){var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4,o,i,s,c=this.blocks;for(i=16;i<80;++i)s=c[i-3]^c[i-8]^c[i-14]^c[i-16],c[i]=s<<1|s>>>31;for(i=0;i<20;i+=5)o=t&n|~t&r,s=e<<5|e>>>27,a=s+o+a+1518500249+c[i]<<0,t=t<<30|t>>>2,o=e&t|~e&n,s=a<<5|a>>>27,r=s+o+r+1518500249+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|~a&t,s=r<<5|r>>>27,n=s+o+n+1518500249+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|~r&e,s=n<<5|n>>>27,t=s+o+t+1518500249+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|~n&a,s=t<<5|t>>>27,e=s+o+e+1518500249+c[i+4]<<0,n=n<<30|n>>>2;for(;i<40;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a+1859775393+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r+1859775393+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n+1859775393+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t+1859775393+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e+1859775393+c[i+4]<<0,n=n<<30|n>>>2;for(;i<60;i+=5)o=t&n|t&r|n&r,s=e<<5|e>>>27,a=s+o+a-1894007588+c[i]<<0,t=t<<30|t>>>2,o=e&t|e&n|t&n,s=a<<5|a>>>27,r=s+o+r-1894007588+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|a&t|e&t,s=r<<5|r>>>27,n=s+o+n-1894007588+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|r&e|a&e,s=n<<5|n>>>27,t=s+o+t-1894007588+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|n&a|r&a,s=t<<5|t>>>27,e=s+o+e-1894007588+c[i+4]<<0,n=n<<30|n>>>2;for(;i<80;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a-899497514+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r-899497514+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n-899497514+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t-899497514+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e-899497514+c[i+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+a<<0},aa.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return Ke[e>>28&15]+Ke[e>>24&15]+Ke[e>>20&15]+Ke[e>>16&15]+Ke[e>>12&15]+Ke[e>>8&15]+Ke[e>>4&15]+Ke[e&15]+Ke[t>>28&15]+Ke[t>>24&15]+Ke[t>>20&15]+Ke[t>>16&15]+Ke[t>>12&15]+Ke[t>>8&15]+Ke[t>>4&15]+Ke[t&15]+Ke[n>>28&15]+Ke[n>>24&15]+Ke[n>>20&15]+Ke[n>>16&15]+Ke[n>>12&15]+Ke[n>>8&15]+Ke[n>>4&15]+Ke[n&15]+Ke[r>>28&15]+Ke[r>>24&15]+Ke[r>>20&15]+Ke[r>>16&15]+Ke[r>>12&15]+Ke[r>>8&15]+Ke[r>>4&15]+Ke[r&15]+Ke[a>>28&15]+Ke[a>>24&15]+Ke[a>>20&15]+Ke[a>>16&15]+Ke[a>>12&15]+Ke[a>>8&15]+Ke[a>>4&15]+Ke[a&15]},aa.prototype.toString=aa.prototype.hex,aa.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,a>>24&255,a>>16&255,a>>8&255,a&255]},aa.prototype.array=aa.prototype.digest,aa.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};const ope=e=>new aa(!0).update(e).hex(),M$=(...e)=>ope(e.join("_"));class ipe{}const spe=new Map;class Fj extends ipe{constructor(t){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=t??new Map}lookup(t,n){return Promise.resolve(this.cache.get(M$(t,n))??null)}async update(t,n,r){this.cache.set(M$(t,n),r)}static global(){return new Fj(spe)}}const cpe=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e;function lpe(e){return typeof e!="object"||!e?!1:!!("type"in e&&e.type==="function"&&"function"in e&&typeof e.function=="object"&&e.function&&"name"in e.function&&"parameters"in e.function)}const upe=()=>!1;class dpe extends Qf{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(t){super(t),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=t.verbose??upe(),this.callbacks=t.callbacks,this.tags=t.tags??[],this.metadata=t.metadata??{}}}class fpe extends dpe{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:t,callbackManager:n,...r}){super({callbacks:t??n,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r.cache=="object"?this.cache=r.cache:r.cache?this.cache=Fj.global():this.cache=void 0,this.caller=new YTe(r??{})}async getNumTokens(t){if(typeof t!="string")return 0;let n=Math.ceil(t.length/4);if(!this._encoding)try{this._encoding=await eRe("modelName"in this?cpe(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{n=this._encoding.encode(t).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return n}static _convertInputToPromptValue(t){return typeof t=="string"?new qL(t):Array.isArray(t)?new Bde(t.map(Jf)):t}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:t,...n}){const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([a,o])=>o!==void 0).map(([a,o])=>`${a}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(t){throw new Error("Use .toJSON() instead")}}class Bc extends Qf{static lc_name(){return"RunnablePassthrough"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t&&(this.func=t.func)}async invoke(t,n){const r=kK(n);return this.func&&await this.func(t,r),this._callWithConfig(a=>Promise.resolve(a),t,r)}async*transform(t,n){const r=kK(n);let a,o=!0;for await(const i of this._transformStreamWithConfig(t,s=>s,r))if(yield i,o)if(a===void 0)a=i;else try{a=AK(a,i)}catch{a=void 0,o=!1}this.func&&a!==void 0&&await this.func(a,r)}static assign(t){return new tRe(new nRe({steps:t}))}}function km(e){return typeof(e==null?void 0:e.parse)=="function"}class Mo extends fpe{constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(t){const[n,r]=super._separateRunnableConfigFromCallOptions(t);return r.signal=n.signal,[n,r]}async invoke(t,n){const r=Mo._convertInputToPromptValue(t);return(await this.generatePrompt([r],n,n==null?void 0:n.callbacks)).generations[0][0].message}async*_streamResponseChunks(t,n,r){throw new Error("Not implemented.")}async*_streamIterator(t,n){var r;if(this._streamResponseChunks===Mo.prototype._streamResponseChunks)yield this.invoke(t,n);else{const a=Mo._convertInputToPromptValue(t).toChatMessages(),[o,i]=this._separateRunnableConfigFromCallOptionsCompat(n),s={...o.metadata,...this.getLsParams(i)},c=await cM.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),[a],o.runId,void 0,l,void 0,void 0,o.runName));let d;try{for await(const f of this._streamResponseChunks(a,i,u==null?void 0:u[0])){if(f.message.id==null){const p=(r=u==null?void 0:u.at(0))==null?void 0:r.runId;p!=null&&f.message._updateId(`run-${p}`)}f.message.response_metadata={...f.generationInfo,...f.message.response_metadata},yield f.message,d?d=d.concat(f):d=f}}catch(f){throw await Promise.all((u??[]).map(p=>p==null?void 0:p.handleLLMError(f))),f}await Promise.all((u??[]).map(f=>f==null?void 0:f.handleLLMEnd({generations:[[d]]})))}}getLsParams(t){return{ls_model_type:"chat",ls_stop:t.stop}}async _generateUncached(t,n,r){var f,p;const a=t.map(y=>y.map(Jf)),o={...r.metadata,...this.getLsParams(n)},i=await cM.configure(r.callbacks,this.callbacks,r.tags,this.tags,o,this.metadata,{verbose:this.verbose}),s={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:1},c=await(i==null?void 0:i.handleChatModelStart(this.toJSON(),a,r.runId,void 0,s,void 0,void 0,r.runName)),l=[],u=[];if(c!=null&&c[0].handlers.find(y=>rRe(y)||aRe(y))&&a.length===1&&this._streamResponseChunks!==Mo.prototype._streamResponseChunks)try{const y=await this._streamResponseChunks(a[0],n,c==null?void 0:c[0]);let m;for await(const v of y){if(v.message.id==null){const b=(f=c==null?void 0:c.at(0))==null?void 0:f.runId;b!=null&&v.message._updateId(`run-${b}`)}m===void 0?m=v:m=AK(m,v)}if(m===void 0)throw new Error("Received empty response from chat model call.");l.push([m]),await(c==null?void 0:c[0].handleLLMEnd({generations:l,llmOutput:{}}))}catch(y){throw await(c==null?void 0:c[0].handleLLMError(y)),y}else{const y=await Promise.allSettled(a.map((m,v)=>this._generate(m,{...n,promptIndex:v},c==null?void 0:c[v])));await Promise.all(y.map(async(m,v)=>{var b,w,_;if(m.status==="fulfilled"){const x=m.value;for(const j of x.generations){if(j.message.id==null){const S=(b=c==null?void 0:c.at(0))==null?void 0:b.runId;S!=null&&j.message._updateId(`run-${S}`)}j.message.response_metadata={...j.generationInfo,...j.message.response_metadata}}return x.generations.length===1&&(x.generations[0].message.response_metadata={...x.llmOutput,...x.generations[0].message.response_metadata}),l[v]=x.generations,u[v]=x.llmOutput,(w=c==null?void 0:c[v])==null?void 0:w.handleLLMEnd({generations:[x.generations],llmOutput:x.llmOutput})}else return await((_=c==null?void 0:c[v])==null?void 0:_.handleLLMError(m.reason)),Promise.reject(m.reason)}))}const d={generations:l,llmOutput:u.length?(p=this._combineLLMOutput)==null?void 0:p.call(this,...u):void 0};return Object.defineProperty(d,TK,{value:c?{runIds:c==null?void 0:c.map(y=>y.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:t,cache:n,llmStringKey:r,parsedOptions:a,handledOptions:o}){const i=t.map(m=>m.map(Jf)),s={...o.metadata,...this.getLsParams(a)},c=await cM.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1,cached:!0},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),i,o.runId,void 0,l,void 0,void 0,o.runName)),d=[],f=(await Promise.allSettled(i.map(async(m,v)=>{const b=Mo._convertInputToPromptValue(m).toString(),w=await n.lookup(b,r);return w==null&&d.push(v),w}))).map((m,v)=>({result:m,runManager:u==null?void 0:u[v]})).filter(({result:m})=>m.status==="fulfilled"&&m.value!=null||m.status==="rejected"),p=[];await Promise.all(f.map(async({result:m,runManager:v},b)=>{if(m.status==="fulfilled"){const w=m.value;return p[b]=w,w.length&&await(v==null?void 0:v.handleLLMNewToken(w[0].text)),v==null?void 0:v.handleLLMEnd({generations:[w]})}else return await(v==null?void 0:v.handleLLMError(m.reason)),Promise.reject(m.reason)}));const y={generations:p,missingPromptIndices:d};return Object.defineProperty(y,TK,{value:u?{runIds:u==null?void 0:u.map(m=>m.runId)}:void 0,configurable:!0}),y}async generate(t,n,r){let a;Array.isArray(n)?a={stop:n}:a=n;const o=t.map(p=>p.map(Jf)),[i,s]=this._separateRunnableConfigFromCallOptionsCompat(a);if(i.callbacks=i.callbacks??r,!this.cache)return this._generateUncached(o,s,i);const{cache:c}=this,l=this._getSerializedCacheKeyParametersForCall(s),{generations:u,missingPromptIndices:d}=await this._generateCached({messages:o,cache:c,llmStringKey:l,parsedOptions:s,handledOptions:i});let f={};if(d.length>0){const p=await this._generateUncached(d.map(y=>o[y]),s,i);await Promise.all(p.generations.map(async(y,m)=>{const v=d[m];u[v]=y;const b=Mo._convertInputToPromptValue(o[v]).toString();return c.update(b,l,y)})),f=p.llmOutput??{}}return{generations:u,llmOutput:f}}invocationParams(t){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(t,n,r){const a=t.map(o=>o.toChatMessages());return this.generate(a,n,r)}async call(t,n,r){return(await this.generate([t.map(Jf)],n,r)).generations[0][0].message}async callPrompt(t,n,r){const a=t.toChatMessages();return this.call(a,n,r)}async predictMessages(t,n,r){return this.call(t,n,r)}async predict(t,n,r){const a=new Dr(t),o=await this.call([a],n,r);if(typeof o.content!="string")throw new Error("Cannot use predict when output is not a string.");return o.content}withStructuredOutput(t,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');const r=t,a=n==null?void 0:n.name,o=r.description??"A function available to call.",i=n==null?void 0:n.method,s=n==null?void 0:n.includeRaw;if(i==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let c=a??"extract",l;km(r)?l=[{type:"function",function:{name:c,description:o,parameters:lM(r)}}]:("name"in r&&(c=r.name),l=[{type:"function",function:{name:c,description:o,parameters:r}}]);const u=this.bindTools(l),d=oRe.from(m=>{if(!m.tool_calls||m.tool_calls.length===0)throw new Error("No tool calls found in the response.");const v=m.tool_calls.find(b=>b.name===c);if(!v)throw new Error(`No tool call found with name ${c}.`);return v.args});if(!s)return u.pipe(d).withConfig({runName:"StructuredOutput"});const f=Bc.assign({parsed:(m,v)=>d.invoke(m.raw,v)}),p=Bc.assign({parsed:()=>null}),y=f.withFallbacks({fallbacks:[p]});return uM.from([{raw:u},y]).withConfig({runName:"StructuredOutputRunnable"})}}class ppe extends Qf{parseResultWithPrompt(t,n,r){return this.parseResult(t,r)}_baseMessageToString(t){return typeof t.content=="string"?t.content:this._baseMessageContentToString(t.content)}_baseMessageContentToString(t){return JSON.stringify(t)}async invoke(t,n){return typeof t=="string"?this._callWithConfig(async(r,a)=>this.parseResult([{text:r}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"}):this._callWithConfig(async(r,a)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"})}}class P$ extends ppe{parseResult(t,n){return this.parse(t[0].text,n)}async parseWithPrompt(t,n,r){return this.parse(t,r)}_type(){throw new Error("_type not implemented")}}class Bj extends Error{constructor(t,n,r,a=!1){if(super(t),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=r,this.sendToLLM=a,a&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}function zj(e,t){const n=typeof e;if(n!==typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;const r=e.length;if(r!==t.length)return!1;for(let a=0;a<r;a++)if(!zj(e[a],t[a]))return!1;return!0}if(n==="object"){if(!e||!t)return e===t;const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(const o of r)if(!zj(e[o],t[o]))return!1;return!0}return e===t}class hpe extends P${async*_transform(t){for await(const n of t)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:this._baseMessageToString(n)}])}async*transform(t,n){yield*this._transformStreamWithConfig(t,this._transform.bind(this),{...n,runType:"parser"})}}class k$ extends hpe{constructor(t){super(t),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(t==null?void 0:t.diff)??this.diff}async*_transform(t){let n,r;for await(const a of t){if(typeof a!="string"&&typeof a.content!="string")throw new Error("Cannot handle non-string output.");let o;if(iRe(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new As({message:a,text:a.content})}else if(sRe(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new As({message:cRe(a),text:a.content})}else o=new lRe({text:a});r===void 0?r=o:r=r.concat(o);const i=await this.parsePartialResult([r]);i!=null&&!zj(i,n)&&(this.diff?yield this._diff(n,i):yield i,n=i)}}getFormatInstructions(){return""}}class Vj extends P${static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(t){super(t),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(t){return new this(t)}static fromNamesAndDescriptions(t){const n=_a.object(Object.fromEntries(Object.entries(t).map(([r,a])=>[r,_a.string().describe(a)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(lM(this.schema))}
\`\`\`
`}async parse(t){try{const n=(t.includes("```")?t.trim().split(/```(?:json)?/)[1]:t.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(r,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(n){throw new Bj(`Failed to parse. Text: "${t}". Error: ${n}`,t)}}}class qj extends k${constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(t,n){if(n)return t?sX(t,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(t){return RK(t[0].text)}async parse(t){return RK(t,JSON.parse)}getFormatInstructions(){return""}}function Uj(e,t){if(e.function===void 0)return;let n;if(t!=null&&t.partial)try{n=uRe(e.function.arguments??"{}")}catch{return}else try{n=JSON.parse(e.function.arguments)}catch(a){throw new Bj([`Function "${e.function.name}" arguments:`,"",e.function.arguments,"","are not valid JSON.",`Error: ${a.message}`].join(`
`))}const r={name:e.function.name,args:n,type:"tool_call"};return t!=null&&t.returnId&&(r.id=e.id),r}function A$(e){if(e.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}}function T$(e,t){var n,r;return{name:(n=e.function)==null?void 0:n.name,args:(r=e.function)==null?void 0:r.arguments,id:e.id,error:t,type:"invalid_tool_call"}}class mpe extends k${static lc_name(){return"JsonOutputToolsParser"}constructor(t){super(t),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(t==null?void 0:t.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(t){return await this.parsePartialResult(t,!1)}async parsePartialResult(t,n=!0){var i;const r=t[0].message;let a;if(rv(r)&&((i=r.tool_calls)!=null&&i.length)?a=r.tool_calls.map(s=>{const{id:c,...l}=s;return this.returnId?{id:c,...l}:l}):r.additional_kwargs.tool_calls!==void 0&&(a=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(s=>Uj(s,{returnId:this.returnId,partial:n}))),!a)return[];const o=[];for(const s of a)if(s!==void 0){const c={type:s.name,args:s.args,id:s.id};o.push(c)}return o}}class Am extends mpe{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=t.keyName,this.returnSingle=t.returnSingle??this.returnSingle,this.zodSchema=t.zodSchema}async _validateResult(t){if(this.zodSchema===void 0)return t;const n=await this.zodSchema.safeParseAsync(t);if(n.success)return n.data;throw new Bj(`Failed to parse. Text: "${JSON.stringify(t,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(t,null,2))}async parsePartialResult(t){const n=(await super.parsePartialResult(t)).filter(a=>a.type===this.keyName);let r=n;if(n.length)return this.returnId||(r=n.map(a=>a.args)),this.returnSingle?r[0]:r}async parseResult(t){const n=(await super.parsePartialResult(t,!1)).filter(a=>a.type===this.keyName);let r=n;return n.length?(this.returnId||(r=n.map(a=>a.args)),this.returnSingle?this._validateResult(r[0]):await Promise.all(r.map(a=>this._validateResult(a)))):void 0}}const ype=Symbol("Let zodToJsonSchema decide on which parser to use"),gpe={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},vpe=e=>({...gpe,...e}),bpe=e=>{const t=vpe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function R$(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function jt(e,t,n,r,a){e[t]=n,R$(e,t,r,a)}function wpe(){return{}}function xpe(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==le.ZodAny&&(n.items=mt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&jt(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&jt(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(jt(n,"minItems",e.exactLength.value,e.exactLength.message,t),jt(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function _pe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?jt(n,"minimum",r.value,r.message,t):jt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),jt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?jt(n,"maximum",r.value,r.message,t):jt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),jt(n,"maximum",r.value,r.message,t));break;case"multipleOf":jt(n,"multipleOf",r.value,r.message,t);break}return n}function jpe(){return{type:"boolean"}}function Spe(e,t){return mt(e.type._def,t)}const Epe=(e,t)=>mt(e.innerType._def,t);function I$(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>I$(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Ope(e,t)}}const Ope=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":jt(n,"minimum",r.value,r.message,t);break;case"max":jt(n,"maximum",r.value,r.message,t);break}return n};function Cpe(e,t){return{...mt(e.innerType._def,t),default:e.defaultValue()}}function Npe(e,t){return t.effectStrategy==="input"?mt(e.schema._def,t):{}}function Mpe(e){return{type:"string",enum:e.values}}const Ppe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function kpe(e,t){const n=[mt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),mt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(Ppe(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Ape(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let Wj;const rs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Wj===void 0&&(Wj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Wj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function D$(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Tpe(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":jt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":jt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":oa(n,"email",a.message,t);break;case"format:idn-email":oa(n,"idn-email",a.message,t);break;case"pattern:zod":ia(n,rs.email,a.message,t);break}break;case"url":oa(n,"uri",a.message,t);break;case"uuid":oa(n,"uuid",a.message,t);break;case"regex":ia(n,a.regex,a.message,t);break;case"cuid":ia(n,rs.cuid,a.message,t);break;case"cuid2":ia(n,rs.cuid2,a.message,t);break;case"startsWith":ia(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":ia(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":oa(n,"date-time",a.message,t);break;case"date":oa(n,"date",a.message,t);break;case"time":oa(n,"time",a.message,t);break;case"duration":oa(n,"duration",a.message,t);break;case"length":jt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),jt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{ia(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&oa(n,"ipv4",a.message,t),a.version!=="v4"&&oa(n,"ipv6",a.message,t);break}case"emoji":ia(n,rs.emoji,a.message,t);break;case"ulid":{ia(n,rs.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{oa(n,"binary",a.message,t);break}case"contentEncoding:base64":{jt(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{ia(n,rs.base64,a.message,t);break}}break}case"nanoid":ia(n,rs.nanoid,a.message,t)}return n}const Tpe=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),oa=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):jt(e,"format",t,n,r)},ia=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:L$(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):jt(e,"pattern",L$(t,r),n,r)},L$=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function $$(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===le.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===le.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(D$(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===le.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Rpe(e,t){if(t.mapStrategy==="record")return $$(e,t);const n=mt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Ipe(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Dpe(){return{not:{}}}function Lpe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Tm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function $pe(e,t){if(t.target==="openApi3")return F$(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Tm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=Tm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return F$(e,t)}const F$=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>mt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Fpe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:Tm[e.innerType._def.typeName],nullable:!0}:{type:[Tm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=mt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=mt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Bpe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",R$(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?jt(n,"minimum",r.value,r.message,t):jt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),jt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?jt(n,"maximum",r.value,r.message,t):jt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),jt(n,"maximum",r.value,r.message,t));break;case"multipleOf":jt(n,"multipleOf",r.value,r.message,t);break}return n}function zpe(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":mt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":mt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Vpe(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=mt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:zpe(e,t)};return n.required.length||delete n.required,n}const qpe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return mt(e.innerType._def,t);const n=mt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Upe=(e,t)=>{if(t.pipeStrategy==="input")return mt(e.in._def,t);if(t.pipeStrategy==="output")return mt(e.out._def,t);const n=mt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=mt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Wpe(e,t){return mt(e.type._def,t)}function Hpe(e,t){const n={type:"array",uniqueItems:!0,items:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&jt(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&jt(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Zpe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>mt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:mt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>mt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Kpe(){return{not:{}}}function Xpe(){return{}}const Gpe=(e,t)=>mt(e.innerType._def,t);function mt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==ype)return s}if(r&&!n){const s=Qpe(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=Ype(e,e.typeName,t);return o&&ehe(e,t,o),a.jsonSchema=o,o}const Qpe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Jpe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Jpe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Ype=(e,t,n)=>{switch(t){case le.ZodString:return D$(e,n);case le.ZodNumber:return Bpe(e,n);case le.ZodObject:return Vpe(e,n);case le.ZodBigInt:return _pe(e,n);case le.ZodBoolean:return jpe();case le.ZodDate:return I$(e,n);case le.ZodUndefined:return Kpe();case le.ZodNull:return Lpe(n);case le.ZodArray:return xpe(e,n);case le.ZodUnion:case le.ZodDiscriminatedUnion:return $pe(e,n);case le.ZodIntersection:return kpe(e,n);case le.ZodTuple:return Zpe(e,n);case le.ZodRecord:return $$(e,n);case le.ZodLiteral:return Ape(e,n);case le.ZodEnum:return Mpe(e);case le.ZodNativeEnum:return Ipe(e);case le.ZodNullable:return Fpe(e,n);case le.ZodOptional:return qpe(e,n);case le.ZodMap:return Rpe(e,n);case le.ZodSet:return Hpe(e,n);case le.ZodLazy:return mt(e.getter()._def,n);case le.ZodPromise:return Wpe(e,n);case le.ZodNaN:case le.ZodNever:return Dpe();case le.ZodEffects:return Npe(e,n);case le.ZodAny:return wpe();case le.ZodUnknown:return Xpe();case le.ZodDefault:return Cpe(e,n);case le.ZodBranded:return Spe(e,n);case le.ZodReadonly:return Gpe(e,n);case le.ZodCatch:return Epe(e,n);case le.ZodPipeline:return Upe(e,n);case le.ZodFunction:case le.ZodVoid:case le.ZodSymbol:return;default:return(r=>{})()}},ehe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),the=(e,t)=>{const n=bpe(t),r=void 0,a=t==null?void 0:t.name,o=mt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},nhe=Symbol("Let zodToJsonSchema decide on which parser to use"),B$={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},rhe=e=>typeof e=="string"?{...B$,basePath:["#"],definitions:{},name:e}:{...B$,basePath:["#"],definitions:{},...e},Hj=e=>"_def"in e?e._def:e;function ahe(e){if(!e)return!0;for(const t in e)return!1;return!0}const ohe=e=>{const t=rhe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[Hj(a),{def:Hj(a),path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function z$(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function St(e,t,n,r,a){e[t]=n,z$(e,t,r,a)}function ihe(){return{}}function she(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==le.ZodAny&&(n.items=dt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&St(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&St(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(St(n,"minItems",e.exactLength.value,e.exactLength.message,t),St(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function che(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?St(n,"minimum",r.value,r.message,t):St(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),St(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?St(n,"maximum",r.value,r.message,t):St(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),St(n,"maximum",r.value,r.message,t));break;case"multipleOf":St(n,"multipleOf",r.value,r.message,t);break}return n}function lhe(){return{type:"boolean"}}function uhe(e,t){return dt(e.type._def,t)}const dhe=(e,t)=>dt(e.innerType._def,t);function V$(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>V$(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return fhe(e,t)}}const fhe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":St(n,"minimum",r.value,r.message,t);break;case"max":St(n,"maximum",r.value,r.message,t);break}return n};function phe(e,t){return{...dt(e.innerType._def,t),default:e.defaultValue()}}function hhe(e,t,n){return t.effectStrategy==="input"?dt(e.schema._def,t,n):{}}function mhe(e){return{type:"string",enum:[...e.values]}}const yhe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function ghe(e,t){const n=[dt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),dt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(yhe(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function vhe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let Zj;const as={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Zj===void 0&&(Zj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Zj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function q$(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?bhe(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":St(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":St(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":sa(n,"email",a.message,t);break;case"format:idn-email":sa(n,"idn-email",a.message,t);break;case"pattern:zod":ca(n,as.email,a.message,t);break}break;case"url":sa(n,"uri",a.message,t);break;case"uuid":sa(n,"uuid",a.message,t);break;case"regex":ca(n,a.regex,a.message,t);break;case"cuid":ca(n,as.cuid,a.message,t);break;case"cuid2":ca(n,as.cuid2,a.message,t);break;case"startsWith":ca(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":ca(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":sa(n,"date-time",a.message,t);break;case"date":sa(n,"date",a.message,t);break;case"time":sa(n,"time",a.message,t);break;case"duration":sa(n,"duration",a.message,t);break;case"length":St(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),St(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{ca(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&sa(n,"ipv4",a.message,t),a.version!=="v4"&&sa(n,"ipv6",a.message,t);break}case"emoji":ca(n,as.emoji,a.message,t);break;case"ulid":{ca(n,as.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{sa(n,"binary",a.message,t);break}case"contentEncoding:base64":{St(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{ca(n,as.base64,a.message,t);break}}break}case"nanoid":ca(n,as.nanoid,a.message,t)}return n}const bhe=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),sa=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):St(e,"format",t,n,r)},ca=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:U$(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):St(e,"pattern",U$(t,r),n,r)},U$=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function W$(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===le.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===le.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(q$(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===le.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function whe(e,t){if(t.mapStrategy==="record")return W$(e,t);const n=dt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function xhe(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function _he(){return{not:{}}}function jhe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Rm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function She(e,t){if(t.target==="openApi3")return H$(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Rm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=Rm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return H$(e,t)}const H$=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>dt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Ehe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"||t.nullableStrategy==="property"?{type:Rm[e.innerType._def.typeName],nullable:!0}:{type:[Rm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=dt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=dt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Ohe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",z$(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?St(n,"minimum",r.value,r.message,t):St(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),St(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?St(n,"maximum",r.value,r.message,t):St(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),St(n,"maximum",r.value,r.message,t));break;case"multipleOf":St(n,"multipleOf",r.value,r.message,t);break}return n}function Che(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":dt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":dt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Nhe(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=dt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()&&!t.openaiStrictMode?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Che(e,t)};return n.required.length||delete n.required,n}const Mhe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return dt(e.innerType._def,t);const n=dt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Phe=(e,t)=>{if(t.pipeStrategy==="input")return dt(e.in._def,t);if(t.pipeStrategy==="output")return dt(e.out._def,t);const n=dt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=dt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function khe(e,t){return dt(e.type._def,t)}function Ahe(e,t){const n={type:"array",uniqueItems:!0,items:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&St(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&St(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function The(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>dt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:dt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>dt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Rhe(){return{not:{}}}function Ihe(){return{}}const Dhe=(e,t)=>dt(e.innerType._def,t);function dt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==nhe)return s}if(r&&!n){const s=Lhe(r,t);if(s!==void 0)return"$ref"in s&&t.seenRefs.add(s.$ref),s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=Fhe(e,e.typeName,t,n);return o&&Bhe(e,t,o),a.jsonSchema=o,o}const Lhe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":const n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&t.nameStrategy==="duplicate-ref"&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:$he(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,a)=>t.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},$he=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Fhe=(e,t,n,r)=>{switch(t){case le.ZodString:return q$(e,n);case le.ZodNumber:return Ohe(e,n);case le.ZodObject:return Nhe(e,n);case le.ZodBigInt:return che(e,n);case le.ZodBoolean:return lhe();case le.ZodDate:return V$(e,n);case le.ZodUndefined:return Rhe();case le.ZodNull:return jhe(n);case le.ZodArray:return she(e,n);case le.ZodUnion:case le.ZodDiscriminatedUnion:return She(e,n);case le.ZodIntersection:return ghe(e,n);case le.ZodTuple:return The(e,n);case le.ZodRecord:return W$(e,n);case le.ZodLiteral:return vhe(e,n);case le.ZodEnum:return mhe(e);case le.ZodNativeEnum:return xhe(e);case le.ZodNullable:return Ehe(e,n);case le.ZodOptional:return Mhe(e,n);case le.ZodMap:return whe(e,n);case le.ZodSet:return Ahe(e,n);case le.ZodLazy:return dt(e.getter()._def,n);case le.ZodPromise:return khe(e,n);case le.ZodNaN:case le.ZodNever:return _he();case le.ZodEffects:return hhe(e,n,r);case le.ZodAny:return ihe();case le.ZodUnknown:return Ihe();case le.ZodDefault:return phe(e,n);case le.ZodBranded:return uhe(e,n);case le.ZodReadonly:return Dhe(e,n);case le.ZodCatch:return dhe(e,n);case le.ZodPipeline:return Phe(e,n);case le.ZodFunction:case le.ZodVoid:case le.ZodSymbol:return;default:return(a=>{})()}},Bhe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),zhe=(e,t)=>{const n=ohe(t),r=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,a=dt(e._def,r===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},o=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;o!==void 0&&(a.title=o);const i=(()=>{if(ahe(n.definitions))return;const c={},l=new Set;for(let u=0;u<500;u++){const d=Object.entries(n.definitions).filter(([f])=>!l.has(f));if(d.length===0)break;for(const[f,p]of d)c[f]=dt(Hj(p),{...n,currentPath:[...n.basePath,n.definitionPath,f]},!0)??{},l.add(f)}return c})(),s=r===void 0?i?{...a,[n.definitionPath]:i}:a:n.nameStrategy==="duplicate-ref"?{...a,...i||n.seenRefs.size?{[n.definitionPath]:{...i,...n.seenRefs.size?{[r]:a}:void 0}}:void 0}:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...i,[r]:a}};return n.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s};function Z$(e,t){return zhe(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function Vhe(e,t,n){return qfe({type:"json_schema",json_schema:{...n,name:t,strict:!0,schema:Z$(e,{name:t})}},r=>e.parse(JSON.parse(r)))}function qhe(e){return Ufe({type:"function",function:{name:e.name,parameters:Z$(e.parameters,{name:e.name}),strict:!0,...e.description?{description:e.description}:void 0}},{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})}function Uhe(e){const{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:a,baseURL:o,azureADTokenProvider:i,azureOpenAIEndpoint:s}=e;if((r||i)&&a&&t)return`${a}/${t}`;if((r||i)&&s&&t)return`${s}/openai/deployments/${t}`;if(r||i){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${t}`}return o}function K$(e,t){const n=typeof t=="number"?void 0:t;return{name:e.name,description:e.description,parameters:lM(e.schema),...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}}function Whe(e,t){let n;return X$(e)?n={type:"function",function:K$(e)}:n=e,n}function Hhe(e){return e!==void 0&&Array.isArray(e.lc_namespace)}function Zhe(e){return e!==void 0&&Qf.isRunnable(e)&&"lc_name"in e.constructor&&typeof e.constructor.lc_name=="function"&&e.constructor.lc_name()==="RunnableToolLike"}function Khe(e){return!!e&&typeof e=="object"&&"name"in e&&"schema"in e&&km(e.schema)}function X$(e){return Khe(e)||Zhe(e)||Hhe(e)}function Im(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/
`,e}function G$(e){let t;return e.constructor.name===fm.name?(t=new Error(e.message),t.name="TimeoutError"):e.constructor.name===Or.name?(t=new Error(e.message),t.name="AbortError"):e.status===400&&e.message.includes("tool_calls")?t=Im(e,"INVALID_TOOL_RESULTS"):e.status===401?t=Im(e,"MODEL_AUTHENTICATION"):e.status===429?t=Im(e,"MODEL_RATE_LIMIT"):e.status===404?t=Im(e,"MODEL_NOT_FOUND"):t=e,t}function Xhe(e){if(e)return e==="any"||e==="required"?"required":e==="auto"?"auto":e==="none"?"none":typeof e=="string"?{type:"function",function:{name:e}}:e}function Ghe(e){return e.anyOf!==void 0&&Array.isArray(e.anyOf)}function Qhe(e){const t=["namespace functions {",""];for(const n of e)n.description&&t.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(t.push(`type ${n.name} = (_: {`),t.push(Q$(n.parameters,0)),t.push("}) => any;")):t.push(`type ${n.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join(`
`)}function Q$(e,t){var r;const n=[];for(const[a,o]of Object.entries(e.properties??{}))o.description&&t<2&&n.push(`// ${o.description}`),(r=e.required)!=null&&r.includes(a)?n.push(`${a}: ${Dm(o,t)},`):n.push(`${a}?: ${Dm(o,t)},`);return n.map(a=>" ".repeat(t)+a).join(`
`)}function Dm(e,t){if(Ghe(e))return e.anyOf.map(n=>Dm(n,t)).join(" | ");switch(e.type){case"string":return e.enum?e.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",Q$(e,t+2),"}"].join(`
`);case"array":return e.items?`${Dm(e.items,t)}[]`:"any[]";default:return""}}function Jhe(e,t){let n;if(X$(e)){const r=qhe({name:e.name,parameters:e.schema,description:e.description});r.function.parameters?n={type:r.type,function:{name:r.function.name,description:r.function.description,parameters:r.function.parameters,...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}}:n={type:"function",function:K$(e,t)}}else n=e;return(t==null?void 0:t.strict)!==void 0&&(n.function.strict=t.strict),n}function Yhe(e){return e.role!=="system"&&e.role!=="developer"&&e.role!=="assistant"&&e.role!=="user"&&e.role!=="function"&&e.role!=="tool"&&console.warn(`Unknown message role: ${e.role}`),e.role}function J$(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!dM.isInstance(e))throw new Error("Invalid generic chat message");return Yhe(e)}default:throw new Error(`Unknown message type: ${t}`)}}function eme(e,t,n){const r=e.tool_calls;switch(e.role){case"assistant":{const a=[],o=[];for(const c of r??[])try{a.push(Uj(c,{returnId:!0}))}catch(l){o.push(T$(c,l.message))}const i={function_call:e.function_call,tool_calls:r};n!==void 0&&(i.__raw_response=t);const s={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(i.audio=e.audio),new eo({content:e.content||"",tool_calls:a,invalid_tool_calls:o,additional_kwargs:i,response_metadata:s,id:t.id})}default:return new dM(e.content||"",e.role??"unknown")}}function tme(e,t,n,r){var c,l;const a=e.role??n,o=e.content??"";let i;e.function_call?i={function_call:e.function_call}:e.tool_calls?i={tool_calls:e.tool_calls}:i={},r&&(i.__raw_response=t),e.audio&&(i.audio={...e.audio,index:t.choices[0].index});const s={usage:{...t.usage}};if(a==="user")return new IK({content:o,response_metadata:s});if(a==="assistant"){const u=[];if(Array.isArray(e.tool_calls))for(const d of e.tool_calls)u.push({name:(c=d.function)==null?void 0:c.name,args:(l=d.function)==null?void 0:l.arguments,id:d.id,index:d.index,type:"tool_call_chunk"});return new Yf({content:o,tool_call_chunks:u,additional_kwargs:i,id:t.id,response_metadata:s})}else return a==="system"?new fM({content:o,response_metadata:s}):a==="developer"?new fM({content:o,response_metadata:s,additional_kwargs:{__openai_role__:"developer"}}):a==="function"?new dRe({content:o,additional_kwargs:i,name:e.name,response_metadata:s}):a==="tool"?new fRe({content:o,additional_kwargs:i,tool_call_id:e.tool_call_id,response_metadata:s}):new DK({content:o,role:a,response_metadata:s})}function Y$(e,t){return e.flatMap(n=>{var o;let r=J$(n);r==="system"&&(t!=null&&t.startsWith("o1"))&&(r="developer");const a={role:r,content:n.content};if(n.name!=null&&(a.name=n.name),n.additional_kwargs.function_call!=null&&(a.function_call=n.additional_kwargs.function_call,a.content=null),rv(n)&&((o=n.tool_calls)!=null&&o.length)?(a.tool_calls=n.tool_calls.map(A$),a.content=null):(n.additional_kwargs.tool_calls!=null&&(a.tool_calls=n.additional_kwargs.tool_calls),n.tool_call_id!=null&&(a.tool_call_id=n.tool_call_id)),n.additional_kwargs.audio&&typeof n.additional_kwargs.audio=="object"&&"id"in n.additional_kwargs.audio){const i={role:"assistant",audio:{id:n.additional_kwargs.audio.id}};return[a,i]}return a})}function e8(e,t){return lpe(e)?(t==null?void 0:t.strict)!==void 0?{...e,function:{...e.function,strict:t.strict}}:e:Jhe(e,t)}class nme extends Mo{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(t,n){var r,a,o,i,s,c,l,u,d;if(super(t??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(t==null?void 0:t.apiKey)??(t==null?void 0:t.openAIApiKey)??((r=t==null?void 0:t.configuration)==null?void 0:r.apiKey)??Go("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(t==null?void 0:t.azureOpenAIApiKey)??Go("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(t==null?void 0:t.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(t==null?void 0:t.azureOpenAIApiInstanceName)??Go("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(t==null?void 0:t.azureOpenAIApiDeploymentName)??Go("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(t==null?void 0:t.azureOpenAIApiVersion)??Go("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(t==null?void 0:t.azureOpenAIBasePath)??Go("AZURE_OPENAI_BASE_PATH"),this.organization=((a=t==null?void 0:t.configuration)==null?void 0:a.organization)??Go("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=(t==null?void 0:t.azureOpenAIEndpoint)??Go("AZURE_OPENAI_ENDPOINT"),this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(t==null?void 0:t.modelKwargs)??{},this.timeout=t==null?void 0:t.timeout,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.topP=(t==null?void 0:t.topP)??this.topP,this.frequencyPenalty=(t==null?void 0:t.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(t==null?void 0:t.presencePenalty)??this.presencePenalty,this.maxTokens=t==null?void 0:t.maxTokens,this.logprobs=t==null?void 0:t.logprobs,this.topLogprobs=t==null?void 0:t.topLogprobs,this.n=(t==null?void 0:t.n)??this.n,this.logitBias=t==null?void 0:t.logitBias,this.stop=(t==null?void 0:t.stopSequences)??(t==null?void 0:t.stop),this.stopSequences=this==null?void 0:this.stop,this.user=t==null?void 0:t.user,this.__includeRawResponse=t==null?void 0:t.__includeRawResponse,this.audio=t==null?void 0:t.audio,this.modalities=t==null?void 0:t.modalities,this.reasoningEffort=t==null?void 0:t.reasoningEffort,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const f=this.azureOpenAIBasePath.split("/openai/deployments/");if(f.length===2){const[,p]=f;this.azureOpenAIApiDeploymentName=p}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.model==="o1"&&(this.disableStreaming=!0),this.streaming=(t==null?void 0:t.streaming)??!1,this.streamUsage=(t==null?void 0:t.streamUsage)??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(n==null?void 0:n.basePath)??((o=t==null?void 0:t.configuration)==null?void 0:o.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((i=n==null?void 0:n.baseOptions)==null?void 0:i.headers)??((c=(s=t==null?void 0:t.configuration)==null?void 0:s.baseOptions)==null?void 0:c.headers),defaultQuery:((l=n==null?void 0:n.baseOptions)==null?void 0:l.params)??((d=(u=t==null?void 0:t.configuration)==null?void 0:u.baseOptions)==null?void 0:d.params),...n,...t==null?void 0:t.configuration},(t==null?void 0:t.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=t.supportsStrictToolCalling)}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.max_tokens??void 0,ls_stop:t.stop}}bindTools(t,n){let r;return(n==null?void 0:n.strict)!==void 0?r=n.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:t.map(a=>e8(a,{strict:r})),...n})}createResponseFormat(t){return t&&t.type==="json_schema"&&t.json_schema.schema&&Lm(t.json_schema.schema)?Vhe(t.json_schema.schema,t.json_schema.name,{description:t.json_schema.description}):t}invocationParams(t,n){var s;let r;(t==null?void 0:t.strict)!==void 0?r=t.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling);let a={};(t==null?void 0:t.stream_options)!==void 0?a={stream_options:t.stream_options}:this.streamUsage&&(this.streaming||n!=null&&n.streaming)&&(a={stream_options:{include_usage:!0}});const o={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(t==null?void 0:t.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:t==null?void 0:t.functions,function_call:t==null?void 0:t.function_call,tools:(s=t==null?void 0:t.tools)!=null&&s.length?t.tools.map(c=>e8(c,{strict:r})):void 0,tool_choice:Xhe(t==null?void 0:t.tool_choice),response_format:this.createResponseFormat(t==null?void 0:t.response_format),seed:t==null?void 0:t.seed,...a,parallel_tool_calls:t==null?void 0:t.parallel_tool_calls,...this.audio||t!=null&&t.audio?{audio:this.audio||(t==null?void 0:t.audio)}:{},...this.modalities||t!=null&&t.modalities?{modalities:this.modalities||(t==null?void 0:t.modalities)}:{},...this.modelKwargs};(t==null?void 0:t.prediction)!==void 0&&(o.prediction=t.prediction);const i=(t==null?void 0:t.reasoning_effort)??this.reasoningEffort;return i!==void 0&&(o.reasoning_effort=i),o}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(t,n,r){var l,u,d,f,p,y,m,v,b,w;const a=Y$(t,this.model),o={...this.invocationParams(n,{streaming:!0}),messages:a,stream:!0};let i;const s=await this.completionWithRetry(o,n);let c;for await(const _ of s){const x=(l=_==null?void 0:_.choices)==null?void 0:l[0];if(_.usage&&(c=_.usage),!x)continue;const{delta:j}=x;if(!j)continue;const S=tme(j,_,i,this.__includeRawResponse);i=j.role??i;const E={prompt:n.promptIndex??0,completion:x.index??0};if(typeof S.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const O={...E};x.finish_reason!=null&&(O.finish_reason=x.finish_reason,O.system_fingerprint=_.system_fingerprint,O.model_name=_.model),this.logprobs&&(O.logprobs=x.logprobs);const M=new As({message:S,text:S.content,generationInfo:O});yield M,await(r==null?void 0:r.handleLLMNewToken(M.text??"",E,void 0,void 0,void 0,{chunk:M}))}if(c){const _={...((u=c.prompt_tokens_details)==null?void 0:u.audio_tokens)!==null&&{audio:(d=c.prompt_tokens_details)==null?void 0:d.audio_tokens},...((f=c.prompt_tokens_details)==null?void 0:f.cached_tokens)!==null&&{cache_read:(p=c.prompt_tokens_details)==null?void 0:p.cached_tokens}},x={...((y=c.completion_tokens_details)==null?void 0:y.audio_tokens)!==null&&{audio:(m=c.completion_tokens_details)==null?void 0:m.audio_tokens},...((v=c.completion_tokens_details)==null?void 0:v.reasoning_tokens)!==null&&{reasoning:(b=c.completion_tokens_details)==null?void 0:b.reasoning_tokens}};yield new As({message:new Yf({content:"",response_metadata:{usage:{...c}},usage_metadata:{input_tokens:c.prompt_tokens,output_tokens:c.completion_tokens,total_tokens:c.total_tokens,...Object.keys(_).length>0&&{input_token_details:_},...Object.keys(x).length>0&&{output_token_details:x}}}),text:""})}if((w=n.signal)!=null&&w.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(t,n,r){var s,c;const a={},o=this.invocationParams(n),i=Y$(t,this.model);if(o.stream){const l=this._streamResponseChunks(t,n,r),u={};for await(const v of l){v.message.response_metadata={...v.generationInfo,...v.message.response_metadata};const b=((s=v.generationInfo)==null?void 0:s.completion)??0;u[b]===void 0?u[b]=v:u[b]=u[b].concat(v)}const d=Object.entries(u).sort(([v],[b])=>parseInt(v,10)-parseInt(b,10)).map(([v,b])=>b),{functions:f,function_call:p}=this.invocationParams(n),y=await this.getEstimatedTokenCountFromPrompt(t,f,p),m=await this.getNumTokensFromGenerations(d);return a.input_tokens=y,a.output_tokens=m,a.total_tokens=y+m,{generations:d,llmOutput:{estimatedTokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}else{let l;n.response_format&&n.response_format.type==="json_schema"?l=await this.betaParsedCompletionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options}):l=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options});const{completion_tokens:u,prompt_tokens:d,total_tokens:f,prompt_tokens_details:p,completion_tokens_details:y}=(l==null?void 0:l.usage)??{};u&&(a.output_tokens=(a.output_tokens??0)+u),d&&(a.input_tokens=(a.input_tokens??0)+d),f&&(a.total_tokens=(a.total_tokens??0)+f),((p==null?void 0:p.audio_tokens)!==null||(p==null?void 0:p.cached_tokens)!==null)&&(a.input_token_details={...(p==null?void 0:p.audio_tokens)!==null&&{audio:p==null?void 0:p.audio_tokens},...(p==null?void 0:p.cached_tokens)!==null&&{cache_read:p==null?void 0:p.cached_tokens}}),((y==null?void 0:y.audio_tokens)!==null||(y==null?void 0:y.reasoning_tokens)!==null)&&(a.output_token_details={...(y==null?void 0:y.audio_tokens)!==null&&{audio:y==null?void 0:y.audio_tokens},...(y==null?void 0:y.reasoning_tokens)!==null&&{reasoning:y==null?void 0:y.reasoning_tokens}});const m=[];for(const v of(l==null?void 0:l.choices)??[]){const b={text:((c=v.message)==null?void 0:c.content)??"",message:eme(v.message??{role:"assistant"},l,this.__includeRawResponse)};b.generationInfo={...v.finish_reason?{finish_reason:v.finish_reason}:{},...v.logprobs?{logprobs:v.logprobs}:{}},rv(b.message)&&(b.message.usage_metadata=a),b.message=new eo(Object.fromEntries(Object.entries(b.message).filter(([w])=>!w.startsWith("lc_")))),m.push(b)}return{generations:m,llmOutput:{tokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(t,n,r){let a=(await this.getNumTokensFromMessages(t)).totalCount;if(n&&r!=="auto"){const o=Qhe(n);a+=await this.getNumTokens(o),a+=9}return n&&t.find(o=>o._getType()==="system")&&(a-=4),r==="none"?a+=1:typeof r=="object"&&(a+=await this.getNumTokens(r.name)+4),a}async getNumTokensFromGenerations(t){return(await Promise.all(t.map(async n=>{var r;return(r=n.message.additional_kwargs)!=null&&r.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)}))).reduce((n,r)=>n+r,0)}async getNumTokensFromMessages(t){let n=0,r=0,a=0;this.model==="gpt-3.5-turbo-0301"?(r=4,a=-1):(r=3,a=1);const o=await Promise.all(t.map(async i=>{var f,p,y,m,v,b;const s=await this.getNumTokens(i.content),c=await this.getNumTokens(J$(i)),l=i.name!==void 0?a+await this.getNumTokens(i.name):0;let u=s+r+c+l;const d=i;if(d._getType()==="function"&&(u-=2),(f=d.additional_kwargs)!=null&&f.function_call&&(u+=3),(p=d==null?void 0:d.additional_kwargs.function_call)!=null&&p.name&&(u+=await this.getNumTokens((y=d.additional_kwargs.function_call)==null?void 0:y.name)),(m=d.additional_kwargs.function_call)==null?void 0:m.arguments)try{u+=await this.getNumTokens(JSON.stringify(JSON.parse((v=d.additional_kwargs.function_call)==null?void 0:v.arguments)))}catch(w){console.error("Error parsing function arguments",w,JSON.stringify(d.additional_kwargs.function_call)),u+=await this.getNumTokens((b=d.additional_kwargs.function_call)==null?void 0:b.arguments)}return n+=u,u}));return n+=3,{totalCount:n,countPerMessage:o}}async completionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(t,r)}catch(a){throw G$(a)}})}async betaParsedCompletionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(t,r)}catch(a){throw G$(a)}})}_getClientOptions(t){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},a=Uhe(r),o={...this.clientConfig,baseURL:a,timeout:this.timeout,maxRetries:0};o.baseURL||delete o.baseURL,this.client=new it(o)}const n={...this.clientConfig,...t};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),n}_llmType(){return"openai"}_combineLLMOutput(...t){return t.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(t,n){let r,a,o,i;rme(t)?(r=t.schema,a=t.name,o=t.method,i=t.includeRaw):(r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw);let s,c;if((n==null?void 0:n.strict)!==void 0&&o==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(o==="jsonMode")s=this.bind({response_format:{type:"json_object"}}),Lm(r)?c=Vj.fromZodSchema(r):c=new qj;else if(o==="jsonSchema")s=this.bind({response_format:{type:"json_schema",json_schema:{name:a??"extract",description:r.description,schema:r,strict:n==null?void 0:n.strict}}}),Lm(r)?c=Vj.fromZodSchema(r):c=new qj;else{let f=a??"extract";if(Lm(r)){const p=the(r);s=this.bind({tools:[{type:"function",function:{name:f,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:f}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new Am({returnSingle:!0,keyName:f,zodSchema:r})}else{let p;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(p=r,f=r.name):(f=r.title??f,p={name:f,description:r.description??"",parameters:r}),s=this.bind({tools:[{type:"function",function:p}],tool_choice:{type:"function",function:{name:f}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new Am({returnSingle:!0,keyName:f})}}if(!i)return s.pipe(c);const l=Bc.assign({parsed:(f,p)=>c.invoke(f.raw,p)}),u=Bc.assign({parsed:()=>null}),d=l.withFallbacks({fallbacks:[u]});return uM.from([{raw:s},d])}}function Lm(e){return typeof(e==null?void 0:e.parse)=="function"}function rme(e){return e!==void 0&&typeof e.schema=="object"}const ame=Symbol("Let zodToJsonSchema decide on which parser to use"),ome={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},ime=e=>({...ome,...e}),sme=e=>{const t=ime(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function t8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Et(e,t,n,r,a){e[t]=n,t8(e,t,r,a)}function cme(){return{}}function lme(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==le.ZodAny&&(n.items=yt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Et(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Et(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Et(n,"minItems",e.exactLength.value,e.exactLength.message,t),Et(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function ume(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Et(n,"minimum",r.value,r.message,t):Et(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Et(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Et(n,"maximum",r.value,r.message,t):Et(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Et(n,"maximum",r.value,r.message,t));break;case"multipleOf":Et(n,"multipleOf",r.value,r.message,t);break}return n}function dme(){return{type:"boolean"}}function fme(e,t){return yt(e.type._def,t)}const pme=(e,t)=>yt(e.innerType._def,t);function n8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>n8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return hme(e,t)}}const hme=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Et(n,"minimum",r.value,r.message,t);break;case"max":Et(n,"maximum",r.value,r.message,t);break}return n};function mme(e,t){return{...yt(e.innerType._def,t),default:e.defaultValue()}}function yme(e,t){return t.effectStrategy==="input"?yt(e.schema._def,t):{}}function gme(e){return{type:"string",enum:e.values}}const vme=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function bme(e,t){const n=[yt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),yt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(vme(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function wme(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let Kj;const os={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Kj===void 0&&(Kj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Kj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function r8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?xme(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":Et(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":Et(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":la(n,"email",a.message,t);break;case"format:idn-email":la(n,"idn-email",a.message,t);break;case"pattern:zod":ua(n,os.email,a.message,t);break}break;case"url":la(n,"uri",a.message,t);break;case"uuid":la(n,"uuid",a.message,t);break;case"regex":ua(n,a.regex,a.message,t);break;case"cuid":ua(n,os.cuid,a.message,t);break;case"cuid2":ua(n,os.cuid2,a.message,t);break;case"startsWith":ua(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":ua(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":la(n,"date-time",a.message,t);break;case"date":la(n,"date",a.message,t);break;case"time":la(n,"time",a.message,t);break;case"duration":la(n,"duration",a.message,t);break;case"length":Et(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),Et(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{ua(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&la(n,"ipv4",a.message,t),a.version!=="v4"&&la(n,"ipv6",a.message,t);break}case"emoji":ua(n,os.emoji,a.message,t);break;case"ulid":{ua(n,os.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{la(n,"binary",a.message,t);break}case"contentEncoding:base64":{Et(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{ua(n,os.base64,a.message,t);break}}break}case"nanoid":ua(n,os.nanoid,a.message,t)}return n}const xme=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),la=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Et(e,"format",t,n,r)},ua=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:a8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Et(e,"pattern",a8(t,r),n,r)},a8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function o8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===le.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===le.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(r8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===le.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function _me(e,t){if(t.mapStrategy==="record")return o8(e,t);const n=yt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function jme(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Sme(){return{not:{}}}function Eme(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const $m={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Ome(e,t){if(t.target==="openApi3")return i8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in $m&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=$m[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return i8(e,t)}const i8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>yt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Cme(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:$m[e.innerType._def.typeName],nullable:!0}:{type:[$m[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=yt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=yt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Nme(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",t8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Et(n,"minimum",r.value,r.message,t):Et(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Et(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Et(n,"maximum",r.value,r.message,t):Et(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Et(n,"maximum",r.value,r.message,t));break;case"multipleOf":Et(n,"multipleOf",r.value,r.message,t);break}return n}function Mme(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":yt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":yt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Pme(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=yt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Mme(e,t)};return n.required.length||delete n.required,n}const kme=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return yt(e.innerType._def,t);const n=yt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Ame=(e,t)=>{if(t.pipeStrategy==="input")return yt(e.in._def,t);if(t.pipeStrategy==="output")return yt(e.out._def,t);const n=yt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=yt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Tme(e,t){return yt(e.type._def,t)}function Rme(e,t){const n={type:"array",uniqueItems:!0,items:yt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Et(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Et(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Ime(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>yt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:yt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>yt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Dme(){return{not:{}}}function Lme(){return{}}const $me=(e,t)=>yt(e.innerType._def,t);function yt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==ame)return s}if(r&&!n){const s=Fme(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=zme(e,e.typeName,t);return o&&Vme(e,t,o),a.jsonSchema=o,o}const Fme=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Bme(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Bme=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},zme=(e,t,n)=>{switch(t){case le.ZodString:return r8(e,n);case le.ZodNumber:return Nme(e,n);case le.ZodObject:return Pme(e,n);case le.ZodBigInt:return ume(e,n);case le.ZodBoolean:return dme();case le.ZodDate:return n8(e,n);case le.ZodUndefined:return Dme();case le.ZodNull:return Eme(n);case le.ZodArray:return lme(e,n);case le.ZodUnion:case le.ZodDiscriminatedUnion:return Ome(e,n);case le.ZodIntersection:return bme(e,n);case le.ZodTuple:return Ime(e,n);case le.ZodRecord:return o8(e,n);case le.ZodLiteral:return wme(e,n);case le.ZodEnum:return gme(e);case le.ZodNativeEnum:return jme(e);case le.ZodNullable:return Cme(e,n);case le.ZodOptional:return kme(e,n);case le.ZodMap:return _me(e,n);case le.ZodSet:return Rme(e,n);case le.ZodLazy:return yt(e.getter()._def,n);case le.ZodPromise:return Tme(e,n);case le.ZodNaN:case le.ZodNever:return Sme();case le.ZodEffects:return yme(e,n);case le.ZodAny:return cme();case le.ZodUnknown:return Lme();case le.ZodDefault:return mme(e,n);case le.ZodBranded:return fme(e,n);case le.ZodReadonly:return $me(e,n);case le.ZodCatch:return pme(e,n);case le.ZodPipeline:return Ame(e,n);case le.ZodFunction:case le.ZodVoid:case le.ZodSymbol:return;default:return(r=>{})()}},Vme=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),qme=(e,t)=>{const n=sme(t),r=void 0,a=t==null?void 0:t.name,o=yt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},zc="0.5.0";let s8=!1,$d,c8,l8,Xj,u8,d8,f8,p8,h8;function Ume(e,t={auto:!1}){if(s8)throw new Error(`you must \`import 'groq-sdk/shims/${e.kind}'\` before importing anything else from groq-sdk`);if($d)throw new Error(`can't \`import 'groq-sdk/shims/${e.kind}'\` after \`import 'groq-sdk/shims/${$d}'\``);s8=t.auto,$d=e.kind,c8=e.fetch,l8=e.FormData,Xj=e.File,u8=e.ReadableStream,d8=e.getMultipartRequestOptions,f8=e.getDefaultAgent,p8=e.fileFromPath,h8=e.isFsReadStream}class Wme{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function Hme({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'groq-sdk'`:\n- `import 'groq-sdk/shims/node'` (if you're running on Node)\n- `import 'groq-sdk/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new Wme(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/groq/groq-typescript#file-uploads")},isFsReadStream:i=>!1}}$d||Ume(Hme(),{auto:!0});class da extends Error{}class An extends da{constructor(t,n,r,a){super(`${An.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.error=n}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t)return new Fm({cause:tS(n)});const o=n;return t===400?new y8(t,o,r,a):t===401?new g8(t,o,r,a):t===403?new v8(t,o,r,a):t===404?new b8(t,o,r,a):t===409?new w8(t,o,r,a):t===422?new x8(t,o,r,a):t===429?new _8(t,o,r,a):t>=500?new j8(t,o,r,a):new An(t,o,r,a)}}class Gj extends An{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class Fm extends An{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class m8 extends Fm{constructor({message:t}={}){super({message:t??"Request timed out."})}}class y8 extends An{constructor(){super(...arguments),this.status=400}}class g8 extends An{constructor(){super(...arguments),this.status=401}}class v8 extends An{constructor(){super(...arguments),this.status=403}}class b8 extends An{constructor(){super(...arguments),this.status=404}}class w8 extends An{constructor(){super(...arguments),this.status=409}}class x8 extends An{constructor(){super(...arguments),this.status=422}}class _8 extends An{constructor(){super(...arguments),this.status=429}}class j8 extends An{}class Vc{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;const a=new Zme;async function*o(){if(!t.body)throw n.abort(),new da("Attempted to iterate over a response with no body");const s=new is,c=S8(t.body);for await(const l of c)for(const u of s.decode(l)){const d=a.decode(u);d&&(yield d)}for(const l of s.flush()){const u=a.decode(l);u&&(yield u)}}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(const c of o())if(!s){if(c.data.startsWith("[DONE]")){s=!0;continue}if(c.event===null){let l;try{l=JSON.parse(c.data)}catch(u){throw console.error("Could not parse message into JSON:",c.data),console.error("From chunk:",c.raw),u}if(l&&l.error)throw new An(void 0,l.error,void 0,void 0);yield l}}s=!0}catch(c){if(c instanceof Error&&c.name==="AbortError")return;throw c}finally{s||n.abort()}}return new Vc(i,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new is,s=S8(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new Vc(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new Vc(()=>a(t),this.controller),new Vc(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new u8({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}}class Zme{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,r,a]=Kme(t,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}class is{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=is.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(is.NEWLINE_REGEXP);return a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof vn<"u"){if(t instanceof vn)return t.toString();if(t instanceof Uint8Array)return vn.from(t).toString();throw new da(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new da(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new da("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}is.NEWLINE_CHARS=new Set([`
`,"\r","\v","\f","","","","\x85","\u2028","\u2029"]),is.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function Kme(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function S8(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const E8=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",O8=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Qj(e),Qj=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",Xme=e=>O8(e)||E8(e)||h8(e);async function C8(e,t,n){var a;if(e=await e,n??(n=O8(e)?{lastModified:e.lastModified,type:e.type}:{}),E8(e)){const o=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new Xj([o],t,n)}const r=await Gme(e);if(t||(t=Jme(e)??"unknown_file"),!n.type){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new Xj(r,t,n)}async function Gme(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Qj(e))t.push(await e.arrayBuffer());else if(Yme(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${Qme(e)}`);return t}function Qme(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function Jme(e){var t;return Jj(e.name)||Jj(e.filename)||((t=Jj(e.path))==null?void 0:t.split(/[\\/]/).pop())}const Jj=e=>{if(typeof e=="string")return e;if(typeof vn<"u"&&e instanceof vn)return String(e)},Yme=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",N8=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",M8=async e=>{const t=await eye(e.body);return d8(t,e)},eye=async e=>{const t=new l8;return await Promise.all(Object.entries(e||{}).map(([n,r])=>Yj(t,n,r))),t},Yj=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(Xme(n)){const r=await C8(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>Yj(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>Yj(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var qc={};async function P8(e){const{response:t}=e;if(e.options.stream)return Uc("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Vc.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return Uc("response",t.status,t.url,t.headers,a),a}const r=await t.text();return Uc("response",t.status,t.url,t.headers,r),r}class Bm extends Promise{constructor(t,n=P8){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new Bm(this.responsePromise,async n=>t(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class tye{constructor({baseURL:t,maxRetries:n=2,timeout:r=6e4,httpAgent:a,fetch:o}){this.baseURL=t,this.maxRetries=eS("maxRetries",n),this.timeout=eS("timeout",r),this.httpAgent=a,this.fetch=o??c8}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...iye(),...this.authHeaders(t)}}validateHeaders(t,n){}defaultIdempotencyKey(){return`stainless-node-retry-${pye()}`}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,r){return this.request(Promise.resolve(r).then(async a=>{const o=a&&Qj(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:t,path:n,...a,body:o}}))}getAPIList(t,n,r){return this.requestAPIList(n,{method:"get",path:t,...r})}calculateContentLength(t){if(typeof t=="string"){if(typeof vn<"u")return vn.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t){var p;const{method:n,path:r,query:a,headers:o={}}=t,i=ArrayBuffer.isView(t.body)||t.__binaryRequest&&typeof t.body=="string"?t.body:N8(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,s=this.calculateContentLength(i),c=this.buildURL(r,a);"timeout"in t&&eS("timeout",t.timeout);const l=t.timeout??this.timeout,u=t.httpAgent??this.httpAgent??f8(c),d=l+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const f=this.buildHeaders({options:t,headers:o,contentLength:s});return{req:{method:n,...i&&{body:i},headers:f,...u&&{agent:u},signal:t.signal??null},url:c,timeout:l}}buildHeaders({options:t,headers:n,contentLength:r}){const a={};r&&(a["content-length"]=r);const o=this.defaultHeaders(t);return I8(a,o),I8(a,n),N8(t.body)&&$d!=="node"&&delete a["content-type"],this.validateHeaders(a,n),a}async prepareOptions(t){}async prepareRequest(t,{url:n,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(n=>[...n])):{...t}:{}}makeStatusError(t,n,r,a){return An.generate(t,n,r,a)}request(t,n=null){return new Bm(this.makeRequest(t,n))}async makeRequest(t,n){var u,d;const r=await t;n==null&&(n=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:a,url:o,timeout:i}=this.buildRequest(r);if(await this.prepareRequest(a,{url:o,options:r}),Uc("request",o,r,a.headers),(u=r.signal)==null?void 0:u.aborted)throw new Gj;const s=new AbortController,c=await this.fetchWithTimeout(o,a,i,s).catch(tS);if(c instanceof Error){if((d=r.signal)!=null&&d.aborted)throw new Gj;if(n)return this.retryRequest(r,n);throw c.name==="AbortError"?new m8:new Fm({cause:c})}const l=rye(c.headers);if(!c.ok){if(n&&this.shouldRetry(c)){const m=`retrying, ${n} attempts remaining`;return Uc(`response (error; ${m})`,c.status,o,l),this.retryRequest(r,n,l)}const f=await c.text().catch(m=>tS(m).message),p=sye(f),y=p?void 0:f;throw Uc(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,l,y),this.makeStatusError(c.status,p,y,l)}return{response:c,options:r,controller:s}}requestAPIList(t,n){const r=this.makeRequest(n,null);return new nye(this,r,t)}buildURL(t,n){const r=lye(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return dye(a)||(n={...a,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(t){return Object.entries(t).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new da(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,n,r,a){const{signal:o,...i}=n||{};o&&o.addEventListener("abort",()=>a.abort());const s=setTimeout(()=>a.abort(),r);return this.getRequestClient().fetch.call(void 0,t,{signal:a.signal,...i}).finally(()=>{clearTimeout(s)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,r){let a;const o=r==null?void 0:r["retry-after-ms"];if(o){const s=parseFloat(o);Number.isNaN(s)||(a=s)}const i=r==null?void 0:r["retry-after"];if(i&&!a){const s=parseFloat(i);Number.isNaN(s)?a=Date.parse(i)-Date.now():a=s*1e3}if(!(a&&0<=a&&a<60*1e3)){const s=t.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,s)}return await uye(a),this.makeRequest(t,n-1)}calculateDefaultRetryTimeoutMillis(t,n){const r=n-t,a=Math.min(.5*Math.pow(2,r),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${zc}`}}class nye extends Bm{constructor(t,n,r){super(n,async a=>new r(t,a.response,await P8(a),a.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}const rye=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),aye=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zc,"X-Stainless-OS":A8(Deno.build.os),"X-Stainless-Arch":k8(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":bn.version};if(Object.prototype.toString.call(typeof bn<"u"?bn:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zc,"X-Stainless-OS":A8(bn.platform),"X-Stainless-Arch":k8(bn.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":bn.version};const e=oye();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function oye(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const k8=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",A8=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let T8;const iye=()=>T8??(T8=aye()),sye=e=>{try{return JSON.parse(e)}catch{return}},cye=new RegExp("^(?:[a-z]+:)?//","i"),lye=e=>cye.test(e),uye=e=>new Promise(t=>setTimeout(t,e)),eS=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new da(`${e} must be an integer`);if(t<0)throw new da(`${e} must be a positive integer`);return t},tS=e=>e instanceof Error?e:new Error(e),R8=e=>{var t,n,r,a;if(typeof bn<"u")return((t=qc==null?void 0:qc[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function dye(e){if(!e)return!0;for(const t in e)return!1;return!0}function fye(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function I8(e,t){for(const n in t){if(!fye(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function Uc(e,...t){typeof bn<"u"&&(qc==null?void 0:qc.DEBUG)==="true"&&console.log(`Groq:DEBUG:${e}`,...t)}const pye=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),hye=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class hi{constructor(t){this._client=t}}class zm extends hi{create(t,n){return this._client.post("/openai/v1/audio/transcriptions",M8({body:t,...n}))}}zm||(zm={});class Vm extends hi{create(t,n){return this._client.post("/openai/v1/audio/translations",M8({body:t,...n}))}}Vm||(Vm={});class qm extends hi{constructor(){super(...arguments),this.transcriptions=new zm(this._client),this.translations=new Vm(this._client)}}(function(e){e.Transcriptions=zm,e.Translations=Vm})(qm||(qm={}));let Um=class extends hi{create(e,t){return this._client.post("/openai/v1/chat/completions",{body:e,...t,stream:e.stream??!1})}};Um||(Um={});class Wm extends hi{constructor(){super(...arguments),this.completions=new Um(this._client)}}(function(e){e.Completions=Um})(Wm||(Wm={}));class Hm extends hi{}Hm||(Hm={});class Zm extends hi{create(t,n){return this._client.post("/openai/v1/embeddings",{body:t,...n})}}Zm||(Zm={});class Km extends hi{retrieve(t,n){return this._client.get(`/openai/v1/models/${t}`,n)}list(t){return this._client.get("/openai/v1/models",t)}delete(t,n){return this._client.delete(`/openai/v1/models/${t}`,n)}}Km||(Km={});var D8;class nn extends tye{constructor({baseURL:t=R8("GROQ_BASE_URL"),apiKey:n=R8("GROQ_API_KEY"),...r}={}){if(n===void 0)throw new da("The GROQ_API_KEY environment variable is missing or empty; either provide it, or instantiate the Groq client with an apiKey option, like new Groq({ apiKey: 'My API Key' }).");const a={apiKey:n,...r,baseURL:t||"https://api.groq.com"};if(!a.dangerouslyAllowBrowser&&hye())throw new da(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Groq({ apiKey, dangerouslyAllowBrowser: true })`);super({baseURL:a.baseURL,timeout:a.timeout??6e4,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new Hm(this),this.chat=new Wm(this),this.embeddings=new Zm(this),this.audio=new qm(this),this.models=new Km(this),this._options=a,this.apiKey=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}}D8=nn,nn.Groq=D8,nn.GroqError=da,nn.APIError=An,nn.APIConnectionError=Fm,nn.APIConnectionTimeoutError=m8,nn.APIUserAbortError=Gj,nn.NotFoundError=b8,nn.ConflictError=w8,nn.RateLimitError=_8,nn.BadRequestError=y8,nn.AuthenticationError=g8,nn.InternalServerError=j8,nn.PermissionDeniedError=v8,nn.UnprocessableEntityError=x8,nn.toFile=C8,nn.fileFromPath=p8,function(e){e.Completions=Hm,e.Chat=Wm,e.Embeddings=Zm,e.Audio=qm,e.Models=Km}(nn||(nn={}));function mye(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";default:throw new Error(`Unknown message type: ${t}`)}}function L8(e){return e.map(t=>{var r;if(typeof t.content!="string")throw new Error("Non string message content not supported");const n={role:mye(t),content:t.content,name:t.name,function_call:t.additional_kwargs.function_call,tool_calls:t.additional_kwargs.tool_calls,tool_call_id:t.tool_call_id};return rv(t)&&((r=t.tool_calls)!=null&&r.length)?n.tool_calls=t.tool_calls.map(A$):(t.additional_kwargs.tool_calls!=null&&(n.tool_calls=t.additional_kwargs.tool_calls),t.tool_call_id!=null&&(n.tool_call_id=t.tool_call_id)),n})}function yye(e,t){const n=e.tool_calls;switch(e.role){case"assistant":{const r=[],a=[];for(const o of n??[])try{r.push(Uj(o,{returnId:!0}))}catch(i){a.push(T$(o,i.message))}return new eo({content:e.content||"",additional_kwargs:{tool_calls:n},tool_calls:r,invalid_tool_calls:a,usage_metadata:t})}default:return new dM(e.content||"",e.role??"unknown")}}function gye(e,t){if(e!=null&&e.length)return e.map(n=>{var r,a;return{id:n.id,name:(r=n.function)==null?void 0:r.name,args:(a=n.function)==null?void 0:a.arguments,type:"tool_call_chunk",index:t}})}function vye(e,t,n){const{role:r}=e,a=e.content??"";let o;e.function_call?o={function_call:e.function_call}:e.tool_calls?o={tool_calls:e.tool_calls}:o={};let i,s;if(n!=null&&n.usage&&(i={input_tokens:n.usage.prompt_tokens,output_tokens:n.usage.completion_tokens,total_tokens:n.usage.total_tokens},s=n.id),r==="user")return{message:new IK({content:a})};if(r==="assistant"){const c=gye(e.tool_calls,t);return{message:new Yf({content:a,additional_kwargs:o,tool_call_chunks:c?c.map(l=>({type:l.type,args:l.args,index:l.index})):void 0,usage_metadata:i,id:s}),toolCallData:c?c.map(l=>({id:l.id??"",name:l.name??"",index:l.index??t,type:"tool_call_chunk"})):void 0}}else return r==="system"?{message:new fM({content:a})}:{message:new DK({content:a,role:r})}}class bye extends Mo{static lc_name(){return"ChatGroq"}_llmType(){return"groq"}get lc_secrets(){return{apiKey:"GROQ_API_KEY"}}constructor(t){super(t??{}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","groq"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0});const n=(t==null?void 0:t.apiKey)||Go("GROQ_API_KEY");if(!n)throw new Error('Groq API key not found. Please set the GROQ_API_KEY environment variable or provide the key into "apiKey"');const r={"User-Agent":"langchainjs",...(t==null?void 0:t.defaultHeaders)??{}};this.client=new nn({apiKey:n,dangerouslyAllowBrowser:!0,baseURL:t==null?void 0:t.baseUrl,timeout:t==null?void 0:t.timeout,httpAgent:t==null?void 0:t.httpAgent,fetch:t==null?void 0:t.fetch,maxRetries:0,defaultHeaders:r,defaultQuery:t==null?void 0:t.defaultQuery}),this.apiKey=n,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.streaming=(t==null?void 0:t.streaming)??this.streaming,this.stop=(t==null?void 0:t.stopSequences)??(typeof(t==null?void 0:t.stop)=="string"?[t.stop]:t==null?void 0:t.stop)??[],this.stopSequences=this.stop,this.maxTokens=t==null?void 0:t.maxTokens}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"groq",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??this.temperature,ls_max_tokens:n.max_tokens??this.maxTokens,ls_stop:t.stop}}async completionWithRetry(t,n){return this.caller.call(async()=>this.client.chat.completions.create(t,n))}invocationParams(t){const n=super.invocationParams(t);return t.tool_choice!==void 0&&(n.tool_choice=t.tool_choice),t.tools!==void 0&&(n.tools=t.tools),t.response_format!==void 0&&(n.response_format=t.response_format),{...n,stop:t.stop??this.stopSequences,model:this.model,temperature:this.temperature,max_tokens:this.maxTokens}}bindTools(t,n){return this.bind({tools:t.map(r=>Whe(r)),...n})}async*_streamResponseChunks(t,n,r){var u,d;const a=this.invocationParams(n),o=L8(t),i=await this.completionWithRetry({...a,messages:o,stream:!0},{signal:n==null?void 0:n.signal,headers:n==null?void 0:n.headers});let s="";const c=[];let l;for await(const f of i){l=f;const p=f==null?void 0:f.choices[0];if(!p)continue;(u=p.delta)!=null&&u.role&&(s=p.delta.role);const{message:y,toolCallData:m}=vye({...p.delta,role:s},p.index,f.x_groq);if(m){const b=m.filter(w=>c.every(_=>_.id!==w.id));c.push(...b),yield new As({message:new Yf({content:"",tool_call_chunks:b}),text:""})}const v=new As({message:y,text:p.delta.content??"",generationInfo:{finishReason:p.finish_reason}});yield v,r==null||r.handleLLMNewToken(v.text??"")}if(l&&("choices"in l&&delete l.choices,yield new As({message:new Yf({content:"",response_metadata:l}),text:""})),(d=n.signal)==null?void 0:d.aborted)throw new Error("AbortError")}async _generate(t,n,r){var a;if(this.streaming){const o={},i=this._streamResponseChunks(t,n,r),s={};for await(const c of i){const l=((a=c.generationInfo)==null?void 0:a.completion)??0;s[l]===void 0?s[l]=c:s[l]=s[l].concat(c)}return{generations:Object.entries(s).sort(([c],[l])=>parseInt(c,10)-parseInt(l,10)).map(([c,l])=>l),llmOutput:{estimatedTokenUsage:o}}}else return this._generateNonStreaming(t,n,r)}async _generateNonStreaming(t,n,r){var l;const a={},o=this.invocationParams(n),i=L8(t),s=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,headers:n==null?void 0:n.headers});if("usage"in s&&s.usage){const{completion_tokens:u,prompt_tokens:d,total_tokens:f}=s.usage;u&&(a.completionTokens=(a.completionTokens??0)+u),d&&(a.promptTokens=(a.promptTokens??0)+d),f&&(a.totalTokens=(a.totalTokens??0)+f)}const c=[];if("choices"in s&&s.choices)for(const u of s.choices){const d=((l=u.message)==null?void 0:l.content)??"";let f;a.totalTokens!==void 0&&(f={input_tokens:a.promptTokens??0,output_tokens:a.completionTokens??0,total_tokens:a.totalTokens});const p={text:d,message:yye(u.message??{role:"assistant"},f)};p.generationInfo={...u.finish_reason?{finish_reason:u.finish_reason}:{},...u.logprobs?{logprobs:u.logprobs}:{}},c.push(p)}return{generations:c,llmOutput:{tokenUsage:a}}}withStructuredOutput(t,n){const r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw;let s=a??"extract",c,l;if(o==="jsonMode")l=this.bind({response_format:{type:"json_object"}}),km(r)?c=Vj.fromZodSchema(r):c=new qj;else if(km(r)){const p=qme(r);l=this.bind({tools:[{type:"function",function:{name:s,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:s}}}),c=new Am({returnSingle:!0,keyName:s,zodSchema:r})}else{let p;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(p=r,s=r.name):(s=r.title??s,p={name:s,description:r.description??"",parameters:r}),l=this.bind({tools:[{type:"function",function:p}],tool_choice:{type:"function",function:{name:s}}}),c=new Am({returnSingle:!0,keyName:s})}if(!i)return l.pipe(c).withConfig({runName:"ChatGroqStructuredOutput"});const u=Bc.assign({parsed:(p,y)=>c.invoke(p.raw,y)}),d=Bc.assign({parsed:()=>null}),f=u.withFallbacks({fallbacks:[d]});return uM.from([{raw:l},f]).withConfig({runName:"ChatGroqStructuredOutput"})}}const wye=e=>{const t=(n,r=null)=>{let a=`{
`;return n.filter(o=>o.parent_id===r).forEach(o=>{if(o.type==="object"){const i=e.filter(c=>c.parent_id===o.id),s=t(i,o.id);a+=`  ${o.name}${o.required?"":"?"}: ${s}
`}else a+=`  // ${o.description||""}
  ${o.name}${o.required?"":"?"}: ${o.type};
`}),a+="}",a};return t(e)},$8=e=>{const t=(r,a=null)=>{let o="";return r.filter(i=>i.parent_id===a).forEach(i=>{if(i.type==="object"){const s=t(r,i.id);o+=`    ${i.name}: z.object({
${s}    })${i.required?"":".optional()"}.describe('${i.description||""}'),
`}else o+=`    ${i.name}: z.${i.type}()${i.required?"":".optional()"}.describe('${i.description||""}'),
`}),o};let n=`const schema = z.object({
`;return n+=t(e),n+="});",n},xye=e=>{const t={},n={string:_a.string,number:_a.number,boolean:_a.boolean,enum:()=>_a.enum([""])};return e.forEach(r=>{if(!r.parent_id)if(r.type==="object"){const a=e.filter(i=>i.parent_id===r.id),o={};a.forEach(i=>{i.type==="object"||i.type==="array"||(o[i.name]=n[i.type](),i.required||(o[i.name]=o[i.name].optional()))}),t[r.name]=_a.object(o),r.required||(t[r.name]=t[r.name].optional())}else r.type==="array"?(t[r.name]=_a.array(_a.string()),r.required||(t[r.name]=t[r.name].optional())):r.type==="enum"?(t[r.name]=_a.enum((r.enum||"").split(",")),r.required||(t[r.name]=t[r.name].optional())):(t[r.name]=n[r.type](),r.required||(t[r.name]=t[r.name].optional()))}),_a.object(t)},_ye=e=>{switch(e){case Ct.Groq:return bye;case Ct.OpenAI:return nme;default:throw new Error("Provider is not supported")}},jye=async(e,t,{schemas:n,onMessageUpdate:r})=>{let a="",o;if(n!=null&&n.length){const i=n.filter(c=>{var l;return(l=c.schema_items)==null?void 0:l.length}).flatMap(c=>c.schema_items),s=await e.withStructuredOutput(xye(i)).stream(t);for await(const c of s)a=JSON.stringify(c),r==null||r({content:a})}else{const i=await e.stream(t);for await(const s of i)a+=`${s.content}`,o=s,r==null||r({content:a,chunk:s})}return{lastChunk:o,content:a}},Sye=()=>{const{toast:e}=Yt(),{t}=Pe("errors"),n=Ye(a=>a.currentSession),{modalRef:r}=Sc(vd);return{stream:g.useCallback(async(a,o)=>{var f,p;const{schemas:i,onMessageUpdate:s,onMessageFinish:c}=o||{};if(!(n!=null&&n.passphrase))throw new Error("Session is not found");await Gf.exists("passphrase")||await new Promise((y,m)=>{r.current.show({onConfirm:async v=>{try{const b=await q_(n.passphrase,v);await Gf.set("passphrase",b),y()}catch(b){e({content:t("invalid_passphrase"),variant:"destructive"}),m(b)}finally{r.current.hide()}},onCancel:()=>{m()}})});const l=(f=o==null?void 0:o.llm)==null?void 0:f.parameters;if(!(l!=null&&l.key)||typeof l.key!="string")throw new Error("API Key is not found");const u=await Gf.get("passphrase");if(!u)throw new Error("Passphrase is not found");const d=await q_(l.key,u);if(!d)throw new Error("API Key is not found");switch(o==null?void 0:o.provider){case Ct.Groq:case Ct.OpenAI:{const y=new(_ye(o.provider))({apiKey:d,model:(p=o==null?void 0:o.llm)==null?void 0:p.name}),{content:m,lastChunk:v}=await jye(y,a,{schemas:i,onMessageUpdate:s});return c==null||c({content:m,lastChunk:v}),{lastChunk:v,content:m}}default:throw new Error("Provider is not supported")}},[n==null?void 0:n.passphrase,r,t,e])}},Wc=()=>{const e=wP(),t=Sye();return{stream:g.useCallback((n,r,a)=>{switch(n){case Ct.WebLLM:return e.stream(r,a);case Ct.Groq:case Ct.OpenAI:return t.stream(r,{...a,provider:n});default:throw new Error("Provider is not supported")}},[t,e])}},Eye=e=>{const[t]=g.useState(!1),n=Ts(i=>i.similaritySearchWithScore),{stream:r}=Wc(),a=g.useCallback(async(i,s)=>{if(!(s!=null&&s.length))return[];const c=[];return await Promise.all(s.map(async l=>{var d,f,p,y;const u=l.placeholderEntity;if(u)switch(u.placeholder_type){case zs.VECTOR_DATABASE_RETREIVER:{if(!l.promptNode||!l.promptEntity||!l.vectorDatabaseNode||!l.vectorDatabaseEntity)return;const m=(d=u.metadata)!=null&&d.k?+((f=u.metadata)==null?void 0:f.k):1;let v=(p=u.metadata)!=null&&p.minimalScore?+((y=u.metadata)==null?void 0:y.minimalScore):void 0;v&&v>1&&(v=v/100);const b=await n({databaseId:l.vectorDatabaseEntity.id},i,m);if(!b)return[];const w=new Jo({template:l.promptEntity.content,inputVariables:["context"]});c.push(new eo(await w.format({context:v?b.filter(([,_])=>_>=v).map(([_])=>_.pageContent).join(`
`):b.map(([_])=>_.pageContent).join(`
`)})))}}})),c},[n]),o=g.useCallback(async(i,s,{retriverInfo:c},{schema:l,onMessageUpdate:u,onResponseMessageCreate:d,onInjectedMessages:f})=>{var v,b;if(!((v=e.mainLLMInfo)!=null&&v.llm)||((b=e.mainLLMInfo)==null?void 0:b.status)!==Ge.Loaded)throw new Error("LLM not found");const p=[];c!=null&&c.length&&(p.push(...await a(i,c)),f==null||f(p));const y=s.map(w=>w.role==="system"?new av(w.content):w.role==="user"?new Dr(w.content):new eo(w.content));d==null||d();const{content:m}=await r(e.mainLLMInfo.llm.provider,y,{schemas:l?[l]:void 0,onMessageUpdate:({content:w})=>{u==null||u({nodeData:{loading:!0,content:w}})},llm:e.mainLLMInfo.llm});return u==null||u({nodeData:{content:m}}),m},[a,r,e.mainLLMInfo]);return{loading:t,sendMessage:o}},Oye=Ya(({onDelete:e})=>{const{t}=Pe("dialogs"),[n,r]=g.useState(!1),a=Jt(),{toast:o}=Yt(),i=async()=>{try{r(!0),await e(),a.hide()}catch{o({variant:"destructive",description:t("delete_chat_data_node.errors.delete_failed")})}finally{r(!1)}};return h.jsx(v2,{open:a.visible,onOpenChange:a.hide,children:h.jsxs(gb,{children:[h.jsxs(vb,{children:[h.jsx(wb,{children:t("delete_chat_data_node.title")}),h.jsx(xb,{children:t("delete_chat_data_node.description")})]}),h.jsxs(bb,{children:[h.jsx(jb,{onClick:a.hide,children:t("delete_chat_data_node.cancel")}),h.jsx(_b,{disabled:n,onClick:i,children:t("delete_chat_data_node.delete")})]})]})})});function Xm(){return h.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"text-foreground",children:[h.jsx("circle",{cx:"4",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_qFRN",begin:"0;spinner_OcgL.end+0.25s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{begin:"spinner_qFRN.begin+0.1s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"20",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_OcgL",begin:"spinner_qFRN.begin+0.2s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})})]})}const Cye=g.lazy(()=>Ut(()=>import("./index-xilbYyvr.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([5,6,1,2,7,8]))),nS=g.memo(({source:e,className:t,...n})=>{const r=Ps(o=>o.theme),a=g.useMemo(()=>({pre:({children:o,className:i,...s})=>h.jsx("pre",{...s,className:K(i,"nowheel"),children:o}),think:({children:o})=>h.jsx("blockquote",{className:"think",children:o})}),[]);return h.jsx(g.Suspense,{children:h.jsx(Cye,{className:K("!text-sm [&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans",t),source:e,wrapperElement:{"data-color-mode":r==="dark"?"dark":"light"},components:a,...n})})},(e,t)=>e.source===t.source),Qt=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:K("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Qt.displayName="Card";const Vn=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:K("flex flex-col space-y-1.5 p-6",e),...t}));Vn.displayName="CardHeader";const Yn=g.forwardRef(({className:e,...t},n)=>h.jsx("h3",{ref:n,className:K("text-2xl font-semibold leading-none tracking-tight",e),...t}));Yn.displayName="CardTitle";const F8=g.forwardRef(({className:e,...t},n)=>h.jsx("p",{ref:n,className:K("text-sm text-muted-foreground",e),...t}));F8.displayName="CardDescription";const qn=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:K("p-6 pt-0",e),...t}));qn.displayName="CardContent";const mi=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:K("flex items-center p-6 pt-0",e),...t}));mi.displayName="CardFooter";const Nye=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",height:192,viewBox:"0 0 150 150",width:192,...e},g.createElement("clipPath",{id:"a"},g.createElement("path",{d:"m0 0h150v150h-150z"})),g.createElement("g",{clipPath:"url(#a)"},g.createElement("path",{d:"m150 0h-150v150h150z",fill:"#29b5e8"}),g.createElement("path",{clipRule:"evenodd",d:"m130.375 67.2532-14.096 8.1221 14.096 8.0536c.843.4872 1.581 1.1357 2.174 1.9084.592.7727 1.026 1.6545 1.278 2.5951.251.9406.315 1.9215.188 2.8867-.128.9652-.444 1.8959-.931 2.7388-.488.843-1.136 1.5817-1.909 2.174s-1.654 1.0267-2.595 1.2782-1.921.3154-2.887.1878c-.965-.1275-1.896-.444-2.739-.9312l-25.2559-14.5496c-1.1575-.6696-2.1128-1.6394-2.765-2.8068-.6523-1.1674-.9773-2.4893-.9408-3.826.0198-.5792.1089-1.1538.2653-1.7117.517-1.8711 1.7458-3.4654 3.4234-4.4419l25.256-14.4983c.847-.4892 1.782-.8067 2.751-.9343.97-.1275 1.955-.0627 2.899.1909.945.2536 1.83.6909 2.605 1.287.775.596 1.425 1.3391 1.913 2.1866.49.8402.808 1.7693.935 2.7334.128.964.063 1.9439-.191 2.8826-.254.9388-.692 1.8177-1.288 2.5859-.597.7681-1.34 1.4101-2.186 1.8887zm-13.343 39.3698-25.2478-14.5243c-1.1296-.6483-2.4091-.9896-3.7115-.9902s-2.5823.3397-3.7124.987c-1.1301.6472-2.0712 1.579-2.7297 2.7026-.6585 1.1237-1.0115 2.4001-1.0239 3.7024v29.0135c.0654 1.928.8772 3.755 2.264 5.095 1.3869 1.341 3.2403 2.09 5.1691 2.09 1.9289 0 3.7823-.749 5.1691-2.09 1.3868-1.34 2.1986-3.167 2.264-5.095v-16.261l14.1301 8.122c.843.488 1.774.805 2.739.933.966.128 1.947.064 2.888-.187s1.823-.685 2.596-1.277c.774-.592 1.423-1.331 1.91-2.174.488-.843.805-1.773.933-2.739.128-.965.065-1.946-.186-2.887s-.685-1.824-1.277-2.597-1.331-1.422-2.174-1.91zm-29.0992-28.3806-10.527 10.3986c-.3601.3349-.8269.5319-1.318.5563h-3.0897c-.49-.0294-.9551-.2257-1.318-.5563l-10.4671-10.4329c-.3274-.3573-.521-.817-.5478-1.3009v-3.081c.0283-.4861.2215-.9481.5478-1.3095l10.4671-10.4329c.3637-.3281.829-.5214 1.318-.5477h3.0897c.4899.0228.9562.2166 1.318.5477l10.4928 10.4329c.3237.3623.514.8243.5392 1.3095v3.081c-.0237.483-.2143.9428-.5392 1.3009zm-8.3874-2.8928c-.0404-.499-.2485-.9696-.5905-1.3352l-3.0383-3.004c-.3641-.3275-.8291-.5207-1.318-.5478h-.1113c-.4867.0255-.9495.2191-1.3094.5478l-3.0383 3.004c-.3262.3676-.5165.8358-.5392 1.3266v.1113c.0215.4834.2124.9439.5392 1.3009l3.0554 2.9955c.3607.3274.823.5208 1.3094.5477h.1113c.4889-.027.9539-.2203 1.318-.5477l3.0383-3.0212c.3282-.3576.5244-.8166.5563-1.3009zm-47.4914-31.2217 25.2563 14.4811c1.1308.648 2.4115.989 3.7149.9889 1.3033 0 2.584-.3409 3.7148-.989 1.1309-.648 2.0725-1.5806 2.7314-2.7051.659-1.1245 1.0123-2.4018 1.0249-3.7051v-28.9879c-.0654-1.9277-.8772-3.7546-2.264-5.0952s-3.2402-2.0899-5.1691-2.0899c-1.9288 0-3.7822.7493-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v16.2613l-14.1473-8.1307c-.8429-.4877-1.7737-.8047-2.7392-.9328-.9654-.1281-1.9466-.0647-2.8876.1864s-1.8232.6852-2.5965 1.2773c-.7732.5921-1.4222 1.3307-1.91 2.1736-.4878.843-.8048 1.7738-.9329 2.7392-.128.9655-.0647 1.9467.1864 2.8876.2512.941.6852 1.8233 1.2773 2.5965.5921.7733 1.3307 1.4223 2.1737 1.9101zm55.4252 15.4739c1.4914.118 2.9836-.2193 4.2793-.9671l25.2475-14.5496c.843-.4877 1.582-1.1368 2.174-1.91s1.026-1.6555 1.277-2.5965.315-1.9222.187-2.8876c-.128-.9655-.445-1.8962-.933-2.7392-.488-.8429-1.137-1.5816-1.91-2.1737-.774-.5921-1.656-1.0261-2.597-1.2772-1.9-.5072-3.924-.2387-5.627.7464l-14.1298 8.1991v-16.2613c-.0654-1.9277-.8772-3.7546-2.264-5.0952-1.3868-1.3405-3.2402-2.0899-5.1691-2.0899-1.9288 0-3.7822.7494-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v29.0136c-.0023 1.8784.7086 3.6876 1.9892 5.0619 1.2805 1.3743 3.0351 2.2111 4.909 2.3412zm-25.8554 31.5298c-1.4916-.1213-2.9847.2162-4.2793.9671l-25.2905 14.4893c-1.7024.985-2.9438 2.607-3.451 4.507s-.2387 3.924.7465 5.627c.9851 1.702 2.6061 2.943 4.5065 3.451 1.9004.507 3.9244.238 5.6268-.747l14.1473-8.122v16.261c.0654 1.928.8772 3.755 2.2641 5.096 1.3868 1.34 3.2402 2.09 5.169 2.09 1.9289 0 3.7823-.75 5.1691-2.09 1.3868-1.341 2.1986-3.168 2.264-5.096v-29.0645c-.0038-1.869-.7144-3.6673-1.9891-5.0341s-3.0192-2.2009-4.8834-2.3348zm-6.8468-13.5825c.4875-1.6032.414-3.3247-.2083-4.8806-.6224-1.5559-1.7564-2.8532-3.2152-3.6779l-25.2306-14.541c-1.704-.976-3.7248-1.2385-5.6216-.7303-1.8968.5083-3.5155 1.7461-4.5032 3.4433-.4889.84-.8065 1.7686-.9343 2.732-.1278.9635-.0632 1.9428.1899 2.8811.2531.9384.6897 1.8173 1.2846 2.5858.595.7686 1.3364 1.4115 2.1814 1.8917l14.096 8.1221-14.096 8.0536c-.8429.4861-1.5819 1.1334-2.1746 1.9051-.5928.7717-1.0277 1.6526-1.2801 2.5923-.2523.9398-.317 1.9201-.1905 2.8849s.4418 1.8952.9279 2.7382c.4861.8429 1.1335 1.5819 1.9051 2.1746.7717.5928 1.6526 1.0277 2.5924 1.2801.9397.2523 1.92.317 2.8848.1905s1.8952-.4418 2.7382-.9279l25.2306-14.5496c1.6248-.9071 2.8451-2.3965 3.4149-4.168z",fill:"#fff",fillRule:"evenodd"}))),Mye=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:48,height:48,...e},g.createElement("path",{fill:"#fbc02d",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20 s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),g.createElement("path",{fill:"#e53935",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039 l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),g.createElement("path",{fill:"#4caf50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36 c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),g.createElement("path",{fill:"#1565c0",d:"M43.611,20.083L43.595,20L42,20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571 c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),Pye=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:1024,height:1024,viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M44.522 44.5217H489.739V489.739H44.522V44.5217Z",fill:"#F35325"}),g.createElement("path",{d:"M534.261 44.5217H979.478V489.739H534.261V44.5217Z",fill:"#81BC06"}),g.createElement("path",{d:"M44.522 534.261H489.739V979.478H44.522V534.261Z",fill:"#05A6F0"}),g.createElement("path",{d:"M534.261 534.261H979.478V979.478H534.261V534.261Z",fill:"#FFBA08"})),kye=e=>g.createElement("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 287.56 191",...e},g.createElement("defs",null,g.createElement("style",null,".cls-1{fill:#0081fb;}.cls-2{fill:url(#linear-gradient);}.cls-3{fill:url(#linear-gradient-2);}"),g.createElement("linearGradient",{id:"linear-gradient",x1:62.34,y1:101.45,x2:260.34,y2:91.45,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0064e1"}),g.createElement("stop",{offset:.4,stopColor:"#0064e1"}),g.createElement("stop",{offset:.83,stopColor:"#0073ee"}),g.createElement("stop",{offset:1,stopColor:"#0082fb"})),g.createElement("linearGradient",{id:"linear-gradient-2",x1:41.42,y1:53,x2:41.42,y2:126,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0082fb"}),g.createElement("stop",{offset:1,stopColor:"#0064e0"}))),g.createElement("title",null,"facebook-meta"),g.createElement("path",{className:"cls-1",d:"M31.06,126c0,11,2.41,19.41,5.56,24.51A19,19,0,0,0,53.19,160c8.1,0,15.51-2,29.79-21.76,11.44-15.83,24.92-38,34-52l15.36-23.6c10.67-16.39,23-34.61,37.18-47C181.07,5.6,193.54,0,206.09,0c21.07,0,41.14,12.21,56.5,35.11,16.81,25.08,25,56.67,25,89.27,0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191V160c17.63,0,22-16.2,22-34.74,0-26.42-6.16-55.74-19.73-76.69-9.63-14.86-22.11-23.94-35.84-23.94-14.85,0-26.8,11.2-40.23,31.17-7.14,10.61-14.47,23.54-22.7,38.13l-9.06,16c-18.2,32.27-22.81,39.62-31.91,51.75C84.74,183,71.12,191,53.19,191c-21.27,0-34.72-9.21-43-23.09C3.34,156.6,0,141.76,0,124.85Z"}),g.createElement("path",{className:"cls-2",d:"M24.49,37.3C38.73,15.35,59.28,0,82.85,0c13.65,0,27.22,4,41.39,15.61,15.5,12.65,32,33.48,52.63,67.81l7.39,12.32c17.84,29.72,28,45,33.93,52.22,7.64,9.26,13,12,19.94,12,17.63,0,22-16.2,22-34.74l27.4-.86c0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191c-12.8,0-24.14-2.78-36.68-14.61-9.64-9.08-20.91-25.21-29.58-39.71L146.08,93.6c-12.94-21.62-24.81-37.74-31.68-45C107,40.71,97.51,31.23,82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78Z"}),g.createElement("path",{className:"cls-3",d:"M82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78C38.61,71.62,31.06,99.34,31.06,126c0,11,2.41,19.41,5.56,24.51L10.14,167.91C3.34,156.6,0,141.76,0,124.85,0,94.1,8.44,62.05,24.49,37.3,38.73,15.35,59.28,0,82.85,0Z"})),Aye=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:256,height:233,viewBox:"0 0 256 233",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M186.182 0h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#f7d046",d:"M209.455 0H256v46.545h-46.545z"}),g.createElement("path",{d:"M0 0h46.545v46.545H0zm0 46.545h46.545V93.09H0zm0 46.546h46.545v46.545H0zm0 46.545h46.545v46.545H0zm0 46.546h46.545v46.545H0z"}),g.createElement("path",{fill:"#f7d046",d:"M23.273 0h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#f2a73b",d:"M209.455 46.545H256V93.09h-46.545zm-186.182 0h46.545V93.09H23.273z"}),g.createElement("path",{d:"M139.636 46.545h46.545V93.09h-46.545z"}),g.createElement("path",{fill:"#f2a73b",d:"M162.909 46.545h46.545V93.09h-46.545zm-93.091 0h46.545V93.09H69.818z"}),g.createElement("path",{fill:"#ee792f",d:"M116.364 93.091h46.545v46.545h-46.545zm46.545 0h46.545v46.545h-46.545zm-93.091 0h46.545v46.545H69.818z"}),g.createElement("path",{d:"M93.091 139.636h46.545v46.545H93.091z"}),g.createElement("path",{fill:"#eb5829",d:"M116.364 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#ee792f",d:"M209.455 93.091H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"}),g.createElement("path",{d:"M186.182 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M209.455 139.636H256v46.545h-46.545z"}),g.createElement("path",{d:"M186.182 186.182h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M23.273 139.636h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#ea3326",d:"M209.455 186.182H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"})),Tye="/NoLLMChat/assets/qwen-B-gSh3_v.webp",Rye="/NoLLMChat/assets/smollm-CikBjd4F.png",Iye="/NoLLMChat/assets/stablelm-BquePdQ7.png",Dye="/NoLLMChat/assets/nomic-BjJqoFji.webp",Lye="/NoLLMChat/assets/joshua-ByaReJuI.webp",$ye="/NoLLMChat/assets/deepseek-CRqFMahi.png",Fye="/NoLLMChat/assets/redpajama-CmUGqSQW.png",Bye=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{fill:"#fff",d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),zye=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),fa=g.memo(({name:e,className:t,...n})=>{const r=Ps(a=>a.theme);return e=e.toLowerCase(),e.includes("gpt")?r==="dark"?h.jsx(Bye,{className:K("w-5 h-5",t),...n}):h.jsx(zye,{className:K("w-5 h-5",t),...n}):e!=null&&e.includes("deepseek")?h.jsx("img",{className:K("w-5 h-5 rounded-full",t),src:$ye,alt:"deepseek",...n}):e!=null&&e.includes("redpajama")?h.jsx("img",{className:K("w-5 h-5 rounded-full",t),src:Fye,alt:"deepseek",...n}):e.includes("gemma")?h.jsx(Mye,{className:K("w-5 h-5",t),...n}):e!=null&&e.includes("qwen")?h.jsx("img",{className:K("w-5 h-5",t),src:Tye,alt:"qwen",...n}):e!=null&&e.includes("phi")?h.jsx(Pye,{className:K("w-5 h-5",t),...n}):e!=null&&e.includes("llama")?h.jsx(kye,{className:K("w-5 h-5",t),...n}):e!=null&&e.includes("smollm")?h.jsx("img",{className:K("w-5 h-5",t),src:Rye,alt:"smollm",...n}):e!=null&&e.includes("mistral")?h.jsx(Aye,{className:K("w-5 h-5",t),...n}):e!=null&&e.includes("snowflake")?h.jsx(Nye,{className:K("w-5 h-5 rounded-full",t),...n}):e!=null&&e.includes("stablelm")?h.jsx("img",{className:K("w-5 h-5 rounded-full",t),src:Iye,alt:"stablelm",...n}):e!=null&&e.includes("nomic")?h.jsx("img",{className:K("w-5 h-5 rounded-full",t),src:Dye,alt:"nomic",...n}):e!=null&&e.includes("Xenova")||e!=null&&e.includes("janus")?h.jsx("img",{className:K("w-5 h-5 rounded-full",t),src:Lye,alt:"Xenova",...n}):h.jsx(fe,{className:K("w-5 h-5",t),name:"brain"})}),rS=["Qwen2.5-1.5B-Instruct-q4f32_1-MLC","Qwen2.5-Coder-1.5B-Instruct-q4f16_1-MLC","stablelm-2-zephyr-1_6b-q4f16_1-MLC-1k","Phi-3.5-mini-instruct-q4f16_1-MLC-1k","Llama-3.2-3B-Instruct-q4f32_1-MLC","DeepSeek-R1-Distill-Qwen-7B-q4f16_1-MLC"],Vye=Ja("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function En({className:e,variant:t,...n}){return h.jsx("div",{className:K(Vye({variant:t}),e),...n})}const Fd=g.memo(e=>{var c;const{name:t,model:n,isCached:r,isFunctionCalling:a}=e,{t:o}=Pe("atoms"),i=g.useCallback(l=>l===1?"llm_info.model_types.embedding":l===2?"llm_info.model_types.vlm":"llm_info.model_types.llm",[]),s=g.useMemo(()=>{if(n)switch(n.model_type){case 0:case 1:return h.jsx(En,{className:"",children:o(i(n.model_type))});case 2:return h.jsxs(h.Fragment,{children:[h.jsx(En,{className:"",children:o(i(0))}),h.jsx(En,{className:"",children:o(i(n.model_type))})]})}},[n,i,o]);if(n)return h.jsxs(h.Fragment,{children:[s,rS.some(l=>t&&l.includes(t))?h.jsx(En,{className:"",variant:"outline",children:o("llm_info.recommended")}):null,r?h.jsx(En,{className:"",variant:"outline",children:o("llm_info.cached")}):null,a?h.jsx(En,{className:"",variant:"outline",children:o("llm_info.function_calling")}):null,n!=null&&n.low_resource_required?h.jsx(En,{className:"",variant:"outline",children:o("llm_info.low_resource_required")}):null,(c=n==null?void 0:n.overrides)!=null&&c.context_window_size?h.jsxs(En,{className:"",variant:"outline",children:[n.overrides.context_window_size.toLocaleString("en-US")," Tokens"]}):null,n!=null&&n.vram_required_MB?h.jsxs(En,{className:"",variant:"outline",children:["VRAM: ",n.vram_required_MB.toLocaleString("en-US")," MB"]}):null]})}),qye=g.memo(({llm:e,status:t,loadLLM:n,progress:r})=>{const{t:a}=Pe("flows"),[o,i]=g.useState();g.useEffect(()=>{o||!(e!=null&&e.name)||Ut(()=>import("./index-D2o0-Nmt.js").then(async l=>(await l.__tla,l)),__vite__mapDeps([9,1,2,3,4])).then(async({hasModelInCache:l,functionCallingModelIds:u,prebuiltAppConfig:d})=>{const f=await l(e==null?void 0:e.name);i({hasCache:f,isFunctionCalling:u.includes(e==null?void 0:e.name),info:d.model_list.find(p=>p.model_id===(e==null?void 0:e.name))})})},[e==null?void 0:e.name,o]);const s=g.useCallback(async()=>{await(n==null?void 0:n())},[n]),c=g.useMemo(()=>{switch(t){case Ge.Downloading:return h.jsx(fe,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case Ge.Loaded:return h.jsx(fa,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"});default:return h.jsx(fa,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"})}},[e==null?void 0:e.name,t]);return h.jsx(Qt,{className:"flex justify-center !bg-inherit !p-2 max-w-full overflow-y-hidden !mb-2 m-2 !mt-0",children:h.jsxs("div",{className:"ml-2 pt-1 max-w-full",children:[h.jsxs("p",{className:"flex gap-2 items-center pr-6 !text-sm font-semibold",children:[c,`${(e==null?void 0:e.name)||""}`]}),h.jsxs("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:[h.jsx(Fd,{model:o==null?void 0:o.info,isFunctionCalling:(o==null?void 0:o.isFunctionCalling)||!1,name:e==null?void 0:e.name,isCached:(o==null?void 0:o.hasCache)||!1}),t!==Ge.Loaded?r?h.jsx("div",{className:"text-sm break-words flex-wrap",children:r}):h.jsx(ut,{disabled:t===Ge.Loading,onClick:s,className:"mt-4 w-full",children:a(o!=null&&o.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")}):void 0]})]})})}),Uye=e=>{const[t,n]=g.useState([]),r=Ye(i=>i.currentSession),a=g.useCallback(async()=>{if(!e||!(r!=null&&r.id))return;const i=await de("FlowEdge").find({where:{session_id:r.id,source:e.id},order:{id:"DESC"}}),{flowNodes:s,flowNodeDatas:c}=await im({where:{session_id:r.id,id:Da(i.map(l=>l.target)),source_type:"JSONData"},order:{updated_at:"DESC"},select:["id","source_id","source_type","updated_at"]});n(s.reduce((l,u)=>{var f;const d=(f=c[u.source_type])==null?void 0:f.find(p=>p.id===u.source_id);return d&&l.push({node:u,entity:d}),l},[]))},[r==null?void 0:r.id,e]),o=g.useCallback(async i=>{await de("FlowNode").delete(i.id),await de("JSONData").delete(i.source_id);const s=await de("FlowEdge").find({where:[{source:i.id},{target:i.id}]});await Promise.all(s.map(c=>de("FlowEdge").delete(c.id))),a()},[a]);return g.useEffect(()=>{e&&a()},[a,e]),{chatList:t,deleteChat:o,getChatList:a}};class Wye{async loadAndSplit(t){if(t===void 0)throw new Error("You must pass a text splitter to use this method.");const n=await this.load();return t.invoke(n)}}class B8 extends Wye{constructor(t,{splitPages:n=!0,pdfjs:r=Hye,parsedItemSeparator:a=""}={}){super(),Object.defineProperty(this,"blob",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"splitPages",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"pdfjs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parsedItemSeparator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.blob=t,this.splitPages=n??this.splitPages,this.pdfjs=r,this.parsedItemSeparator=a}async load(){const{getDocument:t,version:n}=await this.pdfjs(),r=await t({data:new Uint8Array(await this.blob.arrayBuffer()),useWorkerFetch:!1,isEvalSupported:!1,useSystemFonts:!0}).promise,a=await r.getMetadata().catch(()=>null),o=[];for(let i=1;i<=r.numPages;i+=1){const s=await(await r.getPage(i)).getTextContent();if(s.items.length===0)continue;let c;const l=[];for(const d of s.items)"str"in d&&(c===d.transform[5]||!c?l.push(d.str):l.push(`
${d.str}`),c=d.transform[5]);const u=l.join(this.parsedItemSeparator);o.push(new ep({pageContent:u,metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages},loc:{pageNumber:i}}}))}return this.splitPages?o:o.length===0?[]:[new ep({pageContent:o.map(i=>i.pageContent).join(`

`),metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages}}})]}}async function Hye(){try{const{default:e}=await Ut(async()=>{const{default:r}=await import("./pdf-DlLEmhiY.js").then(async a=>(await a.__tla,a)).then(a=>a.p);return{default:r}},__vite__mapDeps([10,1,2])),{getDocument:t,version:n}=e;return{getDocument:t,version:n}}catch(e){throw console.error(e),new Error("Failed to load pdf-parse. Please install it with eg. `npm install pdf-parse`.")}}var aS="Tabs",[Zye,DRe]=ir(aS,[to]),z8=to(),[Kye,oS]=Zye(aS),V8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:o,orientation:i="horizontal",dir:s,activationMode:c="automatic",...l}=e,u=Qo(s),[d,f]=Nn({prop:r,onChange:a,defaultProp:o});return h.jsx(Kye,{scope:n,baseId:Tt(),value:d,onValueChange:f,orientation:i,dir:u,activationMode:c,children:h.jsx(Ae.div,{dir:u,"data-orientation":i,...l,ref:t})})});V8.displayName=aS;var q8="TabsList",U8=g.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,o=oS(q8,n),i=z8(n);return h.jsx(Jl,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:r,children:h.jsx(Ae.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:t})})});U8.displayName=q8;var W8="TabsTrigger",H8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...o}=e,i=oS(W8,n),s=z8(n),c=X8(i.baseId,r),l=G8(i.baseId,r),u=r===i.value;return h.jsx(Yl,{asChild:!0,...s,focusable:!a,active:u,children:h.jsx(Ae.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":l,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:t,onMouseDown:ge(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?i.onValueChange(r):d.preventDefault()}),onKeyDown:ge(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(r)}),onFocus:ge(e.onFocus,()=>{const d=i.activationMode!=="manual";!u&&!a&&d&&i.onValueChange(r)})})})});H8.displayName=W8;var Z8="TabsContent",K8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:o,...i}=e,s=oS(Z8,n),c=X8(s.baseId,r),l=G8(s.baseId,r),u=r===s.value,d=g.useRef(u);return g.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),h.jsx(Ir,{present:a||u,children:({present:f})=>h.jsx(Ae.div,{"data-state":u?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:l,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:f&&o})})});K8.displayName=Z8;function X8(e,t){return`${e}-trigger-${t}`}function G8(e,t){return`${e}-content-${t}`}var Xye=V8,Q8=U8,J8=H8,Y8=K8;const iS=Xye,Gm=g.forwardRef(({className:e,...t},n)=>h.jsx(Q8,{ref:n,className:K("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Gm.displayName=Q8.displayName;const pa=g.forwardRef(({className:e,...t},n)=>h.jsx(J8,{ref:n,className:K("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));pa.displayName=J8.displayName;const ha=g.forwardRef(({className:e,...t},n)=>h.jsx(Y8,{ref:n,className:K("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));ha.displayName=Y8.displayName,Gv=function(e,[t,n]){return Math.min(n,Math.max(t,e))};function eF(e){const t=g.useRef({value:e,previous:e});return g.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Gye=[" ","Enter","ArrowUp","ArrowDown"],Qye=[" ","Enter"],Bd="Select",[Qm,Jm,Jye]=Xf(Bd),[Hc,LRe]=ir(Bd,[Jye,Qs]),Ym=Qs(),[Yye,yi]=Hc(Bd),[ege,tge]=Hc(Bd),tF=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:o,value:i,defaultValue:s,onValueChange:c,dir:l,name:u,autoComplete:d,disabled:f,required:p,form:y}=e,m=Ym(t),[v,b]=g.useState(null),[w,_]=g.useState(null),[x,j]=g.useState(!1),S=Qo(l),[E=!1,O]=Nn({prop:r,defaultProp:a,onChange:o}),[M,N]=Nn({prop:i,defaultProp:s,onChange:c}),P=g.useRef(null),R=v?y||!!v.closest("form"):!0,[k,C]=g.useState(new Set),T=Array.from(k).map(A=>A.props.value).join(";");return h.jsx(Up,{...m,children:h.jsxs(Yye,{required:p,scope:t,trigger:v,onTriggerChange:b,valueNode:w,onValueNodeChange:_,valueNodeHasChildren:x,onValueNodeHasChildrenChange:j,contentId:Tt(),value:M,onValueChange:N,open:E,onOpenChange:O,dir:S,triggerPointerDownPosRef:P,disabled:f,children:[h.jsx(Qm.Provider,{scope:t,children:h.jsx(ege,{scope:e.__scopeSelect,onNativeOptionAdd:g.useCallback(A=>{C(I=>new Set(I).add(A))},[]),onNativeOptionRemove:g.useCallback(A=>{C(I=>{const L=new Set(I);return L.delete(A),L})},[]),children:n})}),R?h.jsxs(OF,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:M,onChange:A=>N(A.target.value),disabled:f,form:y,children:[M===void 0?h.jsx("option",{value:""}):null,Array.from(k)]},T):null]})})};tF.displayName=Bd;var nF="SelectTrigger",rF=g.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,o=Ym(n),i=yi(nF,n),s=i.disabled||r,c=xt(t,i.onTriggerChange),l=Jm(n),u=g.useRef("touch"),[d,f,p]=CF(m=>{const v=l().filter(_=>!_.disabled),b=v.find(_=>_.value===i.value),w=NF(v,m,b);w!==void 0&&i.onValueChange(w.value)}),y=m=>{s||(i.onOpenChange(!0),p()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return h.jsx(ib,{asChild:!0,...o,children:h.jsx(Ae.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":EF(i.value)?"":void 0,...a,ref:c,onClick:ge(a.onClick,m=>{m.currentTarget.focus(),u.current!=="mouse"&&y(m)}),onPointerDown:ge(a.onPointerDown,m=>{u.current=m.pointerType;const v=m.target;v.hasPointerCapture(m.pointerId)&&v.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(y(m),m.preventDefault())}),onKeyDown:ge(a.onKeyDown,m=>{const v=d.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&f(m.key),!(v&&m.key===" ")&&Gye.includes(m.key)&&(y(),m.preventDefault())})})})});rF.displayName=nF;var aF="SelectValue",oF=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:o,placeholder:i="",...s}=e,c=yi(aF,n),{onValueNodeHasChildrenChange:l}=c,u=o!==void 0,d=xt(t,c.onValueNodeChange);return on(()=>{l(u)},[l,u]),h.jsx(Ae.span,{...s,ref:d,style:{pointerEvents:"none"},children:EF(c.value)?h.jsx(h.Fragment,{children:i}):o})});oF.displayName=aF;var nge="SelectIcon",iF=g.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return h.jsx(Ae.span,{"aria-hidden":!0,...a,ref:t,children:r||"\u25BC"})});iF.displayName=nge;var rge="SelectPortal",sF=e=>h.jsx(nv,{asChild:!0,...e});sF.displayName=rge;var ss="SelectContent",cF=g.forwardRef((e,t)=>{const n=yi(ss,e.__scopeSelect),[r,a]=g.useState();if(on(()=>{a(new DocumentFragment)},[]),!n.open){const o=r;return o?Vl.createPortal(h.jsx(lF,{scope:e.__scopeSelect,children:h.jsx(Qm.Slot,{scope:e.__scopeSelect,children:h.jsx("div",{children:e.children})})}),o):null}return h.jsx(uF,{...e,ref:t})});cF.displayName=ss;var ma=10,[lF,gi]=Hc(ss),age="SelectContentImpl",uF=g.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:i,side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:y,hideWhenDetached:m,avoidCollisions:v,...b}=e,w=yi(ss,n),[_,x]=g.useState(null),[j,S]=g.useState(null),E=xt(t,J=>x(J)),[O,M]=g.useState(null),[N,P]=g.useState(null),R=Jm(n),[k,C]=g.useState(!1),T=g.useRef(!1);g.useEffect(()=>{if(_)return tu(_)},[_]),nu();const A=g.useCallback(J=>{const[Z,...U]=R().map(z=>z.ref.current),[Q]=U.slice(-1),ne=document.activeElement;for(const z of J)if(z===ne||(z==null||z.scrollIntoView({block:"nearest"}),z===Z&&j&&(j.scrollTop=0),z===Q&&j&&(j.scrollTop=j.scrollHeight),z==null||z.focus(),document.activeElement!==ne))return},[R,j]),I=g.useCallback(()=>A([O,_]),[A,O,_]);g.useEffect(()=>{k&&I()},[k,I]);const{onOpenChange:L,triggerPointerDownPosRef:D}=w;g.useEffect(()=>{if(_){let J={x:0,y:0};const Z=Q=>{var ne,z;J={x:Math.abs(Math.round(Q.pageX)-(((ne=D.current)==null?void 0:ne.x)??0)),y:Math.abs(Math.round(Q.pageY)-(((z=D.current)==null?void 0:z.y)??0))}},U=Q=>{J.x<=10&&J.y<=10?Q.preventDefault():_.contains(Q.target)||L(!1),document.removeEventListener("pointermove",Z),D.current=null};return D.current!==null&&(document.addEventListener("pointermove",Z),document.addEventListener("pointerup",U,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Z),document.removeEventListener("pointerup",U,{capture:!0})}}},[_,L,D]),g.useEffect(()=>{const J=()=>L(!1);return window.addEventListener("blur",J),window.addEventListener("resize",J),()=>{window.removeEventListener("blur",J),window.removeEventListener("resize",J)}},[L]);const[B,F]=CF(J=>{const Z=R().filter(ne=>!ne.disabled),U=Z.find(ne=>ne.ref.current===document.activeElement),Q=NF(Z,J,U);Q&&setTimeout(()=>Q.ref.current.focus())}),$=g.useCallback((J,Z,U)=>{const Q=!T.current&&!U;(w.value!==void 0&&w.value===Z||Q)&&(M(J),Q&&(T.current=!0))},[w.value]),V=g.useCallback(()=>_==null?void 0:_.focus(),[_]),G=g.useCallback((J,Z,U)=>{const Q=!T.current&&!U;(w.value!==void 0&&w.value===Z||Q)&&P(J)},[w.value]),X=r==="popper"?sS:dF,H=X===sS?{side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:y,hideWhenDetached:m,avoidCollisions:v}:{};return h.jsx(lF,{scope:n,content:_,viewport:j,onViewportChange:S,itemRefCallback:$,selectedItem:O,onItemLeave:V,itemTextRefCallback:G,focusSelectedItem:I,selectedItemText:N,position:r,isPositioned:k,searchRef:B,children:h.jsx(Ap,{as:Xo,allowPinchZoom:!0,children:h.jsx(Sp,{asChild:!0,trapped:w.open,onMountAutoFocus:J=>{J.preventDefault()},onUnmountAutoFocus:ge(a,J=>{var Z;(Z=w.trigger)==null||Z.focus({preventScroll:!0}),J.preventDefault()}),children:h.jsx(tv,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:J=>J.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:h.jsx(X,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:J=>J.preventDefault(),...b,...H,onPlaced:()=>C(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:ge(b.onKeyDown,J=>{const Z=J.ctrlKey||J.altKey||J.metaKey;if(J.key==="Tab"&&J.preventDefault(),!Z&&J.key.length===1&&F(J.key),["ArrowUp","ArrowDown","Home","End"].includes(J.key)){let U=R().filter(Q=>!Q.disabled).map(Q=>Q.ref.current);if(["ArrowUp","End"].includes(J.key)&&(U=U.slice().reverse()),["ArrowUp","ArrowDown"].includes(J.key)){const Q=J.target,ne=U.indexOf(Q);U=U.slice(ne+1)}setTimeout(()=>A(U)),J.preventDefault()}})})})})})})});uF.displayName=age;var oge="SelectItemAlignedPosition",dF=g.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,o=yi(ss,n),i=gi(ss,n),[s,c]=g.useState(null),[l,u]=g.useState(null),d=xt(t,E=>u(E)),f=Jm(n),p=g.useRef(!1),y=g.useRef(!0),{viewport:m,selectedItem:v,selectedItemText:b,focusSelectedItem:w}=i,_=g.useCallback(()=>{if(o.trigger&&o.valueNode&&s&&l&&m&&v&&b){const E=o.trigger.getBoundingClientRect(),O=l.getBoundingClientRect(),M=o.valueNode.getBoundingClientRect(),N=b.getBoundingClientRect();if(o.dir!=="rtl"){const Q=N.left-O.left,ne=M.left-Q,z=E.left-ne,se=E.width+z,re=Math.max(se,O.width),ue=window.innerWidth-ma,je=Gv(ne,[ma,Math.max(ma,ue-re)]);s.style.minWidth=se+"px",s.style.left=je+"px"}else{const Q=O.right-N.right,ne=window.innerWidth-M.right-Q,z=window.innerWidth-E.right-ne,se=E.width+z,re=Math.max(se,O.width),ue=window.innerWidth-ma,je=Gv(ne,[ma,Math.max(ma,ue-re)]);s.style.minWidth=se+"px",s.style.right=je+"px"}const P=f(),R=window.innerHeight-ma*2,k=m.scrollHeight,C=window.getComputedStyle(l),T=parseInt(C.borderTopWidth,10),A=parseInt(C.paddingTop,10),I=parseInt(C.borderBottomWidth,10),L=parseInt(C.paddingBottom,10),D=T+A+k+L+I,B=Math.min(v.offsetHeight*5,D),F=window.getComputedStyle(m),$=parseInt(F.paddingTop,10),V=parseInt(F.paddingBottom,10),G=E.top+E.height/2-ma,X=R-G,H=v.offsetHeight/2,J=v.offsetTop+H,Z=T+A+J,U=D-Z;if(Z<=G){const Q=P.length>0&&v===P[P.length-1].ref.current;s.style.bottom="0px";const ne=l.clientHeight-m.offsetTop-m.offsetHeight,z=Math.max(X,H+(Q?V:0)+ne+I),se=Z+z;s.style.height=se+"px"}else{const Q=P.length>0&&v===P[0].ref.current;s.style.top="0px";const ne=Math.max(G,T+m.offsetTop+(Q?$:0)+H)+U;s.style.height=ne+"px",m.scrollTop=Z-G+m.offsetTop}s.style.margin=`${ma}px 0`,s.style.minHeight=B+"px",s.style.maxHeight=R+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[f,o.trigger,o.valueNode,s,l,m,v,b,o.dir,r]);on(()=>_(),[_]);const[x,j]=g.useState();on(()=>{l&&j(window.getComputedStyle(l).zIndex)},[l]);const S=g.useCallback(E=>{E&&y.current===!0&&(_(),w==null||w(),y.current=!1)},[_,w]);return h.jsx(sge,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:p,onScrollButtonChange:S,children:h.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:x},children:h.jsx(Ae.div,{...a,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});dF.displayName=oge;var ige="SelectPopperPosition",sS=g.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=ma,...o}=e,i=Ym(n);return h.jsx(sb,{...i,...o,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});sS.displayName=ige;var[sge,cS]=Hc(ss,{}),lS="SelectViewport",fF=g.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,o=gi(lS,n),i=cS(lS,n),s=xt(t,o.onViewportChange),c=g.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),h.jsx(Qm.Slot,{scope:n,children:h.jsx(Ae.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ge(a.onScroll,l=>{const u=l.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=i;if(f!=null&&f.current&&d){const p=Math.abs(c.current-u.scrollTop);if(p>0){const y=window.innerHeight-ma*2,m=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),b=Math.max(m,v);if(b<y){const w=b+p,_=Math.min(y,w),x=w-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=x>0?x:0,d.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});fF.displayName=lS;var pF="SelectGroup",[cge,lge]=Hc(pF),uge=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Tt();return h.jsx(cge,{scope:n,id:a,children:h.jsx(Ae.div,{role:"group","aria-labelledby":a,...r,ref:t})})});uge.displayName=pF;var hF="SelectLabel",mF=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=lge(hF,n);return h.jsx(Ae.div,{id:a.id,...r,ref:t})});mF.displayName=hF;var ey="SelectItem",[dge,yF]=Hc(ey),gF=g.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:o,...i}=e,s=yi(ey,n),c=gi(ey,n),l=s.value===r,[u,d]=g.useState(o??""),[f,p]=g.useState(!1),y=xt(t,w=>{var _;return(_=c.itemRefCallback)==null?void 0:_.call(c,w,r,a)}),m=Tt(),v=g.useRef("touch"),b=()=>{a||(s.onValueChange(r),s.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(dge,{scope:n,value:r,disabled:a,textId:m,isSelected:l,onItemTextChange:g.useCallback(w=>{d(_=>_||((w==null?void 0:w.textContent)??"").trim())},[]),children:h.jsx(Qm.ItemSlot,{scope:n,value:r,disabled:a,textValue:u,children:h.jsx(Ae.div,{role:"option","aria-labelledby":m,"data-highlighted":f?"":void 0,"aria-selected":l&&f,"data-state":l?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:y,onFocus:ge(i.onFocus,()=>p(!0)),onBlur:ge(i.onBlur,()=>p(!1)),onClick:ge(i.onClick,()=>{v.current!=="mouse"&&b()}),onPointerUp:ge(i.onPointerUp,()=>{v.current==="mouse"&&b()}),onPointerDown:ge(i.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:ge(i.onPointerMove,w=>{var _;v.current=w.pointerType,a?(_=c.onItemLeave)==null||_.call(c):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ge(i.onPointerLeave,w=>{var _;w.currentTarget===document.activeElement&&((_=c.onItemLeave)==null||_.call(c))}),onKeyDown:ge(i.onKeyDown,w=>{var _;((_=c.searchRef)==null?void 0:_.current)!==""&&w.key===" "||(Qye.includes(w.key)&&b(),w.key===" "&&w.preventDefault())})})})})});gF.displayName=ey;var zd="SelectItemText",vF=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...o}=e,i=yi(zd,n),s=gi(zd,n),c=yF(zd,n),l=tge(zd,n),[u,d]=g.useState(null),f=xt(t,b=>d(b),c.onItemTextChange,b=>{var w;return(w=s.itemTextRefCallback)==null?void 0:w.call(s,b,c.value,c.disabled)}),p=u==null?void 0:u.textContent,y=g.useMemo(()=>h.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:m,onNativeOptionRemove:v}=l;return on(()=>(m(y),()=>v(y)),[m,v,y]),h.jsxs(h.Fragment,{children:[h.jsx(Ae.span,{id:c.textId,...o,ref:f}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Vl.createPortal(o.children,i.valueNode):null]})});vF.displayName=zd;var bF="SelectItemIndicator",wF=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return yF(bF,n).isSelected?h.jsx(Ae.span,{"aria-hidden":!0,...r,ref:t}):null});wF.displayName=bF;var uS="SelectScrollUpButton",xF=g.forwardRef((e,t)=>{const n=gi(uS,e.__scopeSelect),r=cS(uS,e.__scopeSelect),[a,o]=g.useState(!1),i=xt(t,r.onScrollButtonChange);return on(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollTop>0;o(l)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(jF,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop-c.offsetHeight)}}):null});xF.displayName=uS;var dS="SelectScrollDownButton",_F=g.forwardRef((e,t)=>{const n=gi(dS,e.__scopeSelect),r=cS(dS,e.__scopeSelect),[a,o]=g.useState(!1),i=xt(t,r.onScrollButtonChange);return on(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<l;o(u)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(jF,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop+c.offsetHeight)}}):null});_F.displayName=dS;var jF=g.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,o=gi("SelectScrollButton",n),i=g.useRef(null),s=Jm(n),c=g.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return g.useEffect(()=>()=>c(),[c]),on(()=>{var l,u;(u=(l=s().find(d=>d.ref.current===document.activeElement))==null?void 0:l.ref.current)==null||u.scrollIntoView({block:"nearest"})},[s]),h.jsx(Ae.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ge(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:ge(a.onPointerMove,()=>{var l;(l=o.onItemLeave)==null||l.call(o),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:ge(a.onPointerLeave,()=>{c()})})}),fge="SelectSeparator",SF=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return h.jsx(Ae.div,{"aria-hidden":!0,...r,ref:t})});SF.displayName=fge;var fS="SelectArrow",pge=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Ym(n),o=yi(fS,n),i=gi(fS,n);return o.open&&i.position==="popper"?h.jsx(cb,{...a,...r,ref:t}):null});pge.displayName=fS;function EF(e){return e===""||e===void 0}var OF=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=g.useRef(null),o=xt(t,a),i=eF(n);return g.useEffect(()=>{const s=a.current,c=window.HTMLSelectElement.prototype,l=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==n&&l){const u=new Event("change",{bubbles:!0});l.call(s,n),s.dispatchEvent(u)}},[i,n]),h.jsx(pRe,{asChild:!0,children:h.jsx("select",{...r,ref:o,defaultValue:n})})});OF.displayName="BubbleSelect";function CF(e){const t=sr(e),n=g.useRef(""),r=g.useRef(0),a=g.useCallback(i=>{const s=n.current+i;t(s),function c(l){n.current=l,window.clearTimeout(r.current),l!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(s)},[t]),o=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,o]}function NF(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=hge(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.textValue.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function hge(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var mge=tF,MF=rF,yge=oF,gge=iF,vge=sF,PF=cF,bge=fF,kF=mF,AF=gF,wge=vF,xge=wF,TF=xF,RF=_F,IF=SF;const Po=mge,ko=yge,Ba=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(MF,{ref:r,className:K("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,h.jsx(gge,{asChild:!0,children:h.jsx(fe,{name:"chevron-down",className:"h-4 w-4 opacity-50"})})]}));Ba.displayName=MF.displayName;const DF=g.forwardRef(({className:e,...t},n)=>h.jsx(TF,{ref:n,className:K("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(fe,{name:"chevron-up",className:"h-4 w-4"})}));DF.displayName=TF.displayName;const LF=g.forwardRef(({className:e,...t},n)=>h.jsx(RF,{ref:n,className:K("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(fe,{name:"chevron-down",className:"h-4 w-4"})}));LF.displayName=RF.displayName;const za=g.forwardRef(({className:e,children:t,position:n="popper",...r},a)=>h.jsx(vge,{children:h.jsxs(PF,{ref:a,className:K("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[h.jsx(DF,{}),h.jsx(bge,{className:K("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),h.jsx(LF,{})]})}));za.displayName=PF.displayName;const _ge=g.forwardRef(({className:e,...t},n)=>h.jsx(kF,{ref:n,className:K("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));_ge.displayName=kF.displayName;const er=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(AF,{ref:r,className:K("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(xge,{children:h.jsx(fe,{name:"check",className:"h-4 w-4"})})}),h.jsx(wge,{children:t})]}));er.displayName=AF.displayName;const jge=g.forwardRef(({className:e,...t},n)=>h.jsx(IF,{ref:n,className:K("-mx-1 my-1 h-px bg-muted",e),...t}));jge.displayName=IF.displayName;var Ao="Accordion",Sge=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[pS,Ege,Oge]=Xf(Ao),[ty,$Re]=ir(Ao,[Oge,dk]),hS=dk(),$F=W.forwardRef((e,t)=>{const{type:n,...r}=e,a=r,o=r;return h.jsx(pS.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?h.jsx(Pge,{...o,ref:t}):h.jsx(Mge,{...a,ref:t})})});$F.displayName=Ao;var[FF,Cge]=ty(Ao),[BF,Nge]=ty(Ao,{collapsible:!1}),Mge=W.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:o=!1,...i}=e,[s,c]=Nn({prop:n,defaultProp:r,onChange:a});return h.jsx(FF,{scope:e.__scopeAccordion,value:s?[s]:[],onItemOpen:c,onItemClose:W.useCallback(()=>o&&c(""),[o,c]),children:h.jsx(BF,{scope:e.__scopeAccordion,collapsible:o,children:h.jsx(zF,{...i,ref:t})})})}),Pge=W.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Nn({prop:n,defaultProp:r,onChange:a}),c=W.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=W.useCallback(u=>s((d=[])=>d.filter(f=>f!==u)),[s]);return h.jsx(FF,{scope:e.__scopeAccordion,value:i,onItemOpen:c,onItemClose:l,children:h.jsx(BF,{scope:e.__scopeAccordion,collapsible:!0,children:h.jsx(zF,{...o,ref:t})})})}),[kge,ny]=ty(Ao),zF=W.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:o="vertical",...i}=e,s=W.useRef(null),c=xt(s,t),l=Ege(n),u=Qo(a)==="ltr",d=ge(e.onKeyDown,f=>{var E;if(!Sge.includes(f.key))return;const p=f.target,y=l().filter(O=>{var M;return!((M=O.ref.current)!=null&&M.disabled)}),m=y.findIndex(O=>O.ref.current===p),v=y.length;if(m===-1)return;f.preventDefault();let b=m;const w=0,_=v-1,x=()=>{b=m+1,b>_&&(b=w)},j=()=>{b=m-1,b<w&&(b=_)};switch(f.key){case"Home":b=w;break;case"End":b=_;break;case"ArrowRight":o==="horizontal"&&(u?x():j());break;case"ArrowDown":o==="vertical"&&x();break;case"ArrowLeft":o==="horizontal"&&(u?j():x());break;case"ArrowUp":o==="vertical"&&j();break}const S=b%v;(E=y[S].ref.current)==null||E.focus()});return h.jsx(kge,{scope:n,disabled:r,direction:a,orientation:o,children:h.jsx(pS.Slot,{scope:n,children:h.jsx(Ae.div,{...i,"data-orientation":o,ref:c,onKeyDown:r?void 0:d})})})}),ry="AccordionItem",[Age,mS]=ty(ry),VF=W.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...a}=e,o=ny(ry,n),i=Cge(ry,n),s=hS(n),c=Tt(),l=r&&i.value.includes(r)||!1,u=o.disabled||e.disabled;return h.jsx(Age,{scope:n,open:l,disabled:u,triggerId:c,children:h.jsx(hk,{"data-orientation":o.orientation,"data-state":KF(l),...s,...a,ref:t,disabled:u,open:l,onOpenChange:d=>{d?i.onItemOpen(r):i.onItemClose(r)}})})});VF.displayName=ry;var qF="AccordionHeader",UF=W.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=ny(Ao,n),o=mS(qF,n);return h.jsx(Ae.h3,{"data-orientation":a.orientation,"data-state":KF(o.open),"data-disabled":o.disabled?"":void 0,...r,ref:t})});UF.displayName=qF;var yS="AccordionTrigger",WF=W.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=ny(Ao,n),o=mS(yS,n),i=Nge(yS,n),s=hS(n);return h.jsx(pS.ItemSlot,{scope:n,children:h.jsx(pQ,{"aria-disabled":o.open&&!i.collapsible||void 0,"data-orientation":a.orientation,id:o.triggerId,...s,...r,ref:t})})});WF.displayName=yS;var HF="AccordionContent",ZF=W.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=ny(Ao,n),o=mS(HF,n),i=hS(n);return h.jsx(hQ,{role:"region","aria-labelledby":o.triggerId,"data-orientation":a.orientation,...i,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});ZF.displayName=HF;function KF(e){return e?"open":"closed"}let XF;XM=$F,GM=VF,XF=UF,Qv=WF,Jv=ZF;const GF=XM,gS=g.forwardRef(({className:e,...t},n)=>h.jsx(GM,{ref:n,className:K("border-b",e),...t}));gS.displayName="AccordionItem";const vS=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(XF,{className:"flex",children:h.jsxs(Qv,{ref:r,className:K("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,h.jsx(fe,{name:"chevron-down",className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));vS.displayName=Qv.displayName;const bS=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(Jv,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:h.jsx("div",{className:K("pb-4 pt-0",e),children:t})}));bS.displayName=Jv.displayName;const Tge=[1,2,3,4,5,6,7,8,9,10],QF=g.memo(e=>{const{t}=Pe("flows"),[n,r]=g.useState(""),[a,o]=g.useState([]),[i,s]=g.useState("1"),{loading:c,onSimilaritySearch:l,onCreatePrompt:u,onCreateRetriever:d}=e,f=async()=>{o(await l(n,+i)),r("")},p=async y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),f())};return h.jsxs("div",{className:"mt-4 max-w-full",children:[h.jsx("div",{className:"bg-black/5 dark:bg-white/5 rounded-xl relative",children:h.jsxs("div",{className:"relative px-2 py-1 pb-2",children:[h.jsxs(Po,{value:`${i}`,onValueChange:y=>s(y),children:[h.jsx(Ba,{className:"absolute left-0 !w-14 top-[2px] rounded-xl bg-transparent border-none focus:outline-none focus:ring-0 focus:border-opacity-0 focus:ring-transparent",children:h.jsx(ko,{placeholder:t("vector_database_node.k_select_placeholder")})}),h.jsx(za,{children:Tge.map(y=>h.jsx(er,{value:`${y}`,children:y},`${y}`))})]}),h.jsx(vo,{value:n,disabled:c,placeholder:t("vector_database_node.similarity_search_placeholder"),className:K("w-full rounded-xl px-2 pl-11 border-none resize-none bg-transparent","min-h-8 max-h-8"),onKeyDown:p,onChange:y=>{r(y.target.value)}}),h.jsx("button",{type:"button",disabled:c,onClick:f,className:"absolute right-3 top-5 -translate-y-1/2 rounded-xl bg-black/5 dark:bg-white/5 p-1",children:h.jsx(fe,{name:c?"loader-circle":"arrow-right",className:K("w-4 h-4 dark:text-white",n?"opacity-100":"opacity-30",c?"animate-spin":"")})})]})}),h.jsx(GF,{type:"single",collapsible:!0,children:a==null?void 0:a.map(([y,m],v)=>h.jsxs(gS,{value:`${v}`,children:[h.jsxs(vS,{children:[`[${m.toFixed(2)}] ${y.pageContent}`.substring(0,32),"..."]}),h.jsx(bS,{children:y.pageContent})]},`${v}`))}),h.jsxs("div",{className:"w-full mt-4 flex flex-col gap-1",children:[d?h.jsx(ut,{disabled:c,onClick:d,className:"w-full",children:t("vector_database_node.to_retriever")}):void 0,a!=null&&a.length&&u?h.jsx(ut,{disabled:c,onClick:()=>u(a),className:"w-full",children:t("vector_database_node.create_prompt")}):void 0]})]})}),JF=g.memo(({loading:e,onCreateData:t})=>{const{t:n}=Pe("flows"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=async()=>{o&&(await t({id:r,content:o}),a(""),i(""))};return h.jsxs("div",{className:"min-w-80",children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("vector_database_node.add_text.id")}),h.jsx(Mn,{value:r,disabled:e,onChange:c=>a(c.target.value||""),placeholder:n("vector_database_node.add_text.id_placeholder"),className:"mb-4"}),h.jsxs(nt,{htmlFor:"name",children:[n("vector_database_node.add_text.content")," ",h.jsx("span",{className:"text-red-600",children:"*"})]}),h.jsx(vo,{value:o,disabled:e,onChange:c=>i(c.target.value||""),placeholder:n("vector_database_node.add_text.content_placeholder")})]}),h.jsx("div",{className:"flex justify-between mt-6",children:h.jsx(Zn,{loading:e,disabled:!(o!=null&&o.length),onClick:s,className:"w-full",children:n("vector_database_node.add_text.add")})})]})}),wS=({className:e,size:t=200,duration:n=15,anchor:r=90,borderWidth:a=1.5,colorFrom:o="#ffaa40",colorTo:i="#9c40ff",delay:s=0})=>h.jsx("div",{style:{"--size":t,"--duration":n,"--anchor":r,"--border-width":a,"--color-from":o,"--color-to":i,"--delay":`-${s}s`},className:K("pointer-events-none absolute inset-0 rounded-[inherit] [border:calc(var(--border-width)*1px)_solid_transparent]","![mask-clip:padding-box,border-box] ![mask-composite:intersect] [mask:linear-gradient(transparent,transparent),linear-gradient(white,white)]","after:absolute after:aspect-square after:w-[calc(var(--size)*1px)] after:animate-border-beam after:[animation-delay:var(--delay)] after:[background:linear-gradient(to_left,var(--color-from),var(--color-to),transparent)] after:[offset-anchor:calc(var(--anchor)*1%)_50%] after:[offset-path:rect(0_auto_auto_0_round_calc(var(--size)*1px))]",e)});function Rge({accept:e,maxSize:t}){const{t:n}=Pe("atoms"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=g.useRef(null),[c,l]=g.useState(0),u=f=>{var y;const p=(y=f.target.files)==null?void 0:y[0];d(p)},d=f=>{if(i(""),f){if(t&&f.size>t*1024*1024){i(n("file_upload_input.errors.max_size",{maxSize:t,fileSize:(f.size/1024/1024).toFixed(2)}));return}const p=e==null?void 0:e.split(",").map(y=>y.replace(".","").trim());if(e&&!f.type.match(e.replace("/*",""))&&!(p!=null&&p.some(y=>f.type.includes(y)))){i(n("file_upload_input.errors.accept",{accept:e}));return}return l(f.size),a(f.name),f}};return{fileName:r,error:o,fileInputRef:s,handleFileSelect:u,validateAndSetFile:d,clearFile:()=>{a(""),i(""),l(0),s.current&&(s.current.value="")},fileSize:c}}function Ige({file:e,setFile:t,loading:n,progress:r,fileOptions:a}){const{toast:o}=Yt(),{t:i}=Pe("atoms"),[s,c]=g.useState(!1),{fileName:l,fileInputRef:u,clearFile:d,error:f,validateAndSetFile:p,fileSize:y}=Rge({accept:(a==null?void 0:a.accept)||"image/*",maxSize:(a==null?void 0:a.maxSize)||3});g.useEffect(()=>{e||d()},[d,e]),g.useEffect(()=>{f&&o({title:f,variant:"destructive"})},[f,o]);function m(x){const j=p(x);j&&t(j)}function v(x){x.preventDefault(),c(!1);const j=x.dataTransfer.files[0];j&&m(j)}function b(x){var S;const j=(S=x.target.files)==null?void 0:S[0];j&&m(j)}function w(){d(),t(void 0)}const _=g.useMemo(()=>{if(!e)return h.jsx("div",{className:"w-16 h-16 rounded-lg bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center",children:h.jsx(fe,{name:"file-text",className:"w-8 h-8 text-zinc-400"})});const x=e.type.startsWith("image/");return h.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:x?h.jsx("img",{src:URL.createObjectURL(e),alt:"Preview",className:"w-full h-full object-cover"}):h.jsx(fe,{className:"w-14 h-14",name:"file-text"})})},[e]);return h.jsx(h.Fragment,{children:h.jsxs("div",{className:K("relative group cursor-pointer","rounded-lg border-2 border-dashed","transition-colors duration-200",s?"border-indigo-500 bg-indigo-50/50 dark:bg-indigo-500/10":"border-zinc-200 dark:border-zinc-800"),onDragOver:x=>{x.preventDefault(),c(!0)},onDragLeave:()=>c(!1),onDrop:v,onClick:()=>{var x;return(x=u.current)==null?void 0:x.click()},onKeyDown:x=>{var j;(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),(j=u.current)==null||j.click())},"aria-label":"Upload file",children:[h.jsx("input",{ref:u,type:"file",disabled:n||!!(r&&r<1),accept:(a==null?void 0:a.accept)||"image/*",onChange:b,className:"hidden"}),h.jsx("div",{className:"p-8 space-y-4",children:l?h.jsxs("div",{className:"flex items-center gap-4",children:[_,h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("p",{className:"text-sm font-medium truncate",children:[l||"No file selected"," ",h.jsx("span",{className:"text-xs text-zinc-500 leading-5",children:y?`(${(y/1024/1024).toFixed(2)} MB)`:""})]}),r&&r<1?h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsxs("p",{children:[(r*100).toFixed(2)," %"]}),h.jsx("div",{className:"h-1 flex-1 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden items-center flex",children:h.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-200",style:{width:`${r*100}%`}})})]}):void 0]}),h.jsx("button",{type:"button",disabled:n||!!(r&&r<1),onClick:x=>{x.stopPropagation(),w()},className:"p-1 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded",children:h.jsx(fe,{name:"x",className:"w-5 h-5 text-zinc-400"})}),r&&r<1?h.jsx(wS,{className:"rounded-lg"}):void 0]}):h.jsxs("div",{className:"flex flex-col items-center gap-2",children:[h.jsx(fe,{name:"upload",className:"w-8 h-8 text-zinc-400 dark:text-zinc-500"}),h.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:i("file_upload_input.drop_file")})]})})]})})}function YF({onFileSubmit:e,fileOptions:t,progress:n,loading:r}){const{t:a}=Pe("flows"),[o,i]=g.useState(),s=async()=>{o&&(await e(o),i(void 0))};return h.jsxs("div",{className:"w-full max-w-full space-y-2 mt-4",children:[h.jsx("div",{className:"mb-6",children:h.jsx(Ige,{progress:n,loading:r,fileOptions:t,setFile:i,file:o})}),h.jsx(Zn,{loading:r,disabled:!o,onClick:s,className:"w-full mt-4",children:a("vector_database_node.add_file.index")})]})}const ay=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{className:"relative w-full overflow-auto",children:h.jsx("table",{ref:n,className:K("w-full caption-bottom text-sm",e),...t})}));ay.displayName="Table";const oy=g.forwardRef(({className:e,...t},n)=>h.jsx("thead",{ref:n,className:K("[&_tr]:border-b",e),...t}));oy.displayName="TableHeader";const iy=g.forwardRef(({className:e,...t},n)=>h.jsx("tbody",{ref:n,className:K("[&_tr:last-child]:border-0",e),...t}));iy.displayName="TableBody";const Dge=g.forwardRef(({className:e,...t},n)=>h.jsx("tfoot",{ref:n,className:K("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Dge.displayName="TableFooter";const cs=g.forwardRef(({className:e,...t},n)=>h.jsx("tr",{ref:n,className:K("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));cs.displayName="TableRow";const Zc=g.forwardRef(({className:e,...t},n)=>h.jsx("th",{ref:n,className:K("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Zc.displayName="TableHead";const Kc=g.forwardRef(({className:e,...t},n)=>h.jsx("td",{ref:n,className:K("align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Kc.displayName="TableCell";const Lge=g.forwardRef(({className:e,...t},n)=>h.jsx("caption",{ref:n,className:K("mt-4 text-sm text-muted-foreground",e),...t}));Lge.displayName="TableCaption";const e9=({className:e,...t})=>h.jsx("nav",{role:"navigation","aria-label":"pagination",className:K("mx-auto flex w-full justify-center",e),...t});e9.displayName="Pagination";const t9=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,className:K("flex flex-row items-center gap-1",e),...t}));t9.displayName="PaginationContent";const Xc=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,className:K("",e),...t}));Xc.displayName="PaginationItem";const sy=({className:e,isActive:t,size:n="icon",...r})=>h.jsx("a",{"aria-current":t?"page":void 0,className:K(pu({variant:t?"outline":"ghost",size:n}),e),...r});sy.displayName="PaginationLink";const n9=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs(sy,{"aria-label":"Go to previous page",size:"default",className:K("gap-1 pl-2.5",e),...t,children:[h.jsx(fe,{name:"chevron-left",className:"h-4 w-4"}),h.jsx("span",{children:n("pagination.previous")})]})};n9.displayName="PaginationPrevious";const r9=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs(sy,{"aria-label":"Go to next page",size:"default",className:K("gap-1 pr-2.5",e),...t,children:[h.jsx("span",{children:n("pagination.next")}),h.jsx(fe,{name:"chevron-right",className:"h-4 w-4"})]})};r9.displayName="PaginationNext";const xS=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs("span",{"aria-hidden":!0,className:K("flex h-9 w-9 items-center justify-center",e),...t,children:[h.jsx(fe,{name:"ellipsis",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:n("pagination.more_pages")})]})};xS.displayName="PaginationEllipsis";const a9=Ya(({title:e,content:t})=>{const n=Jt();return h.jsx(ii,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(lo,{className:"sm:max-w-2xl",children:[h.jsx(uo,{children:h.jsxs("div",{className:"flex",children:[h.jsx(fe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(fo,{children:e})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-96 overflow-hidden",children:h.jsx("div",{className:"relative w-full h-full overflow-hidden rounded-xl p-1 border border-border",children:h.jsx("pre",{className:"break-all h-full overflow-y-auto bg-background font-mono text-xs w-full",children:t})})})]})})}),cy=g.memo(e=>{const{data:t,headers:n,limitLengthByColumns:r,showPerPage:a=7,paginationShowLimit:o=1,contentLengthLimit:i=64}=e,[s,c]=g.useState({page:1,maxPage:1}),l=Jt(a9);g.useEffect(()=>{c(p=>({...p,maxPage:Math.ceil(t.length/a)}))},[t.length,a]);const u=g.useMemo(()=>t.slice((s.page-1)*a,s.page*a),[t,s.page,a]),d=g.useMemo(()=>{let p=!1,y=!1;return h.jsx(e9,{className:"mt-4 mb-4 ml-4 mr-4 w-full",children:h.jsxs(t9,{children:[s.page>1?h.jsx(Xc,{onClick:()=>c(m=>({...m,page:m.page-1})),children:h.jsx(n9,{})}):null,Array.from({length:s.maxPage},(m,v)=>{const b=v+1,w=v===0||v===s.maxPage-1;return!w&&b>s.page+o&&y?null:!w&&b>s.page+o?(y=!0,h.jsx(Xc,{children:h.jsx(xS,{})},v)):!w&&b<s.page-o&&p?null:!w&&b<s.page-o?(p=!0,h.jsx(Xc,{children:h.jsx(xS,{})},v)):h.jsx(Xc,{onClick:()=>c(_=>({..._,page:b})),children:h.jsx(sy,{isActive:v+1===s.page,children:v+1})},v)}),s.page<s.maxPage?h.jsx(Xc,{onClick:()=>c(m=>({...m,page:m.page+1})),children:h.jsx(r9,{})}):null]})})},[s.maxPage,s.page,o]),f=(p,y)=>{if(!p)return;const m=Array.isArray(p)?p:n.map(v=>p[v]);return h.jsxs(cs,{children:[h.jsx(Kc,{children:h.jsx("div",{className:"font-bold",children:y+1})}),m.map((v,b)=>{const w=typeof v=="string"?v:JSON.stringify(v),_=n[b],x=(r==null?void 0:r[_])||i,j=w.length>x;return h.jsx(Kc,{className:"p-4",children:h.jsxs("div",{onClick:j?()=>l.show({title:_,content:w}):void 0,className:"flex gap-4",children:[j?`${w.substring(0,x)}...`:w,j?h.jsx(fe,{className:"w-6 mt-[-2px]",name:"chevron-right"}):null]})},`${b}`)})]},`${y}`)};return h.jsxs(h.Fragment,{children:[h.jsxs(ay,{className:"w-full",children:[h.jsx(oy,{children:h.jsxs(cs,{children:[h.jsx(Zc,{},"index"),n?n.map(p=>h.jsx(Zc,{children:h.jsx("div",{className:"font-bold",children:p})},p)):void 0]})}),h.jsx(iy,{children:u!=null&&u.length?u==null?void 0:u.map(f):void 0})]}),d]})});var _S,o9;s0=function(){if(o9)return _S;o9=1;function e(t,n,r){var a=-1,o=t.length;n<0&&(n=-n>o?0:o+n),r=r>o?o:r,r<0&&(r+=o),o=n>r?0:r-n>>>0,n>>>=0;for(var i=Array(o);++a<o;)i[a]=t[a+n];return i}return _S=e,_S};var jS,i9;Rs=function(){if(i9)return jS;i9=1;var e=Xl(),t=Ri(),n=yh(),r=Fr();function a(o,i,s){if(!r(s))return!1;var c=typeof i;return(c=="number"?t(s)&&n(i,s.length):c=="string"&&i in s)?e(s[i],o):!1}return jS=a,jS};var SS,s9;function $ge(){if(s9)return SS;s9=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return SS=t,SS}var ES,c9;function Fge(){if(c9)return ES;c9=1;var e=$ge(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return ES=n,ES}var OS,l9;function u9(){if(l9)return OS;l9=1;var e=Fge(),t=Fr(),n=ic(),r=NaN,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=o.test(l);return d||i.test(l)?s(l.slice(2),d?2:8):a.test(l)?r:+l}return OS=c,OS}var CS,d9;function f9(){if(d9)return CS;d9=1;var e=u9(),t=1/0,n=17976931348623157e292;function r(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var o=a<0?-1:1;return o*n}return a===a?a:0}return CS=r,CS}var NS,p9;function h9(){if(p9)return NS;p9=1;var e=f9();function t(n){var r=e(n),a=r%1;return r===r?a?r-a:r:0}return NS=t,NS}var MS,m9;function Bge(){if(m9)return MS;m9=1;var e=s0(),t=Rs(),n=h9(),r=Math.ceil,a=Math.max;function o(i,s,c){(c?t(i,s,c):s===void 0)?s=1:s=a(n(s),0);var l=i==null?0:i.length;if(!l||s<1)return[];for(var u=0,d=0,f=Array(r(l/s));u<l;)f[d++]=e(i,u,u+=s);return f}return MS=o,MS}var zge=Bge();const PS=ot(zge),Vge=()=>{const[e,t]=g.useState(!1),{t:n}=Pe("flows"),{toast:r}=Yt(),a=Ts(c=>c.index),o=Ts(c=>c.similaritySearchWithScore),i=g.useCallback(async(c,l)=>{try{if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===Lr.DataNode)throw new Error("DataNode storage is not supported for similarity search");return t(!0),await o({databaseId:l.vectorDatabase.id},c,l==null?void 0:l.k)}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[o,r,n]),s=g.useCallback(async(c,l)=>{var u;try{t(!0);const d=c.content?[new ep({pageContent:c.content,id:c.id,metadata:{id:c.id}})]:c.documents;if(!(d!=null&&d.length)){r({variant:"destructive",title:n("vector_database_node.errors.content_not_found")});return}if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===Lr.DataNode)throw new Error("DataNode storage is not supported for indexing");{const f=PS(d,10);let p=0;for(const y of f)(u=l==null?void 0:l.onProgressReport)==null||u.call(l,{handling:y.length,handled:p,total:d.length}),await a({databaseId:l.vectorDatabase.id},y),p+=y.length}}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[a,r,n]);return{loading:e,indexData:s,similaritySearchWithScore:i}},qge=Ya(({retriverInfo:e})=>{var m,v,b;const{t}=Pe("applications"),{loading:n,similaritySearchWithScore:r,indexData:a}=Vge(),[o,i]=g.useState("search"),[s,c]=g.useState(0),l=Jt(),u=g.useMemo(()=>{var x,j;if(!((x=e==null?void 0:e.vectorDatabaseEntity)!=null&&x.raw))return{headers:[],rows:[]};const w=["content","embedding","metadata"],_=ov((j=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:j.raw);return{headers:w,rows:_.map(S=>{try{return JSON.parse(S)}catch{return[]}})}},[(m=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:m.raw]),d=g.useCallback(async(...w)=>{const[_,x]=w;await a(_,{...x,vectorDatabase:e.vectorDatabaseEntity})},[a,e.vectorDatabaseEntity]),f=g.useCallback(async(w,_)=>{const x=w.trim(),j=await r(x,{k:_,vectorDatabase:e.vectorDatabaseEntity});if(j!=null&&j.length)return j},[e.vectorDatabaseEntity,r]),p=g.useCallback(async w=>{if(w.type.includes("text")||w.type.includes("txt")){const _=new FileReader;_.onload=async x=>{var S;const j=(S=x.target)==null?void 0:S.result;await d({content:j},{vectorDatabase:e.vectorDatabaseEntity})},_.readAsText(w)}else if(w.type.endsWith("pdf")){const _=new Blob([w],{type:"application/pdf"}),x=await new B8(_,{pdfjs:async()=>{const j=await Ut(()=>import("./pdf.min-T3SIQZZM.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([11,1,2,3,4]));return await Ut(()=>import("./pdf.worker.min-CB1tp3fD.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([12,1,2,3,4])),j.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),j},parsedItemSeparator:" "}).load();await d({documents:x},{vectorDatabase:e.vectorDatabaseEntity,onProgressReport:j=>{c((j.handled+j.handling)/j.total)}})}},[d,e.vectorDatabaseEntity]),y=g.useMemo(()=>{switch(o){case"search":return h.jsx(ha,{value:"search",children:h.jsx(QF,{loading:n,onSimilaritySearch:f})});case"new":return h.jsx(ha,{className:"min-w-80",value:"new",children:h.jsx(JF,{loading:n,onCreateData:d})});case"file":return h.jsx(ha,{value:"file",children:h.jsx(YF,{loading:n,progress:s,onFileSubmit:p,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(ha,{value:"view",className:"max-h-full overflow-auto",children:h.jsx(cy,{data:u.rows,headers:u.headers,limitLengthByColumns:{embedding:32}})})}},[d,p,f,n,o,s,u]);return h.jsx(ii,{open:l.visible,onOpenChange:l.hide,children:h.jsxs(lo,{className:"max-w-3xl",children:[h.jsx(uo,{children:h.jsxs("div",{className:"flex",children:[h.jsx(fe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(fo,{children:t("chat.vector_database")})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-full overflow-hidden",children:h.jsx("div",{className:"w-full h-full",children:h.jsxs(iS,{value:o,onValueChange:i,defaultValue:"search",className:K("w-full h-full mt-4"),children:[h.jsxs(Gm,{className:K("grid w-full grid-cols-3",((v=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:v.storage)===Lr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(pa,{value:"search",children:t("chat.search")}),h.jsx(pa,{value:"new",children:t("chat.text")}),h.jsx(pa,{value:"file",children:t("chat.file")}),((b=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:b.storage)===Lr.DatabaseNode?h.jsx(pa,{value:"view",children:t("chat.view")}):void 0]}),y]})})})]})})});function Uge({schema:e,mainLLMInfo:t,loadLLM:n,retriverInfo:r,threadNode:a,onSelectThread:o,onAddNewThread:i,currentDataNode:s,...c}){var j;const{t:l}=Pe("applications"),[u,d]=g.useState(!1),f=Jt(Oye),p=Jt(qge),{chatList:y,getChatList:m,deleteChat:v}=Uye(a),b=g.useCallback(async()=>{try{d(!0),await(i==null?void 0:i()),m()}finally{d(!1)}},[m,i]),w=g.useCallback(()=>{p.show({retriverInfo:r[0]})},[r,p]),_=g.useCallback(async(S,E)=>{S.stopPropagation(),f.show({onDelete:()=>v(E)})},[v,f]),x=g.useMemo(()=>{var S;return h.jsx(nS,{className:K("overflow-hidden break-words whitespace-pre-wrap w-full rounded-lg"),source:(S=e==null?void 0:e.schema_items)!=null&&S.length?`\`\`\`javascript
${$8((e==null?void 0:e.schema_items)||[])}
\`\`\``:""})},[e==null?void 0:e.schema_items]);return h.jsxs(hb,{variant:"sidebar",side:"right",collapsible:"none",...c,children:[h.jsx("div",{className:"h-1"}),h.jsxs(ju,{className:"justify-between",children:[h.jsx("div",{className:"text-sm pl-2",children:l("chat.history")}),h.jsx(Zn,{loading:u,onClick:b,variant:"link",className:"mr-[-6px]",children:h.jsx(fe,{name:"circle-plus"})})]}),h.jsxs(yb,{children:[h.jsx(_u,{className:"flex-1",children:h.jsx(Ys,{children:y.map(({node:S},E)=>{var O;return h.jsx(so,{onClick:()=>o(S),children:h.jsx(co,{className:"cursor-pointer",children:h.jsxs("div",{className:"flex flex-row justify-between items-center w-full",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx(fe,{size:16,name:((O=s==null?void 0:s.node)==null?void 0:O.id)===S.id?"check":"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"}),h.jsx("span",{children:`Thread ${E+1}`})]}),h.jsx(fe,{onClick:M=>_(M,S),size:16,name:"trash-2"})]})})},S.id)})})}),r!=null&&r.length?h.jsxs(Qt,{className:"m-2 p-2 max-w-full",children:[h.jsx("pre",{className:"overflow-auto",children:r.map((S,E)=>{var O;return h.jsx("span",{children:((O=S.promptEntity)==null?void 0:O.content)||""},`${E}`)})}),h.jsx(ut,{onClick:w,className:"w-full mt-4",children:l("chat.vector_database")})]}):void 0,(j=e==null?void 0:e.schema_items)!=null&&j.length?h.jsx("div",{className:"m-2 !mb-0",children:h.jsx(g.Suspense,{fallback:h.jsx(Xm,{}),children:x})}):void 0,h.jsx(qye,{llm:t==null?void 0:t.llm,status:t==null?void 0:t.status,progress:t==null?void 0:t.progress,loadLLM:n})]})]})}var kS="Avatar",[Wge,FRe]=ir(kS),[Hge,y9]=Wge(kS),g9=g.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,o]=g.useState("idle");return h.jsx(Hge,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:h.jsx(Ae.span,{...r,ref:t})})});g9.displayName=kS;var v9="AvatarImage",b9=g.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...o}=e,i=y9(v9,n),s=Zge(r,o.referrerPolicy),c=sr(l=>{a(l),i.onImageLoadingStatusChange(l)});return on(()=>{s!=="idle"&&c(s)},[s,c]),s==="loaded"?h.jsx(Ae.img,{...o,ref:t,src:r}):null});b9.displayName=v9;var w9="AvatarFallback",x9=g.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,o=y9(w9,n),[i,s]=g.useState(r===void 0);return g.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(c)}},[r]),i&&o.imageLoadingStatus!=="loaded"?h.jsx(Ae.span,{...a,ref:t}):null});x9.displayName=w9;function Zge(e,t){const[n,r]=g.useState("idle");return on(()=>{if(!e){r("error");return}let a=!0;const o=new window.Image,i=s=>()=>{a&&r(s)};return r("loading"),o.onload=i("loaded"),o.onerror=i("error"),o.src=e,t&&(o.referrerPolicy=t),()=>{a=!1}},[e,t]),n}var _9=g9,j9=b9,S9=x9;const E9=g.forwardRef(({className:e,...t},n)=>h.jsx(_9,{ref:n,className:K("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));E9.displayName=_9.displayName;const O9=g.forwardRef(({className:e,...t},n)=>h.jsx(j9,{ref:n,className:K("aspect-square h-full w-full",e),...t}));O9.displayName=j9.displayName;const C9=g.forwardRef(({className:e,...t},n)=>h.jsx(S9,{ref:n,className:K("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));C9.displayName=S9.displayName;const Kge=Ja("flex gap-2 max-w-[60%] items-end relative group",{variants:{variant:{received:"self-start",sent:"self-end flex-row-reverse"},layout:{default:"",ai:"max-w-full w-full items-center"}},defaultVariants:{variant:"received",layout:"default"}}),N9=g.forwardRef(({className:e,variant:t,layout:n,children:r,...a},o)=>h.jsx("div",{className:K(Kge({variant:t,layout:n,className:e}),"relative group"),ref:o,...a,children:g.Children.map(r,i=>g.isValidElement(i)&&typeof i.type!="string"?g.cloneElement(i,{variant:t,layout:n,className:a==null?void 0:a.innerclassname}):i)}));N9.displayName="ChatBubble";const Xge=({src:e,fallback:t,className:n})=>h.jsxs(E9,{className:n,children:[h.jsx(O9,{src:e,alt:"Avatar"}),h.jsx(C9,{children:t})]}),Gge=Ja("p-4",{variants:{variant:{received:"bg-secondary text-secondary-foreground rounded-r-lg rounded-tl-lg",sent:"border border-border rounded-l-lg rounded-tr-lg"},layout:{default:"",ai:"border-t w-full rounded-none bg-transparent"}},defaultVariants:{variant:"received",layout:"default"}}),M9=g.forwardRef(({className:e,variant:t,layout:n,isLoading:r=!1,children:a,...o},i)=>h.jsx("div",{className:K(Gge({variant:t,layout:n,className:e}),"break-words max-w-full whitespace-pre-wrap"),ref:i,...o,children:r?h.jsx("div",{className:"flex items-center space-x-2",children:h.jsx(Xm,{})}):a}));M9.displayName="ChatBubbleMessage";const Qge=({icon:e,onClick:t,className:n,variant:r="ghost",size:a="icon",...o})=>h.jsx(ut,{variant:r,size:a,className:n,onClick:t,...o,children:e}),Jge=g.forwardRef(({variant:e,className:t,children:n,...r},a)=>h.jsx("div",{ref:a,className:K("absolute top-1/2 -translate-y-1/2 flex opacity-0 group-hover:opacity-100 transition-opacity duration-200",e==="sent"?"-left-1 -translate-x-full flex-row-reverse":"-right-1 translate-x-full",t),...r,children:n}));Jge.displayName="ChatBubbleActionWrapper";const Yge=[{icon:"copy",label:"Copy"},{icon:"refresh-ccw",label:"Refresh"},{icon:"volume-2",label:"Volume"}],eve=g.memo(({message:e,index:t,isLastMessage:n,isGenerating:r,isSchema:a,onActionClick:o})=>{const i=g.useMemo(()=>h.jsx(nS,{style:{color:"unset !important"},source:e.content?a?`\`\`\`json
${e.content}
\`\`\``:e.content:""}),[a,e.content]);return h.jsxs(N9,{innerclassname:e.role=="system"?"!bg-transparent font-semibold":void 0,variant:e.role=="user"?"sent":"received",children:[e.role==="system"?h.jsx("div",{className:"w-10 h-10"}):e.role==="assistant"?h.jsx(Xge,{src:"",fallback:e.data&&typeof e.data=="object"&&"injectedMessage"in e.data?"\u{1F4C2}":"\u{1F916}"}):void 0,h.jsxs(M9,{children:[r&&n&&(!e.content||a)?h.jsx(Xm,{}):h.jsxs(g.Suspense,{fallback:h.jsx(Xm,{}),children:[e.role==="system"?h.jsx(En,{className:"!text-sm mb-1",children:"System"}):void 0,i]}),e.role==="assistant"&&n&&h.jsx("div",{className:"flex items-center mt-1.5 gap-1",children:!r&&h.jsx(h.Fragment,{children:Yge.map((s,c)=>h.jsx(Qge,{variant:"ghost",className:"size-5",icon:h.jsx(fe,{name:s.icon,className:"size-3"}),onClick:()=>o(s.label,e)},c))})})]})]},t)},()=>!1),tve=g.memo(()=>{const{t:e}=Pe("applications"),t=g.useRef(!1),[n,r]=g.useState(!1),a=g.useCallback(()=>{setTimeout(()=>{M.current&&(M.current.scrollTop=M.current.scrollHeight)},50)},[]),o=$de(),{schema:i,threadInfo:s,mainLLMInfo:c,retriverInfo:l,currentDataNode:u,loadLLM:d,addNewDataNode:f,selectDataNode:p,updateMessagesData:y,onThreadMessagesLoaded:m}=o,{sendMessage:v}=Eye(o),{input:b,messages:w,isLoading:_,reload:x,setInput:j,handleSubmit:S,handleInputChange:E,setMessages:O}=RM({fetch:async(C,T)=>{try{r(!0);const A=JSON.parse(T==null?void 0:T.body),I=Ti(),L=A.messages[A.messages.length-1];return t.current=!0,O(D=>[...D,{id:Ti(),content:L.content,role:"user"}]),await v(L.content,A.messages||[],{retriverInfo:l},{schema:i,onInjectedMessages:D=>{D.length&&O(B=>[...B,...D.map(F=>F._getType()==="system"?{id:Ti(),content:`${F.content}`,role:"system",data:{injectedMessage:!0}}:F._getType()==="human"?{id:Ti(),content:`${F.content}`,role:"user",data:{injectedMessage:!0}}:{id:Ti(),content:`${F.content}`,role:"assistant",data:{injectedMessage:!0}})])},onResponseMessageCreate:D=>{O(B=>[...B,{id:I,content:D||"",role:"assistant"}])},onMessageUpdate:D=>{O(B=>{const F=[...B],$=F.findIndex(V=>V.id===I);return $!==-1&&(F[$]={...F[$],content:D.nodeData.content||""}),F}),t.current&&a()}}),O(D=>(y(D),D)),r(!1),j(""),t.current&&a(),new Response}finally{r(!1)}}}),M=g.useRef(null);g.useEffect(()=>{const C=m(T=>{O(T||[]),a()});return()=>{C()}},[O,m,a]);const N=async(C,T)=>(r(!0),await S(T),!0),P=g.useCallback(async(C,T)=>{if(C==="Refresh"){r(!0);try{await x()}finally{r(!1)}}C==="Copy"&&T&&T.role==="assistant"&&navigator.clipboard.writeText(T.content),C==="Volume"&&(T!=null&&T.content)&&await pM.speak((T==null?void 0:T.content)||"")},[x]),R=g.useCallback(()=>t.current=!1,[]),k=g.useMemo(()=>w&&w.map((C,T)=>h.jsx(eve,{message:C,index:T,isLastMessage:T===w.length-1,isGenerating:n,isSchema:!!i,onActionClick:P},C.id||`${T}`)),[w,n,i,P]);return h.jsxs(pb,{onClick:R,className:"max-h-full !overflow-hidden !min-h-full",style:{minHeight:"unset"},defaultOpen:!0,children:[h.jsx(mb,{className:"!max-h-full !overflow-hidden",style:{minHeight:"unset"},children:h.jsxs("main",{className:"flex h-full w-full max-w-2xl flex-col items-center mx-auto overflow-hidden",children:[h.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-w-full max-w-full",children:h.jsx($T,{className:"!max-h-full",ref:M,children:k})}),h.jsx(Kv,{className:"!max-w-2xl px-4",onSubmit:N,disabled:_||n||(c==null?void 0:c.status)!==Ge.Loaded,placeholder:e("chat.input_message_placeholder"),maxHeight:72,value:b,onChange:E})]})}),h.jsx(Uge,{schema:i,currentDataNode:u,threadNode:s==null?void 0:s.threadNode,loadLLM:d,mainLLMInfo:c,retriverInfo:l,onAddNewThread:f,onSelectThread:p})]})}),nve=()=>{const[e,t]=g.useState(),n=Ye(u=>u.currentSession),{t:r}=Pe("flows"),{toast:a}=Yt(),{stream:o}=Wc(),{loadModel:i}=sm(),{modalRef:s}=Sc(vd),c=g.useCallback(async(u,d)=>{if(n!=null&&n.main_node_id){if(!(e!=null&&e.llm))return a({variant:"destructive",description:r("editor_node.errors.llm_not_found")});(e==null?void 0:e.status)!==Ge.Loaded&&(await i(e.llm.provider,e.llm.name,f=>{t(p=>p&&{...p,progress:f.text})}),t(f=>f&&{...f,status:Ge.Loaded,progress:""}));try{return(await o(e==null?void 0:e.llm.provider,typeof u=="string"?[new Dr(u)]:u,{onMessageUpdate:f=>{d==null||d(f.content)},llm:e==null?void 0:e.llm})).content}catch(f){if(f instanceof Error&&f.message.includes("LLM_NOT_LOADED_YET"))return a({title:r("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:r("editor_node.errors.stream_message_failed")})}}},[n==null?void 0:n.main_node_id,e==null?void 0:e.llm,e==null?void 0:e.status,a,r,i,o]),l=g.useCallback(async()=>{if(!(n!=null&&n.main_node_id))return;const u=await de("FlowEdge").find({where:{target:n.main_node_id}}),d=(await de("FlowNode").find({where:{id:Da(u.map(p=>p.source))}})).find(p=>p.source_type===oe.LLM);if(!d)return;const f=await de("LLM").findOne({where:{id:d.source_id}});f&&(n.passphrase&&await lm(n.passphrase,s.current),await i(f.provider,f.name,p=>{t(y=>y&&{...y,llm:f,progress:p.text})}),t({llm:f,status:Ge.Loaded}))},[n==null?void 0:n.main_node_id,n==null?void 0:n.passphrase,i,s]);return g.useEffect(()=>{n!=null&&n.main_node_id&&l()},[n==null?void 0:n.main_node_id,l]),{mainLLMInfo:e,createMessage:c}},rve=()=>{const e=Ye(o=>o.currentSession),t=g.useRef(null),[n,r]=g.useState(),a=g.useCallback(async o=>{e!=null&&e.main_node_id&&(clearTimeout(t.current),t.current=setTimeout(async()=>{e!=null&&e.main_node_id&&await de("FlowNode").update(e.main_node_id,{data:o})},150))},[e]);return g.useEffect(()=>{e!=null&&e.main_node_id&&de("FlowNode").findOne({where:{id:e.main_node_id}}).then(o=>{r(o)})},[e]),{flowNode:n,updateEditorContent:a}},ave=g.lazy(()=>Ut(()=>import("./index-BnMUIC5-.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,7,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),ove=g.memo(()=>{var o,i,s,c,l;const{flowNode:e,updateEditorContent:t}=rve(),{mainLLMInfo:n,createMessage:r}=nve(),a=g.useCallback(u=>{t(u)},[t]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(wu,{children:h.jsx(Na,{children:h.jsxs("div",{className:K("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(n==null?void 0:n.status)===Ge.Loaded&&((o=n==null?void 0:n.llm)!=null&&o.name)?h.jsx(fa,{name:(i=n==null?void 0:n.llm)==null?void 0:i.name,className:"w-5 h-5 mr-1"}):void 0,h.jsx(Ma,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:n!=null&&n.progress?n==null?void 0:n.progress:(n==null?void 0:n.status)===Ge.Loaded?(s=n==null?void 0:n.llm)==null?void 0:s.name:h.jsx(fe,{size:16,name:"loader-circle",className:"animate-spin ml-2"})}),h.jsx(Hr,{children:h.jsx("p",{children:(n==null?void 0:n.progress)||((c=n==null?void 0:n.llm)==null?void 0:c.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(Wl,{simple:!0}),children:e?h.jsx(ave,{defaultValue:e==null?void 0:e.data,onValueChange:a,copilotStream:r,hideDragIcon:!0,enableHistoryControl:!0},((l=n==null?void 0:n.llm)==null?void 0:l.name)||"default"):h.jsx(Wl,{simple:!0})})]})}),ive=()=>{const[e,t]=g.useState(!1),[n,r]=g.useState(),a=Ye(p=>p.currentSession),{t:o}=Pe("flows"),{toast:i}=Yt(),{loadModel:s}=sm(),{stream:c}=Wc(),{modalRef:l}=Sc(vd),u=g.useCallback(async(p,y,m)=>{if(a!=null&&a.main_node_id){if(!(n!=null&&n.llm)){i({variant:"destructive",description:o("editor_node.errors.llm_not_found")});return}(n==null?void 0:n.status)!==Ge.Loaded&&(await s(n.llm.provider,n.llm.name,v=>{r(b=>b&&{...b,progress:v.text})}),r(v=>v&&{...v,status:Ge.Loaded,progress:""}));try{const v=y.map(w=>w.role==="system"?new av(w.content):w.role==="assistant"?new eo(w.content):new Dr(w.content)),{content:b}=await c(n.llm.provider,[...v,new Dr(p)],{onMessageUpdate:({content:w})=>{m==null||m(w)},llm:n.llm});return m==null||m(b),b}catch(v){if(v instanceof Error&&v.message.includes("LLM_NOT_LOADED_YET")){i({title:o("editor_node.errors.llm_not_loaded_yet")});return}i({variant:"destructive",title:o("editor_node.errors.stream_message_failed")})}}},[a==null?void 0:a.main_node_id,n==null?void 0:n.llm,n==null?void 0:n.status,i,o,s,c]),d=g.useCallback(async()=>{try{if(t(!0),!(a!=null&&a.main_node_id))return;const p=await de("FlowEdge").find({where:{target:a.main_node_id}}),y=(await de("FlowNode").find({where:{id:Da(p.map(v=>v.source))}})).find(v=>v.source_type===oe.LLM);if(!y)return;const m=await de("LLM").findOne({where:{id:y.source_id}});if(!m)return;a.passphrase&&await lm(a.passphrase,l.current),await s(m.provider,m.name,v=>{r(b=>b&&{...b,llm:m,progress:v.text})}),r({llm:m,status:Ge.Loaded})}finally{t(!1)}},[a==null?void 0:a.main_node_id,a==null?void 0:a.passphrase,s,l]),f=g.useCallback(async()=>{try{if(t(!0),!(n!=null&&n.llm))return;await s(n.llm.provider,n.llm.name,p=>{r(y=>y&&{...y,progress:p.text})}),r(p=>p&&{...p,status:Ge.Loaded,progress:""})}finally{t(!1)}},[s,n==null?void 0:n.llm]);return g.useEffect(()=>{a!=null&&a.main_node_id&&d()},[a==null?void 0:a.main_node_id,d]),{loading:e,mainLLMInfo:n,createMessage:u,loadCurrentModel:f}};QM=function(e,t=""){const n=[];for(const[r,a]of Object.entries(e)){const o=Ti(),i=[t,r].filter(Boolean).join("/"),s="file"in a&&"contents"in a.file?a.file:void 0,c={id:o,isSelectable:!0,content:typeof(s==null?void 0:s.contents)=="string"?s.contents:void 0,file:i,name:r,children:[]};"directory"in a&&(c.children=QM(a.directory,i)),n.push(c)}return n},Yv=function(e){const t=e.trim().split(`
`),n={};return t.forEach(r=>{const{file:a,content:o}=JSON.parse(r),i=a.split("/");let s=n;for(let c=0;c<i.length;c++){const l=i[c];c===i.length-1?s[l]={file:{contents:o}}:(s[l]||(s[l]={directory:{}}),s=s[l].directory)}}),n},Xv=function(e){const t=[];function n(r,a=[]){for(const[o,i]of Object.entries(r))if("file"in i){const s=[...a,o].join("/");if("contents"in i.file){const c=i.file.contents;t.push(JSON.stringify({file:s,content:c}))}}else"directory"in i&&n(i.directory,[...a,o])}return n(e),t.join(`
`)},e0=function(e,t){return LK(`[UpdateCodeContainerFile] Changes ${t.map(n=>`${n.type||"create_or_update"}:${n.path}`).join(", ")}`),t.forEach(({path:n,content:r,type:a="create_or_update"})=>{const o=n.replace(/^\.\//,"").split("/");let i=e;for(let s=0;s<o.length;s++){const c=o[s];if(s===o.length-1)a==="delete"?c in i&&"file"in i[c]?delete i[c]:console.warn(`Path "${n}" is not a file or does not exist.`):c in i&&"file"in i[c]?i[c].file.contents=r:i[c]={file:{contents:r}};else if(c in i&&"directory"in i[c])i=i[c].directory;else if(a==="delete"){console.warn(`Path "${n}" does not exist.`);break}else i[c]={directory:{}},i=i[c].directory}}),e};const sve=()=>{const e=Ye(i=>i.currentSession),[t,n]=g.useState(),r=g.useCallback(async(i,s)=>{await de("FlowNode").update(i,{raw:Xv(s)})},[]),a=g.useCallback(async i=>{e!=null&&e.main_node_id&&n(s=>{if(!(e!=null&&e.main_node_id))return s;const c=e0(s||{},i);return r(e==null?void 0:e.main_node_id,c),c})},[e==null?void 0:e.main_node_id,r]),o=g.useCallback(async()=>{if(!(e!=null&&e.main_node_id))return;const i=await de("FlowNode").findOne({where:{id:e==null?void 0:e.main_node_id}});i&&n(i.raw?Yv(i.raw):{})},[e==null?void 0:e.main_node_id]);return g.useEffect(()=>{e!=null&&e.main_node_id&&o()},[e==null?void 0:e.main_node_id,o]),{fileSystemTree:t,updateCodeContainerFile:a,updateCodeContainerData:r}},cve=g.lazy(()=>Ut(()=>import("./index-DIi5WtnO.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),lve=g.memo(()=>{var s,c,l,u;const{loading:e,mainLLMInfo:t,loadCurrentModel:n,createMessage:r}=ive(),{fileSystemTree:a,updateCodeContainerFile:o}=sve(),i=g.useCallback((d,f,p)=>r(d,f,p),[r]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(wu,{children:h.jsx(Na,{children:h.jsxs("div",{className:K("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(t==null?void 0:t.status)===Ge.Loaded&&((s=t==null?void 0:t.llm)!=null&&s.name)?h.jsx(fa,{name:(c=t==null?void 0:t.llm)==null?void 0:c.name,className:"w-5 h-5 mr-1"}):void 0,h.jsxs(Ma,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:[t!=null&&t.progress?t.progress:(t==null?void 0:t.status)===Ge.Loaded?((l=t==null?void 0:t.llm)==null?void 0:l.name)||"":e?h.jsx(fe,{size:16,name:"loader-circle",className:"animate-spin ml-2"}):void 0,t!=null&&t.llm&&(t==null?void 0:t.status)!==Ge.Loaded?h.jsx(fe,{size:16,name:"loader-circle",onClick:n,className:"animate-spin ml-2"}):void 0]}),h.jsx(Hr,{children:h.jsx("p",{children:(t==null?void 0:t.progress)||((u=t==null?void 0:t.llm)==null?void 0:u.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(Wl,{simple:!0}),children:a!==void 0?h.jsx(cve,{autoLoad:!0,hideAppName:!0,llm:t==null?void 0:t.llm,fileSystemTree:a,onUpdateFileContent:o,sendMessage:i}):void 0})]})});function uve(){var t,n;const e=Ye(r=>r.currentSession);if(!e)return h.jsx(Wl,{simple:!0,className:"w-full h-full"});if(e.main_source_type==="Thread")return h.jsx(tve,{});if(((t=e.main_node)==null?void 0:t.node_type)==="EDITOR_APP")return h.jsx(ove,{});if(((n=e.main_node)==null?void 0:n.node_type)==="VSLITE_APP")return h.jsx(lve,{})}var ly="Menubar",[AS,dve,fve]=Xf(ly),[P9,BRe]=ir(ly,[fve,to]),Un=Jp(),k9=to(),[pve,TS]=P9(ly),A9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,value:r,onValueChange:a,defaultValue:o,loop:i=!0,dir:s,...c}=e,l=Qo(s),u=k9(n),[d="",f]=Nn({prop:r,onChange:a,defaultProp:o}),[p,y]=g.useState(null);return h.jsx(pve,{scope:n,value:d,onMenuOpen:g.useCallback(m=>{f(m),y(m)},[f]),onMenuClose:g.useCallback(()=>f(""),[f]),onMenuToggle:g.useCallback(m=>{f(v=>v?"":m),y(m)},[f]),dir:l,loop:i,children:h.jsx(AS.Provider,{scope:n,children:h.jsx(AS.Slot,{scope:n,children:h.jsx(Jl,{asChild:!0,...u,orientation:"horizontal",loop:i,dir:l,currentTabStopId:p,onCurrentTabStopIdChange:y,children:h.jsx(Ae.div,{role:"menubar",...c,ref:t})})})})})});A9.displayName=ly;var RS="MenubarMenu",[hve,T9]=P9(RS),R9=e=>{const{__scopeMenubar:t,value:n,...r}=e,a=Tt(),o=n||a||"LEGACY_REACT_AUTO_VALUE",i=TS(RS,t),s=Un(t),c=g.useRef(null),l=g.useRef(!1),u=i.value===o;return g.useEffect(()=>{u||(l.current=!1)},[u]),h.jsx(hve,{scope:t,value:o,triggerId:Tt(),triggerRef:c,contentId:Tt(),wasKeyboardTriggerOpenRef:l,children:h.jsx(rT,{...s,open:u,onOpenChange:d=>{d||i.onMenuClose()},modal:!1,dir:i.dir,...r})})};R9.displayName=RS;var IS="MenubarTrigger",I9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,disabled:r=!1,...a}=e,o=k9(n),i=Un(n),s=TS(IS,n),c=T9(IS,n),l=g.useRef(null),u=xt(t,l,c.triggerRef),[d,f]=g.useState(!1),p=s.value===c.value;return h.jsx(AS.ItemSlot,{scope:n,value:c.value,disabled:r,children:h.jsx(Yl,{asChild:!0,...o,focusable:!r,tabStopId:c.value,children:h.jsx(aT,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",role:"menuitem",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":p,"aria-controls":p?c.contentId:void 0,"data-highlighted":d?"":void 0,"data-state":p?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:u,onPointerDown:ge(e.onPointerDown,y=>{!r&&y.button===0&&y.ctrlKey===!1&&(s.onMenuOpen(c.value),p||y.preventDefault())}),onPointerEnter:ge(e.onPointerEnter,()=>{var y;s.value&&!p&&(s.onMenuOpen(c.value),(y=l.current)==null||y.focus())}),onKeyDown:ge(e.onKeyDown,y=>{r||(["Enter"," "].includes(y.key)&&s.onMenuToggle(c.value),y.key==="ArrowDown"&&s.onMenuOpen(c.value),["Enter"," ","ArrowDown"].includes(y.key)&&(c.wasKeyboardTriggerOpenRef.current=!0,y.preventDefault()))}),onFocus:ge(e.onFocus,()=>f(!0)),onBlur:ge(e.onBlur,()=>f(!1))})})})})});I9.displayName=IS;var mve="MenubarPortal",D9=e=>{const{__scopeMenubar:t,...n}=e,r=Un(t);return h.jsx(oT,{...r,...n})};D9.displayName=mve;var DS="MenubarContent",L9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,align:r="start",...a}=e,o=Un(n),i=TS(DS,n),s=T9(DS,n),c=dve(n),l=g.useRef(!1);return h.jsx(iT,{id:s.contentId,"aria-labelledby":s.triggerId,"data-radix-menubar-content":"",...o,...a,ref:t,align:r,onCloseAutoFocus:ge(e.onCloseAutoFocus,u=>{var d;!i.value&&!l.current&&((d=s.triggerRef.current)==null||d.focus()),l.current=!1,u.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,u=>{const d=u.target;c().some(f=>{var p;return(p=f.ref.current)==null?void 0:p.contains(d)})&&u.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,()=>{l.current=!0}),onEntryFocus:u=>{s.wasKeyboardTriggerOpenRef.current||u.preventDefault()},onKeyDown:ge(e.onKeyDown,u=>{if(["ArrowRight","ArrowLeft"].includes(u.key)){const d=u.target,f=d.hasAttribute("data-radix-menubar-subtrigger"),p=d.closest("[data-radix-menubar-content]")!==u.currentTarget,y=(i.dir==="rtl"?"ArrowRight":"ArrowLeft")===u.key;if(!y&&f||p&&y)return;let m=c().filter(w=>!w.disabled).map(w=>w.value);y&&m.reverse();const v=m.indexOf(s.value);m=i.loop?Pve(m,v+1):m.slice(v+1);const[b]=m;b&&i.onMenuOpen(b)}},{checkForDefaultPrevented:!1}),style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});L9.displayName=DS;var yve="MenubarGroup",gve=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(sT,{...a,...r,ref:t})});gve.displayName=yve;var vve="MenubarLabel",$9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(cT,{...a,...r,ref:t})});$9.displayName=vve;var bve="MenubarItem",F9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(lT,{...a,...r,ref:t})});F9.displayName=bve;var wve="MenubarCheckboxItem",B9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(uT,{...a,...r,ref:t})});B9.displayName=wve;var xve="MenubarRadioGroup",_ve=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(dT,{...a,...r,ref:t})});_ve.displayName=xve;var jve="MenubarRadioItem",z9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(fT,{...a,...r,ref:t})});z9.displayName=jve;var Sve="MenubarItemIndicator",V9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(pT,{...a,...r,ref:t})});V9.displayName=Sve;var Eve="MenubarSeparator",q9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(hT,{...a,...r,ref:t})});q9.displayName=Eve;var Ove="MenubarArrow",Cve=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(mT,{...a,...r,ref:t})});Cve.displayName=Ove;var Nve="MenubarSubTrigger",U9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(yT,{"data-radix-menubar-subtrigger":"",...a,...r,ref:t})});U9.displayName=Nve;var Mve="MenubarSubContent",W9=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Un(n);return h.jsx(gT,{...a,"data-radix-menubar-content":"",...r,ref:t,style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});W9.displayName=Mve;function Pve(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var H9=A9,kve=R9,Z9=I9,Ave=D9,K9=L9,X9=$9,G9=F9,Q9=B9,J9=z9,Y9=V9,eB=q9,tB=U9,nB=W9;const LS=kve,rB=g.forwardRef(({className:e,...t},n)=>h.jsx(H9,{ref:n,className:K("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",e),...t}));rB.displayName=H9.displayName;const $S=g.forwardRef(({className:e,...t},n)=>h.jsx(Z9,{ref:n,className:K("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",e),...t}));$S.displayName=Z9.displayName;const Tve=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(tB,{ref:a,className:K("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...r,children:[n,h.jsx(fe,{name:"chevron-right",className:"ml-auto h-4 w-4"})]}));Tve.displayName=tB.displayName;const Rve=g.forwardRef(({className:e,...t},n)=>h.jsx(nB,{ref:n,className:K("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Rve.displayName=nB.displayName;const aB=g.forwardRef(({className:e,align:t="start",alignOffset:n=-4,sideOffset:r=8,...a},o)=>h.jsx(Ave,{children:h.jsx(K9,{ref:o,align:t,alignOffset:n,sideOffset:r,className:K("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));aB.displayName=K9.displayName;const oB=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(G9,{ref:r,className:K("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));oB.displayName=G9.displayName;const Ive=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(Q9,{ref:a,className:K("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(Y9,{children:h.jsx(fe,{name:"check",className:"h-4 w-4"})})}),t]}));Ive.displayName=Q9.displayName;const Dve=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(J9,{ref:r,className:K("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(Y9,{children:h.jsx(fe,{name:"circle",className:"h-2 w-2 fill-current"})})}),t]}));Dve.displayName=J9.displayName;const Lve=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(X9,{ref:r,className:K("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));Lve.displayName=X9.displayName;const $ve=g.forwardRef(({className:e,...t},n)=>h.jsx(eB,{ref:n,className:K("-mx-1 my-1 h-px bg-muted",e),...t}));$ve.displayName=eB.displayName;let iB;De=hRe()(mRe(yRe((e,t)=>({...kL,...wde(e,t)})))),iB=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.pushSyncNodeQueue),a=De(i=>i.createOrUpdateFlowNode),o=g.useCallback(async(i,s)=>{try{if(!e)throw new Error("Session not found");if(!s.provider||!s.name)throw new Error("Provider and name are required");n(!0);const c=await de("LLM").findOne({where:{name:s.name,session_id:e}});return c?(r("LLM",{where:{source_type:"LLM",source_id:c.id}}),c):de("LLM").save({name:`${s.name}`,status:s.provider===Ct.WebLLM?Ge.Started:Ge.Loaded,session_id:e,provider:s.provider,metadata:JSON.stringify(s.metadata||{}),model_type:s.model_type||ou.LLM,parameters:s.parameters||void 0,...s}).then(async l=>{var u,d,f;return await a({source_id:l.id,source_type:"LLM",node_type:oe.LLM,x:(u=i.position)==null?void 0:u.x,y:((d=i.position)==null?void 0:d.y)+(((f=i.measured)==null?void 0:f.height)||0)+30}),l})}finally{n(!1)}},[a,r,e]);return{loading:t,createLLM:o}};function vi(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e==null||e(r),n===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function sB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function cB(...e){return t=>{let n=!1;const r=e.map(a=>{const o=sB(a,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let a=0;a<r.length;a++){const o=r[a];typeof o=="function"?o():sB(e[a],null)}}}}function bi(...e){return g.useCallback(cB(...e),e)}var FS=g.forwardRef((e,t)=>{const{children:n,...r}=e,a=g.Children.toArray(n),o=a.find(Bve);if(o){const i=o.props.children,s=a.map(c=>c===o?g.Children.count(i)>1?g.Children.only(null):g.isValidElement(i)?i.props.children:null:c);return h.jsx(BS,{...r,ref:t,children:g.isValidElement(i)?g.cloneElement(i,void 0,s):null})}return h.jsx(BS,{...r,ref:t,children:n})});FS.displayName="Slot";var BS=g.forwardRef((e,t)=>{const{children:n,...r}=e;if(g.isValidElement(n)){const a=Vve(n);return g.cloneElement(n,{...zve(r,n.props),ref:t?cB(t,a):a})}return g.Children.count(n)>1?g.Children.only(null):null});BS.displayName="SlotClone";var Fve=({children:e})=>h.jsx(h.Fragment,{children:e});function Bve(e){return g.isValidElement(e)&&e.type===Fve}function zve(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...i)=>{o(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function Vve(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var qve=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],To=qve.reduce((e,t)=>{const n=g.forwardRef((r,a)=>{const{asChild:o,...i}=r,s=o?FS:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(s,{...i,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Uve(e,t){e&&Vl.flushSync(()=>e.dispatchEvent(t))}var Wve="DismissableLayer",zS="dismissableLayer.update",Hve="dismissableLayer.pointerDownOutside",Zve="dismissableLayer.focusOutside",lB,uB=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),dB=g.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:i,onDismiss:s,...c}=e,l=g.useContext(uB),[u,d]=g.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=g.useState({}),y=bi(t,E=>d(E)),m=Array.from(l.layers),[v]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),b=m.indexOf(v),w=u?m.indexOf(u):-1,_=l.layersWithOutsidePointerEventsDisabled.size>0,x=w>=b,j=Gve(E=>{const O=E.target,M=[...l.branches].some(N=>N.contains(O));!x||M||(a==null||a(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},f),S=Qve(E=>{const O=E.target;[...l.branches].some(M=>M.contains(O))||(o==null||o(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},f);return gRe(E=>{w===l.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&s&&(E.preventDefault(),s()))},f),g.useEffect(()=>{if(u)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(lB=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(u)),l.layers.add(u),fB(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=lB)}},[u,f,n,l]),g.useEffect(()=>()=>{u&&(l.layers.delete(u),l.layersWithOutsidePointerEventsDisabled.delete(u),fB())},[u,l]),g.useEffect(()=>{const E=()=>p({});return document.addEventListener(zS,E),()=>document.removeEventListener(zS,E)},[]),h.jsx(To.div,{...c,ref:y,style:{pointerEvents:_?x?"auto":"none":void 0,...e.style},onFocusCapture:vi(e.onFocusCapture,S.onFocusCapture),onBlurCapture:vi(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:vi(e.onPointerDownCapture,j.onPointerDownCapture)})});dB.displayName=Wve;var Kve="DismissableLayerBranch",Xve=g.forwardRef((e,t)=>{const n=g.useContext(uB),r=g.useRef(null),a=bi(t,r);return g.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),h.jsx(To.div,{...e,ref:a})});Xve.displayName=Kve;function Gve(e,t=globalThis==null?void 0:globalThis.document){const n=sr(e),r=g.useRef(!1),a=g.useRef(()=>{});return g.useEffect(()=>{const o=s=>{if(s.target&&!r.current){let c=function(){pB(Hve,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Qve(e,t=globalThis==null?void 0:globalThis.document){const n=sr(e),r=g.useRef(!1);return g.useEffect(()=>{const a=o=>{o.target&&!r.current&&pB(Zve,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function fB(){const e=new CustomEvent(zS);document.dispatchEvent(e)}function pB(e,t,n,{discrete:r}){const a=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?Uve(a,o):a.dispatchEvent(o)}var VS="focusScope.autoFocusOnMount",qS="focusScope.autoFocusOnUnmount",hB={bubbles:!1,cancelable:!0},Jve="FocusScope",mB=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=sr(a),u=sr(o),d=g.useRef(null),f=bi(t,m=>c(m)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let m=function(_){if(p.paused||!s)return;const x=_.target;s.contains(x)?d.current=x:wi(d.current,{select:!0})},v=function(_){if(p.paused||!s)return;const x=_.relatedTarget;x!==null&&(s.contains(x)||wi(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const x of _)x.removedNodes.length>0&&wi(s)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,p.paused]),g.useEffect(()=>{if(s){vB.add(p);const m=document.activeElement;if(!s.contains(m)){const v=new CustomEvent(VS,hB);s.addEventListener(VS,l),s.dispatchEvent(v),v.defaultPrevented||(Yve(a0e(yB(s)),{select:!0}),document.activeElement===m&&wi(s))}return()=>{s.removeEventListener(VS,l),setTimeout(()=>{const v=new CustomEvent(qS,hB);s.addEventListener(qS,u),s.dispatchEvent(v),v.defaultPrevented||wi(m??document.body,{select:!0}),s.removeEventListener(qS,u),vB.remove(p)},0)}}},[s,l,u,p]);const y=g.useCallback(m=>{if(!n&&!r||p.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,b=document.activeElement;if(v&&b){const w=m.currentTarget,[_,x]=e0e(w);_&&x?!m.shiftKey&&b===x?(m.preventDefault(),n&&wi(_,{select:!0})):m.shiftKey&&b===_&&(m.preventDefault(),n&&wi(x,{select:!0})):b===w&&m.preventDefault()}},[n,r,p.paused]);return h.jsx(To.div,{tabIndex:-1,...i,ref:f,onKeyDown:y})});mB.displayName=Jve;function Yve(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(wi(r,{select:t}),document.activeElement!==n)return}function e0e(e){const t=yB(e),n=gB(t,e),r=gB(t.reverse(),e);return[n,r]}function yB(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function gB(e,t){for(const n of e)if(!t0e(n,{upTo:t}))return n}function t0e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function n0e(e){return e instanceof HTMLInputElement&&"select"in e}function wi(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&n0e(e)&&t&&e.select()}}var vB=r0e();function r0e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=bB(e,t),e.unshift(t)},remove(t){var n;e=bB(e,t),(n=e[0])==null||n.resume()}}}function bB(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function a0e(e){return e.filter(t=>t.tagName!=="A")}var o0e="Arrow",wB=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(To.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});wB.displayName=o0e;var i0e=wB,US="Popper",[xB,_B]=ir(US),[s0e,jB]=xB(US),SB=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(s0e,{scope:t,anchor:r,onAnchorChange:a,children:n})};SB.displayName=US;var EB="PopperAnchor",OB=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=jB(EB,n),i=g.useRef(null),s=bi(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(To.div,{...a,ref:s})});OB.displayName=EB;var WS="PopperContent",[c0e,l0e]=xB(WS),CB=g.forwardRef((e,t)=>{var J,Z,U,Q,ne,z;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:y,...m}=e,v=jB(WS,n),[b,w]=g.useState(null),_=bi(t,se=>w(se)),[x,j]=g.useState(null),S=ap(x),E=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,M=r+(o!=="center"?"-"+o:""),N=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(l)?l:[l],R=P.length>0,k={padding:N,boundary:P.filter(d0e),altBoundary:R},{refs:C,floatingStyles:T,placement:A,isPositioned:I,middlewareData:L}=Sv({strategy:"fixed",placement:M,whileElementsMounted:(...se)=>uv(...se,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Ev({mainAxis:a+O,alignmentAxis:i}),c&&Ov({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Cv():void 0,...k}),c&&Nv({...k}),fv({...k,apply:({elements:se,rects:re,availableWidth:ue,availableHeight:je})=>{const{width:Le,height:$e}=re.reference,Se=se.floating.style;Se.setProperty("--radix-popper-available-width",`${ue}px`),Se.setProperty("--radix-popper-available-height",`${je}px`),Se.setProperty("--radix-popper-anchor-width",`${Le}px`),Se.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&zv({element:x,padding:s}),f0e({arrowWidth:E,arrowHeight:O}),f&&Vv({strategy:"referenceHidden",...k})]}),[D,B]=PB(A),F=sr(y);on(()=>{I&&(F==null||F())},[I,F]);const $=(J=L.arrow)==null?void 0:J.x,V=(Z=L.arrow)==null?void 0:Z.y,G=((U=L.arrow)==null?void 0:U.centerOffset)!==0,[X,H]=g.useState();return on(()=>{b&&H(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:I?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:X,"--radix-popper-transform-origin":[(Q=L.transformOrigin)==null?void 0:Q.x,(ne=L.transformOrigin)==null?void 0:ne.y].join(" "),...((z=L.hide)==null?void 0:z.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(c0e,{scope:n,placedSide:D,onArrowChange:j,arrowX:$,arrowY:V,shouldHideArrow:G,children:h.jsx(To.div,{"data-side":D,"data-align":B,...m,ref:_,style:{...m.style,animation:I?void 0:"none"}})})})});CB.displayName=WS;var NB="PopperArrow",u0e={top:"bottom",right:"left",bottom:"top",left:"right"},MB=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=l0e(NB,n),o=u0e[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(i0e,{...r,ref:t,style:{...r.style,display:"block"}})})});MB.displayName=NB;function d0e(e){return e!==null}var f0e=e=>({name:"transformOrigin",options:e,fn(t){var m,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((m=a.arrow)==null?void 0:m.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=PB(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,f=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let p="",y="";return c==="bottom"?(p=o?u:`${d}px`,y=`${-s}px`):c==="top"?(p=o?u:`${d}px`,y=`${r.floating.height+s}px`):c==="right"?(p=`${-s}px`,y=o?u:`${f}px`):c==="left"&&(p=`${r.floating.width+s}px`,y=o?u:`${f}px`),{data:{x:p,y}}}});function PB(e){const[t,n="center"]=e.split("-");return[t,n]}var p0e=SB,kB=OB,h0e=CB,m0e=MB,y0e="Portal",AB=g.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[a,o]=g.useState(!1);on(()=>o(!0),[]);const i=n||a&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return i?vRe.createPortal(h.jsx(To.div,{...r,ref:t}),i):null});AB.displayName=y0e;function g0e(e,t){return g.useReducer((n,r)=>t[n][r]??n,e)}var HS=e=>{const{present:t,children:n}=e,r=v0e(t),a=typeof n=="function"?n({present:r.isPresent}):g.Children.only(n),o=bi(r.ref,b0e(a));return typeof n=="function"||r.isPresent?g.cloneElement(a,{ref:o}):null};HS.displayName="Presence";function v0e(e){const[t,n]=g.useState(),r=g.useRef({}),a=g.useRef(e),o=g.useRef("none"),i=e?"mounted":"unmounted",[s,c]=g0e(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const l=uy(r.current);o.current=s==="mounted"?l:"none"},[s]),on(()=>{const l=r.current,u=a.current;if(u!==e){const d=o.current,f=uy(l);e?c("MOUNT"):f==="none"||(l==null?void 0:l.display)==="none"?c("UNMOUNT"):c(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),on(()=>{if(t){let l;const u=t.ownerDocument.defaultView??window,d=p=>{const y=uy(r.current).includes(p.animationName);if(p.target===t&&y&&(c("ANIMATION_END"),!a.current)){const m=t.style.animationFillMode;t.style.animationFillMode="forwards",l=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=m)})}},f=p=>{p.target===t&&(o.current=uy(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(l),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:g.useCallback(l=>{l&&(r.current=getComputedStyle(l)),n(l)},[])}}function uy(e){return(e==null?void 0:e.animationName)||"none"}function b0e(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var dy="right-scroll-bar-position",fy="width-before-scroll-bar",w0e="with-scroll-bars-hidden",x0e="--removed-body-scroll-bar-size";function ZS(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function _0e(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var j0e=typeof window<"u"?g.useLayoutEffect:g.useEffect,TB=new WeakMap;function S0e(e,t){var n=_0e(null,function(r){return e.forEach(function(a){return ZS(a,r)})});return j0e(function(){var r=TB.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||ZS(s,null)}),o.forEach(function(s){a.has(s)||ZS(s,i)})}TB.set(n,e)},[e]),n}var RB=qv(),KS=function(){},py=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:KS,onWheelCapture:KS,onTouchMoveCapture:KS}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,p=e.noIsolation,y=e.inert,m=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,_=op(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=f,j=S0e([n,t]),S=wn(wn({},_),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:RB,removeScrollBar:l,shards:d,noIsolation:p,inert:y,setCallbacks:o,allowPinchZoom:!!m,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),wn(wn({},S),{ref:j})):g.createElement(b,wn({},S,{className:c,ref:j}),s))});py.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},py.classNames={fullWidth:fy,zeroRight:dy};function E0e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Uv();return t&&e.setAttribute("nonce",t),e}function O0e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function C0e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var N0e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=E0e())&&(O0e(t,n),C0e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},M0e=function(){var e=N0e();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},P0e=function(){var e=M0e(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},k0e={left:0,top:0,right:0,gap:0},XS=function(e){return parseInt(e||"",10)||0},A0e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[XS(n),XS(r),XS(a)]},T0e=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return k0e;var t=A0e(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},R0e=P0e(),Gc="data-scroll-locked",I0e=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(w0e,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Gc,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(dy,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(fy,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(dy," .").concat(dy,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(fy," .").concat(fy,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Gc,`] {
    `).concat(x0e,": ").concat(s,`px;
  }
`)},IB=function(){var e=parseInt(document.body.getAttribute(Gc)||"0",10);return isFinite(e)?e:0},D0e=function(){g.useEffect(function(){return document.body.setAttribute(Gc,(IB()+1).toString()),function(){var e=IB()-1;e<=0?document.body.removeAttribute(Gc):document.body.setAttribute(Gc,e.toString())}},[])},L0e=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;D0e();var o=g.useMemo(function(){return T0e(a)},[a]);return g.createElement(R0e,{styles:I0e(o,!t,a,n?"":"!important")})},GS=!1;if(typeof window<"u")try{var hy=Object.defineProperty({},"passive",{get:function(){return GS=!0,!0}});window.addEventListener("test",hy,hy),window.removeEventListener("test",hy,hy)}catch{GS=!1}var Qc=GS?{passive:!1}:!1,$0e=function(e){return e.tagName==="TEXTAREA"},DB=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!$0e(e)&&n[t]==="visible")},F0e=function(e){return DB(e,"overflowY")},B0e=function(e){return DB(e,"overflowX")},LB=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=$B(e,r);if(a){var o=FB(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},z0e=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},V0e=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},$B=function(e,t){return e==="v"?F0e(t):B0e(t)},FB=function(e,t){return e==="v"?z0e(t):V0e(t)},q0e=function(e,t){return e==="h"&&t==="rtl"?-1:1},U0e=function(e,t,n,r,a){var o=q0e(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,f=0;do{var p=FB(e,s),y=p[0],m=p[1],v=p[2],b=m-v-o*y;(y||b)&&$B(e,s)&&(d+=b,f+=y),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(f)<1||!a))&&(l=!0),l},my=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},BB=function(e){return[e.deltaX,e.deltaY]},zB=function(e){return e&&"current"in e?e.current:e},W0e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},H0e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Z0e=0,Jc=[];function K0e(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(Z0e++)[0],o=g.useState(ip)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=Wv([e.lockRef.current],(e.shards||[]).map(zB),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var b=my(m),w=n.current,_="deltaX"in m?m.deltaX:w[0]-b[0],x="deltaY"in m?m.deltaY:w[1]-b[1],j,S=m.target,E=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in m&&E==="h"&&S.type==="range")return!1;var O=LB(E,S);if(!O)return!0;if(O?j=E:(j=E==="v"?"h":"v",O=LB(E,S)),!O)return!1;if(!r.current&&"changedTouches"in m&&(_||x)&&(r.current=j),!j)return!0;var M=r.current||j;return U0e(M,v,m,M==="h"?_:x,!0)},[]),c=g.useCallback(function(m){var v=m;if(!(!Jc.length||Jc[Jc.length-1]!==o)){var b="deltaY"in v?BB(v):my(v),w=t.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&W0e(j.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(zB).filter(Boolean).filter(function(j){return j.contains(v.target)}),x=_.length>0?s(v,_[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(m,v,b,w){var _={name:m,delta:v,target:b,should:w,shadowParent:X0e(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(x){return x!==_})},1)},[]),u=g.useCallback(function(m){n.current=my(m),r.current=void 0},[]),d=g.useCallback(function(m){l(m.type,BB(m),m.target,s(m,e.lockRef.current))},[]),f=g.useCallback(function(m){l(m.type,my(m),m.target,s(m,e.lockRef.current))},[]);g.useEffect(function(){return Jc.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Qc),document.addEventListener("touchmove",c,Qc),document.addEventListener("touchstart",u,Qc),function(){Jc=Jc.filter(function(m){return m!==o}),document.removeEventListener("wheel",c,Qc),document.removeEventListener("touchmove",c,Qc),document.removeEventListener("touchstart",u,Qc)}},[]);var p=e.removeScrollBar,y=e.inert;return g.createElement(g.Fragment,null,y?g.createElement(o,{styles:H0e(a)}):null,p?g.createElement(L0e,{gapMode:e.gapMode}):null)}function X0e(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const G0e=Hv(RB,K0e);var VB=g.forwardRef(function(e,t){return g.createElement(py,wn({},e,{ref:t,sideCar:G0e}))});VB.classNames=py.classNames;var QS="Popover",[qB,zRe]=ir(QS,[_B]),Vd=_B(),[Q0e,xi]=qB(QS),UB=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!1}=e,s=Vd(t),c=g.useRef(null),[l,u]=g.useState(!1),[d=!1,f]=Nn({prop:r,defaultProp:a,onChange:o});return h.jsx(p0e,{...s,children:h.jsx(Q0e,{scope:t,contentId:Tt(),triggerRef:c,open:d,onOpenChange:f,onOpenToggle:g.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:l,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:i,children:n})})};UB.displayName=QS;let JS;JS="PopoverAnchor",Bv=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=xi(JS,n),o=Vd(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:s}=a;return g.useEffect(()=>(i(),()=>s()),[i,s]),h.jsx(kB,{...o,...r,ref:t})}),Bv.displayName=JS;var WB="PopoverTrigger",YS=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=xi(WB,n),o=Vd(n),i=bi(t,a.triggerRef),s=h.jsx(To.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":GB(a.open),...r,ref:i,onClick:vi(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?s:h.jsx(kB,{asChild:!0,...o,children:s})});YS.displayName=WB;var eE="PopoverPortal",[J0e,Y0e]=qB(eE,{forceMount:void 0}),HB=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,o=xi(eE,t);return h.jsx(J0e,{scope:t,forceMount:n,children:h.jsx(HS,{present:n||o.open,children:h.jsx(AB,{asChild:!0,container:a,children:r})})})};HB.displayName=eE;var Yc="PopoverContent",ZB=g.forwardRef((e,t)=>{const n=Y0e(Yc,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,o=xi(Yc,e.__scopePopover);return h.jsx(HS,{present:r||o.open,children:o.modal?h.jsx(ebe,{...a,ref:t}):h.jsx(tbe,{...a,ref:t})})});ZB.displayName=Yc;var ebe=g.forwardRef((e,t)=>{const n=xi(Yc,e.__scopePopover),r=g.useRef(null),a=bi(t,r),o=g.useRef(!1);return g.useEffect(()=>{const i=r.current;if(i)return tu(i)},[]),h.jsx(VB,{as:FS,allowPinchZoom:!0,children:h.jsx(KB,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:vi(e.onCloseAutoFocus,i=>{var s;i.preventDefault(),o.current||((s=n.triggerRef.current)==null||s.focus())}),onPointerDownOutside:vi(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,c=s.button===0&&s.ctrlKey===!0,l=s.button===2||c;o.current=l},{checkForDefaultPrevented:!1}),onFocusOutside:vi(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),tbe=g.forwardRef((e,t)=>{const n=xi(Yc,e.__scopePopover),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(KB,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),KB=g.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onInteractOutside:u,...d}=e,f=xi(Yc,n),p=Vd(n);return nu(),h.jsx(mB,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(dB,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onDismiss:()=>f.onOpenChange(!1),children:h.jsx(h0e,{"data-state":GB(f.open),role:"dialog",id:f.contentId,...p,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),XB="PopoverClose",nbe=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=xi(XB,n);return h.jsx(To.button,{type:"button",...r,ref:t,onClick:vi(e.onClick,()=>a.onOpenChange(!1))})});nbe.displayName=XB;var rbe="PopoverArrow",abe=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Vd(n);return h.jsx(m0e,{...a,...r,ref:t})});abe.displayName=rbe;function GB(e){return e?"open":"closed"}AM=UB,qK=Bv,$M=YS,kM=HB,pv=ZB,KM=AM,KK=$M,Zv=g.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},a)=>h.jsx(kM,{children:h.jsx(pv,{ref:a,align:t,sideOffset:n,className:K("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})})),Zv.displayName=pv.displayName;var QB=1,obe=.9,ibe=.8,sbe=.17,tE=.1,nE=.999,cbe=.9999,lbe=.99,ube=/[\\\/_+.#"@\[\(\{&]/,dbe=/[\\\/_+.#"@\[\(\{&]/g,fbe=/[\s-]/,JB=/[\s-]/g;function rE(e,t,n,r,a,o,i){if(o===t.length)return a===e.length?QB:lbe;var s=`${a},${o}`;if(i[s]!==void 0)return i[s];for(var c=r.charAt(o),l=n.indexOf(c,a),u=0,d,f,p,y;l>=0;)d=rE(e,t,n,r,l+1,o+1,i),d>u&&(l===a?d*=QB:ube.test(e.charAt(l-1))?(d*=ibe,p=e.slice(a,l-1).match(dbe),p&&a>0&&(d*=Math.pow(nE,p.length))):fbe.test(e.charAt(l-1))?(d*=obe,y=e.slice(a,l-1).match(JB),y&&a>0&&(d*=Math.pow(nE,y.length))):(d*=sbe,a>0&&(d*=Math.pow(nE,l-a))),e.charAt(l)!==t.charAt(o)&&(d*=cbe)),(d<tE&&n.charAt(l-1)===r.charAt(o+1)||r.charAt(o+1)===r.charAt(o)&&n.charAt(l-1)!==r.charAt(o))&&(f=rE(e,t,n,r,l+1,o+2,i),f*tE>d&&(d=f*tE)),d>u&&(u=d),l=n.indexOf(c,l+1);return i[s]=u,u}function YB(e){return e.toLowerCase().replace(JB," ")}function pbe(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,rE(e,t,YB(e),YB(t),0,0,{})}var qd='[cmdk-group=""]',aE='[cmdk-group-items=""]',hbe='[cmdk-group-heading=""]',oE='[cmdk-item=""]',ez=`${oE}:not([aria-disabled="true"])`,iE="cmdk-item-select",ls="data-value",mbe=(e,t,n)=>pbe(e,t,n),tz=g.createContext(void 0),Ud=()=>g.useContext(tz),nz=g.createContext(void 0),sE=()=>g.useContext(nz),rz=g.createContext(void 0),az=g.forwardRef((e,t)=>{let n=el(()=>{var $,V;return{search:"",value:(V=($=e.value)!=null?$:e.defaultValue)!=null?V:"",filtered:{count:0,items:new Map,groups:new Set}}}),r=el(()=>new Set),a=el(()=>new Map),o=el(()=>new Map),i=el(()=>new Set),s=oz(e),{label:c,children:l,value:u,onValueChange:d,filter:f,shouldFilter:p,loop:y,disablePointerSelection:m=!1,vimBindings:v=!0,...b}=e,w=Tt(),_=Tt(),x=Tt(),j=g.useRef(null),S=Obe();us(()=>{if(u!==void 0){let $=u.trim();n.current.value=$,E.emit()}},[u]),us(()=>{S(6,k)},[]);let E=g.useMemo(()=>({subscribe:$=>(i.current.add($),()=>i.current.delete($)),snapshot:()=>n.current,setState:($,V,G)=>{var X,H,J;if(!Object.is(n.current[$],V)){if(n.current[$]=V,$==="search")R(),N(),S(1,P);else if($==="value"&&(G||S(5,k),((X=s.current)==null?void 0:X.value)!==void 0)){let Z=V??"";(J=(H=s.current).onValueChange)==null||J.call(H,Z);return}E.emit()}},emit:()=>{i.current.forEach($=>$())}}),[]),O=g.useMemo(()=>({value:($,V,G)=>{var X;V!==((X=o.current.get($))==null?void 0:X.value)&&(o.current.set($,{value:V,keywords:G}),n.current.filtered.items.set($,M(V,G)),S(2,()=>{N(),E.emit()}))},item:($,V)=>(r.current.add($),V&&(a.current.has(V)?a.current.get(V).add($):a.current.set(V,new Set([$]))),S(3,()=>{R(),N(),n.current.value||P(),E.emit()}),()=>{o.current.delete($),r.current.delete($),n.current.filtered.items.delete($);let G=C();S(4,()=>{R(),(G==null?void 0:G.getAttribute("id"))===$&&P(),E.emit()})}),group:$=>(a.current.has($)||a.current.set($,new Set),()=>{o.current.delete($),a.current.delete($)}),filter:()=>s.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>s.current.disablePointerSelection,listId:w,inputId:x,labelId:_,listInnerRef:j}),[]);function M($,V){var G,X;let H=(X=(G=s.current)==null?void 0:G.filter)!=null?X:mbe;return $?H($,n.current.search,V):0}function N(){if(!n.current.search||s.current.shouldFilter===!1)return;let $=n.current.filtered.items,V=[];n.current.filtered.groups.forEach(X=>{let H=a.current.get(X),J=0;H.forEach(Z=>{let U=$.get(Z);J=Math.max(U,J)}),V.push([X,J])});let G=j.current;T().sort((X,H)=>{var J,Z;let U=X.getAttribute("id"),Q=H.getAttribute("id");return((J=$.get(Q))!=null?J:0)-((Z=$.get(U))!=null?Z:0)}).forEach(X=>{let H=X.closest(aE);H?H.appendChild(X.parentElement===H?X:X.closest(`${aE} > *`)):G.appendChild(X.parentElement===G?X:X.closest(`${aE} > *`))}),V.sort((X,H)=>H[1]-X[1]).forEach(X=>{var H;let J=(H=j.current)==null?void 0:H.querySelector(`${qd}[${ls}="${encodeURIComponent(X[0])}"]`);J==null||J.parentElement.appendChild(J)})}function P(){let $=T().find(G=>G.getAttribute("aria-disabled")!=="true"),V=$==null?void 0:$.getAttribute(ls);E.setState("value",V||void 0)}function R(){var $,V,G,X;if(!n.current.search||s.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let H=0;for(let J of r.current){let Z=(V=($=o.current.get(J))==null?void 0:$.value)!=null?V:"",U=(X=(G=o.current.get(J))==null?void 0:G.keywords)!=null?X:[],Q=M(Z,U);n.current.filtered.items.set(J,Q),Q>0&&H++}for(let[J,Z]of a.current)for(let U of Z)if(n.current.filtered.items.get(U)>0){n.current.filtered.groups.add(J);break}n.current.filtered.count=H}function k(){var $,V,G;let X=C();X&&((($=X.parentElement)==null?void 0:$.firstChild)===X&&((G=(V=X.closest(qd))==null?void 0:V.querySelector(hbe))==null||G.scrollIntoView({block:"nearest"})),X.scrollIntoView({block:"nearest"}))}function C(){var $;return($=j.current)==null?void 0:$.querySelector(`${oE}[aria-selected="true"]`)}function T(){var $;return Array.from((($=j.current)==null?void 0:$.querySelectorAll(ez))||[])}function A($){let V=T()[$];V&&E.setState("value",V.getAttribute(ls))}function I($){var V;let G=C(),X=T(),H=X.findIndex(Z=>Z===G),J=X[H+$];(V=s.current)!=null&&V.loop&&(J=H+$<0?X[X.length-1]:H+$===X.length?X[0]:X[H+$]),J&&E.setState("value",J.getAttribute(ls))}function L($){let V=C(),G=V==null?void 0:V.closest(qd),X;for(;G&&!X;)G=$>0?Sbe(G,qd):Ebe(G,qd),X=G==null?void 0:G.querySelector(ez);X?E.setState("value",X.getAttribute(ls)):I($)}let D=()=>A(T().length-1),B=$=>{$.preventDefault(),$.metaKey?D():$.altKey?L(1):I(1)},F=$=>{$.preventDefault(),$.metaKey?A(0):$.altKey?L(-1):I(-1)};return g.createElement(Ae.div,{ref:t,tabIndex:-1,...b,"cmdk-root":"",onKeyDown:$=>{var V;if((V=b.onKeyDown)==null||V.call(b,$),!$.defaultPrevented)switch($.key){case"n":case"j":{v&&$.ctrlKey&&B($);break}case"ArrowDown":{B($);break}case"p":case"k":{v&&$.ctrlKey&&F($);break}case"ArrowUp":{F($);break}case"Home":{$.preventDefault(),A(0);break}case"End":{$.preventDefault(),D();break}case"Enter":if(!$.nativeEvent.isComposing&&$.keyCode!==229){$.preventDefault();let G=C();if(G){let X=new Event(iE);G.dispatchEvent(X)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:Nbe},c),yy(e,$=>g.createElement(nz.Provider,{value:E},g.createElement(tz.Provider,{value:O},$))))}),ybe=g.forwardRef((e,t)=>{var n,r;let a=Tt(),o=g.useRef(null),i=g.useContext(rz),s=Ud(),c=oz(e),l=(r=(n=c.current)==null?void 0:n.forceMount)!=null?r:i==null?void 0:i.forceMount;us(()=>{if(!l)return s.item(a,i==null?void 0:i.id)},[l]);let u=iz(a,o,[e.value,e.children,o],e.keywords),d=sE(),f=ds(S=>S.value&&S.value===u.current),p=ds(S=>l||s.filter()===!1?!0:S.search?S.filtered.items.get(a)>0:!0);g.useEffect(()=>{let S=o.current;if(!(!S||e.disabled))return S.addEventListener(iE,y),()=>S.removeEventListener(iE,y)},[p,e.onSelect,e.disabled]);function y(){var S,E;m(),(E=(S=c.current).onSelect)==null||E.call(S,u.current)}function m(){d.setState("value",u.current,!0)}if(!p)return null;let{disabled:v,value:b,onSelect:w,forceMount:_,keywords:x,...j}=e;return g.createElement(Ae.div,{ref:Wd([o,t]),...j,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!f,"data-disabled":!!v,"data-selected":!!f,onPointerMove:v||s.getDisablePointerSelection()?void 0:m,onClick:v?void 0:y},e.children)}),gbe=g.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:a,...o}=e,i=Tt(),s=g.useRef(null),c=g.useRef(null),l=Tt(),u=Ud(),d=ds(p=>a||u.filter()===!1?!0:p.search?p.filtered.groups.has(i):!0);us(()=>u.group(i),[]),iz(i,s,[e.value,e.heading,c]);let f=g.useMemo(()=>({id:i,forceMount:a}),[a]);return g.createElement(Ae.div,{ref:Wd([s,t]),...o,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&g.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:l},n),yy(e,p=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?l:void 0},g.createElement(rz.Provider,{value:f},p))))}),vbe=g.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,a=g.useRef(null),o=ds(i=>!i.search);return!n&&!o?null:g.createElement(Ae.div,{ref:Wd([a,t]),...r,"cmdk-separator":"",role:"separator"})}),bbe=g.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,a=e.value!=null,o=sE(),i=ds(u=>u.search),s=ds(u=>u.value),c=Ud(),l=g.useMemo(()=>{var u;let d=(u=c.listInnerRef.current)==null?void 0:u.querySelector(`${oE}[${ls}="${encodeURIComponent(s)}"]`);return d==null?void 0:d.getAttribute("id")},[]);return g.useEffect(()=>{e.value!=null&&o.setState("search",e.value)},[e.value]),g.createElement(Ae.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:a?e.value:i,onChange:u=>{a||o.setState("search",u.target.value),n==null||n(u.target.value)}})}),wbe=g.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...a}=e,o=g.useRef(null),i=g.useRef(null),s=Ud();return g.useEffect(()=>{if(i.current&&o.current){let c=i.current,l=o.current,u,d=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let f=c.offsetHeight;l.style.setProperty("--cmdk-list-height",f.toFixed(1)+"px")})});return d.observe(c),()=>{cancelAnimationFrame(u),d.unobserve(c)}}},[]),g.createElement(Ae.div,{ref:Wd([o,t]),...a,"cmdk-list":"",role:"listbox","aria-label":r,id:s.listId},yy(e,c=>g.createElement("div",{ref:Wd([i,s.listInnerRef]),"cmdk-list-sizer":""},c)))}),xbe=g.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:a,contentClassName:o,container:i,...s}=e;return g.createElement(Zl,{open:n,onOpenChange:r},g.createElement(Gl,{container:i},g.createElement(Ii,{"cmdk-overlay":"",className:a}),g.createElement(Di,{"aria-label":e.label,"cmdk-dialog":"",className:o},g.createElement(az,{ref:t,...s}))))}),_be=g.forwardRef((e,t)=>ds(n=>n.filtered.count===0)?g.createElement(Ae.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),jbe=g.forwardRef((e,t)=>{let{progress:n,children:r,label:a="Loading...",...o}=e;return g.createElement(Ae.div,{ref:t,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},yy(e,i=>g.createElement("div",{"aria-hidden":!0},i)))}),tr=Object.assign(az,{List:wbe,Item:ybe,Input:bbe,Group:gbe,Separator:vbe,Dialog:xbe,Empty:_be,Loading:jbe});function Sbe(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function Ebe(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function oz(e){let t=g.useRef(e);return us(()=>{t.current=e}),t}var us=typeof window>"u"?g.useEffect:g.useLayoutEffect;function el(e){let t=g.useRef();return t.current===void 0&&(t.current=e()),t}function Wd(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function ds(e){let t=sE(),n=()=>e(t.snapshot());return rp.useSyncExternalStore(t.subscribe,n,n)}function iz(e,t,n,r=[]){let a=g.useRef(),o=Ud();return us(()=>{var i;let s=(()=>{var l;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():a.current}})(),c=r.map(l=>l.trim());o.value(e,s,c),(i=t.current)==null||i.setAttribute(ls,s),a.current=s}),a}var Obe=()=>{let[e,t]=g.useState(),n=el(()=>new Map);return us(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,a)=>{n.current.set(r,a),t({})}};function Cbe(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function yy({asChild:e,children:t},n){return e&&g.isValidElement(t)?g.cloneElement(Cbe(t),{ref:t.ref},n(t.props.children)):n(t)}var Nbe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const sz=g.forwardRef(({className:e,...t},n)=>h.jsx(tr,{ref:n,className:K("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));sz.displayName=tr.displayName;const cz=g.forwardRef(({className:e,...t},n)=>h.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[h.jsx(fe,{name:"search",className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),h.jsx(tr.Input,{ref:n,className:K("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));cz.displayName=tr.Input.displayName;const lz=g.forwardRef(({className:e,...t},n)=>h.jsx(tr.List,{ref:n,className:K("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));lz.displayName=tr.List.displayName;const uz=g.forwardRef((e,t)=>h.jsx(tr.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));uz.displayName=tr.Empty.displayName;const dz=g.forwardRef(({className:e,...t},n)=>h.jsx(tr.Group,{ref:n,className:K("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));dz.displayName=tr.Group.displayName;const Mbe=g.forwardRef(({className:e,...t},n)=>h.jsx(tr.Separator,{ref:n,className:K("-mx-1 h-px bg-border",e),...t}));Mbe.displayName=tr.Separator.displayName;const gy=g.forwardRef(({className:e,...t},n)=>h.jsx(tr.Item,{ref:n,className:K("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...t}));gy.displayName=tr.Item.displayName;const Pbe=Ja("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Va=g.forwardRef(({className:e,variant:t,...n},r)=>h.jsx("div",{ref:r,role:"alert",className:K(Pbe({variant:t}),e),...n}));Va.displayName="Alert";const Ro=g.forwardRef(({className:e,...t},n)=>h.jsx("h5",{ref:n,className:K("mb-1 font-medium leading-none tracking-tight",e),...t}));Ro.displayName="AlertTitle";const tl=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:K("text-sm [&_p]:leading-relaxed",e),...t}));tl.displayName="AlertDescription";const kbe=Ya(({onConfirm:e,onCancel:t})=>{const n=Jt(),{t:r}=Pe("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{e(a),o("")},c=()=>{t(),n.hide(),o("")};return h.jsx(ii,{open:n.visible,onOpenChange:c,children:h.jsxs(lo,{className:"w-[330px]",children:[h.jsxs(uo,{children:[h.jsx(fo,{children:r("create_session_passkey.title")}),h.jsx(Eu,{children:r("create_session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(F_,{onChange:i,maxLength:6,children:[h.jsxs(gd,{children:[h.jsx(yr,{index:0,hidden:!0}),h.jsx(yr,{index:1,hidden:!0}),h.jsx(yr,{index:2,hidden:!0})]}),h.jsx(B_,{}),h.jsxs(gd,{children:[h.jsx(yr,{index:3,hidden:!0}),h.jsx(yr,{index:4,hidden:!0}),h.jsx(yr,{index:5,hidden:!0})]})]})}),h.jsx(Su,{children:h.jsx(ut,{onClick:s,type:"submit",children:r("create_session_passkey.confirm")})})]})})}),Abe=()=>{const[e,t]=g.useState(!1),n=Ye(o=>o.currentSession),r=Ye(o=>o.setCurrentSession),a=g.useCallback(async o=>{if(!(!n||!o))try{t(!0);const i=await Ide(),s=await BL(i,o);await de("Session").update(n.id,{passphrase:s});const c=await de("Session").findOne({where:{id:n.id}});return c&&r(c),{passphrase:i,encrypted:s}}finally{t(!1)}},[n,r]);return{loading:e,updateSessionPassphrase:a}},Tbe=[Ct.WebLLM,Ct.OpenAI,Ct.Groq],Rbe=["gpt-4o","gpt-4o-mini","gpt-4-turbo","gpt-4","gpt-3.5-turbo"],Ibe=["deepseek-r1-distill-llama-70b","llama-3.2-90b-vision-preview","llama-3.3-70b-versatile","llama-3.3-70b-specdec","llama3-70b-8192","gemma2-9b-it","llama3-8b-8192","mixtral-8x7b-32768"],Dbe=["llama-3.2-90b-vision-preview"];function Lbe(e){var G,X;const{id:t,setDialog:n}=e,{t:r}=Pe("components"),{toast:a}=Yt(),o=$n(t),[i,s]=g.useState(!1),[c,l]=g.useState(""),[u,d]=g.useState(!1),[f,p]=g.useState(""),[y,m]=g.useState(),[v,b]=g.useState(Ct.WebLLM),[w,_]=g.useState(!1),[x,j]=g.useState(),{updateSessionPassphrase:S}=Abe(),E=Ye(H=>H.currentSession),O=Qa(H=>H.syncCachedLLMURLs),M=Qa(H=>H.cachedLLMURLs),{loading:N,createLLM:P}=iB(),{modalRef:R}=Sc(kbe),{modalRef:k}=Sc(vd);g.useEffect(()=>{Ut(()=>import("./index-D2o0-Nmt.js").then(async H=>(await H.__tla,H)),__vite__mapDeps([9,1,2,3,4])).then(async({functionCallingModelIds:H,prebuiltAppConfig:J})=>{const Z=J.model_list;j({modelList:Z,functionCallingModelIds:H})})},[]),g.useEffect(()=>{O()},[O]);const C=g.useMemo(()=>c?v!==Ct.WebLLM:!1,[c,v]),T=g.useMemo(()=>!(x!=null&&x.functionCallingModelIds)||!(x!=null&&x.modelList)?[]:((f?x==null?void 0:x.modelList.filter(H=>H.model_id.toLowerCase().includes(f.toLowerCase())):x==null?void 0:x.modelList)||[]).sort((H,J)=>{const Z=M.some(re=>re.includes(H.model_id)),U=M.some(re=>re.includes(J.model_id));if(Z&&!U)return-1;if(!Z&&U)return 1;const Q=rS.includes(H.model_id),ne=rS.includes(J.model_id);if(Q&&!ne)return-1;if(!Q&&ne)return 1;const z=x==null?void 0:x.functionCallingModelIds.includes(H.model_id),se=x==null?void 0:x.functionCallingModelIds.includes(J.model_id);return z&&!se?-1:!z&&se?1:H.vram_required_MB&&J.vram_required_MB&&H.vram_required_MB!==J.vram_required_MB?H.vram_required_MB-J.vram_required_MB:H.model_id.localeCompare(J.model_id)}),[x==null?void 0:x.modelList,x==null?void 0:x.functionCallingModelIds,f,M]),A=g.useMemo(()=>{if(c)switch(v){case Ct.WebLLM:return(x==null?void 0:x.modelList)&&T.find(H=>H.model_id===c);case Ct.Groq:return m({}),{model:c,model_id:c,model_type:Dbe.includes(c)?2:0,overrides:{}};case Ct.OpenAI:return m({}),{model:c,model_id:c,model_type:2,overrides:{}}}},[c,x==null?void 0:x.modelList,T,v]);g.useEffect(()=>{!(A!=null&&A.model_id)||!M||_(M.some(H=>H.includes(A.model_id)))},[M,A==null?void 0:A.model_id]),g.useEffect(()=>{E!=null&&E.id&&(b(Ct.WebLLM),l(""),p(""),m({}))},[E==null?void 0:E.id]);const I=g.useCallback(H=>{l(H),d(!1)},[]),L=g.useCallback(H=>{p(H)},[]),D=g.useCallback(H=>{b(H),l(""),p(""),m({})},[]),B=async()=>{var H;if(!(!o||!E))try{s(!0);let J="",Z;if(C&&!E.passphrase){await new Promise((Q,ne)=>{R.current.show({onConfirm:z=>{J=z,R.current.hide(),Q(void 0)},onCancel:()=>{ne()}})});const U=await S(J);if(!U||!Object.keys(y||{}).length)throw new Error("Failed to update session passphrase");await Gf.set("passphrase",U.passphrase),Z=await zL(y||{},U.passphrase)}else if(C&&E.passphrase){const U=await lm(E.passphrase,k.current);Z=await zL(y||{},U)}await P(o,{name:c,model_type:F(A==null?void 0:A.model_type),function_calling:A!=null&&A.model_id?(H=x==null?void 0:x.functionCallingModelIds)==null?void 0:H.includes(A==null?void 0:A.model_id):!1,parameters:Z,provider:v}),n==null||n(!1)}catch(J){ks(J),a({variant:"destructive",description:r("add_llm_card.errors.failed_to_create")})}finally{s(!1),b(Ct.WebLLM),m({}),l(""),p("")}},F=g.useCallback(H=>H===1?ou.embedding:H===2?ou.VLM:ou.LLM,[]),$=g.useMemo(()=>{switch(v){case Ct.WebLLM:return T.map(H=>{var J;return h.jsxs(gy,{value:H.model_id,onSelect:I,children:[c===H.model_id?h.jsx(fe,{name:"check",className:"mr-2 h-4 w-4"}):h.jsx("div",{className:"mr-2 h-4 w-4"}),h.jsxs("span",{className:"max-w-md",children:[h.jsxs("div",{className:"flex gap-2 mb-2",children:[h.jsx(fa,{name:H.model_id}),H.model_id]}),h.jsx("div",{className:"flex max-w-full flex-wrap gap-1",children:h.jsx(Fd,{model:H,isFunctionCalling:((J=x==null?void 0:x.functionCallingModelIds)==null?void 0:J.includes(H.model_id))||!1,name:H.model_id,isCached:M.some(Z=>Z.includes(H.model_id))||!1})})]})]},H.model_id)});case Ct.OpenAI:return Rbe.map(H=>h.jsxs(gy,{value:H,onSelect:I,children:[c===H?h.jsx(fe,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(fa,{name:H}),H]})})]},H));case Ct.Groq:return Ibe.map(H=>h.jsxs(gy,{value:H,onSelect:I,children:[c===H?h.jsx(fe,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(fa,{name:H}),H]})})]},H))}},[M,I,c,x==null?void 0:x.functionCallingModelIds,T,v]),V=g.useMemo(()=>{if(C)switch(v){case Ct.Groq:case Ct.OpenAI:return h.jsxs(h.Fragment,{children:[h.jsx(Va,{variant:"destructive",className:"mt-4",children:r("add_llm_card.alert.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(nt,{children:r("add_llm_card.encrypted_fields.api_key")}),h.jsx(Mn,{type:"password",value:(y==null?void 0:y.key)||"",onChange:H=>m(J=>({...J,key:H.target.value}))})]})]})}},[C,v,r,y]);return h.jsxs(Qt,{className:"max-w-lg",children:[h.jsx(Vn,{children:h.jsx(Yn,{children:r("add_llm_card.title")})}),h.jsxs(qn,{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(nt,{children:r("add_llm_card.provider")}),h.jsxs(Po,{value:v,onValueChange:D,children:[h.jsx(Ba,{className:"w-full mb-4",children:h.jsx(ko,{placeholder:r("add_llm_card.provider_select_placeholder")})}),h.jsx(za,{children:Object.values(Tbe).map(H=>h.jsx(er,{value:H,children:r(`add_llm_card.providers.${H.toLowerCase()}`)},H))})]}),h.jsx(nt,{children:r("add_llm_card.model_name")}),h.jsxs(KM,{open:u,onOpenChange:d,children:[h.jsx(YS,{asChild:!0,children:h.jsxs(ut,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between",children:[c?A==null?void 0:A.model_id:r("add_llm_card.select_model_placeholder"),h.jsx(fe,{name:"chevrons-up-down",className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),h.jsx(Zv,{className:"w-full p-0",children:h.jsxs(sz,{children:[h.jsx(cz,{onValueChange:L,placeholder:r("add_llm_card.search_placeholder")}),h.jsxs(lz,{children:[h.jsx(uz,{children:r("add_llm_card.no_model")}),h.jsx(dz,{children:$})]})]})})]})]}),A?h.jsxs("div",{className:"mt-4",children:[h.jsxs("div",{className:"mt-4 text-sm text-muted-foreground center flex max-w-full flex-wrap gap-1",children:[h.jsx(fa,{name:A.model_id,className:"mr-2"}),h.jsx(Fd,{model:A,isFunctionCalling:((G=x==null?void 0:x.functionCallingModelIds)==null?void 0:G.includes(A.model_id))||!1,name:A.model_id,isCached:M.some(H=>H.includes(A.model_id))||!1})]}),h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_url")}),A.model]}),A.model_lib?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_lib_url")}),A.model_lib]}):void 0,A.overrides&&((X=Object.keys(A.overrides))!=null&&X.length)?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.metadata")}),JSON.stringify(A.overrides)]}):void 0]}):null,V]}),h.jsx(mi,{className:"flex justify-between",children:h.jsx(Zn,{loading:N||i,disabled:!(c!=null&&c.length),onClick:B,className:"w-full",children:r(w?"add_llm_card.button_add":"add_llm_card.button_download_and_add")})})]})}const fz=()=>{const e=Ye(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=De(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i)=>{var s,c,l;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const u=((s=o.position)==null?void 0:s.x)||0,d=(((c=o.position)==null?void 0:c.y)||0)+(((l=o.measured)==null?void 0:l.height)||0),f=await de("Prompt").save({content:i.content,prefix:i.prefix,role:i.role||cr.System,status:Br.Started,session_id:e,type:i.type||lr.Chat});if(!f)throw new Error("Failed to save prompt");if(!await r({source_id:f.id,source_type:"Prompt",node_type:oe.Prompt,x:u,y:d+20}))throw new Error("Failed to save prompt node")}finally{n(!1)}},[e,r]);return{loading:t,createPrompt:a}},$be={[lr.Chat]:{label:"add_prompt_card.prompt_types.chat",value:lr.Chat},[lr.FewShotExample]:{label:"add_prompt_card.prompt_types.few_shot_example",value:lr.FewShotExample}},Fbe={[cr.System]:{label:"add_prompt_card.prompt_roles.system",value:cr.System},[cr.Human]:{label:"add_prompt_card.prompt_roles.human",value:cr.Human},[cr.AI]:{label:"add_prompt_card.prompt_roles.ai",value:cr.AI}},cE=g.memo(({defaultPromptContent:e,defaultPromptRole:t,defaultPromptType:n,hidePromptRole:r,hidePromptType:a,loading:o,onSubmit:i})=>{const[s,c]=g.useState(e||""),[l,u]=g.useState(n||lr.Chat),[d,f]=g.useState(t),[p,y]=g.useState(""),{t:m}=Pe("components"),v=g.useCallback(j=>{c(j.target.value)},[]),b=g.useCallback(j=>{y(j.target.value)},[]),w=g.useCallback(j=>{j===lr.FewShotExample&&c(`Question: {input}
Answer: {output}`),u(j)},[]),_=g.useCallback(j=>{f(j)},[]),x=async()=>{await i({content:s,role:d,prefix:p,type:l})&&(c(""),f(void 0),u("chat"),y(""))};return h.jsxs("div",{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[a?void 0:h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_type")}),h.jsxs(Po,{value:l,onValueChange:w,children:[h.jsx(Ba,{className:"w-full mb-4",children:h.jsx(ko,{placeholder:m("add_prompt_card.type_select_placeholder")})}),h.jsx(za,{children:Object.values($be).map(j=>h.jsx(er,{value:j.value,children:m(j.label)},j.value))})]})]}),r?void 0:h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_role")}),h.jsxs(Po,{value:d,onValueChange:_,children:[h.jsx(Ba,{className:"w-full mb-4",children:h.jsx(ko,{placeholder:m("add_prompt_card.role_select_placeholder")})}),h.jsx(za,{children:Object.values(Fbe).map(j=>h.jsx(er,{value:j.value,children:m(j.label)},j.value))})]})]}),l===lr.FewShotExample&&h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_prefix")}),h.jsx(vo,{value:p,onChange:b,disabled:!1,className:"h-20",placeholder:m("add_prompt_card.placeholder"),id:"message"}),h.jsx(nt,{children:m("add_prompt_card.prompt_content")}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm justify-end items-center",children:[h.jsx(fe,{name:"info",className:"mr-2",size:14}),m("add_prompt_card.few_shot_example_note")]})]}),h.jsx(vo,{value:s,onChange:v,disabled:!1,placeholder:m("add_prompt_card.placeholder"),id:"message"})]}),h.jsx("div",{children:h.jsx(Zn,{loading:o,disabled:!(s!=null&&s.length),onClick:x,className:"w-full mt-4",children:m("add_prompt_card.button")})})]})}),Bbe=g.memo(e=>{const{id:t,thread:n,setDialog:r}=e,{t:a}=Pe("components"),{toast:o}=Yt(),i=$n(t),{createPrompt:s,loading:c}=fz(),l=async u=>{if(i)try{if(!(u!=null&&u.content))throw new Error("Prompt data is missing");await s(i,{...u,content:u.content,thread:n}),r==null||r(!1)}catch(d){o({variant:"destructive",title:`${d}`})}};return h.jsxs(Qt,{className:"mw-full",children:[h.jsx(Vn,{children:h.jsx(Yn,{children:a("add_prompt_card.title")})}),h.jsx(qn,{children:h.jsx(cE,{onSubmit:l,loading:c,defaultPromptRole:"system",defaultPromptType:"chat"})})]})}),zbe=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=g.useCallback((i,s,c,l)=>{var u;if(e){for(const d of s)(u=d.data)!=null&&u.length?a(i,d.data,c,d.id):c.push({name:d.name,type:d.type,enum:d.enum?JSON.stringify(d.enum):"",required:d.required,description:d.description,id:d.id||Mu(),parent_id:l,schema_id:i,session_id:e});return c}},[e]),o=g.useCallback(async(i,s)=>{var c,l,u;try{if(!i||!e)throw new Error("Source or Session not found");n(!0);const d=((c=i.position)==null?void 0:c.x)||0,f=(((l=i.position)==null?void 0:l.y)||0)+(((u=i.measured)==null?void 0:u.height)||0),p=await de("Schema").save({name:"Untitled Schema",session_id:e});if(!p)throw new Error("Failed to save schema");const y=a(p.id,s,[],void 0);if(!(y!=null&&y.length))throw new Error("Failed to convert schema items");if(await de("SchemaItem").save(y),!await r({source_id:p.id,source_type:"Schema",node_type:oe.Schema,x:d,y:f+20}))throw new Error("Failed to save schema node")}finally{n(!1)}},[e,a,r]);return{loading:t,createSchema:o}};var lE="Checkbox",[Vbe,VRe]=ir(lE),[qbe,Ube]=Vbe(lE),pz=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:o,required:i,disabled:s,value:c="on",onCheckedChange:l,form:u,...d}=e,[f,p]=g.useState(null),y=xt(t,x=>p(x)),m=g.useRef(!1),v=f?u||!!f.closest("form"):!0,[b=!1,w]=Nn({prop:a,defaultProp:o,onChange:l}),_=g.useRef(b);return g.useEffect(()=>{const x=f==null?void 0:f.form;if(x){const j=()=>w(_.current);return x.addEventListener("reset",j),()=>x.removeEventListener("reset",j)}},[f,w]),h.jsxs(qbe,{scope:n,state:b,disabled:s,children:[h.jsx(Ae.button,{type:"button",role:"checkbox","aria-checked":_i(b)?"mixed":b,"aria-required":i,"data-state":yz(b),"data-disabled":s?"":void 0,disabled:s,value:c,...d,ref:y,onKeyDown:ge(e.onKeyDown,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:ge(e.onClick,x=>{w(j=>_i(j)?!0:!j),v&&(m.current=x.isPropagationStopped(),m.current||x.stopPropagation())})}),v&&h.jsx(Wbe,{control:f,bubbles:!m.current,name:r,value:c,checked:b,required:i,disabled:s,form:u,style:{transform:"translateX(-100%)"},defaultChecked:_i(o)?!1:o})]})});pz.displayName=lE;var hz="CheckboxIndicator",mz=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,o=Ube(hz,n);return h.jsx(Ir,{present:r||_i(o.state)||o.state===!0,children:h.jsx(Ae.span,{"data-state":yz(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});mz.displayName=hz;var Wbe=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:a,...o}=e,i=g.useRef(null),s=eF(n),c=ap(t);g.useEffect(()=>{const u=i.current,d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"checked").set;if(s!==n&&f){const p=new Event("click",{bubbles:r});u.indeterminate=_i(n),f.call(u,_i(n)?!1:n),u.dispatchEvent(p)}},[s,n,r]);const l=g.useRef(_i(n)?!1:n);return h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??l.current,...o,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function _i(e){return e==="indeterminate"}function yz(e){return _i(e)?"indeterminate":e?"checked":"unchecked"}mv=pz,IM=mz;const gz=g.forwardRef(({className:e,...t},n)=>h.jsx(mv,{ref:n,className:K("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:h.jsx(IM,{className:K("flex items-center justify-center text-current"),children:h.jsx(fe,{name:"check",className:"h-4 w-4"})})}));gz.displayName=mv.displayName;const vz=g.memo(({setData:e,data:t,id:n})=>{const{t:r}=Pe("components"),[a,o]=g.useState({name:"",description:"",type:"string",required:!1,data:[]}),i=g.useMemo(()=>n&&t.find(m=>m.id===n)||a,[t,a,n]),s=g.useCallback(m=>{m.target.value&&!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(m.target.value)||(n?e(v=>[...v.map(b=>b.id===n?{...b,name:m.target.value||""}:b)]):o(v=>({...v,name:m.target.value||""})))},[n,e]),c=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,description:m.target.value||""}:b)]):o(v=>({...v,description:m.target.value||""}))},[n,e]),l=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,type:m||""}:b)]):o(v=>({...v,type:m||"string"}))},[n,e]),u=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,required:!!m||!1}:b)]):o(v=>({...v,required:!!m||!1}))},[n,e]),d=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,enum:m.target.value||""}:b)]):o(v=>({...v,enum:m.target.value||""}))},[n,e]),f=g.useCallback(()=>{if(t.find(m=>m.name===a.name))return Hl({variant:"destructive",content:"Name already exists"});a.id=Mu(),e(m=>[...m,{...a}]),o({name:"",description:"",type:"string",required:!1,id:Mu(),parent:n||void 0,data:[]})},[t,a,e,n]),p=g.useCallback(m=>{e(v=>[...v.map(b=>b.id===n?{...b,data:m(b.data||[])}:b)])},[n,e]),y=["object","array"].includes(i.type);return h.jsxs("div",{className:"w-full p-1",children:[h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.name")}),h.jsx(Mn,{id:"name",onChange:s,placeholder:r("add_schema_card.field.name_placeholder"),value:(i==null?void 0:i.name)||""})]}),h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.description")}),h.jsx(Mn,{id:"description",placeholder:r("add_schema_card.field.description_placeholder"),onChange:c,value:(i==null?void 0:i.description)||""})]}),h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.type")}),h.jsxs(Po,{onValueChange:l,value:(i==null?void 0:i.type)||"",children:[h.jsx(Ba,{children:h.jsx(ko,{placeholder:r("add_schema_card.field.type_placeholder")})}),h.jsxs(za,{children:[h.jsx(er,{value:"string",children:r("add_schema_card.types.string")}),h.jsx(er,{value:"boolean",children:r("add_schema_card.types.boolean")}),h.jsx(er,{value:"number",children:r("add_schema_card.types.number")}),h.jsx(er,{value:"object",children:r("add_schema_card.types.object")}),h.jsx(er,{value:"array",children:r("add_schema_card.types.array")})]})]})]}),h.jsxs("div",{className:"flex items-center h-10",children:[h.jsx(nt,{children:r("add_schema_card.field.required")}),h.jsx(gz,{className:"ml-2","aria-label":"Select row",onCheckedChange:u,checked:i==null?void 0:i.required})]}),y?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(nt,{children:r("add_schema_card.children")}),h.jsx(bz,{data:(i==null?void 0:i.data)||[],setData:p})]}):null,(i==null?void 0:i.type)==="enum"?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(nt,{children:r("add_schema_card.field.enum")}),h.jsx(Mn,{id:"enum",onChange:d,placeholder:"Enum"})]}):null,n?null:h.jsx("div",{className:"w-full flex justify-end mt-2",children:h.jsx(ut,{variant:"secondary",disabled:!i.name||!i.description||!i.type,onClick:f,className:"w-full",children:r("add_schema_card.field.add_field")})})]})}),bz=g.memo(({data:e,setData:t})=>h.jsxs(GF,{type:"single",collapsible:!0,children:[e.map(n=>h.jsxs(gS,{value:`${n.id}`,children:[h.jsx(vS,{children:n.name}),h.jsx(bS,{children:h.jsx(vz,{setData:t,data:e,id:n.id})})]},n.id||"new")),h.jsx(Qt,{className:"p-2 mt-4",children:h.jsx(vz,{setData:t,data:e})})]})),Hbe=g.memo(e=>{const{t}=Pe("components"),{id:n}=e,r=$n(n),[a,o]=g.useState([]),{createSchema:i,loading:s}=zbe(),c=async()=>{if(r&&(a!=null&&a.length))try{await i(r,a),o([])}catch(l){Hl({variant:"destructive",title:`${l}`})}};return h.jsxs(Qt,{className:"max-w-lg",children:[h.jsx(Vn,{children:h.jsx(Yn,{children:t("add_schema_card.title")})}),h.jsx(qn,{className:"min-w-96",children:h.jsx(bz,{setData:o,data:a})}),h.jsx(mi,{className:"flex justify-between",children:h.jsx(Zn,{loading:s,disabled:!(a!=null&&a.length),onClick:c,className:"w-full",children:t("add_schema_card.create")})})]})}),wz=()=>{const e=Ye(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=De(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i,s)=>{var c,l,u;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const d=((c=o.position)==null?void 0:c.x)||0,f=(((l=o.position)==null?void 0:l.y)||0)+(((u=o.measured)==null?void 0:u.height)||0),p=bRe(i,s),y=await de("CSVData").save({headers:p.headers,csv:p.data,session_id:e});if(!y)throw new Error("Failed to save");if(!await r({source_id:y.id,source_type:"CSVData",node_type:oe.CSVData,x:d,y:f+20}))throw new Error("Failed to save node")}finally{n(!1)}},[e,r]);return{loading:t,createCSVData:a}};function Zbe({data:e}){const{t}=Pe("components");return h.jsxs(ay,{className:"w-full",children:[h.jsx(oy,{children:h.jsxs(cs,{children:[h.jsx(Zc,{children:t("add_few_shot_example_card.input")}),h.jsx(Zc,{children:t("add_few_shot_example_card.output")})]})}),h.jsx(iy,{children:e==null?void 0:e.map((n,r)=>h.jsxs(cs,{children:[h.jsx(Kc,{className:"p-4",children:n.input}),h.jsx(Kc,{className:"p-4",children:n.output})]},`${n.input}_${n.output}_${r}`))})]})}const Kbe=g.memo(e=>{const{id:t}=e,{t:n}=Pe("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),[s,c]=g.useState(""),l=$n(t),{createCSVData:u,loading:d}=wz(),f=()=>{a(y=>[...y,{input:o,output:s}]),i(""),c("")},p=async()=>{l&&await u(l,["input","output"],r.map(y=>[y.input,y.output]))};return h.jsxs(Qt,{className:"mw-full",children:[h.jsx(Vn,{children:h.jsx(Yn,{children:n("add_few_shot_example_card.title")})}),h.jsxs(qn,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{htmlFor:"name",children:n("add_few_shot_example_card.input")}),h.jsx(Mn,{value:o,onChange:y=>i(y.target.value||""),id:"name",placeholder:n("add_few_shot_example_card.input_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("add_few_shot_example_card.output")}),h.jsx(vo,{value:s,onChange:y=>c(y.target.value||""),placeholder:n("add_few_shot_example_card.output_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(ut,{disabled:!o||!s,onClick:f,className:"w-40",children:n("add_few_shot_example_card.add")})}),h.jsx(Zbe,{data:r||[]})]}),h.jsx(mi,{className:"flex justify-between",children:h.jsx(Zn,{loading:d,disabled:!(r!=null&&r.length),onClick:p,className:"w-full",children:n("add_few_shot_example_card.create")})})]})}),Xbe=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!i||!e)throw new Error("Source or Session not found");if(!s.name||!s.description)throw new Error("Name is required");n(!0);const f=((l=i.position)==null?void 0:l.x)||0,p=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),y=await de("ToolDefinition").save({...s,name:`${s.name}`,description:`${s.description}`,session_id:e});if(!y)throw new Error("Failed create tool.");const m=await r({source_id:y.id,source_type:"ToolDefinition",node_type:oe.ToolDefinition,x:f,y:p+20});if(!m)throw new Error("Failed to save node");c!=null&&c.schemaNode&&await a({source:c.schemaNode.id,target:m.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createTool:o}},Gbe=g.memo(e=>{const{t}=Pe("components"),{toast:n}=Yt(),{id:r}=e,a=$n(r),[o,i]=g.useState(""),[s,c]=g.useState(""),{createTool:l,loading:u}=Xbe(),d=y=>{i(y.target.value)},f=y=>{c(y.target.value)},p=async()=>{if(a&&o&&s)try{await l(a,{name:o,description:s}),i(""),c("")}catch(y){Ko(y),n({variant:"destructive",title:t("add_tool_card.errors.create_tool_failed")})}};return h.jsxs(Qt,{className:"mw-full",children:[h.jsx(Vn,{children:h.jsx(Yn,{children:t("add_tool_card.title")})}),h.jsxs(qn,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{htmlFor:"name",children:t("add_tool_card.tool_name")}),h.jsx(Mn,{onChange:d,id:"name",placeholder:t("add_tool_card.name_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:t("add_tool_card.tool_description")}),h.jsx(vo,{onChange:f,placeholder:t("add_tool_card.description_placeholder")})]})]}),h.jsx(mi,{className:"flex justify-between",children:h.jsx(Zn,{loading:u,onClick:p,className:"w-full",children:t("add_tool_card.create")})})]})}),Qbe=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!(s!=null&&s.name)||!i||!e)throw new Error("Source or Session not found");n(!0);const f=((l=i.position)==null?void 0:l.x)||0,p=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),y=await de("VectorDatabase").save({...s,name:`${s.name}`,type:s.type||wRe.Local,storage:s.storage||Lr.DatabaseNode,raw:"",provider:s.provider||$K.Memory,session_id:e,metadata:c?JSON.stringify({textSplitter:c}):void 0});if(!y)throw new Error("Failed to save vectorDatabase");const m=await r({source_id:y.id,source_type:"VectorDatabase",node_type:oe.VectorDatabase,x:f,y:p+30});if(!m)throw new Error("Failed to save vectorDatabase node");if(s.storage===Lr.DataNode){const v=await de("JSONLData").save({headers:xRe(["content","embedding","metadata"]),jsonl:"",session_id:e});if(!v)throw new Error("Failed to save databaseSource");const b=await r({source_id:v.id,source_type:"JSONLData",node_type:oe.JSONLData,x:f+80,y:p+30});if(!b)throw new Error("Failed to save databaseSource node");await a({source:b.id,target:m.id})}return{vectorDatabase:y,vectorDatabaseNode:m}}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabase:o}},Hd=[$K.Memory],Zd=[Lr.DatabaseNode],Jbe=["TokenTextSplitter","CharacterTextSplitter","RecursiveCharacterTextSplitter"],Ybe=g.memo(e=>{const{t}=Pe("components"),{id:n}=e,r=$n(n),{toast:a}=Yt(),[o,i]=g.useState(""),[s,c]=g.useState(Hd[0]),[l,u]=g.useState(Zd[0]),[d,f]=g.useState({}),{loading:p,createVectorDatabase:y}=Qbe(),m=g.useCallback(S=>{c(S)},[]),v=g.useCallback(S=>{u(S)},[]),b=g.useCallback(S=>{f(E=>({...E,type:S,chunkSize:500,chunkOverlap:40}))},[]),w=g.useCallback(S=>{i(S.target.value||"")},[]),_=g.useCallback(S=>{f(E=>({...E,chunkSize:Number(S.target.value)}))},[]),x=g.useCallback(S=>{f(E=>({...E,chunkOverlap:Number(S.target.value)}))},[]),j=async()=>{try{if(!r)return;await y(r,{name:o,provider:s,storage:l},d!=null&&d.type?{type:d.type,chunkSize:d.chunkSize||500,chunkOverlap:d.chunkOverlap||0}:void 0),i(""),f({})}catch{a({variant:"destructive",description:t("create_vector_database_card.errors.create_failed")})}};return h.jsxs(Qt,{className:"mw-full",children:[h.jsx(Vn,{children:h.jsx(Yn,{children:t("create_vector_database_card.title")})}),h.jsx(qn,{children:h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(nt,{children:t("create_vector_database_card.name")}),h.jsx(Mn,{className:"mb-4",value:o,onChange:w}),(Zd==null?void 0:Zd.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:t("create_vector_database_card.storage_type")}),h.jsxs(Po,{value:l,onValueChange:v,children:[h.jsx(Ba,{className:"w-full mb-4",children:h.jsx(ko,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(za,{children:Object.values(Zd).map(S=>h.jsx(er,{value:S,children:t(`create_vector_database_card.storage_types.${S.toLowerCase()}`)},S))})]})]}):void 0,(Hd==null?void 0:Hd.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:t("create_vector_database_card.provider")}),h.jsxs(Po,{value:s,onValueChange:m,children:[h.jsx(Ba,{className:"w-full mb-4",children:h.jsx(ko,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(za,{children:Object.values(Hd).map(S=>h.jsx(er,{value:S,children:t(`create_vector_database_card.providers.${S.toLowerCase()}`)},S))})]})]}):void 0,h.jsx(nt,{children:t("create_vector_database_card.text_splitter")}),h.jsxs(Po,{value:d.type,onValueChange:b,children:[h.jsx(Ba,{className:"w-full mb-4",children:h.jsx(ko,{placeholder:t("create_vector_database_card.text_splitter_select_placeholder")})}),h.jsx(za,{children:Object.values(Jbe).map(S=>h.jsx(er,{value:S,children:t(`create_vector_database_card.text_splitters.${S.toLowerCase()}`)},S))})]}),d.type?h.jsxs(Qt,{children:[h.jsx(Vn,{children:h.jsx(Yn,{children:t("create_vector_database_card.text_splitter_configuration")})}),h.jsxs(qn,{children:[h.jsx(nt,{children:t("create_vector_database_card.text_splitter_chunksize")}),h.jsx(Mn,{value:d.chunkSize,onChange:_,placeholder:t("create_vector_database_card.text_splitter_chunksize_placeholder")}),h.jsx(nt,{children:t("create_vector_database_card.text_splitter_chunkoverlap")}),h.jsx(Mn,{value:d.chunkOverlap,onChange:x,placeholder:t("create_vector_database_card.text_splitter_chunkoverlap_placeholder")})]})]}):void 0]})}),h.jsx(mi,{className:"flex justify-between",children:h.jsx(Zn,{disabled:!d.type||!o,loading:p,onClick:j,className:"w-full",children:t("create_vector_database_card.create")})})]})});function ewe({data:e}){const{t}=Pe("components");return h.jsxs(ay,{className:"w-full",children:[h.jsx(oy,{children:h.jsx(cs,{children:h.jsx(Zc,{children:t("add_text_data.text")})})}),h.jsx(iy,{children:e==null?void 0:e.map((n,r)=>h.jsx(cs,{children:h.jsx(Kc,{className:"p-4",children:n.text})},`${n.text}_${r}`))})]})}const twe=g.memo(e=>{const{id:t}=e,{t:n}=Pe("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),s=$n(t),{createCSVData:c,loading:l}=wz(),u=()=>{a(f=>[...f,{text:o}]),i("")},d=async()=>{s&&await c(s,["text"],r.map(f=>[f.text]))};return h.jsxs(Qt,{className:"mw-full",children:[h.jsx(Vn,{children:h.jsx(Yn,{children:n("add_text_data.title")})}),h.jsxs(qn,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("add_text_data.text")}),h.jsx(vo,{value:o,onChange:f=>i(f.target.value||""),placeholder:n("add_text_data.text_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(ut,{disabled:!o,onClick:u,className:"w-40",children:n("add_text_data.add")})}),h.jsx(ewe,{data:r||[]})]}),h.jsx(mi,{className:"flex justify-between",children:h.jsx(Zn,{loading:l,disabled:!(r!=null&&r.length),onClick:d,className:"w-full",children:n("add_text_data.create")})})]})});var Io=(e=>(e.ADD_LLM="ADD_LLM",e.ADD_PROMPT="ADD_PROMPT",e.ADD_TOOL_DEFINITION="ADD_TOOL_DEFINITION",e.ADD_SCHEMA="ADD_SCHEMA",e.ADD_FEW_SHOT_EXAMPLE="ADD_FEW_SHOT_EXAMPLE",e.ADD_VECTOR_DATABASE="ADD_VECTOR_DATABASE",e.ADD_TEXT_DATA="ADD_TEXT_DATA",e))(Io||{});const nwe=["ADD_LLM","ADD_PROMPT","ADD_SCHEMA","ADD_VECTOR_DATABASE",{key:"more",label:"more",icon:"ellipsis",children:["ADD_TOOL_DEFINITION","ADD_FEW_SHOT_EXAMPLE"]}],rwe=()=>{const e="_coolMode_effect",t=document.getElementById(e);if(t)return t;const n=document.createElement("div");return n.setAttribute("id",e),n.setAttribute("style","overflow:hidden; position:fixed; height:100%; top:0; left:0; right:0; bottom:0; pointer-events:none; z-index:2147483647"),document.body.appendChild(n),n};let xz=0,_z,jz,Sz,Ez,Oz,Cz,Tn,lt,Nz,Mz,Pz,kz,vy,uE,dE,fE,Az,Tz,pE,Rz,Iz,Dz;_z=(e,t)=>{xz++;const n=(t==null?void 0:t.particle)||"circle",r=[15,20,25,35,45],a=45;let o=[],i=!1,s=0,c=0;const l=rwe();function u(){const E=(t==null?void 0:t.size)||r[Math.floor(Math.random()*r.length)],O=(t==null?void 0:t.speedHorz)||Math.random()*10,M=(t==null?void 0:t.speedUp)||Math.random()*25,N=Math.random()*360,P=Math.random()*35*(Math.random()<=.5?-1:1),R=c-E/2,k=s-E/2,C=Math.random()<=.5?-1:1,T=document.createElement("div");if(n==="circle"){const A="http://www.w3.org/2000/svg",I=document.createElementNS(A,"svg"),L=document.createElementNS(A,"circle");L.setAttributeNS(null,"cx",(E/2).toString()),L.setAttributeNS(null,"cy",(E/2).toString()),L.setAttributeNS(null,"r",(E/2).toString()),L.setAttributeNS(null,"fill",`hsl(${Math.random()*360}, 70%, 50%)`),I.appendChild(L),I.setAttribute("width",E.toString()),I.setAttribute("height",E.toString()),T.appendChild(I)}else T.innerHTML=`<img src="${n}" width="${E}" height="${E}" style="border-radius: 50%">`;T.style.position="absolute",T.style.transform=`translate3d(${k}px, ${R}px, 0px) rotate(${N}deg)`,l.appendChild(T),o.push({direction:C,element:T,left:k,size:E,speedHorz:O,speedUp:M,spinSpeed:P,spinVal:N,top:R})}function d(){o.forEach(E=>{E.left=E.left-E.speedHorz*E.direction,E.top=E.top-E.speedUp,E.speedUp=Math.min(E.size,E.speedUp-1),E.spinVal=E.spinVal+E.spinSpeed,E.top>=Math.max(window.innerHeight,document.body.clientHeight)+E.size&&(o=o.filter(O=>O!==E),E.element.remove()),E.element.setAttribute("style",["position:absolute","will-change:transform",`top:${E.top}px`,`left:${E.left}px`,`transform:rotate(${E.spinVal}deg)`].join(";"))})}let f,p=0;const y=30;function m(){const E=performance.now();i&&o.length<a&&E-p>y&&(u(),p=E),d(),f=requestAnimationFrame(m)}m();const v="ontouchstart"in window,b=v?"touchstart":"mousedown",w=v?"touchend":"mouseup",_=v?"touchmove":"mousemove",x=E=>{var O,M;"touches"in E?(s=(O=E.touches)==null?void 0:O[0].clientX,c=(M=E.touches)==null?void 0:M[0].clientY):(s=E.clientX,c=E.clientY)},j=E=>{x(E),i=!0},S=()=>{i=!1};return e.addEventListener(_,x,{passive:!0}),e.addEventListener(b,j,{passive:!0}),e.addEventListener(w,S,{passive:!0}),e.addEventListener("mouseleave",S,{passive:!0}),()=>{e.removeEventListener(_,x),e.removeEventListener(b,j),e.removeEventListener(w,S),e.removeEventListener("mouseleave",S);const E=setInterval(()=>{f&&o.length===0&&(cancelAnimationFrame(f),clearInterval(E),--xz===0&&l.remove())},500)}},jz=({children:e,options:t})=>{const n=g.useRef(null);return g.useEffect(()=>{if(n.current)return _z(n.current,t)},[t]),W.cloneElement(e,{ref:n})},Sz=g.memo(e=>{const{t}=Pe("flows"),n=Ps(s=>s.theme),[r,a]=g.useState(`${Io.ADD_LLM}`),o=g.useMemo(()=>h.jsxs(rB,{children:[h.jsx(LS,{children:h.jsx(jz,{children:h.jsx(ut,{variant:"link",className:"!p-0 !pl-3",children:h.jsx(_Re,{width:32,height:32,className:K(n==="dark"?"fill-white":"fill-black")})})})}),nwe.map(s=>typeof s=="object"?h.jsxs(LS,{children:[h.jsx($S,{children:s.icon?h.jsx(fe,{name:s.icon}):t(`supported_nodes.${s.label}`)}),h.jsx(aB,{children:s.children.map(c=>h.jsx(oB,{onClick:()=>a(c),children:t(`supported_nodes.${c.toLowerCase()}`)},c))})]},s.key):h.jsx(LS,{children:h.jsx($S,{value:s,onClick:()=>a(s),children:t(`supported_nodes.${s.toLowerCase()}`)})},s))]}),[t,n]),i=g.useMemo(()=>{switch(r){case Io.ADD_LLM:return h.jsx(Lbe,{...e});case Io.ADD_PROMPT:return h.jsx(Bbe,{...e});case Io.ADD_SCHEMA:return h.jsx(Hbe,{...e});case Io.ADD_FEW_SHOT_EXAMPLE:return h.jsx(Kbe,{...e});case Io.ADD_TOOL_DEFINITION:return h.jsx(Gbe,{...e});case Io.ADD_VECTOR_DATABASE:return h.jsx(Ybe,{...e});case Io.ADD_TEXT_DATA:return h.jsx(twe,{...e})}},[e,r]);return h.jsxs(h.Fragment,{children:[o,h.jsx("div",{className:"mt-4",children:i})]})}),Ez=()=>{const[e,t]=g.useState(!1),n=Bi(),r=Ye(s=>s.currentSession),a=Ye(s=>s.getLatestApplications),o=g.useCallback(async(s,c,l,u)=>{var p;const d=(p=c.data)==null?void 0:p.entity;let f=c.type?jRe[c.type]:void 0;if(f&&d&&c&&typeof d=="object"&&"id"in d&&!l.has(`${d.id}`)&&!u.has(`${c.id}`)){f=f;const y=await de(f).save({...d,...d&&typeof d=="object"&&"session_id"in d?{session_id:s.id}:{}});l.set(`${d.id}`,y.id);const m=await de("FlowNode").findOne({where:{id:c.data.flowNode.id}}),v=await de("FlowNode").save({...m||c.data.flowNode,session_id:s.id,id:void 0,source_type:f,source_id:y.id});return u.set(`${c.id}`,v.id),{entityName:f,entity:y,node:v}}else if(!u.has(`${c.id}`)){const y=await de("FlowNode").findOne({where:{id:c.data.flowNode.id}}),m=await de("FlowNode").save({...y||c.data.flowNode,node_type:c.type,session_id:s.id,id:void 0});return u.set(`${c.id}`,m.id),{node:m}}},[]),i=g.useCallback(async(s,c)=>{try{if(!r)throw new Error("No current session");t(!0);const l=await de("Session").save({type:ql.StandaloneApp,name:c.name||(r!=null&&r.name?`${r.name}`:"Standalone"),status:SRe.Started,passphrase:r.passphrase});if(!l)throw new Error("Failed create standalone session");const u=new Map,d=new Map,f=await o(l,s,u,d);if(!f)throw new Error("Failed to clone main node");await de("Session").update(l.id,{main_node_id:f.node.id,main_source_id:f!=null&&f.entity?f.entity.id:void 0,main_source_type:f.entityName?f.entityName:void 0});for(const{node:p,connectedNodes:y}of c.connections)if(await o(l,p,u,d),y)for(const m of y)await o(l,m,u,d);for(const{connections:p}of c.connections)for(const y of p){const m=d.get(`${y.source}`),v=d.get(`${y.target}`);if(!m||!v)throw new Error("Failed to get connected flow node id");await de("FlowEdge").save({source:m,target:v,sourceHandle:y.sourceHandle,targetHandle:y.targetHandle,session_id:l.id})}return a(),n(xn("application",{applicationId:l.id})),!0}finally{t(!1)}},[o,r,a,n]);return{loading:e,createStandaloneSession:i}},Oz=()=>{const[e,t]=g.useState(!1),n=De(o=>o.updateNodes),r=De(o=>o.updateEdges),a=g.useCallback(async o=>{try{t(!0),await de("FlowNode").delete(o);const i=await de("FlowEdge").find({where:[{source:o},{target:o}]});return await Promise.all(i.map(s=>de("FlowEdge").delete(s.id))),await n([{id:o,type:"remove"}]),await r(i.map(s=>({id:s.id,type:"remove"}))),!0}catch{return!1}finally{t(!1)}},[r,n]);return{loading:e,deleteNodeFlow:a}},Cz=Ya(({cloneStandaloneSession:e})=>{const t=Jt(),{t:n}=Pe("dialogs"),[r,a]=g.useState(""),{toast:o}=Yt(),i=c=>{a(c.target.value)},s=async()=>{try{t.hide(),await e(r),a("")}catch{o({variant:"destructive",description:n("create_standalone_application.errors.create_failed")})}};return h.jsx(ii,{open:t.visible,onOpenChange:t.hide,children:h.jsxs(lo,{className:"sm:max-w-[425px]",children:[h.jsxs(uo,{children:[h.jsx(fo,{children:n("create_session.title")}),h.jsx(Eu,{children:n("create_standalone_application.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{className:"mb-2",htmlFor:"name",children:n("create_standalone_application.name")}),h.jsx(Mn,{onChange:i,id:"name",value:r,placeholder:n("create_standalone_application.name_placeholder")})]})}),h.jsx(Su,{children:h.jsx(ut,{onClick:s,disabled:!r,type:"submit",children:n("create_standalone_application.create")})})]})})}),Tn=g.memo(({id:e,className:t,enableToStandalone:n,getLinkedConnections:r})=>{const{t:a}=Pe("common"),{getNode:o}=mr(),{loading:i,deleteNodeFlow:s}=Oz(),{createStandaloneSession:c}=Ez(),{toast:l}=Yt(),u=Jt(Cz),d=g.useCallback(async()=>{try{await s(e),l({description:a("deleted")})}catch{l({description:a("errors.delete_failed"),variant:"destructive"})}},[s,e,l,a]),f=g.useCallback(async y=>{try{const m=o(e);if(!m)throw new Error("No current node");const v=(r==null?void 0:r(e))||[];await c(m,{name:y,connections:v}),l({description:a("standalone_session_created")})}catch(m){ks(m),l({description:a("errors.create_standalone_session_failed"),variant:"destructive"})}},[o,e,r,c,l,a]),p=g.useCallback(()=>{u.show({cloneStandaloneSession:f})},[f,u]);return h.jsxs("div",{className:K("flex absolute z-[51] right-0 top-0 h-10",t),children:[n?h.jsx(ut,{className:"!rounded-none !px-2",onClick:p,variant:"ghost",children:h.jsx(fe,{name:"package-plus",size:16})}):void 0,h.jsx(Zn,{loading:i,className:"!rounded-none !px-2",onClick:d,variant:"ghost",children:h.jsx(fe,{name:"trash-2",size:16})})]})}),lt=g.memo(e=>{const{className:t,...n}=e;return h.jsx(fd,{className:K("!w-2 !h-2 !border-none !rounded-full !bg-slate-700",e.position===he.Top?"!top-[-2px]":"",t),...n})}),Nz=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async i=>{var s,c;n(!0);try{const l=(s=i.data)==null?void 0:s.entity;if(!l||!e)throw new Error("LLM or Session not found");const u=i.position.x,d=i.position.y+(((c=i.measured)==null?void 0:c.height)||0),f=await de("Thread").save({initial_llm_id:l.id,title:`New thread with ${l.name}`,status:lp.Started,messages:[],session_id:e}),p=await r({source_id:f.id,source_type:"Thread",node_type:oe.Thread,x:u,y:d+60});if(!p)throw new Error("Failed to create thread node");const y=await a({source:i.id,target:p.id});return{thread:f,flowNode:p,flowEdge:y}}finally{n(!1)}},[a,r,e]);return{loading:t,createThread:o}},Mz=(e,t)=>{var w;const{t:n}=Pe("flows"),{toast:r}=Yt(),[a,o]=g.useState(!1),[i,s]=g.useState(!1),c=$n(e),{loadModel:l}=sm(),{createThread:u,loading:d}=Nz(),f=De(_=>_.updateNodes),p=De(_=>_.pushSyncNodeQueue),{getNodes:y}=mr(),m=g.useCallback(async()=>{try{if(s(!0),t.entity.id){const _=await de("Thread").find({where:{initial_llm_id:t.entity.id}});p("Thread",{where:{source_type:"Thread",source_id:Da(_.map(x=>x.id))}})}}finally{s(!1)}},[(w=t==null?void 0:t.entity)==null?void 0:w.id,p]),v=g.useCallback(async()=>{try{if(o(!0),t.entity&&c){await(l==null?void 0:l(t.entity.provider,`${t.entity.name}`,x=>{c.data.status=x.progress===100?Ge.Loaded:Ge.Loading,c.data.label=x.text,f([{id:e,type:"replace",item:c}])}));const _=y().filter(x=>x.type===oe.LLM?x.data.entity.provider===Ct.WebLLM:!1).map(x=>(x.data.status=Ge.Started,{id:x.id,type:"replace",item:x}));c.data.label="",c.data.status=Ge.Loaded,_.push({id:e,type:"replace",item:c}),f(_),await m()}}catch(_){Ko(_),r({variant:"destructive",description:n("llm_node.errors.loading_model")})}finally{o(!1)}},[t.entity,y,e,l,c,m,n,r,f]),b=g.useCallback(async()=>{t.entity&&c&&await(u==null?void 0:u(c))},[t.entity,c,u]);return g.useEffect(()=>{t.entity&&c&&t.entity.status!==t.status&&(c.data.status=t.entity.status,f([{id:e,type:"replace",item:c}]))},[]),{loadingModel:a,creatingThread:d,queringThreads:i,loadModel:v,createThread:b,queryThreads:m}},Ln=(e,t)=>{const[n,r]=g.useState(!1),[a,o]=g.useState([]),{deleteElements:i,getNode:s}=mr();em({type:"target",nodeId:e,onConnect:l=>{l!=null&&l.length&&o(u=>[...u,...pde(l)])}});const c=g.useCallback(async(l,u,d,f)=>{try{return await t({id:e,edgeId:l,source:u,target:d,connection:f})}catch{return{deleteEdgeId:l}}},[t,e]);g.useEffect(()=>{!(a!=null&&a.length)||n||(async()=>{try{r(!0);const l=[...a];o([]);const u=[],d=s(e);await Promise.all(l.map(async f=>{const p="edgeId"in f?f.edgeId:void 0,y=s(f.source);if(!y||!d)return;const m=await c(`${p}`,y,d,f);m!=null&&m.deleteEdgeId&&u.push(...Array.isArray(m.deleteEdgeId)?m.deleteEdgeId:[m.deleteEdgeId])})),u!=null&&u.length&&await i({edges:u.map(f=>({id:f}))})}finally{r(!1)}})()},[i,s,e,n,c,a])},Pz=e=>{const t=g.useCallback(async()=>{},[]);Ln(e,t)},kz=g.memo(e=>{var m,v,b,w,_;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(),{t:i}=Pe("flows"),{createThread:s,loadModel:c,queringThreads:l,queryThreads:u,loadingModel:d}=Mz(t,n);Pz(t);const f=[Ge.Loading,Ge.Downloading].includes(n.status);g.useEffect(()=>{var x,j,S,E,O;if(!(a||!((x=n==null?void 0:n.entity)!=null&&x.name))){if(((j=n==null?void 0:n.entity)==null?void 0:j.provider)!==Ct.WebLLM){o({hasCache:!0,isFunctionCalling:!0,info:{model_id:(S=n==null?void 0:n.entity)==null?void 0:S.name,model:(E=n==null?void 0:n.entity)==null?void 0:E.name,model_lib:(O=n==null?void 0:n.entity)==null?void 0:O.provider,model_type:2}});return}Ut(()=>import("./index-D2o0-Nmt.js").then(async M=>(await M.__tla,M)),__vite__mapDeps([9,1,2,3,4])).then(async({hasModelInCache:M,functionCallingModelIds:N,prebuiltAppConfig:P})=>{var k,C;const R=await M((k=n==null?void 0:n.entity)==null?void 0:k.name);o({hasCache:R,isFunctionCalling:N.includes((C=n==null?void 0:n.entity)==null?void 0:C.name),info:P.model_list.find(T=>{var A;return T.model_id===((A=n==null?void 0:n.entity)==null?void 0:A.name)})})})}},[(m=n==null?void 0:n.entity)==null?void 0:m.name,(v=n==null?void 0:n.entity)==null?void 0:v.provider,a]);const p=g.useMemo(()=>{var x,j;switch(n.status){case Ge.Downloading:return h.jsx(fe,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case Ge.Loaded:return h.jsx(fa,{name:((x=n.entity)==null?void 0:x.name)||"brain",className:"w-7 h-7"});case Ge.Loading:return h.jsx(fe,{className:"animate-spin w-7 h-7",name:"loader-circle"});default:return h.jsx(fa,{name:((j=n.entity)==null?void 0:j.name)||"brain",className:"w-7 h-7"})}},[(b=n.entity)==null?void 0:b.name,n.status]),y=g.useMemo(()=>f?null:d?h.jsx(ut,{disabled:!0,className:"w-full mt-4",children:h.jsx(fe,{className:"animate-spin",size:24,name:"loader-circle"})}):n.status===Ge.Loaded?h.jsx(ut,{onClick:s,className:"mt-4 w-full",children:i("llm_node.create_thread_button")}):h.jsxs("div",{className:"flex gap-2 mt-4",children:[a!=null&&a.hasCache?h.jsx(Zn,{loading:l,onClick:u,children:h.jsx(fe,{size:24,name:"message-square-more"})}):null,h.jsx(ut,{disabled:d,onClick:c,className:"w-full",children:i(a!=null&&a.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")})]}),[f,d,n.status,a==null?void 0:a.hasCache,l,u,c,i,s]);return h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Tn,{id:t}),h.jsxs(Va,{className:"flex justify-center",children:[p,h.jsxs("div",{className:"ml-2 pt-1 max-w-lg",children:[h.jsx(Ro,{className:"flex gap-2 items-center pr-6",children:`${((w=n==null?void 0:n.entity)==null?void 0:w.name)||""}`}),h.jsx(tl,{className:"max-w-full",children:`${n.label||""}`}),h.jsx("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:h.jsx(Fd,{model:a==null?void 0:a.info,isFunctionCalling:(a==null?void 0:a.isFunctionCalling)||!1,name:(_=n==null?void 0:n.entity)==null?void 0:_.name,isCached:(a==null?void 0:a.hasCache)||!1})}),y]})]}),f?h.jsx(wS,{className:"rounded-lg"}):void 0]}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),vy=g.memo(({tags:e,disabled:t,loading:n,onSubmit:r})=>{const{t:a}=Pe("components"),o=async i=>{try{return await r(i),!0}catch{return!1}};return h.jsxs(Qt,{className:"min-w-80",children:[h.jsx(Vn,{children:h.jsx(Yn,{children:a("add_message_card.title")})}),h.jsxs(qn,{children:[h.jsx("div",{className:"grid w-full gap-1.5",children:h.jsx(Kv,{onSubmit:o,disabled:t||n,placeholder:a("add_message_card.placeholder")})}),e?h.jsx("div",{className:"mt-2 gap-1 flex flex-wrap",children:e}):null]})]})}),uE=(e,t,n,r=[],a)=>{const o=e.map(i=>a.getNode(i));for(const i of o){if(!i)continue;const s=a.getHandleConnections({type:"target",nodeId:i.id});if(n.push(...s),i.type===oe.Thread){r.push(i.id),t.push(i);continue}else if(i.type!==oe.Message){r.push(i.id);continue}else if(r.includes(i.id))continue;r.push(i.id),t.push(i),s.length&&uE(s.map(c=>c.source),t,n,r,a)}return{nodes:t,connections:n}},dE=(e,t)=>{const n=t.getHandleConnections({nodeId:e.id,type:"target"}),r=n.map(d=>{const f=t.getNode(d.source);return f?{connections:t.getHandleConnections({nodeId:f.id,type:"target"}),node:f}:void 0}),a=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.Prompt}),o=[];a!=null&&a.length&&a.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(y=>t.getNode(y.source)).filter(Boolean);o.push({node:d.node,connections:d.connections,connectedNodes:f})});const i=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.ToolDefinition}),s=[];i!=null&&i.length&&i.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(y=>t.getNode(y.source)).filter(Boolean);f!=null&&f.find(y=>y.type===oe.Schema)&&s.push({node:d.node,connections:d.connections,connectedNodes:f})});const c=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.PlaceHolder}),l=[];c!=null&&c.length&&c.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(y=>t.getNode(y.source)).filter(Boolean);f&&l.push({node:d.node,connections:d.connections,connectedNodes:f})});const u=r.find(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.Schema});return{thread:{node:e,connections:n},llm:r.find(d=>{var f;return((f=d.node)==null?void 0:f.type)===oe.LLM}),schemas:u?[u]:[],prompts:o,tools:s,placeholders:l}},fE=e=>{const t=[];return e.forEach(n=>{var o,i,s;const{node:r,connectedNodes:a}=n;if((o=r.data)!=null&&o.entity){if(r.type===oe.Message){const c=r.data.entity;switch(c.role){case"human":t.push(new Dr(c.content));break;case"ai":t.push(new eo(c.content));break}}else if(r.type===oe.Prompt){const c=r.data.entity;let l=`${c.prefix?`${c.prefix}
`:""}`;if(c.type===lr.FewShotExample){const u=(s=(i=a.find(d=>d.type===oe.CSVData))==null?void 0:i.data)==null?void 0:s.entity;if(u){const{rows:d}=FK(u.headers,u.csv);d.forEach(f=>{l+=`${c.content.replace(/{([^{}]*)}/g,(p,y)=>`${f[y]}`)}
`})}}else l+=c.content;switch(c.suffix&&(l+=`
${c.suffix}`),c.role){case"human":t.push(new Dr(l));break;case"system":t.push(new av(l));break;default:t.push(new eo(l));break}}}}),t},Az=(e,t)=>{const n=(e==null?void 0:e.filter(a=>a.type===oe.Message).map(a=>({node:a,connectedNodes:[]})).reverse())||[],r=[];return t.forEach(async a=>{r.unshift({node:a.node,connectedNodes:a.connectedNodes||[]})}),{history:fE(n),systems:fE(r)}},Tz=e=>e?e.reduce((t,n)=>{var o,i,s,c,l;const r=(o=n.node.data)==null?void 0:o.entity,a=(c=(s=(i=n==null?void 0:n.connectedNodes)==null?void 0:i.find(u=>u.type===oe.Schema))==null?void 0:s.data)==null?void 0:c.entity;return r&&((l=a==null?void 0:a.schema_items)!=null&&l.length)&&t.push({name:r.name,description:r.description,schemaItems:a.schema_items}),t},[]):[],pE=({getNode:e,getHandleConnections:t})=>{const{t:n}=Pe("create_new_message"),[r,a]=g.useState(!1),o=Ye(y=>y.currentSession),i=De(y=>y.createOrUpdateFlowNode),s=De(y=>y.createOrUpdateFlowEdge),c=Ts(y=>y.similaritySearchWithScore),{stream:l}=Wc(),u=g.useCallback(async({content:y,threadId:m,sourceId:v,initialX:b,initialY:w,initialLLMId:_})=>{if(!o)throw new Error("Session is not found");const x=await de("Message").save({thread_id:m,content:y,role:cr.Human,status:Br.Started,llm_id:_,session_id:o.id});if(!x)throw new Error("Failed to save message");const j=await i({source_id:x.id,source_type:"Message",node_type:oe.Message,x:b,y:w+80});if(!j)throw new Error("Failed to save human message node");await s({source:v,target:j.id});const S=await de("Message").save({thread_id:m,content:n("initial_ai_message"),role:cr.AI,status:Br.Inprogress,llm_id:_,parent_message_id:x.id,session_id:o.id});if(!S)throw new Error("Failed to save message");const E=await i({source_id:S.id,source_type:"Message",node_type:oe.Message,x:b,y:w+250});if(!E)throw new Error("Failed to save ai message node");return await s({source:j.id,target:E.id}),{aiMessage:S,humanMessage:x,aiMessageNode:E,humanMessageNode:j}},[s,i,o,n]),d=g.useCallback(async(y,m)=>{const{placeholders:v}=m;if(!(v!=null&&v.length))return[];const b=[];return await Promise.all(v.map(async w=>{var x,j,S,E,O,M,N,P,R,k,C,T;const _=(x=w.node.data)==null?void 0:x.entity;if(_)switch(_.placeholder_type){case zs.VECTOR_DATABASE_RETREIVER:{const A=(j=w.connectedNodes)==null?void 0:j.find(V=>V.type===oe.VectorDatabase),I=(S=A==null?void 0:A.data)==null?void 0:S.entity,L=(M=(O=(E=w.connectedNodes)==null?void 0:E.find(V=>V.type===oe.Prompt))==null?void 0:O.data)==null?void 0:M.entity;if(!L||!I||!A)return;const D=(N=_.metadata)!=null&&N.k?+((P=_.metadata)==null?void 0:P.k):1;let B=(R=_.metadata)!=null&&R.minimalScore?+((k=_.metadata)==null?void 0:k.minimalScore):void 0;B&&B>1&&(B=B/100);const F=[];if(I.storage===Lr.DataNode){const V=(T=(C=t({nodeId:A.id,type:"target"}).map(G=>e(G.source)).find(G=>(G==null?void 0:G.type)&&[oe.JSONLData,oe.CSVData].includes(G==null?void 0:G.type)))==null?void 0:C.data)==null?void 0:T.entity;if(!V)return;F.push(...await c({databaseId:I.id,dataSourceId:V.id,dataSourceType:hM(V)},y.humanMessage.content,D))}else F.push(...await c({databaseId:I.id},y.humanMessage.content,D));if(!F)return[];const $=new Jo({template:L.content,inputVariables:["context"]});b.push(new eo(await $.format({context:B?F.filter(([,V])=>V>=B).map(([V])=>V.pageContent).join(`
`):F.map(([V])=>V.pageContent).join(`
`)})))}}})),b},[t,e,c]),f=g.useCallback(async(y,m,v,{onMessageUpdate:b})=>{var T;const{prompts:w,tools:_,schemas:x,placeholders:j,llm:S}=m,E=(T=S==null?void 0:S.node.data)==null?void 0:T.entity;if(!E)throw new Error("LLM is not found");const O=[];j!=null&&j.length&&O.push(...await d(y,m));const{history:M,systems:N}=Az(v,w),P=[...N,...O,...M,new Dr(y.humanMessage.content)],R=x.map(A=>{var I;return(I=A.node.data)==null?void 0:I.entity}).filter(Boolean),{lastChunk:k,content:C}=await l(E.provider,P,{tools:Tz(_),schemas:R,llm:E,onMessageUpdate:({content:A})=>{b==null||b({id:y.aiMessageNode.id,nodeData:{loading:!0,content:A}})}});return y.aiMessage.content=C,y.aiMessage.metadata=JSON.stringify({message:k}),b==null||b({id:y.aiMessageNode.id,nodeData:{content:C,loading:!1,entity:y.aiMessage}}),y.aiMessage.id&&await de("Message").update(y.aiMessage.id,{content:C,metadata:JSON.stringify({message:k})}),C},[d,l]),p=g.useCallback(async(y,m,v)=>{var S,E,O;const{nodes:b}=uE([y.id],[],[],[],{getNode:e,getHandleConnections:t}),w=b.find(M=>M.type===oe.Thread),_=w==null?void 0:w.data.entity;if(!y||!_||!w)throw new Error("Source or thread is not found");const x=dE(w,{getNode:e,getHandleConnections:t});if(!(x!=null&&x.thread))throw new Error("Thread node is not found");let j;try{a(!0);const M=((S=y.position)==null?void 0:S.x)||0,N=(((E=y.position)==null?void 0:E.y)||0)+(((O=y.measured)==null?void 0:O.height)||0);return j=await u({content:m,initialX:M,initialY:N,sourceId:y.id,threadId:_.id,initialLLMId:_.initial_llm_id}),await f(j,x,b,v),await de("Message").update(`${j.aiMessage.id}`,{status:Br.Success}),j.aiMessage.status=Br.Success,v.onMessageUpdate({id:j.aiMessageNode.id,nodeData:{entity:j.aiMessage,loading:!1}}),!0}catch(M){ks(M),j!=null&&j.aiMessage&&await de("Message").update(`${j.aiMessage.id}`,{status:Br.Failed,content:n("errors.ai_message_content_failed")}),j!=null&&j.aiMessageNode.id&&(v==null||v.onMessageUpdate({id:j.aiMessageNode.id,nodeData:{content:n("errors.ai_message_content_failed"),entity:{...j.aiMessage,status:Br.Failed,content:n("errors.ai_message_content_failed")},loading:!1}}))}finally{a(!1)}},[t,e,u,f,n]);return{loading:r,createMessage:p}},Rz=(e,t)=>{const n=$n(e),{t:r}=Pe("flows"),{getNode:a,getHandleConnections:o}=mr(),i=De(f=>f.updateNodes),{createMessage:s,loading:c}=pE({getNode:a,getHandleConnections:o}),l=g.useCallback(f=>{if(!f.id)return;const p=a(f.id);!p||!f.nodeData||i([{id:p.id,type:"replace",item:{...p,data:{...p.data,...Uu(f.nodeData,Wu)}}}])},[a,i]),u=g.useCallback(async f=>{if(n&&t.entity)try{await s(n,f,{onMessageUpdate:l})}catch(p){if(p instanceof Error&&p.message.includes("LLM_NOT_LOADED_YET"))return Hl({variant:"destructive",title:r("thread_node.errors.llm_not_loaded_yet")});Hl({variant:"destructive",title:`${p}`})}},[n,t.entity,s,l,r]),d=g.useCallback(f=>{const p=a(f);if(!p)return[];const y=[],m=dE(p,{getNode:a,getHandleConnections:o});return m.thread&&y.push({node:m.thread.node,connectedNodes:[],connections:m.thread.connections}),m.prompts&&y.push(...m.prompts.map(v=>({node:v.node,connectedNodes:v.connectedNodes,connections:v.connections}))),m.schemas&&y.push(...m.schemas.map(v=>({node:v.node,connectedNodes:[],connections:v.connections}))),m.placeholders&&m.placeholders.forEach(v=>{const b=v.connections.map(w=>a(w.source)).filter(Boolean);y.push({node:v.node,connectedNodes:b||[],connections:v.connections})}),m.llm&&y.push(m.llm),y},[o,a]);return{loading:c,createMessage:u,getLinkedConnections:d}},Iz=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.Prompt&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.Schema&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.ToolDefinition&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.VectorDatabase&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.PlaceHolder&&(o==null?void 0:o.type)===oe.Thread&&a.data.entity.placeholder_type===zs.VECTOR_DATABASE_RETREIVER){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Ln(e,n)},Dz=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e,{t:a}=Pe("flows"),[o,i]=g.useState(!1),s=em({type:"source"}),c=em({type:"target"}),{getNode:l}=mr(),{loading:u,createMessage:d,getLinkedConnections:f}=Rz(t,n);Iz(t);const p=g.useCallback(async(...b)=>(i(!1),await d(...b)),[d]),y=g.useMemo(()=>s.length>0,[s]),m=g.useCallback(()=>{i(b=>!b)},[]),v=g.useMemo(()=>{var w,_;const b=c.map((x,j)=>{var E;const S=l(x.source);if((S==null?void 0:S.type)===oe.Schema)return h.jsx(En,{children:a("thread_node.structured_output")},`${j}`);if((S==null?void 0:S.type)===oe.Prompt){const O=S.data.entity;return h.jsx(En,{children:a(O.type===lr.FewShotExample?"thread_node.prompts.few_shot_example":`thread_node.prompts.${O.role.toLowerCase()}`)},`${j}`)}else if((S==null?void 0:S.type)===oe.PlaceHolder&&((E=S.data.entity)==null?void 0:E.placeholder_type)===zs.VECTOR_DATABASE_RETREIVER)return h.jsx(En,{children:a("thread_node.vector_database_retriever")},`${j}`)}).filter(Boolean);return e.data.entity&&!((_=(w=e.data.entity)==null?void 0:w.messages)!=null&&_.length)&&!y?h.jsx(vy,{disabled:u,loading:u,onSubmit:p,tags:b}):b!=null&&b.length?h.jsxs(Qt,{className:"p-4 pt-2",children:[h.jsx(Yn,{className:"mb-2",children:a("thread_node.title")}),h.jsx("div",{className:"flex gap-1.5",children:b}),h.jsx("div",{className:"mt-4 w-full flex justify-end",children:h.jsxs(ut,{onClick:m,variant:"outline",children:[h.jsx(fe,{name:o?"copy-minus":"copy-plus"}),a(o?"thread_node.hide":"thread_node.clone")]})})]}):h.jsx("div",{className:"w-12 h-10"})},[y,l,p,m,u,e.data.entity,o,a,c]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Tn,{id:t,enableToStandalone:!0,getLinkedConnections:f}),v,o?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(vy,{disabled:u,loading:u,onSubmit:p})})})]}):void 0]}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})});function awe({data:e,onNewThread:t,loading:n,showThread:r}){var o;const{t:a}=Pe("flows");return h.jsxs(Va,{className:"flex min-w-52",children:[h.jsx(fe,{size:24,name:"user"}),h.jsxs("div",{className:"ml-2 max-w-full w-full",children:[h.jsx(Ro,{children:"Human"}),h.jsx(tl,{children:`${e.content||((o=e.entity)==null?void 0:o.content)||""}`}),t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(ut,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(fe,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]})]})}function owe({data:e,onNewThread:t,loading:n,showThread:r}){var c,l,u,d,f,p,y,m,v;const{t:a}=Pe("flows"),o=g.useMemo(()=>{var b;try{return JSON.parse(((b=e==null?void 0:e.entity)==null?void 0:b.metadata)||"{}")}catch{return{}}},[(c=e==null?void 0:e.entity)==null?void 0:c.metadata]),i=e.entity.status===Br.Failed,s=g.useMemo(()=>{var b;return h.jsx(nS,{source:`${e.content||((b=e.entity)==null?void 0:b.content)||""}`})},[e.content,(l=e.entity)==null?void 0:l.content]);return h.jsxs(Va,{className:K("flex min-w-52",i?"bg-background":""),variant:i?"destructive":"default",children:[h.jsx(fe,{className:K(e.loading?"animate-spin":void 0),size:24,name:e.loading?"loader-circle":"bot"}),h.jsx(fe,{name:r?"minus":"plus",size:24}),h.jsxs("div",{className:"ml-2 w-full max-w-full",children:[h.jsx(Ro,{children:a(`message_node.message_roles.${(d=(u=e.entity)==null?void 0:u.role)==null?void 0:d.toLowerCase()}`)}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(fe,{name:"loader-circle",className:"animate-spin"})}),children:i?e.content||((f=e.entity)==null?void 0:f.content)||"":s}),Array.isArray((p=o==null?void 0:o.message)==null?void 0:p.tool_calls)&&((m=(y=o==null?void 0:o.message)==null?void 0:y.tool_calls)!=null&&m.length)?(v=o==null?void 0:o.message)==null?void 0:v.tool_calls.map((b,w)=>h.jsx(En,{children:a("message_node.tool_call",{name:b.name,args:Object.entries(b.args).map(([_,x])=>`"${_}": "${x}"`).join(", ")})},`${b.name}_${w}`)):null,t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(ut,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(fe,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]}),e.loading?h.jsx(wS,{size:350,duration:10}):void 0]})}const iwe=e=>{const{t}=Pe("flows"),n=$n(e),r=De(u=>u.updateNodes),{getNode:a,getHandleConnections:o}=mr(),{createMessage:i,loading:s}=pE({getNode:a,getHandleConnections:o}),c=g.useCallback(u=>{if(!u.id)return;const d=a(u.id);!d||!u.nodeData||r([{id:d.id,type:"replace",item:{...d,data:{...d.data,...Uu(u.nodeData,Wu)}}}])},[a,r]),l=g.useCallback(async u=>{if(n)try{await i(n,u,{onMessageUpdate:c})}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return Hl({variant:"destructive",title:t("message_node.errors.llm_not_loaded_yet")});Hl({variant:"destructive",title:t("message_node.errors.create_message")})}},[n,t,i,c]);return{loading:s,createMessage:l}},Lz=()=>{const e=Ye(r=>r.currentSession),t=De(r=>r.createOrUpdateFlowNode),n=De(r=>r.createOrUpdateFlowEdge);return{createIdieMessage:g.useCallback(async(r,a,o,i)=>{var y,m,v,b,w;if(!r||!a||!e)return;const s=(m=(y=i==null?void 0:i.promptNode)==null?void 0:y.data)==null?void 0:m.entity,c=((v=r.position)==null?void 0:v.x)||0,l=(((b=r.position)==null?void 0:b.y)||0)+(((w=r.measured)==null?void 0:w.height)||0),u=await de("Message").save({thread_id:a.id,content:o,role:(s==null?void 0:s.role)||cr.Human,status:Br.Started,llm_id:a.initial_llm_id,session_id:e.id});if(!u)throw new Error("Failed to save message");const d=await t({source_id:u.id,source_type:"Message",node_type:oe.Message,x:c,y:l});if(!d)throw new Error("Failed to save message node");const f=await n({source:r.id,target:d.id});let p;return i!=null&&i.promptNode&&(p=await n({source:i==null?void 0:i.promptNode.id,target:d.id})),{message:u,edgeToPrompt:p,messageNode:d,messageEdge:f}},[t,n])}},swe=e=>{const{createIdieMessage:t}=Lz(),n=g.useCallback(async({edgeId:r,source:a,target:o})=>{var i,s;try{if((a==null?void 0:a.type)===oe.Prompt&&(o==null?void 0:o.type)===oe.Message){const c=(i=o==null?void 0:o.data)==null?void 0:i.entity,l=(s=a==null?void 0:a.data)==null?void 0:s.entity;if(!l||!c||!o)return{deleteEdgeId:r};await t(o,{id:c==null?void 0:c.thread_id,title:"",status:lp.Started,initial_llm_id:c.llm_id,session_id:l.session_id},l.content,{promptNode:a});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Ln(e,n)},cwe=g.memo(e=>{var _,x,j;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(!1),[i,s]=g.useState(!1),{t:c}=Pe("common"),l=em({type:"source"}),{loading:u,createMessage:d}=iwe(t),{toast:f}=Yt();swe(t);const p=g.useCallback(async(...S)=>{const E=await d(...S);return o(!1),E},[d]),y=g.useMemo(()=>l.length===0,[l]),m=g.useCallback(()=>{var S;(S=n.entity)!=null&&S.content&&(navigator.clipboard.writeText(n.entity.content),f({description:c("copied")}))},[f,n,c]),v=g.useCallback(async()=>{var S;try{if(i)return await pM.stop(),s(!1);s(!0),await pM.speak(((S=n.entity)==null?void 0:S.content)||"")}catch{f({variant:"destructive",description:c("errors.speech_is_not_supported")})}finally{s(!1)}},[(_=n.entity)==null?void 0:_.content,i,c,f]),b=g.useCallback(()=>{o(S=>!S)},[]),w=g.useMemo(()=>{var S;if(!(!y&&!a||n.loading||u||((S=n==null?void 0:n.entity)==null?void 0:S.status)==="inprogress"))return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(vy,{disabled:u,loading:u,onSubmit:p})})})]})},[(x=n==null?void 0:n.entity)==null?void 0:x.status,n.loading,p,y,u,a]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{className:"max-w-sm min-w-64",children:[h.jsxs("div",{className:"w-auto",children:[h.jsx(Tn,{id:t}),h.jsx("div",{children:((j=n.entity)==null?void 0:j.role)===cr.Human?h.jsx(awe,{data:n,showThread:a,onNewThread:y?void 0:b}):h.jsx(owe,{data:n,showThread:a,loading:u,onNewThread:y?void 0:b})}),h.jsx(ut,{onClick:v,className:"absolute top-0 right-[68px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(fe,{name:i?"circle-stop":"speech",size:16})}),h.jsx(ut,{onClick:m,className:"absolute top-0 right-[36px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(fe,{name:"copy",size:16})})]}),w]}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),lwe=e=>{const t=De(a=>a.createOrUpdateFlowEdge),{createIdieMessage:n}=Lz(),r=g.useCallback(async({edgeId:a,source:o,target:i})=>{var s,c,l,u;try{const d=(s=i==null?void 0:i.data)==null?void 0:s.entity,f=(c=o==null?void 0:o.data)==null?void 0:c.entity;if((o==null?void 0:o.type)===oe.Message&&(i==null?void 0:i.type)===oe.Prompt){const p=(l=o==null?void 0:o.data)==null?void 0:l.entity,y=(u=i==null?void 0:i.data)==null?void 0:u.entity;if(!y||!p||!i)return{deleteEdgeId:a};await n(o,{id:p==null?void 0:p.thread_id,title:"",status:lp.Started,initial_llm_id:p.llm_id,session_id:y.session_id},y.content,{promptNode:i});return}else if((o==null?void 0:o.type)===oe.CSVData&&(i==null?void 0:i.type)===oe.Prompt&&(d==null?void 0:d.type)===lr.FewShotExample&&(f!=null&&f.headers.includes("input"))&&(f!=null&&f.headers.includes("output"))){await t({source:o.id,target:i.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[n,t]);Ln(e,r)},uwe=g.memo(e=>{var l,u,d;const{id:t,data:n,isConnectable:r}=e;lwe(t);const a=Jt(a9),o=g.useMemo(()=>{var f,p,y;return`${(f=n.entity)!=null&&f.prefix?`${(p=n.entity)==null?void 0:p.prefix}
`:""}${((y=n.entity)==null?void 0:y.content)||""}`},[(l=n.entity)==null?void 0:l.prefix,(u=n.entity)==null?void 0:u.content]),i=g.useMemo(()=>{var p;const f=/{(.*?)}/g;return((p=o.match(f))==null?void 0:p.map(y=>y.replace("{","").replace("}","")))||[]},[o]),s=o.length>990,c=()=>{a.show({title:"Prompt",content:o})};return h.jsxs("div",{className:"min-w-56",children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Tn,{id:t}),h.jsxs(Va,{className:"flex justify-center max-w-72",variant:"default",children:[h.jsx(fe,{size:24,name:"notepad-text"}),h.jsxs("div",{className:"ml-2 max-w-full break-words break-all",children:[h.jsx(Ro,{children:`${((d=n.entity)==null?void 0:d.role)||""}`}),h.jsxs(tl,{onClick:s?c:void 0,children:[s?`${o.slice(0,990)}...`:o,s?h.jsx("span",{className:"float-right",children:h.jsx(fe,{name:"chevron-right"})}):void 0]}),i!=null&&i.length?i.map((f,p)=>h.jsx(En,{className:"mt-2 mr-1",variant:"default",children:f},p)):void 0]})]})]}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})});var dwe=ID();const Cr=ot(dwe);var hE,$z;function fwe(){if($z)return hE;$z=1;function e(t){return t==null}return hE=e,hE}var pwe=fwe();const vt=ot(pwe);var mE,Fz;function hwe(){if(Fz)return mE;Fz=1;var e=bo(),t=Fn(),n=ja(),r="[object String]";function a(o){return typeof o=="string"||!t(o)&&n(o)&&e(o)==r}return mE=a,mE}var mwe=hwe();const Kd=ot(mwe);var ywe=np();const tt=ot(ywe);var gwe=Fr();const nl=ot(gwe);var Bz={exports:{}},bt={},zz;function vwe(){if(zz)return bt;zz=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),i=Symbol.for("react.context"),s=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),y;y=Symbol.for("react.module.reference");function m(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case e:switch(v=v.type,v){case n:case a:case r:case l:case u:return v;default:switch(v=v&&v.$$typeof,v){case s:case i:case c:case f:case d:case o:return v;default:return b}}case t:return b}}}return bt.ContextConsumer=i,bt.ContextProvider=o,bt.Element=e,bt.ForwardRef=c,bt.Fragment=n,bt.Lazy=f,bt.Memo=d,bt.Portal=t,bt.Profiler=a,bt.StrictMode=r,bt.Suspense=l,bt.SuspenseList=u,bt.isAsyncMode=function(){return!1},bt.isConcurrentMode=function(){return!1},bt.isContextConsumer=function(v){return m(v)===i},bt.isContextProvider=function(v){return m(v)===o},bt.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===e},bt.isForwardRef=function(v){return m(v)===c},bt.isFragment=function(v){return m(v)===n},bt.isLazy=function(v){return m(v)===f},bt.isMemo=function(v){return m(v)===d},bt.isPortal=function(v){return m(v)===t},bt.isProfiler=function(v){return m(v)===a},bt.isStrictMode=function(v){return m(v)===r},bt.isSuspense=function(v){return m(v)===l},bt.isSuspenseList=function(v){return m(v)===u},bt.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===n||v===a||v===r||v===l||v===u||v===p||typeof v=="object"&&v!==null&&(v.$$typeof===f||v.$$typeof===d||v.$$typeof===o||v.$$typeof===i||v.$$typeof===c||v.$$typeof===y||v.getModuleId!==void 0)},bt.typeOf=m,bt}var Vz;function bwe(){return Vz||(Vz=1,Bz.exports=vwe()),Bz.exports}var wwe=bwe(),yE,qz;function Uz(){if(qz)return yE;qz=1;var e=bo(),t=ja(),n="[object Number]";function r(a){return typeof a=="number"||t(a)&&e(a)==n}return yE=r,yE}var gE,Wz;function xwe(){if(Wz)return gE;Wz=1;var e=Uz();function t(n){return e(n)&&n!=+n}return gE=t,gE}var _we=xwe();const Xd=ot(_we);var jwe=Uz();const Swe=ot(jwe);var ya=function(e){return e===0?0:e>0?1:-1},fs=function(e){return Kd(e)&&e.indexOf("%")===e.length-1},ye=function(e){return Swe(e)&&!Xd(e)},un=function(e){return ye(e)||Kd(e)},Ewe=0,by=function(e){var t=++Ewe;return"".concat(e||"").concat(t)},ps=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ye(e)&&!Kd(e))return n;var a;if(fs(e)){var o=e.indexOf("%");a=t*parseFloat(e.slice(0,o))/100}else a=+e;return Xd(a)&&(a=n),r&&a>t&&(a=t),a},ji=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},Owe=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1},rl=function(e,t){return ye(e)&&ye(t)?function(n){return e+n*(t-e)}:function(){return t}};function vE(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):Cr(r,t))===n})}function al(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function bE(e){"@babel/helpers - typeof";return bE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bE(e)}var Cwe=["viewBox","children"],Nwe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Hz=["points","pathLength"],wE={svg:Cwe,polygon:Hz,polyline:Hz},xE=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],wy=function(e,t){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),!nl(n))return null;var r={};return Object.keys(n).forEach(function(a){xE.includes(a)&&(r[a]=t||function(o){return n[a](n,o)})}),r},Mwe=function(e,t,n){return function(r){return e(t,n,r),null}},xy=function(e,t,n){if(!nl(e)||bE(e)!=="object")return null;var r=null;return Object.keys(e).forEach(function(a){var o=e[a];xE.includes(a)&&typeof o=="function"&&(r||(r={}),r[a]=Mwe(o,t,n))}),r},Pwe=["children"],kwe=["children"];function Zz(e,t){if(e==null)return{};var n=Awe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Awe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var Kz={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Do=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},Xz=null,_E=null,jE=function e(t){if(t===Xz&&Array.isArray(_E))return _E;var n=[];return g.Children.forEach(t,function(r){vt(r)||(wwe.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),_E=n,Xz=t,n};function ga(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(a){return Do(a)}):r=[Do(t)],jE(e).forEach(function(a){var o=Cr(a,"type.displayName")||Cr(a,"type.name");r.indexOf(o)!==-1&&n.push(a)}),n}function br(e,t){var n=ga(e,t);return n&&n[0]}var Gz=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!ye(n)||n<=0||!ye(r)||r<=0)},Twe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Rwe=function(e){return e&&e.type&&Kd(e.type)&&Twe.indexOf(e.type)>=0},Iwe=function(e,t,n,r){var a,o=(a=wE==null?void 0:wE[r])!==null&&a!==void 0?a:[];return!tt(e)&&(r&&o.includes(t)||Nwe.includes(t))||n&&xE.includes(t)},gt=function(e,t,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(g.isValidElement(e)&&(r=e.props),!nl(r))return null;var a={};return Object.keys(r).forEach(function(o){var i;Iwe((i=r)===null||i===void 0?void 0:i[o],o,t,n)&&(a[o]=r[o])}),a},SE=function e(t,n){if(t===n)return!0;var r=g.Children.count(t);if(r!==g.Children.count(n))return!1;if(r===0)return!0;if(r===1)return Qz(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var o=t[a],i=n[a];if(Array.isArray(o)||Array.isArray(i)){if(!e(o,i))return!1}else if(!Qz(o,i))return!1}return!0},Qz=function(e,t){if(vt(e)&&vt(t))return!0;if(!vt(e)&&!vt(t)){var n=e.props||{},r=n.children,a=Zz(n,Pwe),o=t.props||{},i=o.children,s=Zz(o,kwe);return r&&i?al(a,s)&&SE(r,i):!r&&!i?al(a,s):!1}return!1},Jz=function(e,t){var n=[],r={};return jE(e).forEach(function(a,o){if(Rwe(a))n.push(a);else if(a){var i=Do(a.type),s=t[i]||{},c=s.handler,l=s.once;if(c&&(!l||!r[i])){var u=c(a,i,o);n.push(u),r[i]=!0}}}),n},Dwe=function(e){var t=e&&e.type;return t&&Kz[t]?Kz[t]:null},Lwe=function(e,t){return jE(t).indexOf(e)},$we=["children","width","height","viewBox","className","style","title","desc"];function EE(){return EE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},EE.apply(this,arguments)}function Fwe(e,t){if(e==null)return{};var n=Bwe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Bwe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function OE(e){var t=e.children,n=e.width,r=e.height,a=e.viewBox,o=e.className,i=e.style,s=e.title,c=e.desc,l=Fwe(e,$we),u=a||{width:n,height:r,x:0,y:0},d=_t("recharts-surface",o);return W.createElement("svg",EE({},gt(l,!0,"svg"),{className:d,width:n,height:r,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),W.createElement("title",null,s),W.createElement("desc",null,c),t)}var zwe=["children","className"];function CE(){return CE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},CE.apply(this,arguments)}function Vwe(e,t){if(e==null)return{};var n=qwe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qwe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var mn=W.forwardRef(function(e,t){var n=e.children,r=e.className,a=Vwe(e,zwe),o=_t("recharts-layer",r);return W.createElement("g",CE({className:o},gt(a,!0),{ref:t}),n)}),Lo=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]},NE,Yz;function Uwe(){if(Yz)return NE;Yz=1;var e=s0();function t(n,r,a){var o=n.length;return a=a===void 0?o:a,!r&&a>=o?n:e(n,r,a)}return NE=t,NE}var ME,e7;function t7(){if(e7)return ME;e7=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="\\u200d",s=RegExp("["+i+e+a+o+"]");function c(l){return s.test(l)}return ME=c,ME}var PE,n7;function Wwe(){if(n7)return PE;n7=1;function e(t){return t.split("")}return PE=e,PE}var kE,r7;function Hwe(){if(r7)return kE;r7=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="["+e+"]",s="["+a+"]",c="\uD83C[\uDFFB-\uDFFF]",l="(?:"+s+"|"+c+")",u="[^"+e+"]",d="(?:\uD83C[\uDDE6-\uDDFF]){2}",f="[\uD800-\uDBFF][\uDC00-\uDFFF]",p="\\u200d",y=l+"?",m="["+o+"]?",v="(?:"+p+"(?:"+[u,d,f].join("|")+")"+m+y+")*",b=m+y+v,w="(?:"+[u+s+"?",s,d,f,i].join("|")+")",_=RegExp(c+"(?="+c+")|"+w+b,"g");function x(j){return j.match(_)||[]}return kE=x,kE}var AE,a7;function Zwe(){if(a7)return AE;a7=1;var e=Wwe(),t=t7(),n=Hwe();function r(a){return t(a)?n(a):e(a)}return AE=r,AE}var TE,o7;function Kwe(){if(o7)return TE;o7=1;var e=Uwe(),t=t7(),n=Zwe(),r=PD();function a(o){return function(i){i=r(i);var s=t(i)?n(i):void 0,c=s?s[0]:i.charAt(0),l=s?e(s,1).join(""):i.slice(1);return c[o]()+l}}return TE=a,TE}var RE,i7;function Xwe(){if(i7)return RE;i7=1;var e=Kwe(),t=e("toUpperCase");return RE=t,RE}var Gwe=Xwe();const _y=ot(Gwe);function Dt(e){return function(){return e}}const s7=Math.cos,jy=Math.sin,va=Math.sqrt,Sy=Math.PI,Ey=2*Sy,IE=Math.PI,DE=2*IE,hs=1e-6,Qwe=DE-hs;function c7(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Jwe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return c7;const n=10**t;return function(r){this._+=r[0];for(let a=1,o=r.length;a<o;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class Ywe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?c7:Jwe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,a){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(t,n,r,a,o,i){this._append`C${+t},${+n},${+r},${+a},${this._x1=+o},${this._y1=+i}`}arcTo(t,n,r,a,o){if(t=+t,n=+n,r=+r,a=+a,o=+o,o<0)throw new Error(`negative radius: ${o}`);let i=this._x1,s=this._y1,c=r-t,l=a-n,u=i-t,d=s-n,f=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>hs)if(!(Math.abs(d*c-l*u)>hs)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let p=r-i,y=a-s,m=c*c+l*l,v=p*p+y*y,b=Math.sqrt(m),w=Math.sqrt(f),_=o*Math.tan((IE-Math.acos((m+f-v)/(2*b*w)))/2),x=_/w,j=_/b;Math.abs(x-1)>hs&&this._append`L${t+x*u},${n+x*d}`,this._append`A${o},${o},0,0,${+(d*p>u*y)},${this._x1=t+j*c},${this._y1=n+j*l}`}}arc(t,n,r,a,o,i){if(t=+t,n=+n,r=+r,i=!!i,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(a),c=r*Math.sin(a),l=t+s,u=n+c,d=1^i,f=i?a-o:o-a;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>hs||Math.abs(this._y1-u)>hs)&&this._append`L${l},${u}`,r&&(f<0&&(f=f%DE+DE),f>Qwe?this._append`A${r},${r},0,1,${d},${t-s},${n-c}A${r},${r},0,1,${d},${this._x1=l},${this._y1=u}`:f>hs&&this._append`A${r},${r},0,${+(f>=IE)},${d},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function LE(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new Ywe(t)}function $E(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function l7(e){this._context=e}l7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Oy(e){return new l7(e)}function u7(e){return e[0]}function d7(e){return e[1]}function f7(e,t){var n=Dt(!0),r=null,a=Oy,o=null,i=LE(s);e=typeof e=="function"?e:e===void 0?u7:Dt(e),t=typeof t=="function"?t:t===void 0?d7:Dt(t);function s(c){var l,u=(c=$E(c)).length,d,f=!1,p;for(r==null&&(o=a(p=i())),l=0;l<=u;++l)!(l<u&&n(d=c[l],l,c))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(d,l,c),+t(d,l,c));if(p)return o=null,p+""||null}return s.x=function(c){return arguments.length?(e=typeof c=="function"?c:Dt(+c),s):e},s.y=function(c){return arguments.length?(t=typeof c=="function"?c:Dt(+c),s):t},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:Dt(!!c),s):n},s.curve=function(c){return arguments.length?(a=c,r!=null&&(o=a(r)),s):a},s.context=function(c){return arguments.length?(c==null?r=o=null:o=a(r=c),s):r},s}function Cy(e,t,n){var r=null,a=Dt(!0),o=null,i=Oy,s=null,c=LE(l);e=typeof e=="function"?e:e===void 0?u7:Dt(+e),t=typeof t=="function"?t:Dt(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?d7:Dt(+n);function l(d){var f,p,y,m=(d=$E(d)).length,v,b=!1,w,_=new Array(m),x=new Array(m);for(o==null&&(s=i(w=c())),f=0;f<=m;++f){if(!(f<m&&a(v=d[f],f,d))===b)if(b=!b)p=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),y=f-1;y>=p;--y)s.point(_[y],x[y]);s.lineEnd(),s.areaEnd()}b&&(_[f]=+e(v,f,d),x[f]=+t(v,f,d),s.point(r?+r(v,f,d):_[f],n?+n(v,f,d):x[f]))}if(w)return s=null,w+""||null}function u(){return f7().defined(a).curve(i).context(o)}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:Dt(+d),r=null,l):e},l.x0=function(d){return arguments.length?(e=typeof d=="function"?d:Dt(+d),l):e},l.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:Dt(+d),l):r},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:Dt(+d),n=null,l):t},l.y0=function(d){return arguments.length?(t=typeof d=="function"?d:Dt(+d),l):t},l.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:Dt(+d),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(d){return arguments.length?(a=typeof d=="function"?d:Dt(!!d),l):a},l.curve=function(d){return arguments.length?(i=d,o!=null&&(s=i(o)),l):i},l.context=function(d){return arguments.length?(d==null?o=s=null:s=i(o=d),l):o},l}class p7{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function exe(e){return new p7(e,!0)}function txe(e){return new p7(e,!1)}const FE={draw(e,t){const n=va(t/Sy);e.moveTo(n,0),e.arc(0,0,n,0,Ey)}},nxe={draw(e,t){const n=va(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},h7=va(1/3),rxe=h7*2,axe={draw(e,t){const n=va(t/rxe),r=n*h7;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},oxe={draw(e,t){const n=va(t),r=-n/2;e.rect(r,r,n,n)}},ixe=.8908130915292852,m7=jy(Sy/10)/jy(7*Sy/10),sxe=jy(Ey/10)*m7,cxe=-s7(Ey/10)*m7,lxe={draw(e,t){const n=va(t*ixe),r=sxe*n,a=cxe*n;e.moveTo(0,-n),e.lineTo(r,a);for(let o=1;o<5;++o){const i=Ey*o/5,s=s7(i),c=jy(i);e.lineTo(c*n,-s*n),e.lineTo(s*r-c*a,c*r+s*a)}e.closePath()}},BE=va(3),uxe={draw(e,t){const n=-va(t/(BE*3));e.moveTo(0,n*2),e.lineTo(-BE*n,-n),e.lineTo(BE*n,-n),e.closePath()}},Nr=-.5,Mr=va(3)/2,zE=1/va(12),dxe=(zE/2+1)*3,fxe={draw(e,t){const n=va(t/dxe),r=n/2,a=n*zE,o=r,i=n*zE+n,s=-o,c=i;e.moveTo(r,a),e.lineTo(o,i),e.lineTo(s,c),e.lineTo(Nr*r-Mr*a,Mr*r+Nr*a),e.lineTo(Nr*o-Mr*i,Mr*o+Nr*i),e.lineTo(Nr*s-Mr*c,Mr*s+Nr*c),e.lineTo(Nr*r+Mr*a,Nr*a-Mr*r),e.lineTo(Nr*o+Mr*i,Nr*i-Mr*o),e.lineTo(Nr*s+Mr*c,Nr*c-Mr*s),e.closePath()}};function pxe(e,t){let n=null,r=LE(a);e=typeof e=="function"?e:Dt(e||FE),t=typeof t=="function"?t:Dt(t===void 0?64:+t);function a(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return a.type=function(o){return arguments.length?(e=typeof o=="function"?o:Dt(o),a):e},a.size=function(o){return arguments.length?(t=typeof o=="function"?o:Dt(+o),a):t},a.context=function(o){return arguments.length?(n=o??null,a):n},a}function Ny(){}function My(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function y7(e){this._context=e}y7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:My(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:My(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function hxe(e){return new y7(e)}function g7(e){this._context=e}g7.prototype={areaStart:Ny,areaEnd:Ny,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:My(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function mxe(e){return new g7(e)}function v7(e){this._context=e}v7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:My(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function yxe(e){return new v7(e)}function b7(e){this._context=e}b7.prototype={areaStart:Ny,areaEnd:Ny,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function gxe(e){return new b7(e)}function w7(e){return e<0?-1:1}function x7(e,t,n){var r=e._x1-e._x0,a=t-e._x1,o=(e._y1-e._y0)/(r||a<0&&-0),i=(n-e._y1)/(a||r<0&&-0),s=(o*a+i*r)/(r+a);return(w7(o)+w7(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(s))||0}function _7(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function VE(e,t,n){var r=e._x0,a=e._y0,o=e._x1,i=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,a+s*t,o-s,i-s*n,o,i)}function Py(e){this._context=e}Py.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:VE(this,this._t0,_7(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,VE(this,_7(this,n=x7(this,e,t)),n);break;default:VE(this,this._t0,n=x7(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function j7(e){this._context=new S7(e)}(j7.prototype=Object.create(Py.prototype)).point=function(e,t){Py.prototype.point.call(this,t,e)};function S7(e){this._context=e}S7.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,o){this._context.bezierCurveTo(t,e,r,n,o,a)}};function vxe(e){return new Py(e)}function bxe(e){return new j7(e)}function E7(e){this._context=e}E7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=O7(e),a=O7(t),o=0,i=1;i<n;++o,++i)this._context.bezierCurveTo(r[0][o],a[0][o],r[1][o],a[1][o],e[i],t[i]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function O7(e){var t,n=e.length-1,r,a=new Array(n),o=new Array(n),i=new Array(n);for(a[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,o[n-1]=7,i[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/o[t-1],o[t]-=r,i[t]-=r*i[t-1];for(a[n-1]=i[n-1]/o[n-1],t=n-2;t>=0;--t)a[t]=(i[t]-a[t+1])/o[t];for(o[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-a[t+1];return[a,o]}function wxe(e){return new E7(e)}function ky(e,t){this._context=e,this._t=t}ky.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function xxe(e){return new ky(e,.5)}function _xe(e){return new ky(e,0)}function jxe(e){return new ky(e,1)}function ol(e,t){if((i=e.length)>1)for(var n=1,r,a,o=e[t[0]],i,s=o.length;n<i;++n)for(a=o,o=e[t[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function qE(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function Sxe(e,t){return e[t]}function Exe(e){const t=[];return t.key=e,t}function Oxe(){var e=Dt([]),t=qE,n=ol,r=Sxe;function a(o){var i=Array.from(e.apply(this,arguments),Exe),s,c=i.length,l=-1,u;for(const d of o)for(s=0,++l;s<c;++s)(i[s][l]=[0,+r(d,i[s].key,l,o)]).data=d;for(s=0,u=$E(t(i));s<c;++s)i[u[s]].index=s;return n(i,u),i}return a.keys=function(o){return arguments.length?(e=typeof o=="function"?o:Dt(Array.from(o)),a):e},a.value=function(o){return arguments.length?(r=typeof o=="function"?o:Dt(+o),a):r},a.order=function(o){return arguments.length?(t=o==null?qE:typeof o=="function"?o:Dt(Array.from(o)),a):t},a.offset=function(o){return arguments.length?(n=o??ol,a):n},a}function Cxe(e,t){if((r=e.length)>0){for(var n,r,a=0,o=e[0].length,i;a<o;++a){for(i=n=0;n<r;++n)i+=e[n][a][1]||0;if(i)for(n=0;n<r;++n)e[n][a][1]/=i}ol(e,t)}}function Nxe(e,t){if((a=e.length)>0){for(var n=0,r=e[t[0]],a,o=r.length;n<o;++n){for(var i=0,s=0;i<a;++i)s+=e[i][n][1]||0;r[n][1]+=r[n][0]=-s/2}ol(e,t)}}function Mxe(e,t){if(!(!((i=e.length)>0)||!((o=(a=e[t[0]]).length)>0))){for(var n=0,r=1,a,o,i;r<o;++r){for(var s=0,c=0,l=0;s<i;++s){for(var u=e[t[s]],d=u[r][1]||0,f=u[r-1][1]||0,p=(d-f)/2,y=0;y<s;++y){var m=e[t[y]],v=m[r][1]||0,b=m[r-1][1]||0;p+=v-b}c+=d,l+=p*d}a[r-1][1]+=a[r-1][0]=n,c&&(n-=l/c)}a[r-1][1]+=a[r-1][0]=n,ol(e,t)}}function Gd(e){"@babel/helpers - typeof";return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gd(e)}var Pxe=["type","size","sizeType"];function UE(){return UE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UE.apply(this,arguments)}function C7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function N7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C7(Object(n),!0).forEach(function(r){kxe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function kxe(e,t,n){return t=Axe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Axe(e){var t=Txe(e,"string");return Gd(t)=="symbol"?t:t+""}function Txe(e,t){if(Gd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Gd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rxe(e,t){if(e==null)return{};var n=Ixe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ixe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var M7={symbolCircle:FE,symbolCross:nxe,symbolDiamond:axe,symbolSquare:oxe,symbolStar:lxe,symbolTriangle:uxe,symbolWye:fxe},Dxe=Math.PI/180,Lxe=function(e){var t="symbol".concat(_y(e));return M7[t]||FE},$xe=function(e,t,n){if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*Dxe;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.pow(Math.tan(r),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},Fxe=function(e,t){M7["symbol".concat(_y(e))]=t},WE=function(e){var t=e.type,n=t===void 0?"circle":t,r=e.size,a=r===void 0?64:r,o=e.sizeType,i=o===void 0?"area":o,s=Rxe(e,Pxe),c=N7(N7({},s),{},{type:n,size:a,sizeType:i}),l=function(){var y=Lxe(n),m=pxe().type(y).size($xe(a,i,n));return m()},u=c.className,d=c.cx,f=c.cy,p=gt(c,!0);return d===+d&&f===+f&&a===+a?W.createElement("path",UE({},p,{className:_t("recharts-symbols",u),transform:"translate(".concat(d,", ").concat(f,")"),d:l()})):null};WE.registerSymbol=Fxe;function il(e){"@babel/helpers - typeof";return il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},il(e)}function HE(){return HE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HE.apply(this,arguments)}function P7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Bxe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?P7(Object(n),!0).forEach(function(r){Qd(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function zxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vxe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,A7(r.key),r)}}function qxe(e,t,n){return t&&Vxe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uxe(e,t,n){return t=Ay(t),Wxe(e,k7()?Reflect.construct(t,n||[],Ay(e).constructor):t.apply(e,n))}function Wxe(e,t){if(t&&(il(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hxe(e)}function Hxe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(k7=function(){return!!e})()}function Ay(e){return Ay=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ay(e)}function Zxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZE(e,t)}function ZE(e,t){return ZE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},ZE(e,t)}function Qd(e,t,n){return t=A7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A7(e){var t=Kxe(e,"string");return il(t)=="symbol"?t:t+""}function Kxe(e,t){if(il(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(il(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pr=32,KE=function(e){function t(){return zxe(this,t),Uxe(this,t,arguments)}return Zxe(t,e),qxe(t,[{key:"renderIcon",value:function(n){var r=this.props.inactiveColor,a=Pr/2,o=Pr/6,i=Pr/3,s=n.inactive?r:n.color;if(n.type==="plainline")return W.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:a,x2:Pr,y2:a,className:"recharts-legend-icon"});if(n.type==="line")return W.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(a,"h").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*i,",").concat(a,`
            H`).concat(Pr,"M").concat(2*i,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(i,",").concat(a),className:"recharts-legend-icon"});if(n.type==="rect")return W.createElement("path",{stroke:"none",fill:s,d:"M0,".concat(Pr/8,"h").concat(Pr,"v").concat(Pr*3/4,"h").concat(-Pr,"z"),className:"recharts-legend-icon"});if(W.isValidElement(n.legendIcon)){var c=Bxe({},n);return delete c.legendIcon,W.cloneElement(n.legendIcon,c)}return W.createElement(WE,{fill:s,cx:a,cy:a,size:Pr,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,r=this.props,a=r.payload,o=r.iconSize,i=r.layout,s=r.formatter,c=r.inactiveColor,l={x:0,y:0,width:Pr,height:Pr},u={display:i==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(f,p){var y=f.formatter||s,m=_t(Qd(Qd({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",f.inactive));if(f.type==="none")return null;var v=tt(f.value)?null:f.value;Lo(!tt(f.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=f.inactive?c:f.color;return W.createElement("li",HE({className:m,style:u,key:"legend-item-".concat(p)},xy(n.props,f,p)),W.createElement(OE,{width:o,height:o,viewBox:l,style:d},n.renderIcon(f)),W.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},y?y(v,f,p):v))})}},{key:"render",value:function(){var n=this.props,r=n.payload,a=n.layout,o=n.align;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return W.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(g.PureComponent);Qd(KE,"displayName","Legend"),Qd(KE,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var XE,T7;function R7(){if(T7)return XE;T7=1;function e(t,n,r,a){for(var o=t.length,i=r+(a?1:-1);a?i--:++i<o;)if(n(t[i],i,t))return i;return-1}return XE=e,XE}var GE,I7;function Xxe(){if(I7)return GE;I7=1;function e(t){return t!==t}return GE=e,GE}var QE,D7;function Gxe(){if(D7)return QE;D7=1;function e(t,n,r){for(var a=r-1,o=t.length;++a<o;)if(t[a]===n)return a;return-1}return QE=e,QE}var JE,L7;function Qxe(){if(L7)return JE;L7=1;var e=R7(),t=Xxe(),n=Gxe();function r(a,o,i){return o===o?n(a,o,i):e(a,t,i)}return JE=r,JE}var YE,$7;function Jxe(){if($7)return YE;$7=1;var e=Qxe();function t(n,r){var a=n==null?0:n.length;return!!a&&e(n,r,0)>-1}return YE=t,YE}var eO,F7;function Yxe(){if(F7)return eO;F7=1;function e(t,n,r){for(var a=-1,o=t==null?0:t.length;++a<o;)if(r(n,t[a]))return!0;return!1}return eO=e,eO}var tO,B7;function e1e(){if(B7)return tO;B7=1;function e(){}return tO=e,tO}var nO,z7;function t1e(){if(z7)return nO;z7=1;var e=lD(),t=e1e(),n=ex(),r=1/0,a=e&&1/n(new e([,-0]))[1]==r?function(o){return new e(o)}:t;return nO=a,nO}var rO,V7;function n1e(){if(V7)return rO;V7=1;var e=vI(),t=Jxe(),n=Yxe(),r=_I(),a=t1e(),o=ex(),i=200;function s(c,l,u){var d=-1,f=t,p=c.length,y=!0,m=[],v=m;if(u)y=!1,f=n;else if(p>=i){var b=l?null:a(c);if(b)return o(b);y=!1,f=r,v=new e}else v=l?[]:m;e:for(;++d<p;){var w=c[d],_=l?l(w):w;if(w=u||w!==0?w:0,y&&_===_){for(var x=v.length;x--;)if(v[x]===_)continue e;l&&v.push(_),m.push(w)}else f(v,_,u)||(v!==m&&v.push(_),m.push(w))}return m}return rO=s,rO}var aO,q7;function r1e(){if(q7)return aO;q7=1;var e=ka(),t=n1e();function n(r,a){return r&&r.length?t(r,e(a,2)):[]}return aO=n,aO}var a1e=r1e();const U7=ot(a1e);function W7(e,t,n){return t===!0?U7(e,n):tt(t)?U7(e,t):e}function sl(e){"@babel/helpers - typeof";return sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sl(e)}var o1e=["ref"];function H7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function $o(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?H7(Object(n),!0).forEach(function(r){Ry(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function i1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,X7(r.key),r)}}function s1e(e,t,n){return t&&Z7(e.prototype,t),n&&Z7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c1e(e,t,n){return t=Ty(t),l1e(e,K7()?Reflect.construct(t,n||[],Ty(e).constructor):t.apply(e,n))}function l1e(e,t){if(t&&(sl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u1e(e)}function u1e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(K7=function(){return!!e})()}function Ty(e){return Ty=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ty(e)}function d1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},oO(e,t)}function Ry(e,t,n){return t=X7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X7(e){var t=f1e(e,"string");return sl(t)=="symbol"?t:t+""}function f1e(e,t){if(sl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(sl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function p1e(e,t){if(e==null)return{};var n=h1e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function h1e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function m1e(e){return e.value}function y1e(e,t){if(W.isValidElement(e))return W.cloneElement(e,t);if(typeof e=="function")return W.createElement(e,t);t.ref;var n=p1e(t,o1e);return W.createElement(KE,n)}var G7=1,cl=function(e){function t(){var n;i1e(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=c1e(this,t,[].concat(a)),Ry(n,"lastBoundingBox",{width:-1,height:-1}),n}return d1e(t,e),s1e(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,r=this.getBBox();r?(Math.abs(r.width-this.lastBoundingBox.width)>G7||Math.abs(r.height-this.lastBoundingBox.height)>G7)&&(this.lastBoundingBox.width=r.width,this.lastBoundingBox.height=r.height,n&&n(r)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?$o({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var r=this.props,a=r.layout,o=r.align,i=r.verticalAlign,s=r.margin,c=r.chartWidth,l=r.chartHeight,u,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&a==="vertical"){var f=this.getBBoxSnapshot();u={left:((c||0)-f.width)/2}}else u=o==="right"?{right:s&&s.right||0}:{left:s&&s.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var p=this.getBBoxSnapshot();d={top:((l||0)-p.height)/2}}else d=i==="bottom"?{bottom:s&&s.bottom||0}:{top:s&&s.top||0};return $o($o({},u),d)}},{key:"render",value:function(){var n=this,r=this.props,a=r.content,o=r.width,i=r.height,s=r.wrapperStyle,c=r.payloadUniqBy,l=r.payload,u=$o($o({position:"absolute",width:o||"auto",height:i||"auto"},this.getDefaultPosition(s)),s);return W.createElement("div",{className:"recharts-legend-wrapper",style:u,ref:function(d){n.wrapperNode=d}},y1e(a,$o($o({},this.props),{},{payload:W7(l,c,m1e)})))}}],[{key:"getWithHeight",value:function(n,r){var a=$o($o({},this.defaultProps),n.props),o=a.layout;return o==="vertical"&&ye(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||r}:null}}])}(g.PureComponent);Ry(cl,"displayName","Legend"),Ry(cl,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var iO,Q7;function g1e(){if(Q7)return iO;Q7=1;var e=Fs(),t=tp(),n=Fn(),r=e?e.isConcatSpreadable:void 0;function a(o){return n(o)||t(o)||!!(r&&o&&o[r])}return iO=a,iO}var sO,J7;iv=function(){if(J7)return sO;J7=1;var e=rx(),t=g1e();function n(r,a,o,i,s){var c=-1,l=r.length;for(o||(o=t),s||(s=[]);++c<l;){var u=r[c];a>0&&o(u)?a>1?n(u,a-1,o,i,s):e(s,u):i||(s[s.length]=u)}return s}return sO=n,sO};var cO,Y7;function v1e(){if(Y7)return cO;Y7=1;function e(t){return function(n,r,a){for(var o=-1,i=Object(n),s=a(n),c=s.length;c--;){var l=s[t?c:++o];if(r(i[l],l,i)===!1)break}return n}}return cO=e,cO}var lO,eV;bM=function(){if(eV)return lO;eV=1;var e=v1e(),t=e();return lO=t,lO};var uO,tV;function nV(){if(tV)return uO;tV=1;var e=bM(),t=eu();function n(r,a){return r&&e(r,a,t)}return uO=n,uO}var dO,rV;function b1e(){if(rV)return dO;rV=1;var e=Ri();function t(n,r){return function(a,o){if(a==null)return a;if(!e(a))return n(a,o);for(var i=a.length,s=r?i:-1,c=Object(a);(r?s--:++s<i)&&o(c[s],s,c)!==!1;);return a}}return dO=t,dO}var fO,aV;function pO(){if(aV)return fO;aV=1;var e=nV(),t=b1e(),n=t(e);return fO=n,fO}var hO,oV;function iV(){if(oV)return hO;oV=1;var e=pO(),t=Ri();function n(r,a){var o=-1,i=t(r)?Array(r.length):[];return e(r,function(s,c,l){i[++o]=a(s,c,l)}),i}return hO=n,hO}var mO,sV;function w1e(){if(sV)return mO;sV=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return mO=e,mO}var yO,cV;function x1e(){if(cV)return yO;cV=1;var e=ic();function t(n,r){if(n!==r){var a=n!==void 0,o=n===null,i=n===n,s=e(n),c=r!==void 0,l=r===null,u=r===r,d=e(r);if(!l&&!d&&!s&&n>r||s&&c&&u&&!l&&!d||o&&c&&u||!a&&u||!i)return 1;if(!o&&!s&&!d&&n<r||d&&a&&i&&!o&&!s||l&&a&&i||!c&&i||!u)return-1}return 0}return yO=t,yO}var gO,lV;function _1e(){if(lV)return gO;lV=1;var e=x1e();function t(n,r,a){for(var o=-1,i=n.criteria,s=r.criteria,c=i.length,l=a.length;++o<c;){var u=e(i[o],s[o]);if(u){if(o>=l)return u;var d=a[o];return u*(d=="desc"?-1:1)}}return n.index-r.index}return gO=t,gO}var vO,uV;function j1e(){if(uV)return vO;uV=1;var e=Kl(),t=ru(),n=ka(),r=iV(),a=w1e(),o=a0(),i=_1e(),s=sc(),c=Fn();function l(u,d,f){d.length?d=e(d,function(m){return c(m)?function(v){return t(v,m.length===1?m[0]:m)}:m}):d=[s];var p=-1;d=e(d,o(n));var y=r(u,function(m,v,b){var w=e(d,function(_){return _(m)});return{criteria:w,index:++p,value:m}});return a(y,function(m,v){return i(m,v,f)})}return vO=l,vO}var bO,dV;CM=function(){if(dV)return bO;dV=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return bO=e,bO};var wO,fV;vM=function(){if(fV)return wO;fV=1;var e=CM(),t=Math.max;function n(r,a,o){return a=t(a===void 0?r.length-1:a,0),function(){for(var i=arguments,s=-1,c=t(i.length-a,0),l=Array(c);++s<c;)l[s]=i[a+s];s=-1;for(var u=Array(a+1);++s<a;)u[s]=i[s];return u[a]=o(l),e(r,this,u)}}return wO=n,wO};var xO,pV;function S1e(){if(pV)return xO;pV=1;function e(t){return function(){return t}}return xO=e,xO}var _O,hV;function E1e(){if(hV)return _O;hV=1;var e=S1e(),t=ZD(),n=sc(),r=t?function(a,o){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:n;return _O=r,_O}var jO,mV;function O1e(){if(mV)return jO;mV=1;var e=800,t=16,n=Date.now;function r(a){var o=0,i=0;return function(){var s=n(),c=t-(s-i);if(i=s,c>0){if(++o>=e)return arguments[0]}else o=0;return a.apply(void 0,arguments)}}return jO=r,jO}var SO,yV;gM=function(){if(yV)return SO;yV=1;var e=E1e(),t=O1e(),n=t(e);return SO=n,SO};var EO,gV;wM=function(){if(gV)return EO;gV=1;var e=sc(),t=vM(),n=gM();function r(a,o){return n(t(a,o,e),a+"")}return EO=r,EO};var OO,vV;function C1e(){if(vV)return OO;vV=1;var e=iv(),t=j1e(),n=wM(),r=Rs(),a=n(function(o,i){if(o==null)return[];var s=i.length;return s>1&&r(o,i[0],i[1])?i=[]:s>2&&r(i[0],i[1],i[2])&&(i=[i[0]]),t(o,e(i,1),[])});return OO=a,OO}var N1e=C1e();const CO=ot(N1e);function Jd(e){"@babel/helpers - typeof";return Jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jd(e)}function NO(){return NO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},NO.apply(this,arguments)}function M1e(e,t){return T1e(e)||A1e(e,t)||k1e(e,t)||P1e()}function P1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k1e(e,t){if(e){if(typeof e=="string")return bV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bV(e,t)}}function bV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A1e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function T1e(e){if(Array.isArray(e))return e}function wV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function MO(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wV(Object(n),!0).forEach(function(r){R1e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function R1e(e,t,n){return t=I1e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I1e(e){var t=D1e(e,"string");return Jd(t)=="symbol"?t:t+""}function D1e(e,t){if(Jd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Jd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function L1e(e){return Array.isArray(e)&&un(e[0])&&un(e[1])?e.join(" ~ "):e}var $1e=function(e){var t=e.separator,n=t===void 0?" : ":t,r=e.contentStyle,a=r===void 0?{}:r,o=e.itemStyle,i=o===void 0?{}:o,s=e.labelStyle,c=s===void 0?{}:s,l=e.payload,u=e.formatter,d=e.itemSorter,f=e.wrapperClassName,p=e.labelClassName,y=e.label,m=e.labelFormatter,v=e.accessibilityLayer,b=v===void 0?!1:v,w=function(){if(l&&l.length){var N={padding:0,margin:0},P=(d?CO(l,d):l).map(function(R,k){if(R.type==="none")return null;var C=MO({display:"block",paddingTop:4,paddingBottom:4,color:R.color||"#000"},i),T=R.formatter||u||L1e,A=R.value,I=R.name,L=A,D=I;if(T&&L!=null&&D!=null){var B=T(A,I,R,k,l);if(Array.isArray(B)){var F=M1e(B,2);L=F[0],D=F[1]}else L=B}return W.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(k),style:C},un(D)?W.createElement("span",{className:"recharts-tooltip-item-name"},D):null,un(D)?W.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,W.createElement("span",{className:"recharts-tooltip-item-value"},L),W.createElement("span",{className:"recharts-tooltip-item-unit"},R.unit||""))});return W.createElement("ul",{className:"recharts-tooltip-item-list",style:N},P)}return null},_=MO({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),x=MO({margin:0},c),j=!vt(y),S=j?y:"",E=_t("recharts-default-tooltip",f),O=_t("recharts-tooltip-label",p);j&&m&&l!==void 0&&l!==null&&(S=m(y,l));var M=b?{role:"status","aria-live":"assertive"}:{};return W.createElement("div",NO({className:E,style:_},M),W.createElement("p",{className:O,style:x},W.isValidElement(S)?S:"".concat(S)),w())};function Yd(e){"@babel/helpers - typeof";return Yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yd(e)}function Iy(e,t,n){return t=F1e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F1e(e){var t=B1e(e,"string");return Yd(t)=="symbol"?t:t+""}function B1e(e,t){if(Yd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Yd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ef="recharts-tooltip-wrapper",z1e={visibility:"hidden"};function V1e(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return _t(ef,Iy(Iy(Iy(Iy({},"".concat(ef,"-right"),ye(n)&&t&&ye(t.x)&&n>=t.x),"".concat(ef,"-left"),ye(n)&&t&&ye(t.x)&&n<t.x),"".concat(ef,"-bottom"),ye(r)&&t&&ye(t.y)&&r>=t.y),"".concat(ef,"-top"),ye(r)&&t&&ye(t.y)&&r<t.y))}function xV(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,a=e.offsetTopLeft,o=e.position,i=e.reverseDirection,s=e.tooltipDimension,c=e.viewBox,l=e.viewBoxDimension;if(o&&ye(o[r]))return o[r];var u=n[r]-s-a,d=n[r]+a;if(t[r])return i[r]?u:d;if(i[r]){var f=u,p=c[r];return f<p?Math.max(d,c[r]):Math.max(u,c[r])}var y=d+s,m=c[r]+l;return y>m?Math.max(u,c[r]):Math.max(d,c[r])}function q1e(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function U1e(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,a=e.position,o=e.reverseDirection,i=e.tooltipBox,s=e.useTranslate3d,c=e.viewBox,l,u,d;return i.height>0&&i.width>0&&n?(u=xV({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),d=xV({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),l=q1e({translateX:u,translateY:d,useTranslate3d:s})):l=z1e,{cssProperties:l,cssClasses:V1e({translateX:u,translateY:d,coordinate:n})}}function ll(e){"@babel/helpers - typeof";return ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ll(e)}function _V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function jV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_V(Object(n),!0).forEach(function(r){kO(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_V(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function W1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H1e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,EV(r.key),r)}}function Z1e(e,t,n){return t&&H1e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function K1e(e,t,n){return t=Dy(t),X1e(e,SV()?Reflect.construct(t,n||[],Dy(e).constructor):t.apply(e,n))}function X1e(e,t){if(t&&(ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G1e(e)}function G1e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SV=function(){return!!e})()}function Dy(e){return Dy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Dy(e)}function Q1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PO(e,t)}function PO(e,t){return PO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},PO(e,t)}function kO(e,t,n){return t=EV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EV(e){var t=J1e(e,"string");return ll(t)=="symbol"?t:t+""}function J1e(e,t){if(ll(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ll(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OV=1,Y1e=function(e){function t(){var n;W1e(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=K1e(this,t,[].concat(a)),kO(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),kO(n,"handleKeyDown",function(i){if(i.key==="Escape"){var s,c,l,u;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&s!==void 0?s:0,y:(l=(u=n.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0}})}}),n}return Q1e(t,e),Z1e(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>OV||Math.abs(n.height-this.state.lastBoundingBox.height)>OV)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,r;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.children,l=r.coordinate,u=r.hasPayload,d=r.isAnimationActive,f=r.offset,p=r.position,y=r.reverseDirection,m=r.useTranslate3d,v=r.viewBox,b=r.wrapperStyle,w=U1e({allowEscapeViewBox:o,coordinate:l,offsetTopLeft:f,position:p,reverseDirection:y,tooltipBox:this.state.lastBoundingBox,useTranslate3d:m,viewBox:v}),_=w.cssClasses,x=w.cssProperties,j=jV(jV({transition:d&&a?"transform ".concat(i,"ms ").concat(s):void 0},x),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&u?"visible":"hidden",position:"absolute",top:0,left:0},b);return W.createElement("div",{tabIndex:-1,className:_,style:j,ref:function(S){n.wrapperNode=S}},c)}}])}(g.PureComponent),e_e=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Si={isSsr:e_e(),get:function(e){return Si[e]},set:function(e,t){if(typeof e=="string")Si[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(r){Si[r]=e[r]})}}};function ul(e){"@babel/helpers - typeof";return ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ul(e)}function CV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function NV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CV(Object(n),!0).forEach(function(r){TO(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function t_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n_e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,PV(r.key),r)}}function r_e(e,t,n){return t&&n_e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function a_e(e,t,n){return t=Ly(t),o_e(e,MV()?Reflect.construct(t,n||[],Ly(e).constructor):t.apply(e,n))}function o_e(e,t){if(t&&(ul(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return i_e(e)}function i_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MV=function(){return!!e})()}function Ly(e){return Ly=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ly(e)}function s_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AO(e,t)}function AO(e,t){return AO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},AO(e,t)}function TO(e,t,n){return t=PV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PV(e){var t=c_e(e,"string");return ul(t)=="symbol"?t:t+""}function c_e(e,t){if(ul(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ul(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function l_e(e){return e.dataKey}function u_e(e,t){return W.isValidElement(e)?W.cloneElement(e,t):typeof e=="function"?W.createElement(e,t):W.createElement($1e,t)}var qa=function(e){function t(){return t_e(this,t),a_e(this,t,arguments)}return s_e(t,e),r_e(t,[{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.content,l=r.coordinate,u=r.filterNull,d=r.isAnimationActive,f=r.offset,p=r.payload,y=r.payloadUniqBy,m=r.position,v=r.reverseDirection,b=r.useTranslate3d,w=r.viewBox,_=r.wrapperStyle,x=p??[];u&&x.length&&(x=W7(p.filter(function(S){return S.value!=null&&(S.hide!==!0||n.props.includeHidden)}),y,l_e));var j=x.length>0;return W.createElement(Y1e,{allowEscapeViewBox:o,animationDuration:i,animationEasing:s,isAnimationActive:d,active:a,coordinate:l,hasPayload:j,offset:f,position:m,reverseDirection:v,useTranslate3d:b,viewBox:w,wrapperStyle:_},u_e(c,NV(NV({},this.props),{},{payload:x})))}}])}(g.PureComponent);TO(qa,"displayName","Tooltip"),TO(qa,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Si.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var RO,kV;function d_e(){if(kV)return RO;kV=1;var e=$r(),t=function(){return e.Date.now()};return RO=t,RO}var IO,AV;SM=function(){if(AV)return IO;AV=1;var e=Fr(),t=d_e(),n=u9(),r="Expected a function",a=Math.max,o=Math.min;function i(s,c,l){var u,d,f,p,y,m,v=0,b=!1,w=!1,_=!0;if(typeof s!="function")throw new TypeError(r);c=n(c)||0,e(l)&&(b=!!l.leading,w="maxWait"in l,f=w?a(n(l.maxWait)||0,c):f,_="trailing"in l?!!l.trailing:_);function x(k){var C=u,T=d;return u=d=void 0,v=k,p=s.apply(T,C),p}function j(k){return v=k,y=setTimeout(O,c),b?x(k):p}function S(k){var C=k-m,T=k-v,A=c-C;return w?o(A,f-T):A}function E(k){var C=k-m,T=k-v;return m===void 0||C>=c||C<0||w&&T>=f}function O(){var k=t();if(E(k))return M(k);y=setTimeout(O,S(k))}function M(k){return y=void 0,_&&u?x(k):(u=d=void 0,p)}function N(){y!==void 0&&clearTimeout(y),v=0,u=m=d=y=void 0}function P(){return y===void 0?p:M(t())}function R(){var k=t(),C=E(k);if(u=arguments,d=this,m=k,C){if(y===void 0)return j(m);if(w)return clearTimeout(y),y=setTimeout(O,c),x(m)}return y===void 0&&(y=setTimeout(O,c)),p}return R.cancel=N,R.flush=P,R}return IO=i,IO};var DO,TV;function f_e(){if(TV)return DO;TV=1;var e=SM(),t=Fr(),n="Expected a function";function r(a,o,i){var s=!0,c=!0;if(typeof a!="function")throw new TypeError(n);return t(i)&&(s="leading"in i?!!i.leading:s,c="trailing"in i?!!i.trailing:c),e(a,o,{leading:s,maxWait:o,trailing:c})}return DO=r,DO}var p_e=f_e();lv=ot(p_e);function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function RV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function $y(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RV(Object(n),!0).forEach(function(r){h_e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function h_e(e,t,n){return t=m_e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m_e(e){var t=y_e(e,"string");return tf(t)=="symbol"?t:t+""}function y_e(e,t){if(tf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(tf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g_e(e,t){return x_e(e)||w_e(e,t)||b_e(e,t)||v_e()}function v_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b_e(e,t){if(e){if(typeof e=="string")return IV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IV(e,t)}}function IV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w_e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function x_e(e){if(Array.isArray(e))return e}var __e=g.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,a=r===void 0?{width:-1,height:-1}:r,o=e.width,i=o===void 0?"100%":o,s=e.height,c=s===void 0?"100%":s,l=e.minWidth,u=l===void 0?0:l,d=e.minHeight,f=e.maxHeight,p=e.children,y=e.debounce,m=y===void 0?0:y,v=e.id,b=e.className,w=e.onResize,_=e.style,x=_===void 0?{}:_,j=g.useRef(null),S=g.useRef();S.current=w,g.useImperativeHandle(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var E=g.useState({containerWidth:a.width,containerHeight:a.height}),O=g_e(E,2),M=O[0],N=O[1],P=g.useCallback(function(k,C){N(function(T){var A=Math.round(k),I=Math.round(C);return T.containerWidth===A&&T.containerHeight===I?T:{containerWidth:A,containerHeight:I}})},[]);g.useEffect(function(){var k=function(L){var D,B=L[0].contentRect,F=B.width,$=B.height;P(F,$),(D=S.current)===null||D===void 0||D.call(S,F,$)};m>0&&(k=lv(k,m,{trailing:!0,leading:!1}));var C=new ResizeObserver(k),T=j.current.getBoundingClientRect(),A=T.width,I=T.height;return P(A,I),C.observe(j.current),function(){C.disconnect()}},[P,m]);var R=g.useMemo(function(){var k=M.containerWidth,C=M.containerHeight;if(k<0||C<0)return null;Lo(fs(i)||fs(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),Lo(!n||n>0,"The aspect(%s) must be greater than zero.",n);var T=fs(i)?k:i,A=fs(c)?C:c;n&&n>0&&(T?A=T/n:A&&(T=A*n),f&&A>f&&(A=f)),Lo(T>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,T,A,i,c,u,d,n);var I=!Array.isArray(p)&&Do(p.type).endsWith("Chart");return W.Children.map(p,function(L){return W.isValidElement(L)?g.cloneElement(L,$y({width:T,height:A},I?{style:$y({height:"100%",width:"100%",maxHeight:A,maxWidth:T},L.props.style)}:{})):L})},[n,p,c,f,d,u,M,i]);return W.createElement("div",{id:v?"".concat(v):void 0,className:_t("recharts-responsive-container",b),style:$y($y({},x),{},{width:i,height:c,minWidth:u,minHeight:d,maxHeight:f}),ref:j},R)}),DV=function(e){return null};DV.displayName="Cell";function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function LV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function LO(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?LV(Object(n),!0).forEach(function(r){j_e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function j_e(e,t,n){return t=S_e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S_e(e){var t=E_e(e,"string");return nf(t)=="symbol"?t:t+""}function E_e(e,t){if(nf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(nf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dl={widthCache:{},cacheCount:0},O_e=2e3,C_e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},$V="recharts_measurement_span";function N_e(e){var t=LO({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var rf=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Si.isSsr)return{width:0,height:0};var n=N_e(t),r=JSON.stringify({text:e,copyStyle:n});if(dl.widthCache[r])return dl.widthCache[r];try{var a=document.getElementById($V);a||(a=document.createElement("span"),a.setAttribute("id",$V),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=LO(LO({},C_e),n);Object.assign(a.style,o),a.textContent="".concat(e);var i=a.getBoundingClientRect(),s={width:i.width,height:i.height};return dl.widthCache[r]=s,++dl.cacheCount>O_e&&(dl.cacheCount=0,dl.widthCache={}),s}catch{return{width:0,height:0}}},M_e=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function Fy(e,t){return T_e(e)||A_e(e,t)||k_e(e,t)||P_e()}function P_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k_e(e,t){if(e){if(typeof e=="string")return FV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FV(e,t)}}function FV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A_e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function T_e(e){if(Array.isArray(e))return e}function R_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,D_e(r.key),r)}}function I_e(e,t,n){return t&&BV(e.prototype,t),n&&BV(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function D_e(e){var t=L_e(e,"string");return af(t)=="symbol"?t:t+""}function L_e(e,t){if(af(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(af(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var zV=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,VV=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,$_e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,F_e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,qV={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},B_e=Object.keys(qV),fl="NaN";function z_e(e,t){return e*qV[t]}var By=function(){function e(t,n){R_e(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!$_e.test(n)&&(this.num=NaN,this.unit=""),B_e.includes(n)&&(this.num=z_e(t,n),this.unit="px")}return I_e(e,[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(t){var n,r=(n=F_e.exec(t))!==null&&n!==void 0?n:[],a=Fy(r,3),o=a[1],i=a[2];return new e(parseFloat(o),i??"")}}])}();function UV(e){if(e.includes(fl))return fl;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=zV.exec(t))!==null&&n!==void 0?n:[],a=Fy(r,4),o=a[1],i=a[2],s=a[3],c=By.parse(o??""),l=By.parse(s??""),u=i==="*"?c.multiply(l):c.divide(l);if(u.isNaN())return fl;t=t.replace(zV,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,f=(d=VV.exec(t))!==null&&d!==void 0?d:[],p=Fy(f,4),y=p[1],m=p[2],v=p[3],b=By.parse(y??""),w=By.parse(v??""),_=m==="+"?b.add(w):b.subtract(w);if(_.isNaN())return fl;t=t.replace(VV,_.toString())}return t}var WV=/\(([^()]*)\)/;function V_e(e){for(var t=e;t.includes("(");){var n=WV.exec(t),r=Fy(n,2),a=r[1];t=t.replace(WV,UV(a))}return t}function q_e(e){var t=e.replace(/\s+/g,"");return t=V_e(t),t=UV(t),t}function U_e(e){try{return q_e(e)}catch{return fl}}function $O(e){var t=U_e(e.slice(5,-1));return t===fl?"":t}var W_e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],H_e=["dx","dy","angle","className","breakAll"];function FO(){return FO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FO.apply(this,arguments)}function HV(e,t){if(e==null)return{};var n=Z_e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Z_e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function ZV(e,t){return Q_e(e)||G_e(e,t)||X_e(e,t)||K_e()}function K_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X_e(e,t){if(e){if(typeof e=="string")return KV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return KV(e,t)}}function KV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function G_e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function Q_e(e){if(Array.isArray(e))return e}var XV=/[ \f\n\r\t\v\u2028\u2029]+/,GV=function(e){var t=e.children,n=e.breakAll,r=e.style;try{var a=[];vt(t)||(n?a=t.toString().split(""):a=t.toString().split(XV));var o=a.map(function(s){return{word:s,width:rf(s,r).width}}),i=n?0:rf("\xA0",r).width;return{wordsWithComputedWidth:o,spaceWidth:i}}catch{return null}},J_e=function(e,t,n,r,a){var o=e.maxLines,i=e.children,s=e.style,c=e.breakAll,l=ye(o),u=i,d=function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return k.reduce(function(C,T){var A=T.word,I=T.width,L=C[C.length-1];if(L&&(r==null||a||L.width+I+n<Number(r)))L.words.push(A),L.width+=I+n;else{var D={words:[A],width:I};C.push(D)}return C},[])},f=d(t),p=function(k){return k.reduce(function(C,T){return C.width>T.width?C:T})};if(!l)return f;for(var y="\u2026",m=function(k){var C=u.slice(0,k),T=GV({breakAll:c,style:s,children:C+y}).wordsWithComputedWidth,A=d(T),I=A.length>o||p(A).width>Number(r);return[I,A]},v=0,b=u.length-1,w=0,_;v<=b&&w<=u.length-1;){var x=Math.floor((v+b)/2),j=x-1,S=m(j),E=ZV(S,2),O=E[0],M=E[1],N=m(x),P=ZV(N,1),R=P[0];if(!O&&!R&&(v=x+1),O&&R&&(b=x-1),!O&&R){_=M;break}w++}return _||f},QV=function(e){var t=vt(e)?[]:e.toString().split(XV);return[{words:t}]},Y_e=function(e){var t=e.width,n=e.scaleToFit,r=e.children,a=e.style,o=e.breakAll,i=e.maxLines;if((t||n)&&!Si.isSsr){var s,c,l=GV({breakAll:o,children:r,style:a});if(l){var u=l.wordsWithComputedWidth,d=l.spaceWidth;s=u,c=d}else return QV(r);return J_e({breakAll:o,children:r,maxLines:i,style:a},s,c,t,n)}return QV(r)},JV="#808080",zy=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.lineHeight,i=o===void 0?"1em":o,s=e.capHeight,c=s===void 0?"0.71em":s,l=e.scaleToFit,u=l===void 0?!1:l,d=e.textAnchor,f=d===void 0?"start":d,p=e.verticalAnchor,y=p===void 0?"end":p,m=e.fill,v=m===void 0?JV:m,b=HV(e,W_e),w=g.useMemo(function(){return Y_e({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:u,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,u,b.style,b.width]),_=b.dx,x=b.dy,j=b.angle,S=b.className,E=b.breakAll,O=HV(b,H_e);if(!un(n)||!un(a))return null;var M=n+(ye(_)?_:0),N=a+(ye(x)?x:0),P;switch(y){case"start":P=$O("calc(".concat(c,")"));break;case"middle":P=$O("calc(".concat((w.length-1)/2," * -").concat(i," + (").concat(c," / 2))"));break;default:P=$O("calc(".concat(w.length-1," * -").concat(i,")"));break}var R=[];if(u){var k=w[0].width,C=b.width;R.push("scale(".concat((ye(C)?C/k:1)/k,")"))}return j&&R.push("rotate(".concat(j,", ").concat(M,", ").concat(N,")")),R.length&&(O.transform=R.join(" ")),W.createElement("text",FO({},gt(O,!0),{x:M,y:N,className:_t("recharts-text",S),textAnchor:f,fill:v.includes("url")?JV:v}),w.map(function(T,A){var I=T.words.join(E?"":" ");return W.createElement("tspan",{x:M,dy:A===0?P:i,key:"".concat(I,"-").concat(A)},I)}))};function Ei(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function eje(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function BO(e){let t,n,r;e.length!==2?(t=Ei,n=(s,c)=>Ei(e(s),c),r=(s,c)=>e(s)-c):(t=e===Ei||e===eje?e:tje,n=e,r=e);function a(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<0?l=d+1:u=d}while(l<u)}return l}function o(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<=0?l=d+1:u=d}while(l<u)}return l}function i(s,c,l=0,u=s.length){const d=a(s,c,l,u-1);return d>l&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:a,center:i,right:o}}function tje(){return 0}function YV(e){return e===null?NaN:+e}function*nje(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const rje=BO(Ei),of=rje.right;BO(YV).center;class eq extends Map{constructor(t,n=ije){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,a]of t)this.set(r,a)}get(t){return super.get(tq(this,t))}has(t){return super.has(tq(this,t))}set(t,n){return super.set(aje(this,t),n)}delete(t){return super.delete(oje(this,t))}}function tq({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function aje({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function oje({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function ije(e){return e!==null&&typeof e=="object"?e.valueOf():e}function sje(e=Ei){if(e===Ei)return nq;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function nq(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const cje=Math.sqrt(50),lje=Math.sqrt(10),uje=Math.sqrt(2);function Vy(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),o=r/Math.pow(10,a),i=o>=cje?10:o>=lje?5:o>=uje?2:1;let s,c,l;return a<0?(l=Math.pow(10,-a)/i,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=Math.pow(10,a)*i,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?Vy(e,t,n*2):[s,c,l]}function zO(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,o,i]=r?Vy(t,e,n):Vy(e,t,n);if(!(o>=a))return[];const s=o-a+1,c=new Array(s);if(r)if(i<0)for(let l=0;l<s;++l)c[l]=(o-l)/-i;else for(let l=0;l<s;++l)c[l]=(o-l)*i;else if(i<0)for(let l=0;l<s;++l)c[l]=(a+l)/-i;else for(let l=0;l<s;++l)c[l]=(a+l)*i;return c}function VO(e,t,n){return t=+t,e=+e,n=+n,Vy(e,t,n)[2]}function qO(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?VO(t,e,n):VO(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function rq(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function aq(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function oq(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=a===void 0?nq:sje(a);r>n;){if(r-n>600){const c=r-n+1,l=t-n+1,u=Math.log(c),d=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*d*(c-d)/c)*(l-c/2<0?-1:1),p=Math.max(n,Math.floor(t-l*d/c+f)),y=Math.min(r,Math.floor(t+(c-l)*d/c+f));oq(e,t,p,y,a)}const o=e[t];let i=n,s=r;for(sf(e,n,t),a(e[r],o)>0&&sf(e,n,r);i<s;){for(sf(e,i,s),++i,--s;a(e[i],o)<0;)++i;for(;a(e[s],o)>0;)--s}a(e[n],o)===0?sf(e,n,s):(++s,sf(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function sf(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function dje(e,t,n){if(e=Float64Array.from(nje(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return aq(e);if(t>=1)return rq(e);var r,a=(r-1)*t,o=Math.floor(a),i=rq(oq(e,o).subarray(0,o+1)),s=aq(e.subarray(o+1));return i+(s-i)*(a-o)}}function fje(e,t,n=YV){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,o=Math.floor(a),i=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return i+(s-i)*(a-o)}}function pje(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(a);++r<a;)o[r]=e+r*n;return o}function kr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Fo(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const UO=Symbol("implicit");function WO(){var e=new eq,t=[],n=[],r=UO;function a(o){let i=e.get(o);if(i===void 0){if(r!==UO)return r;e.set(o,i=t.push(o)-1)}return n[i%n.length]}return a.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new eq;for(const i of o)e.has(i)||e.set(i,t.push(i)-1);return a},a.range=function(o){return arguments.length?(n=Array.from(o),a):n.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return WO(t,n).unknown(r)},kr.apply(a,arguments),a}function cf(){var e=WO().unknown(void 0),t=e.domain,n=e.range,r=0,a=1,o,i,s=!1,c=0,l=0,u=.5;delete e.unknown;function d(){var f=t().length,p=a<r,y=p?a:r,m=p?r:a;o=(m-y)/Math.max(1,f-c+l*2),s&&(o=Math.floor(o)),y+=(m-y-o*(f-c))*u,i=o*(1-c),s&&(y=Math.round(y),i=Math.round(i));var v=pje(f).map(function(b){return y+o*b});return n(p?v.reverse():v)}return e.domain=function(f){return arguments.length?(t(f),d()):t()},e.range=function(f){return arguments.length?([r,a]=f,r=+r,a=+a,d()):[r,a]},e.rangeRound=function(f){return[r,a]=f,r=+r,a=+a,s=!0,d()},e.bandwidth=function(){return i},e.step=function(){return o},e.round=function(f){return arguments.length?(s=!!f,d()):s},e.padding=function(f){return arguments.length?(c=Math.min(1,l=+f),d()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),d()):c},e.paddingOuter=function(f){return arguments.length?(l=+f,d()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),d()):u},e.copy=function(){return cf(t(),[r,a]).round(s).paddingInner(c).paddingOuter(l).align(u)},kr.apply(d(),arguments)}function iq(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return iq(t())},e}function lf(){return iq(cf.apply(null,arguments).paddingInner(1))}function hje(e){return function(){return e}}function qy(e){return+e}var sq=[0,1];function Wn(e){return e}function HO(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:hje(isNaN(t)?NaN:.5)}function mje(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function yje(e,t,n){var r=e[0],a=e[1],o=t[0],i=t[1];return a<r?(r=HO(a,r),o=n(i,o)):(r=HO(r,a),o=n(o,i)),function(s){return o(r(s))}}function gje(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),o=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)a[i]=HO(e[i],e[i+1]),o[i]=n(t[i],t[i+1]);return function(s){var c=of(e,s,1,r)-1;return o[c](a[c](s))}}function uf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Uy(){var e=sq,t=sq,n=dc,r,a,o,i=Wn,s,c,l;function u(){var f=Math.min(e.length,t.length);return i!==Wn&&(i=mje(e[0],e[f-1])),s=f>2?gje:yje,c=l=null,d}function d(f){return f==null||isNaN(f=+f)?o:(c||(c=s(e.map(r),t,n)))(r(i(f)))}return d.invert=function(f){return i(a((l||(l=s(t,e.map(r),Gr)))(f)))},d.domain=function(f){return arguments.length?(e=Array.from(f,qy),u()):e.slice()},d.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},d.rangeRound=function(f){return t=Array.from(f),n=D1,u()},d.clamp=function(f){return arguments.length?(i=f?!0:Wn,u()):i!==Wn},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(o=f,d):o},function(f,p){return r=f,a=p,u()}}function ZO(){return Uy()(Wn,Wn)}function vje(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Wy(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function pl(e){return e=Wy(Math.abs(e)),e?e[1]:NaN}function bje(e,t){return function(n,r){for(var a=n.length,o=[],i=0,s=e[0],c=0;a>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(n.substring(a-=s,a+s)),!((c+=s+1)>r));)s=e[i=(i+1)%e.length];return o.reverse().join(t)}}function wje(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var xje=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function df(e){if(!(t=xje.exec(e)))throw new Error("invalid format: "+e);var t;return new KO({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}df.prototype=KO.prototype;function KO(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}KO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function _je(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var cq;function jje(e,t){var n=Wy(e,t);if(!n)return e+"";var r=n[0],a=n[1],o=a-(cq=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Wy(e,Math.max(0,t+o-1))[0]}function lq(e,t){var n=Wy(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const uq={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:vje,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>lq(e*100,t),r:lq,s:jje,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function dq(e){return e}var fq=Array.prototype.map,pq=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Sje(e){var t=e.grouping===void 0||e.thousands===void 0?dq:bje(fq.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?dq:wje(fq.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(d){d=df(d);var f=d.fill,p=d.align,y=d.sign,m=d.symbol,v=d.zero,b=d.width,w=d.comma,_=d.precision,x=d.trim,j=d.type;j==="n"?(w=!0,j="g"):uq[j]||(_===void 0&&(_=12),x=!0,j="g"),(v||f==="0"&&p==="=")&&(v=!0,f="0",p="=");var S=m==="$"?n:m==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",E=m==="$"?r:/[%p]/.test(j)?i:"",O=uq[j],M=/[defgprs%]/.test(j);_=_===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function N(P){var R=S,k=E,C,T,A;if(j==="c")k=O(P)+k,P="";else{P=+P;var I=P<0||1/P<0;if(P=isNaN(P)?c:O(Math.abs(P),_),x&&(P=_je(P)),I&&+P==0&&y!=="+"&&(I=!1),R=(I?y==="("?y:s:y==="-"||y==="("?"":y)+R,k=(j==="s"?pq[8+cq/3]:"")+k+(I&&y==="("?")":""),M){for(C=-1,T=P.length;++C<T;)if(A=P.charCodeAt(C),48>A||A>57){k=(A===46?a+P.slice(C+1):P.slice(C))+k,P=P.slice(0,C);break}}}w&&!v&&(P=t(P,1/0));var L=R.length+P.length+k.length,D=L<b?new Array(b-L+1).join(f):"";switch(w&&v&&(P=t(D+P,D.length?b-k.length:1/0),D=""),p){case"<":P=R+P+k+D;break;case"=":P=R+D+P+k;break;case"^":P=D.slice(0,L=D.length>>1)+R+P+k+D.slice(L);break;default:P=D+R+P+k;break}return o(P)}return N.toString=function(){return d+""},N}function u(d,f){var p=l((d=df(d),d.type="f",d)),y=Math.max(-8,Math.min(8,Math.floor(pl(f)/3)))*3,m=Math.pow(10,-y),v=pq[8+y/3];return function(b){return p(m*b)+v}}return{format:l,formatPrefix:u}}var Hy,XO,hq;Eje({thousands:",",grouping:[3],currency:["$",""]});function Eje(e){return Hy=Sje(e),XO=Hy.format,hq=Hy.formatPrefix,Hy}function Oje(e){return Math.max(0,-pl(Math.abs(e)))}function Cje(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(pl(t)/3)))*3-pl(Math.abs(e)))}function Nje(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,pl(t)-pl(e))+1}function mq(e,t,n,r){var a=qO(e,t,n),o;switch(r=df(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=Cje(a,i))&&(r.precision=o),hq(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Nje(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Oje(a))&&(r.precision=o-(r.type==="%")*2);break}}return XO(r)}function Oi(e){var t=e.domain;return e.ticks=function(n){var r=t();return zO(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return mq(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,o=r.length-1,i=r[a],s=r[o],c,l,u=10;for(s<i&&(l=i,i=s,s=l,l=a,a=o,o=l);u-- >0;){if(l=VO(i,s,n),l===c)return r[a]=i,r[o]=s,t(r);if(l>0)i=Math.floor(i/l)*l,s=Math.ceil(s/l)*l;else if(l<0)i=Math.ceil(i*l)/l,s=Math.floor(s*l)/l;else break;c=l}return e},e}function Zy(){var e=ZO();return e.copy=function(){return uf(e,Zy())},kr.apply(e,arguments),Oi(e)}function yq(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,qy),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return yq(e).unknown(t)},e=arguments.length?Array.from(e,qy):[0,1],Oi(n)}function gq(e,t){e=e.slice();var n=0,r=e.length-1,a=e[n],o=e[r],i;return o<a&&(i=n,n=r,r=i,i=a,a=o,o=i),e[n]=t.floor(a),e[r]=t.ceil(o),e}function vq(e){return Math.log(e)}function bq(e){return Math.exp(e)}function Mje(e){return-Math.log(-e)}function Pje(e){return-Math.exp(-e)}function kje(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Aje(e){return e===10?kje:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Tje(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function wq(e){return(t,n)=>-e(-t,n)}function GO(e){const t=e(vq,bq),n=t.domain;let r=10,a,o;function i(){return a=Tje(r),o=Aje(r),n()[0]<0?(a=wq(a),o=wq(o),e(Mje,Pje)):e(vq,bq),t}return t.base=function(s){return arguments.length?(r=+s,i()):r},t.domain=function(s){return arguments.length?(n(s),i()):n()},t.ticks=s=>{const c=n();let l=c[0],u=c[c.length-1];const d=u<l;d&&([l,u]=[u,l]);let f=a(l),p=a(u),y,m;const v=s==null?10:+s;let b=[];if(!(r%1)&&p-f<v){if(f=Math.floor(f),p=Math.ceil(p),l>0){for(;f<=p;++f)for(y=1;y<r;++y)if(m=f<0?y/o(-f):y*o(f),!(m<l)){if(m>u)break;b.push(m)}}else for(;f<=p;++f)for(y=r-1;y>=1;--y)if(m=f>0?y/o(-f):y*o(f),!(m<l)){if(m>u)break;b.push(m)}b.length*2<v&&(b=zO(l,u,v))}else b=zO(f,p,Math.min(p-f,v)).map(o);return d?b.reverse():b},t.tickFormat=(s,c)=>{if(s==null&&(s=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=df(c)).precision==null&&(c.trim=!0),c=XO(c)),s===1/0)return c;const l=Math.max(1,r*s/t.ticks().length);return u=>{let d=u/o(Math.round(a(u)));return d*r<r-.5&&(d*=r),d<=l?c(u):""}},t.nice=()=>n(gq(n(),{floor:s=>o(Math.floor(a(s))),ceil:s=>o(Math.ceil(a(s)))})),t}function xq(){const e=GO(Uy()).domain([1,10]);return e.copy=()=>uf(e,xq()).base(e.base()),kr.apply(e,arguments),e}function _q(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function jq(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function QO(e){var t=1,n=e(_q(t),jq(t));return n.constant=function(r){return arguments.length?e(_q(t=+r),jq(t)):t},Oi(n)}function Sq(){var e=QO(Uy());return e.copy=function(){return uf(e,Sq()).constant(e.constant())},kr.apply(e,arguments)}function Eq(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Rje(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Ije(e){return e<0?-e*e:e*e}function JO(e){var t=e(Wn,Wn),n=1;function r(){return n===1?e(Wn,Wn):n===.5?e(Rje,Ije):e(Eq(n),Eq(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,r()):n},Oi(t)}function YO(){var e=JO(Uy());return e.copy=function(){return uf(e,YO()).exponent(e.exponent())},kr.apply(e,arguments),e}function Dje(){return YO.apply(null,arguments).exponent(.5)}function Oq(e){return Math.sign(e)*e*e}function Lje(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Cq(){var e=ZO(),t=[0,1],n=!1,r;function a(o){var i=Lje(e(o));return isNaN(i)?r:n?Math.round(i):i}return a.invert=function(o){return e.invert(Oq(o))},a.domain=function(o){return arguments.length?(e.domain(o),a):e.domain()},a.range=function(o){return arguments.length?(e.range((t=Array.from(o,qy)).map(Oq)),a):t.slice()},a.rangeRound=function(o){return a.range(o).round(!0)},a.round=function(o){return arguments.length?(n=!!o,a):n},a.clamp=function(o){return arguments.length?(e.clamp(o),a):e.clamp()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return Cq(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},kr.apply(a,arguments),Oi(a)}function Nq(){var e=[],t=[],n=[],r;function a(){var i=0,s=Math.max(1,t.length);for(n=new Array(s-1);++i<s;)n[i-1]=fje(e,i/s);return o}function o(i){return i==null||isNaN(i=+i)?r:t[of(n,i)]}return o.invertExtent=function(i){var s=t.indexOf(i);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Ei),a()},o.range=function(i){return arguments.length?(t=Array.from(i),a()):t.slice()},o.unknown=function(i){return arguments.length?(r=i,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return Nq().domain(e).range(t).unknown(r)},kr.apply(o,arguments)}function Mq(){var e=0,t=1,n=1,r=[.5],a=[0,1],o;function i(c){return c!=null&&c<=c?a[of(r,c,0,n)]:o}function s(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,s()):[e,t]},i.range=function(c){return arguments.length?(n=(a=Array.from(c)).length-1,s()):a.slice()},i.invertExtent=function(c){var l=a.indexOf(c);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},i.unknown=function(c){return arguments.length&&(o=c),i},i.thresholds=function(){return r.slice()},i.copy=function(){return Mq().domain([e,t]).range(a).unknown(o)},kr.apply(Oi(i),arguments)}function Pq(){var e=[.5],t=[0,1],n,r=1;function a(o){return o!=null&&o<=o?t[of(e,o,0,r)]:n}return a.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(o){var i=t.indexOf(o);return[e[i-1],e[i]]},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return Pq().domain(e).range(t).unknown(n)},kr.apply(a,arguments)}const eC=new Date,tC=new Date;function dn(e,t,n,r){function a(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return a.floor=o=>(e(o=new Date(+o)),o),a.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),a.round=o=>{const i=a(o),s=a.ceil(o);return o-i<s-o?i:s},a.offset=(o,i)=>(t(o=new Date(+o),i==null?1:Math.floor(i)),o),a.range=(o,i,s)=>{const c=[];if(o=a.ceil(o),s=s==null?1:Math.floor(s),!(o<i)||!(s>0))return c;let l;do c.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<i);return c},a.filter=o=>dn(i=>{if(i>=i)for(;e(i),!o(i);)i.setTime(i-1)},(i,s)=>{if(i>=i)if(s<0)for(;++s<=0;)for(;t(i,-1),!o(i););else for(;--s>=0;)for(;t(i,1),!o(i););}),n&&(a.count=(o,i)=>(eC.setTime(+o),tC.setTime(+i),e(eC),e(tC),Math.floor(n(eC,tC))),a.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?a.filter(r?i=>r(i)%o===0:i=>a.count(0,i)%o===0):a)),a}const Ky=dn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Ky.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?dn(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Ky),Ky.range;const Bo=1e3,Ar=Bo*60,zo=Ar*60,Vo=zo*24,nC=Vo*7,kq=Vo*30,rC=Vo*365,ms=dn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Bo)},(e,t)=>(t-e)/Bo,e=>e.getUTCSeconds());ms.range;const aC=dn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Bo)},(e,t)=>{e.setTime(+e+t*Ar)},(e,t)=>(t-e)/Ar,e=>e.getMinutes());aC.range;const oC=dn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ar)},(e,t)=>(t-e)/Ar,e=>e.getUTCMinutes());oC.range;const iC=dn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Bo-e.getMinutes()*Ar)},(e,t)=>{e.setTime(+e+t*zo)},(e,t)=>(t-e)/zo,e=>e.getHours());iC.range;const sC=dn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*zo)},(e,t)=>(t-e)/zo,e=>e.getUTCHours());sC.range;const ff=dn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ar)/Vo,e=>e.getDate()-1);ff.range;const Xy=dn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Vo,e=>e.getUTCDate()-1);Xy.range;const Aq=dn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Vo,e=>Math.floor(e/Vo));Aq.range;function ys(e){return dn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ar)/nC)}const Gy=ys(0),Qy=ys(1),$je=ys(2),Fje=ys(3),hl=ys(4),Bje=ys(5),zje=ys(6);Gy.range,Qy.range,$je.range,Fje.range,hl.range,Bje.range,zje.range;function gs(e){return dn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/nC)}const Jy=gs(0),Yy=gs(1),Vje=gs(2),qje=gs(3),ml=gs(4),Uje=gs(5),Wje=gs(6);Jy.range,Yy.range,Vje.range,qje.range,ml.range,Uje.range,Wje.range;const cC=dn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());cC.range;const lC=dn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());lC.range;const qo=dn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());qo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:dn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}),qo.range;const Uo=dn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Uo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:dn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}),Uo.range;function Tq(e,t,n,r,a,o){const i=[[ms,1,Bo],[ms,5,5*Bo],[ms,15,15*Bo],[ms,30,30*Bo],[o,1,Ar],[o,5,5*Ar],[o,15,15*Ar],[o,30,30*Ar],[a,1,zo],[a,3,3*zo],[a,6,6*zo],[a,12,12*zo],[r,1,Vo],[r,2,2*Vo],[n,1,nC],[t,1,kq],[t,3,3*kq],[e,1,rC]];function s(l,u,d){const f=u<l;f&&([l,u]=[u,l]);const p=d&&typeof d.range=="function"?d:c(l,u,d),y=p?p.range(l,+u+1):[];return f?y.reverse():y}function c(l,u,d){const f=Math.abs(u-l)/d,p=BO(([,,v])=>v).right(i,f);if(p===i.length)return e.every(qO(l/rC,u/rC,d));if(p===0)return Ky.every(Math.max(qO(l,u,d),1));const[y,m]=i[f/i[p-1][2]<i[p][2]/f?p-1:p];return y.every(m)}return[s,c]}const[Hje,Zje]=Tq(Uo,lC,Jy,Aq,sC,oC),[Kje,Xje]=Tq(qo,cC,Gy,ff,iC,aC);function uC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function dC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function pf(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Gje(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,o=e.days,i=e.shortDays,s=e.months,c=e.shortMonths,l=hf(a),u=mf(a),d=hf(o),f=mf(o),p=hf(i),y=mf(i),m=hf(s),v=mf(s),b=hf(c),w=mf(c),_={a:I,A:L,b:D,B,c:null,d:Fq,e:Fq,f:bSe,g:MSe,G:kSe,H:ySe,I:gSe,j:vSe,L:Bq,m:wSe,M:xSe,p:F,q:$,Q:Hq,s:Zq,S:_Se,u:jSe,U:SSe,V:ESe,w:OSe,W:CSe,x:null,X:null,y:NSe,Y:PSe,Z:ASe,"%":Wq},x={a:V,A:G,b:X,B:H,c:null,d:Vq,e:Vq,f:DSe,g:HSe,G:KSe,H:TSe,I:RSe,j:ISe,L:qq,m:LSe,M:$Se,p:J,q:Z,Q:Hq,s:Zq,S:FSe,u:BSe,U:zSe,V:VSe,w:qSe,W:USe,x:null,X:null,y:WSe,Y:ZSe,Z:XSe,"%":Wq},j={a:N,A:P,b:R,B:k,c:C,d:Lq,e:Lq,f:fSe,g:Dq,G:Iq,H:$q,I:$q,j:cSe,L:dSe,m:sSe,M:lSe,p:M,q:iSe,Q:hSe,s:mSe,S:uSe,u:tSe,U:nSe,V:rSe,w:eSe,W:aSe,x:T,X:A,y:Dq,Y:Iq,Z:oSe,"%":pSe};_.x=S(n,_),_.X=S(r,_),_.c=S(t,_),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(U,Q){return function(ne){var z=[],se=-1,re=0,ue=U.length,je,Le,$e;for(ne instanceof Date||(ne=new Date(+ne));++se<ue;)U.charCodeAt(se)===37&&(z.push(U.slice(re,se)),(Le=Rq[je=U.charAt(++se)])!=null?je=U.charAt(++se):Le=je==="e"?" ":"0",($e=Q[je])&&(je=$e(ne,Le)),z.push(je),re=se+1);return z.push(U.slice(re,se)),z.join("")}}function E(U,Q){return function(ne){var z=pf(1900,void 0,1),se=O(z,U,ne+="",0),re,ue;if(se!=ne.length)return null;if("Q"in z)return new Date(z.Q);if("s"in z)return new Date(z.s*1e3+("L"in z?z.L:0));if(Q&&!("Z"in z)&&(z.Z=0),"p"in z&&(z.H=z.H%12+z.p*12),z.m===void 0&&(z.m="q"in z?z.q:0),"V"in z){if(z.V<1||z.V>53)return null;"w"in z||(z.w=1),"Z"in z?(re=dC(pf(z.y,0,1)),ue=re.getUTCDay(),re=ue>4||ue===0?Yy.ceil(re):Yy(re),re=Xy.offset(re,(z.V-1)*7),z.y=re.getUTCFullYear(),z.m=re.getUTCMonth(),z.d=re.getUTCDate()+(z.w+6)%7):(re=uC(pf(z.y,0,1)),ue=re.getDay(),re=ue>4||ue===0?Qy.ceil(re):Qy(re),re=ff.offset(re,(z.V-1)*7),z.y=re.getFullYear(),z.m=re.getMonth(),z.d=re.getDate()+(z.w+6)%7)}else("W"in z||"U"in z)&&("w"in z||(z.w="u"in z?z.u%7:"W"in z?1:0),ue="Z"in z?dC(pf(z.y,0,1)).getUTCDay():uC(pf(z.y,0,1)).getDay(),z.m=0,z.d="W"in z?(z.w+6)%7+z.W*7-(ue+5)%7:z.w+z.U*7-(ue+6)%7);return"Z"in z?(z.H+=z.Z/100|0,z.M+=z.Z%100,dC(z)):uC(z)}}function O(U,Q,ne,z){for(var se=0,re=Q.length,ue=ne.length,je,Le;se<re;){if(z>=ue)return-1;if(je=Q.charCodeAt(se++),je===37){if(je=Q.charAt(se++),Le=j[je in Rq?Q.charAt(se++):je],!Le||(z=Le(U,ne,z))<0)return-1}else if(je!=ne.charCodeAt(z++))return-1}return z}function M(U,Q,ne){var z=l.exec(Q.slice(ne));return z?(U.p=u.get(z[0].toLowerCase()),ne+z[0].length):-1}function N(U,Q,ne){var z=p.exec(Q.slice(ne));return z?(U.w=y.get(z[0].toLowerCase()),ne+z[0].length):-1}function P(U,Q,ne){var z=d.exec(Q.slice(ne));return z?(U.w=f.get(z[0].toLowerCase()),ne+z[0].length):-1}function R(U,Q,ne){var z=b.exec(Q.slice(ne));return z?(U.m=w.get(z[0].toLowerCase()),ne+z[0].length):-1}function k(U,Q,ne){var z=m.exec(Q.slice(ne));return z?(U.m=v.get(z[0].toLowerCase()),ne+z[0].length):-1}function C(U,Q,ne){return O(U,t,Q,ne)}function T(U,Q,ne){return O(U,n,Q,ne)}function A(U,Q,ne){return O(U,r,Q,ne)}function I(U){return i[U.getDay()]}function L(U){return o[U.getDay()]}function D(U){return c[U.getMonth()]}function B(U){return s[U.getMonth()]}function F(U){return a[+(U.getHours()>=12)]}function $(U){return 1+~~(U.getMonth()/3)}function V(U){return i[U.getUTCDay()]}function G(U){return o[U.getUTCDay()]}function X(U){return c[U.getUTCMonth()]}function H(U){return s[U.getUTCMonth()]}function J(U){return a[+(U.getUTCHours()>=12)]}function Z(U){return 1+~~(U.getUTCMonth()/3)}return{format:function(U){var Q=S(U+="",_);return Q.toString=function(){return U},Q},parse:function(U){var Q=E(U+="",!1);return Q.toString=function(){return U},Q},utcFormat:function(U){var Q=S(U+="",x);return Q.toString=function(){return U},Q},utcParse:function(U){var Q=E(U+="",!0);return Q.toString=function(){return U},Q}}}var Rq={"-":"",_:" ",0:"0"},yn=/^\s*\d+/,Qje=/^%/,Jje=/[\\^$*+?|[\]().{}]/g;function ft(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",o=a.length;return r+(o<n?new Array(n-o+1).join(t)+a:a)}function Yje(e){return e.replace(Jje,"\\$&")}function hf(e){return new RegExp("^(?:"+e.map(Yje).join("|")+")","i")}function mf(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function eSe(e,t,n){var r=yn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function tSe(e,t,n){var r=yn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function nSe(e,t,n){var r=yn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function rSe(e,t,n){var r=yn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function aSe(e,t,n){var r=yn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Iq(e,t,n){var r=yn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Dq(e,t,n){var r=yn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function oSe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function iSe(e,t,n){var r=yn.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function sSe(e,t,n){var r=yn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Lq(e,t,n){var r=yn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function cSe(e,t,n){var r=yn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function $q(e,t,n){var r=yn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function lSe(e,t,n){var r=yn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function uSe(e,t,n){var r=yn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function dSe(e,t,n){var r=yn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function fSe(e,t,n){var r=yn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function pSe(e,t,n){var r=Qje.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function hSe(e,t,n){var r=yn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function mSe(e,t,n){var r=yn.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Fq(e,t){return ft(e.getDate(),t,2)}function ySe(e,t){return ft(e.getHours(),t,2)}function gSe(e,t){return ft(e.getHours()%12||12,t,2)}function vSe(e,t){return ft(1+ff.count(qo(e),e),t,3)}function Bq(e,t){return ft(e.getMilliseconds(),t,3)}function bSe(e,t){return Bq(e,t)+"000"}function wSe(e,t){return ft(e.getMonth()+1,t,2)}function xSe(e,t){return ft(e.getMinutes(),t,2)}function _Se(e,t){return ft(e.getSeconds(),t,2)}function jSe(e){var t=e.getDay();return t===0?7:t}function SSe(e,t){return ft(Gy.count(qo(e)-1,e),t,2)}function zq(e){var t=e.getDay();return t>=4||t===0?hl(e):hl.ceil(e)}function ESe(e,t){return e=zq(e),ft(hl.count(qo(e),e)+(qo(e).getDay()===4),t,2)}function OSe(e){return e.getDay()}function CSe(e,t){return ft(Qy.count(qo(e)-1,e),t,2)}function NSe(e,t){return ft(e.getFullYear()%100,t,2)}function MSe(e,t){return e=zq(e),ft(e.getFullYear()%100,t,2)}function PSe(e,t){return ft(e.getFullYear()%1e4,t,4)}function kSe(e,t){var n=e.getDay();return e=n>=4||n===0?hl(e):hl.ceil(e),ft(e.getFullYear()%1e4,t,4)}function ASe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ft(t/60|0,"0",2)+ft(t%60,"0",2)}function Vq(e,t){return ft(e.getUTCDate(),t,2)}function TSe(e,t){return ft(e.getUTCHours(),t,2)}function RSe(e,t){return ft(e.getUTCHours()%12||12,t,2)}function ISe(e,t){return ft(1+Xy.count(Uo(e),e),t,3)}function qq(e,t){return ft(e.getUTCMilliseconds(),t,3)}function DSe(e,t){return qq(e,t)+"000"}function LSe(e,t){return ft(e.getUTCMonth()+1,t,2)}function $Se(e,t){return ft(e.getUTCMinutes(),t,2)}function FSe(e,t){return ft(e.getUTCSeconds(),t,2)}function BSe(e){var t=e.getUTCDay();return t===0?7:t}function zSe(e,t){return ft(Jy.count(Uo(e)-1,e),t,2)}function Uq(e){var t=e.getUTCDay();return t>=4||t===0?ml(e):ml.ceil(e)}function VSe(e,t){return e=Uq(e),ft(ml.count(Uo(e),e)+(Uo(e).getUTCDay()===4),t,2)}function qSe(e){return e.getUTCDay()}function USe(e,t){return ft(Yy.count(Uo(e)-1,e),t,2)}function WSe(e,t){return ft(e.getUTCFullYear()%100,t,2)}function HSe(e,t){return e=Uq(e),ft(e.getUTCFullYear()%100,t,2)}function ZSe(e,t){return ft(e.getUTCFullYear()%1e4,t,4)}function KSe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ml(e):ml.ceil(e),ft(e.getUTCFullYear()%1e4,t,4)}function XSe(){return"+0000"}function Wq(){return"%"}function Hq(e){return+e}function Zq(e){return Math.floor(+e/1e3)}var yl,Kq,Xq;GSe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function GSe(e){return yl=Gje(e),Kq=yl.format,yl.parse,Xq=yl.utcFormat,yl.utcParse,yl}function QSe(e){return new Date(e)}function JSe(e){return e instanceof Date?+e:+new Date(+e)}function fC(e,t,n,r,a,o,i,s,c,l){var u=ZO(),d=u.invert,f=u.domain,p=l(".%L"),y=l(":%S"),m=l("%I:%M"),v=l("%I %p"),b=l("%a %d"),w=l("%b %d"),_=l("%B"),x=l("%Y");function j(S){return(c(S)<S?p:s(S)<S?y:i(S)<S?m:o(S)<S?v:r(S)<S?a(S)<S?b:w:n(S)<S?_:x)(S)}return u.invert=function(S){return new Date(d(S))},u.domain=function(S){return arguments.length?f(Array.from(S,JSe)):f().map(QSe)},u.ticks=function(S){var E=f();return e(E[0],E[E.length-1],S??10)},u.tickFormat=function(S,E){return E==null?j:l(E)},u.nice=function(S){var E=f();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?f(gq(E,S)):u},u.copy=function(){return uf(u,fC(e,t,n,r,a,o,i,s,c,l))},u}function YSe(){return kr.apply(fC(Kje,Xje,qo,cC,Gy,ff,iC,aC,ms,Kq).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function eEe(){return kr.apply(fC(Hje,Zje,Uo,lC,Jy,Xy,sC,oC,ms,Xq).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function eg(){var e=0,t=1,n,r,a,o,i=Wn,s=!1,c;function l(d){return d==null||isNaN(d=+d)?c:i(a===0?.5:(d=(o(d)-n)*a,s?Math.max(0,Math.min(1,d)):d))}l.domain=function(d){return arguments.length?([e,t]=d,n=o(e=+e),r=o(t=+t),a=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(d){return arguments.length?(s=!!d,l):s},l.interpolator=function(d){return arguments.length?(i=d,l):i};function u(d){return function(f){var p,y;return arguments.length?([p,y]=f,i=d(p,y),l):[i(0),i(1)]}}return l.range=u(dc),l.rangeRound=u(D1),l.unknown=function(d){return arguments.length?(c=d,l):c},function(d){return o=d,n=d(e),r=d(t),a=n===r?0:1/(r-n),l}}function Ci(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Gq(){var e=Oi(eg()(Wn));return e.copy=function(){return Ci(e,Gq())},Fo.apply(e,arguments)}function Qq(){var e=GO(eg()).domain([1,10]);return e.copy=function(){return Ci(e,Qq()).base(e.base())},Fo.apply(e,arguments)}function Jq(){var e=QO(eg());return e.copy=function(){return Ci(e,Jq()).constant(e.constant())},Fo.apply(e,arguments)}function pC(){var e=JO(eg());return e.copy=function(){return Ci(e,pC()).exponent(e.exponent())},Fo.apply(e,arguments)}function tEe(){return pC.apply(null,arguments).exponent(.5)}function Yq(){var e=[],t=Wn;function n(r){if(r!=null&&!isNaN(r=+r))return t((of(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let a of r)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ei),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,o)=>dje(e,o/r))},n.copy=function(){return Yq(t).domain(e)},Fo.apply(n,arguments)}function tg(){var e=0,t=.5,n=1,r=1,a,o,i,s,c,l=Wn,u,d=!1,f;function p(m){return isNaN(m=+m)?f:(m=.5+((m=+u(m))-o)*(r*m<r*o?s:c),l(d?Math.max(0,Math.min(1,m)):m))}p.domain=function(m){return arguments.length?([e,t,n]=m,a=u(e=+e),o=u(t=+t),i=u(n=+n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,p):[e,t,n]},p.clamp=function(m){return arguments.length?(d=!!m,p):d},p.interpolator=function(m){return arguments.length?(l=m,p):l};function y(m){return function(v){var b,w,_;return arguments.length?([b,w,_]=v,l=Woe(m,[b,w,_]),p):[l(0),l(.5),l(1)]}}return p.range=y(dc),p.rangeRound=y(D1),p.unknown=function(m){return arguments.length?(f=m,p):f},function(m){return u=m,a=m(e),o=m(t),i=m(n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,p}}function eU(){var e=Oi(tg()(Wn));return e.copy=function(){return Ci(e,eU())},Fo.apply(e,arguments)}function tU(){var e=GO(tg()).domain([.1,1,10]);return e.copy=function(){return Ci(e,tU()).base(e.base())},Fo.apply(e,arguments)}function nU(){var e=QO(tg());return e.copy=function(){return Ci(e,nU()).constant(e.constant())},Fo.apply(e,arguments)}function hC(){var e=JO(tg());return e.copy=function(){return Ci(e,hC()).exponent(e.exponent())},Fo.apply(e,arguments)}function nEe(){return hC.apply(null,arguments).exponent(.5)}const rU=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:cf,scaleDiverging:eU,scaleDivergingLog:tU,scaleDivergingPow:hC,scaleDivergingSqrt:nEe,scaleDivergingSymlog:nU,scaleIdentity:yq,scaleImplicit:UO,scaleLinear:Zy,scaleLog:xq,scaleOrdinal:WO,scalePoint:lf,scalePow:YO,scaleQuantile:Nq,scaleQuantize:Mq,scaleRadial:Cq,scaleSequential:Gq,scaleSequentialLog:Qq,scaleSequentialPow:pC,scaleSequentialQuantile:Yq,scaleSequentialSqrt:tEe,scaleSequentialSymlog:Jq,scaleSqrt:Dje,scaleSymlog:Sq,scaleThreshold:Pq,scaleTime:YSe,scaleUtc:eEe,tickFormat:mq},Symbol.toStringTag,{value:"Module"}));var mC,aU;function oU(){if(aU)return mC;aU=1;var e=ic();function t(n,r,a){for(var o=-1,i=n.length;++o<i;){var s=n[o],c=r(s);if(c!=null&&(l===void 0?c===c&&!e(c):a(c,l)))var l=c,u=s}return u}return mC=t,mC}var yC,iU;function rEe(){if(iU)return yC;iU=1;function e(t,n){return t>n}return yC=e,yC}var gC,sU;function aEe(){if(sU)return gC;sU=1;var e=oU(),t=rEe(),n=sc();function r(a){return a&&a.length?e(a,n,t):void 0}return gC=r,gC}var oEe=aEe();const ng=ot(oEe);var vC,cU;function iEe(){if(cU)return vC;cU=1;function e(t,n){return t<n}return vC=e,vC}var bC,lU;function sEe(){if(lU)return bC;lU=1;var e=oU(),t=iEe(),n=sc();function r(a){return a&&a.length?e(a,n,t):void 0}return bC=r,bC}var cEe=sEe();const rg=ot(cEe);var wC,uU;xM=function(){if(uU)return wC;uU=1;var e=Kl(),t=ka(),n=iV(),r=Fn();function a(o,i){var s=r(o)?e:n;return s(o,t(i,3))}return wC=a,wC};var xC,dU;function lEe(){if(dU)return xC;dU=1;var e=iv(),t=xM();function n(r,a){return e(t(r,a),1)}return xC=n,xC}var uEe=lEe();const dEe=ot(uEe);var _C,fU;function fEe(){if(fU)return _C;fU=1;var e=Dx();function t(n,r){return e(n,r)}return _C=t,_C}var pEe=fEe();const jC=ot(pEe);var gl=1e9,hEe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},OC,zt=!0,Tr="[DecimalError] ",vs=Tr+"Invalid argument: ",SC=Tr+"Exponent out of range: ",vl=Math.floor,bs=Math.pow,mEe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,wr,gn=1e7,Lt=7,pU=9007199254740991,ag=vl(pU/Lt),Ce={};Ce.absoluteValue=Ce.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},Ce.comparedTo=Ce.cmp=function(e){var t,n,r,a,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(r=o.d.length,a=e.d.length,t=0,n=r<a?r:a;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===a?0:r>a^o.s<0?1:-1},Ce.decimalPlaces=Ce.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Lt;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n},Ce.dividedBy=Ce.div=function(e){return Wo(this,new this.constructor(e))},Ce.dividedToIntegerBy=Ce.idiv=function(e){var t=this,n=t.constructor;return kt(Wo(t,new n(e),0,1),n.precision)},Ce.equals=Ce.eq=function(e){return!this.cmp(e)},Ce.exponent=function(){return rn(this)},Ce.greaterThan=Ce.gt=function(e){return this.cmp(e)>0},Ce.greaterThanOrEqualTo=Ce.gte=function(e){return this.cmp(e)>=0},Ce.isInteger=Ce.isint=function(){return this.e>this.d.length-2},Ce.isNegative=Ce.isneg=function(){return this.s<0},Ce.isPositive=Ce.ispos=function(){return this.s>0},Ce.isZero=function(){return this.s===0},Ce.lessThan=Ce.lt=function(e){return this.cmp(e)<0},Ce.lessThanOrEqualTo=Ce.lte=function(e){return this.cmp(e)<1},Ce.logarithm=Ce.log=function(e){var t,n=this,r=n.constructor,a=r.precision,o=a+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(wr))throw Error(Tr+"NaN");if(n.s<1)throw Error(Tr+(n.s?"NaN":"-Infinity"));return n.eq(wr)?new r(0):(zt=!1,t=Wo(yf(n,o),yf(e,o),o),zt=!0,kt(t,a))},Ce.minus=Ce.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?gU(t,e):hU(t,(e.s=-e.s,e))},Ce.modulo=Ce.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(e=new r(e),!e.s)throw Error(Tr+"NaN");return n.s?(zt=!1,t=Wo(n,e,0,1).times(e),zt=!0,n.minus(t)):kt(new r(n),a)},Ce.naturalExponential=Ce.exp=function(){return mU(this)},Ce.naturalLogarithm=Ce.ln=function(){return yf(this)},Ce.negated=Ce.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},Ce.plus=Ce.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?hU(t,e):gU(t,(e.s=-e.s,e))},Ce.precision=Ce.sd=function(e){var t,n,r,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(vs+e);if(t=rn(a)+1,r=a.d.length-1,n=r*Lt+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},Ce.squareRoot=Ce.sqrt=function(){var e,t,n,r,a,o,i,s=this,c=s.constructor;if(s.s<1){if(!s.s)return new c(0);throw Error(Tr+"NaN")}for(e=rn(s),zt=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=Wa(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=vl((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(a.toString()),n=c.precision,a=i=n+3;;)if(o=r,r=o.plus(Wo(s,o,i+2)).times(.5),Wa(o.d).slice(0,i)===(t=Wa(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&t=="4999"){if(kt(o,n+1,0),o.times(o).eq(s)){r=o;break}}else if(t!="9999")break;i+=4}return zt=!0,kt(r,n)},Ce.times=Ce.mul=function(e){var t,n,r,a,o,i,s,c,l,u=this,d=u.constructor,f=u.d,p=(e=new d(e)).d;if(!u.s||!e.s)return new d(0);for(e.s*=u.s,n=u.e+e.e,c=f.length,l=p.length,c<l&&(o=f,f=p,p=o,i=c,c=l,l=i),o=[],i=c+l,r=i;r--;)o.push(0);for(r=l;--r>=0;){for(t=0,a=c+r;a>r;)s=o[a]+p[r]*f[a-r-1]+t,o[a--]=s%gn|0,t=s/gn|0;o[a]=(o[a]+t)%gn|0}for(;!o[--i];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,zt?kt(e,d.precision):e},Ce.toDecimalPlaces=Ce.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(Ua(e,0,gl),t===void 0?t=r.rounding:Ua(t,0,8),kt(n,e+rn(n)+1,t))},Ce.toExponential=function(e,t){var n,r=this,a=r.constructor;return e===void 0?n=ws(r,!0):(Ua(e,0,gl),t===void 0?t=a.rounding:Ua(t,0,8),r=kt(new a(r),e+1,t),n=ws(r,!0,e+1)),n},Ce.toFixed=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?ws(a):(Ua(e,0,gl),t===void 0?t=o.rounding:Ua(t,0,8),r=kt(new o(a),e+rn(a)+1,t),n=ws(r.abs(),!1,e+rn(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},Ce.toInteger=Ce.toint=function(){var e=this,t=e.constructor;return kt(new t(e),rn(e)+1,t.rounding)},Ce.toNumber=function(){return+this},Ce.toPower=Ce.pow=function(e){var t,n,r,a,o,i,s=this,c=s.constructor,l=12,u=+(e=new c(e));if(!e.s)return new c(wr);if(s=new c(s),!s.s){if(e.s<1)throw Error(Tr+"Infinity");return s}if(s.eq(wr))return s;if(r=c.precision,e.eq(wr))return kt(s,r);if(t=e.e,n=e.d.length-1,i=t>=n,o=s.s,i){if((n=u<0?-u:u)<=pU){for(a=new c(wr),t=Math.ceil(r/Lt+4),zt=!1;n%2&&(a=a.times(s),vU(a.d,t)),n=vl(n/2),n!==0;)s=s.times(s),vU(s.d,t);return zt=!0,e.s<0?new c(wr).div(a):kt(a,r)}}else if(o<0)throw Error(Tr+"NaN");return o=o<0&&e.d[Math.max(t,n)]&1?-1:1,s.s=1,zt=!1,a=e.times(yf(s,r+l)),zt=!0,a=mU(a),a.s=o,a},Ce.toPrecision=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?(n=rn(a),r=ws(a,n<=o.toExpNeg||n>=o.toExpPos)):(Ua(e,1,gl),t===void 0?t=o.rounding:Ua(t,0,8),a=kt(new o(a),e,t),n=rn(a),r=ws(a,e<=n||n<=o.toExpNeg,e)),r},Ce.toSignificantDigits=Ce.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(Ua(e,1,gl),t===void 0?t=r.rounding:Ua(t,0,8)),kt(new r(n),e,t)},Ce.toString=Ce.valueOf=Ce.val=Ce.toJSON=Ce[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=rn(e),n=e.constructor;return ws(e,t<=n.toExpNeg||t>=n.toExpPos)};function hU(e,t){var n,r,a,o,i,s,c,l,u=e.constructor,d=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),zt?kt(t,d):t;if(c=e.d,l=t.d,i=e.e,a=t.e,c=c.slice(),o=i-a,o){for(o<0?(r=c,o=-o,s=l.length):(r=l,a=i,s=c.length),i=Math.ceil(d/Lt),s=i>s?i+1:s+1,o>s&&(o=s,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(s=c.length,o=l.length,s-o<0&&(o=s,r=l,l=c,c=r),n=0;o;)n=(c[--o]=c[o]+l[o]+n)/gn|0,c[o]%=gn;for(n&&(c.unshift(n),++a),s=c.length;c[--s]==0;)c.pop();return t.d=c,t.e=a,zt?kt(t,d):t}function Ua(e,t,n){if(e!==~~e||e<t||e>n)throw Error(vs+e)}function Wa(e){var t,n,r,a=e.length-1,o="",i=e[0];if(a>0){for(o+=i,t=1;t<a;t++)r=e[t]+"",n=Lt-r.length,n&&(o+=Ni(n)),o+=r;i=e[t],r=i+"",n=Lt-r.length,n&&(o+=Ni(n))}else if(i===0)return"0";for(;i%10===0;)i/=10;return o+i}var Wo=function(){function e(r,a){var o,i=0,s=r.length;for(r=r.slice();s--;)o=r[s]*a+i,r[s]=o%gn|0,i=o/gn|0;return i&&r.unshift(i),r}function t(r,a,o,i){var s,c;if(o!=i)c=o>i?1:-1;else for(s=c=0;s<o;s++)if(r[s]!=a[s]){c=r[s]>a[s]?1:-1;break}return c}function n(r,a,o){for(var i=0;o--;)r[o]-=i,i=r[o]<a[o]?1:0,r[o]=i*gn+r[o]-a[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,o,i){var s,c,l,u,d,f,p,y,m,v,b,w,_,x,j,S,E,O,M=r.constructor,N=r.s==a.s?1:-1,P=r.d,R=a.d;if(!r.s)return new M(r);if(!a.s)throw Error(Tr+"Division by zero");for(c=r.e-a.e,E=R.length,j=P.length,p=new M(N),y=p.d=[],l=0;R[l]==(P[l]||0);)++l;if(R[l]>(P[l]||0)&&--c,o==null?w=o=M.precision:i?w=o+(rn(r)-rn(a))+1:w=o,w<0)return new M(0);if(w=w/Lt+2|0,l=0,E==1)for(u=0,R=R[0],w++;(l<j||u)&&w--;l++)_=u*gn+(P[l]||0),y[l]=_/R|0,u=_%R|0;else{for(u=gn/(R[0]+1)|0,u>1&&(R=e(R,u),P=e(P,u),E=R.length,j=P.length),x=E,m=P.slice(0,E),v=m.length;v<E;)m[v++]=0;O=R.slice(),O.unshift(0),S=R[0],R[1]>=gn/2&&++S;do u=0,s=t(R,m,E,v),s<0?(b=m[0],E!=v&&(b=b*gn+(m[1]||0)),u=b/S|0,u>1?(u>=gn&&(u=gn-1),d=e(R,u),f=d.length,v=m.length,s=t(d,m,f,v),s==1&&(u--,n(d,E<f?O:R,f))):(u==0&&(s=u=1),d=R.slice()),f=d.length,f<v&&d.unshift(0),n(m,d,v),s==-1&&(v=m.length,s=t(R,m,E,v),s<1&&(u++,n(m,E<v?O:R,v))),v=m.length):s===0&&(u++,m=[0]),y[l++]=u,s&&m[0]?m[v++]=P[x]||0:(m=[P[x]],v=1);while((x++<j||m[0]!==void 0)&&w--)}return y[0]||y.shift(),p.e=c,kt(p,i?o+rn(p)+1:o)}}();function mU(e,t){var n,r,a,o,i,s,c=0,l=0,u=e.constructor,d=u.precision;if(rn(e)>16)throw Error(SC+rn(e));if(!e.s)return new u(wr);for(t==null?(zt=!1,s=d):s=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),l+=5;for(r=Math.log(bs(2,l))/Math.LN10*2+5|0,s+=r,n=a=o=new u(wr),u.precision=s;;){if(a=kt(a.times(e),s),n=n.times(++c),i=o.plus(Wo(a,n,s)),Wa(i.d).slice(0,s)===Wa(o.d).slice(0,s)){for(;l--;)o=kt(o.times(o),s);return u.precision=d,t==null?(zt=!0,kt(o,d)):o}o=i}}function rn(e){for(var t=e.e*Lt,n=e.d[0];n>=10;n/=10)t++;return t}function EC(e,t,n){if(t>e.LN10.sd())throw zt=!0,n&&(e.precision=n),Error(Tr+"LN10 precision limit exceeded");return kt(new e(e.LN10),t)}function Ni(e){for(var t="";e--;)t+="0";return t}function yf(e,t){var n,r,a,o,i,s,c,l,u,d=1,f=10,p=e,y=p.d,m=p.constructor,v=m.precision;if(p.s<1)throw Error(Tr+(p.s?"NaN":"-Infinity"));if(p.eq(wr))return new m(0);if(t==null?(zt=!1,l=v):l=t,p.eq(10))return t==null&&(zt=!0),EC(m,l);if(l+=f,m.precision=l,n=Wa(y),r=n.charAt(0),o=rn(p),Math.abs(o)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)p=p.times(e),n=Wa(p.d),r=n.charAt(0),d++;o=rn(p),r>1?(p=new m("0."+n),o++):p=new m(r+"."+n.slice(1))}else return c=EC(m,l+2,v).times(o+""),p=yf(new m(r+"."+n.slice(1)),l-f).plus(c),m.precision=v,t==null?(zt=!0,kt(p,v)):p;for(s=i=p=Wo(p.minus(wr),p.plus(wr),l),u=kt(p.times(p),l),a=3;;){if(i=kt(i.times(u),l),c=s.plus(Wo(i,new m(a),l)),Wa(c.d).slice(0,l)===Wa(s.d).slice(0,l))return s=s.times(2),o!==0&&(s=s.plus(EC(m,l+2,v).times(o+""))),s=Wo(s,new m(d),l),m.precision=v,t==null?(zt=!0,kt(s,v)):s;s=c,a+=2}}function yU(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=vl(n/Lt),e.d=[],r=(n+1)%Lt,n<0&&(r+=Lt),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=Lt;r<a;)e.d.push(+t.slice(r,r+=Lt));t=t.slice(r),r=Lt-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),zt&&(e.e>ag||e.e<-ag))throw Error(SC+n)}else e.s=0,e.e=0,e.d=[0];return e}function kt(e,t,n){var r,a,o,i,s,c,l,u,d=e.d;for(i=1,o=d[0];o>=10;o/=10)i++;if(r=t-i,r<0)r+=Lt,a=t,l=d[u=0];else{if(u=Math.ceil((r+1)/Lt),o=d.length,u>=o)return e;for(l=o=d[u],i=1;o>=10;o/=10)i++;r%=Lt,a=r-Lt+i}if(n!==void 0&&(o=bs(10,i-a-1),s=l/o%10|0,c=t<0||d[u+1]!==void 0||l%o,c=n<4?(s||c)&&(n==0||n==(e.s<0?3:2)):s>5||s==5&&(n==4||c||n==6&&(r>0?a>0?l/bs(10,i-a):0:d[u-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return c?(o=rn(e),d.length=1,t=t-o-1,d[0]=bs(10,(Lt-t%Lt)%Lt),e.e=vl(-t/Lt)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=u,o=1,u--):(d.length=u+1,o=bs(10,Lt-r),d[u]=a>0?(l/bs(10,i-a)%bs(10,a)|0)*o:0),c)for(;;)if(u==0){(d[0]+=o)==gn&&(d[0]=1,++e.e);break}else{if(d[u]+=o,d[u]!=gn)break;d[u--]=0,o=1}for(r=d.length;d[--r]===0;)d.pop();if(zt&&(e.e>ag||e.e<-ag))throw Error(SC+rn(e));return e}function gU(e,t){var n,r,a,o,i,s,c,l,u,d,f=e.constructor,p=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),zt?kt(t,p):t;if(c=e.d,d=t.d,r=t.e,l=e.e,c=c.slice(),i=l-r,i){for(u=i<0,u?(n=c,i=-i,s=d.length):(n=d,r=l,s=c.length),a=Math.max(Math.ceil(p/Lt),s)+2,i>a&&(i=a,n.length=1),n.reverse(),a=i;a--;)n.push(0);n.reverse()}else{for(a=c.length,s=d.length,u=a<s,u&&(s=a),a=0;a<s;a++)if(c[a]!=d[a]){u=c[a]<d[a];break}i=0}for(u&&(n=c,c=d,d=n,t.s=-t.s),s=c.length,a=d.length-s;a>0;--a)c[s++]=0;for(a=d.length;a>i;){if(c[--a]<d[a]){for(o=a;o&&c[--o]===0;)c[o]=gn-1;--c[o],c[a]+=gn}c[a]-=d[a]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,zt?kt(t,p):t):new f(0)}function ws(e,t,n){var r,a=rn(e),o=Wa(e.d),i=o.length;return t?(n&&(r=n-i)>0?o=o.charAt(0)+"."+o.slice(1)+Ni(r):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(a<0?"e":"e+")+a):a<0?(o="0."+Ni(-a-1)+o,n&&(r=n-i)>0&&(o+=Ni(r))):a>=i?(o+=Ni(a+1-i),n&&(r=n-a-1)>0&&(o=o+"."+Ni(r))):((r=a+1)<i&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-i)>0&&(a+1===i&&(o+="."),o+=Ni(r))),e.s<0?"-"+o:o}function vU(e,t){if(e.length>t)return e.length=t,!0}function bU(e){var t,n,r;function a(o){var i=this;if(!(i instanceof a))return new a(o);if(i.constructor=a,o instanceof a){i.s=o.s,i.e=o.e,i.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(vs+o);if(o>0)i.s=1;else if(o<0)o=-o,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(o===~~o&&o<1e7){i.e=0,i.d=[o];return}return yU(i,o.toString())}else if(typeof o!="string")throw Error(vs+o);if(o.charCodeAt(0)===45?(o=o.slice(1),i.s=-1):i.s=1,mEe.test(o))yU(i,o);else throw Error(vs+o)}if(a.prototype=Ce,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=bU,a.config=a.set=yEe,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return a.config(e),a}function yEe(e){if(!e||typeof e!="object")throw Error(Tr+"Object expected");var t,n,r,a=["precision",1,gl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((r=e[n=a[t]])!==void 0)if(vl(r)===r&&r>=a[t+1]&&r<=a[t+2])this[n]=r;else throw Error(vs+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(vs+n+": "+r);return this}var OC=bU(hEe);wr=new OC(1);const Mt=OC;function gEe(e){return xEe(e)||wEe(e)||bEe(e)||vEe()}function vEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bEe(e,t){if(e){if(typeof e=="string")return CC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CC(e,t)}}function wEe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function xEe(e){if(Array.isArray(e))return CC(e)}function CC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _Ee=function(e){return e},wU={"@@functional/placeholder":!0},xU=function(e){return e===wU},_U=function(e){return function t(){return arguments.length===0||arguments.length===1&&xU(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},jEe=function e(t,n){return t===1?n:_U(function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var i=a.filter(function(s){return s!==wU}).length;return i>=t?n.apply(void 0,a):e(t-i,_U(function(){for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=a.map(function(d){return xU(d)?c.shift():d});return n.apply(void 0,gEe(u).concat(c))}))})},og=function(e){return jEe(e.length,e)},NC=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},SEe=og(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),EEe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return _Ee;var r=t.reverse(),a=r[0],o=r.slice(1);return function(){return o.reduce(function(i,s){return s(i)},a.apply(void 0,arguments))}},MC=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},jU=function(e){var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t&&a.every(function(i,s){return i===t[s]})||(t=a,n=e.apply(void 0,a)),n}};function OEe(e){var t;return e===0?t=1:t=Math.floor(new Mt(e).abs().log(10).toNumber())+1,t}function CEe(e,t,n){for(var r=new Mt(e),a=0,o=[];r.lt(t)&&a<1e5;)o.push(r.toNumber()),r=r.add(n),a++;return o}var NEe=og(function(e,t,n){var r=+e,a=+t;return r+n*(a-r)}),MEe=og(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),PEe=og(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const ig={rangeStep:CEe,getDigitCount:OEe,interpolateNumber:NEe,uninterpolateNumber:MEe,uninterpolateTruncation:PEe};function PC(e){return TEe(e)||AEe(e)||SU(e)||kEe()}function kEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AEe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function TEe(e){if(Array.isArray(e))return kC(e)}function gf(e,t){return DEe(e)||IEe(e,t)||SU(e,t)||REe()}function REe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SU(e,t){if(e){if(typeof e=="string")return kC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kC(e,t)}}function kC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function IEe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),s;!(r=(s=i.next()).done)&&(n.push(s.value),!(t&&n.length===t));r=!0);}catch(c){a=!0,o=c}finally{try{!r&&i.return!=null&&i.return()}finally{if(a)throw o}}return n}}function DEe(e){if(Array.isArray(e))return e}function EU(e){var t=gf(e,2),n=t[0],r=t[1],a=n,o=r;return n>r&&(a=r,o=n),[a,o]}function OU(e,t,n){if(e.lte(0))return new Mt(0);var r=ig.getDigitCount(e.toNumber()),a=new Mt(10).pow(r),o=e.div(a),i=r!==1?.05:.1,s=new Mt(Math.ceil(o.div(i).toNumber())).add(n).mul(i),c=s.mul(a);return t?c:new Mt(Math.ceil(c))}function LEe(e,t,n){var r=1,a=new Mt(e);if(!a.isint()&&n){var o=Math.abs(e);o<1?(r=new Mt(10).pow(ig.getDigitCount(e)-1),a=new Mt(Math.floor(a.div(r).toNumber())).mul(r)):o>1&&(a=new Mt(Math.floor(e)))}else e===0?a=new Mt(Math.floor((t-1)/2)):n||(a=new Mt(Math.floor(e)));var i=Math.floor((t-1)/2),s=EEe(SEe(function(c){return a.add(new Mt(c-i).mul(r)).toNumber()}),NC);return s(0,t)}function CU(e,t,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Mt(0),tickMin:new Mt(0),tickMax:new Mt(0)};var o=OU(new Mt(t).sub(e).div(n-1),r,a),i;e<=0&&t>=0?i=new Mt(0):(i=new Mt(e).add(t).div(2),i=i.sub(new Mt(i).mod(o)));var s=Math.ceil(i.sub(e).div(o).toNumber()),c=Math.ceil(new Mt(t).sub(i).div(o).toNumber()),l=s+c+1;return l>n?CU(e,t,n,r,a+1):(l<n&&(c=t>0?c+(n-l):c,s=t>0?s:s+(n-l)),{step:o,tickMin:i.sub(new Mt(s).mul(o)),tickMax:i.add(new Mt(c).mul(o))})}function $Ee(e){var t=gf(e,2),n=t[0],r=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),s=EU([n,r]),c=gf(s,2),l=c[0],u=c[1];if(l===-1/0||u===1/0){var d=u===1/0?[l].concat(PC(NC(0,a-1).map(function(){return 1/0}))):[].concat(PC(NC(0,a-1).map(function(){return-1/0})),[u]);return n>r?MC(d):d}if(l===u)return LEe(l,a,o);var f=CU(l,u,i,o),p=f.step,y=f.tickMin,m=f.tickMax,v=ig.rangeStep(y,m.add(new Mt(.1).mul(p)),p);return n>r?MC(v):v}function FEe(e,t){var n=gf(e,2),r=n[0],a=n[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=EU([r,a]),s=gf(i,2),c=s[0],l=s[1];if(c===-1/0||l===1/0)return[r,a];if(c===l)return[c];var u=Math.max(t,2),d=OU(new Mt(l).sub(c).div(u-1),o,0),f=[].concat(PC(ig.rangeStep(new Mt(c),new Mt(l).sub(new Mt(.99).mul(d)),d)),[l]);return r>a?MC(f):f}var BEe=jU($Ee),zEe=jU(FEe),VEe="Invariant failed";function xs(e,t){throw new Error(VEe)}var qEe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function bl(e){"@babel/helpers - typeof";return bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bl(e)}function sg(){return sg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sg.apply(this,arguments)}function UEe(e,t){return KEe(e)||ZEe(e,t)||HEe(e,t)||WEe()}function WEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HEe(e,t){if(e){if(typeof e=="string")return NU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NU(e,t)}}function NU(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ZEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function KEe(e){if(Array.isArray(e))return e}function XEe(e,t){if(e==null)return{};var n=GEe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function GEe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function QEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JEe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kU(r.key),r)}}function YEe(e,t,n){return t&&JEe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function eOe(e,t,n){return t=cg(t),tOe(e,MU()?Reflect.construct(t,n||[],cg(e).constructor):t.apply(e,n))}function tOe(e,t){if(t&&(bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nOe(e)}function nOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MU=function(){return!!e})()}function cg(e){return cg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cg(e)}function rOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AC(e,t)}function AC(e,t){return AC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},AC(e,t)}function PU(e,t,n){return t=kU(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kU(e){var t=aOe(e,"string");return bl(t)=="symbol"?t:t+""}function aOe(e,t){if(bl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lg=function(e){function t(){return QEe(this,t),eOe(this,t,arguments)}return rOe(t,e),YEe(t,[{key:"render",value:function(){var n=this.props,r=n.offset,a=n.layout,o=n.width,i=n.dataKey,s=n.data,c=n.dataPointFormatter,l=n.xAxis,u=n.yAxis,d=XEe(n,qEe),f=gt(d,!1);this.props.direction==="x"&&l.type!=="number"&&xs();var p=s.map(function(y){var m=c(y,i),v=m.x,b=m.y,w=m.value,_=m.errorVal;if(!_)return null;var x=[],j,S;if(Array.isArray(_)){var E=UEe(_,2);j=E[0],S=E[1]}else j=S=_;if(a==="vertical"){var O=l.scale,M=b+r,N=M+o,P=M-o,R=O(w-j),k=O(w+S);x.push({x1:k,y1:N,x2:k,y2:P}),x.push({x1:R,y1:M,x2:k,y2:M}),x.push({x1:R,y1:N,x2:R,y2:P})}else if(a==="horizontal"){var C=u.scale,T=v+r,A=T-o,I=T+o,L=C(w-j),D=C(w+S);x.push({x1:A,y1:D,x2:I,y2:D}),x.push({x1:T,y1:L,x2:T,y2:D}),x.push({x1:A,y1:L,x2:I,y2:L})}return W.createElement(mn,sg({className:"recharts-errorBar",key:"bar-".concat(x.map(function(B){return"".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)}))},f),x.map(function(B){return W.createElement("line",sg({},B,{key:"line-".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)}))}))});return W.createElement(mn,{className:"recharts-errorBars"},p)}}])}(W.Component);PU(lg,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),PU(lg,"displayName","ErrorBar");function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function AU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function _s(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AU(Object(n),!0).forEach(function(r){oOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function oOe(e,t,n){return t=iOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iOe(e){var t=sOe(e,"string");return vf(t)=="symbol"?t:t+""}function sOe(e,t){if(vf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(vf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TU=function(e){var t=e.children,n=e.formattedGraphicalItems,r=e.legendWidth,a=e.legendContent,o=br(t,cl);if(!o)return null;var i=cl.defaultProps,s=i!==void 0?_s(_s({},i),o.props):{},c;return o.props&&o.props.payload?c=o.props&&o.props.payload:a==="children"?c=(n||[]).reduce(function(l,u){var d=u.item,f=u.props,p=f.sectors||f.data||[];return l.concat(p.map(function(y){return{type:o.props.iconType||d.props.legendType,value:y.name,color:y.fill,payload:y}}))},[]):c=(n||[]).map(function(l){var u=l.item,d=u.type.defaultProps,f=d!==void 0?_s(_s({},d),u.props):{},p=f.dataKey,y=f.name,m=f.legendType,v=f.hide;return{inactive:v,dataKey:p,type:s.iconType||m||"square",color:RC(u),value:y||p,payload:f}}),_s(_s(_s({},s),cl.getWithHeight(o,r)),{},{payload:c,item:o})};function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function RU(e){return dOe(e)||uOe(e)||lOe(e)||cOe()}function cOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lOe(e,t){if(e){if(typeof e=="string")return TC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TC(e,t)}}function uOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dOe(e){if(Array.isArray(e))return TC(e)}function TC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function IU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IU(Object(n),!0).forEach(function(r){wl(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function wl(e,t,n){return t=fOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fOe(e){var t=pOe(e,"string");return bf(t)=="symbol"?t:t+""}function pOe(e,t){if(bf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ha(e,t,n){return vt(e)||vt(t)?n:un(t)?Cr(e,t,n):tt(t)?t(e):n}function ug(e,t,n,r){var a=dEe(e,function(s){return Ha(s,t)});if(n==="number"){var o=a.filter(function(s){return ye(s)||parseFloat(s)});return o.length?[rg(o),ng(o)]:[1/0,-1/0]}var i=r?a.filter(function(s){return!vt(s)}):a;return i.map(function(s){return un(s)||s instanceof Date?s:""})}var hOe=function(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,i=(t=n==null?void 0:n.length)!==null&&t!==void 0?t:0;if(i<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var s=a.range,c=0;c<i;c++){var l=c>0?r[c-1].coordinate:r[i-1].coordinate,u=r[c].coordinate,d=c>=i-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(ya(u-l)!==ya(d-u)){var p=[];if(ya(d-u)===ya(s[1]-s[0])){f=d;var y=u+s[1]-s[0];p[0]=Math.min(y,(y+l)/2),p[1]=Math.max(y,(y+l)/2)}else{f=l;var m=d+s[1]-s[0];p[0]=Math.min(u,(m+u)/2),p[1]=Math.max(u,(m+u)/2)}var v=[Math.min(u,(f+u)/2),Math.max(u,(f+u)/2)];if(e>v[0]&&e<=v[1]||e>=p[0]&&e<=p[1]){o=r[c].index;break}}else{var b=Math.min(l,d),w=Math.max(l,d);if(e>(b+u)/2&&e<=(w+u)/2){o=r[c].index;break}}}else for(var _=0;_<i;_++)if(_===0&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_>0&&_<i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_===i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2){o=n[_].index;break}return o},RC=function(e){var t,n=e,r=n.type.displayName,a=(t=e.type)!==null&&t!==void 0&&t.defaultProps?Kt(Kt({},e.type.defaultProps),e.props):e.props,o=a.stroke,i=a.fill,s;switch(r){case"Line":s=o;break;case"Area":case"Radar":s=o&&o!=="none"?o:i;break;default:s=i;break}return s},mOe=function(e){var t=e.barSize,n=e.totalSize,r=e.stackGroups,a=r===void 0?{}:r;if(!a)return{};for(var o={},i=Object.keys(a),s=0,c=i.length;s<c;s++)for(var l=a[i[s]].stackGroups,u=Object.keys(l),d=0,f=u.length;d<f;d++){var p=l[u[d]],y=p.items,m=p.cateAxisId,v=y.filter(function(S){return Do(S.type).indexOf("Bar")>=0});if(v&&v.length){var b=v[0].type.defaultProps,w=b!==void 0?Kt(Kt({},b),v[0].props):v[0].props,_=w.barSize,x=w[m];o[x]||(o[x]=[]);var j=vt(_)?t:_;o[x].push({item:v[0],stackList:v.slice(1),barSize:vt(j)?void 0:ps(j,n,0)})}}return o},yOe=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,a=e.sizeList,o=a===void 0?[]:a,i=e.maxBarSize,s=o.length;if(s<1)return null;var c=ps(t,r,0,!0),l,u=[];if(o[0].barSize===+o[0].barSize){var d=!1,f=r/s,p=o.reduce(function(_,x){return _+x.barSize||0},0);p+=(s-1)*c,p>=r&&(p-=(s-1)*c,c=0),p>=r&&f>0&&(d=!0,f*=.9,p=s*f);var y=(r-p)/2>>0,m={offset:y-c,size:0};l=o.reduce(function(_,x){var j={item:x.item,position:{offset:m.offset+m.size+c,size:d?f:x.barSize}},S=[].concat(RU(_),[j]);return m=S[S.length-1].position,x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){S.push({item:E,position:m})}),S},u)}else{var v=ps(n,r,0,!0);r-2*v-(s-1)*c<=0&&(c=0);var b=(r-2*v-(s-1)*c)/s;b>1&&(b>>=0);var w=i===+i?Math.min(b,i):b;l=o.reduce(function(_,x,j){var S=[].concat(RU(_),[{item:x.item,position:{offset:v+(b+c)*j+(b-w)/2,size:w}}]);return x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){S.push({item:E,position:S[S.length-1].position})}),S},u)}return l},gOe=function(e,t,n,r){var a=n.children,o=n.width,i=n.margin,s=o-(i.left||0)-(i.right||0),c=TU({children:a,legendWidth:s});if(c){var l=r||{},u=l.width,d=l.height,f=c.align,p=c.verticalAlign,y=c.layout;if((y==="vertical"||y==="horizontal"&&p==="middle")&&f!=="center"&&ye(e[f]))return Kt(Kt({},e),{},wl({},f,e[f]+(u||0)));if((y==="horizontal"||y==="vertical"&&f==="center")&&p!=="middle"&&ye(e[p]))return Kt(Kt({},e),{},wl({},p,e[p]+(d||0)))}return e},vOe=function(e,t,n){return vt(t)?!0:e==="horizontal"?t==="yAxis":e==="vertical"||n==="x"?t==="xAxis":n==="y"?t==="yAxis":!0},DU=function(e,t,n,r,a){var o=t.props.children,i=ga(o,lg).filter(function(c){return vOe(r,a,c.props.direction)});if(i&&i.length){var s=i.map(function(c){return c.props.dataKey});return e.reduce(function(c,l){var u=Ha(l,n);if(vt(u))return c;var d=Array.isArray(u)?[rg(u),ng(u)]:[u,u],f=s.reduce(function(p,y){var m=Ha(l,y,0),v=d[0]-Math.abs(Array.isArray(m)?m[0]:m),b=d[1]+Math.abs(Array.isArray(m)?m[1]:m);return[Math.min(v,p[0]),Math.max(b,p[1])]},[1/0,-1/0]);return[Math.min(f[0],c[0]),Math.max(f[1],c[1])]},[1/0,-1/0])}return null},bOe=function(e,t,n,r,a){var o=t.map(function(i){return DU(e,i,n,a,r)}).filter(function(i){return!vt(i)});return o&&o.length?o.reduce(function(i,s){return[Math.min(i[0],s[0]),Math.max(i[1],s[1])]},[1/0,-1/0]):null},LU=function(e,t,n,r,a){var o=t.map(function(s){var c=s.props.dataKey;return n==="number"&&c&&DU(e,s,c,r)||ug(e,c,n,a)});if(n==="number")return o.reduce(function(s,c){return[Math.min(s[0],c[0]),Math.max(s[1],c[1])]},[1/0,-1/0]);var i={};return o.reduce(function(s,c){for(var l=0,u=c.length;l<u;l++)i[c[l]]||(i[c[l]]=!0,s.push(c[l]));return s},[])},$U=function(e,t){return e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis"},FU=function(e,t,n,r){if(r)return e.map(function(s){return s.coordinate});var a,o,i=e.map(function(s){return s.coordinate===t&&(a=!0),s.coordinate===n&&(o=!0),s.coordinate});return a||i.push(t),o||i.push(n),i},Ho=function(e,t,n){if(!e)return null;var r=e.scale,a=e.duplicateDomain,o=e.type,i=e.range,s=e.realScaleType==="scaleBand"?r.bandwidth()/2:2,c=(t||n)&&o==="category"&&r.bandwidth?r.bandwidth()/s:0;if(c=e.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?ya(i[0]-i[1])*2*c:c,t&&(e.ticks||e.niceTicks)){var l=(e.ticks||e.niceTicks).map(function(u){var d=a?a.indexOf(u):u;return{coordinate:r(d)+c,value:u,offset:c}});return l.filter(function(u){return!Xd(u.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(u,d){return{coordinate:r(u)+c,value:u,index:d,offset:c}}):r.ticks&&!n?r.ticks(e.tickCount).map(function(u){return{coordinate:r(u)+c,value:u,offset:c}}):r.domain().map(function(u,d){return{coordinate:r(u)+c,value:a?a[u]:u,index:d,offset:c}})},IC=new WeakMap,dg=function(e,t){if(typeof t!="function")return e;IC.has(e)||IC.set(e,new WeakMap);var n=IC.get(e);if(n.has(t))return n.get(t);var r=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return n.set(t,r),r},wOe=function(e,t,n){var r=e.scale,a=e.type,o=e.layout,i=e.axisType;if(r==="auto")return o==="radial"&&i==="radiusAxis"?{scale:cf(),realScaleType:"band"}:o==="radial"&&i==="angleAxis"?{scale:Zy(),realScaleType:"linear"}:a==="category"&&t&&(t.indexOf("LineChart")>=0||t.indexOf("AreaChart")>=0||t.indexOf("ComposedChart")>=0&&!n)?{scale:lf(),realScaleType:"point"}:a==="category"?{scale:cf(),realScaleType:"band"}:{scale:Zy(),realScaleType:"linear"};if(Kd(r)){var s="scale".concat(_y(r));return{scale:(rU[s]||lf)(),realScaleType:rU[s]?s:"point"}}return tt(r)?{scale:r}:{scale:lf(),realScaleType:"point"}},BU=1e-4,xOe=function(e){var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-BU,o=Math.max(r[0],r[1])+BU,i=e(t[0]),s=e(t[n-1]);(i<a||i>o||s<a||s>o)&&e.domain([t[0],t[n-1]])}},_Oe=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null},jOe=function(e,t){if(!t||t.length!==2||!ye(t[0])||!ye(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!ye(e[0])||e[0]<n)&&(a[0]=n),(!ye(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a},SOe=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0,i=0;i<t;++i){var s=Xd(e[i][n][1])?e[i][n][0]:e[i][n][1];s>=0?(e[i][n][0]=a,e[i][n][1]=a+s,a=e[i][n][1]):(e[i][n][0]=o,e[i][n][1]=o+s,o=e[i][n][1])}},EOe=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0;o<t;++o){var i=Xd(e[o][n][1])?e[o][n][0]:e[o][n][1];i>=0?(e[o][n][0]=a,e[o][n][1]=a+i,a=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}},OOe={sign:SOe,expand:Cxe,none:ol,silhouette:Nxe,wiggle:Mxe,positive:EOe},COe=function(e,t,n){var r=t.map(function(i){return i.props.dataKey}),a=OOe[n],o=Oxe().keys(r).value(function(i,s){return+Ha(i,s,0)}).order(qE).offset(a);return o(e)},NOe=function(e,t,n,r,a,o){if(!e)return null;var i=o?t.reverse():t,s={},c=i.reduce(function(u,d){var f,p=(f=d.type)!==null&&f!==void 0&&f.defaultProps?Kt(Kt({},d.type.defaultProps),d.props):d.props,y=p.stackId,m=p.hide;if(m)return u;var v=p[n],b=u[v]||{hasStack:!1,stackGroups:{}};if(un(y)){var w=b.stackGroups[y]||{numericAxisId:n,cateAxisId:r,items:[]};w.items.push(d),b.hasStack=!0,b.stackGroups[y]=w}else b.stackGroups[by("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[d]};return Kt(Kt({},u),{},wl({},v,b))},s),l={};return Object.keys(c).reduce(function(u,d){var f=c[d];if(f.hasStack){var p={};f.stackGroups=Object.keys(f.stackGroups).reduce(function(y,m){var v=f.stackGroups[m];return Kt(Kt({},y),{},wl({},m,{numericAxisId:n,cateAxisId:r,items:v.items,stackedData:COe(e,v.items,a)}))},p)}return Kt(Kt({},u),{},wl({},d,f))},l)},MOe=function(e,t){var n=t.realScaleType,r=t.type,a=t.tickCount,o=t.originalDomain,i=t.allowDecimals,s=n||t.scale;if(s!=="auto"&&s!=="linear")return null;if(a&&r==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=e.domain();if(!c.length)return null;var l=BEe(c,a,i);return e.domain([rg(l),ng(l)]),{niceTicks:l}}if(a&&r==="number"){var u=e.domain(),d=zEe(u,a,i);return{niceTicks:d}}return null},zU=function(e){var t=e.axis,n=e.ticks,r=e.offset,a=e.bandSize,o=e.entry,i=e.index;if(t.type==="category")return n[i]?n[i].coordinate+r:null;var s=Ha(o,t.dataKey,t.domain[i]);return vt(s)?null:t.scale(s)-a/2+r},POe=function(e){var t=e.numericAxis,n=t.scale.domain();if(t.type==="number"){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]},kOe=function(e,t){var n,r=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Kt(Kt({},e.type.defaultProps),e.props):e.props,a=r.stackId;if(un(a)){var o=t[a];if(o){var i=o.items.indexOf(e);return i>=0?o.stackedData[i]:null}}return null},AOe=function(e){return e.reduce(function(t,n){return[rg(n.concat([t[0]]).filter(ye)),ng(n.concat([t[1]]).filter(ye))]},[1/0,-1/0])},VU=function(e,t,n){return Object.keys(e).reduce(function(r,a){var o=e[a],i=o.stackedData,s=i.reduce(function(c,l){var u=AOe(l.slice(t,n+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]).map(function(r){return r===1/0||r===-1/0?0:r})},qU=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,UU=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,DC=function(e,t,n){if(tt(e))return e(t,n);if(!Array.isArray(e))return t;var r=[];if(ye(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(qU.test(e[0])){var a=+qU.exec(e[0])[1];r[0]=t[0]-a}else tt(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(ye(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(UU.test(e[1])){var o=+UU.exec(e[1])[1];r[1]=t[1]+o}else tt(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},fg=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=CO(t,function(u){return u.coordinate}),o=1/0,i=1,s=a.length;i<s;i++){var c=a[i],l=a[i-1];o=Math.min((c.coordinate||0)-(l.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},WU=function(e,t,n){return!e||!e.length||jC(e,Cr(n,"type.defaultProps.domain"))?t:e},HU=function(e,t){var n=e.type.defaultProps?Kt(Kt({},e.type.defaultProps),e.props):e.props,r=n.dataKey,a=n.name,o=n.unit,i=n.formatter,s=n.tooltipType,c=n.chartType,l=n.hide;return Kt(Kt({},gt(e,!1)),{},{dataKey:r,unit:o,formatter:i,name:a||r,color:RC(e),value:Ha(t,r),type:s,payload:t,chartType:c,hide:l})};function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}function ZU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function KU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ZU(Object(n),!0).forEach(function(r){TOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function TOe(e,t,n){return t=ROe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ROe(e){var t=IOe(e,"string");return wf(t)=="symbol"?t:t+""}function IOe(e,t){if(wf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pg=Math.PI/180,DOe=function(e){return e*180/Math.PI},On=function(e,t,n,r){return{x:e+Math.cos(-pg*r)*n,y:t+Math.sin(-pg*r)*n}},LOe=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-o,2))},$Oe=function(e,t){var n=e.x,r=e.y,a=t.cx,o=t.cy,i=LOe({x:n,y:r},{x:a,y:o});if(i<=0)return{radius:i};var s=(n-a)/i,c=Math.acos(s);return r>o&&(c=2*Math.PI-c),{radius:i,angle:DOe(c),angleInRadian:c}},FOe=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),a=Math.floor(n/360),o=Math.min(r,a);return{startAngle:t-o*360,endAngle:n-o*360}},BOe=function(e,t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),o=Math.floor(r/360),i=Math.min(a,o);return e+i*360},XU=function(e,t){var n=e.x,r=e.y,a=$Oe({x:n,y:r},t),o=a.radius,i=a.angle,s=t.innerRadius,c=t.outerRadius;if(o<s||o>c)return!1;if(o===0)return!0;var l=FOe(t),u=l.startAngle,d=l.endAngle,f=i,p;if(u<=d){for(;f>d;)f-=360;for(;f<u;)f+=360;p=f>=u&&f<=d}else{for(;f>u;)f-=360;for(;f<d;)f+=360;p=f>=d&&f<=u}return p?KU(KU({},t),{},{radius:o,angle:BOe(f,t)}):null};function xf(e){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xf(e)}var zOe=["offset"];function VOe(e){return HOe(e)||WOe(e)||UOe(e)||qOe()}function qOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UOe(e,t){if(e){if(typeof e=="string")return LC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LC(e,t)}}function WOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HOe(e){if(Array.isArray(e))return LC(e)}function LC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ZOe(e,t){if(e==null)return{};var n=KOe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function KOe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function GU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GU(Object(n),!0).forEach(function(r){XOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function XOe(e,t,n){return t=GOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GOe(e){var t=QOe(e,"string");return xf(t)=="symbol"?t:t+""}function QOe(e,t){if(xf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _f(){return _f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_f.apply(this,arguments)}var JOe=function(e){var t=e.value,n=e.formatter,r=vt(e.children)?t:e.children;return tt(n)?n(r):r},YOe=function(e,t){var n=ya(t-e),r=Math.min(Math.abs(t-e),360);return n*r},eCe=function(e,t,n){var r=e.position,a=e.viewBox,o=e.offset,i=e.className,s=a,c=s.cx,l=s.cy,u=s.innerRadius,d=s.outerRadius,f=s.startAngle,p=s.endAngle,y=s.clockWise,m=(u+d)/2,v=YOe(f,p),b=v>=0?1:-1,w,_;r==="insideStart"?(w=f+b*o,_=y):r==="insideEnd"?(w=p-b*o,_=!y):r==="end"&&(w=p+b*o,_=y),_=v<=0?_:!_;var x=On(c,l,m,w),j=On(c,l,m,w+(_?1:-1)*359),S="M".concat(x.x,",").concat(x.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(_?0:1,`,
    `).concat(j.x,",").concat(j.y),E=vt(e.id)?by("recharts-radial-line-"):e.id;return W.createElement("text",_f({},n,{dominantBaseline:"central",className:_t("recharts-radial-bar-label",i)}),W.createElement("defs",null,W.createElement("path",{id:E,d:S})),W.createElement("textPath",{xlinkHref:"#".concat(E)},t))},tCe=function(e){var t=e.viewBox,n=e.offset,r=e.position,a=t,o=a.cx,i=a.cy,s=a.innerRadius,c=a.outerRadius,l=a.startAngle,u=a.endAngle,d=(l+u)/2;if(r==="outside"){var f=On(o,i,c+n,d),p=f.x,y=f.y;return{x:p,y,textAnchor:p>=o?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"end"};var m=(s+c)/2,v=On(o,i,m,d),b=v.x,w=v.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},nCe=function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,a=e.position,o=t,i=o.x,s=o.y,c=o.width,l=o.height,u=l>=0?1:-1,d=u*r,f=u>0?"end":"start",p=u>0?"start":"end",y=c>=0?1:-1,m=y*r,v=y>0?"end":"start",b=y>0?"start":"end";if(a==="top"){var w={x:i+c/2,y:s-u*r,textAnchor:"middle",verticalAnchor:f};return fn(fn({},w),n?{height:Math.max(s-n.y,0),width:c}:{})}if(a==="bottom"){var _={x:i+c/2,y:s+l+d,textAnchor:"middle",verticalAnchor:p};return fn(fn({},_),n?{height:Math.max(n.y+n.height-(s+l),0),width:c}:{})}if(a==="left"){var x={x:i-m,y:s+l/2,textAnchor:v,verticalAnchor:"middle"};return fn(fn({},x),n?{width:Math.max(x.x-n.x,0),height:l}:{})}if(a==="right"){var j={x:i+c+m,y:s+l/2,textAnchor:b,verticalAnchor:"middle"};return fn(fn({},j),n?{width:Math.max(n.x+n.width-j.x,0),height:l}:{})}var S=n?{width:c,height:l}:{};return a==="insideLeft"?fn({x:i+m,y:s+l/2,textAnchor:b,verticalAnchor:"middle"},S):a==="insideRight"?fn({x:i+c-m,y:s+l/2,textAnchor:v,verticalAnchor:"middle"},S):a==="insideTop"?fn({x:i+c/2,y:s+d,textAnchor:"middle",verticalAnchor:p},S):a==="insideBottom"?fn({x:i+c/2,y:s+l-d,textAnchor:"middle",verticalAnchor:f},S):a==="insideTopLeft"?fn({x:i+m,y:s+d,textAnchor:b,verticalAnchor:p},S):a==="insideTopRight"?fn({x:i+c-m,y:s+d,textAnchor:v,verticalAnchor:p},S):a==="insideBottomLeft"?fn({x:i+m,y:s+l-d,textAnchor:b,verticalAnchor:f},S):a==="insideBottomRight"?fn({x:i+c-m,y:s+l-d,textAnchor:v,verticalAnchor:f},S):nl(a)&&(ye(a.x)||fs(a.x))&&(ye(a.y)||fs(a.y))?fn({x:i+ps(a.x,c),y:s+ps(a.y,l),textAnchor:"end",verticalAnchor:"end"},S):fn({x:i+c/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},S)},rCe=function(e){return"cx"in e&&ye(e.cx)};function Rn(e){var t=e.offset,n=t===void 0?5:t,r=ZOe(e,zOe),a=fn({offset:n},r),o=a.viewBox,i=a.position,s=a.value,c=a.children,l=a.content,u=a.className,d=u===void 0?"":u,f=a.textBreakAll;if(!o||vt(s)&&vt(c)&&!g.isValidElement(l)&&!tt(l))return null;if(g.isValidElement(l))return g.cloneElement(l,a);var p;if(tt(l)){if(p=g.createElement(l,a),g.isValidElement(p))return p}else p=JOe(a);var y=rCe(o),m=gt(a,!0);if(y&&(i==="insideStart"||i==="insideEnd"||i==="end"))return eCe(a,p,m);var v=y?tCe(a):nCe(a);return W.createElement(zy,_f({className:_t("recharts-label",d)},m,v,{breakAll:f}),p)}Rn.displayName="Label";var QU=function(e){var t=e.cx,n=e.cy,r=e.angle,a=e.startAngle,o=e.endAngle,i=e.r,s=e.radius,c=e.innerRadius,l=e.outerRadius,u=e.x,d=e.y,f=e.top,p=e.left,y=e.width,m=e.height,v=e.clockWise,b=e.labelViewBox;if(b)return b;if(ye(y)&&ye(m)){if(ye(u)&&ye(d))return{x:u,y:d,width:y,height:m};if(ye(f)&&ye(p))return{x:f,y:p,width:y,height:m}}return ye(u)&&ye(d)?{x:u,y:d,width:0,height:0}:ye(t)&&ye(n)?{cx:t,cy:n,startAngle:a||r||0,endAngle:o||r||0,innerRadius:c||0,outerRadius:l||s||i||0,clockWise:v}:e.viewBox?e.viewBox:{}},aCe=function(e,t){return e?e===!0?W.createElement(Rn,{key:"label-implicit",viewBox:t}):un(e)?W.createElement(Rn,{key:"label-implicit",viewBox:t,value:e}):g.isValidElement(e)?e.type===Rn?g.cloneElement(e,{key:"label-implicit",viewBox:t}):W.createElement(Rn,{key:"label-implicit",content:e,viewBox:t}):tt(e)?W.createElement(Rn,{key:"label-implicit",content:e,viewBox:t}):nl(e)?W.createElement(Rn,_f({viewBox:t},e,{key:"label-implicit"})):null:null},oCe=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=QU(e),o=ga(r,Rn).map(function(s,c){return g.cloneElement(s,{viewBox:t||a,key:"label-".concat(c)})});if(!n)return o;var i=aCe(e.label,t||a);return[i].concat(VOe(o))};Rn.parseViewBox=QU,Rn.renderCallByParent=oCe;var $C,JU;lP=function(){if(JU)return $C;JU=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return $C=e,$C};var iCe=lP();_M=ot(iCe);function jf(e){"@babel/helpers - typeof";return jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jf(e)}var sCe=["valueAccessor"],cCe=["data","dataKey","clockWise","id","textBreakAll"];function lCe(e){return pCe(e)||fCe(e)||dCe(e)||uCe()}function uCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dCe(e,t){if(e){if(typeof e=="string")return FC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FC(e,t)}}function fCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pCe(e){if(Array.isArray(e))return FC(e)}function FC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hg(){return hg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hg.apply(this,arguments)}function YU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function eW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YU(Object(n),!0).forEach(function(r){hCe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hCe(e,t,n){return t=mCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mCe(e){var t=yCe(e,"string");return jf(t)=="symbol"?t:t+""}function yCe(e,t){if(jf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(jf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tW(e,t){if(e==null)return{};var n=gCe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function gCe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var vCe=function(e){return Array.isArray(e.value)?_M(e.value):e.value};function js(e){var t=e.valueAccessor,n=t===void 0?vCe:t,r=tW(e,sCe),a=r.data,o=r.dataKey,i=r.clockWise,s=r.id,c=r.textBreakAll,l=tW(r,cCe);return!a||!a.length?null:W.createElement(mn,{className:"recharts-label-list"},a.map(function(u,d){var f=vt(o)?n(u,d):Ha(u&&u.payload,o),p=vt(s)?{}:{id:"".concat(s,"-").concat(d)};return W.createElement(Rn,hg({},gt(u,!0),l,p,{parentViewBox:u.parentViewBox,value:f,textBreakAll:c,viewBox:Rn.parseViewBox(vt(i)?u:eW(eW({},u),{},{clockWise:i})),key:"label-".concat(d),index:d}))}))}js.displayName="LabelList";function bCe(e,t){return e?e===!0?W.createElement(js,{key:"labelList-implicit",data:t}):W.isValidElement(e)||tt(e)?W.createElement(js,{key:"labelList-implicit",data:t,content:e}):nl(e)?W.createElement(js,hg({data:t},e,{key:"labelList-implicit"})):null:null}function wCe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=ga(r,js).map(function(i,s){return g.cloneElement(i,{data:t,key:"labelList-".concat(s)})});if(!n)return a;var o=bCe(e.label,t);return[o].concat(lCe(a))}js.renderCallByParent=wCe;function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function BC(){return BC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},BC.apply(this,arguments)}function nW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function rW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nW(Object(n),!0).forEach(function(r){xCe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xCe(e,t,n){return t=_Ce(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _Ce(e){var t=jCe(e,"string");return Sf(t)=="symbol"?t:t+""}function jCe(e,t){if(Sf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Sf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SCe=function(e,t){var n=ya(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},mg=function(e){var t=e.cx,n=e.cy,r=e.radius,a=e.angle,o=e.sign,i=e.isExternal,s=e.cornerRadius,c=e.cornerIsExternal,l=s*(i?1:-1)+r,u=Math.asin(s/l)/pg,d=c?a:a+o*u,f=On(t,n,l,d),p=On(t,n,r,d),y=c?a-o*u:a,m=On(t,n,l*Math.cos(u*pg),y);return{center:f,circleTangency:p,lineTangency:m,theta:u}},aW=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.startAngle,i=e.endAngle,s=SCe(o,i),c=o+s,l=On(t,n,a,o),u=On(t,n,a,c),d="M ".concat(l.x,",").concat(l.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(o>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(r>0){var f=On(t,n,r,o),p=On(t,n,r,c);d+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(o<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},ECe=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.cornerRadius,i=e.forceCornerRadius,s=e.cornerIsExternal,c=e.startAngle,l=e.endAngle,u=ya(l-c),d=mg({cx:t,cy:n,radius:a,angle:c,sign:u,cornerRadius:o,cornerIsExternal:s}),f=d.circleTangency,p=d.lineTangency,y=d.theta,m=mg({cx:t,cy:n,radius:a,angle:l,sign:-u,cornerRadius:o,cornerIsExternal:s}),v=m.circleTangency,b=m.lineTangency,w=m.theta,_=s?Math.abs(c-l):Math.abs(c-l)-y-w;if(_<0)return i?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):aW({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:c,endAngle:l});var x="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(_>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(r>0){var j=mg({cx:t,cy:n,radius:r,angle:c,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),S=j.circleTangency,E=j.lineTangency,O=j.theta,M=mg({cx:t,cy:n,radius:r,angle:l,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),N=M.circleTangency,P=M.lineTangency,R=M.theta,k=s?Math.abs(c-l):Math.abs(c-l)-O-R;if(k<0&&o===0)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(P.x,",").concat(P.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(N.x,",").concat(N.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(k>180),",").concat(+(u>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(E.x,",").concat(E.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x},OCe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},oW=function(e){var t=rW(rW({},OCe),e),n=t.cx,r=t.cy,a=t.innerRadius,o=t.outerRadius,i=t.cornerRadius,s=t.forceCornerRadius,c=t.cornerIsExternal,l=t.startAngle,u=t.endAngle,d=t.className;if(o<a||l===u)return null;var f=_t("recharts-sector",d),p=o-a,y=ps(i,p,0,!0),m;return y>0&&Math.abs(l-u)<360?m=ECe({cx:n,cy:r,innerRadius:a,outerRadius:o,cornerRadius:Math.min(y,p/2),forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u}):m=aW({cx:n,cy:r,innerRadius:a,outerRadius:o,startAngle:l,endAngle:u}),W.createElement("path",BC({},gt(t,!0),{className:f,d:m,role:"img"}))};function Ef(e){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ef(e)}function zC(){return zC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zC.apply(this,arguments)}function iW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function sW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iW(Object(n),!0).forEach(function(r){CCe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function CCe(e,t,n){return t=NCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NCe(e){var t=MCe(e,"string");return Ef(t)=="symbol"?t:t+""}function MCe(e,t){if(Ef(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ef(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cW={curveBasisClosed:mxe,curveBasisOpen:yxe,curveBasis:hxe,curveBumpX:exe,curveBumpY:txe,curveLinearClosed:gxe,curveLinear:Oy,curveMonotoneX:vxe,curveMonotoneY:bxe,curveNatural:wxe,curveStep:xxe,curveStepAfter:jxe,curveStepBefore:_xe},yg=function(e){return e.x===+e.x&&e.y===+e.y},Of=function(e){return e.x},Cf=function(e){return e.y},PCe=function(e,t){if(tt(e))return e;var n="curve".concat(_y(e));return(n==="curveMonotone"||n==="curveBump")&&t?cW["".concat(n).concat(t==="vertical"?"Y":"X")]:cW[n]||Oy},kCe=function(e){var t=e.type,n=t===void 0?"linear":t,r=e.points,a=r===void 0?[]:r,o=e.baseLine,i=e.layout,s=e.connectNulls,c=s===void 0?!1:s,l=PCe(n,i),u=c?a.filter(function(y){return yg(y)}):a,d;if(Array.isArray(o)){var f=c?o.filter(function(y){return yg(y)}):o,p=u.map(function(y,m){return sW(sW({},y),{},{base:f[m]})});return i==="vertical"?d=Cy().y(Cf).x1(Of).x0(function(y){return y.base.x}):d=Cy().x(Of).y1(Cf).y0(function(y){return y.base.y}),d.defined(yg).curve(l),d(p)}return i==="vertical"&&ye(o)?d=Cy().y(Cf).x1(Of).x0(o):ye(o)?d=Cy().x(Of).y1(Cf).y0(o):d=f7().x(Of).y(Cf),d.defined(yg).curve(l),d(u)},lW=function(e){var t=e.className,n=e.points,r=e.path,a=e.pathRef;if((!n||!n.length)&&!r)return null;var o=n&&n.length?kCe(e):r;return W.createElement("path",zC({},gt(e,!1),wy(e),{className:_t("recharts-curve",t),d:o,ref:a}))},uW={exports:{}},VC,dW;function ACe(){if(dW)return VC;dW=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return VC=e,VC}var qC,fW;function TCe(){if(fW)return qC;fW=1;var e=ACe();function t(){}function n(){}return n.resetWarningCache=t,qC=function(){function r(i,s,c,l,u,d){if(d!==e){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o},qC}var pW;function RCe(){return pW||(pW=1,uW.exports=TCe()()),uW.exports}var ICe=RCe();const He=ot(ICe);var DCe=Object.getOwnPropertyNames,LCe=Object.getOwnPropertySymbols,$Ce=Object.prototype.hasOwnProperty;function hW(e,t){return function(n,r,a){return e(n,r,a)&&t(n,r,a)}}function gg(e){return function(t,n,r){if(!t||!n||typeof t!="object"||typeof n!="object")return e(t,n,r);var a=r.cache,o=a.get(t),i=a.get(n);if(o&&i)return o===n&&i===t;a.set(t,n),a.set(n,t);var s=e(t,n,r);return a.delete(t),a.delete(n),s}}function mW(e){return DCe(e).concat(LCe(e))}var yW=Object.hasOwn||function(e,t){return $Ce.call(e,t)};function xl(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var gW="_owner",vW=Object.getOwnPropertyDescriptor,bW=Object.keys;function FCe(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function BCe(e,t){return xl(e.getTime(),t.getTime())}function wW(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.entries(),o=0,i,s;(i=a.next())&&!i.done;){for(var c=t.entries(),l=!1,u=0;(s=c.next())&&!s.done;){var d=i.value,f=d[0],p=d[1],y=s.value,m=y[0],v=y[1];!l&&!r[u]&&(l=n.equals(f,m,o,u,e,t,n)&&n.equals(p,v,f,m,e,t,n))&&(r[u]=!0),u++}if(!l)return!1;o++}return!0}function zCe(e,t,n){var r=bW(e),a=r.length;if(bW(t).length!==a)return!1;for(var o;a-- >0;)if(o=r[a],o===gW&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!yW(t,o)||!n.equals(e[o],t[o],o,o,e,t,n))return!1;return!0}function Nf(e,t,n){var r=mW(e),a=r.length;if(mW(t).length!==a)return!1;for(var o,i,s;a-- >0;)if(o=r[a],o===gW&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!yW(t,o)||!n.equals(e[o],t[o],o,o,e,t,n)||(i=vW(e,o),s=vW(t,o),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return!1;return!0}function VCe(e,t){return xl(e.valueOf(),t.valueOf())}function qCe(e,t){return e.source===t.source&&e.flags===t.flags}function xW(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.values(),o,i;(o=a.next())&&!o.done;){for(var s=t.values(),c=!1,l=0;(i=s.next())&&!i.done;)!c&&!r[l]&&(c=n.equals(o.value,i.value,o.value,i.value,e,t,n))&&(r[l]=!0),l++;if(!c)return!1}return!0}function UCe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var WCe="[object Arguments]",HCe="[object Boolean]",ZCe="[object Date]",KCe="[object Map]",XCe="[object Number]",GCe="[object Object]",QCe="[object RegExp]",JCe="[object Set]",YCe="[object String]",eNe=Array.isArray,_W=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,jW=Object.assign,tNe=Object.prototype.toString.call.bind(Object.prototype.toString);function nNe(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,a=e.areObjectsEqual,o=e.arePrimitiveWrappersEqual,i=e.areRegExpsEqual,s=e.areSetsEqual,c=e.areTypedArraysEqual;return function(l,u,d){if(l===u)return!0;if(l==null||u==null||typeof l!="object"||typeof u!="object")return l!==l&&u!==u;var f=l.constructor;if(f!==u.constructor)return!1;if(f===Object)return a(l,u,d);if(eNe(l))return t(l,u,d);if(_W!=null&&_W(l))return c(l,u,d);if(f===Date)return n(l,u,d);if(f===RegExp)return i(l,u,d);if(f===Map)return r(l,u,d);if(f===Set)return s(l,u,d);var p=tNe(l);return p===ZCe?n(l,u,d):p===QCe?i(l,u,d):p===KCe?r(l,u,d):p===JCe?s(l,u,d):p===GCe?typeof l.then!="function"&&typeof u.then!="function"&&a(l,u,d):p===WCe?a(l,u,d):p===HCe||p===XCe||p===YCe?o(l,u,d):!1}}function rNe(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,a={areArraysEqual:r?Nf:FCe,areDatesEqual:BCe,areMapsEqual:r?hW(wW,Nf):wW,areObjectsEqual:r?Nf:zCe,arePrimitiveWrappersEqual:VCe,areRegExpsEqual:qCe,areSetsEqual:r?hW(xW,Nf):xW,areTypedArraysEqual:r?Nf:UCe};if(n&&(a=jW({},a,n(a))),t){var o=gg(a.areArraysEqual),i=gg(a.areMapsEqual),s=gg(a.areObjectsEqual),c=gg(a.areSetsEqual);a=jW({},a,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c})}return a}function aNe(e){return function(t,n,r,a,o,i,s){return e(t,n,s)}}function oNe(e){var t=e.circular,n=e.comparator,r=e.createState,a=e.equals,o=e.strict;if(r)return function(s,c){var l=r(),u=l.cache,d=u===void 0?t?new WeakMap:void 0:u,f=l.meta;return n(s,c,{cache:d,equals:a,meta:f,strict:o})};if(t)return function(s,c){return n(s,c,{cache:new WeakMap,equals:a,meta:void 0,strict:o})};var i={cache:void 0,equals:a,meta:void 0,strict:o};return function(s,c){return n(s,c,i)}}var iNe=Mi();Mi({strict:!0}),Mi({circular:!0}),Mi({circular:!0,strict:!0}),Mi({createInternalComparator:function(){return xl}}),Mi({strict:!0,createInternalComparator:function(){return xl}}),Mi({circular:!0,createInternalComparator:function(){return xl}}),Mi({circular:!0,createInternalComparator:function(){return xl},strict:!0});function Mi(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,a=e.createState,o=e.strict,i=o===void 0?!1:o,s=rNe(e),c=nNe(s),l=r?r(c):aNe(c);return oNe({circular:n,comparator:c,createState:a,equals:l,strict:i})}function sNe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function SW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function a(o){n<0&&(n=o),o-n>t?(e(o),n=-1):sNe(a)};requestAnimationFrame(r)}function UC(e){"@babel/helpers - typeof";return UC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UC(e)}function cNe(e){return fNe(e)||dNe(e)||uNe(e)||lNe()}function lNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uNe(e,t){if(e){if(typeof e=="string")return EW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return EW(e,t)}}function EW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fNe(e){if(Array.isArray(e))return e}function pNe(){var e={},t=function(){return null},n=!1,r=function a(o){if(!n){if(Array.isArray(o)){if(!o.length)return;var i=o,s=cNe(i),c=s[0],l=s.slice(1);if(typeof c=="number"){SW(a.bind(null,l),c);return}a(c),SW(a.bind(null,l));return}UC(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){n=!0},start:function(a){n=!1,r(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function Mf(e){"@babel/helpers - typeof";return Mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mf(e)}function OW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function CW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?OW(Object(n),!0).forEach(function(r){NW(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function NW(e,t,n){return t=hNe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hNe(e){var t=mNe(e,"string");return Mf(t)==="symbol"?t:String(t)}function mNe(e,t){if(Mf(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Mf(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yNe=function(e,t){return[Object.keys(e),Object.keys(t)].reduce(function(n,r){return n.filter(function(a){return r.includes(a)})})},gNe=function(e){return e},vNe=function(e){return e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})},Pf=function(e,t){return Object.keys(t).reduce(function(n,r){return CW(CW({},n),{},NW({},r,e(r,t[r])))},{})},MW=function(e,t,n){return e.map(function(r){return"".concat(vNe(r)," ").concat(t,"ms ").concat(n)}).join(",")};function bNe(e,t){return _Ne(e)||xNe(e,t)||PW(e,t)||wNe()}function wNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xNe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function _Ne(e){if(Array.isArray(e))return e}function jNe(e){return ONe(e)||ENe(e)||PW(e)||SNe()}function SNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PW(e,t){if(e){if(typeof e=="string")return WC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WC(e,t)}}function ENe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ONe(e){if(Array.isArray(e))return WC(e)}function WC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var vg=1e-4,kW=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},AW=function(e,t){return e.map(function(n,r){return n*Math.pow(t,r)}).reduce(function(n,r){return n+r})},TW=function(e,t){return function(n){var r=kW(e,t);return AW(r,n)}},CNe=function(e,t){return function(n){var r=kW(e,t),a=[].concat(jNe(r.map(function(o,i){return o*i}).slice(1)),[0]);return AW(a,n)}},RW=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],o=t[2],i=t[3];if(t.length===1)switch(t[0]){case"linear":r=0,a=0,o=1,i=1;break;case"ease":r=.25,a=.1,o=.25,i=1;break;case"ease-in":r=.42,a=0,o=1,i=1;break;case"ease-out":r=.42,a=0,o=.58,i=1;break;case"ease-in-out":r=0,a=0,o=.58,i=1;break;default:{var s=t[0].split("(");if(s[0]==="cubic-bezier"&&s[1].split(")")[0].split(",").length===4){var c=s[1].split(")")[0].split(",").map(function(m){return parseFloat(m)}),l=bNe(c,4);r=l[0],a=l[1],o=l[2],i=l[3]}}}var u=TW(r,o),d=TW(a,i),f=CNe(r,o),p=function(m){return m>1?1:m<0?0:m},y=function(m){for(var v=m>1?1:m,b=v,w=0;w<8;++w){var _=u(b)-v,x=f(b);if(Math.abs(_-v)<vg||x<vg)return d(b);b=p(b-_/x)}return d(b)};return y.isStepper=!1,y},NNe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.stiff,n=t===void 0?100:t,r=e.damping,a=r===void 0?8:r,o=e.dt,i=o===void 0?17:o,s=function(c,l,u){var d=-(c-l)*n,f=u*a,p=u+(d-f)*i/1e3,y=u*i/1e3+c;return Math.abs(y-l)<vg&&Math.abs(p)<vg?[l,0]:[y,p]};return s.isStepper=!0,s.dt=i,s},MNe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if(typeof r=="string")switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return RW(r);case"spring":return NNe();default:if(r.split("(")[0]==="cubic-bezier")return RW(r)}return typeof r=="function"?r:null};function kf(e){"@babel/helpers - typeof";return kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kf(e)}function IW(e){return ANe(e)||kNe(e)||LW(e)||PNe()}function PNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ANe(e){if(Array.isArray(e))return ZC(e)}function DW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Cn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?DW(Object(n),!0).forEach(function(r){HC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function HC(e,t,n){return t=TNe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TNe(e){var t=RNe(e,"string");return kf(t)==="symbol"?t:String(t)}function RNe(e,t){if(kf(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(kf(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function INe(e,t){return $Ne(e)||LNe(e,t)||LW(e,t)||DNe()}function DNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LW(e,t){if(e){if(typeof e=="string")return ZC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZC(e,t)}}function ZC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function LNe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function $Ne(e){if(Array.isArray(e))return e}var bg=function(e,t,n){return e+(t-e)*n},KC=function(e){var t=e.from,n=e.to;return t!==n},FNe=function e(t,n,r){var a=Pf(function(o,i){if(KC(i)){var s=t(i.from,i.to,i.velocity),c=INe(s,2),l=c[0],u=c[1];return Cn(Cn({},i),{},{from:l,velocity:u})}return i},n);return r<1?Pf(function(o,i){return KC(i)?Cn(Cn({},i),{},{velocity:bg(i.velocity,a[o].velocity,r),from:bg(i.from,a[o].from,r)}):i},n):e(t,a,r-1)};const BNe=function(e,t,n,r,a){var o=yNe(e,t),i=o.reduce(function(v,b){return Cn(Cn({},v),{},HC({},b,[e[b],t[b]]))},{}),s=o.reduce(function(v,b){return Cn(Cn({},v),{},HC({},b,{from:e[b],velocity:0,to:t[b]}))},{}),c=-1,l,u,d=function(){return null},f=function(){return Pf(function(v,b){return b.from},s)},p=function(){return!Object.values(s).filter(KC).length},y=function(v){l||(l=v);var b=v-l,w=b/n.dt;s=FNe(n,s,w),a(Cn(Cn(Cn({},e),t),f())),l=v,p()||(c=requestAnimationFrame(d))},m=function(v){u||(u=v);var b=(v-u)/r,w=Pf(function(x,j){return bg.apply(void 0,IW(j).concat([n(b)]))},i);if(a(Cn(Cn(Cn({},e),t),w)),b<1)c=requestAnimationFrame(d);else{var _=Pf(function(x,j){return bg.apply(void 0,IW(j).concat([n(1)]))},i);a(Cn(Cn(Cn({},e),t),_))}};return d=n.isStepper?y:m,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(c)}}};function _l(e){"@babel/helpers - typeof";return _l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_l(e)}var zNe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function VNe(e,t){if(e==null)return{};var n=qNe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qNe(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,o;for(o=0;o<r.length;o++)a=r[o],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function XC(e){return ZNe(e)||HNe(e)||WNe(e)||UNe()}function UNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WNe(e,t){if(e){if(typeof e=="string")return GC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GC(e,t)}}function HNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ZNe(e){if(Array.isArray(e))return GC(e)}function GC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ba(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$W(Object(n),!0).forEach(function(r){Af(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$W(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Af(e,t,n){return t=FW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XNe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,FW(r.key),r)}}function GNe(e,t,n){return t&&XNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function FW(e){var t=QNe(e,"string");return _l(t)==="symbol"?t:String(t)}function QNe(e,t){if(_l(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_l(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QC(e,t)}function QC(e,t){return QC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},QC(e,t)}function YNe(e){var t=eMe();return function(){var n=wg(e),r;if(t){var a=wg(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return JC(this,r)}}function JC(e,t){if(t&&(_l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YC(e)}function YC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wg(e){return wg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wg(e)}var Pi=function(e){JNe(n,e);var t=YNe(n);function n(r,a){var o;KNe(this,n),o=t.call(this,r,a);var i=o.props,s=i.isActive,c=i.attributeName,l=i.from,u=i.to,d=i.steps,f=i.children,p=i.duration;if(o.handleStyleChange=o.handleStyleChange.bind(YC(o)),o.changeStyle=o.changeStyle.bind(YC(o)),!s||p<=0)return o.state={style:{}},typeof f=="function"&&(o.state={style:u}),JC(o);if(d&&d.length)o.state={style:d[0].style};else if(l){if(typeof f=="function")return o.state={style:l},JC(o);o.state={style:c?Af({},c,l):l}}else o.state={style:{}};return o}return GNe(n,[{key:"componentDidMount",value:function(){var r=this.props,a=r.isActive,o=r.canBegin;this.mounted=!0,!(!a||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(r){var a=this.props,o=a.isActive,i=a.canBegin,s=a.attributeName,c=a.shouldReAnimate,l=a.to,u=a.from,d=this.state.style;if(i){if(!o){var f={style:s?Af({},s,l):l};this.state&&d&&(s&&d[s]!==l||!s&&d!==l)&&this.setState(f);return}if(!(iNe(r.to,l)&&r.canBegin&&r.isActive)){var p=!r.canBegin||!r.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var y=p||c?u:r.to;if(this.state&&d){var m={style:s?Af({},s,y):y};(s&&d[s]!==y||!s&&d!==y)&&this.setState(m)}this.runAnimation(ba(ba({},this.props),{},{from:y,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var r=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),r&&r()}},{key:"handleStyleChange",value:function(r){this.changeStyle(r)}},{key:"changeStyle",value:function(r){this.mounted&&this.setState({style:r})}},{key:"runJSAnimation",value:function(r){var a=this,o=r.from,i=r.to,s=r.duration,c=r.easing,l=r.begin,u=r.onAnimationEnd,d=r.onAnimationStart,f=BNe(o,i,MNe(c),s,this.changeStyle),p=function(){a.stopJSAnimation=f()};this.manager.start([d,l,p,s,u])}},{key:"runStepAnimation",value:function(r){var a=this,o=r.steps,i=r.begin,s=r.onAnimationStart,c=o[0],l=c.style,u=c.duration,d=u===void 0?0:u,f=function(p,y,m){if(m===0)return p;var v=y.duration,b=y.easing,w=b===void 0?"ease":b,_=y.style,x=y.properties,j=y.onAnimationEnd,S=m>0?o[m-1]:y,E=x||Object.keys(_);if(typeof w=="function"||w==="spring")return[].concat(XC(p),[a.runJSAnimation.bind(a,{from:S.style,to:_,duration:v,easing:w}),v]);var O=MW(E,v,w),M=ba(ba(ba({},S.style),_),{},{transition:O});return[].concat(XC(p),[M,v,j]).filter(gNe)};return this.manager.start([s].concat(XC(o.reduce(f,[l,Math.max(d,i)])),[r.onAnimationEnd]))}},{key:"runAnimation",value:function(r){this.manager||(this.manager=pNe());var a=r.begin,o=r.duration,i=r.attributeName,s=r.to,c=r.easing,l=r.onAnimationStart,u=r.onAnimationEnd,d=r.steps,f=r.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof c=="function"||typeof f=="function"||c==="spring"){this.runJSAnimation(r);return}if(d.length>1){this.runStepAnimation(r);return}var y=i?Af({},i,s):s,m=MW(Object.keys(y),o,c);p.start([l,a,ba(ba({},y),{},{transition:m}),o,u])}},{key:"render",value:function(){var r=this.props,a=r.children;r.begin;var o=r.duration;r.attributeName,r.easing;var i=r.isActive;r.steps,r.from,r.to,r.canBegin,r.onAnimationEnd,r.shouldReAnimate,r.onAnimationReStart;var s=VNe(r,zNe),c=g.Children.count(a),l=this.state.style;if(typeof a=="function")return a(l);if(!i||c===0||o<=0)return a;var u=function(d){var f=d.props,p=f.style,y=p===void 0?{}:p,m=f.className,v=g.cloneElement(d,ba(ba({},s),{},{style:ba(ba({},y),l),className:m}));return v};return c===1?u(g.Children.only(a)):W.createElement("div",null,g.Children.map(a,function(d){return u(d)}))}}]),n}(g.PureComponent);Pi.displayName="Animate",Pi.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},Pi.propTypes={from:He.oneOfType([He.object,He.string]),to:He.oneOfType([He.object,He.string]),attributeName:He.string,duration:He.number,begin:He.number,easing:He.oneOfType([He.string,He.func]),steps:He.arrayOf(He.shape({duration:He.number.isRequired,style:He.object.isRequired,easing:He.oneOfType([He.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),He.func]),properties:He.arrayOf("string"),onAnimationEnd:He.func})),children:He.oneOfType([He.node,He.func]),isActive:He.bool,canBegin:He.bool,onAnimationEnd:He.func,shouldReAnimate:He.bool,onAnimationStart:He.func,onAnimationReStart:He.func},He.object,He.object,He.object,He.element,He.object,He.object,He.object,He.oneOfType([He.array,He.element]),He.any;function Tf(e){"@babel/helpers - typeof";return Tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tf(e)}function xg(){return xg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xg.apply(this,arguments)}function tMe(e,t){return oMe(e)||aMe(e,t)||rMe(e,t)||nMe()}function nMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rMe(e,t){if(e){if(typeof e=="string")return BW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BW(e,t)}}function BW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aMe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function oMe(e){if(Array.isArray(e))return e}function zW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function VW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zW(Object(n),!0).forEach(function(r){iMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function iMe(e,t,n){return t=sMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sMe(e){var t=cMe(e,"string");return Tf(t)=="symbol"?t:t+""}function cMe(e,t){if(Tf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Tf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qW=function(e,t,n,r,a){var o=Math.min(Math.abs(n)/2,Math.abs(r)/2),i=r>=0?1:-1,s=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0,l;if(o>0&&a instanceof Array){for(var u=[0,0,0,0],d=0,f=4;d<f;d++)u[d]=a[d]>o?o:a[d];l="M".concat(e,",").concat(t+i*u[0]),u[0]>0&&(l+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+s*u[0],",").concat(t)),l+="L ".concat(e+n-s*u[1],",").concat(t),u[1]>0&&(l+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+n,",").concat(t+i*u[1])),l+="L ".concat(e+n,",").concat(t+r-i*u[2]),u[2]>0&&(l+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+n-s*u[2],",").concat(t+r)),l+="L ".concat(e+s*u[3],",").concat(t+r),u[3]>0&&(l+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+r-i*u[3])),l+="Z"}else if(o>0&&a===+a&&a>0){var p=Math.min(o,a);l="M ".concat(e,",").concat(t+i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+s*p,",").concat(t,`
            L `).concat(e+n-s*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+n,",").concat(t+i*p,`
            L `).concat(e+n,",").concat(t+r-i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+n-s*p,",").concat(t+r,`
            L `).concat(e+s*p,",").concat(t+r,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(t+r-i*p," Z")}else l="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return l},lMe=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,a=t.x,o=t.y,i=t.width,s=t.height;if(Math.abs(i)>0&&Math.abs(s)>0){var c=Math.min(a,a+i),l=Math.max(a,a+i),u=Math.min(o,o+s),d=Math.max(o,o+s);return n>=c&&n<=l&&r>=u&&r<=d}return!1},uMe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},eN=function(e){var t=VW(VW({},uMe),e),n=g.useRef(),r=g.useState(-1),a=tMe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var _=n.current.getTotalLength();_&&i(_)}catch{}},[]);var s=t.x,c=t.y,l=t.width,u=t.height,d=t.radius,f=t.className,p=t.animationEasing,y=t.animationDuration,m=t.animationBegin,v=t.isAnimationActive,b=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||l===0||u===0)return null;var w=_t("recharts-rectangle",f);return b?W.createElement(Pi,{canBegin:o>0,from:{width:l,height:u,x:s,y:c},to:{width:l,height:u,x:s,y:c},duration:y,animationEasing:p,isActive:b},function(_){var x=_.width,j=_.height,S=_.x,E=_.y;return W.createElement(Pi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:y,isActive:v,easing:p},W.createElement("path",xg({},gt(t,!0),{className:w,d:qW(S,E,x,j,d),ref:n})))}):W.createElement("path",xg({},gt(t,!0),{className:w,d:qW(s,c,l,u,d)}))};function tN(){return tN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tN.apply(this,arguments)}var UW=function(e){var t=e.cx,n=e.cy,r=e.r,a=e.className,o=_t("recharts-dot",a);return t===+t&&n===+n&&r===+r?W.createElement("circle",tN({},gt(e,!1),wy(e),{className:o,cx:t,cy:n,r})):null};function Rf(e){"@babel/helpers - typeof";return Rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rf(e)}var dMe=["x","y","top","left","width","height","className"];function nN(){return nN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nN.apply(this,arguments)}function WW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function fMe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WW(Object(n),!0).forEach(function(r){pMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function pMe(e,t,n){return t=hMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hMe(e){var t=mMe(e,"string");return Rf(t)=="symbol"?t:t+""}function mMe(e,t){if(Rf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Rf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yMe(e,t){if(e==null)return{};var n=gMe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function gMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var vMe=function(e,t,n,r,a,o){return"M".concat(e,",").concat(a,"v").concat(r,"M").concat(o,",").concat(t,"h").concat(n)},bMe=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.top,i=o===void 0?0:o,s=e.left,c=s===void 0?0:s,l=e.width,u=l===void 0?0:l,d=e.height,f=d===void 0?0:d,p=e.className,y=yMe(e,dMe),m=fMe({x:n,y:a,top:i,left:c,width:u,height:f},y);return!ye(n)||!ye(a)||!ye(u)||!ye(f)||!ye(i)||!ye(c)?null:W.createElement("path",nN({},gt(m,!0),{className:_t("recharts-cross",p),d:vMe(n,a,u,f,i,c)}))},rN,HW;yM=function(){if(HW)return rN;HW=1;var e=bo(),t=n0(),n=ja(),r="[object Object]",a=Function.prototype,o=Object.prototype,i=a.toString,s=o.hasOwnProperty,c=i.call(Object);function l(u){if(!n(u)||e(u)!=r)return!1;var d=t(u);if(d===null)return!0;var f=s.call(d,"constructor")&&d.constructor;return typeof f=="function"&&f instanceof f&&i.call(f)==c}return rN=l,rN};var wMe=yM();const xMe=ot(wMe);var aN,ZW;function _Me(){if(ZW)return aN;ZW=1;var e=bo(),t=ja(),n="[object Boolean]";function r(a){return a===!0||a===!1||t(a)&&e(a)==n}return aN=r,aN}var jMe=_Me();const SMe=ot(jMe);function If(e){"@babel/helpers - typeof";return If=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},If(e)}function _g(){return _g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_g.apply(this,arguments)}function EMe(e,t){return MMe(e)||NMe(e,t)||CMe(e,t)||OMe()}function OMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CMe(e,t){if(e){if(typeof e=="string")return KW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return KW(e,t)}}function KW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function NMe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function MMe(e){if(Array.isArray(e))return e}function XW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function GW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XW(Object(n),!0).forEach(function(r){PMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function PMe(e,t,n){return t=kMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kMe(e){var t=AMe(e,"string");return If(t)=="symbol"?t:t+""}function AMe(e,t){if(If(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(If(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QW=function(e,t,n,r,a){var o=n-r,i;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+n,",").concat(t),i+="L ".concat(e+n-o/2,",").concat(t+a),i+="L ".concat(e+n-o/2-r,",").concat(t+a),i+="L ".concat(e,",").concat(t," Z"),i},TMe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},RMe=function(e){var t=GW(GW({},TMe),e),n=g.useRef(),r=g.useState(-1),a=EMe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&i(w)}catch{}},[]);var s=t.x,c=t.y,l=t.upperWidth,u=t.lowerWidth,d=t.height,f=t.className,p=t.animationEasing,y=t.animationDuration,m=t.animationBegin,v=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||d!==+d||l===0&&u===0||d===0)return null;var b=_t("recharts-trapezoid",f);return v?W.createElement(Pi,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:d,x:s,y:c},to:{upperWidth:l,lowerWidth:u,height:d,x:s,y:c},duration:y,animationEasing:p,isActive:v},function(w){var _=w.upperWidth,x=w.lowerWidth,j=w.height,S=w.x,E=w.y;return W.createElement(Pi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:y,easing:p},W.createElement("path",_g({},gt(t,!0),{className:b,d:QW(S,E,_,x,j),ref:n})))}):W.createElement("g",null,W.createElement("path",_g({},gt(t,!0),{className:b,d:QW(s,c,l,u,d)})))},IMe=["option","shapeType","propTransformer","activeClassName","isActive"];function Df(e){"@babel/helpers - typeof";return Df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Df(e)}function DMe(e,t){if(e==null)return{};var n=LMe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function LMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function JW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function jg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JW(Object(n),!0).forEach(function(r){$Me(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $Me(e,t,n){return t=FMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FMe(e){var t=BMe(e,"string");return Df(t)=="symbol"?t:t+""}function BMe(e,t){if(Df(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Df(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zMe(e,t){return jg(jg({},t),e)}function VMe(e,t){return e==="symbols"}function YW(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return W.createElement(eN,n);case"trapezoid":return W.createElement(RMe,n);case"sector":return W.createElement(oW,n);case"symbols":if(VMe(t))return W.createElement(WE,n);break;default:return null}}function qMe(e){return g.isValidElement(e)?e.props:e}function UMe(e){var t=e.option,n=e.shapeType,r=e.propTransformer,a=r===void 0?zMe:r,o=e.activeClassName,i=o===void 0?"recharts-active-shape":o,s=e.isActive,c=DMe(e,IMe),l;if(g.isValidElement(t))l=g.cloneElement(t,jg(jg({},c),qMe(t)));else if(tt(t))l=t(c);else if(xMe(t)&&!SMe(t)){var u=a(t,c);l=W.createElement(YW,{shapeType:n,elementProps:u})}else{var d=c;l=W.createElement(YW,{shapeType:n,elementProps:d})}return s?W.createElement(mn,{className:i},l):l}function Sg(e,t){return t!=null&&"trapezoids"in e.props}function Eg(e,t){return t!=null&&"sectors"in e.props}function Lf(e,t){return t!=null&&"points"in e.props}function WMe(e,t){var n,r,a=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,o=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return a&&o}function HMe(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function ZMe(e,t){var n=e.x===t.x,r=e.y===t.y,a=e.z===t.z;return n&&r&&a}function KMe(e,t){var n;return Sg(e,t)?n=WMe:Eg(e,t)?n=HMe:Lf(e,t)&&(n=ZMe),n}function XMe(e,t){var n;return Sg(e,t)?n="trapezoids":Eg(e,t)?n="sectors":Lf(e,t)&&(n="points"),n}function GMe(e,t){if(Sg(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(Eg(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return Lf(e,t)?t.payload:{}}function QMe(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,a=XMe(n,t),o=GMe(n,t),i=r.filter(function(c,l){var u=jC(o,c),d=n.props[a].filter(function(y){var m=KMe(n,t);return m(y,t)}),f=n.props[a].indexOf(d[d.length-1]),p=l===f;return u&&p}),s=r.indexOf(i[i.length-1]);return s}var oN,eH;function JMe(){if(eH)return oN;eH=1;var e=Math.ceil,t=Math.max;function n(r,a,o,i){for(var s=-1,c=t(e((a-r)/(o||1)),0),l=Array(c);c--;)l[i?c:++s]=r,r+=o;return l}return oN=n,oN}var iN,tH;function YMe(){if(tH)return iN;tH=1;var e=JMe(),t=Rs(),n=f9();function r(a){return function(o,i,s){return s&&typeof s!="number"&&t(o,i,s)&&(i=s=void 0),o=n(o),i===void 0?(i=o,o=0):i=n(i),s=s===void 0?o<i?1:-1:n(s),e(o,i,s,a)}}return iN=r,iN}var sN,nH;function ePe(){if(nH)return sN;nH=1;var e=YMe(),t=e();return sN=t,sN}var tPe=ePe();const Og=ot(tPe);function $f(e){"@babel/helpers - typeof";return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$f(e)}function rH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function aH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rH(Object(n),!0).forEach(function(r){oH(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function oH(e,t,n){return t=nPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nPe(e){var t=rPe(e,"string");return $f(t)=="symbol"?t:t+""}function rPe(e,t){if($f(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($f(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aPe=["Webkit","Moz","O","ms"],oPe=function(e,t){var n=e.replace(/(\w)/,function(a){return a.toUpperCase()}),r=aPe.reduce(function(a,o){return aH(aH({},a),{},oH({},o+n,t))},{});return r[e]=t,r};function jl(e){"@babel/helpers - typeof";return jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jl(e)}function Cg(){return Cg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cg.apply(this,arguments)}function iH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function cN(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iH(Object(n),!0).forEach(function(r){xr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function iPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lH(r.key),r)}}function sPe(e,t,n){return t&&sH(e.prototype,t),n&&sH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function cPe(e,t,n){return t=Ng(t),lPe(e,cH()?Reflect.construct(t,n||[],Ng(e).constructor):t.apply(e,n))}function lPe(e,t){if(t&&(jl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uPe(e)}function uPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cH=function(){return!!e})()}function Ng(e){return Ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ng(e)}function dPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lN(e,t)}function lN(e,t){return lN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},lN(e,t)}function xr(e,t,n){return t=lH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lH(e){var t=fPe(e,"string");return jl(t)=="symbol"?t:t+""}function fPe(e,t){if(jl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(jl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pPe=function(e){var t=e.data,n=e.startIndex,r=e.endIndex,a=e.x,o=e.width,i=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,c=lf().domain(Og(0,s)).range([a,a+o-i]),l=c.domain().map(function(u){return c(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(n),endX:c(r),scale:c,scaleValues:l}},uH=function(e){return e.changedTouches&&!!e.changedTouches.length},Sl=function(e){function t(n){var r;return iPe(this,t),r=cPe(this,t,[n]),xr(r,"handleDrag",function(a){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(a):r.state.isSlideMoving&&r.handleSlideDrag(a)}),xr(r,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&r.handleDrag(a.changedTouches[0])}),xr(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=r.props,o=a.endIndex,i=a.onDragEnd,s=a.startIndex;i==null||i({endIndex:o,startIndex:s})}),r.detachDragEndListener()}),xr(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),xr(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),xr(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),xr(r,"handleSlideDragStart",function(a){var o=uH(a)?a.changedTouches[0]:a;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return dPe(t,e),sPe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var r=n.startX,a=n.endX,o=this.state.scaleValues,i=this.props,s=i.gap,c=i.data,l=c.length-1,u=Math.min(r,a),d=Math.max(r,a),f=t.getIndexInRange(o,u),p=t.getIndexInRange(o,d);return{startIndex:f-f%s,endIndex:p===l?l:p-p%s}}},{key:"getTextOfTick",value:function(n){var r=this.props,a=r.data,o=r.tickFormatter,i=r.dataKey,s=Ha(a[n],i,n);return tt(o)?o(s,n):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var r=this.state,a=r.slideMoveStartX,o=r.startX,i=r.endX,s=this.props,c=s.x,l=s.width,u=s.travellerWidth,d=s.startIndex,f=s.endIndex,p=s.onChange,y=n.pageX-a;y>0?y=Math.min(y,c+l-u-i,c+l-u-o):y<0&&(y=Math.max(y,c-o,c-i));var m=this.getIndex({startX:o+y,endX:i+y});(m.startIndex!==d||m.endIndex!==f)&&p&&p(m),this.setState({startX:o+y,endX:i+y,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,r){var a=uH(r)?r.changedTouches[0]:r;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var r=this.state,a=r.brushMoveStartX,o=r.movingTravellerId,i=r.endX,s=r.startX,c=this.state[o],l=this.props,u=l.x,d=l.width,f=l.travellerWidth,p=l.onChange,y=l.gap,m=l.data,v={startX:this.state.startX,endX:this.state.endX},b=n.pageX-a;b>0?b=Math.min(b,u+d-f-c):b<0&&(b=Math.max(b,u-c)),v[o]=c+b;var w=this.getIndex(v),_=w.startIndex,x=w.endIndex,j=function(){var S=m.length-1;return o==="startX"&&(i>s?_%y===0:x%y===0)||i<s&&x===S||o==="endX"&&(i>s?x%y===0:_%y===0)||i>s&&x===S};this.setState(xr(xr({},o,c+b),"brushMoveStartX",n.pageX),function(){p&&j()&&p(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,r){var a=this,o=this.state,i=o.scaleValues,s=o.startX,c=o.endX,l=this.state[r],u=i.indexOf(l);if(u!==-1){var d=u+n;if(!(d===-1||d>=i.length)){var f=i[d];r==="startX"&&f>=c||r==="endX"&&f<=s||this.setState(xr({},r,f),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.fill,c=n.stroke;return W.createElement("rect",{stroke:c,fill:s,x:r,y:a,width:o,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.data,c=n.children,l=n.padding,u=g.Children.only(c);return u?W.cloneElement(u,{x:r,y:a,width:o,height:i,margin:l,compact:!0,data:s}):null}},{key:"renderTravellerLayer",value:function(n,r){var a,o,i=this,s=this.props,c=s.y,l=s.travellerWidth,u=s.height,d=s.traveller,f=s.ariaLabel,p=s.data,y=s.startIndex,m=s.endIndex,v=Math.max(n,this.props.x),b=cN(cN({},gt(this.props,!1)),{},{x:v,y:c,width:l,height:u}),w=f||"Min value: ".concat((a=p[y])===null||a===void 0?void 0:a.name,", Max value: ").concat((o=p[m])===null||o===void 0?void 0:o.name);return W.createElement(mn,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),i.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,r))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(d,b))}},{key:"renderSlide",value:function(n,r){var a=this.props,o=a.y,i=a.height,s=a.stroke,c=a.travellerWidth,l=Math.min(n,r)+c,u=Math.max(Math.abs(r-n)-c,0);return W.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:s,fillOpacity:.2,x:l,y:o,width:u,height:i})}},{key:"renderText",value:function(){var n=this.props,r=n.startIndex,a=n.endIndex,o=n.y,i=n.height,s=n.travellerWidth,c=n.stroke,l=this.state,u=l.startX,d=l.endX,f=5,p={pointerEvents:"none",fill:c};return W.createElement(mn,{className:"recharts-brush-texts"},W.createElement(zy,Cg({textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,d)-f,y:o+i/2},p),this.getTextOfTick(r)),W.createElement(zy,Cg({textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,d)+s+f,y:o+i/2},p),this.getTextOfTick(a)))}},{key:"render",value:function(){var n=this.props,r=n.data,a=n.className,o=n.children,i=n.x,s=n.y,c=n.width,l=n.height,u=n.alwaysShowText,d=this.state,f=d.startX,p=d.endX,y=d.isTextActive,m=d.isSlideMoving,v=d.isTravellerMoving,b=d.isTravellerFocused;if(!r||!r.length||!ye(i)||!ye(s)||!ye(c)||!ye(l)||c<=0||l<=0)return null;var w=_t("recharts-brush",a),_=W.Children.count(o)===1,x=oPe("userSelect","none");return W.createElement(mn,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:x},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(f,p),this.renderTravellerLayer(f,"startX"),this.renderTravellerLayer(p,"endX"),(y||m||v||b||u)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var r=n.x,a=n.y,o=n.width,i=n.height,s=n.stroke,c=Math.floor(a+i/2)-1;return W.createElement(W.Fragment,null,W.createElement("rect",{x:r,y:a,width:o,height:i,fill:s,stroke:"none"}),W.createElement("line",{x1:r+1,y1:c,x2:r+o-1,y2:c,fill:"none",stroke:"#fff"}),W.createElement("line",{x1:r+1,y1:c+2,x2:r+o-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,r){var a;return W.isValidElement(n)?a=W.cloneElement(n,r):tt(n)?a=n(r):a=t.renderDefaultTraveller(r),a}},{key:"getDerivedStateFromProps",value:function(n,r){var a=n.data,o=n.width,i=n.x,s=n.travellerWidth,c=n.updateId,l=n.startIndex,u=n.endIndex;if(a!==r.prevData||c!==r.prevUpdateId)return cN({prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o},a&&a.length?pPe({data:a,width:o,x:i,travellerWidth:s,startIndex:l,endIndex:u}):{scale:null,scaleValues:null});if(r.scale&&(o!==r.prevWidth||i!==r.prevX||s!==r.prevTravellerWidth)){r.scale.range([i,i+o-s]);var d=r.scale.domain().map(function(f){return r.scale(f)});return{prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o,startX:r.scale(n.startIndex),endX:r.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,r){for(var a=n.length,o=0,i=a-1;i-o>1;){var s=Math.floor((o+i)/2);n[s]>r?i=s:o=s}return r>=n[i]?i:o}}])}(g.PureComponent);xr(Sl,"displayName","Brush"),xr(Sl,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var uN,dH;function hPe(){if(dH)return uN;dH=1;var e=pO();function t(n,r){var a;return e(n,function(o,i,s){return a=r(o,i,s),!a}),!!a}return uN=t,uN}var dN,fH;function mPe(){if(fH)return dN;fH=1;var e=wI(),t=ka(),n=hPe(),r=Fn(),a=Rs();function o(i,s,c){var l=r(i)?e:n;return c&&a(i,s,c)&&(s=void 0),l(i,t(s,3))}return dN=o,dN}var yPe=mPe();const gPe=ot(yPe);var Za=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},fN,pH;function vPe(){if(pH)return fN;pH=1;var e=dv(),t=nV(),n=ka();function r(a,o){var i={};return o=n(o,3),t(a,function(s,c,l){e(i,c,o(s,c,l))}),i}return fN=r,fN}var bPe=vPe();const wPe=ot(bPe);var pN,hH;function xPe(){if(hH)return pN;hH=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(!n(t[r],r,t))return!1;return!0}return pN=e,pN}var hN,mH;function _Pe(){if(mH)return hN;mH=1;var e=pO();function t(n,r){var a=!0;return e(n,function(o,i,s){return a=!!r(o,i,s),a}),a}return hN=t,hN}var mN,yH;function jPe(){if(yH)return mN;yH=1;var e=xPe(),t=_Pe(),n=ka(),r=Fn(),a=Rs();function o(i,s,c){var l=r(i)?e:t;return c&&a(i,s,c)&&(s=void 0),l(i,n(s,3))}return mN=o,mN}var SPe=jPe();const gH=ot(SPe);var EPe=["x","y"];function Ff(e){"@babel/helpers - typeof";return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ff(e)}function yN(){return yN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yN.apply(this,arguments)}function vH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Bf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vH(Object(n),!0).forEach(function(r){OPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function OPe(e,t,n){return t=CPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CPe(e){var t=NPe(e,"string");return Ff(t)=="symbol"?t:t+""}function NPe(e,t){if(Ff(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ff(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MPe(e,t){if(e==null)return{};var n=PPe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function PPe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function kPe(e,t){var n=e.x,r=e.y,a=MPe(e,EPe),o="".concat(n),i=parseInt(o,10),s="".concat(r),c=parseInt(s,10),l="".concat(t.height||a.height),u=parseInt(l,10),d="".concat(t.width||a.width),f=parseInt(d,10);return Bf(Bf(Bf(Bf(Bf({},t),a),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function bH(e){return W.createElement(UMe,yN({shapeType:"rectangle",propTransformer:kPe,activeClassName:"recharts-active-bar"},e))}var APe=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,r){if(typeof e=="number")return e;var a=typeof n=="number";return a?e(n,r):(a||xs(),t)}},TPe=["value","background"],wH;function El(e){"@babel/helpers - typeof";return El=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},El(e)}function RPe(e,t){if(e==null)return{};var n=IPe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function IPe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Mg(){return Mg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mg.apply(this,arguments)}function xH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function an(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xH(Object(n),!0).forEach(function(r){ki(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function DPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,SH(r.key),r)}}function LPe(e,t,n){return t&&_H(e.prototype,t),n&&_H(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Pe(e,t,n){return t=Pg(t),FPe(e,jH()?Reflect.construct(t,n||[],Pg(e).constructor):t.apply(e,n))}function FPe(e,t){if(t&&(El(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BPe(e)}function BPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jH=function(){return!!e})()}function Pg(e){return Pg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pg(e)}function zPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gN(e,t)}function gN(e,t){return gN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},gN(e,t)}function ki(e,t,n){return t=SH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SH(e){var t=VPe(e,"string");return El(t)=="symbol"?t:t+""}function VPe(e,t){if(El(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(El(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ss=function(e){function t(){var n;DPe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=$Pe(this,t,[].concat(a)),ki(n,"state",{isAnimationFinished:!1}),ki(n,"id",by("recharts-bar-")),ki(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),i&&i()}),ki(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),i&&i()}),n}return zPe(t,e),LPe(t,[{key:"renderRectanglesStatically",value:function(n){var r=this,a=this.props,o=a.shape,i=a.dataKey,s=a.activeIndex,c=a.activeBar,l=gt(this.props,!1);return n&&n.map(function(u,d){var f=d===s,p=f?c:o,y=an(an(an({},l),u),{},{isActive:f,option:p,index:d,dataKey:i,onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd});return W.createElement(mn,Mg({className:"recharts-bar-rectangle"},xy(r.props,u,d),{key:"rectangle-".concat(u==null?void 0:u.x,"-").concat(u==null?void 0:u.y,"-").concat(u==null?void 0:u.value)}),W.createElement(bH,y))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,r=this.props,a=r.data,o=r.layout,i=r.isAnimationActive,s=r.animationBegin,c=r.animationDuration,l=r.animationEasing,u=r.animationId,d=this.state.prevData;return W.createElement(Pi,{begin:s,duration:c,isActive:i,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(f){var p=f.t,y=a.map(function(m,v){var b=d&&d[v];if(b){var w=rl(b.x,m.x),_=rl(b.y,m.y),x=rl(b.width,m.width),j=rl(b.height,m.height);return an(an({},m),{},{x:w(p),y:_(p),width:x(p),height:j(p)})}if(o==="horizontal"){var S=rl(0,m.height),E=S(p);return an(an({},m),{},{y:m.y+m.height-E,height:E})}var O=rl(0,m.width),M=O(p);return an(an({},m),{},{width:M})});return W.createElement(mn,null,n.renderRectanglesStatically(y))})}},{key:"renderRectangles",value:function(){var n=this.props,r=n.data,a=n.isAnimationActive,o=this.state.prevData;return a&&r&&r.length&&(!o||!jC(o,r))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(r)}},{key:"renderBackground",value:function(){var n=this,r=this.props,a=r.data,o=r.dataKey,i=r.activeIndex,s=gt(this.props.background,!1);return a.map(function(c,l){c.value;var u=c.background,d=RPe(c,TPe);if(!u)return null;var f=an(an(an(an(an({},d),{},{fill:"#eee"},u),s),xy(n.props,c,l)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:l,className:"recharts-bar-background-rectangle"});return W.createElement(bH,Mg({key:"background-bar-".concat(l),option:n.props.background,isActive:l===i},f))})}},{key:"renderErrorBar",value:function(n,r){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.data,i=a.xAxis,s=a.yAxis,c=a.layout,l=a.children,u=ga(l,lg);if(!u)return null;var d=c==="vertical"?o[0].height/2:o[0].width/2,f=function(y,m){var v=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:v,errorVal:Ha(y,m)}},p={clipPath:n?"url(#clipPath-".concat(r,")"):null};return W.createElement(mn,p,u.map(function(y){return W.cloneElement(y,{key:"error-bar-".concat(r,"-").concat(y.props.dataKey),data:o,xAxis:i,yAxis:s,layout:c,offset:d,dataPointFormatter:f})}))}},{key:"render",value:function(){var n=this.props,r=n.hide,a=n.data,o=n.className,i=n.xAxis,s=n.yAxis,c=n.left,l=n.top,u=n.width,d=n.height,f=n.isAnimationActive,p=n.background,y=n.id;if(r||!a||!a.length)return null;var m=this.state.isAnimationFinished,v=_t("recharts-bar",o),b=i&&i.allowDataOverflow,w=s&&s.allowDataOverflow,_=b||w,x=vt(y)?this.id:y;return W.createElement(mn,{className:v},b||w?W.createElement("defs",null,W.createElement("clipPath",{id:"clipPath-".concat(x)},W.createElement("rect",{x:b?c:c-u/2,y:w?l:l-d/2,width:b?u:u*2,height:w?d:d*2}))):null,W.createElement(mn,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(x,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,x),(!f||m)&&js.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,r){return n.animationId!==r.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:r.curData}:n.data!==r.curData?{curData:n.data}:null}}])}(g.PureComponent);wH=Ss,ki(Ss,"displayName","Bar"),ki(Ss,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Si.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),ki(Ss,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,o=e.xAxis,i=e.yAxis,s=e.xAxisTicks,c=e.yAxisTicks,l=e.stackedData,u=e.dataStartIndex,d=e.displayedData,f=e.offset,p=_Oe(r,n);if(!p)return null;var y=t.layout,m=n.type.defaultProps,v=m!==void 0?an(an({},m),n.props):n.props,b=v.dataKey,w=v.children,_=v.minPointSize,x=y==="horizontal"?i:o,j=l?x.scale.domain():null,S=POe({numericAxis:x}),E=ga(w,DV),O=d.map(function(M,N){var P,R,k,C,T,A;l?P=jOe(l[u+N],j):(P=Ha(M,b),Array.isArray(P)||(P=[S,P]));var I=APe(_,wH.defaultProps.minPointSize)(P[1],N);if(y==="horizontal"){var L,D=[i.scale(P[0]),i.scale(P[1])],B=D[0],F=D[1];R=zU({axis:o,ticks:s,bandSize:a,offset:p.offset,entry:M,index:N}),k=(L=F??B)!==null&&L!==void 0?L:void 0,C=p.size;var $=B-F;if(T=Number.isNaN($)?0:$,A={x:R,y:i.y,width:C,height:i.height},Math.abs(I)>0&&Math.abs(T)<Math.abs(I)){var V=ya(T||I)*(Math.abs(I)-Math.abs(T));k-=V,T+=V}}else{var G=[o.scale(P[0]),o.scale(P[1])],X=G[0],H=G[1];if(R=X,k=zU({axis:i,ticks:c,bandSize:a,offset:p.offset,entry:M,index:N}),C=H-X,T=p.size,A={x:o.x,y:k,width:o.width,height:T},Math.abs(I)>0&&Math.abs(C)<Math.abs(I)){var J=ya(C||I)*(Math.abs(I)-Math.abs(C));C+=J}}return an(an(an({},M),{},{x:R,y:k,width:C,height:T,value:l?P:P[1],payload:M,background:A},E&&E[N]&&E[N].props),{},{tooltipPayload:[HU(n,M)],tooltipPosition:{x:R+C/2,y:k+T/2}})});return an({data:O,layout:y},f)});function zf(e){"@babel/helpers - typeof";return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zf(e)}function qPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,CH(r.key),r)}}function UPe(e,t,n){return t&&EH(e.prototype,t),n&&EH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function OH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function wa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?OH(Object(n),!0).forEach(function(r){kg(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function kg(e,t,n){return t=CH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CH(e){var t=WPe(e,"string");return zf(t)=="symbol"?t:t+""}function WPe(e,t){if(zf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(zf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HPe=function(e,t,n,r,a){var o=e.width,i=e.height,s=e.layout,c=e.children,l=Object.keys(t),u={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},d=!!br(c,Ss);return l.reduce(function(f,p){var y=t[p],m=y.orientation,v=y.domain,b=y.padding,w=b===void 0?{}:b,_=y.mirror,x=y.reversed,j="".concat(m).concat(_?"Mirror":""),S,E,O,M,N;if(y.type==="number"&&(y.padding==="gap"||y.padding==="no-gap")){var P=v[1]-v[0],R=1/0,k=y.categoricalDomain.sort();if(k.forEach(function(V,G){G>0&&(R=Math.min((V||0)-(k[G-1]||0),R))}),Number.isFinite(R)){var C=R/P,T=y.layout==="vertical"?n.height:n.width;if(y.padding==="gap"&&(S=C*T/2),y.padding==="no-gap"){var A=ps(e.barCategoryGap,C*T),I=C*T/2;S=I-A-(I-A)/T*A}}}r==="xAxis"?E=[n.left+(w.left||0)+(S||0),n.left+n.width-(w.right||0)-(S||0)]:r==="yAxis"?E=s==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(S||0),n.top+n.height-(w.bottom||0)-(S||0)]:E=y.range,x&&(E=[E[1],E[0]]);var L=wOe(y,a,d),D=L.scale,B=L.realScaleType;D.domain(v).range(E),xOe(D);var F=MOe(D,wa(wa({},y),{},{realScaleType:B}));r==="xAxis"?(N=m==="top"&&!_||m==="bottom"&&_,O=n.left,M=u[j]-N*y.height):r==="yAxis"&&(N=m==="left"&&!_||m==="right"&&_,O=u[j]-N*y.width,M=n.top);var $=wa(wa(wa({},y),F),{},{realScaleType:B,x:O,y:M,scale:D,width:r==="xAxis"?n.width:y.width,height:r==="yAxis"?n.height:y.height});return $.bandSize=fg($,F),!y.hide&&r==="xAxis"?u[j]+=(N?-1:1)*$.height:y.hide||(u[j]+=(N?-1:1)*$.width),wa(wa({},f),{},kg({},p,$))},{})},NH=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return{x:Math.min(n,a),y:Math.min(r,o),width:Math.abs(a-n),height:Math.abs(o-r)}},ZPe=function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return NH({x:t,y:n},{x:r,y:a})},MH=function(){function e(t){qPe(this,e),this.scale=t}return UPe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.bandAware,a=n.position;if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}},{key:"isInRange",value:function(t){var n=this.range(),r=n[0],a=n[n.length-1];return r<=a?t>=r&&t<=a:t>=a&&t<=r}}],[{key:"create",value:function(t){return new e(t)}}])}();kg(MH,"EPS",1e-4);var vN=function(e){var t=Object.keys(e).reduce(function(n,r){return wa(wa({},n),{},kg({},r,MH.create(e[r])))},{});return wa(wa({},t),{},{apply:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.bandAware,o=r.position;return wPe(n,function(i,s){return t[s].apply(i,{bandAware:a,position:o})})},isInRange:function(n){return gH(n,function(r,a){return t[a].isInRange(r)})}})};function KPe(e){return(e%180+180)%180}var XPe=function(e){var t=e.width,n=e.height,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=KPe(r),o=a*Math.PI/180,i=Math.atan(n/t),s=o>i&&o<Math.PI-i?n/Math.sin(o):t/Math.cos(o);return Math.abs(s)},bN,PH;function GPe(){if(PH)return bN;PH=1;var e=ka(),t=Ri(),n=eu();function r(a){return function(o,i,s){var c=Object(o);if(!t(o)){var l=e(i,3);o=n(o),i=function(d){return l(c[d],d,c)}}var u=a(o,i,s);return u>-1?c[l?o[u]:u]:void 0}}return bN=r,bN}var wN,kH;function QPe(){if(kH)return wN;kH=1;var e=R7(),t=ka(),n=h9(),r=Math.max;function a(o,i,s){var c=o==null?0:o.length;if(!c)return-1;var l=s==null?0:n(s);return l<0&&(l=r(c+l,0)),e(o,t(i,3),l)}return wN=a,wN}var xN,AH;function JPe(){if(AH)return xN;AH=1;var e=GPe(),t=QPe(),n=e(t);return xN=n,xN}var YPe=JPe();const eke=ot(YPe);var tke=SD(),nke=ot(tke)(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),_N=g.createContext(void 0),jN=g.createContext(void 0),TH=g.createContext(void 0),RH=g.createContext({}),IH=g.createContext(void 0),DH=g.createContext(0),LH=g.createContext(0),$H=function(e){var t=e.state,n=t.xAxisMap,r=t.yAxisMap,a=t.offset,o=e.clipPathId,i=e.children,s=e.width,c=e.height,l=nke(a);return W.createElement(_N.Provider,{value:n},W.createElement(jN.Provider,{value:r},W.createElement(RH.Provider,{value:a},W.createElement(TH.Provider,{value:l},W.createElement(IH.Provider,{value:o},W.createElement(DH.Provider,{value:c},W.createElement(LH.Provider,{value:s},i)))))))},rke=function(){return g.useContext(IH)},FH=function(e){var t=g.useContext(_N);t==null&&xs();var n=t[e];return n==null&&xs(),n},ake=function(){var e=g.useContext(_N);return ji(e)},oke=function(){var e=g.useContext(jN),t=eke(e,function(n){return gH(n.domain,Number.isFinite)});return t||ji(e)},BH=function(e){var t=g.useContext(jN);t==null&&xs();var n=t[e];return n==null&&xs(),n},ike=function(){var e=g.useContext(TH);return e},ske=function(){return g.useContext(RH)},SN=function(){return g.useContext(LH)},EN=function(){return g.useContext(DH)};function Ol(e){"@babel/helpers - typeof";return Ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ol(e)}function cke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,UH(r.key),r)}}function uke(e,t,n){return t&&lke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function dke(e,t,n){return t=Ag(t),fke(e,zH()?Reflect.construct(t,n||[],Ag(e).constructor):t.apply(e,n))}function fke(e,t){if(t&&(Ol(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pke(e)}function pke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zH=function(){return!!e})()}function Ag(e){return Ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ag(e)}function hke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ON(e,t)}function ON(e,t){return ON=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},ON(e,t)}function VH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VH(Object(n),!0).forEach(function(r){CN(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function CN(e,t,n){return t=UH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UH(e){var t=mke(e,"string");return Ol(t)=="symbol"?t:t+""}function mke(e,t){if(Ol(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ol(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yke(e,t){return wke(e)||bke(e,t)||vke(e,t)||gke()}function gke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vke(e,t){if(e){if(typeof e=="string")return WH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WH(e,t)}}function WH(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bke(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function wke(e){if(Array.isArray(e))return e}function NN(){return NN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},NN.apply(this,arguments)}var xke=function(e,t){var n;return W.isValidElement(e)?n=W.cloneElement(e,t):tt(e)?n=e(t):n=W.createElement("line",NN({},t,{className:"recharts-reference-line-line"})),n},_ke=function(e,t,n,r,a,o,i,s,c){var l=a.x,u=a.y,d=a.width,f=a.height;if(n){var p=c.y,y=e.y.apply(p,{position:o});if(Za(c,"discard")&&!e.y.isInRange(y))return null;var m=[{x:l+d,y},{x:l,y}];return s==="left"?m.reverse():m}if(t){var v=c.x,b=e.x.apply(v,{position:o});if(Za(c,"discard")&&!e.x.isInRange(b))return null;var w=[{x:b,y:u+f},{x:b,y:u}];return i==="top"?w.reverse():w}if(r){var _=c.segment,x=_.map(function(j){return e.apply(j,{position:o})});return Za(c,"discard")&&gPe(x,function(j){return!e.isInRange(j)})?null:x}return null};function jke(e){var t=e.x,n=e.y,r=e.segment,a=e.xAxisId,o=e.yAxisId,i=e.shape,s=e.className,c=e.alwaysShow,l=rke(),u=FH(a),d=BH(o),f=ike();if(!l||!f)return null;Lo(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=vN({x:u.scale,y:d.scale}),y=un(t),m=un(n),v=r&&r.length===2,b=_ke(p,y,m,v,f,e.position,u.orientation,d.orientation,e);if(!b)return null;var w=yke(b,2),_=w[0],x=_.x,j=_.y,S=w[1],E=S.x,O=S.y,M=Za(e,"hidden")?"url(#".concat(l,")"):void 0,N=qH(qH({clipPath:M},gt(e,!0)),{},{x1:x,y1:j,x2:E,y2:O});return W.createElement(mn,{className:_t("recharts-reference-line",s)},xke(i,N),Rn.renderCallByParent(e,ZPe({x1:x,y1:j,x2:E,y2:O})))}var MN=function(e){function t(){return cke(this,t),dke(this,t,arguments)}return hke(t,e),uke(t,[{key:"render",value:function(){return W.createElement(jke,this.props)}}])}(W.Component);CN(MN,"displayName","ReferenceLine"),CN(MN,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function PN(){return PN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PN.apply(this,arguments)}function Cl(e){"@babel/helpers - typeof";return Cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cl(e)}function HH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ZH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?HH(Object(n),!0).forEach(function(r){Rg(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Ske(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Eke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,XH(r.key),r)}}function Oke(e,t,n){return t&&Eke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cke(e,t,n){return t=Tg(t),Nke(e,KH()?Reflect.construct(t,n||[],Tg(e).constructor):t.apply(e,n))}function Nke(e,t){if(t&&(Cl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mke(e)}function Mke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KH=function(){return!!e})()}function Tg(e){return Tg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tg(e)}function Pke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kN(e,t)}function kN(e,t){return kN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},kN(e,t)}function Rg(e,t,n){return t=XH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XH(e){var t=kke(e,"string");return Cl(t)=="symbol"?t:t+""}function kke(e,t){if(Cl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Cl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ake=function(e){var t=e.x,n=e.y,r=e.xAxis,a=e.yAxis,o=vN({x:r.scale,y:a.scale}),i=o.apply({x:t,y:n},{bandAware:!0});return Za(e,"discard")&&!o.isInRange(i)?null:i},Ig=function(e){function t(){return Ske(this,t),Cke(this,t,arguments)}return Pke(t,e),Oke(t,[{key:"render",value:function(){var n=this.props,r=n.x,a=n.y,o=n.r,i=n.alwaysShow,s=n.clipPathId,c=un(r),l=un(a);if(Lo(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!l)return null;var u=Ake(this.props);if(!u)return null;var d=u.x,f=u.y,p=this.props,y=p.shape,m=p.className,v=Za(this.props,"hidden")?"url(#".concat(s,")"):void 0,b=ZH(ZH({clipPath:v},gt(this.props,!0)),{},{cx:d,cy:f});return W.createElement(mn,{className:_t("recharts-reference-dot",m)},t.renderDot(y,b),Rn.renderCallByParent(this.props,{x:d-o,y:f-o,width:2*o,height:2*o}))}}])}(W.Component);Rg(Ig,"displayName","ReferenceDot"),Rg(Ig,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),Rg(Ig,"renderDot",function(e,t){var n;return W.isValidElement(e)?n=W.cloneElement(e,t):tt(e)?n=e(t):n=W.createElement(UW,PN({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function AN(){return AN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},AN.apply(this,arguments)}function Nl(e){"@babel/helpers - typeof";return Nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nl(e)}function GH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function QH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GH(Object(n),!0).forEach(function(r){Lg(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Tke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,YH(r.key),r)}}function Ike(e,t,n){return t&&Rke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dke(e,t,n){return t=Dg(t),Lke(e,JH()?Reflect.construct(t,n||[],Dg(e).constructor):t.apply(e,n))}function Lke(e,t){if(t&&(Nl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $ke(e)}function $ke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JH=function(){return!!e})()}function Dg(e){return Dg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Dg(e)}function Fke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TN(e,t)}function TN(e,t){return TN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},TN(e,t)}function Lg(e,t,n){return t=YH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YH(e){var t=Bke(e,"string");return Nl(t)=="symbol"?t:t+""}function Bke(e,t){if(Nl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Nl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zke=function(e,t,n,r,a){var o=a.x1,i=a.x2,s=a.y1,c=a.y2,l=a.xAxis,u=a.yAxis;if(!l||!u)return null;var d=vN({x:l.scale,y:u.scale}),f={x:e?d.x.apply(o,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(s,{position:"start"}):d.y.rangeMin},p={x:t?d.x.apply(i,{position:"end"}):d.x.rangeMax,y:r?d.y.apply(c,{position:"end"}):d.y.rangeMax};return Za(a,"discard")&&(!d.isInRange(f)||!d.isInRange(p))?null:NH(f,p)},$g=function(e){function t(){return Tke(this,t),Dke(this,t,arguments)}return Fke(t,e),Ike(t,[{key:"render",value:function(){var n=this.props,r=n.x1,a=n.x2,o=n.y1,i=n.y2,s=n.className,c=n.alwaysShow,l=n.clipPathId;Lo(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=un(r),d=un(a),f=un(o),p=un(i),y=this.props.shape;if(!u&&!d&&!f&&!p&&!y)return null;var m=zke(u,d,f,p,this.props);if(!m&&!y)return null;var v=Za(this.props,"hidden")?"url(#".concat(l,")"):void 0;return W.createElement(mn,{className:_t("recharts-reference-area",s)},t.renderRect(y,QH(QH({clipPath:v},gt(this.props,!0)),m)),Rn.renderCallByParent(this.props,m))}}])}(W.Component);Lg($g,"displayName","ReferenceArea"),Lg($g,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),Lg($g,"renderRect",function(e,t){var n;return W.isValidElement(e)?n=W.cloneElement(e,t):tt(e)?n=e(t):n=W.createElement(eN,AN({},t,{className:"recharts-reference-area-rect"})),n});function eZ(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function Vke(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return XPe(r,n)}function qke(e,t,n){var r=n==="width",a=e.x,o=e.y,i=e.width,s=e.height;return t===1?{start:r?a:o,end:r?a+i:o+s}:{start:r?a+i:o+s,end:r?a:o}}function Fg(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var o=n();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-a)<=0}function Uke(e,t){return eZ(e,t+1)}function Wke(e,t,n,r,a){for(var o=(r||[]).slice(),i=t.start,s=t.end,c=0,l=1,u=i,d=function(){var p=r==null?void 0:r[c];if(p===void 0)return{v:eZ(r,l)};var y=c,m,v=function(){return m===void 0&&(m=n(p,y)),m},b=p.coordinate,w=c===0||Fg(e,b,v,u,s);w||(c=0,u=i,l+=1),w&&(u=b+e*(v()/2+a),c+=l)},f;l<=o.length;)if(f=d(),f)return f.v;return[]}function Vf(e){"@babel/helpers - typeof";return Vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vf(e)}function tZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function In(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tZ(Object(n),!0).forEach(function(r){Hke(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Hke(e,t,n){return t=Zke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zke(e){var t=Kke(e,"string");return Vf(t)=="symbol"?t:t+""}function Kke(e,t){if(Vf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Vf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xke(e,t,n,r,a){for(var o=(r||[]).slice(),i=o.length,s=t.start,c=t.end,l=function(d){var f=o[d],p,y=function(){return p===void 0&&(p=n(f,d)),p};if(d===i-1){var m=e*(f.coordinate+e*y()/2-c);o[d]=f=In(In({},f),{},{tickCoord:m>0?f.coordinate-m*e:f.coordinate})}else o[d]=f=In(In({},f),{},{tickCoord:f.coordinate});var v=Fg(e,f.tickCoord,y,s,c);v&&(c=f.tickCoord-e*(y()/2+a),o[d]=In(In({},f),{},{isShow:!0}))},u=i-1;u>=0;u--)l(u);return o}function Gke(e,t,n,r,a,o){var i=(r||[]).slice(),s=i.length,c=t.start,l=t.end;if(o){var u=r[s-1],d=n(u,s-1),f=e*(u.coordinate+e*d/2-l);i[s-1]=u=In(In({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate});var p=Fg(e,u.tickCoord,function(){return d},c,l);p&&(l=u.tickCoord-e*(d/2+a),i[s-1]=In(In({},u),{},{isShow:!0}))}for(var y=o?s-1:s,m=function(b){var w=i[b],_,x=function(){return _===void 0&&(_=n(w,b)),_};if(b===0){var j=e*(w.coordinate-e*x()/2-c);i[b]=w=In(In({},w),{},{tickCoord:j<0?w.coordinate-j*e:w.coordinate})}else i[b]=w=In(In({},w),{},{tickCoord:w.coordinate});var S=Fg(e,w.tickCoord,x,c,l);S&&(c=w.tickCoord+e*(x()/2+a),i[b]=In(In({},w),{},{isShow:!0}))},v=0;v<y;v++)m(v);return i}function RN(e,t,n){var r=e.tick,a=e.ticks,o=e.viewBox,i=e.minTickGap,s=e.orientation,c=e.interval,l=e.tickFormatter,u=e.unit,d=e.angle;if(!a||!a.length||!r)return[];if(ye(c)||Si.isSsr)return Uke(a,typeof c=="number"&&ye(c)?c:0);var f=[],p=s==="top"||s==="bottom"?"width":"height",y=u&&p==="width"?rf(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},m=function(w,_){var x=tt(l)?l(w.value,_):w.value;return p==="width"?Vke(rf(x,{fontSize:t,letterSpacing:n}),y,d):rf(x,{fontSize:t,letterSpacing:n})[p]},v=a.length>=2?ya(a[1].coordinate-a[0].coordinate):1,b=qke(o,v,p);return c==="equidistantPreserveStart"?Wke(v,b,m,a,i):(c==="preserveStart"||c==="preserveStartEnd"?f=Gke(v,b,m,a,i,c==="preserveStartEnd"):f=Xke(v,b,m,a,i),f.filter(function(w){return w.isShow}))}var Qke=["viewBox"],Jke=["viewBox"],Yke=["ticks"];function Ml(e){"@babel/helpers - typeof";return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ml(e)}function Pl(){return Pl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pl.apply(this,arguments)}function nZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Hn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nZ(Object(n),!0).forEach(function(r){LN(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function IN(e,t){if(e==null)return{};var n=eAe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function eAe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function tAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oZ(r.key),r)}}function nAe(e,t,n){return t&&rZ(e.prototype,t),n&&rZ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function rAe(e,t,n){return t=Bg(t),aAe(e,aZ()?Reflect.construct(t,n||[],Bg(e).constructor):t.apply(e,n))}function aAe(e,t){if(t&&(Ml(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oAe(e)}function oAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aZ=function(){return!!e})()}function Bg(e){return Bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bg(e)}function iAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DN(e,t)}function DN(e,t){return DN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},DN(e,t)}function LN(e,t,n){return t=oZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oZ(e){var t=sAe(e,"string");return Ml(t)=="symbol"?t:t+""}function sAe(e,t){if(Ml(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ml(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kl=function(e){function t(n){var r;return tAe(this,t),r=rAe(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return iAe(t,e),nAe(t,[{key:"shouldComponentUpdate",value:function(n,r){var a=n.viewBox,o=IN(n,Qke),i=this.props,s=i.viewBox,c=IN(i,Jke);return!al(a,s)||!al(o,c)||!al(r,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var r=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];r&&this.setState({fontSize:window.getComputedStyle(r).fontSize,letterSpacing:window.getComputedStyle(r).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var r=this.props,a=r.x,o=r.y,i=r.width,s=r.height,c=r.orientation,l=r.tickSize,u=r.mirror,d=r.tickMargin,f,p,y,m,v,b,w=u?-1:1,_=n.tickSize||l,x=ye(n.tickCoord)?n.tickCoord:n.coordinate;switch(c){case"top":f=p=n.coordinate,m=o+ +!u*s,y=m-w*_,b=y-w*d,v=x;break;case"left":y=m=n.coordinate,p=a+ +!u*i,f=p-w*_,v=f-w*d,b=x;break;case"right":y=m=n.coordinate,p=a+ +u*i,f=p+w*_,v=f+w*d,b=x;break;default:f=p=n.coordinate,m=o+ +u*s,y=m+w*_,b=y+w*d,v=x;break}return{line:{x1:f,y1:y,x2:p,y2:m},tick:{x:v,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o;switch(r){case"left":o=a?"start":"end";break;case"right":o=a?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o="end";switch(r){case"left":case"right":o="middle";break;case"top":o=a?"start":"end";break;default:o=a?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.orientation,c=n.mirror,l=n.axisLine,u=Hn(Hn(Hn({},gt(this.props,!1)),gt(l,!1)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!c||s==="bottom"&&c);u=Hn(Hn({},u),{},{x1:r,y1:a+d*i,x2:r+o,y2:a+d*i})}else{var f=+(s==="left"&&!c||s==="right"&&c);u=Hn(Hn({},u),{},{x1:r+f*o,y1:a,x2:r+f*o,y2:a+i})}return W.createElement("line",Pl({},u,{className:_t("recharts-cartesian-axis-line",Cr(l,"className"))}))}},{key:"renderTicks",value:function(n,r,a){var o=this,i=this.props,s=i.tickLine,c=i.stroke,l=i.tick,u=i.tickFormatter,d=i.unit,f=RN(Hn(Hn({},this.props),{},{ticks:n}),r,a),p=this.getTickTextAnchor(),y=this.getTickVerticalAnchor(),m=gt(this.props,!1),v=gt(l,!1),b=Hn(Hn({},m),{},{fill:"none"},gt(s,!1)),w=f.map(function(_,x){var j=o.getTickLineCoord(_),S=j.line,E=j.tick,O=Hn(Hn(Hn(Hn({textAnchor:p,verticalAnchor:y},m),{},{stroke:"none",fill:c},v),E),{},{index:x,payload:_,visibleTicksCount:f.length,tickFormatter:u});return W.createElement(mn,Pl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},xy(o.props,_,x)),s&&W.createElement("line",Pl({},b,S,{className:_t("recharts-cartesian-axis-tick-line",Cr(s,"className"))})),l&&t.renderTickItem(l,O,"".concat(tt(u)?u(_.value,x):_.value).concat(d||"")))});return W.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,r=this.props,a=r.axisLine,o=r.width,i=r.height,s=r.ticksGenerator,c=r.className,l=r.hide;if(l)return null;var u=this.props,d=u.ticks,f=IN(u,Yke),p=d;return tt(s)&&(p=d&&d.length>0?s(this.props):s(f)),o<=0||i<=0||!p||!p.length?null:W.createElement(mn,{className:_t("recharts-cartesian-axis",c),ref:function(y){n.layerReference=y}},a&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),Rn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,r,a){var o;return W.isValidElement(n)?o=W.cloneElement(n,r):tt(n)?o=n(r):o=W.createElement(zy,Pl({},r,{className:"recharts-cartesian-axis-tick-value"}),a),o}}])}(g.Component);LN(kl,"displayName","CartesianAxis"),LN(kl,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var cAe=["x1","y1","x2","y2","key"],lAe=["offset"];function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function iZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Dn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iZ(Object(n),!0).forEach(function(r){uAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function uAe(e,t,n){return t=dAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dAe(e){var t=fAe(e,"string");return Es(t)=="symbol"?t:t+""}function fAe(e,t){if(Es(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Es(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Os(){return Os=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Os.apply(this,arguments)}function sZ(e,t){if(e==null)return{};var n=pAe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function pAe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var hAe=function(e){var t=e.fill;if(!t||t==="none")return null;var n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.ry;return W.createElement("rect",{x:r,y:a,ry:s,width:o,height:i,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function cZ(e,t){var n;if(W.isValidElement(e))n=W.cloneElement(e,t);else if(tt(e))n=e(t);else{var r=t.x1,a=t.y1,o=t.x2,i=t.y2,s=t.key,c=sZ(t,cAe),l=gt(c,!1);l.offset;var u=sZ(l,lAe);n=W.createElement("line",Os({},u,{x1:r,y1:a,x2:o,y2:i,fill:"none",key:s}))}return n}function mAe(e){var t=e.x,n=e.width,r=e.horizontal,a=r===void 0?!0:r,o=e.horizontalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=Dn(Dn({},e),{},{x1:t,y1:s,x2:t+n,y2:s,key:"line-".concat(c),index:c});return cZ(a,l)});return W.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function yAe(e){var t=e.y,n=e.height,r=e.vertical,a=r===void 0?!0:r,o=e.verticalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=Dn(Dn({},e),{},{x1:s,y1:t,x2:s,y2:t+n,key:"line-".concat(c),index:c});return cZ(a,l)});return W.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function gAe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.horizontalPoints,c=e.horizontal,l=c===void 0?!0:c;if(!l||!t||!t.length)return null;var u=s.map(function(f){return Math.round(f+a-a)}).sort(function(f,p){return f-p});a!==u[0]&&u.unshift(0);var d=u.map(function(f,p){var y=!u[p+1],m=y?a+i-f:u[p+1]-f;if(m<=0)return null;var v=p%t.length;return W.createElement("rect",{key:"react-".concat(p),y:f,x:r,height:m,width:o,stroke:"none",fill:t[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return W.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function vAe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,a=e.fillOpacity,o=e.x,i=e.y,s=e.width,c=e.height,l=e.verticalPoints;if(!n||!r||!r.length)return null;var u=l.map(function(f){return Math.round(f+o-o)}).sort(function(f,p){return f-p});o!==u[0]&&u.unshift(0);var d=u.map(function(f,p){var y=!u[p+1],m=y?o+s-f:u[p+1]-f;if(m<=0)return null;var v=p%r.length;return W.createElement("rect",{key:"react-".concat(p),x:f,y:i,width:m,height:c,stroke:"none",fill:r[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return W.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var bAe=function(e,t){var n=e.xAxis,r=e.width,a=e.height,o=e.offset;return FU(RN(Dn(Dn(Dn({},kl.defaultProps),n),{},{ticks:Ho(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.left,o.left+o.width,t)},wAe=function(e,t){var n=e.yAxis,r=e.width,a=e.height,o=e.offset;return FU(RN(Dn(Dn(Dn({},kl.defaultProps),n),{},{ticks:Ho(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.top,o.top+o.height,t)},Al={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function lZ(e){var t,n,r,a,o,i,s=SN(),c=EN(),l=ske(),u=Dn(Dn({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Al.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Al.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:Al.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Al.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:Al.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:Al.verticalFill,x:ye(e.x)?e.x:l.left,y:ye(e.y)?e.y:l.top,width:ye(e.width)?e.width:l.width,height:ye(e.height)?e.height:l.height}),d=u.x,f=u.y,p=u.width,y=u.height,m=u.syncWithTicks,v=u.horizontalValues,b=u.verticalValues,w=ake(),_=oke();if(!ye(p)||p<=0||!ye(y)||y<=0||!ye(d)||d!==+d||!ye(f)||f!==+f)return null;var x=u.verticalCoordinatesGenerator||bAe,j=u.horizontalCoordinatesGenerator||wAe,S=u.horizontalPoints,E=u.verticalPoints;if((!S||!S.length)&&tt(j)){var O=v&&v.length,M=j({yAxis:_?Dn(Dn({},_),{},{ticks:O?v:_.ticks}):void 0,width:s,height:c,offset:l},O?!0:m);Lo(Array.isArray(M),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Es(M),"]")),Array.isArray(M)&&(S=M)}if((!E||!E.length)&&tt(x)){var N=b&&b.length,P=x({xAxis:w?Dn(Dn({},w),{},{ticks:N?b:w.ticks}):void 0,width:s,height:c,offset:l},N?!0:m);Lo(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Es(P),"]")),Array.isArray(P)&&(E=P)}return W.createElement("g",{className:"recharts-cartesian-grid"},W.createElement(hAe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),W.createElement(mAe,Os({},u,{offset:l,horizontalPoints:S,xAxis:w,yAxis:_})),W.createElement(yAe,Os({},u,{offset:l,verticalPoints:E,xAxis:w,yAxis:_})),W.createElement(gAe,Os({},u,{horizontalPoints:S})),W.createElement(vAe,Os({},u,{verticalPoints:E})))}lZ.displayName="CartesianGrid";function Tl(e){"@babel/helpers - typeof";return Tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tl(e)}function xAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fZ(r.key),r)}}function jAe(e,t,n){return t&&_Ae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function SAe(e,t,n){return t=zg(t),EAe(e,uZ()?Reflect.construct(t,n||[],zg(e).constructor):t.apply(e,n))}function EAe(e,t){if(t&&(Tl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OAe(e)}function OAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uZ=function(){return!!e})()}function zg(e){return zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zg(e)}function CAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$N(e,t)}function $N(e,t){return $N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},$N(e,t)}function dZ(e,t,n){return t=fZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fZ(e){var t=NAe(e,"string");return Tl(t)=="symbol"?t:t+""}function NAe(e,t){if(Tl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Tl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FN(){return FN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FN.apply(this,arguments)}function MAe(e){var t=e.xAxisId,n=SN(),r=EN(),a=FH(t);return a==null?null:W.createElement(kl,FN({},a,{className:_t("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return Ho(o,!0)}}))}var Vg=function(e){function t(){return xAe(this,t),SAe(this,t,arguments)}return CAe(t,e),jAe(t,[{key:"render",value:function(){return W.createElement(MAe,this.props)}}])}(W.Component);dZ(Vg,"displayName","XAxis"),dZ(Vg,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Rl(e){"@babel/helpers - typeof";return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(e)}function PAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kAe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,mZ(r.key),r)}}function AAe(e,t,n){return t&&kAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function TAe(e,t,n){return t=qg(t),RAe(e,pZ()?Reflect.construct(t,n||[],qg(e).constructor):t.apply(e,n))}function RAe(e,t){if(t&&(Rl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IAe(e)}function IAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pZ=function(){return!!e})()}function qg(e){return qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qg(e)}function DAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BN(e,t)}function BN(e,t){return BN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},BN(e,t)}function hZ(e,t,n){return t=mZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mZ(e){var t=LAe(e,"string");return Rl(t)=="symbol"?t:t+""}function LAe(e,t){if(Rl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Rl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zN(){return zN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zN.apply(this,arguments)}var $Ae=function(e){var t=e.yAxisId,n=SN(),r=EN(),a=BH(t);return a==null?null:W.createElement(kl,zN({},a,{className:_t("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return Ho(o,!0)}}))},VN=function(e){function t(){return PAe(this,t),TAe(this,t,arguments)}return DAe(t,e),AAe(t,[{key:"render",value:function(){return W.createElement($Ae,this.props)}}])}(W.Component);hZ(VN,"displayName","YAxis"),hZ(VN,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function yZ(e){return VAe(e)||zAe(e)||BAe(e)||FAe()}function FAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BAe(e,t){if(e){if(typeof e=="string")return qN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qN(e,t)}}function zAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VAe(e){if(Array.isArray(e))return qN(e)}function qN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var UN=function(e,t,n,r,a){var o=ga(e,MN),i=ga(e,Ig),s=[].concat(yZ(o),yZ(i)),c=ga(e,$g),l="".concat(r,"Id"),u=r[0],d=t;if(s.length&&(d=s.reduce(function(y,m){if(m.props[l]===n&&Za(m.props,"extendDomain")&&ye(m.props[u])){var v=m.props[u];return[Math.min(y[0],v),Math.max(y[1],v)]}return y},d)),c.length){var f="".concat(u,"1"),p="".concat(u,"2");d=c.reduce(function(y,m){if(m.props[l]===n&&Za(m.props,"extendDomain")&&ye(m.props[f])&&ye(m.props[p])){var v=m.props[f],b=m.props[p];return[Math.min(y[0],v,b),Math.max(y[1],v,b)]}return y},d)}return a&&a.length&&(d=a.reduce(function(y,m){return ye(m)?[Math.min(y[0],m),Math.max(y[1],m)]:y},d)),d},gZ={exports:{}},vZ;function qAe(){return vZ||(vZ=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new a(u,d||c,f),y=n?n+l:l;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],p]:c._events[y].push(p):(c._events[y]=p,c._eventsCount++),c}function i(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)t.call(l,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},s.prototype.listeners=function(c){var l=n?n+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},s.prototype.listenerCount=function(c){var l=n?n+c:c,u=this._events[l];return u?u.fn?1:u.length:0},s.prototype.emit=function(c,l,u,d,f,p){var y=n?n+c:c;if(!this._events[y])return!1;var m=this._events[y],v=arguments.length,b,w;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,u),!0;case 4:return m.fn.call(m.context,l,u,d),!0;case 5:return m.fn.call(m.context,l,u,d,f),!0;case 6:return m.fn.call(m.context,l,u,d,f,p),!0}for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];m.fn.apply(m.context,b)}else{var _=m.length,x;for(w=0;w<_;w++)switch(m[w].once&&this.removeListener(c,m[w].fn,void 0,!0),v){case 1:m[w].fn.call(m[w].context);break;case 2:m[w].fn.call(m[w].context,l);break;case 3:m[w].fn.call(m[w].context,l,u);break;case 4:m[w].fn.call(m[w].context,l,u,d);break;default:if(!b)for(x=1,b=new Array(v-1);x<v;x++)b[x-1]=arguments[x];m[w].fn.apply(m[w].context,b)}}return!0},s.prototype.on=function(c,l,u){return o(this,c,l,u,!1)},s.prototype.once=function(c,l,u){return o(this,c,l,u,!0)},s.prototype.removeListener=function(c,l,u,d){var f=n?n+c:c;if(!this._events[f])return this;if(!l)return i(this,f),this;var p=this._events[f];if(p.fn)p.fn===l&&(!d||p.once)&&(!u||p.context===u)&&i(this,f);else{for(var y=0,m=[],v=p.length;y<v;y++)(p[y].fn!==l||d&&!p[y].once||u&&p[y].context!==u)&&m.push(p[y]);m.length?this._events[f]=m.length===1?m[0]:m:i(this,f)}return this},s.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&i(this,l)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(gZ)),gZ.exports}var UAe=qAe();const WAe=ot(UAe);var WN=new WAe,HN="recharts.syncMouseEvents";function qf(e){"@babel/helpers - typeof";return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qf(e)}function HAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZAe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bZ(r.key),r)}}function KAe(e,t,n){return t&&ZAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZN(e,t,n){return t=bZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bZ(e){var t=XAe(e,"string");return qf(t)=="symbol"?t:t+""}function XAe(e,t){if(qf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(qf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var GAe=function(){function e(){HAe(this,e),ZN(this,"activeIndex",0),ZN(this,"coordinateList",[]),ZN(this,"layout","horizontal")}return KAe(e,[{key:"setDetails",value:function(t){var n,r=t.coordinateList,a=r===void 0?null:r,o=t.container,i=o===void 0?null:o,s=t.layout,c=s===void 0?null:s,l=t.offset,u=l===void 0?null:l,d=t.mouseHandlerCallback,f=d===void 0?null:d;this.coordinateList=(n=a??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=c??this.layout,this.offset=u??this.offset,this.mouseHandlerCallback=f??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(t){if(this.coordinateList.length!==0)switch(t.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(t){this.activeIndex=t}},{key:"spoofMouse",value:function(){var t,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var r=this.container.getBoundingClientRect(),a=r.x,o=r.y,i=r.height,s=this.coordinateList[this.activeIndex].coordinate,c=((t=window)===null||t===void 0?void 0:t.scrollX)||0,l=((n=window)===null||n===void 0?void 0:n.scrollY)||0,u=a+s+c,d=o+this.offset.top+i/2+l;this.mouseHandlerCallback({pageX:u,pageY:d})}}}])}();function QAe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],a=e==null?void 0:e[1];if(r&&a&&ye(r)&&ye(a))return!0}return!1}function JAe(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function wZ(e){var t=e.cx,n=e.cy,r=e.radius,a=e.startAngle,o=e.endAngle,i=On(t,n,r,a),s=On(t,n,r,o);return{points:[i,s],cx:t,cy:n,radius:r,startAngle:a,endAngle:o}}function YAe(e,t,n){var r,a,o,i;if(e==="horizontal")r=t.x,o=r,a=n.top,i=n.top+n.height;else if(e==="vertical")a=t.y,i=a,r=n.left,o=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,c=t.cy,l=t.innerRadius,u=t.outerRadius,d=t.angle,f=On(s,c,l,d),p=On(s,c,u,d);r=f.x,a=f.y,o=p.x,i=p.y}else return wZ(t);return[{x:r,y:a},{x:o,y:i}]}function Uf(e){"@babel/helpers - typeof";return Uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uf(e)}function xZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ug(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xZ(Object(n),!0).forEach(function(r){e2e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function e2e(e,t,n){return t=t2e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t2e(e){var t=n2e(e,"string");return Uf(t)=="symbol"?t:t+""}function n2e(e,t){if(Uf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Uf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r2e(e){var t,n,r=e.element,a=e.tooltipEventType,o=e.isActive,i=e.activeCoordinate,s=e.activePayload,c=e.offset,l=e.activeTooltipIndex,u=e.tooltipAxisBandSize,d=e.layout,f=e.chartName,p=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!p||!o||!i||f!=="ScatterChart"&&a!=="axis")return null;var y,m=lW;if(f==="ScatterChart")y=i,m=bMe;else if(f==="BarChart")y=JAe(d,i,c,u),m=eN;else if(d==="radial"){var v=wZ(i),b=v.cx,w=v.cy,_=v.radius,x=v.startAngle,j=v.endAngle;y={cx:b,cy:w,startAngle:x,endAngle:j,innerRadius:_,outerRadius:_},m=oW}else y={points:YAe(d,i,c)},m=lW;var S=Ug(Ug(Ug(Ug({stroke:"#ccc",pointerEvents:"none"},c),y),gt(p,!1)),{},{payload:s,payloadIndex:l,className:_t("recharts-tooltip-cursor",p.className)});return g.isValidElement(p)?g.cloneElement(p,S):g.createElement(m,S)}var a2e=["item"],o2e=["children","className","width","height","style","compact","title","desc"];function Il(e){"@babel/helpers - typeof";return Il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Il(e)}function Dl(){return Dl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dl.apply(this,arguments)}function _Z(e,t){return c2e(e)||s2e(e,t)||EZ(e,t)||i2e()}function i2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s2e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function c2e(e){if(Array.isArray(e))return e}function jZ(e,t){if(e==null)return{};var n=l2e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function l2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function u2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d2e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,CZ(r.key),r)}}function f2e(e,t,n){return t&&d2e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function p2e(e,t,n){return t=Wg(t),h2e(e,SZ()?Reflect.construct(t,n||[],Wg(e).constructor):t.apply(e,n))}function h2e(e,t){if(t&&(Il(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return m2e(e)}function m2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SZ=function(){return!!e})()}function Wg(e){return Wg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wg(e)}function y2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KN(e,t)}function KN(e,t){return KN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},KN(e,t)}function Ll(e){return b2e(e)||v2e(e)||EZ(e)||g2e()}function g2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EZ(e,t){if(e){if(typeof e=="string")return XN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XN(e,t)}}function v2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function b2e(e){if(Array.isArray(e))return XN(e)}function XN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function OZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?OZ(Object(n),!0).forEach(function(r){Fe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fe(e,t,n){return t=CZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CZ(e){var t=w2e(e,"string");return Il(t)=="symbol"?t:t+""}function w2e(e,t){if(Il(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Il(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x2e={xAxis:["bottom","top"],yAxis:["left","right"]},_2e={width:"100%",height:"100%"},NZ={x:0,y:0};function Hg(e){return e}var j2e=function(e,t){return t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius},S2e=function(e,t,n,r){var a=t.find(function(l){return l&&l.index===n});if(a){if(e==="horizontal")return{x:a.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:a.coordinate};if(e==="centric"){var o=a.coordinate,i=r.radius;return ie(ie(ie({},r),On(r.cx,r.cy,i,o)),{},{angle:o,radius:i})}var s=a.coordinate,c=r.angle;return ie(ie(ie({},r),On(r.cx,r.cy,s,c)),{},{angle:c,radius:s})}return NZ},Zg=function(e,t){var n=t.graphicalItems,r=t.dataStartIndex,a=t.dataEndIndex,o=(n??[]).reduce(function(i,s){var c=s.props.data;return c&&c.length?[].concat(Ll(i),Ll(c)):i},[]);return o.length>0?o:e&&e.length&&ye(r)&&ye(a)?e.slice(r,a+1):[]};function MZ(e){return e==="number"?[0,"auto"]:void 0}var GN=function(e,t,n,r){var a=e.graphicalItems,o=e.tooltipAxis,i=Zg(t,e);return n<0||!a||!a.length||n>=i.length?null:a.reduce(function(s,c){var l,u=(l=c.props.data)!==null&&l!==void 0?l:t;u&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(u=u.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(o.dataKey&&!o.allowDuplicatedCategory){var f=u===void 0?i:u;d=vE(f,o.dataKey,r)}else d=u&&u[n]||i[n];return d?[].concat(Ll(s),[HU(c,d)]):s},[])},PZ=function(e,t,n,r){var a=r||{x:e.chartX,y:e.chartY},o=j2e(a,n),i=e.orderedTooltipTicks,s=e.tooltipAxis,c=e.tooltipTicks,l=hOe(o,i,c,s);if(l>=0&&c){var u=c[l]&&c[l].value,d=GN(e,t,l,u),f=S2e(n,i,l,a);return{activeTooltipIndex:l,activeLabel:u,activePayload:d,activeCoordinate:f}}return null},E2e=function(e,t){var n=t.axes,r=t.graphicalItems,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=e.stackOffset,f=$U(l,a);return n.reduce(function(p,y){var m,v=y.type.defaultProps!==void 0?ie(ie({},y.type.defaultProps),y.props):y.props,b=v.type,w=v.dataKey,_=v.allowDataOverflow,x=v.allowDuplicatedCategory,j=v.scale,S=v.ticks,E=v.includeHidden,O=v[o];if(p[O])return p;var M=Zg(e.data,{graphicalItems:r.filter(function(F){var $,V=o in F.props?F.props[o]:($=F.type.defaultProps)===null||$===void 0?void 0:$[o];return V===O}),dataStartIndex:s,dataEndIndex:c}),N=M.length,P,R,k;QAe(v.domain,_,b)&&(P=DC(v.domain,null,_),f&&(b==="number"||j!=="auto")&&(k=ug(M,w,"category")));var C=MZ(b);if(!P||P.length===0){var T,A=(T=v.domain)!==null&&T!==void 0?T:C;if(w){if(P=ug(M,w,b),b==="category"&&f){var I=Owe(P);x&&I?(R=P,P=Og(0,N)):x||(P=WU(A,P,y).reduce(function(F,$){return F.indexOf($)>=0?F:[].concat(Ll(F),[$])},[]))}else if(b==="category")x?P=P.filter(function(F){return F!==""&&!vt(F)}):P=WU(A,P,y).reduce(function(F,$){return F.indexOf($)>=0||$===""||vt($)?F:[].concat(Ll(F),[$])},[]);else if(b==="number"){var L=bOe(M,r.filter(function(F){var $,V,G=o in F.props?F.props[o]:($=F.type.defaultProps)===null||$===void 0?void 0:$[o],X="hide"in F.props?F.props.hide:(V=F.type.defaultProps)===null||V===void 0?void 0:V.hide;return G===O&&(E||!X)}),w,a,l);L&&(P=L)}f&&(b==="number"||j!=="auto")&&(k=ug(M,w,"category"))}else f?P=Og(0,N):i&&i[O]&&i[O].hasStack&&b==="number"?P=d==="expand"?[0,1]:VU(i[O].stackGroups,s,c):P=LU(M,r.filter(function(F){var $=o in F.props?F.props[o]:F.type.defaultProps[o],V="hide"in F.props?F.props.hide:F.type.defaultProps.hide;return $===O&&(E||!V)}),b,l,!0);if(b==="number")P=UN(u,P,O,a,S),A&&(P=DC(A,P,_));else if(b==="category"&&A){var D=A,B=P.every(function(F){return D.indexOf(F)>=0});B&&(P=D)}}return ie(ie({},p),{},Fe({},O,ie(ie({},v),{},{axisType:a,domain:P,categoricalDomain:k,duplicateDomain:R,originalDomain:(m=v.domain)!==null&&m!==void 0?m:C,isCategorical:f,layout:l})))},{})},O2e=function(e,t){var n=t.graphicalItems,r=t.Axis,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=Zg(e.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:c}),f=d.length,p=$U(l,a),y=-1;return n.reduce(function(m,v){var b=v.type.defaultProps!==void 0?ie(ie({},v.type.defaultProps),v.props):v.props,w=b[o],_=MZ("number");if(!m[w]){y++;var x;return p?x=Og(0,f):i&&i[w]&&i[w].hasStack?(x=VU(i[w].stackGroups,s,c),x=UN(u,x,w,a)):(x=DC(_,LU(d,n.filter(function(j){var S,E,O=o in j.props?j.props[o]:(S=j.type.defaultProps)===null||S===void 0?void 0:S[o],M="hide"in j.props?j.props.hide:(E=j.type.defaultProps)===null||E===void 0?void 0:E.hide;return O===w&&!M}),"number",l),r.defaultProps.allowDataOverflow),x=UN(u,x,w,a)),ie(ie({},m),{},Fe({},w,ie(ie({axisType:a},r.defaultProps),{},{hide:!0,orientation:Cr(x2e,"".concat(a,".").concat(y%2),null),domain:x,originalDomain:_,isCategorical:p,layout:l})))}return m},{})},C2e=function(e,t){var n=t.axisType,r=n===void 0?"xAxis":n,a=t.AxisComp,o=t.graphicalItems,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.children,u="".concat(r,"Id"),d=ga(l,a),f={};return d&&d.length?f=E2e(e,{axes:d,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c}):o&&o.length&&(f=O2e(e,{Axis:a,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c})),f},N2e=function(e){var t=ji(e),n=Ho(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:CO(n,function(r){return r.coordinate}),tooltipAxis:t,tooltipAxisBandSize:fg(t,n)}},kZ=function(e){var t=e.children,n=e.defaultShowTooltip,r=br(t,Sl),a=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(a=r.props.startIndex),r.props.endIndex>=0&&(o=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},M2e=function(e){return!e||!e.length?!1:e.some(function(t){var n=Do(t&&t.type);return n&&n.indexOf("Bar")>=0})},AZ=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},P2e=function(e,t){var n=e.props,r=e.graphicalItems,a=e.xAxisMap,o=a===void 0?{}:a,i=e.yAxisMap,s=i===void 0?{}:i,c=n.width,l=n.height,u=n.children,d=n.margin||{},f=br(u,Sl),p=br(u,cl),y=Object.keys(s).reduce(function(x,j){var S=s[j],E=S.orientation;return!S.mirror&&!S.hide?ie(ie({},x),{},Fe({},E,x[E]+S.width)):x},{left:d.left||0,right:d.right||0}),m=Object.keys(o).reduce(function(x,j){var S=o[j],E=S.orientation;return!S.mirror&&!S.hide?ie(ie({},x),{},Fe({},E,Cr(x,"".concat(E))+S.height)):x},{top:d.top||0,bottom:d.bottom||0}),v=ie(ie({},m),y),b=v.bottom;f&&(v.bottom+=f.props.height||Sl.defaultProps.height),p&&t&&(v=gOe(v,r,n,t));var w=c-v.left-v.right,_=l-v.top-v.bottom;return ie(ie({brushBottom:b},v),{},{width:Math.max(w,0),height:Math.max(_,0)})},k2e=function(e,t){if(t==="xAxis")return e[t].width;if(t==="yAxis")return e[t].height},A2e=function(e){var t=e.chartName,n=e.GraphicalChild,r=e.defaultTooltipEventType,a=r===void 0?"axis":r,o=e.validateTooltipEventTypes,i=o===void 0?["axis"]:o,s=e.axisComponents,c=e.legendContent,l=e.formatAxisMap,u=e.defaultProps,d=function(m,v){var b=v.graphicalItems,w=v.stackGroups,_=v.offset,x=v.updateId,j=v.dataStartIndex,S=v.dataEndIndex,E=m.barSize,O=m.layout,M=m.barGap,N=m.barCategoryGap,P=m.maxBarSize,R=AZ(O),k=R.numericAxisName,C=R.cateAxisName,T=M2e(b),A=[];return b.forEach(function(I,L){var D=Zg(m.data,{graphicalItems:[I],dataStartIndex:j,dataEndIndex:S}),B=I.type.defaultProps!==void 0?ie(ie({},I.type.defaultProps),I.props):I.props,F=B.dataKey,$=B.maxBarSize,V=B["".concat(k,"Id")],G=B["".concat(C,"Id")],X={},H=s.reduce(function(Se,Ve){var Ue=v["".concat(Ve.axisType,"Map")],We=B["".concat(Ve.axisType,"Id")];Ue&&Ue[We]||Ve.axisType==="zAxis"||xs();var At=Ue[We];return ie(ie({},Se),{},Fe(Fe({},Ve.axisType,At),"".concat(Ve.axisType,"Ticks"),Ho(At)))},X),J=H[C],Z=H["".concat(C,"Ticks")],U=w&&w[V]&&w[V].hasStack&&kOe(I,w[V].stackGroups),Q=Do(I.type).indexOf("Bar")>=0,ne=fg(J,Z),z=[],se=T&&mOe({barSize:E,stackGroups:w,totalSize:k2e(H,C)});if(Q){var re,ue,je=vt($)?P:$,Le=(re=(ue=fg(J,Z,!0))!==null&&ue!==void 0?ue:je)!==null&&re!==void 0?re:0;z=yOe({barGap:M,barCategoryGap:N,bandSize:Le!==ne?Le:ne,sizeList:se[G],maxBarSize:je}),Le!==ne&&(z=z.map(function(Se){return ie(ie({},Se),{},{position:ie(ie({},Se.position),{},{offset:Se.position.offset-Le/2})})}))}var $e=I&&I.type&&I.type.getComposedData;$e&&A.push({props:ie(ie({},$e(ie(ie({},H),{},{displayedData:D,props:m,dataKey:F,item:I,bandSize:ne,barPosition:z,offset:_,stackedData:U,layout:O,dataStartIndex:j,dataEndIndex:S}))),{},Fe(Fe(Fe({key:I.key||"item-".concat(L)},k,H[k]),C,H[C]),"animationId",x)),childIndex:Lwe(I,m.children),item:I})}),A},f=function(m,v){var b=m.props,w=m.dataStartIndex,_=m.dataEndIndex,x=m.updateId;if(!Gz({props:b}))return null;var j=b.children,S=b.layout,E=b.stackOffset,O=b.data,M=b.reverseStackOrder,N=AZ(S),P=N.numericAxisName,R=N.cateAxisName,k=ga(j,n),C=NOe(O,k,"".concat(P,"Id"),"".concat(R,"Id"),E,M),T=s.reduce(function(B,F){var $="".concat(F.axisType,"Map");return ie(ie({},B),{},Fe({},$,C2e(b,ie(ie({},F),{},{graphicalItems:k,stackGroups:F.axisType===P&&C,dataStartIndex:w,dataEndIndex:_}))))},{}),A=P2e(ie(ie({},T),{},{props:b,graphicalItems:k}),v==null?void 0:v.legendBBox);Object.keys(T).forEach(function(B){T[B]=l(b,T[B],A,B.replace("Map",""),t)});var I=T["".concat(R,"Map")],L=N2e(I),D=d(b,ie(ie({},T),{},{dataStartIndex:w,dataEndIndex:_,updateId:x,graphicalItems:k,stackGroups:C,offset:A}));return ie(ie({formattedGraphicalItems:D,graphicalItems:k,offset:A,stackGroups:C},L),T)},p=function(m){function v(b){var w,_,x;return u2e(this,v),x=p2e(this,v,[b]),Fe(x,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Fe(x,"accessibilityManager",new GAe),Fe(x,"handleLegendBBoxUpdate",function(j){if(j){var S=x.state,E=S.dataStartIndex,O=S.dataEndIndex,M=S.updateId;x.setState(ie({legendBBox:j},f({props:x.props,dataStartIndex:E,dataEndIndex:O,updateId:M},ie(ie({},x.state),{},{legendBBox:j}))))}}),Fe(x,"handleReceiveSyncEvent",function(j,S,E){if(x.props.syncId===j){if(E===x.eventEmitterSymbol&&typeof x.props.syncMethod!="function")return;x.applySyncEvent(S)}}),Fe(x,"handleBrushChange",function(j){var S=j.startIndex,E=j.endIndex;if(S!==x.state.dataStartIndex||E!==x.state.dataEndIndex){var O=x.state.updateId;x.setState(function(){return ie({dataStartIndex:S,dataEndIndex:E},f({props:x.props,dataStartIndex:S,dataEndIndex:E,updateId:O},x.state))}),x.triggerSyncEvent({dataStartIndex:S,dataEndIndex:E})}}),Fe(x,"handleMouseEnter",function(j){var S=x.getMouseInfo(j);if(S){var E=ie(ie({},S),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseEnter;tt(O)&&O(E,j)}}),Fe(x,"triggeredAfterMouseMove",function(j){var S=x.getMouseInfo(j),E=S?ie(ie({},S),{},{isTooltipActive:!0}):{isTooltipActive:!1};x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseMove;tt(O)&&O(E,j)}),Fe(x,"handleItemMouseEnter",function(j){x.setState(function(){return{isTooltipActive:!0,activeItem:j,activePayload:j.tooltipPayload,activeCoordinate:j.tooltipPosition||{x:j.cx,y:j.cy}}})}),Fe(x,"handleItemMouseLeave",function(){x.setState(function(){return{isTooltipActive:!1}})}),Fe(x,"handleMouseMove",function(j){j.persist(),x.throttleTriggeredAfterMouseMove(j)}),Fe(x,"handleMouseLeave",function(j){x.throttleTriggeredAfterMouseMove.cancel();var S={isTooltipActive:!1};x.setState(S),x.triggerSyncEvent(S);var E=x.props.onMouseLeave;tt(E)&&E(S,j)}),Fe(x,"handleOuterEvent",function(j){var S=Dwe(j),E=Cr(x.props,"".concat(S));if(S&&tt(E)){var O,M;/.*touch.*/i.test(S)?M=x.getMouseInfo(j.changedTouches[0]):M=x.getMouseInfo(j),E((O=M)!==null&&O!==void 0?O:{},j)}}),Fe(x,"handleClick",function(j){var S=x.getMouseInfo(j);if(S){var E=ie(ie({},S),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onClick;tt(O)&&O(E,j)}}),Fe(x,"handleMouseDown",function(j){var S=x.props.onMouseDown;if(tt(S)){var E=x.getMouseInfo(j);S(E,j)}}),Fe(x,"handleMouseUp",function(j){var S=x.props.onMouseUp;if(tt(S)){var E=x.getMouseInfo(j);S(E,j)}}),Fe(x,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.throttleTriggeredAfterMouseMove(j.changedTouches[0])}),Fe(x,"handleTouchStart",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.handleMouseDown(j.changedTouches[0])}),Fe(x,"handleTouchEnd",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&x.handleMouseUp(j.changedTouches[0])}),Fe(x,"triggerSyncEvent",function(j){x.props.syncId!==void 0&&WN.emit(HN,x.props.syncId,j,x.eventEmitterSymbol)}),Fe(x,"applySyncEvent",function(j){var S=x.props,E=S.layout,O=S.syncMethod,M=x.state.updateId,N=j.dataStartIndex,P=j.dataEndIndex;if(j.dataStartIndex!==void 0||j.dataEndIndex!==void 0)x.setState(ie({dataStartIndex:N,dataEndIndex:P},f({props:x.props,dataStartIndex:N,dataEndIndex:P,updateId:M},x.state)));else if(j.activeTooltipIndex!==void 0){var R=j.chartX,k=j.chartY,C=j.activeTooltipIndex,T=x.state,A=T.offset,I=T.tooltipTicks;if(!A)return;if(typeof O=="function")C=O(I,j);else if(O==="value"){C=-1;for(var L=0;L<I.length;L++)if(I[L].value===j.activeLabel){C=L;break}}var D=ie(ie({},A),{},{x:A.left,y:A.top}),B=Math.min(R,D.x+D.width),F=Math.min(k,D.y+D.height),$=I[C]&&I[C].value,V=GN(x.state,x.props.data,C),G=I[C]?{x:E==="horizontal"?I[C].coordinate:B,y:E==="horizontal"?F:I[C].coordinate}:NZ;x.setState(ie(ie({},j),{},{activeLabel:$,activeCoordinate:G,activePayload:V,activeTooltipIndex:C}))}else x.setState(j)}),Fe(x,"renderCursor",function(j){var S,E=x.state,O=E.isTooltipActive,M=E.activeCoordinate,N=E.activePayload,P=E.offset,R=E.activeTooltipIndex,k=E.tooltipAxisBandSize,C=x.getTooltipEventType(),T=(S=j.props.active)!==null&&S!==void 0?S:O,A=x.props.layout,I=j.key||"_recharts-cursor";return W.createElement(r2e,{key:I,activeCoordinate:M,activePayload:N,activeTooltipIndex:R,chartName:t,element:j,isActive:T,layout:A,offset:P,tooltipAxisBandSize:k,tooltipEventType:C})}),Fe(x,"renderPolarAxis",function(j,S,E){var O=Cr(j,"type.axisType"),M=Cr(x.state,"".concat(O,"Map")),N=j.type.defaultProps,P=N!==void 0?ie(ie({},N),j.props):j.props,R=M&&M[P["".concat(O,"Id")]];return g.cloneElement(j,ie(ie({},R),{},{className:_t(O,R.className),key:j.key||"".concat(S,"-").concat(E),ticks:Ho(R,!0)}))}),Fe(x,"renderPolarGrid",function(j){var S=j.props,E=S.radialLines,O=S.polarAngles,M=S.polarRadius,N=x.state,P=N.radiusAxisMap,R=N.angleAxisMap,k=ji(P),C=ji(R),T=C.cx,A=C.cy,I=C.innerRadius,L=C.outerRadius;return g.cloneElement(j,{polarAngles:Array.isArray(O)?O:Ho(C,!0).map(function(D){return D.coordinate}),polarRadius:Array.isArray(M)?M:Ho(k,!0).map(function(D){return D.coordinate}),cx:T,cy:A,innerRadius:I,outerRadius:L,key:j.key||"polar-grid",radialLines:E})}),Fe(x,"renderLegend",function(){var j=x.state.formattedGraphicalItems,S=x.props,E=S.children,O=S.width,M=S.height,N=x.props.margin||{},P=O-(N.left||0)-(N.right||0),R=TU({children:E,formattedGraphicalItems:j,legendWidth:P,legendContent:c});if(!R)return null;var k=R.item,C=jZ(R,a2e);return g.cloneElement(k,ie(ie({},C),{},{chartWidth:O,chartHeight:M,margin:N,onBBoxUpdate:x.handleLegendBBoxUpdate}))}),Fe(x,"renderTooltip",function(){var j,S=x.props,E=S.children,O=S.accessibilityLayer,M=br(E,qa);if(!M)return null;var N=x.state,P=N.isTooltipActive,R=N.activeCoordinate,k=N.activePayload,C=N.activeLabel,T=N.offset,A=(j=M.props.active)!==null&&j!==void 0?j:P;return g.cloneElement(M,{viewBox:ie(ie({},T),{},{x:T.left,y:T.top}),active:A,label:C,payload:A?k:[],coordinate:R,accessibilityLayer:O})}),Fe(x,"renderBrush",function(j){var S=x.props,E=S.margin,O=S.data,M=x.state,N=M.offset,P=M.dataStartIndex,R=M.dataEndIndex,k=M.updateId;return g.cloneElement(j,{key:j.key||"_recharts-brush",onChange:dg(x.handleBrushChange,j.props.onChange),data:O,x:ye(j.props.x)?j.props.x:N.left,y:ye(j.props.y)?j.props.y:N.top+N.height+N.brushBottom-(E.bottom||0),width:ye(j.props.width)?j.props.width:N.width,startIndex:P,endIndex:R,updateId:"brush-".concat(k)})}),Fe(x,"renderReferenceElement",function(j,S,E){if(!j)return null;var O=x,M=O.clipPathId,N=x.state,P=N.xAxisMap,R=N.yAxisMap,k=N.offset,C=j.type.defaultProps||{},T=j.props,A=T.xAxisId,I=A===void 0?C.xAxisId:A,L=T.yAxisId,D=L===void 0?C.yAxisId:L;return g.cloneElement(j,{key:j.key||"".concat(S,"-").concat(E),xAxis:P[I],yAxis:R[D],viewBox:{x:k.left,y:k.top,width:k.width,height:k.height},clipPathId:M})}),Fe(x,"renderActivePoints",function(j){var S=j.item,E=j.activePoint,O=j.basePoint,M=j.childIndex,N=j.isRange,P=[],R=S.props.key,k=S.item.type.defaultProps!==void 0?ie(ie({},S.item.type.defaultProps),S.item.props):S.item.props,C=k.activeDot,T=k.dataKey,A=ie(ie({index:M,dataKey:T,cx:E.x,cy:E.y,r:4,fill:RC(S.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},gt(C,!1)),wy(C));return P.push(v.renderActiveDot(C,A,"".concat(R,"-activePoint-").concat(M))),O?P.push(v.renderActiveDot(C,ie(ie({},A),{},{cx:O.x,cy:O.y}),"".concat(R,"-basePoint-").concat(M))):N&&P.push(null),P}),Fe(x,"renderGraphicChild",function(j,S,E){var O=x.filterFormatItem(j,S,E);if(!O)return null;var M=x.getTooltipEventType(),N=x.state,P=N.isTooltipActive,R=N.tooltipAxis,k=N.activeTooltipIndex,C=N.activeLabel,T=x.props.children,A=br(T,qa),I=O.props,L=I.points,D=I.isRange,B=I.baseLine,F=O.item.type.defaultProps!==void 0?ie(ie({},O.item.type.defaultProps),O.item.props):O.item.props,$=F.activeDot,V=F.hide,G=F.activeBar,X=F.activeShape,H=!!(!V&&P&&A&&($||G||X)),J={};M!=="axis"&&A&&A.props.trigger==="click"?J={onClick:dg(x.handleItemMouseEnter,j.props.onClick)}:M!=="axis"&&(J={onMouseLeave:dg(x.handleItemMouseLeave,j.props.onMouseLeave),onMouseEnter:dg(x.handleItemMouseEnter,j.props.onMouseEnter)});var Z=g.cloneElement(j,ie(ie({},O.props),J));function U(Ue){return typeof R.dataKey=="function"?R.dataKey(Ue.payload):null}if(H)if(k>=0){var Q,ne;if(R.dataKey&&!R.allowDuplicatedCategory){var z=typeof R.dataKey=="function"?U:"payload.".concat(R.dataKey.toString());Q=vE(L,z,C),ne=D&&B&&vE(B,z,C)}else Q=L==null?void 0:L[k],ne=D&&B&&B[k];if(X||G){var se=j.props.activeIndex!==void 0?j.props.activeIndex:k;return[g.cloneElement(j,ie(ie(ie({},O.props),J),{},{activeIndex:se})),null,null]}if(!vt(Q))return[Z].concat(Ll(x.renderActivePoints({item:O,activePoint:Q,basePoint:ne,childIndex:k,isRange:D})))}else{var re,ue=(re=x.getItemByXY(x.state.activeCoordinate))!==null&&re!==void 0?re:{graphicalItem:Z},je=ue.graphicalItem,Le=je.item,$e=Le===void 0?j:Le,Se=je.childIndex,Ve=ie(ie(ie({},O.props),J),{},{activeIndex:Se});return[g.cloneElement($e,Ve),null,null]}return D?[Z,null,null]:[Z,null]}),Fe(x,"renderCustomized",function(j,S,E){return g.cloneElement(j,ie(ie({key:"recharts-customized-".concat(E)},x.props),x.state))}),Fe(x,"renderMap",{CartesianGrid:{handler:Hg,once:!0},ReferenceArea:{handler:x.renderReferenceElement},ReferenceLine:{handler:Hg},ReferenceDot:{handler:x.renderReferenceElement},XAxis:{handler:Hg},YAxis:{handler:Hg},Brush:{handler:x.renderBrush,once:!0},Bar:{handler:x.renderGraphicChild},Line:{handler:x.renderGraphicChild},Area:{handler:x.renderGraphicChild},Radar:{handler:x.renderGraphicChild},RadialBar:{handler:x.renderGraphicChild},Scatter:{handler:x.renderGraphicChild},Pie:{handler:x.renderGraphicChild},Funnel:{handler:x.renderGraphicChild},Tooltip:{handler:x.renderCursor,once:!0},PolarGrid:{handler:x.renderPolarGrid,once:!0},PolarAngleAxis:{handler:x.renderPolarAxis},PolarRadiusAxis:{handler:x.renderPolarAxis},Customized:{handler:x.renderCustomized}}),x.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:by("recharts"),"-clip"),x.throttleTriggeredAfterMouseMove=lv(x.triggeredAfterMouseMove,(_=b.throttleDelay)!==null&&_!==void 0?_:1e3/60),x.state={},x}return y2e(v,m),f2e(v,[{key:"componentDidMount",value:function(){var b,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,w=b.children,_=b.data,x=b.height,j=b.layout,S=br(w,qa);if(S){var E=S.props.defaultIndex;if(!(typeof E!="number"||E<0||E>this.state.tooltipTicks.length-1)){var O=this.state.tooltipTicks[E]&&this.state.tooltipTicks[E].value,M=GN(this.state,_,E,O),N=this.state.tooltipTicks[E].coordinate,P=(this.state.offset.top+x)/2,R=j==="horizontal",k=R?{x:N,y:P}:{y:N,x:P},C=this.state.formattedGraphicalItems.find(function(A){var I=A.item;return I.type.name==="Scatter"});C&&(k=ie(ie({},k),C.props.points[E].tooltipPosition),M=C.props.points[E].tooltipPayload);var T={activeTooltipIndex:E,isTooltipActive:!0,activeLabel:O,activePayload:M,activeCoordinate:k};this.setState(T),this.renderCursor(S),this.accessibilityManager.setIndex(E)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var _,x;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(x=this.props.margin.top)!==null&&x!==void 0?x:0}})}return null}},{key:"componentDidUpdate",value:function(b){SE([br(b.children,qa)],[br(this.props.children,qa)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=br(this.props.children,qa);if(b&&typeof b.props.shared=="boolean"){var w=b.props.shared?"axis":"item";return i.indexOf(w)>=0?w:a}return a}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var w=this.container,_=w.getBoundingClientRect(),x=M_e(_),j={chartX:Math.round(b.pageX-x.left),chartY:Math.round(b.pageY-x.top)},S=_.width/w.offsetWidth||1,E=this.inRange(j.chartX,j.chartY,S);if(!E)return null;var O=this.state,M=O.xAxisMap,N=O.yAxisMap,P=this.getTooltipEventType();if(P!=="axis"&&M&&N){var R=ji(M).scale,k=ji(N).scale,C=R&&R.invert?R.invert(j.chartX):null,T=k&&k.invert?k.invert(j.chartY):null;return ie(ie({},j),{},{xValue:C,yValue:T})}var A=PZ(this.state,this.props.data,this.props.layout,E);return A?ie(ie({},j),A):null}},{key:"inRange",value:function(b,w){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=this.props.layout,j=b/_,S=w/_;if(x==="horizontal"||x==="vertical"){var E=this.state.offset,O=j>=E.left&&j<=E.left+E.width&&S>=E.top&&S<=E.top+E.height;return O?{x:j,y:S}:null}var M=this.state,N=M.angleAxisMap,P=M.radiusAxisMap;if(N&&P){var R=ji(N);return XU({x:j,y:S},R)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,w=this.getTooltipEventType(),_=br(b,qa),x={};_&&w==="axis"&&(_.props.trigger==="click"?x={onClick:this.handleClick}:x={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var j=wy(this.props,this.handleOuterEvent);return ie(ie({},j),x)}},{key:"addListener",value:function(){WN.on(HN,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){WN.removeListener(HN,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,w,_){for(var x=this.state.formattedGraphicalItems,j=0,S=x.length;j<S;j++){var E=x[j];if(E.item===b||E.props.key===b.key||w===Do(E.item.type)&&_===E.childIndex)return E}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,w=this.state.offset,_=w.left,x=w.top,j=w.height,S=w.width;return W.createElement("defs",null,W.createElement("clipPath",{id:b},W.createElement("rect",{x:_,y:x,height:j,width:S})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(w,_){var x=_Z(_,2),j=x[0],S=x[1];return ie(ie({},w),{},Fe({},j,S.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(w,_){var x=_Z(_,2),j=x[0],S=x[1];return ie(ie({},w),{},Fe({},j,S.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(b){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(b){var w=this.state,_=w.formattedGraphicalItems,x=w.activeItem;if(_&&_.length)for(var j=0,S=_.length;j<S;j++){var E=_[j],O=E.props,M=E.item,N=M.type.defaultProps!==void 0?ie(ie({},M.type.defaultProps),M.props):M.props,P=Do(M.type);if(P==="Bar"){var R=(O.data||[]).find(function(A){return lMe(b,A)});if(R)return{graphicalItem:E,payload:R}}else if(P==="RadialBar"){var k=(O.data||[]).find(function(A){return XU(b,A)});if(k)return{graphicalItem:E,payload:k}}else if(Sg(E,x)||Eg(E,x)||Lf(E,x)){var C=QMe({graphicalItem:E,activeTooltipItem:x,itemData:N.data}),T=N.activeIndex===void 0?C:N.activeIndex;return{graphicalItem:ie(ie({},E),{},{childIndex:T}),payload:Lf(E,x)?N.data[C]:E.props.data[C]}}}return null}},{key:"render",value:function(){var b=this;if(!Gz(this))return null;var w=this.props,_=w.children,x=w.className,j=w.width,S=w.height,E=w.style,O=w.compact,M=w.title,N=w.desc,P=jZ(w,o2e),R=gt(P,!1);if(O)return W.createElement($H,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},W.createElement(OE,Dl({},R,{width:j,height:S,title:M,desc:N}),this.renderClipPath(),Jz(_,this.renderMap)));if(this.props.accessibilityLayer){var k,C;R.tabIndex=(k=this.props.tabIndex)!==null&&k!==void 0?k:0,R.role=(C=this.props.role)!==null&&C!==void 0?C:"application",R.onKeyDown=function(A){b.accessibilityManager.keyboardEvent(A)},R.onFocus=function(){b.accessibilityManager.focus()}}var T=this.parseEventsOfWrapper();return W.createElement($H,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},W.createElement("div",Dl({className:_t("recharts-wrapper",x),style:ie({position:"relative",cursor:"default",width:j,height:S},E)},T,{ref:function(A){b.container=A}}),W.createElement(OE,Dl({},R,{width:j,height:S,title:M,desc:N,style:_2e}),this.renderClipPath(),Jz(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(g.Component);Fe(p,"displayName",t),Fe(p,"defaultProps",ie({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),Fe(p,"getDerivedStateFromProps",function(m,v){var b=m.dataKey,w=m.data,_=m.children,x=m.width,j=m.height,S=m.layout,E=m.stackOffset,O=m.margin,M=v.dataStartIndex,N=v.dataEndIndex;if(v.updateId===void 0){var P=kZ(m);return ie(ie(ie({},P),{},{updateId:0},f(ie(ie({props:m},P),{},{updateId:0}),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:j,prevLayout:S,prevStackOffset:E,prevMargin:O,prevChildren:_})}if(b!==v.prevDataKey||w!==v.prevData||x!==v.prevWidth||j!==v.prevHeight||S!==v.prevLayout||E!==v.prevStackOffset||!al(O,v.prevMargin)){var R=kZ(m),k={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},C=ie(ie({},PZ(v,w,S)),{},{updateId:v.updateId+1}),T=ie(ie(ie({},R),k),C);return ie(ie(ie({},T),f(ie({props:m},T),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:j,prevLayout:S,prevStackOffset:E,prevMargin:O,prevChildren:_})}if(!SE(_,v.prevChildren)){var A,I,L,D,B=br(_,Sl),F=B&&(A=(I=B.props)===null||I===void 0?void 0:I.startIndex)!==null&&A!==void 0?A:M,$=B&&(L=(D=B.props)===null||D===void 0?void 0:D.endIndex)!==null&&L!==void 0?L:N,V=F!==M||$!==N,G=!vt(w),X=G&&!V?v.updateId:v.updateId+1;return ie(ie({updateId:X},f(ie(ie({props:m},v),{},{updateId:X,dataStartIndex:F,dataEndIndex:$}),v)),{},{prevChildren:_,dataStartIndex:F,dataEndIndex:$})}return null}),Fe(p,"renderActiveDot",function(m,v,b){var w;return g.isValidElement(m)?w=g.cloneElement(m,v):tt(m)?w=m(v):w=W.createElement(UW,v),W.createElement(mn,{className:"recharts-active-dot",key:b},w)});var y=g.forwardRef(function(m,v){return W.createElement(p,Dl({},m,{ref:v}))});return y.displayName=p.displayName,y},T2e=A2e({chartName:"BarChart",GraphicalChild:Ss,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Vg},{axisType:"yAxis",AxisComp:VN}],formatAxisMap:HPe});const R2e={light:"",dark:".dark"},TZ=g.createContext(null);function RZ(){const e=g.useContext(TZ);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const IZ=g.forwardRef(({id:e,className:t,children:n,config:r,...a},o)=>{const i=g.useId(),s=`chart-${e||i.replace(/:/g,"")}`;return h.jsx(TZ.Provider,{value:{config:r},children:h.jsxs("div",{"data-chart":s,ref:o,className:K("flex aspect-video justify-center text-xs",t),...a,children:[h.jsx(I2e,{id:s,config:r}),h.jsx(__e,{children:n})]})})});IZ.displayName="Chart";const I2e=({id:e,config:t})=>{const n=Object.entries(t).filter(([r,a])=>a.theme||a.color);return n.length?h.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(R2e).map(([r,a])=>`
${a} [data-chart=${e}] {
${n.map(([o,i])=>{var c;const s=((c=i.theme)==null?void 0:c[r])||i.color;return s?`  --color-${o}: ${s};`:null}).join(`
`)}
}
`).join(`
`)}}):null},D2e=qa,DZ=g.forwardRef(({active:e,payload:t,className:n,indicator:r="dot",hideLabel:a=!1,hideIndicator:o=!1,label:i,labelFormatter:s,labelClassName:c,formatter:l,color:u,nameKey:d,labelKey:f},p)=>{const{config:y}=RZ(),m=g.useMemo(()=>{var j;if(a||!(t!=null&&t.length))return null;const[b]=t,w=`${f||b.dataKey||b.name||"value"}`,_=QN(y,b,w),x=!f&&typeof i=="string"?((j=y[i])==null?void 0:j.label)||i:_==null?void 0:_.label;return s?h.jsx("div",{className:K("font-medium",c),children:s(x,t)}):x?h.jsx("div",{className:K("font-medium",c),children:x}):null},[i,s,t,a,c,y,f]);if(!e||!(t!=null&&t.length))return null;const v=t.length===1&&r!=="dot";return h.jsxs("div",{ref:p,className:K("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[v?null:m,h.jsx("div",{className:"grid gap-1.5",children:t.map((b,w)=>{const _=`${d||b.name||b.dataKey||"value"}`,x=QN(y,b,_),j=u||b.payload.fill||b.color;return h.jsx("div",{className:K("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",r==="dot"&&"items-center"),children:l&&(b==null?void 0:b.value)!==void 0&&b.name?l(b.value,b.name,b,w,b.payload):h.jsxs(h.Fragment,{children:[x!=null&&x.icon?h.jsx(x.icon,{}):!o&&h.jsx("div",{className:K("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":v&&r==="dashed"}),style:{"--color-bg":j,"--color-border":j}}),h.jsxs("div",{className:K("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[h.jsxs("div",{className:"grid gap-1.5",children:[v?m:null,h.jsx("span",{className:"text-muted-foreground",children:(x==null?void 0:x.label)||b.name})]}),b.value&&h.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:b.value.toLocaleString()})]})]})},b.dataKey)})})]})});DZ.displayName="ChartTooltip";const L2e=g.forwardRef(({className:e,hideIcon:t=!1,payload:n,verticalAlign:r="bottom",nameKey:a},o)=>{const{config:i}=RZ();return n!=null&&n.length?h.jsx("div",{ref:o,className:K("flex items-center justify-center gap-4",r==="top"?"pb-3":"pt-3",e),children:n.map(s=>{const c=`${a||s.dataKey||"value"}`,l=QN(i,s,c);return h.jsxs("div",{className:K("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[l!=null&&l.icon&&!t?h.jsx(l.icon,{}):h.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:s.color}}),l==null?void 0:l.label]},s.value)})}):null});L2e.displayName="ChartLegend";function QN(e,t,n){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=n;return n in t&&typeof t[n]=="string"?a=t[n]:r&&n in r&&typeof r[n]=="string"&&(a=r[n]),a in e?e[a]:e[n]}const LZ=e=>{const t=["Bytes","KB","MB","GB","TB"];if(e===void 0)return"Unknown size";if(e===0)return"0 Byte";const n=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,n))} ${t[n]}`},$2e=g.memo(()=>{const{t:e}=Pe("flows"),[t,n]=g.useState(),r=Qa(y=>y.cachedLLMURLs),a=Ye(y=>y.currentSession),[o,i]=g.useState(),[s,c]=g.useState(""),[l,u]=g.useState(),d=g.useMemo(()=>({nodes:{label:e("session_info_node.entities.nodes"),color:"#2563eb"},edges:{label:e("session_info_node.entities.edges"),color:"#34d399"},threads:{label:e("session_info_node.entities.threads"),color:"#fbbf24"},llms:{label:e("session_info_node.entities.llms"),color:"#f87171"},prompts:{label:e("session_info_node.entities.prompts"),color:"#a78bfa"},tools:{label:e("session_info_node.entities.tools"),color:"#ffcccb"},schemas:{label:e("session_info_node.entities.schemas"),color:"#ffb6c1"},vectorDatabases:{label:e("session_info_node.entities.vector_databases"),color:"#ff69b4"},jsonlDatas:{label:e("session_info_node.entities.jsonl_data"),color:"#ff1493"},csvDatas:{label:e("session_info_node.entities.csv_data"),color:"#db7093"}}),[e]);g.useEffect(()=>{Ut(async()=>{const{functionCallingModelIds:y,prebuiltAppConfig:m}=await import("./index-D2o0-Nmt.js").then(async v=>(await v.__tla,v));return{functionCallingModelIds:y,prebuiltAppConfig:m}},__vite__mapDeps([9,1,2,3,4])).then(({functionCallingModelIds:y,prebuiltAppConfig:m})=>{n(r==null?void 0:r.map(v=>{const b=m.model_list.find(w=>v.includes(w.model));if(b)return{model_id:(b==null?void 0:b.model_id)||"",info:b,isFunctionCalling:y.includes((b==null?void 0:b.model_id)||"")}}))})},[r,a==null?void 0:a.id]);const f=g.useCallback(async()=>{navigator.storage.estimate().then(y=>{y&&c(e("session_info_node.used_bytes",{used:LZ(y.usage),total:LZ(y==null?void 0:y.quota)}))}),a!=null&&a.id&&(Promise.all([de("FlowNode").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("FlowEdge").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("Thread").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("Prompt").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("LLM").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("Schema").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("ToolDefinition").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("VectorDatabase").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("JSONLData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),de("CSVData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}})]).then(y=>{const m=y.reduce((v,b)=>b!=null&&b.updated_at&&(!v||new Date(b.updated_at)>v)?new Date(b.updated_at):v,a.updated_at?new Date(a.updated_at):void 0);i(m)}),Promise.all([de("FlowNode").count({where:{session_id:a==null?void 0:a.id}}),de("FlowEdge").count({where:{session_id:a==null?void 0:a.id}}),de("Thread").count({where:{session_id:a==null?void 0:a.id}}),de("Prompt").count({where:{session_id:a==null?void 0:a.id}}),de("LLM").count({where:{session_id:a==null?void 0:a.id}}),de("ToolDefinition").count({where:{session_id:a==null?void 0:a.id}}),de("Schema").count({where:{session_id:a==null?void 0:a.id}}),de("VectorDatabase").count({where:{session_id:a==null?void 0:a.id}}),de("JSONLData").count({where:{session_id:a==null?void 0:a.id}}),de("CSVData").count({where:{session_id:a==null?void 0:a.id}})]).then(([y,m,v,b,w,_,x,j,S,E])=>{u([{name:e("session_info_node.count_info.title"),nodes:y||0,edges:m||0,threads:v||0,prompts:b||0,llms:w||0,tools:_||0,schemas:x||0,vectorDatabases:j||0,jsonlDatas:S||0,csvDatas:E||0}])}))},[a==null?void 0:a.id,a==null?void 0:a.updated_at,e]),p=g.useCallback(()=>{f()},[f]);return g.useEffect(()=>{f()},[f]),h.jsxs(Qt,{className:"w-96",children:[h.jsxs(Vn,{children:[h.jsx(Yn,{children:e("session_info_node.title")}),h.jsx(F8,{children:o||a!=null&&a.updated_at?ERe(o||(a==null?void 0:a.updated_at)).fromNow():""})]}),h.jsxs(qn,{className:"grid gap-4",children:[h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsx("p",{className:"text-sm font-medium leading-none",children:e("session_info_node.disk_size")}),h.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})}),h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsxs("div",{className:"text-sm font-medium leading-none",children:[e("session_info_node.cached_llms"),h.jsx(En,{className:"ml-2",children:(t==null?void 0:t.length)||0})]}),t==null?void 0:t.map(y=>h.jsxs("div",{className:"text-sm text-muted-foreground gap-1",children:[y==null?void 0:y.model_id,h.jsx("div",{className:"max-w-full gap-1 flex flex-wrap mt-1",children:h.jsx(Fd,{model:y==null?void 0:y.info,isFunctionCalling:(y==null?void 0:y.isFunctionCalling)||!1,isCached:!0})})]},y==null?void 0:y.model_id))]})}),h.jsx("div",{children:h.jsx(IZ,{config:d,className:"min-h-28 w-full",children:h.jsxs(T2e,{accessibilityLayer:!0,data:l,children:[h.jsx(lZ,{vertical:!1}),h.jsx(Vg,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),h.jsx(D2e,{content:h.jsx(DZ,{})}),Object.entries(d).map(([y,m])=>h.jsx(Ss,{dataKey:y,fill:m.color,radius:4},y))]})})})]}),h.jsx(mi,{children:h.jsxs(ut,{className:"w-full",onClick:p,children:[h.jsx(fe,{size:24,name:"refresh-ccw"}),e("session_info_node.reload")]})})]})}),F2e=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);Ln(e,t)},B2e=g.memo(e=>{var c,l;const{t}=Pe("flows"),{id:n,data:r,isConnectable:a}=e,o=g.useRef(!1),i=$n(n),s=De(u=>u.updateNodes);return F2e(n),g.useEffect(()=>{var d;const u=r==null?void 0:r.entity;!u||!i||o.current||(d=u==null?void 0:u.schema_items)!=null&&d.length||r.loaded||(o.current=!0,de("SchemaItem").find({where:{schema_id:u.id}}).then(f=>{s([{id:i.id,type:"replace",item:{...i,data:{...(i==null?void 0:i.data)||{},loaded:!0,entity:{...r.entity,schema_items:f}}}}])}).finally(()=>{o.current=!1}))},[r.entity,r.loaded,i,s]),h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Tn,{id:n}),h.jsxs(iS,{defaultValue:"account",className:"w-[400px]",children:[h.jsxs(Gm,{className:"grid w-full grid-cols-2",children:[h.jsx(pa,{value:"account",children:t("schema_node.typescript")}),h.jsx(pa,{value:"password",children:t("schema_node.zod")})]}),h.jsx(ha,{value:"account",children:h.jsx(Qt,{className:"p-4",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:wye(((c=r==null?void 0:r.entity)==null?void 0:c.schema_items)||[])})})}),h.jsx(ha,{value:"password",children:h.jsx(Qt,{className:"p-4 max-w-full",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:$8(((l=r==null?void 0:r.entity)==null?void 0:l.schema_items)||[])})})})]})]}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:a})]})}),z2e=g.memo(e=>{var o,i;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{if(!(n!=null&&n.entity))return{headers:[],rows:[]};const s=ov(n.entity.csv);return{headers:mM(n.entity.headers),rows:s.map(c=>mM(c))}},[n==null?void 0:n.entity]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Tn,{id:t}),h.jsxs(Qt,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Vn,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(fe,{name:"file-spreadsheet",className:"mr-2"}),h.jsxs(nt,{className:"!font-medium leading-none tracking-tight pr-8",children:[oe.CSVData," ",(o=a==null?void 0:a.rows)!=null&&o.length?`(${((i=a==null?void 0:a.rows)==null?void 0:i.length)||0})`:""]})]})}),h.jsx(qn,{className:"pb-0",children:h.jsx(cy,{data:a.rows,headers:a.headers})})]})]}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),V2e=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.Schema&&(o==null?void 0:o.type)===oe.ToolDefinition){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Ln(e,n)},q2e=g.memo(({id:e,data:t,isConnectable:n})=>{var r,a;return V2e(e),h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:n}),h.jsx("div",{children:h.jsxs(Va,{className:"flex justify-center",children:[h.jsx(fe,{size:24,name:"wrench"}),h.jsxs("div",{className:"ml-2",children:[h.jsx(Ro,{children:`${((r=t.entity)==null?void 0:r.name)||""}`}),h.jsx(tl,{children:`${((a=t.entity)==null?void 0:a.description)||""}`})]})]})}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:n})]})}),U2e=e=>{const t=g.useCallback(async({edgeId:n})=>({deleteEdgeId:n}),[]);Ln(e,t)},W2e=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e;return U2e(t),h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:r}),h.jsx("div",{children:h.jsxs(Va,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(fa,{name:n.model||"brain",className:"w-7 h-7"}),h.jsx("div",{className:"ml-2 pr-4 flex items-center",children:h.jsx(Ro,{children:`${n.model||""}`})})]})}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),H2e=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
Use three sentences maximum and keep the answer as concise as possible.

{context}
`,Z2e=Ya(e=>{const{source:t,documents:n}=e,r=Jt(),{toast:a}=Yt(),{t:o}=Pe("dialogs"),{loading:i,createPrompt:s}=fz(),c=async l=>{try{if(!l.content||!l.content.includes("{context}")){a({title:o("create_vector_database_prompt.errors.fill_context"),variant:"destructive"});return}const u=l.content.replace("{context}",n.map(d=>`<document>${d.pageContent}</document>`).join(`
`));return await s(t,{...l,content:u}),r.hide(),!0}catch{a({title:o("create_vector_database_prompt.errors.create_failed"),variant:"destructive"})}};return h.jsx(ii,{open:r.visible,onOpenChange:r.hide,children:h.jsxs(lo,{className:"sm:max-w-[425px]",children:[h.jsx(uo,{children:h.jsxs("div",{className:"flex",children:[h.jsx(fe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(fo,{children:o("create_vector_database_prompt.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(cE,{onSubmit:c,loading:i,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:H2e}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(fe,{name:"info",className:"mr-2",size:14}),o("create_vector_database_prompt.fill_content_note")]})]})]})})}),K2e=()=>{const e=Ye(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async({prompt:i,source:s,metadata:c})=>{var l,u,d,f;try{const p=(l=s==null?void 0:s.data)==null?void 0:l.entity;if(!p||!e)throw new Error("Source or Session not found");n(!0);const y=((u=s.position)==null?void 0:u.x)||0,m=(((d=s.position)==null?void 0:d.y)||0)+(((f=s.measured)==null?void 0:f.height)||0),v=await de("Prompt").save({...i,status:(i==null?void 0:i.status)||Br.Started,role:(i==null?void 0:i.role)||cr.System,type:(i==null?void 0:i.type)||lr.Chat,content:(i==null?void 0:i.content)||"{context}",session_id:e});if(!v)throw new Error("Failed to save prompt");const b=await r({source_id:v.id,source_type:"Prompt",node_type:oe.Prompt,x:y,y:m+20});if(!b)throw new Error("Failed to save prompt node");const w=await de("FlowNodePlaceholder").save({placeholder:`Retriever for ${p.name}`,placeholder_type:zs.VECTOR_DATABASE_RETREIVER,session_id:e,metadata:c});if(!w)throw new Error("Failed to save node placeholder");const _=await r({source_id:w.id,source_type:"FlowNodePlaceholder",node_type:oe.PlaceHolder,x:y,y:m+40});if(!_)throw new Error("Failed to save node placeholder node");await a({source:b.id,target:_.id}),await a({source:s.id,target:_.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabaseRetriever:o}},X2e=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}
`,G2e=Ya(e=>{const{source:t}=e,n=Jt(),{toast:r}=Yt(),{t:a}=Pe("dialogs"),[o,i]=g.useState(1),[s,c]=g.useState(void 0),{loading:l,createVectorDatabaseRetriever:u}=K2e(),d=async y=>{try{const m=y.content;if(!m||!m.includes("{context}")){r({title:a("create_vector_database_retriever.errors.fill_context"),variant:"destructive"});return}return await u({source:t,prompt:{content:m},metadata:{k:o,minimalScore:s}}),i(1),c(void 0),n.hide(),!0}catch{r({title:a("create_vector_database_retriever.errors.create_failed"),variant:"destructive"})}},f=y=>{i(y.target.value?Number(y.target.value):void 0)},p=y=>{c(y.target.value?Number(y.target.value):void 0)};return h.jsx(ii,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(lo,{className:"sm:max-w-[425px]",children:[h.jsx(uo,{children:h.jsxs("div",{className:"flex",children:[h.jsx(fe,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(fo,{children:a("create_vector_database_retriever.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(cE,{onSubmit:d,loading:l,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:X2e}),h.jsxs(Qt,{children:[h.jsx(Vn,{children:h.jsx(Yn,{children:a("create_vector_database_retriever.retriever_settings")})}),h.jsxs(qn,{children:[h.jsx(nt,{children:a("create_vector_database_retriever.retriever_k")}),h.jsx(Mn,{value:o||"",type:"number",onChange:f,placeholder:a("create_vector_database_retriever.retriever_k_placeholder")}),h.jsx(nt,{children:a("create_vector_database_retriever.retriever_minimum_score")}),h.jsx(Mn,{value:s||"",type:"number",onChange:p,placeholder:a("create_vector_database_retriever.retriever_minimum_score_placeholder")})]})]}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(fe,{name:"info",className:"mr-2",size:14}),a("create_vector_database_retriever.fill_content_note")]})]})]})})}),Q2e=e=>{const t=De(a=>a.createOrUpdateFlowEdge),n=Ts(a=>a.index),r=g.useCallback(async({edgeId:a,target:o,source:i})=>{var s,c;try{const l=(s=o==null?void 0:o.data)==null?void 0:s.entity;if((i==null?void 0:i.type)===oe.CSVData&&(o==null?void 0:o.type)===oe.VectorDatabase){const u=(c=i==null?void 0:i.data)==null?void 0:c.entity;if(!u||!l)return{deleteEdgeId:a};const{rows:d}=FK(u.headers,u.csv),f=d.map(p=>new ep({pageContent:`${p.text}`}));await n({databaseId:l.id,dataSourceId:u.id,dataSourceType:"CSVData"},f),await t({source:i.id,target:o.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[t,n]);Ln(e,r)},J2e=e=>{const[t,n]=g.useState(!1),{t:r}=Pe("flows"),{toast:a}=Yt(),{getNode:o,getHandleConnections:i}=mr(),s=De(f=>f.updateNodes),c=Ts(f=>f.index),l=Ts(f=>f.similaritySearchWithScore),u=g.useCallback(async(f,p)=>{var y,m,v;try{const b=o(e);if(!b)return;const w=(y=b.data)==null?void 0:y.entity;if(!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(w.storage===Lr.DataNode){const _=(v=(m=i({nodeId:e,type:"target"}).map(x=>o(x.source)).find(x=>(x==null?void 0:x.type)&&[oe.JSONLData,oe.CSVData].includes(x==null?void 0:x.type)))==null?void 0:m.data)==null?void 0:v.entity;if(!_){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}return n(!0),await l({databaseId:w.id,dataSourceId:_.id,dataSourceType:hM(_)},f,p==null?void 0:p.k)}else return n(!0),await l({databaseId:w.id},f,p==null?void 0:p.k)}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,l,a,r,o]),d=g.useCallback(async(f,p)=>{var y,m,v,b;try{const w=o(e);if(!w)return;n(!0);const _=f.content?[new ep({pageContent:f.content,id:f.id,metadata:{id:f.id}})]:f.documents;if(!(_!=null&&_.length)){a({variant:"destructive",title:r("vector_database_node.errors.content_not_found")});return}const x=(y=w.data)==null?void 0:y.entity;if(!x||!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(x.storage===Lr.DataNode){const j=i({nodeId:e,type:"target"}).map(N=>o(N.source)).find(N=>(N==null?void 0:N.type)&&[oe.JSONLData,oe.CSVData].includes(N==null?void 0:N.type)),S=(m=j==null?void 0:j.data)==null?void 0:m.entity;if(!S){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}const E=hM(S),O=PS(_,10);let M=0;for(const N of O){if((v=p==null?void 0:p.onProgressReport)==null||v.call(p,{handling:N.length,handled:M,total:_.length}),await c({databaseId:x.id,dataSourceId:S.id,dataSourceType:E},N),E&&j){const P=await de(E).findOne({where:{id:S.id}});s([{type:"replace",id:j.id,item:{...j,data:{...j.data,entity:P}}}])}M+=N.length}}else{const j=PS(_,10);let S=0;for(const E of j){(b=p==null?void 0:p.onProgressReport)==null||b.call(p,{handling:E.length,handled:S,total:_.length}),await c({databaseId:x.id},E);const O=await de("VectorDatabase").findOne({where:{id:`${x.id}`}});s([{type:"replace",id:w.id,item:{...w,data:{...w.data,entity:O}}}]),S+=E.length}}}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,c,a,r,o,s]);return{loading:t,indexData:d,similaritySearchWithScore:u}},Y2e=g.memo(e=>{var S,E,O,M;const{t}=Pe("flows"),[n,r]=g.useState(0),[a,o]=g.useState("search"),i=$n(e.id),{id:s,data:c,isConnectable:l}=e,{loading:u,similaritySearchWithScore:d,indexData:f}=J2e(s),p=Jt(Z2e),y=Jt(G2e);Q2e(s);const m=g.useCallback(async(...N)=>{i&&await f(...N)},[f,i]),v=g.useCallback(async(N,P)=>{const R=N.trim(),k=await d(R,{k:P});if(k!=null&&k.length)return k},[d]),b=g.useCallback(N=>{p.show({source:i,documents:N.map(([P])=>P)})},[p,i]),w=g.useCallback(async()=>{y.show({source:i})},[y,i]),_=g.useCallback(async N=>{if(N.type.includes("text")||N.type.includes("txt")){const P=new FileReader;P.onload=async R=>{var C;const k=(C=R.target)==null?void 0:C.result;await m({content:k})},P.readAsText(N)}else if(N.type.endsWith("pdf")){const P=new Blob([N],{type:"application/pdf"}),R=await new B8(P,{pdfjs:async()=>{const k=await Ut(()=>import("./pdf.min-T3SIQZZM.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([11,1,2,3,4]));return await Ut(()=>import("./pdf.worker.min-CB1tp3fD.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([12,1,2,3,4])),k.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),k},parsedItemSeparator:" "}).load();await m({documents:R},{onProgressReport:k=>{r((k.handled+k.handling)/k.total)}})}},[m]),x=g.useMemo(()=>{var R,k;if(!((R=c==null?void 0:c.entity)!=null&&R.raw))return{headers:[],rows:[]};const N=["content","embedding","metadata"],P=ov((k=c==null?void 0:c.entity)==null?void 0:k.raw);return{headers:N,rows:P.map(C=>{try{return JSON.parse(C)}catch{return[]}})}},[(S=c==null?void 0:c.entity)==null?void 0:S.raw]),j=g.useMemo(()=>{switch(a){case"search":return h.jsx(ha,{value:"search",children:h.jsx(QF,{loading:u,onSimilaritySearch:v,onCreatePrompt:b,onCreateRetriever:w})});case"new":return h.jsx(ha,{className:"min-w-80",value:"new",children:h.jsx(JF,{loading:u,onCreateData:m})});case"file":return h.jsx(ha,{value:"file",children:h.jsx(YF,{loading:u,progress:n,onFileSubmit:_,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(ha,{value:"view",children:h.jsx(cy,{data:x.rows,headers:x.headers,limitLengthByColumns:{embedding:32}})})}},[m,b,w,_,v,u,a,n,x]);return h.jsxs("div",{className:"min-w-72",children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:l}),h.jsxs("div",{className:"max-w-full",children:[h.jsx(Tn,{id:s}),h.jsxs(Va,{className:"flex justify-center",variant:"default",children:[h.jsx(fe,{size:24,name:"database-zap"}),h.jsxs("div",{className:"ml-2 max-w-full",children:[h.jsx(Ro,{children:`${((E=c.entity)==null?void 0:E.name)||""}`}),h.jsxs(iS,{value:a,onValueChange:o,defaultValue:"search",className:K("w-full mt-4"),children:[h.jsxs(Gm,{className:K("grid w-full grid-cols-3",((O=c.entity)==null?void 0:O.storage)===Lr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(pa,{value:"search",children:t("vector_database_node.search")}),h.jsx(pa,{value:"new",children:t("vector_database_node.text")}),h.jsx(pa,{value:"file",children:t("vector_database_node.file")}),((M=c.entity)==null?void 0:M.storage)===Lr.DatabaseNode?h.jsx(pa,{value:"view",children:t("vector_database_node.view")}):void 0]}),j]})]})]})]}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:l})]})}),eTe={embedding:32},tTe=g.memo(e=>{var o,i,s;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{var u;if(!((u=n==null?void 0:n.entity)!=null&&u.jsonl))return{headers:[],rows:[]};const c=mM(n.entity.headers||""),l=ov(n.entity.jsonl);return{headers:c,rows:l.map(d=>{try{return JSON.parse(d)}catch{return[]}})}},[(o=n==null?void 0:n.entity)==null?void 0:o.jsonl,n.entity.headers]);return h.jsxs("div",{className:"min-w-80",children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Tn,{id:t}),h.jsxs(Qt,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Vn,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(fe,{name:"file-json",className:"mr-2"}),h.jsxs(nt,{className:"!font-medium leading-none tracking-tight pr-8",children:[oe.JSONLData," ",(i=a==null?void 0:a.rows)!=null&&i.length?`(${((s=a==null?void 0:a.rows)==null?void 0:s.length)||0})`:""]})]})}),h.jsx(qn,{className:"pb-0",children:h.jsx(cy,{data:a.rows,headers:a.headers,limitLengthByColumns:eTe})})]})]}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),$Z=60,FZ=140,nTe=Ja("supports-backdrop-blur:bg-white/10 supports-backdrop-blur:dark:bg-black/10 mx-auto flex h-[58px] w-max gap-2 rounded-lg border p-2 backdrop-blur-md"),BZ=W.forwardRef(({className:e,children:t,magnification:n=$Z,distance:r=FZ,direction:a="bottom",...o},i)=>{const s=c0(1/0),c=()=>W.Children.map(t,l=>W.isValidElement(l)&&l.type===Wf?W.cloneElement(l,{...l.props,mouseX:s,magnification:n,distance:r}):l);return h.jsx(Kf.div,{ref:i,onMouseMove:l=>s.set(l.pageX),onMouseLeave:()=>s.set(1/0),...o,className:K(nTe({className:e}),{"items-start":a==="top","items-center":a==="middle","items-end":a==="bottom"}),children:c()})});BZ.displayName="Dock";const Wf=({magnification:e=$Z,distance:t=FZ,mouseX:n,className:r,children:a,...o})=>{const i=g.useRef(null),s=mP(n||new ORe,u=>{var f;const d=((f=i.current)==null?void 0:f.getBoundingClientRect())??{x:0,width:0};return u-d.x-d.width/2}),c=mP(s,[-t,0,t],[40,e,40]),l=iX(c,{mass:.1,stiffness:150,damping:12});return h.jsx(Kf.div,{ref:i,style:{width:l},className:K("flex aspect-square cursor-pointer items-center justify-center rounded-full",r),...o,children:a})};Wf.displayName="DockIcon";let zZ,VZ,qZ,UZ,Kg,WZ,Hf,HZ,ZZ,KZ,XZ,GZ,QZ,JZ,YZ,eK,tK,nK,rK,aK,oK,iK,sK,cK,lK,uK,dK,fK;zZ=e=>g.createElement("svg",{viewBox:"0 0 256 254",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:256,height:254,preserveAspectRatio:"xMidYMid",...e},g.createElement("defs",null,g.createElement("linearGradient",{id:"c",x1:"50%",x2:"50%",y1:"0%",y2:"100%"},g.createElement("stop",{offset:"0%",stopColor:"#FFF"}),g.createElement("stop",{offset:"100%",stopColor:"#FFF",stopOpacity:0})),g.createElement("path",{id:"a",d:"M180.828 252.605a15.872 15.872 0 0 0 12.65-.486l52.501-25.262a15.94 15.94 0 0 0 9.025-14.364V41.197a15.939 15.939 0 0 0-9.025-14.363l-52.5-25.263a15.877 15.877 0 0 0-18.115 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.507 91.695a15.853 15.853 0 0 0 5.464 3.571Zm10.464-183.649-76.262 57.889 76.262 57.888V68.956Z"})),g.createElement("mask",{id:"b",fill:"#fff"},g.createElement("use",{xlinkHref:"#a"})),g.createElement("path",{fill:"#0065A9",d:"M246.135 26.873 193.593 1.575a15.885 15.885 0 0 0-18.123 3.08L3.466 161.482c-4.626 4.219-4.62 11.502.012 15.714l14.05 12.772a10.625 10.625 0 0 0 13.569.604L238.229 33.436c6.949-5.271 16.93-.315 16.93 8.407v-.61a15.938 15.938 0 0 0-9.024-14.36Z"}),g.createElement("path",{fill:"#007ACC",d:"m246.135 226.816-52.542 25.298a15.887 15.887 0 0 1-18.123-3.08L3.466 92.207c-4.626-4.218-4.62-11.502.012-15.713l14.05-12.773a10.625 10.625 0 0 1 13.569-.603l207.132 157.135c6.949 5.271 16.93.315 16.93-8.408v.611a15.939 15.939 0 0 1-9.024 14.36Z"}),g.createElement("path",{fill:"#1F9CF0",d:"M193.428 252.134a15.892 15.892 0 0 1-18.125-3.083c5.881 5.88 15.938 1.715 15.938-6.603V11.273c0-8.318-10.057-12.483-15.938-6.602a15.892 15.892 0 0 1 18.125-3.084l52.533 25.263a15.937 15.937 0 0 1 9.03 14.363V212.51c0 6.125-3.51 11.709-9.03 14.363l-52.533 25.262Z"}),g.createElement("path",{fill:"url(#c)",fillOpacity:.25,d:"M180.828 252.605a15.874 15.874 0 0 0 12.65-.486l52.5-25.263a15.938 15.938 0 0 0 9.026-14.363V41.197a15.939 15.939 0 0 0-9.025-14.363L193.477 1.57a15.877 15.877 0 0 0-18.114 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.506 91.695a15.857 15.857 0 0 0 5.465 3.571Zm10.464-183.65-76.262 57.89 76.262 57.888V68.956Z"})),VZ="/NoLLMChat/assets/plate-editor-C1jTW62C.png",qZ={[oe.Shape]:{width:100,height:100},[oe.CircleShape]:{width:100,height:100},[oe.TriangleShape]:{width:100,height:100},[oe.EditorApp]:{width:1240,height:400}},UZ=e=>{const t=$n(e),n=Ye(s=>s.currentSession),[r,a]=g.useState(!1),o=De(s=>s.createOrUpdateFlowNode),i=g.useCallback(async s=>{var c,l,u;try{if(a(!0),t&&(n==null?void 0:n.id)){const d=((c=t.position)==null?void 0:c.x)||0,f=(((l=t.position)==null?void 0:l.y)||0)+(((u=t.measured)==null?void 0:u.height)||0),p=await de("FlowNodeData").save({data:{},session_id:n.id});if(!p)throw new Error("Failed to save node data");if(!await o({node_type:s,data:{},source_id:p.id,source_type:"FlowNodeData",x:d,y:f+20,...qZ[s]||{}}))throw new Error("Failed to save node")}}finally{a(!1)}},[o,n==null?void 0:n.id,t]);return{loading:r,createNode:i}},Kg={applications:[{key:oe.EditorApp,image:VZ,label:"application_bar.editor"},{key:oe.VSLiteApp,icon:zZ,label:"application_bar.vslite"}],shapes:[{key:oe.Shape,icon:"square",label:"application_bar.square"},{key:oe.CircleShape,icon:"circle",label:"application_bar.circle"},{key:oe.TriangleShape,icon:"triangle",label:"application_bar.triangle"}],old:[{key:oe.CodeContainerApp,icon:"file-code-2",label:"application_bar.code_editor"}]},WZ=g.memo(e=>{const{t}=Pe("flows"),{toast:n}=Yt(),{loading:r,createNode:a}=UZ(e.id),o=async i=>{try{if(r)return;await a(i)}catch{n({description:t("application_bar.errors.add_node_failed"),variant:"destructive"})}};return h.jsx(wu,{children:h.jsxs(BZ,{direction:"middle",children:[Kg.applications.map(i=>{const s=i.icon;return h.jsx(Wf,{children:h.jsxs(Na,{children:[h.jsxs(Ma,{children:[s?h.jsx(s,{width:20,height:20,onClick:()=>o(i.key)}):void 0,i.image?h.jsx("img",{src:i.image,alt:t(i.label),className:"w-8 h-8 rounded-md",onClick:()=>o(i.key)}):void 0]}),h.jsx(Hr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)}),h.jsx(Ls,{orientation:"vertical",className:"h-full"}),Kg.shapes.map(i=>h.jsx(Wf,{children:h.jsxs(Na,{children:[h.jsx(Ma,{children:h.jsx(fe,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Hr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)),h.jsx(Ls,{orientation:"vertical",className:"h-full"}),Kg.old.map(i=>h.jsx(Wf,{children:h.jsxs(Na,{children:[h.jsx(Ma,{children:h.jsx(fe,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Hr,{children:h.jsx("p",{children:t(i.label)})})]})},i.label))]})})}),Hf=g.memo(e=>{const{lineClassName:t,handleClassName:n,...r}=e;return h.jsx(xue,{lineClassName:K("!border-1.5",t),handleClassName:K("!w-2 !h-2 !border-2 !rounded-full",n),...r})}),HZ=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.CircleShape,oe.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.Shape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Ln(e,n)},ZZ=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return HZ(t),h.jsxs(h.Fragment,{children:[h.jsx(Hf,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:he.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border border",children:h.jsx(Tn,{id:t})}),h.jsx(lt,{type:"source",position:he.Bottom,isConnectable:r})]})}),KZ=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.Shape,oe.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.CircleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Ln(e,n)},XZ=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return KZ(t),h.jsxs(h.Fragment,{children:[h.jsx(Hf,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:he.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border rounded-full border",children:h.jsx(Tn,{id:t})}),h.jsx(lt,{type:"source",position:he.Bottom,isConnectable:r})]})}),GZ=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.CircleShape,oe.Shape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.TriangleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Ln(e,n)},QZ=g.memo(e=>{const{id:t,selected:n,width:r,height:a,isConnectable:o}=e;return GZ(t),h.jsxs(h.Fragment,{children:[h.jsx(Hf,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:he.Top,isConnectable:o}),h.jsx("div",{className:"w-0 h-0 border-l-transparent border-r-transparent border-b-border",style:{borderLeftWidth:(r||0)/2,borderRightWidth:(r||0)/2,borderBottomWidth:a||0}}),h.jsx(Tn,{id:t,className:"absolute top-0 right-0"}),h.jsx(lt,{type:"source",position:he.Bottom,isConnectable:o})]})}),JZ=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.EditorApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Ln(e,n)},YZ=e=>{const t=$n(e),{t:n}=Pe("flows"),r=g.useRef(null),{toast:a}=Yt(),{getNode:o,getHandleConnections:i}=mr(),{stream:s}=Wc(),c=g.useCallback(async d=>{t&&(clearTimeout(r.current),r.current=setTimeout(async()=>{await de("FlowNode").update(t.id,{data:d})},150))},[t]),l=g.useCallback(async(d,f)=>{var p;if(t){const y=i({nodeId:e,type:"target"}).find(b=>{var w;return((w=o(b.source))==null?void 0:w.type)===oe.LLM}),m=y?o(y==null?void 0:y.source):void 0,v=(p=m==null?void 0:m.data)==null?void 0:p.entity;if(!m||!v)return a({variant:"destructive",description:n("editor_node.errors.llm_not_found")});if(m.data.status!==Ge.Loaded)return a({variant:"destructive",description:n("editor_node.errors.llm_not_loaded_yet")});try{return(await s(v.provider,typeof d=="string"?[new Dr(d)]:d,{onMessageUpdate:b=>{f==null||f(b.content)},llm:v})).content}catch(b){if(b instanceof Error&&b.message.includes("LLM_NOT_LOADED_YET"))return a({title:n("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:n("editor_node.errors.stream_message_failed")})}}},[t,i,e,o,a,n,s]),u=g.useCallback(d=>{if(!o(d))return[];const f=[];return i({nodeId:d,type:"target"}).forEach(p=>{const y=o(p.source);!y||y.type!==oe.LLM||f.push({node:y,connections:[p]})}),f},[i,o]);return{createMessage:l,updateEditorContent:c,getLinkedConnections:u}},eK=g.lazy(()=>Ut(()=>import("./index-BnMUIC5-.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,7,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),tK=g.memo(e=>{var l;const{id:t,data:n,selected:r,isConnectable:a}=e;JZ(t);const{createMessage:o,updateEditorContent:i,getLinkedConnections:s}=YZ(t),c=g.useCallback(u=>{i(u)},[i]);return h.jsxs("div",{className:"w-full min-w-[1240px] h-full",children:[h.jsx(Hf,{isVisible:!!r,minWidth:1240,minHeight:400}),h.jsx(lt,{type:"target",position:he.Top,isConnectable:a}),h.jsxs("div",{className:"min-w-10 min-h-10 w-full h-full rounded-lg border bg-background",children:[h.jsx(Tn,{className:"!z-[100]",id:t,enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(fe,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx("div",{className:"h-full w-ful rounded-lg","data-registry":"plate",children:h.jsx(eK,{defaultValue:(l=n==null?void 0:n.flowNode)==null?void 0:l.data,onValueChange:c,copilotStream:o})})})]}),h.jsx(lt,{type:"source",position:he.Bottom,isConnectable:a})]})}),nK=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);Ln(e,t)},rK=g.memo(e=>{var i,s;const{id:t,data:n,isConnectable:r}=e,{t:a}=Pe("flows");nK(t);let o="";switch((i=n.entity)==null?void 0:i.placeholder_type){case"VECTOR_DATABASE_RETREIVER":o=a("placeholder_node.vector_database_retriever");break}return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:r}),h.jsxs(Va,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(Tn,{id:t}),h.jsx(fe,{name:"land-plot",className:"w-7 h-7"}),h.jsxs("div",{className:"ml-2 pr-4",children:[h.jsx(Ro,{children:`${((s=n.entity)==null?void 0:s.placeholder)||""}`}),h.jsx(tl,{children:o?h.jsx(En,{children:o}):void 0})]})]}),h.jsx(lt,{type:"source",position:he.Bottom,id:"a",isConnectable:r})]})}),aK=g.lazy(()=>Ut(()=>import("./CodeContainerApp-DvxCEJM4.js").then(async e=>(await e.__tla,e)).then(e=>e.C),__vite__mapDeps([62,1,2,14,60,6]))),oK=g.memo(e=>{const{id:t,isConnectable:n}=e;return h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Tn,{id:t}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(fe,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(aK,{...e})})]}),h.jsx(lt,{type:"source",position:he.Bottom,isConnectable:n})]})}),iK=["empty-source","vite-vue","shadcn-react-vite","todo-app-react-vite","porfolio-nextjs"],sK=async e=>{switch(e){case"empty-source":return Ut(()=>import("./empty-source-Dw1dvL8s.js"),[]).then(t=>t.BASE);case"vite-vue":return Ut(()=>import("./vite-vue-Bmz2z3Fo.js"),[]).then(t=>t.BASE);case"shadcn-react-vite":return Ut(()=>import("./shadcn-react-vite-CDJ9BaE9.js"),[]).then(t=>t.BASE);case"todo-app-react-vite":return Ut(()=>import("./todo-app-react-vite-BBWBkRjR.js"),[]).then(t=>t.BASE);case"porfolio-nextjs":return Ut(()=>import("./porfolio-nextjs-DCkli5iW.js"),[]).then(t=>t.BASE);default:throw new Error(`Unknown source base: ${e}`)}},JM=g.memo(({className:e,onUpdateSourceBase:t})=>{const{t:n}=Pe("components"),[r,a]=g.useState();return h.jsxs(Qt,{className:K("mw-full",e),children:[h.jsx(Vn,{className:"p-4",children:h.jsx(Yn,{children:n("add_source_base.title")})}),h.jsx(qn,{className:"p-4",children:h.jsxs("div",{className:"flex items-center justify-center w-full h-full flex-col",children:[h.jsxs(Po,{onValueChange:o=>a(o),children:[h.jsx(Ba,{className:"w-full mb-4",children:h.jsx(ko,{placeholder:n("add_source_base.source_base_select_placeholder")})}),h.jsx(za,{children:iK.map(o=>h.jsx(er,{value:`${o}`,children:n(`add_source_base.sourcebases.${o.toLowerCase()}`)},`${o}`))})]}),h.jsx(ut,{className:"w-full",onClick:async()=>r&&t(await sK(r)),children:n("add_source_base.update_source")})]})})]})}),cK=()=>{const{getNode:e,getHandleConnections:t}=mr(),{stream:n}=Wc(),r=g.useCallback(async(o,i)=>{await de("FlowNode").update(o,{raw:Xv(i)})},[]),a=g.useCallback(o=>{if(!e(o))return[];const i=[];return t({nodeId:o,type:"target"}).forEach(s=>{const c=e(s.source);!c||c.type!==oe.LLM||i.push({node:c,connections:[s]})}),i},[t,e]);return{sendMessage:g.useCallback(async(o,i,{onMessageUpdate:s,onResponseMessageCreate:c}={})=>{const l=i.map(d=>d.role==="system"?new av(d.content):d.role==="user"?new Dr(d.content):new eo(d.content));c==null||c();const{content:u}=await n(Ct.WebLLM,[...l,new Dr(o)],{onMessageUpdate:({content:d})=>{s==null||s({nodeData:{loading:!0,content:d}})},llm:void 0});return s==null||s({nodeData:{loading:!1,content:u}}),u},[n]),getLinkedConnections:a,updateCodeContainerData:r}},lK=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.VSLiteApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Ln(e,n)},uK=g.lazy(()=>Ut(()=>import("./index-DIi5WtnO.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),dK=g.memo(e=>{var f,p,y,m;const{id:t,isConnectable:n,data:r}=e,[a,o]=g.useState((f=r==null?void 0:r.flowNode)!=null&&f.raw?Yv(r.flowNode.raw):void 0),{updateCodeContainerData:i,getLinkedConnections:s,sendMessage:c}=cK();lK(t);const l=g.useCallback(async v=>{var b,w;(b=r==null?void 0:r.flowNode)!=null&&b.id&&(await i((w=r==null?void 0:r.flowNode)==null?void 0:w.id,v),o(v))},[(p=r==null?void 0:r.flowNode)==null?void 0:p.id,i]),u=g.useCallback(async(v,b)=>{var w;return(w=r==null?void 0:r.flowNode)!=null&&w.id?await c(v,b):void 0},[(y=r==null?void 0:r.flowNode)==null?void 0:y.id,c]),d=g.useCallback(async v=>{o(b=>{var _;const w=e0(b||{},v);return i((_=r==null?void 0:r.flowNode)==null?void 0:_.id,w),w})},[(m=r==null?void 0:r.flowNode)==null?void 0:m.id,i]);return a?h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(lt,{type:"target",position:he.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Tn,{id:t,className:"z-50",enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(fe,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(uK,{fileSystemTree:a,onUpdateFileContent:d,sendMessage:u})})]}),h.jsx(lt,{type:"source",position:he.Bottom,isConnectable:n})]}):h.jsx("div",{className:"h-full flex justify-center items-center",children:h.jsx(JM,{className:"w-64",onUpdateSourceBase:l})})}),fK={[oe.LLM]:kz,[oe.Toolbox]:Sz,[oe.Thread]:Dz,[oe.Message]:cwe,[oe.Prompt]:uwe,[oe.SessionInfo]:$2e,[oe.Schema]:B2e,[oe.CSVData]:z2e,[oe.ToolDefinition]:q2e,[oe.DefaultEmbeddingModel]:W2e,[oe.VectorDatabase]:Y2e,[oe.JSONLData]:tTe,[oe.ApplicationBar]:WZ,[oe.Shape]:ZZ,[oe.CircleShape]:XZ,[oe.TriangleShape]:QZ,[oe.EditorApp]:tK,[oe.PlaceHolder]:rK,[oe.CodeContainerApp]:oK,[oe.VSLiteApp]:dK};function rTe(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...y}=d,m=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,y=g.useContext(p);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,aTe(a,...t)]}function aTe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var oTe="Toggle",JN=g.forwardRef((e,t)=>{const{pressed:n,defaultPressed:r=!1,onPressedChange:a,...o}=e,[i=!1,s]=Nn({prop:n,onChange:a,defaultProp:r});return h.jsx(Ae.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":e.disabled?"":void 0,...o,ref:t,onClick:ge(e.onClick,()=>{e.disabled||s(!i)})})});JN.displayName=oTe;let YN,Cs,eM,tM,Xg;YN=JN,Cs="ToggleGroup",[eM,VK]=rTe(Cs,[to]),tM=to(),Xg=W.forwardRef((e,t)=>{const{type:n,...r}=e;if(n==="single"){const a=r;return h.jsx(iTe,{...a,ref:t})}if(n==="multiple"){const a=r;return h.jsx(sTe,{...a,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${Cs}\``)}),Xg.displayName=Cs;var[pK,hK]=eM(Cs),iTe=W.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i,s]=Nn({prop:n,defaultProp:r,onChange:a});return h.jsx(pK,{scope:e.__scopeToggleGroup,type:"single",value:i?[i]:[],onItemActivate:s,onItemDeactivate:W.useCallback(()=>s(""),[s]),children:h.jsx(mK,{...o,ref:t})})}),sTe=W.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Nn({prop:n,defaultProp:r,onChange:a}),c=W.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=W.useCallback(u=>s((d=[])=>d.filter(f=>f!==u)),[s]);return h.jsx(pK,{scope:e.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:c,onItemDeactivate:l,children:h.jsx(mK,{...o,ref:t})})});Xg.displayName=Cs;var[cTe,lTe]=eM(Cs),mK=W.forwardRef((e,t)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:a=!0,orientation:o,dir:i,loop:s=!0,...c}=e,l=tM(n),u=Qo(i),d={role:"group",dir:u,...c};return h.jsx(cTe,{scope:n,rovingFocus:a,disabled:r,children:a?h.jsx(Jl,{asChild:!0,...l,orientation:o,dir:u,loop:s,children:h.jsx(Ae.div,{...d,ref:t})}):h.jsx(Ae.div,{...d,ref:t})})}),Gg="ToggleGroupItem",yK=W.forwardRef((e,t)=>{const n=hK(Gg,e.__scopeToggleGroup),r=lTe(Gg,e.__scopeToggleGroup),a=tM(e.__scopeToggleGroup),o=n.value.includes(e.value),i=r.disabled||e.disabled,s={...e,pressed:o,disabled:i},c=W.useRef(null);return r.rovingFocus?h.jsx(Yl,{asChild:!0,...a,focusable:!i,active:o,ref:c,children:h.jsx(nM,{...s,ref:t})}):h.jsx(nM,{...s,ref:t})});yK.displayName=Gg;let nM;nM=W.forwardRef((e,t)=>{const{__scopeToggleGroup:n,value:r,...a}=e,o=hK(Gg,n),i={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},s=o.type==="single"?i:void 0;return h.jsx(JN,{...s,...a,ref:t,onPressedChange:c=>{c?o.onItemActivate(r):o.onItemDeactivate(r)}})}),yv=Xg,gv=yK;const gK=Ja("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),uTe=g.forwardRef(({className:e,variant:t,size:n,...r},a)=>h.jsx(YN,{ref:a,className:K(gK({variant:t,size:n,className:e})),...r}));uTe.displayName=YN.displayName;const vK=g.createContext({size:"default",variant:"default"}),bK=g.forwardRef(({className:e,variant:t,size:n,children:r,...a},o)=>h.jsx(yv,{ref:o,className:K("flex items-center justify-center gap-1",e),...a,children:h.jsx(vK.Provider,{value:{variant:t,size:n},children:r})}));bK.displayName=yv.displayName;const wK=g.forwardRef(({className:e,children:t,variant:n,size:r,...a},o)=>{const i=g.useContext(vK);return h.jsx(gv,{ref:o,className:K(gK({variant:i.variant||n,size:i.size||r}),e),...a,children:t})});wK.displayName=gv.displayName;function dTe(){const e=Qe(t=>`x: ${t.transform[0].toFixed(2)}, y: ${t.transform[1].toFixed(2)}, zoom: ${t.transform[2].toFixed(2)}`);return h.jsx("div",{children:e})}function fTe({change:e}){var r,a,o,i;const t="id"in e?e.id:"-",{type:n}=e;return h.jsxs("div",{className:"mb-3",children:[h.jsxs("div",{children:["node id: ",t]}),h.jsxs("div",{children:[n==="add"?JSON.stringify(e.item,null,2):null,n==="dimensions"?`dimensions: ${(r=e.dimensions)==null?void 0:r.width} \xD7 ${(a=e.dimensions)==null?void 0:a.height}`:null,n==="position"?`position: ${(o=e.position)==null?void 0:o.x.toFixed(1)}, ${(i=e.position)==null?void 0:i.y.toFixed(1)}`:null,n==="remove"?"remove":null,n==="select"?e.selected?"select":"unselect":null]})]})}function pTe({limit:e=20}){const[t,n]=g.useState([]),r=It(),a=g.useCallback(i=>{n(s=>[...i,...s].slice(0,e))},[e]);g.useEffect(()=>(r.setState({onNodesChange:a}),()=>r.setState({onNodesChange:void 0})),[a,r]);const o=()=>h.jsx("div",{children:"No Changes Triggered"});return h.jsx(h.Fragment,{children:t.length===0?h.jsx(o,{}):t.map((i,s)=>h.jsx(fTe,{change:i},s))})}function hTe(){const{getInternalNode:e}=mr(),t=Xle();return h.jsx(Zle,{children:h.jsx("div",{className:"text-secondary-foreground",children:t.map(n=>{var o,i;const r=e(n.id);if(!r)return null;const a=r==null?void 0:r.internals.positionAbsolute;return h.jsx(mTe,{id:n.id,selected:!!n.selected,type:n.type||"default",position:n.position,absPosition:a,width:((o=n.measured)==null?void 0:o.width)??0,height:((i=n.measured)==null?void 0:i.height)??0,data:n.data},n.id)})})})}function mTe({id:e,type:t,selected:n,position:r,absPosition:a,width:o,height:i,data:s}){if(!o||!i)return null;const c=`translate(${a.x}px, ${a.y+i}px)`,l=`${r.x.toFixed(1)}, ${r.y.toFixed(1)}`,u=`${o} \xD7 ${i}`,d=n?"Selected":"Not Selected";return h.jsxs("div",{style:{position:"absolute",transform:c,width:o*2},className:"text-xs",children:[h.jsxs("div",{children:["id: ",e]}),h.jsxs("div",{children:["type: ",t]}),h.jsxs("div",{children:["selected: ",d]}),h.jsxs("div",{children:["position: ",l]}),h.jsxs("div",{children:["dimensions: ",u]}),h.jsxs("div",{children:["data: ",JSON.stringify(s,null,2)]})]})}function yTe({tools:e}){return h.jsx(bc,{position:"top-left",className:"bg-card p-1 border rounded shadow-sm",children:h.jsx(bK,{type:"multiple",children:e.map(({active:t,setActive:n,label:r,value:a})=>h.jsx(wK,{value:a,onClick:()=>n(o=>!o),"aria-pressed":t,className:"bg-card text-card-foreground transition-colors duration-300 hover:bg-secondary hover:text-secondary-foreground",children:r},a))})})}function xK(){const[e,t]=g.useState(!1),[n,r]=g.useState(!1),[a,o]=g.useState(!1),i=[{active:e,setActive:t,label:"Node Inspector",value:"node-inspector"},{active:n,setActive:r,label:"Change Logger",value:"change-logger"},{active:a,setActive:o,label:"Viewport Logger",value:"viewport-logger"}];return h.jsxs(h.Fragment,{children:[h.jsx(yTe,{tools:i}),n&&h.jsx(bc,{className:"text-xs p-5 bg-white rounded shadow-md overflow-y-auto max-h-[50%] mt-20",position:"bottom-right",children:h.jsx(pTe,{})}),e&&h.jsx(hTe,{}),a&&h.jsx(bc,{position:"bottom-left",className:"text-secondary-foreground",children:h.jsx(dTe,{})})]})}xK.displayName="DevTools";const gTe=()=>{const e=g.useRef({}),t=g.useRef({}),n=De(N=>N.flowEdges),r=Ye(N=>N.currentSession),a=De(N=>N.setNodes),o=De(N=>N.updateNodes),i=De(N=>N.updateEdges),s=De(N=>N.addConnectionToEdges),c=De(N=>N.reset),l=De(N=>N.findFlowEdges),u=De(N=>N.deleteFlowNode),d=De(N=>N.deleteFlowEdge),f=De(N=>N.updateFlowNode),p=De(N=>N.getNodes),y=De(N=>N.findFlowNodesWithSource),m=g.useRef(n),v=g.useRef(),[b,w]=g.useState({loading:!1});m.current=n;const _=g.useCallback(async(N,P)=>{try{v.current=N,c(),await(P==null?void 0:P())}catch{v.current=void 0}},[c]),x=g.useCallback(async N=>{try{if(!(r!=null&&r.id))return;w(k=>({...k,loading:!0}));const P=await y({...N,where:{...N.where,session_id:r.id}}),R=await l({where:[{source:Da(P.map(k=>k.id))},{target:Da(P.map(k=>k.id))}]});return{flowNodes:P,flowEdges:R}}finally{w(P=>({...P,loading:!1}))}},[y,l,r==null?void 0:r.id]),j=g.useCallback(async N=>{var P,R;for(const k of N)if("id"in k&&Object.values(md).includes(k.id)&&k.type!=="remove")o([k]);else if(k.type==="position"&&k.position&&!isNaN(k.position.x)&&!isNaN(k.position.y)){o([k]);const C=k.position.x,T=k.position.y;clearTimeout(e.current[k.id]),e.current[k.id]=setTimeout(async()=>{e.current[k.id]=void 0,await f({id:k.id,x:C,y:T},{silent:!0})},200)}else if(k.type==="remove"){const C=(P=p([k.id]))==null?void 0:P[0];if(!(C!=null&&C.type)||bde.includes(C.type))return;await u({id:k.id})}else if(k.type==="dimensions"&&k.dimensions&&!isNaN(k.dimensions.width)&&!isNaN(k.dimensions.height)){const C=(R=p([k.id]))==null?void 0:R[0];if(!(C!=null&&C.width)&&!(C!=null&&C.height))return;o([k]),clearTimeout(t.current[k.id]);const T=k.dimensions.width,A=k.dimensions.height;t.current[k.id]=setTimeout(async()=>{await f({id:k.id,width:T,height:A},{silent:!0})},200)}else k.type==="select"&&o([k])},[o,f,p,u]),S=g.useCallback(N=>{Promise.all(N.map(async P=>{if(P.type==="remove")return d({id:P.id})})),i(N)},[d,i]),E=g.useCallback(N=>{s(N)},[s]),O=g.useCallback(()=>{var N;(N=m.current)==null||N.length},[]),M=g.useCallback(N=>{a(P=>{var T,A;let R;if(typeof N=="function"?R=N(P):R=N,!R)return P;const k=P==null?void 0:P.find(I=>I.id===R.id),C={id:R.id,item:k?nm(k,R):{...R,position:{x:((T=R.position)==null?void 0:T.x)||0,y:((A=R.position)==null?void 0:A.y)||0}},type:k?"replace":"add"};return Ji([C],P)})},[a]);return{syncEdges:O,initialFlow:_,loadingState:b,prepareFlowInfo:x,updateNodeChanges:j,updateEdgeChanges:S,updateOrCreateNode:M,currentSessionIdRef:v,updateEdgeConnection:E}},vTe=e=>{const t=Ye(u=>{var d;return(d=u.currentSession)==null?void 0:d.id}),{loadingState:n,prepareFlowInfo:r,syncEdges:a,initialFlow:o,currentSessionIdRef:i}=e,s=De(u=>u.ready),c=De(u=>u.removeSyncNodeQueue),l=De(u=>u.removeSyncEdgeQueue);g.useLayoutEffect(()=>{},[t]),g.useEffect(()=>{n.loading||!s||!t||i.current===t||o(t,async()=>{await r({where:{session_id:t}})})},[o,r,n.loading,i,s,t]),g.useEffect(()=>{const u=De.subscribe(f=>f.syncNodeQueue,async(f,p)=>{const y=p.map(v=>v.timestamp),m=f.filter(v=>!y.includes(v.timestamp));m.length&&c(m.map(v=>v.timestamp))}),d=De.subscribe(f=>f.syncEdgeQueue,async(f,p)=>{const y=p.map(v=>v.timestamp),m=f.filter(v=>!y.includes(v.timestamp));m.length&&(l(m.map(v=>v.timestamp)),a())});return()=>{u(),d()}},[r,l,c,a])},bTe=()=>{const[e,t]=g.useState(!0),n=gTe(),r=Qa(u=>u.selectedModel),a=g.useRef(r),o=Qa(u=>u.setInitProgressCallback),{updateOrCreateNode:i,updateNodeChanges:s,updateEdgeChanges:c,updateEdgeConnection:l}=n;return vTe(n),a.current=r,g.useEffect(()=>{const u=o==null?void 0:o(d=>{if(!a.current)return;const f=`${a.current}`;i(p=>{const y=p==null?void 0:p.find(m=>{var v;return(v=m.data)!=null&&v.entity&&typeof m.data.entity=="object"&&"name"in m.data.entity?m.data.entity.name===f:!1});if(y)return y.data.label=d.text,y.data.status=Ge.Loading,d.progress===100&&(y.data.label="",y.data.status=Ge.Loaded),y})});return()=>{u==null||u()}},[o,i]),g.useMemo(()=>({updateNodeChanges:s,updateEdgeChanges:c,initializing:e,setInitializing:t,updateEdgeConnection:l}),[s,c,e,t,l])},wTe=()=>{const e=Ps(l=>l.theme),t=De(l=>l.nodes),n=De(l=>l.edges),{updateNodeChanges:r,updateEdgeChanges:a,updateEdgeConnection:o}=bTe(),i=g.useCallback(l=>{r(l)},[r]),s=g.useCallback(l=>{a(l)},[a]),c=g.useCallback(l=>{o(l)},[o]);return h.jsxs(Wle,{nodes:t,edges:n,nodeTypes:fK,onNodesChange:i,onEdgesChange:s,onConnect:c,panOnScroll:!0,panOnScrollMode:ci.Free,colorMode:e,fitView:!0,children:[h.jsx(eue,{variant:Oo.Dots,gap:24,size:1}),h.jsx(sue,{}),h.jsx(bue,{}),CRe?h.jsx(xK,{}):void 0]})},xTe=g.memo(wTe);function _Te(){return h.jsx(xTe,{})}const jTe=g.lazy(()=>Ut(()=>import("./DocumentViewer-DJlSnUKu.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([63,1,2,15]))),STe=()=>{const{documentId:e}=bp();return h.jsx(g.Suspense,{fallback:h.jsx(Wl,{flickeringGrid:!0,className:"w-full h-full"}),children:h.jsx(jTe,{name:e||""})})};function Qg(){const e=JP();return ks(e),h.jsx(NRe,{})}const ETe=OG(h.jsxs(ti,{errorElement:h.jsx(Qg,{}),children:[h.jsxs(ti,{element:h.jsx(LT,{requiredSession:!0}),children:[h.jsx(ti,{path:Kp.whiteboard,Component:_Te,errorElement:h.jsx(Qg,{})}),h.jsx(ti,{path:Kp.application,errorElement:h.jsx(Qg,{}),Component:uve}),h.jsx(ti,{path:"*",element:h.jsx(jG,{to:xn("whiteboard")})})]}),h.jsx(ti,{element:h.jsx(LT,{}),children:h.jsx(ti,{path:Kp.document,errorElement:h.jsx(Qg,{}),Component:STe})})]})),OTe=(e,t)=>{switch(CY){case"browser":return sk(e,t);case"hash":return GG(e);default:return sk(e,t)}},CTe=OTe(ETe,{basename:"/NoLLMChat/"});LK("[BASE_URL]","/NoLLMChat/");let _K;_K=g.memo(()=>{const e=!window.location.pathname.includes("/NoLLMChat/");return g.useLayoutEffect(()=>{e&&(window.location.href="/NoLLMChat/".replace("//","/"))},[e]),e?h.jsx(Wl,{className:"w-screen h-screen",simple:!0}):h.jsx(sQ,{router:CTe})},()=>!0),ZK=Object.freeze(Object.defineProperty({__proto__:null,default:_K},Symbol.toStringTag,{value:"Module"}))});export{Zl as $,yM as A,iv as B,gM as C,vM as D,Kl as E,sv as F,Xl as G,Ri as H,tp as I,np as J,cv as K,bM as L,wM as M,Rs as N,xM as O,_M as P,jM as Q,SM as R,lv as S,EM as T,OM as U,CM as V,NM as W,MM as X,PM as Y,uv as Z,Tt as _,kRe as __tla,dv as a,fv as a$,Gl as a0,Ii as a1,Di as a2,rp as a3,Ql as a4,Is as a5,Ds as a6,kM as a7,pv as a8,AM as a9,TM as aA,zK as aB,hv as aC,RM as aD,mv as aE,IM as aF,to as aG,VK as aH,Qo as aI,Jl as aJ,Yl as aK,yv as aL,gv as aM,vv as aN,bv as aO,wv as aP,xv as aQ,_v as aR,jv as aS,DM as aT,LM as aU,ap as aV,Sv as aW,Ev as aX,Ov as aY,Cv as aZ,Nv as a_,$M as aa,qK as ab,Mv as ac,UK as ad,FM as ae,BM as af,zM as ag,Pv as ah,VM as ai,WK as aj,kv as ak,Av as al,Tv as am,qM as an,Rv as ao,Iv as ap,Dv as aq,Lv as ar,$v as as,Fv as at,UM as au,WM as av,HK as aw,Bv as ax,HM as ay,ZM as az,eu as b,zv as b0,Vv as b1,qv as b2,op as b3,wn as b4,Uv as b5,ip as b6,Wv as b7,Hv as b8,tu as b9,ZK as bA,nu as ba,KK as bb,KM as bc,nt as bd,Ls as be,Zv as bf,Kv as bg,Zn as bh,De as bi,Ln as bj,$n as bk,Xv as bl,Gv as bm,XM as bn,GM as bo,Qv as bp,Jv as bq,ut as br,QM as bs,Yv as bt,e0 as bu,JM as bv,YM as bw,eP as bx,$s as by,Jo as bz,tP as c,$r as d,t0 as e,nP as f,rP as g,Fs as h,Fr as i,n0 as j,r0 as k,aP as l,ja as m,oP as n,a0 as o,o0 as p,iP as q,sP as r,cP as s,i0 as t,Fn as u,ru as v,s0 as w,au as x,Bs as y,lP as z};
