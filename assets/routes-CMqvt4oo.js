const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/few_shot-B66Vt9iw.js","assets/index-nXv2NFmm.js","assets/index-DbmpG02v.css","assets/dot-CHBIXRqb.js","assets/createLucideIcon-DKyIB8D1.js","assets/index-D98JkF8D.js","assets/objectWithoutPropertiesLoose-BjXSgPXB.js","assets/index-BqGmRIA8.js","assets/index-Cr8Tc6mT.css","assets/index-CIMzE0bz.js","assets/pdf-BeUxqsBa.js","assets/pdf.min-_jKpy57e.js","assets/pdf.worker.min-D4zSgXYp.js","assets/index-C42Ik6Ft.js","assets/use-prevent-pitch-zoom-fV-fTAH2.js","assets/index-JUk17oUP.js","assets/link-BUu6rTaK.js","assets/trash-2-Dpvbq54i.js","assets/text-C2ULUFM8.js","assets/external-link-D9SfWb1w.js","assets/unlink-OvbyDRF2.js","assets/index-Dwv60gqf.js","assets/list-Ckyg8Pod.js","assets/list-ordered-BJp-mHIw.js","assets/list-todo-Bfx_PH14.js","assets/indent-increase-CNtsWW26.js","assets/pilcrow-D6tF5nAw.js","assets/heading-1-BlAppKWr.js","assets/heading-2-yhLxtpWv.js","assets/heading-3-B96RyY38.js","assets/table-CY1vRpEm.js","assets/file-code-mhK3zF6g.js","assets/quote-CFRLyFrp.js","assets/minus-j0Izgvlb.js","assets/square-DHhIcjNi.js","assets/chevron-right-DDpmBazq.js","assets/image-HZDH_TYe.js","assets/table-of-contents-C9vJFO7B.js","assets/columns-3-QMANzLWH.js","assets/link-2-DzvIPFeD.js","assets/calendar-BaN-ZKBE.js","assets/plus-DRwVCPb8.js","assets/wrap-text-RDzhNUhd.js","assets/pen-CaAwftdW.js","assets/eye-DBvvanD4.js","assets/indent-decrease-B91DbJG5.js","assets/pointer-ldrdBsA8.js","assets/wand-sparkles-B5MH5YWY.js","assets/bold-B5CmWVzd.js","assets/italic-e6T4iYqk.js","assets/underline-5MvBwAOs.js","assets/strikethrough-zhEziCba.js","assets/code-xml-BcLnc11I.js","assets/baseline-C0WrH3eE.js","assets/paint-bucket-4wsUMFnG.js","assets/arrow-up-to-line-DBaHd7iK.js","assets/index-BCYu3EnN.css","assets/index-BhSMxwf6.js","assets/check-B-XmV6BJ.js","assets/circle-CyGFoACk.js","assets/index-KnKzh-cU.js","assets/index-HSnfLTSA.css","assets/CodeContainerApp-DJGvUQCN.js","assets/DocumentViewer-B54eJTT4.js"])))=>i.map(i=>d[i]);
var $De=Object.defineProperty;var FDe=(Yi,po,Gs)=>po in Yi?$De(Yi,po,{enumerable:!0,configurable:!0,writable:!0,value:Gs}):Yi[po]=Gs;var zP=(Yi,po,Gs)=>FDe(Yi,typeof po!="symbol"?po+"":po,Gs);import{r as g,M as UP,j as h,u as _v,P as BDe,a as VP,L as zDe,m as UDe,c as VDe,f as AX,i as WDe,b as WP,d as TX,e as HDe,g as qDe,_ as RX,h as IX,k as nu,l as Sv,n as co,o as oi,p as ru,q as fn,R as ZDe,s as fr,t as Rn,v as $e,w as _e,x as Ur,y as kt,z as G,A as lo,S as ii,B as pr,D as jv,C as KDe,E as Ev,F as me,G as DX,H as XDe,I as Re,J as hp,K as st,N as uo,O as an,Q as on,T as he,U as Ws,V as mp,W as LX,X as YDe,Y as JDe,Z as $X,$ as au,a0 as ou,a1 as En,a2 as ft,a3 as FX,a4 as Y,a5 as iu,a6 as QDe,a7 as GDe,a8 as On,a9 as ue,aa as e4e,ab as qi,ac as yp,ad as gp,ae as Qt,af as Vr,ag as t4e,ah as n4e,ai as r4e,aj as a4e,ak as vp,al as BX,am as o4e,an as i4e,ao as HP,ap as qP,aq as s4e,ar as c4e,as as zX,at as ZP,au as l4e,av as Ov,aw as u4e,ax as Vn,ay as d4e,az as f4e,aA as p4e,aB as Ra,aC as UX,aD as h4e,aE as su,aF as ae,aG as Wr,aH as Hr,aI as qr,aJ as KP,aK as VX,aL as XP,aM as m4e,aN as y4e,aO as WX,aP as g4e,aQ as v4e,aR as b4e,aS as Hs,aT as Cv,aU as bp,aV as w4e,aW as Zr,aX as kv,aY as YP,aZ as cu,a_ as HX,a$ as x4e,b0 as _4e,b1 as S4e,b2 as j4e,b3 as E4e,b4 as lu,b5 as O4e,b6 as C4e,b7 as qX,b8 as k4e,b9 as P4e,ba as N4e,bb as M4e,bc as ZX,bd as JP,be as Pt,bf as A4e,bg as QP,bh as T4e,bi as R4e,bj as I4e,__tla as D4e}from"./index-nXv2NFmm.js";import KX,{__tla as L4e}from"./dot-CHBIXRqb.js";let uu,GP,Pv,eN,tN,du,Nv,fu,Zi,wp,xp,Mv,nN,rN,qs,aN,oN,iN,sN,Av,cN,lN,uN,dN,fN,pN,Tv,zt,Rv,Iv,pu,Ki,Xi,_p,hu,Zs,Ks,hN,Dv,mN,yN,XX,Lv,gN,$v,vN,fo,YX,si,mu,yu,Fv,Bv,zv,Uv,Vv,Wv,Hv,qv,bN,wN,Sp,Zv,Kv,Xv,Yv,Jv,xN,JX,Qv,QX,_N,SN,jN,Gv,EN,GX,e0,t0,n0,ON,r0,a0,o0,i0,s0,c0,CN,kN,eY,l0,PN,NN,gu,u0,d0,f0,jp,Cn,p0,Ep,h0,m0,vu,tY,bu,nY,MN,it,Xs,y0,g0,tr,ze,Wn,Hn,v0,b0,AN,TN,w0,x0,yt,RN,_0,S0,IN,DN,LN,Ys,ci,$N,Kr,j0,FN,BN,Js,Xr,E0,O0,zN,Ia,UN,C0,k0,VN,WN,HN,P0,qn,wu,N0,xu,Qs,qN,$4e=Promise.all([(()=>{try{return D4e}catch{}})(),(()=>{try{return L4e}catch{}})()]).then(async()=>{var NX,MX;class Yi extends g.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function po({children:e,isPresent:t}){const n=g.useId(),r=g.useRef(null),a=g.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=g.useContext(UP);return g.useInsertionEffect(()=>{const{width:i,height:s,top:c,left:l}=a.current;if(t||!r.current||!i||!s)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return o&&(u.nonce=o),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${c}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),h.jsx(Yi,{isPresent:t,childRef:r,sizeRef:a,children:g.cloneElement(e,{ref:r})})}const Gs=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:o,mode:i})=>{const s=_v(oY),c=g.useId(),l=g.useCallback(d=>{s.set(d,!0);for(const f of s.values())if(!f)return;r&&r()},[s,r]),u=g.useMemo(()=>({id:c,initial:t,isPresent:n,custom:a,onExitComplete:l,register:d=>(s.set(d,!1),()=>s.delete(d))}),o?[Math.random(),l]:[n,l]);return g.useMemo(()=>{s.forEach((d,f)=>s.set(f,!1))},[n]),g.useEffect(()=>{!n&&!s.size&&r&&r()},[n]),i==="popLayout"&&(e=h.jsx(po,{isPresent:n,children:e})),h.jsx(BDe.Provider,{value:u,children:e})};function oY(){return new Map}const Cp=e=>e.key||"";function YN(e){const t=[];return g.Children.forEach(e,n=>{g.isValidElement(n)&&t.push(n)}),t}const iY=({children:e,exitBeforeEnter:t,custom:n,initial:r=!0,onExitComplete:a,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const s=g.useMemo(()=>YN(e),[e]),c=s.map(Cp),l=g.useRef(!0),u=g.useRef(s),d=_v(()=>new Map),[f,p]=g.useState(s),[m,y]=g.useState(s);VP(()=>{l.current=!1,u.current=s;for(let w=0;w<m.length;w++){const _=Cp(m[w]);c.includes(_)?d.delete(_):d.get(_)!==!0&&d.set(_,!1)}},[m,c.length,c.join("-")]);const v=[];if(s!==f){let w=[...s];for(let _=0;_<m.length;_++){const x=m[_],S=Cp(x);c.includes(S)||(w.splice(_,0,x),v.push(x))}i==="wait"&&v.length&&(w=v),y(YN(w)),p(s);return}const{forceRender:b}=g.useContext(zDe);return h.jsx(h.Fragment,{children:m.map(w=>{const _=Cp(w),x=s===m||c.includes(_),S=()=>{if(d.has(_))d.set(_,!0);else return;let j=!0;d.forEach(E=>{E||(j=!1)}),j&&(b==null||b(),y(u.current),a&&a())};return h.jsx(Gs,{isPresent:x,initial:!l.current||r?void 0:!1,custom:x?void 0:n,presenceAffectsLayout:o,mode:i,onExitComplete:x?void 0:S,children:w},_)})})};function M0(e){const t=_v(()=>UDe(e)),{isStatic:n}=g.useContext(UP);if(n){const[,r]=g.useState(e);g.useEffect(()=>t.on("change",r),[])}return t}function JN(e,t){const n=M0(t()),r=()=>n.set(t());return r(),VP(()=>{const a=()=>AX.preRender(r,!1,!0),o=e.map(i=>i.on("change",a));return()=>{o.forEach(i=>i()),VDe(r)}}),n}const sY=e=>e&&typeof e=="object"&&e.mix,cY=e=>sY(e)?e.mix:void 0;function lY(...e){const t=!Array.isArray(e[0]),n=t?0:-1,r=e[0+n],a=e[1+n],o=e[2+n],i=e[3+n],s=WDe(a,o,{mixer:cY(o[0]),...i});return t?s(r):s}function uY(e){WP.current=[],e();const t=JN(WP.current,e);return WP.current=void 0,t}function QN(e,t,n,r){if(typeof e=="function")return uY(e);const a=typeof t=="function"?t:lY(t,n,r);return Array.isArray(e)?GN(e,a):GN([e],([o])=>a(o))}function GN(e,t){const n=_v(()=>[]);return JN(e,()=>{n.length=0;const r=e.length;for(let a=0;a<r;a++)n[a]=e[a].get();return t(n)})}function eM(e){return typeof e=="number"?e:parseFloat(e)}function dY(e,t={}){const{isStatic:n}=g.useContext(UP),r=g.useRef(null),a=M0(TX(e)?eM(e.get()):e),o=g.useRef(a.get()),i=g.useRef(()=>{}),s=()=>{const l=r.current;l&&l.time===0&&l.sample(HDe.delta),c(),r.current=qDe({keyframes:[a.get(),o.current],velocity:a.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:i.current})},c=()=>{r.current&&r.current.stop()};return g.useInsertionEffect(()=>a.attach((l,u)=>n?u(l):(o.current=l,i.current=u,AX.update(s),a.get()),c),[JSON.stringify(t)]),VP(()=>{if(TX(e))return e.on("change",l=>a.set(eM(l)))},[a]),a}var rt=(e=>(e.Started="started",e.Downloading="downloading",e.Downloaded="downloaded",e.Loading="loading",e.Loaded="loaded",e))(rt||{}),_u=(e=>(e.LLM="LLM",e.embedding="embedding",e.VLM="VLM",e))(_u||{}),gt=(e=>(e.WebLLM="WebLLM",e.OpenAI="OpenAI",e.Groq="Groq",e.VertexAI="VertexAI",e))(gt||{}),Yr=(e=>(e.Started="started",e.Inprogress="inprogress",e.Success="success",e.Failed="failed",e))(Yr||{}),hr=(e=>(e.Human="human",e.User="user",e.AI="ai",e.System="system",e.Assistant="assistant",e.Tool="tool",e.FewShotExample="few_shot_example",e))(hr||{}),kp=(e=>(e.Started="started",e.Inprogress="inprogress",e.Done="done",e))(kp||{}),mr=(e=>(e.Chat="chat",e.FewShotExample="few_shot_example",e))(mr||{}),ec=(e=>(e.VECTOR_DATABASE_RETREIVER="VECTOR_DATABASE_RETREIVER",e))(ec||{});function tM(e,t,n,r,a){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=RX(t),i=RX(e),s=!1,c=i.length-1;c>=0;c--){var l=i[c],u=e[l];if(IX(t,l)&&!(t[l]===void 0&&u!==void 0&&Array.isArray(t)===!1)){var d=t[l];typeof u=="object"&&u!=null&&typeof d=="object"&&d!=null&&Array.isArray(u)===Array.isArray(d)?tM(u,d,n,r+"/"+nu(l),a):u!==d&&(a&&n.push({op:"test",path:r+"/"+nu(l),value:Sv(u)}),n.push({op:"replace",path:r+"/"+nu(l),value:Sv(d)}))}else Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+nu(l),value:Sv(u)}),n.push({op:"remove",path:r+"/"+nu(l)}),s=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&o.length==i.length))for(var c=0;c<o.length;c++){var l=o[c];!IX(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+nu(l),value:Sv(t[l])})}}}function fY(e,t,n=!1){var r=[];return tM(e,t,r,"",n),r}let nM,rM;nM=async(e,t)=>{let n="",r="",a;const o=[];await e;for await(const i of e)i&&(Array.isArray(i)?(o.push(...i.map(s=>s.content)),o!=null&&o.length&&(r=o.join(""),t==null||t({chunk:i,content:r}))):(n=typeof i=="object"&&"content"in i?`${i.content}`:`${i}`,t==null||t({chunk:i,content:n})),a=i);return{lastChunk:a,content:n}},rM=()=>{const e=co(a=>a.toolsCallingStream),t=co(a=>a.structuredStream),n=co(a=>a.stream),r=co(a=>a.getCurrentModelInfo);return{stream:g.useCallback(async(a,o)=>{var p;const{tools:i,schemas:s,onMessageUpdate:c,onMessageFinish:l}=o||{};let u;if(!await r())throw new Error("Model is not found");if(s!=null&&s.length?(s&&(s==null?void 0:s.length)>1&&oi("Multiple schemas are not supported. Only the first schema will be used."),u=t(((p=s==null?void 0:s[0])==null?void 0:p.schema_items)||[],a)):i!=null&&i.length?u=e(i,a):u=n(a),!u)throw new Error("Stream is not supported");const{lastChunk:d,content:f}=await nM(u,c);return l==null||l({content:f,lastChunk:d}),{lastChunk:d,content:f}},[r,n,t,e])}},Nv=globalThis||void 0||self;var Su={},aM;function pY(){if(aM)return Su;aM=1,Object.defineProperty(Su,"__esModule",{value:!0}),Su.parse=i,Su.serialize=l;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const f=function(){};return f.prototype=Object.create(null),f})();function i(f,p){const m=new o,y=f.length;if(y<2)return m;const v=(p==null?void 0:p.decode)||u;let b=0;do{const w=f.indexOf("=",b);if(w===-1)break;const _=f.indexOf(";",b),x=_===-1?y:_;if(w>x){b=f.lastIndexOf(";",w-1)+1;continue}const S=s(f,b,w),j=c(f,w,S),E=f.slice(S,j);if(m[E]===void 0){let O=s(f,w+1,x),P=c(f,x,O);const k=v(f.slice(O,P));m[E]=k}b=x+1}while(b<y);return m}function s(f,p,m){do{const y=f.charCodeAt(p);if(y!==32&&y!==9)return p}while(++p<m);return m}function c(f,p,m){for(;p>m;){const y=f.charCodeAt(--p);if(y!==32&&y!==9)return p+1}return m}function l(f,p,m){const y=(m==null?void 0:m.encode)||encodeURIComponent;if(!e.test(f))throw new TypeError(`argument name is invalid: ${f}`);const v=y(p);if(!t.test(v))throw new TypeError(`argument val is invalid: ${p}`);let b=f+"="+v;if(!m)return b;if(m.maxAge!==void 0){if(!Number.isInteger(m.maxAge))throw new TypeError(`option maxAge is invalid: ${m.maxAge}`);b+="; Max-Age="+m.maxAge}if(m.domain){if(!n.test(m.domain))throw new TypeError(`option domain is invalid: ${m.domain}`);b+="; Domain="+m.domain}if(m.path){if(!r.test(m.path))throw new TypeError(`option path is invalid: ${m.path}`);b+="; Path="+m.path}if(m.expires){if(!d(m.expires)||!Number.isFinite(m.expires.valueOf()))throw new TypeError(`option expires is invalid: ${m.expires}`);b+="; Expires="+m.expires.toUTCString()}if(m.httpOnly&&(b+="; HttpOnly"),m.secure&&(b+="; Secure"),m.partitioned&&(b+="; Partitioned"),m.priority)switch(typeof m.priority=="string"?m.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${m.priority}`)}if(m.sameSite)switch(typeof m.sameSite=="string"?m.sameSite.toLowerCase():m.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${m.sameSite}`)}return b}function u(f){if(f.indexOf("%")===-1)return f;try{return decodeURIComponent(f)}catch{return f}}function d(f){return a.call(f)==="[object Date]"}return Su}pY();var oM="popstate";function hY(e={}){function t(r,a){let{pathname:o,search:i,hash:s}=r.location;return tc("",{pathname:o,search:i,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:ho(a)}return sM(t,n,null,e)}function mY(e={}){function t(a,o){let{pathname:i="/",search:s="",hash:c=""}=mo(a.location.hash.substring(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),tc("",{pathname:i,search:s,hash:c},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(a,o){let i=a.document.querySelector("base"),s="";if(i&&i.getAttribute("href")){let c=a.location.href,l=c.indexOf("#");s=l===-1?c:c.slice(0,l)}return s+"#"+(typeof o=="string"?o:ho(o))}function r(a,o){pn(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return sM(t,n,r,e)}function nt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function pn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function yY(){return Math.random().toString(36).substring(2,10)}function iM(e,t){return{usr:e.state,key:e.key,idx:t}}function tc(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?mo(t):t,state:n,key:t&&t.key||r||yY()}}function ho({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function mo(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function sM(e,t,n,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,i=a.history,s="POP",c=null,l=u();l==null&&(l=0,i.replaceState({...i.state,idx:l},""));function u(){return(i.state||{idx:null}).idx}function d(){s="POP";let v=u(),b=v==null?null:v-l;l=v,c&&c({action:s,location:y.location,delta:b})}function f(v,b){s="PUSH";let w=tc(y.location,v,b);n&&n(w,v),l=u()+1;let _=iM(w,l),x=y.createHref(w);try{i.pushState(_,"",x)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;a.location.assign(x)}o&&c&&c({action:s,location:y.location,delta:1})}function p(v,b){s="REPLACE";let w=tc(y.location,v,b);n&&n(w,v),l=u();let _=iM(w,l),x=y.createHref(w);i.replaceState(_,"",x),o&&c&&c({action:s,location:y.location,delta:0})}function m(v){let b=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof v=="string"?v:ho(v);return w=w.replace(/ $/,"%20"),nt(b,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,b)}let y={get action(){return s},get location(){return e(a,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(oM,d),c=v,()=>{a.removeEventListener(oM,d),c=null}},createHref(v){return t(a,v)},createURL:m,encodeLocation(v){let b=m(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:p,go(v){return i.go(v)}};return y}var gY=new Set(["lazy","caseSensitive","path","id","index","children"]);function vY(e){return e.index===!0}function Pp(e,t,n=[],r={}){return e.map((a,o)=>{let i=[...n,String(o)],s=typeof a.id=="string"?a.id:i.join("-");if(nt(a.index!==!0||!a.children,"Cannot specify children on an index route"),nt(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),vY(a)){let c={...a,...t(a),id:s};return r[s]=c,c}else{let c={...a,...t(a),id:s,children:void 0};return r[s]=c,a.children&&(c.children=Pp(a.children,t,i,r)),c}})}function li(e,t,n="/"){return Np(e,t,n,!1)}function Np(e,t,n,r){let a=typeof t=="string"?mo(t):t,o=Jr(a.pathname||"/",n);if(o==null)return null;let i=cM(e);wY(i);let s=null;for(let c=0;s==null&&c<i.length;++c){let l=MY(o);s=PY(i[c],l,r)}return s}function bY(e,t){let{route:n,pathname:r,params:a}=e;return{id:n.id,pathname:r,params:a,data:t[n.id],handle:n.handle}}function cM(e,t=[],n=[],r=""){let a=(o,i,s)=>{let c={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(nt(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let l=Da([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(nt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),cM(o.children,t,u,l)),!(o.path==null&&!o.index)&&t.push({path:l,score:CY(l,o.index),routesMeta:u})};return e.forEach((o,i)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))a(o,i);else for(let c of lM(o.path))a(o,i,c)}),t}function lM(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let i=lM(r.join("/")),s=[];return s.push(...i.map(c=>c===""?o:[o,c].join("/"))),a&&s.push(...i),s.map(c=>e.startsWith("/")&&c===""?"/":c)}function wY(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:kY(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var xY=/^:[\w-]+$/,_Y=3,SY=2,jY=1,EY=10,OY=-2,uM=e=>e==="*";function CY(e,t){let n=e.split("/"),r=n.length;return n.some(uM)&&(r+=OY),t&&(r+=SY),n.filter(a=>!uM(a)).reduce((a,o)=>a+(xY.test(o)?_Y:o===""?jY:EY),r)}function kY(e,t){return e.length===t.length&&e.slice(0,-1).every((n,r)=>n===t[r])?e[e.length-1]-t[t.length-1]:0}function PY(e,t,n=!1){let{routesMeta:r}=e,a={},o="/",i=[];for(let s=0;s<r.length;++s){let c=r[s],l=s===r.length-1,u=o==="/"?t:t.slice(o.length)||"/",d=Mp({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),f=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=Mp({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Da([o,d.pathname]),pathnameBase:RY(Da([o,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(o=Da([o,d.pathnameBase]))}return i}function Mp(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=NY(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((c,{paramName:l,isOptional:u},d)=>{if(l==="*"){let p=s[d]||"";i=o.slice(0,o.length-p.length).replace(/(.)\/+$/,"$1")}const f=s[d];return u&&!f?c[l]=void 0:c[l]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:i,pattern:e}}function NY(e,t=!1,n=!0){pn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,i,s)=>(r.push({paramName:i,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function MY(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return pn(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Jr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function AY(e,t="/"){let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?mo(e):e;return{pathname:n?n.startsWith("/")?n:TY(n,t):t,search:IY(r),hash:DY(a)}}function TY(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function A0(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function dM(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Ap(e){let t=dM(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function Tp(e,t,n,r=!1){let a;typeof e=="string"?a=mo(e):(a={...e},nt(!a.pathname||!a.pathname.includes("?"),A0("?","pathname","search",a)),nt(!a.pathname||!a.pathname.includes("#"),A0("#","pathname","hash",a)),nt(!a.search||!a.search.includes("#"),A0("#","search","hash",a)));let o=e===""||a.pathname==="",i=o?"/":a.pathname,s;if(i==null)s=n;else{let d=t.length-1;if(!r&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),d-=1;a.pathname=f.join("/")}s=d>=0?t[d]:"/"}let c=AY(a,s),l=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}var Da=e=>e.join("/").replace(/\/\/+/g,"/"),RY=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),IY=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,DY=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Rp=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function Ip(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var fM=["POST","PUT","PATCH","DELETE"],LY=new Set(fM),$Y=["GET",...fM],FY=new Set($Y),BY=new Set([301,302,303,307,308]),zY=new Set([307,308]),T0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},UY={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ju={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},R0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,VY=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),pM="remix-router-transitions",hM=Symbol("ResetLoaderData");function mM(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";nt(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.mapRouteProperties||VY,a={},o=Pp(e.routes,r,void 0,a),i,s=e.basename||"/",c=e.dataStrategy||KY,l=e.patchRoutesOnNavigation,u={...e.future},d=null,f=new Set,p=null,m=null,y=null,v=e.hydrationData!=null,b=li(o,e.history.location,s),w=null;if(b==null&&!l){let X=kr(404,{pathname:e.history.location.pathname}),{matches:re,route:ce}=CM(o);b=re,w={[ce.id]:X}}b&&!e.hydrationData&&Ne(b,o,e.history.location.pathname).active&&(b=null);let _;if(b)if(b.some(X=>X.route.lazy))_=!1;else if(!b.some(X=>X.route.loader))_=!0;else{let X=e.hydrationData?e.hydrationData.loaderData:null,re=e.hydrationData?e.hydrationData.errors:null;if(re){let ce=b.findIndex(ge=>re[ge.route.id]!==void 0);_=b.slice(0,ce+1).every(ge=>!D0(ge.route,X,re))}else _=b.every(ce=>!D0(ce.route,X,re))}else{_=!1,b=[];let X=Ne(null,o,e.history.location.pathname);X.active&&X.matches&&(b=X.matches)}let x,S={historyAction:e.history.action,location:e.history.location,matches:b,initialized:_,navigation:T0,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||w,fetchers:new Map,blockers:new Map},j="POP",E=!1,O,P=!1,k=new Map,N=null,R=!1,M=!1,C=new Set,T=new Map,A=0,I=-1,F=new Map,D=new Set,V=new Map,U=new Map,B=new Set,K=new Map,te,L=null;function $(){if(d=e.history.listen(({action:X,location:re,delta:ce})=>{if(te){te(),te=void 0;return}pn(K.size===0||ce!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ge=qt({currentLocation:S.location,nextLocation:re,historyAction:X});if(ge&&ce!=null){let Ae=new Promise(Be=>{te=Be});e.history.go(ce*-1),De(ge,{state:"blocked",location:re,proceed(){De(ge,{state:"proceeding",proceed:void 0,reset:void 0,location:re}),Ae.then(()=>e.history.go(ce))},reset(){let Be=new Map(S.blockers);Be.set(ge,ju),Z({blockers:Be})}});return}return le(X,re)}),n){oJ(t,k);let X=()=>iJ(t,k);t.addEventListener("pagehide",X),N=()=>t.removeEventListener("pagehide",X)}return S.initialized||le("POP",S.location,{initialHydration:!0}),x}function W(){d&&d(),N&&N(),f.clear(),O&&O.abort(),S.fetchers.forEach((X,re)=>Ie(re)),S.blockers.forEach((X,re)=>ye(re))}function q(X){return f.add(X),()=>f.delete(X)}function Z(X,re={}){S={...S,...X};let ce=[],ge=[];S.fetchers.forEach((Ae,Be)=>{Ae.state==="idle"&&(B.has(Be)?ce.push(Be):ge.push(Be))}),[...f].forEach(Ae=>Ae(S,{deletedFetchers:ce,viewTransitionOpts:re.viewTransitionOpts,flushSync:re.flushSync===!0})),ce.forEach(Ae=>Ie(Ae)),ge.forEach(Ae=>S.fetchers.delete(Ae))}function ee(X,re,{flushSync:ce}={}){var je,Ye;let ge=S.actionData!=null&&S.navigation.formMethod!=null&&Qr(S.navigation.formMethod)&&S.navigation.state==="loading"&&((je=X.state)==null?void 0:je._isRedirect)!==!0,Ae;re.actionData?Object.keys(re.actionData).length>0?Ae=re.actionData:Ae=null:ge?Ae=S.actionData:Ae=null;let Be=re.loaderData?EM(S.loaderData,re.loaderData,re.matches||[],re.errors):S.loaderData,qe=S.blockers;qe.size>0&&(qe=new Map(qe),qe.forEach((ot,Ut)=>qe.set(Ut,ju)));let Te=E===!0||S.navigation.formMethod!=null&&Qr(S.navigation.formMethod)&&((Ye=X.state)==null?void 0:Ye._isRedirect)!==!0;i&&(o=i,i=void 0),R||j==="POP"||(j==="PUSH"?e.history.push(X,X.state):j==="REPLACE"&&e.history.replace(X,X.state));let Le;if(j==="POP"){let ot=k.get(S.location.pathname);ot&&ot.has(X.pathname)?Le={currentLocation:S.location,nextLocation:X}:k.has(X.pathname)&&(Le={currentLocation:X,nextLocation:S.location})}else if(P){let ot=k.get(S.location.pathname);ot?ot.add(X.pathname):(ot=new Set([X.pathname]),k.set(S.location.pathname,ot)),Le={currentLocation:S.location,nextLocation:X}}Z({...re,actionData:Ae,loaderData:Be,historyAction:j,location:X,initialized:!0,navigation:T0,revalidation:"idle",restoreScrollPosition:Pe(X,re.matches||S.matches),preventScrollReset:Te,blockers:qe},{viewTransitionOpts:Le,flushSync:ce===!0}),j="POP",E=!1,P=!1,R=!1,M=!1,L==null||L.resolve(),L=null}async function oe(X,re){if(typeof X=="number"){e.history.go(X);return}let ce=I0(S.location,S.matches,s,X,re==null?void 0:re.fromRouteId,re==null?void 0:re.relative),{path:ge,submission:Ae,error:Be}=yM(!1,ce,re),qe=S.location,Te=tc(S.location,ge,re&&re.state);Te={...Te,...e.history.encodeLocation(Te)};let Le=re&&re.replace!=null?re.replace:void 0,je="PUSH";Le===!0?je="REPLACE":Le===!1||Ae!=null&&Qr(Ae.formMethod)&&Ae.formAction===S.location.pathname+S.location.search&&(je="REPLACE");let Ye=re&&"preventScrollReset"in re?re.preventScrollReset===!0:void 0,ot=(re&&re.flushSync)===!0,Ut=qt({currentLocation:qe,nextLocation:Te,historyAction:je});if(Ut){De(Ut,{state:"blocked",location:Te,proceed(){De(Ut,{state:"proceeding",proceed:void 0,reset:void 0,location:Te}),oe(X,re)},reset(){let Zt=new Map(S.blockers);Zt.set(Ut,ju),Z({blockers:Zt})}});return}await le(je,Te,{submission:Ae,pendingError:Be,preventScrollReset:Ye,replace:re&&re.replace,enableViewTransition:re&&re.viewTransition,flushSync:ot})}function H(){L||(L=sJ()),z(),Z({revalidation:"loading"});let X=L.promise;return S.navigation.state==="submitting"?X:S.navigation.state==="idle"?(le(S.historyAction,S.location,{startUninterruptedRevalidation:!0}),X):(le(j||S.historyAction,S.navigation.location,{overrideNavigation:S.navigation,enableViewTransition:P===!0}),X)}async function le(X,re,ce){O&&O.abort(),O=null,j=X,R=(ce&&ce.startUninterruptedRevalidation)===!0,ke(S.location,S.matches),E=(ce&&ce.preventScrollReset)===!0,P=(ce&&ce.enableViewTransition)===!0;let ge=i||o,Ae=ce&&ce.overrideNavigation,Be=li(ge,re,s),qe=(ce&&ce.flushSync)===!0,Te=Ne(Be,ge,re.pathname);if(Te.active&&Te.matches&&(Be=Te.matches),!Be){let{error:dt,notFoundMatches:ur,route:nn}=$t(re.pathname);ee(re,{matches:ur,loaderData:{},errors:{[nn.id]:dt}},{flushSync:qe});return}if(S.initialized&&!M&&eJ(S.location,re)&&!(ce&&ce.submission&&Qr(ce.submission.formMethod))){ee(re,{matches:Be},{flushSync:qe});return}O=new AbortController;let Le=nc(e.history,re,O.signal,ce&&ce.submission),je;if(ce&&ce.pendingError)je=[Ji(Be).route.id,{type:"error",error:ce.pendingError}];else if(ce&&ce.submission&&Qr(ce.submission.formMethod)){let dt=await ie(Le,re,ce.submission,Be,Te.active,{replace:ce.replace,flushSync:qe});if(dt.shortCircuited)return;if(dt.pendingActionResult){let[ur,nn]=dt.pendingActionResult;if(yr(nn)&&Ip(nn.error)&&nn.error.status===404){O=null,ee(re,{matches:dt.matches,loaderData:{},errors:{[ur]:nn.error}});return}}Be=dt.matches||Be,je=dt.pendingActionResult,Ae=F0(re,ce.submission),qe=!1,Te.active=!1,Le=nc(e.history,Le.url,Le.signal)}let{shortCircuited:Ye,matches:ot,loaderData:Ut,errors:Zt}=await pe(Le,re,Be,Te.active,Ae,ce&&ce.submission,ce&&ce.fetcherSubmission,ce&&ce.replace,ce&&ce.initialHydration===!0,qe,je);Ye||(O=null,ee(re,{matches:ot||Be,...OM(je),loaderData:Ut,errors:Zt}))}async function ie(X,re,ce,ge,Ae,Be={}){z();let qe=rJ(re,ce);if(Z({navigation:qe},{flushSync:Be.flushSync===!0}),Ae){let je=await Ge(ge,re.pathname,X.signal);if(je.type==="aborted")return{shortCircuited:!0};if(je.type==="error"){let Ye=Ji(je.partialMatches).route.id;return{matches:je.partialMatches,pendingActionResult:[Ye,{type:"error",error:je.error}]}}else if(je.matches)ge=je.matches;else{let{notFoundMatches:Ye,error:ot,route:Ut}=$t(re.pathname);return{matches:Ye,pendingActionResult:[Ut.id,{type:"error",error:ot}]}}}let Te,Le=Eu(ge,re);if(!Le.route.action&&!Le.route.lazy)Te={type:"error",error:kr(405,{method:X.method,pathname:re.pathname,routeId:Le.route.id})};else if(Te=(await Qe("action",S,X,[Le],ge,null))[Le.route.id],X.signal.aborted)return{shortCircuited:!0};if(Qi(Te)){let je;return Be&&Be.replace!=null?je=Be.replace:je=_M(Te.response.headers.get("Location"),new URL(X.url),s)===S.location.pathname+S.location.search,await Je(X,Te,!0,{submission:ce,replace:je}),{shortCircuited:!0}}if(yr(Te)){let je=Ji(ge,Le.route.id);return(Be&&Be.replace)!==!0&&(j="PUSH"),{matches:ge,pendingActionResult:[je.route.id,Te]}}return{matches:ge,pendingActionResult:[Le.route.id,Te]}}async function pe(X,re,ce,ge,Ae,Be,qe,Te,Le,je,Ye){let ot=Ae||F0(re,Be),Ut=Be||qe||MM(ot),Zt=!R&&!Le;if(ge){if(Zt){let dr=Oe(Ye);Z({navigation:ot,...dr!==void 0?{actionData:dr}:{}},{flushSync:je})}let wt=await Ge(ce,re.pathname,X.signal);if(wt.type==="aborted")return{shortCircuited:!0};if(wt.type==="error"){let dr=Ji(wt.partialMatches).route.id;return{matches:wt.partialMatches,loaderData:{},errors:{[dr]:wt.error}}}else if(wt.matches)ce=wt.matches;else{let{error:dr,notFoundMatches:Vs,route:Jt}=$t(re.pathname);return{matches:Vs,loaderData:{},errors:{[Jt.id]:dr}}}}let dt=i||o,[ur,nn]=vM(e.history,S,ce,Ut,re,Le===!0,M,C,B,V,D,dt,s,Ye);if(I=++A,ur.length===0&&nn.length===0){let wt=Q();return ee(re,{matches:ce,loaderData:{},errors:Ye&&yr(Ye[1])?{[Ye[0]]:Ye[1].error}:null,...OM(Ye),...wt?{fetchers:new Map(S.fetchers)}:{}},{flushSync:je}),{shortCircuited:!0}}if(Zt){let wt={};if(!ge){wt.navigation=ot;let dr=Oe(Ye);dr!==void 0&&(wt.actionData=dr)}nn.length>0&&(wt.fetchers=Ue(nn)),Z(wt,{flushSync:je})}nn.forEach(wt=>{Xe(wt.key),wt.controller&&T.set(wt.key,wt.controller)});let Us=()=>nn.forEach(wt=>Xe(wt.key));O&&O.signal.addEventListener("abort",Us);let{loaderResults:Ta,fetcherResults:Hi}=await Rt(S,ce,ur,nn,X);if(X.signal.aborted)return{shortCircuited:!0};O&&O.signal.removeEventListener("abort",Us),nn.forEach(wt=>T.delete(wt.key));let so=Dp(Ta);if(so)return await Je(X,so.result,!0,{replace:Te}),{shortCircuited:!0};if(so=Dp(Hi),so)return D.add(so.key),await Je(X,so.result,!0,{replace:Te}),{shortCircuited:!0};let{loaderData:pp,errors:zr}=jM(S,ce,Ta,Ye,nn,Hi);Le&&S.errors&&(zr={...S.errors,...zr});let Gl=Q(),eu=ne(I),tu=Gl||eu||nn.length>0;return{matches:ce,loaderData:pp,errors:zr,...tu?{fetchers:new Map(S.fetchers)}:{}}}function Oe(X){if(X&&!yr(X[1]))return{[X[0]]:X[1].data};if(S.actionData)return Object.keys(S.actionData).length===0?null:S.actionData}function Ue(X){return X.forEach(re=>{let ce=S.fetchers.get(re.key),ge=Ou(void 0,ce?ce.data:void 0);S.fetchers.set(re.key,ge)}),new Map(S.fetchers)}async function Ve(X,re,ce,ge){Xe(X);let Ae=(ge&&ge.flushSync)===!0,Be=i||o,qe=I0(S.location,S.matches,s,ce,re,ge==null?void 0:ge.relative),Te=li(Be,qe,s),Le=Ne(Te,Be,qe);if(Le.active&&Le.matches&&(Te=Le.matches),!Te){fe(X,re,kr(404,{pathname:qe}),{flushSync:Ae});return}let{path:je,submission:Ye,error:ot}=yM(!0,qe,ge);if(ot){fe(X,re,ot,{flushSync:Ae});return}let Ut=Eu(Te,je),Zt=(ge&&ge.preventScrollReset)===!0;if(Ye&&Qr(Ye.formMethod)){await Ce(X,re,je,Ut,Te,Le.active,Ae,Zt,Ye);return}V.set(X,{routeId:re,path:je}),await Ze(X,re,je,Ut,Te,Le.active,Ae,Zt,Ye)}async function Ce(X,re,ce,ge,Ae,Be,qe,Te,Le){z(),V.delete(X);function je(Jt){if(!Jt.route.action&&!Jt.route.lazy){let ai=kr(405,{method:Le.formMethod,pathname:ce,routeId:re});return fe(X,re,ai,{flushSync:qe}),!0}return!1}if(!Be&&je(ge))return;let Ye=S.fetchers.get(X);J(X,aJ(Le,Ye),{flushSync:qe});let ot=new AbortController,Ut=nc(e.history,ce,ot.signal,Le);if(Be){let Jt=await Ge(Ae,ce,Ut.signal);if(Jt.type==="aborted")return;if(Jt.type==="error"){fe(X,re,Jt.error,{flushSync:qe});return}else if(Jt.matches){if(Ae=Jt.matches,ge=Eu(Ae,ce),je(ge))return}else{fe(X,re,kr(404,{pathname:ce}),{flushSync:qe});return}}T.set(X,ot);let Zt=A,dt=(await Qe("action",S,Ut,[ge],Ae,X))[ge.route.id];if(Ut.signal.aborted){T.get(X)===ot&&T.delete(X);return}if(B.has(X)){if(Qi(dt)||yr(dt)){J(X,ui(void 0));return}}else{if(Qi(dt))if(T.delete(X),I>Zt){J(X,ui(void 0));return}else return D.add(X),J(X,Ou(Le)),Je(Ut,dt,!1,{fetcherSubmission:Le,preventScrollReset:Te});if(yr(dt)){fe(X,re,dt.error);return}}let ur=S.navigation.location||S.location,nn=nc(e.history,ur,ot.signal),Us=i||o,Ta=S.navigation.state!=="idle"?li(Us,S.navigation.location,s):S.matches;nt(Ta,"Didn't find any matches after fetcher action");let Hi=++A;F.set(X,Hi);let so=Ou(Le,dt.data);S.fetchers.set(X,so);let[pp,zr]=vM(e.history,S,Ta,Le,ur,!1,M,C,B,V,D,Us,s,[ge.route.id,dt]);zr.filter(Jt=>Jt.key!==X).forEach(Jt=>{let ai=Jt.key,xv=S.fetchers.get(ai),FP=Ou(void 0,xv?xv.data:void 0);S.fetchers.set(ai,FP),Xe(ai),Jt.controller&&T.set(ai,Jt.controller)}),Z({fetchers:new Map(S.fetchers)});let Gl=()=>zr.forEach(Jt=>Xe(Jt.key));ot.signal.addEventListener("abort",Gl);let{loaderResults:eu,fetcherResults:tu}=await Rt(S,Ta,pp,zr,nn);if(ot.signal.aborted)return;ot.signal.removeEventListener("abort",Gl),F.delete(X),T.delete(X),zr.forEach(Jt=>T.delete(Jt.key));let wt=Dp(eu);if(wt)return Je(nn,wt.result,!1,{preventScrollReset:Te});if(wt=Dp(tu),wt)return D.add(wt.key),Je(nn,wt.result,!1,{preventScrollReset:Te});let{loaderData:dr,errors:Vs}=jM(S,Ta,eu,void 0,zr,tu);if(S.fetchers.has(X)){let Jt=ui(dt.data);S.fetchers.set(X,Jt)}ne(Hi),S.navigation.state==="loading"&&Hi>I?(nt(j,"Expected pending action"),O&&O.abort(),ee(S.navigation.location,{matches:Ta,loaderData:dr,errors:Vs,fetchers:new Map(S.fetchers)})):(Z({errors:Vs,loaderData:EM(S.loaderData,dr,Ta,Vs),fetchers:new Map(S.fetchers)}),M=!1)}async function Ze(X,re,ce,ge,Ae,Be,qe,Te,Le){let je=S.fetchers.get(X);J(X,Ou(Le,je?je.data:void 0),{flushSync:qe});let Ye=new AbortController,ot=nc(e.history,ce,Ye.signal);if(Be){let dt=await Ge(Ae,ce,ot.signal);if(dt.type==="aborted")return;if(dt.type==="error"){fe(X,re,dt.error,{flushSync:qe});return}else if(dt.matches)Ae=dt.matches,ge=Eu(Ae,ce);else{fe(X,re,kr(404,{pathname:ce}),{flushSync:qe});return}}T.set(X,Ye);let Ut=A,Zt=(await Qe("loader",S,ot,[ge],Ae,X))[ge.route.id];if(T.get(X)===Ye&&T.delete(X),!ot.signal.aborted){if(B.has(X)){J(X,ui(void 0));return}if(Qi(Zt))if(I>Ut){J(X,ui(void 0));return}else{D.add(X),await Je(ot,Zt,!1,{preventScrollReset:Te});return}if(yr(Zt)){fe(X,re,Zt.error);return}J(X,ui(Zt.data))}}async function Je(X,re,ce,{submission:ge,fetcherSubmission:Ae,preventScrollReset:Be,replace:qe}={}){re.response.headers.has("X-Remix-Revalidate")&&(M=!0);let Te=re.response.headers.get("Location");nt(Te,"Expected a Location header on the redirect Response"),Te=_M(Te,new URL(X.url),s);let Le=tc(S.location,Te,{_isRedirect:!0});if(n){let dt=!1;if(re.response.headers.has("X-Remix-Reload-Document"))dt=!0;else if(R0.test(Te)){const ur=e.history.createURL(Te);dt=ur.origin!==t.location.origin||Jr(ur.pathname,s)==null}if(dt){qe?t.location.replace(Te):t.location.assign(Te);return}}O=null;let je=qe===!0||re.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:Ye,formAction:ot,formEncType:Ut}=S.navigation;!ge&&!Ae&&Ye&&ot&&Ut&&(ge=MM(S.navigation));let Zt=ge||Ae;if(zY.has(re.response.status)&&Zt&&Qr(Zt.formMethod))await le(je,Le,{submission:{...Zt,formAction:Te},preventScrollReset:Be||E,enableViewTransition:ce?P:void 0});else{let dt=F0(Le,ge);await le(je,Le,{overrideNavigation:dt,fetcherSubmission:Ae,preventScrollReset:Be||E,enableViewTransition:ce?P:void 0})}}async function Qe(X,re,ce,ge,Ae,Be){let qe,Te={};try{qe=await XY(c,X,re,ce,ge,Ae,Be,a,r)}catch(Le){return ge.forEach(je=>{Te[je.route.id]={type:"error",error:Le}}),Te}for(let[Le,je]of Object.entries(qe))if(tJ(je)){let Ye=je.result;Te[Le]={type:"redirect",response:QY(Ye,ce,Le,Ae,s)}}else Te[Le]=await JY(je);return Te}async function Rt(X,re,ce,ge,Ae){let Be=Qe("loader",X,Ae,ce,re,null),qe=Promise.all(ge.map(async je=>{if(je.matches&&je.match&&je.controller){let Ye=(await Qe("loader",X,nc(e.history,je.path,je.controller.signal),[je.match],je.matches,je.key))[je.match.route.id];return{[je.key]:Ye}}else return Promise.resolve({[je.key]:{type:"error",error:kr(404,{pathname:je.path})}})})),Te=await Be,Le=(await qe).reduce((je,Ye)=>Object.assign(je,Ye),{});return{loaderResults:Te,fetcherResults:Le}}function z(){M=!0,V.forEach((X,re)=>{T.has(re)&&C.add(re),Xe(re)})}function J(X,re,ce={}){S.fetchers.set(X,re),Z({fetchers:new Map(S.fetchers)},{flushSync:(ce&&ce.flushSync)===!0})}function fe(X,re,ce,ge={}){let Ae=Ji(S.matches,re);Ie(X),Z({errors:{[Ae.route.id]:ce},fetchers:new Map(S.fetchers)},{flushSync:(ge&&ge.flushSync)===!0})}function ve(X){return U.set(X,(U.get(X)||0)+1),B.has(X)&&B.delete(X),S.fetchers.get(X)||UY}function Ie(X){let re=S.fetchers.get(X);T.has(X)&&!(re&&re.state==="loading"&&F.has(X))&&Xe(X),V.delete(X),F.delete(X),D.delete(X),B.delete(X),C.delete(X),S.fetchers.delete(X)}function Ke(X){let re=(U.get(X)||0)-1;re<=0?(U.delete(X),B.add(X)):U.set(X,re),Z({fetchers:new Map(S.fetchers)})}function Xe(X){let re=T.get(X);re&&(re.abort(),T.delete(X))}function ut(X){for(let re of X){let ce=ve(re),ge=ui(ce.data);S.fetchers.set(re,ge)}}function Q(){let X=[],re=!1;for(let ce of D){let ge=S.fetchers.get(ce);nt(ge,`Expected fetcher: ${ce}`),ge.state==="loading"&&(D.delete(ce),X.push(ce),re=!0)}return ut(X),re}function ne(X){let re=[];for(let[ce,ge]of F)if(ge<X){let Ae=S.fetchers.get(ce);nt(Ae,`Expected fetcher: ${ce}`),Ae.state==="loading"&&(Xe(ce),F.delete(ce),re.push(ce))}return ut(re),re.length>0}function se(X,re){let ce=S.blockers.get(X)||ju;return K.get(X)!==re&&K.set(X,re),ce}function ye(X){S.blockers.delete(X),K.delete(X)}function De(X,re){let ce=S.blockers.get(X)||ju;nt(ce.state==="unblocked"&&re.state==="blocked"||ce.state==="blocked"&&re.state==="blocked"||ce.state==="blocked"&&re.state==="proceeding"||ce.state==="blocked"&&re.state==="unblocked"||ce.state==="proceeding"&&re.state==="unblocked",`Invalid blocker state transition: ${ce.state} -> ${re.state}`);let ge=new Map(S.blockers);ge.set(X,re),Z({blockers:ge})}function qt({currentLocation:X,nextLocation:re,historyAction:ce}){if(K.size===0)return;K.size>1&&pn(!1,"A router only supports one blocker at a time");let ge=Array.from(K.entries()),[Ae,Be]=ge[ge.length-1],qe=S.blockers.get(Ae);if(!(qe&&qe.state==="proceeding")&&Be({currentLocation:X,nextLocation:re,historyAction:ce}))return Ae}function $t(X){let re=kr(404,{pathname:X}),ce=i||o,{matches:ge,route:Ae}=CM(ce);return{notFoundMatches:ge,route:Ae,error:re}}function We(X,re,ce){if(p=X,y=re,m=ce||null,!v&&S.navigation===T0){v=!0;let ge=Pe(S.location,S.matches);ge!=null&&Z({restoreScrollPosition:ge})}return()=>{p=null,y=null,m=null}}function xe(X,re){return m&&m(X,re.map(ce=>bY(ce,S.loaderData)))||X.key}function ke(X,re){if(p&&y){let ce=xe(X,re);p[ce]=y()}}function Pe(X,re){if(p){let ce=xe(X,re),ge=p[ce];if(typeof ge=="number")return ge}return null}function Ne(X,re,ce){if(l)if(X){if(Object.keys(X[0].params).length>0)return{active:!0,matches:Np(re,ce,s,!0)}}else return{active:!0,matches:Np(re,ce,s,!0)||[]};return{active:!1,matches:null}}async function Ge(X,re,ce){if(!l)return{type:"success",matches:X};let ge=X;for(;;){let Ae=i==null,Be=i||o,qe=a;try{await l({path:re,matches:ge,patch:(je,Ye)=>{ce.aborted||wM(je,Ye,Be,qe,r)}})}catch(je){return{type:"error",error:je,partialMatches:ge}}finally{Ae&&!ce.aborted&&(o=[...o])}if(ce.aborted)return{type:"aborted"};let Te=li(Be,re,s);if(Te)return{type:"success",matches:Te};let Le=Np(Be,re,s,!0);if(!Le||ge.length===Le.length&&ge.every((je,Ye)=>je.route.id===Le[Ye].route.id))return{type:"success",matches:null};ge=Le}}function It(X){a={},i=Pp(X,r,void 0,a)}function Yt(X,re){let ce=i==null;wM(X,re,i||o,a,r),ce&&(o=[...o],Z({}))}return x={get basename(){return s},get future(){return u},get state(){return S},get routes(){return o},get window(){return t},initialize:$,subscribe:q,enableScrollRestoration:We,navigate:oe,fetch:Ve,revalidate:H,createHref:X=>e.history.createHref(X),encodeLocation:X=>e.history.encodeLocation(X),getFetcher:ve,deleteFetcher:Ke,dispose:W,getBlocker:se,deleteBlocker:ye,patchRoutes:Yt,_internalFetchControllers:T,_internalSetRoutes:It},x}function WY(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function I0(e,t,n,r,a,o){let i,s;if(a){i=[];for(let l of t)if(i.push(l),l.route.id===a){s=l;break}}else i=t,s=t[t.length-1];let c=Tp(r||".",Ap(i),Jr(e.pathname,n)||e.pathname,o==="path");if(r==null&&(c.search=e.search,c.hash=e.hash),(r==null||r===""||r===".")&&s){let l=$0(c.search);if(s.route.index&&!l)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&l){let u=new URLSearchParams(c.search),d=u.getAll("index");u.delete("index"),d.filter(p=>p).forEach(p=>u.append("index",p));let f=u.toString();c.search=f?`?${f}`:""}}return n!=="/"&&(c.pathname=c.pathname==="/"?n:Da([n,c.pathname])),ho(c)}function yM(e,t,n){if(!n||!WY(n))return{path:t};if(n.formMethod&&!nJ(n.formMethod))return{path:t,error:kr(405,{method:n.formMethod})};let r=()=>({path:t,error:kr(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),o=kM(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Qr(a))return r();let u=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((d,[f,p])=>`${d}${f}=${p}
`,""):String(n.body);return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:u}}}else if(n.formEncType==="application/json"){if(!Qr(a))return r();try{let u=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:u,text:void 0}}}catch{return r()}}}nt(typeof FormData=="function","FormData is not available in this environment");let i,s;if(n.formData)i=L0(n.formData),s=n.formData;else if(n.body instanceof FormData)i=L0(n.body),s=n.body;else if(n.body instanceof URLSearchParams)i=n.body,s=SM(i);else if(n.body==null)i=new URLSearchParams,s=new FormData;else try{i=new URLSearchParams(n.body),s=SM(i)}catch{return r()}let c={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:s,json:void 0,text:void 0};if(Qr(c.formMethod))return{path:t,submission:c};let l=mo(t);return e&&l.search&&$0(l.search)&&i.append("index",""),l.search=`?${i}`,{path:ho(l),submission:c}}function gM(e,t,n=!1){let r=e.findIndex(a=>a.route.id===t);return r>=0?e.slice(0,n?r+1:r):e}function vM(e,t,n,r,a,o,i,s,c,l,u,d,f,p){let m=p?yr(p[1])?p[1].error:p[1].data:void 0,y=e.createURL(t.location),v=e.createURL(a),b=n;o&&t.errors?b=gM(n,Object.keys(t.errors)[0],!0):p&&yr(p[1])&&(b=gM(n,p[0]));let w=p?p[1].statusCode:void 0,_=w&&w>=400,x=b.filter((j,E)=>{let{route:O}=j;if(O.lazy)return!0;if(O.loader==null)return!1;if(o)return D0(O,t.loaderData,t.errors);if(HY(t.loaderData,t.matches[E],j))return!0;let P=t.matches[E],k=j;return bM(j,{currentUrl:y,currentParams:P.params,nextUrl:v,nextParams:k.params,...r,actionResult:m,actionStatus:w,defaultShouldRevalidate:_?!1:i||y.pathname+y.search===v.pathname+v.search||y.search!==v.search||qY(P,k)})}),S=[];return l.forEach((j,E)=>{if(o||!n.some(R=>R.route.id===j.routeId)||c.has(E))return;let O=li(d,j.path,f);if(!O){S.push({key:E,routeId:j.routeId,path:j.path,matches:null,match:null,controller:null});return}let P=t.fetchers.get(E),k=Eu(O,j.path),N=!1;u.has(E)?N=!1:s.has(E)?(s.delete(E),N=!0):P&&P.state!=="idle"&&P.data===void 0?N=i:N=bM(k,{currentUrl:y,currentParams:t.matches[t.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params,...r,actionResult:m,actionStatus:w,defaultShouldRevalidate:_?!1:i}),N&&S.push({key:E,routeId:j.routeId,path:j.path,matches:O,match:k,controller:new AbortController})}),[x,S]}function D0(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&t[e.id]!==void 0,a=n!=null&&n[e.id]!==void 0;return!r&&a?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!a}function HY(e,t,n){let r=!t||n.route.id!==t.route.id,a=!e.hasOwnProperty(n.route.id);return r||a}function qY(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function bM(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function wM(e,t,n,r,a){let o;if(e){let c=r[e];nt(c,`No route found to patch children into: routeId = ${e}`),c.children||(c.children=[]),o=c.children}else o=n;let i=t.filter(c=>!o.some(l=>xM(c,l))),s=Pp(i,a,[e||"_","patch",String((o==null?void 0:o.length)||"0")],r);o.push(...s)}function xM(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var a;return(a=t.children)==null?void 0:a.some(o=>xM(n,o))}):!1}async function ZY(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let a=n[e.id];nt(a,"No route found in manifest");let o={};for(let i in r){let s=a[i]!==void 0&&i!=="hasErrorBoundary";pn(!s,`Route "${a.id}" has a static property "${i}" defined but its lazy function is also returning a value for this property. The lazy route property "${i}" will be ignored.`),!s&&!gY.has(i)&&(o[i]=r[i])}Object.assign(a,o),Object.assign(a,{...t(a),lazy:void 0})}async function KY({matches:e}){let t=e.filter(n=>n.shouldLoad);return(await Promise.all(t.map(n=>n.resolve()))).reduce((n,r,a)=>Object.assign(n,{[t[a].route.id]:r}),{})}async function XY(e,t,n,r,a,o,i,s,c,l){let u=o.map(p=>p.route.lazy?ZY(p.route,c,s):void 0),d=o.map((p,m)=>{let y=u[m],v=a.some(b=>b.route.id===p.route.id);return{...p,shouldLoad:v,resolve:async b=>(b&&r.method==="GET"&&(p.route.lazy||p.route.loader)&&(v=!0),v?YY(t,r,p,y,b,l):Promise.resolve({type:"data",result:void 0}))}}),f=await e({matches:d,request:r,params:o[0].params,fetcherKey:i,context:l});try{await Promise.all(u)}catch{}return f}async function YY(e,t,n,r,a,o){let i,s,c=l=>{let u,d=new Promise((m,y)=>u=y);s=()=>u(),t.signal.addEventListener("abort",s);let f=m=>typeof l!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${e}" [routeId: ${n.route.id}]`)):l({request:t,params:n.params,context:o},...m!==void 0?[m]:[]),p=(async()=>{try{return{type:"data",result:await(a?a(m=>f(m)):f())}}catch(m){return{type:"error",result:m}}})();return Promise.race([p,d])};try{let l=n.route[e];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(f=>{u=f}),r]);if(u!==void 0)throw u;i=d}else if(await r,l=n.route[e],l)i=await c(l);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw kr(405,{method:t.method,pathname:d,routeId:n.route.id})}else return{type:"data",result:void 0};else if(l)i=await c(l);else{let u=new URL(t.url),d=u.pathname+u.search;throw kr(404,{pathname:d})}}catch(l){return{type:"error",result:l}}finally{s&&t.signal.removeEventListener("abort",s)}return i}async function JY(e){var r,a,o,i;let{result:t,type:n}=e;if(NM(t)){let s;try{let c=t.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?t.body==null?s=null:s=await t.json():s=await t.text()}catch(c){return{type:"error",error:c}}return n==="error"?{type:"error",error:new Rp(t.status,t.statusText,s),statusCode:t.status,headers:t.headers}:{type:"data",data:s,statusCode:t.status,headers:t.headers}}if(n==="error"){if(PM(t)){if(t.data instanceof Error)return{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status};t=new Rp(((a=t.init)==null?void 0:a.status)||500,void 0,t.data)}return{type:"error",error:t,statusCode:Ip(t)?t.status:void 0}}return PM(t)?{type:"data",data:t.data,statusCode:(o=t.init)==null?void 0:o.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function QY(e,t,n,r,a){let o=e.headers.get("Location");if(nt(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!R0.test(o)){let i=r.slice(0,r.findIndex(s=>s.route.id===n)+1);o=I0(new URL(t.url),i,a,o),e.headers.set("Location",o)}return e}function _M(e,t,n){if(R0.test(e)){let r=e,a=r.startsWith("//")?new URL(t.protocol+r):new URL(r),o=Jr(a.pathname,n)!=null;if(a.origin===t.origin&&o)return a.pathname+a.search+a.hash}return e}function nc(e,t,n,r){let a=e.createURL(kM(t)).toString(),o={signal:n};if(r&&Qr(r.formMethod)){let{formMethod:i,formEncType:s}=r;o.method=i.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=L0(r.formData):o.body=r.formData}return new Request(a,o)}function L0(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function SM(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function GY(e,t,n,r=!1,a=!1){let o={},i=null,s,c=!1,l={},u=n&&yr(n[1])?n[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let f=d.route.id,p=t[f];if(nt(!Qi(p),"Cannot handle redirect results in processLoaderData"),yr(p)){let m=p.error;if(u!==void 0&&(m=u,u=void 0),i=i||{},a)i[f]=m;else{let y=Ji(e,f);i[y.route.id]==null&&(i[y.route.id]=m)}r||(o[f]=hM),c||(c=!0,s=Ip(p.error)?p.error.status:500),p.headers&&(l[f]=p.headers)}else o[f]=p.data,p.statusCode&&p.statusCode!==200&&!c&&(s=p.statusCode),p.headers&&(l[f]=p.headers)}),u!==void 0&&n&&(i={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:i,statusCode:s||200,loaderHeaders:l}}function jM(e,t,n,r,a,o){let{loaderData:i,errors:s}=GY(t,n,r);return a.forEach(c=>{let{key:l,match:u,controller:d}=c,f=o[l];if(nt(f,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(yr(f)){let p=Ji(e.matches,u==null?void 0:u.route.id);s&&s[p.route.id]||(s={...s,[p.route.id]:f.error}),e.fetchers.delete(l)}else if(Qi(f))nt(!1,"Unhandled fetcher revalidation redirect");else{let p=ui(f.data);e.fetchers.set(l,p)}}),{loaderData:i,errors:s}}function EM(e,t,n,r){let a=Object.entries(t).filter(([,o])=>o!==hM).reduce((o,[i,s])=>(o[i]=s,o),{});for(let o of n){let i=o.route.id;if(!t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&o.route.loader&&(a[i]=e[i]),r&&r.hasOwnProperty(i))break}return a}function OM(e){return e?yr(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Ji(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function CM(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function kr(e,{pathname:t,routeId:n,method:r,type:a,message:o}={}){let i="Unknown Server Error",s="Unknown @remix-run/router error";return e===400?(i="Bad Request",r&&t&&n?s=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:a==="invalid-body"&&(s="Unable to encode submission body")):e===403?(i="Forbidden",s=`Route "${n}" does not match URL "${t}"`):e===404?(i="Not Found",s=`No route matches URL "${t}"`):e===405&&(i="Method Not Allowed",r&&t&&n?s=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new Rp(e||500,i,new Error(s),!0)}function Dp(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,a]=t[n];if(Qi(a))return{key:r,result:a}}}function kM(e){let t=typeof e=="string"?mo(e):e;return ho({...t,hash:""})}function eJ(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function tJ(e){return NM(e.result)&&BY.has(e.result.status)}function yr(e){return e.type==="error"}function Qi(e){return(e&&e.type)==="redirect"}function PM(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function NM(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function nJ(e){return FY.has(e.toUpperCase())}function Qr(e){return LY.has(e.toUpperCase())}function $0(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function Eu(e,t){let n=typeof t=="string"?mo(t).search:t.search;if(e[e.length-1].route.index&&$0(n||""))return e[e.length-1];let r=dM(e);return r[r.length-1]}function MM(e){let{formMethod:t,formAction:n,formEncType:r,text:a,formData:o,json:i}=e;if(!(!t||!n||!r)){if(a!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:a};if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:i,text:void 0}}}function F0(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function rJ(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Ou(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function aJ(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function ui(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function oJ(e,t){try{let n=e.sessionStorage.getItem(pM);if(n){let r=JSON.parse(n);for(let[a,o]of Object.entries(r||{}))o&&Array.isArray(o)&&t.set(a,new Set(o||[]))}}catch{}}function iJ(e,t){if(t.size>0){let n={};for(let[r,a]of t)n[r]=[...a];try{e.sessionStorage.setItem(pM,JSON.stringify(n))}catch(r){pn(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function sJ(){let e,t,n=new Promise((r,a)=>{e=async o=>{r(o);try{await n}catch{}},t=async o=>{a(o);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var Gi=g.createContext(null);Gi.displayName="DataRouter";var Cu=g.createContext(null);Cu.displayName="DataRouterState";var B0=g.createContext({isTransitioning:!1});B0.displayName="ViewTransition";var AM=g.createContext(new Map);AM.displayName="Fetchers";var cJ=g.createContext(null);cJ.displayName="Await";var Gr=g.createContext(null);Gr.displayName="Navigation";var Lp=g.createContext(null);Lp.displayName="Location";var Pr=g.createContext({outlet:null,matches:[],isDataRoute:!1});Pr.displayName="Route";var z0=g.createContext(null);z0.displayName="RouteError";function lJ(e,{relative:t}={}){nt(rc(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=g.useContext(Gr),{hash:a,pathname:o,search:i}=ku(e,{relative:t}),s=o;return n!=="/"&&(s=o==="/"?n:Da([n,o])),r.createHref({pathname:s,search:i,hash:a})}function rc(){return g.useContext(Lp)!=null}function La(){return nt(rc(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(Lp).location}var TM="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function RM(e){g.useContext(Gr).static||g.useLayoutEffect(e)}function es(){let{isDataRoute:e}=g.useContext(Pr);return e?SJ():uJ()}function uJ(){nt(rc(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(Gi),{basename:t,navigator:n}=g.useContext(Gr),{matches:r}=g.useContext(Pr),{pathname:a}=La(),o=JSON.stringify(Ap(r)),i=g.useRef(!1);return RM(()=>{i.current=!0}),g.useCallback((s,c={})=>{if(pn(i.current,TM),!i.current)return;if(typeof s=="number"){n.go(s);return}let l=Tp(s,JSON.parse(o),a,c.relative==="path");e==null&&t!=="/"&&(l.pathname=l.pathname==="/"?t:Da([t,l.pathname])),(c.replace?n.replace:n.push)(l,c.state,c)},[t,n,o,a,e])}var dJ=g.createContext(null);function fJ(e){let t=g.useContext(Pr).outlet;return t&&g.createElement(dJ.Provider,{value:e},t)}function $p(){let{matches:e}=g.useContext(Pr),t=e[e.length-1];return t?t.params:{}}function ku(e,{relative:t}={}){let{matches:n}=g.useContext(Pr),{pathname:r}=La(),a=JSON.stringify(Ap(n));return g.useMemo(()=>Tp(e,JSON.parse(a),r,t==="path"),[e,a,r,t])}function pJ(e,t,n,r){nt(rc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(Gr),{matches:o}=g.useContext(Pr),i=o[o.length-1],s=i?i.params:{},c=i?i.pathname:"/",l=i?i.pathnameBase:"/",u=i&&i.route;{let v=u&&u.path||"";LM(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=La(),f;f=d;let p=f.pathname||"/",m=p;if(l!=="/"){let v=l.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(v.length).join("/")}let y=li(e,{pathname:m});return pn(u||y!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),pn(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),vJ(y&&y.map(v=>Object.assign({},v,{params:Object.assign({},s,v.params),pathname:Da([l,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Da([l,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r)}function hJ(){let e=IM(),t=Ip(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=g.createElement(g.Fragment,null,g.createElement("p",null,"\u{1F4BF} Hey developer \u{1F44B}"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:o},"ErrorBoundary")," or"," ",g.createElement("code",{style:o},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),n?g.createElement("pre",{style:a},n):null,i)}var mJ=g.createElement(hJ,null),yJ=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?g.createElement(Pr.Provider,{value:this.props.routeContext},g.createElement(z0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function gJ({routeContext:e,match:t,children:n}){let r=g.useContext(Gi);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(Pr.Provider,{value:e},n)}function vJ(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,o=n==null?void 0:n.errors;if(o!=null){let c=a.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id])!==void 0);nt(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let i=!1,s=-1;if(n)for(let c=0;c<a.length;c++){let l=a[c];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(s=c),l.route.id){let{loaderData:u,errors:d}=n,f=l.route.loader&&!u.hasOwnProperty(l.route.id)&&(!d||d[l.route.id]===void 0);if(l.route.lazy||f){i=!0,s>=0?a=a.slice(0,s+1):a=[a[0]];break}}}return a.reduceRight((c,l,u)=>{let d,f=!1,p=null,m=null;n&&(d=o&&l.route.id?o[l.route.id]:void 0,p=l.route.errorElement||mJ,i&&(s<0&&u===0?(LM("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,m=null):s===u&&(f=!0,m=l.route.hydrateFallbackElement||null)));let y=t.concat(a.slice(0,u+1)),v=()=>{let b;return d?b=p:f?b=m:l.route.Component?b=g.createElement(l.route.Component,null):l.route.element?b=l.route.element:b=c,g.createElement(gJ,{match:l,routeContext:{outlet:c,matches:y,isDataRoute:n!=null},children:b})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?g.createElement(yJ,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}function U0(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function bJ(e){let t=g.useContext(Gi);return nt(t,U0(e)),t}function wJ(e){let t=g.useContext(Cu);return nt(t,U0(e)),t}function xJ(e){let t=g.useContext(Pr);return nt(t,U0(e)),t}function V0(e){let t=xJ(e),n=t.matches[t.matches.length-1];return nt(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function _J(){return V0("useRouteId")}function IM(){var r;let e=g.useContext(z0),t=wJ("useRouteError"),n=V0("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function SJ(){let{router:e}=bJ("useNavigate"),t=V0("useNavigate"),n=g.useRef(!1);return RM(()=>{n.current=!0}),g.useCallback(async(r,a={})=>{pn(n.current,TM),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...a}))},[e,t])}var DM={};function LM(e,t,n){!t&&!DM[e]&&(DM[e]=!0,pn(!1,n))}var $M={};function FM(e,t){!e&&!$M[t]&&($M[t]=!0,console.warn(t))}function BM(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&pn(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:g.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&pn(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:g.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&pn(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:g.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var jJ=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function EJ({router:e,flushSync:t}){let[n,r]=g.useState(e.state),[a,o]=g.useState(),[i,s]=g.useState({isTransitioning:!1}),[c,l]=g.useState(),[u,d]=g.useState(),[f,p]=g.useState(),m=g.useRef(new Map),y=g.useCallback((_,{deletedFetchers:x,flushSync:S,viewTransitionOpts:j})=>{x.forEach(O=>m.current.delete(O)),_.fetchers.forEach((O,P)=>{O.data!==void 0&&m.current.set(P,O.data)}),FM(S===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let E=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(FM(j==null||E,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!j||!E){t&&S?t(()=>r(_)):g.startTransition(()=>r(_));return}if(t&&S){t(()=>{u&&(c&&c.resolve(),u.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:j.currentLocation,nextLocation:j.nextLocation})});let O=e.window.document.startViewTransition(()=>{t(()=>r(_))});O.finished.finally(()=>{t(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})})}),t(()=>d(O));return}u?(c&&c.resolve(),u.skipTransition(),p({state:_,currentLocation:j.currentLocation,nextLocation:j.nextLocation})):(o(_),s({isTransitioning:!0,flushSync:!1,currentLocation:j.currentLocation,nextLocation:j.nextLocation}))},[e.window,t,u,c]);g.useLayoutEffect(()=>e.subscribe(y),[e,y]),g.useEffect(()=>{i.isTransitioning&&!i.flushSync&&l(new jJ)},[i]),g.useEffect(()=>{if(c&&a&&e.window){let _=a,x=c.promise,S=e.window.document.startViewTransition(async()=>{g.startTransition(()=>r(_)),await x});S.finished.finally(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})}),d(S)}},[a,c,e.window]),g.useEffect(()=>{c&&a&&n.location.key===a.location.key&&c.resolve()},[c,u,n.location,a]),g.useEffect(()=>{!i.isTransitioning&&f&&(o(f.state),s({isTransitioning:!0,flushSync:!1,currentLocation:f.currentLocation,nextLocation:f.nextLocation}),p(void 0))},[i.isTransitioning,f]);let v=g.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:_=>e.navigate(_),push:(_,x,S)=>e.navigate(_,{state:x,preventScrollReset:S==null?void 0:S.preventScrollReset}),replace:(_,x,S)=>e.navigate(_,{replace:!0,state:x,preventScrollReset:S==null?void 0:S.preventScrollReset})}),[e]),b=e.basename||"/",w=g.useMemo(()=>({router:e,navigator:v,static:!1,basename:b}),[e,v,b]);return g.createElement(g.Fragment,null,g.createElement(Gi.Provider,{value:w},g.createElement(Cu.Provider,{value:n},g.createElement(AM.Provider,{value:m.current},g.createElement(B0.Provider,{value:i},g.createElement(NJ,{basename:b,location:n.location,navigationType:n.historyAction,navigator:v},g.createElement(OJ,{routes:e.routes,future:e.future,state:n})))))),null)}var OJ=g.memo(CJ);function CJ({routes:e,future:t,state:n}){return pJ(e,void 0,n,t)}function kJ({to:e,replace:t,state:n,relative:r}){nt(rc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(Gr);pn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=g.useContext(Pr),{pathname:i}=La(),s=es(),c=Tp(e,Ap(o),i,r==="path"),l=JSON.stringify(c);return g.useEffect(()=>{s(JSON.parse(l),{replace:t,state:n,relative:r})},[s,l,r,t,n]),null}function PJ(e){return fJ(e.context)}function di(e){nt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function NJ({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:a,static:o=!1}){nt(!rc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),s=g.useMemo(()=>({basename:i,navigator:a,static:o,future:{}}),[i,a,o]);typeof n=="string"&&(n=mo(n));let{pathname:c="/",search:l="",hash:u="",state:d=null,key:f="default"}=n,p=g.useMemo(()=>{let m=Jr(c,i);return m==null?null:{location:{pathname:m,search:l,hash:u,state:d,key:f},navigationType:r}},[i,c,l,u,d,f,r]);return pn(p!=null,`<Router basename="${i}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:g.createElement(Gr.Provider,{value:s},g.createElement(Lp.Provider,{children:t,value:p}))}function W0(e,t=[]){let n=[];return g.Children.forEach(e,(r,a)=>{if(!g.isValidElement(r))return;let o=[...t,a];if(r.type===g.Fragment){n.push.apply(n,W0(r.props.children,o));return}nt(r.type===di,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),nt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=W0(r.props.children,o)),n.push(i)}),n}var MJ=W0,Fp="get",Bp="application/x-www-form-urlencoded";function zp(e){return e!=null&&typeof e.tagName=="string"}function AJ(e){return zp(e)&&e.tagName.toLowerCase()==="button"}function TJ(e){return zp(e)&&e.tagName.toLowerCase()==="form"}function RJ(e){return zp(e)&&e.tagName.toLowerCase()==="input"}function IJ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function DJ(e,t){return e.button===0&&(!t||t==="_self")&&!IJ(e)}var Up=null;function LJ(){if(Up===null)try{new FormData(document.createElement("form"),0),Up=!1}catch{Up=!0}return Up}var $J=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function H0(e){return e!=null&&!$J.has(e)?(pn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bp}"`),null):e}function FJ(e,t){let n,r,a,o,i;if(TJ(e)){let s=e.getAttribute("action");r=s?Jr(s,t):null,n=e.getAttribute("method")||Fp,a=H0(e.getAttribute("enctype"))||Bp,o=new FormData(e)}else if(AJ(e)||RJ(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||s.getAttribute("action");if(r=c?Jr(c,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||Fp,a=H0(e.getAttribute("formenctype"))||H0(s.getAttribute("enctype"))||Bp,o=new FormData(s,e),!LJ()){let{name:l,type:u,value:d}=e;if(u==="image"){let f=l?`${l}.`:"";o.append(`${f}x`,"0"),o.append(`${f}y`,"0")}else l&&o.append(l,d)}}else{if(zp(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Fp,r=null,a=Bp,i=e}return o&&a==="text/plain"&&(i=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:i}}function q0(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function BJ(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module).then(async r=>(await r.__tla,r));return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function zJ(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function UJ(e,t,n){let r=await Promise.all(e.map(async a=>{let o=t.routes[a.route.id];if(o){let i=await BJ(o,n);return i.links?i.links():[]}return[]}));return qJ(r.flat(1).filter(zJ).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function zM(e,t,n,r,a,o){let i=(c,l)=>n[l]?c.route.id!==n[l].route.id:!0,s=(c,l)=>{var u;return n[l].pathname!==c.pathname||((u=n[l].route.path)==null?void 0:u.endsWith("*"))&&n[l].params["*"]!==c.params["*"]};return o==="assets"?t.filter((c,l)=>i(c,l)||s(c,l)):o==="data"?t.filter((c,l)=>{var d;let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(i(c,l)||s(c,l))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function VJ(e,t){return WJ(e.map(n=>{let r=t.routes[n.route.id];if(!r)return[];let a=[r.module];return r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function WJ(e){return[...new Set(e)]}function HJ(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function qJ(e,t){let n=new Set;return new Set(t),e.reduce((r,a)=>{let o=JSON.stringify(HJ(a));return n.has(o)||(n.add(o),r.push({key:o,link:a})),r},[])}function ZJ(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function KJ(){let e=g.useContext(Gi);return q0(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function XJ(){let e=g.useContext(Cu);return q0(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Z0=g.createContext(void 0);Z0.displayName="FrameworkContext";function UM(){let e=g.useContext(Z0);return q0(e,"You must render this element inside a <HydratedRouter> element"),e}function YJ(e,t){let n=g.useContext(Z0),[r,a]=g.useState(!1),[o,i]=g.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=t,f=g.useRef(null);g.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let y=b=>{b.forEach(w=>{i(w.isIntersecting)})},v=new IntersectionObserver(y,{threshold:.5});return f.current&&v.observe(f.current),()=>{v.disconnect()}}},[e]),g.useEffect(()=>{if(r){let y=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(y)}}},[r]);let p=()=>{a(!0)},m=()=>{a(!1),i(!1)};return n?e!=="intent"?[o,f,{}]:[o,f,{onFocus:Pu(s,p),onBlur:Pu(c,m),onMouseEnter:Pu(l,p),onMouseLeave:Pu(u,m),onTouchStart:Pu(d,p)}]:[!1,f,{}]}function Pu(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function JJ({page:e,...t}){let{router:n}=KJ(),r=g.useMemo(()=>li(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?g.createElement(GJ,{page:e,matches:r,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function QJ(e){let{manifest:t,routeModules:n}=UM(),[r,a]=g.useState([]);return g.useEffect(()=>{let o=!1;return UJ(e,t,n).then(i=>{o||a(i)}),()=>{o=!0}},[e,t,n]),r}function GJ({page:e,matches:t,...n}){let r=La(),{manifest:a,routeModules:o}=UM(),{loaderData:i,matches:s}=XJ(),c=g.useMemo(()=>zM(e,t,s,a,r,"data"),[e,t,s,a,r]),l=g.useMemo(()=>zM(e,t,s,a,r,"assets"),[e,t,s,a,r]),u=g.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let p=new Set,m=!1;if(t.forEach(v=>{var w;let b=a.routes[v.route.id];!b||!b.hasLoader||(!c.some(_=>_.route.id===v.route.id)&&v.route.id in i&&((w=o[v.route.id])!=null&&w.shouldRevalidate)||b.hasClientLoader?m=!0:p.add(v.route.id))}),p.size===0)return[];let y=ZJ(e);return m&&p.size>0&&y.searchParams.set("_routes",t.filter(v=>p.has(v.route.id)).map(v=>v.route.id).join(",")),[y.pathname+y.search]},[i,r,a,c,t,e,o]),d=g.useMemo(()=>VJ(l,a),[l,a]),f=QJ(l);return g.createElement(g.Fragment,null,u.map(p=>g.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),d.map(p=>g.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),f.map(({key:p,link:m})=>g.createElement("link",{key:p,...m})))}function eQ(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var VM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{VM&&(window.__reactRouterVersion="7.0.2")}catch{}function WM(e,t){return mM({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:hY({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||HM(),routes:e,mapRouteProperties:BM,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function tQ(e,t){return mM({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:mY({window:t==null?void 0:t.window}),hydrationData:HM(),routes:e,mapRouteProperties:BM,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function HM(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:nQ(e.errors)}),e}function nQ(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,a]of t)if(a&&a.__type==="RouteErrorResponse")n[r]=new Rp(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let o=window[a.__subType];if(typeof o=="function")try{let i=new o(a.message);i.stack="",n[r]=i}catch{}}if(n[r]==null){let o=new Error(a.message);o.stack="",n[r]=o}}else n[r]=a;return n}var qM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,K0=g.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:a,replace:o,state:i,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},f){let{basename:p}=g.useContext(Gr),m=typeof c=="string"&&qM.test(c),y,v=!1;if(typeof c=="string"&&m&&(y=c,VM))try{let O=new URL(window.location.href),P=c.startsWith("//")?new URL(O.protocol+c):new URL(c),k=Jr(P.pathname,p);P.origin===O.origin&&k!=null?c=k+P.search+P.hash:v=!0}catch{pn(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=lJ(c,{relative:r}),[w,_,x]=YJ(n,d),S=iQ(c,{replace:o,state:i,target:s,preventScrollReset:l,relative:r,viewTransition:u});function j(O){e&&e(O),O.defaultPrevented||S(O)}let E=g.createElement("a",{...d,...x,href:y||b,onClick:v||a?e:j,ref:eQ(f,_),target:s,"data-discover":!m&&t==="render"?"true":void 0});return w&&!m?g.createElement(g.Fragment,null,E,g.createElement(JJ,{page:b})):E});K0.displayName="Link";var rQ=g.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:a,to:o,viewTransition:i,children:s,...c},l){let u=ku(o,{relative:c.relative}),d=La(),f=g.useContext(Cu),{navigator:p,basename:m}=g.useContext(Gr),y=f!=null&&dQ(u)&&i===!0,v=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,b=d.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&m&&(w=Jr(w,m)||w);const _=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let x=b===v||!r&&b.startsWith(v)&&b.charAt(_)==="/",S=w!=null&&(w===v||!r&&w.startsWith(v)&&w.charAt(v.length)==="/"),j={isActive:x,isPending:S,isTransitioning:y},E=x?e:void 0,O;typeof n=="function"?O=n(j):O=[n,x?"active":null,S?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let P=typeof a=="function"?a(j):a;return g.createElement(K0,{...c,"aria-current":E,className:O,ref:l,style:P,to:o,viewTransition:i},typeof s=="function"?s(j):s)});rQ.displayName="NavLink";var aQ=g.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:a,state:o,method:i=Fp,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...f},p)=>{let m=lQ(),y=uQ(s,{relative:l}),v=i.toLowerCase()==="get"?"get":"post",b=typeof s=="string"&&qM.test(s),w=_=>{if(c&&c(_),_.defaultPrevented)return;_.preventDefault();let x=_.nativeEvent.submitter,S=(x==null?void 0:x.getAttribute("formmethod"))||i;m(x||_.currentTarget,{fetcherKey:t,method:S,navigate:n,replace:a,state:o,relative:l,preventScrollReset:u,viewTransition:d})};return g.createElement("form",{ref:p,method:v,action:y,onSubmit:r?c:w,...f,"data-discover":!b&&e==="render"?"true":void 0})});aQ.displayName="Form";function oQ(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ZM(e){let t=g.useContext(Gi);return nt(t,oQ(e)),t}function iQ(e,{target:t,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:i}={}){let s=es(),c=La(),l=ku(e,{relative:o});return g.useCallback(u=>{if(DJ(u,t)){u.preventDefault();let d=n!==void 0?n:ho(c)===ho(l);s(e,{replace:d,state:r,preventScrollReset:a,relative:o,viewTransition:i})}},[c,s,l,n,r,t,e,a,o,i])}var sQ=0,cQ=()=>`__${String(++sQ)}__`;function lQ(){let{router:e}=ZM("useSubmit"),{basename:t}=g.useContext(Gr),n=_J();return g.useCallback(async(r,a={})=>{let{action:o,method:i,encType:s,formData:c,body:l}=FJ(r,t);if(a.navigate===!1){let u=a.fetcherKey||cQ();await e.fetch(u,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}function uQ(e,{relative:t}={}){let{basename:n}=g.useContext(Gr),r=g.useContext(Pr);nt(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...ku(e||".",{relative:t})},i=La();if(e==null){o.search=i.search;let s=new URLSearchParams(o.search),c=s.getAll("index");if(c.some(l=>l==="")){s.delete("index"),c.filter(u=>u).forEach(u=>s.append("index",u));let l=s.toString();o.search=l?`?${l}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:Da([n,o.pathname])),ho(o)}function dQ(e,t={}){let n=g.useContext(B0);nt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=ZM("useViewTransitionState"),a=ku(e,{relative:t.relative});if(!n.isTransitioning)return!1;let o=Jr(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=Jr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Mp(a.pathname,i)!=null||Mp(a.pathname,o)!=null}new TextEncoder;function fQ(e){return g.createElement(EJ,{flushSync:ru.flushSync,...e})}var pQ=ZDe.useId||(()=>{}),hQ=0;zt=function(e){const[t,n]=g.useState(pQ());return fn(()=>{e||n(r=>r??String(hQ++))},[e]),e||(t?`radix-${t}`:"")};var X0="Collapsible",[mQ,KM]=fr(X0),[yQ,Y0]=mQ(X0),XM=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:o,onOpenChange:i,...s}=e,[c=!1,l]=Rn({prop:r,defaultProp:a,onChange:i});return h.jsx(yQ,{scope:n,disabled:o,contentId:zt(),open:c,onOpenToggle:g.useCallback(()=>l(u=>!u),[l]),children:h.jsx($e.div,{"data-state":eb(c),"data-disabled":o?"":void 0,...s,ref:t})})});XM.displayName=X0;var YM="CollapsibleTrigger",J0=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=Y0(YM,n);return h.jsx($e.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":eb(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:_e(e.onClick,a.onOpenToggle)})});J0.displayName=YM;var Q0="CollapsibleContent",G0=g.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Y0(Q0,e.__scopeCollapsible);return h.jsx(Ur,{present:n||a.open,children:({present:o})=>h.jsx(gQ,{...r,ref:t,present:o})})});G0.displayName=Q0;var gQ=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...o}=e,i=Y0(Q0,n),[s,c]=g.useState(r),l=g.useRef(null),u=kt(t,l),d=g.useRef(0),f=d.current,p=g.useRef(0),m=p.current,y=i.open||s,v=g.useRef(y),b=g.useRef();return g.useEffect(()=>{const w=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(w)},[]),fn(()=>{const w=l.current;if(w){b.current=b.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const _=w.getBoundingClientRect();d.current=_.height,p.current=_.width,v.current||(w.style.transitionDuration=b.current.transitionDuration,w.style.animationName=b.current.animationName),c(r)}},[i.open,r]),h.jsx($e.div,{"data-state":eb(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!y,...o,ref:u,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":m?`${m}px`:void 0,...e.style},children:y&&a})});function eb(e){return e?"open":"closed"}var JM=XM,vQ=J0,bQ=G0;const wQ=JM,xQ=J0,_Q=G0,tb=768;function SQ(){const[e,t]=g.useState(void 0);return g.useEffect(()=>{const n=window.matchMedia(`(max-width: ${tb-1}px)`),r=()=>{t(window.innerWidth<tb)};return n.addEventListener("change",r),t(window.innerWidth<tb),()=>n.removeEventListener("change",r)},[]),!!e}let Nu;Nu=lo("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),yt=g.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...a},o)=>{const i=r?ii:"button";return h.jsx(i,{className:G(Nu({variant:t,size:n,className:e})),ref:o,...a})}),yt.displayName="Button";const In=g.forwardRef(({className:e,type:t,...n},r)=>h.jsx("input",{type:t,className:G("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));In.displayName="Input";var jQ="Separator",QM="horizontal",EQ=["horizontal","vertical"],GM=g.forwardRef((e,t)=>{const{decorative:n,orientation:r=QM,...a}=e,o=OQ(r)?r:QM,i=n?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return h.jsx($e.div,{"data-orientation":o,...i,...a,ref:t})});GM.displayName=jQ;function OQ(e){return EQ.includes(e)}Qv=GM,Xs=g.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},a)=>h.jsx(Qv,{ref:a,decorative:n,orientation:t,className:G("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r})),Xs.displayName=Qv.displayName;var nb="focusScope.autoFocusOnMount",rb="focusScope.autoFocusOnUnmount",eA={bubbles:!1,cancelable:!0},CQ="FocusScope",Vp=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=pr(a),u=pr(o),d=g.useRef(null),f=kt(t,y=>c(y)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let y=function(_){if(p.paused||!s)return;const x=_.target;s.contains(x)?d.current=x:fi(d.current,{select:!0})},v=function(_){if(p.paused||!s)return;const x=_.relatedTarget;x!==null&&(s.contains(x)||fi(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const x of _)x.removedNodes.length>0&&fi(s)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,p.paused]),g.useEffect(()=>{if(s){rA.add(p);const y=document.activeElement;if(!s.contains(y)){const v=new CustomEvent(nb,eA);s.addEventListener(nb,l),s.dispatchEvent(v),v.defaultPrevented||(kQ(TQ(tA(s)),{select:!0}),document.activeElement===y&&fi(s))}return()=>{s.removeEventListener(nb,l),setTimeout(()=>{const v=new CustomEvent(rb,eA);s.addEventListener(rb,u),s.dispatchEvent(v),v.defaultPrevented||fi(y??document.body,{select:!0}),s.removeEventListener(rb,u),rA.remove(p)},0)}}},[s,l,u,p]);const m=g.useCallback(y=>{if(!n&&!r||p.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,b=document.activeElement;if(v&&b){const w=y.currentTarget,[_,x]=PQ(w);_&&x?!y.shiftKey&&b===x?(y.preventDefault(),n&&fi(_,{select:!0})):y.shiftKey&&b===_&&(y.preventDefault(),n&&fi(x,{select:!0})):b===w&&y.preventDefault()}},[n,r,p.paused]);return h.jsx($e.div,{tabIndex:-1,...i,ref:f,onKeyDown:m})});Vp.displayName=CQ;function kQ(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(fi(r,{select:t}),document.activeElement!==n)return}function PQ(e){const t=tA(e),n=nA(t,e),r=nA(t.reverse(),e);return[n,r]}function tA(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function nA(e,t){for(const n of e)if(!NQ(n,{upTo:t}))return n}function NQ(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function MQ(e){return e instanceof HTMLInputElement&&"select"in e}function fi(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&MQ(e)&&t&&e.select()}}var rA=AQ();function AQ(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=aA(e,t),e.unshift(t)},remove(t){var n;e=aA(e,t),(n=e[0])==null||n.resume()}}}function aA(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function TQ(e){return e.filter(t=>t.tagName!=="A")}var ab=0;bu=function(){g.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??oA()),document.body.insertAdjacentElement("beforeend",e[1]??oA()),ab++,()=>{ab===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),ab--}},[])};function oA(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}Cn=function(){return Cn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Cn.apply(this,arguments)},jp=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},h0=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};var Wp="right-scroll-bar-position",Hp="width-before-scroll-bar",RQ="with-scroll-bars-hidden",IQ="--removed-body-scroll-bar-size";function ob(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function DQ(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var LQ=typeof window<"u"?g.useLayoutEffect:g.useEffect,iA=new WeakMap;function $Q(e,t){var n=DQ(null,function(r){return e.forEach(function(a){return ob(a,r)})});return LQ(function(){var r=iA.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||ob(s,null)}),o.forEach(function(s){a.has(s)||ob(s,i)})}iA.set(n,e)},[e]),n}function FQ(e){return e}function BQ(e,t){t===void 0&&(t=FQ);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var i=t(o,r);return n.push(i),function(){n=n.filter(function(s){return s!==i})}},assignSyncMedium:function(o){for(r=!0;n.length;){var i=n;n=[],i.forEach(o)}n={push:function(s){return o(s)},filter:function(){return n}}},assignMedium:function(o){r=!0;var i=[];if(n.length){var s=n;n=[],s.forEach(o),i=n}var c=function(){var u=i;i=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){i.push(u),l()},filter:function(u){return i=i.filter(u),n}}}};return a}f0=function(e){e===void 0&&(e={});var t=BQ(null);return t.options=Cn({async:!0,ssr:!1},e),t};var sA=function(e){var t=e.sideCar,n=jp(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,Cn({},n))};sA.isSideCarExport=!0,m0=function(e,t){return e.useMedium(t),sA};var cA=f0(),ib=function(){},qp=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:ib,onWheelCapture:ib,onTouchMoveCapture:ib}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,p=e.noIsolation,m=e.inert,y=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,_=jp(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=f,S=$Q([n,t]),j=Cn(Cn({},_),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:cA,removeScrollBar:l,shards:d,noIsolation:p,inert:m,setCallbacks:o,allowPinchZoom:!!y,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),Cn(Cn({},j),{ref:S})):g.createElement(b,Cn({},j,{className:c,ref:S}),s))});qp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},qp.classNames={fullWidth:Hp,zeroRight:Wp},p0=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function zQ(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=p0();return t&&e.setAttribute("nonce",t),e}function UQ(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function VQ(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}let lA,uA,dA,Zp,fA,pA,hA,ts,mA,sb,yA,gA,Kp;if(lA=function(){var e=0,t=null;return{add:function(n){e==0&&(t=zQ())&&(UQ(t,n),VQ(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},uA=function(){var e=lA();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Ep=function(){var e=uA(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},dA={left:0,top:0,right:0,gap:0},Zp=function(e){return parseInt(e||"",10)||0},fA=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[Zp(n),Zp(r),Zp(a)]},pA=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return dA;var t=fA(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},hA=Ep(),ts="data-scroll-locked",mA=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(RQ,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(ts,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Wp,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Hp,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Wp," .").concat(Wp,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Hp," .").concat(Hp,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(ts,`] {
    `).concat(IQ,": ").concat(s,`px;
  }
`)},sb=function(){var e=parseInt(document.body.getAttribute(ts)||"0",10);return isFinite(e)?e:0},yA=function(){g.useEffect(function(){return document.body.setAttribute(ts,(sb()+1).toString()),function(){var e=sb()-1;e<=0?document.body.removeAttribute(ts):document.body.setAttribute(ts,e.toString())}},[])},gA=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;yA();var o=g.useMemo(function(){return pA(a)},[a]);return g.createElement(hA,{styles:mA(o,!t,a,n?"":"!important")})},Kp=!1,typeof window<"u")try{var Xp=Object.defineProperty({},"passive",{get:function(){return Kp=!0,!0}});window.addEventListener("test",Xp,Xp),window.removeEventListener("test",Xp,Xp)}catch{Kp=!1}var ac=Kp?{passive:!1}:!1,WQ=function(e){return e.tagName==="TEXTAREA"},vA=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!WQ(e)&&n[t]==="visible")},HQ=function(e){return vA(e,"overflowY")},qQ=function(e){return vA(e,"overflowX")},bA=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=wA(e,r);if(a){var o=xA(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},ZQ=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},KQ=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},wA=function(e,t){return e==="v"?HQ(t):qQ(t)},xA=function(e,t){return e==="v"?ZQ(t):KQ(t)},XQ=function(e,t){return e==="h"&&t==="rtl"?-1:1},YQ=function(e,t,n,r,a){var o=XQ(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,f=0;do{var p=xA(e,s),m=p[0],y=p[1],v=p[2],b=y-v-o*m;(m||b)&&wA(e,s)&&(d+=b,f+=m),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(f)<1||!a))&&(l=!0),l},Yp=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},_A=function(e){return[e.deltaX,e.deltaY]},SA=function(e){return e&&"current"in e?e.current:e},JQ=function(e,t){return e[0]===t[0]&&e[1]===t[1]},QQ=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},GQ=0,oc=[];function eG(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(GQ++)[0],o=g.useState(Ep)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var y=h0([e.lockRef.current],(e.shards||[]).map(SA),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!i.current.allowPinchZoom;var b=Yp(y),w=n.current,_="deltaX"in y?y.deltaX:w[0]-b[0],x="deltaY"in y?y.deltaY:w[1]-b[1],S,j=y.target,E=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in y&&E==="h"&&j.type==="range")return!1;var O=bA(E,j);if(!O)return!0;if(O?S=E:(S=E==="v"?"h":"v",O=bA(E,j)),!O)return!1;if(!r.current&&"changedTouches"in y&&(_||x)&&(r.current=S),!S)return!0;var P=r.current||S;return YQ(P,v,y,P==="h"?_:x,!0)},[]),c=g.useCallback(function(y){var v=y;if(!(!oc.length||oc[oc.length-1]!==o)){var b="deltaY"in v?_A(v):Yp(v),w=t.current.filter(function(S){return S.name===v.type&&(S.target===v.target||v.target===S.shadowParent)&&JQ(S.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(SA).filter(Boolean).filter(function(S){return S.contains(v.target)}),x=_.length>0?s(v,_[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(y,v,b,w){var _={name:y,delta:v,target:b,should:w,shadowParent:tG(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(x){return x!==_})},1)},[]),u=g.useCallback(function(y){n.current=Yp(y),r.current=void 0},[]),d=g.useCallback(function(y){l(y.type,_A(y),y.target,s(y,e.lockRef.current))},[]),f=g.useCallback(function(y){l(y.type,Yp(y),y.target,s(y,e.lockRef.current))},[]);g.useEffect(function(){return oc.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",c,ac),document.addEventListener("touchmove",c,ac),document.addEventListener("touchstart",u,ac),function(){oc=oc.filter(function(y){return y!==o}),document.removeEventListener("wheel",c,ac),document.removeEventListener("touchmove",c,ac),document.removeEventListener("touchstart",u,ac)}},[]);var p=e.removeScrollBar,m=e.inert;return g.createElement(g.Fragment,null,m?g.createElement(o,{styles:QQ(a)}):null,p?g.createElement(gA,{gapMode:e.gapMode}):null)}function tG(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const nG=m0(cA,eG);var Jp=g.forwardRef(function(e,t){return g.createElement(qp,Cn({},e,{ref:t,sideCar:nG}))});Jp.classNames=qp.classNames;let jA,ns,Mu,Au,Qp,cb,EA,OA,Gp,lb,ub,CA,Nr,db;jA=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ns=new WeakMap,Mu=new WeakMap,Au={},Qp=0,cb=function(e){return e&&(e.host||cb(e.parentNode))},EA=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=cb(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},OA=function(e,t,n,r){var a=EA(t,Array.isArray(e)?e:[e]);Au[n]||(Au[n]=new WeakMap);var o=Au[n],i=[],s=new Set,c=new Set(a),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};a.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(f){if(s.has(f))u(f);else try{var p=f.getAttribute(r),m=p!==null&&p!=="false",y=(ns.get(f)||0)+1,v=(o.get(f)||0)+1;ns.set(f,y),o.set(f,v),i.push(f),y===1&&m&&Mu.set(f,!0),v===1&&f.setAttribute(n,"true"),m||f.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",f,b)}})};return u(t),s.clear(),Qp++,function(){i.forEach(function(d){var f=ns.get(d)-1,p=o.get(d)-1;ns.set(d,f),o.set(d,p),f||(Mu.has(d)||d.removeAttribute(r),Mu.delete(d)),p||d.removeAttribute(n)}),Qp--,Qp||(ns=new WeakMap,ns=new WeakMap,Mu=new WeakMap,Au={})}},vu=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=jA(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),OA(r,a,n,"aria-hidden")):function(){return null}},Gp="Dialog",[lb,ub]=fr(Gp),[CA,Nr]=lb(Gp),db=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!0}=e,s=g.useRef(null),c=g.useRef(null),[l=!1,u]=Rn({prop:r,defaultProp:a,onChange:o});return h.jsx(CA,{scope:t,triggerRef:s,contentRef:c,contentId:zt(),titleId:zt(),descriptionId:zt(),open:l,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:i,children:n})},db.displayName=Gp;var kA="DialogTrigger",PA=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Nr(kA,n),o=kt(t,a.triggerRef);return h.jsx($e.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":hb(a.open),...r,ref:o,onClick:_e(e.onClick,a.onOpenToggle)})});PA.displayName=kA;var fb="DialogPortal",[rG,NA]=lb(fb,{forceMount:void 0}),MA=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,o=Nr(fb,t);return h.jsx(rG,{scope:t,forceMount:n,children:g.Children.map(r,i=>h.jsx(Ur,{present:n||o.open,children:h.jsx(Ev,{asChild:!0,container:a,children:i})}))})};MA.displayName=fb;var eh="DialogOverlay",AA=g.forwardRef((e,t)=>{const n=NA(eh,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=Nr(eh,e.__scopeDialog);return o.modal?h.jsx(Ur,{present:r||o.open,children:h.jsx(aG,{...a,ref:t})}):null});AA.displayName=eh;var aG=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Nr(eh,n);return h.jsx(Jp,{as:ii,allowPinchZoom:!0,shards:[a.contentRef],children:h.jsx($e.div,{"data-state":hb(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),rs="DialogContent",TA=g.forwardRef((e,t)=>{const n=NA(rs,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=Nr(rs,e.__scopeDialog);return h.jsx(Ur,{present:r||o.open,children:o.modal?h.jsx(oG,{...a,ref:t}):h.jsx(iG,{...a,ref:t})})});TA.displayName=rs;var oG=g.forwardRef((e,t)=>{const n=Nr(rs,e.__scopeDialog),r=g.useRef(null),a=kt(t,n.contentRef,r);return g.useEffect(()=>{const o=r.current;if(o)return vu(o)},[]),h.jsx(RA,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:_e(e.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:_e(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,s=i.button===0&&i.ctrlKey===!0;(i.button===2||s)&&o.preventDefault()}),onFocusOutside:_e(e.onFocusOutside,o=>o.preventDefault())})}),iG=g.forwardRef((e,t)=>{const n=Nr(rs,e.__scopeDialog),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(RA,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),RA=g.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,...i}=e,s=Nr(rs,n),c=g.useRef(null),l=kt(t,c);return bu(),h.jsxs(h.Fragment,{children:[h.jsx(Vp,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(jv,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":hb(s.open),...i,ref:l,onDismiss:()=>s.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(zA,{titleId:s.titleId}),h.jsx(VA,{contentRef:c,descriptionId:s.descriptionId})]})]})}),pb="DialogTitle",IA=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Nr(pb,n);return h.jsx($e.h2,{id:a.titleId,...r,ref:t})});IA.displayName=pb;var DA="DialogDescription",LA=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Nr(DA,n);return h.jsx($e.p,{id:a.descriptionId,...r,ref:t})});LA.displayName=DA;var $A="DialogClose",FA=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Nr($A,n);return h.jsx($e.button,{type:"button",...r,ref:t,onClick:_e(e.onClick,()=>a.onOpenChange(!1))})});FA.displayName=$A;function hb(e){return e?"open":"closed"}let mb,BA,yb,zA,UA,VA,WA;mb="DialogTitleWarning",[BA,yb]=KDe(mb,{contentName:rs,titleName:pb,docsSlug:"dialog"}),zA=({titleId:e})=>{const t=yb(mb),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return g.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},UA="DialogDescriptionWarning",VA=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${yb(UA).contentName}}.`;return g.useEffect(()=>{var a;const r=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},uu=db,WA=PA,pu=MA,Ki=AA,Xi=TA,Zs=IA,Ks=LA,hu=FA;const sG=uu,cG=pu,HA=g.forwardRef(({className:e,...t},n)=>h.jsx(Ki,{className:G("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));HA.displayName=Ki.displayName;const lG=lo("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),qA=g.forwardRef(({side:e="right",className:t,children:n,...r},a)=>h.jsxs(cG,{children:[h.jsx(HA,{}),h.jsxs(Xi,{ref:a,className:G(lG({side:e}),t),...r,children:[n,h.jsxs(hu,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[h.jsx(me,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qA.displayName=Xi.displayName;const uG=g.forwardRef(({className:e,...t},n)=>h.jsx(Zs,{ref:n,className:G("text-lg font-semibold text-foreground",e),...t}));uG.displayName=Zs.displayName;const dG=g.forwardRef(({className:e,...t},n)=>h.jsx(Ks,{ref:n,className:G("text-sm text-muted-foreground",e),...t}));dG.displayName=Ks.displayName;function ZA({className:e,...t}){return h.jsx("div",{className:G("animate-pulse rounded-md bg-muted",e),...t})}const fG=["top","right","bottom","left"],$a=Math.min,gr=Math.max,th=Math.round,nh=Math.floor,pi=e=>({x:e,y:e}),pG={left:"right",right:"left",bottom:"top",top:"bottom"},hG={start:"end",end:"start"};function gb(e,t,n){return gr(e,$a(t,n))}function yo(e,t){return typeof e=="function"?e(t):e}function go(e){return e.split("-")[0]}function ic(e){return e.split("-")[1]}function vb(e){return e==="x"?"y":"x"}function bb(e){return e==="y"?"height":"width"}function hi(e){return["top","bottom"].includes(go(e))?"y":"x"}function wb(e){return vb(hi(e))}function mG(e,t,n){n===void 0&&(n=!1);const r=ic(e),a=wb(e),o=bb(a);let i=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=rh(i)),[i,rh(i)]}function yG(e){const t=rh(e);return[xb(e),t,xb(t)]}function xb(e){return e.replace(/start|end/g,t=>hG[t])}function gG(e,t,n){const r=["left","right"],a=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?o:i;default:return[]}}function vG(e,t,n,r){const a=ic(e);let o=gG(go(e),n==="start",r);return a&&(o=o.map(i=>i+"-"+a),t&&(o=o.concat(o.map(xb)))),o}function rh(e){return e.replace(/left|right|bottom|top/g,t=>pG[t])}function bG(e){return{top:0,right:0,bottom:0,left:0,...e}}function KA(e){return typeof e!="number"?bG(e):{top:e,right:e,bottom:e,left:e}}function ah(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function XA(e,t,n){let{reference:r,floating:a}=e;const o=hi(t),i=wb(t),s=bb(i),c=go(t),l=o==="y",u=r.x+r.width/2-a.width/2,d=r.y+r.height/2-a.height/2,f=r[s]/2-a[s]/2;let p;switch(c){case"top":p={x:u,y:r.y-a.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-a.width,y:d};break;default:p={x:r.x,y:r.y}}switch(ic(t)){case"start":p[i]-=f*(n&&l?-1:1);break;case"end":p[i]+=f*(n&&l?-1:1);break}return p}const wG=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:i}=n,s=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let l=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:d}=XA(l,r,c),f=r,p={},m=0;for(let y=0;y<s.length;y++){const{name:v,fn:b}=s[y],{x:w,y:_,data:x,reset:S}=await b({x:u,y:d,initialPlacement:r,placement:f,strategy:a,middlewareData:p,rects:l,platform:i,elements:{reference:e,floating:t}});u=w??u,d=_??d,p={...p,[v]:{...p[v],...x}},S&&m<=50&&(m++,typeof S=="object"&&(S.placement&&(f=S.placement),S.rects&&(l=S.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):S.rects),{x:u,y:d}=XA(l,f,c)),y=-1)}return{x:u,y:d,placement:f,strategy:a,middlewareData:p}};async function Tu(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:o,rects:i,elements:s,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=yo(t,e),m=KA(p),y=s[f?d==="floating"?"reference":"floating":d],v=ah(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(y)))==null||n?y:y.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),b=d==="floating"?{x:r,y:a,width:i.floating.width,height:i.floating.height}:i.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),_=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},x=ah(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:w,strategy:c}):b);return{top:(v.top-x.top+m.top)/_.y,bottom:(x.bottom-v.bottom+m.bottom)/_.y,left:(v.left-x.left+m.left)/_.x,right:(x.right-v.right+m.right)/_.x}}const xG=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:o,platform:i,elements:s,middlewareData:c}=t,{element:l,padding:u=0}=yo(e,t)||{};if(l==null)return{};const d=KA(u),f={x:n,y:r},p=wb(a),m=bb(p),y=await i.getDimensions(l),v=p==="y",b=v?"top":"left",w=v?"bottom":"right",_=v?"clientHeight":"clientWidth",x=o.reference[m]+o.reference[p]-f[p]-o.floating[m],S=f[p]-o.reference[p],j=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l));let E=j?j[_]:0;(!E||!await(i.isElement==null?void 0:i.isElement(j)))&&(E=s.floating[_]||o.floating[m]);const O=x/2-S/2,P=E/2-y[m]/2-1,k=$a(d[b],P),N=$a(d[w],P),R=k,M=E-y[m]-N,C=E/2-y[m]/2+O,T=gb(R,C,M),A=!c.arrow&&ic(a)!=null&&C!==T&&o.reference[m]/2-(C<R?k:N)-y[m]/2<0,I=A?C<R?C-R:C-M:0;return{[p]:f[p]+I,data:{[p]:T,centerOffset:C-T-I,...A&&{alignmentOffset:I}},reset:A}}}),_G=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:i,initialPlacement:s,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:y=!0,...v}=yo(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const b=go(a),w=hi(s),_=go(s)===s,x=await(c.isRTL==null?void 0:c.isRTL(l.floating)),S=f||(_||!y?[rh(s)]:yG(s)),j=m!=="none";!f&&j&&S.push(...vG(s,y,m,x));const E=[s,...S],O=await Tu(t,v),P=[];let k=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&P.push(O[b]),d){const C=mG(a,i,x);P.push(O[C[0]],O[C[1]])}if(k=[...k,{placement:a,overflows:P}],!P.every(C=>C<=0)){var N,R;const C=(((N=o.flip)==null?void 0:N.index)||0)+1,T=E[C];if(T)return{data:{index:C,overflows:k},reset:{placement:T}};let A=(R=k.filter(I=>I.overflows[0]<=0).sort((I,F)=>I.overflows[1]-F.overflows[1])[0])==null?void 0:R.placement;if(!A)switch(p){case"bestFit":{var M;const I=(M=k.filter(F=>{if(j){const D=hi(F.placement);return D===w||D==="y"}return!0}).map(F=>[F.placement,F.overflows.filter(D=>D>0).reduce((D,V)=>D+V,0)]).sort((F,D)=>F[1]-D[1])[0])==null?void 0:M[0];I&&(A=I);break}case"initialPlacement":A=s;break}if(a!==A)return{reset:{placement:A}}}return{}}}};function YA(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function JA(e){return fG.some(t=>e[t]>=0)}const SG=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=yo(e,t);switch(r){case"referenceHidden":{const o=await Tu(t,{...a,elementContext:"reference"}),i=YA(o,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:JA(i)}}}case"escaped":{const o=await Tu(t,{...a,altBoundary:!0}),i=YA(o,n.floating);return{data:{escapedOffsets:i,escaped:JA(i)}}}default:return{}}}}};async function jG(e,t){const{placement:n,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),i=go(n),s=ic(n),c=hi(n)==="y",l=["left","top"].includes(i)?-1:1,u=o&&c?-1:1,d=yo(t,e);let{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof m=="number"&&(p=s==="end"?m*-1:m),c?{x:p*u,y:f*l}:{x:f*l,y:p*u}}const EG=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:o,placement:i,middlewareData:s}=t,c=await jG(t,e);return i===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:a+c.x,y:o+c.y,data:{...c,placement:i}}}}},OG=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:s={fn:v=>{let{x:b,y:w}=v;return{x:b,y:w}}},...c}=yo(e,t),l={x:n,y:r},u=await Tu(t,c),d=hi(go(a)),f=vb(d);let p=l[f],m=l[d];if(o){const v=f==="y"?"top":"left",b=f==="y"?"bottom":"right",w=p+u[v],_=p-u[b];p=gb(w,p,_)}if(i){const v=d==="y"?"top":"left",b=d==="y"?"bottom":"right",w=m+u[v],_=m-u[b];m=gb(w,m,_)}const y=s.fn({...t,[f]:p,[d]:m});return{...y,data:{x:y.x-n,y:y.y-r}}}}},CG=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:o,middlewareData:i}=t,{offset:s=0,mainAxis:c=!0,crossAxis:l=!0}=yo(e,t),u={x:n,y:r},d=hi(a),f=vb(d);let p=u[f],m=u[d];const y=yo(s,t),v=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(c){const _=f==="y"?"height":"width",x=o.reference[f]-o.floating[_]+v.mainAxis,S=o.reference[f]+o.reference[_]-v.mainAxis;p<x?p=x:p>S&&(p=S)}if(l){var b,w;const _=f==="y"?"width":"height",x=["top","left"].includes(go(a)),S=o.reference[d]-o.floating[_]+(x&&((b=i.offset)==null?void 0:b[d])||0)+(x?0:v.crossAxis),j=o.reference[d]+o.reference[_]+(x?0:((w=i.offset)==null?void 0:w[d])||0)-(x?v.crossAxis:0);m<S?m=S:m>j&&(m=j)}return{[f]:p,[d]:m}}}},kG=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:a,elements:o}=t,{apply:i=()=>{},...s}=yo(e,t),c=await Tu(t,s),l=go(n),u=ic(n),d=hi(n)==="y",{width:f,height:p}=r.floating;let m,y;l==="top"||l==="bottom"?(m=l,y=u===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(y=l,m=u==="end"?"top":"bottom");const v=p-c.top-c.bottom,b=f-c.left-c.right,w=$a(p-c[m],v),_=$a(f-c[y],b),x=!t.middlewareData.shift;let S=w,j=_;if(d?j=u||x?$a(_,b):b:S=u||x?$a(w,v):v,x&&!u){const O=gr(c.left,0),P=gr(c.right,0),k=gr(c.top,0),N=gr(c.bottom,0);d?j=f-2*(O!==0||P!==0?O+P:gr(c.left,c.right)):S=p-2*(k!==0||N!==0?k+N:gr(c.top,c.bottom))}await i({...t,availableWidth:j,availableHeight:S});const E=await a.getDimensions(o.floating);return f!==E.width||p!==E.height?{reset:{rects:!0}}:{}}}};function sc(e){return QA(e)?(e.nodeName||"").toLowerCase():"#document"}function vr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function vo(e){var t;return(t=(QA(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function QA(e){return e instanceof Node||e instanceof vr(e).Node}function ea(e){return e instanceof Element||e instanceof vr(e).Element}function Fa(e){return e instanceof HTMLElement||e instanceof vr(e).HTMLElement}function GA(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof vr(e).ShadowRoot}function Ru(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=ta(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function PG(e){return["table","td","th"].includes(sc(e))}function oh(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function _b(e){const t=Sb(),n=ea(e)?ta(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function NG(e){let t=mi(e);for(;Fa(t)&&!cc(t);){if(_b(t))return t;if(oh(t))return null;t=mi(t)}return null}function Sb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function cc(e){return["html","body","#document"].includes(sc(e))}function ta(e){return vr(e).getComputedStyle(e)}function ih(e){return ea(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function mi(e){if(sc(e)==="html")return e;const t=e.assignedSlot||e.parentNode||GA(e)&&e.host||vo(e);return GA(t)?t.host:t}function e2(e){const t=mi(e);return cc(t)?e.ownerDocument?e.ownerDocument.body:e.body:Fa(t)&&Ru(t)?t:e2(t)}function Iu(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=e2(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),i=vr(a);if(o){const s=jb(i);return t.concat(i,i.visualViewport||[],Ru(a)?a:[],s&&n?Iu(s):[])}return t.concat(a,Iu(a,[],n))}function jb(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function t2(e){const t=ta(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=Fa(e),o=a?e.offsetWidth:n,i=a?e.offsetHeight:r,s=th(n)!==o||th(r)!==i;return s&&(n=o,r=i),{width:n,height:r,$:s}}function Eb(e){return ea(e)?e:e.contextElement}function lc(e){const t=Eb(e);if(!Fa(t))return pi(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=t2(t);let i=(o?th(n.width):n.width)/r,s=(o?th(n.height):n.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const MG=pi(0);function n2(e){const t=vr(e);return!Sb()||!t.visualViewport?MG:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function AG(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==vr(e)?!1:t}function as(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=Eb(e);let i=pi(1);t&&(r?ea(r)&&(i=lc(r)):i=lc(e));const s=AG(o,n,r)?n2(o):pi(0);let c=(a.left+s.x)/i.x,l=(a.top+s.y)/i.y,u=a.width/i.x,d=a.height/i.y;if(o){const f=vr(o),p=r&&ea(r)?vr(r):r;let m=f,y=jb(m);for(;y&&r&&p!==m;){const v=lc(y),b=y.getBoundingClientRect(),w=ta(y),_=b.left+(y.clientLeft+parseFloat(w.paddingLeft))*v.x,x=b.top+(y.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,l*=v.y,u*=v.x,d*=v.y,c+=_,l+=x,m=vr(y),y=jb(m)}}return ah({width:u,height:d,x:c,y:l})}function TG(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const o=a==="fixed",i=vo(r),s=t?oh(t.floating):!1;if(r===i||s&&o)return n;let c={scrollLeft:0,scrollTop:0},l=pi(1);const u=pi(0),d=Fa(r);if((d||!d&&!o)&&((sc(r)!=="body"||Ru(i))&&(c=ih(r)),Fa(r))){const f=as(r);l=lc(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function RG(e){return Array.from(e.getClientRects())}function r2(e){return as(vo(e)).left+ih(e).scrollLeft}function IG(e){const t=vo(e),n=ih(e),r=e.ownerDocument.body,a=gr(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=gr(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+r2(e);const s=-n.scrollTop;return ta(r).direction==="rtl"&&(i+=gr(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:i,y:s}}function DG(e,t){const n=vr(e),r=vo(e),a=n.visualViewport;let o=r.clientWidth,i=r.clientHeight,s=0,c=0;if(a){o=a.width,i=a.height;const l=Sb();(!l||l&&t==="fixed")&&(s=a.offsetLeft,c=a.offsetTop)}return{width:o,height:i,x:s,y:c}}function LG(e,t){const n=as(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,o=Fa(e)?lc(e):pi(1),i=e.clientWidth*o.x,s=e.clientHeight*o.y,c=a*o.x,l=r*o.y;return{width:i,height:s,x:c,y:l}}function a2(e,t,n){let r;if(t==="viewport")r=DG(e,n);else if(t==="document")r=IG(vo(e));else if(ea(t))r=LG(t,n);else{const a=n2(e);r={...t,x:t.x-a.x,y:t.y-a.y}}return ah(r)}function o2(e,t){const n=mi(e);return n===t||!ea(n)||cc(n)?!1:ta(n).position==="fixed"||o2(n,t)}function $G(e,t){const n=t.get(e);if(n)return n;let r=Iu(e,[],!1).filter(s=>ea(s)&&sc(s)!=="body"),a=null;const o=ta(e).position==="fixed";let i=o?mi(e):e;for(;ea(i)&&!cc(i);){const s=ta(i),c=_b(i);!c&&s.position==="fixed"&&(a=null),(o?!c&&!a:!c&&s.position==="static"&&a&&["absolute","fixed"].includes(a.position)||Ru(i)&&!c&&o2(e,i))?r=r.filter(l=>l!==i):a=s,i=mi(i)}return t.set(e,r),r}function FG(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const o=[...n==="clippingAncestors"?oh(t)?[]:$G(t,this._c):[].concat(n),r],i=o[0],s=o.reduce((c,l)=>{const u=a2(t,l,a);return c.top=gr(u.top,c.top),c.right=$a(u.right,c.right),c.bottom=$a(u.bottom,c.bottom),c.left=gr(u.left,c.left),c},a2(t,i,a));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function BG(e){const{width:t,height:n}=t2(e);return{width:t,height:n}}function zG(e,t,n){const r=Fa(t),a=vo(t),o=n==="fixed",i=as(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const c=pi(0);if(r||!r&&!o)if((sc(t)!=="body"||Ru(a))&&(s=ih(t)),r){const d=as(t,!0,o,t);c.x=d.x+t.clientLeft,c.y=d.y+t.clientTop}else a&&(c.x=r2(a));const l=i.left+s.scrollLeft-c.x,u=i.top+s.scrollTop-c.y;return{x:l,y:u,width:i.width,height:i.height}}function Ob(e){return ta(e).position==="static"}function i2(e,t){return!Fa(e)||ta(e).position==="fixed"?null:t?t(e):e.offsetParent}function s2(e,t){const n=vr(e);if(oh(e))return n;if(!Fa(e)){let a=mi(e);for(;a&&!cc(a);){if(ea(a)&&!Ob(a))return a;a=mi(a)}return n}let r=i2(e,t);for(;r&&PG(r)&&Ob(r);)r=i2(r,t);return r&&cc(r)&&Ob(r)&&!_b(r)?n:r||NG(e)||n}const UG=async function(e){const t=this.getOffsetParent||s2,n=this.getDimensions,r=await n(e.floating);return{reference:zG(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function VG(e){return ta(e).direction==="rtl"}const WG={convertOffsetParentRelativeRectToViewportRelativeRect:TG,getDocumentElement:vo,getClippingRect:FG,getOffsetParent:s2,getElementRects:UG,getClientRects:RG,getDimensions:BG,getScale:lc,isElement:ea,isRTL:VG};function HG(e,t){let n=null,r;const a=vo(e);function o(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),o();const{left:l,top:u,width:d,height:f}=e.getBoundingClientRect();if(s||t(),!d||!f)return;const p=nh(u),m=nh(a.clientWidth-(l+d)),y=nh(a.clientHeight-(u+f)),v=nh(l),b={rootMargin:-p+"px "+-m+"px "+-y+"px "+-v+"px",threshold:gr(0,$a(1,c))||1};let w=!0;function _(x){const S=x[0].intersectionRatio;if(S!==c){if(!w)return i();S?i(!1,S):r=setTimeout(()=>{i(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(_,{...b,root:a.ownerDocument})}catch{n=new IntersectionObserver(_,b)}n.observe(e)}return i(!0),o}Tv=function(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=Eb(e),u=a||o?[...l?Iu(l):[],...Iu(t)]:[];u.forEach(b=>{a&&b.addEventListener("scroll",n,{passive:!0}),o&&b.addEventListener("resize",n)});const d=l&&s?HG(l,n):null;let f=-1,p=null;i&&(p=new ResizeObserver(b=>{let[w]=b;w&&w.target===l&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var _;(_=p)==null||_.observe(t)})),n()}),l&&!c&&p.observe(l),p.observe(t));let m,y=c?as(e):null;c&&v();function v(){const b=as(e);y&&(b.x!==y.x||b.y!==y.y||b.width!==y.width||b.height!==y.height)&&n(),y=b,m=requestAnimationFrame(v)}return n(),()=>{var b;u.forEach(w=>{a&&w.removeEventListener("scroll",n),o&&w.removeEventListener("resize",n)}),d==null||d(),(b=p)==null||b.disconnect(),p=null,c&&cancelAnimationFrame(m)}};let c2;dN=EG,_N=OG,fN=_G,jN=kG,c2=SG,Gv=xG,SN=CG,pN=(e,t,n)=>{const r=new Map,a={platform:WG,...n},o={...a.platform,_c:r};return wG(e,t,{...a,platform:o})};var sh=typeof document<"u"?g.useLayoutEffect:g.useEffect;function ch(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!ch(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!ch(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function l2(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function u2(e,t){const n=l2(e);return Math.round(t*n)/n}function d2(e){const t=g.useRef(e);return sh(()=>{t.current=e}),t}Zv=function(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:i}={},transform:s=!0,whileElementsMounted:c,open:l}=e,[u,d]=g.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=g.useState(r);ch(f,r)||p(r);const[m,y]=g.useState(null),[v,b]=g.useState(null),w=g.useCallback(I=>{I!==j.current&&(j.current=I,y(I))},[]),_=g.useCallback(I=>{I!==E.current&&(E.current=I,b(I))},[]),x=o||m,S=i||v,j=g.useRef(null),E=g.useRef(null),O=g.useRef(u),P=c!=null,k=d2(c),N=d2(a),R=g.useCallback(()=>{if(!j.current||!E.current)return;const I={placement:t,strategy:n,middleware:f};N.current&&(I.platform=N.current),pN(j.current,E.current,I).then(F=>{const D={...F,isPositioned:!0};M.current&&!ch(O.current,D)&&(O.current=D,ru.flushSync(()=>{d(D)}))})},[f,t,n,N]);sh(()=>{l===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,d(I=>({...I,isPositioned:!1})))},[l]);const M=g.useRef(!1);sh(()=>(M.current=!0,()=>{M.current=!1}),[]),sh(()=>{if(x&&(j.current=x),S&&(E.current=S),x&&S){if(k.current)return k.current(x,S,R);R()}},[x,S,R,k,P]);const C=g.useMemo(()=>({reference:j,floating:E,setReference:w,setFloating:_}),[w,_]),T=g.useMemo(()=>({reference:x,floating:S}),[x,S]),A=g.useMemo(()=>{const I={position:n,left:0,top:0};if(!T.floating)return I;const F=u2(T.floating,u.x),D=u2(T.floating,u.y);return s?{...I,transform:"translate("+F+"px, "+D+"px)",...l2(T.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:F,top:D}},[n,s,T.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:R,refs:C,elements:T,floatingStyles:A}),[u,R,C,T,A])};let f2;f2=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Gv({element:r.current,padding:a}).fn(n):{}:r?Gv({element:r,padding:a}).fn(n):{}}}},Kv=(e,t)=>({...dN(e),options:[e,t]}),Xv=(e,t)=>({..._N(e),options:[e,t]}),Yv=(e,t)=>({...SN(e),options:[e,t]}),Jv=(e,t)=>({...fN(e),options:[e,t]}),Iv=(e,t)=>({...jN(e),options:[e,t]}),d0=(e,t)=>({...c2(e),options:[e,t]}),u0=(e,t)=>({...f2(e),options:[e,t]});var qG="Arrow",p2=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx($e.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});p2.displayName=qG;var ZG=p2;function KG(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...m}=d,y=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>m,Object.values(m));return h.jsx(y.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,m=g.useContext(p);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,XG(a,...t)]}function XG(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}Sp=function(e){const[t,n]=g.useState(void 0);return fn(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let i,s;if("borderBoxSize"in o){const c=o.borderBoxSize,l=Array.isArray(c)?c[0]:c;i=l.inlineSize,s=l.blockSize}else i=e.offsetWidth,s=e.offsetHeight;n({width:i,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t};var Cb="Popper",[h2,uc]=KG(Cb),[YG,m2]=h2(Cb),y2=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(YG,{scope:t,anchor:r,onAnchorChange:a,children:n})};y2.displayName=Cb;var g2="PopperAnchor",v2=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=m2(g2,n),i=g.useRef(null),s=kt(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx($e.div,{...a,ref:s})});v2.displayName=g2;var kb="PopperContent",[JG,QG]=h2(kb),b2=g.forwardRef((e,t)=>{var W,q,Z,ee,oe,H;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...y}=e,v=m2(kb,n),[b,w]=g.useState(null),_=kt(t,le=>w(le)),[x,S]=g.useState(null),j=Sp(x),E=(j==null?void 0:j.width)??0,O=(j==null?void 0:j.height)??0,P=r+(o!=="center"?"-"+o:""),k=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},N=Array.isArray(l)?l:[l],R=N.length>0,M={padding:k,boundary:N.filter(eee),altBoundary:R},{refs:C,floatingStyles:T,placement:A,isPositioned:I,middlewareData:F}=Zv({strategy:"fixed",placement:P,whileElementsMounted:(...le)=>Tv(...le,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Kv({mainAxis:a+O,alignmentAxis:i}),c&&Xv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Yv():void 0,...M}),c&&Jv({...M}),Iv({...M,apply:({elements:le,rects:ie,availableWidth:pe,availableHeight:Oe})=>{const{width:Ue,height:Ve}=ie.reference,Ce=le.floating.style;Ce.setProperty("--radix-popper-available-width",`${pe}px`),Ce.setProperty("--radix-popper-available-height",`${Oe}px`),Ce.setProperty("--radix-popper-anchor-width",`${Ue}px`),Ce.setProperty("--radix-popper-anchor-height",`${Ve}px`)}}),x&&u0({element:x,padding:s}),tee({arrowWidth:E,arrowHeight:O}),f&&d0({strategy:"referenceHidden",...M})]}),[D,V]=_2(A),U=pr(m);fn(()=>{I&&(U==null||U())},[I,U]);const B=(W=F.arrow)==null?void 0:W.x,K=(q=F.arrow)==null?void 0:q.y,te=((Z=F.arrow)==null?void 0:Z.centerOffset)!==0,[L,$]=g.useState();return fn(()=>{b&&$(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:I?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:L,"--radix-popper-transform-origin":[(ee=F.transformOrigin)==null?void 0:ee.x,(oe=F.transformOrigin)==null?void 0:oe.y].join(" "),...((H=F.hide)==null?void 0:H.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(JG,{scope:n,placedSide:D,onArrowChange:S,arrowX:B,arrowY:K,shouldHideArrow:te,children:h.jsx($e.div,{"data-side":D,"data-align":V,...y,ref:_,style:{...y.style,animation:I?void 0:"none"}})})})});b2.displayName=kb;var w2="PopperArrow",GG={top:"bottom",right:"left",bottom:"top",left:"right"},x2=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=QG(w2,n),o=GG[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(ZG,{...r,ref:t,style:{...r.style,display:"block"}})})});x2.displayName=w2;function eee(e){return e!==null}var tee=e=>({name:"transformOrigin",options:e,fn(t){var y,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((y=a.arrow)==null?void 0:y.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=_2(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,f=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let p="",m="";return c==="bottom"?(p=o?u:`${d}px`,m=`${-s}px`):c==="top"?(p=o?u:`${d}px`,m=`${r.floating.height+s}px`):c==="right"?(p=`${-s}px`,m=o?u:`${f}px`):c==="left"&&(p=`${r.floating.width+s}px`,m=o?u:`${f}px`),{data:{x:p,y:m}}}});function _2(e){const[t,n="center"]=e.split("-");return[t,n]}var lh=y2,Pb=v2,Nb=b2,Mb=x2,[uh,F4e]=fr("Tooltip",[uc]),dh=uc(),S2="TooltipProvider",nee=700,Ab="tooltip.open",[ree,Tb]=uh(S2),j2=e=>{const{__scopeTooltip:t,delayDuration:n=nee,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:o}=e,[i,s]=g.useState(!0),c=g.useRef(!1),l=g.useRef(0);return g.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),h.jsx(ree,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:g.useCallback(u=>{c.current=u},[]),disableHoverableContent:a,children:o})};j2.displayName=S2;var fh="Tooltip",[aee,Du]=uh(fh),E2=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a=!1,onOpenChange:o,disableHoverableContent:i,delayDuration:s}=e,c=Tb(fh,e.__scopeTooltip),l=dh(t),[u,d]=g.useState(null),f=zt(),p=g.useRef(0),m=i??c.disableHoverableContent,y=s??c.delayDuration,v=g.useRef(!1),[b=!1,w]=Rn({prop:r,defaultProp:a,onChange:E=>{E?(c.onOpen(),document.dispatchEvent(new CustomEvent(Ab))):c.onClose(),o==null||o(E)}}),_=g.useMemo(()=>b?v.current?"delayed-open":"instant-open":"closed",[b]),x=g.useCallback(()=>{window.clearTimeout(p.current),p.current=0,v.current=!1,w(!0)},[w]),S=g.useCallback(()=>{window.clearTimeout(p.current),p.current=0,w(!1)},[w]),j=g.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{v.current=!0,w(!0),p.current=0},y)},[y,w]);return g.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),h.jsx(lh,{...l,children:h.jsx(aee,{scope:t,contentId:f,open:b,stateAttribute:_,trigger:u,onTriggerChange:d,onTriggerEnter:g.useCallback(()=>{c.isOpenDelayed?j():x()},[c.isOpenDelayed,j,x]),onTriggerLeave:g.useCallback(()=>{m?S():(window.clearTimeout(p.current),p.current=0)},[S,m]),onOpen:x,onClose:S,disableHoverableContent:m,children:n})})};E2.displayName=fh;var Rb="TooltipTrigger",O2=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=Du(Rb,n),o=Tb(Rb,n),i=dh(n),s=g.useRef(null),c=kt(t,s,a.onTriggerChange),l=g.useRef(!1),u=g.useRef(!1),d=g.useCallback(()=>l.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),h.jsx(Pb,{asChild:!0,...i,children:h.jsx($e.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:c,onPointerMove:_e(e.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!o.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:_e(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:_e(e.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:_e(e.onFocus,()=>{l.current||a.onOpen()}),onBlur:_e(e.onBlur,a.onClose),onClick:_e(e.onClick,a.onClose)})})});O2.displayName=Rb;var Ib="TooltipPortal",[oee,iee]=uh(Ib,{forceMount:void 0}),C2=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:a}=e,o=Du(Ib,t);return h.jsx(oee,{scope:t,forceMount:n,children:h.jsx(Ur,{present:n||o.open,children:h.jsx(Ev,{asChild:!0,container:a,children:r})})})};C2.displayName=Ib;var dc="TooltipContent",k2=g.forwardRef((e,t)=>{const n=iee(dc,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...o}=e,i=Du(dc,e.__scopeTooltip);return h.jsx(Ur,{present:r||i.open,children:i.disableHoverableContent?h.jsx(P2,{side:a,...o,ref:t}):h.jsx(see,{side:a,...o,ref:t})})}),see=g.forwardRef((e,t)=>{const n=Du(dc,e.__scopeTooltip),r=Tb(dc,e.__scopeTooltip),a=g.useRef(null),o=kt(t,a),[i,s]=g.useState(null),{trigger:c,onClose:l}=n,u=a.current,{onPointerInTransitChange:d}=r,f=g.useCallback(()=>{s(null),d(!1)},[d]),p=g.useCallback((m,y)=>{const v=m.currentTarget,b={x:m.clientX,y:m.clientY},w=dee(b,v.getBoundingClientRect()),_=fee(b,w),x=pee(y.getBoundingClientRect()),S=mee([..._,...x]);s(S),d(!0)},[d]);return g.useEffect(()=>()=>f(),[f]),g.useEffect(()=>{if(c&&u){const m=v=>p(v,u),y=v=>p(v,c);return c.addEventListener("pointerleave",m),u.addEventListener("pointerleave",y),()=>{c.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",y)}}},[c,u,p,f]),g.useEffect(()=>{if(i){const m=y=>{const v=y.target,b={x:y.clientX,y:y.clientY},w=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),_=!hee(b,i);w?f():_&&(f(),l())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[c,u,i,l,f]),h.jsx(P2,{...e,ref:o})}),[cee,lee]=uh(fh,{isInside:!1}),P2=g.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:o,onPointerDownOutside:i,...s}=e,c=Du(dc,n),l=dh(n),{onClose:u}=c;return g.useEffect(()=>(document.addEventListener(Ab,u),()=>document.removeEventListener(Ab,u)),[u]),g.useEffect(()=>{if(c.trigger){const d=f=>{var p;(p=f.target)!=null&&p.contains(c.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[c.trigger,u]),h.jsx(jv,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:h.jsxs(Nb,{"data-state":c.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[h.jsx(DX,{children:r}),h.jsx(cee,{scope:n,isInside:!0,children:h.jsx(XDe,{id:c.contentId,role:"tooltip",children:a||r})})]})})});k2.displayName=dc;var N2="TooltipArrow",uee=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=dh(n);return lee(N2,n).isInside?null:h.jsx(Mb,{...a,...r,ref:t})});uee.displayName=N2;function dee(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(n,r,a,o)){case o:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function fee(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function pee(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function hee(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function mee(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),yee(t)}function yee(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const o=n[n.length-1],i=n[n.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}PN=j2,NN=E2,yN=O2,XX=C2,Lv=k2;const Lu=PN,Ba=NN,za=yN,na=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(Lv,{ref:r,sideOffset:t,className:G("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));na.displayName=Lv.displayName;const gee="sidebar:state",vee=60*60*24*7,bee="16rem",wee="18rem",xee="3rem",_ee="b",M2=g.createContext(null);function $u(){const e=g.useContext(M2);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const Db=g.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:a,children:o,...i},s)=>{const c=SQ(),[l,u]=g.useState(!1),[d,f]=g.useState(e),p=t??d,m=g.useCallback(w=>{const _=typeof w=="function"?w(p):w;n?n(_):f(_),document.cookie=`${gee}=${_}; path=/; max-age=${vee}`},[n,p]),y=g.useCallback(()=>c?u(w=>!w):m(w=>!w),[c,m,u]);g.useEffect(()=>{const w=_=>{_.key===_ee&&(_.metaKey||_.ctrlKey)&&(_.preventDefault(),y())};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[y]);const v=p?"expanded":"collapsed",b=g.useMemo(()=>({state:v,open:p,setOpen:m,isMobile:c,openMobile:l,setOpenMobile:u,toggleSidebar:y}),[v,p,m,c,l,u,y]);return h.jsx(M2.Provider,{value:b,children:h.jsx(Lu,{delayDuration:0,children:h.jsx("div",{style:{"--sidebar-width":bee,"--sidebar-width-icon":xee,...a},className:G("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:s,...i,children:o})})})});Db.displayName="SidebarProvider";const Lb=g.forwardRef(({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:r,children:a,...o},i)=>{const{isMobile:s,state:c,openMobile:l,setOpenMobile:u}=$u();return n==="none"?h.jsx("div",{className:G("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:i,...o,children:a}):s?h.jsx(sG,{open:l,onOpenChange:u,...o,children:h.jsx(qA,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":wee},side:e,children:h.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):h.jsxs("div",{ref:i,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?n:"","data-variant":t,"data-side":e,children:[h.jsx("div",{className:G("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),h.jsx("div",{className:G("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...o,children:h.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});Lb.displayName="Sidebar";const A2=g.forwardRef(({className:e,onClick:t,...n},r)=>{const{toggleSidebar:a}=$u();return h.jsx(yt,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:G("h-7 w-7",e),onClick:o=>{t==null||t(o),a()},...n,children:h.jsx(me,{size:32,name:"panel-left"})})});A2.displayName="SidebarTrigger";const T2=g.forwardRef(({className:e,...t},n)=>{const{toggleSidebar:r}=$u();return h.jsx("button",{ref:n,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:G("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});T2.displayName="SidebarRail";const $b=g.forwardRef(({className:e,...t},n)=>h.jsx("main",{ref:n,className:G("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));$b.displayName="SidebarInset";const See=g.forwardRef(({className:e,...t},n)=>h.jsx(In,{ref:n,"data-sidebar":"input",className:G("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));See.displayName="SidebarInput";const jee=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"header",className:G("flex flex-col gap-2 p-2",e),...t}));jee.displayName="SidebarHeader";const R2=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"footer",className:G("flex flex-col gap-2 p-2",e),...t}));R2.displayName="SidebarFooter";const Eee=g.forwardRef(({className:e,...t},n)=>h.jsx(Xs,{ref:n,"data-sidebar":"separator",className:G("mx-2 w-auto bg-sidebar-border",e),...t}));Eee.displayName="SidebarSeparator";const Fb=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"content",className:G("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));Fb.displayName="SidebarContent";const Fu=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group",className:G("relative flex w-full min-w-0 flex-col p-2",e),...t}));Fu.displayName="SidebarGroup";const Bu=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?ii:"div";return h.jsx(a,{ref:r,"data-sidebar":"group-label",className:G("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...n})});Bu.displayName="SidebarGroupLabel";const Oee=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?ii:"button";return h.jsx(a,{ref:r,"data-sidebar":"group-action",className:G("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...n})});Oee.displayName="SidebarGroupAction";const Cee=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group-content",className:G("w-full text-sm",e),...t}));Cee.displayName="SidebarGroupContent";const fc=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu",className:G("flex w-full min-w-0 flex-col gap-1",e),...t}));fc.displayName="SidebarMenu";const bo=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,"data-sidebar":"menu-item",className:G("group/menu-item relative",e),...t}));bo.displayName="SidebarMenuItem";const kee=lo("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),wo=g.forwardRef(({asChild:e=!1,isActive:t=!1,variant:n="default",size:r="default",tooltip:a,className:o,...i},s)=>{const c=e?ii:"button",{isMobile:l,state:u}=$u(),d=h.jsx(c,{ref:s,"data-sidebar":"menu-button","data-size":r,"data-active":t,className:G(kee({variant:n,size:r}),o),...i});return a?(typeof a=="string"&&(a={children:a}),h.jsxs(Ba,{children:[h.jsx(za,{asChild:!0,children:d}),h.jsx(na,{side:"right",align:"center",hidden:u!=="collapsed"||l,...a})]})):d});wo.displayName="SidebarMenuButton";const Pee=g.forwardRef(({className:e,asChild:t=!1,showOnHover:n=!1,...r},a)=>{const o=t?ii:"button";return h.jsx(o,{ref:a,"data-sidebar":"menu-action",className:G("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})});Pee.displayName="SidebarMenuAction";const Nee=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"menu-badge",className:G("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));Nee.displayName="SidebarMenuBadge";const Mee=g.forwardRef(({className:e,showIcon:t=!1,...n},r)=>{const a=g.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return h.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:G("rounded-md h-8 flex gap-2 px-2 items-center",e),...n,children:[t&&h.jsx(ZA,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),h.jsx(ZA,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});Mee.displayName="SidebarMenuSkeleton";const I2=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu-sub",className:G("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));I2.displayName="SidebarMenuSub";const D2=g.forwardRef(({...e},t)=>h.jsx("li",{ref:t,...e}));D2.displayName="SidebarMenuSubItem";const L2=g.forwardRef(({asChild:e=!1,size:t="md",isActive:n,className:r,...a},o)=>{const i=e?ii:"a";return h.jsx(i,{ref:o,"data-sidebar":"menu-sub-button","data-size":t,"data-active":n,className:G("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...a})});L2.displayName="SidebarMenuSubButton";const Aee="hash",ph={application:"/application/:applicationId?",whiteboard:"/whiteboard/:sessionId?",document:"/document/:documentId?"},bn=(e,t)=>{let n=ph[e];return t?n=Object.keys(t||{}).reduce((r,a)=>r.replace(`:${a}`,(t==null?void 0:t[a])||""),n):n=n.replace(/\/:[^/]+/g,""),n!=null&&n.endsWith("?")?n.slice(0,-1):n},Tee=()=>{{const[,e]=window.location.hash.split("?");return new URLSearchParams(`?${e}`)}};function Ree({items:e}){const{t}=Re("documents");return h.jsxs(Fu,{children:[h.jsx(Bu,{children:h.jsx("div",{className:"text-sm",children:t("title")})}),h.jsx(fc,{children:e.map(n=>{var r;return h.jsx(wQ,{asChild:!0,defaultOpen:n.isActive,className:"group/collapsible",children:h.jsxs(bo,{children:[h.jsx(xQ,{asChild:!0,children:h.jsxs(wo,{className:"cursor-pointer",tooltip:t(n.title),children:[n.icon,h.jsx("span",{children:t(n.title)}),h.jsx(me,{name:"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),h.jsx(_Q,{children:h.jsx(I2,{children:(r=n.items)==null?void 0:r.map(a=>h.jsx(D2,{className:"cursor-pointer",children:h.jsx(L2,{asChild:!0,children:h.jsx(K0,{to:bn("document",{documentId:a.id}),children:h.jsx("span",{children:t(a.title)})})})},t(a.title)))})})]})},n.title)})})]})}const Iee=g.memo(({text:e,colors:t={first:"#9E7AFF",second:"#FE8BBB"},className:n,sparklesCount:r=10,...a})=>{const[o,i]=g.useState([]);return g.useEffect(()=>{const s=()=>{const d=`${Math.random()*100}%`,f=`${Math.random()*100}%`,p=Math.random()>.5?t.first:t.second,m=Math.random()*2,y=Math.random()*1+.3,v=Math.random()*10+5;return{id:`${d}-${f}-${Date.now()}`,x:d,y:f,color:p,delay:m,scale:y,lifespan:v}},c=()=>{const d=Array.from({length:r},s);i(d)},l=()=>{i(d=>d.map(f=>f.lifespan<=0?s():{...f,lifespan:f.lifespan-.1}))};c();const u=setInterval(l,100);return()=>clearInterval(u)},[t.first,t.second]),h.jsx("div",{className:G("text-6xl font-bold",n),...a,style:{"--sparkles-first-color":`${t.first}`,"--sparkles-second-color":`${t.second}`},children:h.jsxs("span",{className:"relative inline-block",children:[o.map(s=>h.jsx(Dee,{...s},s.id)),h.jsx("strong",{children:e})]})})},(e,t)=>e.text===t.text),Dee=({id:e,x:t,y:n,color:r,delay:a,scale:o})=>h.jsx(hp.svg,{className:"pointer-events-none absolute z-20",initial:{opacity:0,left:t,top:n},animate:{opacity:[0,1,0],scale:[0,o,0],rotate:[75,120,150]},transition:{duration:.8,repeat:1/0,delay:a},width:"21",height:"21",viewBox:"0 0 21 21",children:h.jsx("path",{d:"M9.82531 0.843845C10.0553 0.215178 10.9446 0.215178 11.1746 0.843845L11.8618 2.72026C12.4006 4.19229 12.3916 6.39157 13.5 7.5C14.6084 8.60843 16.8077 8.59935 18.2797 9.13822L20.1561 9.82534C20.7858 10.0553 20.7858 10.9447 20.1561 11.1747L18.2797 11.8618C16.8077 12.4007 14.6084 12.3916 13.5 13.5C12.3916 14.6084 12.4006 16.8077 11.8618 18.2798L11.1746 20.1562C10.9446 20.7858 10.0553 20.7858 9.82531 20.1562L9.13819 18.2798C8.59932 16.8077 8.60843 14.6084 7.5 13.5C6.39157 12.3916 4.19225 12.4007 2.72023 11.8618L0.843814 11.1747C0.215148 10.9447 0.215148 10.0553 0.843814 9.82534L2.72023 9.13822C4.19225 8.59935 6.39157 8.60843 7.5 7.5C8.60843 6.39157 8.59932 4.19229 9.13819 2.72026L9.82531 0.843845Z",fill:r})},e);function Lee({className:e,onClick:t}){const{t:n}=Re("sidebar");return h.jsxs(wo,{className:G(e,"tw-w-full"),onClick:t,children:[h.jsx(me,{name:"frame"}),h.jsx(Iee,{text:n("new_session"),className:"text-sm",sparklesCount:3})]})}const $ee=()=>{const[e,t]=g.useState(!1),n=st(a=>a.createSession),r=g.useCallback(async a=>{try{return t(!0),await n(a)}finally{t(!1)}},[n]);return{loading:e,createSession:r}},yi=uu,Fee=pu,$2=g.forwardRef(({className:e,...t},n)=>h.jsx(Ki,{ref:n,className:G("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));$2.displayName=Ki.displayName;const xo=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(Fee,{children:[h.jsx($2,{}),h.jsxs(Xi,{ref:r,className:G("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,h.jsxs(hu,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(me,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));xo.displayName=Xi.displayName;const _o=({className:e,...t})=>h.jsx("div",{className:G("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});_o.displayName="DialogHeader";const zu=({className:e,...t})=>h.jsx("div",{className:G("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});zu.displayName="DialogFooter";const So=g.forwardRef(({className:e,...t},n)=>h.jsx(Zs,{ref:n,className:G("text-lg font-semibold leading-none tracking-tight",e),...t}));So.displayName=Zs.displayName;const Uu=g.forwardRef(({className:e,...t},n)=>h.jsx(Ks,{ref:n,className:G("text-sm text-muted-foreground",e),...t}));Uu.displayName=Ks.displayName;var Bee="Label",F2=g.forwardRef((e,t)=>h.jsx($e.label,{...e,ref:t,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=e.onMouseDown)==null||r.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));F2.displayName=Bee;var B2=F2;let z2;z2=lo("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),it=g.forwardRef(({className:e,...t},n)=>h.jsx(B2,{ref:n,className:G(z2(),e),...t})),it.displayName=B2.displayName;const zee=uo(()=>{const e=an(),{t}=Re("dialogs"),[n,r]=g.useState(""),{toast:a}=on(),{loading:o,createSession:i}=$ee(),s=u=>{r(u.target.value)},c=async()=>{try{const u=await i({name:n});r(""),e.resolve(u.id),e.hide()}catch(u){a({variant:"destructive",description:t("create_session.errors.create_failed")}),e.reject(u)}},l=()=>{r(""),e.resolve(void 0),e.hide()};return h.jsx(yi,{open:e.visible,onOpenChange:l,children:h.jsxs(xo,{className:"sm:max-w-[425px]",children:[h.jsxs(_o,{children:[h.jsx(So,{children:t("create_session.title")}),h.jsx(Uu,{children:t("create_session.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(it,{className:"mb-2",htmlFor:"name",children:t("create_session.name")}),h.jsx(In,{onChange:s,id:"name",value:n,placeholder:t("create_session.name_placeholder")})]})}),h.jsx(zu,{children:h.jsx(yt,{onClick:c,disabled:o||!n,type:"submit",children:t("create_session.create")})})]})})}),Uee=()=>{const[e,t]=g.useState(!1),n=st(a=>a.deleteSession),r=g.useCallback(async a=>{try{t(!0),await n(a),await Promise.all([he("FlowEdge").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>he("FlowEdge").delete(i.id)))),he("FlowNode").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>he("FlowNode").delete(i.id))))])}finally{t(!1)}},[n]);return{loading:e,deleteSession:r}};var U2="AlertDialog",[Vee,B4e]=fr(U2,[ub]),jo=ub(),V2=e=>{const{__scopeAlertDialog:t,...n}=e,r=jo(t);return h.jsx(uu,{...r,...n,modal:!0})};V2.displayName=U2;var Wee="AlertDialogTrigger",Hee=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=jo(n);return h.jsx(WA,{...a,...r,ref:t})});Hee.displayName=Wee;var qee="AlertDialogPortal",W2=e=>{const{__scopeAlertDialog:t,...n}=e,r=jo(t);return h.jsx(pu,{...r,...n})};W2.displayName=qee;var Zee="AlertDialogOverlay",H2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=jo(n);return h.jsx(Ki,{...a,...r,ref:t})});H2.displayName=Zee;var pc="AlertDialogContent",[Kee,Xee]=Vee(pc),q2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,o=jo(n),i=g.useRef(null),s=kt(t,i),c=g.useRef(null);return h.jsx(BA,{contentName:pc,titleName:Z2,docsSlug:"alert-dialog",children:h.jsx(Kee,{scope:n,cancelRef:c,children:h.jsxs(Xi,{role:"alertdialog",...o,...a,ref:s,onOpenAutoFocus:_e(a.onOpenAutoFocus,l=>{var u;l.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[h.jsx(DX,{children:r}),h.jsx(eT,{contentRef:i})]})})})});q2.displayName=pc;var Z2="AlertDialogTitle",K2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=jo(n);return h.jsx(Zs,{...a,...r,ref:t})});K2.displayName=Z2;var X2="AlertDialogDescription",Y2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=jo(n);return h.jsx(Ks,{...a,...r,ref:t})});Y2.displayName=X2;var Yee="AlertDialogAction",J2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=jo(n);return h.jsx(hu,{...a,...r,ref:t})});J2.displayName=Yee;var Q2="AlertDialogCancel",G2=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=Xee(Q2,n),o=jo(n),i=kt(t,a);return h.jsx(hu,{...o,...r,ref:i})});G2.displayName=Q2;let eT;eT=({contentRef:e})=>{const t=`\`${pc}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${pc}\` by passing a \`${X2}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${pc}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return g.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},wN=V2,bN=W2,zv=H2,Uv=q2,Hv=J2,qv=G2,Vv=K2,Wv=Y2;const tT=wN,Jee=bN,nT=g.forwardRef(({className:e,...t},n)=>h.jsx(zv,{className:G("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));nT.displayName=zv.displayName;const Bb=g.forwardRef(({className:e,...t},n)=>h.jsxs(Jee,{children:[h.jsx(nT,{}),h.jsx(Uv,{ref:n,className:G("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Bb.displayName=Uv.displayName;const zb=({className:e,...t})=>h.jsx("div",{className:G("flex flex-col space-y-2 text-center sm:text-left",e),...t});zb.displayName="AlertDialogHeader";const Ub=({className:e,...t})=>h.jsx("div",{className:G("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Ub.displayName="AlertDialogFooter";const Vb=g.forwardRef(({className:e,...t},n)=>h.jsx(Vv,{ref:n,className:G("text-lg font-semibold",e),...t}));Vb.displayName=Vv.displayName;const Wb=g.forwardRef(({className:e,...t},n)=>h.jsx(Wv,{ref:n,className:G("text-sm text-muted-foreground",e),...t}));Wb.displayName=Wv.displayName;const Hb=g.forwardRef(({className:e,...t},n)=>h.jsx(Hv,{ref:n,className:G(Nu(),e),...t}));Hb.displayName=Hv.displayName;const qb=g.forwardRef(({className:e,...t},n)=>h.jsx(qv,{ref:n,className:G(Nu({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));qb.displayName=qv.displayName;const rT=uo(({id:e})=>{const{t}=Re("dialogs"),n=an(),{toast:r}=on(),{deleteSession:a,loading:o}=Uee(),i=async()=>{try{await a(e),n.hide()}catch{r({variant:"destructive",description:t("delete_session.errors.delete_failed")})}};return h.jsx(tT,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(Bb,{children:[h.jsxs(zb,{children:[h.jsx(Vb,{children:t("delete_session.title")}),h.jsx(Wb,{children:t("delete_session.description")})]}),h.jsxs(Ub,{children:[h.jsx(qb,{onClick:n.hide,children:t("delete_session.cancel")}),h.jsx(Hb,{disabled:o,onClick:i,children:t("delete_session.delete")})]})]})})});function Qee({sessions:e,currentSession:t,setCurrentSession:n}){const{t:r}=Re("sidebar"),a=es(),{sessionId:o}=$p(),[i,s]=g.useState(),c=an(zee),l=an(rT),u=g.useCallback(async()=>{try{const p=await c.show({});p&&typeof p=="string"&&a(bn("whiteboard",{sessionId:p}))}catch{}},[c,a]),d=g.useCallback((p,m)=>{p.preventDefault(),p.stopPropagation(),l.show({id:m})},[l]),f=async p=>{try{s(p.id),await n(p),a(bn("whiteboard",{sessionId:p.id}))}catch(m){Ws(m),s(void 0)}};return g.useEffect(()=>{!i||i!==(t==null?void 0:t.id)||s(void 0)},[i,t==null?void 0:t.id]),h.jsxs(Fu,{className:"group-data-[collapsible=icon]:hidden",children:[h.jsx(Bu,{children:h.jsx("div",{className:"text-sm",children:r("sessions")})}),h.jsxs(fc,{children:[h.jsx(bo,{children:h.jsx(Lee,{onClick:u,className:"w-full"})}),e.map(p=>h.jsx(bo,{className:"cursor-pointer",children:h.jsx(wo,{disabled:!!i,asChild:!0,onClick:()=>f(p),children:h.jsxs("div",{className:"flex flex-row justify-between items-center",children:[h.jsxs("div",{className:"flex gap-2",children:[p.id===i?h.jsx(me,{size:16,name:"loader",className:"animate-spin"}):o===p.id?h.jsx(me,{size:16,color:"green",name:"check"}):h.jsx(me,{size:16,name:"chevron-right"}),h.jsx("span",{children:p.name})]}),h.jsx(me,{onClick:m=>d(m,p.id),size:16,name:"trash-2",className:"!z-50"})]})})},p.id)),e!=null&&e.length?h.jsx(bo,{children:h.jsxs(wo,{className:"text-sidebar-foreground/70",children:[h.jsx(me,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}var Gee=g.createContext(void 0);si=function(e){const t=g.useContext(Gee);return e||t||"ltr"};function ete(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...m}=d,y=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>m,Object.values(m));return h.jsx(y.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,m=g.useContext(p);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,tte(a,...t)]}function tte(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}let hh,aT,Vu,mh,Zb,oT,iT,sT,cT,Kb;hh="rovingFocusGroup.onEntryFocus",aT={bubbles:!1,cancelable:!0},Vu="RovingFocusGroup",[mh,Zb,oT]=mp(Vu),[iT,fo]=ete(Vu,[oT]),[sT,cT]=iT(Vu),Kb=g.forwardRef((e,t)=>h.jsx(mh.Provider,{scope:e.__scopeRovingFocusGroup,children:h.jsx(mh.Slot,{scope:e.__scopeRovingFocusGroup,children:h.jsx(nte,{...e,ref:t})})})),Kb.displayName=Vu;var nte=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=e,f=g.useRef(null),p=kt(t,f),m=si(o),[y=null,v]=Rn({prop:i,defaultProp:s,onChange:c}),[b,w]=g.useState(!1),_=pr(l),x=Zb(n),S=g.useRef(!1),[j,E]=g.useState(0);return g.useEffect(()=>{const O=f.current;if(O)return O.addEventListener(hh,_),()=>O.removeEventListener(hh,_)},[_]),h.jsx(sT,{scope:n,orientation:r,dir:m,loop:a,currentTabStopId:y,onItemFocus:g.useCallback(O=>v(O),[v]),onItemShiftTab:g.useCallback(()=>w(!0),[]),onFocusableItemAdd:g.useCallback(()=>E(O=>O+1),[]),onFocusableItemRemove:g.useCallback(()=>E(O=>O-1),[]),children:h.jsx($e.div,{tabIndex:b||j===0?-1:0,"data-orientation":r,...d,ref:p,style:{outline:"none",...e.style},onMouseDown:_e(e.onMouseDown,()=>{S.current=!0}),onFocus:_e(e.onFocus,O=>{const P=!S.current;if(O.target===O.currentTarget&&P&&!b){const k=new CustomEvent(hh,aT);if(O.currentTarget.dispatchEvent(k),!k.defaultPrevented){const N=x().filter(T=>T.focusable),R=N.find(T=>T.active),M=N.find(T=>T.id===y),C=[R,M,...N].filter(Boolean).map(T=>T.ref.current);dT(C,u)}}S.current=!1}),onBlur:_e(e.onBlur,()=>w(!1))})})}),lT="RovingFocusGroupItem",uT=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,...i}=e,s=zt(),c=o||s,l=cT(lT,n),u=l.currentTabStopId===c,d=Zb(n),{onFocusableItemAdd:f,onFocusableItemRemove:p}=l;return g.useEffect(()=>{if(r)return f(),()=>p()},[r,f,p]),h.jsx(mh.ItemSlot,{scope:n,id:c,focusable:r,active:a,children:h.jsx($e.span,{tabIndex:u?0:-1,"data-orientation":l.orientation,...i,ref:t,onMouseDown:_e(e.onMouseDown,m=>{r?l.onItemFocus(c):m.preventDefault()}),onFocus:_e(e.onFocus,()=>l.onItemFocus(c)),onKeyDown:_e(e.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){l.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const y=ote(m,l.orientation,l.dir);if(y!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let v=d().filter(b=>b.focusable).map(b=>b.ref.current);if(y==="last")v.reverse();else if(y==="prev"||y==="next"){y==="prev"&&v.reverse();const b=v.indexOf(m.currentTarget);v=l.loop?ite(v,b+1):v.slice(b+1)}setTimeout(()=>dT(v))}})})})});uT.displayName=lT;var rte={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ate(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ote(e,t,n){const r=ate(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return rte[r]}function dT(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function ite(e,t){return e.map((n,r)=>e[(t+r)%e.length])}let yh,fT,Xb,pT,hT,mT,hc,mc,yT,gT,gi,gh,yc,Yb,Jb,Eo,vT,gc,Qb;mu=Kb,yu=uT,yh=["Enter"," "],fT=["ArrowDown","PageUp","Home"],Xb=["ArrowUp","PageDown","End"],pT=[...fT,...Xb],hT={ltr:[...yh,"ArrowRight"],rtl:[...yh,"ArrowLeft"]},mT={ltr:["ArrowLeft"],rtl:["ArrowRight"]},hc="Menu",[mc,yT,gT]=mp(hc),[gi,gh]=fr(hc,[gT,uc,fo]),yc=uc(),Yb=fo(),[Jb,Eo]=gi(hc),[vT,gc]=gi(hc),Qb=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:o,modal:i=!0}=e,s=yc(t),[c,l]=g.useState(null),u=g.useRef(!1),d=pr(o),f=si(a);return g.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),h.jsx(lh,{...s,children:h.jsx(Jb,{scope:t,open:n,onOpenChange:d,content:c,onContentChange:l,children:h.jsx(vT,{scope:t,onClose:g.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:f,modal:i,children:r})})})},Qb.displayName=hc;var ste="MenuAnchor",Gb=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=yc(n);return h.jsx(Pb,{...a,...r,ref:t})});Gb.displayName=ste;var ew="MenuPortal",[cte,bT]=gi(ew,{forceMount:void 0}),wT=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,o=Eo(ew,t);return h.jsx(cte,{scope:t,forceMount:n,children:h.jsx(Ur,{present:n||o.open,children:h.jsx(Ev,{asChild:!0,container:a,children:r})})})};wT.displayName=ew;var Mr="MenuContent",[lte,tw]=gi(Mr),xT=g.forwardRef((e,t)=>{const n=bT(Mr,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=Eo(Mr,e.__scopeMenu),i=gc(Mr,e.__scopeMenu);return h.jsx(mc.Provider,{scope:e.__scopeMenu,children:h.jsx(Ur,{present:r||o.open,children:h.jsx(mc.Slot,{scope:e.__scopeMenu,children:i.modal?h.jsx(ute,{...a,ref:t}):h.jsx(dte,{...a,ref:t})})})})}),ute=g.forwardRef((e,t)=>{const n=Eo(Mr,e.__scopeMenu),r=g.useRef(null),a=kt(t,r);return g.useEffect(()=>{const o=r.current;if(o)return vu(o)},[]),h.jsx(nw,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:_e(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),dte=g.forwardRef((e,t)=>{const n=Eo(Mr,e.__scopeMenu);return h.jsx(nw,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),nw=g.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,disableOutsideScroll:m,...y}=e,v=Eo(Mr,n),b=gc(Mr,n),w=yc(n),_=Yb(n),x=yT(n),[S,j]=g.useState(null),E=g.useRef(null),O=kt(t,E,v.onContentChange),P=g.useRef(0),k=g.useRef(""),N=g.useRef(0),R=g.useRef(null),M=g.useRef("right"),C=g.useRef(0),T=m?Jp:g.Fragment,A=m?{as:ii,allowPinchZoom:!0}:void 0,I=D=>{var W,q;const V=k.current+D,U=x().filter(Z=>!Z.disabled),B=document.activeElement,K=(W=U.find(Z=>Z.ref.current===B))==null?void 0:W.textValue,te=U.map(Z=>Z.textValue),L=Ste(te,V,K),$=(q=U.find(Z=>Z.textValue===L))==null?void 0:q.ref.current;(function Z(ee){k.current=ee,window.clearTimeout(P.current),ee!==""&&(P.current=window.setTimeout(()=>Z(""),1e3))})(V),$&&setTimeout(()=>$.focus())};g.useEffect(()=>()=>window.clearTimeout(P.current),[]),bu();const F=g.useCallback(D=>{var V,U;return M.current===((V=R.current)==null?void 0:V.side)&&Ete(D,(U=R.current)==null?void 0:U.area)},[]);return h.jsx(lte,{scope:n,searchRef:k,onItemEnter:g.useCallback(D=>{F(D)&&D.preventDefault()},[F]),onItemLeave:g.useCallback(D=>{var V;F(D)||((V=E.current)==null||V.focus(),j(null))},[F]),onTriggerLeave:g.useCallback(D=>{F(D)&&D.preventDefault()},[F]),pointerGraceTimerRef:N,onPointerGraceIntentChange:g.useCallback(D=>{R.current=D},[]),children:h.jsx(T,{...A,children:h.jsx(Vp,{asChild:!0,trapped:a,onMountAutoFocus:_e(o,D=>{var V;D.preventDefault(),(V=E.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:h.jsx(jv,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,children:h.jsx(mu,{asChild:!0,..._,dir:b.dir,orientation:"vertical",loop:r,currentTabStopId:S,onCurrentTabStopIdChange:j,onEntryFocus:_e(c,D=>{b.isUsingKeyboardRef.current||D.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(Nb,{role:"menu","aria-orientation":"vertical","data-state":FT(v.open),"data-radix-menu-content":"",dir:b.dir,...w,...y,ref:O,style:{outline:"none",...y.style},onKeyDown:_e(y.onKeyDown,D=>{const V=D.target.closest("[data-radix-menu-content]")===D.currentTarget,U=D.ctrlKey||D.altKey||D.metaKey,B=D.key.length===1;V&&(D.key==="Tab"&&D.preventDefault(),!U&&B&&I(D.key));const K=E.current;if(D.target!==K||!pT.includes(D.key))return;D.preventDefault();const te=x().filter(L=>!L.disabled).map(L=>L.ref.current);Xb.includes(D.key)&&te.reverse(),xte(te)}),onBlur:_e(e.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(P.current),k.current="")}),onPointerMove:_e(e.onPointerMove,Hu(D=>{const V=D.target,U=C.current!==D.clientX;if(D.currentTarget.contains(V)&&U){const B=D.clientX>C.current?"right":"left";M.current=B,C.current=D.clientX}}))})})})})})})});xT.displayName=Mr;var fte="MenuGroup",rw=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx($e.div,{role:"group",...r,ref:t})});rw.displayName=fte;var pte="MenuLabel",_T=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx($e.div,{...r,ref:t})});_T.displayName=pte;var vh="MenuItem",ST="menu.itemSelect",bh=g.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,o=g.useRef(null),i=gc(vh,e.__scopeMenu),s=tw(vh,e.__scopeMenu),c=kt(t,o),l=g.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const f=new CustomEvent(ST,{bubbles:!0,cancelable:!0});d.addEventListener(ST,p=>r==null?void 0:r(p),{once:!0}),YDe(d,f),f.defaultPrevented?l.current=!1:i.onClose()}};return h.jsx(jT,{...a,ref:c,disabled:n,onClick:_e(e.onClick,u),onPointerDown:d=>{var f;(f=e.onPointerDown)==null||f.call(e,d),l.current=!0},onPointerUp:_e(e.onPointerUp,d=>{var f;l.current||((f=d.currentTarget)==null||f.click())}),onKeyDown:_e(e.onKeyDown,d=>{const f=s.searchRef.current!=="";n||f&&d.key===" "||yh.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});bh.displayName=vh;var jT=g.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...o}=e,i=tw(vh,n),s=Yb(n),c=g.useRef(null),l=kt(t,c),[u,d]=g.useState(!1),[f,p]=g.useState("");return g.useEffect(()=>{const m=c.current;m&&p((m.textContent??"").trim())},[o.children]),h.jsx(mc.ItemSlot,{scope:n,disabled:r,textValue:a??f,children:h.jsx(yu,{asChild:!0,...s,focusable:!r,children:h.jsx($e.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:l,onPointerMove:_e(e.onPointerMove,Hu(m=>{r?i.onItemLeave(m):(i.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:_e(e.onPointerLeave,Hu(m=>i.onItemLeave(m))),onFocus:_e(e.onFocus,()=>d(!0)),onBlur:_e(e.onBlur,()=>d(!1))})})})}),hte="MenuCheckboxItem",ET=g.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return h.jsx(NT,{scope:e.__scopeMenu,checked:n,children:h.jsx(bh,{role:"menuitemcheckbox","aria-checked":wh(n)?"mixed":n,...a,ref:t,"data-state":iw(n),onSelect:_e(a.onSelect,()=>r==null?void 0:r(wh(n)?!0:!n),{checkForDefaultPrevented:!1})})})});ET.displayName=hte;var OT="MenuRadioGroup",[mte,yte]=gi(OT,{value:void 0,onValueChange:()=>{}}),CT=g.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,o=pr(r);return h.jsx(mte,{scope:e.__scopeMenu,value:n,onValueChange:o,children:h.jsx(rw,{...a,ref:t})})});CT.displayName=OT;var kT="MenuRadioItem",PT=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=yte(kT,e.__scopeMenu),o=n===a.value;return h.jsx(NT,{scope:e.__scopeMenu,checked:o,children:h.jsx(bh,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":iw(o),onSelect:_e(r.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,n)},{checkForDefaultPrevented:!1})})})});PT.displayName=kT;var aw="MenuItemIndicator",[NT,gte]=gi(aw,{checked:!1}),MT=g.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,o=gte(aw,n);return h.jsx(Ur,{present:r||wh(o.checked)||o.checked===!0,children:h.jsx($e.span,{...a,ref:t,"data-state":iw(o.checked)})})});MT.displayName=aw;var vte="MenuSeparator",AT=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx($e.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});AT.displayName=vte;var bte="MenuArrow",TT=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=yc(n);return h.jsx(Mb,{...a,...r,ref:t})});TT.displayName=bte;var ow="MenuSub",[wte,RT]=gi(ow),IT=e=>{const{__scopeMenu:t,children:n,open:r=!1,onOpenChange:a}=e,o=Eo(ow,t),i=yc(t),[s,c]=g.useState(null),[l,u]=g.useState(null),d=pr(a);return g.useEffect(()=>(o.open===!1&&d(!1),()=>d(!1)),[o.open,d]),h.jsx(lh,{...i,children:h.jsx(Jb,{scope:t,open:r,onOpenChange:d,content:l,onContentChange:u,children:h.jsx(wte,{scope:t,contentId:zt(),triggerId:zt(),trigger:s,onTriggerChange:c,children:n})})})};IT.displayName=ow;var Wu="MenuSubTrigger",DT=g.forwardRef((e,t)=>{const n=Eo(Wu,e.__scopeMenu),r=gc(Wu,e.__scopeMenu),a=RT(Wu,e.__scopeMenu),o=tw(Wu,e.__scopeMenu),i=g.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:c}=o,l={__scopeMenu:e.__scopeMenu},u=g.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return g.useEffect(()=>u,[u]),g.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),c(null)}},[s,c]),h.jsx(Gb,{asChild:!0,...l,children:h.jsx(jT,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":FT(n.open),...e,ref:LX(t,a.onTriggerChange),onClick:d=>{var f;(f=e.onClick)==null||f.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:_e(e.onPointerMove,Hu(d=>{o.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:_e(e.onPointerLeave,Hu(d=>{var p,m;u();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const y=(m=n.content)==null?void 0:m.dataset.side,v=y==="right",b=v?-5:5,w=f[v?"left":"right"],_=f[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+b,y:d.clientY},{x:w,y:f.top},{x:_,y:f.top},{x:_,y:f.bottom},{x:w,y:f.bottom}],side:y}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:_e(e.onKeyDown,d=>{var p;const f=o.searchRef.current!=="";e.disabled||f&&d.key===" "||hT[r.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});DT.displayName=Wu;var LT="MenuSubContent",$T=g.forwardRef((e,t)=>{const n=bT(Mr,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=Eo(Mr,e.__scopeMenu),i=gc(Mr,e.__scopeMenu),s=RT(LT,e.__scopeMenu),c=g.useRef(null),l=kt(t,c);return h.jsx(mc.Provider,{scope:e.__scopeMenu,children:h.jsx(Ur,{present:r||o.open,children:h.jsx(mc.Slot,{scope:e.__scopeMenu,children:h.jsx(nw,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:l,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;i.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:_e(e.onFocusOutside,u=>{u.target!==s.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:_e(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:_e(e.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),f=mT[i.dir].includes(u.key);d&&f&&(o.onOpenChange(!1),(p=s.trigger)==null||p.focus(),u.preventDefault())})})})})})});$T.displayName=LT;function FT(e){return e?"open":"closed"}function wh(e){return e==="indeterminate"}function iw(e){return wh(e)?"indeterminate":e?"checked":"unchecked"}function xte(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function _te(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function Ste(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=_te(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function jte(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function Ete(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return jte(n,t)}function Hu(e){return t=>t.pointerType==="mouse"?e(t):void 0}var BT=Qb,zT=Gb,UT=wT,VT=xT,WT=rw,HT=_T,qT=bh,ZT=ET,KT=CT,XT=PT,YT=MT,JT=AT,QT=TT,Ote=IT,GT=DT,eR=$T,sw="DropdownMenu",[Cte,z4e]=fr(sw,[gh]),Dn=gh(),[kte,tR]=Cte(sw),nR=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:o,onOpenChange:i,modal:s=!0}=e,c=Dn(t),l=g.useRef(null),[u=!1,d]=Rn({prop:a,defaultProp:o,onChange:i});return h.jsx(kte,{scope:t,triggerId:zt(),triggerRef:l,contentId:zt(),open:u,onOpenChange:d,onOpenToggle:g.useCallback(()=>d(f=>!f),[d]),modal:s,children:h.jsx(BT,{...c,open:u,onOpenChange:d,dir:r,modal:s,children:n})})};nR.displayName=sw;var rR="DropdownMenuTrigger",aR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,o=tR(rR,n),i=Dn(n);return h.jsx(zT,{asChild:!0,...i,children:h.jsx($e.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:LX(t,o.triggerRef),onPointerDown:_e(e.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(o.onOpenToggle(),o.open||s.preventDefault())}),onKeyDown:_e(e.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&o.onOpenToggle(),s.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});aR.displayName=rR;var Pte="DropdownMenuPortal",oR=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Dn(t);return h.jsx(UT,{...r,...n})};oR.displayName=Pte;var iR="DropdownMenuContent",sR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=tR(iR,n),o=Dn(n),i=g.useRef(!1);return h.jsx(VT,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...r,ref:t,onCloseAutoFocus:_e(e.onCloseAutoFocus,s=>{var c;i.current||((c=a.triggerRef.current)==null||c.focus()),i.current=!1,s.preventDefault()}),onInteractOutside:_e(e.onInteractOutside,s=>{const c=s.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!a.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});sR.displayName=iR;var Nte="DropdownMenuGroup",cR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(WT,{...a,...r,ref:t})});cR.displayName=Nte;var Mte="DropdownMenuLabel",lR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(HT,{...a,...r,ref:t})});lR.displayName=Mte;var Ate="DropdownMenuItem",uR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(qT,{...a,...r,ref:t})});uR.displayName=Ate;var Tte="DropdownMenuCheckboxItem",dR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(ZT,{...a,...r,ref:t})});dR.displayName=Tte;var Rte="DropdownMenuRadioGroup",fR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(KT,{...a,...r,ref:t})});fR.displayName=Rte;var Ite="DropdownMenuRadioItem",pR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(XT,{...a,...r,ref:t})});pR.displayName=Ite;var Dte="DropdownMenuItemIndicator",hR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(YT,{...a,...r,ref:t})});hR.displayName=Dte;var Lte="DropdownMenuSeparator",mR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(JT,{...a,...r,ref:t})});mR.displayName=Lte;var $te="DropdownMenuArrow",Fte=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(QT,{...a,...r,ref:t})});Fte.displayName=$te;var Bte=e=>{const{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:a,defaultOpen:o}=e,i=Dn(t),[s=!1,c]=Rn({prop:r,defaultProp:o,onChange:a});return h.jsx(Ote,{...i,open:s,onOpenChange:c,children:n})},zte="DropdownMenuSubTrigger",yR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(GT,{...a,...r,ref:t})});yR.displayName=zte;var Ute="DropdownMenuSubContent",gR=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Dn(n);return h.jsx(eR,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});gR.displayName=Ute,CN=nR,kN=aR,ON=oR,e0=sR,EN=cR,s0=lR,r0=uR,a0=dR,GX=fR,i0=pR,o0=hR,c0=mR,eY=Bte,t0=yR,n0=gR;const Vte=CN,Wte=kN,Hte=EN,qte=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(t0,{ref:a,className:G("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r,children:[n,h.jsx(me,{name:"chevron-right",className:"ml-auto"})]}));qte.displayName=t0.displayName;const Zte=g.forwardRef(({className:e,...t},n)=>h.jsx(n0,{ref:n,className:G("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Zte.displayName=n0.displayName;const vR=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(ON,{children:h.jsx(e0,{ref:r,sideOffset:t,className:G("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));vR.displayName=e0.displayName;const bR=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(r0,{ref:r,className:G("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n}));bR.displayName=r0.displayName;const Kte=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(a0,{ref:a,className:G("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(o0,{children:h.jsx(me,{name:"check",className:"h-4 w-4"})})}),t]}));Kte.displayName=a0.displayName;const Xte=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(i0,{ref:r,className:G("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(o0,{children:h.jsx(me,{name:"circle",className:"h-4 w-4"})})}),t]}));Xte.displayName=i0.displayName;const Yte=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(s0,{ref:r,className:G("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));Yte.displayName=s0.displayName;const Jte=g.forwardRef(({className:e,...t},n)=>h.jsx(c0,{ref:n,className:G("-mx-1 my-1 h-px bg-muted",e),...t}));Jte.displayName=c0.displayName;function Qte(){const{t:e}=Re("sidebar"),{isMobile:t}=$u();return h.jsx(fc,{children:h.jsx(bo,{children:h.jsxs(Vte,{children:[h.jsx(Wte,{asChild:!0,children:h.jsxs(wo,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[h.jsx("div",{children:h.jsx(me,{name:"settings",size:28,className:"pr-2"})}),h.jsx(me,{name:"chevrons-up-down",className:"ml-auto size-4"})]})}),h.jsx(vR,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:t?"bottom":"right",align:"end",sideOffset:4,children:h.jsx(Hte,{children:h.jsxs(bR,{children:[h.jsx(me,{name:"sparkles"}),e("contact")]})})})]})})})}function Gte({applications:e,currentSession:t,setCurrentSession:n}){const{t:r}=Re("sidebar"),a=es(),{applicationId:o}=$p(),[i,s]=g.useState(),c=an(rT),l=g.useCallback((f,p)=>{f.preventDefault(),f.stopPropagation(),c.show({id:p})},[c]),u=async f=>{try{s(f.id),n(f),a(bn("application",{applicationId:f.id}))}catch(p){console.error(p),s(void 0)}},d=f=>{switch(f.main_source_type){case"Thread":return h.jsx(me,{className:"inline-flex items-center ml-2",name:"message-circle-more",size:14});default:return null}};return g.useEffect(()=>{!i||i!==(t==null?void 0:t.id)||s(void 0)},[i,t==null?void 0:t.id]),h.jsxs(Fu,{className:"group-data-[collapsible=icon]:hidden pt-0",children:[h.jsx(Bu,{children:h.jsx("div",{className:"text-sm",children:r("applications")})}),h.jsxs(fc,{children:[e==null?void 0:e.map(f=>h.jsx(bo,{className:"cursor-pointer",children:h.jsx(wo,{disabled:!!i,asChild:!0,onClick:()=>u(f),children:h.jsxs("div",{className:"flex flex-row justify-between items-center !h-auto",children:[h.jsxs("div",{className:"flex gap-2",children:[f.id===i?h.jsx(me,{size:16,name:"loader",className:"animate-spin"}):o===f.id?h.jsx(me,{size:16,color:"green",name:"check"}):h.jsx(me,{size:16,name:"chevron-right"}),h.jsxs("span",{children:[f.name,d(f)]})]}),h.jsx(me,{onClick:p=>l(p,f.id),size:16,className:"!z-50",name:"trash-2"})]})})},f.id)),e?h.jsx(bo,{children:h.jsxs(wo,{className:"text-sidebar-foreground/70",children:[h.jsx(me,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}const ene={navMain:[{title:"playground.title",icon:h.jsx(me,{name:"square-terminal"}),isActive:!0,items:[{title:"playground.nodes",id:"nodes"},{title:"playground.connections",id:"connections"}]},{title:"model.title",url:"#",icon:h.jsx(me,{name:"bot"}),items:[{title:"model.llm",id:"llm"},{title:"model.embedding",id:"embedding"}]},{title:"tutorial.title",icon:h.jsx(me,{name:"book-open"}),items:[{title:"tutorial.get_started",id:"get-started"},{title:"tutorial.simple_workflow",id:"simple-workflow"},{title:"tutorial.ai_structured_output",id:"ai-structured-output"},{title:"tutorial.standalone_chat_application",id:"chat-application"},{title:"tutorial.standalone_editor_application",id:"editor-application"},{title:"tutorial.tool_calling",id:"tool-calling"},{title:"tutorial.vector_database",id:"vector-database"}]},{title:"application.title",icon:h.jsx(me,{name:"settings-2"}),items:[{title:"application.chat",id:"chat"},{title:"application.editor",id:"editor"},{title:"application.vslite",id:"vslite"}]}]};function tne({sessions:e,applications:t,currentSession:n,setCurrentSession:r,...a}){return h.jsxs(Lb,{collapsible:"offcanvas",...a,children:[h.jsx("div",{className:"h-1"}),h.jsxs(Fb,{children:[h.jsx(Qee,{sessions:e||[],currentSession:n,setCurrentSession:r}),h.jsx(Gte,{applications:t||[],currentSession:n,setCurrentSession:r}),h.jsx(Ree,{items:ene.navMain})]}),h.jsx(R2,{children:h.jsx(Qte,{})}),h.jsx(T2,{})]})}tr=g.memo(e=>{const{loading:t,...n}=e;return h.jsx(yt,{...n,disabled:e.disabled||t,children:t?h.jsx(me,{name:"loader-circle",className:"animate-spin"}):e.children})});function nne({className:e,onProcess:t=async()=>(await new Promise(a=>setTimeout(a,2e3)),Math.random()>.5),processDuration:n=2e3,...r}){const[a,o]=g.useState(!1),[i,s]=g.useState(null),[c,l]=g.useState(!1),[,u]=g.useState(0);g.useEffect(()=>{if(a){const f=Date.now(),p=setInterval(()=>{const m=(Date.now()-f)/n*100;m>=100?(clearInterval(p),u(100)):u(m)},10);return()=>clearInterval(p)}},[a,n]);async function d(){if(a)return;o(!0),s(null),u(0),await new Promise(p=>setTimeout(p,n));const f=t?await t():!0;s(f),o(!1),l(!0),setTimeout(()=>{s(null),u(0),l(!1)},2e3)}return h.jsx(yt,{className:G("relative group","transition-all duration-300",a&&"cursor-wait",e),variant:"ghost",onClick:d,disabled:a,...r,children:h.jsx("div",{className:G("w-full flex items-center justify-center gap-2",c&&"animate-[scale_300ms_ease-in-out]"),children:i===null?h.jsx(h.Fragment,{children:h.jsx(me,{name:"forward",className:G("w-4 h-4 transition-transform duration-200","group-hover:scale-110",a&&"animate-bounce")})}):i?h.jsx(h.Fragment,{children:h.jsx(me,{name:"check",className:"w-4 h-4 text-green-500"})}):h.jsx(h.Fragment,{children:h.jsx(me,{name:"x",className:"w-4 h-4 text-red-500"})})})})}const Ua="NOLLM",rne="0123456789abcdef",ane=[8,4,4,4,12];function qu(){return ane.map(e=>JDe(rne,e)()).join("-")}const one=()=>{const e=st(t=>t.currentSession);return{exportSession:g.useCallback(async()=>{if(!(e!=null&&e.id))return;const t={},n={},r=Object.keys($X).filter(c=>c!=="Session");await Promise.all(r.map(c=>he(c).find({where:{session_id:e.id}}).then(l=>{l.map(u=>{n[u.id]=u.id}),t[c]=l}))),Object.keys(n).forEach(c=>{n[c]=`[ID_${qu()}]`});let a=JSON.stringify({[Ua]:{key:e.id,session:Object.entries(e).reduce((c,[l,u])=>((typeof u!="object"||u===null)&&(c[l]=u),u===void 0&&(c[l]=null),c),{}),ids:Object.keys(n)},...t});Object.keys(n).forEach(c=>{a=a.replace(new RegExp(c,"g"),n[c])}),a=a.replace(new RegExp(e.id,"g"),"[SESSION_ID]");const o=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=`${e.name}_${new Date}.json`,s.click()},[e])}},ine=()=>{const[e,t]=g.useState(!1),n=es(),r=g.useCallback((o,{idMap:i,newSessionId:s,replaceItem:c})=>{const l=o;return{...Object.keys(l).reduce((u,d)=>(l[d]&&typeof l[d]=="string"&&i[l[d]]?u[d]=i[l[d]]:d==="session_id"&&s?u[d]=s:u[d]=l[d],u),{}),...c||{}}},[]),a=g.useCallback(async o=>{try{t(!0);const i=Object.keys($X).filter(d=>d!==Ua);if(!Object.keys(o[Ua]).length||typeof o[Ua]!="object")throw new Error("Missing Metadata");if(!("session"in o[Ua])||!o[Ua].session)throw new Error("Missing Session Metadata");const s=o[Ua].session;if(!("ids"in o[Ua]))throw new Error("Missing Session ID");const c=o[Ua].ids.reduce((d,f)=>(d[f]=qu(),d),{}),l=Object.keys(o).filter(d=>d!==Ua);if(!l.every(d=>i.includes(d)))throw new Error("Invalid JSON keys");if(!l.every(d=>Array.isArray(o[d])))throw new Error("Invalid JSON values");l.forEach(d=>{o[d].forEach(f=>{if("session_id"in f&&f.session_id!=="[SESSION_ID]")throw new Error("Invalid JSON values")})});const u=await he("Session").save(r(s,{idMap:c,newSessionId:"",replaceItem:{id:void 0}}));if(!u)throw new Error("Failed to import session");await Promise.all(i.map(d=>{const f=o[d];if(!f||!f.length)return Promise.resolve();const p=f.map(m=>r(m,{idMap:c,newSessionId:u.id}));return he(d).save(p)})),u.type===au.Whiteboard?n(bn("whiteboard",{sessionId:u.id})):u.type===au.StandaloneApp&&n(bn("application",{applicationId:u.id}))}finally{t(!1)}},[n,r]);return{loading:e,importSession:a}};function sne(){const{t:e}=Re("tooltips"),t=La(),n=ou(f=>f.setTheme),r=ou(f=>f.theme),{exportSession:a}=one(),{loading:o,importSession:i}=ine(),s=g.useRef(null),c=g.useCallback(()=>{n(r==="dark"?"light":"dark")},[r,n]),l=g.useCallback(async()=>{try{return await a(),!0}catch(f){return Ws(f),!1}},[a]),u=g.useCallback(async f=>{var p;try{const m=(p=f.target.files)==null?void 0:p[0];if(!m)return;const y=await new Promise((v,b)=>{const w=new FileReader;w.onload=_=>{var x;try{const S=(x=_.target)==null?void 0:x.result;v(JSON.parse(S))}catch(S){b(S)}},w.onerror=_=>{b(_)},w.readAsText(m)});await i(y)}catch(m){return Ws(m),!1}},[i]),d=g.useMemo(()=>{if(t.pathname.includes(bn("whiteboard")))return e("whiteboard");if(t.pathname.includes(bn("application")))return e("apllication")},[t.pathname,e]);return h.jsxs("header",{className:"flex h-14 shrink-0 items-center gap-2 transition-[width,height] ease-linear justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2 px-4",children:[h.jsx(A2,{}),h.jsx(it,{children:d})]}),h.jsx("div",{className:"flex items-center pl-4 pr-2",children:h.jsxs(Lu,{children:[h.jsxs(Ba,{children:[h.jsx(za,{children:h.jsxs(tr,{loading:o,variant:"ghost",onClick:()=>{var f;return(f=s.current)==null?void 0:f.click()},children:[h.jsx(me,{size:18,name:"import"}),h.jsx("input",{ref:s,type:"file",accept:".json",onChange:u,className:"hidden"},`${Date.now()}`)]})}),h.jsx(na,{children:h.jsx("p",{children:e("import")})})]}),h.jsxs(Ba,{children:[h.jsx(za,{children:h.jsx(nne,{onProcess:l})}),h.jsx(na,{children:h.jsx("p",{children:e("export")})})]}),h.jsxs(Ba,{children:[h.jsx(za,{children:h.jsx(yt,{disabled:o,onClick:c,variant:"ghost",children:h.jsx(me,{size:18,name:r==="dark"?"moon":"sun"})})}),h.jsx(na,{children:h.jsx("p",{children:e("theme")})})]}),h.jsxs(Ba,{children:[h.jsx(za,{children:h.jsx(yt,{variant:"link",children:h.jsx("a",{referrerPolicy:"no-referrer",target:"_blank",href:"https://github.com/zrg-team/NoLLMChat",children:h.jsx(me,{size:18,name:"github"})})})}),h.jsx(na,{children:h.jsx("p",{children:"https://github.com/zrg-team/NoLLMChat"})})]})]})})]})}function wR({requiredSession:e}){const t=$p(),n=es(),r=La(),a=g.useRef(r),o=st(l=>l.currentSession),i=st(l=>l.sessions),s=st(l=>l.applications),c=st(l=>l.setCurrentSession);return a.current=r,g.useEffect(()=>{!(o!=null&&o.id)||!e||(r.pathname.includes(bn("whiteboard"))?t.sessionId?t.sessionId&&t.sessionId!==(o==null?void 0:o.id)&&c(t.sessionId):n(bn("whiteboard",{sessionId:o==null?void 0:o.id})):r.pathname.includes(bn("application"))&&(t.applicationId?t.applicationId&&t.applicationId!==(o==null?void 0:o.id)&&c(t.applicationId):n(bn("application",{applicationId:o==null?void 0:o.id}))))},[o==null?void 0:o.id,r.pathname,n,t.applicationId,t.sessionId,e,c]),g.useEffect(()=>{e&&c(t.sessionId||t.applicationId).then(l=>{!l||Tee().has("flow")&&l.type===au.StandaloneApp||(l.type===au.StandaloneApp&&a.current.pathname.includes(bn("whiteboard").replace("/",""))?n(bn("application",{applicationId:l.id})):l.type===au.Whiteboard&&a.current.pathname.includes(bn("application").replace("/",""))&&n(bn("whiteboard",{sessionId:l.id})))})},[n,t.applicationId,t.sessionId,e,c]),h.jsxs(Db,{defaultOpen:!1,children:[h.jsx(tne,{sessions:i,applications:s,currentSession:o,setCurrentSession:c}),h.jsxs($b,{className:"max-h-screen overflow-hidden",children:[h.jsx(sne,{}),h.jsx(Xs,{className:"shrink-0"}),h.jsx("div",{className:"flex flex-1 flex-col p-0 m-0 overflow-y-auto",children:h.jsx(PJ,{})})]})]})}const xR=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx("div",{className:G("flex flex-col w-full h-full p-4 gap-6 overflow-y-auto",e),ref:r,...n,children:t}));xR.displayName="ChatMessageList";var _R="vercel.ai.error",cne=Symbol.for(_R),SR,lne=class rY extends Error{constructor({name:t,message:n,cause:r}){super(n),this[SR]=!0,this.name=t,this.cause=r}static isInstance(t){return rY.hasMarker(t,_R)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};SR=cne;var vc=lne;function jR(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var ER="AI_InvalidArgumentError",OR=`vercel.ai.error.${ER}`,une=Symbol.for(OR),CR,dne=class extends vc{constructor({message:e,cause:t,argument:n}){super({name:ER,message:e,cause:t}),this[CR]=!0,this.argument=n}static isInstance(e){return vc.hasMarker(e,OR)}};CR=une;var kR="AI_JSONParseError",PR=`vercel.ai.error.${kR}`,fne=Symbol.for(PR),NR,MR=class extends vc{constructor({text:e,cause:t}){super({name:kR,message:`JSON parsing failed: Text: ${e}.
Error message: ${jR(t)}`,cause:t}),this[NR]=!0,this.text=e}static isInstance(e){return vc.hasMarker(e,PR)}};NR=fne;var AR="AI_TypeValidationError",TR=`vercel.ai.error.${AR}`,pne=Symbol.for(TR),RR,hne=class ZN extends vc{constructor({value:t,cause:n}){super({name:AR,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${jR(n)}`,cause:n}),this[RR]=!0,this.value=t}static isInstance(t){return vc.hasMarker(t,TR)}static wrap({value:t,cause:n}){return ZN.isInstance(n)&&n.value===t?n:new ZN({value:t,cause:n})}};RR=pne;var IR=hne;let mne=(e,t=21)=>(n=t)=>{let r="",a=n;for(;a--;)r+=e[Math.random()*e.length|0];return r};var os={exports:{}},DR;function yne(){if(DR)return os.exports;DR=1;const e=typeof En<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(s,c,l){l==null&&c!==null&&typeof c=="object"&&(l=c,c=void 0),e&&En.isBuffer(s)&&(s=s.toString()),s&&s.charCodeAt(0)===65279&&(s=s.slice(1));const u=JSON.parse(s,c);if(u===null||typeof u!="object")return u;const d=l&&l.protoAction||"error",f=l&&l.constructorAction||"error";if(d==="ignore"&&f==="ignore")return u;if(d!=="ignore"&&f!=="ignore"){if(t.test(s)===!1&&n.test(s)===!1)return u}else if(d!=="ignore"&&f==="ignore"){if(t.test(s)===!1)return u}else if(n.test(s)===!1)return u;return a(u,{protoAction:d,constructorAction:f,safe:l&&l.safe})}function a(s,{protoAction:c="error",constructorAction:l="error",safe:u}={}){let d=[s];for(;d.length;){const f=d;d=[];for(const p of f){if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"__proto__")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.__proto__}if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"constructor")&&Object.prototype.hasOwnProperty.call(p.constructor,"prototype")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.constructor}for(const m in p){const y=p[m];y&&typeof y=="object"&&d.push(y)}}}return s}function o(s,c,l){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,l)}finally{Error.stackTraceLimit=u}}function i(s,c){const l=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=l}}return os.exports=o,os.exports.default=o,os.exports.parse=o,os.exports.safeParse=i,os.exports.scan=a,os.exports}var gne=yne();const vne=ft(gne);var bne=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=mne(n,t);if(e==null)return a;if(n.includes(r))throw new dne({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return o=>`${e}${r}${a(o)}`},LR=bne(),cw=Symbol.for("vercel.ai.validator");function wne(e){return{[cw]:!0,validate:e}}function xne(e){return typeof e=="object"&&e!==null&&cw in e&&e[cw]===!0&&"validate"in e}function _ne(e){return xne(e)?e:Sne(e)}function Sne(e){return wne(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function jne({value:e,schema:t}){const n=_ne(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:IR.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:IR.wrap({value:e,cause:r})}}}function $R({text:e,schema:t}){try{const n=vne.parse(e);return t==null?{success:!0,value:n}:jne({value:n,schema:t})}catch(n){return{success:!1,error:MR.isInstance(n)?n:new MR({text:e,cause:n})}}}var xh={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},_h={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Sh={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},jh={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Eh={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},Ene=[xh,_h,Sh,jh,Eh];xh.code+"",_h.code+"",Sh.code+"",jh.code+"",Eh.code+"",xh.name+"",xh.code,_h.name+"",_h.code,Sh.name+"",Sh.code,jh.name+"",jh.code,Eh.name+"",Eh.code,Ene.map(e=>e.code);function One(e){const t=["ROOT"];let n=-1,r=null;function a(c,l,u){switch(c){case'"':{n=l,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=l,r=l,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=l,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=l,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function o(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=l,t.pop();break}}}function i(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}}}for(let c=0;c<e.length;c++){const l=e[c];switch(t[t.length-1]){case"ROOT":a(l,c,"FINISH");break;case"INSIDE_OBJECT_START":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=c,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(l){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{a(l,c,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{o(l,c);break}case"INSIDE_STRING":{switch(l){case'"':{t.pop(),n=c;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=c}break}case"INSIDE_ARRAY_START":{switch(l){case"]":{n=c,t.pop();break}default:{n=c,a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}default:{n=c;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=c;break}case"INSIDE_NUMBER":{switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const u=e.substring(r,c+1);!"false".startsWith(u)&&!"true".startsWith(u)&&!"null".startsWith(u)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?o(l,c):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c)):n=c;break}}}let s=e.slice(0,n+1);for(let c=t.length-1;c>=0;c--)switch(t[c]){case"INSIDE_STRING":{s+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{s+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{s+="]";break}case"INSIDE_LITERAL":{const l=e.substring(r,e.length);"true".startsWith(l)?s+="true".slice(l.length):"false".startsWith(l)?s+="false".slice(l.length):"null".startsWith(l)&&(s+="null".slice(l.length))}}return s}function Cne(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=$R({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=$R({text:One(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var Zu={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Ku={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},Xu={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Yu={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},Ju={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},Qu={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},Gu={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},ed={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},td={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},nd={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},kne=[Zu,Ku,Xu,Yu,Ju,Qu,Gu,ed,td,nd],Pne={[Zu.code]:Zu,[Ku.code]:Ku,[Xu.code]:Xu,[Yu.code]:Yu,[Ju.code]:Ju,[Qu.code]:Qu,[Gu.code]:Gu,[ed.code]:ed,[td.code]:td,[nd.code]:nd};Zu.name+"",Zu.code,Ku.name+"",Ku.code,Xu.name+"",Xu.code,Yu.name+"",Yu.code,Ju.name+"",Ju.code,Qu.name+"",Qu.code,Gu.name+"",Gu.code,ed.name+"",ed.code,td.name+"",td.code,nd.name+"",nd.code;var Nne=kne.map(e=>e.code),Mne=e=>{const t=e.indexOf(":");if(t===-1)throw new Error("Failed to parse stream string. No separator found.");const n=e.slice(0,t);if(!Nne.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const r=n,a=e.slice(t+1),o=JSON.parse(a);return Pne[r].parse(o)},Ane=10;function Tne(e,t){const n=new Uint8Array(t);let r=0;for(const a of e)n.set(a,r),r+=a.length;return e.length=0,n}async function Rne({stream:e,onTextPart:t,onDataPart:n,onErrorPart:r,onToolCallStreamingStartPart:a,onToolCallDeltaPart:o,onToolCallPart:i,onToolResultPart:s,onMessageAnnotationsPart:c,onFinishMessagePart:l,onFinishStepPart:u}){const d=e.getReader(),f=new TextDecoder,p=[];let m=0;for(;;){const{value:y}=await d.read();if(y&&(p.push(y),m+=y.length,y[y.length-1]!==Ane))continue;if(p.length===0)break;const v=Tne(p,m);m=0;const b=f.decode(v,{stream:!0}).split(`
`).filter(w=>w!=="").map(Mne);for(const{type:w,value:_}of b)switch(w){case"text":await(t==null?void 0:t(_));break;case"data":await(n==null?void 0:n(_));break;case"error":await(r==null?void 0:r(_));break;case"message_annotations":await(c==null?void 0:c(_));break;case"tool_call_streaming_start":await(a==null?void 0:a(_));break;case"tool_call_delta":await(o==null?void 0:o(_));break;case"tool_call":await(i==null?void 0:i(_));break;case"tool_result":await(s==null?void 0:s(_));break;case"finish_message":await(l==null?void 0:l(_));break;case"finish_step":await(u==null?void 0:u(_));break;default:{const x=w;throw new Error(`Unknown stream part type: ${x}`)}}}}function Ine({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}async function Dne({stream:e,update:t,onToolCall:n,onFinish:r,generateId:a=LR,getCurrentDate:o=()=>new Date}){const i=o();let s,c=!0;const l=[],u=[];let d;const f={};let p={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},m="unknown";function y(){const b=[...u];if(s==null){t(l,b);return}d!=null&&d.length&&(s.annotations=d);const w={...JSON.parse(JSON.stringify(s)),revisionId:a()};t([...l,w],b)}function v(){return(c||s==null)&&(s!=null&&l.push(s),c=!1,s={id:a(),role:"assistant",content:"",createdAt:i}),s}await Rne({stream:e,onTextPart(b){const w=v();s={...w,content:w.content+b},y()},onToolCallStreamingStartPart(b){const w=v();w.toolInvocations==null&&(w.toolInvocations=[]),f[b.toolCallId]={text:"",toolName:b.toolName,index:w.toolInvocations.length},w.toolInvocations.push({state:"partial-call",toolCallId:b.toolCallId,toolName:b.toolName,args:void 0}),y()},onToolCallDeltaPart(b){const w=v(),_=f[b.toolCallId];_.text+=b.argsTextDelta;const{value:x}=Cne(_.text);w.toolInvocations[_.index]={state:"partial-call",toolCallId:b.toolCallId,toolName:_.toolName,args:x},y()},async onToolCallPart(b){const w=v();if(f[b.toolCallId]!=null?w.toolInvocations[f[b.toolCallId].index]={state:"call",...b}:(w.toolInvocations==null&&(w.toolInvocations=[]),w.toolInvocations.push({state:"call",...b})),n){const _=await n({toolCall:b});_!=null&&(w.toolInvocations[w.toolInvocations.length-1]={state:"result",...b,result:_})}y()},onToolResultPart(b){const w=v().toolInvocations;if(w==null)throw new Error("tool_result must be preceded by a tool_call");const _=w.findIndex(x=>x.toolCallId===b.toolCallId);if(_===-1)throw new Error("tool_result must be preceded by a tool_call with the same toolCallId");w[_]={...w[_],state:"result",...b},y()},onDataPart(b){u.push(...b),y()},onMessageAnnotationsPart(b){d==null?d=[...b]:d.push(...b),y()},onFinishStepPart(b){c=!b.isContinued},onFinishMessagePart(b){m=b.finishReason,b.usage!=null&&(p=Ine(b.usage))},onErrorPart(b){throw new Error(b)}}),r==null||r({message:s,finishReason:m,usage:p})}async function Lne({stream:e,onTextPart:t}){const n=e.pipeThrough(new TextDecoderStream).getReader();for(;;){const{done:r,value:a}=await n.read();if(r)break;await t(a)}}var $ne=()=>fetch;async function Fne({api:e,body:t,streamProtocol:n="data",credentials:r,headers:a,abortController:o,restoreMessagesOnFailure:i,onResponse:s,onUpdate:c,onFinish:l,onToolCall:u,generateId:d,fetch:f=$ne()}){var p,m;const y=await f(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",...a},signal:(p=o==null?void 0:o())==null?void 0:p.signal,credentials:r}).catch(v=>{throw i(),v});if(s)try{await s(y)}catch(v){throw v}if(!y.ok)throw i(),new Error((m=await y.text())!=null?m:"Failed to fetch the chat response.");if(!y.body)throw new Error("The response body is empty.");switch(n){case"text":{const v={id:d(),createdAt:new Date,role:"assistant",content:""};await Lne({stream:y.body,onTextPart:b=>{v.content+=b,c([{...v}],[])}}),l==null||l(v,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"});return}case"data":{await Dne({stream:y.body,update:c,onToolCall:u,onFinish({message:v,finishReason:b,usage:w}){l&&v!=null&&l(v,{usage:w,finishReason:b})},generateId:d});return}default:{const v=n;throw new Error(`Unknown stream protocol: ${v}`)}}}var FR={exports:{}},lw={},BR;function Bne(){if(BR)return lw;BR=1;var e=FX();function t(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,a=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function s(d,f){var p=f(),m=r({inst:{value:p,getSnapshot:f}}),y=m[0].inst,v=m[1];return o(function(){y.value=p,y.getSnapshot=f,c(y)&&v({inst:y})},[d,p,f]),a(function(){return c(y)&&v({inst:y}),d(function(){c(y)&&v({inst:y})})},[d]),i(p),p}function c(d){var f=d.getSnapshot;d=d.value;try{var p=f();return!n(d,p)}catch{return!0}}function l(d,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:s;return lw.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,lw}var zR;function UR(){return zR||(zR=1,FR.exports=Bne()),FR.exports}_p=UR();let Oo,Zn,Oh,ht,ra,Co,VR,rd;QX=ft(_p),Oo=()=>{},Zn=Oo(),Oh=Object,ht=e=>e===Zn,ra=e=>typeof e=="function",Co=(e,t)=>({...e,...t}),VR=e=>ra(e.then),rd=new WeakMap;let zne=0;const ad=e=>{const t=typeof e,n=e&&e.constructor,r=n==Date;let a,o;if(Oh(e)===e&&!r&&n!=RegExp){if(a=rd.get(e),a)return a;if(a=++zne+"~",rd.set(e,a),n==Array){for(a="@",o=0;o<e.length;o++)a+=ad(e[o])+",";rd.set(e,a)}if(n==Oh){a="#";const i=Oh.keys(e).sort();for(;!ht(o=i.pop());)ht(e[o])||(a+=o+":"+ad(e[o])+",");rd.set(e,a)}}else a=r?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return a},ko=new WeakMap,uw={},Ch={},dw="undefined",kh=typeof window!=dw,fw=typeof document!=dw,Une=()=>kh&&typeof window.requestAnimationFrame!=dw,WR=(e,t)=>{const n=ko.get(e);return[()=>!ht(t)&&e.get(t)||uw,r=>{if(!ht(t)){const a=e.get(t);t in Ch||(Ch[t]=a),n[5](t,Co(a,r),a||uw)}},n[6],()=>!ht(t)&&t in Ch?Ch[t]:!ht(t)&&e.get(t)||uw]};let pw=!0;const Vne=()=>pw,[hw,mw]=kh&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[Oo,Oo],Wne=()=>{const e=fw&&document.visibilityState;return ht(e)||e!=="hidden"},Hne=e=>(fw&&document.addEventListener("visibilitychange",e),hw("focus",e),()=>{fw&&document.removeEventListener("visibilitychange",e),mw("focus",e)}),qne=e=>{const t=()=>{pw=!0,e()},n=()=>{pw=!1};return hw("online",t),hw("offline",n),()=>{mw("online",t),mw("offline",n)}},Zne={isOnline:Vne,isVisible:Wne},Kne={initFocus:Hne,initReconnect:qne},HR=!Y.useId,od=!kh||"Deno"in window,Xne=e=>Une()?window.requestAnimationFrame(e):setTimeout(e,1),yw=od?g.useEffect:g.useLayoutEffect,gw=typeof navigator<"u"&&navigator.connection,qR=!od&&gw&&(["slow-2g","2g"].includes(gw.effectiveType)||gw.saveData),vw=e=>{if(ra(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?ad(e):"",[e,t]};let Yne=0;const bw=()=>++Yne,ZR=0,KR=1,XR=2;var id={__proto__:null,ERROR_REVALIDATE_EVENT:3,FOCUS_EVENT:ZR,MUTATE_EVENT:XR,RECONNECT_EVENT:KR};async function YR(...e){const[t,n,r,a]=e,o=Co({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let i=o.populateCache;const s=o.rollbackOnError;let c=o.optimisticData;const l=f=>typeof s=="function"?s(f):s!==!1,u=o.throwOnError;if(ra(n)){const f=n,p=[],m=t.keys();for(const y of m)!/^\$(inf|sub)\$/.test(y)&&f(t.get(y)._k)&&p.push(y);return Promise.all(p.map(d))}return d(n);async function d(f){const[p]=vw(f);if(!p)return;const[m,y]=WR(t,p),[v,b,w,_]=ko.get(t),x=()=>{const M=v[p];return(ra(o.revalidate)?o.revalidate(m().data,f):o.revalidate!==!1)&&(delete w[p],delete _[p],M&&M[0])?M[0](XR).then(()=>m().data):m().data};if(e.length<3)return x();let S=r,j;const E=bw();b[p]=[E,0];const O=!ht(c),P=m(),k=P.data,N=P._c,R=ht(N)?k:N;if(O&&(c=ra(c)?c(R,k):c,y({data:c,_c:R})),ra(S))try{S=S(R)}catch(M){j=M}if(S&&VR(S))if(S=await S.catch(M=>{j=M}),E!==b[p][0]){if(j)throw j;return S}else j&&O&&l(j)&&(i=!0,y({data:R,_c:Zn}));if(i&&!j)if(ra(i)){const M=i(S,R);y({data:M,error:Zn,_c:Zn})}else y({data:S,error:Zn,_c:Zn});if(b[p][1]=bw(),Promise.resolve(x()).then(()=>{y({_c:Zn})}),j){if(u)throw j;return}return S}}const JR=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},Jne=(e,t)=>{if(!ko.has(e)){const n=Co(Kne,t),r={},a=YR.bind(Zn,e);let o=Oo;const i={},s=(u,d)=>{const f=i[u]||[];return i[u]=f,f.push(d),()=>f.splice(f.indexOf(d),1)},c=(u,d,f)=>{e.set(u,d);const p=i[u];if(p)for(const m of p)m(d,f)},l=()=>{if(!ko.has(e)&&(ko.set(e,[r,{},{},{},a,c,s]),!od)){const u=n.initFocus(setTimeout.bind(Zn,JR.bind(Zn,r,ZR))),d=n.initReconnect(setTimeout.bind(Zn,JR.bind(Zn,r,KR)));o=()=>{u&&u(),d&&d(),ko.delete(e)}}};return l(),[e,a,l,o]}return[e,ko.get(e)[4]]},Qne=(e,t,n,r,a)=>{const o=n.errorRetryCount,i=a.retryCount,s=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!ht(o)&&i>o||setTimeout(r,s,a)},Gne=(e,t)=>ad(e)==ad(t),[QR,ere]=Jne(new Map),tre=Co({onLoadingSlow:Oo,onSuccess:Oo,onError:Oo,onErrorRetry:Qne,onDiscarded:Oo,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:qR?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:qR?5e3:3e3,compare:Gne,isPaused:()=>!1,cache:QR,mutate:ere,fallback:{}},Zne),nre=(e,t)=>{const n=Co(e,t);if(t){const{use:r,fallback:a}=e,{use:o,fallback:i}=t;r&&o&&(n.use=r.concat(o)),a&&i&&(n.fallback=Co(a,i))}return n},rre=g.createContext({}),are="$inf$",GR=kh&&window.__SWR_DEVTOOLS_USE__,ore=GR?window.__SWR_DEVTOOLS_USE__:[],ire=()=>{GR&&(window.__SWR_DEVTOOLS_REACT__=Y)},sre=e=>ra(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],cre=()=>Co(tre,g.useContext(rre)),lre=e=>(t,n,r)=>e(t,n&&((...a)=>{const[o]=vw(t),[,,,i]=ko.get(QR);if(o.startsWith(are))return n(...a);const s=i[o];return ht(s)?n(...a):(delete i[o],s)}),r),ure=ore.concat(lre),dre=e=>function(...t){const n=cre(),[r,a,o]=sre(t),i=nre(n,o);let s=e;const{use:c}=i,l=(c||[]).concat(ure);for(let u=l.length;u--;)s=l[u](s);return s(r,a||i.fetcher||null,i)},fre=(e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const a=r.indexOf(n);a>=0&&(r[a]=r[r.length-1],r.pop())}};ire();const eI=Y.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e)}),ww={dedupe:!0},pre=(e,t,n)=>{const{cache:r,compare:a,suspense:o,fallbackData:i,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:l,refreshWhenHidden:u,refreshWhenOffline:d,keepPreviousData:f}=n,[p,m,y,v]=ko.get(r),[b,w]=vw(e),_=g.useRef(!1),x=g.useRef(!1),S=g.useRef(b),j=g.useRef(t),E=g.useRef(n),O=()=>E.current,P=()=>O().isVisible()&&O().isOnline(),[k,N,R,M]=WR(r,b),C=g.useRef({}).current,T=ht(i)?n.fallback[b]:i,A=(H,le)=>{for(const ie in C){const pe=ie;if(pe==="data"){if(!a(H[pe],le[pe])&&(!ht(H[pe])||!a(L,le[pe])))return!1}else if(le[pe]!==H[pe])return!1}return!0},I=g.useMemo(()=>{const H=!b||!t?!1:ht(s)?O().isPaused()||o?!1:ht(c)?!0:c:s,le=Ce=>{const Ze=Co(Ce);return delete Ze._k,H?{isValidating:!0,isLoading:!0,...Ze}:Ze},ie=k(),pe=M(),Oe=le(ie),Ue=ie===pe?Oe:le(pe);let Ve=Oe;return[()=>{const Ce=le(k());return A(Ce,Ve)?(Ve.data=Ce.data,Ve.isLoading=Ce.isLoading,Ve.isValidating=Ce.isValidating,Ve.error=Ce.error,Ve):(Ve=Ce,Ce)},()=>Ue]},[r,b]),F=_p.useSyncExternalStore(g.useCallback(H=>R(b,(le,ie)=>{A(ie,le)||H()}),[r,b]),I[0],I[1]),D=!_.current,V=p[b]&&p[b].length>0,U=F.data,B=ht(U)?T:U,K=F.error,te=g.useRef(B),L=f?ht(U)?te.current:U:B,$=V&&!ht(K)?!1:D&&!ht(s)?s:O().isPaused()?!1:o?ht(B)?!1:c:ht(B)||c,W=!!(b&&t&&D&&$),q=ht(F.isValidating)?W:F.isValidating,Z=ht(F.isLoading)?W:F.isLoading,ee=g.useCallback(async H=>{const le=j.current;if(!b||!le||x.current||O().isPaused())return!1;let ie,pe,Oe=!0;const Ue=H||{},Ve=!y[b]||!Ue.dedupe,Ce=()=>HR?!x.current&&b===S.current&&_.current:b===S.current,Ze={isValidating:!1,isLoading:!1},Je=()=>{N(Ze)},Qe=()=>{const z=y[b];z&&z[1]===pe&&delete y[b]},Rt={isValidating:!0};ht(k().data)&&(Rt.isLoading=!0);try{if(Ve&&(N(Rt),n.loadingTimeout&&ht(k().data)&&setTimeout(()=>{Oe&&Ce()&&O().onLoadingSlow(b,n)},n.loadingTimeout),y[b]=[le(w),bw()]),[ie,pe]=y[b],ie=await ie,Ve&&setTimeout(Qe,n.dedupingInterval),!y[b]||y[b][1]!==pe)return Ve&&Ce()&&O().onDiscarded(b),!1;Ze.error=Zn;const z=m[b];if(!ht(z)&&(pe<=z[0]||pe<=z[1]||z[1]===0))return Je(),Ve&&Ce()&&O().onDiscarded(b),!1;const J=k().data;Ze.data=a(J,ie)?J:ie,Ve&&Ce()&&O().onSuccess(ie,b,n)}catch(z){Qe();const J=O(),{shouldRetryOnError:fe}=J;J.isPaused()||(Ze.error=z,Ve&&Ce()&&(J.onError(z,b,J),(fe===!0||ra(fe)&&fe(z))&&(!O().revalidateOnFocus||!O().revalidateOnReconnect||P())&&J.onErrorRetry(z,b,J,ve=>{const Ie=p[b];Ie&&Ie[0]&&Ie[0](id.ERROR_REVALIDATE_EVENT,ve)},{retryCount:(Ue.retryCount||0)+1,dedupe:!0})))}return Oe=!1,Je(),!0},[b,r]),oe=g.useCallback((...H)=>YR(r,S.current,...H),[]);if(yw(()=>{j.current=t,E.current=n,ht(U)||(te.current=U)}),yw(()=>{if(!b)return;const H=ee.bind(Zn,ww);let le=0;const ie=fre(b,p,(pe,Oe={})=>{if(pe==id.FOCUS_EVENT){const Ue=Date.now();O().revalidateOnFocus&&Ue>le&&P()&&(le=Ue+O().focusThrottleInterval,H())}else if(pe==id.RECONNECT_EVENT)O().revalidateOnReconnect&&P()&&H();else{if(pe==id.MUTATE_EVENT)return ee();if(pe==id.ERROR_REVALIDATE_EVENT)return ee(Oe)}});return x.current=!1,S.current=b,_.current=!0,N({_k:w}),$&&(ht(B)||od?H():Xne(H)),()=>{x.current=!0,ie()}},[b]),yw(()=>{let H;function le(){const pe=ra(l)?l(k().data):l;pe&&H!==-1&&(H=setTimeout(ie,pe))}function ie(){!k().error&&(u||O().isVisible())&&(d||O().isOnline())?ee(ww).then(le):le()}return le(),()=>{H&&(clearTimeout(H),H=-1)}},[l,u,d,b]),g.useDebugValue(L),o&&ht(B)&&b){if(!HR&&od)throw new Error("Fallback data is required when using suspense in SSR.");j.current=t,E.current=n,x.current=!1;const H=v[b];if(!ht(H)){const le=oe(H);eI(le)}if(ht(K)){const le=ee(ww);ht(L)||(le.status="fulfilled",le.value=!0),eI(le)}else throw K}return{mutate:oe,get data(){return C.data=!0,L},get error(){return C.error=!0,K},get isValidating(){return C.isValidating=!0,q},get isLoading(){return C.isLoading=!0,Z}}},Ph=dre(pre);var xw,tI;function hre(){if(tI)return xw;tI=1;function e(t,n){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let r,a=0;return function(...o){clearTimeout(r);const i=Date.now(),s=i-a,c=n-s;c<=0?(a=i,t.apply(this,o)):r=setTimeout(()=>{a=Date.now(),t.apply(this,o)},c)}}return xw=e,xw}var mre=hre();const yre=ft(mre);function nI(e,t){return t!=null?yre(e,t):e}var gre=async(e,t,n,r,a,o,i,s,c,l,u,d,f,p,m,y,v)=>{var b;const w=i.current;n(t.messages,!1);const _=p?t.messages:t.messages.map(({role:S,content:j,experimental_attachments:E,data:O,annotations:P,toolInvocations:k})=>({role:S,content:j,...E!==void 0&&{experimental_attachments:E},...O!==void 0&&{data:O},...P!==void 0&&{annotations:P},...k!==void 0&&{toolInvocations:k}})),x=a.current;return await Fne({api:e,body:(b=m==null?void 0:m({messages:t.messages,requestData:t.data,requestBody:t.body}))!=null?b:{messages:_,data:t.data,...o.current.body,...t.body},streamProtocol:l,credentials:o.current.credentials,headers:{...o.current.headers,...t.headers},abortController:()=>s.current,restoreMessagesOnFailure(){v||n(w,!1)},onResponse:d,onUpdate(S,j){n([...t.messages,...S],!1),j!=null&&j.length&&r([...x??[],...j],!1)},onToolCall:f,onFinish:u,generateId:c,fetch:y})};function vre({api:e="/api/chat",id:t,initialMessages:n,initialInput:r="",sendExtraMessageFields:a,onToolCall:o,experimental_prepareRequestBody:i,maxSteps:s=1,streamProtocol:c="data",onResponse:l,onFinish:u,onError:d,credentials:f,headers:p,body:m,generateId:y=LR,fetch:v,keepLastMessageOnError:b=!0,experimental_throttle:w}={}){const _=g.useId(),x=t??_,S=typeof e=="string"?[e,x]:x,[j]=g.useState([]),{data:E,mutate:O}=Ph([S,"messages"],null,{fallbackData:n??j}),P=g.useRef(E||[]);g.useEffect(()=>{P.current=E||[]},[E]);const{data:k,mutate:N}=Ph([S,"streamData"],null),R=g.useRef(k);g.useEffect(()=>{R.current=k},[k]);const{data:M=!1,mutate:C}=Ph([S,"loading"],null),{data:T=void 0,mutate:A}=Ph([S,"error"],null),I=g.useRef(null),F=g.useRef({credentials:f,headers:p,body:m});g.useEffect(()=>{F.current={credentials:f,headers:p,body:m}},[f,p,m]);const D=g.useCallback(async q=>{const Z=P.current.length;try{C(!0),A(void 0);const H=new AbortController;I.current=H,await gre(e,q,nI(O,w),nI(N,w),R,F,P,I,y,c,u,l,o,a,i,v,b),I.current=null}catch(H){if(H.name==="AbortError")return I.current=null,null;d&&H instanceof Error&&d(H),A(H)}finally{C(!1)}const ee=P.current,oe=ee[ee.length-1];ee.length>Z&&oe!=null&&s>1&&rI(oe)&&bre(ee)<s&&await D({messages:ee})},[O,C,e,F,l,u,d,A,N,R,c,a,i,o,s,P,I,y,v,b,w]),V=g.useCallback(async(q,{data:Z,headers:ee,body:oe,experimental_attachments:H}={})=>{var le,ie;q.id||(q.id=y());const pe=await aI(H),Oe=P.current.concat({...q,id:(le=q.id)!=null?le:y(),createdAt:(ie=q.createdAt)!=null?ie:new Date,experimental_attachments:pe.length>0?pe:void 0});return D({messages:Oe,headers:ee,body:oe,data:Z})},[D,y]),U=g.useCallback(async({data:q,headers:Z,body:ee}={})=>{const oe=P.current;if(oe.length===0)return null;const H=oe[oe.length-1];return D({messages:H.role==="assistant"?oe.slice(0,-1):oe,headers:Z,body:ee,data:q})},[D]),B=g.useCallback(()=>{I.current&&(I.current.abort(),I.current=null)},[]),K=g.useCallback(q=>{typeof q=="function"&&(q=q(P.current)),O(q,!1),P.current=q},[O]),te=g.useCallback(q=>{typeof q=="function"&&(q=q(R.current)),N(q,!1),R.current=q},[N]),[L,$]=g.useState(r),W=g.useCallback(async(q,Z={},ee)=>{var oe;if((oe=q==null?void 0:q.preventDefault)==null||oe.call(q),!L&&!Z.allowEmptySubmit)return;ee&&(F.current={...F.current,...ee});const H=await aI(Z.experimental_attachments),le={messages:!L&&!H.length&&Z.allowEmptySubmit?P.current:P.current.concat({id:y(),createdAt:new Date,role:"user",content:L,experimental_attachments:H.length>0?H:void 0}),headers:Z.headers,body:Z.body,data:Z.data};D(le),$("")},[L,y,D]);return{messages:E||[],setMessages:K,data:k,setData:te,error:T,append:V,reload:U,stop:B,input:L,setInput:$,handleInputChange:q=>{$(q.target.value)},handleSubmit:W,isLoading:M,addToolResult:({toolCallId:q,result:Z})=>{const ee=P.current.map((H,le,ie)=>le===ie.length-1&&H.role==="assistant"&&H.toolInvocations?{...H,toolInvocations:H.toolInvocations.map(pe=>pe.toolCallId===q?{...pe,result:Z,state:"result"}:pe)}:H);O(ee,!1);const oe=ee[ee.length-1];rI(oe)&&D({messages:ee})}}}function rI(e){return e.role==="assistant"&&e.toolInvocations&&e.toolInvocations.length>0&&e.toolInvocations.every(t=>"result"in t)}function bre(e){let t=0;for(let n=e.length-1;n>=0&&e[n].role==="assistant";n--)t++;return t}async function aI(e){if(e==null)return[];if(e instanceof FileList)return Promise.all(Array.from(e).map(async t=>{const{name:n,type:r}=t,a=await new Promise((o,i)=>{const s=new FileReader;s.onload=c=>{var l;o((l=c.target)==null?void 0:l.result)},s.onerror=c=>i(c),s.readAsDataURL(t)});return{name:n,contentType:r,url:a}}));if(Array.isArray(e))return e;throw new Error("Invalid attachments type")}gN=vre;const Va=g.forwardRef(({className:e,...t},n)=>h.jsx("textarea",{className:G("flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));Va.displayName="Textarea";function wre({minHeight:e,maxHeight:t}){const n=g.useRef(null),r=g.useCallback(a=>{const o=n.current;if(!o)return;if(a){o.style.height=`${e}px`;return}o.style.height=`${e}px`;const i=Math.max(e,Math.min(o.scrollHeight,t??Number.POSITIVE_INFINITY));o.style.height=`${i}px`},[e,t]);return g.useEffect(()=>{const a=n.current;a&&(a.style.height=`${e}px`)},[e]),g.useEffect(()=>{const a=()=>r();return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[r]),{textareaRef:n,adjustHeight:r}}const xre=48,oI=164;g0=function({onSubmit:e,disabled:t,enableTool:n,enableFile:r,placeholder:a,minHeight:o,maxHeight:i,className:s,height:c,onChange:l,value:u}){const[d,f]=g.useState(!1),[p,m]=g.useState(""),{textareaRef:y,adjustHeight:v}=wre({minHeight:o||xre,maxHeight:i||oI}),[b,w]=g.useState(!0),_=g.useCallback(async S=>{try{f(!0),await e(p,S)&&m("")}finally{f(!1)}},[p,e]),x=g.useMemo(()=>({maxHeight:`${i||oI}px`,...c?{height:`${c}px`}:{}}),[i,c]);return h.jsx("div",{className:G("w-full py-4 max-w-xl",s),children:h.jsx("div",{className:"relative w-full mx-auto",children:h.jsxs("div",{className:"relative flex flex-col",children:[h.jsx("div",{className:"overflow-y-auto",style:x,children:h.jsx(Va,{id:"ai-input-04",value:(l?u:p)||"",disabled:t||d,placeholder:a,className:"w-full rounded-xl rounded-b-none px-4 py-3 bg-black/5 dark:bg-white/5 border-none dark:text-white placeholder:text-black/70 dark:placeholder:text-white/70 resize-none focus-visible:ring-0 leading-[1.2]",ref:y,onKeyDown:S=>{S.key==="Enter"&&!S.shiftKey&&(S.preventDefault(),_(S))},onChange:S=>{l||m(S.target.value),v(),l==null||l(S)}})}),h.jsxs("div",{className:"h-12 bg-black/5 dark:bg-white/5 rounded-b-xl",children:[h.jsxs("div",{className:"absolute left-3 bottom-3 flex items-center gap-2",children:[r?h.jsxs("label",{className:"cursor-pointer rounded-lg p-2 bg-black/5 dark:bg-white/5",children:[h.jsx("input",{type:"file",className:"hidden"}),h.jsx(me,{name:"paperclip",className:"w-4 h-4 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white transition-colors"})]}):void 0,n?h.jsxs("button",{type:"button",onClick:()=>{w(!b)},className:G("rounded-full transition-all flex items-center gap-2 px-1.5 py-1 border h-8",b?"bg-sky-500/15 border-sky-400 text-sky-500":"bg-black/5 dark:bg-white/5 border-transparent text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:[h.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:h.jsx(hp.div,{animate:{rotate:b?180:0,scale:b?1.1:1},whileHover:{rotate:b?180:15,scale:1.1,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:h.jsx(me,{name:"globe",className:G("w-4 h-4",b?"text-sky-500":"text-inherit")})})}),h.jsx(iY,{children:b&&h.jsx(hp.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-sm overflow-hidden whitespace-nowrap text-sky-500 flex-shrink-0",children:"Search"})})]}):void 0]}),h.jsx("div",{className:"absolute right-3 bottom-3",children:h.jsx("button",{type:"button",disabled:t||d,onClick:S=>{_(S)},className:G("rounded-lg p-2",l&&u||p?"bg-sky-500/15 text-sky-500":"bg-black/5 dark:bg-white/5 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:h.jsx(me,{name:"send",className:"w-4 h-4"})})})]})]})})})};var _w,iI;function _re(){if(iI)return _w;iI=1;function e(){this.__data__=[],this.size=0}return _w=e,_w}var Sw,sI;fu=function(){if(sI)return Sw;sI=1;function e(t,n){return t===n||t!==t&&n!==n}return Sw=e,Sw};var jw,cI;function Nh(){if(cI)return jw;cI=1;var e=fu();function t(n,r){for(var a=n.length;a--;)if(e(n[a][0],r))return a;return-1}return jw=t,jw}var Ew,lI;function Sre(){if(lI)return Ew;lI=1;var e=Nh(),t=Array.prototype,n=t.splice;function r(a){var o=this.__data__,i=e(o,a);if(i<0)return!1;var s=o.length-1;return i==s?o.pop():n.call(o,i,1),--this.size,!0}return Ew=r,Ew}var Ow,uI;function jre(){if(uI)return Ow;uI=1;var e=Nh();function t(n){var r=this.__data__,a=e(r,n);return a<0?void 0:r[a][1]}return Ow=t,Ow}var Cw,dI;function Ere(){if(dI)return Cw;dI=1;var e=Nh();function t(n){return e(this.__data__,n)>-1}return Cw=t,Cw}var kw,fI;function Ore(){if(fI)return kw;fI=1;var e=Nh();function t(n,r){var a=this.__data__,o=e(a,n);return o<0?(++this.size,a.push([n,r])):a[o][1]=r,this}return kw=t,kw}var Pw,pI;function Mh(){if(pI)return Pw;pI=1;var e=_re(),t=Sre(),n=jre(),r=Ere(),a=Ore();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,Pw=o,Pw}var Nw,hI;function Cre(){if(hI)return Nw;hI=1;var e=Mh();function t(){this.__data__=new e,this.size=0}return Nw=t,Nw}var Mw,mI;function kre(){if(mI)return Mw;mI=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return Mw=e,Mw}var Aw,yI;function Pre(){if(yI)return Aw;yI=1;function e(t){return this.__data__.get(t)}return Aw=e,Aw}var Tw,gI;function Nre(){if(gI)return Tw;gI=1;function e(t){return this.__data__.has(t)}return Tw=e,Tw}var Rw,vI;function bI(){if(vI)return Rw;vI=1;var e=typeof iu=="object"&&iu&&iu.Object===Object&&iu;return Rw=e,Rw}var Iw,wI;Kr=function(){if(wI)return Iw;wI=1;var e=bI(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return Iw=n,Iw};var Dw,xI;Js=function(){if(xI)return Dw;xI=1;var e=Kr(),t=e.Symbol;return Dw=t,Dw};var Lw,_I;function Mre(){if(_I)return Lw;_I=1;var e=Js(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,a=e?e.toStringTag:void 0;function o(i){var s=n.call(i,a),c=i[a];try{i[a]=void 0;var l=!0}catch{}var u=r.call(i);return l&&(s?i[a]=c:delete i[a]),u}return Lw=o,Lw}var $w,SI;function Are(){if(SI)return $w;SI=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return $w=n,$w}var Fw,jI;function Po(){if(jI)return Fw;jI=1;var e=Js(),t=Mre(),n=Are(),r="[object Null]",a="[object Undefined]",o=e?e.toStringTag:void 0;function i(s){return s==null?s===void 0?a:r:o&&o in Object(s)?t(s):n(s)}return Fw=i,Fw}var Bw,EI;Xr=function(){if(EI)return Bw;EI=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Bw=e,Bw};var zw,OI;xp=function(){if(OI)return zw;OI=1;var e=Po(),t=Xr(),n="[object AsyncFunction]",r="[object Function]",a="[object GeneratorFunction]",o="[object Proxy]";function i(s){if(!t(s))return!1;var c=e(s);return c==r||c==a||c==n||c==o}return zw=i,zw};var Uw,CI;function Tre(){if(CI)return Uw;CI=1;var e=Kr(),t=e["__core-js_shared__"];return Uw=t,Uw}var Vw,kI;function Rre(){if(kI)return Vw;kI=1;var e=Tre(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return Vw=n,Vw}var Ww,PI;function NI(){if(PI)return Ww;PI=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return Ww=n,Ww}var Hw,MI;function Ire(){if(MI)return Hw;MI=1;var e=xp(),t=Rre(),n=Xr(),r=NI(),a=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,i=Function.prototype,s=Object.prototype,c=i.toString,l=s.hasOwnProperty,u=RegExp("^"+c.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(f){if(!n(f)||t(f))return!1;var p=e(f)?u:o;return p.test(r(f))}return Hw=d,Hw}var qw,AI;function Dre(){if(AI)return qw;AI=1;function e(t,n){return t==null?void 0:t[n]}return qw=e,qw}var Zw,TI;function is(){if(TI)return Zw;TI=1;var e=Ire(),t=Dre();function n(r,a){var o=t(r,a);return e(o)?o:void 0}return Zw=n,Zw}var Kw,RI;function Xw(){if(RI)return Kw;RI=1;var e=is(),t=Kr(),n=e(t,"Map");return Kw=n,Kw}var Yw,II;function Ah(){if(II)return Yw;II=1;var e=is(),t=e(Object,"create");return Yw=t,Yw}var Jw,DI;function Lre(){if(DI)return Jw;DI=1;var e=Ah();function t(){this.__data__=e?e(null):{},this.size=0}return Jw=t,Jw}var Qw,LI;function $re(){if(LI)return Qw;LI=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return Qw=e,Qw}var Gw,$I;function Fre(){if($I)return Gw;$I=1;var e=Ah(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function a(o){var i=this.__data__;if(e){var s=i[o];return s===t?void 0:s}return r.call(i,o)?i[o]:void 0}return Gw=a,Gw}var ex,FI;function Bre(){if(FI)return ex;FI=1;var e=Ah(),t=Object.prototype,n=t.hasOwnProperty;function r(a){var o=this.__data__;return e?o[a]!==void 0:n.call(o,a)}return ex=r,ex}var tx,BI;function zre(){if(BI)return tx;BI=1;var e=Ah(),t="__lodash_hash_undefined__";function n(r,a){var o=this.__data__;return this.size+=this.has(r)?0:1,o[r]=e&&a===void 0?t:a,this}return tx=n,tx}var nx,zI;function Ure(){if(zI)return nx;zI=1;var e=Lre(),t=$re(),n=Fre(),r=Bre(),a=zre();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,nx=o,nx}var rx,UI;function Vre(){if(UI)return rx;UI=1;var e=Ure(),t=Mh(),n=Xw();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return rx=r,rx}var ax,VI;function Wre(){if(VI)return ax;VI=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return ax=e,ax}var ox,WI;function Th(){if(WI)return ox;WI=1;var e=Wre();function t(n,r){var a=n.__data__;return e(r)?a[typeof r=="string"?"string":"hash"]:a.map}return ox=t,ox}var ix,HI;function Hre(){if(HI)return ix;HI=1;var e=Th();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return ix=t,ix}var sx,qI;function qre(){if(qI)return sx;qI=1;var e=Th();function t(n){return e(this,n).get(n)}return sx=t,sx}var cx,ZI;function Zre(){if(ZI)return cx;ZI=1;var e=Th();function t(n){return e(this,n).has(n)}return cx=t,cx}var lx,KI;function Kre(){if(KI)return lx;KI=1;var e=Th();function t(n,r){var a=e(this,n),o=a.size;return a.set(n,r),this.size+=a.size==o?0:1,this}return lx=t,lx}var ux,XI;function dx(){if(XI)return ux;XI=1;var e=Vre(),t=Hre(),n=qre(),r=Zre(),a=Kre();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,ux=o,ux}var fx,YI;function Xre(){if(YI)return fx;YI=1;var e=Mh(),t=Xw(),n=dx(),r=200;function a(o,i){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<r-1)return c.push([o,i]),this.size=++s.size,this;s=this.__data__=new n(c)}return s.set(o,i),this.size=s.size,this}return fx=a,fx}var px,JI;k0=function(){if(JI)return px;JI=1;var e=Mh(),t=Cre(),n=kre(),r=Pre(),a=Nre(),o=Xre();function i(s){var c=this.__data__=new e(s);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=a,i.prototype.set=o,px=i,px};var hx,QI;function Yre(){if(QI)return hx;QI=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return hx=t,hx}var mx,GI;function Jre(){if(GI)return mx;GI=1;function e(t){return this.__data__.has(t)}return mx=e,mx}var yx,eD;function tD(){if(eD)return yx;eD=1;var e=dx(),t=Yre(),n=Jre();function r(a){var o=-1,i=a==null?0:a.length;for(this.__data__=new e;++o<i;)this.add(a[o])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,yx=r,yx}var gx,nD;function rD(){if(nD)return gx;nD=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(n(t[r],r,t))return!0;return!1}return gx=e,gx}var vx,aD;function oD(){if(aD)return vx;aD=1;function e(t,n){return t.has(n)}return vx=e,vx}var bx,iD;function sD(){if(iD)return bx;iD=1;var e=tD(),t=rD(),n=oD(),r=1,a=2;function o(i,s,c,l,u,d){var f=c&r,p=i.length,m=s.length;if(p!=m&&!(f&&m>p))return!1;var y=d.get(i),v=d.get(s);if(y&&v)return y==s&&v==i;var b=-1,w=!0,_=c&a?new e:void 0;for(d.set(i,s),d.set(s,i);++b<p;){var x=i[b],S=s[b];if(l)var j=f?l(S,x,b,s,i,d):l(x,S,b,i,s,d);if(j!==void 0){if(j)continue;w=!1;break}if(_){if(!t(s,function(E,O){if(!n(_,O)&&(x===E||u(x,E,c,l,d)))return _.push(O)})){w=!1;break}}else if(!(x===S||u(x,S,c,l,d))){w=!1;break}}return d.delete(i),d.delete(s),w}return bx=o,bx}var wx,cD;BN=function(){if(cD)return wx;cD=1;var e=Kr(),t=e.Uint8Array;return wx=t,wx};var xx,lD;function Qre(){if(lD)return xx;lD=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a,o){r[++n]=[o,a]}),r}return xx=e,xx}var _x,uD;function Sx(){if(uD)return _x;uD=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a){r[++n]=a}),r}return _x=e,_x}var jx,dD;function Gre(){if(dD)return jx;dD=1;var e=Js(),t=BN(),n=fu(),r=sD(),a=Qre(),o=Sx(),i=1,s=2,c="[object Boolean]",l="[object Date]",u="[object Error]",d="[object Map]",f="[object Number]",p="[object RegExp]",m="[object Set]",y="[object String]",v="[object Symbol]",b="[object ArrayBuffer]",w="[object DataView]",_=e?e.prototype:void 0,x=_?_.valueOf:void 0;function S(j,E,O,P,k,N,R){switch(O){case w:if(j.byteLength!=E.byteLength||j.byteOffset!=E.byteOffset)return!1;j=j.buffer,E=E.buffer;case b:return!(j.byteLength!=E.byteLength||!N(new t(j),new t(E)));case c:case l:case f:return n(+j,+E);case u:return j.name==E.name&&j.message==E.message;case p:case y:return j==E+"";case d:var M=a;case m:var C=P&i;if(M||(M=o),j.size!=E.size&&!C)return!1;var T=R.get(j);if(T)return T==E;P|=s,R.set(j,E);var A=r(M(j),M(E),P,k,N,R);return R.delete(j),A;case v:if(x)return x.call(j)==x.call(E)}return!1}return jx=S,jx}var Ex,fD;function Ox(){if(fD)return Ex;fD=1;function e(t,n){for(var r=-1,a=n.length,o=t.length;++r<a;)t[o+r]=n[r];return t}return Ex=e,Ex}var Cx,pD;qn=function(){if(pD)return Cx;pD=1;var e=Array.isArray;return Cx=e,Cx};var kx,hD;function mD(){if(hD)return kx;hD=1;var e=Ox(),t=qn();function n(r,a,o){var i=a(r);return t(r)?i:e(i,o(r))}return kx=n,kx}var Px,yD;function eae(){if(yD)return Px;yD=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=0,i=[];++r<a;){var s=t[r];n(s,r,t)&&(i[o++]=s)}return i}return Px=e,Px}var Nx,gD;function vD(){if(gD)return Nx;gD=1;function e(){return[]}return Nx=e,Nx}var Mx,bD;j0=function(){if(bD)return Mx;bD=1;var e=eae(),t=vD(),n=Object.prototype,r=n.propertyIsEnumerable,a=Object.getOwnPropertySymbols,o=a?function(i){return i==null?[]:(i=Object(i),e(a(i),function(s){return r.call(i,s)}))}:t;return Mx=o,Mx};var Ax,wD;function tae(){if(wD)return Ax;wD=1;function e(t,n){for(var r=-1,a=Array(t);++r<t;)a[r]=n(r);return a}return Ax=e,Ax}var Tx,xD;Ia=function(){if(xD)return Tx;xD=1;function e(t){return t!=null&&typeof t=="object"}return Tx=e,Tx};var Rx,_D;function nae(){if(_D)return Rx;_D=1;var e=Po(),t=Ia(),n="[object Arguments]";function r(a){return t(a)&&e(a)==n}return Rx=r,Rx}var Ix,SD;wp=function(){if(SD)return Ix;SD=1;var e=nae(),t=Ia(),n=Object.prototype,r=n.hasOwnProperty,a=n.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(i){return t(i)&&r.call(i,"callee")&&!a.call(i,"callee")};return Ix=o,Ix};var Rh={exports:{}},Dx,jD;function rae(){if(jD)return Dx;jD=1;function e(){return!1}return Dx=e,Dx}Rh.exports;var ED;P0=function(){return ED||(ED=1,function(e,t){var n=Kr(),r=rae(),a=t&&!t.nodeType&&t,o=a&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===a,s=i?n.Buffer:void 0,c=s?s.isBuffer:void 0,l=c||r;e.exports=l}(Rh,Rh.exports)),Rh.exports};var Lx,OD;function Ih(){if(OD)return Lx;OD=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,a){var o=typeof r;return a=a??e,!!a&&(o=="number"||o!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<a}return Lx=n,Lx}var $x,CD;function Fx(){if(CD)return $x;CD=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return $x=t,$x}var Bx,kD;function aae(){if(kD)return Bx;kD=1;var e=Po(),t=Fx(),n=Ia(),r="[object Arguments]",a="[object Array]",o="[object Boolean]",i="[object Date]",s="[object Error]",c="[object Function]",l="[object Map]",u="[object Number]",d="[object Object]",f="[object RegExp]",p="[object Set]",m="[object String]",y="[object WeakMap]",v="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",S="[object Int16Array]",j="[object Int32Array]",E="[object Uint8Array]",O="[object Uint8ClampedArray]",P="[object Uint16Array]",k="[object Uint32Array]",N={};N[w]=N[_]=N[x]=N[S]=N[j]=N[E]=N[O]=N[P]=N[k]=!0,N[r]=N[a]=N[v]=N[o]=N[b]=N[i]=N[s]=N[c]=N[l]=N[u]=N[d]=N[f]=N[p]=N[m]=N[y]=!1;function R(M){return n(M)&&t(M.length)&&!!N[e(M)]}return Bx=R,Bx}var zx,PD;C0=function(){if(PD)return zx;PD=1;function e(t){return function(n){return t(n)}}return zx=e,zx};var Dh={exports:{}};Dh.exports;var ND;UN=function(){return ND||(ND=1,function(e,t){var n=bI(),r=t&&!t.nodeType&&t,a=r&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===r,i=o&&n.process,s=function(){try{var c=a&&a.require&&a.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=s}(Dh,Dh.exports)),Dh.exports};var Ux,MD;Mv=function(){if(MD)return Ux;MD=1;var e=aae(),t=C0(),n=UN(),r=n&&n.isTypedArray,a=r?t(r):e;return Ux=a,Ux};var Vx,AD;function TD(){if(AD)return Vx;AD=1;var e=tae(),t=wp(),n=qn(),r=P0(),a=Ih(),o=Mv(),i=Object.prototype,s=i.hasOwnProperty;function c(l,u){var d=n(l),f=!d&&t(l),p=!d&&!f&&r(l),m=!d&&!f&&!p&&o(l),y=d||f||p||m,v=y?e(l.length,String):[],b=v.length;for(var w in l)(u||s.call(l,w))&&!(y&&(w=="length"||p&&(w=="offset"||w=="parent")||m&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||a(w,b)))&&v.push(w);return v}return Vx=c,Vx}var Wx,RD;O0=function(){if(RD)return Wx;RD=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,a=typeof r=="function"&&r.prototype||e;return n===a}return Wx=t,Wx};var Hx,ID;function DD(){if(ID)return Hx;ID=1;function e(t,n){return function(r){return t(n(r))}}return Hx=e,Hx}var qx,LD;function oae(){if(LD)return qx;LD=1;var e=DD(),t=e(Object.keys,Object);return qx=t,qx}var Zx,$D;function iae(){if($D)return Zx;$D=1;var e=O0(),t=oae(),n=Object.prototype,r=n.hasOwnProperty;function a(o){if(!e(o))return t(o);var i=[];for(var s in Object(o))r.call(o,s)&&s!="constructor"&&i.push(s);return i}return Zx=a,Zx}var Kx,FD;Zi=function(){if(FD)return Kx;FD=1;var e=xp(),t=Fx();function n(r){return r!=null&&t(r.length)&&!e(r)}return Kx=n,Kx};var Xx,BD;gu=function(){if(BD)return Xx;BD=1;var e=TD(),t=iae(),n=Zi();function r(a){return n(a)?e(a):t(a)}return Xx=r,Xx};var Yx,zD;VN=function(){if(zD)return Yx;zD=1;var e=mD(),t=j0(),n=gu();function r(a){return e(a,n,t)}return Yx=r,Yx};var Jx,UD;function sae(){if(UD)return Jx;UD=1;var e=VN(),t=1,n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s,c,l,u){var d=s&t,f=e(o),p=f.length,m=e(i),y=m.length;if(p!=y&&!d)return!1;for(var v=p;v--;){var b=f[v];if(!(d?b in i:r.call(i,b)))return!1}var w=u.get(o),_=u.get(i);if(w&&_)return w==i&&_==o;var x=!0;u.set(o,i),u.set(i,o);for(var S=d;++v<p;){b=f[v];var j=o[b],E=i[b];if(c)var O=d?c(E,j,b,i,o,u):c(j,E,b,o,i,u);if(!(O===void 0?j===E||l(j,E,s,c,u):O)){x=!1;break}S||(S=b=="constructor")}if(x&&!S){var P=o.constructor,k=i.constructor;P!=k&&"constructor"in o&&"constructor"in i&&!(typeof P=="function"&&P instanceof P&&typeof k=="function"&&k instanceof k)&&(x=!1)}return u.delete(o),u.delete(i),x}return Jx=a,Jx}var Qx,VD;function cae(){if(VD)return Qx;VD=1;var e=is(),t=Kr(),n=e(t,"DataView");return Qx=n,Qx}var Gx,WD;function lae(){if(WD)return Gx;WD=1;var e=is(),t=Kr(),n=e(t,"Promise");return Gx=n,Gx}var e1,HD;function qD(){if(HD)return e1;HD=1;var e=is(),t=Kr(),n=e(t,"Set");return e1=n,e1}var t1,ZD;function uae(){if(ZD)return t1;ZD=1;var e=is(),t=Kr(),n=e(t,"WeakMap");return t1=n,t1}var n1,KD;zN=function(){if(KD)return n1;KD=1;var e=cae(),t=Xw(),n=lae(),r=qD(),a=uae(),o=Po(),i=NI(),s="[object Map]",c="[object Object]",l="[object Promise]",u="[object Set]",d="[object WeakMap]",f="[object DataView]",p=i(e),m=i(t),y=i(n),v=i(r),b=i(a),w=o;return(e&&w(new e(new ArrayBuffer(1)))!=f||t&&w(new t)!=s||n&&w(n.resolve())!=l||r&&w(new r)!=u||a&&w(new a)!=d)&&(w=function(_){var x=o(_),S=x==c?_.constructor:void 0,j=S?i(S):"";if(j)switch(j){case p:return f;case m:return s;case y:return l;case v:return u;case b:return d}return x}),n1=w,n1};var r1,XD;function dae(){if(XD)return r1;XD=1;var e=k0(),t=sD(),n=Gre(),r=sae(),a=zN(),o=qn(),i=P0(),s=Mv(),c=1,l="[object Arguments]",u="[object Array]",d="[object Object]",f=Object.prototype,p=f.hasOwnProperty;function m(y,v,b,w,_,x){var S=o(y),j=o(v),E=S?u:a(y),O=j?u:a(v);E=E==l?d:E,O=O==l?d:O;var P=E==d,k=O==d,N=E==O;if(N&&i(y)){if(!i(v))return!1;S=!0,P=!1}if(N&&!P)return x||(x=new e),S||s(y)?t(y,v,b,w,_,x):n(y,v,E,b,w,_,x);if(!(b&c)){var R=P&&p.call(y,"__wrapped__"),M=k&&p.call(v,"__wrapped__");if(R||M){var C=R?y.value():y,T=M?v.value():v;return x||(x=new e),_(C,T,b,w,x)}}return N?(x||(x=new e),r(y,v,b,w,_,x)):!1}return r1=m,r1}var a1,YD;function o1(){if(YD)return a1;YD=1;var e=dae(),t=Ia();function n(r,a,o,i,s){return r===a?!0:r==null||a==null||!t(r)&&!t(a)?r!==r&&a!==a:e(r,a,o,i,n,s)}return a1=n,a1}var i1,JD;function fae(){if(JD)return i1;JD=1;var e=k0(),t=o1(),n=1,r=2;function a(o,i,s,c){var l=s.length,u=l,d=!c;if(o==null)return!u;for(o=Object(o);l--;){var f=s[l];if(d&&f[2]?f[1]!==o[f[0]]:!(f[0]in o))return!1}for(;++l<u;){f=s[l];var p=f[0],m=o[p],y=f[1];if(d&&f[2]){if(m===void 0&&!(p in o))return!1}else{var v=new e;if(c)var b=c(m,y,p,o,i,v);if(!(b===void 0?t(y,m,n|r,c,v):b))return!1}}return!0}return i1=a,i1}var s1,QD;function GD(){if(QD)return s1;QD=1;var e=Xr();function t(n){return n===n&&!e(n)}return s1=t,s1}var c1,e4;function pae(){if(e4)return c1;e4=1;var e=GD(),t=gu();function n(r){for(var a=t(r),o=a.length;o--;){var i=a[o],s=r[i];a[o]=[i,s,e(s)]}return a}return c1=n,c1}var l1,t4;function n4(){if(t4)return l1;t4=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return l1=e,l1}var u1,r4;function hae(){if(r4)return u1;r4=1;var e=fae(),t=pae(),n=n4();function r(a){var o=t(a);return o.length==1&&o[0][2]?n(o[0][0],o[0][1]):function(i){return i===a||e(i,a,o)}}return u1=r,u1}var d1,a4;function bc(){if(a4)return d1;a4=1;var e=Po(),t=Ia(),n="[object Symbol]";function r(a){return typeof a=="symbol"||t(a)&&e(a)==n}return d1=r,d1}var f1,o4;function p1(){if(o4)return f1;o4=1;var e=qn(),t=bc(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function a(o,i){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:r.test(o)||!n.test(o)||i!=null&&o in Object(i)}return f1=a,f1}var h1,i4;function s4(){if(i4)return h1;i4=1;var e=dx(),t="Expected a function";function n(r,a){if(typeof r!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var o=function(){var i=arguments,s=a?a.apply(this,i):i[0],c=o.cache;if(c.has(s))return c.get(s);var l=r.apply(this,i);return o.cache=c.set(s,l)||c,l};return o.cache=new(n.Cache||e),o}return n.Cache=e,h1=n,h1}var m1,c4;function mae(){if(c4)return m1;c4=1;var e=s4(),t=500;function n(r){var a=e(r,function(i){return o.size===t&&o.clear(),i}),o=a.cache;return a}return m1=n,m1}var y1,l4;function yae(){if(l4)return y1;l4=1;var e=mae(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(a){var o=[];return a.charCodeAt(0)===46&&o.push(""),a.replace(t,function(i,s,c,l){o.push(c?l.replace(n,"$1"):s||i)}),o});return y1=r,y1}var g1,u4;du=function(){if(u4)return g1;u4=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=Array(a);++r<a;)o[r]=n(t[r],r,t);return o}return g1=e,g1};var v1,d4;function gae(){if(d4)return v1;d4=1;var e=Js(),t=du(),n=qn(),r=bc(),a=1/0,o=e?e.prototype:void 0,i=o?o.toString:void 0;function s(c){if(typeof c=="string")return c;if(n(c))return t(c,s)+"";if(r(c))return i?i.call(c):"";var l=c+"";return l=="0"&&1/c==-a?"-0":l}return v1=s,v1}var b1,f4;function p4(){if(f4)return b1;f4=1;var e=gae();function t(n){return n==null?"":e(n)}return b1=t,b1}var w1,h4;xu=function(){if(h4)return w1;h4=1;var e=qn(),t=p1(),n=yae(),r=p4();function a(o,i){return e(o)?o:t(o,i)?[o]:n(r(o))}return w1=a,w1};var x1,m4;Qs=function(){if(m4)return x1;m4=1;var e=bc(),t=1/0;function n(r){if(typeof r=="string"||e(r))return r;var a=r+"";return a=="0"&&1/r==-t?"-0":a}return x1=n,x1};var _1,y4;wu=function(){if(y4)return _1;y4=1;var e=xu(),t=Qs();function n(r,a){a=e(a,r);for(var o=0,i=a.length;r!=null&&o<i;)r=r[t(a[o++])];return o&&o==i?r:void 0}return _1=n,_1};var S1,g4;function v4(){if(g4)return S1;g4=1;var e=wu();function t(n,r,a){var o=n==null?void 0:e(n,r);return o===void 0?a:o}return S1=t,S1}var j1,b4;function vae(){if(b4)return j1;b4=1;function e(t,n){return t!=null&&n in Object(t)}return j1=e,j1}var E1,w4;function bae(){if(w4)return E1;w4=1;var e=xu(),t=wp(),n=qn(),r=Ih(),a=Fx(),o=Qs();function i(s,c,l){c=e(c,s);for(var u=-1,d=c.length,f=!1;++u<d;){var p=o(c[u]);if(!(f=s!=null&&l(s,p)))break;s=s[p]}return f||++u!=d?f:(d=s==null?0:s.length,!!d&&a(d)&&r(p,d)&&(n(s)||t(s)))}return E1=i,E1}var O1,x4;lN=function(){if(x4)return O1;x4=1;var e=vae(),t=bae();function n(r,a){return r!=null&&t(r,a,e)}return O1=n,O1};var C1,_4;function wae(){if(_4)return C1;_4=1;var e=o1(),t=v4(),n=lN(),r=p1(),a=GD(),o=n4(),i=Qs(),s=1,c=2;function l(u,d){return r(u)&&a(d)?o(i(u),d):function(f){var p=t(f,u);return p===void 0&&p===d?n(f,u):e(d,p,s|c)}}return C1=l,C1}var k1,S4;function wc(){if(S4)return k1;S4=1;function e(t){return t}return k1=e,k1}var P1,j4;function xae(){if(j4)return P1;j4=1;function e(t){return function(n){return n==null?void 0:n[t]}}return P1=e,P1}var N1,E4;function _ae(){if(E4)return N1;E4=1;var e=wu();function t(n){return function(r){return e(r,n)}}return N1=t,N1}var M1,O4;function Sae(){if(O4)return M1;O4=1;var e=xae(),t=_ae(),n=p1(),r=Qs();function a(o){return n(o)?e(r(o)):t(o)}return M1=a,M1}var A1,C4;function Wa(){if(C4)return A1;C4=1;var e=hae(),t=wae(),n=wc(),r=qn(),a=Sae();function o(i){return typeof i=="function"?i:i==null?n:typeof i=="object"?r(i)?t(i[0],i[1]):e(i):a(i)}return A1=o,A1}var T1,k4;function jae(){if(k4)return T1;k4=1;var e="Expected a function";function t(n){if(typeof n!="function")throw new TypeError(e);return function(){var r=arguments;switch(r.length){case 0:return!n.call(this);case 1:return!n.call(this,r[0]);case 2:return!n.call(this,r[0],r[1]);case 3:return!n.call(this,r[0],r[1],r[2])}return!n.apply(this,r)}}return T1=t,T1}var R1,P4;function N4(){if(P4)return R1;P4=1;var e=is(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return R1=t,R1}var I1,M4;Rv=function(){if(M4)return I1;M4=1;var e=N4();function t(n,r,a){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[r]=a}return I1=t,I1};var D1,A4;WN=function(){if(A4)return D1;A4=1;var e=Rv(),t=fu(),n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s){var c=o[i];(!(r.call(o,i)&&t(c,s))||s===void 0&&!(i in o))&&e(o,i,s)}return D1=a,D1};var L1,T4;function Eae(){if(T4)return L1;T4=1;var e=WN(),t=xu(),n=Ih(),r=Xr(),a=Qs();function o(i,s,c,l){if(!r(i))return i;s=t(s,i);for(var u=-1,d=s.length,f=d-1,p=i;p!=null&&++u<d;){var m=a(s[u]),y=c;if(m==="__proto__"||m==="constructor"||m==="prototype")return i;if(u!=f){var v=p[m];y=l?l(v,m,p):void 0,y===void 0&&(y=r(v)?v:n(s[u+1])?[]:{})}e(p,m,y),p=p[m]}return i}return L1=o,L1}var $1,R4;cN=function(){if(R4)return $1;R4=1;var e=wu(),t=Eae(),n=xu();function r(a,o,i){for(var s=-1,c=o.length,l={};++s<c;){var u=o[s],d=e(a,u);i(d,u)&&t(l,n(u,a),d)}return l}return $1=r,$1};var F1,I4;E0=function(){if(I4)return F1;I4=1;var e=DD(),t=e(Object.getPrototypeOf,Object);return F1=t,F1};var B1,D4;FN=function(){if(D4)return B1;D4=1;var e=Ox(),t=E0(),n=j0(),r=vD(),a=Object.getOwnPropertySymbols,o=a?function(i){for(var s=[];i;)e(s,n(i)),i=t(i);return s}:r;return B1=o,B1};var z1,L4;function Oae(){if(L4)return z1;L4=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return z1=e,z1}var U1,$4;function Cae(){if($4)return U1;$4=1;var e=Xr(),t=O0(),n=Oae(),r=Object.prototype,a=r.hasOwnProperty;function o(i){if(!e(i))return n(i);var s=t(i),c=[];for(var l in i)l=="constructor"&&(s||!a.call(i,l))||c.push(l);return c}return U1=o,U1}var V1,F4;$N=function(){if(F4)return V1;F4=1;var e=TD(),t=Cae(),n=Zi();function r(a){return n(a)?e(a,!0):t(a)}return V1=r,V1};var W1,B4;HN=function(){if(B4)return W1;B4=1;var e=mD(),t=FN(),n=$N();function r(a){return e(a,n,t)}return W1=r,W1};var H1,z4;function kae(){if(z4)return H1;z4=1;var e=du(),t=Wa(),n=cN(),r=HN();function a(o,i){if(o==null)return{};var s=e(r(o),function(c){return[c]});return i=t(i),n(o,s,function(c,l){return i(c,l[0])})}return H1=a,H1}var q1,U4;function Pae(){if(U4)return q1;U4=1;var e=Wa(),t=jae(),n=kae();function r(a,o){return n(a,t(e(o)))}return q1=r,q1}var Nae=Pae();const sd=ft(Nae);var Z1,V4;function Mae(){if(V4)return Z1;V4=1;function e(t){return t===void 0}return Z1=e,Z1}var Aae=Mae();const cd=ft(Aae);function sn(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=sn(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Tae={value:()=>{}};function Lh(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new $h(n)}function $h(e){this._=e}function Rae(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}$h.prototype=Lh.prototype={constructor:$h,on:function(e,t){var n=this._,r=Rae(e+"",n),a,o=-1,i=r.length;if(arguments.length<2){for(;++o<i;)if((a=(e=r[o]).type)&&(a=Iae(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<i;)if(a=(e=r[o]).type)n[a]=W4(n[a],e.name,t);else if(t==null)for(a in n)n[a]=W4(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new $h(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,o;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,a=o.length;r<a;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,o=r.length;a<o;++a)r[a].value.apply(t,n)}};function Iae(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function W4(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=Tae,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var K1="http://www.w3.org/1999/xhtml";const H4={svg:"http://www.w3.org/2000/svg",xhtml:K1,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Fh(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),H4.hasOwnProperty(t)?{space:H4[t],local:e}:e}function Dae(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===K1&&t.documentElement.namespaceURI===K1?t.createElement(e):t.createElementNS(n,e)}}function Lae(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function q4(e){var t=Fh(e);return(t.local?Lae:Dae)(t)}function $ae(){}function X1(e){return e==null?$ae:function(){return this.querySelector(e)}}function Fae(e){typeof e!="function"&&(e=X1(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=new Array(i),c,l,u=0;u<i;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),s[u]=l);return new br(r,this._parents)}function Bae(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function zae(){return[]}function Z4(e){return e==null?zae:function(){return this.querySelectorAll(e)}}function Uae(e){return function(){return Bae(e.apply(this,arguments))}}function Vae(e){typeof e=="function"?e=Uae(e):e=Z4(e);for(var t=this._groups,n=t.length,r=[],a=[],o=0;o<n;++o)for(var i=t[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),a.push(c));return new br(r,a)}function K4(e){return function(){return this.matches(e)}}function X4(e){return function(t){return t.matches(e)}}var Wae=Array.prototype.find;function Hae(e){return function(){return Wae.call(this.children,e)}}function qae(){return this.firstElementChild}function Zae(e){return this.select(e==null?qae:Hae(typeof e=="function"?e:X4(e)))}var Kae=Array.prototype.filter;function Xae(){return Array.from(this.children)}function Yae(e){return function(){return Kae.call(this.children,e)}}function Jae(e){return this.selectAll(e==null?Xae:Yae(typeof e=="function"?e:X4(e)))}function Qae(e){typeof e!="function"&&(e=K4(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new br(r,this._parents)}function Y4(e){return new Array(e.length)}function Gae(){return new br(this._enter||this._groups.map(Y4),this._parents)}function Bh(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Bh.prototype={constructor:Bh,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function eoe(e){return function(){return e}}function toe(e,t,n,r,a,o){for(var i=0,s,c=t.length,l=o.length;i<l;++i)(s=t[i])?(s.__data__=o[i],r[i]=s):n[i]=new Bh(e,o[i]);for(;i<c;++i)(s=t[i])&&(a[i]=s)}function noe(e,t,n,r,a,o,i){var s,c,l=new Map,u=t.length,d=o.length,f=new Array(u),p;for(s=0;s<u;++s)(c=t[s])&&(f[s]=p=i.call(c,c.__data__,s,t)+"",l.has(p)?a[s]=c:l.set(p,c));for(s=0;s<d;++s)p=i.call(e,o[s],s,o)+"",(c=l.get(p))?(r[s]=c,c.__data__=o[s],l.delete(p)):n[s]=new Bh(e,o[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(f[s])===c&&(a[s]=c)}function roe(e){return e.__data__}function aoe(e,t){if(!arguments.length)return Array.from(this,roe);var n=t?noe:toe,r=this._parents,a=this._groups;typeof e!="function"&&(e=eoe(e));for(var o=a.length,i=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],d=a[l],f=d.length,p=ooe(e.call(u,u&&u.__data__,l,r)),m=p.length,y=s[l]=new Array(m),v=i[l]=new Array(m),b=c[l]=new Array(f);n(u,d,y,v,b,p,t);for(var w=0,_=0,x,S;w<m;++w)if(x=y[w]){for(w>=_&&(_=w+1);!(S=v[_])&&++_<m;);x._next=S||null}}return i=new br(i,r),i._enter=s,i._exit=c,i}function ooe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ioe(){return new br(this._exit||this._groups.map(Y4),this._parents)}function soe(e,t,n){var r=this.enter(),a=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?o.remove():n(o),r&&a?r.merge(a).order():a}function coe(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,o=r.length,i=Math.min(a,o),s=new Array(a),c=0;c<i;++c)for(var l=n[c],u=r[c],d=l.length,f=s[c]=new Array(d),p,m=0;m<d;++m)(p=l[m]||u[m])&&(f[m]=p);for(;c<a;++c)s[c]=n[c];return new br(s,this._parents)}function loe(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,o=r[a],i;--a>=0;)(i=r[a])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function uoe(e){e||(e=doe);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,a=new Array(r),o=0;o<r;++o){for(var i=n[o],s=i.length,c=a[o]=new Array(s),l,u=0;u<s;++u)(l=i[u])&&(c[u]=l);c.sort(t)}return new br(a,this._parents).order()}function doe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function foe(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function poe(){return Array.from(this)}function hoe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length;a<o;++a){var i=r[a];if(i)return i}return null}function moe(){let e=0;for(const t of this)++e;return e}function yoe(){return!this.node()}function goe(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],o=0,i=a.length,s;o<i;++o)(s=a[o])&&e.call(s,s.__data__,o,a);return this}function voe(e){return function(){this.removeAttribute(e)}}function boe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function woe(e,t){return function(){this.setAttribute(e,t)}}function xoe(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function _oe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Soe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function joe(e,t){var n=Fh(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?boe:voe:typeof t=="function"?n.local?Soe:_oe:n.local?xoe:woe)(n,t))}function J4(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Eoe(e){return function(){this.style.removeProperty(e)}}function Ooe(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Coe(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function koe(e,t,n){return arguments.length>1?this.each((t==null?Eoe:typeof t=="function"?Coe:Ooe)(e,t,n??"")):xc(this.node(),e)}function xc(e,t){return e.style.getPropertyValue(t)||J4(e).getComputedStyle(e,null).getPropertyValue(t)}function Poe(e){return function(){delete this[e]}}function Noe(e,t){return function(){this[e]=t}}function Moe(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Aoe(e,t){return arguments.length>1?this.each((t==null?Poe:typeof t=="function"?Moe:Noe)(e,t)):this.node()[e]}function Q4(e){return e.trim().split(/^|\s+/)}function Y1(e){return e.classList||new G4(e)}function G4(e){this._node=e,this._names=Q4(e.getAttribute("class")||"")}G4.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function e3(e,t){for(var n=Y1(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function t3(e,t){for(var n=Y1(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function Toe(e){return function(){e3(this,e)}}function Roe(e){return function(){t3(this,e)}}function Ioe(e,t){return function(){(t.apply(this,arguments)?e3:t3)(this,e)}}function Doe(e,t){var n=Q4(e+"");if(arguments.length<2){for(var r=Y1(this.node()),a=-1,o=n.length;++a<o;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?Ioe:t?Toe:Roe)(n,t))}function Loe(){this.textContent=""}function $oe(e){return function(){this.textContent=e}}function Foe(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Boe(e){return arguments.length?this.each(e==null?Loe:(typeof e=="function"?Foe:$oe)(e)):this.node().textContent}function zoe(){this.innerHTML=""}function Uoe(e){return function(){this.innerHTML=e}}function Voe(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Woe(e){return arguments.length?this.each(e==null?zoe:(typeof e=="function"?Voe:Uoe)(e)):this.node().innerHTML}function Hoe(){this.nextSibling&&this.parentNode.appendChild(this)}function qoe(){return this.each(Hoe)}function Zoe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Koe(){return this.each(Zoe)}function Xoe(e){var t=typeof e=="function"?e:q4(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Yoe(){return null}function Joe(e,t){var n=typeof e=="function"?e:q4(e),r=t==null?Yoe:typeof t=="function"?t:X1(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Qoe(){var e=this.parentNode;e&&e.removeChild(this)}function Goe(){return this.each(Qoe)}function eie(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function tie(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function nie(e){return this.select(e?tie:eie)}function rie(e){return arguments.length?this.property("__data__",e):this.node().__data__}function aie(e){return function(t){e.call(this,t,this.__data__)}}function oie(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function iie(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,o;n<a;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function sie(e,t,n){return function(){var r=this.__on,a,o=aie(t);if(r){for(var i=0,s=r.length;i<s;++i)if((a=r[i]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=o,a.options=n),a.value=t;return}}this.addEventListener(e.type,o,n),a={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(a):this.__on=[a]}}function cie(e,t,n){var r=oie(e+""),a,o=r.length,i;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(a=0,u=s[c];a<o;++a)if((i=r[a]).type===u.type&&i.name===u.name)return u.value}return}for(s=t?sie:iie,a=0;a<o;++a)this.each(s(r[a],t,n));return this}function n3(e,t,n){var r=J4(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function lie(e,t){return function(){return n3(this,e,t)}}function uie(e,t){return function(){return n3(this,e,t.apply(this,arguments))}}function die(e,t){return this.each((typeof t=="function"?uie:lie)(e,t))}function*fie(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length,i;a<o;++a)(i=r[a])&&(yield i)}var r3=[null];function br(e,t){this._groups=e,this._parents=t}function ld(){return new br([[document.documentElement]],r3)}function pie(){return this}br.prototype=ld.prototype={constructor:br,select:Fae,selectAll:Vae,selectChild:Zae,selectChildren:Jae,filter:Qae,data:aoe,enter:Gae,exit:ioe,join:soe,merge:coe,selection:pie,order:loe,sort:uoe,call:foe,nodes:poe,node:hoe,size:moe,empty:yoe,each:goe,attr:joe,style:koe,property:Aoe,classed:Doe,text:Boe,html:Woe,raise:qoe,lower:Koe,append:Xoe,insert:Joe,remove:Goe,clone:nie,datum:rie,on:cie,dispatch:die,[Symbol.iterator]:fie};function wr(e){return typeof e=="string"?new br([[document.querySelector(e)]],[document.documentElement]):new br([[e]],r3)}function hie(e){let t;for(;t=e.sourceEvent;)e=t;return e}function aa(e,t){if(e=hie(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const mie={passive:!1},ud={capture:!0,passive:!1};function J1(e){e.stopImmediatePropagation()}function _c(e){e.preventDefault(),e.stopImmediatePropagation()}function a3(e){var t=e.document.documentElement,n=wr(e).on("dragstart.drag",_c,ud);"onselectstart"in t?n.on("selectstart.drag",_c,ud):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function o3(e,t){var n=e.document.documentElement,r=wr(e).on("dragstart.drag",null);t&&(r.on("click.drag",_c,ud),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const zh=e=>()=>e;function Q1(e,{sourceEvent:t,subject:n,target:r,identifier:a,active:o,x:i,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}Q1.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function yie(e){return!e.ctrlKey&&!e.button}function gie(){return this.parentNode}function vie(e,t){return t??{x:e.x,y:e.y}}function bie(){return navigator.maxTouchPoints||"ontouchstart"in this}function i3(){var e=yie,t=gie,n=vie,r=bie,a={},o=Lh("start","drag","end"),i=0,s,c,l,u,d=0;function f(x){x.on("mousedown.drag",p).filter(r).on("touchstart.drag",v).on("touchmove.drag",b,mie).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(x,S){if(!(u||!e.call(this,x,S))){var j=_(this,t.call(this,x,S),x,S,"mouse");j&&(wr(x.view).on("mousemove.drag",m,ud).on("mouseup.drag",y,ud),a3(x.view),J1(x),l=!1,s=x.clientX,c=x.clientY,j("start",x))}}function m(x){if(_c(x),!l){var S=x.clientX-s,j=x.clientY-c;l=S*S+j*j>d}a.mouse("drag",x)}function y(x){wr(x.view).on("mousemove.drag mouseup.drag",null),o3(x.view,l),_c(x),a.mouse("end",x)}function v(x,S){if(e.call(this,x,S)){var j=x.changedTouches,E=t.call(this,x,S),O=j.length,P,k;for(P=0;P<O;++P)(k=_(this,E,x,S,j[P].identifier,j[P]))&&(J1(x),k("start",x,j[P]))}}function b(x){var S=x.changedTouches,j=S.length,E,O;for(E=0;E<j;++E)(O=a[S[E].identifier])&&(_c(x),O("drag",x,S[E]))}function w(x){var S=x.changedTouches,j=S.length,E,O;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),E=0;E<j;++E)(O=a[S[E].identifier])&&(J1(x),O("end",x,S[E]))}function _(x,S,j,E,O,P){var k=o.copy(),N=aa(P||j,S),R,M,C;if((C=n.call(x,new Q1("beforestart",{sourceEvent:j,target:f,identifier:O,active:i,x:N[0],y:N[1],dx:0,dy:0,dispatch:k}),E))!=null)return R=C.x-N[0]||0,M=C.y-N[1]||0,function T(A,I,F){var D=N,V;switch(A){case"start":a[O]=T,V=i++;break;case"end":delete a[O],--i;case"drag":N=aa(F||I,S),V=i;break}k.call(A,x,new Q1(A,{sourceEvent:I,subject:C,target:f,identifier:O,active:V,x:N[0]+R,y:N[1]+M,dx:N[0]-D[0],dy:N[1]-D[1],dispatch:k}),E)}}return f.filter=function(x){return arguments.length?(e=typeof x=="function"?x:zh(!!x),f):e},f.container=function(x){return arguments.length?(t=typeof x=="function"?x:zh(x),f):t},f.subject=function(x){return arguments.length?(n=typeof x=="function"?x:zh(x),f):n},f.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:zh(!!x),f):r},f.on=function(){var x=o.on.apply(o,arguments);return x===o?f:x},f.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,f):Math.sqrt(d)},f}function G1(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function s3(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function dd(){}var fd=.7,Uh=1/fd,Sc="\\s*([+-]?\\d+)\\s*",pd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ha="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wie=/^#([0-9a-f]{3,8})$/,xie=new RegExp(`^rgb\\(${Sc},${Sc},${Sc}\\)$`),_ie=new RegExp(`^rgb\\(${Ha},${Ha},${Ha}\\)$`),Sie=new RegExp(`^rgba\\(${Sc},${Sc},${Sc},${pd}\\)$`),jie=new RegExp(`^rgba\\(${Ha},${Ha},${Ha},${pd}\\)$`),Eie=new RegExp(`^hsl\\(${pd},${Ha},${Ha}\\)$`),Oie=new RegExp(`^hsla\\(${pd},${Ha},${Ha},${pd}\\)$`),c3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};G1(dd,ss,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:l3,formatHex:l3,formatHex8:Cie,formatHsl:kie,formatRgb:u3,toString:u3});function l3(){return this.rgb().formatHex()}function Cie(){return this.rgb().formatHex8()}function kie(){return m3(this).formatHsl()}function u3(){return this.rgb().formatRgb()}function ss(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=wie.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?d3(t):n===3?new nr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Vh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Vh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=xie.exec(e))?new nr(t[1],t[2],t[3],1):(t=_ie.exec(e))?new nr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Sie.exec(e))?Vh(t[1],t[2],t[3],t[4]):(t=jie.exec(e))?Vh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Eie.exec(e))?h3(t[1],t[2]/100,t[3]/100,1):(t=Oie.exec(e))?h3(t[1],t[2]/100,t[3]/100,t[4]):c3.hasOwnProperty(e)?d3(c3[e]):e==="transparent"?new nr(NaN,NaN,NaN,0):null}function d3(e){return new nr(e>>16&255,e>>8&255,e&255,1)}function Vh(e,t,n,r){return r<=0&&(e=t=n=NaN),new nr(e,t,n,r)}function Pie(e){return e instanceof dd||(e=ss(e)),e?(e=e.rgb(),new nr(e.r,e.g,e.b,e.opacity)):new nr}function e_(e,t,n,r){return arguments.length===1?Pie(e):new nr(e,t,n,r??1)}function nr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}G1(nr,e_,s3(dd,{brighter(e){return e=e==null?Uh:Math.pow(Uh,e),new nr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?fd:Math.pow(fd,e),new nr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new nr(cs(this.r),cs(this.g),cs(this.b),Wh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:f3,formatHex:f3,formatHex8:Nie,formatRgb:p3,toString:p3}));function f3(){return`#${ls(this.r)}${ls(this.g)}${ls(this.b)}`}function Nie(){return`#${ls(this.r)}${ls(this.g)}${ls(this.b)}${ls((isNaN(this.opacity)?1:this.opacity)*255)}`}function p3(){const e=Wh(this.opacity);return`${e===1?"rgb(":"rgba("}${cs(this.r)}, ${cs(this.g)}, ${cs(this.b)}${e===1?")":`, ${e})`}`}function Wh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function cs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ls(e){return e=cs(e),(e<16?"0":"")+e.toString(16)}function h3(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new oa(e,t,n,r)}function m3(e){if(e instanceof oa)return new oa(e.h,e.s,e.l,e.opacity);if(e instanceof dd||(e=ss(e)),!e)return new oa;if(e instanceof oa)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,s=o-a,c=(o+a)/2;return s?(t===o?i=(n-r)/s+(n<r)*6:n===o?i=(r-t)/s+2:i=(t-n)/s+4,s/=c<.5?o+a:2-o-a,i*=60):s=c>0&&c<1?0:i,new oa(i,s,c,e.opacity)}function Mie(e,t,n,r){return arguments.length===1?m3(e):new oa(e,t,n,r??1)}function oa(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}G1(oa,Mie,s3(dd,{brighter(e){return e=e==null?Uh:Math.pow(Uh,e),new oa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?fd:Math.pow(fd,e),new oa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new nr(t_(e>=240?e-240:e+120,a,r),t_(e,a,r),t_(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new oa(y3(this.h),Hh(this.s),Hh(this.l),Wh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Wh(this.opacity);return`${e===1?"hsl(":"hsla("}${y3(this.h)}, ${Hh(this.s)*100}%, ${Hh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function y3(e){return e=(e||0)%360,e<0?e+360:e}function Hh(e){return Math.max(0,Math.min(1,e||0))}function t_(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const n_=e=>()=>e;function Aie(e,t){return function(n){return e+n*t}}function Tie(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Rie(e){return(e=+e)==1?g3:function(t,n){return n-t?Tie(t,n,e):n_(isNaN(t)?n:t)}}function g3(e,t){var n=t-e;return n?Aie(e,n):n_(isNaN(e)?t:e)}const qh=function e(t){var n=Rie(t);function r(a,o){var i=n((a=e_(a)).r,(o=e_(o)).r),s=n(a.g,o.g),c=n(a.b,o.b),l=g3(a.opacity,o.opacity);return function(u){return a.r=i(u),a.g=s(u),a.b=c(u),a.opacity=l(u),a+""}}return r.gamma=e,r}(1);function Iie(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(o){for(a=0;a<n;++a)r[a]=e[a]*(1-o)+t[a]*o;return r}}function Die(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Lie(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),o=new Array(n),i;for(i=0;i<r;++i)a[i]=jc(e[i],t[i]);for(;i<n;++i)o[i]=t[i];return function(s){for(i=0;i<r;++i)o[i]=a[i](s);return o}}function $ie(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ia(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Fie(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=jc(e[a],t[a]):r[a]=t[a];return function(o){for(a in n)r[a]=n[a](o);return r}}var r_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,a_=new RegExp(r_.source,"g");function Bie(e){return function(){return e}}function zie(e){return function(t){return e(t)+""}}function v3(e,t){var n=r_.lastIndex=a_.lastIndex=0,r,a,o,i=-1,s=[],c=[];for(e=e+"",t=t+"";(r=r_.exec(e))&&(a=a_.exec(t));)(o=a.index)>n&&(o=t.slice(n,o),s[i]?s[i]+=o:s[++i]=o),(r=r[0])===(a=a[0])?s[i]?s[i]+=a:s[++i]=a:(s[++i]=null,c.push({i,x:ia(r,a)})),n=a_.lastIndex;return n<t.length&&(o=t.slice(n),s[i]?s[i]+=o:s[++i]=o),s.length<2?c[0]?zie(c[0].x):Bie(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)s[(d=c[u]).i]=d.x(l);return s.join("")})}function jc(e,t){var n=typeof t,r;return t==null||n==="boolean"?n_(t):(n==="number"?ia:n==="string"?(r=ss(t))?(t=r,qh):v3:t instanceof ss?qh:t instanceof Date?$ie:Die(t)?Iie:Array.isArray(t)?Lie:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Fie:ia)(e,t)}function o_(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var b3=180/Math.PI,w3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function x3(e,t,n,r,a,o){var i,s,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:a,translateY:o,rotate:Math.atan2(t,e)*b3,skewX:Math.atan(c)*b3,scaleX:i,scaleY:s}}var Zh;function Uie(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?w3:x3(t.a,t.b,t.c,t.d,t.e,t.f)}function Vie(e){return e==null||(Zh||(Zh=document.createElementNS("http://www.w3.org/2000/svg","g")),Zh.setAttribute("transform",e),!(e=Zh.transform.baseVal.consolidate()))?w3:(e=e.matrix,x3(e.a,e.b,e.c,e.d,e.e,e.f))}function _3(e,t,n,r){function a(l){return l.length?l.pop()+" ":""}function o(l,u,d,f,p,m){if(l!==d||u!==f){var y=p.push("translate(",null,t,null,n);m.push({i:y-4,x:ia(l,d)},{i:y-2,x:ia(u,f)})}else(d||f)&&p.push("translate("+d+t+f+n)}function i(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(a(d)+"rotate(",null,r)-2,x:ia(l,u)})):u&&d.push(a(d)+"rotate("+u+r)}function s(l,u,d,f){l!==u?f.push({i:d.push(a(d)+"skewX(",null,r)-2,x:ia(l,u)}):u&&d.push(a(d)+"skewX("+u+r)}function c(l,u,d,f,p,m){if(l!==d||u!==f){var y=p.push(a(p)+"scale(",null,",",null,")");m.push({i:y-4,x:ia(l,d)},{i:y-2,x:ia(u,f)})}else(d!==1||f!==1)&&p.push(a(p)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,d,f),i(l.rotate,u.rotate,d,f),s(l.skewX,u.skewX,d,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(p){for(var m=-1,y=f.length,v;++m<y;)d[(v=f[m]).i]=v.x(p);return d.join("")}}}var Wie=_3(Uie,"px, ","px)","deg)"),Hie=_3(Vie,", ",")",")"),qie=1e-12;function S3(e){return((e=Math.exp(e))+1/e)/2}function Zie(e){return((e=Math.exp(e))-1/e)/2}function Kie(e){return((e=Math.exp(2*e))-1)/(e+1)}const Xie=function e(t,n,r){function a(o,i){var s=o[0],c=o[1],l=o[2],u=i[0],d=i[1],f=i[2],p=u-s,m=d-c,y=p*p+m*m,v,b;if(y<qie)b=Math.log(f/l)/t,v=function(E){return[s+E*p,c+E*m,l*Math.exp(t*E*b)]};else{var w=Math.sqrt(y),_=(f*f-l*l+r*y)/(2*l*n*w),x=(f*f-l*l-r*y)/(2*f*n*w),S=Math.log(Math.sqrt(_*_+1)-_),j=Math.log(Math.sqrt(x*x+1)-x);b=(j-S)/t,v=function(E){var O=E*b,P=S3(S),k=l/(n*w)*(P*Kie(t*O+S)-Zie(S));return[s+k*p,c+k*m,l*P/S3(t*O+S)]}}return v.duration=b*1e3*t/Math.SQRT2,v}return a.rho=function(o){var i=Math.max(.001,+o),s=i*i,c=s*s;return e(i,s,c)},a}(Math.SQRT2,2,4);function Yie(e,t){t===void 0&&(t=e,e=jc);for(var n=0,r=t.length-1,a=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(a,a=t[++n]);return function(i){var s=Math.max(0,Math.min(r-1,Math.floor(i*=r)));return o[s](i-s)}}var Ec=0,hd=0,md=0,j3=1e3,Kh,yd,Xh=0,us=0,Yh=0,gd=typeof performance=="object"&&performance.now?performance:Date,E3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function i_(){return us||(E3(Jie),us=gd.now()+Yh)}function Jie(){us=0}function Jh(){this._call=this._time=this._next=null}Jh.prototype=O3.prototype={constructor:Jh,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?i_():+n)+(t==null?0:+t),!this._next&&yd!==this&&(yd?yd._next=this:Kh=this,yd=this),this._call=e,this._time=n,s_()},stop:function(){this._call&&(this._call=null,this._time=1/0,s_())}};function O3(e,t,n){var r=new Jh;return r.restart(e,t,n),r}function Qie(){i_(),++Ec;for(var e=Kh,t;e;)(t=us-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ec}function C3(){us=(Xh=gd.now())+Yh,Ec=hd=0;try{Qie()}finally{Ec=0,ese(),us=0}}function Gie(){var e=gd.now(),t=e-Xh;t>j3&&(Yh-=t,Xh=e)}function ese(){for(var e,t=Kh,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Kh=n);yd=e,s_(r)}function s_(e){if(!Ec){hd&&(hd=clearTimeout(hd));var t=e-us;t>24?(e<1/0&&(hd=setTimeout(C3,e-gd.now()-Yh)),md&&(md=clearInterval(md))):(md||(Xh=gd.now(),md=setInterval(Gie,j3)),Ec=1,E3(C3))}}function k3(e,t,n){var r=new Jh;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var tse=Lh("start","end","cancel","interrupt"),nse=[],P3=0,N3=1,c_=2,Qh=3,M3=4,l_=5,Gh=6;function em(e,t,n,r,a,o){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;rse(e,n,{name:t,index:r,group:a,on:tse,tween:nse,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:P3})}function u_(e,t){var n=sa(e,t);if(n.state>P3)throw new Error("too late; already scheduled");return n}function qa(e,t){var n=sa(e,t);if(n.state>Qh)throw new Error("too late; already running");return n}function sa(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function rse(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=O3(o,0,n.time);function o(l){n.state=N3,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var u,d,f,p;if(n.state!==N3)return c();for(u in r)if(p=r[u],p.name===n.name){if(p.state===Qh)return k3(i);p.state===M3?(p.state=Gh,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete r[u]):+u<t&&(p.state=Gh,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete r[u])}if(k3(function(){n.state===Qh&&(n.state=M3,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=c_,n.on.call("start",e,e.__data__,n.index,n.group),n.state===c_){for(n.state=Qh,a=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(p=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(a[++d]=p);a.length=d+1}}function s(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=l_,1),d=-1,f=a.length;++d<f;)a[d].call(e,u);n.state===l_&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Gh,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function tm(e,t){var n=e.__transition,r,a,o=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){o=!1;continue}a=r.state>c_&&r.state<l_,r.state=Gh,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}o&&delete e.__transition}}function ase(e){return this.each(function(){tm(this,e)})}function ose(e,t){var n,r;return function(){var a=qa(this,e),o=a.tween;if(o!==n){r=n=o;for(var i=0,s=r.length;i<s;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}a.tween=r}}function ise(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var o=qa(this,e),i=o.tween;if(i!==r){a=(r=i).slice();for(var s={name:t,value:n},c=0,l=a.length;c<l;++c)if(a[c].name===t){a[c]=s;break}c===l&&a.push(s)}o.tween=a}}function sse(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=sa(this.node(),n).tween,a=0,o=r.length,i;a<o;++a)if((i=r[a]).name===e)return i.value;return null}return this.each((t==null?ose:ise)(n,e,t))}function d_(e,t,n){var r=e._id;return e.each(function(){var a=qa(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return sa(a,r).value[t]}}function A3(e,t){var n;return(typeof t=="number"?ia:t instanceof ss?qh:(n=ss(t))?(t=n,qh):v3)(e,t)}function cse(e){return function(){this.removeAttribute(e)}}function lse(e){return function(){this.removeAttributeNS(e.space,e.local)}}function use(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttribute(e);return i===a?null:i===r?o:o=t(r=i,n)}}function dse(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===r?o:o=t(r=i,n)}}function fse(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function pse(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function hse(e,t){var n=Fh(e),r=n==="transform"?Hie:A3;return this.attrTween(e,typeof t=="function"?(n.local?pse:fse)(n,r,d_(this,"attr."+e,t)):t==null?(n.local?lse:cse)(n):(n.local?dse:use)(n,r,t))}function mse(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function yse(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function gse(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&yse(e,o)),n}return a._value=t,a}function vse(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&mse(e,o)),n}return a._value=t,a}function bse(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Fh(e);return this.tween(n,(r.local?gse:vse)(r,t))}function wse(e,t){return function(){u_(this,e).delay=+t.apply(this,arguments)}}function xse(e,t){return t=+t,function(){u_(this,e).delay=t}}function _se(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?wse:xse)(t,e)):sa(this.node(),t).delay}function Sse(e,t){return function(){qa(this,e).duration=+t.apply(this,arguments)}}function jse(e,t){return t=+t,function(){qa(this,e).duration=t}}function Ese(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Sse:jse)(t,e)):sa(this.node(),t).duration}function Ose(e,t){if(typeof t!="function")throw new Error;return function(){qa(this,e).ease=t}}function Cse(e){var t=this._id;return arguments.length?this.each(Ose(t,e)):sa(this.node(),t).ease}function kse(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;qa(this,e).ease=n}}function Pse(e){if(typeof e!="function")throw new Error;return this.each(kse(this._id,e))}function Nse(e){typeof e!="function"&&(e=K4(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new No(r,this._parents,this._name,this._id)}function Mse(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,o=Math.min(r,a),i=new Array(r),s=0;s<o;++s)for(var c=t[s],l=n[s],u=c.length,d=i[s]=new Array(u),f,p=0;p<u;++p)(f=c[p]||l[p])&&(d[p]=f);for(;s<r;++s)i[s]=t[s];return new No(i,this._parents,this._name,this._id)}function Ase(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Tse(e,t,n){var r,a,o=Ase(t)?u_:qa;return function(){var i=o(this,e),s=i.on;s!==r&&(a=(r=s).copy()).on(t,n),i.on=a}}function Rse(e,t){var n=this._id;return arguments.length<2?sa(this.node(),n).on.on(e):this.each(Tse(n,e,t))}function Ise(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Dse(){return this.on("end.remove",Ise(this._id))}function Lse(e){var t=this._name,n=this._id;typeof e!="function"&&(e=X1(e));for(var r=this._groups,a=r.length,o=new Array(a),i=0;i<a;++i)for(var s=r[i],c=s.length,l=o[i]=new Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,em(l[f],t,n,f,l,sa(u,n)));return new No(o,this._parents,t,n)}function $se(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Z4(e));for(var r=this._groups,a=r.length,o=[],i=[],s=0;s<a;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),p,m=sa(u,n),y=0,v=f.length;y<v;++y)(p=f[y])&&em(p,t,n,y,f,m);o.push(f),i.push(u)}return new No(o,i,t,n)}var Fse=ld.prototype.constructor;function Bse(){return new Fse(this._groups,this._parents)}function zse(e,t){var n,r,a;return function(){var o=xc(this,e),i=(this.style.removeProperty(e),xc(this,e));return o===i?null:o===n&&i===r?a:a=t(n=o,r=i)}}function T3(e){return function(){this.style.removeProperty(e)}}function Use(e,t,n){var r,a=n+"",o;return function(){var i=xc(this,e);return i===a?null:i===r?o:o=t(r=i,n)}}function Vse(e,t,n){var r,a,o;return function(){var i=xc(this,e),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),xc(this,e))),i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s))}}function Wse(e,t){var n,r,a,o="style."+t,i="end."+o,s;return function(){var c=qa(this,e),l=c.on,u=c.value[o]==null?s||(s=T3(t)):void 0;(l!==n||a!==u)&&(r=(n=l).copy()).on(i,a=u),c.on=r}}function Hse(e,t,n){var r=(e+="")=="transform"?Wie:A3;return t==null?this.styleTween(e,zse(e,r)).on("end.style."+e,T3(e)):typeof t=="function"?this.styleTween(e,Vse(e,r,d_(this,"style."+e,t))).each(Wse(this._id,e)):this.styleTween(e,Use(e,r,t),n).on("end.style."+e,null)}function qse(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Zse(e,t,n){var r,a;function o(){var i=t.apply(this,arguments);return i!==a&&(r=(a=i)&&qse(e,i,n)),r}return o._value=t,o}function Kse(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Zse(e,t,n??""))}function Xse(e){return function(){this.textContent=e}}function Yse(e){return function(){var t=e(this);this.textContent=t??""}}function Jse(e){return this.tween("text",typeof e=="function"?Yse(d_(this,"text",e)):Xse(e==null?"":e+""))}function Qse(e){return function(t){this.textContent=e.call(this,t)}}function Gse(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&Qse(a)),t}return r._value=e,r}function ece(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Gse(e))}function tce(){for(var e=this._name,t=this._id,n=R3(),r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)if(c=i[l]){var u=sa(c,t);em(c,e,n,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new No(r,this._parents,e,n)}function nce(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(o,i){var s={value:i},c={value:function(){--a===0&&o()}};n.each(function(){var l=qa(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),l.on=t}),a===0&&o()})}var rce=0;function No(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function R3(){return++rce}var Mo=ld.prototype;No.prototype={constructor:No,select:Lse,selectAll:$se,selectChild:Mo.selectChild,selectChildren:Mo.selectChildren,filter:Nse,merge:Mse,selection:Bse,transition:tce,call:Mo.call,nodes:Mo.nodes,node:Mo.node,size:Mo.size,empty:Mo.empty,each:Mo.each,on:Rse,attr:hse,attrTween:bse,style:Hse,styleTween:Kse,text:Jse,textTween:ece,remove:Dse,tween:sse,delay:_se,duration:Ese,ease:Cse,easeVarying:Pse,end:nce,[Symbol.iterator]:Mo[Symbol.iterator]};function ace(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var oce={time:null,delay:0,duration:250,ease:ace};function ice(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function sce(e){var t,n;e instanceof No?(t=e._id,e=e._name):(t=R3(),(n=oce).time=i_(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&em(c,e,t,l,i,n||ice(c,t));return new No(r,this._parents,e,t)}ld.prototype.interrupt=ase,ld.prototype.transition=sce;const nm=e=>()=>e;function cce(e,{sourceEvent:t,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function Ao(e,t,n){this.k=e,this.x=t,this.y=n}Ao.prototype={constructor:Ao,scale:function(e){return e===1?this:new Ao(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ao(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var rm=new Ao(1,0,0);I3.prototype=Ao.prototype;function I3(e){for(;!e.__zoom;)if(!(e=e.parentNode))return rm;return e.__zoom}function f_(e){e.stopImmediatePropagation()}function vd(e){e.preventDefault(),e.stopImmediatePropagation()}function lce(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function uce(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function D3(){return this.__zoom||rm}function dce(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function fce(){return navigator.maxTouchPoints||"ontouchstart"in this}function pce(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function L3(){var e=lce,t=uce,n=pce,r=dce,a=fce,o=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,c=Xie,l=Lh("start","zoom","end"),u,d,f,p=500,m=150,y=0,v=10;function b(C){C.property("__zoom",D3).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",k).filter(a).on("touchstart.zoom",N).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",M).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(C,T,A,I){var F=C.selection?C.selection():C;F.property("__zoom",D3),C!==F?S(C,T,A,I):F.interrupt().each(function(){j(this,arguments).event(I).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},b.scaleBy=function(C,T,A,I){b.scaleTo(C,function(){var F=this.__zoom.k,D=typeof T=="function"?T.apply(this,arguments):T;return F*D},A,I)},b.scaleTo=function(C,T,A,I){b.transform(C,function(){var F=t.apply(this,arguments),D=this.__zoom,V=A==null?x(F):typeof A=="function"?A.apply(this,arguments):A,U=D.invert(V),B=typeof T=="function"?T.apply(this,arguments):T;return n(_(w(D,B),V,U),F,i)},A,I)},b.translateBy=function(C,T,A,I){b.transform(C,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),i)},null,I)},b.translateTo=function(C,T,A,I,F){b.transform(C,function(){var D=t.apply(this,arguments),V=this.__zoom,U=I==null?x(D):typeof I=="function"?I.apply(this,arguments):I;return n(rm.translate(U[0],U[1]).scale(V.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof A=="function"?-A.apply(this,arguments):-A),D,i)},I,F)};function w(C,T){return T=Math.max(o[0],Math.min(o[1],T)),T===C.k?C:new Ao(T,C.x,C.y)}function _(C,T,A){var I=T[0]-A[0]*C.k,F=T[1]-A[1]*C.k;return I===C.x&&F===C.y?C:new Ao(C.k,I,F)}function x(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function S(C,T,A,I){C.on("start.zoom",function(){j(this,arguments).event(I).start()}).on("interrupt.zoom end.zoom",function(){j(this,arguments).event(I).end()}).tween("zoom",function(){var F=this,D=arguments,V=j(F,D).event(I),U=t.apply(F,D),B=A==null?x(U):typeof A=="function"?A.apply(F,D):A,K=Math.max(U[1][0]-U[0][0],U[1][1]-U[0][1]),te=F.__zoom,L=typeof T=="function"?T.apply(F,D):T,$=c(te.invert(B).concat(K/te.k),L.invert(B).concat(K/L.k));return function(W){if(W===1)W=L;else{var q=$(W),Z=K/q[2];W=new Ao(Z,B[0]-q[0]*Z,B[1]-q[1]*Z)}V.zoom(null,W)}})}function j(C,T,A){return!A&&C.__zooming||new E(C,T)}function E(C,T){this.that=C,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,T),this.taps=0}E.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,T){return this.mouse&&C!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var T=wr(this.that).datum();l.call(C,this.that,new cce(C,{sourceEvent:this.sourceEvent,target:b,type:C,transform:this.that.__zoom,dispatch:l}),T)}};function O(C,...T){if(!e.apply(this,arguments))return;var A=j(this,T).event(C),I=this.__zoom,F=Math.max(o[0],Math.min(o[1],I.k*Math.pow(2,r.apply(this,arguments)))),D=aa(C);if(A.wheel)(A.mouse[0][0]!==D[0]||A.mouse[0][1]!==D[1])&&(A.mouse[1]=I.invert(A.mouse[0]=D)),clearTimeout(A.wheel);else{if(I.k===F)return;A.mouse=[D,I.invert(D)],tm(this),A.start()}vd(C),A.wheel=setTimeout(V,m),A.zoom("mouse",n(_(w(I,F),A.mouse[0],A.mouse[1]),A.extent,i));function V(){A.wheel=null,A.end()}}function P(C,...T){if(f||!e.apply(this,arguments))return;var A=C.currentTarget,I=j(this,T,!0).event(C),F=wr(C.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",K,!0),D=aa(C,A),V=C.clientX,U=C.clientY;a3(C.view),f_(C),I.mouse=[D,this.__zoom.invert(D)],tm(this),I.start();function B(te){if(vd(te),!I.moved){var L=te.clientX-V,$=te.clientY-U;I.moved=L*L+$*$>y}I.event(te).zoom("mouse",n(_(I.that.__zoom,I.mouse[0]=aa(te,A),I.mouse[1]),I.extent,i))}function K(te){F.on("mousemove.zoom mouseup.zoom",null),o3(te.view,I.moved),vd(te),I.event(te).end()}}function k(C,...T){if(e.apply(this,arguments)){var A=this.__zoom,I=aa(C.changedTouches?C.changedTouches[0]:C,this),F=A.invert(I),D=A.k*(C.shiftKey?.5:2),V=n(_(w(A,D),I,F),t.apply(this,T),i);vd(C),s>0?wr(this).transition().duration(s).call(S,V,I,C):wr(this).call(b.transform,V,I,C)}}function N(C,...T){if(e.apply(this,arguments)){var A=C.touches,I=A.length,F=j(this,T,C.changedTouches.length===I).event(C),D,V,U,B;for(f_(C),V=0;V<I;++V)U=A[V],B=aa(U,this),B=[B,this.__zoom.invert(B),U.identifier],F.touch0?!F.touch1&&F.touch0[2]!==B[2]&&(F.touch1=B,F.taps=0):(F.touch0=B,D=!0,F.taps=1+!!u);u&&(u=clearTimeout(u)),D&&(F.taps<2&&(d=B[0],u=setTimeout(function(){u=null},p)),tm(this),F.start())}}function R(C,...T){if(this.__zooming){var A=j(this,T).event(C),I=C.changedTouches,F=I.length,D,V,U,B;for(vd(C),D=0;D<F;++D)V=I[D],U=aa(V,this),A.touch0&&A.touch0[2]===V.identifier?A.touch0[0]=U:A.touch1&&A.touch1[2]===V.identifier&&(A.touch1[0]=U);if(V=A.that.__zoom,A.touch1){var K=A.touch0[0],te=A.touch0[1],L=A.touch1[0],$=A.touch1[1],W=(W=L[0]-K[0])*W+(W=L[1]-K[1])*W,q=(q=$[0]-te[0])*q+(q=$[1]-te[1])*q;V=w(V,Math.sqrt(W/q)),U=[(K[0]+L[0])/2,(K[1]+L[1])/2],B=[(te[0]+$[0])/2,(te[1]+$[1])/2]}else if(A.touch0)U=A.touch0[0],B=A.touch0[1];else return;A.zoom("touch",n(_(V,U,B),A.extent,i))}}function M(C,...T){if(this.__zooming){var A=j(this,T).event(C),I=C.changedTouches,F=I.length,D,V;for(f_(C),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),D=0;D<F;++D)V=I[D],A.touch0&&A.touch0[2]===V.identifier?delete A.touch0:A.touch1&&A.touch1[2]===V.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(V=aa(V,this),Math.hypot(d[0]-V[0],d[1]-V[1])<v)){var U=wr(this).on("dblclick.zoom");U&&U.apply(this,arguments)}}}return b.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:nm(+C),b):r},b.filter=function(C){return arguments.length?(e=typeof C=="function"?C:nm(!!C),b):e},b.touchable=function(C){return arguments.length?(a=typeof C=="function"?C:nm(!!C),b):a},b.extent=function(C){return arguments.length?(t=typeof C=="function"?C:nm([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),b):t},b.scaleExtent=function(C){return arguments.length?(o[0]=+C[0],o[1]=+C[1],b):[o[0],o[1]]},b.translateExtent=function(C){return arguments.length?(i[0][0]=+C[0][0],i[1][0]=+C[1][0],i[0][1]=+C[0][1],i[1][1]=+C[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(C){return arguments.length?(n=C,b):n},b.duration=function(C){return arguments.length?(s=+C,b):s},b.interpolate=function(C){return arguments.length?(c=C,b):c},b.on=function(){var C=l.on.apply(l,arguments);return C===l?b:C},b.clickDistance=function(C){return arguments.length?(y=(C=+C)*C,b):Math.sqrt(y)},b.tapDistance=function(C){return arguments.length?(v=+C,b):v},b}const To={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},bd=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],$3=["Enter"," ","Escape"];var Oc;(function(e){e.Strict="strict",e.Loose="loose"})(Oc||(Oc={}));var vi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(vi||(vi={}));var wd;(function(e){e.Partial="partial",e.Full="full"})(wd||(wd={}));const F3={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var bi;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(bi||(bi={}));var am;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(am||(am={}));var be;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(be||(be={}));const B3={[be.Left]:be.Right,[be.Right]:be.Left,[be.Top]:be.Bottom,[be.Bottom]:be.Top};function hce(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function z3(e,t,n){if(!n)return;const r=[];e.forEach((a,o)=>{t!=null&&t.has(o)||r.push(a)}),r.length&&n(r)}function U3(e){return e===null?null:e?"valid":"invalid"}const V3=e=>"id"in e&&"source"in e&&"target"in e,mce=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),p_=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),xd=(e,t=[0,0])=>{const{width:n,height:r}=Ro(e),a=e.origin??t,o=n*a[0],i=r*a[1];return{x:e.position.x-o,y:e.position.y-i}},yce=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,a)=>{const o=typeof a=="string";let i=!t.nodeLookup&&!o?a:void 0;t.nodeLookup&&(i=o?t.nodeLookup.get(a):p_(a)?a:t.nodeLookup.get(a.id));const s=i?sm(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return om(r,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return im(n)},_d=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const a=sm(r);n=om(n,a)}}),im(n)},W3=(e,t,[n,r,a]=[0,0,1],o=!1,i=!1)=>{const s={...jd(t,[n,r,a]),width:t.width/a,height:t.height/a},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:f=!1}=l;if(i&&!d||f)continue;const p=u.width??l.width??l.initialWidth??null,m=u.height??l.height??l.initialHeight??null,y=Sd(s,kc(l)),v=(p??0)*(m??0),b=o&&y>0;(!l.internals.handleBounds||b||y>=v||l.dragging)&&c.push(l)}return c},gce=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function h_(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&(t!=null&&t.includeHiddenNodes||!a.hidden)&&(!r||r.has(a.id))&&n.set(a.id,a)}),n}async function m_({nodes:e,width:t,height:n,panZoom:r,minZoom:a,maxZoom:o},i){if(e.size===0)return Promise.resolve(!1);const s=_d(e),c=g_(s,t,n,(i==null?void 0:i.minZoom)??a,(i==null?void 0:i.maxZoom)??o,(i==null?void 0:i.padding)??.1);return await r.setViewport(c,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function H3({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:a,onError:o}){const i=n.get(e),s=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=s?s.internals.positionAbsolute:{x:0,y:0},u=i.origin??r;let d=a;if(i.extent==="parent"&&!i.expandParent)if(!s)o==null||o("005",To.error005());else{const p=s.measured.width,m=s.measured.height;p&&m&&(d=[[c,l],[c+p,l+m]])}else s&&Pc(i.extent)&&(d=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const f=Pc(d)?ds(t,d,i.measured):t;return{position:{x:f.x-c+i.measured.width*u[0],y:f.y-l+i.measured.height*u[1]},positionAbsolute:f}}async function vce({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:a}){const o=new Set(e.map(d=>d.id)),i=[];for(const d of n){if(d.deletable===!1)continue;const f=o.has(d.id),p=!f&&d.parentId&&i.find(m=>m.id===d.parentId);(f||p)&&i.push(d)}const s=new Set(t.map(d=>d.id)),c=r.filter(d=>d.deletable!==!1),l=gce(i,c);for(const d of c)s.has(d.id)&&!l.find(f=>f.id===d.id)&&l.push(d);if(!a)return{edges:l,nodes:i};const u=await a({nodes:i,edges:l});return typeof u=="boolean"?u?{edges:l,nodes:i}:{edges:[],nodes:[]}:u}const Cc=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),ds=(e={x:0,y:0},t,n)=>({x:Cc(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Cc(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function q3(e,t,n){const{width:r,height:a}=Ro(n),{x:o,y:i}=n.internals.positionAbsolute;return ds(e,[[o,i],[o+r,i+a]],t)}const Z3=(e,t,n)=>e<t?Cc(Math.abs(e-t),1,t)/t:e>n?-Cc(Math.abs(e-n),1,t)/t:0,K3=(e,t,n=15,r=40)=>{const a=Z3(e.x,r,t.width-r)*n,o=Z3(e.y,r,t.height-r)*n;return[a,o]},om=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),y_=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),im=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),kc=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=p_(e)?e.internals.positionAbsolute:xd(e,t);return{x:n,y:r,width:((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0,height:((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0}},sm=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=p_(e)?e.internals.positionAbsolute:xd(e,t);return{x:n,y:r,x2:n+(((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0),y2:r+(((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0)}},X3=(e,t)=>im(om(y_(e),y_(t))),Sd=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Y3=e=>ca(e.width)&&ca(e.height)&&ca(e.x)&&ca(e.y),ca=e=>!isNaN(e)&&isFinite(e),bce=(e,t)=>{},cm=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),jd=({x:e,y:t},[n,r,a],o=!1,i=[1,1])=>{const s={x:(e-n)/a,y:(t-r)/a};return o?cm(s,i):s},J3=({x:e,y:t},[n,r,a])=>({x:e*a+n,y:t*a+r}),g_=(e,t,n,r,a,o)=>{const i=t/(e.width*(1+o)),s=n/(e.height*(1+o)),c=Math.min(i,s),l=Cc(c,r,a),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,p=n/2-d*l;return{x:f,y:p,zoom:l}},lm=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Pc(e){return e!==void 0&&e!=="parent"}function Ro(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Q3(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function G3(e,t={width:0,height:0},n,r,a){const o={...e},i=r.get(n);if(i){const s=i.origin||a;o.x+=i.internals.positionAbsolute.x-(t.width??0)*s[0],o.y+=i.internals.positionAbsolute.y-(t.height??0)*s[1]}return o}function Ed(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:a}){const{x:o,y:i}=Io(e),s=jd({x:o-((a==null?void 0:a.left)??0),y:i-((a==null?void 0:a.top)??0)},r),{x:c,y:l}=n?cm(s,t):s;return{xSnapped:c,ySnapped:l,...s}}const um=e=>({width:e.offsetWidth,height:e.offsetHeight}),e5=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},wce=["INPUT","SELECT","TEXTAREA"];function v_(e){var n,r;const t=((r=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:r[0])||e.target;return wce.includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}const t5=e=>"clientX"in e,Io=(e,t)=>{var o,i;const n=t5(e),r=n?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,a=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:a-((t==null?void 0:t.top)??0)}},n5=(e,t,n,r,a)=>{const o=t.querySelectorAll(`.${e}`);return!o||!o.length?null:Array.from(o).map(i=>{const s=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:a,position:i.getAttribute("data-handlepos"),x:(s.left-n.left)/r,y:(s.top-n.top)/r,...um(i)}})};function r5({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:a,sourceControlY:o,targetControlX:i,targetControlY:s}){const c=e*.125+a*.375+i*.375+n*.125,l=t*.125+o*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function dm(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function a5({pos:e,x1:t,y1:n,x2:r,y2:a,c:o}){switch(e){case be.Left:return[t-dm(t-r,o),n];case be.Right:return[t+dm(r-t,o),n];case be.Top:return[t,n-dm(n-a,o)];case be.Bottom:return[t,n+dm(a-n,o)]}}function o5({sourceX:e,sourceY:t,sourcePosition:n=be.Bottom,targetX:r,targetY:a,targetPosition:o=be.Top,curvature:i=.25}){const[s,c]=a5({pos:n,x1:e,y1:t,x2:r,y2:a,c:i}),[l,u]=a5({pos:o,x1:r,y1:a,x2:e,y2:t,c:i}),[d,f,p,m]=r5({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${a}`,d,f,p,m]}function i5({sourceX:e,sourceY:t,targetX:n,targetY:r}){const a=Math.abs(n-e)/2,o=n<e?n+a:n-a,i=Math.abs(r-t)/2,s=r<t?r+i:r-i;return[o,s,a,i]}function xce({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:a=!1}){if(!a)return r;const o=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(o?i:0)}function _ce({sourceNode:e,targetNode:t,width:n,height:r,transform:a}){const o=om(sm(e),sm(t));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const i={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:r/a[2]};return Sd(i,im(o))>0}const Sce=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,jce=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),s5=(e,t)=>{if(!e.source||!e.target)return t;let n;return V3(e)?n={...e}:n={...e,id:Sce(e)},jce(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function c5({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[a,o,i,s]=i5({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,a,o,i,s]}const l5={[be.Left]:{x:-1,y:0},[be.Right]:{x:1,y:0},[be.Top]:{x:0,y:-1},[be.Bottom]:{x:0,y:1}},Ece=({source:e,sourcePosition:t=be.Bottom,target:n})=>t===be.Left||t===be.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},u5=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Oce({source:e,sourcePosition:t=be.Bottom,target:n,targetPosition:r=be.Top,center:a,offset:o}){const i=l5[t],s=l5[r],c={x:e.x+i.x*o,y:e.y+i.y*o},l={x:n.x+s.x*o,y:n.y+s.y*o},u=Ece({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let p=[],m,y;const v={x:0,y:0},b={x:0,y:0},[w,_,x,S]=i5({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[d]*s[d]===-1){m=a.x??w,y=a.y??_;const j=[{x:m,y:c.y},{x:m,y:l.y}],E=[{x:c.x,y},{x:l.x,y}];i[d]===f?p=d==="x"?j:E:p=d==="x"?E:j}else{const j=[{x:c.x,y:l.y}],E=[{x:l.x,y:c.y}];if(d==="x"?p=i.x===f?E:j:p=i.y===f?j:E,t===r){const R=Math.abs(e[d]-n[d]);if(R<=o){const M=Math.min(o-1,o-R);i[d]===f?v[d]=(c[d]>e[d]?-1:1)*M:b[d]=(l[d]>n[d]?-1:1)*M}}if(t!==r){const R=d==="x"?"y":"x",M=i[d]===s[R],C=c[R]>l[R],T=c[R]<l[R];(i[d]===1&&(!M&&C||M&&T)||i[d]!==1&&(!M&&T||M&&C))&&(p=d==="x"?j:E)}const O={x:c.x+v.x,y:c.y+v.y},P={x:l.x+b.x,y:l.y+b.y},k=Math.max(Math.abs(O.x-p[0].x),Math.abs(P.x-p[0].x)),N=Math.max(Math.abs(O.y-p[0].y),Math.abs(P.y-p[0].y));k>=N?(m=(O.x+P.x)/2,y=p[0].y):(m=p[0].x,y=(O.y+P.y)/2)}return[[e,{x:c.x+v.x,y:c.y+v.y},...p,{x:l.x+b.x,y:l.y+b.y},n],m,y,x,S]}function Cce(e,t,n,r){const a=Math.min(u5(e,t)/2,u5(t,n)/2,r),{x:o,y:i}=t;if(e.x===o&&o===n.x||e.y===i&&i===n.y)return`L${o} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${o+a*l},${i}Q ${o},${i} ${o},${i+a*u}`}const s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${o},${i+a*c}Q ${o},${i} ${o+a*s},${i}`}function b_({sourceX:e,sourceY:t,sourcePosition:n=be.Bottom,targetX:r,targetY:a,targetPosition:o=be.Top,borderRadius:i=5,centerX:s,centerY:c,offset:l=20}){const[u,d,f,p,m]=Oce({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:a},targetPosition:o,center:{x:s,y:c},offset:l});return[u.reduce((y,v,b)=>{let w="";return b>0&&b<u.length-1?w=Cce(u[b-1],v,u[b+1],i):w=`${b===0?"M":"L"}${v.x} ${v.y}`,y+=w,y},""),d,f,p,m]}function d5(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function kce(e){var d;const{sourceNode:t,targetNode:n}=e;if(!d5(t)||!d5(n))return null;const r=t.internals.handleBounds||f5(t.handles),a=n.internals.handleBounds||f5(n.handles),o=p5((r==null?void 0:r.source)??[],e.sourceHandle),i=p5(e.connectionMode===Oc.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),e.targetHandle);if(!o||!i)return(d=e.onError)==null||d.call(e,"008",To.error008(o?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=(o==null?void 0:o.position)||be.Bottom,c=(i==null?void 0:i.position)||be.Top,l=Od(t,o,s),u=Od(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:s,targetPosition:c}}function f5(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Od(e,t,n=be.Left,r=!1){const a=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,o=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:s}=t??Ro(e);if(r)return{x:a+i/2,y:o+s/2};switch((t==null?void 0:t.position)??n){case be.Top:return{x:a+i/2,y:o};case be.Right:return{x:a+i,y:o+s/2};case be.Bottom:return{x:a+i/2,y:o+s};case be.Left:return{x:a,y:o+s/2}}}function p5(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function w_(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function Pce(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:a}){const o=new Set;return e.reduce((i,s)=>([s.markerStart||r,s.markerEnd||a].forEach(c=>{if(c&&typeof c=="object"){const l=w_(c,t);o.has(l)||(i.push({id:l,color:c.color||n,...c}),o.add(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))}const x_={nodeOrigin:[0,0],nodeExtent:bd,elevateNodesOnSelect:!0,defaults:{}},Nce={...x_,checkEquality:!0};function __(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function Mce(e,t,n){const r=__(x_,n);for(const a of e.values())if(a.parentId)j_(a,e,t,r);else{const o=xd(a,r.nodeOrigin),i=Pc(a.extent)?a.extent:r.nodeExtent,s=ds(o,i,Ro(a));a.internals.positionAbsolute=s}}function S_(e,t,n,r){var s,c;const a=__(Nce,r),o=new Map(t),i=a!=null&&a.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let u=o.get(l.id);if(a.checkEquality&&l===(u==null?void 0:u.internals.userNode))t.set(l.id,u);else{const d=xd(l,a.nodeOrigin),f=Pc(l.extent)?l.extent:a.nodeExtent,p=ds(d,f,Ro(l));u={...a.defaults,...l,measured:{width:(s=l.measured)==null?void 0:s.width,height:(c=l.measured)==null?void 0:c.height},internals:{positionAbsolute:p,handleBounds:l.measured?u==null?void 0:u.internals.handleBounds:void 0,z:h5(l,i),userNode:l}},t.set(l.id,u)}l.parentId&&j_(u,t,n,r)}}function Ace(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function j_(e,t,n,r){const{elevateNodesOnSelect:a,nodeOrigin:o,nodeExtent:i}=__(x_,r),s=e.parentId,c=t.get(s);if(!c){console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Ace(e,n);const l=a?1e3:0,{x:u,y:d,z:f}=Tce(e,c,o,i,l),{positionAbsolute:p}=e.internals,m=u!==p.x||d!==p.y;(m||f!==e.internals.z)&&(e.internals={...e.internals,positionAbsolute:m?{x:u,y:d}:p,z:f})}function h5(e,t){return(ca(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Tce(e,t,n,r,a){const{x:o,y:i}=t.internals.positionAbsolute,s=Ro(e),c=xd(e,n),l=Pc(e.extent)?ds(c,e.extent,s):c;let u=ds({x:o+l.x,y:i+l.y},r,s);e.extent==="parent"&&(u=q3(u,s,t));const d=h5(e,a),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>d?f:d}}function E_(e,t,n,r=[0,0]){var i;const a=[],o=new Map;for(const s of e){const c=t.get(s.parentId);if(!c)continue;const l=((i=o.get(s.parentId))==null?void 0:i.expandedRect)??kc(c),u=X3(l,s.rect);o.set(s.parentId,{expandedRect:u,parent:c})}return o.size>0&&o.forEach(({expandedRect:s,parent:c},l)=>{var _;const u=c.internals.positionAbsolute,d=Ro(c),f=c.origin??r,p=s.x<u.x?Math.round(Math.abs(u.x-s.x)):0,m=s.y<u.y?Math.round(Math.abs(u.y-s.y)):0,y=Math.max(d.width,Math.round(s.width)),v=Math.max(d.height,Math.round(s.height)),b=(y-d.width)*f[0],w=(v-d.height)*f[1];(p>0||m>0||b||w)&&(a.push({id:l,type:"position",position:{x:c.position.x-p+b,y:c.position.y-m+w}}),(_=n.get(l))==null||_.forEach(x=>{e.some(S=>S.id===x.id)||a.push({id:x.id,type:"position",position:{x:x.position.x+p,y:x.position.y+m}})})),(d.width<s.width||d.height<s.height||p||m)&&a.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:y+(p?f[0]*p-b:0),height:v+(m?f[1]*m-w:0)}})}),a}function Rce(e,t,n,r,a,o){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let s=!1;if(!i)return{changes:[],updatedInternals:s};const c=[],l=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const f of e.values()){const p=t.get(f.id);if(p)if(p.hidden)p.internals={...p.internals,handleBounds:void 0},s=!0;else{const m=um(f.nodeElement),y=p.measured.width!==m.width||p.measured.height!==m.height;if(m.width&&m.height&&(y||!p.internals.handleBounds||f.force)){const v=f.nodeElement.getBoundingClientRect(),b=Pc(p.extent)?p.extent:o;let{positionAbsolute:w}=p.internals;p.parentId&&p.extent==="parent"?w=q3(w,m,t.get(p.parentId)):b&&(w=ds(w,b,m)),p.measured=m,p.internals={...p.internals,positionAbsolute:w,handleBounds:{source:n5("source",f.nodeElement,v,u,p.id),target:n5("target",f.nodeElement,v,u,p.id)}},p.parentId&&j_(p,t,n,{nodeOrigin:a}),s=!0,y&&(c.push({id:p.id,type:"dimensions",dimensions:m}),p.expandParent&&p.parentId&&d.push({id:p.id,parentId:p.parentId,rect:kc(p,a)}))}}}if(d.length>0){const f=E_(d,t,n,a);c.push(...f)}return{changes:c,updatedInternals:s}}async function Ice({delta:e,panZoom:t,transform:n,translateExtent:r,width:a,height:o}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[a,o]],r),s=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(s)}function m5(e,t,n){e.clear(),t.clear();for(const r of n){const{source:a,target:o,sourceHandle:i=null,targetHandle:s=null}=r,c=`${a}-source-${i}`,l=`${o}-target-${s}`,u=e.get(c)||new Map,d=e.get(l)||new Map,f={edgeId:r.id,source:a,target:o,sourceHandle:i,targetHandle:s};t.set(r.id,r),e.set(c,u.set(`${o}-${s}`,f)),e.set(l,d.set(`${a}-${i}`,f))}}function y5(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:y5(n,t):!1}function g5(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n)return!1;r=r.parentElement}while(r);return!1}function Dce(e,t,n,r){const a=new Map;for(const[o,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!y5(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const s=e.get(o);s&&a.set(o,{id:o,position:s.position||{x:0,y:0},distance:{x:n.x-s.internals.positionAbsolute.x,y:n.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return a}function O_({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,s,c;const a=[];for(const[l,u]of t){const d=(i=n.get(l))==null?void 0:i.internals.userNode;d&&a.push({...d,position:u.position,dragging:r})}if(!e)return[a[0],a];const o=(s=n.get(e))==null?void 0:s.internals.userNode;return[o?{...o,position:((c=t.get(e))==null?void 0:c.position)||o.position,dragging:r}:a[0],a]}function Lce({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:a}){let o={x:null,y:null},i=0,s=new Map,c=!1,l={x:0,y:0},u=null,d=!1,f=null,p=!1;function m({noDragClassName:v,handleSelector:b,domNode:w,isSelectable:_,nodeId:x,nodeClickDistance:S=0}){f=wr(w);function j({x:k,y:N},R){const{nodeLookup:M,nodeExtent:C,snapGrid:T,snapToGrid:A,nodeOrigin:I,onNodeDrag:F,onSelectionDrag:D,onError:V,updateNodePositions:U}=t();o={x:k,y:N};let B=!1,K={x:0,y:0,x2:0,y2:0};if(s.size>1&&C){const te=_d(s);K=y_(te)}for(const[te,L]of s){if(!M.has(te))continue;let $={x:k-L.distance.x,y:N-L.distance.y};A&&($=cm($,T));let W=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(s.size>1&&C&&!L.extent){const{positionAbsolute:ee}=L.internals,oe=ee.x-K.x+C[0][0],H=ee.x+L.measured.width-K.x2+C[1][0],le=ee.y-K.y+C[0][1],ie=ee.y+L.measured.height-K.y2+C[1][1];W=[[oe,le],[H,ie]]}const{position:q,positionAbsolute:Z}=H3({nodeId:te,nextPosition:$,nodeLookup:M,nodeExtent:W,nodeOrigin:I,onError:V});B=B||L.position.x!==q.x||L.position.y!==q.y,L.position=q,L.internals.positionAbsolute=Z}if(B&&(U(s,!0),R&&(r||F||!x&&D))){const[te,L]=O_({nodeId:x,dragItems:s,nodeLookup:M});r==null||r(R,s,te,L),F==null||F(R,te,L),x||(D==null||D(R,L))}}async function E(){if(!u)return;const{transform:k,panBy:N,autoPanSpeed:R}=t(),[M,C]=K3(l,u,R);(M!==0||C!==0)&&(o.x=(o.x??0)-M/k[2],o.y=(o.y??0)-C/k[2],await N({x:M,y:C})&&j(o,null)),i=requestAnimationFrame(E)}function O(k){var B;const{nodeLookup:N,multiSelectionActive:R,nodesDraggable:M,transform:C,snapGrid:T,snapToGrid:A,selectNodesOnDrag:I,onNodeDragStart:F,onSelectionDragStart:D,unselectNodesAndEdges:V}=t();d=!0,(!I||!_)&&!R&&x&&((B=N.get(x))!=null&&B.selected||V()),_&&I&&x&&(e==null||e(x));const U=Ed(k.sourceEvent,{transform:C,snapGrid:T,snapToGrid:A,containerBounds:u});if(o=U,s=Dce(N,M,U,x),s.size>0&&(n||F||!x&&D)){const[K,te]=O_({nodeId:x,dragItems:s,nodeLookup:N});n==null||n(k.sourceEvent,s,K,te),F==null||F(k.sourceEvent,K,te),x||(D==null||D(k.sourceEvent,te))}}const P=i3().clickDistance(S).on("start",k=>{const{domNode:N,nodeDragThreshold:R,transform:M,snapGrid:C,snapToGrid:T}=t();u=(N==null?void 0:N.getBoundingClientRect())||null,p=!1,R===0&&O(k),o=Ed(k.sourceEvent,{transform:M,snapGrid:C,snapToGrid:T,containerBounds:u}),l=Io(k.sourceEvent,u)}).on("drag",k=>{const{autoPanOnNodeDrag:N,transform:R,snapGrid:M,snapToGrid:C,nodeDragThreshold:T,nodeLookup:A}=t(),I=Ed(k.sourceEvent,{transform:R,snapGrid:M,snapToGrid:C,containerBounds:u});if((k.sourceEvent.type==="touchmove"&&k.sourceEvent.touches.length>1||x&&!A.has(x))&&(p=!0),!p){if(!c&&N&&d&&(c=!0,E()),!d){const F=I.xSnapped-(o.x??0),D=I.ySnapped-(o.y??0);Math.sqrt(F*F+D*D)>T&&O(k)}(o.x!==I.xSnapped||o.y!==I.ySnapped)&&s&&d&&(l=Io(k.sourceEvent,u),j(I,k.sourceEvent))}}).on("end",k=>{if(!(!d||p)&&(c=!1,d=!1,cancelAnimationFrame(i),s.size>0)){const{nodeLookup:N,updateNodePositions:R,onNodeDragStop:M,onSelectionDragStop:C}=t();if(R(s,!1),a||M||!x&&C){const[T,A]=O_({nodeId:x,dragItems:s,nodeLookup:N,dragging:!1});a==null||a(k.sourceEvent,s,T,A),M==null||M(k.sourceEvent,T,A),x||(C==null||C(k.sourceEvent,A))}}}).filter(k=>{const N=k.target;return!k.button&&(!v||!g5(N,`.${v}`,w))&&(!b||g5(N,b,w))});f.call(P)}function y(){f==null||f.on(".drag",null)}return{update:m,destroy:y}}function $ce(e,t,n){const r=[],a={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const o of t.values())Sd(a,kc(o))>0&&r.push(o);return r}const Fce=250;function Bce(e,t,n,r){var s,c;let a=[],o=1/0;const i=$ce(e,n,t+Fce);for(const l of i){const u=[...((s=l.internals.handleBounds)==null?void 0:s.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:f,y:p}=Od(l,d,d.position,!0),m=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(p-e.y,2));m>t||(m<o?(a=[{...d,x:f,y:p}],o=m):m===o&&a.push({...d,x:f,y:p}))}}if(!a.length)return null;if(a.length>1){const l=r.type==="source"?"target":"source";return a.find(u=>u.type===l)??a[0]}return a[0]}function v5(e,t,n,r,a,o=!1){var l,u,d;const i=r.get(e);if(!i)return null;const s=a==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((d=i.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?s==null?void 0:s.find(f=>f.id===n):s==null?void 0:s[0])??null;return c&&o?{...c,...Od(i,c,c.position,!0)}:c}function b5(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function zce(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const w5=()=>!0;function Uce(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:a,edgeUpdaterType:o,isTarget:i,domNode:s,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:f,cancelConnection:p,onConnectStart:m,onConnect:y,onConnectEnd:v,isValidConnection:b=w5,onReconnectEnd:w,updateConnection:_,getTransform:x,getFromHandle:S,autoPanSpeed:j}){const E=e5(e.target);let O=0,P;const{x:k,y:N}=Io(e),R=E==null?void 0:E.elementFromPoint(k,N),M=b5(o,R),C=s==null?void 0:s.getBoundingClientRect();if(!C||!M)return;const T=v5(a,M,r,c,t);if(!T)return;let A=Io(e,C),I=!1,F=null,D=!1,V=null;function U(){if(!u||!C)return;const[q,Z]=K3(A,C,j);f({x:q,y:Z}),O=requestAnimationFrame(U)}const B={...T,nodeId:a,type:M,position:T.position},K=c.get(a),te={inProgress:!0,isValid:null,from:Od(K,B,be.Left,!0),fromHandle:B,fromPosition:B.position,fromNode:K,to:A,toHandle:null,toPosition:B3[B.position],toNode:null};_(te);let L=te;m==null||m(e,{nodeId:a,handleId:r,handleType:M});function $(q){if(!S()||!B){W(q);return}const Z=x();A=Io(q,C),P=Bce(jd(A,Z,!1,[1,1]),n,c,B),I||(U(),I=!0);const ee=x5(q,{handle:P,connectionMode:t,fromNodeId:a,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:E,lib:l,flowId:d,nodeLookup:c});V=ee.handleDomNode,F=ee.connection,D=zce(!!P,ee.isValid);const oe={...L,isValid:D,to:P&&D?J3({x:P.x,y:P.y},Z):A,toHandle:ee.toHandle,toPosition:D&&ee.toHandle?ee.toHandle.position:B3[B.position],toNode:ee.toHandle?c.get(ee.toHandle.nodeId):null};D&&P&&L.toHandle&&oe.toHandle&&L.toHandle.type===oe.toHandle.type&&L.toHandle.nodeId===oe.toHandle.nodeId&&L.toHandle.id===oe.toHandle.id&&L.to.x===oe.to.x&&L.to.y===oe.to.y||(_(oe),L=oe)}function W(q){(P||V)&&F&&D&&(y==null||y(F));const{inProgress:Z,...ee}=L,oe={...ee,toPosition:L.toHandle?L.toPosition:null};v==null||v(q,oe),o&&(w==null||w(q,oe)),p(),cancelAnimationFrame(O),I=!1,D=!1,F=null,V=null,E.removeEventListener("mousemove",$),E.removeEventListener("mouseup",W),E.removeEventListener("touchmove",$),E.removeEventListener("touchend",W)}E.addEventListener("mousemove",$),E.addEventListener("mouseup",W),E.addEventListener("touchmove",$),E.addEventListener("touchend",W)}function x5(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:a,fromType:o,doc:i,lib:s,flowId:c,isValidConnection:l=w5,nodeLookup:u}){const d=o==="target",f=t?i.querySelector(`.${s}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:p,y:m}=Io(e),y=i.elementFromPoint(p,m),v=y!=null&&y.classList.contains(`${s}-flow__handle`)?y:f,b={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=b5(void 0,v),_=v.getAttribute("data-nodeid"),x=v.getAttribute("data-handleid"),S=v.classList.contains("connectable"),j=v.classList.contains("connectableend");if(!_||!w)return b;const E={source:d?_:r,sourceHandle:d?x:a,target:d?r:_,targetHandle:d?a:x};b.connection=E;const O=S&&j&&(n===Oc.Strict?d&&w==="source"||!d&&w==="target":_!==r||x!==a);b.isValid=O&&l(E),b.toHandle=v5(_,w,x,u,n,!1)}return b}const C_={onPointerDown:Uce,isValid:x5};function Vce({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const a=wr(e);function o({translateExtent:s,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:f=!0,inversePan:p=!1}){const m=_=>{const x=n();if(_.sourceEvent.type!=="wheel"||!t)return;const S=-_.sourceEvent.deltaY*(_.sourceEvent.deltaMode===1?.05:_.sourceEvent.deltaMode?1:.002)*u,j=x[2]*Math.pow(2,S);t.scaleTo(j)};let y=[0,0];const v=_=>{(_.sourceEvent.type==="mousedown"||_.sourceEvent.type==="touchstart")&&(y=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY])},b=_=>{const x=n();if(_.sourceEvent.type!=="mousemove"&&_.sourceEvent.type!=="touchmove"||!t)return;const S=[_.sourceEvent.clientX??_.sourceEvent.touches[0].clientX,_.sourceEvent.clientY??_.sourceEvent.touches[0].clientY],j=[S[0]-y[0],S[1]-y[1]];y=S;const E=r()*Math.max(x[2],Math.log(x[2]))*(p?-1:1),O={x:x[0]-j[0]*E,y:x[1]-j[1]*E},P=[[0,0],[c,l]];t.setViewportConstrained({x:O.x,y:O.y,zoom:x[2]},P,s)},w=L3().on("start",v).on("zoom",d?b:null).on("zoom.wheel",f?m:null);a.call(w,{})}function i(){a.on("zoom",null)}return{update:o,destroy:i,pointer:aa}}const Wce=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,fm=e=>({x:e.x,y:e.y,zoom:e.k}),k_=({x:e,y:t,zoom:n})=>rm.translate(e,t).scale(n),Nc=(e,t)=>e.target.closest(`.${t}`),_5=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),P_=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},S5=e=>{const t=e.ctrlKey&&lm()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Hce({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:o,zoomOnPinch:i,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(Nc(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&i){const v=aa(u),b=S5(u),w=d*Math.pow(2,b);r.scaleTo(n,w,v,u);return}const f=u.deltaMode===1?20:1;let p=a===vi.Vertical?0:u.deltaX*f,m=a===vi.Horizontal?0:u.deltaY*f;!lm()&&u.shiftKey&&a!==vi.Vertical&&(p=u.deltaY*f,m=0),r.translateBy(n,-(p/d)*o,-(m/d)*o,{internal:!0});const y=fm(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s==null||s(u,y)),e.isPanScrolling&&(c==null||c(u,y),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,y),e.isPanScrolling=!1},150))}}function qce({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,a){if(!t&&r.type==="wheel"&&!r.ctrlKey||Nc(r,e))return null;r.preventDefault(),n.call(this,r,a)}}function Zce({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var o,i,s;if((o=r.sourceEvent)!=null&&o.internal)return;const a=fm(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=a,((s=r.sourceEvent)==null?void 0:s.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,a))}}function Kce({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:a}){return o=>{var i,s;e.usedRightMouseButton=!!(n&&_5(t,e.mouseButton??0)),(i=o.sourceEvent)!=null&&i.sync||r([o.transform.x,o.transform.y,o.transform.k]),a&&!((s=o.sourceEvent)!=null&&s.internal)&&(a==null||a(o.sourceEvent,fm(o.transform)))}}function Xce({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:a,onPaneContextMenu:o}){return i=>{var s;if(!((s=i.sourceEvent)!=null&&s.internal)&&(e.isZoomingOrPanning=!1,o&&_5(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&o(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),a&&Wce(e.prevViewport,i.transform))){const c=fm(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a==null||a(i.sourceEvent,c)},n?150:0)}}}function Yce({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:a,zoomOnDoubleClick:o,userSelectionActive:i,noWheelClassName:s,noPanClassName:c,lib:l}){return u=>{var m;const d=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Nc(u,`${l}-flow__node`)||Nc(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!a&&!o&&!n||i||Nc(u,s)&&u.type==="wheel"||Nc(u,c)&&(u.type!=="wheel"||a&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((m=u.touches)==null?void 0:m.length)>1)return u.preventDefault(),!1;if(!d&&!a&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const p=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&p}}function Jce({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:a,viewport:o,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=L3().clickDistance(!ca(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(a),p=wr(e).call(f);_({x:o.x,y:o.y,zoom:Cc(o.zoom,t,n)},[[0,0],[d.width,d.height]],a);const m=p.on("wheel.zoom"),y=p.on("dblclick.zoom");f.wheelDelta(S5);function v(R,M){return p?new Promise(C=>{f==null||f.transform(P_(p,M==null?void 0:M.duration,()=>C(!0)),R)}):Promise.resolve(!1)}function b({noWheelClassName:R,noPanClassName:M,onPaneContextMenu:C,userSelectionActive:T,panOnScroll:A,panOnDrag:I,panOnScrollMode:F,panOnScrollSpeed:D,preventScrolling:V,zoomOnPinch:U,zoomOnScroll:B,zoomOnDoubleClick:K,zoomActivationKeyPressed:te,lib:L,onTransformChange:$}){T&&!u.isZoomingOrPanning&&w();const W=A&&!te&&!T?Hce({zoomPanValues:u,noWheelClassName:R,d3Selection:p,d3Zoom:f,panOnScrollMode:F,panOnScrollSpeed:D,zoomOnPinch:U,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:c}):qce({noWheelClassName:R,preventScrolling:V,d3ZoomHandler:m});if(p.on("wheel.zoom",W,{passive:!1}),!T){const Z=Zce({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:s});f.on("start",Z);const ee=Kce({zoomPanValues:u,panOnDrag:I,onPaneContextMenu:!!C,onPanZoom:i,onTransformChange:$});f.on("zoom",ee);const oe=Xce({zoomPanValues:u,panOnDrag:I,panOnScroll:A,onPaneContextMenu:C,onPanZoomEnd:c,onDraggingChange:l});f.on("end",oe)}const q=Yce({zoomActivationKeyPressed:te,panOnDrag:I,zoomOnScroll:B,panOnScroll:A,zoomOnDoubleClick:K,zoomOnPinch:U,userSelectionActive:T,noPanClassName:M,noWheelClassName:R,lib:L});f.filter(q),K?p.on("dblclick.zoom",y):p.on("dblclick.zoom",null)}function w(){f.on("zoom",null)}async function _(R,M,C){const T=k_(R),A=f==null?void 0:f.constrain()(T,M,C);return A&&await v(A),new Promise(I=>I(A))}async function x(R,M){const C=k_(R);return await v(C,M),new Promise(T=>T(C))}function S(R){if(p){const M=k_(R),C=p.property("__zoom");(C.k!==R.zoom||C.x!==R.x||C.y!==R.y)&&(f==null||f.transform(p,M,null,{sync:!0}))}}function j(){const R=p?I3(p.node()):{x:0,y:0,k:1};return{x:R.x,y:R.y,zoom:R.k}}function E(R,M){return p?new Promise(C=>{f==null||f.scaleTo(P_(p,M==null?void 0:M.duration,()=>C(!0)),R)}):Promise.resolve(!1)}function O(R,M){return p?new Promise(C=>{f==null||f.scaleBy(P_(p,M==null?void 0:M.duration,()=>C(!0)),R)}):Promise.resolve(!1)}function P(R){f==null||f.scaleExtent(R)}function k(R){f==null||f.translateExtent(R)}function N(R){const M=!ca(R)||R<0?0:R;f==null||f.clickDistance(M)}return{update:b,destroy:w,setViewport:x,setViewportConstrained:_,getViewport:j,scaleTo:E,scaleBy:O,setScaleExtent:P,setTranslateExtent:k,syncViewport:S,setClickDistance:N}}var Mc;(function(e){e.Line="line",e.Handle="handle"})(Mc||(Mc={}));const Qce=["top-left","top-right","bottom-left","bottom-right"],Gce=["top","right","bottom","left"];function ele({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:a,affectsY:o}){const i=e-t,s=n-r,c=[i>0?1:i<0?-1:0,s>0?1:s<0?-1:0];return i&&a&&(c[0]=c[0]*-1),s&&o&&(c[1]=c[1]*-1),c}function tle(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:a}}function wi(e,t){return Math.max(0,t-e)}function xi(e,t){return Math.max(0,e-t)}function pm(e,t,n){return Math.max(0,t-e,e-n)}function j5(e,t){return e?!t:t}function nle(e,t,n,r,a,o,i,s){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,f=u&&d,{xSnapped:p,ySnapped:m}=n,{minWidth:y,maxWidth:v,minHeight:b,maxHeight:w}=r,{x:_,y:x,width:S,height:j,aspectRatio:E}=e;let O=Math.floor(u?p-e.pointerX:0),P=Math.floor(d?m-e.pointerY:0);const k=S+(c?-O:O),N=j+(l?-P:P),R=-o[0]*S,M=-o[1]*j;let C=pm(k,y,v),T=pm(N,b,w);if(i){let F=0,D=0;c&&O<0?F=wi(_+O+R,i[0][0]):!c&&O>0&&(F=xi(_+k+R,i[1][0])),l&&P<0?D=wi(x+P+M,i[0][1]):!l&&P>0&&(D=xi(x+N+M,i[1][1])),C=Math.max(C,F),T=Math.max(T,D)}if(s){let F=0,D=0;c&&O>0?F=xi(_+O,s[0][0]):!c&&O<0&&(F=wi(_+k,s[1][0])),l&&P>0?D=xi(x+P,s[0][1]):!l&&P<0&&(D=wi(x+N,s[1][1])),C=Math.max(C,F),T=Math.max(T,D)}if(a){if(u){const F=pm(k/E,b,w)*E;if(C=Math.max(C,F),i){let D=0;!c&&!l||c&&!l&&f?D=xi(x+M+k/E,i[1][1])*E:D=wi(x+M+(c?O:-O)/E,i[0][1])*E,C=Math.max(C,D)}if(s){let D=0;!c&&!l||c&&!l&&f?D=wi(x+k/E,s[1][1])*E:D=xi(x+(c?O:-O)/E,s[0][1])*E,C=Math.max(C,D)}}if(d){const F=pm(N*E,y,v)/E;if(T=Math.max(T,F),i){let D=0;!c&&!l||l&&!c&&f?D=xi(_+N*E+R,i[1][0])/E:D=wi(_+(l?P:-P)*E+R,i[0][0])/E,T=Math.max(T,D)}if(s){let D=0;!c&&!l||l&&!c&&f?D=wi(_+N*E,s[1][0])/E:D=xi(_+(l?P:-P)*E,s[0][0])/E,T=Math.max(T,D)}}}P=P+(P<0?T:-T),O=O+(O<0?C:-C),a&&(f?k>N*E?P=(j5(c,l)?-O:O)/E:O=(j5(c,l)?-P:P)*E:u?(P=O/E,l=c):(O=P*E,c=l));const A=c?_+O:_,I=l?x+P:x;return{width:S+(c?-O:O),height:j+(l?-P:P),x:o[0]*O*(c?-1:1)+A,y:o[1]*P*(l?-1:1)+I}}const E5={width:0,height:0,x:0,y:0},rle={...E5,pointerX:0,pointerY:0,aspectRatio:1};function ale(e){return[[0,0],[e.measured.width,e.measured.height]]}function ole(e,t,n){const r=t.position.x+e.position.x,a=t.position.y+e.position.y,o=e.measured.width??0,i=e.measured.height??0,s=n[0]*o,c=n[1]*i;return[[r-s,a-c],[r+o-s,a+i-c]]}function ile({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:a}){const o=wr(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:u,onResizeStart:d,onResize:f,onResizeEnd:p,shouldResize:m}){let y={...E5},v={...rle};const b=tle(c);let w,_=null,x=[],S,j,E;const O=i3().on("start",P=>{const{nodeLookup:k,transform:N,snapGrid:R,snapToGrid:M,nodeOrigin:C,paneDomNode:T}=n();if(w=k.get(t),!w)return;_=(T==null?void 0:T.getBoundingClientRect())??null;const{xSnapped:A,ySnapped:I}=Ed(P.sourceEvent,{transform:N,snapGrid:R,snapToGrid:M,containerBounds:_});y={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},v={...y,pointerX:A,pointerY:I,aspectRatio:y.width/y.height},S=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(S=k.get(w.parentId),j=S&&w.extent==="parent"?ale(S):void 0),x=[],E=void 0;for(const[F,D]of k)if(D.parentId===t&&(x.push({id:F,position:{...D.position},extent:D.extent}),D.extent==="parent"||D.expandParent)){const V=ole(D,w,D.origin??C);E?E=[[Math.min(V[0][0],E[0][0]),Math.min(V[0][1],E[0][1])],[Math.max(V[1][0],E[1][0]),Math.max(V[1][1],E[1][1])]]:E=V}d==null||d(P,{...y})}).on("drag",P=>{const{transform:k,snapGrid:N,snapToGrid:R,nodeOrigin:M}=n(),C=Ed(P.sourceEvent,{transform:k,snapGrid:N,snapToGrid:R,containerBounds:_}),T=[];if(!w)return;const{x:A,y:I,width:F,height:D}=y,V={},U=w.origin??M,{width:B,height:K,x:te,y:L}=nle(v,b,C,l,u,U,j,E),$=B!==F,W=K!==D,q=te!==A&&$,Z=L!==I&&W;if(!q&&!Z&&!$&&!W)return;if((q||Z||U[0]===1||U[1]===1)&&(V.x=q?te:y.x,V.y=Z?L:y.y,y.x=V.x,y.y=V.y,x.length>0)){const H=te-A,le=L-I;for(const ie of x)ie.position={x:ie.position.x-H+U[0]*(B-F),y:ie.position.y-le+U[1]*(K-D)},T.push(ie)}if(($||W)&&(V.width=$?B:y.width,V.height=W?K:y.height,y.width=V.width,y.height=V.height),S&&w.expandParent){const H=U[0]*(V.width??0);V.x&&V.x<H&&(y.x=H,v.x=v.x-(V.x-H));const le=U[1]*(V.height??0);V.y&&V.y<le&&(y.y=le,v.y=v.y-(V.y-le))}const ee=ele({width:y.width,prevWidth:F,height:y.height,prevHeight:D,affectsX:b.affectsX,affectsY:b.affectsY}),oe={...y,direction:ee};(m==null?void 0:m(P,oe))!==!1&&(f==null||f(P,oe),r(V,T))}).on("end",P=>{p==null||p(P,{...y}),a==null||a()});o.call(O)}function s(){o.on(".drag",null)}return{update:i,destroy:s}}var O5={exports:{}},N_={},C5;function sle(){if(C5)return N_;C5=1;var e=FX(),t=UR();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:n,a=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return N_.useSyncExternalStoreWithSelector=function(l,u,d,f,p){var m=o(null);if(m.current===null){var y={hasValue:!1,value:null};m.current=y}else y=m.current;m=s(function(){function b(j){if(!w){if(w=!0,_=j,j=f(j),p!==void 0&&y.hasValue){var E=y.value;if(p(E,j))return x=E}return x=j}if(E=x,r(_,j))return E;var O=f(j);return p!==void 0&&p(E,O)?E:(_=j,x=O)}var w=!1,_,x,S=d===void 0?null:d;return[function(){return b(u())},S===null?void 0:function(){return b(S())}]},[u,d,f,p]);var v=a(l,m[0],m[1]);return i(function(){y.hasValue=!0,y.value=v},[v]),c(v),v},N_}var k5;function cle(){return k5||(k5=1,O5.exports=sle()),O5.exports}var lle=cle();let P5,M_,N5,M5,A5,T5;iN=ft(lle),P5={BASE_URL:"/NoLLMChat/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_URL:"/NoLLMChat/",VITE_ROUTE_MODE:"hash"},M_=e=>{let t;const n=new Set,r=(s,c)=>{const l=typeof s=="function"?s(t):s;if(!Object.is(l,t)){const u=t;t=c??(typeof l!="object"||l===null)?l:Object.assign({},t,l),n.forEach(d=>d(t,u))}},a=()=>t,o={setState:r,getState:a,getInitialState:()=>i,subscribe:s=>(n.add(s),()=>n.delete(s)),destroy:()=>{(P5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},i=t=e(r,a,o);return o},N5=e=>e?M_(e):M_,{useDebugValue:M5}=Y,{useSyncExternalStoreWithSelector:A5}=iN,T5=e=>e;function R5(e,t=T5,n){const r=A5(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return M5(r),r}const I5=(e,t)=>{const n=N5(e),r=(a,o=t)=>R5(n,a,o);return Object.assign(r,n),r},ule=(e,t)=>e?I5(e,t):I5;function Kt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const hm=g.createContext(null),dle=hm.Provider,D5=To.error001();function at(e,t){const n=g.useContext(hm);if(n===null)throw new Error(D5);return R5(n,e,t)}function Vt(){const e=g.useContext(hm);if(e===null)throw new Error(D5);return g.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const L5={display:"none"},fle={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},$5="react-flow__node-desc",F5="react-flow__edge-desc",ple="react-flow__aria-live",hle=e=>e.ariaLiveMessage;function mle({rfId:e}){const t=at(hle);return h.jsx("div",{id:`${ple}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:fle,children:t})}function yle({rfId:e,disableKeyboardA11y:t}){return h.jsxs(h.Fragment,{children:[h.jsxs("div",{id:`${$5}-${e}`,style:L5,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),h.jsx("div",{id:`${F5}-${e}`,style:L5,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&h.jsx(mle,{rfId:e})]})}const gle=e=>e.userSelectionActive?"none":"all";function Ac({position:e="top-left",children:t,className:n,style:r,...a}){const o=at(gle),i=`${e}`.split("-");return h.jsx("div",{className:sn(["react-flow__panel",n,...i]),style:{...r,pointerEvents:o},...a,children:t})}function vle({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:h.jsx(Ac,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:h.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const ble=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},mm=e=>e.id;function wle(e,t){return Kt(e.selectedNodes.map(mm),t.selectedNodes.map(mm))&&Kt(e.selectedEdges.map(mm),t.selectedEdges.map(mm))}function xle({onSelectionChange:e}){const t=Vt(),{selectedNodes:n,selectedEdges:r}=at(ble,wle);return g.useEffect(()=>{const a={nodes:n,edges:r};e==null||e(a),t.getState().onSelectionChangeHandlers.forEach(o=>o(a))},[n,r,e]),null}const _le=e=>!!e.onSelectionChangeHandlers;function Sle({onSelectionChange:e}){const t=at(_le);return e||t?h.jsx(xle,{onSelectionChange:e}):null}const B5=[0,0],jle={x:0,y:0,zoom:1},Ele=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],z5=[...Ele,"rfId"],Ole=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),U5={translateExtent:bd,nodeOrigin:B5,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Cle(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:a,setTranslateExtent:o,setNodeExtent:i,reset:s,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=at(Ole,Kt),u=Vt();g.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=U5,s()}),[]);const d=g.useRef(U5);return g.useEffect(()=>{for(const f of z5){const p=e[f],m=d.current[f];p!==m&&(typeof e[f]>"u"||(f==="nodes"?t(p):f==="edges"?n(p):f==="minZoom"?r(p):f==="maxZoom"?a(p):f==="translateExtent"?o(p):f==="nodeExtent"?i(p):f==="paneClickDistance"?l(p):f==="fitView"?u.setState({fitViewOnInit:p}):f==="fitViewOptions"?u.setState({fitViewOnInitOptions:p}):u.setState({[f]:p})))}d.current=e},z5.map(f=>e[f])),null}function V5(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function kle(e){var r;const[t,n]=g.useState(e==="system"?null:e);return g.useEffect(()=>{if(e!=="system"){n(e);return}const a=V5(),o=()=>n(a!=null&&a.matches?"dark":"light");return o(),a==null||a.addEventListener("change",o),()=>{a==null||a.removeEventListener("change",o)}},[e]),t!==null?t:(r=V5())!=null&&r.matches?"dark":"light"}const W5=typeof document<"u"?document:null;function Cd(e=null,t={target:W5,actInsideInputWithModifier:!0}){const[n,r]=g.useState(!1),a=g.useRef(!1),o=g.useRef(new Set([])),[i,s]=g.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),l=c.reduce((u,d)=>u.concat(...d),[]);return[c,l]}return[[],[]]},[e]);return g.useEffect(()=>{const c=(t==null?void 0:t.target)||W5;if(e!==null){const l=f=>{if(a.current=f.ctrlKey||f.metaKey||f.shiftKey,(!a.current||a.current&&!t.actInsideInputWithModifier)&&v_(f))return!1;const p=q5(f.code,s);o.current.add(f[p]),H5(i,o.current,!1)&&(f.preventDefault(),r(!0))},u=f=>{if((!a.current||a.current&&!t.actInsideInputWithModifier)&&v_(f))return!1;const p=q5(f.code,s);H5(i,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(f[p]),f.key==="Meta"&&o.current.clear(),a.current=!1},d=()=>{o.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function H5(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(a=>t.has(a)))}function q5(e,t){return t.includes(e)?"code":"key"}const Ple=()=>{const e=Vt();return g.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,a,o],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??a,zoom:t.zoom??o},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:a,panZoom:o,domNode:i}=e.getState();if(!o||!i)return Promise.resolve(!1);const s=h_(n,t),{width:c,height:l}=um(i);return m_({nodes:s,width:c,height:l,minZoom:r,maxZoom:a,panZoom:o},t)},setCenter:async(t,n,r)=>{const{width:a,height:o,maxZoom:i,panZoom:s}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,l=a/2-t*c,u=o/2-n*c;return s?(await s.setViewport({x:l,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:a,minZoom:o,maxZoom:i,panZoom:s}=e.getState(),c=g_(t,r,a,o,i,(n==null?void 0:n.padding)??.1);return s?(await s.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:r,snapGrid:a,domNode:o}=e.getState();if(!o)return t;const{x:i,y:s}=o.getBoundingClientRect(),c={x:t.x-i,y:t.y-s};return jd(c,r,n.snapToGrid,a)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:a,y:o}=r.getBoundingClientRect(),i=J3(t,n);return{x:i.x+a,y:i.y+o}}}),[])};function Z5(e,t){const n=[],r=new Map,a=[];for(const o of e)if(o.type==="add"){a.push(o);continue}else if(o.type==="remove"||o.type==="replace")r.set(o.id,[o]);else{const i=r.get(o.id);i?i.push(o):r.set(o.id,[o])}for(const o of t){const i=r.get(o.id);if(!i){n.push(o);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const s={...o};for(const c of i)Nle(c,s);n.push(s)}return a.length&&a.forEach(o=>{o.index!==void 0?n.splice(o.index,0,{...o.item}):n.push({...o.item})}),n}function Nle(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function fs(e,t){return Z5(e,t)}function kd(e,t){return Z5(e,t)}function ps(e,t){return{id:e,type:"select",selected:t}}function Tc(e,t=new Set,n=!1){const r=[];for(const[a,o]of e){const i=t.has(a);!(o.selected===void 0&&!i)&&o.selected!==i&&(n&&(o.selected=i),r.push(ps(o.id,i)))}return r}function K5({items:e=[],lookup:t}){var a;const n=[],r=new Map(e.map(o=>[o.id,o]));for(const[o,i]of e.entries()){const s=t.get(i.id),c=((a=s==null?void 0:s.internals)==null?void 0:a.userNode)??s;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:o})}for(const[o]of t)r.get(o)===void 0&&n.push({id:o,type:"remove"});return n}function X5(e){return{id:e.id,type:"remove"}}const Y5=e=>mce(e),Mle=e=>V3(e);function J5(e){return g.forwardRef(e)}const Ale=typeof window<"u"?g.useLayoutEffect:g.useEffect;function Q5(e){const[t,n]=g.useState(BigInt(0)),[r]=g.useState(()=>Tle(()=>n(a=>a+BigInt(1))));return Ale(()=>{const a=r.get();a.length&&(e(a),r.reset())},[t]),r}function Tle(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const G5=g.createContext(null);function Rle({children:e}){const t=Vt(),n=g.useCallback(s=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:f}=t.getState();let p=c;for(const m of s)p=typeof m=="function"?m(p):m;u?l(p):d&&d(K5({items:p,lookup:f}))},[]),r=Q5(n),a=g.useCallback(s=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:f}=t.getState();let p=c;for(const m of s)p=typeof m=="function"?m(p):m;u?l(p):d&&d(K5({items:p,lookup:f}))},[]),o=Q5(a),i=g.useMemo(()=>({nodeQueue:r,edgeQueue:o}),[]);return h.jsx(G5.Provider,{value:i,children:e})}function Ile(){const e=g.useContext(G5);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Dle=e=>!!e.panZoom;function xr(){const e=Ple(),t=Vt(),n=Ile(),r=at(Dle),a=g.useMemo(()=>{const o=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},s=d=>{n.edgeQueue.push(d)},c=d=>{var b,w;const{nodeLookup:f,nodeOrigin:p}=t.getState(),m=Y5(d)?d:f.get(d.id),y=m.parentId?G3(m.position,m.measured,m.parentId,f,p):m.position,v={id:m.id,position:y,width:((b=m.measured)==null?void 0:b.width)??m.width,height:((w=m.measured)==null?void 0:w.height)??m.height,data:m.data};return kc(v)},l=(d,f,p={replace:!1})=>{i(m=>m.map(y=>{if(y.id===d){const v=typeof f=="function"?f(y):f;return p.replace&&Y5(v)?v:{...y,...v}}return y}))},u=(d,f,p={replace:!1})=>{s(m=>m.map(y=>{if(y.id===d){const v=typeof f=="function"?f(y):f;return p.replace&&Mle(v)?v:{...y,...v}}return y}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=o(d))==null?void 0:f.internals.userNode},getInternalNode:o,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:s,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(p=>[...p,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(p=>[...p,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:p}=t.getState(),[m,y,v]=p;return{nodes:d.map(b=>({...b})),edges:f.map(b=>({...b})),viewport:{x:m,y,zoom:v}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:p,edges:m,onNodesDelete:y,onEdgesDelete:v,triggerNodeChanges:b,triggerEdgeChanges:w,onDelete:_,onBeforeDelete:x}=t.getState(),{nodes:S,edges:j}=await vce({nodesToRemove:d,edgesToRemove:f,nodes:p,edges:m,onBeforeDelete:x}),E=j.length>0,O=S.length>0;if(E){const P=j.map(X5);v==null||v(j),w(P)}if(O){const P=S.map(X5);y==null||y(S),b(P)}return(O||E)&&(_==null||_({nodes:S,edges:j})),{deletedNodes:S,deletedEdges:j}},getIntersectingNodes:(d,f=!0,p)=>{const m=Y3(d),y=m?d:c(d),v=p!==void 0;return y?(p||t.getState().nodes).filter(b=>{const w=t.getState().nodeLookup.get(b.id);if(w&&!m&&(b.id===d.id||!w.internals.positionAbsolute))return!1;const _=kc(v?b:w),x=Sd(_,y);return f&&x>0||x>=y.width*y.height}):[]},isNodeIntersecting:(d,f,p=!0)=>{const m=Y3(d)?d:c(d);if(!m)return!1;const y=Sd(m,f);return p&&y>0||y>=m.width*m.height},updateNode:l,updateNodeData:(d,f,p={replace:!1})=>{l(d,m=>{const y=typeof f=="function"?f(m):f;return p.replace?{...m,data:y}:{...m,data:{...m.data,...y}}},p)},updateEdge:u,updateEdgeData:(d,f,p={replace:!1})=>{u(d,m=>{const y=typeof f=="function"?f(m):f;return p.replace?{...m,data:y}:{...m,data:{...m.data,...y}}},p)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:p}=t.getState();return yce(d,{nodeLookup:f,nodeOrigin:p})},getHandleConnections:({type:d,id:f,nodeId:p})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${p}-${d}-${f??null}`))==null?void 0:m.values())??[])}}},[]);return g.useMemo(()=>({...a,...e,viewportInitialized:r}),[r])}const eL=e=>e.selected,Lle={actInsideInputWithModifier:!1},$le=typeof window<"u"?window:void 0;function Fle({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=Vt(),{deleteElements:r}=xr(),a=Cd(e,Lle),o=Cd(t,{target:$le});g.useEffect(()=>{if(a){const{edges:i,nodes:s}=n.getState();r({nodes:s.filter(eL),edges:i.filter(eL)}),n.setState({nodesSelectionActive:!1})}},[a]),g.useEffect(()=>{n.setState({multiSelectionActive:o})},[o])}function Ble(e){const t=Vt();g.useEffect(()=>{const n=()=>{var a,o;if(!e.current)return!1;const r=um(e.current);(r.height===0||r.width===0)&&((o=(a=t.getState()).onError)==null||o.call(a,"004",To.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const ym={position:"absolute",width:"100%",height:"100%",top:0,left:0},zle=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function Ule({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:a=.5,panOnScrollMode:o=vi.Free,zoomOnDoubleClick:i=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:p=!0,children:m,noWheelClassName:y,noPanClassName:v,onViewportChange:b,isControlledViewport:w,paneClickDistance:_}){const x=Vt(),S=g.useRef(null),{userSelectionActive:j,lib:E}=at(zle,Kt),O=Cd(f),P=g.useRef();Ble(S);const k=g.useCallback(N=>{b==null||b({x:N[0],y:N[1],zoom:N[2]}),w||x.setState({transform:N})},[b,w]);return g.useEffect(()=>{if(S.current){P.current=Jce({domNode:S.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:_,onDraggingChange:C=>x.setState({paneDragging:C}),onPanZoomStart:(C,T)=>{const{onViewportChangeStart:A,onMoveStart:I}=x.getState();I==null||I(C,T),A==null||A(T)},onPanZoom:(C,T)=>{const{onViewportChange:A,onMove:I}=x.getState();I==null||I(C,T),A==null||A(T)},onPanZoomEnd:(C,T)=>{const{onViewportChangeEnd:A,onMoveEnd:I}=x.getState();I==null||I(C,T),A==null||A(T)}});const{x:N,y:R,zoom:M}=P.current.getViewport();return x.setState({panZoom:P.current,transform:[N,R,M],domNode:S.current.closest(".react-flow")}),()=>{var C;(C=P.current)==null||C.destroy()}}},[]),g.useEffect(()=>{var N;(N=P.current)==null||N.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:a,panOnScrollMode:o,zoomOnDoubleClick:i,panOnDrag:s,zoomActivationKeyPressed:O,preventScrolling:p,noPanClassName:v,userSelectionActive:j,noWheelClassName:y,lib:E,onTransformChange:k})},[e,t,n,r,a,o,i,s,O,p,v,j,y,E,k]),h.jsx("div",{className:"react-flow__renderer",ref:S,style:ym,children:m})}const Vle=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Wle(){const{userSelectionActive:e,userSelectionRect:t}=at(Vle,Kt);return e&&t?h.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const A_=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Hle=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function qle({isSelecting:e,selectionKeyPressed:t,selectionMode:n=wd.Full,panOnDrag:r,selectionOnDrag:a,onSelectionStart:o,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:f,children:p}){const m=g.useRef(null),y=Vt(),v=g.useRef(0),b=g.useRef(0),w=g.useRef(),_=g.useRef(new Map),{userSelectionActive:x,elementsSelectable:S,dragging:j}=at(Hle,Kt),E=S&&(e||x),O=g.useRef(!1),P=g.useRef(!1),k=()=>{y.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,b.current=0},N=F=>{if(O.current){O.current=!1;return}s==null||s(F),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},R=F=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){F.preventDefault();return}c==null||c(F)},M=l?F=>l(F):void 0,C=F=>{var te,L,$,W;const{resetSelectedElements:D,domNode:V,edgeLookup:U}=y.getState();if(w.current=V==null?void 0:V.getBoundingClientRect(),!S||!e||F.button!==0||F.target!==m.current||!w.current)return;(L=(te=F.target)==null?void 0:te.setPointerCapture)==null||L.call(te,F.pointerId),P.current=!0,O.current=!1,_.current=new Map;for(const[q,Z]of U)_.current.set(Z.source,(($=_.current.get(Z.source))==null?void 0:$.add(q))||new Set([q])),_.current.set(Z.target,((W=_.current.get(Z.target))==null?void 0:W.add(q))||new Set([q]));const{x:B,y:K}=Io(F.nativeEvent,w.current);D(),y.setState({userSelectionRect:{width:0,height:0,startX:B,startY:K,x:B,y:K}}),o==null||o(F)},T=F=>{const{userSelectionRect:D,edgeLookup:V,transform:U,nodeLookup:B,triggerNodeChanges:K,triggerEdgeChanges:te}=y.getState();if(!w.current||!D)return;O.current=!0;const{x:L,y:$}=Io(F.nativeEvent,w.current),{startX:W,startY:q}=D,Z={startX:W,startY:q,x:L<W?L:W,y:$<q?$:q,width:Math.abs(L-W),height:Math.abs($-q)},ee=W3(B,Z,U,n===wd.Partial,!0),oe=new Set,H=new Set;for(const le of ee){H.add(le.id);const ie=_.current.get(le.id);if(ie)for(const pe of ie)oe.add(pe)}if(v.current!==H.size){v.current=H.size;const le=Tc(B,H,!0);K(le)}if(b.current!==oe.size){b.current=oe.size;const le=Tc(V,oe);te(le)}y.setState({userSelectionRect:Z,userSelectionActive:!0,nodesSelectionActive:!1})},A=F=>{var V,U;if(F.button!==0||!P.current)return;(U=(V=F.target)==null?void 0:V.releasePointerCapture)==null||U.call(V,F.pointerId);const{userSelectionRect:D}=y.getState();!x&&D&&F.target===m.current&&(N==null||N(F)),v.current>0&&y.setState({nodesSelectionActive:!0}),k(),i==null||i(F),(t||a)&&(O.current=!1),P.current=!1},I=r===!0||Array.isArray(r)&&r.includes(0);return h.jsxs("div",{className:sn(["react-flow__pane",{draggable:I,dragging:j,selection:e}]),onClick:E?void 0:A_(N,m),onContextMenu:A_(R,m),onWheel:A_(M,m),onPointerEnter:E?void 0:u,onPointerDown:E?C:d,onPointerMove:E?T:d,onPointerUp:E?A:void 0,onPointerLeave:f,ref:m,style:ym,children:[p,h.jsx(Wle,{})]})}function T_({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:a,unselectNodesAndEdges:o,multiSelectionActive:i,nodeLookup:s,onError:c}=t.getState(),l=s.get(e);if(!l){c==null||c("012",To.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(o({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):a([e])}function tL({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:a,isSelectable:o,nodeClickDistance:i}){const s=Vt(),[c,l]=g.useState(!1),u=g.useRef();return g.useEffect(()=>{u.current=Lce({getStoreItems:()=>s.getState(),onNodeMouseDown:d=>{T_({id:d,store:s,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),g.useEffect(()=>{var d,f;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:o,nodeId:a,nodeClickDistance:i}),()=>{var p;(p=u.current)==null||p.destroy()}},[n,r,t,o,e,a]),c}const Zle=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function nL(){const e=Vt();return g.useCallback(t=>{const{nodeExtent:n,snapToGrid:r,snapGrid:a,nodesDraggable:o,onError:i,updateNodePositions:s,nodeLookup:c,nodeOrigin:l}=e.getState(),u=new Map,d=Zle(o),f=r?a[0]:5,p=r?a[1]:5,m=t.direction.x*f*t.factor,y=t.direction.y*p*t.factor;for(const[,v]of c){if(!d(v))continue;let b={x:v.internals.positionAbsolute.x+m,y:v.internals.positionAbsolute.y+y};r&&(b=cm(b,a));const{position:w,positionAbsolute:_}=H3({nodeId:v.id,nextPosition:b,nodeLookup:c,nodeExtent:n,nodeOrigin:l,onError:i});v.position=w,v.internals.positionAbsolute=_,u.set(v.id,v)}s(u)},[])}const R_=g.createContext(null),Kle=R_.Provider;R_.Consumer;const I_=()=>g.useContext(R_),Xle=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Yle=(e,t,n)=>r=>{const{connectionClickStartHandle:a,connectionMode:o,connection:i}=r,{fromHandle:s,toHandle:c,isValid:l}=i,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,connectingTo:u,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,isPossibleEndHandle:o===Oc.Strict?(s==null?void 0:s.type)!==n:e!==(s==null?void 0:s.nodeId)||t!==(s==null?void 0:s.id),connectionInProcess:!!s,valid:u&&l}};function Jle({type:e="source",position:t=be.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:a=!0,isConnectableEnd:o=!0,id:i,onConnect:s,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},p){var C,T;const m=i||null,y=e==="target",v=Vt(),b=I_(),{connectOnClick:w,noPanClassName:_,rfId:x}=at(Xle,Kt),{connectingFrom:S,connectingTo:j,clickConnecting:E,isPossibleEndHandle:O,connectionInProcess:P,valid:k}=at(Yle(b,m,e),Kt);b||((T=(C=v.getState()).onError)==null||T.call(C,"010",To.error010()));const N=A=>{const{defaultEdgeOptions:I,onConnect:F,hasDefaultEdges:D}=v.getState(),V={...I,...A};if(D){const{edges:U,setEdges:B}=v.getState();B(s5(V,U))}F==null||F(V),s==null||s(V)},R=A=>{if(!b)return;const I=t5(A.nativeEvent);if(a&&(I&&A.button===0||!I)){const F=v.getState();C_.onPointerDown(A.nativeEvent,{autoPanOnConnect:F.autoPanOnConnect,connectionMode:F.connectionMode,connectionRadius:F.connectionRadius,domNode:F.domNode,nodeLookup:F.nodeLookup,lib:F.lib,isTarget:y,handleId:m,nodeId:b,flowId:F.rfId,panBy:F.panBy,cancelConnection:F.cancelConnection,onConnectStart:F.onConnectStart,onConnectEnd:F.onConnectEnd,updateConnection:F.updateConnection,onConnect:N,isValidConnection:n||F.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:F.autoPanSpeed})}I?u==null||u(A):d==null||d(A)},M=A=>{const{onClickConnectStart:I,onClickConnectEnd:F,connectionClickStartHandle:D,connectionMode:V,isValidConnection:U,lib:B,rfId:K,nodeLookup:te,connection:L}=v.getState();if(!b||!D&&!a)return;if(!D){I==null||I(A.nativeEvent,{nodeId:b,handleId:m,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:b,type:e,id:m}});return}const $=e5(A.target),W=n||U,{connection:q,isValid:Z}=C_.isValid(A.nativeEvent,{handle:{nodeId:b,id:m,type:e},connectionMode:V,fromNodeId:D.nodeId,fromHandleId:D.id||null,fromType:D.type,isValidConnection:W,flowId:K,doc:$,lib:B,nodeLookup:te});Z&&q&&N(q);const ee=structuredClone(L);delete ee.inProgress,ee.toPosition=ee.toHandle?ee.toHandle.position:null,F==null||F(A,ee),v.setState({connectionClickStartHandle:null})};return h.jsx("div",{"data-handleid":m,"data-nodeid":b,"data-handlepos":t,"data-id":`${x}-${b}-${m}-${e}`,className:sn(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",_,l,{source:!y,target:y,connectable:r,connectablestart:a,connectableend:o,clickconnecting:E,connectingfrom:S,connectingto:j,valid:k,connectionindicator:r&&(!P||O)&&(P?o:a)}]),onMouseDown:R,onTouchStart:R,onClick:w?M:void 0,ref:p,...f,children:c})}const Pd=g.memo(J5(Jle));function Qle({data:e,isConnectable:t,sourcePosition:n=be.Bottom}){return h.jsxs(h.Fragment,{children:[e==null?void 0:e.label,h.jsx(Pd,{type:"source",position:n,isConnectable:t})]})}function Gle({data:e,isConnectable:t,targetPosition:n=be.Top,sourcePosition:r=be.Bottom}){return h.jsxs(h.Fragment,{children:[h.jsx(Pd,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,h.jsx(Pd,{type:"source",position:r,isConnectable:t})]})}function eue(){return null}function tue({data:e,isConnectable:t,targetPosition:n=be.Top}){return h.jsxs(h.Fragment,{children:[h.jsx(Pd,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const gm={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},rL={input:Qle,default:Gle,output:tue,group:eue};function nue(e){var t,n,r,a;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((a=e.style)==null?void 0:a.height)}}const rue=e=>{const{width:t,height:n,x:r,y:a}=_d(e.nodeLookup,{filter:o=>!!o.selected});return{width:ca(t)?t:null,height:ca(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`}};function aue({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Vt(),{width:a,height:o,transformString:i,userSelectionActive:s}=at(rue,Kt),c=nL(),l=g.useRef(null);if(g.useEffect(()=>{var f;n||((f=l.current)==null||f.focus({preventScroll:!0}))},[n]),tL({nodeRef:l}),s||!a||!o)return null;const u=e?f=>{const p=r.getState().nodes.filter(m=>m.selected);e(f,p)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(gm,f.key)&&c({direction:gm[f.key],factor:f.shiftKey?4:1})};return h.jsx("div",{className:sn(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:h.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:a,height:o}})})}const aL=typeof window<"u"?window:void 0,oue=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function oL({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:m,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:_,panOnScroll:x,panOnScrollSpeed:S,panOnScrollMode:j,zoomOnDoubleClick:E,panOnDrag:O,defaultViewport:P,translateExtent:k,minZoom:N,maxZoom:R,preventScrolling:M,onSelectionContextMenu:C,noWheelClassName:T,noPanClassName:A,disableKeyboardA11y:I,onViewportChange:F,isControlledViewport:D}){const{nodesSelectionActive:V,userSelectionActive:U}=at(oue),B=Cd(l,{target:aL}),K=Cd(y,{target:aL}),te=K||O,L=K||x,$=u&&te!==!0,W=B||U||$;return Fle({deleteKeyCode:c,multiSelectionKeyCode:m}),h.jsx(Ule,{onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:_,panOnScroll:L,panOnScrollSpeed:S,panOnScrollMode:j,zoomOnDoubleClick:E,panOnDrag:!B&&te,defaultViewport:P,translateExtent:k,minZoom:N,maxZoom:R,zoomActivationKeyCode:v,preventScrolling:M,noWheelClassName:T,noPanClassName:A,onViewportChange:F,isControlledViewport:D,paneClickDistance:s,children:h.jsxs(qle,{onSelectionStart:f,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,panOnDrag:te,isSelecting:!!W,selectionMode:d,selectionKeyPressed:B,selectionOnDrag:$,children:[e,V&&h.jsx(aue,{onSelectionContextMenu:C,noPanClassName:A,disableKeyboardA11y:I})]})})}oL.displayName="FlowRenderer";const iue=g.memo(oL),sue=e=>t=>e?W3(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function cue(e){return at(g.useCallback(sue(e),[e]),Kt)}const lue=e=>e.updateNodeInternals;function uue(){const e=at(lue),[t]=g.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(a=>{const o=a.target.getAttribute("data-id");r.set(o,{id:o,nodeElement:a.target,force:!0})}),e(r)}));return g.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function due({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const a=Vt(),o=g.useRef(null),i=g.useRef(null),s=g.useRef(e.sourcePosition),c=g.useRef(e.targetPosition),l=g.useRef(t),u=n&&!!e.internals.handleBounds;return g.useEffect(()=>{o.current&&!e.hidden&&(!u||i.current!==o.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(o.current),i.current=o.current)},[u,e.hidden]),g.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),g.useEffect(()=>{if(o.current){const d=l.current!==t,f=s.current!==e.sourcePosition,p=c.current!==e.targetPosition;(d||f||p)&&(l.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:o.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),o}function fue({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:a,onContextMenu:o,onDoubleClick:i,nodesDraggable:s,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:f,noPanClassName:p,disableKeyboardA11y:m,rfId:y,nodeTypes:v,nodeExtent:b,nodeClickDistance:w,onError:_}){const{node:x,internals:S,isParent:j}=at(q=>{const Z=q.nodeLookup.get(e),ee=q.parentLookup.has(e);return{node:Z,internals:Z.internals,isParent:ee}},Kt);let E=x.type||"default",O=(v==null?void 0:v[E])||rL[E];O===void 0&&(_==null||_("003",To.error003(E)),E="default",O=rL.default);const P=!!(x.draggable||s&&typeof x.draggable>"u"),k=!!(x.selectable||c&&typeof x.selectable>"u"),N=!!(x.connectable||l&&typeof x.connectable>"u"),R=!!(x.focusable||u&&typeof x.focusable>"u"),M=Vt(),C=Q3(x),T=due({node:x,nodeType:E,hasDimensions:C,resizeObserver:d}),A=tL({nodeRef:T,disabled:x.hidden||!P,noDragClassName:f,handleSelector:x.dragHandle,nodeId:e,isSelectable:k,nodeClickDistance:w}),I=nL();if(x.hidden)return null;const F=Ro(x),D=nue(x),V=k||P||t||n||r||a,U=n?q=>n(q,{...S.userNode}):void 0,B=r?q=>r(q,{...S.userNode}):void 0,K=a?q=>a(q,{...S.userNode}):void 0,te=o?q=>o(q,{...S.userNode}):void 0,L=i?q=>i(q,{...S.userNode}):void 0,$=q=>{const{selectNodesOnDrag:Z,nodeDragThreshold:ee}=M.getState();k&&(!Z||!P||ee>0)&&T_({id:e,store:M,nodeRef:T}),t&&t(q,{...S.userNode})},W=q=>{if(!(v_(q.nativeEvent)||m))if($3.includes(q.key)&&k){const Z=q.key==="Escape";T_({id:e,store:M,unselect:Z,nodeRef:T})}else P&&x.selected&&Object.prototype.hasOwnProperty.call(gm,q.key)&&(M.setState({ariaLiveMessage:`Moved selected node ${q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~S.positionAbsolute.x}, y: ${~~S.positionAbsolute.y}`}),I({direction:gm[q.key],factor:q.shiftKey?4:1}))};return h.jsx("div",{className:sn(["react-flow__node",`react-flow__node-${E}`,{[p]:P},x.className,{selected:x.selected,selectable:k,parent:j,draggable:P,dragging:A}]),ref:T,style:{zIndex:S.z,transform:`translate(${S.positionAbsolute.x}px,${S.positionAbsolute.y}px)`,pointerEvents:V?"all":"none",visibility:C?"visible":"hidden",...x.style,...D},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:U,onMouseMove:B,onMouseLeave:K,onContextMenu:te,onClick:$,onDoubleClick:L,onKeyDown:R?W:void 0,tabIndex:R?0:void 0,role:R?"button":void 0,"aria-describedby":m?void 0:`${$5}-${y}`,"aria-label":x.ariaLabel,children:h.jsx(Kle,{value:e,children:h.jsx(O,{id:e,data:x.data,type:E,positionAbsoluteX:S.positionAbsolute.x,positionAbsoluteY:S.positionAbsolute.y,selected:x.selected,selectable:k,draggable:P,deletable:x.deletable??!0,isConnectable:N,sourcePosition:x.sourcePosition,targetPosition:x.targetPosition,dragging:A,dragHandle:x.dragHandle,zIndex:S.z,parentId:x.parentId,...F})})})}const pue=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function iL(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,onError:o}=at(pue,Kt),i=cue(e.onlyRenderVisibleElements),s=uue();return h.jsx("div",{className:"react-flow__nodes",style:ym,children:i.map(c=>h.jsx(fue,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:o},c))})}iL.displayName="NodeRenderer";const hue=g.memo(iL);function mue(e){return at(g.useCallback(t=>{if(!e)return t.edges.map(r=>r.id);const n=[];if(t.width&&t.height)for(const r of t.edges){const a=t.nodeLookup.get(r.source),o=t.nodeLookup.get(r.target);a&&o&&_ce({sourceNode:a,targetNode:o,width:t.width,height:t.height,transform:t.transform})&&n.push(r.id)}return n},[e]),Kt)}const yue=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),gue=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),sL={[am.Arrow]:yue,[am.ArrowClosed]:gue};function vue(e){const t=Vt();return g.useMemo(()=>{var n,r;return Object.prototype.hasOwnProperty.call(sL,e)?sL[e]:((r=(n=t.getState()).onError)==null||r.call(n,"009",To.error009(e)),null)},[e])}const bue=({id:e,type:t,color:n,width:r=12.5,height:a=12.5,markerUnits:o="strokeWidth",strokeWidth:i,orient:s="auto-start-reverse"})=>{const c=vue(t);return c?h.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:h.jsx(c,{color:n,strokeWidth:i})}):null},cL=({defaultColor:e,rfId:t})=>{const n=at(o=>o.edges),r=at(o=>o.defaultEdgeOptions),a=g.useMemo(()=>Pce(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return a.length?h.jsx("svg",{className:"react-flow__marker",children:h.jsx("defs",{children:a.map(o=>h.jsx(bue,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})}):null};cL.displayName="MarkerDefinitions";var wue=g.memo(cL);function lL({x:e,y:t,label:n,labelStyle:r={},labelShowBg:a=!0,labelBgStyle:o={},labelBgPadding:i=[2,4],labelBgBorderRadius:s=2,children:c,className:l,...u}){const[d,f]=g.useState({x:1,y:0,width:0,height:0}),p=sn(["react-flow__edge-textwrapper",l]),m=g.useRef(null);return g.useEffect(()=>{if(m.current){const y=m.current.getBBox();f({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),typeof n>"u"||!n?null:h.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:p,visibility:d.width?"visible":"hidden",...u,children:[a&&h.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),h.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:m,style:r,children:n}),c]})}lL.displayName="EdgeText";const xue=g.memo(lL);function vm({id:e,path:t,labelX:n,labelY:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,className:p,interactionWidth:m=20}){return h.jsxs(h.Fragment,{children:[h.jsx("path",{id:e,style:u,d:t,fill:"none",className:sn(["react-flow__edge-path",p]),markerEnd:d,markerStart:f}),m&&h.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),a&&ca(n)&&ca(r)?h.jsx(xue,{x:n,y:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l}):null]})}function uL({pos:e,x1:t,y1:n,x2:r,y2:a}){return e===be.Left||e===be.Right?[.5*(t+r),n]:[t,.5*(n+a)]}function dL({sourceX:e,sourceY:t,sourcePosition:n=be.Bottom,targetX:r,targetY:a,targetPosition:o=be.Top}){const[i,s]=uL({pos:n,x1:e,y1:t,x2:r,y2:a}),[c,l]=uL({pos:o,x1:r,y1:a,x2:e,y2:t}),[u,d,f,p]=r5({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:i,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${s} ${c},${l} ${r},${a}`,u,d,f,p]}function fL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=be.Bottom,targetPosition:s=be.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:v,interactionWidth:b})=>{const[w,_,x]=dL({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s}),S=e.isInternal?void 0:t;return h.jsx(vm,{id:S,path:w,labelX:_,labelY:x,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:v,interactionWidth:b})})}const _ue=fL({isInternal:!1}),pL=fL({isInternal:!0});_ue.displayName="SimpleBezierEdge",pL.displayName="SimpleBezierEdgeInternal";function hL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,sourcePosition:p=be.Bottom,targetPosition:m=be.Top,markerEnd:y,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[_,x,S]=b_({sourceX:n,sourceY:r,sourcePosition:p,targetX:a,targetY:o,targetPosition:m,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset}),j=e.isInternal?void 0:t;return h.jsx(vm,{id:j,path:_,labelX:x,labelY:S,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:y,markerStart:v,interactionWidth:w})})}const mL=hL({isInternal:!1}),yL=hL({isInternal:!0});mL.displayName="SmoothStepEdge",yL.displayName="SmoothStepEdgeInternal";function gL(e){return g.memo(({id:t,...n})=>{var a;const r=e.isInternal?void 0:t;return h.jsx(mL,{...n,id:r,pathOptions:g.useMemo(()=>{var o;return{borderRadius:0,offset:(o=n.pathOptions)==null?void 0:o.offset}},[(a=n.pathOptions)==null?void 0:a.offset])})})}const Sue=gL({isInternal:!1}),vL=gL({isInternal:!0});Sue.displayName="StepEdge",vL.displayName="StepEdgeInternal";function bL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:y})=>{const[v,b,w]=c5({sourceX:n,sourceY:r,targetX:a,targetY:o}),_=e.isInternal?void 0:t;return h.jsx(vm,{id:_,path:v,labelX:b,labelY:w,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:y})})}const jue=bL({isInternal:!1}),wL=bL({isInternal:!0});jue.displayName="StraightEdge",wL.displayName="StraightEdgeInternal";function xL(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=be.Bottom,targetPosition:s=be.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[_,x,S]=o5({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s,curvature:b==null?void 0:b.curvature}),j=e.isInternal?void 0:t;return h.jsx(vm,{id:j,path:_,labelX:x,labelY:S,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:v,interactionWidth:w})})}const Eue=xL({isInternal:!1}),_L=xL({isInternal:!0});Eue.displayName="BezierEdge",_L.displayName="BezierEdgeInternal";const SL={default:_L,straight:wL,step:vL,smoothstep:yL,simplebezier:pL},jL={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Oue=(e,t,n)=>n===be.Left?e-t:n===be.Right?e+t:e,Cue=(e,t,n)=>n===be.Top?e-t:n===be.Bottom?e+t:e,EL="react-flow__edgeupdater";function OL({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:a,onMouseEnter:o,onMouseOut:i,type:s}){return h.jsx("circle",{onMouseDown:a,onMouseEnter:o,onMouseOut:i,className:sn([EL,`${EL}-${s}`]),cx:Oue(t,r,e),cy:Cue(n,r,e),r,stroke:"transparent",fill:"transparent"})}function kue({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:a,targetX:o,targetY:i,sourcePosition:s,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:f,setUpdateHover:p}){const m=Vt(),y=(x,S)=>{if(x.button!==0)return;const{autoPanOnConnect:j,domNode:E,isValidConnection:O,connectionMode:P,connectionRadius:k,lib:N,onConnectStart:R,onConnectEnd:M,cancelConnection:C,nodeLookup:T,rfId:A,panBy:I,updateConnection:F}=m.getState(),D=S.type==="target";f(!0),u==null||u(x,n,S.type);const V=(B,K)=>{f(!1),d==null||d(B,n,S.type,K)},U=B=>l==null?void 0:l(n,B);C_.onPointerDown(x.nativeEvent,{autoPanOnConnect:j,connectionMode:P,connectionRadius:k,domNode:E,handleId:S.id,nodeId:S.nodeId,nodeLookup:T,isTarget:D,edgeUpdaterType:S.type,lib:N,flowId:A,cancelConnection:C,panBy:I,isValidConnection:O,onConnect:U,onConnectStart:R,onConnectEnd:M,onReconnectEnd:V,updateConnection:F,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle})},v=x=>y(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=x=>y(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>p(!0),_=()=>p(!1);return h.jsxs(h.Fragment,{children:[(e===!0||e==="source")&&h.jsx(OL,{position:s,centerX:r,centerY:a,radius:t,onMouseDown:v,onMouseEnter:w,onMouseOut:_,type:"source"}),(e===!0||e==="target")&&h.jsx(OL,{position:c,centerX:o,centerY:i,radius:t,onMouseDown:b,onMouseEnter:w,onMouseOut:_,type:"target"})]})}function Pue({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:a,onDoubleClick:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:p,rfId:m,edgeTypes:y,noPanClassName:v,onError:b,disableKeyboardA11y:w}){let _=at(H=>H.edgeLookup.get(e));const x=at(H=>H.defaultEdgeOptions);_=x?{...x,..._}:_;let S=_.type||"default",j=(y==null?void 0:y[S])||SL[S];j===void 0&&(b==null||b("011",To.error011(S)),S="default",j=SL.default);const E=!!(_.focusable||t&&typeof _.focusable>"u"),O=typeof d<"u"&&(_.reconnectable||n&&typeof _.reconnectable>"u"),P=!!(_.selectable||r&&typeof _.selectable>"u"),k=g.useRef(null),[N,R]=g.useState(!1),[M,C]=g.useState(!1),T=Vt(),{zIndex:A,sourceX:I,sourceY:F,targetX:D,targetY:V,sourcePosition:U,targetPosition:B}=at(g.useCallback(H=>{const le=H.nodeLookup.get(_.source),ie=H.nodeLookup.get(_.target);if(!le||!ie)return{zIndex:_.zIndex,...jL};const pe=kce({id:e,sourceNode:le,targetNode:ie,sourceHandle:_.sourceHandle||null,targetHandle:_.targetHandle||null,connectionMode:H.connectionMode,onError:b});return{zIndex:xce({selected:_.selected,zIndex:_.zIndex,sourceNode:le,targetNode:ie,elevateOnSelect:H.elevateEdgesOnSelect}),...pe||jL}},[_.source,_.target,_.sourceHandle,_.targetHandle,_.selected,_.zIndex]),Kt),K=g.useMemo(()=>_.markerStart?`url('#${w_(_.markerStart,m)}')`:void 0,[_.markerStart,m]),te=g.useMemo(()=>_.markerEnd?`url('#${w_(_.markerEnd,m)}')`:void 0,[_.markerEnd,m]);if(_.hidden||I===null||F===null||D===null||V===null)return null;const L=H=>{var Oe;const{addSelectedEdges:le,unselectNodesAndEdges:ie,multiSelectionActive:pe}=T.getState();P&&(T.setState({nodesSelectionActive:!1}),_.selected&&pe?(ie({nodes:[],edges:[_]}),(Oe=k.current)==null||Oe.blur()):le([e])),a&&a(H,_)},$=o?H=>{o(H,{..._})}:void 0,W=i?H=>{i(H,{..._})}:void 0,q=s?H=>{s(H,{..._})}:void 0,Z=c?H=>{c(H,{..._})}:void 0,ee=l?H=>{l(H,{..._})}:void 0,oe=H=>{var le;if(!w&&$3.includes(H.key)&&P){const{unselectNodesAndEdges:ie,addSelectedEdges:pe}=T.getState();H.key==="Escape"?((le=k.current)==null||le.blur(),ie({edges:[_]})):pe([e])}};return h.jsx("svg",{style:{zIndex:A},children:h.jsxs("g",{className:sn(["react-flow__edge",`react-flow__edge-${S}`,_.className,v,{selected:_.selected,animated:_.animated,inactive:!P&&!a,updating:N,selectable:P}]),onClick:L,onDoubleClick:$,onContextMenu:W,onMouseEnter:q,onMouseMove:Z,onMouseLeave:ee,onKeyDown:E?oe:void 0,tabIndex:E?0:void 0,role:E?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":_.ariaLabel===null?void 0:_.ariaLabel||`Edge from ${_.source} to ${_.target}`,"aria-describedby":E?`${F5}-${m}`:void 0,ref:k,children:[!M&&h.jsx(j,{id:e,source:_.source,target:_.target,type:_.type,selected:_.selected,animated:_.animated,selectable:P,deletable:_.deletable??!0,label:_.label,labelStyle:_.labelStyle,labelShowBg:_.labelShowBg,labelBgStyle:_.labelBgStyle,labelBgPadding:_.labelBgPadding,labelBgBorderRadius:_.labelBgBorderRadius,sourceX:I,sourceY:F,targetX:D,targetY:V,sourcePosition:U,targetPosition:B,data:_.data,style:_.style,sourceHandleId:_.sourceHandle,targetHandleId:_.targetHandle,markerStart:K,markerEnd:te,pathOptions:"pathOptions"in _?_.pathOptions:void 0,interactionWidth:_.interactionWidth}),O&&h.jsx(kue,{edge:_,isReconnectable:O,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:p,sourceX:I,sourceY:F,targetX:D,targetY:V,sourcePosition:U,targetPosition:B,setUpdateHover:R,setReconnecting:C})]})})}const Nue=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function CL({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:a,onReconnect:o,onEdgeContextMenu:i,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:p,onReconnectEnd:m,disableKeyboardA11y:y}){const{edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,onError:_}=at(Nue,Kt),x=mue(t);return h.jsxs("div",{className:"react-flow__edges",children:[h.jsx(wue,{defaultColor:e,rfId:n}),x.map(S=>h.jsx(Pue,{id:S,edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,noPanClassName:a,onReconnect:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:f,onReconnectStart:p,onReconnectEnd:m,rfId:n,onError:_,edgeTypes:r,disableKeyboardA11y:y},S))]})}CL.displayName="EdgeRenderer";const Mue=g.memo(CL),Aue=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Tue({children:e}){const t=at(Aue);return h.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Rue(e){const t=xr(),n=g.useRef(!1);g.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Iue=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function Due(e){const t=at(Iue),n=Vt();return g.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Lue(e){return e.connection.inProgress?{...e.connection,to:jd(e.connection.to,e.transform)}:{...e.connection}}function $ue(e){return Lue}function Fue(e){const t=$ue();return at(t,Kt)}const Bue=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function zue({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:a,width:o,height:i,isValid:s,inProgress:c}=at(Bue,Kt);return o&&a&&c?h.jsx("svg",{style:e,width:o,height:i,className:"react-flow__connectionline react-flow__container",children:h.jsx("g",{className:sn(["react-flow__connection",U3(s)]),children:h.jsx(kL,{style:t,type:n,CustomComponent:r,isValid:s})})}):null}const kL=({style:e,type:t=bi.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:a,from:o,fromNode:i,fromHandle:s,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:f}=Fue();if(!a)return;if(n)return h.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:s,fromX:o.x,fromY:o.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:U3(r),toNode:u,toHandle:d});let p="";const m={sourceX:o.x,sourceY:o.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case bi.Bezier:[p]=o5(m);break;case bi.SimpleBezier:[p]=dL(m);break;case bi.Step:[p]=b_({...m,borderRadius:0});break;case bi.SmoothStep:[p]=b_(m);break;default:[p]=c5(m)}return h.jsx("path",{d:p,fill:"none",className:"react-flow__connection-path",style:e})};kL.displayName="ConnectionLine";const Uue={};function PL(e=Uue){g.useRef(e),Vt(),g.useEffect(()=>{},[e])}function Vue(){Vt(),g.useRef(!1),g.useEffect(()=>{},[])}function NL({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:o,onEdgeDoubleClick:i,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:p,connectionLineType:m,connectionLineStyle:y,connectionLineComponent:v,connectionLineContainerStyle:b,selectionKeyCode:w,selectionOnDrag:_,selectionMode:x,multiSelectionKeyCode:S,panActivationKeyCode:j,zoomActivationKeyCode:E,deleteKeyCode:O,onlyRenderVisibleElements:P,elementsSelectable:k,defaultViewport:N,translateExtent:R,minZoom:M,maxZoom:C,preventScrolling:T,defaultMarkerColor:A,zoomOnScroll:I,zoomOnPinch:F,panOnScroll:D,panOnScrollSpeed:V,panOnScrollMode:U,zoomOnDoubleClick:B,panOnDrag:K,onPaneClick:te,onPaneMouseEnter:L,onPaneMouseMove:$,onPaneMouseLeave:W,onPaneScroll:q,onPaneContextMenu:Z,paneClickDistance:ee,nodeClickDistance:oe,onEdgeContextMenu:H,onEdgeMouseEnter:le,onEdgeMouseMove:ie,onEdgeMouseLeave:pe,reconnectRadius:Oe,onReconnect:Ue,onReconnectStart:Ve,onReconnectEnd:Ce,noDragClassName:Ze,noWheelClassName:Je,noPanClassName:Qe,disableKeyboardA11y:Rt,nodeExtent:z,rfId:J,viewport:fe,onViewportChange:ve}){return PL(e),PL(t),Vue(),Rue(n),Due(fe),h.jsx(iue,{onPaneClick:te,onPaneMouseEnter:L,onPaneMouseMove:$,onPaneMouseLeave:W,onPaneContextMenu:Z,onPaneScroll:q,paneClickDistance:ee,deleteKeyCode:O,selectionKeyCode:w,selectionOnDrag:_,selectionMode:x,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:S,panActivationKeyCode:j,zoomActivationKeyCode:E,elementsSelectable:k,zoomOnScroll:I,zoomOnPinch:F,zoomOnDoubleClick:B,panOnScroll:D,panOnScrollSpeed:V,panOnScrollMode:U,panOnDrag:K,defaultViewport:N,translateExtent:R,minZoom:M,maxZoom:C,onSelectionContextMenu:d,preventScrolling:T,noDragClassName:Ze,noWheelClassName:Je,noPanClassName:Qe,disableKeyboardA11y:Rt,onViewportChange:ve,isControlledViewport:!!fe,children:h.jsxs(Tue,{children:[h.jsx(Mue,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:i,onReconnect:Ue,onReconnectStart:Ve,onReconnectEnd:Ce,onlyRenderVisibleElements:P,onEdgeContextMenu:H,onEdgeMouseEnter:le,onEdgeMouseMove:ie,onEdgeMouseLeave:pe,reconnectRadius:Oe,defaultMarkerColor:A,noPanClassName:Qe,disableKeyboardA11y:Rt,rfId:J}),h.jsx(zue,{style:y,type:m,component:v,containerStyle:b}),h.jsx("div",{className:"react-flow__edgelabel-renderer"}),h.jsx(hue,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:oe,onlyRenderVisibleElements:P,noPanClassName:Qe,noDragClassName:Ze,disableKeyboardA11y:Rt,nodeExtent:z,rfId:J}),h.jsx("div",{className:"react-flow__viewport-portal"})]})})}NL.displayName="GraphView";const Wue=g.memo(NL),ML=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}={})=>{const l=new Map,u=new Map,d=new Map,f=new Map,p=r??t??[],m=n??e??[],y=s??[0,0],v=c??bd;m5(d,f,p),S_(m,l,u,{nodeOrigin:y,nodeExtent:v,elevateNodesOnSelect:!1});let b=[0,0,1];if(i&&a&&o){const w=_d(l,{filter:j=>!!((j.width||j.initialWidth)&&(j.height||j.initialHeight))}),{x:_,y:x,zoom:S}=g_(w,a,o,.5,2,.1);b=[_,x,S]}return{rfId:"1",width:0,height:0,transform:b,nodes:m,nodeLookup:l,parentLookup:u,edges:p,edgeLookup:f,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:bd,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Oc.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:y,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...F3},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:bce,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},Hue=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c})=>ule((l,u)=>({...ML({nodes:e,edges:t,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:d=>{const{nodeLookup:f,parentLookup:p,nodeOrigin:m,elevateNodesOnSelect:y}=u();S_(d,f,p,{nodeOrigin:m,nodeExtent:c,elevateNodesOnSelect:y,checkEquality:!0}),l({nodes:d})},setEdges:d=>{const{connectionLookup:f,edgeLookup:p}=u();m5(f,p,d),l({edges:d})},setDefaultNodesAndEdges:(d,f)=>{if(d){const{setNodes:p}=u();p(d),l({hasDefaultNodes:!0})}if(f){const{setEdges:p}=u();p(f),l({hasDefaultEdges:!0})}},updateNodeInternals:(d,f={triggerFitView:!0})=>{const{triggerNodeChanges:p,nodeLookup:m,parentLookup:y,fitViewOnInit:v,fitViewDone:b,fitViewOnInitOptions:w,domNode:_,nodeOrigin:x,nodeExtent:S,debug:j,fitViewSync:E}=u(),{changes:O,updatedInternals:P}=Rce(d,m,y,_,x,S);if(P){if(Mce(m,y,{nodeOrigin:x,nodeExtent:S}),f.triggerFitView){let k=b;!b&&v&&(k=E({...w,nodes:w==null?void 0:w.nodes})),l({fitViewDone:k})}else l({});(O==null?void 0:O.length)>0&&(j&&console.log("React Flow: trigger node changes",O),p==null||p(O))}},updateNodePositions:(d,f=!1)=>{const p=[],m=[];for(const[y,v]of d){const b={id:y,type:"position",position:v.position,dragging:f};v!=null&&v.expandParent&&(v!=null&&v.parentId)&&b.position&&(p.push({id:y,parentId:v.parentId,rect:{...v.internals.positionAbsolute,width:v.measured.width,height:v.measured.height}}),b.position.x=Math.max(0,b.position.x),b.position.y=Math.max(0,b.position.y)),m.push(b)}if(p.length>0){const{nodeLookup:y,parentLookup:v,nodeOrigin:b}=u(),w=E_(p,y,v,b);m.push(...w)}u().triggerNodeChanges(m)},triggerNodeChanges:d=>{const{onNodesChange:f,setNodes:p,nodes:m,hasDefaultNodes:y,debug:v}=u();if(d!=null&&d.length){if(y){const b=fs(d,m);p(b)}v&&console.log("React Flow: trigger node changes",d),f==null||f(d)}},triggerEdgeChanges:d=>{const{onEdgesChange:f,setEdges:p,edges:m,hasDefaultEdges:y,debug:v}=u();if(d!=null&&d.length){if(y){const b=kd(d,m);p(b)}v&&console.log("React Flow: trigger edge changes",d),f==null||f(d)}},addSelectedNodes:d=>{const{multiSelectionActive:f,edgeLookup:p,nodeLookup:m,triggerNodeChanges:y,triggerEdgeChanges:v}=u();if(f){const b=d.map(w=>ps(w,!0));y(b);return}y(Tc(m,new Set([...d]),!0)),v(Tc(p))},addSelectedEdges:d=>{const{multiSelectionActive:f,edgeLookup:p,nodeLookup:m,triggerNodeChanges:y,triggerEdgeChanges:v}=u();if(f){const b=d.map(w=>ps(w,!0));v(b);return}v(Tc(p,new Set([...d]))),y(Tc(m,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:f}={})=>{const{edges:p,nodes:m,nodeLookup:y,triggerNodeChanges:v,triggerEdgeChanges:b}=u(),w=d||m,_=f||p,x=w.map(j=>{const E=y.get(j.id);return E&&(E.selected=!1),ps(j.id,!1)}),S=_.map(j=>ps(j.id,!1));v(x),b(S)},setMinZoom:d=>{const{panZoom:f,maxZoom:p}=u();f==null||f.setScaleExtent([d,p]),l({minZoom:d})},setMaxZoom:d=>{const{panZoom:f,minZoom:p}=u();f==null||f.setScaleExtent([p,d]),l({maxZoom:d})},setTranslateExtent:d=>{var f;(f=u().panZoom)==null||f.setTranslateExtent(d),l({translateExtent:d})},setPaneClickDistance:d=>{var f;(f=u().panZoom)==null||f.setClickDistance(d)},resetSelectedElements:()=>{const{edges:d,nodes:f,triggerNodeChanges:p,triggerEdgeChanges:m}=u(),y=f.reduce((b,w)=>w.selected?[...b,ps(w.id,!1)]:b,[]),v=d.reduce((b,w)=>w.selected?[...b,ps(w.id,!1)]:b,[]);p(y),m(v)},setNodeExtent:d=>{const{nodes:f,nodeLookup:p,parentLookup:m,nodeOrigin:y,elevateNodesOnSelect:v,nodeExtent:b}=u();d[0][0]===b[0][0]&&d[0][1]===b[0][1]&&d[1][0]===b[1][0]&&d[1][1]===b[1][1]||(S_(f,p,m,{nodeOrigin:y,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!1}),l({nodeExtent:d}))},panBy:d=>{const{transform:f,width:p,height:m,panZoom:y,translateExtent:v}=u();return Ice({delta:d,panZoom:y,transform:f,translateExtent:v,width:p,height:m})},fitView:d=>{const{panZoom:f,width:p,height:m,minZoom:y,maxZoom:v,nodeLookup:b}=u();if(!f)return Promise.resolve(!1);const w=h_(b,d);return m_({nodes:w,width:p,height:m,panZoom:f,minZoom:y,maxZoom:v},d)},fitViewSync:d=>{const{panZoom:f,width:p,height:m,minZoom:y,maxZoom:v,nodeLookup:b}=u();if(!f)return!1;const w=h_(b,d);return m_({nodes:w,width:p,height:m,panZoom:f,minZoom:y,maxZoom:v},d),w.size>0},cancelConnection:()=>{l({connection:{...F3}})},updateConnection:d=>{l({connection:d})},reset:()=>l({...ML()})}),Object.is);function que({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:a,initialHeight:o,fitView:i,nodeOrigin:s,nodeExtent:c,children:l}){const[u]=g.useState(()=>Hue({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}));return h.jsx(dle,{value:u,children:h.jsx(Rle,{children:l})})}function Zue({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:o,height:i,fitView:s,nodeOrigin:c,nodeExtent:l}){return g.useContext(hm)?h.jsx(h.Fragment,{children:e}):h.jsx(que,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:o,initialHeight:i,fitView:s,nodeOrigin:c,nodeExtent:l,children:e})}const Kue={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Xue({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:a,nodeTypes:o,edgeTypes:i,onNodeClick:s,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:p,onConnectStart:m,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:b,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:x,onNodeContextMenu:S,onNodeDoubleClick:j,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:P,onNodesDelete:k,onEdgesDelete:N,onDelete:R,onSelectionChange:M,onSelectionDragStart:C,onSelectionDrag:T,onSelectionDragStop:A,onSelectionContextMenu:I,onSelectionStart:F,onSelectionEnd:D,onBeforeDelete:V,connectionMode:U,connectionLineType:B=bi.Bezier,connectionLineStyle:K,connectionLineComponent:te,connectionLineContainerStyle:L,deleteKeyCode:$="Backspace",selectionKeyCode:W="Shift",selectionOnDrag:q=!1,selectionMode:Z=wd.Full,panActivationKeyCode:ee="Space",multiSelectionKeyCode:oe=lm()?"Meta":"Control",zoomActivationKeyCode:H=lm()?"Meta":"Control",snapToGrid:le,snapGrid:ie,onlyRenderVisibleElements:pe=!1,selectNodesOnDrag:Oe,nodesDraggable:Ue,nodesConnectable:Ve,nodesFocusable:Ce,nodeOrigin:Ze=B5,edgesFocusable:Je,edgesReconnectable:Qe,elementsSelectable:Rt=!0,defaultViewport:z=jle,minZoom:J=.5,maxZoom:fe=2,translateExtent:ve=bd,preventScrolling:Ie=!0,nodeExtent:Ke,defaultMarkerColor:Xe="#b1b1b7",zoomOnScroll:ut=!0,zoomOnPinch:Q=!0,panOnScroll:ne=!1,panOnScrollSpeed:se=.5,panOnScrollMode:ye=vi.Free,zoomOnDoubleClick:De=!0,panOnDrag:qt=!0,onPaneClick:$t,onPaneMouseEnter:We,onPaneMouseMove:xe,onPaneMouseLeave:ke,onPaneScroll:Pe,onPaneContextMenu:Ne,paneClickDistance:Ge=0,nodeClickDistance:It=0,children:Yt,onReconnect:X,onReconnectStart:re,onReconnectEnd:ce,onEdgeContextMenu:ge,onEdgeDoubleClick:Ae,onEdgeMouseEnter:Be,onEdgeMouseMove:qe,onEdgeMouseLeave:Te,reconnectRadius:Le=10,onNodesChange:je,onEdgesChange:Ye,noDragClassName:ot="nodrag",noWheelClassName:Ut="nowheel",noPanClassName:Zt="nopan",fitView:dt,fitViewOptions:ur,connectOnClick:nn,attributionPosition:Us,proOptions:Ta,defaultEdgeOptions:Hi,elevateNodesOnSelect:so,elevateEdgesOnSelect:pp,disableKeyboardA11y:zr=!1,autoPanOnConnect:Gl,autoPanOnNodeDrag:eu,autoPanSpeed:tu,connectionRadius:wt,isValidConnection:dr,onError:Vs,style:Jt,id:ai,nodeDragThreshold:xv,viewport:FP,onViewportChange:NDe,width:MDe,height:ADe,colorMode:TDe="light",debug:RDe,...IDe},DDe){const BP=ai||"1",LDe=kle(TDe);return h.jsx("div",{...IDe,style:{...Jt,...Kue},ref:DDe,className:sn(["react-flow",a,LDe]),"data-testid":"rf__wrapper",id:ai,children:h.jsxs(Zue,{nodes:e,edges:t,width:MDe,height:ADe,fitView:dt,nodeOrigin:Ze,nodeExtent:Ke,children:[h.jsx(Wue,{onInit:l,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:x,onNodeContextMenu:S,onNodeDoubleClick:j,nodeTypes:o,edgeTypes:i,connectionLineType:B,connectionLineStyle:K,connectionLineComponent:te,connectionLineContainerStyle:L,selectionKeyCode:W,selectionOnDrag:q,selectionMode:Z,deleteKeyCode:$,multiSelectionKeyCode:oe,panActivationKeyCode:ee,zoomActivationKeyCode:H,onlyRenderVisibleElements:pe,defaultViewport:z,translateExtent:ve,minZoom:J,maxZoom:fe,preventScrolling:Ie,zoomOnScroll:ut,zoomOnPinch:Q,zoomOnDoubleClick:De,panOnScroll:ne,panOnScrollSpeed:se,panOnScrollMode:ye,panOnDrag:qt,onPaneClick:$t,onPaneMouseEnter:We,onPaneMouseMove:xe,onPaneMouseLeave:ke,onPaneScroll:Pe,onPaneContextMenu:Ne,paneClickDistance:Ge,nodeClickDistance:It,onSelectionContextMenu:I,onSelectionStart:F,onSelectionEnd:D,onReconnect:X,onReconnectStart:re,onReconnectEnd:ce,onEdgeContextMenu:ge,onEdgeDoubleClick:Ae,onEdgeMouseEnter:Be,onEdgeMouseMove:qe,onEdgeMouseLeave:Te,reconnectRadius:Le,defaultMarkerColor:Xe,noDragClassName:ot,noWheelClassName:Ut,noPanClassName:Zt,rfId:BP,disableKeyboardA11y:zr,nodeExtent:Ke,viewport:FP,onViewportChange:NDe}),h.jsx(Cle,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:p,onConnectStart:m,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:b,nodesDraggable:Ue,nodesConnectable:Ve,nodesFocusable:Ce,edgesFocusable:Je,edgesReconnectable:Qe,elementsSelectable:Rt,elevateNodesOnSelect:so,elevateEdgesOnSelect:pp,minZoom:J,maxZoom:fe,nodeExtent:Ke,onNodesChange:je,onEdgesChange:Ye,snapToGrid:le,snapGrid:ie,connectionMode:U,translateExtent:ve,connectOnClick:nn,defaultEdgeOptions:Hi,fitView:dt,fitViewOptions:ur,onNodesDelete:k,onEdgesDelete:N,onDelete:R,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:P,onSelectionDrag:T,onSelectionDragStart:C,onSelectionDragStop:A,onMove:u,onMoveStart:d,onMoveEnd:f,noPanClassName:Zt,nodeOrigin:Ze,rfId:BP,autoPanOnConnect:Gl,autoPanOnNodeDrag:eu,autoPanSpeed:tu,onError:Vs,connectionRadius:wt,isValidConnection:dr,selectNodesOnDrag:Oe,nodeDragThreshold:xv,onBeforeDelete:V,paneClickDistance:Ge,debug:RDe}),h.jsx(Sle,{onSelectionChange:M}),Yt,h.jsx(vle,{proOptions:Ta,position:Us}),h.jsx(yle,{rfId:BP,disableKeyboardA11y:zr})]})})}var Yue=J5(Xue);const Jue=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__viewport-portal")};function Que({children:e}){const t=at(Jue);return t?ru.createPortal(e,t):null}const Gue=e=>e.nodes;function ede(){return at(Gue,Kt)}function bm({type:e,id:t=null,nodeId:n,onConnect:r,onDisconnect:a}){const o=I_(),i=n??o,s=g.useRef(null),c=at(l=>l.connectionLookup.get(`${i}-${e}-${t}`),hce);return g.useEffect(()=>{if(s.current&&s.current!==c){const l=c??new Map;z3(s.current,l,a),z3(l,s.current,r)}s.current=c??new Map},[c,r,a]),g.useMemo(()=>Array.from((c==null?void 0:c.values())??[]),[c])}Hn=function(e){return at(g.useCallback(t=>t.nodeLookup.get(e),[e]),Kt)};function tde({dimensions:e,lineWidth:t,variant:n,className:r}){return h.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:sn(["react-flow__background-pattern",n,r])})}function nde({radius:e,className:t}){return h.jsx("circle",{cx:e,cy:e,r:e,className:sn(["react-flow__background-pattern","dots",t])})}var Do;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Do||(Do={}));const rde={[Do.Dots]:1,[Do.Lines]:1,[Do.Cross]:6},ade=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function AL({id:e,variant:t=Do.Dots,gap:n=20,size:r,lineWidth:a=1,offset:o=0,color:i,bgColor:s,style:c,className:l,patternClassName:u}){const d=g.useRef(null),{transform:f,patternId:p}=at(ade,Kt),m=r||rde[t],y=t===Do.Dots,v=t===Do.Cross,b=Array.isArray(n)?n:[n,n],w=[b[0]*f[2]||1,b[1]*f[2]||1],_=m*f[2],x=Array.isArray(o)?o:[o,o],S=v?[_,_]:w,j=[x[0]*f[2]||1+S[0]/2,x[1]*f[2]||1+S[1]/2],E=`${p}${e||""}`;return h.jsxs("svg",{className:sn(["react-flow__background",l]),style:{...c,...ym,"--xy-background-color-props":s,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[h.jsx("pattern",{id:E,x:f[0]%w[0],y:f[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${j[0]},-${j[1]})`,children:y?h.jsx(nde,{radius:_/2,className:u}):h.jsx(tde,{dimensions:S,lineWidth:a,variant:t,className:u})}),h.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E})`})]})}AL.displayName="Background";const ode=g.memo(AL);function ide(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:h.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function sde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:h.jsx("path",{d:"M0 0h32v4.2H0z"})})}function cde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:h.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function lde(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function ude(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function wm({children:e,className:t,...n}){return h.jsx("button",{type:"button",className:sn(["react-flow__controls-button",t]),...n,children:e})}const dde=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function TL({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:a,onZoomIn:o,onZoomOut:i,onFitView:s,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:f="vertical","aria-label":p="React Flow controls"}){const m=Vt(),{isInteractive:y,minZoomReached:v,maxZoomReached:b}=at(dde,Kt),{zoomIn:w,zoomOut:_,fitView:x}=xr(),S=()=>{w(),o==null||o()},j=()=>{_(),i==null||i()},E=()=>{x(a),s==null||s()},O=()=>{m.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),c==null||c(!y)},P=f==="horizontal"?"horizontal":"vertical";return h.jsxs(Ac,{className:sn(["react-flow__controls",P,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":p,children:[t&&h.jsxs(h.Fragment,{children:[h.jsx(wm,{onClick:S,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b,children:h.jsx(ide,{})}),h.jsx(wm,{onClick:j,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:h.jsx(sde,{})})]}),n&&h.jsx(wm,{className:"react-flow__controls-fitview",onClick:E,title:"fit view","aria-label":"fit view",children:h.jsx(cde,{})}),r&&h.jsx(wm,{className:"react-flow__controls-interactive",onClick:O,title:"toggle interactivity","aria-label":"toggle interactivity",children:y?h.jsx(ude,{}):h.jsx(lde,{})}),u]})}TL.displayName="Controls";const fde=g.memo(TL);function pde({id:e,x:t,y:n,width:r,height:a,style:o,color:i,strokeColor:s,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:f,onClick:p}){const{background:m,backgroundColor:y}=o||{},v=i||m||y;return h.jsx("rect",{className:sn(["react-flow__minimap-node",{selected:f},l]),x:t,y:n,rx:u,ry:u,width:r,height:a,style:{fill:v,stroke:s,strokeWidth:c},shapeRendering:d,onClick:p?b=>p(b,e):void 0})}const hde=g.memo(pde),mde=e=>e.nodes.map(t=>t.id),D_=e=>e instanceof Function?e:()=>e;function yde({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:a,nodeComponent:o=hde,onClick:i}){const s=at(mde,Kt),c=D_(t),l=D_(e),u=D_(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return h.jsx(h.Fragment,{children:s.map(f=>h.jsx(vde,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:a,NodeComponent:o,onClick:i,shapeRendering:d},f))})}function gde({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:a,nodeStrokeWidth:o,shapeRendering:i,NodeComponent:s,onClick:c}){const{node:l,x:u,y:d,width:f,height:p}=at(m=>{const y=m.nodeLookup.get(e),{x:v,y:b}=y.internals.positionAbsolute,{width:w,height:_}=Ro(y);return{node:y,x:v,y:b,width:w,height:_}},Kt);return!l||l.hidden||!Q3(l)?null:h.jsx(s,{x:u,y:d,width:f,height:p,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:a,strokeColor:n(l),strokeWidth:o,shapeRendering:i,onClick:c,id:l.id})}const vde=g.memo(gde);var bde=g.memo(yde);const wde=200,xde=150,_de=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?X3(_d(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Sde="react-flow__minimap-desc";function RL({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:a="",nodeBorderRadius:o=5,nodeStrokeWidth:i,nodeComponent:s,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:f="bottom-right",onClick:p,onNodeClick:m,pannable:y=!1,zoomable:v=!1,ariaLabel:b="React Flow mini map",inversePan:w,zoomStep:_=10,offsetScale:x=5}){const S=Vt(),j=g.useRef(null),{boundingRect:E,viewBB:O,rfId:P,panZoom:k,translateExtent:N,flowWidth:R,flowHeight:M}=at(_de,Kt),C=(e==null?void 0:e.width)??wde,T=(e==null?void 0:e.height)??xde,A=E.width/C,I=E.height/T,F=Math.max(A,I),D=F*C,V=F*T,U=x*F,B=E.x-(D-E.width)/2-U,K=E.y-(V-E.height)/2-U,te=D+U*2,L=V+U*2,$=`${Sde}-${P}`,W=g.useRef(0),q=g.useRef();W.current=F,g.useEffect(()=>{if(j.current&&k)return q.current=Vce({domNode:j.current,panZoom:k,getTransform:()=>S.getState().transform,getViewScale:()=>W.current}),()=>{var oe;(oe=q.current)==null||oe.destroy()}},[k]),g.useEffect(()=>{var oe;(oe=q.current)==null||oe.update({translateExtent:N,width:R,height:M,inversePan:w,pannable:y,zoomStep:_,zoomable:v})},[y,v,w,_,N,R,M]);const Z=p?oe=>{var ie;const[H,le]=((ie=q.current)==null?void 0:ie.pointer(oe))||[0,0];p(oe,{x:H,y:le})}:void 0,ee=m?g.useCallback((oe,H)=>{const le=S.getState().nodeLookup.get(H);m(oe,le)},[]):void 0;return h.jsx(Ac,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*F:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:sn(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:h.jsxs("svg",{width:C,height:T,viewBox:`${B} ${K} ${te} ${L}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":$,ref:j,onClick:Z,children:[b&&h.jsx("title",{id:$,children:b}),h.jsx(bde,{onClick:ee,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:o,nodeClassName:a,nodeStrokeWidth:i,nodeComponent:s}),h.jsx("path",{className:"react-flow__minimap-mask",d:`M${B-U},${K-U}h${te+U*2}v${L+U*2}h${-te-U*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}RL.displayName="MiniMap";const jde=g.memo(RL);function Ede({nodeId:e,position:t,variant:n=Mc.Handle,className:r,style:a={},children:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:p,onResize:m,onResizeEnd:y}){const v=I_(),b=typeof e=="string"?e:v,w=Vt(),_=g.useRef(null),x=n===Mc.Line?"right":"bottom-right",S=t??x,j=g.useRef(null);g.useEffect(()=>{if(!(!_.current||!b))return j.current||(j.current=ile({domNode:_.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:k,transform:N,snapGrid:R,snapToGrid:M,nodeOrigin:C,domNode:T}=w.getState();return{nodeLookup:k,transform:N,snapGrid:R,snapToGrid:M,nodeOrigin:C,paneDomNode:T}},onChange:(k,N)=>{const{triggerNodeChanges:R,nodeLookup:M,parentLookup:C,nodeOrigin:T}=w.getState(),A=[],I={x:k.x,y:k.y},F=M.get(b);if(F&&F.expandParent&&F.parentId){const D=F.origin??T,V=k.width??F.measured.width,U=k.height??F.measured.height,B={id:F.id,parentId:F.parentId,rect:{width:V,height:U,...G3({x:k.x??F.position.x,y:k.y??F.position.y},{width:V,height:U},F.parentId,M,D)}},K=E_([B],M,C,T);A.push(...K),I.x=k.x?Math.max(D[0]*V,k.x):void 0,I.y=k.y?Math.max(D[1]*U,k.y):void 0}if(I.x!==void 0&&I.y!==void 0){const D={id:b,type:"position",position:{...I}};A.push(D)}if(k.width!==void 0&&k.height!==void 0){const D={id:b,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:k.width,height:k.height}};A.push(D)}for(const D of N){const V={...D,type:"position"};A.push(V)}R(A)},onEnd:()=>{const k={id:b,type:"dimensions",resizing:!1};w.getState().triggerNodeChanges([k])}})),j.current.update({controlPosition:S,boundaries:{minWidth:s,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,onResizeStart:p,onResize:m,onResizeEnd:y,shouldResize:f}),()=>{var k;(k=j.current)==null||k.destroy()}},[S,s,c,l,u,d,p,m,y,f]);const E=S.split("-"),O=n===Mc.Line?"borderColor":"backgroundColor",P=i?{...a,[O]:i}:a;return h.jsx("div",{className:sn(["react-flow__resize-control","nodrag",...E,n,r]),ref:_,style:P,children:o})}const IL=g.memo(Ede);function Ode({nodeId:e,isVisible:t=!0,handleClassName:n,handleStyle:r,lineClassName:a,lineStyle:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:p,onResize:m,onResizeEnd:y}){return t?h.jsxs(h.Fragment,{children:[Gce.map(v=>h.jsx(IL,{className:a,style:o,nodeId:e,position:v,variant:Mc.Line,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:p,keepAspectRatio:d,shouldResize:f,onResize:m,onResizeEnd:y},v)),Qce.map(v=>h.jsx(IL,{className:n,style:r,nodeId:e,position:v,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:p,keepAspectRatio:d,shouldResize:f,onResize:m,onResizeEnd:y},v))]}):null}var L_,DL;function Cde(){if(DL)return L_;DL=1;var e=function(b){return t(b)&&!n(b)};function t(b){return!!b&&typeof b=="object"}function n(b){var w=Object.prototype.toString.call(b);return w==="[object RegExp]"||w==="[object Date]"||o(b)}var r=typeof Symbol=="function"&&Symbol.for,a=r?Symbol.for("react.element"):60103;function o(b){return b.$$typeof===a}function i(b){return Array.isArray(b)?[]:{}}function s(b,w){return w.clone!==!1&&w.isMergeableObject(b)?y(i(b),b,w):b}function c(b,w,_){return b.concat(w).map(function(x){return s(x,_)})}function l(b,w){if(!w.customMerge)return y;var _=w.customMerge(b);return typeof _=="function"?_:y}function u(b){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(b).filter(function(w){return Object.propertyIsEnumerable.call(b,w)}):[]}function d(b){return Object.keys(b).concat(u(b))}function f(b,w){try{return w in b}catch{return!1}}function p(b,w){return f(b,w)&&!(Object.hasOwnProperty.call(b,w)&&Object.propertyIsEnumerable.call(b,w))}function m(b,w,_){var x={};return _.isMergeableObject(b)&&d(b).forEach(function(S){x[S]=s(b[S],_)}),d(w).forEach(function(S){p(b,S)||(f(b,S)&&_.isMergeableObject(w[S])?x[S]=l(S,_)(b[S],w[S],_):x[S]=s(w[S],_))}),x}function y(b,w,_){_=_||{},_.arrayMerge=_.arrayMerge||c,_.isMergeableObject=_.isMergeableObject||e,_.cloneUnlessOtherwiseSpecified=s;var x=Array.isArray(w),S=Array.isArray(b),j=x===S;return j?x?_.arrayMerge(b,w,_):m(b,w,_):s(w,_)}y.all=function(b,w){if(!Array.isArray(b))throw new Error("first argument should be an array");return b.reduce(function(_,x){return y(_,x,w)},{})};var v=y;return L_=v,L_}var kde=Cde();const xm=ft(kde);var LL={},$L;function Pde(){if($L)return LL;$L=1;var e;return function(t){(function(n){var r=typeof globalThis=="object"?globalThis:typeof iu=="object"?iu:typeof self=="object"?self:typeof this=="object"?this:c(),a=o(t);typeof r.Reflect<"u"&&(a=o(r.Reflect,a)),n(a,r),typeof r.Reflect>"u"&&(r.Reflect=t);function o(l,u){return function(d,f){Object.defineProperty(l,d,{configurable:!0,writable:!0,value:f}),u&&u(d,f)}}function i(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function c(){return i()||s()}})(function(n,r){var a=Object.prototype.hasOwnProperty,o=typeof Symbol=="function",i=o&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=o&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,u=!c&&!l,d={create:c?function(){return ut(Object.create(null))}:l?function(){return ut({__proto__:null})}:function(){return ut({})},has:u?function(Q,ne){return a.call(Q,ne)}:function(Q,ne){return ne in Q},get:u?function(Q,ne){return a.call(Q,ne)?Q[ne]:void 0}:function(Q,ne){return Q[ne]}},f=Object.getPrototypeOf(Function),p=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),m=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Ke(),y=typeof WeakMap=="function"?WeakMap:Xe(),v=o?Symbol.for("@reflect-metadata:registry"):void 0,b=z(),w=J(b);function _(Q,ne,se,ye){if(K(se)){if(!H(Q))throw new TypeError;if(!ie(ne))throw new TypeError;return M(Q,ne)}else{if(!H(Q))throw new TypeError;if(!$(ne))throw new TypeError;if(!$(ye)&&!K(ye)&&!te(ye))throw new TypeError;return te(ye)&&(ye=void 0),se=oe(se),C(Q,ne,se,ye)}}n("decorate",_);function x(Q,ne){function se(ye,De){if(!$(ye))throw new TypeError;if(!K(De)&&!pe(De))throw new TypeError;D(Q,ne,ye,De)}return se}n("metadata",x);function S(Q,ne,se,ye){if(!$(se))throw new TypeError;return K(ye)||(ye=oe(ye)),D(Q,ne,se,ye)}n("defineMetadata",S);function j(Q,ne,se){if(!$(ne))throw new TypeError;return K(se)||(se=oe(se)),T(Q,ne,se)}n("hasMetadata",j);function E(Q,ne,se){if(!$(ne))throw new TypeError;return K(se)||(se=oe(se)),A(Q,ne,se)}n("hasOwnMetadata",E);function O(Q,ne,se){if(!$(ne))throw new TypeError;return K(se)||(se=oe(se)),I(Q,ne,se)}n("getMetadata",O);function P(Q,ne,se){if(!$(ne))throw new TypeError;return K(se)||(se=oe(se)),F(Q,ne,se)}n("getOwnMetadata",P);function k(Q,ne){if(!$(Q))throw new TypeError;return K(ne)||(ne=oe(ne)),V(Q,ne)}n("getMetadataKeys",k);function N(Q,ne){if(!$(Q))throw new TypeError;return K(ne)||(ne=oe(ne)),U(Q,ne)}n("getOwnMetadataKeys",N);function R(Q,ne,se){if(!$(ne))throw new TypeError;if(K(se)||(se=oe(se)),!$(ne))throw new TypeError;K(se)||(se=oe(se));var ye=ve(ne,se,!1);return K(ye)?!1:ye.OrdinaryDeleteMetadata(Q,ne,se)}n("deleteMetadata",R);function M(Q,ne){for(var se=Q.length-1;se>=0;--se){var ye=Q[se],De=ye(ne);if(!K(De)&&!te(De)){if(!ie(De))throw new TypeError;ne=De}}return ne}function C(Q,ne,se,ye){for(var De=Q.length-1;De>=0;--De){var qt=Q[De],$t=qt(ne,se,ye);if(!K($t)&&!te($t)){if(!$($t))throw new TypeError;ye=$t}}return ye}function T(Q,ne,se){var ye=A(Q,ne,se);if(ye)return!0;var De=Qe(ne);return te(De)?!1:T(Q,De,se)}function A(Q,ne,se){var ye=ve(ne,se,!1);return K(ye)?!1:Z(ye.OrdinaryHasOwnMetadata(Q,ne,se))}function I(Q,ne,se){var ye=A(Q,ne,se);if(ye)return F(Q,ne,se);var De=Qe(ne);if(!te(De))return I(Q,De,se)}function F(Q,ne,se){var ye=ve(ne,se,!1);if(!K(ye))return ye.OrdinaryGetOwnMetadata(Q,ne,se)}function D(Q,ne,se,ye){var De=ve(se,ye,!0);De.OrdinaryDefineOwnMetadata(Q,ne,se,ye)}function V(Q,ne){var se=U(Q,ne),ye=Qe(Q);if(ye===null)return se;var De=V(ye,ne);if(De.length<=0)return se;if(se.length<=0)return De;for(var qt=new m,$t=[],We=0,xe=se;We<xe.length;We++){var ke=xe[We],Pe=qt.has(ke);Pe||(qt.add(ke),$t.push(ke))}for(var Ne=0,Ge=De;Ne<Ge.length;Ne++){var ke=Ge[Ne],Pe=qt.has(ke);Pe||(qt.add(ke),$t.push(ke))}return $t}function U(Q,ne){var se=ve(Q,ne,!1);return se?se.OrdinaryOwnMetadataKeys(Q,ne):[]}function B(Q){if(Q===null)return 1;switch(typeof Q){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Q===null?1:6;default:return 6}}function K(Q){return Q===void 0}function te(Q){return Q===null}function L(Q){return typeof Q=="symbol"}function $(Q){return typeof Q=="object"?Q!==null:typeof Q=="function"}function W(Q,ne){switch(B(Q)){case 0:return Q;case 1:return Q;case 2:return Q;case 3:return Q;case 4:return Q;case 5:return Q}var se="string",ye=Ue(Q,i);if(ye!==void 0){var De=ye.call(Q,se);if($(De))throw new TypeError;return De}return q(Q)}function q(Q,ne){var se,ye;{var De=Q.toString;if(le(De)){var ye=De.call(Q);if(!$(ye))return ye}var se=Q.valueOf;if(le(se)){var ye=se.call(Q);if(!$(ye))return ye}}throw new TypeError}function Z(Q){return!!Q}function ee(Q){return""+Q}function oe(Q){var ne=W(Q);return L(ne)?ne:ee(ne)}function H(Q){return Array.isArray?Array.isArray(Q):Q instanceof Object?Q instanceof Array:Object.prototype.toString.call(Q)==="[object Array]"}function le(Q){return typeof Q=="function"}function ie(Q){return typeof Q=="function"}function pe(Q){switch(B(Q)){case 3:return!0;case 4:return!0;default:return!1}}function Oe(Q,ne){return Q===ne||Q!==Q&&ne!==ne}function Ue(Q,ne){var se=Q[ne];if(se!=null){if(!le(se))throw new TypeError;return se}}function Ve(Q){var ne=Ue(Q,s);if(!le(ne))throw new TypeError;var se=ne.call(Q);if(!$(se))throw new TypeError;return se}function Ce(Q){return Q.value}function Ze(Q){var ne=Q.next();return ne.done?!1:ne}function Je(Q){var ne=Q.return;ne&&ne.call(Q)}function Qe(Q){var ne=Object.getPrototypeOf(Q);if(typeof Q!="function"||Q===f||ne!==f)return ne;var se=Q.prototype,ye=se&&Object.getPrototypeOf(se);if(ye==null||ye===Object.prototype)return ne;var De=ye.constructor;return typeof De!="function"||De===Q?ne:De}function Rt(){var Q;!K(v)&&typeof r.Reflect<"u"&&!(v in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(Q=fe(r.Reflect));var ne,se,ye,De=new y,qt={registerProvider:$t,getProvider:xe,setProvider:Pe};return qt;function $t(Ne){if(!Object.isExtensible(qt))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Q===Ne:break;case K(ne):ne=Ne;break;case ne===Ne:break;case K(se):se=Ne;break;case se===Ne:break;default:ye===void 0&&(ye=new m),ye.add(Ne);break}}function We(Ne,Ge){if(!K(ne)){if(ne.isProviderFor(Ne,Ge))return ne;if(!K(se)){if(se.isProviderFor(Ne,Ge))return ne;if(!K(ye))for(var It=Ve(ye);;){var Yt=Ze(It);if(!Yt)return;var X=Ce(Yt);if(X.isProviderFor(Ne,Ge))return Je(It),X}}}if(!K(Q)&&Q.isProviderFor(Ne,Ge))return Q}function xe(Ne,Ge){var It=De.get(Ne),Yt;return K(It)||(Yt=It.get(Ge)),K(Yt)&&(Yt=We(Ne,Ge),K(Yt)||(K(It)&&(It=new p,De.set(Ne,It)),It.set(Ge,Yt))),Yt}function ke(Ne){if(K(Ne))throw new TypeError;return ne===Ne||se===Ne||!K(ye)&&ye.has(Ne)}function Pe(Ne,Ge,It){if(!ke(It))throw new Error("Metadata provider not registered.");var Yt=xe(Ne,Ge);if(Yt!==It){if(!K(Yt))return!1;var X=De.get(Ne);K(X)&&(X=new p,De.set(Ne,X)),X.set(Ge,It)}return!0}}function z(){var Q;return!K(v)&&$(r.Reflect)&&Object.isExtensible(r.Reflect)&&(Q=r.Reflect[v]),K(Q)&&(Q=Rt()),!K(v)&&$(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,v,{enumerable:!1,configurable:!1,writable:!1,value:Q}),Q}function J(Q){var ne=new y,se={isProviderFor:function(ke,Pe){var Ne=ne.get(ke);return K(Ne)?!1:Ne.has(Pe)},OrdinaryDefineOwnMetadata:$t,OrdinaryHasOwnMetadata:De,OrdinaryGetOwnMetadata:qt,OrdinaryOwnMetadataKeys:We,OrdinaryDeleteMetadata:xe};return b.registerProvider(se),se;function ye(ke,Pe,Ne){var Ge=ne.get(ke),It=!1;if(K(Ge)){if(!Ne)return;Ge=new p,ne.set(ke,Ge),It=!0}var Yt=Ge.get(Pe);if(K(Yt)){if(!Ne)return;if(Yt=new p,Ge.set(Pe,Yt),!Q.setProvider(ke,Pe,se))throw Ge.delete(Pe),It&&ne.delete(ke),new Error("Wrong provider for target.")}return Yt}function De(ke,Pe,Ne){var Ge=ye(Pe,Ne,!1);return K(Ge)?!1:Z(Ge.has(ke))}function qt(ke,Pe,Ne){var Ge=ye(Pe,Ne,!1);if(!K(Ge))return Ge.get(ke)}function $t(ke,Pe,Ne,Ge){var It=ye(Ne,Ge,!0);It.set(ke,Pe)}function We(ke,Pe){var Ne=[],Ge=ye(ke,Pe,!1);if(K(Ge))return Ne;for(var It=Ge.keys(),Yt=Ve(It),X=0;;){var re=Ze(Yt);if(!re)return Ne.length=X,Ne;var ce=Ce(re);try{Ne[X]=ce}catch(ge){try{Je(Yt)}finally{throw ge}}X++}}function xe(ke,Pe,Ne){var Ge=ye(Pe,Ne,!1);if(K(Ge)||!Ge.delete(ke))return!1;if(Ge.size===0){var It=ne.get(Pe);K(It)||(It.delete(Ne),It.size===0&&ne.delete(It))}return!0}}function fe(Q){var ne=Q.defineMetadata,se=Q.hasOwnMetadata,ye=Q.getOwnMetadata,De=Q.getOwnMetadataKeys,qt=Q.deleteMetadata,$t=new y,We={isProviderFor:function(xe,ke){var Pe=$t.get(xe);return!K(Pe)&&Pe.has(ke)?!0:De(xe,ke).length?(K(Pe)&&(Pe=new m,$t.set(xe,Pe)),Pe.add(ke),!0):!1},OrdinaryDefineOwnMetadata:ne,OrdinaryHasOwnMetadata:se,OrdinaryGetOwnMetadata:ye,OrdinaryOwnMetadataKeys:De,OrdinaryDeleteMetadata:qt};return We}function ve(Q,ne,se){var ye=b.getProvider(Q,ne);if(!K(ye))return ye;if(se){if(b.setProvider(Q,ne,w))return w;throw new Error("Illegal state.")}}function Ie(){var Q={},ne=[],se=function(){function We(xe,ke,Pe){this._index=0,this._keys=xe,this._values=ke,this._selector=Pe}return We.prototype["@@iterator"]=function(){return this},We.prototype[s]=function(){return this},We.prototype.next=function(){var xe=this._index;if(xe>=0&&xe<this._keys.length){var ke=this._selector(this._keys[xe],this._values[xe]);return xe+1>=this._keys.length?(this._index=-1,this._keys=ne,this._values=ne):this._index++,{value:ke,done:!1}}return{value:void 0,done:!0}},We.prototype.throw=function(xe){throw this._index>=0&&(this._index=-1,this._keys=ne,this._values=ne),xe},We.prototype.return=function(xe){return this._index>=0&&(this._index=-1,this._keys=ne,this._values=ne),{value:xe,done:!0}},We}(),ye=function(){function We(){this._keys=[],this._values=[],this._cacheKey=Q,this._cacheIndex=-2}return Object.defineProperty(We.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),We.prototype.has=function(xe){return this._find(xe,!1)>=0},We.prototype.get=function(xe){var ke=this._find(xe,!1);return ke>=0?this._values[ke]:void 0},We.prototype.set=function(xe,ke){var Pe=this._find(xe,!0);return this._values[Pe]=ke,this},We.prototype.delete=function(xe){var ke=this._find(xe,!1);if(ke>=0){for(var Pe=this._keys.length,Ne=ke+1;Ne<Pe;Ne++)this._keys[Ne-1]=this._keys[Ne],this._values[Ne-1]=this._values[Ne];return this._keys.length--,this._values.length--,Oe(xe,this._cacheKey)&&(this._cacheKey=Q,this._cacheIndex=-2),!0}return!1},We.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Q,this._cacheIndex=-2},We.prototype.keys=function(){return new se(this._keys,this._values,De)},We.prototype.values=function(){return new se(this._keys,this._values,qt)},We.prototype.entries=function(){return new se(this._keys,this._values,$t)},We.prototype["@@iterator"]=function(){return this.entries()},We.prototype[s]=function(){return this.entries()},We.prototype._find=function(xe,ke){if(!Oe(this._cacheKey,xe)){this._cacheIndex=-1;for(var Pe=0;Pe<this._keys.length;Pe++)if(Oe(this._keys[Pe],xe)){this._cacheIndex=Pe;break}}return this._cacheIndex<0&&ke&&(this._cacheIndex=this._keys.length,this._keys.push(xe),this._values.push(void 0)),this._cacheIndex},We}();return ye;function De(We,xe){return We}function qt(We,xe){return xe}function $t(We,xe){return[We,xe]}}function Ke(){var Q=function(){function ne(){this._map=new p}return Object.defineProperty(ne.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ne.prototype.has=function(se){return this._map.has(se)},ne.prototype.add=function(se){return this._map.set(se,se),this},ne.prototype.delete=function(se){return this._map.delete(se)},ne.prototype.clear=function(){this._map.clear()},ne.prototype.keys=function(){return this._map.keys()},ne.prototype.values=function(){return this._map.keys()},ne.prototype.entries=function(){return this._map.entries()},ne.prototype["@@iterator"]=function(){return this.keys()},ne.prototype[s]=function(){return this.keys()},ne}();return Q}function Xe(){var Q=16,ne=d.create(),se=ye();return function(){function xe(){this._key=ye()}return xe.prototype.has=function(ke){var Pe=De(ke,!1);return Pe!==void 0?d.has(Pe,this._key):!1},xe.prototype.get=function(ke){var Pe=De(ke,!1);return Pe!==void 0?d.get(Pe,this._key):void 0},xe.prototype.set=function(ke,Pe){var Ne=De(ke,!0);return Ne[this._key]=Pe,this},xe.prototype.delete=function(ke){var Pe=De(ke,!1);return Pe!==void 0?delete Pe[this._key]:!1},xe.prototype.clear=function(){this._key=ye()},xe}();function ye(){var xe;do xe="@@WeakMap@@"+We();while(d.has(ne,xe));return ne[xe]=!0,xe}function De(xe,ke){if(!a.call(xe,se)){if(!ke)return;Object.defineProperty(xe,se,{value:d.create()})}return xe[se]}function qt(xe,ke){for(var Pe=0;Pe<ke;++Pe)xe[Pe]=Math.random()*255|0;return xe}function $t(xe){if(typeof Uint8Array=="function"){var ke=new Uint8Array(xe);return typeof crypto<"u"?crypto.getRandomValues(ke):typeof msCrypto<"u"?msCrypto.getRandomValues(ke):qt(ke,xe),ke}return qt(new Array(xe),xe)}function We(){var xe=$t(Q);xe[6]=xe[6]&79|64,xe[8]=xe[8]&191|128;for(var ke="",Pe=0;Pe<Q;++Pe){var Ne=xe[Pe];(Pe===4||Pe===6||Pe===8)&&(ke+="-"),Ne<16&&(ke+="0"),ke+=Ne.toString(16).toLowerCase()}return ke}}function ut(Q){return Q.__=void 0,delete Q.__,Q}})}(e||(e={})),LL}Pde(),typeof window<"u"&&(window.Buffer=QDe),typeof Nv<"u"&&typeof require<"u"&&(Nv.Buffer=require("buffer/").Buffer);class cn{static isObject(t){return t!==null&&typeof t=="object"}static isObjectWithName(t){return t!==null&&typeof t=="object"&&t.name!==void 0}static assign(t,...n){for(const r of n)for(const a of Object.getOwnPropertyNames(r))t[a]=r[a]}static mixedListToArray(t){return t!==null&&typeof t=="object"?Object.keys(t).map(n=>t[n]):t}}class Ee extends Error{get name(){return this.constructor.name}constructor(t){super(t),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class Rc extends Ee{constructor(){super("Locking not supported on given driver.")}}class $_ extends Ee{constructor(){super('Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')}}class Ft{static isMssqlParameter(t){return this.check(t,"MssqlParameter")}static isEntityMetadata(t){return this.check(t,"EntityMetadata")}static isColumnMetadata(t){return this.check(t,"ColumnMetadata")}static isSelectQueryBuilder(t){return this.check(t,"SelectQueryBuilder")}static isInsertQueryBuilder(t){return this.check(t,"InsertQueryBuilder")}static isDeleteQueryBuilder(t){return this.check(t,"DeleteQueryBuilder")}static isUpdateQueryBuilder(t){return this.check(t,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(t){return this.check(t,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(t){return this.check(t,"RelationQueryBuilder")}static isBrackets(t){return this.check(t,"Brackets")||this.check(t,"NotBrackets")}static isNotBrackets(t){return this.check(t,"NotBrackets")}static isSubject(t){return this.check(t,"Subject")}static isRdbmsSchemaBuilder(t){return this.check(t,"RdbmsSchemaBuilder")}static isMongoEntityManager(t){return this.check(t,"MongoEntityManager")}static isSqljsEntityManager(t){return this.check(t,"SqljsEntityManager")}static isEntitySchema(t){return this.check(t,"EntitySchema")}static isBaseEntityConstructor(t){return typeof t=="function"&&typeof t.hasId=="function"&&typeof t.save=="function"&&typeof t.useDataSource=="function"}static isFindOperator(t){return this.check(t,"FindOperator")||this.check(t,"EqualOperator")}static isEqualOperator(t){return this.check(t,"EqualOperator")}static isQuery(t){return this.check(t,"Query")}static isTable(t){return this.check(t,"Table")}static isTableCheck(t){return this.check(t,"TableCheck")}static isTableColumn(t){return this.check(t,"TableColumn")}static isTableExclusion(t){return this.check(t,"TableExclusion")}static isTableForeignKey(t){return this.check(t,"TableForeignKey")}static isTableIndex(t){return this.check(t,"TableIndex")}static isTableUnique(t){return this.check(t,"TableUnique")}static isView(t){return this.check(t,"View")}static isDataSource(t){return this.check(t,"DataSource")}static check(t,n){return typeof t=="object"&&t!==null&&t["@instanceof"]===Symbol.for(n)}}class Nde extends Ee{constructor(t,n){super(),this.entityClass=t,this.criteria=n,this.message=`Could not find any entity of type "${this.stringifyTarget(t)}" matching: ${this.stringifyCriteria(n)}`}stringifyTarget(t){return Ft.isEntitySchema(t)?t.options.name:typeof t=="function"||cn.isObject(t)&&"name"in t?t.name:t}stringifyCriteria(t){try{return JSON.stringify(t,null,4)}catch{}return""+t}}class FL extends Ee{constructor(t,n,r){super(`The optimistic lock on entity ${t} failed, version ${n} was expected, but is actually ${r}.`)}}class BL extends Ee{constructor(){super("Your database does not support LIMIT on UPDATE statements.")}}class Mde extends Ee{constructor(t){super(`Entity "${t.name}" does not have delete date columns.`)}}class _m extends Ee{constructor(){super("OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL or MariaDB databases.")}}class Za extends Ee{constructor(t,n){super(t),Object.setPrototypeOf(this,Za.prototype),this.message=`Property "${t}" was not found in "${n.targetName}". Make sure your query is correct.`}}class Ade extends Ee{constructor(t){super(`Entity ${t} does not have version or update date columns.`)}}class Tde extends Ee{constructor(){super('Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')}}class Nd extends Ee{constructor(){super("The optimistic lock can be used only with getOne() method.")}}class Rde extends Ee{constructor(t){super(),t.length===1?this.message=`Relation "${t[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${t.map(n=>`"${n}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class Ide extends Ee{constructor(){super("An open transaction is required for pessimistic lock.")}}class Dde extends Ee{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class zL{constructor(t){cn.assign(this,t||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(t){this._metadata=t}get metadata(){if(!this._metadata)throw new Ee(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class Ka{static isAliasProperty(t){if(typeof t!="string"||t.indexOf(".")===-1)return!1;const[n,r]=t.split(".");return!(!n||!r||t.indexOf("(")!==-1||t.indexOf(")")!==-1)}}var F_={exports:{}},B_={exports:{}},UL;function Ic(){return UL||(UL=1,typeof Object.create=="function"?B_.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:B_.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),B_.exports}var z_={exports:{}},VL;function hs(){return VL||(VL=1,function(e,t){var n=GDe(),r=n.Buffer;function a(i,s){for(var c in i)s[c]=i[c]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o);function o(i,s,c){return r(i,s,c)}o.prototype=Object.create(r.prototype),a(r,o),o.from=function(i,s,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return r(i,s,c)},o.alloc=function(i,s,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var l=r(i);return s!==void 0?typeof c=="string"?l.fill(s,c):l.fill(s):l.fill(0),l},o.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r(i)},o.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(i)}}(z_,z_.exports)),z_.exports}var U_,WL;function Dc(){if(WL)return U_;WL=1;var e=hs().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var a=this._block,o=this._blockSize,i=n.length,s=this._len,c=0;c<i;){for(var l=s%o,u=Math.min(i-c,o-l),d=0;d<u;d++)a[l+d]=n[c+d];s+=u,c+=u,s%o===0&&this._update(a)}return this._len+=i,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var o=(a&4294967295)>>>0,i=(a-o)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(o,this._blockSize-4)}this._update(this._block);var s=this._hash();return n?s.toString(n):s},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},U_=t,U_}var V_,HL;function Lde(){if(HL)return V_;HL=1;var e=Ic(),t=Dc(),n=hs().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(l){return l<<5|l>>>27}function s(l){return l<<30|l>>>2}function c(l,u,d,f){return l===0?u&d|~u&f:l===2?u&d|u&f|d&f:u^d^f}return o.prototype._update=function(l){for(var u=this._w,d=this._a|0,f=this._b|0,p=this._c|0,m=this._d|0,y=this._e|0,v=0;v<16;++v)u[v]=l.readInt32BE(v*4);for(;v<80;++v)u[v]=u[v-3]^u[v-8]^u[v-14]^u[v-16];for(var b=0;b<80;++b){var w=~~(b/20),_=i(d)+c(w,f,p,m)+y+u[b]+r[w]|0;y=m,m=p,p=s(f),f=d,d=_}this._a=d+this._a|0,this._b=f+this._b|0,this._c=p+this._c|0,this._d=m+this._d|0,this._e=y+this._e|0},o.prototype._hash=function(){var l=n.allocUnsafe(20);return l.writeInt32BE(this._a|0,0),l.writeInt32BE(this._b|0,4),l.writeInt32BE(this._c|0,8),l.writeInt32BE(this._d|0,12),l.writeInt32BE(this._e|0,16),l},V_=o,V_}var W_,qL;function $de(){if(qL)return W_;qL=1;var e=Ic(),t=Dc(),n=hs().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(u){return u<<1|u>>>31}function s(u){return u<<5|u>>>27}function c(u){return u<<30|u>>>2}function l(u,d,f,p){return u===0?d&f|~d&p:u===2?d&f|d&p|f&p:d^f^p}return o.prototype._update=function(u){for(var d=this._w,f=this._a|0,p=this._b|0,m=this._c|0,y=this._d|0,v=this._e|0,b=0;b<16;++b)d[b]=u.readInt32BE(b*4);for(;b<80;++b)d[b]=i(d[b-3]^d[b-8]^d[b-14]^d[b-16]);for(var w=0;w<80;++w){var _=~~(w/20),x=s(f)+l(_,p,m,y)+v+d[w]+r[_]|0;v=y,y=m,m=c(p),p=f,f=x}this._a=f+this._a|0,this._b=p+this._b|0,this._c=m+this._c|0,this._d=y+this._d|0,this._e=v+this._e|0},o.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},W_=o,W_}var H_,ZL;function KL(){if(ZL)return H_;ZL=1;var e=Ic(),t=Dc(),n=hs().Buffer,r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function i(f,p,m){return m^f&(p^m)}function s(f,p,m){return f&p|m&(f|p)}function c(f){return(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10)}function l(f){return(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7)}function u(f){return(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3}function d(f){return(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10}return o.prototype._update=function(f){for(var p=this._w,m=this._a|0,y=this._b|0,v=this._c|0,b=this._d|0,w=this._e|0,_=this._f|0,x=this._g|0,S=this._h|0,j=0;j<16;++j)p[j]=f.readInt32BE(j*4);for(;j<64;++j)p[j]=d(p[j-2])+p[j-7]+u(p[j-15])+p[j-16]|0;for(var E=0;E<64;++E){var O=S+l(w)+i(w,_,x)+r[E]+p[E]|0,P=c(m)+s(m,y,v)|0;S=x,x=_,_=w,w=b+O|0,b=v,v=y,y=m,m=O+P|0}this._a=m+this._a|0,this._b=y+this._b|0,this._c=v+this._c|0,this._d=b+this._d|0,this._e=w+this._e|0,this._f=_+this._f|0,this._g=x+this._g|0,this._h=S+this._h|0},o.prototype._hash=function(){var f=n.allocUnsafe(32);return f.writeInt32BE(this._a,0),f.writeInt32BE(this._b,4),f.writeInt32BE(this._c,8),f.writeInt32BE(this._d,12),f.writeInt32BE(this._e,16),f.writeInt32BE(this._f,20),f.writeInt32BE(this._g,24),f.writeInt32BE(this._h,28),f},H_=o,H_}var q_,XL;function Fde(){if(XL)return q_;XL=1;var e=Ic(),t=KL(),n=Dc(),r=hs().Buffer,a=new Array(64);function o(){this.init(),this._w=a,n.call(this,64,56)}return e(o,t),o.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(28);return i.writeInt32BE(this._a,0),i.writeInt32BE(this._b,4),i.writeInt32BE(this._c,8),i.writeInt32BE(this._d,12),i.writeInt32BE(this._e,16),i.writeInt32BE(this._f,20),i.writeInt32BE(this._g,24),i},q_=o,q_}var Z_,YL;function JL(){if(YL)return Z_;YL=1;var e=Ic(),t=Dc(),n=hs().Buffer,r=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function o(){this.init(),this._w=a,t.call(this,128,112)}e(o,t),o.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function i(y,v,b){return b^y&(v^b)}function s(y,v,b){return y&v|b&(y|v)}function c(y,v){return(y>>>28|v<<4)^(v>>>2|y<<30)^(v>>>7|y<<25)}function l(y,v){return(y>>>14|v<<18)^(y>>>18|v<<14)^(v>>>9|y<<23)}function u(y,v){return(y>>>1|v<<31)^(y>>>8|v<<24)^y>>>7}function d(y,v){return(y>>>1|v<<31)^(y>>>8|v<<24)^(y>>>7|v<<25)}function f(y,v){return(y>>>19|v<<13)^(v>>>29|y<<3)^y>>>6}function p(y,v){return(y>>>19|v<<13)^(v>>>29|y<<3)^(y>>>6|v<<26)}function m(y,v){return y>>>0<v>>>0?1:0}return o.prototype._update=function(y){for(var v=this._w,b=this._ah|0,w=this._bh|0,_=this._ch|0,x=this._dh|0,S=this._eh|0,j=this._fh|0,E=this._gh|0,O=this._hh|0,P=this._al|0,k=this._bl|0,N=this._cl|0,R=this._dl|0,M=this._el|0,C=this._fl|0,T=this._gl|0,A=this._hl|0,I=0;I<32;I+=2)v[I]=y.readInt32BE(I*4),v[I+1]=y.readInt32BE(I*4+4);for(;I<160;I+=2){var F=v[I-30],D=v[I-15*2+1],V=u(F,D),U=d(D,F);F=v[I-2*2],D=v[I-2*2+1];var B=f(F,D),K=p(D,F),te=v[I-7*2],L=v[I-7*2+1],$=v[I-16*2],W=v[I-16*2+1],q=U+L|0,Z=V+te+m(q,U)|0;q=q+K|0,Z=Z+B+m(q,K)|0,q=q+W|0,Z=Z+$+m(q,W)|0,v[I]=Z,v[I+1]=q}for(var ee=0;ee<160;ee+=2){Z=v[ee],q=v[ee+1];var oe=s(b,w,_),H=s(P,k,N),le=c(b,P),ie=c(P,b),pe=l(S,M),Oe=l(M,S),Ue=r[ee],Ve=r[ee+1],Ce=i(S,j,E),Ze=i(M,C,T),Je=A+Oe|0,Qe=O+pe+m(Je,A)|0;Je=Je+Ze|0,Qe=Qe+Ce+m(Je,Ze)|0,Je=Je+Ve|0,Qe=Qe+Ue+m(Je,Ve)|0,Je=Je+q|0,Qe=Qe+Z+m(Je,q)|0;var Rt=ie+H|0,z=le+oe+m(Rt,ie)|0;O=E,A=T,E=j,T=C,j=S,C=M,M=R+Je|0,S=x+Qe+m(M,R)|0,x=_,R=N,_=w,N=k,w=b,k=P,P=Je+Rt|0,b=Qe+z+m(P,Je)|0}this._al=this._al+P|0,this._bl=this._bl+k|0,this._cl=this._cl+N|0,this._dl=this._dl+R|0,this._el=this._el+M|0,this._fl=this._fl+C|0,this._gl=this._gl+T|0,this._hl=this._hl+A|0,this._ah=this._ah+b+m(this._al,P)|0,this._bh=this._bh+w+m(this._bl,k)|0,this._ch=this._ch+_+m(this._cl,N)|0,this._dh=this._dh+x+m(this._dl,R)|0,this._eh=this._eh+S+m(this._el,M)|0,this._fh=this._fh+j+m(this._fl,C)|0,this._gh=this._gh+E+m(this._gl,T)|0,this._hh=this._hh+O+m(this._hl,A)|0},o.prototype._hash=function(){var y=n.allocUnsafe(64);function v(b,w,_){y.writeInt32BE(b,_),y.writeInt32BE(w,_+4)}return v(this._ah,this._al,0),v(this._bh,this._bl,8),v(this._ch,this._cl,16),v(this._dh,this._dl,24),v(this._eh,this._el,32),v(this._fh,this._fl,40),v(this._gh,this._gl,48),v(this._hh,this._hl,56),y},Z_=o,Z_}var K_,QL;function Bde(){if(QL)return K_;QL=1;var e=Ic(),t=JL(),n=Dc(),r=hs().Buffer,a=new Array(160);function o(){this.init(),this._w=a,n.call(this,128,112)}return e(o,t),o.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(48);function s(c,l,u){i.writeInt32BE(c,u),i.writeInt32BE(l,u+4)}return s(this._ah,this._al,0),s(this._bh,this._bl,8),s(this._ch,this._cl,16),s(this._dh,this._dl,24),s(this._eh,this._el,32),s(this._fh,this._fl,40),i},K_=o,K_}var GL;function zde(){if(GL)return F_.exports;GL=1;var e=F_.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n};return e.sha=Lde(),e.sha1=$de(),e.sha224=Fde(),e.sha256=KL(),e.sha384=Bde(),e.sha512=JL(),F_.exports}var Ude=zde();const Vde=ft(Ude);function Wde(e,t={}){const{segmentLength:n=4,separator:r="__",termLength:a=2}=t;return e.split(r).reduce((o,i)=>{const s=i.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),c=s.length>1?a:n,l=s.map(u=>u.substr(0,c)).join("");return o.push(l),o},[]).join(r)}function Hde(e,t={}){const n=Vde("sha1");n.update(e,"utf8");const r=n.digest("hex");return t.length?r.slice(0,t.length):r}class qde{static isGreaterOrEqual(t,n){const r=e$(t),a=e$(n);return r[0]>a[0]||r[0]===a[0]&&r[1]>a[1]||r[0]===a[0]&&r[1]===a[1]&&r[2]>=a[2]}}function e$(e=""){const t=[0,0,0];return e.split(".").forEach((n,r)=>t[r]=parseInt(n,10)),t}class Se{static isSQLiteFamily(t){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(t.options.type)}static isMySQLFamily(t){return["mysql","mariadb"].includes(t.options.type)}static isReleaseVersionOrGreater(t,n){return t.version!=null&&qde.isGreaterOrEqual(t.version,n)}static isPostgresFamily(t){return["postgres","aurora-postgres","cockroachdb"].includes(t.options.type)}static buildDriverOptions(t,n){if(t.url){const r=this.parseConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildMongoDBDriverOptions(t,n){if(t.url){const r=this.parseMongoDBConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildAlias({maxAliasLength:t},n,...r){const a=n&&n.joiner?n.joiner:"_";let o=r.length===1?r[0]:r.join(a);if(t&&t>0&&o.length>t){if(n&&n.shorten===!0){const i=Wde(o);if(i.length<t)return i}return Hde(o,{length:t})}return o}static buildColumnAlias({maxAliasLength:t},n,...r){return typeof n=="string"?(r.unshift(n),n={shorten:!1,joiner:"_"}):n=Object.assign({shorten:!1,joiner:"_"},n),this.buildAlias({maxAliasLength:t},n,...r)}static parseConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0;s&&s.indexOf("?")!==-1&&(s=s.substr(0,s.indexOf("?")));const c=i.lastIndexOf("@"),l=i.substr(0,c),u=i.substr(c+1);let d=l,f="";const p=l.indexOf(":");p!==-1&&(d=l.substr(0,p),f=l.substr(p+1));const[m,y]=u.split(":");return{type:n,host:m,username:decodeURIComponent(d),password:decodeURIComponent(f),port:y?parseInt(y):void 0,database:s||void 0}}static parseMongoDBConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0,c="",l,u,d,f,p={};if(s&&s.indexOf("?")!==-1){c=s.substr(s.indexOf("?")+1,s.length);const S=c.split("&");let j,E;S.forEach(O=>{j=O.split("=")[0],E=O.split("=")[1],p[j]=E}),f=p.replicaSet,s=s.substr(0,s.indexOf("?"))}const m=i.lastIndexOf("@"),y=i.substr(0,m),v=i.substr(m+1);let b=y,w="";const _=y.indexOf(":");_!==-1&&(b=y.substr(0,_),w=y.substr(_+1)),f?d=v:[l,u]=v.split(":");let x={type:n,host:l,hostReplicaSet:d,username:decodeURIComponent(b),password:decodeURIComponent(w),port:u?parseInt(u):void 0,database:s||void 0};for(const[S,j]of Object.entries(p))x[S]=j;return x}}class t${constructor(t,n,r){this.connection=t,this.queryExpressionMap=n,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,r&&cn.assign(this,r)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){let t=()=>{for(const n of this.queryExpressionMap.selects)if(n.selection===this.alias.name||this.metadata&&this.metadata.columns.find(r=>n.selection===this.alias.name+"."+r.propertyPath))return!0;return!1};this.isSelectedCache=t(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(Ka.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(Ka.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let t=()=>{if(!Ka.isAliasProperty(this.entityOrProperty))return;const n=this.queryExpressionMap.findAliasByName(this.parentAlias);let r=n.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(r||n.metadata.parentEntityMetadata&&(r=n.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),r))return r;throw new Ee(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=t.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new Ee("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new Ee("Junction property is not defined.");const t=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?Se.buildAlias(this.connection.driver,void 0,t,this.alias.name):Se.buildAlias(this.connection.driver,void 0,this.alias.name,t)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class X_{constructor(t,n){this.queryExpressionMap=t,this.disableMixedMap=!1,cn.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Ka.isAliasProperty(this.relationName))throw new Ee("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!Ka.isAliasProperty(this.relationName))throw new Ee("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!Ka.isAliasProperty(this.relationName))throw new Ee("Given value must be a string representation of alias property");const t=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new Ee(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return t}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class Y_{constructor(t,n){this.expressionMap=t,cn.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Ka.isAliasProperty(this.relationName))throw new Ee("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!Ka.isAliasProperty(this.relationName))throw new Ee("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rc"}get relation(){if(!Ka.isAliasProperty(this.relationName))throw new Ee("Given value is a string representation of alias property");const[t,n]=this.relationName.split("."),r=this.expressionMap.findAliasByName(t).metadata.findRelationWithPropertyPath(n);if(!r)throw new Ee(`Relation with property path ${n} in entity was not found.`);return r}get metadata(){if(!Ka.isAliasProperty(this.relationName))throw new Ee("Given value is a string representation of alias property");const t=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(t).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}class J_{constructor(t){var n;this.connection=t,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],t.options.relationLoadStrategy&&(this.relationLoadStrategy=t.options.relationLoadStrategy),this.timeTravel=((n=t.options)==null?void 0:n.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const t=this.mainAlias.metadata.orderBy||{};return Object.keys(t).reduce((n,r)=>(n[this.mainAlias.name+"."+r]=t[r],n),{})}return this.orderBys}setMainAlias(t){return this.mainAlias=t,t}createAlias(t){let n=t.name;!n&&t.tablePath&&(n=t.tablePath),!n&&typeof t.target=="function"&&(n=t.target.name),!n&&typeof t.target=="string"&&(n=t.target);const r=new zL;return r.type=t.type,n&&(r.name=n),t.metadata&&(r.metadata=t.metadata),t.target&&!r.hasMetadata&&(r.metadata=this.connection.getMetadata(t.target)),t.tablePath&&(r.tablePath=t.tablePath),t.subQuery&&(r.subQuery=t.subQuery),this.aliases.push(r),r}findAliasByName(t){const n=this.aliases.find(r=>r.name===t);if(!n)throw new Ee(`"${t}" alias was not found. Maybe you forgot to join it?`);return n}findColumnByAliasExpression(t){const[n,r]=t.split(".");return this.findAliasByName(n).metadata.findColumnWithPropertyName(r)}get relationMetadata(){if(!this.mainAlias)throw new Ee("Entity to work with is not specified!");const t=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new Ee(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return t}clone(){const t=new J_(this.connection);return t.queryType=this.queryType,t.selects=this.selects.map(n=>n),t.maxExecutionTime=this.maxExecutionTime,t.selectDistinct=this.selectDistinct,t.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(n=>t.aliases.push(new zL(n))),t.relationLoadStrategy=this.relationLoadStrategy,t.mainAlias=this.mainAlias,t.valuesSet=this.valuesSet,t.returning=this.returning,t.onConflict=this.onConflict,t.onIgnore=this.onIgnore,t.onUpdate=this.onUpdate,t.joinAttributes=this.joinAttributes.map(n=>new t$(this.connection,this,n)),t.relationIdAttributes=this.relationIdAttributes.map(n=>new X_(this,n)),t.relationCountAttributes=this.relationCountAttributes.map(n=>new Y_(this,n)),t.wheres=this.wheres.map(n=>({...n})),t.havings=this.havings.map(n=>({...n})),t.orderBys=Object.assign({},this.orderBys),t.groupBys=this.groupBys.map(n=>n),t.limit=this.limit,t.offset=this.offset,t.skip=this.skip,t.take=this.take,t.lockMode=this.lockMode,t.onLocked=this.onLocked,t.lockVersion=this.lockVersion,t.lockTables=this.lockTables,t.withDeleted=this.withDeleted,t.parameters=Object.assign({},this.parameters),t.disableEscaping=this.disableEscaping,t.enableRelationIdValues=this.enableRelationIdValues,t.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,t.subQuery=this.subQuery,t.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,t.cache=this.cache,t.cacheId=this.cacheId,t.cacheDuration=this.cacheDuration,t.relationPropertyPath=this.relationPropertyPath,t.of=this.of,t.insertColumns=this.insertColumns,t.whereEntities=this.whereEntities,t.updateEntity=this.updateEntity,t.callListeners=this.callListeners,t.useTransaction=this.useTransaction,t.timeTravel=this.timeTravel,t.nativeParameters=Object.assign({},this.nativeParameters),t.comment=this.comment,t.commonTableExpressions=this.commonTableExpressions.map(n=>({alias:n.alias,queryBuilder:typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.clone(),options:n.options})),t}}class n${constructor(t){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=t}}class Q_{static transformFrom(t,n){return Array.isArray(t)?t.slice().reverse().reduce((r,a)=>a.from(r),n):t.from(n)}static transformTo(t,n){return Array.isArray(t)?t.reduce((r,a)=>a.to(r),n):t.to(n)}}class Md{constructor(t,n,r=!0,a=!1,o,i){this["@instanceof"]=Symbol.for("FindOperator"),this._type=t,this._value=n,this._useParameter=r,this._multipleParameters=a,this._getSql=o,this._objectLiteralParameters=i}get useParameter(){return Ft.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return Ft.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return Ft.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return Ft.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(Ft.isFindOperator(this._value))return this._value}get getSql(){return Ft.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(t){this._value instanceof Md?this._value.transformValue(t):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(n=>t&&Q_.transformTo(t,n)):Q_.transformTo(t,this._value)}}function Xa(e){return new Md("in",e,!0,!0)}const Zde=/[.*+\-?^${}()|[\]\\]/g,Kde=e=>e.replace(Zde,"\\$&");class en{constructor(t,n){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,Ft.isDataSource(t)?(this.connection=t,this.queryRunner=n,this.expressionMap=new J_(this.connection)):(this.connection=t.connection,this.queryRunner=t.queryRunner,this.expressionMap=t.expressionMap.clone())}static registerQueryBuilderClass(t,n){en.queryBuilderRegistry[t]=n}get alias(){if(!this.expressionMap.mainAlias)throw new Ee("Main alias is not set");return this.expressionMap.mainAlias.name}select(t,n){return this.expressionMap.queryType="select",Array.isArray(t)?this.expressionMap.selects=t.map(r=>({selection:r})):t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]),Ft.isSelectQueryBuilder(this)?this:en.queryBuilderRegistry.SelectQueryBuilder(this)}insert(){return this.expressionMap.queryType="insert",Ft.isInsertQueryBuilder(this)?this:en.queryBuilderRegistry.InsertQueryBuilder(this)}update(t,n){const r=n||t;if(t=Ft.isEntitySchema(t)?t.options.name:t,typeof t=="function"||typeof t=="string"){const a=this.createFromAlias(t);this.expressionMap.setMainAlias(a)}return this.expressionMap.queryType="update",this.expressionMap.valuesSet=r,Ft.isUpdateQueryBuilder(this)?this:en.queryBuilderRegistry.UpdateQueryBuilder(this)}delete(){return this.expressionMap.queryType="delete",Ft.isDeleteQueryBuilder(this)?this:en.queryBuilderRegistry.DeleteQueryBuilder(this)}softDelete(){return this.expressionMap.queryType="soft-delete",Ft.isSoftDeleteQueryBuilder(this)?this:en.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}restore(){return this.expressionMap.queryType="restore",Ft.isSoftDeleteQueryBuilder(this)?this:en.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}relation(t,n){const r=arguments.length===2?t:void 0,a=arguments.length===2?n:t;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=a,r){const o=this.createFromAlias(r);this.expressionMap.setMainAlias(o)}return Ft.isRelationQueryBuilder(this)?this:en.queryBuilderRegistry.RelationQueryBuilder(this)}hasRelation(t,n){const r=this.connection.getMetadata(t);return(Array.isArray(n)?n:[n]).every(a=>!!r.findRelationWithPropertyPath(a))}hasParameter(t){var n;return((n=this.parentQueryBuilder)==null?void 0:n.hasParameter(t))||t in this.expressionMap.parameters}setParameter(t,n){if(typeof n=="function")throw new Ee(`Function parameter isn't supported in the parameters. Please check "${t}" parameter.`);if(!t.match(/^([A-Za-z0-9_.]+)$/))throw new Ee("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(t,n),this.expressionMap.parameters[t]=n,this}setParameters(t){for(const[n,r]of Object.entries(t))this.setParameter(n,r);return this}createParameter(t){let n;do n=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(n));return this.setParameter(n,t),`:${n}`}setNativeParameters(t){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(t),Object.keys(t).forEach(n=>{this.expressionMap.nativeParameters[n]=t[n]}),this}getParameters(){const t=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const n=this.expressionMap.mainAlias.metadata;if(n.discriminatorColumn&&n.parentEntityMetadata){const r=n.childEntityMetadatas.filter(a=>a.discriminatorColumn).map(a=>a.discriminatorValue);r.push(n.discriminatorValue),t.discriminatorColumnValues=r}}return t}printSql(){const[t,n]=this.getQueryAndParameters();return this.connection.logger.logQuery(t,n),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const t=this.getQuery(),n=this.getParameters();return this.connection.driver.escapeQueryWithParameters(t,n,this.expressionMap.nativeParameters)}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();try{return await r.query(t,n)}finally{r!==this.queryRunner&&await r.release()}}createQueryBuilder(t){return new this.constructor(this.connection,t??this.queryRunner)}clone(){return new this.constructor(this)}comment(t){return this.expressionMap.comment=t,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(t){return this.expressionMap.disableEscaping?this.connection.driver.escape(t):t}setQueryRunner(t){return this.queryRunner=t,this}callListeners(t){return this.expressionMap.callListeners=t,this}useTransaction(t){return this.expressionMap.useTransaction=t,this}addCommonTableExpression(t,n,r){return this.expressionMap.commonTableExpressions.push({queryBuilder:t,alias:n,options:r||{}}),this}getTableName(t){return t.split(".").map(n=>n===""?n:this.escape(n)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new Ee('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(t,n){if(this.connection.hasMetadata(t)){const r=this.connection.getMetadata(t);return this.expressionMap.createAlias({type:"from",name:n,metadata:this.connection.getMetadata(t),tablePath:r.tablePath})}else{if(typeof t=="string"){const o=t.substr(0,1)==="("&&t.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:n,tablePath:o?void 0:t,subQuery:o?t:void 0})}const r=t(this.subQuery());this.setParameters(r.getParameters());const a=r.getQuery();return this.expressionMap.createAlias({type:"from",name:n,subQuery:a})}}replacePropertyNames(t){return t}replacePropertyNamesForTheWholeQuery(t){const n={};for(const o of this.expressionMap.aliases){if(!o.hasMetadata)continue;const i=this.expressionMap.aliasNamePrefixingEnabled&&o.name?`${o.name}.`:"";n[i]||(n[i]={});for(const s of o.metadata.relations)s.joinColumns.length>0&&(n[i][s.propertyPath]=s.joinColumns[0].databaseName);for(const s of o.metadata.relations){const c=[...s.joinColumns,...s.inverseJoinColumns];for(const l of c){const u=`${s.propertyPath}.${l.referencedColumn.propertyPath}`;n[i][u]=l.databaseName}}for(const s of o.metadata.columns)n[i][s.databaseName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyPath]=s.databaseName}const r=Object.keys(n),a=r.map(o=>Kde(o)).join("|");return r.length>0&&(t=t.replace(new RegExp(`([ =(]|^.{0})${a?"("+a+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...o)=>{let i,s,c;if(a){if(i=o[0],s=o[1],c=o[3],n[o[2]][c])return`${s}${this.escape(o[2].substring(0,o[2].length-1))}.${this.escape(n[o[2]][c])}`}else if(i=o[0],s=o[1],c=o[2],n[""][c])return`${s}${this.escape(n[""][c])}`;return i})),t}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace(/\*\//g,"")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const t=[],n=this.createWhereClausesExpression(this.expressionMap.wheres);if(n.length>0&&n!=="1=1"&&t.push(this.replacePropertyNames(n)),this.expressionMap.mainAlias.hasMetadata){const a=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&a.deleteDateColumn){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.deleteDateColumn.propertyName:a.deleteDateColumn.propertyName,i=`${this.replacePropertyNames(o)} IS NULL`;t.push(i)}if(a.discriminatorColumn&&a.parentEntityMetadata){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.discriminatorColumn.databaseName:a.discriminatorColumn.databaseName,i=`${this.replacePropertyNames(o)} IN (:...discriminatorColumnValues)`;t.push(i)}}if(this.expressionMap.extraAppendedAndWhereCondition){const a=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);t.push(a)}let r="";return r+=this.createTimeTravelQuery(),t.length?t.length===1?r+=` WHERE ${t[0]}`:r+=` WHERE ( ${t.join(" ) AND ( ")} )`:r+="",r}createReturningExpression(t){const n=this.getReturningColumns(),r=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&r.isReturningSqlSupported(t)&&n.push(...this.expressionMap.extraReturningColumns.filter(a=>n.indexOf(a)===-1)),n.length){let a=n.map(o=>{const i=this.escape(o.databaseName);return r.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+i:this.escape(this.getMainTableName())+"."+i:i}).join(", ");return r.options.type==="oracle"&&(a+=" INTO "+n.map(o=>this.createParameter({type:r.columnTypeToNativeParameter(o.type),dir:r.oracle.BIND_OUT})).join(", ")),r.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(a+=" INTO @OutputTable"),a}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const t=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(n=>{this.expressionMap.mainAlias.hasMetadata&&t.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n))}),t}createWhereClausesExpression(t){return t.map((n,r)=>{const a=this.createWhereConditionExpression(n.condition);switch(n.type){case"and":return(r>0?"AND ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`;case"or":return(r>0?"OR ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`}return a}).join(" ").trim()}createWhereConditionExpression(t,n=!1){if(typeof t=="string")return t;if(Array.isArray(t))return t.length===0?"1=1":t.length===1&&!n?this.createWhereClausesExpression(t):"("+this.createWhereClausesExpression(t)+")";const{driver:r}=this.connection;switch(t.operator){case"lessThan":return`${t.parameters[0]} < ${t.parameters[1]}`;case"lessThanOrEqual":return`${t.parameters[0]} <= ${t.parameters[1]}`;case"arrayContains":return`${t.parameters[0]} @> ${t.parameters[1]}`;case"jsonContains":return`${t.parameters[0]} ::jsonb @> ${t.parameters[1]}`;case"arrayContainedBy":return`${t.parameters[0]} <@ ${t.parameters[1]}`;case"arrayOverlap":return`${t.parameters[0]} && ${t.parameters[1]}`;case"moreThan":return`${t.parameters[0]} > ${t.parameters[1]}`;case"moreThanOrEqual":return`${t.parameters[0]} >= ${t.parameters[1]}`;case"notEqual":return`${t.parameters[0]} != ${t.parameters[1]}`;case"equal":return`${t.parameters[0]} = ${t.parameters[1]}`;case"ilike":return r.options.type==="postgres"||r.options.type==="cockroachdb"?`${t.parameters[0]} ILIKE ${t.parameters[1]}`:`UPPER(${t.parameters[0]}) LIKE UPPER(${t.parameters[1]})`;case"like":return`${t.parameters[0]} LIKE ${t.parameters[1]}`;case"between":return`${t.parameters[0]} BETWEEN ${t.parameters[1]} AND ${t.parameters[2]}`;case"in":return t.parameters.length<=1?"0=1":`${t.parameters[0]} IN (${t.parameters.slice(1).join(", ")})`;case"any":return r.options.type==="cockroachdb"?`${t.parameters[0]}::STRING = ANY(${t.parameters[1]}::STRING[])`:`${t.parameters[0]} = ANY(${t.parameters[1]})`;case"isNull":return`${t.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(t.condition)})`;case"brackets":return`${this.createWhereConditionExpression(t.condition,!0)}`;case"and":return"("+t.parameters.join(" AND ")+")";case"or":return"("+t.parameters.join(" OR ")+")"}throw new TypeError(`Unsupported FindOperator ${Md.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const t=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(n=>{const r=typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.getQuery();if(typeof n.queryBuilder!="string"){if(n.queryBuilder.hasCommonTableExpressions())throw new Ee(`Nested CTEs aren't supported (CTE: ${n.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!Ft.isSelectQueryBuilder(n.queryBuilder))throw new Ee(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${n.alias})`);this.setParameters(n.queryBuilder.getParameters())}let a=this.escape(n.alias);if(n.options.columnNames){const s=n.options.columnNames.map(c=>this.escape(c));if(Ft.isSelectQueryBuilder(n.queryBuilder)&&n.queryBuilder.expressionMap.selects.length&&n.options.columnNames.length!==n.queryBuilder.expressionMap.selects.length)throw new Ee(`cte.options.columnNames length (${n.options.columnNames.length}) doesn't match subquery select list length ${n.queryBuilder.expressionMap.selects.length} (CTE: ${n.alias})`);a+=`(${s.join(", ")})`}const o=n.options.recursive&&t?"RECURSIVE":"";let i="";return this.connection.driver.cteCapabilities.materializedHint&&n.options.materialized!==void 0&&(i=n.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[o,a,"AS",i,`(${r})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(t){const n=this.expressionMap.mainAlias.metadata,r=(Array.isArray(t)?t:[t]).map(a=>n.ensureEntityIdMap(a));if(!n.hasMultiplePrimaryKeys){const a=n.primaryColumns[0];if(!a.transformer&&!a.relationMetadata&&!a.embeddedMetadata)return{[a.propertyName]:Xa(r.map(o=>a.getEntityValue(o,!1)))}}return new n$(a=>{for(const o of r)a.orWhere(new n$(i=>i.where(o)))})}getExistsCondition(t){const n=t.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${n.getQuery()})`,n.getParameters()]}findColumnsForPropertyPath(t){let n=this.expressionMap.mainAlias;const r=[],a=t.split(".");for(;a.length>1;){const s=a[0];if(!(n!=null&&n.hasMetadata))break;if(n.metadata.hasEmbeddedWithPropertyPath(s)){a.unshift(`${a.shift()}.${a.shift()}`);continue}if(n.metadata.hasRelationWithPropertyPath(s)){const c=this.expressionMap.joinAttributes.find(l=>l.relationPropertyPath===s);if(!(c!=null&&c.alias)){const l=r.length>0?`${r.join(".")}.${s}`:s;throw new Error(`Cannot find alias for relation at ${l}`)}n=c.alias,r.push(...s.split(".")),a.shift();continue}break}if(!n)throw new Error(`Cannot find alias for property ${t}`);const o=a.join("."),i=n.metadata.findColumnsWithPropertyPath(o);if(!i.length)throw new Za(t,n.metadata);return[n,r,i]}createPropertyPath(t,n,r=""){const a=[];for(const o of Object.keys(n)){const i=r?`${r}.${o}`:o;if(n[o]===null||typeof n[o]!="object"||Ft.isFindOperator(n[o])){a.push(i);continue}if(t.hasEmbeddedWithPropertyPath(i)){const s=this.createPropertyPath(t,n[o],i);a.push(...s);continue}if(t.hasRelationWithPropertyPath(i)){const s=t.findRelationWithPropertyPath(i);if(s.relationType==="one-to-one"||s.relationType==="many-to-one"){const u=s.joinColumns.map(d=>d.referencedColumn).filter(d=>!!d);if(u.length>0&&u.every(d=>d.getEntityValue(n[o],!1))){a.push(i);continue}}if(s.relationType==="one-to-many"||s.relationType==="many-to-many")throw new Error(`Cannot query across ${s.relationType} for property ${i}`);const c=s.inverseEntityMetadata.primaryColumns;if(c.length>0&&c.every(u=>u.getEntityValue(n[o],!1))){const u=c.map(d=>`${i}.${d.propertyPath}`);a.push(...u);continue}const l=this.createPropertyPath(s.inverseEntityMetadata,n[o]).map(u=>`${i}.${u}`);a.push(...l);continue}a.push(i)}return a}*getPredicates(t){if(this.expressionMap.mainAlias.hasMetadata){const n=this.createPropertyPath(this.expressionMap.mainAlias.metadata,t);for(const r of n){const[a,o,i]=this.findColumnsForPropertyPath(r);for(const s of i){let c=t;for(const d of o){if(!c||!(d in c)){c={};break}c=c[d]}const l=this.expressionMap.aliasNamePrefixingEnabled?`${a.name}.${s.propertyPath}`:s.propertyPath,u=s.getEntityValue(c,!0);yield[l,u]}}}else for(const n of Object.keys(t)){const r=t[n];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${n}`:n,r]}}getWherePredicateCondition(t,n){if(Ft.isFindOperator(n)){let r=[];if(n.useParameter)if(n.objectLiteralParameters)this.setParameters(n.objectLiteralParameters);else if(n.multipleParameters)for(const a of n.value)r.push(this.createParameter(a));else r.push(this.createParameter(n.value));if(n.type==="raw")return n.getSql?n.getSql(t):{operator:"equal",parameters:[t,n.value]};if(n.type==="not")return n.child?{operator:n.type,condition:this.getWherePredicateCondition(t,n.child)}:{operator:"notEqual",parameters:[t,...r]};if(n.type==="and"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else if(n.type==="or"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else return{operator:n.type,parameters:[t,...r]}}else return{operator:"equal",parameters:[t,this.createParameter(n)]}}getWhereCondition(t){if(typeof t=="string")return t;if(Ft.isBrackets(t)){const a=this.createQueryBuilder();return a.parentQueryBuilder=this,a.expressionMap.mainAlias=this.expressionMap.mainAlias,a.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,a.expressionMap.parameters=this.expressionMap.parameters,a.expressionMap.nativeParameters=this.expressionMap.nativeParameters,a.expressionMap.wheres=[],t.whereFactory(a),{operator:Ft.isNotBrackets(t)?"not":"brackets",condition:a.expressionMap.wheres}}if(typeof t=="function")return t(this);const n=Array.isArray(t)?t:[t],r=[];for(const a of n){const o=[];for(const[i,s]of this.getPredicates(a))o.push({type:"and",condition:this.getWherePredicateCondition(i,s)});r.push({type:"or",condition:o})}return r.length===1?r[0].condition:r}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}en.queryBuilderRegistry={};class Xde{static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class Yde extends en{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("DeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createDeleteExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("BeforeRemove",this.expressionMap.mainAlias.metadata);const o=await r.query(t,n,!0),i=Xde.from(o);return this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("AfterRemove",this.expressionMap.mainAlias.metadata),a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}finally{r!==this.queryRunner&&await r.release()}}from(t,n){t=Ft.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("delete"))throw new _m;return this.expressionMap.returning=t,this}createDeleteExpression(){const t=this.getTableName(this.getMainTableName()),n=this.createWhereExpression(),r=this.createReturningExpression("delete");return r===""?`DELETE FROM ${t}${n}`:this.connection.driver.options.type==="mssql"?`DELETE FROM ${t} OUTPUT ${r}${n}`:`DELETE FROM ${t}${n} RETURNING ${r}`}}let Sm;const Jde=new Uint8Array(16);function Qde(){if(!Sm&&(Sm=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Sm))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Sm(Jde)}const kn=[];for(let e=0;e<256;++e)kn.push((e+256).toString(16).slice(1));function Gde(e,t=0){return kn[e[t+0]]+kn[e[t+1]]+kn[e[t+2]]+kn[e[t+3]]+"-"+kn[e[t+4]]+kn[e[t+5]]+"-"+kn[e[t+6]]+kn[e[t+7]]+"-"+kn[e[t+8]]+kn[e[t+9]]+"-"+kn[e[t+10]]+kn[e[t+11]]+kn[e[t+12]]+kn[e[t+13]]+kn[e[t+14]]+kn[e[t+15]]}const efe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),r$={randomUUID:efe};function tfe(e,t,n){if(r$.randomUUID&&!t&&!e)return r$.randomUUID();e=e||{};const r=e.random||(e.rng||Qde)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Gde(r)}class a${constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}class o${constructor(){this.identifiers=[],this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.raw,n}}class G_{constructor(t,n){this.queryRunner=t,this.expressionMap=n}async update(t,n){const r=this.expressionMap.mainAlias.metadata;await Promise.all(n.map(async(a,o)=>{if(this.queryRunner.connection.driver.isReturningSqlSupported("update")){this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((c,l,u)=>(c[this.expressionMap.extraReturningColumns[u].databaseName]=l[0],c),{}));const i=Array.isArray(t.raw)?t.raw[o]:t.raw,s=this.queryRunner.connection.driver.createGeneratedMap(r,i);s&&(this.queryRunner.manager.merge(r.target,a,s),t.generatedMaps.push(s))}else{const i=this.expressionMap.extraReturningColumns;if(i.length>0){const s=this.expressionMap.mainAlias.metadata.getEntityIdMap(a);if(!s)throw new Ee("Cannot update entity because entity id is not set in the entity.");const c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(i.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).withDeleted().setOption("create-pojo").getOne();c&&(this.queryRunner.manager.merge(r.target,a,c),t.generatedMaps.push(c))}}}))}async insert(t,n){const r=this.expressionMap.mainAlias.metadata;let a=r.getInsertionReturningColumns();const o=this.queryRunner.connection.driver.isReturningSqlSupported("insert");a=a.filter(s=>s.isGenerated?o===!0:!0);const i=n.map((s,c)=>{this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((d,f,p)=>(d[this.expressionMap.extraReturningColumns[p].databaseName]=f[0],d),{}));const l=Array.isArray(t.raw)?t.raw[c]:t.raw,u=this.queryRunner.connection.driver.createGeneratedMap(r,l,c,n.length)||{};return c in this.expressionMap.locallyGenerated&&this.queryRunner.manager.merge(r.target,u,this.expressionMap.locallyGenerated[c]),this.queryRunner.manager.merge(r.target,s,u),u});if(a.length>0&&!this.queryRunner.connection.driver.isReturningSqlSupported("insert")){const s=n.map(l=>{const u=r.getEntityIdMap(l);if(!u)throw new Ee("Cannot update entity because entity id is not set in the entity.");return u}),c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(a.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).setOption("create-pojo").getMany();n.forEach((l,u)=>{this.queryRunner.manager.merge(r.target,i[u],c[u]),this.queryRunner.manager.merge(r.target,l,c[u])})}n.forEach((s,c)=>{const l=r.getEntityIdMap(s);t.identifiers.push(l),t.generatedMaps.push(i[c])})}getUpdationReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion)}getSoftDeletionReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion||t.isDeleteDate)}}class nfe extends en{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("InsertQueryBuilder")}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createInsertExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.getValueSets();if(t.length===0)return new o$;const n=this.obtainQueryRunner();let r=!1;try{if(this.expressionMap.useTransaction===!0&&n.isTransactionActive===!1&&(await n.startTransaction(),r=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const p=new a$;t.forEach(m=>{n.broadcaster.broadcastBeforeInsertEvent(p,this.expressionMap.mainAlias.metadata,m)}),await p.wait()}let a=null,o=null;const i=new G_(n,this.expressionMap),s=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const p of this.expressionMap.returning)s.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(p));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&(t.length>1&&this.connection.driver.options.type==="oracle"||(this.expressionMap.extraReturningColumns=this.expressionMap.mainAlias.metadata.getInsertionReturningColumns()),s.push(...this.expressionMap.extraReturningColumns.filter(p=>!s.includes(p)))),s.length>0&&this.connection.driver.options.type==="mssql"&&(a=this.connection.driver.buildTableVariableDeclaration("@OutputTable",s),o="SELECT * FROM @OutputTable");const[c,l]=this.getQueryAndParameters(),u=[a,c,o].filter(p=>p!=null).join(`;

`),d=await n.query(u,l,!0),f=o$.from(d);if(this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&await i.insert(f,t),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const p=new a$;t.forEach(m=>{n.broadcaster.broadcastAfterInsertEvent(p,this.expressionMap.mainAlias.metadata,m)}),await p.wait()}return r&&await n.commitTransaction(),f}catch(a){if(r)try{await n.rollbackTransaction()}catch{}throw a}finally{n!==this.queryRunner&&await n.release()}}into(t,n){t=Ft.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t);return this.expressionMap.setMainAlias(r),this.expressionMap.insertColumns=n||[],this}values(t){return this.expressionMap.valuesSet=t,this}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("insert"))throw new _m;return this.expressionMap.returning=t,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}onConflict(t){return this.expressionMap.onConflict=t,this}orIgnore(t=!0){return this.expressionMap.onIgnore=!!t,this}orUpdate(t,n,r){return Array.isArray(t)?(this.expressionMap.onUpdate={overwrite:t,conflict:n,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,indexPredicate:r==null?void 0:r.indexPredicate,upsertType:r==null?void 0:r.upsertType},this):(this.expressionMap.onUpdate={conflict:t==null?void 0:t.conflict_target,columns:t==null?void 0:t.columns,overwrite:t==null?void 0:t.overwrite,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,upsertType:r==null?void 0:r.upsertType},this)}createInsertExpression(){var i,s;const t=this.getTableName(this.getMainTableName()),n=this.createValuesExpression(),r=this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1?null:this.createReturningExpression("insert"),a=this.createColumnNamesExpression();let o="INSERT ";if(((i=this.expressionMap.onUpdate)==null?void 0:i.upsertType)==="primary-key"&&(o="UPSERT "),(Se.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+=`${this.expressionMap.onIgnore?" IGNORE ":""}`),o+=`INTO ${t}`,this.alias!==this.getMainTableName()&&Se.isPostgresFamily(this.connection.driver)&&(o+=` AS "${this.alias}"`),a?o+=`(${a})`:!n&&(Se.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+="()"),r&&this.connection.driver.options.type==="mssql"&&(o+=` OUTPUT ${r}`),n?(this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="sap")&&this.getValueSets().length>1?o+=` ${n}`:o+=` VALUES ${n}`:Se.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"?o+=" VALUES ()":o+=" DEFAULT VALUES",((s=this.expressionMap.onUpdate)==null?void 0:s.upsertType)!=="primary-key"){if(this.connection.driver.supportedUpsertTypes.includes("on-conflict-do-update")){if(this.expressionMap.onIgnore)o+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)o+=` ON CONFLICT ${this.expressionMap.onConflict} `;else if(this.expressionMap.onUpdate){const{overwrite:c,columns:l,conflict:u,skipUpdateIfNoValuesChanged:d,indexPredicate:f}=this.expressionMap.onUpdate;let p="ON CONFLICT";if(Array.isArray(u)){if(p+=` ( ${u.map(y=>this.escape(y)).join(", ")} )`,f&&!Se.isPostgresFamily(this.connection.driver))throw new Ee("indexPredicate option is not supported by the current database driver");f&&Se.isPostgresFamily(this.connection.driver)&&(p+=` WHERE ( ${f} )`)}else u&&(p+=` ON CONSTRAINT ${this.escape(u)}`);const m=[];Array.isArray(c)?m.push(...c.map(y=>`${this.escape(y)} = EXCLUDED.${this.escape(y)}`)):l&&m.push(...l.map(y=>`${this.escape(y)} = :${y}`)),m.length>0&&(o+=` ${p} DO UPDATE SET `,m.push(...this.expressionMap.mainAlias.metadata.columns.filter(y=>y.isUpdateDate&&!(c!=null&&c.includes(y.databaseName))&&!(this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1||Se.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")).map(y=>`${this.escape(y.databaseName)} = DEFAULT`)),o+=m.join(", "),o+=" "),Array.isArray(c)&&d&&Se.isPostgresFamily(this.connection.driver)&&(o+=" WHERE (",o+=c.map(y=>`${t}.${this.escape(y)} IS DISTINCT FROM EXCLUDED.${this.escape(y)}`).join(" OR "),o+=") ")}}else if(this.connection.driver.supportedUpsertTypes.includes("on-duplicate-key-update")){if(this.expressionMap.onUpdate){const{overwrite:c,columns:l}=this.expressionMap.onUpdate;Array.isArray(c)?(o+=" ON DUPLICATE KEY UPDATE ",o+=c.map(u=>`${this.escape(u)} = VALUES(${this.escape(u)})`).join(", "),o+=" "):Array.isArray(l)&&(o+=" ON DUPLICATE KEY UPDATE ",o+=l.map(u=>`${this.escape(u)} = :${u}`).join(", "),o+=" ")}}else if(this.expressionMap.onUpdate)throw new Ee("onUpdate is not supported by the current database driver")}return r&&(Se.isPostgresFamily(this.connection.driver)||this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="cockroachdb"||Se.isMySQLFamily(this.connection.driver))&&(o+=` RETURNING ${r}`),this.connection.driver.options.type==="mssql"&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter(c=>this.expressionMap.insertColumns.length>0?this.expressionMap.insertColumns.indexOf(c.propertyPath)!==-1:c.isInsert).some(c=>this.isOverridingAutoIncrementBehavior(c))&&(o=`SET IDENTITY_INSERT ${t} ON; ${o}; SET IDENTITY_INSERT ${t} OFF`),o}getInsertedColumns(){return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter(t=>this.expressionMap.insertColumns.length?this.expressionMap.insertColumns.indexOf(t.propertyPath)!==-1:!(!t.isInsert||t.isGenerated&&t.generationStrategy==="increment"&&this.connection.driver.options.type!=="spanner"&&this.connection.driver.options.type!=="oracle"&&!Se.isSQLiteFamily(this.connection.driver)&&!Se.isMySQLFamily(this.connection.driver)&&this.connection.driver.options.type!=="aurora-mysql"&&!(this.connection.driver.options.type==="mssql"&&this.isOverridingAutoIncrementBehavior(t)))):[]}createColumnNamesExpression(){const t=this.getInsertedColumns();if(t.length>0)return t.map(n=>this.escape(n.databaseName)).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){const n=this.getValueSets();if(n.length===1)return Object.keys(n[0]).map(r=>this.escape(r)).join(", ")}return this.expressionMap.insertColumns.map(n=>this.escape(n)).join(", ")}createValuesExpression(){const t=this.getValueSets(),n=this.getInsertedColumns();if(n.length>0){let r="";return t.forEach((a,o)=>{n.forEach((i,s)=>{s===0&&(this.connection.driver.options.type==="oracle"&&t.length>1||this.connection.driver.options.type==="sap"&&t.length>1?r+=" SELECT ":r+="(");let c=i.getEntityValue(a);if(typeof c!="function"&&(c=this.connection.driver.preparePersistentValue(c,i)),i.isVersion&&c===void 0)r+="1";else if(i.isDiscriminator)r+=this.createParameter(this.expressionMap.mainAlias.metadata.discriminatorValue);else if(i.isGenerated&&i.generationStrategy==="uuid"&&!this.connection.driver.isUUIDGenerationSupported()&&c===void 0)c=tfe(),r+=this.createParameter(c),o in this.expressionMap.locallyGenerated||(this.expressionMap.locallyGenerated[o]={}),i.setEntityValue(this.expressionMap.locallyGenerated[o],c);else if(c===void 0)this.connection.driver.options.type==="oracle"&&t.length>1||Se.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?i.default!==void 0&&i.default!==null?r+=this.connection.driver.normalizeDefault(i):r+="NULL":r+="DEFAULT";else if(c===null&&this.connection.driver.options.type==="spanner")r+="NULL";else if(typeof c=="function")r+=c();else{this.connection.driver.options.type==="mssql"&&(c=this.connection.driver.parametrizeValue(i,c));const l=this.createParameter(c);if((Se.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1){const u=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";i.srid!=null?r+=`${u}(${l}, ${i.srid})`:r+=`${u}(${l})`}else Se.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?i.srid!=null?r+=`ST_SetSRID(ST_GeomFromGeoJSON(${l}), ${i.srid})::${i.type}`:r+=`ST_GeomFromGeoJSON(${l})::${i.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?r+=i.type+"::STGeomFromText("+l+", "+(i.srid||"0")+")":r+=l}s===n.length-1?o===t.length-1?this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy ":r+=")":this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL UNION ALL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy UNION ALL ":r+="), ":r+=", "})}),r==="()"?"":r}else{let r="";return t.forEach((a,o)=>{Object.keys(a).forEach((i,s)=>{s===0&&(r+="(");const c=a[i];typeof c=="function"?r+=c():c===void 0?this.connection.driver.options.type==="oracle"&&t.length>1||Se.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?r+="NULL":r+="DEFAULT":c===null&&this.connection.driver.options.type==="spanner"||(r+=this.createParameter(c)),s===Object.keys(a).length-1?o===t.length-1?r+=")":r+="), ":r+=", "})}),r==="()"?"":r}}getValueSets(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(cn.isObject(this.expressionMap.valuesSet))return[this.expressionMap.valuesSet];throw new Tde}isOverridingAutoIncrementBehavior(t){return t.isPrimary&&t.isGenerated&&t.generationStrategy==="increment"&&this.getValueSets().some(n=>t.getEntityValue(n)!==void 0&&t.getEntityValue(n)!==null)}}class i${constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async update(t){const n=this.expressionMap.relationMetadata;if(n.isManyToOne||n.isOneToOneOwner){const r=n.joinColumns.reduce((a,o)=>{const i=cn.isObject(t)?o.referencedColumn.getEntityValue(t):t;return o.setEntityValue(a,i),a},{});if(!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length)return;await this.queryBuilder.createQueryBuilder().update(n.entityMetadata.target).set(r).whereInIds(this.expressionMap.of).execute()}else if((n.isOneToOneNotOwner||n.isOneToMany)&&t===null){const r={};n.inverseRelation.joinColumns.forEach(c=>{r[c.propertyName]=null});const a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o={},i=[];a.forEach((c,l)=>{n.inverseRelation.joinColumns.map((u,d)=>{const f="joinColumn_"+l+"_"+d;o[f]=cn.isObject(c)?u.referencedColumn.getEntityValue(c):c,i.push(`${u.propertyPath} = :${f}`)})});const s=i.map(c=>"("+c+")").join(" OR ");if(!s)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(r).where(s).setParameters(o).execute()}else if(n.isOneToOneNotOwner||n.isOneToMany){if(Array.isArray(this.expressionMap.of))throw new Ee("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");const r=this.expressionMap.of,a=n.inverseRelation.joinColumns.reduce((o,i)=>{const s=cn.isObject(r)?i.referencedColumn.getEntityValue(r):r;return i.setEntityValue(o,s),o},{});if(!t||Array.isArray(t)&&!t.length)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(a).whereInIds(t).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c=[];if(i.forEach(l=>{s.forEach(u=>{const d={};r.ownerColumns.forEach(f=>{d[f.databaseName]=cn.isObject(l)?f.referencedColumn.getEntityValue(l):l}),r.inverseColumns.forEach(f=>{d[f.databaseName]=cn.isObject(u)?f.referencedColumn.getEntityValue(u):u}),c.push(d)})}),!c.length)return;this.queryBuilder.connection.driver.options.type==="oracle"||this.queryBuilder.connection.driver.options.type==="sap"?await Promise.all(c.map(l=>this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(l).execute())):await this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(c).execute()}}}class rfe{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async remove(t){const n=this.expressionMap.relationMetadata;if(n.isOneToMany){const r=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],a=Array.isArray(t)?t:[t],o={};n.inverseRelation.joinColumns.forEach(l=>{o[l.propertyName]=null});const i={},s=[];r.forEach((l,u)=>{s.push(...a.map((d,f)=>[...n.inverseRelation.joinColumns.map((p,m)=>{const y="joinColumn_"+u+"_"+f+"_"+m;return i[y]=cn.isObject(l)?p.referencedColumn.getEntityValue(l):l,`${p.propertyPath} = :${y}`}),...n.inverseRelation.entityMetadata.primaryColumns.map((p,m)=>{const y="primaryColumn_"+f+"_"+f+"_"+m;return i[y]=cn.isObject(d)?p.getEntityValue(d):d,`${p.propertyPath} = :${y}`})].join(" AND ")))});const c=s.map(l=>"("+l+")").join(" OR ");if(!c)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(o).where(c).setParameters(i).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c={},l=[];i.forEach((d,f)=>{l.push(...s.map((p,m)=>[...r.ownerColumns.map((y,v)=>{const b="firstValue_"+f+"_"+m+"_"+v;return c[b]=cn.isObject(d)?y.referencedColumn.getEntityValue(d):d,`${y.databaseName} = :${b}`}),...r.inverseColumns.map((y,v)=>{const b="secondValue_"+f+"_"+m+"_"+v;return c[b]=cn.isObject(p)?y.referencedColumn.getEntityValue(p):p,`${y.databaseName} = :${b}`})].join(" AND ")))});const u=l.map(d=>"("+d+")").join(" OR ");await this.queryBuilder.createQueryBuilder().delete().from(r.tableName).where(u).setParameters(c).execute()}}}class afe extends en{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("RelationQueryBuilder")}getQuery(){return""}of(t){return this.expressionMap.of=t,this}async set(t){const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new Ee("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToMany||n.isOneToMany)throw new Ee(`Set operation is only supported for many-to-one and one-to-one relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .add() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!cn.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new Ee('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new i$(this,this.expressionMap).update(t)}async add(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new Ee("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new Ee(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!cn.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new Ee('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new i$(this,this.expressionMap).update(t)}async remove(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new Ee("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new Ee(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set(null) method instead.`);return new rfe(this,this.expressionMap).remove(t)}async addAndRemove(t,n){await this.remove(n),await this.add(t)}async loadOne(){return this.loadMany().then(t=>t[0])}async loadMany(){let t=this.expressionMap.of;if(!cn.isObject(t)){const n=this.expressionMap.mainAlias.metadata;if(n.hasMultiplePrimaryKeys)throw new Ee("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");t=n.primaryColumns[0].createValueMap(t)}return this.connection.relationLoader.load(this.expressionMap.relationMetadata,t,this.queryRunner)}}class Pn{static chunk(t,n){return Array.from(Array(Math.ceil(t.length/n)),(r,a)=>t.slice(a*n,a*n+n))}static splitClassesAndStrings(t){return[t.filter(n=>typeof n!="string"),t.filter(n=>typeof n=="string")]}static groupBy(t,n){return t.reduce((r,a)=>{const o=n(a);let i=r.find(s=>s.id===o);return i||(i={id:o,items:[]},r.push(i)),i.items.push(a),r},[])}static uniq(t,n){return t.reduce((r,a)=>{let o=!1;if(typeof n=="function"){const i=n(a);o=!!r.find(s=>n(s)===i)}else typeof n=="string"?o=!!r.find(i=>i[n]===a[n]):o=r.indexOf(a)!==-1;return o||r.push(a),r},[])}static isPlainObject(t){return t==null?!1:!t.constructor||t.constructor===Object}static mergeArrayKey(t,n,r,a){if(a.has(r)){t[n]=a.get(r);return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){t[n]=r;return}t[n]||(t[n]=Array.isArray(r)?[]:{}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static mergeObjectKey(t,n,r,a){if(a.has(r)){Object.assign(t,{[n]:a.get(r)});return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){Object.assign(t,{[n]:r});return}t[n]||Object.assign(t,{[n]:Array.isArray(r)?[]:{}}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static merge(t,n,r=new Map){if(this.isPlainObject(t)&&this.isPlainObject(n))for(const a of Object.keys(n))a!=="__proto__"&&this.mergeObjectKey(t,a,n[a],r);if(Array.isArray(t)&&Array.isArray(n))for(let a=0;a<n.length;a++)this.mergeArrayKey(t,a,n[a],r)}static mergeDeep(t,...n){if(!n.length)return t;for(const r of n)Pn.merge(t,r);return t}static deepCompare(...t){let n,r,a,o;if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(a=[],o=[],!this.compare2Objects(a,o,arguments[0],arguments[n]))return!1;return!0}static deepValue(t,n){const r=n.split(".");for(let a=0,o=r.length;a<o;a++)t=t[r[a]];return t}static replaceEmptyObjectsWithBooleans(t){for(let n in t)t[n]&&typeof t[n]=="object"&&(Object.keys(t[n]).length===0?t[n]=!0:this.replaceEmptyObjectsWithBooleans(t[n]))}static propertyPathsToTruthyObject(t){let n={};for(let r of t){const a=r.split(".");if(!a.length)continue;(!n[a[0]]||n[a[0]]===!0)&&(n[a[0]]={});let o=n[a[0]];for(let[i,s]of a.entries())i!==0&&(o[s]?o=o[s]:i===a.length-1?(o[s]={},o=null):(o[s]={},o=o[s]))}return this.replaceEmptyObjectsWithBooleans(n),n}static compareIds(t,n){return t==null||n===void 0||n===null?!1:(typeof t.id=="string"&&typeof n.id=="string"||typeof t.id=="number"&&typeof n.id=="number")&&Object.keys(t).length===1&&Object.keys(n).length===1?t.id===n.id:Pn.deepCompare(t,n)}static toBoolean(t){return typeof t=="boolean"?t:typeof t=="string"?t==="true"||t==="1":typeof t=="number"?t>0:!1}static zipObject(t,n){return t.reduce((r,a,o)=>(r[a]=n[o],r),{})}static isArraysEqual(t,n){return t.length!==n.length?!1:t.every(r=>n.indexOf(r)!==-1)}static areMutuallyExclusive(...t){return!t.some(n=>{const r=t.filter(a=>a!==n);return n.some(a=>r.some(o=>o.includes(a)))})}static parseSqlCheckExpression(t,n){const r=t.match(new RegExp(`"${n}" varchar CHECK\\s*\\(\\s*"${n}"\\s+IN\\s*`));if(r&&r.index){const a=t.substring(r.index+r[0].length);let o="",i="";const s=[];for(let c=0;c<a.length;c++){const l=a[c];switch(l){case",":o==""?(s.push(i),i=""):i+=l;break;case"'":o==l?a[c+1]===l?(i+=l,c+=1):o="":o=l;break;case")":if(o=="")return s.push(i),s;i+=l;break;default:o!=""&&(i+=l)}}}}static compare2Objects(t,n,r,a){let o;if(Number.isNaN(r)&&Number.isNaN(a)||r===a)return!0;if(r===null||a===null||r===void 0||a===void 0)return!1;if((typeof r.equals=="function"||typeof r.equals=="function")&&r.equals(a))return!0;if(typeof r=="function"&&typeof a=="function"||r instanceof Date&&a instanceof Date||r instanceof RegExp&&a instanceof RegExp||typeof r=="string"&&typeof a=="string"||typeof r=="number"&&typeof a=="number")return r.toString()===a.toString();if(!(typeof r=="object"&&typeof a=="object")||Object.prototype.isPrototypeOf.call(r,a)||Object.prototype.isPrototypeOf.call(a,r)||r.constructor!==a.constructor||r.prototype!==a.prototype||t.indexOf(r)>-1||n.indexOf(a)>-1)return!1;for(o in a)if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;for(o in r){if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;switch(typeof r[o]){case"object":case"function":if(t.push(r),n.push(a),!this.compare2Objects(t,n,r[o],a[o]))return!1;t.pop(),n.pop();break;default:if(r[o]!==a[o])return!1;break}}return!0}}class ofe{constructor(t,n,r,a,o){this.expressionMap=t,this.driver=n,this.rawRelationIdResults=r,this.rawRelationCountResults=a,this.queryRunner=o}transform(t,n){const r=this.group(t,n),a=[];return r.forEach(o=>{const i=this.transformRawResultsGroup(o,n);i!==void 0&&!Object.values(i).every(s=>s===null)&&a.push(i)}),a}group(t,n){const r=new Map,a=[];return n.metadata.tableType==="view"?a.push(...n.metadata.columns.map(o=>Se.buildAlias(this.driver,void 0,n.name,o.databaseName))):a.push(...n.metadata.primaryColumns.map(o=>Se.buildAlias(this.driver,void 0,n.name,o.databaseName))),t.forEach(o=>{const i=a.map(c=>{const l=o[c];return En.isBuffer(l)?l.toString("hex"):cn.isObject(l)?JSON.stringify(l):l}).join("_"),s=r.get(i);s?s.push(o):r.set(i,[o])}),r}transformRawResultsGroup(t,n){let r=n.metadata;if(r.discriminatorColumn){const l=t.map(d=>d[Se.buildAlias(this.driver,void 0,n.name,n.metadata.discriminatorColumn.databaseName)]),u=r.childEntityMetadatas.find(d=>typeof l.find(f=>f===d.discriminatorValue)<"u");u&&(r=u)}let a=r.create(this.queryRunner,{fromDeserializer:!0,pojo:this.expressionMap.options.indexOf("create-pojo")!==-1});const o=this.transformColumns(t,n,a,r),i=this.transformJoins(t,a,n,r),s=this.transformRelationIds(t,n,a,r),c=this.transformRelationCounts(t,n,a);if(o||r.primaryColumns.filter(l=>l.isVirtual===!1).length===0&&(i||s||c))return a}transformColumns(t,n,r,a){let o=!1;return a.columns.forEach(i=>{if(a.childEntityMetadatas.length>0&&a.childEntityMetadatas.findIndex(c=>c.target===i.target)!==-1)return;const s=t[0][Se.buildAlias(this.driver,void 0,n.name,i.databaseName)];s===void 0||i.isVirtual||this.expressionMap.selects.find(c=>c.selection===n.name||c.selection===n.name+"."+i.propertyPath)&&(i.setEntityValue(r,this.driver.prepareHydratedValue(s,i)),s!==null&&(o=!0))}),o}transformJoins(t,n,r,a){let o=!1;return this.expressionMap.joinAttributes.forEach(i=>{if(!i.metadata||!i.isSelected||i.relation&&!a.relations.find(c=>c===i.relation))return;if(i.mapToProperty){if(i.mapToPropertyParentAlias!==r.name)return}else if(!i.relation||i.parentAlias!==r.name||i.relationPropertyPath!==i.relation.propertyPath)return;let s=this.transform(t,i.alias);s=i.isMany?s:s[0],s=!i.isMany&&s===void 0?null:s,s!==void 0&&(i.mapToPropertyPropertyName?n[i.mapToPropertyPropertyName]=s:i.relation.setEntityValue(n,s),o=!0)}),o}transformRelationIds(t,n,r,a){let o=!1;return this.rawRelationIdResults.forEach((i,s)=>{if(i.relationIdAttribute.parentAlias!==n.name)return;const c=i.relationIdAttribute.relation,l=this.createValueMapFromJoinColumns(c,i.relationIdAttribute.parentAlias,t);if(l==null)return;this.prepareDataForTransformRelationIds();const u=this.hashEntityIds(c,l),d=this.relationIdMaps[s][u]||[],f=i.relationIdAttribute.mapToPropertyPropertyPath.split("."),p=(m,y,v)=>{const b=m.shift();if(b&&m.length===0)return y[b]=v,y;if(b&&m.length>0)p(m,y[b],v);else return y};c.isOneToOne||c.isManyToOne?d[0]!==void 0&&(p(f,r,d[0]),o=!0):(p(f,r,d),o=o||d.length>0)}),o}transformRelationCounts(t,n,r){let a=!1;return this.rawRelationCountResults.filter(o=>o.relationCountAttribute.parentAlias===n.name).forEach(o=>{const i=o.relationCountAttribute.relation;let s;i.isOneToMany?s=i.inverseRelation.joinColumns[0].referencedColumn.databaseName:s=i.isOwning?i.joinColumns[0].referencedColumn.databaseName:i.inverseRelation.joinColumns[0].referencedColumn.databaseName;const c=t[0][Se.buildAlias(this.driver,void 0,n.name,s)];c!=null&&(r[o.relationCountAttribute.mapToPropertyPropertyName]=0,o.results.filter(l=>l.parentId===c).forEach(l=>{r[o.relationCountAttribute.mapToPropertyPropertyName]=parseInt(l.cnt),a=!0}))}),a}createValueMapFromJoinColumns(t,n,r){let a;return t.isManyToOne||t.isOneToOneOwner?a=t.entityMetadata.primaryColumns.map(o=>o):t.isOneToMany||t.isOneToOneNotOwner?a=t.inverseRelation.joinColumns.map(o=>o):t.isOwning?a=t.joinColumns.map(o=>o):a=t.inverseRelation.inverseJoinColumns.map(o=>o),a.reduce((o,i)=>(r.forEach(s=>{t.isManyToOne||t.isOneToOneOwner?o[i.databaseName]=this.driver.prepareHydratedValue(s[Se.buildAlias(this.driver,void 0,n,i.databaseName)],i):o[i.databaseName]=this.driver.prepareHydratedValue(s[Se.buildAlias(this.driver,void 0,n,i.referencedColumn.databaseName)],i.referencedColumn)}),o),{})}extractEntityPrimaryIds(t,n){let r;return t.isManyToOne||t.isOneToOneOwner?r=t.entityMetadata.primaryColumns.map(a=>a):t.isOneToMany||t.isOneToOneNotOwner?r=t.inverseRelation.joinColumns.map(a=>a):t.isOwning?r=t.joinColumns.map(a=>a):r=t.inverseRelation.inverseJoinColumns.map(a=>a),r.reduce((a,o)=>(a[o.databaseName]=n[o.databaseName],a),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(t=>{const n=t.relationIdAttribute.relation;let r;return n.isManyToOne||n.isOneToOneOwner?r=n.joinColumns:n.isOneToMany||n.isOneToOneNotOwner?r=n.inverseEntityMetadata.primaryColumns:n.isOwning?r=n.inverseJoinColumns:r=n.inverseRelation.joinColumns,t.results.reduce((a,o)=>{let i=r.reduce((s,c)=>{let l=o[c.databaseName];return n.isOneToMany||n.isOneToOneNotOwner?(c.isVirtual&&c.referencedColumn&&c.referencedColumn.propertyName!==c.propertyName&&(l=c.referencedColumn.createValueMap(l)),Pn.mergeDeep(s,c.createValueMap(l))):(!c.isPrimary&&c.referencedColumn.referencedColumn&&(l=c.referencedColumn.referencedColumn.createValueMap(l)),Pn.mergeDeep(s,c.referencedColumn.createValueMap(l)))},{});if(r.length===1&&!t.relationIdAttribute.disableMixedMap&&(n.isOneToMany||n.isOneToOneNotOwner?i=r[0].getEntityValue(i):i=r[0].referencedColumn.getEntityValue(i)),i!==void 0){const s=this.hashEntityIds(n,o);a[s]?a[s].push(i):a[s]=[i]}return a},{})}))}hashEntityIds(t,n){const r=this.extractEntityPrimaryIds(t,n);return JSON.stringify(r)}}let ife=class{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}async load(e){const t=this.relationIdAttributes.map(async n=>{if(n.relation.isManyToOne||n.relation.isOneToOneOwner){if(n.queryBuilderFactory)throw new Ee("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const r={},a=e.map(o=>{const i={},s=[];n.relation.joinColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[Se.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l.referencedColumn);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),n.relation.entityMetadata.primaryColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[Se.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),s.sort();const c=s.join("::");return r[c]?null:(r[c]=!0,i)}).filter(o=>o);return{relationIdAttribute:n,results:a}}else if(n.relation.isOneToMany||n.relation.isOneToOneNotOwner){const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.joinColumns,o=r.inverseEntityMetadata.target,i=r.inverseEntityMetadata.tableName,s=n.alias||i,c={},l={},u=e.map((p,m)=>{const y=[],v={},b=a.map(_=>{const x=_.databaseName+m,S=p[Se.buildAlias(this.connection.driver,void 0,n.parentAlias,_.referencedColumn.databaseName)],j=`${s}:${_.propertyPath}:${S}`;return y.indexOf(j)!==-1?"":(y.push(j),v[x]=S,s+"."+_.propertyPath+" = :"+x)}).filter(_=>_).join(" AND ");y.sort();const w=y.join("::");return c[w]?"":(c[w]=!0,Object.assign(l,v),b)}).filter(p=>p).map(p=>"("+p+")").join(" OR ");if(!u)return{relationIdAttribute:n,results:[]};const d=this.connection.createQueryBuilder(this.queryRunner);Pn.uniq([...a,...r.inverseRelation.entityMetadata.primaryColumns],p=>p.propertyPath).forEach(p=>{d.addSelect(s+"."+p.propertyPath,p.databaseName)}),d.from(o,s).where("("+u+")").setParameters(l),n.queryBuilderFactory&&n.queryBuilderFactory(d);const f=await d.getRawMany();return f.forEach(p=>{a.forEach(m=>{p[m.databaseName]=this.connection.driver.prepareHydratedValue(p[m.databaseName],m.referencedColumn)}),r.inverseRelation.entityMetadata.primaryColumns.forEach(m=>{p[m.databaseName]=this.connection.driver.prepareHydratedValue(p[m.databaseName],m)})}),{relationIdAttribute:n,results:f}}else{const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.inverseJoinColumns,o=r.isOwning?r.inverseJoinColumns:r.inverseRelation.joinColumns,i=n.junctionAlias,s=n.joinInverseSideMetadata.tableName,c=n.alias||s,l=r.isOwning?r.junctionEntityMetadata.tableName:r.inverseRelation.junctionEntityMetadata.tableName,u=e.map(w=>a.reduce((_,x)=>(_[x.propertyPath]=w[Se.buildAlias(this.connection.driver,void 0,n.parentAlias,x.referencedColumn.databaseName)],_),{}));if(u.length===0)return{relationIdAttribute:n,results:[]};const d={},f={},p=u.map((w,_)=>{const x=[],S={},j=Object.keys(w).map(O=>{const P=O+_,k=w[O],N=`${i}:${O}:${k}`;return x.indexOf(N)!==-1?"":(x.push(N),S[P]=k,i+"."+O+" = :"+P)}).filter(O=>O).join(" AND ");x.sort();const E=x.join("::");return f[E]?"":(f[E]=!0,Object.assign(d,S),j)}).filter(w=>w),m=o.map(w=>i+"."+w.propertyPath+" = "+c+"."+w.referencedColumn.propertyPath).join(" AND "),y=p.map(w=>"("+w+" AND "+m+")").join(" OR "),v=this.connection.createQueryBuilder(this.queryRunner);o.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),a.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),v.from(s,c).innerJoin(l,i,y).setParameters(d),n.queryBuilderFactory&&n.queryBuilderFactory(v);const b=await v.getRawMany();return b.forEach(w=>{[...a,...o].forEach(_=>{w[_.databaseName]=this.connection.driver.prepareHydratedValue(w[_.databaseName],_.referencedColumn)})}),{relationIdAttribute:n,results:b}}});return Promise.all(t)}};class sfe{constructor(t,n){this.connection=t,this.queryRunner=n}load(t,n,r){const a=Array.isArray(n)?n:[n],o=Array.isArray(r)?r:r?[r]:void 0;return t.isManyToMany?this.loadForManyToMany(t,a,o):t.isManyToOne||t.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(t,a,o):this.loadForOneToManyAndOneToOneNotOwner(t,a,o)}async loadManyToManyRelationIdsAndGroup(t,n,r,a){const o=t.isManyToMany||t.isOneToMany,i=Array.isArray(n)?n:[n];if(!r&&(r=await this.connection.relationLoader.load(t,n,this.queryRunner,a),!r.length))return i.map(d=>({entity:d,related:o?[]:void 0}));const s=await this.load(t,n,r),c=Array.isArray(r)?r:[r];let l=[],u=[];return t.isManyToManyOwner?(l=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn)):t.isManyToManyNotOwner?(l=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn)):t.isManyToOne||t.isOneToOneOwner?(l=t.joinColumns.map(d=>d.referencedColumn),u=t.entityMetadata.primaryColumns):(t.isOneToMany||t.isOneToOneNotOwner)&&(l=t.inverseRelation.entityMetadata.primaryColumns,u=t.inverseRelation.joinColumns.map(d=>d.referencedColumn)),i.map(d=>{const f={entity:d,related:o?[]:void 0},p=s.filter(m=>u.every(y=>y.compareEntityValue(d,m[y.entityMetadata.name+"_"+y.propertyAliasName])));return p.length&&c.forEach(m=>{p.forEach(y=>{l.every(v=>v.compareEntityValue(m,y[Se.buildAlias(this.connection.driver,void 0,v.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+v.propertyPath.replace(".","_"))]))&&(o?f.related.push(m):f.related=m)})}),f})}loadForManyToMany(t,n,r){const a=t.junctionEntityMetadata,o=a.name,i=t.isOwning?a.ownerColumns:a.inverseColumns,s=t.isOwning?a.inverseColumns:a.ownerColumns,c=this.connection.createQueryBuilder(this.queryRunner);i.forEach(f=>{const p=Se.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+f.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+f.propertyPath,p)}),s.forEach(f=>{const p=Se.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+f.propertyPath,p)});let l="";if(i.length===1){const f=n.map(p=>i[0].referencedColumn.getEntityValue(p));f.every(p=>typeof p=="number")?l=`${o}.${i[0].propertyPath} IN (${f.join(", ")})`:(c.setParameter("values1",f),l=o+"."+i[0].propertyPath+" IN (:...values1)")}else l="("+n.map((f,p)=>i.map(m=>{const y="entity1_"+p+"_"+m.propertyName;return c.setParameter(y,m.referencedColumn.getEntityValue(f)),o+"."+m.propertyPath+" = :"+y}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";let u="";if(r)if(s.length===1){const f=r.map(p=>s[0].referencedColumn.getEntityValue(p));f.every(p=>typeof p=="number")?u=`${o}.${s[0].propertyPath} IN (${f.join(", ")})`:(c.setParameter("values2",f),u=o+"."+s[0].propertyPath+" IN (:...values2)")}else u="("+r.map((f,p)=>s.map(m=>{const y="entity2_"+p+"_"+m.propertyName;return c.setParameter(y,m.referencedColumn.getEntityValue(f)),o+"."+m.propertyPath+" = :"+y}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";const d=[l,u].filter(f=>f.length>0).join(" AND ");return c.from(a.target,o).where(d).getRawMany()}loadForManyToOneAndOneToOneOwner(t,n,r){const a=t.entityMetadata.targetName,o=t.joinColumns.every(c=>!!t.entityMetadata.nonVirtualColumns.find(l=>l===c));if(r&&o){let c=[];if(n.forEach(l=>{let u={};t.entityMetadata.primaryColumns.forEach(d=>{const f=d.entityMetadata.name+"_"+d.propertyPath.replace(".","_");u[f]=d.getEntityValue(l)}),r.forEach(d=>{t.joinColumns.forEach(f=>{const p=f.getEntityValue(l),m=f.referencedColumn.getEntityValue(d);if(!(p===void 0||m===void 0)&&p===m){const y=f.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_");u[y]=m}})}),Object.keys(u).length===t.entityMetadata.primaryColumns.length+t.joinColumns.length&&c.push(u)}),c.length===n.length)return Promise.resolve(c)}const i=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(c=>{const l=Se.buildAlias(this.connection.driver,void 0,c.entityMetadata.name+"_"+c.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)}),t.joinColumns.forEach(c=>{const l=Se.buildAlias(this.connection.driver,void 0,c.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+c.referencedColumn.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)});let s="";if(t.entityMetadata.primaryColumns.length===1){const c=n.map(l=>t.entityMetadata.primaryColumns[0].getEntityValue(l));c.every(l=>typeof l=="number")?s=`${a}.${t.entityMetadata.primaryColumns[0].propertyPath} IN (${c.join(", ")})`:(i.setParameter("values",c),s=a+"."+t.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else s=n.map((c,l)=>t.entityMetadata.primaryColumns.map((u,d)=>{const f="entity"+l+"_"+d;return i.setParameter(f,u.getEntityValue(c)),a+"."+u.propertyPath+" = :"+f}).join(" AND ")).map(c=>"("+c+")").join(" OR ");return i.from(t.entityMetadata.target,a).where(s).getRawMany()}loadForOneToManyAndOneToOneNotOwner(t,n,r){if(t=t.inverseRelation,t.entityMetadata.primaryColumns.length===t.joinColumns.length&&t.entityMetadata.primaryColumns.every(s=>t.joinColumns.indexOf(s)!==-1))return Promise.resolve(n.map(s=>{const c={};return t.joinColumns.forEach(function(l){const u=l.referencedColumn.getEntityValue(s),d=l.referencedColumn.entityMetadata.name+"_"+l.referencedColumn.propertyPath.replace(".","_"),f=l.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+l.propertyPath.replace(".","_");c[d]=u,c[f]=u}),c}));const a=t.entityMetadata.targetName,o=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(s=>{const c=Se.buildAlias(this.connection.driver,void 0,s.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+s.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)}),t.joinColumns.forEach(s=>{const c=Se.buildAlias(this.connection.driver,void 0,s.referencedColumn.entityMetadata.name+"_"+s.referencedColumn.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)});let i="";if(t.joinColumns.length===1){const s=n.map(c=>t.joinColumns[0].referencedColumn.getEntityValue(c));s.every(c=>typeof c=="number")?i=`${a}.${t.joinColumns[0].propertyPath} IN (${s.join(", ")})`:(o.setParameter("values",s),i=a+"."+t.joinColumns[0].propertyPath+" IN (:...values)")}else i=n.map((s,c)=>t.joinColumns.map((l,u)=>{const d="entity"+c+"_"+u;return o.setParameter(d,l.referencedColumn.getEntityValue(s)),a+"."+l.propertyPath+" = :"+d}).join(" AND ")).map(s=>"("+s+")").join(" OR ");return o.from(t.entityMetadata.target,a).where(i).getRawMany()}}class cfe{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationIdAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationIds.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationIdAttributes.push(r)})})}metadataToAttribute(t,n){return new X_(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class lfe{constructor(t,n,r){this.connection=t,this.queryRunner=n,this.relationCountAttributes=r}async load(t){const n=(a,o,i)=>i.indexOf(a)===o,r=this.relationCountAttributes.map(async a=>{if(a.relation.isOneToMany){const o=a.relation,i=o.inverseRelation,s=i.joinColumns[0].referencedColumn.propertyName,c=o.inverseEntityMetadata.target,l=o.inverseEntityMetadata.tableName,u=a.alias||l,d=i.propertyName;let f=t.map(m=>m[a.parentAlias+"_"+s]).filter(m=>!!m);if(f=f.filter(n),f.length===0)return{relationCountAttribute:a,results:[]};const p=this.connection.createQueryBuilder(this.queryRunner);return p.select(u+"."+d,"parentId").addSelect("COUNT(*)","cnt").from(c,u).where(u+"."+d+" IN (:...ids)").addGroupBy(u+"."+d).setParameter("ids",f),a.queryBuilderFactory&&a.queryBuilderFactory(p),{relationCountAttribute:a,results:await p.getRawMany()}}else{let o,i,s,c;a.relation.isOwning?(o=a.relation.joinColumns[0].referencedColumn.databaseName,i=a.relation.inverseJoinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[0],c=a.relation.junctionEntityMetadata.columns[1]):(o=a.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,i=a.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[1],c=a.relation.junctionEntityMetadata.columns[0]);let l=t.map(v=>v[a.parentAlias+"_"+o]).filter(v=>!!v);if(l=l.filter(n),l.length===0)return{relationCountAttribute:a,results:[]};const u=a.junctionAlias,d=a.joinInverseSideMetadata.tableName,f=a.alias||d,p=a.relation.junctionEntityMetadata.tableName,m=u+"."+s.propertyName+" IN ("+l.map(v=>isNaN(v)?"'"+v+"'":v)+") AND "+u+"."+c.propertyName+" = "+f+"."+i,y=this.connection.createQueryBuilder(this.queryRunner);return y.select(u+"."+s.propertyName,"parentId").addSelect("COUNT("+y.escape(f)+"."+y.escape(i)+")","cnt").from(d,f).innerJoin(p,u,m).addGroupBy(u+"."+s.propertyName),a.queryBuilderFactory&&a.queryBuilderFactory(y),{relationCountAttribute:a,results:await y.getRawMany()}}});return Promise.all(r)}}class ufe{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationCountAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationCounts.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationCountAttributes.push(r)})})}metadataToAttribute(t,n){return new Y_(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class eS{static isFindOneOptions(t){const n=t;return n&&(Array.isArray(n.select)||Array.isArray(n.relations)||typeof n.select=="object"||typeof n.relations=="object"||typeof n.where=="object"||typeof n.join=="object"||typeof n.order=="object"||typeof n.cache=="object"||typeof n.cache=="boolean"||typeof n.cache=="number"||typeof n.comment=="string"||typeof n.lock=="object"||typeof n.loadRelationIds=="object"||typeof n.loadRelationIds=="boolean"||typeof n.loadEagerRelations=="boolean"||typeof n.withDeleted=="boolean"||typeof n.relationLoadStrategy=="string"||typeof n.transaction=="boolean")}static isFindManyOptions(t){const n=t;return n&&(this.isFindOneOptions(n)||typeof n.skip=="number"||typeof n.take=="number"||typeof n.skip=="string"||typeof n.take=="string")}static extractFindManyOptionsAlias(t){if(this.isFindManyOptions(t)&&t.join)return t.join.alias}static applyOptionsToTreeQueryBuilder(t,n){if(n!=null&&n.relations){const r=[...n.relations];if(eS.applyRelationsRecursively(t,r,t.expressionMap.mainAlias.name,t.expressionMap.mainAlias.metadata,""),r.length>0)throw new Rde(r)}return t}static applyRelationsRecursively(t,n,r,a,o){let i=[];if(o){const s=new RegExp("^"+o.replace(".","\\.")+"\\.");i=n.filter(c=>c.match(s)).map(c=>a.findRelationWithPropertyPath(c.replace(s,""))).filter(c=>c)}else i=n.map(s=>a.findRelationWithPropertyPath(s)).filter(s=>s);i.forEach(s=>{let c=Se.buildAlias(t.connection.driver,{joiner:"__"},r,s.propertyPath);const l=r+"."+s.propertyPath;t.expressionMap.relationLoadStrategy==="query"?t.concatRelationMetadata(s):t.leftJoinAndSelect(l,c),n.splice(n.indexOf(o?o+"."+s.propertyPath:s.propertyPath),1);let u,d;if(t.expressionMap.relationLoadStrategy==="query")u=s.inverseEntityMetadata,d=c;else{const f=t.expressionMap.joinAttributes.find(p=>p.entityOrProperty===l);u=f.metadata,d=f.alias.name}if(!d||!u)throw new Za(s.propertyPath,a);if(this.applyRelationsRecursively(t,n,d,u,o?o+"."+s.propertyPath:s.propertyPath),t.expressionMap.relationLoadStrategy==="join"){const f=a.relations.find(p=>p.propertyName===s.propertyPath);f&&this.joinEagerRelations(t,c,f.inverseEntityMetadata)}})}static joinEagerRelations(t,n,r){r.eagerRelations.forEach(a=>{let o=Se.buildAlias(t.connection.driver,{joiner:"__"},n,a.propertyName),i=!0;for(const l of t.expressionMap.joinAttributes)if(!(l.condition!==void 0||l.mapToProperty!==void 0||l.isMappingMany!==void 0||l.direction!=="LEFT"||l.entityOrProperty!==`${n}.${a.propertyPath}`)){i=!1,o=l.alias.name;break}const s=!!t.expressionMap.joinAttributes.find(l=>l.alias.name===o);i&&!s&&t.leftJoin(n+"."+a.propertyPath,o);let c=!0;for(const l of t.expressionMap.selects)if(!(l.aliasName!==void 0||l.virtual!==void 0||l.selection!==o)){c=!1;break}c&&t.addSelect(o),this.joinEagerRelations(t,o,a.inverseEntityMetadata)})}}class tS extends en{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createSelectExpression(),t+=this.createJoinExpression(),t+=this.createWhereExpression(),t+=this.createGroupByExpression(),t+=this.createHavingExpression(),t+=this.createOrderByExpression(),t+=this.createLimitOffsetExpression(),t+=this.createLockExpression(),t=t.trim(),this.expressionMap.subQuery&&(t="("+t+")"),this.replacePropertyNamesForTheWholeQuery(t)}setFindOptions(t){return this.findOptions=t,this.applyFindOptions(),this}subQuery(){const t=this.createQueryBuilder();return t.expressionMap.subQuery=!0,t.parentQueryBuilder=this,t}select(t,n){if(this.expressionMap.queryType="select",Array.isArray(t))this.expressionMap.selects=t.map(r=>({selection:r}));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]);return this}addSelect(t,n){if(!t)return this;if(Array.isArray(t))this.expressionMap.selects=this.expressionMap.selects.concat(t.map(r=>({selection:r})));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&this.expressionMap.selects.push({selection:t,aliasName:n});return this}maxExecutionTime(t){return this.expressionMap.maxExecutionTime=t,this}distinct(t=!0){return this.expressionMap.selectDistinct=t,this}distinctOn(t){return this.expressionMap.selectDistinctOn=t,this}fromDummy(){return this.from(this.connection.driver.dummyTableName??"(SELECT 1 AS dummy_column)","dummy_table")}from(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}addFrom(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this}innerJoin(t,n,r,a){return this.join("INNER",t,n,r,a),this}leftJoin(t,n,r,a){return this.join("LEFT",t,n,r,a),this}innerJoinAndSelect(t,n,r,a){return this.addSelect(n),this.innerJoin(t,n,r,a),this}leftJoinAndSelect(t,n,r,a){return this.addSelect(n),this.leftJoin(t,n,r,a),this}innerJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!0),this}innerJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!1,i),this}leftJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!0),this}leftJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!1,i),this}loadRelationIdAndMap(t,n,r,a){const o=new X_(this.expressionMap);return o.mapToProperty=t,o.relationName=n,typeof r=="string"&&(o.alias=r),typeof r=="object"&&r.disableMixedMap&&(o.disableMixedMap=!0),o.queryBuilderFactory=a,this.expressionMap.relationIdAttributes.push(o),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(t,n,r,a){const o=new Y_(this.expressionMap);return o.mapToProperty=t,o.relationName=n,o.alias=r,o.queryBuilderFactory=a,this.expressionMap.relationCountAttributes.push(o),this.expressionMap.createAlias({type:"other",name:o.junctionAlias}),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadAllRelationIds(t){return this.expressionMap.mainAlias.metadata.relations.forEach(n=>{t!==void 0&&t.relations!==void 0&&t.relations.indexOf(n.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+n.propertyPath,this.expressionMap.mainAlias.name+"."+n.propertyPath,t)}),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereExists(t){return this.where(...this.getExistsCondition(t))}andWhereExists(t){return this.andWhere(...this.getExistsCondition(t))}orWhereExists(t){return this.orWhere(...this.getExistsCondition(t))}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}having(t,n){return this.expressionMap.havings.push({type:"simple",condition:t}),n&&this.setParameters(n),this}andHaving(t,n){return this.expressionMap.havings.push({type:"and",condition:t}),n&&this.setParameters(n),this}orHaving(t,n){return this.expressionMap.havings.push({type:"or",condition:t}),n&&this.setParameters(n),this}groupBy(t){return t?this.expressionMap.groupBys=[t]:this.expressionMap.groupBys=[],this}addGroupBy(t){return this.expressionMap.groupBys.push(t),this}timeTravelQuery(t){return this.connection.driver.options.type==="cockroachdb"&&(t===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=t),this}orderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new Ee('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new Ee('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new Ee('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new Ee('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){if(this.expressionMap.limit=this.normalizeNumber(t),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new Ee('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(t){if(this.expressionMap.offset=this.normalizeNumber(t),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new Ee('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(t){if(this.expressionMap.take=this.normalizeNumber(t),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new Ee('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(t){if(this.expressionMap.skip=this.normalizeNumber(t),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new Ee('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(t){return this.expressionMap.useIndex=t,this}setLock(t,n,r){return this.expressionMap.lockMode=t,this.expressionMap.lockVersion=n,this.expressionMap.lockTables=r,this}setOnLocked(t){return this.expressionMap.onLocked=t,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if(this.expressionMap.lockMode==="optimistic")throw new Nd;this.expressionMap.queryEntity=!1;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0);const r=await this.loadRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getRawAndEntities(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getOne(){const t=(await this.getRawAndEntities()).entities[0];if(t&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const n=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const r=n.updateDateColumn.getEntityValue(t);if(r.getTime()!==this.expressionMap.lockVersion.getTime())throw new FL(n.name,this.expressionMap.lockVersion,r)}else{const r=n.versionColumn.getEntityValue(t);if(r!==this.expressionMap.lockVersion)throw new FL(n.name,this.expressionMap.lockVersion,r)}}return t===void 0?null:t}async getOneOrFail(){const t=await this.getOne();if(!t)throw new Nde(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return t}async getMany(){if(this.expressionMap.lockMode==="optimistic")throw new Nd;return(await this.getRawAndEntities()).entities}async getCount(){if(this.expressionMap.lockMode==="optimistic")throw new Nd;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeCountQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getExists(){if(this.expressionMap.lockMode==="optimistic")throw new Nd;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeExistsQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getManyAndCount(){if(this.expressionMap.lockMode==="optimistic")throw new Nd;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);this.expressionMap.queryEntity=!1;const a=this.expressionMap.cacheId;this.expressionMap.cacheId=a&&`${a}-count`;const o=await this.executeCountQuery(t),i=[r.entities,o];return n&&await t.commitTransaction(),i}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async stream(){this.expressionMap.queryEntity=!1;const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0);const o=()=>{if(r!==this.queryRunner)return r.release()},i=r.stream(t,n,o,o);return a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}}cache(t,n){return typeof t=="boolean"?this.expressionMap.cache=t:typeof t=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=t):(typeof t=="string"||typeof t=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=t),n&&(this.expressionMap.cacheDuration=n),this}setOption(t){return this.expressionMap.options.push(t),this}join(t,n,r,a,o,i,s,c){o&&this.setParameters(o);const l=new t$(this.connection,this.expressionMap);l.direction=t,l.mapAsEntity=c,l.mapToProperty=i,l.isMappingMany=s,l.entityOrProperty=n,l.condition=a,this.expressionMap.joinAttributes.push(l);const u=l.metadata;if(u){if(u.deleteDateColumn&&!this.expressionMap.withDeleted){const d=`${r}.${u.deleteDateColumn.propertyName} IS NULL`;l.condition=l.condition?` ${l.condition} AND ${d}`:`${d}`}l.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:u}),l.relation&&l.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:l.junctionAlias,metadata:l.relation.junctionEntityMetadata})}else{let d="";if(typeof n=="function"){const p=n(this.subQuery());this.setParameters(p.getParameters()),d=p.getQuery()}else d=n;const f=typeof n=="function"||n.substr(0,1)==="("&&n.substr(-1)===")";l.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:f===!1?n:void 0,subQuery:f===!0?d:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new Ee("Cannot build query because main alias is not set (call qb#from method)");const t=[],n=[];if(this.expressionMap.mainAlias.hasMetadata){const s=this.expressionMap.mainAlias.metadata;t.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,s)),n.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,s))}this.expressionMap.joinAttributes.forEach(s=>{if(s.metadata)t.push(...this.buildEscapedEntityColumnSelects(s.alias.name,s.metadata)),n.push(...this.findEntityColumnSelects(s.alias.name,s.metadata));else if(this.expressionMap.selects.some(c=>c.selection===s.alias.name)){t.push({selection:this.escape(s.alias.name)+".*"});const c=this.expressionMap.selects.find(l=>l.selection===s.alias.name);n.push(c)}}),this.expressionMap.selects.filter(s=>n.indexOf(s)===-1).forEach(s=>t.push({selection:this.replacePropertyNames(s.selection),aliasName:s.aliasName})),t.length===0&&t.push({selection:"*"});let r="";this.expressionMap.useIndex&&Se.isMySQLFamily(this.connection.driver)&&(r=` USE INDEX (${this.expressionMap.useIndex})`);const a=this.expressionMap.aliases.filter(s=>s.type==="from"&&(s.tablePath||s.subQuery)).map(s=>s.subQuery?s.subQuery+" "+this.escape(s.name):this.getTableName(s.tablePath)+" "+this.escape(s.name)),o=this.createSelectDistinctExpression(),i=t.map(s=>s.selection+(s.aliasName?" AS "+this.escape(s.aliasName):"")).join(", ");return o+i+" FROM "+a.join(", ")+this.createTableLockExpression()+r}createSelectDistinctExpression(){const{selectDistinct:t,selectDistinctOn:n,maxExecutionTime:r}=this.expressionMap,{driver:a}=this.connection;let o="SELECT ";return r>0&&Se.isMySQLFamily(a)&&(o+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),Se.isPostgresFamily(a)&&n.length>0?o=`SELECT DISTINCT ON (${n.map(i=>this.replacePropertyNames(i)).join(", ")}) `:t&&(o="SELECT DISTINCT "),o}createJoinExpression(){return this.expressionMap.joinAttributes.map(t=>{const n=t.relation,r=t.tablePath,a=t.alias.name;let o=t.condition?" AND ("+t.condition+")":"";const i=t.parentAlias;if(!i||!n){const s=t.alias.subQuery?t.alias.subQuery:this.getTableName(r);return" "+t.direction+" JOIN "+s+" "+this.escape(a)+this.createTableLockExpression()+(t.condition?" ON "+this.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){const s=n.joinColumns.map(c=>a+"."+c.referencedColumn.propertyPath+"="+i+"."+n.propertyPath+"."+c.referencedColumn.propertyPath).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else if(n.isOneToMany||n.isOneToOneNotOwner){const s=n.inverseRelation.joinColumns.map(c=>(n.inverseEntityMetadata.tableType==="entity-child"&&n.inverseEntityMetadata.discriminatorColumn&&(o+=" AND "+a+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),a+"."+n.inverseRelation.propertyPath+"."+c.referencedColumn.propertyPath+"="+i+"."+c.referencedColumn.propertyPath)).join(" AND ");if(!s)throw new Ee(`Relation ${n.entityMetadata.name}.${n.propertyName} does not have join columns.`);return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else{const s=n.junctionEntityMetadata.tablePath,c=t.junctionAlias;let l="",u="";return n.isOwning?(l=n.joinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseJoinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND ")):(l=n.inverseRelation.inverseJoinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseRelation.joinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND "))," "+t.direction+" JOIN "+this.getTableName(s)+" "+this.escape(c)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l)+" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(u+o)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const t=this.expressionMap.allOrderBys;return Object.keys(t).length===0?"":" ORDER BY "+Object.keys(t).map(n=>{const r=typeof t[n]=="string"?t[n]:t[n].order+" "+t[n].nulls,a=this.expressionMap.selects.find(o=>o.selection===n);if(a&&!a.aliasName&&n.indexOf(".")!==-1){const o=n.split("."),i=o[0],s=o.slice(1).join("."),c=this.expressionMap.aliases.find(l=>l.name===i);if(c){const l=c.metadata.findColumnWithPropertyPath(s);if(l){const u=Se.buildAlias(this.connection.driver,void 0,i,l.databaseName);return this.escape(u)+" "+r}}}return this.replacePropertyNames(n)+" "+r}).join(", ")}createLimitOffsetExpression(){let t=this.expressionMap.offset,n=this.expressionMap.limit;if(!t&&!n&&this.expressionMap.joinAttributes.length===0&&(t=this.expressionMap.skip,n=this.expressionMap.take),this.connection.driver.options.type==="mssql"){let r="";if((n||t)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(r=" ORDER BY (SELECT NULL)"),n&&t)return r+" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return r+" OFFSET 0 ROWS FETCH NEXT "+n+" ROWS ONLY";if(t)return r+" OFFSET "+t+" ROWS"}else if(Se.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)throw new Dde}else if(Se.isSQLiteFamily(this.connection.driver)){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" LIMIT -1 OFFSET "+t}else if(this.connection.driver.options.type==="oracle"){if(n&&t)return" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return" FETCH NEXT "+n+" ROWS ONLY";if(t)return" OFFSET "+t+" ROWS"}else{if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" OFFSET "+t}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const t=this.connection.driver;let n="";if(this.expressionMap.lockTables){if(!(Se.isPostgresFamily(t)||t.options.type==="cockroachdb"))throw new Ee("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new Ee("lockTables cannot be an empty array");n=" OF "+this.expressionMap.lockTables.join(", ")}let r="";switch(this.expressionMap.onLocked==="nowait"?r=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(r=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(t.options.type==="mysql"||t.options.type==="aurora-mysql")return Se.isReleaseVersionOrGreater(t,"8.0.0")?" FOR SHARE"+n+r:" LOCK IN SHARE MODE";if(t.options.type==="mariadb")return" LOCK IN SHARE MODE";if(Se.isPostgresFamily(t))return" FOR SHARE"+n+r;if(t.options.type==="oracle")return" FOR UPDATE";if(t.options.type==="mssql")return"";throw new Rc;case"pessimistic_write":if(Se.isMySQLFamily(t)||t.options.type==="aurora-mysql"||t.options.type==="oracle")return" FOR UPDATE"+r;if(Se.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+r;if(t.options.type==="mssql")return"";throw new Rc;case"pessimistic_partial_write":if(Se.isPostgresFamily(t))return" FOR UPDATE"+n+" SKIP LOCKED";if(Se.isMySQLFamily(t))return" FOR UPDATE SKIP LOCKED";throw new Rc;case"pessimistic_write_or_fail":if(Se.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+" NOWAIT";if(Se.isMySQLFamily(t))return" FOR UPDATE NOWAIT";throw new Rc;case"for_no_key_update":if(Se.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+n+r;throw new Rc;case"for_key_share":if(Se.isPostgresFamily(t))return" FOR KEY SHARE"+n+r;throw new Rc;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const t=this.expressionMap.havings.map((n,r)=>{switch(n.type){case"and":return(r>0?"AND ":"")+this.replacePropertyNames(n.condition);case"or":return(r>0?"OR ":"")+this.replacePropertyNames(n.condition);default:return this.replacePropertyNames(n.condition)}}).join(" ");return t.length?" HAVING "+t:""}buildEscapedEntityColumnSelects(t,n){const r=this.expressionMap.selects.some(l=>l.selection===t),a=[];if(r&&a.push(...n.columns.filter(l=>l.isSelect===!0)),a.push(...n.columns.filter(l=>this.expressionMap.selects.some(u=>u.selection===t+"."+l.propertyPath))),a.length===0)return[];const o=this.expressionMap.queryEntity?n.primaryColumns.filter(l=>a.indexOf(l)===-1):[],i=[...a,...o],s=[],c=this.escape(t);return i.forEach(l=>{let u=c+"."+this.escape(l.databaseName);l.isVirtualProperty&&l.query&&(u=`(${l.query(c)})`),this.connection.driver.spatialTypes.indexOf(l.type)!==-1&&((Se.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(u=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${u})`),Se.isPostgresFamily(this.connection.driver)&&(l.precision?u=`ST_AsGeoJSON(${u}, ${l.precision})::json`:u=`ST_AsGeoJSON(${u})::json`),this.connection.driver.options.type==="mssql"&&(u=`${u}.ToString()`));const d=this.expressionMap.selects.filter(f=>f.selection===t+"."+l.propertyPath);if(d.length)d.forEach(f=>{s.push({selection:u,aliasName:f.aliasName?f.aliasName:Se.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:f.virtual})});else{if(l.isVirtualProperty)return;s.push({selection:u,aliasName:Se.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:r})}}),s}findEntityColumnSelects(t,n){const r=this.expressionMap.selects.find(a=>a.selection===t);return r?[r]:this.expressionMap.selects.filter(a=>n.columns.some(o=>a.selection===t+"."+o.propertyPath))}computeCountExpression(){const t=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(t);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||Se.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+"))";if(Se.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const a=n.map(o=>`${r}.${this.escape(o.databaseName)}`).join(", '|;|', ");return n.length===1?`COUNT(DISTINCT(${a}))`:`COUNT(DISTINCT(CONCAT(${a})))`}return this.connection.driver.options.type==="spanner"?n.length===1?`COUNT(DISTINCT(${r}.${this.escape(n[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${n.map(a=>`CAST(${r}.${this.escape(a.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(" || '|;|' || ")+"))"}async executeCountQuery(t){const n=this.computeCountExpression(),r=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(n,"cnt").setOption("disable-global-order").loadRawResults(t);return!r||!r[0]||!r[0].cnt?0:parseInt(r[0].cnt)}async executeExistsQuery(t){return(await this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(t)).length>0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const t=Array.isArray(this.findOptions.select)?Pn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(t,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const t=Array.isArray(this.findOptions.relations)?Pn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(t=>{t.select&&!t.selection?t.type==="inner"?this.innerJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):t.type==="inner"?this.innerJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(t=>{this.leftJoin(this.findOptions.join.leftJoin[t],t)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(t=>{this.innerJoin(this.findOptions.join.innerJoin[t],t)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(t=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[t],t)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(t=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[t],t)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const t=this.findOptions.lock.tables?this.findOptions.lock.tables.map(n=>{const r=this.expressionMap.aliases.find(a=>a.metadata.tableNameWithoutPrefix===n);if(!r)throw new Ee(`"${n}" is not part of this query`);return this.escape(r.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,t),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&eS.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(t){this.relationMetadatas.push(t)}async executeEntitiesAndRawResults(t){if(!this.expressionMap.mainAlias)throw new Ee('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!t.isTransactionActive)throw new Ide;if(this.expressionMap.lockMode==="optimistic"){const i=this.expressionMap.mainAlias.metadata;if(!i.versionColumn&&!i.updateDateColumn)throw new Ade(i.name)}const n=new ife(this.connection,t,this.expressionMap.relationIdAttributes),r=new lfe(this.connection,t,this.expressionMap.relationCountAttributes);new cfe(this.expressionMap).transform(),new ufe(this.expressionMap).transform();let a=[],o=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[i,s]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),c=this.expressionMap.mainAlias.metadata,l=this.expressionMap.mainAlias.name,u=c.primaryColumns.map(p=>{const m=this.escape("distinctAlias"),y=this.escape(Se.buildAlias(this.connection.driver,void 0,l,p.databaseName));s[y]||(s[y]="ASC");const v=Se.buildAlias(this.connection.driver,void 0,"ids_"+l,p.databaseName);return`${m}.${y} AS ${this.escape(v)}`}),d=this.clone(),f=d.expressionMap.timeTravel;if(a=await new tS(this.connection,t).select(`DISTINCT ${u.join(", ")}`).addSelect(i).from(`(${d.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(f).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(s).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),a.length>0){let p="";const m={};if(c.hasMultiplePrimaryKeys)p=a.map((y,v)=>c.primaryColumns.map(b=>{const w=`orm_distinct_ids_${v}_${b.databaseName}`,_=Se.buildAlias(this.connection.driver,void 0,"ids_"+l,b.databaseName);return m[w]=y[_],`${l}.${b.propertyPath}=:${w}`}).join(" AND ")).join(" OR ");else{const y=Se.buildAlias(this.connection.driver,void 0,"ids_"+l,c.primaryColumns[0].databaseName),v=a.map(b=>b[y]);v.every(b=>typeof b=="number")?p=`${l}.${c.primaryColumns[0].propertyPath} IN (${v.join(", ")})`:(m.orm_distinct_ids=v,p=l+"."+c.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}a=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:p}).setParameters(m).loadRawResults(t)}}else a=await this.loadRawResults(t);if(a.length>0){const i=await n.load(a),s=await r.load(a);o=new ofe(this.expressionMap,this.connection.driver,i,s,this.queryRunner).transform(a,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,o)}if(this.expressionMap.relationLoadStrategy==="query"){const i=new sfe(this.connection,t);await Promise.all(this.relationMetadatas.map(async s=>{const c=s.inverseEntityMetadata.target,l=s.inverseEntityMetadata.targetName,u=Array.isArray(this.findOptions.select)?Pn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,d=Array.isArray(this.findOptions.relations)?Pn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,f=this.createQueryBuilder(t).select(l).from(c,l).setFindOptions({select:u?Pn.deepValue(u,s.propertyPath):void 0,order:this.findOptions.order?Pn.deepValue(this.findOptions.order,s.propertyPath):void 0,relations:d?Pn.deepValue(d,s.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(o.length>0){const p=await i.loadManyToManyRelationIdsAndGroup(s,o,void 0,f);o.forEach(m=>{const y=p.find(v=>v.entity===m);if(y){const v=y.related===void 0?null:y.related;s.setEntityValue(m,v)}})}}))}return{raw:a,entities:o}}createOrderByCombinedWithSelectExpression(t){const n=this.expressionMap.allOrderBys,r=Object.keys(n).map(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);return this.escape(t)+"."+this.escape(Se.buildAlias(this.connection.driver,void 0,s,l.databaseName))}else return this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?this.escape(t)+"."+this.escape(o):""}).join(", "),a={};return Object.keys(n).forEach(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);a[this.escape(t)+"."+this.escape(Se.buildAlias(this.connection.driver,void 0,s,l.databaseName))]=n[o]}else this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?a[this.escape(t)+"."+this.escape(o)]=n[o]:a[o]=n[o]}),[r,a]}async loadRawResults(t){const[n,r]=this.getQueryAndParameters(),a=n+" -- PARAMETERS: "+JSON.stringify(r,(u,d)=>typeof d=="bigint"?d.toString():d),o=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let i;const s=o.alwaysEnabled&&this.expressionMap.cache!==!1||this.expressionMap.cache===!0;let c=!1;if(this.connection.queryResultCache&&s)try{if(i=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:a,duration:this.expressionMap.cacheDuration||o.duration||1e3},t),i&&!this.connection.queryResultCache.isExpired(i))return JSON.parse(i.result)}catch(u){if(!o.ignoreErrors)throw u;c=!0}const l=await t.query(n,r,!0);if(!c&&this.connection.queryResultCache&&s)try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:a,time:new Date().getTime(),duration:this.expressionMap.cacheDuration||o.duration||1e3,result:JSON.stringify(l.records)},i,t)}catch(u){if(!o.ignoreErrors)throw u}return l.records}mergeExpressionMap(t){return cn.assign(this.expressionMap,t),this}normalizeNumber(t){return typeof t=="number"||t===void 0||t===null?t:Number(t)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner(this.connection.defaultReplicationModeForReads())}buildSelect(t,n,r,a){for(let o in t){if(t[o]===void 0||t[o]===!1)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Za(i,n);s?this.selects.push(r+"."+i):c&&this.buildSelect(t[o],n,r,i)}}buildRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Za(c,r);if(l)this.buildRelations(s,typeof n=="object"?Pn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=Se.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(u):(this.joins.push({type:"left",select:!0,selection:n&&typeof n[i]=="object"?n[i]:void 0,alias:d,parentAlias:a,relationMetadata:u}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d))),typeof s=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(s,typeof n=="object"?Pn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildEagerRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Za(c,r);if(l)this.buildEagerRelations(s,typeof n=="object"?Pn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=Se.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&u.inverseEntityMetadata.eagerRelations.forEach(f=>{let p=d+"_"+f.propertyPath.replace(".","_");p=Se.buildAlias(this.connection.driver,{joiner:"__"},d,p),this.joins.find(m=>m.alias===p)||this.joins.push({type:"left",select:!0,alias:p,parentAlias:d,selection:void 0,relationMetadata:f}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d)}),typeof s=="object"&&this.buildEagerRelations(s,typeof n=="object"?Pn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildOrder(t,n,r,a){for(let o in t){if(t[o]===void 0)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Za(i,n);if(s){let u=typeof t[o]=="object"?t[o].direction:t[o];u=u==="DESC"||u==="desc"||u===-1?"DESC":"ASC";let d=typeof t[o]=="object"?t[o].nulls:void 0;d=(d==null?void 0:d.toLowerCase())==="first"?"NULLS FIRST":(d==null?void 0:d.toLowerCase())==="last"?"NULLS LAST":void 0;let f=`${r}.${i}`;this.addOrderBy(f,u,d)}else if(c)this.buildOrder(t[o],n,r,i);else if(l){let u=r+"_"+i.replace(".","_");u=Se.buildAlias(this.connection.driver,{joiner:"__"},r,u),this.joins.find(d=>d.alias===u)||this.joins.push({type:"left",select:!1,alias:u,parentAlias:r,selection:void 0,relationMetadata:l}),this.buildOrder(t[o],l.inverseEntityMetadata,u)}}}buildWhere(t,n,r,a){let o="";if(Array.isArray(t))t.length&&(o=t.map(i=>this.buildWhere(i,n,r,a)).filter(i=>!!i).map(i=>"("+i+")").join(" OR "));else{let i=[];for(let s in t){if(t[s]===void 0||t[s]===null)continue;const c=a?a+"."+s:s,l=n.findColumnWithPropertyPathStrict(c),u=n.findEmbeddedWithPropertyPath(c),d=n.findRelationWithPropertyPath(c);if(!u&&!l&&!d)throw new Za(c,n);if(l){let f=`${r}.${c}`;l.isVirtualProperty&&l.query&&(f=`(${l.query(r)})`);let p=t[s];Ft.isEqualOperator(t[s])&&(p=t[s].value),l.transformer&&(p instanceof Md?p.transformValue(l.transformer):p=Q_.transformTo(l.transformer,p)),i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(f,p)))}else if(u){const f=this.buildWhere(t[s],n,r,c);f&&i.push(f)}else if(d){if(typeof t[s]=="object"&&Object.keys(t[s]).every(f=>t[s][f]===void 0))continue;if(Ft.isFindOperator(t[s]))if(t[s].type==="moreThan"||t[s].type==="lessThan"||t[s].type==="moreThanOrEqual"||t[s].type==="lessThanOrEqual"){let f="";t[s].type==="moreThan"?f=">":t[s].type==="lessThan"?f="<":t[s].type==="moreThanOrEqual"?f=">=":t[s].type==="lessThanOrEqual"&&(f="<=");const p=this.subQuery();if(d.isManyToManyOwner)p.select("COUNT(*)").from(d.joinTableName,d.joinTableName).where(d.joinColumns.map(m=>`${d.joinTableName}.${m.propertyName} = ${r}.${m.referencedColumn.propertyName}`).join(" AND "));else if(d.isManyToManyNotOwner)p.select("COUNT(*)").from(d.inverseRelation.joinTableName,d.inverseRelation.joinTableName).where(d.inverseRelation.inverseJoinColumns.map(m=>`${d.inverseRelation.joinTableName}.${m.propertyName} = ${r}.${m.referencedColumn.propertyName}`).join(" AND "));else if(d.isOneToMany)p.select("COUNT(*)").from(d.inverseEntityMetadata.target,d.inverseEntityMetadata.tableName).where(d.inverseRelation.joinColumns.map(m=>`${d.inverseEntityMetadata.tableName}.${m.propertyName} = ${r}.${m.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(p.getSql()+" "+f+" "+parseInt(t[s].value))}else if(d.isManyToOne||d.isOneToOne&&d.isOneToOneOwner){const f=`${r}.${c}`;i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(f,t[s])))}else throw new Error("This relation isn't supported by given find operator");else{let f=r+"_"+d.propertyPath.replace(".","_");f=Se.buildAlias(this.connection.driver,{joiner:"__"},r,f),this.joins.find(m=>m.alias===f)||this.joins.push({type:"left",select:!1,selection:void 0,alias:f,parentAlias:r,relationMetadata:d});const p=this.buildWhere(t[s],d.inverseEntityMetadata,f);p&&i.push(p)}}}o=i.length?"("+i.join(") AND (")+")":i.join(" AND ")}return o.length?"("+o+")":o}}class s${constructor(){this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class dfe extends en{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("SoftDeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createUpdateExpression();return t+=this.createCteExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("BeforeSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("BeforeRecover",this.expressionMap.mainAlias.metadata));const r=new G_(t,this.expressionMap);this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=r.getSoftDeletionReturningColumns());const[a,o]=this.getQueryAndParameters(),i=await t.query(a,o,!0),s=s$.from(i);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await r.update(s,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("AfterSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("AfterRecover",this.expressionMap.mainAlias.metadata)),n&&await t.commitTransaction(),s}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}from(t,n){t=Ft.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new _m;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new Ee(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new Ee("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!t)throw new Ee(`Cannot get entity metadata for the given alias "${this.expressionMap.mainAlias}"`);if(!t.deleteDateColumn)throw new Mde(t);const n=[];switch(this.expressionMap.queryType){case"soft-delete":n.push(this.escape(t.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":n.push(this.escape(t.deleteDateColumn.databaseName)+" = NULL");break;default:throw new Ee('The queryType must be "soft-delete" or "restore"')}if(t.versionColumn&&n.push(this.escape(t.versionColumn.databaseName)+" = "+this.escape(t.versionColumn.databaseName)+" + 1"),t.updateDateColumn&&n.push(this.escape(t.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),n.length<=0)throw new $_;const r=this.createWhereExpression(),a=this.createReturningExpression("update");return a===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")} OUTPUT ${a}${r}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r} RETURNING ${a}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(Se.isMySQLFamily(this.connection.driver))return" LIMIT "+t;throw new BL}return""}}class ffe extends en{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("UpdateQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createUpdateExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("BeforeUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet);let r=null,a=null;const o=new G_(t,this.expressionMap),i=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const f of this.expressionMap.returning)i.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(f));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=o.getUpdationReturningColumns(),i.push(...this.expressionMap.extraReturningColumns.filter(f=>!i.includes(f)))),i.length>0&&this.connection.driver.options.type==="mssql"&&(r=this.connection.driver.buildTableVariableDeclaration("@OutputTable",i),a="SELECT * FROM @OutputTable");const[s,c]=this.getQueryAndParameters(),l=[r,s,a],u=await t.query(l.filter(f=>f!=null).join(`;

`),c,!0),d=s$.from(u);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await o.update(d,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("AfterUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),n&&await t.commitTransaction(),d}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}set(t){return this.expressionMap.valuesSet=t,this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new _m;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new Ee(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new Ee("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.getValueSet(),n=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,r={};for(let c in t)t[c]!==void 0&&(r[c]=t[c]);const a=[],o=[];if(n?(this.createPropertyPath(n,r).forEach(c=>{const l=n.findColumnsWithPropertyPath(c);if(l.length<=0)throw new Za(c,n);l.forEach(u=>{if(!u.isUpdate||o.includes(u))return;o.push(u);let d=u.getEntityValue(r);if(u.referencedColumn&&typeof d=="object"&&!(d instanceof Date)&&d!==null&&!En.isBuffer(d)?d=u.referencedColumn.getEntityValue(d):typeof d!="function"&&(d=this.connection.driver.preparePersistentValue(d,u)),typeof d=="function")a.push(this.escape(u.databaseName)+" = "+d());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&d===null)a.push(this.escape(u.databaseName)+" = NULL");else{this.connection.driver.options.type==="mssql"&&(d=this.connection.driver.parametrizeValue(u,d));const f=this.createParameter(d);let p=null;if((Se.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1){const m=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";u.srid!=null?p=`${m}(${f}, ${u.srid})`:p=`${m}(${f})`}else Se.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?u.srid!=null?p=`ST_SetSRID(ST_GeomFromGeoJSON(${f}), ${u.srid})::${u.type}`:p=`ST_GeomFromGeoJSON(${f})::${u.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?p=u.type+"::STGeomFromText("+f+", "+(u.srid||"0")+")":p=f;a.push(this.escape(u.databaseName)+" = "+p)}})}),(a.length>0||Object.keys(r).length===0)&&(n.versionColumn&&o.indexOf(n.versionColumn)===-1&&a.push(this.escape(n.versionColumn.databaseName)+" = "+this.escape(n.versionColumn.databaseName)+" + 1"),n.updateDateColumn&&o.indexOf(n.updateDateColumn)===-1&&a.push(this.escape(n.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"))):Object.keys(r).map(c=>{let l=r[c];if(typeof l=="function")a.push(this.escape(c)+" = "+l());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&l===null)a.push(this.escape(c)+" = NULL");else{const u=this.createParameter(l);a.push(this.escape(c)+" = "+u)}}),a.length<=0)throw new $_;const i=this.createWhereExpression(),s=this.createReturningExpression("update");return s===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")} OUTPUT ${s}${i}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i} RETURNING ${s}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(Se.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")return" LIMIT "+t;throw new BL}return""}getValueSet(){if(typeof this.expressionMap.valuesSet=="object")return this.expressionMap.valuesSet;throw new $_}}function pfe(){en.registerQueryBuilderClass("DeleteQueryBuilder",e=>new Yde(e)),en.registerQueryBuilderClass("InsertQueryBuilder",e=>new nfe(e)),en.registerQueryBuilderClass("RelationQueryBuilder",e=>new afe(e)),en.registerQueryBuilderClass("SelectQueryBuilder",e=>new tS(e)),en.registerQueryBuilderClass("SoftDeleteQueryBuilder",e=>new dfe(e)),en.registerQueryBuilderClass("UpdateQueryBuilder",e=>new ffe(e))}var c$;(function(e){e.VIEW="VIEW",e.MATERIALIZED_VIEW="MATERIALIZED_VIEW",e.GENERATED_COLUMN="GENERATED_COLUMN"})(c$||(c$={}));var nS={exports:{}},rS,l$;function hfe(){if(l$)return rS;l$=1;var e=1e3,t=e*60,n=t*60,r=n*24,a=r*7,o=r*365.25;rS=function(u,d){d=d||{};var f=typeof u;if(f==="string"&&u.length>0)return i(u);if(f==="number"&&isFinite(u))return d.long?c(u):s(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function i(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var f=parseFloat(d[1]),p=(d[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return f*o;case"weeks":case"week":case"w":return f*a;case"days":case"day":case"d":return f*r;case"hours":case"hour":case"hrs":case"hr":case"h":return f*n;case"minutes":case"minute":case"mins":case"min":case"m":return f*t;case"seconds":case"second":case"secs":case"sec":case"s":return f*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function s(u){var d=Math.abs(u);return d>=r?Math.round(u/r)+"d":d>=n?Math.round(u/n)+"h":d>=t?Math.round(u/t)+"m":d>=e?Math.round(u/e)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=r?l(u,d,r,"day"):d>=n?l(u,d,n,"hour"):d>=t?l(u,d,t,"minute"):d>=e?l(u,d,e,"second"):u+" ms"}function l(u,d,f,p){var m=d>=f*1.5;return Math.round(u/f)+" "+p+(m?"s":"")}return rS}var aS,u$;function mfe(){if(u$)return aS;u$=1;function e(t){r.debug=r,r.default=r,r.coerce=l,r.disable=i,r.enable=o,r.enabled=s,r.humanize=hfe(),r.destroy=u,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function n(d){let f=0;for(let p=0;p<d.length;p++)f=(f<<5)-f+d.charCodeAt(p),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=n;function r(d){let f,p=null,m,y;function v(...b){if(!v.enabled)return;const w=v,_=Number(new Date),x=_-(f||_);w.diff=x,w.prev=f,w.curr=_,f=_,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let S=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(j,E)=>{if(j==="%%")return"%";S++;const O=r.formatters[E];if(typeof O=="function"){const P=b[S];j=O.call(w,P),b.splice(S,1),S--}return j}),r.formatArgs.call(w,b),(w.log||r.log).apply(w,b)}return v.namespace=d,v.useColors=r.useColors(),v.color=r.selectColor(d),v.extend=a,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(m!==r.namespaces&&(m=r.namespaces,y=r.enabled(d)),y),set:b=>{p=b}}),typeof r.init=="function"&&r.init(v),v}function a(d,f){const p=r(this.namespace+(typeof f>"u"?":":f)+d);return p.log=this.log,p}function o(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let f;const p=(typeof d=="string"?d:"").split(/[\s,]+/),m=p.length;for(f=0;f<m;f++)p[f]&&(d=p[f].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...r.names.map(c),...r.skips.map(c).map(f=>"-"+f)].join(",");return r.enable(""),d}function s(d){if(d[d.length-1]==="*")return!0;let f,p;for(f=0,p=r.skips.length;f<p;f++)if(r.skips[f].test(d))return!1;for(f=0,p=r.names.length;f<p;f++)if(r.names[f].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return aS=e,aS}var d$;function yfe(){return d$||(d$=1,function(e,t){var n={};t.formatArgs=a,t.save=o,t.load=i,t.useColors=r,t.storage=s(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,f=0;l[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(f=d))}),l.splice(f,0,u)}t.log=console.debug||console.log||(()=>{});function o(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function i(){let l;try{l=t.storage.getItem("debug")}catch{}return!l&&typeof On<"u"&&"env"in On&&(l=n.DEBUG),l}function s(){try{return localStorage}catch{}}e.exports=mfe()(t);const{formatters:c}=e.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(nS,nS.exports)),nS.exports}yfe(),pfe();const f$=(e,t)=>({id:e.id,type:e.node_type,position:{x:e.x||0,y:e.y||0},width:e.width||void 0,height:e.height||void 0,data:{loading:!1,flowNode:e,...t}}),gfe=e=>({id:e.id,target:e.target,source:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),p$=e=>({id:e.id,source:e.source,target:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),vfe=e=>e.filter(t=>"edgeId"in t?`${t.edgeId}`.startsWith("xy-edge__"):!1),oS=(e,t,n)=>{const r=[];return{changes:e.map(a=>{var c;const o=t.find(l=>a.id===l.id);o||r.push(a.id);const i=(c=n==null?void 0:n[a.source_type])==null?void 0:c.find(l=>(l==null?void 0:l.id)===a.source_id),s=f$(a,{...o==null?void 0:o.data,entity:i});return{type:o?"replace":"add",id:a.id,item:o?xm({...o||{},data:void 0},sd(s,cd)):s}}),newIds:[]}},iS=(e,t)=>{const n=[],r=[],a=e.map(o=>{const i=t.find(s=>o.source===s.source&&o.target===s.target);return!i||i.id!==o.id?(i&&r.push(i.id),{type:"add",item:p$(o)}):(n.push(o.id),{type:"replace",item:p$(o)})});return t.forEach(o=>{n.includes(o.id)||r.push(o.id)}),{changes:a,updatedIds:n,deletedIds:r}},sS={width:440,height:360},jm={width:380,height:650},Ad={[ue.Toolbox]:"toolbox",[ue.SessionInfo]:"session-info",[ue.DefaultEmbeddingModel]:"default-embedding-model",[ue.ApplicationBar]:"application-bar"},bfe={id:Ad[ue.Toolbox],type:ue.Toolbox,position:{x:10+jm.width+20,y:10},measured:sS,data:{}},wfe={id:Ad[ue.SessionInfo],type:ue.SessionInfo,position:{x:10,y:10},measured:jm,data:{}},xfe={id:Ad[ue.DefaultEmbeddingModel],type:ue.DefaultEmbeddingModel,position:{x:10+jm.width+sS.width+40,y:10},data:{model:e4e}},_fe={id:Ad[ue.ApplicationBar],type:ue.ApplicationBar,position:{x:10+jm.width+sS.width+40,y:80},data:{}},Sfe=[bfe,wfe,xfe,_fe],jfe=[ue.Toolbox,ue.SessionInfo,ue.ApplicationBar,ue.EditorApp,ue.CodeContainerApp],h$={flowNodes:[],flowEdges:[],ready:!0,flowEdgeLoading:!1,flowNodeLoading:!1,syncedNodes:[],syncedEdges:[],syncNodeQueue:[],syncEdgeQueue:[],edges:[],nodes:Sfe},Em=async e=>{const t=await he("FlowNode").find(e),n=t.reduce((a,o)=>{var i;return a[o.source_type]||(a[o.source_type]=[]),(i=a[o.source_type])==null||i.push(o),a},{}),r={};return await Promise.all(Object.entries(n).map(async([a,o])=>{const i=a;r[i]=await he(i).find({where:{id:Xa(o.map(s=>s.source_id))}})})),{flowNodes:t,entityGroups:n,flowNodeDatas:r}},Efe=(e,t)=>({reset:()=>{e(h$)},setNodes:n=>{if(typeof n=="function"){e({nodes:n(t().nodes)});return}e({nodes:n})},setEdges:n=>{if(typeof n=="function"){e({edges:n(t().edges)});return}e({edges:n})},updateNodes:n=>{const r=t().nodes;e({nodes:fs(n,r)})},updateEdges:n=>{const r=t().edges;e({edges:kd(n,r)})},addConnectionToEdges:n=>{const r=t().edges;e({edges:s5(n,r)})},flowNodesToNodes:(n,r={})=>{const a=t().nodes,{changes:o}=oS(n,a,r);e({nodes:fs(o,a)})},flowEdgesToEdges:n=>{const r=t().edges,{changes:a,updatedIds:o,deletedIds:i}=iS(n,r);r.forEach(s=>{o.includes(s.id)||i.push(s.id)}),i.forEach(s=>{a.push({type:"remove",id:s})}),e({edges:kd(a,r)})},getNodes:n=>t().nodes.filter(r=>n.includes(r.id)),removeSyncNodeQueue:n=>{const{syncNodeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncNodeQueue:r})},removeSyncEdgeQueue:n=>{const{syncEdgeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncEdgeQueue:r})},pushSyncNodeQueue:(n,r)=>{const{syncNodeQueue:a}=t();e({syncNodeQueue:[...a,{query:r,timestamp:Date.now(),syncType:n}]})},pushSyncEdgeQueue:()=>{const{syncEdgeQueue:n}=t();e({syncEdgeQueue:[...n,{timestamp:Date.now()}]})},findFlowNodesWithSource:async(n,r)=>{try{e({flowNodeLoading:!0});const{flowNodes:a,flowNodeDatas:o}=await Em(n);if(r!=null&&r.clean)e({flowNodes:a,nodes:a.map(i=>{var c;const s=(c=o==null?void 0:o[i.source_type])==null?void 0:c.find(l=>l.id===i.source_id);return f$(i,{data:s})})});else{const i=t().flowNodes,s=a.map(u=>u.id),c=t().nodes,{changes:l}=oS(a,c,o);e({flowNodes:[...i.filter(u=>!s.includes(u.id)),...a],nodes:fs(l,c)})}return a}finally{e({flowNodeLoading:!1})}},findFlowEdges:async(n,r)=>{try{e({flowEdgeLoading:!0});const a=await he("FlowEdge").find(n),o=t().flowEdges,i=a.map(s=>s.id);if(r!=null&&r.clean)e({flowEdges:a,edges:a.map(s=>gfe(s))});else{const s=t().edges,{changes:c}=iS(a,s);e({flowEdges:[...o.filter(l=>!i.includes(l.id)),...a],edges:kd(c,s)})}return a}finally{e({flowEdgeLoading:!1})}},deleteFlowNode:async n=>{try{if(!n.id&&!n.source_type&&!n.source_id)throw new Error("Missing flow node indentify");const r=await he("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}});if(r){await he("FlowNode").delete(r.id);const a=t().flowNodes;r.source_type&&r.source_id&&await he(r.source_type).delete(r.source_id).catch(i=>{oi("Failed to delete source entity",r.source_type,r.source_id,i)});const o=t().nodes;e({flowNodes:a.filter(i=>i.id!==r.id),nodes:fs([{type:"remove",id:r.id}],o)})}}catch(r){oi("Failed to delete flow node",r)}},deleteFlowEdge:async n=>{try{if(!n.id&&!n.source&&!n.target)throw new Error("Missing flow edge indentify");const r=await he("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}});if(r){await he("FlowEdge").delete(r.id);const a=t().flowEdges;e({flowEdges:a.filter(o=>o.id!==r.id)})}}catch(r){oi("Failed to delete flow edge",r)}},updateFlowNode:async(n,r)=>{var a;try{if(!((a=st.getState().currentSession)!=null&&a.id))throw new Error("Session not found");if(!n.id)throw new Error("Missing flow node indentify");await he("FlowNode").update(n.id,n);const o=t().flowNodes.map(i=>i.id===n.id?{...i,...n}:i);e({flowNodes:r!=null&&r.silent?o:[...o]})}catch(o){oi("Failed to create or update flow node",o,n)}},createOrUpdateFlowNode:async(n,r)=>{var a;try{const o=st.getState().currentSession;if(!(o!=null&&o.id))throw new Error("Session not found");if(!n.id&&(!n.source_type||!n.source_id))throw new Error("Missing flow node indentify");let i,s=n!=null&&n.id?t().flowNodes.find(p=>p.id===n.id):void 0;if(!s&&(n.id||n.source_type&&n.source_id)&&(s=await he("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}})),s)i=xm(s,sd(n,cd)),r!=null&&r.lazy?he("FlowNode").update(s.id,i):await he("FlowNode").update(s.id,i);else if(n.source_id&&n.source_type)i={...n,source_id:`${n.source_id}`,source_type:`${n.source_type}`,node_type:n.node_type||"NEW_MESSAGE",session_id:n.session_id||(o==null?void 0:o.id)},r!=null&&r.lazy?(i.id=qi(),he("FlowNode").save(i)):i=await he("FlowNode").save(i);else throw new Error("Missing source id and type");let c;const l=t().nodes.find(p=>p.id===i.id);i.source_type&&!l?c=await he(i.source_type).findOne({where:{id:n.source_id}}):i.source_type&&l&&(c=(a=l==null?void 0:l.data)==null?void 0:a.entity);const u=t().flowNodes,d=t().nodes,{changes:f}=oS([i],d,{[i.source_type]:[c]});return e({flowNodes:[...u.filter(p=>p.id!==i.id),i],nodes:fs(f,d)}),i}catch(o){oi("Failed to create or update flow node",o,n)}},createOrUpdateFlowEdge:async(n,r)=>{try{const a=st.getState().currentSession;if(!(a!=null&&a.id))throw new Error("Session not found");if(!n.id&&(!n.source||!n.target))throw new Error("Missing flow node indentify");let o,i=n!=null&&n.id?t().flowEdges.find(l=>l.id===n.id):void 0;if(i&&(n.id||n.source&&n.target)&&(i=await he("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}})),i)o=xm(i,sd(n,cd)),r!=null&&r.lazy?he("FlowEdge").update(i.id,o):await he("FlowEdge").update(i.id,o);else if(n.source&&n.target)o={...n,source:`${n.source}`,target:`${n.target}`,session_id:n.session_id||(a==null?void 0:a.id)},r!=null&&r.lazy?(o.id=qi(),he("FlowEdge").save(o)):o=await he("FlowEdge").save(o);else throw new Error("Missing source and target");const s=t().flowEdges,c=t().edges;return e({flowEdges:[...s.filter(l=>l.id!==o.id),o],edges:kd(iS([o],c).changes,c)}),o}catch(a){oi("Failed to create or update flow node",a)}}}),Om=()=>{const e=co(t=>t.loadModel);return{loadModel:g.useCallback(async(t,...n)=>{switch(t){case gt.WebLLM:return e(...n);default:return}},[e])}};var Ofe=Object.defineProperty,Cfe=Object.defineProperties,kfe=Object.getOwnPropertyDescriptors,Cm=Object.getOwnPropertySymbols,m$=Object.prototype.hasOwnProperty,y$=Object.prototype.propertyIsEnumerable,g$=(e,t,n)=>t in e?Ofe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pfe=(e,t)=>{for(var n in t||(t={}))m$.call(t,n)&&g$(e,n,t[n]);if(Cm)for(var n of Cm(t))y$.call(t,n)&&g$(e,n,t[n]);return e},Nfe=(e,t)=>Cfe(e,kfe(t)),Mfe=(e,t)=>{var n={};for(var r in e)m$.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Cm)for(var r of Cm(e))t.indexOf(r)<0&&y$.call(e,r)&&(n[r]=e[r]);return n};function Afe(e){let t=setTimeout(e,0),n=setTimeout(e,10),r=setTimeout(e,50);return[t,n,r]}function Tfe(e){let t=g.useRef();return g.useEffect(()=>{t.current=e}),t.current}var Rfe=18,v$=40,Ife=`${v$}px`,Dfe=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function Lfe({containerRef:e,inputRef:t,pushPasswordManagerStrategy:n,isFocused:r}){let[a,o]=g.useState(!1),[i,s]=g.useState(!1),[c,l]=g.useState(!1),u=g.useMemo(()=>n==="none"?!1:(n==="increase-width"||n==="experimental-no-flickering")&&a&&i,[a,i,n]),d=g.useCallback(()=>{let f=e.current,p=t.current;if(!f||!p||c||n==="none")return;let m=f,y=m.getBoundingClientRect().left+m.offsetWidth,v=m.getBoundingClientRect().top+m.offsetHeight/2,b=y-Rfe,w=v;document.querySelectorAll(Dfe).length===0&&document.elementFromPoint(b,w)===f||(o(!0),l(!0))},[e,t,c,n]);return g.useEffect(()=>{let f=e.current;if(!f||n==="none")return;function p(){let y=window.innerWidth-f.getBoundingClientRect().right;s(y>=v$)}p();let m=setInterval(p,1e3);return()=>{clearInterval(m)}},[e,n]),g.useEffect(()=>{let f=r||document.activeElement===t.current;if(n==="none"||!f)return;let p=setTimeout(d,0),m=setTimeout(d,2e3),y=setTimeout(d,5e3),v=setTimeout(()=>{l(!0)},6e3);return()=>{clearTimeout(p),clearTimeout(m),clearTimeout(y),clearTimeout(v)}},[t,r,n,d]),{hasPWMBadge:a,willPushPWMBadge:u,PWM_BADGE_SPACE_WIDTH:Ife}}var b$=g.createContext({}),w$=g.forwardRef((e,t)=>{var n=e,{value:r,onChange:a,maxLength:o,textAlign:i="left",pattern:s,placeholder:c,inputMode:l="numeric",onComplete:u,pushPasswordManagerStrategy:d="increase-width",pasteTransformer:f,containerClassName:p,noScriptCSSFallback:m=$fe,render:y,children:v}=n,b=Mfe(n,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),w,_,x,S,j;let[E,O]=g.useState(typeof b.defaultValue=="string"?b.defaultValue:""),P=r??E,k=Tfe(P),N=g.useCallback(ie=>{a==null||a(ie),O(ie)},[a]),R=g.useMemo(()=>s?typeof s=="string"?new RegExp(s):s:null,[s]),M=g.useRef(null),C=g.useRef(null),T=g.useRef({value:P,onChange:N,isIOS:typeof window<"u"&&((_=(w=window==null?void 0:window.CSS)==null?void 0:w.supports)==null?void 0:_.call(w,"-webkit-touch-callout","none"))}),A=g.useRef({prev:[(x=M.current)==null?void 0:x.selectionStart,(S=M.current)==null?void 0:S.selectionEnd,(j=M.current)==null?void 0:j.selectionDirection]});g.useImperativeHandle(t,()=>M.current,[]),g.useEffect(()=>{let ie=M.current,pe=C.current;if(!ie||!pe)return;T.current.value!==ie.value&&T.current.onChange(ie.value),A.current.prev=[ie.selectionStart,ie.selectionEnd,ie.selectionDirection];function Oe(){if(document.activeElement!==ie){B(null),te(null);return}let Ce=ie.selectionStart,Ze=ie.selectionEnd,Je=ie.selectionDirection,Qe=ie.maxLength,Rt=ie.value,z=A.current.prev,J=-1,fe=-1,ve;if(Rt.length!==0&&Ce!==null&&Ze!==null){let ut=Ce===Ze,Q=Ce===Rt.length&&Rt.length<Qe;if(ut&&!Q){let ne=Ce;if(ne===0)J=0,fe=1,ve="forward";else if(ne===Qe)J=ne-1,fe=ne,ve="backward";else if(Qe>1&&Rt.length>1){let se=0;if(z[0]!==null&&z[1]!==null){ve=ne<z[1]?"backward":"forward";let ye=z[0]===z[1]&&z[0]<Qe;ve==="backward"&&!ye&&(se=-1)}J=se+ne,fe=se+ne+1}}J!==-1&&fe!==-1&&J!==fe&&M.current.setSelectionRange(J,fe,ve)}let Ie=J!==-1?J:Ce,Ke=fe!==-1?fe:Ze,Xe=ve??Je;B(Ie),te(Ke),A.current.prev=[Ie,Ke,Xe]}if(document.addEventListener("selectionchange",Oe,{capture:!0}),Oe(),document.activeElement===ie&&V(!0),!document.getElementById("input-otp-style")){let Ce=document.createElement("style");if(Ce.id="input-otp-style",document.head.appendChild(Ce),Ce.sheet){let Ze="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";Td(Ce.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),Td(Ce.sheet,`[data-input-otp]:autofill { ${Ze} }`),Td(Ce.sheet,`[data-input-otp]:-webkit-autofill { ${Ze} }`),Td(Ce.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),Td(Ce.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let Ue=()=>{pe&&pe.style.setProperty("--root-height",`${ie.clientHeight}px`)};Ue();let Ve=new ResizeObserver(Ue);return Ve.observe(ie),()=>{document.removeEventListener("selectionchange",Oe,{capture:!0}),Ve.disconnect()}},[]);let[I,F]=g.useState(!1),[D,V]=g.useState(!1),[U,B]=g.useState(null),[K,te]=g.useState(null);g.useEffect(()=>{Afe(()=>{var ie,pe,Oe,Ue;(ie=M.current)==null||ie.dispatchEvent(new Event("input"));let Ve=(pe=M.current)==null?void 0:pe.selectionStart,Ce=(Oe=M.current)==null?void 0:Oe.selectionEnd,Ze=(Ue=M.current)==null?void 0:Ue.selectionDirection;Ve!==null&&Ce!==null&&(B(Ve),te(Ce),A.current.prev=[Ve,Ce,Ze])})},[P,D]),g.useEffect(()=>{k!==void 0&&P!==k&&k.length<o&&P.length===o&&(u==null||u(P))},[o,u,k,P]);let L=Lfe({containerRef:C,inputRef:M,pushPasswordManagerStrategy:d,isFocused:D}),$=g.useCallback(ie=>{let pe=ie.currentTarget.value.slice(0,o);if(pe.length>0&&R&&!R.test(pe)){ie.preventDefault();return}typeof k=="string"&&pe.length<k.length&&document.dispatchEvent(new Event("selectionchange")),N(pe)},[o,N,k,R]),W=g.useCallback(()=>{var ie;if(M.current){let pe=Math.min(M.current.value.length,o-1),Oe=M.current.value.length;(ie=M.current)==null||ie.setSelectionRange(pe,Oe),B(pe),te(Oe)}V(!0)},[o]),q=g.useCallback(ie=>{var pe,Oe;let Ue=M.current;if(!f&&(!T.current.isIOS||!ie.clipboardData||!Ue))return;let Ve=ie.clipboardData.getData("text/plain"),Ce=f?f(Ve):Ve;ie.preventDefault();let Ze=(pe=M.current)==null?void 0:pe.selectionStart,Je=(Oe=M.current)==null?void 0:Oe.selectionEnd,Qe=(Ze!==Je?P.slice(0,Ze)+Ce+P.slice(Je):P.slice(0,Ze)+Ce+P.slice(Ze)).slice(0,o);if(Qe.length>0&&R&&!R.test(Qe))return;Ue.value=Qe,N(Qe);let Rt=Math.min(Qe.length,o-1),z=Qe.length;Ue.setSelectionRange(Rt,z),B(Rt),te(z)},[o,N,R,P]),Z=g.useMemo(()=>({position:"relative",cursor:b.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[b.disabled]),ee=g.useMemo(()=>({position:"absolute",inset:0,width:L.willPushPWMBadge?`calc(100% + ${L.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:L.willPushPWMBadge?`inset(0 ${L.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:i,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[L.PWM_BADGE_SPACE_WIDTH,L.willPushPWMBadge,i]),oe=g.useMemo(()=>g.createElement("input",Nfe(Pfe({autoComplete:b.autoComplete||"one-time-code"},b),{"data-input-otp":!0,"data-input-otp-placeholder-shown":P.length===0||void 0,"data-input-otp-mss":U,"data-input-otp-mse":K,inputMode:l,pattern:R==null?void 0:R.source,"aria-placeholder":c,style:ee,maxLength:o,value:P,ref:M,onPaste:ie=>{var pe;q(ie),(pe=b.onPaste)==null||pe.call(b,ie)},onChange:$,onMouseOver:ie=>{var pe;F(!0),(pe=b.onMouseOver)==null||pe.call(b,ie)},onMouseLeave:ie=>{var pe;F(!1),(pe=b.onMouseLeave)==null||pe.call(b,ie)},onFocus:ie=>{var pe;W(),(pe=b.onFocus)==null||pe.call(b,ie)},onBlur:ie=>{var pe;V(!1),(pe=b.onBlur)==null||pe.call(b,ie)}})),[$,W,q,l,ee,o,K,U,b,R==null?void 0:R.source,P]),H=g.useMemo(()=>({slots:Array.from({length:o}).map((ie,pe)=>{var Oe;let Ue=D&&U!==null&&K!==null&&(U===K&&pe===U||pe>=U&&pe<K),Ve=P[pe]!==void 0?P[pe]:null,Ce=P[0]!==void 0?null:(Oe=c==null?void 0:c[pe])!=null?Oe:null;return{char:Ve,placeholderChar:Ce,isActive:Ue,hasFakeCaret:Ue&&Ve===null}}),isFocused:D,isHovering:!b.disabled&&I}),[D,I,o,K,U,b.disabled,P]),le=g.useMemo(()=>y?y(H):g.createElement(b$.Provider,{value:H},v),[v,H,y]);return g.createElement(g.Fragment,null,m!==null&&g.createElement("noscript",null,g.createElement("style",null,m)),g.createElement("div",{ref:C,"data-input-otp-container":!0,style:Z,className:p},le,g.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},oe)))});w$.displayName="Input";function Td(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var $fe=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const cS=g.forwardRef(({className:e,containerClassName:t,...n},r)=>h.jsx(w$,{ref:r,containerClassName:G("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:G("disabled:cursor-not-allowed",e),...n}));cS.displayName="InputOTP";const Rd=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("flex items-center",e),...t}));Rd.displayName="InputOTPGroup";const _r=g.forwardRef(({index:e,className:t,hidden:n,...r},a)=>{const o=g.useContext(b$),{char:i,hasFakeCaret:s,isActive:c}=o.slots[e];return h.jsxs("div",{ref:a,className:G("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",c&&"z-10 ring-2 ring-ring ring-offset-background",t),...r,children:[n&&i?h.jsx(KX,{}):i,s&&h.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});_r.displayName="InputOTPSlot";const lS=g.forwardRef(({...e},t)=>h.jsx("div",{ref:t,role:"separator",...e,children:h.jsx(KX,{})}));lS.displayName="InputOTPSeparator";const Id=uo(({onConfirm:e,onCancel:t})=>{const n=an(),{t:r}=Re("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{e(a),o(""),n.resolve(!0),n.hide()},c=()=>{t(),o(""),n.resolve(!1),n.hide()};return h.jsx(yi,{open:n.visible,onOpenChange:c,children:h.jsxs(xo,{className:"w-[330px]",children:[h.jsxs(_o,{children:[h.jsx(So,{children:r("session_passkey.title")}),h.jsx(Uu,{children:r("session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(cS,{onChange:i,maxLength:6,children:[h.jsxs(Rd,{children:[h.jsx(_r,{index:0,hidden:!0}),h.jsx(_r,{index:1,hidden:!0}),h.jsx(_r,{index:2,hidden:!0})]}),h.jsx(lS,{}),h.jsxs(Rd,{children:[h.jsx(_r,{index:3,hidden:!0}),h.jsx(_r,{index:4,hidden:!0}),h.jsx(_r,{index:5,hidden:!0})]})]})}),h.jsx(zu,{children:h.jsx(yt,{onClick:s,type:"submit",children:r("session_passkey.confirm")})})]})})}),Dd=e=>{const t=e.match(/.{1,2}/g);if(!t)throw new Error("Invalid hexString");return Uint8Array.from(t.map(n=>parseInt(n,16))).buffer},x$=e=>new TextEncoder().encode(e).buffer,Ffe=async e=>{const t=x$(e);return await crypto.subtle.digest("SHA-256",t)},uS=e=>[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join(""),Bfe=async()=>{const e=crypto.getRandomValues(new Uint8Array(32));return uS(e)},dS=async e=>{const t=await Ffe(e);return uS(t)},_$=async e=>(await dS(e)).substring(0,32),S$=async(e,t)=>{const n=await dS(t),r=await _$(t),a=x$(e),o=await zfe(a,n,r);return uS(o)},fS=async(e,t)=>{const n=await dS(t),r=await _$(t),a=Dd(e),o=await Ufe(a,n,r);return new TextDecoder().decode(o)},zfe=async(e,t,n)=>{const r=Dd(n),a=Dd(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.encrypt({name:"AES-CBC",iv:r},o,e)},Ufe=async(e,t,n)=>{const r=Dd(n),a=Dd(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.decrypt({name:"AES-CBC",iv:r},o,e)},j$=async(e,t)=>{const n={};return await Promise.all(Object.entries(e||{}).map(async([r,a])=>{const o=await S$(a,t);n[r]=o})),n},km=async(e,t)=>{let n;if(await new Promise((r,a)=>{t.show({onConfirm:async o=>{try{n=await fS(e,o),await yp.set("passphrase",n),r(!0)}catch(i){a(i)}finally{t.hide()}},onCancel:()=>{a()}})}),!n)throw new Error("Passphrase is required");return n},Lc=e=>{const t=an(e),n=g.useRef(t);return n.current=t,{modal:t,modalRef:n}},Vfe=()=>{var E,O;const[e,t]=g.useState(),[n,r]=g.useState(),[a,o]=g.useState(),[i,s]=g.useState([]),[c,l]=g.useState(),u=g.useRef(),d=g.useRef({}),f=st(P=>P.currentSession),{loadModel:p}=Om(),{modalRef:m}=Lc(Id),y=g.useCallback(async P=>{var N;if(!f)return;const k=await he("JSONData").findOne({where:{id:P.source_id,session_id:f==null?void 0:f.id}});k&&((N=u.current)==null||N.call(u,k.data?k.data:[]),l({node:P,enity:k}))},[f]),v=g.useCallback(async P=>{var A;const k=(P==null?void 0:P.sessionId)||(f==null?void 0:f.id),N=(P==null?void 0:P.threadNode)||(n==null?void 0:n.threadNode),R=(P==null?void 0:P.prompts)||(e==null?void 0:e.prompts);if(!k||!(N!=null&&N.id))return;const M=R==null?void 0:R.map(I=>{if(I.type!=="few_shot_example")switch(I.role){case"ai":case"assistant":case"tool":return{id:I.id,content:I.content,role:"assistant"};case"system":return{id:I.id,content:I.content,role:"system"};default:return{id:I.id,content:I.content,role:"user"}}}).filter(Boolean),C=await he("JSONData").save({headers:"item",session_id:k,json:"",data:M});if(!C)return;const T=await he("FlowNode").save({session_id:k,source_id:C.id,source_type:"JSONData",node_type:"JSON_DATA",x:0,y:0});if(T)return await he("FlowEdge").save({session_id:k,source:N.id,target:T.id}),(A=u.current)==null||A.call(u,M),l({node:T,enity:C}),{jsonData:C,jsonDataNode:T}},[e==null?void 0:e.prompts,f==null?void 0:f.id,n==null?void 0:n.threadNode]),b=g.useCallback(async(P,k)=>{if(!f)return;const N=await he("FlowEdge").findOne({where:{session_id:f.id,source:P.id},order:{id:"DESC"}});if(N){const R=await he("FlowNode").findOne({where:{id:N.target,session_id:f.id}});if(!R)return;await y(R)}else if(!await v({sessionId:f.id,threadNode:P,prompts:k||[]}))return},[v,f,y]),w=g.useCallback(async P=>{if(P!=null&&P.length&&(f!=null&&f.id)){const k=(await Promise.all(P.map(async N=>he("FlowEdge").find({where:{target:N.source.id}}).then(R=>Em({where:{session_id:f.id,id:Xa(R.map(M=>M.source))}}).then(M=>({...M,...N})))))).map(N=>{var A,I,F,D;const R=N.flowNodes.find(V=>V.source_type==="Prompt"),M=N.flowNodes.find(V=>V.source_type==="VectorDatabase");if(!M||!R)return;const C=(I=(A=N.flowNodeDatas)==null?void 0:A.Prompt)==null?void 0:I.find(V=>V.id===R.source_id),T=(D=(F=N.flowNodeDatas)==null?void 0:F.VectorDatabase)==null?void 0:D.find(V=>V.id===M.source_id);return{promptNode:R,vectorDatabaseNode:M,placeholderNode:N.source,placeholderEntity:N.entity,promptEntity:C,vectorDatabaseEntity:T}}).filter(Boolean);s(k)}},[f==null?void 0:f.id]),_=g.useCallback(async()=>{try{if(d.current.handling=f==null?void 0:f.id,!(f!=null&&f.id)||!(f!=null&&f.main_source_id)||(f==null?void 0:f.main_source_type)!=="Thread")return;const[P,k]=await Promise.all([he("Thread").findOne({where:{id:f.main_source_id,session_id:f.id}}),he("FlowNode").findOne({where:{id:f.main_node_id}})]);if(!P||!k)return;const N=await he("FlowEdge").find({where:{session_id:f.id,target:k.id}}),{flowNodes:R,flowNodeDatas:M}=await Em({where:{session_id:f.id,id:Xa(N.map(U=>U.source))}}),C=(await he("FlowEdge").find({where:{session_id:f.id}})).filter(U=>U.target===k.id).map(U=>{var K;const B=R.find(te=>te.id===U.source);return{connection:U,source:B,entity:(K=M==null?void 0:M[B.source_type])==null?void 0:K.find(te=>te.id===B.source_id)}}),T=C.find(U=>U.source.source_type==="LLM"),A=C.filter(U=>U.source.source_type==="Prompt"),I=C.find(U=>U.source.source_type==="Schema"),F=T==null?void 0:T.entity;if(!F)return;f.passphrase&&await km(f.passphrase,m.current);const D=C.filter(U=>U.source.source_type==="FlowNodePlaceholder");await w(D),await b(k,(A==null?void 0:A.map(U=>U.entity))||[]),o({llm:F,status:F.status||rt.Started,progress:""}),r({thread:P,threadNode:k});const V=I==null?void 0:I.entity;if(V){const U=await he("SchemaItem").find({where:{schema_id:V.id}});V.schema_items=U||[]}t({prompts:(A==null?void 0:A.map(U=>U.entity))||[],schema:V}),d.current.handled=f.id}finally{d.current.handling=void 0}},[f==null?void 0:f.id,f==null?void 0:f.main_node_id,f==null?void 0:f.main_source_id,f==null?void 0:f.main_source_type,f==null?void 0:f.passphrase,w,b,m]),x=g.useCallback(async()=>{var P;if((P=a==null?void 0:a.llm)!=null&&P.name)try{o(k=>k&&{...k,status:rt.Loading}),await p(a.llm.provider,a==null?void 0:a.llm.name,k=>{o(N=>N&&{...N,progress:k.text})}),o(k=>k&&{...k,status:rt.Loaded,progress:""})}catch{o(k=>k&&{...k,status:rt.Started,progress:""})}},[(E=a==null?void 0:a.llm)==null?void 0:E.name,(O=a==null?void 0:a.llm)==null?void 0:O.provider,p]),S=g.useCallback(P=>(u.current=P,()=>{u.current=void 0}),[]),j=g.useCallback(async P=>{!(c!=null&&c.node)||!(c!=null&&c.enity)||await he("JSONData").save({...c.enity,data:P})},[c==null?void 0:c.enity,c==null?void 0:c.node]);return g.useEffect(()=>{d.current.handling||(d==null?void 0:d.current.handled)===(f==null?void 0:f.id)||_()},[f==null?void 0:f.id,_]),{...e,loadLLM:x,threadInfo:n,mainLLMInfo:a,retriverInfo:i,currentDataNode:c,updateMessagesData:j,addNewDataNode:v,selectDataNode:y,onThreadMessagesLoaded:S}};class Wfe extends gp{get lc_attributes(){return{partialVariables:void 0}}constructor(t){super(t),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:n}=t;if(n.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,t)}async mergePartialAndUserVariables(t){const n=this.partialVariables??{},r={};for(const[a,o]of Object.entries(n))typeof o=="string"?r[a]=o:r[a]=await o();return{...r,...t}}async invoke(t,n){return this._callWithConfig(r=>this.formatPromptValue(r),t,{...n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(t){switch(t._type){case"prompt":{const{PromptTemplate:n}=await Qt(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>D$);return{PromptTemplate:r}},[]);return n.deserialize(t)}case void 0:{const{PromptTemplate:n}=await Qt(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>D$);return{PromptTemplate:r}},void 0);return n.deserialize({...t,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:n}=await Qt(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot-B66Vt9iw.js").then(async a=>(await a.__tla,a));return{FewShotPromptTemplate:r}},__vite__mapDeps([0,1,2,3,4]));return n.deserialize(t)}default:throw new Error(`Invalid prompt type in config: ${t._type}`)}}}class E$ extends t4e{}class O$ extends E${static lc_name(){return"StringPromptValue"}constructor(t){super({value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=t}toString(){return this.value}toChatMessages(){return[new Vr(this.value)]}}class Hfe extends E${static lc_name(){return"ChatPromptValue"}constructor(t){Array.isArray(t)&&(t={messages:t}),super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=t.messages}toString(){return n4e(this.messages)}toChatMessages(){return this.messages}}DN=class extends Wfe{async formatPromptValue(e){const t=await this.format(e);return new O$(t)}};var qfe=Object.prototype.toString,$c=Array.isArray||function(e){return qfe.call(e)==="[object Array]"};function pS(e){return typeof e=="function"}function Zfe(e){return $c(e)?"array":typeof e}function hS(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function C$(e,t){return e!=null&&typeof e=="object"&&t in e}function Kfe(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var Xfe=RegExp.prototype.test;function Yfe(e,t){return Xfe.call(e,t)}var Jfe=/\S/;function Qfe(e){return!Yfe(Jfe,e)}var Gfe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function epe(e){return String(e).replace(/[&<>"'`=\/]/g,function(t){return Gfe[t]})}var tpe=/\s*/,npe=/\s+/,k$=/\s*=/,rpe=/\s*\}/,ape=/#|\^|\/|>|\{|&|=|!/;function ope(e,t){if(!e)return[];var n=!1,r=[],a=[],o=[],i=!1,s=!1,c="",l=0;function u(){if(i&&!s)for(;o.length;)delete a[o.pop()];else o=[];i=!1,s=!1}var d,f,p;function m(O){if(typeof O=="string"&&(O=O.split(npe,2)),!$c(O)||O.length!==2)throw new Error("Invalid tags: "+O);d=new RegExp(hS(O[0])+"\\s*"),f=new RegExp("\\s*"+hS(O[1])),p=new RegExp("\\s*"+hS("}"+O[1]))}m(t||rr.tags);for(var y=new Ld(e),v,b,w,_,x,S;!y.eos();){if(v=y.pos,w=y.scanUntil(d),w)for(var j=0,E=w.length;j<E;++j)_=w.charAt(j),Qfe(_)?(o.push(a.length),c+=_):(s=!0,n=!0,c+=" "),a.push(["text",_,v,v+1]),v+=1,_===`
`&&(u(),c="",l=0,n=!1);if(!y.scan(d))break;if(i=!0,b=y.scan(ape)||"name",y.scan(tpe),b==="="?(w=y.scanUntil(k$),y.scan(k$),y.scanUntil(f)):b==="{"?(w=y.scanUntil(p),y.scan(rpe),y.scanUntil(f),b="&"):w=y.scanUntil(f),!y.scan(f))throw new Error("Unclosed tag at "+y.pos);if(b==">"?x=[b,w,v,y.pos,c,l,n]:x=[b,w,v,y.pos],l++,a.push(x),b==="#"||b==="^")r.push(x);else if(b==="/"){if(S=r.pop(),!S)throw new Error('Unopened section "'+w+'" at '+v);if(S[1]!==w)throw new Error('Unclosed section "'+S[1]+'" at '+v)}else b==="name"||b==="{"||b==="&"?s=!0:b==="="&&m(w)}if(u(),S=r.pop(),S)throw new Error('Unclosed section "'+S[1]+'" at '+y.pos);return spe(ipe(a))}function ipe(e){for(var t=[],n,r,a=0,o=e.length;a<o;++a)n=e[a],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function spe(e){for(var t=[],n=t,r=[],a,o,i=0,s=e.length;i<s;++i)switch(a=e[i],a[0]){case"#":case"^":n.push(a),r.push(a),n=a[4]=[];break;case"/":o=r.pop(),o[5]=a[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(a)}return t}function Ld(e){this.string=e,this.tail=e,this.pos=0}Ld.prototype.eos=function(){return this.tail===""},Ld.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},Ld.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n};function Fc(e,t){this.view=e,this.cache={".":this.view},this.parent=t}Fc.prototype.push=function(e){return new Fc(e,this)},Fc.prototype.lookup=function(e){var t=this.cache,n;if(t.hasOwnProperty(e))n=t[e];else{for(var r=this,a,o,i,s=!1;r;){if(e.indexOf(".")>0)for(a=r.view,o=e.split("."),i=0;a!=null&&i<o.length;)i===o.length-1&&(s=C$(a,o[i])||Kfe(a,o[i])),a=a[o[i++]];else a=r.view[e],s=C$(r.view,e);if(s){n=a;break}r=r.parent}t[e]=n}return pS(n)&&(n=n.call(this.view)),n};function Kn(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Kn.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()},Kn.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||rr.tags).join(":"),a=typeof n<"u",o=a?n.get(r):void 0;return o==null&&(o=ope(e,t),a&&n.set(r,o)),o},Kn.prototype.render=function(e,t,n,r){var a=this.getConfigTags(r),o=this.parse(e,a),i=t instanceof Fc?t:new Fc(t,void 0);return this.renderTokens(o,i,n,e,r)},Kn.prototype.renderTokens=function(e,t,n,r,a){for(var o="",i,s,c,l=0,u=e.length;l<u;++l)c=void 0,i=e[l],s=i[0],s==="#"?c=this.renderSection(i,t,n,r,a):s==="^"?c=this.renderInverted(i,t,n,r,a):s===">"?c=this.renderPartial(i,t,n,a):s==="&"?c=this.unescapedValue(i,t):s==="name"?c=this.escapedValue(i,t,a):s==="text"&&(c=this.rawValue(i)),c!==void 0&&(o+=c);return o},Kn.prototype.renderSection=function(e,t,n,r,a){var o=this,i="",s=t.lookup(e[1]);function c(d){return o.render(d,t,n,a)}if(s){if($c(s))for(var l=0,u=s.length;l<u;++l)i+=this.renderTokens(e[4],t.push(s[l]),n,r,a);else if(typeof s=="object"||typeof s=="string"||typeof s=="number")i+=this.renderTokens(e[4],t.push(s),n,r,a);else if(pS(s)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");s=s.call(t.view,r.slice(e[3],e[5]),c),s!=null&&(i+=s)}else i+=this.renderTokens(e[4],t,n,r,a);return i}},Kn.prototype.renderInverted=function(e,t,n,r,a){var o=t.lookup(e[1]);if(!o||$c(o)&&o.length===0)return this.renderTokens(e[4],t,n,r,a)},Kn.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),a=e.split(`
`),o=0;o<a.length;o++)a[o].length&&(o>0||!n)&&(a[o]=r+a[o]);return a.join(`
`)},Kn.prototype.renderPartial=function(e,t,n,r){if(n){var a=this.getConfigTags(r),o=pS(n)?n(e[1]):n[e[1]];if(o!=null){var i=e[6],s=e[5],c=e[4],l=o;s==0&&c&&(l=this.indentPartial(o,c,i));var u=this.parse(l,a);return this.renderTokens(u,t,n,l,r)}}},Kn.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(n!=null)return n},Kn.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||rr.escape,a=t.lookup(e[1]);if(a!=null)return typeof a=="number"&&r===rr.escape?String(a):r(a)},Kn.prototype.rawValue=function(e){return e[1]},Kn.prototype.getConfigTags=function(e){return $c(e)?e:e&&typeof e=="object"?e.tags:void 0},Kn.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!$c(e))return e.escape};var rr={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){$d.templateCache=e},get templateCache(){return $d.templateCache}},$d=new Kn;rr.clearCache=function(){return $d.clearCache()},rr.parse=function(e,t){return $d.parse(e,t)},rr.render=function(e,t,n,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+Zfe(e)+'" was given as the first argument for mustache#render(template, view, partials)');return $d.render(e,t,n,r)},rr.escape=epe,rr.Scanner=Ld,rr.Context=Fc,rr.Writer=Kn;function P$(){rr.escape=e=>e}let mS,N$,M$,A$,T$,Pm,R$,I$;mS=e=>{const t=e.split(""),n=[],r=(o,i)=>{for(let s=i;s<t.length;s+=1)if(o.includes(t[s]))return s;return-1};let a=0;for(;a<t.length;)if(t[a]==="{"&&a+1<t.length&&t[a+1]==="{")n.push({type:"literal",text:"{"}),a+=2;else if(t[a]==="}"&&a+1<t.length&&t[a+1]==="}")n.push({type:"literal",text:"}"}),a+=2;else if(t[a]==="{"){const o=r("}",a);if(o<0)throw new Error("Unclosed '{' in template.");n.push({type:"variable",name:t.slice(a+1,o).join("")}),a=o+1}else{if(t[a]==="}")throw new Error("Single '}' in template.");{const o=r("{}",a),i=(o<0?t.slice(a):t.slice(a,o)).join("");n.push({type:"literal",text:i}),a=o<0?t.length:o}}return n},N$=e=>e.map(t=>t[0]==="name"?{type:"variable",name:t[1].includes(".")?t[1].split(".")[0]:t[1]}:["#","&","^",">"].includes(t[0])?{type:"variable",name:t[1]}:{type:"literal",text:t[1]}),M$=e=>{P$();const t=rr.parse(e);return N$(t)},A$=(e,t)=>mS(e).reduce((n,r)=>{if(r.type==="variable"){if(r.name in t)return n+t[r.name];throw new Error(`(f-string) Missing value for input ${r.name}`)}return n+r.text},""),T$=(e,t)=>(P$(),rr.render(e,t)),Pm={"f-string":A$,mustache:T$},R$={"f-string":mS,mustache:M$},Ys=(e,t,n)=>Pm[t](e,n),I$=(e,t)=>R$[t](e),LN=(e,t,n)=>{if(!(t in Pm)){const r=Object.keys(Pm);throw new Error(`Invalid template format. Got \`${t}\`;
                         should be one of ${r}`)}try{const r=n.reduce((a,o)=>(a[o]="foo",a),{});Array.isArray(e)?e.forEach(a=>{if(a.type==="text")Ys(a.text,t,r);else if(a.type==="image_url")if(typeof a.image_url=="string")Ys(a.image_url,t,r);else{const o=a.image_url.url;Ys(o,t,r)}else throw new Error(`Invalid message template received. ${JSON.stringify(a,null,2)}`)}):Ys(e,t,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}},ci=class extends DN{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),LN(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return Ys(this.template,this.templateFormat,t)}static fromExamples(e,t,n,r=`

`,a=""){const o=[a,...e,t].join(r);return new ci({inputVariables:n,template:o})}static fromTemplate(e,t){const{templateFormat:n="f-string",...r}=t??{},a=new Set;return I$(e,n).forEach(o=>{o.type==="variable"&&a.add(o.name)}),new ci({inputVariables:[...a],templateFormat:n,template:e,...r})}async partial(e){const t=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new ci(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new ci({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}};const D$=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:ci},Symbol.toStringTag,{value:"Module"})),yS="RFC3986",gS={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},cpe="RFC1738",lpe=Array.isArray,Ya=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),vS=1024,upe=(e,t,n,r,a)=>{if(e.length===0)return e;let o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(s){return"%26%23"+parseInt(s.slice(2),16)+"%3B"});let i="";for(let s=0;s<o.length;s+=vS){const c=o.length>=vS?o.slice(s,s+vS):o,l=[];for(let u=0;u<c.length;++u){let d=c.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||a===cpe&&(d===40||d===41)){l[l.length]=c.charAt(u);continue}if(d<128){l[l.length]=Ya[d];continue}if(d<2048){l[l.length]=Ya[192|d>>6]+Ya[128|d&63];continue}if(d<55296||d>=57344){l[l.length]=Ya[224|d>>12]+Ya[128|d>>6&63]+Ya[128|d&63];continue}u+=1,d=65536+((d&1023)<<10|c.charCodeAt(u)&1023),l[l.length]=Ya[240|d>>18]+Ya[128|d>>12&63]+Ya[128|d>>6&63]+Ya[128|d&63]}i+=l.join("")}return i};function dpe(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function L$(e,t){if(lpe(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const fpe=Object.prototype.hasOwnProperty,$$={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},Ja=Array.isArray,ppe=Array.prototype.push,F$=function(e,t){ppe.apply(e,Ja(t)?t:[t])},hpe=Date.prototype.toISOString,hn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:upe,encodeValuesOnly:!1,format:yS,formatter:gS[yS],indices:!1,serializeDate(e){return hpe.call(e)},skipNulls:!1,strictNullHandling:!1};function mpe(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const bS={};function B$(e,t,n,r,a,o,i,s,c,l,u,d,f,p,m,y,v,b){let w=e,_=b,x=0,S=!1;for(;(_=_.get(bS))!==void 0&&!S;){const k=_.get(e);if(x+=1,typeof k<"u"){if(k===x)throw new RangeError("Cyclic object value");S=!0}typeof _.get(bS)>"u"&&(x=0)}if(typeof l=="function"?w=l(t,w):w instanceof Date?w=f==null?void 0:f(w):n==="comma"&&Ja(w)&&(w=L$(w,function(k){return k instanceof Date?f==null?void 0:f(k):k})),w===null){if(o)return c&&!y?c(t,hn.encoder,v,"key",p):t;w=""}if(mpe(w)||dpe(w)){if(c){const k=y?t:c(t,hn.encoder,v,"key",p);return[(m==null?void 0:m(k))+"="+(m==null?void 0:m(c(w,hn.encoder,v,"value",p)))]}return[(m==null?void 0:m(t))+"="+(m==null?void 0:m(String(w)))]}const j=[];if(typeof w>"u")return j;let E;if(n==="comma"&&Ja(w))y&&c&&(w=L$(w,c)),E=[{value:w.length>0?w.join(",")||null:void 0}];else if(Ja(l))E=l;else{const k=Object.keys(w);E=u?k.sort(u):k}const O=s?String(t).replace(/\./g,"%2E"):String(t),P=r&&Ja(w)&&w.length===1?O+"[]":O;if(a&&Ja(w)&&w.length===0)return P+"[]";for(let k=0;k<E.length;++k){const N=E[k],R=typeof N=="object"&&typeof N.value<"u"?N.value:w[N];if(i&&R===null)continue;const M=d&&s?N.replace(/\./g,"%2E"):N,C=Ja(w)?typeof n=="function"?n(P,M):P:P+(d?"."+M:"["+M+"]");b.set(e,x);const T=new WeakMap;T.set(bS,b),F$(j,B$(R,C,n,r,a,o,i,s,n==="comma"&&y&&Ja(w)?null:c,l,u,d,f,p,m,y,v,T))}return j}function ype(e=hn){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||hn.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=yS;if(typeof e.format<"u"){if(!fpe.call(gS,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=gS[n];let a=hn.filter;(typeof e.filter=="function"||Ja(e.filter))&&(a=e.filter);let o;if(e.arrayFormat&&e.arrayFormat in $$?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=hn.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:hn.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:hn.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:hn.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:hn.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?hn.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:hn.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:hn.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:hn.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:hn.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:hn.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:hn.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:hn.strictNullHandling}}function gpe(e,t={}){let n=e;const r=ype(t);let a,o;typeof r.filter=="function"?(o=r.filter,n=o("",n)):Ja(r.filter)&&(o=r.filter,a=o);const i=[];if(typeof n!="object"||n===null)return"";const s=$$[r.arrayFormat],c=s==="comma"&&r.commaRoundTrip;a||(a=Object.keys(n)),r.sort&&a.sort(r.sort);const l=new WeakMap;for(let f=0;f<a.length;++f){const p=a[f];r.skipNulls&&n[p]===null||F$(i,B$(n[p],p,s,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const u=i.join(r.delimiter);let d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const Bc="4.78.1";let z$=!1,Fd,U$,V$,wS,W$,H$,q$,Z$,K$;function vpe(e,t={auto:!1}){if(z$)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(Fd)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${Fd}'\``);z$=t.auto,Fd=e.kind,U$=e.fetch,V$=e.FormData,wS=e.File,W$=e.ReadableStream,H$=e.getMultipartRequestOptions,q$=e.getDefaultAgent,Z$=e.fileFromPath,K$=e.isFsReadStream}let bpe=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function wpe({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new bpe(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}Fd||vpe(wpe(),{auto:!0});class ct extends Error{}let ar=class KN extends ct{constructor(t,n,r,a){super(`${KN.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=n;const o=n;this.code=o==null?void 0:o.code,this.param=o==null?void 0:o.param,this.type=o==null?void 0:o.type}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t||!a)return new Nm({message:r,cause:jS(n)});const o=n==null?void 0:n.error;return t===400?new X$(t,o,r,a):t===401?new Y$(t,o,r,a):t===403?new J$(t,o,r,a):t===404?new Q$(t,o,r,a):t===409?new G$(t,o,r,a):t===422?new e6(t,o,r,a):t===429?new t6(t,o,r,a):t>=500?new n6(t,o,r,a):new KN(t,o,r,a)}},Ar=class extends ar{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},Nm=class extends ar{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},Mm=class extends Nm{constructor({message:e}={}){super({message:e??"Request timed out."})}},X$=class extends ar{},Y$=class extends ar{},J$=class extends ar{},Q$=class extends ar{},G$=class extends ar{},e6=class extends ar{},t6=class extends ar{},n6=class extends ar{};class r6 extends ct{constructor(){super("Could not parse response content as the length limit was reached")}}class a6 extends ct{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}let Am=class XN{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=XN.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(XN.NEWLINE_REGEXP);return r&&a.pop(),a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof En<"u"){if(t instanceof En)return t.toString();if(t instanceof Uint8Array)return En.from(t).toString();throw new ct(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new ct(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new ct("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}};Am.NEWLINE_CHARS=new Set([`
`,"\r"]),Am.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let Bd=class Op{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const i of xpe(t,n))if(!o){if(i.data.startsWith("[DONE]")){o=!0;continue}if(i.event===null){let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(s&&s.error)throw new ar(void 0,s.error,void 0,void 0);yield s}else{let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new ar(void 0,s.error,s.message,void 0);yield{event:i.event,data:s}}}o=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{o||n.abort()}}return new Op(a,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new Am,s=o6(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new Op(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new Op(()=>a(t),this.controller),new Op(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new W$({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}};async function*xpe(e,t){if(!e.body)throw t.abort(),new ct("Attempted to iterate over a response with no body");const n=new jpe,r=new Am,a=o6(e.body);for await(const o of _pe(a))for(const i of r.decode(o)){const s=n.decode(i);s&&(yield s)}for(const o of r.flush()){const i=n.decode(o);i&&(yield i)}}async function*_pe(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let a=new Uint8Array(t.length+r.length);a.set(t),a.set(r,t.length),t=a;let o;for(;(o=Spe(t))!==-1;)yield t.slice(0,o),t=t.slice(o)}t.length>0&&(yield t)}function Spe(e){for(let t=0;t<e.length-2;t++){if(e[t]===10&&e[t+1]===10||e[t]===13&&e[t+1]===13)return t+2;if(e[t]===13&&e[t+1]===10&&t+3<e.length&&e[t+2]===13&&e[t+3]===10)return t+4}return-1}let jpe=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=Epe(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}};function Epe(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function o6(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const i6=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",s6=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Tm(e),Tm=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",Ope=e=>s6(e)||i6(e)||K$(e);async function c6(e,t,n){var a;if(e=await e,s6(e))return e;if(i6(e)){const o=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=Tm(o)?[await o.arrayBuffer()]:[o];return new wS(i,t,n)}const r=await Cpe(e);if(t||(t=Ppe(e)??"unknown_file"),!(n!=null&&n.type)){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new wS(r,t,n)}async function Cpe(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Tm(e))t.push(await e.arrayBuffer());else if(Npe(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${kpe(e)}`);return t}function kpe(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function Ppe(e){var t;return xS(e.name)||xS(e.filename)||((t=xS(e.path))==null?void 0:t.split(/[\\/]/).pop())}const xS=e=>{if(typeof e=="string")return e;if(typeof En<"u"&&e instanceof En)return String(e)},Npe=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",l6=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",zc=async e=>{const t=await Mpe(e.body);return H$(t,e)},Mpe=async e=>{const t=new V$;return await Promise.all(Object.entries(e||{}).map(([n,r])=>_S(t,n,r))),t},_S=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(Ope(n)){const r=await c6(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>_S(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>_S(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Uc={},Ape=function(e,t,n,r,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n},Tpe=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Rm;async function u6(e){const{response:t}=e;if(e.options.stream)return Vc("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Bd.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return Vc("response",t.status,t.url,t.headers,a),d6(a,t)}const r=await t.text();return Vc("response",t.status,t.url,t.headers,r),r}function d6(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}let f6=class aY extends Promise{constructor(t,n=u6){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new aY(this.responsePromise,async n=>d6(t(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}},Rpe=class{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:a}){this.baseURL=e,this.maxRetries=SS("maxRetries",t),this.timeout=SS("timeout",n),this.httpAgent=r,this.fetch=a??U$}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Bpe(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Wpe()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async r=>{const a=r&&Tm(r==null?void 0:r.body)?new DataView(await r.body.arrayBuffer()):(r==null?void 0:r.body)instanceof DataView?r.body:(r==null?void 0:r.body)instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r==null?void 0:r.body)?new DataView(r.body.buffer):r==null?void 0:r.body;return{method:e,path:t,...r,body:a}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof En<"u")return En.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var p;const{method:n,path:r,query:a,headers:o={}}=e,i=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:l6(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,s=this.calculateContentLength(i),c=this.buildURL(r,a);"timeout"in e&&SS("timeout",e.timeout);const l=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??q$(c),d=l+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const f=this.buildHeaders({options:e,headers:o,contentLength:s,retryCount:t});return{req:{method:n,...i&&{body:i},headers:f,...u&&{agent:u},signal:e.signal??null},url:c,timeout:l}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const a={};n&&(a["content-length"]=n);const o=this.defaultHeaders(e);return b6(a,o),b6(a,t),l6(e.body)&&Fd!=="node"&&delete a["content-type"],w6(o,"x-stainless-retry-count")===void 0&&w6(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(r)),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,r){return ar.generate(e,t,n,r)}request(e,t=null){return new f6(this.makeRequest(e,t))}async makeRequest(e,t){var u,d;const n=await e,r=n.maxRetries??this.maxRetries;t==null&&(t=r),await this.prepareOptions(n);const{req:a,url:o,timeout:i}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(a,{url:o,options:n}),Vc("request",o,n,a.headers),(u=n.signal)==null?void 0:u.aborted)throw new Ar;const s=new AbortController,c=await this.fetchWithTimeout(o,a,i,s).catch(jS);if(c instanceof Error){if((d=n.signal)!=null&&d.aborted)throw new Ar;if(t)return this.retryRequest(n,t);throw c.name==="AbortError"?new Mm:new Nm({cause:c})}const l=Dpe(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const y=`retrying, ${t} attempts remaining`;return Vc(`response (error; ${y})`,c.status,o,l),this.retryRequest(n,t,l)}const f=await c.text().catch(y=>jS(y).message),p=zpe(f),m=p?void 0:f;throw Vc(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,l,m),this.makeStatusError(c.status,p,m,l)}return{response:c,options:n,controller:s}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new Ipe(this,n,e)}buildURL(e,t){const n=Vpe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return g6(r)||(t={...r,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new ct(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:a,...o}=t||{};a&&a.addEventListener("abort",()=>r.abort());const i=setTimeout(()=>r.abort(),n),s={signal:r.signal,...o};return s.method&&(s.method=s.method.toUpperCase()),this.fetch.call(void 0,e,s).finally(()=>{clearTimeout(i)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let r;const a=n==null?void 0:n["retry-after-ms"];if(a){const i=parseFloat(a);Number.isNaN(i)||(r=i)}const o=n==null?void 0:n["retry-after"];if(o&&!r){const i=parseFloat(o);Number.isNaN(i)?r=Date.parse(o)-Date.now():r=i*1e3}if(!(r&&0<=r&&r<60*1e3)){const i=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,i)}return await zd(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e,r=Math.min(.5*Math.pow(2,n),8),a=1-Math.random()*.25;return r*a*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Bc}`}};class p6{constructor(t,n,r,a){Rm.set(this,void 0),Ape(this,Rm,t),this.options=a,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new ct("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in t&&typeof n.query=="object")n.query={...n.query,...t.params};else if("url"in t){const r=[...Object.entries(n.query||{}),...t.url.searchParams.entries()];for(const[a,o]of r)t.url.searchParams.set(a,o);n.query=void 0,n.path=t.url.toString()}return await Tpe(this,Rm,"f").requestAPIList(this.constructor,n)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(Rm=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}let Ipe=class extends f6{constructor(e,t,n){super(t,async r=>new n(e,r.response,await u6(r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}};const Dpe=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),Lpe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},or=e=>typeof e=="object"&&e!==null&&!g6(e)&&Object.keys(e).every(t=>v6(Lpe,t)),$pe=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bc,"X-Stainless-OS":m6(Deno.build.os),"X-Stainless-Arch":h6(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":On.version};if(Object.prototype.toString.call(typeof On<"u"?On:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bc,"X-Stainless-OS":m6(On.platform),"X-Stainless-Arch":h6(On.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":On.version};const e=Fpe();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Fpe(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const h6=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",m6=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let y6;const Bpe=()=>y6??(y6=$pe()),zpe=e=>{try{return JSON.parse(e)}catch{return}},Upe=/^[a-z][a-z0-9+.-]*:/i,Vpe=e=>Upe.test(e),zd=e=>new Promise(t=>setTimeout(t,e)),SS=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new ct(`${e} must be an integer`);if(t<0)throw new ct(`${e} must be a positive integer`);return t},jS=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},Im=e=>{var t,n,r,a;if(typeof On<"u")return((t=Uc==null?void 0:Uc[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function g6(e){if(!e)return!0;for(const t in e)return!1;return!0}function v6(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function b6(e,t){for(const n in t){if(!v6(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function Vc(e,...t){typeof On<"u"&&(Uc==null?void 0:Uc.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${e}`,...t)}const Wpe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),Hpe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",qpe=e=>typeof(e==null?void 0:e.get)=="function",w6=(e,t)=>{var r;const n=t.toLowerCase();if(qpe(e)){const a=((r=t[0])==null?void 0:r.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(o,i,s)=>i+s.toUpperCase());for(const o of[t,n,t.toUpperCase(),a]){const i=e.get(o);if(i)return i}}for(const[a,o]of Object.entries(e))if(a.toLowerCase()===n)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${t} header, using the first entry.`),o[0]):o};function ES(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class Zpe extends p6{constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class la extends p6{constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const n=Object.fromEntries(t.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const t=this.getPaginatedItems();if(!t.length)return null;const n=(r=t[t.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}let xt=class{constructor(e){this._client=e}},x6=class extends xt{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},OS=class extends xt{constructor(){super(...arguments),this.completions=new x6(this._client)}};OS.Completions=x6;class _6 extends xt{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}let S6=class extends xt{create(e,t){return this._client.post("/audio/transcriptions",zc({body:e,...t}))}},j6=class extends xt{create(e,t){return this._client.post("/audio/translations",zc({body:e,...t}))}},Ud=class extends xt{constructor(){super(...arguments),this.transcriptions=new S6(this._client),this.translations=new j6(this._client),this.speech=new _6(this._client)}};Ud.Transcriptions=S6,Ud.Translations=j6,Ud.Speech=_6;class CS extends xt{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(`/batches/${t}`,n)}list(t={},n){return or(t)?this.list({},t):this._client.getAPIList("/batches",kS,{query:t,...n})}cancel(t,n){return this._client.post(`/batches/${t}/cancel`,n)}}class kS extends la{}CS.BatchesPage=kS;class PS extends xt{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/assistants/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return or(t)?this.list({},t):this._client.getAPIList("/assistants",NS,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class NS extends la{}PS.AssistantsPage=NS;function E6(e){return typeof e.parse=="function"}const Wc=e=>(e==null?void 0:e.role)==="assistant",O6=e=>(e==null?void 0:e.role)==="function",C6=e=>(e==null?void 0:e.role)==="tool";var ua=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Gt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},MS,Dm,Lm,Vd,Wd,$m,Hd,Lo,qd,Fm,Bm,Hc,k6;class P6{constructor(){MS.add(this),this.controller=new AbortController,Dm.set(this,void 0),Lm.set(this,()=>{}),Vd.set(this,()=>{}),Wd.set(this,void 0),$m.set(this,()=>{}),Hd.set(this,()=>{}),Lo.set(this,{}),qd.set(this,!1),Fm.set(this,!1),Bm.set(this,!1),Hc.set(this,!1),ua(this,Dm,new Promise((t,n)=>{ua(this,Lm,t,"f"),ua(this,Vd,n,"f")}),"f"),ua(this,Wd,new Promise((t,n)=>{ua(this,$m,t,"f"),ua(this,Hd,n,"f")}),"f"),Gt(this,Dm,"f").catch(()=>{}),Gt(this,Wd,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},Gt(this,MS,"m",k6).bind(this))},0)}_connected(){this.ended||(Gt(this,Lm,"f").call(this),this._emit("connect"))}get ended(){return Gt(this,qd,"f")}get errored(){return Gt(this,Fm,"f")}get aborted(){return Gt(this,Bm,"f")}abort(){this.controller.abort()}on(t,n){return(Gt(this,Lo,"f")[t]||(Gt(this,Lo,"f")[t]=[])).push({listener:n}),this}off(t,n){const r=Gt(this,Lo,"f")[t];if(!r)return this;const a=r.findIndex(o=>o.listener===n);return a>=0&&r.splice(a,1),this}once(t,n){return(Gt(this,Lo,"f")[t]||(Gt(this,Lo,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,r)=>{ua(this,Hc,!0,"f"),t!=="error"&&this.once("error",r),this.once(t,n)})}async done(){ua(this,Hc,!0,"f"),await Gt(this,Wd,"f")}_emit(t,...n){if(Gt(this,qd,"f"))return;t==="end"&&(ua(this,qd,!0,"f"),Gt(this,$m,"f").call(this));const r=Gt(this,Lo,"f")[t];if(r&&(Gt(this,Lo,"f")[t]=r.filter(a=>!a.once),r.forEach(({listener:a})=>a(...n))),t==="abort"){const a=n[0];!Gt(this,Hc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Gt(this,Vd,"f").call(this,a),Gt(this,Hd,"f").call(this,a),this._emit("end");return}if(t==="error"){const a=n[0];!Gt(this,Hc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Gt(this,Vd,"f").call(this,a),Gt(this,Hd,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Dm=new WeakMap,Lm=new WeakMap,Vd=new WeakMap,Wd=new WeakMap,$m=new WeakMap,Hd=new WeakMap,Lo=new WeakMap,qd=new WeakMap,Fm=new WeakMap,Bm=new WeakMap,Hc=new WeakMap,MS=new WeakSet,k6=function(e){if(ua(this,Fm,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Ar),e instanceof Ar)return ua(this,Bm,!0,"f"),this._emit("abort",e);if(e instanceof ct)return this._emit("error",e);if(e instanceof Error){const t=new ct(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new ct(String(e)))};function Kpe(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function N6(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function Xpe(e,{parser:t,callback:n}){const r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function Zd(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function Ype(e,t){return!t||!M6(t)?{...e,choices:e.choices.map(n=>({...n,message:{...n.message,parsed:null,tool_calls:n.message.tool_calls??[]}}))}:AS(e,t)}function AS(e,t){const n=e.choices.map(r=>{var a;if(r.finish_reason==="length")throw new r6;if(r.finish_reason==="content_filter")throw new a6;return{...r,message:{...r.message,tool_calls:((a=r.message.tool_calls)==null?void 0:a.map(o=>Qpe(t,o)))??[],parsed:r.message.content&&!r.message.refusal?Jpe(t,r.message.content):null}}});return{...e,choices:n}}function Jpe(e,t){var n,r;return((n=e.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=e.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function Qpe(e,t){var r;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:Zd(n)?n.$parseRaw(t.function.arguments):n!=null&&n.function.strict?JSON.parse(t.function.arguments):null}}}function Gpe(e,t){var r;if(!e)return!1;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return Zd(n)||(n==null?void 0:n.function.strict)||!1}function M6(e){var t;return N6(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(n=>Zd(n)||n.type==="function"&&n.function.strict===!0))??!1}function ehe(e){for(const t of e??[]){if(t.type!=="function")throw new ct(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new ct(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var ir=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Ln,TS,zm,RS,IS,DS,A6,LS;const T6=10;class R6 extends P6{constructor(){super(...arguments),Ln.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var r;this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=(r=t.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),(O6(t)||C6(t))&&t.content)this._emit("functionCallResult",t.content);else if(Wc(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(Wc(t)&&t.tool_calls)for(const r of t.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new ct("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),ir(this,Ln,"m",TS).call(this)}async finalMessage(){return await this.done(),ir(this,Ln,"m",zm).call(this)}async finalFunctionCall(){return await this.done(),ir(this,Ln,"m",RS).call(this)}async finalFunctionCallResult(){return await this.done(),ir(this,Ln,"m",IS).call(this)}async totalUsage(){return await this.done(),ir(this,Ln,"m",DS).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=ir(this,Ln,"m",zm).call(this);n&&this._emit("finalMessage",n);const r=ir(this,Ln,"m",TS).call(this);r&&this._emit("finalContent",r);const a=ir(this,Ln,"m",RS).call(this);a&&this._emit("finalFunctionCall",a);const o=ir(this,Ln,"m",IS).call(this);o!=null&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",ir(this,Ln,"m",DS).call(this))}async _createChatCompletion(t,n,r){const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ir(this,Ln,"m",A6).call(this,n);const o=await t.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(AS(o,n))}async _runChatCompletion(t,n,r){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(t,n,r)}async _runFunctions(t,n,r){var f;const a="function",{function_call:o="auto",stream:i,...s}=n,c=typeof o!="string"&&(o==null?void 0:o.name),{maxChatCompletions:l=T6}=r||{},u={};for(const p of n.functions)u[p.name||p.function.name]=p;const d=n.functions.map(p=>({name:p.name||p.function.name,parameters:p.parameters,description:p.description}));for(const p of n.messages)this._addMessage(p,!1);for(let p=0;p<l;++p){const m=(f=(await this._createChatCompletion(t,{...s,function_call:o,functions:d,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!m)throw new ct("missing message in ChatCompletion response");if(!m.function_call)return;const{name:y,arguments:v}=m.function_call,b=u[y];if(b){if(c&&c!==y){const S=`Invalid function_call: ${JSON.stringify(y)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,name:y,content:S});continue}}else{const S=`Invalid function_call: ${JSON.stringify(y)}. Available options are: ${d.map(j=>JSON.stringify(j.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:y,content:S});continue}let w;try{w=E6(b)?await b.parse(v):v}catch(S){this._addMessage({role:a,name:y,content:S instanceof Error?S.message:String(S)});continue}const _=await b.function(w,this),x=ir(this,Ln,"m",LS).call(this,_);if(this._addMessage({role:a,name:y,content:x}),c)return}}async _runTools(t,n,r){var p,m,y;const a="tool",{tool_choice:o="auto",stream:i,...s}=n,c=typeof o!="string"&&((p=o==null?void 0:o.function)==null?void 0:p.name),{maxChatCompletions:l=T6}=r||{},u=n.tools.map(v=>{if(Zd(v)){if(!v.$callback)throw new ct("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),d={};for(const v of u)v.type==="function"&&(d[v.function.name||v.function.function.name]=v.function);const f="tools"in n?u.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<l;++v){const b=(m=(await this._createChatCompletion(t,{...s,tool_choice:o,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:m.message;if(!b)throw new ct("missing message in ChatCompletion response");if(!((y=b.tool_calls)!=null&&y.length))return;for(const w of b.tool_calls){if(w.type!=="function")continue;const _=w.id,{name:x,arguments:S}=w.function,j=d[x];if(j){if(c&&c!==x){const k=`Invalid tool_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:_,content:k});continue}}else{const k=`Invalid tool_call: ${JSON.stringify(x)}. Available options are: ${Object.keys(d).map(N=>JSON.stringify(N)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:_,content:k});continue}let E;try{E=E6(j)?await j.parse(S):S}catch(k){const N=k instanceof Error?k.message:String(k);this._addMessage({role:a,tool_call_id:_,content:N});continue}const O=await j.function(E,this),P=ir(this,Ln,"m",LS).call(this,O);if(this._addMessage({role:a,tool_call_id:_,content:P}),c)return}}}}Ln=new WeakSet,TS=function(){return ir(this,Ln,"m",zm).call(this).content??null},zm=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Wc(t)){const{function_call:n,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new ct("stream ended without producing a ChatCompletionMessage with role=assistant")},RS=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(Wc(r)&&(r!=null&&r.function_call))return r.function_call;if(Wc(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},IS=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(O6(t)&&t.content!=null||C6(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},DS=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},A6=function(e){if(e.n!=null&&e.n>1)throw new ct("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},LS=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Kd extends R6{static runFunctions(t,n,r){const a=new Kd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new Kd,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}_addMessage(t,n=!0){super._addMessage(t,n),Wc(t)&&t.content&&this._emit("content",t.content)}}const I6=1,D6=2,L6=4,$6=8,F6=16,B6=32,z6=64,U6=128,V6=256,W6=U6|V6,H6=F6|B6|W6|z6,q6=I6|D6|H6,Z6=L6|$6,the=q6|Z6,wn={STR:I6,NUM:D6,ARR:L6,OBJ:$6,NULL:F6,BOOL:B6,NAN:z6,INFINITY:U6,MINUS_INFINITY:V6,INF:W6,SPECIAL:H6,ATOM:q6,COLLECTION:Z6,ALL:the};class nhe extends Error{}class rhe extends Error{}function ahe(e,t=wn.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return ohe(e.trim(),t)}const ohe=(e,t)=>{const n=e.length;let r=0;const a=f=>{throw new nhe(`${f} at position ${r}`)},o=f=>{throw new rhe(`${f} at position ${r}`)},i=()=>(d(),r>=n&&a("Unexpected end of input"),e[r]==='"'?s():e[r]==="{"?c():e[r]==="["?l():e.substring(r,r+4)==="null"||wn.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):e.substring(r,r+4)==="true"||wn.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):e.substring(r,r+5)==="false"||wn.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):e.substring(r,r+8)==="Infinity"||wn.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):e.substring(r,r+9)==="-Infinity"||wn.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):e.substring(r,r+3)==="NaN"||wn.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),s=()=>{const f=r;let p=!1;for(r++;r<n&&(e[r]!=='"'||p&&e[r-1]==="\\");)p=e[r]==="\\"?!p:!1,r++;if(e.charAt(r)=='"')try{return JSON.parse(e.substring(f,++r-Number(p)))}catch(m){o(String(m))}else if(wn.STR&t)try{return JSON.parse(e.substring(f,r-Number(p))+'"')}catch{return JSON.parse(e.substring(f,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{r++,d();const f={};try{for(;e[r]!=="}";){if(d(),r>=n&&wn.OBJ&t)return f;const p=s();d(),r++;try{const m=i();Object.defineProperty(f,p,{value:m,writable:!0,enumerable:!0,configurable:!0})}catch(m){if(wn.OBJ&t)return f;throw m}d(),e[r]===","&&r++}}catch{if(wn.OBJ&t)return f;a("Expected '}' at end of object")}return r++,f},l=()=>{r++;const f=[];try{for(;e[r]!=="]";)f.push(i()),d(),e[r]===","&&r++}catch{if(wn.ARR&t)return f;a("Expected ']' at end of array")}return r++,f},u=()=>{if(r===0){e==="-"&&wn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(p){if(wn.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}o(String(p))}}const f=r;for(e[r]==="-"&&r++;e[r]&&!",]}".includes(e[r]);)r++;r==n&&!(wn.NUM&t)&&a("Unterminated number literal");try{return JSON.parse(e.substring(f,r))}catch{e.substring(f,r)==="-"&&wn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e.substring(f,e.lastIndexOf("e")))}catch(p){o(String(p))}}},d=()=>{for(;r<n&&` 
\r	`.includes(e[r]);)r++};return i()},K6=e=>ahe(e,wn.ALL^wn.NUM);var qc=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Dt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},mn,$o,Zc,_i,$S,Um,FS,BS,zS,Vm,US,X6;class Xd extends R6{constructor(t){super(),mn.add(this),$o.set(this,void 0),Zc.set(this,void 0),_i.set(this,void 0),qc(this,$o,t,"f"),qc(this,Zc,[],"f")}get currentChatCompletionSnapshot(){return Dt(this,_i,"f")}static fromReadableStream(t){const n=new Xd(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,r){const a=new Xd(n);return a._run(()=>a._runChatCompletion(t,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(t,n,r){var i;super._createChatCompletion;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Dt(this,mn,"m",$S).call(this);const o=await t.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const s of o)Dt(this,mn,"m",FS).call(this,s);if((i=o.controller.signal)!=null&&i.aborted)throw new Ar;return this._addChatCompletion(Dt(this,mn,"m",Vm).call(this))}async _fromReadableStream(t,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Dt(this,mn,"m",$S).call(this),this._connected();const a=Bd.fromReadableStream(t,this.controller);let o;for await(const s of a)o&&o!==s.id&&this._addChatCompletion(Dt(this,mn,"m",Vm).call(this)),Dt(this,mn,"m",FS).call(this,s),o=s.id;if((i=a.controller.signal)!=null&&i.aborted)throw new Ar;return this._addChatCompletion(Dt(this,mn,"m",Vm).call(this))}[($o=new WeakMap,Zc=new WeakMap,_i=new WeakMap,mn=new WeakSet,$S=function(){this.ended||qc(this,_i,void 0,"f")},Um=function(t){let n=Dt(this,Zc,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Dt(this,Zc,"f")[t.index]=n,n)},FS=function(t){var r,a,o,i,s,c,l,u,d,f,p,m,y,v,b;if(this.ended)return;const n=Dt(this,mn,"m",X6).call(this,t);this._emit("chunk",t,n);for(const w of t.choices){const _=n.choices[w.index];w.delta.content!=null&&((r=_.message)==null?void 0:r.role)==="assistant"&&((a=_.message)!=null&&a.content)&&(this._emit("content",w.delta.content,_.message.content),this._emit("content.delta",{delta:w.delta.content,snapshot:_.message.content,parsed:_.message.parsed})),w.delta.refusal!=null&&((o=_.message)==null?void 0:o.role)==="assistant"&&((i=_.message)!=null&&i.refusal)&&this._emit("refusal.delta",{delta:w.delta.refusal,snapshot:_.message.refusal}),((s=w.logprobs)==null?void 0:s.content)!=null&&((c=_.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(l=w.logprobs)==null?void 0:l.content,snapshot:((u=_.logprobs)==null?void 0:u.content)??[]}),((d=w.logprobs)==null?void 0:d.refusal)!=null&&((f=_.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(p=w.logprobs)==null?void 0:p.refusal,snapshot:((m=_.logprobs)==null?void 0:m.refusal)??[]});const x=Dt(this,mn,"m",Um).call(this,_);_.finish_reason&&(Dt(this,mn,"m",zS).call(this,_),x.current_tool_call_index!=null&&Dt(this,mn,"m",BS).call(this,_,x.current_tool_call_index));for(const S of w.delta.tool_calls??[])x.current_tool_call_index!==S.index&&(Dt(this,mn,"m",zS).call(this,_),x.current_tool_call_index!=null&&Dt(this,mn,"m",BS).call(this,_,x.current_tool_call_index)),x.current_tool_call_index=S.index;for(const S of w.delta.tool_calls??[]){const j=(y=_.message.tool_calls)==null?void 0:y[S.index];j!=null&&j.type&&((j==null?void 0:j.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=j.function)==null?void 0:v.name,index:S.index,arguments:j.function.arguments,parsed_arguments:j.function.parsed_arguments,arguments_delta:((b=S.function)==null?void 0:b.arguments)??""}):j==null||j.type)}}},BS=function(t,n){var a,o,i;if(Dt(this,mn,"m",Um).call(this,t).done_tool_calls.has(n))return;const r=(a=t.message.tool_calls)==null?void 0:a[n];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const s=(i=(o=Dt(this,$o,"f"))==null?void 0:o.tools)==null?void 0:i.find(c=>c.type==="function"&&c.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:n,arguments:r.function.arguments,parsed_arguments:Zd(s)?s.$parseRaw(r.function.arguments):s!=null&&s.function.strict?JSON.parse(r.function.arguments):null})}else r.type},zS=function(t){var r,a;const n=Dt(this,mn,"m",Um).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const o=Dt(this,mn,"m",US).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Vm=function(){if(this.ended)throw new ct("stream has ended, this shouldn't happen");const t=Dt(this,_i,"f");if(!t)throw new ct("request ended without sending any chunks");return qc(this,_i,void 0,"f"),qc(this,Zc,[],"f"),ihe(t,Dt(this,$o,"f"))},US=function(){var n;const t=(n=Dt(this,$o,"f"))==null?void 0:n.response_format;return N6(t)?t:null},X6=function(t){var n,r,a,o;let i=Dt(this,_i,"f");const{choices:s,...c}=t;i?Object.assign(i,c):i=qc(this,_i,{...c,choices:[]},"f");for(const{delta:l,finish_reason:u,index:d,logprobs:f=null,...p}of t.choices){let m=i.choices[d];if(m||(m=i.choices[d]={finish_reason:u,index:d,message:{},logprobs:f,...p}),f)if(!m.logprobs)m.logprobs=Object.assign({},f);else{const{content:S,refusal:j,...E}=f;Object.assign(m.logprobs,E),S&&((n=m.logprobs).content??(n.content=[]),m.logprobs.content.push(...S)),j&&((r=m.logprobs).refusal??(r.refusal=[]),m.logprobs.refusal.push(...j))}if(u&&(m.finish_reason=u,Dt(this,$o,"f")&&M6(Dt(this,$o,"f")))){if(u==="length")throw new r6;if(u==="content_filter")throw new a6}if(Object.assign(m,p),!l)continue;const{content:y,refusal:v,function_call:b,role:w,tool_calls:_,...x}=l;if(Object.assign(m.message,x),v&&(m.message.refusal=(m.message.refusal||"")+v),w&&(m.message.role=w),b&&(m.message.function_call?(b.name&&(m.message.function_call.name=b.name),b.arguments&&((a=m.message.function_call).arguments??(a.arguments=""),m.message.function_call.arguments+=b.arguments)):m.message.function_call=b),y&&(m.message.content=(m.message.content||"")+y,!m.message.refusal&&Dt(this,mn,"m",US).call(this)&&(m.message.parsed=K6(m.message.content))),_){m.message.tool_calls||(m.message.tool_calls=[]);for(const{index:S,id:j,type:E,function:O,...P}of _){const k=(o=m.message.tool_calls)[S]??(o[S]={});Object.assign(k,P),j&&(k.id=j),E&&(k.type=E),O&&(k.function??(k.function={name:O.name??"",arguments:""})),O!=null&&O.name&&(k.function.name=O.name),O!=null&&O.arguments&&(k.function.arguments+=O.arguments,Gpe(Dt(this,$o,"f"),k)&&(k.function.parsed_arguments=K6(k.function.arguments)))}}}return i},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("chunk",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Bd(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function ihe(e,t){const{id:n,choices:r,created:a,model:o,system_fingerprint:i,...s}=e,c={...s,id:n,choices:r.map(({message:l,finish_reason:u,index:d,logprobs:f,...p})=>{if(!u)throw new ct(`missing finish_reason for choice ${d}`);const{content:m=null,function_call:y,tool_calls:v,...b}=l,w=l.role;if(!w)throw new ct(`missing role for choice ${d}`);if(y){const{arguments:_,name:x}=y;if(_==null)throw new ct(`missing function_call.arguments for choice ${d}`);if(!x)throw new ct(`missing function_call.name for choice ${d}`);return{...p,message:{content:m,function_call:{arguments:_,name:x},role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:f}}return v?{...p,index:d,finish_reason:u,logprobs:f,message:{...b,role:w,content:m,refusal:l.refusal??null,tool_calls:v.map((_,x)=>{const{function:S,type:j,id:E,...O}=_,{arguments:P,name:k,...N}=S||{};if(E==null)throw new ct(`missing choices[${d}].tool_calls[${x}].id
${Wm(e)}`);if(j==null)throw new ct(`missing choices[${d}].tool_calls[${x}].type
${Wm(e)}`);if(k==null)throw new ct(`missing choices[${d}].tool_calls[${x}].function.name
${Wm(e)}`);if(P==null)throw new ct(`missing choices[${d}].tool_calls[${x}].function.arguments
${Wm(e)}`);return{...O,id:E,type:j,function:{...N,name:k,arguments:P}}})}}:{...p,message:{...b,content:m,role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:f}}),created:a,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Ype(c,t)}function Wm(e){return JSON.stringify(e)}class Kc extends Xd{static fromReadableStream(t){const n=new Kc(null);return n._run(()=>n._fromReadableStream(t)),n}static runFunctions(t,n,r){const a=new Kc(null),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new Kc(n),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}}let Y6=class extends xt{parse(e,t){return ehe(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>AS(n,e))}runFunctions(e,t){return e.stream?Kc.runFunctions(this._client,e,t):Kd.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Kc.runTools(this._client,e,t):Kd.runTools(this._client,e,t)}stream(e,t){return Xd.createChatCompletion(this._client,e,t)}},VS=class extends xt{constructor(){super(...arguments),this.completions=new Y6(this._client)}};(function(e){e.Completions=Y6})(VS||(VS={}));class J6 extends xt{create(t,n){return this._client.post("/realtime/sessions",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class WS extends xt{constructor(){super(...arguments),this.sessions=new J6(this._client)}}WS.Sessions=J6;var Fe=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Sr=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Nn,HS,Qa,Hm,da,ms,Xc,ys,qm,jr,Zm,Km,Yd,Jd,Qd,Q6,G6,e8,t8,n8,r8,a8;class fa extends P6{constructor(){super(...arguments),Nn.add(this),HS.set(this,[]),Qa.set(this,{}),Hm.set(this,{}),da.set(this,void 0),ms.set(this,void 0),Xc.set(this,void 0),ys.set(this,void 0),qm.set(this,void 0),jr.set(this,void 0),Zm.set(this,void 0),Km.set(this,void 0),Yd.set(this,void 0)}[(HS=new WeakMap,Qa=new WeakMap,Hm=new WeakMap,da=new WeakMap,ms=new WeakMap,Xc=new WeakMap,ys=new WeakMap,qm=new WeakMap,jr=new WeakMap,Zm=new WeakMap,Km=new WeakMap,Yd=new WeakMap,Nn=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("event",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new fa;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Bd.fromReadableStream(t,this.controller);for await(const i of a)Fe(this,Nn,"m",Jd).call(this,i);if((o=a.controller.signal)!=null&&o.aborted)throw new Ar;return this._addRun(Fe(this,Nn,"m",Qd).call(this))}toReadableStream(){return new Bd(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,r,a,o){const i=new fa;return i._run(()=>i._runToolAssistantStream(t,n,r,a,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(t,n,r,a,o){var l;const i=o==null?void 0:o.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...a,stream:!0},c=await t.submitToolOutputs(n,r,s,{...o,signal:this.controller.signal});this._connected();for await(const u of c)Fe(this,Nn,"m",Jd).call(this,u);if((l=c.controller.signal)!=null&&l.aborted)throw new Ar;return this._addRun(Fe(this,Nn,"m",Qd).call(this))}static createThreadAssistantStream(t,n,r){const a=new fa;return a._run(()=>a._threadAssistantStream(t,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(t,n,r,a){const o=new fa;return o._run(()=>o._runAssistantStream(t,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return Fe(this,Zm,"f")}currentRun(){return Fe(this,Km,"f")}currentMessageSnapshot(){return Fe(this,da,"f")}currentRunStepSnapshot(){return Fe(this,Yd,"f")}async finalRunSteps(){return await this.done(),Object.values(Fe(this,Qa,"f"))}async finalMessages(){return await this.done(),Object.values(Fe(this,Hm,"f"))}async finalRun(){if(await this.done(),!Fe(this,ms,"f"))throw Error("Final run was not received.");return Fe(this,ms,"f")}async _createThreadAssistantStream(t,n,r){var s;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},i=await t.createAndRun(o,{...r,signal:this.controller.signal});this._connected();for await(const c of i)Fe(this,Nn,"m",Jd).call(this,c);if((s=i.controller.signal)!=null&&s.aborted)throw new Ar;return this._addRun(Fe(this,Nn,"m",Qd).call(this))}async _createAssistantStream(t,n,r,a){var c;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},s=await t.create(n,i,{...a,signal:this.controller.signal});this._connected();for await(const l of s)Fe(this,Nn,"m",Jd).call(this,l);if((c=s.controller.signal)!=null&&c.aborted)throw new Ar;return this._addRun(Fe(this,Nn,"m",Qd).call(this))}static accumulateDelta(t,n){for(const[r,a]of Object.entries(n)){if(!t.hasOwnProperty(r)){t[r]=a;continue}let o=t[r];if(o==null){t[r]=a;continue}if(r==="index"||r==="type"){t[r]=a;continue}if(typeof o=="string"&&typeof a=="string")o+=a;else if(typeof o=="number"&&typeof a=="number")o+=a;else if(ES(o)&&ES(a))o=this.accumulateDelta(o,a);else if(Array.isArray(o)&&Array.isArray(a)){if(o.every(i=>typeof i=="string"||typeof i=="number")){o.push(...a);continue}for(const i of a){if(!ES(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const s=i.index;if(s==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof s!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const c=o[s];c==null?o.push(i):o[s]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${o}`);t[r]=o}return t}_addRun(t){return t}async _threadAssistantStream(t,n,r){return await this._createThreadAssistantStream(n,t,r)}async _runAssistantStream(t,n,r,a){return await this._createAssistantStream(n,t,r,a)}async _runToolAssistantStream(t,n,r,a,o){return await this._createToolAssistantStream(r,t,n,a,o)}}Jd=function(e){if(!this.ended)switch(Sr(this,Zm,e,"f"),Fe(this,Nn,"m",e8).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Fe(this,Nn,"m",a8).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Fe(this,Nn,"m",G6).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Fe(this,Nn,"m",Q6).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Qd=function(){if(this.ended)throw new ct("stream has ended, this shouldn't happen");if(!Fe(this,ms,"f"))throw Error("Final run has not been received");return Fe(this,ms,"f")},Q6=function(e){const[t,n]=Fe(this,Nn,"m",n8).call(this,e,Fe(this,da,"f"));Sr(this,da,t,"f"),Fe(this,Hm,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,o=t.content[r.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=Fe(this,Xc,"f")){if(Fe(this,ys,"f"))switch(Fe(this,ys,"f").type){case"text":this._emit("textDone",Fe(this,ys,"f").text,Fe(this,da,"f"));break;case"image_file":this._emit("imageFileDone",Fe(this,ys,"f").image_file,Fe(this,da,"f"));break}Sr(this,Xc,r.index,"f")}Sr(this,ys,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Fe(this,Xc,"f")!==void 0){const r=e.data.content[Fe(this,Xc,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,Fe(this,da,"f"));break;case"text":this._emit("textDone",r.text,Fe(this,da,"f"));break}}Fe(this,da,"f")&&this._emit("messageDone",e.data),Sr(this,da,void 0,"f")}},G6=function(e){const t=Fe(this,Nn,"m",t8).call(this,e);switch(Sr(this,Yd,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const r of n.step_details.tool_calls)r.index==Fe(this,qm,"f")?this._emit("toolCallDelta",r,t.step_details.tool_calls[r.index]):(Fe(this,jr,"f")&&this._emit("toolCallDone",Fe(this,jr,"f")),Sr(this,qm,r.index,"f"),Sr(this,jr,t.step_details.tool_calls[r.index],"f"),Fe(this,jr,"f")&&this._emit("toolCallCreated",Fe(this,jr,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Sr(this,Yd,void 0,"f"),e.data.step_details.type=="tool_calls"&&Fe(this,jr,"f")&&(this._emit("toolCallDone",Fe(this,jr,"f")),Sr(this,jr,void 0,"f")),this._emit("runStepDone",e.data,t);break}},e8=function(e){Fe(this,HS,"f").push(e),this._emit("event",e)},t8=function(e){switch(e.event){case"thread.run.step.created":return Fe(this,Qa,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Fe(this,Qa,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=fa.accumulateDelta(t,n.delta);Fe(this,Qa,"f")[e.data.id]=r}return Fe(this,Qa,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Fe(this,Qa,"f")[e.data.id]=e.data;break}if(Fe(this,Qa,"f")[e.data.id])return Fe(this,Qa,"f")[e.data.id];throw new Error("No snapshot available")},n8=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let o=t.content[a.index];t.content[a.index]=Fe(this,Nn,"m",r8).call(this,a,o)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},r8=function(e,t){return fa.accumulateDelta(t,e)},a8=function(e){switch(Sr(this,Km,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Sr(this,ms,e.data,"f"),Fe(this,jr,"f")&&(this._emit("toolCallDone",Fe(this,jr,"f")),Sr(this,jr,void 0,"f"));break}};class qS extends xt{create(t,n,r){return this._client.post(`/threads/${t}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/messages/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return or(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/messages`,ZS,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n,r){return this._client.delete(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class ZS extends la{}qS.MessagesPage=ZS;class KS extends xt{retrieve(t,n,r,a={},o){return or(a)?this.retrieve(t,n,r,{},a):this._client.get(`/threads/${t}/runs/${n}/steps/${r}`,{query:a,...o,headers:{"OpenAI-Beta":"assistants=v2",...o==null?void 0:o.headers}})}list(t,n,r={},a){return or(r)?this.list(t,n,{},r):this._client.getAPIList(`/threads/${t}/runs/${n}/steps`,XS,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class XS extends la{}KS.RunStepsPage=XS;class Gd extends xt{constructor(){super(...arguments),this.steps=new KS(this._client)}create(t,n,r){const{include:a,...o}=n;return this._client.post(`/threads/${t}/runs`,{query:{include:a},body:o,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(t,n,r){return this._client.get(`/threads/${t}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return or(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/runs`,YS,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/threads/${t}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n,r);return await this.poll(t,a.id,r)}createAndStream(t,n,r){return fa.createAssistantStream(t,this._client.beta.threads.runs,n,r)}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:{...r==null?void 0:r.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await zd(s);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,n,r){return fa.createAssistantStream(t,this._client.beta.threads.runs,n,r)}submitToolOutputs(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}/submit_tool_outputs`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(t,n,r,a){const o=await this.submitToolOutputs(t,n,r,a);return await this.poll(t,o.id,a)}submitToolOutputsStream(t,n,r,a){return fa.createToolAssistantStream(t,n,this._client.beta.threads.runs,r,a)}}class YS extends la{}Gd.RunsPage=YS,Gd.Steps=KS,Gd.RunStepsPage=XS;class Yc extends xt{constructor(){super(...arguments),this.runs=new Gd(this._client),this.messages=new qS(this._client)}create(t={},n){return or(t)?this.create({},t):this._client.post("/threads",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/threads/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n){return this._client.delete(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}async createAndRunPoll(t,n){const r=await this.createAndRun(t,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(t,n){return fa.createThreadAssistantStream(t,this._client.beta.threads,n)}}Yc.Runs=Gd,Yc.RunsPage=YS,Yc.Messages=qS,Yc.MessagesPage=ZS;const she=async e=>{const t=await Promise.allSettled(e),n=t.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const a of t)a.status==="fulfilled"&&r.push(a.value);return r};let JS=class extends xt{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return or(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Xm,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for((n==null?void 0:n.pollIntervalMs)&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),o=a.data;switch(o.status){case"in_progress":let i=5e3;if(n!=null&&n.pollIntervalMs)i=n.pollIntervalMs;else{const s=a.response.headers.get("openai-poll-after-ms");if(s){const c=parseInt(s);isNaN(c)||(i=c)}}await zd(i);break;case"failed":case"completed":return o}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}};class Xm extends la{}JS.VectorStoreFilesPage=Xm;class o8 extends xt{create(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/vector_stores/${t}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n);return await this.poll(t,a.id,r)}listFiles(t,n,r={},a){return or(r)?this.listFiles(t,n,{},r):this._client.getAPIList(`/vector_stores/${t}/file_batches/${n}/files`,Xm,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:a}).withResponse();switch(o.status){case"in_progress":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await zd(s);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:n,fileIds:r=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=(a==null?void 0:a.maxConcurrency)??5,i=Math.min(o,n.length),s=this._client,c=n.values(),l=[...r];async function u(f){for(let p of f){const m=await s.files.create({file:p,purpose:"assistants"},a);l.push(m.id)}}const d=Array(i).fill(c).map(u);return await she(d),await this.createAndPoll(t,{file_ids:l})}}class Jc extends xt{constructor(){super(...arguments),this.files=new JS(this._client),this.fileBatches=new o8(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/vector_stores/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return or(t)?this.list({},t):this._client.getAPIList("/vector_stores",QS,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class QS extends la{}Jc.VectorStoresPage=QS,Jc.Files=JS,Jc.VectorStoreFilesPage=Xm,Jc.FileBatches=o8;class Si extends xt{constructor(){super(...arguments),this.realtime=new WS(this._client),this.vectorStores=new Jc(this._client),this.chat=new VS(this._client),this.assistants=new PS(this._client),this.threads=new Yc(this._client)}}Si.Realtime=WS,Si.VectorStores=Jc,Si.VectorStoresPage=QS,Si.Assistants=PS,Si.AssistantsPage=NS,Si.Threads=Yc;let i8=class extends xt{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}},s8=class extends xt{create(e,t){return this._client.post("/embeddings",{body:e,...t})}};class GS extends xt{create(t,n){return this._client.post("/files",zc({body:t,...n}))}retrieve(t,n){return this._client.get(`/files/${t}`,n)}list(t={},n){return or(t)?this.list({},t):this._client.getAPIList("/files",ej,{query:t,...n})}del(t,n){return this._client.delete(`/files/${t}`,n)}content(t,n){return this._client.get(`/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(t,n){return this._client.get(`/files/${t}/content`,n)}async waitForProcessing(t,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),o=Date.now();let i=await this.retrieve(t);for(;!i.status||!a.has(i.status);)if(await zd(n),i=await this.retrieve(t),Date.now()-o>r)throw new Mm({message:`Giving up on waiting for file ${t} to finish processing after ${r} milliseconds.`});return i}}class ej extends la{}GS.FileObjectsPage=ej;class tj extends xt{list(t,n={},r){return or(n)?this.list(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,nj,{query:n,...r})}}class nj extends la{}tj.FineTuningJobCheckpointsPage=nj;class Qc extends xt{constructor(){super(...arguments),this.checkpoints=new tj(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(`/fine_tuning/jobs/${t}`,n)}list(t={},n){return or(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",rj,{query:t,...n})}cancel(t,n){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},r){return or(n)?this.listEvents(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,aj,{query:n,...r})}}class rj extends la{}class aj extends la{}Qc.FineTuningJobsPage=rj,Qc.FineTuningJobEventsPage=aj,Qc.Checkpoints=tj,Qc.FineTuningJobCheckpointsPage=nj;class ef extends xt{constructor(){super(...arguments),this.jobs=new Qc(this._client)}}ef.Jobs=Qc,ef.FineTuningJobsPage=rj,ef.FineTuningJobEventsPage=aj;class c8 extends xt{createVariation(t,n){return this._client.post("/images/variations",zc({body:t,...n}))}edit(t,n){return this._client.post("/images/edits",zc({body:t,...n}))}generate(t,n){return this._client.post("/images/generations",{body:t,...n})}}let oj=class extends xt{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",ij,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}};class ij extends Zpe{}oj.ModelsPage=ij;class l8 extends xt{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class u8 extends xt{create(t,n,r){return this._client.post(`/uploads/${t}/parts`,zc({body:n,...r}))}}class sj extends xt{constructor(){super(...arguments),this.parts=new u8(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(`/uploads/${t}/cancel`,n)}complete(t,n,r){return this._client.post(`/uploads/${t}/complete`,{body:n,...r})}}sj.Parts=u8;var d8;let pt=class extends Rpe{constructor({baseURL:e=Im("OPENAI_BASE_URL"),apiKey:t=Im("OPENAI_API_KEY"),organization:n=Im("OPENAI_ORG_ID")??null,project:r=Im("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new ct("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&Hpe())throw new ct(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new i8(this),this.chat=new OS(this),this.embeddings=new s8(this),this.files=new GS(this),this.images=new c8(this),this.audio=new Ud(this),this.moderations=new l8(this),this.models=new oj(this),this.fineTuning=new ef(this),this.beta=new Si(this),this.batches=new CS(this),this.uploads=new sj(this),this._options=o,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return gpe(e,{arrayFormat:"brackets"})}};d8=pt,pt.OpenAI=d8,pt.DEFAULT_TIMEOUT=6e5,pt.OpenAIError=ct,pt.APIError=ar,pt.APIConnectionError=Nm,pt.APIConnectionTimeoutError=Mm,pt.APIUserAbortError=Ar,pt.NotFoundError=Q$,pt.ConflictError=G$,pt.RateLimitError=t6,pt.BadRequestError=X$,pt.AuthenticationError=Y$,pt.InternalServerError=n6,pt.PermissionDeniedError=J$,pt.UnprocessableEntityError=e6,pt.toFile=c6,pt.fileFromPath=Z$,pt.Completions=i8,pt.Chat=OS,pt.Embeddings=s8,pt.Files=GS,pt.FileObjectsPage=ej,pt.Images=c8,pt.Audio=Ud,pt.Moderations=l8,pt.Models=oj,pt.ModelsPage=ij,pt.FineTuning=ef,pt.Beta=Si,pt.Batches=CS,pt.BatchesPage=kS,pt.Uploads=sj;var che=typeof window=="object"?window:{},tt="0123456789abcdef".split(""),lhe=[-2147483648,8388608,32768,128],pa=[24,16,8,0],xn=[];function ha(e){e?(xn[0]=xn[16]=xn[1]=xn[2]=xn[3]=xn[4]=xn[5]=xn[6]=xn[7]=xn[8]=xn[9]=xn[10]=xn[11]=xn[12]=xn[13]=xn[14]=xn[15]=0,this.blocks=xn):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}ha.prototype.update=function(e){if(!this.finalized){var t=typeof e!="string";t&&e.constructor===che.ArrayBuffer&&(e=new Uint8Array(e));for(var n,r=0,a,o=e.length||0,i=this.blocks;r<o;){if(this.hashed&&(this.hashed=!1,i[0]=this.block,i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),t)for(a=this.start;r<o&&a<64;++r)i[a>>2]|=e[r]<<pa[a++&3];else for(a=this.start;r<o&&a<64;++r)n=e.charCodeAt(r),n<128?i[a>>2]|=n<<pa[a++&3]:n<2048?(i[a>>2]|=(192|n>>6)<<pa[a++&3],i[a>>2]|=(128|n&63)<<pa[a++&3]):n<55296||n>=57344?(i[a>>2]|=(224|n>>12)<<pa[a++&3],i[a>>2]|=(128|n>>6&63)<<pa[a++&3],i[a>>2]|=(128|n&63)<<pa[a++&3]):(n=65536+((n&1023)<<10|e.charCodeAt(++r)&1023),i[a>>2]|=(240|n>>18)<<pa[a++&3],i[a>>2]|=(128|n>>12&63)<<pa[a++&3],i[a>>2]|=(128|n>>6&63)<<pa[a++&3],i[a>>2]|=(128|n&63)<<pa[a++&3]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=i[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},ha.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=lhe[t&3],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},ha.prototype.hash=function(){var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4,o,i,s,c=this.blocks;for(i=16;i<80;++i)s=c[i-3]^c[i-8]^c[i-14]^c[i-16],c[i]=s<<1|s>>>31;for(i=0;i<20;i+=5)o=t&n|~t&r,s=e<<5|e>>>27,a=s+o+a+1518500249+c[i]<<0,t=t<<30|t>>>2,o=e&t|~e&n,s=a<<5|a>>>27,r=s+o+r+1518500249+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|~a&t,s=r<<5|r>>>27,n=s+o+n+1518500249+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|~r&e,s=n<<5|n>>>27,t=s+o+t+1518500249+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|~n&a,s=t<<5|t>>>27,e=s+o+e+1518500249+c[i+4]<<0,n=n<<30|n>>>2;for(;i<40;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a+1859775393+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r+1859775393+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n+1859775393+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t+1859775393+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e+1859775393+c[i+4]<<0,n=n<<30|n>>>2;for(;i<60;i+=5)o=t&n|t&r|n&r,s=e<<5|e>>>27,a=s+o+a-1894007588+c[i]<<0,t=t<<30|t>>>2,o=e&t|e&n|t&n,s=a<<5|a>>>27,r=s+o+r-1894007588+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|a&t|e&t,s=r<<5|r>>>27,n=s+o+n-1894007588+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|r&e|a&e,s=n<<5|n>>>27,t=s+o+t-1894007588+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|n&a|r&a,s=t<<5|t>>>27,e=s+o+e-1894007588+c[i+4]<<0,n=n<<30|n>>>2;for(;i<80;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a-899497514+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r-899497514+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n-899497514+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t-899497514+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e-899497514+c[i+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+a<<0},ha.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return tt[e>>28&15]+tt[e>>24&15]+tt[e>>20&15]+tt[e>>16&15]+tt[e>>12&15]+tt[e>>8&15]+tt[e>>4&15]+tt[e&15]+tt[t>>28&15]+tt[t>>24&15]+tt[t>>20&15]+tt[t>>16&15]+tt[t>>12&15]+tt[t>>8&15]+tt[t>>4&15]+tt[t&15]+tt[n>>28&15]+tt[n>>24&15]+tt[n>>20&15]+tt[n>>16&15]+tt[n>>12&15]+tt[n>>8&15]+tt[n>>4&15]+tt[n&15]+tt[r>>28&15]+tt[r>>24&15]+tt[r>>20&15]+tt[r>>16&15]+tt[r>>12&15]+tt[r>>8&15]+tt[r>>4&15]+tt[r&15]+tt[a>>28&15]+tt[a>>24&15]+tt[a>>20&15]+tt[a>>16&15]+tt[a>>12&15]+tt[a>>8&15]+tt[a>>4&15]+tt[a&15]},ha.prototype.toString=ha.prototype.hex,ha.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,a>>24&255,a>>16&255,a>>8&255,a&255]},ha.prototype.array=ha.prototype.digest,ha.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};const uhe=e=>new ha(!0).update(e).hex(),f8=(...e)=>uhe(e.join("_"));class dhe{}const fhe=new Map;class cj extends dhe{constructor(t){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=t??new Map}lookup(t,n){return Promise.resolve(this.cache.get(f8(t,n))??null)}async update(t,n,r){this.cache.set(f8(t,n),r)}static global(){return new cj(fhe)}}const phe=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e;function p8(e){return typeof e!="object"||!e?!1:!!("type"in e&&e.type==="function"&&"function"in e&&typeof e.function=="object"&&e.function&&"name"in e.function&&"parameters"in e.function)}const hhe=()=>!1;class mhe extends gp{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(t){super(t),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=t.verbose??hhe(),this.callbacks=t.callbacks,this.tags=t.tags??[],this.metadata=t.metadata??{}}}class yhe extends mhe{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:t,callbackManager:n,...r}){super({callbacks:t??n,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r.cache=="object"?this.cache=r.cache:r.cache?this.cache=cj.global():this.cache=void 0,this.caller=new r4e(r??{})}async getNumTokens(t){if(typeof t!="string")return 0;let n=Math.ceil(t.length/4);if(!this._encoding)try{this._encoding=await a4e("modelName"in this?phe(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{n=this._encoding.encode(t).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return n}static _convertInputToPromptValue(t){return typeof t=="string"?new O$(t):Array.isArray(t)?new Hfe(t.map(vp)):t}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:t,...n}){const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([a,o])=>o!==void 0).map(([a,o])=>`${a}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(t){throw new Error("Use .toJSON() instead")}}class ji extends gp{static lc_name(){return"RunnablePassthrough"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t&&(this.func=t.func)}async invoke(t,n){const r=BX(n);return this.func&&await this.func(t,r),this._callWithConfig(a=>Promise.resolve(a),t,r)}async*transform(t,n){const r=BX(n);let a,o=!0;for await(const i of this._transformStreamWithConfig(t,s=>s,r))if(yield i,o)if(a===void 0)a=i;else try{a=HP(a,i)}catch{a=void 0,o=!1}this.func&&a!==void 0&&await this.func(a,r)}static assign(t){return new o4e(new i4e({steps:t}))}}function Ym(e){return typeof(e==null?void 0:e.parse)=="function"}class Ga extends yhe{constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(t){const[n,r]=super._separateRunnableConfigFromCallOptions(t);return r.signal=n.signal,[n,r]}async invoke(t,n){const r=Ga._convertInputToPromptValue(t);return(await this.generatePrompt([r],n,n==null?void 0:n.callbacks)).generations[0][0].message}async*_streamResponseChunks(t,n,r){throw new Error("Not implemented.")}async*_streamIterator(t,n){var r;if(this._streamResponseChunks===Ga.prototype._streamResponseChunks)yield this.invoke(t,n);else{const a=Ga._convertInputToPromptValue(t).toChatMessages(),[o,i]=this._separateRunnableConfigFromCallOptionsCompat(n),s={...o.metadata,...this.getLsParams(i)},c=await qP.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),[a],o.runId,void 0,l,void 0,void 0,o.runName));let d;try{for await(const f of this._streamResponseChunks(a,i,u==null?void 0:u[0])){if(f.message.id==null){const p=(r=u==null?void 0:u.at(0))==null?void 0:r.runId;p!=null&&f.message._updateId(`run-${p}`)}f.message.response_metadata={...f.generationInfo,...f.message.response_metadata},yield f.message,d?d=d.concat(f):d=f}}catch(f){throw await Promise.all((u??[]).map(p=>p==null?void 0:p.handleLLMError(f))),f}await Promise.all((u??[]).map(f=>f==null?void 0:f.handleLLMEnd({generations:[[d]]})))}}getLsParams(t){return{ls_model_type:"chat",ls_stop:t.stop}}async _generateUncached(t,n,r){var f,p;const a=t.map(m=>m.map(vp)),o={...r.metadata,...this.getLsParams(n)},i=await qP.configure(r.callbacks,this.callbacks,r.tags,this.tags,o,this.metadata,{verbose:this.verbose}),s={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:1},c=await(i==null?void 0:i.handleChatModelStart(this.toJSON(),a,r.runId,void 0,s,void 0,void 0,r.runName)),l=[],u=[];if(c!=null&&c[0].handlers.find(m=>s4e(m)||c4e(m))&&a.length===1&&this._streamResponseChunks!==Ga.prototype._streamResponseChunks)try{const m=await this._streamResponseChunks(a[0],n,c==null?void 0:c[0]);let y;for await(const v of m){if(v.message.id==null){const b=(f=c==null?void 0:c.at(0))==null?void 0:f.runId;b!=null&&v.message._updateId(`run-${b}`)}y===void 0?y=v:y=HP(y,v)}if(y===void 0)throw new Error("Received empty response from chat model call.");l.push([y]),await(c==null?void 0:c[0].handleLLMEnd({generations:l,llmOutput:{}}))}catch(m){throw await(c==null?void 0:c[0].handleLLMError(m)),m}else{const m=await Promise.allSettled(a.map((y,v)=>this._generate(y,{...n,promptIndex:v},c==null?void 0:c[v])));await Promise.all(m.map(async(y,v)=>{var b,w,_;if(y.status==="fulfilled"){const x=y.value;for(const S of x.generations){if(S.message.id==null){const j=(b=c==null?void 0:c.at(0))==null?void 0:b.runId;j!=null&&S.message._updateId(`run-${j}`)}S.message.response_metadata={...S.generationInfo,...S.message.response_metadata}}return x.generations.length===1&&(x.generations[0].message.response_metadata={...x.llmOutput,...x.generations[0].message.response_metadata}),l[v]=x.generations,u[v]=x.llmOutput,(w=c==null?void 0:c[v])==null?void 0:w.handleLLMEnd({generations:[x.generations],llmOutput:x.llmOutput})}else return await((_=c==null?void 0:c[v])==null?void 0:_.handleLLMError(y.reason)),Promise.reject(y.reason)}))}const d={generations:l,llmOutput:u.length?(p=this._combineLLMOutput)==null?void 0:p.call(this,...u):void 0};return Object.defineProperty(d,zX,{value:c?{runIds:c==null?void 0:c.map(m=>m.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:t,cache:n,llmStringKey:r,parsedOptions:a,handledOptions:o}){const i=t.map(y=>y.map(vp)),s={...o.metadata,...this.getLsParams(a)},c=await qP.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1,cached:!0},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),i,o.runId,void 0,l,void 0,void 0,o.runName)),d=[],f=(await Promise.allSettled(i.map(async(y,v)=>{const b=Ga._convertInputToPromptValue(y).toString(),w=await n.lookup(b,r);return w==null&&d.push(v),w}))).map((y,v)=>({result:y,runManager:u==null?void 0:u[v]})).filter(({result:y})=>y.status==="fulfilled"&&y.value!=null||y.status==="rejected"),p=[];await Promise.all(f.map(async({result:y,runManager:v},b)=>{if(y.status==="fulfilled"){const w=y.value;return p[b]=w,w.length&&await(v==null?void 0:v.handleLLMNewToken(w[0].text)),v==null?void 0:v.handleLLMEnd({generations:[w]})}else return await(v==null?void 0:v.handleLLMError(y.reason)),Promise.reject(y.reason)}));const m={generations:p,missingPromptIndices:d};return Object.defineProperty(m,zX,{value:u?{runIds:u==null?void 0:u.map(y=>y.runId)}:void 0,configurable:!0}),m}async generate(t,n,r){let a;Array.isArray(n)?a={stop:n}:a=n;const o=t.map(p=>p.map(vp)),[i,s]=this._separateRunnableConfigFromCallOptionsCompat(a);if(i.callbacks=i.callbacks??r,!this.cache)return this._generateUncached(o,s,i);const{cache:c}=this,l=this._getSerializedCacheKeyParametersForCall(s),{generations:u,missingPromptIndices:d}=await this._generateCached({messages:o,cache:c,llmStringKey:l,parsedOptions:s,handledOptions:i});let f={};if(d.length>0){const p=await this._generateUncached(d.map(m=>o[m]),s,i);await Promise.all(p.generations.map(async(m,y)=>{const v=d[y];u[v]=m;const b=Ga._convertInputToPromptValue(o[v]).toString();return c.update(b,l,m)})),f=p.llmOutput??{}}return{generations:u,llmOutput:f}}invocationParams(t){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(t,n,r){const a=t.map(o=>o.toChatMessages());return this.generate(a,n,r)}async call(t,n,r){return(await this.generate([t.map(vp)],n,r)).generations[0][0].message}async callPrompt(t,n,r){const a=t.toChatMessages();return this.call(a,n,r)}async predictMessages(t,n,r){return this.call(t,n,r)}async predict(t,n,r){const a=new Vr(t),o=await this.call([a],n,r);if(typeof o.content!="string")throw new Error("Cannot use predict when output is not a string.");return o.content}withStructuredOutput(t,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');const r=t,a=n==null?void 0:n.name,o=r.description??"A function available to call.",i=n==null?void 0:n.method,s=n==null?void 0:n.includeRaw;if(i==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let c=a??"extract",l;Ym(r)?l=[{type:"function",function:{name:c,description:o,parameters:ZP(r)}}]:("name"in r&&(c=r.name),l=[{type:"function",function:{name:c,description:o,parameters:r}}]);const u=this.bindTools(l),d=l4e.from(y=>{if(!y.tool_calls||y.tool_calls.length===0)throw new Error("No tool calls found in the response.");const v=y.tool_calls.find(b=>b.name===c);if(!v)throw new Error(`No tool call found with name ${c}.`);return v.args});if(!s)return u.pipe(d).withConfig({runName:"StructuredOutput"});const f=ji.assign({parsed:(y,v)=>d.invoke(y.raw,v)}),p=ji.assign({parsed:()=>null}),m=f.withFallbacks({fallbacks:[p]});return Ov.from([{raw:u},m]).withConfig({runName:"StructuredOutputRunnable"})}}class ghe extends gp{parseResultWithPrompt(t,n,r){return this.parseResult(t,r)}_baseMessageToString(t){return typeof t.content=="string"?t.content:this._baseMessageContentToString(t.content)}_baseMessageContentToString(t){return JSON.stringify(t)}async invoke(t,n){return typeof t=="string"?this._callWithConfig(async(r,a)=>this.parseResult([{text:r}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"}):this._callWithConfig(async(r,a)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"})}}class h8 extends ghe{parseResult(t,n){return this.parse(t[0].text,n)}async parseWithPrompt(t,n,r){return this.parse(t,r)}_type(){throw new Error("_type not implemented")}}class lj extends Error{constructor(t,n,r,a=!1){if(super(t),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=r,this.sendToLLM=a,a&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}function uj(e,t){const n=typeof e;if(n!==typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;const r=e.length;if(r!==t.length)return!1;for(let a=0;a<r;a++)if(!uj(e[a],t[a]))return!1;return!0}if(n==="object"){if(!e||!t)return e===t;const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(const o of r)if(!uj(e[o],t[o]))return!1;return!0}return e===t}class vhe extends h8{async*_transform(t){for await(const n of t)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:this._baseMessageToString(n)}])}async*transform(t,n){yield*this._transformStreamWithConfig(t,this._transform.bind(this),{...n,runType:"parser"})}}class m8 extends vhe{constructor(t){super(t),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(t==null?void 0:t.diff)??this.diff}async*_transform(t){let n,r;for await(const a of t){if(typeof a!="string"&&typeof a.content!="string")throw new Error("Cannot handle non-string output.");let o;if(u4e(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new Vn({message:a,text:a.content})}else if(d4e(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new Vn({message:f4e(a),text:a.content})}else o=new p4e({text:a});r===void 0?r=o:r=r.concat(o);const i=await this.parsePartialResult([r]);i!=null&&!uj(i,n)&&(this.diff?yield this._diff(n,i):yield i,n=i)}}getFormatInstructions(){return""}}class dj extends h8{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(t){super(t),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(t){return new this(t)}static fromNamesAndDescriptions(t){const n=Ra.object(Object.fromEntries(Object.entries(t).map(([r,a])=>[r,Ra.string().describe(a)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(ZP(this.schema))}
\`\`\`
`}async parse(t){try{const n=(t.includes("```")?t.trim().split(/```(?:json)?/)[1]:t.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(r,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(n){throw new lj(`Failed to parse. Text: "${t}". Error: ${n}`,t)}}}class fj extends m8{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(t,n){if(n)return t?fY(t,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(t){return UX(t[0].text)}async parse(t){return UX(t,JSON.parse)}getFormatInstructions(){return""}}function pj(e,t){if(e.function===void 0)return;let n;if(t!=null&&t.partial)try{n=h4e(e.function.arguments??"{}")}catch{return}else try{n=JSON.parse(e.function.arguments)}catch(a){throw new lj([`Function "${e.function.name}" arguments:`,"",e.function.arguments,"","are not valid JSON.",`Error: ${a.message}`].join(`
`))}const r={name:e.function.name,args:n,type:"tool_call"};return t!=null&&t.returnId&&(r.id=e.id),r}function y8(e){if(e.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}}function g8(e,t){var n,r;return{name:(n=e.function)==null?void 0:n.name,args:(r=e.function)==null?void 0:r.arguments,id:e.id,error:t,type:"invalid_tool_call"}}class bhe extends m8{static lc_name(){return"JsonOutputToolsParser"}constructor(t){super(t),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(t==null?void 0:t.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(t){return await this.parsePartialResult(t,!1)}async parsePartialResult(t,n=!0){var i;const r=t[0].message;let a;if(su(r)&&((i=r.tool_calls)!=null&&i.length)?a=r.tool_calls.map(s=>{const{id:c,...l}=s;return this.returnId?{id:c,...l}:l}):r.additional_kwargs.tool_calls!==void 0&&(a=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(s=>pj(s,{returnId:this.returnId,partial:n}))),!a)return[];const o=[];for(const s of a)if(s!==void 0){const c={type:s.name,args:s.args,id:s.id};o.push(c)}return o}}class Gc extends bhe{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=t.keyName,this.returnSingle=t.returnSingle??this.returnSingle,this.zodSchema=t.zodSchema}async _validateResult(t){if(this.zodSchema===void 0)return t;const n=await this.zodSchema.safeParseAsync(t);if(n.success)return n.data;throw new lj(`Failed to parse. Text: "${JSON.stringify(t,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(t,null,2))}async parsePartialResult(t){const n=(await super.parsePartialResult(t)).filter(a=>a.type===this.keyName);let r=n;if(n.length)return this.returnId||(r=n.map(a=>a.args)),this.returnSingle?r[0]:r}async parseResult(t){const n=(await super.parsePartialResult(t,!1)).filter(a=>a.type===this.keyName);let r=n;return n.length?(this.returnId||(r=n.map(a=>a.args)),this.returnSingle?this._validateResult(r[0]):await Promise.all(r.map(a=>this._validateResult(a)))):void 0}}const whe=Symbol("Let zodToJsonSchema decide on which parser to use"),xhe={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},_he=e=>({...xhe,...e}),She=e=>{const t=_he(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function v8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Nt(e,t,n,r,a){e[t]=n,v8(e,t,r,a)}function jhe(){return{}}function Ehe(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==ae.ZodAny&&(n.items=_t(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Nt(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Nt(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Nt(n,"minItems",e.exactLength.value,e.exactLength.message,t),Nt(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function Ohe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Nt(n,"minimum",r.value,r.message,t):Nt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Nt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Nt(n,"maximum",r.value,r.message,t):Nt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Nt(n,"maximum",r.value,r.message,t));break;case"multipleOf":Nt(n,"multipleOf",r.value,r.message,t);break}return n}function Che(){return{type:"boolean"}}function khe(e,t){return _t(e.type._def,t)}const Phe=(e,t)=>_t(e.innerType._def,t);function b8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>b8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Nhe(e,t)}}const Nhe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Nt(n,"minimum",r.value,r.message,t);break;case"max":Nt(n,"maximum",r.value,r.message,t);break}return n};function Mhe(e,t){return{..._t(e.innerType._def,t),default:e.defaultValue()}}function Ahe(e,t){return t.effectStrategy==="input"?_t(e.schema._def,t):{}}function The(e){return{type:"string",enum:e.values}}const Rhe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Ihe(e,t){const n=[_t(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),_t(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(Rhe(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Dhe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let hj;const gs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(hj===void 0&&(hj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),hj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function w8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Lhe(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":Nt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":Nt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ma(n,"email",a.message,t);break;case"format:idn-email":ma(n,"idn-email",a.message,t);break;case"pattern:zod":ya(n,gs.email,a.message,t);break}break;case"url":ma(n,"uri",a.message,t);break;case"uuid":ma(n,"uuid",a.message,t);break;case"regex":ya(n,a.regex,a.message,t);break;case"cuid":ya(n,gs.cuid,a.message,t);break;case"cuid2":ya(n,gs.cuid2,a.message,t);break;case"startsWith":ya(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":ya(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":ma(n,"date-time",a.message,t);break;case"date":ma(n,"date",a.message,t);break;case"time":ma(n,"time",a.message,t);break;case"duration":ma(n,"duration",a.message,t);break;case"length":Nt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),Nt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{ya(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&ma(n,"ipv4",a.message,t),a.version!=="v4"&&ma(n,"ipv6",a.message,t);break}case"emoji":ya(n,gs.emoji,a.message,t);break;case"ulid":{ya(n,gs.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ma(n,"binary",a.message,t);break}case"contentEncoding:base64":{Nt(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{ya(n,gs.base64,a.message,t);break}}break}case"nanoid":ya(n,gs.nanoid,a.message,t)}return n}const Lhe=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),ma=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Nt(e,"format",t,n,r)},ya=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:x8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Nt(e,"pattern",x8(t,r),n,r)},x8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function _8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===ae.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:_t(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:_t(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===ae.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(w8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===ae.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function $he(e,t){if(t.mapStrategy==="record")return _8(e,t);const n=_t(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=_t(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Fhe(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Bhe(){return{not:{}}}function zhe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Jm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Uhe(e,t){if(t.target==="openApi3")return S8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Jm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=Jm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return S8(e,t)}const S8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>_t(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Vhe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:Jm[e.innerType._def.typeName],nullable:!0}:{type:[Jm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=_t(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=_t(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Whe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",v8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Nt(n,"minimum",r.value,r.message,t):Nt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Nt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Nt(n,"maximum",r.value,r.message,t):Nt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Nt(n,"maximum",r.value,r.message,t));break;case"multipleOf":Nt(n,"multipleOf",r.value,r.message,t);break}return n}function Hhe(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":_t(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":_t(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function qhe(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=_t(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Hhe(e,t)};return n.required.length||delete n.required,n}const Zhe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return _t(e.innerType._def,t);const n=_t(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Khe=(e,t)=>{if(t.pipeStrategy==="input")return _t(e.in._def,t);if(t.pipeStrategy==="output")return _t(e.out._def,t);const n=_t(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=_t(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Xhe(e,t){return _t(e.type._def,t)}function Yhe(e,t){const n={type:"array",uniqueItems:!0,items:_t(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Nt(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Nt(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Jhe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>_t(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:_t(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>_t(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Qhe(){return{not:{}}}function Ghe(){return{}}const eme=(e,t)=>_t(e.innerType._def,t);function _t(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==whe)return s}if(r&&!n){const s=tme(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=rme(e,e.typeName,t);return o&&ame(e,t,o),a.jsonSchema=o,o}const tme=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:nme(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},nme=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},rme=(e,t,n)=>{switch(t){case ae.ZodString:return w8(e,n);case ae.ZodNumber:return Whe(e,n);case ae.ZodObject:return qhe(e,n);case ae.ZodBigInt:return Ohe(e,n);case ae.ZodBoolean:return Che();case ae.ZodDate:return b8(e,n);case ae.ZodUndefined:return Qhe();case ae.ZodNull:return zhe(n);case ae.ZodArray:return Ehe(e,n);case ae.ZodUnion:case ae.ZodDiscriminatedUnion:return Uhe(e,n);case ae.ZodIntersection:return Ihe(e,n);case ae.ZodTuple:return Jhe(e,n);case ae.ZodRecord:return _8(e,n);case ae.ZodLiteral:return Dhe(e,n);case ae.ZodEnum:return The(e);case ae.ZodNativeEnum:return Fhe(e);case ae.ZodNullable:return Vhe(e,n);case ae.ZodOptional:return Zhe(e,n);case ae.ZodMap:return $he(e,n);case ae.ZodSet:return Yhe(e,n);case ae.ZodLazy:return _t(e.getter()._def,n);case ae.ZodPromise:return Xhe(e,n);case ae.ZodNaN:case ae.ZodNever:return Bhe();case ae.ZodEffects:return Ahe(e,n);case ae.ZodAny:return jhe();case ae.ZodUnknown:return Ghe();case ae.ZodDefault:return Mhe(e,n);case ae.ZodBranded:return khe(e,n);case ae.ZodReadonly:return eme(e,n);case ae.ZodCatch:return Phe(e,n);case ae.ZodPipeline:return Khe(e,n);case ae.ZodFunction:case ae.ZodVoid:case ae.ZodSymbol:return;default:return(r=>{})()}},ame=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),ome=(e,t)=>{const n=She(t),r=void 0,a=t==null?void 0:t.name,o=_t(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},ime=Symbol("Let zodToJsonSchema decide on which parser to use"),j8={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},sme=e=>typeof e=="string"?{...j8,basePath:["#"],definitions:{},name:e}:{...j8,basePath:["#"],definitions:{},...e},mj=e=>"_def"in e?e._def:e;function cme(e){if(!e)return!0;for(const t in e)return!1;return!0}const lme=e=>{const t=sme(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[mj(a),{def:mj(a),path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function E8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Mt(e,t,n,r,a){e[t]=n,E8(e,t,r,a)}function ume(){return{}}function dme(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==ae.ZodAny&&(n.items=vt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Mt(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Mt(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Mt(n,"minItems",e.exactLength.value,e.exactLength.message,t),Mt(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function fme(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Mt(n,"minimum",r.value,r.message,t):Mt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Mt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Mt(n,"maximum",r.value,r.message,t):Mt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Mt(n,"maximum",r.value,r.message,t));break;case"multipleOf":Mt(n,"multipleOf",r.value,r.message,t);break}return n}function pme(){return{type:"boolean"}}function hme(e,t){return vt(e.type._def,t)}const mme=(e,t)=>vt(e.innerType._def,t);function O8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>O8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return yme(e,t)}}const yme=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Mt(n,"minimum",r.value,r.message,t);break;case"max":Mt(n,"maximum",r.value,r.message,t);break}return n};function gme(e,t){return{...vt(e.innerType._def,t),default:e.defaultValue()}}function vme(e,t,n){return t.effectStrategy==="input"?vt(e.schema._def,t,n):{}}function bme(e){return{type:"string",enum:[...e.values]}}const wme=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function xme(e,t){const n=[vt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),vt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(wme(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function _me(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let yj;const vs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(yj===void 0&&(yj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),yj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function C8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Sme(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":Mt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":Mt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ga(n,"email",a.message,t);break;case"format:idn-email":ga(n,"idn-email",a.message,t);break;case"pattern:zod":va(n,vs.email,a.message,t);break}break;case"url":ga(n,"uri",a.message,t);break;case"uuid":ga(n,"uuid",a.message,t);break;case"regex":va(n,a.regex,a.message,t);break;case"cuid":va(n,vs.cuid,a.message,t);break;case"cuid2":va(n,vs.cuid2,a.message,t);break;case"startsWith":va(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":va(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":ga(n,"date-time",a.message,t);break;case"date":ga(n,"date",a.message,t);break;case"time":ga(n,"time",a.message,t);break;case"duration":ga(n,"duration",a.message,t);break;case"length":Mt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),Mt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{va(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&ga(n,"ipv4",a.message,t),a.version!=="v4"&&ga(n,"ipv6",a.message,t);break}case"emoji":va(n,vs.emoji,a.message,t);break;case"ulid":{va(n,vs.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ga(n,"binary",a.message,t);break}case"contentEncoding:base64":{Mt(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{va(n,vs.base64,a.message,t);break}}break}case"nanoid":va(n,vs.nanoid,a.message,t)}return n}const Sme=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),ga=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Mt(e,"format",t,n,r)},va=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:k8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Mt(e,"pattern",k8(t,r),n,r)},k8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function P8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===ae.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===ae.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(C8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===ae.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function jme(e,t){if(t.mapStrategy==="record")return P8(e,t);const n=vt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Eme(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Ome(){return{not:{}}}function Cme(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Qm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function kme(e,t){if(t.target==="openApi3")return N8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Qm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=Qm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return N8(e,t)}const N8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>vt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Pme(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"||t.nullableStrategy==="property"?{type:Qm[e.innerType._def.typeName],nullable:!0}:{type:[Qm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=vt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=vt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Nme(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",E8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Mt(n,"minimum",r.value,r.message,t):Mt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Mt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Mt(n,"maximum",r.value,r.message,t):Mt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Mt(n,"maximum",r.value,r.message,t));break;case"multipleOf":Mt(n,"multipleOf",r.value,r.message,t);break}return n}function Mme(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":vt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":vt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Ame(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=vt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()&&!t.openaiStrictMode?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Mme(e,t)};return n.required.length||delete n.required,n}const Tme=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return vt(e.innerType._def,t);const n=vt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Rme=(e,t)=>{if(t.pipeStrategy==="input")return vt(e.in._def,t);if(t.pipeStrategy==="output")return vt(e.out._def,t);const n=vt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=vt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Ime(e,t){return vt(e.type._def,t)}function Dme(e,t){const n={type:"array",uniqueItems:!0,items:vt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Mt(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Mt(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Lme(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>vt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:vt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>vt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function $me(){return{not:{}}}function Fme(){return{}}const Bme=(e,t)=>vt(e.innerType._def,t);function vt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==ime)return s}if(r&&!n){const s=zme(r,t);if(s!==void 0)return"$ref"in s&&t.seenRefs.add(s.$ref),s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=Vme(e,e.typeName,t,n);return o&&Wme(e,t,o),a.jsonSchema=o,o}const zme=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":const n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&t.nameStrategy==="duplicate-ref"&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:Ume(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,a)=>t.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Ume=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Vme=(e,t,n,r)=>{switch(t){case ae.ZodString:return C8(e,n);case ae.ZodNumber:return Nme(e,n);case ae.ZodObject:return Ame(e,n);case ae.ZodBigInt:return fme(e,n);case ae.ZodBoolean:return pme();case ae.ZodDate:return O8(e,n);case ae.ZodUndefined:return $me();case ae.ZodNull:return Cme(n);case ae.ZodArray:return dme(e,n);case ae.ZodUnion:case ae.ZodDiscriminatedUnion:return kme(e,n);case ae.ZodIntersection:return xme(e,n);case ae.ZodTuple:return Lme(e,n);case ae.ZodRecord:return P8(e,n);case ae.ZodLiteral:return _me(e,n);case ae.ZodEnum:return bme(e);case ae.ZodNativeEnum:return Eme(e);case ae.ZodNullable:return Pme(e,n);case ae.ZodOptional:return Tme(e,n);case ae.ZodMap:return jme(e,n);case ae.ZodSet:return Dme(e,n);case ae.ZodLazy:return vt(e.getter()._def,n);case ae.ZodPromise:return Ime(e,n);case ae.ZodNaN:case ae.ZodNever:return Ome();case ae.ZodEffects:return vme(e,n,r);case ae.ZodAny:return ume();case ae.ZodUnknown:return Fme();case ae.ZodDefault:return gme(e,n);case ae.ZodBranded:return hme(e,n);case ae.ZodReadonly:return Bme(e,n);case ae.ZodCatch:return mme(e,n);case ae.ZodPipeline:return Rme(e,n);case ae.ZodFunction:case ae.ZodVoid:case ae.ZodSymbol:return;default:return(a=>{})()}},Wme=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),Hme=(e,t)=>{const n=lme(t),r=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,a=vt(e._def,r===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},o=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;o!==void 0&&(a.title=o);const i=(()=>{if(cme(n.definitions))return;const c={},l=new Set;for(let u=0;u<500;u++){const d=Object.entries(n.definitions).filter(([f])=>!l.has(f));if(d.length===0)break;for(const[f,p]of d)c[f]=vt(mj(p),{...n,currentPath:[...n.basePath,n.definitionPath,f]},!0)??{},l.add(f)}return c})(),s=r===void 0?i?{...a,[n.definitionPath]:i}:a:n.nameStrategy==="duplicate-ref"?{...a,...i||n.seenRefs.size?{[n.definitionPath]:{...i,...n.seenRefs.size?{[r]:a}:void 0}}:void 0}:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...i,[r]:a}};return n.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s};function M8(e,t){return Hme(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function qme(e,t,n){return Kpe({type:"json_schema",json_schema:{...n,name:t,strict:!0,schema:M8(e,{name:t})}},r=>e.parse(JSON.parse(r)))}function Zme(e){return Xpe({type:"function",function:{name:e.name,parameters:M8(e.parameters,{name:e.name}),strict:!0,...e.description?{description:e.description}:void 0}},{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})}function Kme(e){const{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:a,baseURL:o,azureADTokenProvider:i,azureOpenAIEndpoint:s}=e;if((r||i)&&a&&t)return`${a}/${t}`;if((r||i)&&s&&t)return`${s}/openai/deployments/${t}`;if(r||i){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${t}`}return o}function A8(e,t){const n=typeof t=="number"?void 0:t;return{name:e.name,description:e.description,parameters:ZP(e.schema),...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}}function Xme(e,t){let n;return Gm(e)?n={type:"function",function:A8(e)}:n=e,n}function Yme(e){return e!==void 0&&Array.isArray(e.lc_namespace)}function Jme(e){return e!==void 0&&gp.isRunnable(e)&&"lc_name"in e.constructor&&typeof e.constructor.lc_name=="function"&&e.constructor.lc_name()==="RunnableToolLike"}function Qme(e){return!!e&&typeof e=="object"&&"name"in e&&"schema"in e&&Ym(e.schema)}function Gm(e){return Qme(e)||Jme(e)||Yme(e)}function ey(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/
`,e}function T8(e){let t;return e.constructor.name===Mm.name?(t=new Error(e.message),t.name="TimeoutError"):e.constructor.name===Ar.name?(t=new Error(e.message),t.name="AbortError"):e.status===400&&e.message.includes("tool_calls")?t=ey(e,"INVALID_TOOL_RESULTS"):e.status===401?t=ey(e,"MODEL_AUTHENTICATION"):e.status===429?t=ey(e,"MODEL_RATE_LIMIT"):e.status===404?t=ey(e,"MODEL_NOT_FOUND"):t=e,t}function Gme(e){if(e)return e==="any"||e==="required"?"required":e==="auto"?"auto":e==="none"?"none":typeof e=="string"?{type:"function",function:{name:e}}:e}function eye(e){return e.anyOf!==void 0&&Array.isArray(e.anyOf)}function tye(e){const t=["namespace functions {",""];for(const n of e)n.description&&t.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(t.push(`type ${n.name} = (_: {`),t.push(R8(n.parameters,0)),t.push("}) => any;")):t.push(`type ${n.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join(`
`)}function R8(e,t){var r;const n=[];for(const[a,o]of Object.entries(e.properties??{}))o.description&&t<2&&n.push(`// ${o.description}`),(r=e.required)!=null&&r.includes(a)?n.push(`${a}: ${ty(o,t)},`):n.push(`${a}?: ${ty(o,t)},`);return n.map(a=>" ".repeat(t)+a).join(`
`)}function ty(e,t){if(eye(e))return e.anyOf.map(n=>ty(n,t)).join(" | ");switch(e.type){case"string":return e.enum?e.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",R8(e,t+2),"}"].join(`
`);case"array":return e.items?`${ty(e.items,t)}[]`:"any[]";default:return""}}function nye(e,t){let n;if(Gm(e)){const r=Zme({name:e.name,parameters:e.schema,description:e.description});r.function.parameters?n={type:r.type,function:{name:r.function.name,description:r.function.description,parameters:r.function.parameters,...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}}:n={type:"function",function:A8(e,t)}}else n=e;return(t==null?void 0:t.strict)!==void 0&&(n.function.strict=t.strict),n}function rye(e){return e.role!=="system"&&e.role!=="developer"&&e.role!=="assistant"&&e.role!=="user"&&e.role!=="function"&&e.role!=="tool"&&console.warn(`Unknown message role: ${e.role}`),e.role}function I8(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!KP.isInstance(e))throw new Error("Invalid generic chat message");return rye(e)}default:throw new Error(`Unknown message type: ${t}`)}}function aye(e,t,n){const r=e.tool_calls;switch(e.role){case"assistant":{const a=[],o=[];for(const c of r??[])try{a.push(pj(c,{returnId:!0}))}catch(l){o.push(g8(c,l.message))}const i={function_call:e.function_call,tool_calls:r};n!==void 0&&(i.__raw_response=t);const s={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(i.audio=e.audio),new qr({content:e.content||"",tool_calls:a,invalid_tool_calls:o,additional_kwargs:i,response_metadata:s,id:t.id})}default:return new KP(e.content||"",e.role??"unknown")}}function oye(e,t,n,r){var c,l;const a=e.role??n,o=e.content??"";let i;e.function_call?i={function_call:e.function_call}:e.tool_calls?i={tool_calls:e.tool_calls}:i={},r&&(i.__raw_response=t),e.audio&&(i.audio={...e.audio,index:t.choices[0].index});const s={usage:{...t.usage}};if(a==="user")return new VX({content:o,response_metadata:s});if(a==="assistant"){const u=[];if(Array.isArray(e.tool_calls))for(const d of e.tool_calls)u.push({name:(c=d.function)==null?void 0:c.name,args:(l=d.function)==null?void 0:l.arguments,id:d.id,index:d.index,type:"tool_call_chunk"});return new Hr({content:o,tool_call_chunks:u,additional_kwargs:i,id:t.id,response_metadata:s})}else return a==="system"?new XP({content:o,response_metadata:s}):a==="developer"?new XP({content:o,response_metadata:s,additional_kwargs:{__openai_role__:"developer"}}):a==="function"?new m4e({content:o,additional_kwargs:i,name:e.name,response_metadata:s}):a==="tool"?new y4e({content:o,additional_kwargs:i,tool_call_id:e.tool_call_id,response_metadata:s}):new WX({content:o,role:a,response_metadata:s})}function D8(e,t){return e.flatMap(n=>{var o;let r=I8(n);r==="system"&&(t!=null&&t.startsWith("o1"))&&(r="developer");const a={role:r,content:n.content};if(n.name!=null&&(a.name=n.name),n.additional_kwargs.function_call!=null&&(a.function_call=n.additional_kwargs.function_call,a.content=null),su(n)&&((o=n.tool_calls)!=null&&o.length)?(a.tool_calls=n.tool_calls.map(y8),a.content=null):(n.additional_kwargs.tool_calls!=null&&(a.tool_calls=n.additional_kwargs.tool_calls),n.tool_call_id!=null&&(a.tool_call_id=n.tool_call_id)),n.additional_kwargs.audio&&typeof n.additional_kwargs.audio=="object"&&"id"in n.additional_kwargs.audio){const i={role:"assistant",audio:{id:n.additional_kwargs.audio.id}};return[a,i]}return a})}function L8(e,t){return p8(e)?(t==null?void 0:t.strict)!==void 0?{...e,function:{...e.function,strict:t.strict}}:e:nye(e,t)}class iye extends Ga{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(t,n){var r,a,o,i,s,c,l,u,d;if(super(t??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(t==null?void 0:t.apiKey)??(t==null?void 0:t.openAIApiKey)??((r=t==null?void 0:t.configuration)==null?void 0:r.apiKey)??Wr("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(t==null?void 0:t.azureOpenAIApiKey)??Wr("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(t==null?void 0:t.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(t==null?void 0:t.azureOpenAIApiInstanceName)??Wr("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(t==null?void 0:t.azureOpenAIApiDeploymentName)??Wr("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(t==null?void 0:t.azureOpenAIApiVersion)??Wr("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(t==null?void 0:t.azureOpenAIBasePath)??Wr("AZURE_OPENAI_BASE_PATH"),this.organization=((a=t==null?void 0:t.configuration)==null?void 0:a.organization)??Wr("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=(t==null?void 0:t.azureOpenAIEndpoint)??Wr("AZURE_OPENAI_ENDPOINT"),this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(t==null?void 0:t.modelKwargs)??{},this.timeout=t==null?void 0:t.timeout,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.topP=(t==null?void 0:t.topP)??this.topP,this.frequencyPenalty=(t==null?void 0:t.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(t==null?void 0:t.presencePenalty)??this.presencePenalty,this.maxTokens=t==null?void 0:t.maxTokens,this.logprobs=t==null?void 0:t.logprobs,this.topLogprobs=t==null?void 0:t.topLogprobs,this.n=(t==null?void 0:t.n)??this.n,this.logitBias=t==null?void 0:t.logitBias,this.stop=(t==null?void 0:t.stopSequences)??(t==null?void 0:t.stop),this.stopSequences=this==null?void 0:this.stop,this.user=t==null?void 0:t.user,this.__includeRawResponse=t==null?void 0:t.__includeRawResponse,this.audio=t==null?void 0:t.audio,this.modalities=t==null?void 0:t.modalities,this.reasoningEffort=t==null?void 0:t.reasoningEffort,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const f=this.azureOpenAIBasePath.split("/openai/deployments/");if(f.length===2){const[,p]=f;this.azureOpenAIApiDeploymentName=p}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.model==="o1"&&(this.disableStreaming=!0),this.streaming=(t==null?void 0:t.streaming)??!1,this.streamUsage=(t==null?void 0:t.streamUsage)??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(n==null?void 0:n.basePath)??((o=t==null?void 0:t.configuration)==null?void 0:o.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((i=n==null?void 0:n.baseOptions)==null?void 0:i.headers)??((c=(s=t==null?void 0:t.configuration)==null?void 0:s.baseOptions)==null?void 0:c.headers),defaultQuery:((l=n==null?void 0:n.baseOptions)==null?void 0:l.params)??((d=(u=t==null?void 0:t.configuration)==null?void 0:u.baseOptions)==null?void 0:d.params),...n,...t==null?void 0:t.configuration},(t==null?void 0:t.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=t.supportsStrictToolCalling)}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.max_tokens??void 0,ls_stop:t.stop}}bindTools(t,n){let r;return(n==null?void 0:n.strict)!==void 0?r=n.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:t.map(a=>L8(a,{strict:r})),...n})}createResponseFormat(t){return t&&t.type==="json_schema"&&t.json_schema.schema&&ny(t.json_schema.schema)?qme(t.json_schema.schema,t.json_schema.name,{description:t.json_schema.description}):t}invocationParams(t,n){var s;let r;(t==null?void 0:t.strict)!==void 0?r=t.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling);let a={};(t==null?void 0:t.stream_options)!==void 0?a={stream_options:t.stream_options}:this.streamUsage&&(this.streaming||n!=null&&n.streaming)&&(a={stream_options:{include_usage:!0}});const o={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(t==null?void 0:t.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:t==null?void 0:t.functions,function_call:t==null?void 0:t.function_call,tools:(s=t==null?void 0:t.tools)!=null&&s.length?t.tools.map(c=>L8(c,{strict:r})):void 0,tool_choice:Gme(t==null?void 0:t.tool_choice),response_format:this.createResponseFormat(t==null?void 0:t.response_format),seed:t==null?void 0:t.seed,...a,parallel_tool_calls:t==null?void 0:t.parallel_tool_calls,...this.audio||t!=null&&t.audio?{audio:this.audio||(t==null?void 0:t.audio)}:{},...this.modalities||t!=null&&t.modalities?{modalities:this.modalities||(t==null?void 0:t.modalities)}:{},...this.modelKwargs};(t==null?void 0:t.prediction)!==void 0&&(o.prediction=t.prediction);const i=(t==null?void 0:t.reasoning_effort)??this.reasoningEffort;return i!==void 0&&(o.reasoning_effort=i),o}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(t,n,r){var l,u,d,f,p,m,y,v,b,w;const a=D8(t,this.model),o={...this.invocationParams(n,{streaming:!0}),messages:a,stream:!0};let i;const s=await this.completionWithRetry(o,n);let c;for await(const _ of s){const x=(l=_==null?void 0:_.choices)==null?void 0:l[0];if(_.usage&&(c=_.usage),!x)continue;const{delta:S}=x;if(!S)continue;const j=oye(S,_,i,this.__includeRawResponse);i=S.role??i;const E={prompt:n.promptIndex??0,completion:x.index??0};if(typeof j.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const O={...E};x.finish_reason!=null&&(O.finish_reason=x.finish_reason,O.system_fingerprint=_.system_fingerprint,O.model_name=_.model),this.logprobs&&(O.logprobs=x.logprobs);const P=new Vn({message:j,text:j.content,generationInfo:O});yield P,await(r==null?void 0:r.handleLLMNewToken(P.text??"",E,void 0,void 0,void 0,{chunk:P}))}if(c){const _={...((u=c.prompt_tokens_details)==null?void 0:u.audio_tokens)!==null&&{audio:(d=c.prompt_tokens_details)==null?void 0:d.audio_tokens},...((f=c.prompt_tokens_details)==null?void 0:f.cached_tokens)!==null&&{cache_read:(p=c.prompt_tokens_details)==null?void 0:p.cached_tokens}},x={...((m=c.completion_tokens_details)==null?void 0:m.audio_tokens)!==null&&{audio:(y=c.completion_tokens_details)==null?void 0:y.audio_tokens},...((v=c.completion_tokens_details)==null?void 0:v.reasoning_tokens)!==null&&{reasoning:(b=c.completion_tokens_details)==null?void 0:b.reasoning_tokens}};yield new Vn({message:new Hr({content:"",response_metadata:{usage:{...c}},usage_metadata:{input_tokens:c.prompt_tokens,output_tokens:c.completion_tokens,total_tokens:c.total_tokens,...Object.keys(_).length>0&&{input_token_details:_},...Object.keys(x).length>0&&{output_token_details:x}}}),text:""})}if((w=n.signal)!=null&&w.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(t,n,r){var s,c;const a={},o=this.invocationParams(n),i=D8(t,this.model);if(o.stream){const l=this._streamResponseChunks(t,n,r),u={};for await(const v of l){v.message.response_metadata={...v.generationInfo,...v.message.response_metadata};const b=((s=v.generationInfo)==null?void 0:s.completion)??0;u[b]===void 0?u[b]=v:u[b]=u[b].concat(v)}const d=Object.entries(u).sort(([v],[b])=>parseInt(v,10)-parseInt(b,10)).map(([v,b])=>b),{functions:f,function_call:p}=this.invocationParams(n),m=await this.getEstimatedTokenCountFromPrompt(t,f,p),y=await this.getNumTokensFromGenerations(d);return a.input_tokens=m,a.output_tokens=y,a.total_tokens=m+y,{generations:d,llmOutput:{estimatedTokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}else{let l;n.response_format&&n.response_format.type==="json_schema"?l=await this.betaParsedCompletionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options}):l=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options});const{completion_tokens:u,prompt_tokens:d,total_tokens:f,prompt_tokens_details:p,completion_tokens_details:m}=(l==null?void 0:l.usage)??{};u&&(a.output_tokens=(a.output_tokens??0)+u),d&&(a.input_tokens=(a.input_tokens??0)+d),f&&(a.total_tokens=(a.total_tokens??0)+f),((p==null?void 0:p.audio_tokens)!==null||(p==null?void 0:p.cached_tokens)!==null)&&(a.input_token_details={...(p==null?void 0:p.audio_tokens)!==null&&{audio:p==null?void 0:p.audio_tokens},...(p==null?void 0:p.cached_tokens)!==null&&{cache_read:p==null?void 0:p.cached_tokens}}),((m==null?void 0:m.audio_tokens)!==null||(m==null?void 0:m.reasoning_tokens)!==null)&&(a.output_token_details={...(m==null?void 0:m.audio_tokens)!==null&&{audio:m==null?void 0:m.audio_tokens},...(m==null?void 0:m.reasoning_tokens)!==null&&{reasoning:m==null?void 0:m.reasoning_tokens}});const y=[];for(const v of(l==null?void 0:l.choices)??[]){const b={text:((c=v.message)==null?void 0:c.content)??"",message:aye(v.message??{role:"assistant"},l,this.__includeRawResponse)};b.generationInfo={...v.finish_reason?{finish_reason:v.finish_reason}:{},...v.logprobs?{logprobs:v.logprobs}:{}},su(b.message)&&(b.message.usage_metadata=a),b.message=new qr(Object.fromEntries(Object.entries(b.message).filter(([w])=>!w.startsWith("lc_")))),y.push(b)}return{generations:y,llmOutput:{tokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(t,n,r){let a=(await this.getNumTokensFromMessages(t)).totalCount;if(n&&r!=="auto"){const o=tye(n);a+=await this.getNumTokens(o),a+=9}return n&&t.find(o=>o._getType()==="system")&&(a-=4),r==="none"?a+=1:typeof r=="object"&&(a+=await this.getNumTokens(r.name)+4),a}async getNumTokensFromGenerations(t){return(await Promise.all(t.map(async n=>{var r;return(r=n.message.additional_kwargs)!=null&&r.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)}))).reduce((n,r)=>n+r,0)}async getNumTokensFromMessages(t){let n=0,r=0,a=0;this.model==="gpt-3.5-turbo-0301"?(r=4,a=-1):(r=3,a=1);const o=await Promise.all(t.map(async i=>{var f,p,m,y,v,b;const s=await this.getNumTokens(i.content),c=await this.getNumTokens(I8(i)),l=i.name!==void 0?a+await this.getNumTokens(i.name):0;let u=s+r+c+l;const d=i;if(d._getType()==="function"&&(u-=2),(f=d.additional_kwargs)!=null&&f.function_call&&(u+=3),(p=d==null?void 0:d.additional_kwargs.function_call)!=null&&p.name&&(u+=await this.getNumTokens((m=d.additional_kwargs.function_call)==null?void 0:m.name)),(y=d.additional_kwargs.function_call)==null?void 0:y.arguments)try{u+=await this.getNumTokens(JSON.stringify(JSON.parse((v=d.additional_kwargs.function_call)==null?void 0:v.arguments)))}catch(w){console.error("Error parsing function arguments",w,JSON.stringify(d.additional_kwargs.function_call)),u+=await this.getNumTokens((b=d.additional_kwargs.function_call)==null?void 0:b.arguments)}return n+=u,u}));return n+=3,{totalCount:n,countPerMessage:o}}async completionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(t,r)}catch(a){throw T8(a)}})}async betaParsedCompletionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(t,r)}catch(a){throw T8(a)}})}_getClientOptions(t){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},a=Kme(r),o={...this.clientConfig,baseURL:a,timeout:this.timeout,maxRetries:0};o.baseURL||delete o.baseURL,this.client=new pt(o)}const n={...this.clientConfig,...t};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),n}_llmType(){return"openai"}_combineLLMOutput(...t){return t.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(t,n){let r,a,o,i;sye(t)?(r=t.schema,a=t.name,o=t.method,i=t.includeRaw):(r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw);let s,c;if((n==null?void 0:n.strict)!==void 0&&o==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(o==="jsonMode")s=this.bind({response_format:{type:"json_object"}}),ny(r)?c=dj.fromZodSchema(r):c=new fj;else if(o==="jsonSchema")s=this.bind({response_format:{type:"json_schema",json_schema:{name:a??"extract",description:r.description,schema:r,strict:n==null?void 0:n.strict}}}),ny(r)?c=dj.fromZodSchema(r):c=new fj;else{let f=a??"extract";if(ny(r)){const p=ome(r);s=this.bind({tools:[{type:"function",function:{name:f,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:f}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new Gc({returnSingle:!0,keyName:f,zodSchema:r})}else{let p;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(p=r,f=r.name):(f=r.title??f,p={name:f,description:r.description??"",parameters:r}),s=this.bind({tools:[{type:"function",function:p}],tool_choice:{type:"function",function:{name:f}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new Gc({returnSingle:!0,keyName:f})}}if(!i)return s.pipe(c);const l=ji.assign({parsed:(f,p)=>c.invoke(f.raw,p)}),u=ji.assign({parsed:()=>null}),d=l.withFallbacks({fallbacks:[u]});return Ov.from([{raw:s},d])}}function ny(e){return typeof(e==null?void 0:e.parse)=="function"}function sye(e){return e!==void 0&&typeof e.schema=="object"}const cye=Symbol("Let zodToJsonSchema decide on which parser to use"),lye={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},uye=e=>({...lye,...e}),dye=e=>{const t=uye(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function $8(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function At(e,t,n,r,a){e[t]=n,$8(e,t,r,a)}function fye(){return{}}function pye(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==ae.ZodAny&&(n.items=St(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&At(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&At(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(At(n,"minItems",e.exactLength.value,e.exactLength.message,t),At(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function hye(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?At(n,"minimum",r.value,r.message,t):At(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),At(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?At(n,"maximum",r.value,r.message,t):At(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),At(n,"maximum",r.value,r.message,t));break;case"multipleOf":At(n,"multipleOf",r.value,r.message,t);break}return n}function mye(){return{type:"boolean"}}function yye(e,t){return St(e.type._def,t)}const gye=(e,t)=>St(e.innerType._def,t);function F8(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>F8(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return vye(e,t)}}const vye=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":At(n,"minimum",r.value,r.message,t);break;case"max":At(n,"maximum",r.value,r.message,t);break}return n};function bye(e,t){return{...St(e.innerType._def,t),default:e.defaultValue()}}function wye(e,t){return t.effectStrategy==="input"?St(e.schema._def,t):{}}function xye(e){return{type:"string",enum:e.values}}const _ye=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Sye(e,t){const n=[St(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),St(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(_ye(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function jye(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let gj;const bs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(gj===void 0&&(gj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),gj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function B8(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Eye(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":At(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":At(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ba(n,"email",a.message,t);break;case"format:idn-email":ba(n,"idn-email",a.message,t);break;case"pattern:zod":wa(n,bs.email,a.message,t);break}break;case"url":ba(n,"uri",a.message,t);break;case"uuid":ba(n,"uuid",a.message,t);break;case"regex":wa(n,a.regex,a.message,t);break;case"cuid":wa(n,bs.cuid,a.message,t);break;case"cuid2":wa(n,bs.cuid2,a.message,t);break;case"startsWith":wa(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":wa(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":ba(n,"date-time",a.message,t);break;case"date":ba(n,"date",a.message,t);break;case"time":ba(n,"time",a.message,t);break;case"duration":ba(n,"duration",a.message,t);break;case"length":At(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),At(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{wa(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&ba(n,"ipv4",a.message,t),a.version!=="v4"&&ba(n,"ipv6",a.message,t);break}case"emoji":wa(n,bs.emoji,a.message,t);break;case"ulid":{wa(n,bs.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ba(n,"binary",a.message,t);break}case"contentEncoding:base64":{At(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{wa(n,bs.base64,a.message,t);break}}break}case"nanoid":wa(n,bs.nanoid,a.message,t)}return n}const Eye=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),ba=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):At(e,"format",t,n,r)},wa=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:z8(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):At(e,"pattern",z8(t,r),n,r)},z8=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function U8(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===ae.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:St(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:St(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===ae.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(B8(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===ae.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Oye(e,t){if(t.mapStrategy==="record")return U8(e,t);const n=St(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=St(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Cye(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function kye(){return{not:{}}}function Pye(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const ry={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Nye(e,t){if(t.target==="openApi3")return V8(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in ry&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=ry[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return V8(e,t)}const V8=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>St(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Mye(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:ry[e.innerType._def.typeName],nullable:!0}:{type:[ry[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=St(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=St(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Aye(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",$8(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?At(n,"minimum",r.value,r.message,t):At(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),At(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?At(n,"maximum",r.value,r.message,t):At(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),At(n,"maximum",r.value,r.message,t));break;case"multipleOf":At(n,"multipleOf",r.value,r.message,t);break}return n}function Tye(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":St(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":St(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Rye(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=St(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:Tye(e,t)};return n.required.length||delete n.required,n}const Iye=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return St(e.innerType._def,t);const n=St(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Dye=(e,t)=>{if(t.pipeStrategy==="input")return St(e.in._def,t);if(t.pipeStrategy==="output")return St(e.out._def,t);const n=St(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=St(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Lye(e,t){return St(e.type._def,t)}function $ye(e,t){const n={type:"array",uniqueItems:!0,items:St(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&At(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&At(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Fye(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>St(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:St(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>St(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Bye(){return{not:{}}}function zye(){return{}}const Uye=(e,t)=>St(e.innerType._def,t);function St(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==cye)return s}if(r&&!n){const s=Vye(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=Hye(e,e.typeName,t);return o&&qye(e,t,o),a.jsonSchema=o,o}const Vye=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Wye(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Wye=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Hye=(e,t,n)=>{switch(t){case ae.ZodString:return B8(e,n);case ae.ZodNumber:return Aye(e,n);case ae.ZodObject:return Rye(e,n);case ae.ZodBigInt:return hye(e,n);case ae.ZodBoolean:return mye();case ae.ZodDate:return F8(e,n);case ae.ZodUndefined:return Bye();case ae.ZodNull:return Pye(n);case ae.ZodArray:return pye(e,n);case ae.ZodUnion:case ae.ZodDiscriminatedUnion:return Nye(e,n);case ae.ZodIntersection:return Sye(e,n);case ae.ZodTuple:return Fye(e,n);case ae.ZodRecord:return U8(e,n);case ae.ZodLiteral:return jye(e,n);case ae.ZodEnum:return xye(e);case ae.ZodNativeEnum:return Cye(e);case ae.ZodNullable:return Mye(e,n);case ae.ZodOptional:return Iye(e,n);case ae.ZodMap:return Oye(e,n);case ae.ZodSet:return $ye(e,n);case ae.ZodLazy:return St(e.getter()._def,n);case ae.ZodPromise:return Lye(e,n);case ae.ZodNaN:case ae.ZodNever:return kye();case ae.ZodEffects:return wye(e,n);case ae.ZodAny:return fye();case ae.ZodUnknown:return zye();case ae.ZodDefault:return bye(e,n);case ae.ZodBranded:return yye(e,n);case ae.ZodReadonly:return Uye(e,n);case ae.ZodCatch:return gye(e,n);case ae.ZodPipeline:return Dye(e,n);case ae.ZodFunction:case ae.ZodVoid:case ae.ZodSymbol:return;default:return(r=>{})()}},qye=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),Zye=(e,t)=>{const n=dye(t),r=void 0,a=t==null?void 0:t.name,o=St(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},el="0.5.0";let W8=!1,tf,H8,q8,vj,Z8,K8,X8,Y8,J8;function Kye(e,t={auto:!1}){if(W8)throw new Error(`you must \`import 'groq-sdk/shims/${e.kind}'\` before importing anything else from groq-sdk`);if(tf)throw new Error(`can't \`import 'groq-sdk/shims/${e.kind}'\` after \`import 'groq-sdk/shims/${tf}'\``);W8=t.auto,tf=e.kind,H8=e.fetch,q8=e.FormData,vj=e.File,Z8=e.ReadableStream,K8=e.getMultipartRequestOptions,X8=e.getDefaultAgent,Y8=e.fileFromPath,J8=e.isFsReadStream}class Xye{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function Yye({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'groq-sdk'`:\n- `import 'groq-sdk/shims/node'` (if you're running on Node)\n- `import 'groq-sdk/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new Xye(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/groq/groq-typescript#file-uploads")},isFsReadStream:i=>!1}}tf||Kye(Yye(),{auto:!0});class xa extends Error{}class $n extends xa{constructor(t,n,r,a){super(`${$n.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.error=n}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t)return new ay({cause:jj(n)});const o=n;return t===400?new G8(t,o,r,a):t===401?new e9(t,o,r,a):t===403?new t9(t,o,r,a):t===404?new n9(t,o,r,a):t===409?new r9(t,o,r,a):t===422?new a9(t,o,r,a):t===429?new o9(t,o,r,a):t>=500?new i9(t,o,r,a):new $n(t,o,r,a)}}class bj extends $n{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class ay extends $n{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class Q8 extends ay{constructor({message:t}={}){super({message:t??"Request timed out."})}}class G8 extends $n{constructor(){super(...arguments),this.status=400}}class e9 extends $n{constructor(){super(...arguments),this.status=401}}class t9 extends $n{constructor(){super(...arguments),this.status=403}}class n9 extends $n{constructor(){super(...arguments),this.status=404}}class r9 extends $n{constructor(){super(...arguments),this.status=409}}class a9 extends $n{constructor(){super(...arguments),this.status=422}}class o9 extends $n{constructor(){super(...arguments),this.status=429}}class i9 extends $n{}class tl{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;const a=new Jye;async function*o(){if(!t.body)throw n.abort(),new xa("Attempted to iterate over a response with no body");const s=new ws,c=s9(t.body);for await(const l of c)for(const u of s.decode(l)){const d=a.decode(u);d&&(yield d)}for(const l of s.flush()){const u=a.decode(l);u&&(yield u)}}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(const c of o())if(!s){if(c.data.startsWith("[DONE]")){s=!0;continue}if(c.event===null){let l;try{l=JSON.parse(c.data)}catch(u){throw console.error("Could not parse message into JSON:",c.data),console.error("From chunk:",c.raw),u}if(l&&l.error)throw new $n(void 0,l.error,void 0,void 0);yield l}}s=!0}catch(c){if(c instanceof Error&&c.name==="AbortError")return;throw c}finally{s||n.abort()}}return new tl(i,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new ws,s=s9(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new tl(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new tl(()=>a(t),this.controller),new tl(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new Z8({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}}class Jye{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,r,a]=Qye(t,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}class ws{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=ws.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(ws.NEWLINE_REGEXP);return a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof En<"u"){if(t instanceof En)return t.toString();if(t instanceof Uint8Array)return En.from(t).toString();throw new xa(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new xa(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new xa("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}ws.NEWLINE_CHARS=new Set([`
`,"\r","\v","\f","","","","\x85","\u2028","\u2029"]),ws.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function Qye(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function s9(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const c9=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",l9=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&wj(e),wj=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",Gye=e=>l9(e)||c9(e)||J8(e);async function u9(e,t,n){var a;if(e=await e,n??(n=l9(e)?{lastModified:e.lastModified,type:e.type}:{}),c9(e)){const o=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new vj([o],t,n)}const r=await ege(e);if(t||(t=nge(e)??"unknown_file"),!n.type){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new vj(r,t,n)}async function ege(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(wj(e))t.push(await e.arrayBuffer());else if(rge(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${tge(e)}`);return t}function tge(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function nge(e){var t;return xj(e.name)||xj(e.filename)||((t=xj(e.path))==null?void 0:t.split(/[\\/]/).pop())}const xj=e=>{if(typeof e=="string")return e;if(typeof En<"u"&&e instanceof En)return String(e)},rge=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",d9=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",f9=async e=>{const t=await age(e.body);return K8(t,e)},age=async e=>{const t=new q8;return await Promise.all(Object.entries(e||{}).map(([n,r])=>_j(t,n,r))),t},_j=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(Gye(n)){const r=await u9(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>_j(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>_j(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var nl={};async function p9(e){const{response:t}=e;if(e.options.stream)return rl("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):tl.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return rl("response",t.status,t.url,t.headers,a),a}const r=await t.text();return rl("response",t.status,t.url,t.headers,r),r}class oy extends Promise{constructor(t,n=p9){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new oy(this.responsePromise,async n=>t(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class oge{constructor({baseURL:t,maxRetries:n=2,timeout:r=6e4,httpAgent:a,fetch:o}){this.baseURL=t,this.maxRetries=Sj("maxRetries",n),this.timeout=Sj("timeout",r),this.httpAgent=a,this.fetch=o??H8}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...uge(),...this.authHeaders(t)}}validateHeaders(t,n){}defaultIdempotencyKey(){return`stainless-node-retry-${gge()}`}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,r){return this.request(Promise.resolve(r).then(async a=>{const o=a&&wj(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:t,path:n,...a,body:o}}))}getAPIList(t,n,r){return this.requestAPIList(n,{method:"get",path:t,...r})}calculateContentLength(t){if(typeof t=="string"){if(typeof En<"u")return En.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t){var p;const{method:n,path:r,query:a,headers:o={}}=t,i=ArrayBuffer.isView(t.body)||t.__binaryRequest&&typeof t.body=="string"?t.body:d9(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,s=this.calculateContentLength(i),c=this.buildURL(r,a);"timeout"in t&&Sj("timeout",t.timeout);const l=t.timeout??this.timeout,u=t.httpAgent??this.httpAgent??X8(c),d=l+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const f=this.buildHeaders({options:t,headers:o,contentLength:s});return{req:{method:n,...i&&{body:i},headers:f,...u&&{agent:u},signal:t.signal??null},url:c,timeout:l}}buildHeaders({options:t,headers:n,contentLength:r}){const a={};r&&(a["content-length"]=r);const o=this.defaultHeaders(t);return v9(a,o),v9(a,n),d9(t.body)&&tf!=="node"&&delete a["content-type"],this.validateHeaders(a,n),a}async prepareOptions(t){}async prepareRequest(t,{url:n,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(n=>[...n])):{...t}:{}}makeStatusError(t,n,r,a){return $n.generate(t,n,r,a)}request(t,n=null){return new oy(this.makeRequest(t,n))}async makeRequest(t,n){var u,d;const r=await t;n==null&&(n=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:a,url:o,timeout:i}=this.buildRequest(r);if(await this.prepareRequest(a,{url:o,options:r}),rl("request",o,r,a.headers),(u=r.signal)==null?void 0:u.aborted)throw new bj;const s=new AbortController,c=await this.fetchWithTimeout(o,a,i,s).catch(jj);if(c instanceof Error){if((d=r.signal)!=null&&d.aborted)throw new bj;if(n)return this.retryRequest(r,n);throw c.name==="AbortError"?new Q8:new ay({cause:c})}const l=sge(c.headers);if(!c.ok){if(n&&this.shouldRetry(c)){const y=`retrying, ${n} attempts remaining`;return rl(`response (error; ${y})`,c.status,o,l),this.retryRequest(r,n,l)}const f=await c.text().catch(y=>jj(y).message),p=dge(f),m=p?void 0:f;throw rl(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,l,m),this.makeStatusError(c.status,p,m,l)}return{response:c,options:r,controller:s}}requestAPIList(t,n){const r=this.makeRequest(n,null);return new ige(this,r,t)}buildURL(t,n){const r=pge(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return mge(a)||(n={...a,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(t){return Object.entries(t).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new xa(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,n,r,a){const{signal:o,...i}=n||{};o&&o.addEventListener("abort",()=>a.abort());const s=setTimeout(()=>a.abort(),r);return this.getRequestClient().fetch.call(void 0,t,{signal:a.signal,...i}).finally(()=>{clearTimeout(s)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,r){let a;const o=r==null?void 0:r["retry-after-ms"];if(o){const s=parseFloat(o);Number.isNaN(s)||(a=s)}const i=r==null?void 0:r["retry-after"];if(i&&!a){const s=parseFloat(i);Number.isNaN(s)?a=Date.parse(i)-Date.now():a=s*1e3}if(!(a&&0<=a&&a<60*1e3)){const s=t.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,s)}return await hge(a),this.makeRequest(t,n-1)}calculateDefaultRetryTimeoutMillis(t,n){const r=n-t,a=Math.min(.5*Math.pow(2,r),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${el}`}}class ige extends oy{constructor(t,n,r){super(n,async a=>new r(t,a.response,await p9(a),a.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}const sge=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),cge=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":el,"X-Stainless-OS":m9(Deno.build.os),"X-Stainless-Arch":h9(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":el,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":On.version};if(Object.prototype.toString.call(typeof On<"u"?On:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":el,"X-Stainless-OS":m9(On.platform),"X-Stainless-Arch":h9(On.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":On.version};const e=lge();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":el,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":el,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function lge(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const h9=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",m9=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let y9;const uge=()=>y9??(y9=cge()),dge=e=>{try{return JSON.parse(e)}catch{return}},fge=new RegExp("^(?:[a-z]+:)?//","i"),pge=e=>fge.test(e),hge=e=>new Promise(t=>setTimeout(t,e)),Sj=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new xa(`${e} must be an integer`);if(t<0)throw new xa(`${e} must be a positive integer`);return t},jj=e=>e instanceof Error?e:new Error(e),g9=e=>{var t,n,r,a;if(typeof On<"u")return((t=nl==null?void 0:nl[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function mge(e){if(!e)return!0;for(const t in e)return!1;return!0}function yge(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function v9(e,t){for(const n in t){if(!yge(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function rl(e,...t){typeof On<"u"&&(nl==null?void 0:nl.DEBUG)==="true"&&console.log(`Groq:DEBUG:${e}`,...t)}const gge=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),vge=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class Ei{constructor(t){this._client=t}}class iy extends Ei{create(t,n){return this._client.post("/openai/v1/audio/transcriptions",f9({body:t,...n}))}}iy||(iy={});class sy extends Ei{create(t,n){return this._client.post("/openai/v1/audio/translations",f9({body:t,...n}))}}sy||(sy={});class cy extends Ei{constructor(){super(...arguments),this.transcriptions=new iy(this._client),this.translations=new sy(this._client)}}(function(e){e.Transcriptions=iy,e.Translations=sy})(cy||(cy={}));let ly=class extends Ei{create(e,t){return this._client.post("/openai/v1/chat/completions",{body:e,...t,stream:e.stream??!1})}};ly||(ly={});class uy extends Ei{constructor(){super(...arguments),this.completions=new ly(this._client)}}(function(e){e.Completions=ly})(uy||(uy={}));class dy extends Ei{}dy||(dy={});class fy extends Ei{create(t,n){return this._client.post("/openai/v1/embeddings",{body:t,...n})}}fy||(fy={});class py extends Ei{retrieve(t,n){return this._client.get(`/openai/v1/models/${t}`,n)}list(t){return this._client.get("/openai/v1/models",t)}delete(t,n){return this._client.delete(`/openai/v1/models/${t}`,n)}}py||(py={});var b9;class ln extends oge{constructor({baseURL:t=g9("GROQ_BASE_URL"),apiKey:n=g9("GROQ_API_KEY"),...r}={}){if(n===void 0)throw new xa("The GROQ_API_KEY environment variable is missing or empty; either provide it, or instantiate the Groq client with an apiKey option, like new Groq({ apiKey: 'My API Key' }).");const a={apiKey:n,...r,baseURL:t||"https://api.groq.com"};if(!a.dangerouslyAllowBrowser&&vge())throw new xa(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Groq({ apiKey, dangerouslyAllowBrowser: true })`);super({baseURL:a.baseURL,timeout:a.timeout??6e4,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new dy(this),this.chat=new uy(this),this.embeddings=new fy(this),this.audio=new cy(this),this.models=new py(this),this._options=a,this.apiKey=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}}b9=ln,ln.Groq=b9,ln.GroqError=xa,ln.APIError=$n,ln.APIConnectionError=ay,ln.APIConnectionTimeoutError=Q8,ln.APIUserAbortError=bj,ln.NotFoundError=n9,ln.ConflictError=r9,ln.RateLimitError=o9,ln.BadRequestError=G8,ln.AuthenticationError=e9,ln.InternalServerError=i9,ln.PermissionDeniedError=t9,ln.UnprocessableEntityError=a9,ln.toFile=u9,ln.fileFromPath=Y8,function(e){e.Completions=dy,e.Chat=uy,e.Embeddings=fy,e.Audio=cy,e.Models=py}(ln||(ln={}));function bge(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";default:throw new Error(`Unknown message type: ${t}`)}}function w9(e){return e.map(t=>{var r;if(typeof t.content!="string")throw new Error("Non string message content not supported");const n={role:bge(t),content:t.content,name:t.name,function_call:t.additional_kwargs.function_call,tool_calls:t.additional_kwargs.tool_calls,tool_call_id:t.tool_call_id};return su(t)&&((r=t.tool_calls)!=null&&r.length)?n.tool_calls=t.tool_calls.map(y8):(t.additional_kwargs.tool_calls!=null&&(n.tool_calls=t.additional_kwargs.tool_calls),t.tool_call_id!=null&&(n.tool_call_id=t.tool_call_id)),n})}function wge(e,t){const n=e.tool_calls;switch(e.role){case"assistant":{const r=[],a=[];for(const o of n??[])try{r.push(pj(o,{returnId:!0}))}catch(i){a.push(g8(o,i.message))}return new qr({content:e.content||"",additional_kwargs:{tool_calls:n},tool_calls:r,invalid_tool_calls:a,usage_metadata:t})}default:return new KP(e.content||"",e.role??"unknown")}}function xge(e,t){if(e!=null&&e.length)return e.map(n=>{var r,a;return{id:n.id,name:(r=n.function)==null?void 0:r.name,args:(a=n.function)==null?void 0:a.arguments,type:"tool_call_chunk",index:t}})}function _ge(e,t,n){const{role:r}=e,a=e.content??"";let o;e.function_call?o={function_call:e.function_call}:e.tool_calls?o={tool_calls:e.tool_calls}:o={};let i,s;if(n!=null&&n.usage&&(i={input_tokens:n.usage.prompt_tokens,output_tokens:n.usage.completion_tokens,total_tokens:n.usage.total_tokens},s=n.id),r==="user")return{message:new VX({content:a})};if(r==="assistant"){const c=xge(e.tool_calls,t);return{message:new Hr({content:a,additional_kwargs:o,tool_call_chunks:c?c.map(l=>({type:l.type,args:l.args,index:l.index})):void 0,usage_metadata:i,id:s}),toolCallData:c?c.map(l=>({id:l.id??"",name:l.name??"",index:l.index??t,type:"tool_call_chunk"})):void 0}}else return r==="system"?{message:new XP({content:a})}:{message:new WX({content:a,role:r})}}class Sge extends Ga{static lc_name(){return"ChatGroq"}_llmType(){return"groq"}get lc_secrets(){return{apiKey:"GROQ_API_KEY"}}constructor(t){super(t??{}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","groq"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0});const n=(t==null?void 0:t.apiKey)||Wr("GROQ_API_KEY");if(!n)throw new Error('Groq API key not found. Please set the GROQ_API_KEY environment variable or provide the key into "apiKey"');const r={"User-Agent":"langchainjs",...(t==null?void 0:t.defaultHeaders)??{}};this.client=new ln({apiKey:n,dangerouslyAllowBrowser:!0,baseURL:t==null?void 0:t.baseUrl,timeout:t==null?void 0:t.timeout,httpAgent:t==null?void 0:t.httpAgent,fetch:t==null?void 0:t.fetch,maxRetries:0,defaultHeaders:r,defaultQuery:t==null?void 0:t.defaultQuery}),this.apiKey=n,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.streaming=(t==null?void 0:t.streaming)??this.streaming,this.stop=(t==null?void 0:t.stopSequences)??(typeof(t==null?void 0:t.stop)=="string"?[t.stop]:t==null?void 0:t.stop)??[],this.stopSequences=this.stop,this.maxTokens=t==null?void 0:t.maxTokens}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"groq",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??this.temperature,ls_max_tokens:n.max_tokens??this.maxTokens,ls_stop:t.stop}}async completionWithRetry(t,n){return this.caller.call(async()=>this.client.chat.completions.create(t,n))}invocationParams(t){const n=super.invocationParams(t);return t.tool_choice!==void 0&&(n.tool_choice=t.tool_choice),t.tools!==void 0&&(n.tools=t.tools),t.response_format!==void 0&&(n.response_format=t.response_format),{...n,stop:t.stop??this.stopSequences,model:this.model,temperature:this.temperature,max_tokens:this.maxTokens}}bindTools(t,n){return this.bind({tools:t.map(r=>Xme(r)),...n})}async*_streamResponseChunks(t,n,r){var u,d;const a=this.invocationParams(n),o=w9(t),i=await this.completionWithRetry({...a,messages:o,stream:!0},{signal:n==null?void 0:n.signal,headers:n==null?void 0:n.headers});let s="";const c=[];let l;for await(const f of i){l=f;const p=f==null?void 0:f.choices[0];if(!p)continue;(u=p.delta)!=null&&u.role&&(s=p.delta.role);const{message:m,toolCallData:y}=_ge({...p.delta,role:s},p.index,f.x_groq);if(y){const b=y.filter(w=>c.every(_=>_.id!==w.id));c.push(...b),yield new Vn({message:new Hr({content:"",tool_call_chunks:b}),text:""})}const v=new Vn({message:m,text:p.delta.content??"",generationInfo:{finishReason:p.finish_reason}});yield v,r==null||r.handleLLMNewToken(v.text??"")}if(l&&("choices"in l&&delete l.choices,yield new Vn({message:new Hr({content:"",response_metadata:l}),text:""})),(d=n.signal)==null?void 0:d.aborted)throw new Error("AbortError")}async _generate(t,n,r){var a;if(this.streaming){const o={},i=this._streamResponseChunks(t,n,r),s={};for await(const c of i){const l=((a=c.generationInfo)==null?void 0:a.completion)??0;s[l]===void 0?s[l]=c:s[l]=s[l].concat(c)}return{generations:Object.entries(s).sort(([c],[l])=>parseInt(c,10)-parseInt(l,10)).map(([c,l])=>l),llmOutput:{estimatedTokenUsage:o}}}else return this._generateNonStreaming(t,n,r)}async _generateNonStreaming(t,n,r){var l;const a={},o=this.invocationParams(n),i=w9(t),s=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,headers:n==null?void 0:n.headers});if("usage"in s&&s.usage){const{completion_tokens:u,prompt_tokens:d,total_tokens:f}=s.usage;u&&(a.completionTokens=(a.completionTokens??0)+u),d&&(a.promptTokens=(a.promptTokens??0)+d),f&&(a.totalTokens=(a.totalTokens??0)+f)}const c=[];if("choices"in s&&s.choices)for(const u of s.choices){const d=((l=u.message)==null?void 0:l.content)??"";let f;a.totalTokens!==void 0&&(f={input_tokens:a.promptTokens??0,output_tokens:a.completionTokens??0,total_tokens:a.totalTokens});const p={text:d,message:wge(u.message??{role:"assistant"},f)};p.generationInfo={...u.finish_reason?{finish_reason:u.finish_reason}:{},...u.logprobs?{logprobs:u.logprobs}:{}},c.push(p)}return{generations:c,llmOutput:{tokenUsage:a}}}withStructuredOutput(t,n){const r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw;let s=a??"extract",c,l;if(o==="jsonMode")l=this.bind({response_format:{type:"json_object"}}),Ym(r)?c=dj.fromZodSchema(r):c=new fj;else if(Ym(r)){const p=Zye(r);l=this.bind({tools:[{type:"function",function:{name:s,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:s}}}),c=new Gc({returnSingle:!0,keyName:s,zodSchema:r})}else{let p;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(p=r,s=r.name):(s=r.title??s,p={name:s,description:r.description??"",parameters:r}),l=this.bind({tools:[{type:"function",function:p}],tool_choice:{type:"function",function:{name:s}}}),c=new Gc({returnSingle:!0,keyName:s})}if(!i)return l.pipe(c).withConfig({runName:"ChatGroqStructuredOutput"});const u=ji.assign({parsed:(p,m)=>c.invoke(p.raw,m)}),d=ji.assign({parsed:()=>null}),f=u.withFallbacks({fallbacks:[d]});return Ov.from([{raw:l},f]).withConfig({runName:"ChatGroqStructuredOutput"})}}class nf extends Error{constructor(t,n){super(n),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reply",{enumerable:!0,configurable:!0,writable:!0,value:""}),this.response=t}}const x9=["googleSearchRetrieval","googleSearch"],jge=["functionDeclaration","retrieval",...x9],Ege=Symbol("Let zodToJsonSchema decide on which parser to use"),Oge={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Cge=e=>({...Oge,...e}),kge=e=>{const t=Cge(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function _9(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Tt(e,t,n,r,a){e[t]=n,_9(e,t,r,a)}function Pge(){return{}}function Nge(e,t){var r,a,o;const n={type:"array"};return(r=e.type)!=null&&r._def&&((o=(a=e.type)==null?void 0:a._def)==null?void 0:o.typeName)!==ae.ZodAny&&(n.items=jt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Tt(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Tt(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Tt(n,"minItems",e.exactLength.value,e.exactLength.message,t),Tt(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function Mge(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Tt(n,"minimum",r.value,r.message,t):Tt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Tt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Tt(n,"maximum",r.value,r.message,t):Tt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Tt(n,"maximum",r.value,r.message,t));break;case"multipleOf":Tt(n,"multipleOf",r.value,r.message,t);break}return n}function Age(){return{type:"boolean"}}function S9(e,t){return jt(e.type._def,t)}const Tge=(e,t)=>jt(e.innerType._def,t);function j9(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>j9(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Rge(e,t)}}const Rge=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Tt(n,"minimum",r.value,r.message,t);break;case"max":Tt(n,"maximum",r.value,r.message,t);break}return n};function Ige(e,t){return{...jt(e.innerType._def,t),default:e.defaultValue()}}function Dge(e,t){return t.effectStrategy==="input"?jt(e.schema._def,t):{}}function Lge(e){return{type:"string",enum:Array.from(e.values)}}const $ge=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Fge(e,t){const n=[jt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),jt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if($ge(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Bge(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let Ej;const _a={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Ej===void 0&&(Ej=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Ej),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function E9(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":Tt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":Tt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":Sa(n,"email",r.message,t);break;case"format:idn-email":Sa(n,"idn-email",r.message,t);break;case"pattern:zod":Xn(n,_a.email,r.message,t);break}break;case"url":Sa(n,"uri",r.message,t);break;case"uuid":Sa(n,"uuid",r.message,t);break;case"regex":Xn(n,r.regex,r.message,t);break;case"cuid":Xn(n,_a.cuid,r.message,t);break;case"cuid2":Xn(n,_a.cuid2,r.message,t);break;case"startsWith":Xn(n,RegExp(`^${Oj(r.value,t)}`),r.message,t);break;case"endsWith":Xn(n,RegExp(`${Oj(r.value,t)}$`),r.message,t);break;case"datetime":Sa(n,"date-time",r.message,t);break;case"date":Sa(n,"date",r.message,t);break;case"time":Sa(n,"time",r.message,t);break;case"duration":Sa(n,"duration",r.message,t);break;case"length":Tt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),Tt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{Xn(n,RegExp(Oj(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&Sa(n,"ipv4",r.message,t),r.version!=="v4"&&Sa(n,"ipv6",r.message,t);break}case"base64url":Xn(n,_a.base64url,r.message,t);break;case"jwt":Xn(n,_a.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&Xn(n,_a.ipv4Cidr,r.message,t),r.version!=="v4"&&Xn(n,_a.ipv6Cidr,r.message,t);break}case"emoji":Xn(n,_a.emoji(),r.message,t);break;case"ulid":{Xn(n,_a.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{Sa(n,"binary",r.message,t);break}case"contentEncoding:base64":{Tt(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{Xn(n,_a.base64,r.message,t);break}}break}case"nanoid":Xn(n,_a.nanoid,r.message,t)}return n}function Oj(e,t){return t.patternStrategy==="escape"?Uge(e):e}const zge=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Uge(e){let t="";for(let n=0;n<e.length;n++)zge.has(e[n])||(t+="\\"),t+=e[n];return t}function Sa(e,t,n,r){var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Tt(e,"format",t,n,r)}function Xn(e,t,n,r){var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:O9(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Tt(e,"pattern",O9(t,r),n,r)}function O9(e,t){var c;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let a="",o=!1,i=!1,s=!1;for(let l=0;l<r.length;l++){if(o){a+=r[l],o=!1;continue}if(n.i){if(i){if(r[l].match(/[a-z]/)){s?(a+=r[l],a+=`${r[l-2]}-${r[l]}`.toUpperCase(),s=!1):r[l+1]==="-"&&((c=r[l+2])!=null&&c.match(/[a-z]/))?(a+=r[l],s=!0):a+=`${r[l]}${r[l].toUpperCase()}`;continue}}else if(r[l].match(/[a-z]/)){a+=`[${r[l]}${r[l].toUpperCase()}]`;continue}}if(n.m){if(r[l]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(r[l]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&r[l]==="."){a+=i?`${r[l]}\r
`:`[${r[l]}\r
]`;continue}a+=r[l],r[l]==="\\"?o=!0:i&&r[l]==="]"?i=!1:!i&&r[l]==="["&&(i=!0)}try{new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return a}function C9(e,t){var r,a,o,i,s,c;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===ae.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((l,u)=>({...l,[u]:jt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:jt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===ae.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const{type:l,...u}=E9(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((i=e.keyType)==null?void 0:i._def.typeName)===ae.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((s=e.keyType)==null?void 0:s._def.typeName)===ae.ZodBranded&&e.keyType._def.type._def.typeName===ae.ZodString&&((c=e.keyType._def.type._def.checks)!=null&&c.length)){const{type:l,...u}=S9(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function Vge(e,t){if(t.mapStrategy==="record")return C9(e,t);const n=jt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=jt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Wge(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function Hge(){return{not:{}}}function qge(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const hy={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Zge(e,t){if(t.target==="openApi3")return k9(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in hy&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=hy[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return k9(e,t)}const k9=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>jt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Kge(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:hy[e.innerType._def.typeName],nullable:!0}:{type:[hy[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=jt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=jt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Xge(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",_9(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Tt(n,"minimum",r.value,r.message,t):Tt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Tt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Tt(n,"maximum",r.value,r.message,t):Tt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Tt(n,"maximum",r.value,r.message,t));break;case"multipleOf":Tt(n,"multipleOf",r.value,r.message,t);break}return n}function Yge(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":jt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":jt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Jge(e,t){const n=t.target==="openAi",r={type:"object",...Object.entries(e.shape()).reduce((a,[o,i])=>{if(i===void 0||i._def===void 0)return a;let s=i.isOptional();s&&n&&(i instanceof g4e&&(i=i._def.innerType),i.isNullable()||(i=i.nullable()),s=!1);const c=jt(i._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});return c===void 0?a:{properties:{...a.properties,[o]:c},required:s?a.required:[...a.required,o]}},{properties:{},required:[]}),additionalProperties:Yge(e,t)};return r.required.length||delete r.required,r}const Qge=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return jt(e.innerType._def,t);const n=jt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Gge=(e,t)=>{if(t.pipeStrategy==="input")return jt(e.in._def,t);if(t.pipeStrategy==="output")return jt(e.out._def,t);const n=jt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=jt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function eve(e,t){return jt(e.type._def,t)}function tve(e,t){const n={type:"array",uniqueItems:!0,items:jt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Tt(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Tt(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function nve(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>jt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:jt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>jt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function rve(){return{not:{}}}function ave(){return{}}const ove=(e,t)=>jt(e.innerType._def,t);function jt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==Ege)return s}if(r&&!n){const s=ive(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=cve(e,e.typeName,t);return o&&lve(e,t,o),a.jsonSchema=o,o}const ive=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:sve(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},sve=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},cve=(e,t,n)=>{switch(t){case ae.ZodString:return E9(e,n);case ae.ZodNumber:return Xge(e,n);case ae.ZodObject:return Jge(e,n);case ae.ZodBigInt:return Mge(e,n);case ae.ZodBoolean:return Age();case ae.ZodDate:return j9(e,n);case ae.ZodUndefined:return rve();case ae.ZodNull:return qge(n);case ae.ZodArray:return Nge(e,n);case ae.ZodUnion:case ae.ZodDiscriminatedUnion:return Zge(e,n);case ae.ZodIntersection:return Fge(e,n);case ae.ZodTuple:return nve(e,n);case ae.ZodRecord:return C9(e,n);case ae.ZodLiteral:return Bge(e,n);case ae.ZodEnum:return Lge(e);case ae.ZodNativeEnum:return Wge(e);case ae.ZodNullable:return Kge(e,n);case ae.ZodOptional:return Qge(e,n);case ae.ZodMap:return Vge(e,n);case ae.ZodSet:return tve(e,n);case ae.ZodLazy:return jt(e.getter()._def,n);case ae.ZodPromise:return eve(e,n);case ae.ZodNaN:case ae.ZodNever:return Hge();case ae.ZodEffects:return Dge(e,n);case ae.ZodAny:return Pge();case ae.ZodUnknown:return ave();case ae.ZodDefault:return Ige(e,n);case ae.ZodBranded:return S9(e,n);case ae.ZodReadonly:return ove(e,n);case ae.ZodCatch:return Tge(e,n);case ae.ZodPipeline:return Gge(e,n);case ae.ZodFunction:case ae.ZodVoid:case ae.ZodSymbol:return;default:return(r=>{})()}},lve=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),uve=(e,t)=>{const n=kge(t),r=void 0,a=t==null?void 0:t.name,o=jt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i};function my(e){if(typeof e=="object"&&e!==null){const t={...e};"additionalProperties"in t&&delete t.additionalProperties;for(const n in t)n in t&&(Array.isArray(t[n])?t[n]=t[n].map(my):typeof t[n]=="object"&&t[n]!==null&&(t[n]=my(t[n])));return t}return e}function Cj(e){const t=my(uve(e)),{$schema:n,...r}=t;return r}function dve(e){const t=my(e),{$schema:n,...r}=t;return r}class P9{constructor(t){Object.defineProperty(this,"errorFinish",{enumerable:!0,configurable:!0,writable:!0,value:["SAFETY","RECITATION","OTHER"]}),this.errorFinish=(t==null?void 0:t.errorFinish)??this.errorFinish}handleDataPromptFeedback(t,n){var a;const r=(a=n==null?void 0:n.promptFeedback)==null?void 0:a.blockReason;if(r)throw new nf(t,`Prompt blocked: ${r}`);return n}handleDataFinishReason(t,n){var a,o;const r=(o=(a=n==null?void 0:n.candidates)==null?void 0:a[0])==null?void 0:o.finishReason;if(this.errorFinish.includes(r))throw new nf(t,`Finish reason: ${r}`);return n}handleData(t,n){let r=n;return r=this.handleDataPromptFeedback(t,r),r=this.handleDataFinishReason(t,r),r}handle(t){let n;if("nextChunk"in t.data)n=t.data;else if(Array.isArray(t.data))try{n=t.data.map(r=>this.handleData(t,r))}catch(r){throw r instanceof nf?new nf(t,r.message):r}else{const r=t.data;n=this.handleData(t,r)}return{...t,data:n}}}const fve=e=>e.startsWith("data:")?{mimeType:e.split(":")[1].split(";")[0],data:e.split(",")[1]}:null;function N9(e){function t(z){return z!=null&&z.text&&(z==null?void 0:z.text.length)>0?{text:z.text}:null}function n(z){const J=typeof z.image_url=="string"?z.image_url:z.image_url.url;if(!J)throw new Error("Missing Image URL");const fe=fve(J);return fe?{inlineData:fe}:{fileData:{mimeType:"image/png",fileUri:J}}}async function r(z){return{fileData:{fileUri:z.path,mimeType:z.mimetype}}}async function a(z){var J;return(J=e==null?void 0:e.mediaManager)==null?void 0:J.getMediaBlob(z)}async function o(z){if("mimeType"in z&&"data"in z)return{inlineData:{mimeType:z.mimeType,data:z.data}};if("mimeType"in z&&"fileUri"in z)return{fileData:{mimeType:z.mimeType,fileUri:z.fileUri}};{const J=z.fileUri,fe=await a(J);if(fe)return await r(fe)}throw new Error(`Invalid media content: ${JSON.stringify(z,null,1)}`)}async function i(z){switch(z.type){case"text":if("text"in z)return t(z);break;case"image_url":if("image_url"in z)return n(z);break;case"media":return await o(z);default:throw new Error(`Unsupported type "${z.type}" received while converting message to message parts: ${z}`)}throw new Error(`Cannot coerce "${z.type}" message part into a string.`)}async function s(z){const J=z.map(i);return Promise.all(J)}async function c(z){return(await s(typeof z=="string"?[{type:"text",text:z}]:z)).reduce((J,fe)=>fe?[...J,fe]:J,[])}function l(z){return!z||z.length===0?[]:z.map(J=>{var ve;let fe={};if((ve=J==null?void 0:J.function)!=null&&ve.arguments){const Ie=J.function.arguments;fe=JSON.parse(Ie)}return{functionCall:{name:J.function.name,args:fe}}})}function u(z){const J=[];return z!=null&&z.tool_calls&&J.push(...l(z.tool_calls)),J}async function d(z,J){var Ke;const fe=await c(J.content);let ve;su(J)&&((Ke=J.tool_calls)!=null&&Ke.length)?ve=J.tool_calls.map(Xe=>({functionCall:{name:Xe.name,args:Xe.args}})):ve=u(J.additional_kwargs);const Ie=[...fe,...ve];return[{role:z,parts:Ie}]}async function f(z){return e!=null&&e.useSystemInstruction?d("system",z):[...await d("user",z),...await d("model",new qr("Ok"))]}function p(z,J){var Ie;const fe=typeof z.content=="string"?z.content:z.content.reduce((Ke,Xe)=>Xe.type==="text"?Ke+Xe.text:Ke,""),ve=(su(J)&&((Ie=J.tool_calls)!=null&&Ie.length)?J.tool_calls[0].name:J.name)??z.tool_call_id;try{const Ke=JSON.parse(fe);return[{role:"function",parts:[{functionResponse:{name:ve,response:{content:Ke}}}]}]}catch{return[{role:"function",parts:[{functionResponse:{name:ve,response:{content:fe}}}]}]}}async function m(z,J){const fe=z._getType();switch(fe){case"system":return f(z);case"human":return d("user",z);case"ai":return d("model",z);case"tool":if(!J)throw new Error("Tool messages cannot be the first message passed to the model.");return p(z,J);default:return console.log(`Unsupported message type: ${fe}`),[]}}function y(z){return{type:"text",text:z.text}}function v(z){return{type:"image_url",image_url:`data:${z.inlineData.mimeType};base64,${z.inlineData.data}`}}function b(z){return{type:"image_url",image_url:z.fileData.fileUri}}function w(z){return z.map(J=>J==null?null:"text"in J?y(J):"inlineData"in J?v(J):"fileData"in J?b(J):null).reduce((J,fe)=>(fe&&J.push(fe),J),[])}function _(z){return{id:z.id,type:z.type,function:{name:z.function.name,arguments:JSON.stringify(z.function.arguments)}}}function x(z){return{id:v4e().replace(/-/g,""),type:"function",function:{name:z.functionCall.name,arguments:z.functionCall.args??{}}}}function S(z){return z.map(J=>J==null?null:"functionCall"in J?x(J):null).reduce((J,fe)=>(fe&&J.push(fe),J),[])}function j(z){return z.map(J=>_(J))}function E(z){if("nextChunk"in z.data)throw new Error("Cannot convert Stream to GenerateContentResponseData");return Array.isArray(z.data)?z.data.reduce((J,fe)=>{var Ie,Ke,Xe;const ve=((Xe=(Ke=(Ie=fe==null?void 0:fe.candidates)==null?void 0:Ie[0])==null?void 0:Ke.content)==null?void 0:Xe.parts)??[];return J.candidates[0].content.parts.push(...ve),J.promptFeedback=fe.promptFeedback,J}):z.data}function O(z){var J,fe,ve,Ie;return((Ie=(ve=(fe=(J=E(z))==null?void 0:J.candidates)==null?void 0:fe[0])==null?void 0:ve.content)==null?void 0:Ie.parts)??[]}function P(z){return"text"in z?z.text:""}function k(z){return O(z).reduce((J,fe)=>{const ve=P(fe);return J+ve},"")}function N(z,J){const fe=(e==null?void 0:e.safetyHandler)??new P9;try{const ve=fe.handle(z);return J(ve)}catch(ve){if(ve instanceof nf){const Ie=J(ve.response);ve.reply=Ie}throw ve}}function R(z){return N(z,k)}function M(z){const J=z==null?void 0:z.token,fe=z==null?void 0:z.logProbability,ve=new TextEncoder,Ie=Array.from(ve.encode(J));return{token:J,logprob:fe,bytes:Ie}}function C(z){var Ke;const J=z==null?void 0:z.logprobsResult,fe=(J==null?void 0:J.chosenCandidates)??[],ve=(J==null?void 0:J.topCandidates)??[],Ie=[];for(let Xe=0;Xe<fe.length;Xe+=1){const ut=fe[Xe],Q=((Ke=ve[Xe])==null?void 0:Ke.candidates)??[],ne=M(ut);ne.top_logprobs=Q.map(se=>M(se)),Ie.push(ne)}return{content:Ie}}function T(z){var fe,ve,Ie,Ke,Xe,ut,Q,ne,se;if(!Array.isArray(z.data))return{};const J=z.data[0];return{usage_metadata:{prompt_token_count:(fe=J.usageMetadata)==null?void 0:fe.promptTokenCount,candidates_token_count:(ve=J.usageMetadata)==null?void 0:ve.candidatesTokenCount,total_token_count:(Ie=J.usageMetadata)==null?void 0:Ie.totalTokenCount},safety_ratings:(Xe=(Ke=J.candidates[0])==null?void 0:Ke.safetyRatings)==null?void 0:Xe.map(ye=>({category:ye.category,probability:ye.probability,probability_score:ye.probabilityScore,severity:ye.severity,severity_score:ye.severityScore})),citation_metadata:(ut=J.candidates[0])==null?void 0:ut.citationMetadata,grounding_metadata:(Q=J.candidates[0])==null?void 0:Q.groundingMetadata,finish_reason:(ne=J.candidates[0])==null?void 0:ne.finishReason,avgLogprobs:(se=J.candidates[0])==null?void 0:se.avgLogprobs,logprobs:C(J.candidates[0])}}function A(z){return new Vn({text:k(z),message:D(O(z)[0]),generationInfo:T(z)})}function I(z){return N(z,A)}function F(z){if(z===null)return"";if(typeof z.content=="string")return z.content;if(z.content.length===0)return"";if(z.content[0].type==="text")return z.content[0].text;throw new Error(`Unexpected chunk: ${z}`)}function D(z){const J=L([z]);if(typeof J.content=="string")return new Hr(J);if(J.content.every(fe=>fe.type==="text")){const fe=J.content.map(ve=>"text"in ve?ve.text:"").join("");return new Hr({...J,content:fe})}return new Hr(J)}function V(z){const J=D(z),fe=P(z);return new Vn({text:fe,message:J})}function U(z){const J=[];return!z||z.length===0?[]:(z==null||z.forEach(fe=>{var Ie;const ve=((Ie=fe==null?void 0:fe.segment)==null?void 0:Ie.partIndex)??0;J[ve]?J[ve].push(fe):J[ve]=[fe]}),J)}function B(z){var Xe,ut;const J=O(z);if(J.length===0)return[];const fe=(ut=(Xe=z==null?void 0:z.data)==null?void 0:Xe.candidates)==null?void 0:ut[0],ve=fe==null?void 0:fe.groundingMetadata,Ie=fe==null?void 0:fe.citationMetadata,Ke=U(ve==null?void 0:ve.groundingSupports);return J.map((Q,ne)=>{const se=V(Q);if(se.generationInfo||(se.generationInfo={}),ve){se.generationInfo.groundingMetadata=ve;const ye=Ke[ne];ye&&(se.generationInfo.groundingSupport=ye)}return Ie&&(se.generationInfo.citationMetadata=Ie),se})}function K(z){var Ke,Xe,ut,Q,ne,se;let J=B(z);if(J.length===0)return[];if(J.every(ye=>typeof ye.message.content=="string")){const ye=J.map(We=>We.message.content).join(""),De=J.map(We=>We.text).join(""),qt=(ut=(Xe=(Ke=J[J.length-1])==null?void 0:Ke.message.additional_kwargs)==null?void 0:Xe.tool_calls)==null?void 0:ut.map((We,xe)=>({name:We.function.name,args:We.function.arguments,id:We.id,index:xe,type:"tool_call_chunk"}));let $t;"usageMetadata"in z.data&&($t={input_tokens:z.data.usageMetadata.promptTokenCount,output_tokens:z.data.usageMetadata.candidatesTokenCount,total_tokens:z.data.usageMetadata.totalTokenCount}),J=[new Vn({message:new Hr({content:ye,additional_kwargs:(Q=J[J.length-1])==null?void 0:Q.message.additional_kwargs,tool_call_chunks:qt,usage_metadata:$t}),text:De,generationInfo:J[J.length-1].generationInfo})]}const fe=(se=(ne=z==null?void 0:z.data)==null?void 0:ne.candidates)==null?void 0:se[0],ve=fe==null?void 0:fe.avgLogprobs,Ie=C(fe);return Ie&&(J[0].message.response_metadata={...J[0].message.response_metadata,logprobs:Ie,avgLogprobs:ve}),J}function te(z){const J=O(z);return L(J)}function L(z){var ve,Ie,Ke;const J={content:w(z),tool_call_chunks:[],tool_calls:[],invalid_tool_calls:[]},fe=S(z);if(fe.length>0){const Xe=j(fe);for(const ut of Xe){(ve=J.tool_call_chunks)==null||ve.push({name:ut.function.name,args:ut.function.arguments,id:ut.id,type:"tool_call_chunk"});try{(Ie=J.tool_calls)==null||Ie.push({name:ut.function.name,args:JSON.parse(ut.function.arguments),id:ut.id})}catch(Q){(Ke=J.invalid_tool_calls)==null||Ke.push({name:ut.function.name,args:ut.function.arguments,id:ut.id,error:Q.message,type:"invalid_tool_call"})}}J.additional_kwargs={tool_calls:Xe}}return J}function $(z){const J=te(z);return new qr(J)}function W(z){return N(z,$)}function q(z){return{generations:K(z),llmOutput:T(z)}}function Z(z){return N(z,q)}function ee(z){if(typeof z=="string")return"MessageContent";{const J=z[0];return Object.hasOwn(J,"content")?"BaseMessageArray":"MessageContent"}}async function oe(z,J){return[{role:"user",parts:await c(z)}]}async function H(z,J){const fe=z.map((ve,Ie)=>m(ve,z[Ie-1]));return(await Promise.all(fe)).reduce((ve,Ie)=>{var Ke;return Ie.every(Xe=>Xe.role==="system")||(((Ke=Ie[0])==null?void 0:Ke.role)==="function"&&ve.length>0&&ve[ve.length-1].role==="function"?ve[ve.length-1].parts=[...ve[ve.length-1].parts,...Ie[0].parts]:ve.push(...Ie)),ve},[])}async function le(z,J){const fe=ee(z);switch(fe){case"MessageContent":return oe(z);case"BaseMessageArray":return H(z);default:throw new Error(`Unknown input type "${fe}": ${z}`)}}function ie(z){const J={temperature:z.temperature,topK:z.topK,topP:z.topP,presencePenalty:z.presencePenalty,frequencyPenalty:z.frequencyPenalty,maxOutputTokens:z.maxOutputTokens,stopSequences:z.stopSequences,responseMimeType:z.responseMimeType};return typeof z.logprobs<"u"&&(J.responseLogprobs=z.logprobs,z.logprobs&&typeof z.topLogprobs<"u"&&(J.logprobs=z.topLogprobs)),J}function pe(z){return z.safetySettings??[]}async function Oe(z){let J={};for(let fe=0;fe<z.length;fe+=1){const ve=z[fe];if(ve._getType()==="system")if(fe===0)J=(await m(ve,void 0))[0];else throw new Error("System messages are only permitted as the first passed message.")}return J}async function Ue(z){if(!(e!=null&&e.useSystemInstruction))return{};switch(ee(z)){case"BaseMessageArray":return Oe(z);default:return{}}}function Ve(z){const J=Cj(z.schema);return{name:z.name,description:z.description??"A function available to call.",parameters:J}}function Ce(z){for(const J of x9)if(J in z)return J}function Ze(z){const J=Ce(z),fe=e==null?void 0:e.googleSearchToolAdjustment;return J&&fe&&fe!==J?{[fe]:{}}:z}function Je(z){const J=z==null?void 0:z.tools;if(!J||J.length===0)return[];const fe=[],ve=[];J.forEach(Ke=>{Gm(Ke)?fe.push(Ke):ve.push(Ze(Ke))});const Ie=[...ve];return fe.length>0&&Ie.push({functionDeclarations:fe.map(Ve)}),Ie}function Qe(z){if(!(!z.tool_choice||typeof z.tool_choice!="string"))return["auto","any","none"].includes(z.tool_choice)?{functionCallingConfig:{mode:z.tool_choice,allowedFunctionNames:z.allowed_function_names}}:{functionCallingConfig:{mode:"any",allowedFunctionNames:[z.tool_choice]}}}async function Rt(z,J){var se;const fe=z,ve=await le(fe),Ie=ie(J),Ke=Je(J),Xe=Qe(J),ut=pe(J),Q=await Ue(fe),ne={contents:ve,generationConfig:Ie};return Ke&&Ke.length&&(ne.tools=Ke),Xe&&(ne.toolConfig=Xe),ut&&ut.length&&(ne.safetySettings=ut),Q!=null&&Q.role&&(Q!=null&&Q.parts)&&((se=Q==null?void 0:Q.parts)!=null&&se.length)&&(ne.systemInstruction=Q),ne}return{messageContentToParts:c,baseMessageToContent:m,responseToString:R,responseToChatGeneration:I,chunkToString:F,responseToBaseMessage:W,responseToChatResult:Z,formatData:Rt}}function pve(e){if(e.maxOutputTokens&&e.maxOutputTokens<0)throw new Error("`maxOutputTokens` must be a positive integer");if(e.temperature&&(e.temperature<0||e.temperature>2))throw new Error("`temperature` must be in the range of [0.0,2.0]");if(e.topP&&(e.topP<0||e.topP>1))throw new Error("`topP` must be in the range of [0.0,1.0]");if(e.topK&&e.topK<0)throw new Error("`topK` must be a positive integer")}function hve(e){return e.toLowerCase().startsWith("gemini")}function mve(e){function t(L){return"text"in L?L.text:""}function n(L){return((L==null?void 0:L.content)??[]).reduce(($,W)=>{const q=t(W);return $+q},"")}function r(L){const $=L.data;switch($==null?void 0:$.type){case"message":return n($);default:throw Error(`Unknown type: ${$==null?void 0:$.type}`)}}function a(L){if(typeof L=="string")return new Hr(L);const $={...L};if(Array.isArray(L==null?void 0:L.content)){let W="";L.content.forEach(q=>{W!==void 0&&q.type==="text"?W=`${W}${q.text}`:W=void 0}),W&&($.content=W)}return new Hr($)}function o(L){return{content:[L]}}function i(L){const $={id:L.id,name:L.name,type:"tool_call",args:L.input};return{content:[],tool_calls:[$]}}function s(L){switch(L==null?void 0:L.type){case"text":return o(L);case"tool_use":return i(L);default:return}}function c(L){const $=[],W=[];return L.forEach(q=>{const Z=s(q);Z!=null&&Z.content&&$.push(...Z.content),Z!=null&&Z.tool_calls&&W.push(...Z.tool_calls)}),a({content:$,tool_calls:W})}function l(L){const $=L==null?void 0:L.usage;return{usage_metadata:{input_tokens:($==null?void 0:$.input_tokens)??0,output_tokens:($==null?void 0:$.output_tokens)??0,total_tokens:(($==null?void 0:$.input_tokens)??0)+(($==null?void 0:$.output_tokens)??0)},finish_reason:L.stop_reason}}function u(L){const $=(L==null?void 0:L.content)??[],W=n(L),q=c($),Z=l(L);return new Vn({text:W,message:q,generationInfo:Z})}function d(L){const $=L.message;return u($)}function f(L){const $=L.delta;return u($)}function p(L){const $=L.content_block,W=c([$]);if(!W)return null;const q="text"in $?$.text:"";return new Vn({message:W,text:q})}function m(L){const $=L.content_block,W="",q={type:"tool_call_chunk",index:L.index,name:$.name,id:$.id};typeof $.input=="object"&&Object.keys($.input).length>0&&(q.args=JSON.stringify($.input));const Z=[q],ee={content:[{index:L.index,...$}],tool_call_chunks:Z},oe=a(ee);return new Vn({message:oe,text:W})}function y(L){switch(L.content_block.type){case"text":return p(L);case"tool_use":return m(L);default:return console.warn(`Unexpected start content_block type: ${JSON.stringify(L)}`),null}}function v(L){var q;const $=(q=L.delta)==null?void 0:q.text,W=a($);return new Vn({message:W,text:$})}function b(L){const $=L.delta,W="",q=[{index:L.index,args:$.partial_json}],Z={content:[{index:L.index,...$}],tool_call_chunks:q},ee=a(Z);return new Vn({message:ee,text:W})}function w(L){switch(L.delta.type){case"text_delta":return v(L);case"input_json_delta":return b(L);default:return console.warn(`Unexpected delta content_block type: ${JSON.stringify(L)}`),null}}function _(L){const $=L.data;switch($.type){case"message":return u($);case"message_start":return d($);case"message_delta":return f($);case"content_block_start":return y($);case"content_block_delta":return w($);case"ping":case"message_stop":case"content_block_stop":return null;case"error":throw new Error(`Error while streaming results: ${JSON.stringify($)}`);default:return console.warn("Unknown data for responseToChatGeneration",$),null}}function x(L){if(L===null)return"";if(typeof L.content=="string")return L.content;if(L.content.length===0)return"";if(L.content[0].type==="text")return L.content[0].text;throw new Error(`Unexpected chunk: ${L}`)}function S(L){var W;const $=((W=L.data)==null?void 0:W.content)??[];return c($)}function j(L){const $=L.data,W=[],q=_(L);q&&W.push(q);const Z=l($);return{generations:W,llmOutput:Z}}function E(){return(e==null?void 0:e.version)??"vertex-2023-10-16"}function O(L){return L}function P(L){return L.startsWith("data:")?{media_type:L.split(":")[1].split(";")[0],data:L.split(",")[1]}:null}function k(L){const $=L.image_url,W=typeof $=="string"?$:$==null?void 0:$.url,q=P(W);if(q)return{type:"image",source:{type:"base64",...q}}}function N(L){const $=L==null?void 0:L.type;switch($){case"text":return L;case"image_url":return k(L);default:console.warn(`Unexpected content type: ${$}`);return}}function R(L){const $=[];return(typeof L=="string"?[{type:"text",text:L}]:L).forEach(W=>{const q=N(W);q&&$.push(q)}),$}function M(L,$){const W=R(L.content);return{role:$,content:W}}function C(L){const $="user",W=L.tool_call_id,q=R(L.content);return{role:$,content:[{type:"tool_result",tool_use_id:W,content:q}]}}function T(L){switch(L._getType()){case"human":return M(L,"user");case"ai":return M(L,"assistant");case"tool":return C(L);default:return}}function A(L){const $=[];return L.forEach(W=>{const q=T(W);q&&$.push(q)}),$}function I(L){const $={stream:(L==null?void 0:L.streaming)??!1,max_tokens:(L==null?void 0:L.maxOutputTokens)??8192};return L.topP&&($.top_p=L.topP),L.topK&&($.top_k=L.topK),L.temperature&&($.temperature=L.temperature),L.stopSequences&&($.stop_sequences=L.stopSequences),$}function F(L){let $="";return L.forEach(W=>{(W==null?void 0:W.type)==="text"&&($=`${$}
${W.text}`)}),$}function D(L){let $="";return L.forEach(W=>{if(W._getType()==="system"){const q=W==null?void 0:W.content,Z=typeof q=="string"?q:F(q);$=`${$}
${Z}`}}),$}function V(L){return Object.hasOwn(L,"functionDeclarations")?((L==null?void 0:L.functionDeclarations)??[]).map($=>{const W=$.parameters;return{name:$.name,description:$.description,input_schema:W}}):(console.warn(`Unable to format GeminiTool: ${JSON.stringify(L,null,1)}`),[])}function U(L){return Object.hasOwn(L,"name")?[L]:V(L)}function B(L){const $=(L==null?void 0:L.tools)??[],W=[];return $.forEach(q=>{U(q).forEach(Z=>{Z&&W.push(Z)})}),W}function K(L){const $=L==null?void 0:L.tool_choice;if($){if(typeof $=="object")return $;switch($){case"any":case"auto":return{type:$};case"none":return;default:return{type:"tool",name:$}}}else return}async function te(L,$){const W=L,q=E(),Z=A(W),ee=I($),oe=D(W),H=B($),le=K($),ie={anthropic_version:q,messages:Z,...ee};return H&&H.length&&($==null?void 0:$.tool_choice)!=="none"&&(ie.tools=H),le&&(ie.tool_choice=le),oe!=null&&oe.length&&(ie.system=oe),ie}return{responseToString:r,responseToChatGeneration:_,chunkToString:x,responseToBaseMessage:S,responseToChatResult:j,formatData:te}}function yve(e){return e.toLowerCase().startsWith("claude")}function gve(e,t){return A9(e,t,{})}function vve(e,t){if(!e)return t?{tool_choice:"any",allowed_function_names:t}:void 0;if(e==="any"||e==="auto"||e==="none")return{tool_choice:e,allowed_function_names:t};if(typeof e=="string")return{tool_choice:"any",allowed_function_names:[...t??[],e]};throw new Error("Object inputs for tool_choice not supported.")}function bve(e){for(const t of jge)if(t in e)return!0;return!1}function wve(e){return bve(e)&&!("functionDeclaration"in e)}function M9(e){const t=[];let n=-1;return e.forEach(r=>{if(wve(r))t.push(r);else if(n===-1&&(t.push({functionDeclarations:[]}),n=t.length-1),"functionDeclarations"in r&&Array.isArray(r.functionDeclarations)){const a=r.functionDeclarations;t[n].functionDeclarations.push(...a)}else if(Gm(r)){const a=Cj(r.schema);t[n].functionDeclarations.push({name:r.name,description:r.description??"A function available to call.",parameters:a})}else if(p8(r))t[n].functionDeclarations.push({name:r.function.name,description:r.function.description??"A function available to call.",parameters:dve(r.function.parameters)});else throw new Error(`Received invalid tool: ${JSON.stringify(r)}`)}),t}function A9(e,t,n){const r=n||{},a=(t==null?void 0:t.model)??(e==null?void 0:e.model)??n.model;r.modelName=a??(t==null?void 0:t.modelName)??(e==null?void 0:e.modelName)??n.modelName,r.model=a,r.temperature=(t==null?void 0:t.temperature)??(e==null?void 0:e.temperature)??n.temperature,r.maxOutputTokens=(t==null?void 0:t.maxOutputTokens)??(e==null?void 0:e.maxOutputTokens)??n.maxOutputTokens,r.topP=(t==null?void 0:t.topP)??(e==null?void 0:e.topP)??n.topP,r.topK=(t==null?void 0:t.topK)??(e==null?void 0:e.topK)??n.topK,r.presencePenalty=(t==null?void 0:t.presencePenalty)??(e==null?void 0:e.presencePenalty)??n.presencePenalty,r.frequencyPenalty=(t==null?void 0:t.frequencyPenalty)??(e==null?void 0:e.frequencyPenalty)??n.frequencyPenalty,r.stopSequences=(t==null?void 0:t.stopSequences)??(e==null?void 0:e.stopSequences)??n.stopSequences,r.safetySettings=(t==null?void 0:t.safetySettings)??(e==null?void 0:e.safetySettings)??n.safetySettings,r.logprobs=(t==null?void 0:t.logprobs)??(e==null?void 0:e.logprobs)??n.logprobs,r.topLogprobs=(t==null?void 0:t.topLogprobs)??(e==null?void 0:e.topLogprobs)??n.topLogprobs,r.convertSystemMessageToHumanContent=(t==null?void 0:t.convertSystemMessageToHumanContent)??(e==null?void 0:e.convertSystemMessageToHumanContent)??(n==null?void 0:n.convertSystemMessageToHumanContent),r.responseMimeType=(t==null?void 0:t.responseMimeType)??(e==null?void 0:e.responseMimeType)??(n==null?void 0:n.responseMimeType),r.streaming=(t==null?void 0:t.streaming)??(e==null?void 0:e.streaming)??(n==null?void 0:n.streaming);const o=vve(t==null?void 0:t.tool_choice,t==null?void 0:t.allowed_function_names);o&&(r.tool_choice=o.tool_choice,r.allowed_function_names=o.allowed_function_names);const i=t==null?void 0:t.tools;return i&&(r.tools=M9(i)),r}function kj(e){return e?hve(e)?"gemini":yve(e)?"claude":null:null}function xve(e){switch(kj(e)){case"gemini":case"palm":return"google";case"claude":return"anthropic";default:return"unknown"}}function _ve(e){const t=e??{},n=t.model??t.modelName;switch(kj(n)){case"gemini":return pve(t);case"claude":return;default:throw new Error(`Unable to verify model params: ${JSON.stringify(e)}`)}}function Sve(e,t){return A9(e,void 0,t),_ve(t),t}const jve=[400,401,402,403,404,405,406,407,408,409];function Eve(e){var n;const t=((n=e==null?void 0:e.response)==null?void 0:n.status)??0;if(t===0)throw console.error("failedAttemptHandler",e),e;if(jve.includes(+t))throw e}function Ove(e){return{onFailedAttempt:Eve,...e??{}}}class Cve{constructor(){Object.defineProperty(this,"_buffer",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_bufferOpen",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_firstRun",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_chunkResolution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_chunkPending",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_chunkQueue",{enumerable:!0,configurable:!0,writable:!0,value:[]})}appendBuffer(t){this._buffer+=t,this._firstRun&&(this._skipTo("["),this._firstRun=!1),this._parseBuffer()}closeBuffer(){this._bufferOpen=!1,this._parseBuffer()}_parseBuffer(){let t=null;do if(this._skipTo("{"),t=this._getFullObject(),t!==null){const n=this._simplifyObject(t);this._handleChunk(n)}while(t!==null);this._bufferOpen||(this._handleChunk(null),this._buffer="")}_skipTo(t){const n=this._buffer.indexOf(t);n>0&&(this._buffer=this._buffer.slice(n))}_getFullObject(){let t=null,n=0;for(;t===null&&this._buffer.length>n;){if(n=this._buffer.indexOf("}",n+1),n===-1)return null;try{const r=this._buffer.substring(0,n+1);t=JSON.parse(r),this._buffer=this._buffer.slice(n+1)}catch{}}return t}_simplifyObject(t){return t}_handleChunk(t){this._chunkPending?(this._chunkResolution(t),this._chunkPending=null):this._chunkQueue.push(t)}async nextChunk(){return this._chunkQueue.length>0?this._chunkQueue.shift():(this._chunkPending=new Promise(t=>{this._chunkResolution=t}),this._chunkPending)}get streamDone(){return!this._bufferOpen&&this._buffer.length===0&&this._chunkQueue.length===0&&this._chunkPending===null}}class kve{constructor(t,n){Object.defineProperty(this,"baseStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"decoder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.baseStream=t,this.decoder=new TextDecoder("utf-8"),n?this.run(n):console.error("Unexpected empty body while streaming")}appendBuffer(t){return this.baseStream.appendBuffer(t)}closeBuffer(){return this.baseStream.closeBuffer()}nextChunk(){return this.baseStream.nextChunk()}get streamDone(){return this.baseStream.streamDone}async run(t){const n=t.getReader();let r=!1;for(;!r;){const{value:a,done:o}=await n.read();if(o)r=o,this.closeBuffer();else{const i=this.decoder.decode(a,{stream:!0});this.appendBuffer(i)}}}}class Pve extends kve{constructor(t){super(new Cve,t)}}class Nve{constructor(t,n,r){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=t,this.client=n,this.streaming=r??!1}async _clientInfoHeaders(){const{userAgent:t,clientLibraryVersion:n}=await this._getClientInfo();return{"User-Agent":t,"Client-Info":n}}async _getClientInfo(){var o;const t=((o=await b4e())==null?void 0:o.library)??"langchain-js",n="0",r=await this._moduleName();let a=`${t}/${n}`;return r&&r.length&&(a=`${a}-${r}`),{userAgent:a,clientLibraryVersion:`${n}-${r}`}}async _moduleName(){return this.constructor.name}async additionalHeaders(){return{}}async _buildOpts(t,n,r={}){const a=await this.buildUrl(),o=this.buildMethod(),i=await this._clientInfoHeaders()??{},s=await this.additionalHeaders()??{},c={...i,...s,...r},l={url:a,method:o,headers:c};return t&&o==="POST"&&(l.data=t),this.streaming?l.responseType="stream":l.responseType="json",l}async _request(t,n,r={}){const a=await this._buildOpts(t,n,r);return await this.caller.callWithOptions({signal:n==null?void 0:n.signal},async()=>this.client.request(a))}}class Mve extends Nve{constructor(t,n,r,a){super(n,r,a),Object.defineProperty(this,"platformType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_endpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_location",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiVersion",{enumerable:!0,configurable:!0,writable:!0,value:"v1"}),this.caller=n,this.platformType=t==null?void 0:t.platformType,this._endpoint=t==null?void 0:t.endpoint,this._location=t==null?void 0:t.location,this.apiVersion=(t==null?void 0:t.apiVersion)??this.apiVersion,this.client=r}get platform(){return this.platformType??this.computedPlatformType}get computedPlatformType(){return"gcp"}get location(){return this._location??this.computedLocation}get computedLocation(){return"us-central1"}get endpoint(){return this._endpoint??this.computedEndpoint}get computedEndpoint(){return`${this.location}-aiplatform.googleapis.com`}buildMethod(){return"POST"}}class Ave extends Mve{constructor(t,n,r,a){super(t,n,r,a),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_apiName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.client=r,this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this._apiName=t==null?void 0:t.apiName,this.apiConfig={safetyHandler:t==null?void 0:t.safetyHandler,...t==null?void 0:t.apiConfig}}get modelFamily(){return kj(this.model)}get modelPublisher(){return xve(this.model)}get computedAPIName(){return this.modelPublisher}get apiName(){return this._apiName??this.computedAPIName}get api(){switch(this.apiName){case"google":return N9(this.apiConfig);case"anthropic":return mve(this.apiConfig);default:throw new Error(`Unknown API: ${this.apiName}`)}}get computedPlatformType(){return this.client.clientType==="apiKey"?"gai":"gcp"}get computedLocation(){switch(this.apiName){case"google":return super.computedLocation;case"anthropic":return"us-east5";default:throw new Error(`Unknown apiName: ${this.apiName}. Can't get location.`)}}async buildUrlGenerativeLanguage(){const t=await this.buildUrlMethod();return`https://generativelanguage.googleapis.com/${this.apiVersion}/models/${this.model}:${t}`}async buildUrlVertex(){const t=await this.client.getProjectId(),n=await this.buildUrlMethod(),r=this.modelPublisher;return`https://${this.endpoint}/${this.apiVersion}/projects/${t}/locations/${this.location}/publishers/${r}/models/${this.model}:${n}`}async buildUrl(){switch(this.platform){case"gai":return this.buildUrlGenerativeLanguage();default:return this.buildUrlVertex()}}async request(t,n,r,a){const o=this.constructor.name,i={...n,streaming:this.streaming},s=await this.formatData(t,i);await(a==null?void 0:a.handleCustomEvent(`google-request-${o}`,{data:s,parameters:i,options:r,connection:{...this,url:await this.buildUrl(),urlMethod:await this.buildUrlMethod(),modelFamily:this.modelFamily,modelPublisher:this.modelPublisher,computedPlatformType:this.computedPlatformType}}));const c=await this._request(s,r);return await(a==null?void 0:a.handleCustomEvent(`google-response-${o}`,{response:c})),c}}class Tve extends Ave{async buildUrlMethodGemini(){return this.streaming?"streamGenerateContent":"generateContent"}async buildUrlMethodClaude(){return this.streaming?"streamRawPredict":"rawPredict"}async buildUrlMethod(){switch(this.modelFamily){case"gemini":return this.buildUrlMethodGemini();case"claude":return this.buildUrlMethodClaude();default:throw new Error(`Unknown model family: ${this.modelFamily}`)}}async formatData(t,n){return this.api.formatData(t,n)}}class T9{async _buildData(t,n){switch(n.responseType){case"json":return t.json();case"stream":return new Pve(t.body);default:return t.blob()}}async _request(t,n,r){if(t==null)throw new Error("Missing URL");const a={method:n.method,headers:{"Content-Type":"application/json",...n.headers??{},...r??{}}};n.data!==void 0&&(typeof n.data=="string"?a.body=n.data:a.body=JSON.stringify(n.data));const o=await fetch(t,a);if(!o.ok){const i=await o.text(),s=new Error(`Google request failed with status code ${o.status}: ${i}`);throw s.response=o,s.details={url:t,opts:n,fetchOptions:a,result:o},s}return{data:await this._buildData(o,n),config:{},status:o.status,statusText:o.statusText,headers:o.headers,request:{responseURL:o.url}}}}class Rve extends T9{constructor(t){super(),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.apiKey=t}get clientType(){return"apiKey"}getProjectId(){throw new Error("APIs that require a project ID cannot use an API key")}request(t){const n={"X-Goog-Api-Key":this.apiKey};return this._request(t.url,t,n)}}function Ive(e){switch(e){case"gai":return["https://www.googleapis.com/auth/generative-language"];default:return["https://www.googleapis.com/auth/cloud-platform"]}}function Dve(e,t,n){if(e&&Object.hasOwn(e,t))return e;const r=Array.isArray(n)?n:Ive(n??"gcp");return{[t]:r,...e??{}}}class R9 extends Tve{constructor(t,n,r,a){super(t,n,r,a),Object.defineProperty(this,"convertSystemMessageToHumanContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.convertSystemMessageToHumanContent=t==null?void 0:t.convertSystemMessageToHumanContent}get useSystemInstruction(){return typeof this.convertSystemMessageToHumanContent=="boolean"?!this.convertSystemMessageToHumanContent:this.computeUseSystemInstruction}get computeUseSystemInstruction(){return this.modelFamily==="palm"||this.modelName==="gemini-1.0-pro-001"||this.modelName.startsWith("gemini-pro-vision")||this.modelName.startsWith("gemini-1.0-pro-vision")?!1:!(this.modelName==="gemini-pro"&&this.platform==="gai")}computeGoogleSearchToolAdjustmentFromModel(){return this.modelName.startsWith("gemini-1.0")||this.modelName.startsWith("gemini-1.5")?"googleSearchRetrieval":"googleSearch"}computeGoogleSearchToolAdjustment(t){const n=t.googleSearchToolAdjustment;return n===void 0||n===!0?this.computeGoogleSearchToolAdjustmentFromModel():n}buildGeminiAPI(){const t=this.apiConfig??{},n=this.computeGoogleSearchToolAdjustment(t),r={useSystemInstruction:this.useSystemInstruction,googleSearchToolAdjustment:n,...t};return N9(r)}get api(){switch(this.apiName){case"google":return this.buildGeminiAPI();default:return super.api}}}class Lve extends Ga{static lc_name(){return"ChatGoogle"}get lc_secrets(){return{authOptions:"GOOGLE_AUTH_OPTIONS"}}constructor(t){super(Ove(t)),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"maxOutputTokens",{enumerable:!0,configurable:!0,writable:!0,value:1024}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:.8}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:40}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"safetySettings",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"convertSystemMessageToHumanContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"safetyHandler",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"connection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamedConnection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Sve(t,this),this.safetyHandler=(t==null?void 0:t.safetyHandler)??new P9,this.streamUsage=(t==null?void 0:t.streamUsage)??this.streamUsage;const n=this.buildClient(t);this.buildConnection(t??{},n)}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"google_vertexai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.maxOutputTokens??void 0,ls_stop:t.stop}}buildApiKeyClient(t){return new Rve(t)}buildApiKey(t){if((t==null?void 0:t.platformType)!=="gcp")return(t==null?void 0:t.apiKey)??Wr("GOOGLE_API_KEY")}buildClient(t){const n=this.buildApiKey(t);return n?this.buildApiKeyClient(n):this.buildAbstractedClient(t)}buildConnection(t,n){this.connection=new R9({...t,...this},this.caller,n,!1),this.streamedConnection=new R9({...t,...this},this.caller,n,!0)}get platform(){return this.connection.platform}bindTools(t,n){return this.bind({tools:M9(t),...n})}_llmType(){return"chat_integration"}invocationParams(t){return gve(this,t)}async _generate(t,n,r){var c;const a=this.invocationParams(n);if(this.streaming){const l=this._streamResponseChunks(t,n,r);let u=null;for await(const d of l)u=u?HP(u,d):d;if(!u)throw new Error("No chunks were returned from the stream.");return{generations:[u]}}const o=await this.connection.request(t,a,n,r),i=this.connection.api.responseToChatResult(o),s=(c=i==null?void 0:i.generations)==null?void 0:c[0];return s&&await(r==null?void 0:r.handleLLMNewToken(s.text||"")),i}async*_streamResponseChunks(t,n,r){const a=this.invocationParams(n),o=(await this.streamedConnection.request(t,a,n,r)).data;let i;for(;!o.streamDone;){const s=await o.nextChunk();await(r==null?void 0:r.handleCustomEvent(`google-chunk-${this.constructor.name}`,{output:s})),s&&s.usageMetadata&&this.streamUsage!==!1&&n.streamUsage!==!1&&(i={input_tokens:s.usageMetadata.promptTokenCount,output_tokens:s.usageMetadata.candidatesTokenCount,total_tokens:s.usageMetadata.totalTokenCount});const c=s!==null?this.connection.api.responseToChatGeneration({data:s}):new Vn({text:"",generationInfo:{finishReason:"stop"},message:new Hr({content:"",usage_metadata:i})});c&&(yield c,await(r==null?void 0:r.handleLLMNewToken(c.text??"",void 0,void 0,void 0,void 0,{chunk:c})))}}_combineLLMOutput(){return[]}withStructuredOutput(t,n){const r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw;if(o==="jsonMode")throw new Error('Google only supports "functionCalling" as a method.');let s=a??"extract",c,l;if($ve(r)){const m=Cj(r);l=[{functionDeclarations:[{name:s,description:m.description??"A function available to call.",parameters:m}]}],c=new Gc({returnSingle:!0,keyName:s,zodSchema:r})}else{let m;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(m=r,s=r.name):m={name:s,description:r.description??"",parameters:r},l=[{functionDeclarations:[m]}],c=new Gc({returnSingle:!0,keyName:s})}const u=this.bind({tools:l,tool_choice:s});if(!i)return u.pipe(c).withConfig({runName:"ChatGoogleStructuredOutput"});const d=ji.assign({parsed:(m,y)=>c.invoke(m.raw,y)}),f=ji.assign({parsed:()=>null}),p=d.withFallbacks({fallbacks:[f]});return Ov.from([{raw:u},p]).withConfig({runName:"StructuredOutputRunnable"})}}function $ve(e){return typeof(e==null?void 0:e.parse)=="function"}const Pj=crypto,I9=e=>e instanceof CryptoKey,al=new TextEncoder,yy=new TextDecoder;function Fve(...e){const t=e.reduce((a,{length:o})=>a+o,0),n=new Uint8Array(t);let r=0;return e.forEach(a=>{n.set(a,r),r+=a.length}),n}const Bve=e=>{let t=e;typeof t=="string"&&(t=al.encode(t));const n=32768,r=[];for(let a=0;a<t.length;a+=n)r.push(String.fromCharCode.apply(null,t.subarray(a,a+n)));return btoa(r.join(""))},Nj=e=>Bve(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),zve=e=>{const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},Uve=e=>{let t=e;t instanceof Uint8Array&&(t=yy.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return zve(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}};class Mj extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(t){var n;super(t),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,(n=Error.captureStackTrace)===null||n===void 0||n.call(Error,this,this.constructor)}}class gy extends Mj{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}class rf extends Mj{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}}class Oi extends Mj{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}function Fo(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function vy(e,t){return e.name===t}function Aj(e){return parseInt(e.name.slice(4),10)}function Vve(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function Wve(e,t){if(t.length&&!t.some(n=>e.usages.includes(n))){let n="CryptoKey does not support this operation, its usages must include ";if(t.length>2){const r=t.pop();n+=`one of ${t.join(", ")}, or ${r}.`}else t.length===2?n+=`one of ${t[0]} or ${t[1]}.`:n+=`${t[0]}.`;throw new TypeError(n)}}function Hve(e,t,...n){switch(t){case"HS256":case"HS384":case"HS512":{if(!vy(e.algorithm,"HMAC"))throw Fo("HMAC");const r=parseInt(t.slice(2),10);if(Aj(e.algorithm.hash)!==r)throw Fo(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!vy(e.algorithm,"RSASSA-PKCS1-v1_5"))throw Fo("RSASSA-PKCS1-v1_5");const r=parseInt(t.slice(2),10);if(Aj(e.algorithm.hash)!==r)throw Fo(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!vy(e.algorithm,"RSA-PSS"))throw Fo("RSA-PSS");const r=parseInt(t.slice(2),10);if(Aj(e.algorithm.hash)!==r)throw Fo(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":{if(e.algorithm.name!=="Ed25519"&&e.algorithm.name!=="Ed448")throw Fo("Ed25519 or Ed448");break}case"ES256":case"ES384":case"ES512":{if(!vy(e.algorithm,"ECDSA"))throw Fo("ECDSA");const r=Vve(t);if(e.algorithm.namedCurve!==r)throw Fo(r,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}Wve(e,n)}function D9(e,t,...n){if(n.length>2){const r=n.pop();e+=`one of type ${n.join(", ")}, or ${r}.`}else n.length===2?e+=`one of type ${n[0]} or ${n[1]}.`:e+=`of type ${n[0]}.`;return t==null?e+=` Received ${t}`:typeof t=="function"&&t.name?e+=` Received function ${t.name}`:typeof t=="object"&&t!=null&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}const L9=(e,...t)=>D9("Key must be ",e,...t);function $9(e,t,...n){return D9(`Key for the ${e} algorithm must be `,t,...n)}const F9=e=>I9(e),Bo=["CryptoKey"],qve=(...e)=>{const t=e.filter(Boolean);if(t.length===0||t.length===1)return!0;let n;for(const r of t){const a=Object.keys(r);if(!n||n.size===0){n=new Set(a);continue}for(const o of a){if(n.has(o))return!1;n.add(o)}}return!0};function Zve(e){return typeof e=="object"&&e!==null}function B9(e){if(!Zve(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}const Kve=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:n}=t.algorithm;if(typeof n!="number"||n<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}},Ci=(e,t,n=0)=>{n===0&&(t.unshift(t.length),t.unshift(6));let r=e.indexOf(t[0],n);if(r===-1)return!1;const a=e.subarray(r,r+t.length);return a.length!==t.length?!1:a.every((o,i)=>o===t[i])||Ci(e,t,r+1)},z9=e=>{switch(!0){case Ci(e,[42,134,72,206,61,3,1,7]):return"P-256";case Ci(e,[43,129,4,0,34]):return"P-384";case Ci(e,[43,129,4,0,35]):return"P-521";case Ci(e,[43,101,110]):return"X25519";case Ci(e,[43,101,111]):return"X448";case Ci(e,[43,101,112]):return"Ed25519";case Ci(e,[43,101,113]):return"Ed448";default:throw new gy("Invalid or unsupported EC Key Curve or OKP Key Sub Type")}},Xve=async(e,t,n,r,a)=>{var o;let i,s;const c=new Uint8Array(atob(n.replace(e,"")).split("").map(l=>l.charCodeAt(0)));switch(r){case"PS256":case"PS384":case"PS512":i={name:"RSA-PSS",hash:`SHA-${r.slice(-3)}`},s=["sign"];break;case"RS256":case"RS384":case"RS512":i={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${r.slice(-3)}`},s=["sign"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":i={name:"RSA-OAEP",hash:`SHA-${parseInt(r.slice(-3),10)||1}`},s=["decrypt","unwrapKey"];break;case"ES256":i={name:"ECDSA",namedCurve:"P-256"},s=["sign"];break;case"ES384":i={name:"ECDSA",namedCurve:"P-384"},s=["sign"];break;case"ES512":i={name:"ECDSA",namedCurve:"P-521"},s=["sign"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{const l=z9(c);i=l.startsWith("P-")?{name:"ECDH",namedCurve:l}:{name:l},s=["deriveBits"];break}case"EdDSA":i={name:z9(c)},s=["sign"];break;default:throw new gy('Invalid or unsupported "alg" (Algorithm) value')}return Pj.subtle.importKey(t,c,i,(o=void 0)!==null&&o!==void 0?o:!1,s)},Yve=(e,t,n)=>Xve(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",e,t);async function Jve(e,t,n){if(typeof e!="string"||e.indexOf("-----BEGIN PRIVATE KEY-----")!==0)throw new TypeError('"pkcs8" must be PKCS#8 formatted string');return Yve(e,t)}const Qve=(e,t)=>{if(!(t instanceof Uint8Array)){if(!F9(t))throw new TypeError($9(e,t,...Bo,"Uint8Array"));if(t.type!=="secret")throw new TypeError(`${Bo.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},Gve=(e,t,n)=>{if(!F9(t))throw new TypeError($9(e,t,...Bo));if(t.type==="secret")throw new TypeError(`${Bo.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if(t.type==="public")throw new TypeError(`${Bo.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if(t.algorithm&&n==="verify"&&t.type==="private")throw new TypeError(`${Bo.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&n==="encrypt"&&t.type==="private")throw new TypeError(`${Bo.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)},e0e=(e,t,n)=>{e.startsWith("HS")||e==="dir"||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?Qve(e,t):Gve(e,t,n)};function t0e(e,t,n,r,a){if(a.crit!==void 0&&r.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!r||r.crit===void 0)return new Set;if(!Array.isArray(r.crit)||r.crit.length===0||r.crit.some(i=>typeof i!="string"||i.length===0))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;n!==void 0?o=new Map([...Object.entries(n),...t.entries()]):o=t;for(const i of r.crit){if(!o.has(i))throw new gy(`Extension Header Parameter "${i}" is not recognized`);if(a[i]===void 0)throw new e(`Extension Header Parameter "${i}" is missing`);if(o.get(i)&&r[i]===void 0)throw new e(`Extension Header Parameter "${i}" MUST be integrity protected`)}return new Set(r.crit)}function n0e(e,t){const n=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:n,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:n,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:n,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:n,name:"ECDSA",namedCurve:t.namedCurve};case"EdDSA":return{name:t.name};default:throw new gy(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}function r0e(e,t,n){if(I9(t))return Hve(t,e,n),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(L9(t,...Bo));return Pj.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[n])}throw new TypeError(L9(t,...Bo,"Uint8Array"))}const Tj=e=>Math.floor(e.getTime()/1e3),U9=60,V9=U9*60,Rj=V9*24,a0e=Rj*7,o0e=Rj*365.25,i0e=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,W9=e=>{const t=i0e.exec(e);if(!t)throw new TypeError("Invalid time period format");const n=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(n);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(n*U9);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(n*V9);case"day":case"days":case"d":return Math.round(n*Rj);case"week":case"weeks":case"w":return Math.round(n*a0e);default:return Math.round(n*o0e)}},s0e=async(e,t,n)=>{const r=await r0e(e,t,"sign");Kve(e,r);const a=await Pj.subtle.sign(n0e(e,r.algorithm),r,n);return new Uint8Array(a)};class c0e{constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=t}setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}async sign(t,n){if(!this._protectedHeader&&!this._unprotectedHeader)throw new rf("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!qve(this._protectedHeader,this._unprotectedHeader))throw new rf("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const r={...this._protectedHeader,...this._unprotectedHeader},a=t0e(rf,new Map([["b64",!0]]),n==null?void 0:n.crit,this._protectedHeader,r);let o=!0;if(a.has("b64")&&(o=this._protectedHeader.b64,typeof o!="boolean"))throw new rf('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:i}=r;if(typeof i!="string"||!i)throw new rf('JWS "alg" (Algorithm) Header Parameter missing or invalid');e0e(i,t,"sign");let s=this._payload;o&&(s=al.encode(Nj(s)));let c;this._protectedHeader?c=al.encode(Nj(JSON.stringify(this._protectedHeader))):c=al.encode("");const l=Fve(c,al.encode("."),s),u=await s0e(i,t,l),d={signature:Nj(u),payload:""};return o&&(d.payload=yy.decode(s)),this._unprotectedHeader&&(d.header=this._unprotectedHeader),this._protectedHeader&&(d.protected=yy.decode(c)),d}}class l0e{constructor(t){this._flattened=new c0e(t)}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}async sign(t,n){const r=await this._flattened.sign(t,n);if(r.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}class u0e{constructor(t){if(!B9(t))throw new TypeError("JWT Claims Set MUST be an object");this._payload=t}setIssuer(t){return this._payload={...this._payload,iss:t},this}setSubject(t){return this._payload={...this._payload,sub:t},this}setAudience(t){return this._payload={...this._payload,aud:t},this}setJti(t){return this._payload={...this._payload,jti:t},this}setNotBefore(t){return typeof t=="number"?this._payload={...this._payload,nbf:t}:this._payload={...this._payload,nbf:Tj(new Date)+W9(t)},this}setExpirationTime(t){return typeof t=="number"?this._payload={...this._payload,exp:t}:this._payload={...this._payload,exp:Tj(new Date)+W9(t)},this}setIssuedAt(t){return typeof t>"u"?this._payload={...this._payload,iat:Tj(new Date)}:this._payload={...this._payload,iat:t},this}}class d0e extends u0e{setProtectedHeader(t){return this._protectedHeader=t,this}async sign(t,n){var r;const a=new l0e(al.encode(JSON.stringify(this._payload)));if(a.setProtectedHeader(this._protectedHeader),Array.isArray((r=this._protectedHeader)===null||r===void 0?void 0:r.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new Oi("JWTs MUST NOT use unencoded payload");return a.sign(t,n)}}const f0e=Uve;function p0e(e){if(typeof e!="string")throw new Oi("JWTs must use Compact JWS serialization, JWT must be a string");const{1:t,length:n}=e.split(".");if(n===5)throw new Oi("Only JWTs using Compact JWS serialization can be decoded");if(n!==3)throw new Oi("Invalid JWT");if(!t)throw new Oi("JWTs must contain a payload");let r;try{r=f0e(t)}catch{throw new Oi("Failed to base64url decode the payload")}let a;try{a=JSON.parse(yy.decode(r))}catch{throw new Oi("Failed to parse the decoded payload as JSON")}if(!B9(a))throw new Oi("Invalid JWT Claims Set");return a}const Ij=typeof((MX=(NX=globalThis.caches)==null?void 0:NX.default)==null?void 0:MX.put)=="function";class h0e extends Error{constructor(n,r){super(n,{cause:r==null?void 0:r.cause});zP(this,"name","FetchError");zP(this,"response");this.response=r.response,Error.captureStackTrace&&Error.captureStackTrace(this,Error)}}const H9=new Set;function m0e(e,t,n){H9.has(t)||(H9.add(t),console[e](n))}function ol(e){return typeof e=="string"||e instanceof String?Object.freeze(JSON.parse(e)):Object.isFrozen(e)?e:Object.freeze(e)}function y0e(e){const t=ol(e.credentials);return Jve(t.private_key,"RS256")}async function g0e(e){let{credentials:t,scope:n,subject:r,audience:a,env:o,...i}=e;if(t)t=ol(t);else{if(!(o!=null&&o.GOOGLE_CLOUD_CREDENTIALS))throw new TypeError("Missing credentials");t=ol(o.GOOGLE_CLOUD_CREDENTIALS)}n=Array.isArray(n)?n.join(" "):n;const s=await y0e({credentials:t});return await new d0e({scope:n,...i}).setIssuer(t.client_email).setAudience(a??t.token_uri).setSubject(r??t.client_email).setProtectedHeader({alg:"RS256"}).setIssuedAt().setExpirationTime("1h").sign(s)}const v0e=new Map;async function b0e(e){var d;!(e!=null&&e.waitUntil)&&Ij&&m0e("warn","verifyIdToken","Missing `waitUntil` option.");let t;if(e!=null&&e.credentials)t=ol(e.credentials);else{if(!((d=e==null?void 0:e.env)!=null&&d.GOOGLE_CLOUD_CREDENTIALS))throw new TypeError("Missing credentials");t=ol(e.env.GOOGLE_CLOUD_CREDENTIALS)}const n=Array.isArray(e.scope)?e.scope.join(","):e.scope,r=Array.isArray(e.audience)?e.audience.join(","):e.audience,a=t.token_uri,o=new URL(a);o.searchParams.set("scope",n??""),o.searchParams.set("aud",r??""),o.searchParams.set("key",t.private_key_id);const i=o.toString(),s=e.cache??v0e,c=s.get(i);let l=Math.floor(Date.now()/1e3);if(c)if(c.created>l-60*60){let f=await c.promise;if(f.expires>l)return f.token;{const p=s.get(i);if(p&&p!==c){if(f=await p.promise,f.expires>l)return f.token;s.delete(i)}}}else s.delete(i);const u=(async()=>{let f;if(Ij&&(f=await caches.default.match(i)),!f){l=Math.floor(Date.now()/1e3);const y=await g0e({credentials:t,scope:e.audience??e.scope}),v=new URLSearchParams;if(v.append("grant_type","urn:ietf:params:oauth:grant-type:jwt-bearer"),v.append("assertion",y),f=await fetch(a,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:v}),!f.ok){const b=await f.json().then(w=>w==null?void 0:w.error_description).catch(()=>{});throw new h0e(b??"Failed to fetch an access token.",{response:f})}if(Ij){let b=f.clone();b=new Response(b.body,b),b.headers.set("Cache-Control","max-age=3590, public"),b.headers.set("Last-Modified",new Date().toUTCString());const w=caches.default.put(i,b);e.waitUntil&&e.waitUntil(w)}}const p=await f.json();if("id_token"in p){const y=p0e(p.id_token);return{token:p.id_token,expires:y.exp}}const m=f.headers.get("last-modified");return{expires:m?Math.floor(new Date(m).valueOf()/1e3)+p.expires_in:l+p.expires_in,token:p.access_token}})();return s.set(i,{created:l,promise:u}),await u.then(f=>f.token)}class w0e extends T9{constructor(t){super(),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const n=t==null?void 0:t.authOptions,r=n==null?void 0:n.accessToken,a=(n==null?void 0:n.credentials)??Wr("GOOGLE_WEB_CREDENTIALS")??Wr("GOOGLE_VERTEX_AI_WEB_CREDENTIALS");if(a===void 0)throw new Error('Credentials not found. Please set the GOOGLE_WEB_CREDENTIALS environment variable or pass credentials into "authOptions.credentials".');this.options=Dve({...n,accessToken:r,credentials:a},"scope",t==null?void 0:t.platformType)}get clientType(){return"webauth"}async getProjectId(){return ol(this.options.credentials).project_id}async request(t){let{accessToken:n}=this.options;n===void 0&&(n=await b0e(this.options));const r={Authorization:`Bearer ${n}`};return this._request(t==null?void 0:t.url,t,r)}}class x0e extends Lve{static lc_name(){return"ChatGoogle"}constructor(t){super(t)}buildAbstractedClient(t){return new w0e(t)}}class _0e extends x0e{static lc_name(){return"ChatVertexAI"}constructor(t){super({...t,platformType:"gcp"}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","vertexai"]})}}const S0e=e=>{const t=(n,r=null)=>{let a=`{
`;return n.filter(o=>o.parent_id===r).forEach(o=>{if(o.type==="object"){const i=e.filter(c=>c.parent_id===o.id),s=t(i,o.id);a+=`  ${o.name}${o.required?"":"?"}: ${s}
`}else a+=`  // ${o.description||""}
  ${o.name}${o.required?"":"?"}: ${o.type};
`}),a+="}",a};return t(e)},q9=e=>{const t=(r,a=null)=>{let o="";return r.filter(i=>i.parent_id===a).forEach(i=>{if(i.type==="object"){const s=t(r,i.id);o+=`    ${i.name}: z.object({
${s}    })${i.required?"":".optional()"}.describe('${i.description||""}'),
`}else o+=`    ${i.name}: z.${i.type}()${i.required?"":".optional()"}.describe('${i.description||""}'),
`}),o};let n=`const schema = z.object({
`;return n+=t(e),n+="});",n},j0e=e=>{const t={},n={string:Ra.string,number:Ra.number,boolean:Ra.boolean,enum:()=>Ra.enum([""])};return e.forEach(r=>{if(!r.parent_id)if(r.type==="object"){const a=e.filter(i=>i.parent_id===r.id),o={};a.forEach(i=>{i.type==="object"||i.type==="array"||(o[i.name]=n[i.type](),i.required||(o[i.name]=o[i.name].optional()))}),t[r.name]=Ra.object(o),r.required||(t[r.name]=t[r.name].optional())}else r.type==="array"?(t[r.name]=Ra.array(Ra.string()),r.required||(t[r.name]=t[r.name].optional())):r.type==="enum"?(t[r.name]=Ra.enum((r.enum||"").split(",")),r.required||(t[r.name]=t[r.name].optional())):(t[r.name]=n[r.type](),r.required||(t[r.name]=t[r.name].optional()))}),Ra.object(t)},Dj=async(e,t,{schemas:n,onMessageUpdate:r})=>{let a="",o;if(n!=null&&n.length){const i=n.filter(c=>{var l;return(l=c.schema_items)==null?void 0:l.length}).flatMap(c=>c.schema_items),s=await e.withStructuredOutput(j0e(i)).stream(t);for await(const c of s)a=JSON.stringify(c),r==null||r({content:a})}else{const i=await e.stream(t);for await(const s of i)a+=`${s.content}`,o=s,r==null||r({content:a,chunk:s})}return{lastChunk:o,content:a}},E0e=()=>{const{toast:e}=on(),{t}=Re("errors"),n=st(a=>a.currentSession),{modalRef:r}=Lc(Id);return{stream:g.useCallback(async(a,o)=>{var m,y,v,b;const{schemas:i,onMessageUpdate:s,onMessageFinish:c}=o||{};if(!(n!=null&&n.passphrase))throw new Error("Session is not found");await yp.exists("passphrase")||await new Promise((w,_)=>{r.current.show({onConfirm:async x=>{try{const S=await fS(n.passphrase,x);await yp.set("passphrase",S),w()}catch(S){e({content:t("invalid_passphrase"),variant:"destructive"}),_(S)}finally{r.current.hide()}},onCancel:()=>{_()}})});const l=(m=o==null?void 0:o.llm)==null?void 0:m.parameters;if(!(l!=null&&l.key)||typeof l.key!="string")throw new Error("API Key is not found");const u=await yp.get("passphrase");if(!u)throw new Error("Passphrase is not found");const d=await fS(l.key,u);if(!d)throw new Error("API Key is not found");let f="",p;switch(o==null?void 0:o.provider){case gt.VertexAI:{const w=new _0e({authOptions:{credentials:d},model:(y=o==null?void 0:o.llm)==null?void 0:y.name});if(l!=null&&l.enabled_google_search_retrieval){const x={googleSearchRetrieval:{dynamicRetrievalConfig:{mode:"MODE_DYNAMIC",dynamicThreshold:.7}}};w.bindTools([x])}const _=await Dj(w,a,{schemas:i,onMessageUpdate:s});f=_.content,p=_.lastChunk}break;case gt.Groq:{const w=new Sge({apiKey:d,model:(v=o==null?void 0:o.llm)==null?void 0:v.name}),_=await Dj(w,a,{schemas:i,onMessageUpdate:s});f=_.content,p=_.lastChunk}break;case gt.OpenAI:{const w=new iye({apiKey:d,model:(b=o==null?void 0:o.llm)==null?void 0:b.name}),_=await Dj(w,a,{schemas:i,onMessageUpdate:s});f=_.content,p=_.lastChunk}break;default:throw new Error("Provider is not supported")}return c==null||c({content:f,lastChunk:p}),{lastChunk:p,content:f}},[n,r,t,e])}},il=()=>{const e=rM(),t=E0e();return{stream:g.useCallback((n,r,a)=>{switch(n){case gt.WebLLM:return e.stream(r,a);case gt.VertexAI:case gt.Groq:case gt.OpenAI:return t.stream(r,{...a,provider:n});default:throw new Error("Provider is not supported")}},[t,e])}},O0e=e=>{const[t]=g.useState(!1),n=Hs(i=>i.similaritySearchWithScore),{stream:r}=il(),a=g.useCallback(async(i,s)=>{if(!(s!=null&&s.length))return[];const c=[];return await Promise.all(s.map(async l=>{var d,f,p,m;const u=l.placeholderEntity;if(u)switch(u.placeholder_type){case ec.VECTOR_DATABASE_RETREIVER:{if(!l.promptNode||!l.promptEntity||!l.vectorDatabaseNode||!l.vectorDatabaseEntity)return;const y=(d=u.metadata)!=null&&d.k?+((f=u.metadata)==null?void 0:f.k):1;let v=(p=u.metadata)!=null&&p.minimalScore?+((m=u.metadata)==null?void 0:m.minimalScore):void 0;v&&v>1&&(v=v/100);const b=await n({databaseId:l.vectorDatabaseEntity.id},i,y);if(!b)return[];const w=new ci({template:l.promptEntity.content,inputVariables:["context"]});c.push(new qr(await w.format({context:v?b.filter(([,_])=>_>=v).map(([_])=>_.pageContent).join(`
`):b.map(([_])=>_.pageContent).join(`
`)})))}}})),c},[n]),o=g.useCallback(async(i,s,{retriverInfo:c},{schema:l,onMessageUpdate:u,onResponseMessageCreate:d,onInjectedMessages:f})=>{var v,b;if(!((v=e.mainLLMInfo)!=null&&v.llm)||((b=e.mainLLMInfo)==null?void 0:b.status)!==rt.Loaded)throw new Error("LLM not found");const p=[];c!=null&&c.length&&(p.push(...await a(i,c)),f==null||f(p));const m=s.map(w=>w.role==="system"?new Cv(w.content):w.role==="user"?new Vr(w.content):new qr(w.content));d==null||d();const{content:y}=await r(e.mainLLMInfo.llm.provider,m,{schemas:l?[l]:void 0,onMessageUpdate:({content:w})=>{u==null||u({nodeData:{loading:!0,content:w}})},llm:e.mainLLMInfo.llm});return u==null||u({nodeData:{content:y}}),y},[a,r,e.mainLLMInfo]);return{loading:t,sendMessage:o}},C0e=uo(({onDelete:e})=>{const{t}=Re("dialogs"),[n,r]=g.useState(!1),a=an(),{toast:o}=on(),i=async()=>{try{r(!0),await e(),a.hide()}catch{o({variant:"destructive",description:t("delete_chat_data_node.errors.delete_failed")})}finally{r(!1)}};return h.jsx(tT,{open:a.visible,onOpenChange:a.hide,children:h.jsxs(Bb,{children:[h.jsxs(zb,{children:[h.jsx(Vb,{children:t("delete_chat_data_node.title")}),h.jsx(Wb,{children:t("delete_chat_data_node.description")})]}),h.jsxs(Ub,{children:[h.jsx(qb,{onClick:a.hide,children:t("delete_chat_data_node.cancel")}),h.jsx(Hb,{disabled:n,onClick:i,children:t("delete_chat_data_node.delete")})]})]})})});function by(){return h.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"text-foreground",children:[h.jsx("circle",{cx:"4",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_qFRN",begin:"0;spinner_OcgL.end+0.25s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{begin:"spinner_qFRN.begin+0.1s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"20",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_OcgL",begin:"spinner_qFRN.begin+0.2s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})})]})}const k0e=g.lazy(()=>Qt(()=>import("./index-D98JkF8D.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([5,6,1,2,7,8]))),Lj=g.memo(({source:e,className:t,...n})=>{const r=ou(o=>o.theme),a=g.useMemo(()=>({pre:({children:o,className:i,...s})=>h.jsx("pre",{...s,className:G(i,"nowheel"),children:o}),think:({children:o})=>h.jsx("blockquote",{className:"think",children:o})}),[]);return h.jsx(g.Suspense,{children:h.jsx(k0e,{className:G("!text-sm [&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans",t),source:e,wrapperElement:{"data-color-mode":r==="dark"?"dark":"light"},components:a,...n})})},(e,t)=>e.source===t.source),rn=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));rn.displayName="Card";const Yn=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("flex flex-col space-y-1.5 p-6",e),...t}));Yn.displayName="CardHeader";const sr=g.forwardRef(({className:e,...t},n)=>h.jsx("h3",{ref:n,className:G("text-2xl font-semibold leading-none tracking-tight",e),...t}));sr.displayName="CardTitle";const Z9=g.forwardRef(({className:e,...t},n)=>h.jsx("p",{ref:n,className:G("text-sm text-muted-foreground",e),...t}));Z9.displayName="CardDescription";const Jn=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("p-6 pt-0",e),...t}));Jn.displayName="CardContent";const ki=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("flex items-center p-6 pt-0",e),...t}));ki.displayName="CardFooter";const P0e=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",height:192,viewBox:"0 0 150 150",width:192,...e},g.createElement("clipPath",{id:"a"},g.createElement("path",{d:"m0 0h150v150h-150z"})),g.createElement("g",{clipPath:"url(#a)"},g.createElement("path",{d:"m150 0h-150v150h150z",fill:"#29b5e8"}),g.createElement("path",{clipRule:"evenodd",d:"m130.375 67.2532-14.096 8.1221 14.096 8.0536c.843.4872 1.581 1.1357 2.174 1.9084.592.7727 1.026 1.6545 1.278 2.5951.251.9406.315 1.9215.188 2.8867-.128.9652-.444 1.8959-.931 2.7388-.488.843-1.136 1.5817-1.909 2.174s-1.654 1.0267-2.595 1.2782-1.921.3154-2.887.1878c-.965-.1275-1.896-.444-2.739-.9312l-25.2559-14.5496c-1.1575-.6696-2.1128-1.6394-2.765-2.8068-.6523-1.1674-.9773-2.4893-.9408-3.826.0198-.5792.1089-1.1538.2653-1.7117.517-1.8711 1.7458-3.4654 3.4234-4.4419l25.256-14.4983c.847-.4892 1.782-.8067 2.751-.9343.97-.1275 1.955-.0627 2.899.1909.945.2536 1.83.6909 2.605 1.287.775.596 1.425 1.3391 1.913 2.1866.49.8402.808 1.7693.935 2.7334.128.964.063 1.9439-.191 2.8826-.254.9388-.692 1.8177-1.288 2.5859-.597.7681-1.34 1.4101-2.186 1.8887zm-13.343 39.3698-25.2478-14.5243c-1.1296-.6483-2.4091-.9896-3.7115-.9902s-2.5823.3397-3.7124.987c-1.1301.6472-2.0712 1.579-2.7297 2.7026-.6585 1.1237-1.0115 2.4001-1.0239 3.7024v29.0135c.0654 1.928.8772 3.755 2.264 5.095 1.3869 1.341 3.2403 2.09 5.1691 2.09 1.9289 0 3.7823-.749 5.1691-2.09 1.3868-1.34 2.1986-3.167 2.264-5.095v-16.261l14.1301 8.122c.843.488 1.774.805 2.739.933.966.128 1.947.064 2.888-.187s1.823-.685 2.596-1.277c.774-.592 1.423-1.331 1.91-2.174.488-.843.805-1.773.933-2.739.128-.965.065-1.946-.186-2.887s-.685-1.824-1.277-2.597-1.331-1.422-2.174-1.91zm-29.0992-28.3806-10.527 10.3986c-.3601.3349-.8269.5319-1.318.5563h-3.0897c-.49-.0294-.9551-.2257-1.318-.5563l-10.4671-10.4329c-.3274-.3573-.521-.817-.5478-1.3009v-3.081c.0283-.4861.2215-.9481.5478-1.3095l10.4671-10.4329c.3637-.3281.829-.5214 1.318-.5477h3.0897c.4899.0228.9562.2166 1.318.5477l10.4928 10.4329c.3237.3623.514.8243.5392 1.3095v3.081c-.0237.483-.2143.9428-.5392 1.3009zm-8.3874-2.8928c-.0404-.499-.2485-.9696-.5905-1.3352l-3.0383-3.004c-.3641-.3275-.8291-.5207-1.318-.5478h-.1113c-.4867.0255-.9495.2191-1.3094.5478l-3.0383 3.004c-.3262.3676-.5165.8358-.5392 1.3266v.1113c.0215.4834.2124.9439.5392 1.3009l3.0554 2.9955c.3607.3274.823.5208 1.3094.5477h.1113c.4889-.027.9539-.2203 1.318-.5477l3.0383-3.0212c.3282-.3576.5244-.8166.5563-1.3009zm-47.4914-31.2217 25.2563 14.4811c1.1308.648 2.4115.989 3.7149.9889 1.3033 0 2.584-.3409 3.7148-.989 1.1309-.648 2.0725-1.5806 2.7314-2.7051.659-1.1245 1.0123-2.4018 1.0249-3.7051v-28.9879c-.0654-1.9277-.8772-3.7546-2.264-5.0952s-3.2402-2.0899-5.1691-2.0899c-1.9288 0-3.7822.7493-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v16.2613l-14.1473-8.1307c-.8429-.4877-1.7737-.8047-2.7392-.9328-.9654-.1281-1.9466-.0647-2.8876.1864s-1.8232.6852-2.5965 1.2773c-.7732.5921-1.4222 1.3307-1.91 2.1736-.4878.843-.8048 1.7738-.9329 2.7392-.128.9655-.0647 1.9467.1864 2.8876.2512.941.6852 1.8233 1.2773 2.5965.5921.7733 1.3307 1.4223 2.1737 1.9101zm55.4252 15.4739c1.4914.118 2.9836-.2193 4.2793-.9671l25.2475-14.5496c.843-.4877 1.582-1.1368 2.174-1.91s1.026-1.6555 1.277-2.5965.315-1.9222.187-2.8876c-.128-.9655-.445-1.8962-.933-2.7392-.488-.8429-1.137-1.5816-1.91-2.1737-.774-.5921-1.656-1.0261-2.597-1.2772-1.9-.5072-3.924-.2387-5.627.7464l-14.1298 8.1991v-16.2613c-.0654-1.9277-.8772-3.7546-2.264-5.0952-1.3868-1.3405-3.2402-2.0899-5.1691-2.0899-1.9288 0-3.7822.7494-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v29.0136c-.0023 1.8784.7086 3.6876 1.9892 5.0619 1.2805 1.3743 3.0351 2.2111 4.909 2.3412zm-25.8554 31.5298c-1.4916-.1213-2.9847.2162-4.2793.9671l-25.2905 14.4893c-1.7024.985-2.9438 2.607-3.451 4.507s-.2387 3.924.7465 5.627c.9851 1.702 2.6061 2.943 4.5065 3.451 1.9004.507 3.9244.238 5.6268-.747l14.1473-8.122v16.261c.0654 1.928.8772 3.755 2.2641 5.096 1.3868 1.34 3.2402 2.09 5.169 2.09 1.9289 0 3.7823-.75 5.1691-2.09 1.3868-1.341 2.1986-3.168 2.264-5.096v-29.0645c-.0038-1.869-.7144-3.6673-1.9891-5.0341s-3.0192-2.2009-4.8834-2.3348zm-6.8468-13.5825c.4875-1.6032.414-3.3247-.2083-4.8806-.6224-1.5559-1.7564-2.8532-3.2152-3.6779l-25.2306-14.541c-1.704-.976-3.7248-1.2385-5.6216-.7303-1.8968.5083-3.5155 1.7461-4.5032 3.4433-.4889.84-.8065 1.7686-.9343 2.732-.1278.9635-.0632 1.9428.1899 2.8811.2531.9384.6897 1.8173 1.2846 2.5858.595.7686 1.3364 1.4115 2.1814 1.8917l14.096 8.1221-14.096 8.0536c-.8429.4861-1.5819 1.1334-2.1746 1.9051-.5928.7717-1.0277 1.6526-1.2801 2.5923-.2523.9398-.317 1.9201-.1905 2.8849s.4418 1.8952.9279 2.7382c.4861.8429 1.1335 1.5819 1.9051 2.1746.7717.5928 1.6526 1.0277 2.5924 1.2801.9397.2523 1.92.317 2.8848.1905s1.8952-.4418 2.7382-.9279l25.2306-14.5496c1.6248-.9071 2.8451-2.3965 3.4149-4.168z",fill:"#fff",fillRule:"evenodd"}))),N0e=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:48,height:48,...e},g.createElement("path",{fill:"#fbc02d",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20 s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),g.createElement("path",{fill:"#e53935",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039 l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),g.createElement("path",{fill:"#4caf50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36 c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),g.createElement("path",{fill:"#1565c0",d:"M43.611,20.083L43.595,20L42,20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571 c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),M0e=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:1024,height:1024,viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M44.522 44.5217H489.739V489.739H44.522V44.5217Z",fill:"#F35325"}),g.createElement("path",{d:"M534.261 44.5217H979.478V489.739H534.261V44.5217Z",fill:"#81BC06"}),g.createElement("path",{d:"M44.522 534.261H489.739V979.478H44.522V534.261Z",fill:"#05A6F0"}),g.createElement("path",{d:"M534.261 534.261H979.478V979.478H534.261V534.261Z",fill:"#FFBA08"})),A0e=e=>g.createElement("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 287.56 191",...e},g.createElement("defs",null,g.createElement("style",null,".cls-1{fill:#0081fb;}.cls-2{fill:url(#linear-gradient);}.cls-3{fill:url(#linear-gradient-2);}"),g.createElement("linearGradient",{id:"linear-gradient",x1:62.34,y1:101.45,x2:260.34,y2:91.45,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0064e1"}),g.createElement("stop",{offset:.4,stopColor:"#0064e1"}),g.createElement("stop",{offset:.83,stopColor:"#0073ee"}),g.createElement("stop",{offset:1,stopColor:"#0082fb"})),g.createElement("linearGradient",{id:"linear-gradient-2",x1:41.42,y1:53,x2:41.42,y2:126,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0082fb"}),g.createElement("stop",{offset:1,stopColor:"#0064e0"}))),g.createElement("title",null,"facebook-meta"),g.createElement("path",{className:"cls-1",d:"M31.06,126c0,11,2.41,19.41,5.56,24.51A19,19,0,0,0,53.19,160c8.1,0,15.51-2,29.79-21.76,11.44-15.83,24.92-38,34-52l15.36-23.6c10.67-16.39,23-34.61,37.18-47C181.07,5.6,193.54,0,206.09,0c21.07,0,41.14,12.21,56.5,35.11,16.81,25.08,25,56.67,25,89.27,0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191V160c17.63,0,22-16.2,22-34.74,0-26.42-6.16-55.74-19.73-76.69-9.63-14.86-22.11-23.94-35.84-23.94-14.85,0-26.8,11.2-40.23,31.17-7.14,10.61-14.47,23.54-22.7,38.13l-9.06,16c-18.2,32.27-22.81,39.62-31.91,51.75C84.74,183,71.12,191,53.19,191c-21.27,0-34.72-9.21-43-23.09C3.34,156.6,0,141.76,0,124.85Z"}),g.createElement("path",{className:"cls-2",d:"M24.49,37.3C38.73,15.35,59.28,0,82.85,0c13.65,0,27.22,4,41.39,15.61,15.5,12.65,32,33.48,52.63,67.81l7.39,12.32c17.84,29.72,28,45,33.93,52.22,7.64,9.26,13,12,19.94,12,17.63,0,22-16.2,22-34.74l27.4-.86c0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191c-12.8,0-24.14-2.78-36.68-14.61-9.64-9.08-20.91-25.21-29.58-39.71L146.08,93.6c-12.94-21.62-24.81-37.74-31.68-45C107,40.71,97.51,31.23,82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78Z"}),g.createElement("path",{className:"cls-3",d:"M82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78C38.61,71.62,31.06,99.34,31.06,126c0,11,2.41,19.41,5.56,24.51L10.14,167.91C3.34,156.6,0,141.76,0,124.85,0,94.1,8.44,62.05,24.49,37.3,38.73,15.35,59.28,0,82.85,0Z"})),T0e=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:256,height:233,viewBox:"0 0 256 233",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M186.182 0h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#f7d046",d:"M209.455 0H256v46.545h-46.545z"}),g.createElement("path",{d:"M0 0h46.545v46.545H0zm0 46.545h46.545V93.09H0zm0 46.546h46.545v46.545H0zm0 46.545h46.545v46.545H0zm0 46.546h46.545v46.545H0z"}),g.createElement("path",{fill:"#f7d046",d:"M23.273 0h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#f2a73b",d:"M209.455 46.545H256V93.09h-46.545zm-186.182 0h46.545V93.09H23.273z"}),g.createElement("path",{d:"M139.636 46.545h46.545V93.09h-46.545z"}),g.createElement("path",{fill:"#f2a73b",d:"M162.909 46.545h46.545V93.09h-46.545zm-93.091 0h46.545V93.09H69.818z"}),g.createElement("path",{fill:"#ee792f",d:"M116.364 93.091h46.545v46.545h-46.545zm46.545 0h46.545v46.545h-46.545zm-93.091 0h46.545v46.545H69.818z"}),g.createElement("path",{d:"M93.091 139.636h46.545v46.545H93.091z"}),g.createElement("path",{fill:"#eb5829",d:"M116.364 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#ee792f",d:"M209.455 93.091H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"}),g.createElement("path",{d:"M186.182 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M209.455 139.636H256v46.545h-46.545z"}),g.createElement("path",{d:"M186.182 186.182h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M23.273 139.636h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#ea3326",d:"M209.455 186.182H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"})),R0e="/NoLLMChat/assets/qwen-B-gSh3_v.webp",I0e="/NoLLMChat/assets/smollm-CikBjd4F.png",D0e="/NoLLMChat/assets/stablelm-BquePdQ7.png",L0e="/NoLLMChat/assets/nomic-BjJqoFji.webp",$0e="/NoLLMChat/assets/joshua-ByaReJuI.webp",F0e="/NoLLMChat/assets/deepseek-CRqFMahi.png",B0e="/NoLLMChat/assets/redpajama-CmUGqSQW.png",z0e=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{fill:"#fff",d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),U0e=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),Tr=g.memo(({name:e,className:t,...n})=>{const r=ou(a=>a.theme);return e=e.toLowerCase(),e.includes("gpt")?r==="dark"?h.jsx(z0e,{className:G("w-5 h-5",t),...n}):h.jsx(U0e,{className:G("w-5 h-5",t),...n}):e!=null&&e.includes("deepseek")?h.jsx("img",{className:G("w-5 h-5 rounded-full",t),src:F0e,alt:"deepseek",...n}):e!=null&&e.includes("redpajama")?h.jsx("img",{className:G("w-5 h-5 rounded-full",t),src:B0e,alt:"deepseek",...n}):e.includes("gemma")||e.includes("gemini")?h.jsx(N0e,{className:G("w-5 h-5",t),...n}):e!=null&&e.includes("qwen")?h.jsx("img",{className:G("w-5 h-5",t),src:R0e,alt:"qwen",...n}):e!=null&&e.includes("phi")?h.jsx(M0e,{className:G("w-5 h-5",t),...n}):e!=null&&e.includes("llama")?h.jsx(A0e,{className:G("w-5 h-5",t),...n}):e!=null&&e.includes("smollm")?h.jsx("img",{className:G("w-5 h-5",t),src:I0e,alt:"smollm",...n}):e!=null&&e.includes("mistral")?h.jsx(T0e,{className:G("w-5 h-5",t),...n}):e!=null&&e.includes("snowflake")?h.jsx(P0e,{className:G("w-5 h-5 rounded-full",t),...n}):e!=null&&e.includes("stablelm")?h.jsx("img",{className:G("w-5 h-5 rounded-full",t),src:D0e,alt:"stablelm",...n}):e!=null&&e.includes("nomic")?h.jsx("img",{className:G("w-5 h-5 rounded-full",t),src:L0e,alt:"nomic",...n}):e!=null&&e.includes("Xenova")||e!=null&&e.includes("janus")?h.jsx("img",{className:G("w-5 h-5 rounded-full",t),src:$0e,alt:"Xenova",...n}):h.jsx(me,{className:G("w-5 h-5",t),name:"brain"})}),$j=["Qwen2.5-1.5B-Instruct-q4f32_1-MLC","Qwen2.5-Coder-1.5B-Instruct-q4f16_1-MLC","stablelm-2-zephyr-1_6b-q4f16_1-MLC-1k","Phi-3.5-mini-instruct-q4f16_1-MLC-1k","Llama-3.2-3B-Instruct-q4f32_1-MLC","DeepSeek-R1-Distill-Qwen-7B-q4f16_1-MLC"],V0e=lo("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Mn({className:e,variant:t,...n}){return h.jsx("div",{className:G(V0e({variant:t}),e),...n})}const af=g.memo(e=>{var c;const{name:t,model:n,isCached:r,isFunctionCalling:a}=e,{t:o}=Re("atoms"),i=g.useCallback(l=>l===1?"llm_info.model_types.embedding":l===2?"llm_info.model_types.vlm":"llm_info.model_types.llm",[]),s=g.useMemo(()=>{if(n)switch(n.model_type){case 0:case 1:return h.jsx(Mn,{className:"",children:o(i(n.model_type))});case 2:return h.jsxs(h.Fragment,{children:[h.jsx(Mn,{className:"",children:o(i(0))}),h.jsx(Mn,{className:"",children:o(i(n.model_type))})]})}},[n,i,o]);if(n)return h.jsxs(h.Fragment,{children:[s,$j.some(l=>t&&l.includes(t))?h.jsx(Mn,{className:"",variant:"outline",children:o("llm_info.recommended")}):null,r?h.jsx(Mn,{className:"",variant:"outline",children:o("llm_info.cached")}):null,a?h.jsx(Mn,{className:"",variant:"outline",children:o("llm_info.function_calling")}):null,n!=null&&n.low_resource_required?h.jsx(Mn,{className:"",variant:"outline",children:o("llm_info.low_resource_required")}):null,(c=n==null?void 0:n.overrides)!=null&&c.context_window_size?h.jsxs(Mn,{className:"",variant:"outline",children:[n.overrides.context_window_size.toLocaleString("en-US")," Tokens"]}):null,n!=null&&n.vram_required_MB?h.jsxs(Mn,{className:"",variant:"outline",children:["VRAM: ",n.vram_required_MB.toLocaleString("en-US")," MB"]}):null]})}),W0e=g.memo(({llm:e,status:t,loadLLM:n,progress:r})=>{const{t:a}=Re("flows"),[o,i]=g.useState();g.useEffect(()=>{o||!(e!=null&&e.name)||Qt(()=>import("./index-CIMzE0bz.js").then(async l=>(await l.__tla,l)),__vite__mapDeps([9,1,2,3,4])).then(async({hasModelInCache:l,functionCallingModelIds:u,prebuiltAppConfig:d})=>{const f=await l(e==null?void 0:e.name);i({hasCache:f,isFunctionCalling:u.includes(e==null?void 0:e.name),info:d.model_list.find(p=>p.model_id===(e==null?void 0:e.name))})})},[e==null?void 0:e.name,o]);const s=g.useCallback(async()=>{await(n==null?void 0:n())},[n]),c=g.useMemo(()=>{switch(t){case rt.Downloading:return h.jsx(me,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case rt.Loaded:return h.jsx(Tr,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"});default:return h.jsx(Tr,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"})}},[e==null?void 0:e.name,t]);return h.jsx(rn,{className:"flex justify-center !bg-inherit !p-2 max-w-full overflow-y-hidden !mb-2 m-2 !mt-0",children:h.jsxs("div",{className:"ml-2 pt-1 max-w-full",children:[h.jsxs("p",{className:"flex gap-2 items-center pr-6 !text-sm font-semibold",children:[c,`${(e==null?void 0:e.name)||""}`]}),h.jsxs("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:[h.jsx(af,{model:o==null?void 0:o.info,isFunctionCalling:(o==null?void 0:o.isFunctionCalling)||!1,name:e==null?void 0:e.name,isCached:(o==null?void 0:o.hasCache)||!1}),t!==rt.Loaded?r?h.jsx("div",{className:"text-sm break-words flex-wrap",children:r}):h.jsx(yt,{disabled:t===rt.Loading,onClick:s,className:"mt-4 w-full",children:a(o!=null&&o.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")}):void 0]})]})})}),H0e=e=>{const[t,n]=g.useState([]),r=st(i=>i.currentSession),a=g.useCallback(async()=>{if(!e||!(r!=null&&r.id))return;const i=await he("FlowEdge").find({where:{session_id:r.id,source:e.id},order:{id:"DESC"}}),{flowNodes:s,flowNodeDatas:c}=await Em({where:{session_id:r.id,id:Xa(i.map(l=>l.target)),source_type:"JSONData"},order:{updated_at:"DESC"},select:["id","source_id","source_type","updated_at"]});n(s.reduce((l,u)=>{var f;const d=(f=c[u.source_type])==null?void 0:f.find(p=>p.id===u.source_id);return d&&l.push({node:u,entity:d}),l},[]))},[r==null?void 0:r.id,e]),o=g.useCallback(async i=>{await he("FlowNode").delete(i.id),await he("JSONData").delete(i.source_id);const s=await he("FlowEdge").find({where:[{source:i.id},{target:i.id}]});await Promise.all(s.map(c=>he("FlowEdge").delete(c.id))),a()},[a]);return g.useEffect(()=>{e&&a()},[a,e]),{chatList:t,deleteChat:o,getChatList:a}};class q0e{async loadAndSplit(t){if(t===void 0)throw new Error("You must pass a text splitter to use this method.");const n=await this.load();return t.invoke(n)}}class K9 extends q0e{constructor(t,{splitPages:n=!0,pdfjs:r=Z0e,parsedItemSeparator:a=""}={}){super(),Object.defineProperty(this,"blob",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"splitPages",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"pdfjs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parsedItemSeparator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.blob=t,this.splitPages=n??this.splitPages,this.pdfjs=r,this.parsedItemSeparator=a}async load(){const{getDocument:t,version:n}=await this.pdfjs(),r=await t({data:new Uint8Array(await this.blob.arrayBuffer()),useWorkerFetch:!1,isEvalSupported:!1,useSystemFonts:!0}).promise,a=await r.getMetadata().catch(()=>null),o=[];for(let i=1;i<=r.numPages;i+=1){const s=await(await r.getPage(i)).getTextContent();if(s.items.length===0)continue;let c;const l=[];for(const d of s.items)"str"in d&&(c===d.transform[5]||!c?l.push(d.str):l.push(`
${d.str}`),c=d.transform[5]);const u=l.join(this.parsedItemSeparator);o.push(new bp({pageContent:u,metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages},loc:{pageNumber:i}}}))}return this.splitPages?o:o.length===0?[]:[new bp({pageContent:o.map(i=>i.pageContent).join(`

`),metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages}}})]}}async function Z0e(){try{const{default:e}=await Qt(async()=>{const{default:r}=await import("./pdf-BeUxqsBa.js").then(async a=>(await a.__tla,a)).then(a=>a.p);return{default:r}},__vite__mapDeps([10,1,2])),{getDocument:t,version:n}=e;return{getDocument:t,version:n}}catch(e){throw console.error(e),new Error("Failed to load pdf-parse. Please install it with eg. `npm install pdf-parse`.")}}var Fj="Tabs",[K0e,V4e]=fr(Fj,[fo]),X9=fo(),[X0e,Bj]=K0e(Fj),Y9=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:o,orientation:i="horizontal",dir:s,activationMode:c="automatic",...l}=e,u=si(s),[d,f]=Rn({prop:r,onChange:a,defaultProp:o});return h.jsx(X0e,{scope:n,baseId:zt(),value:d,onValueChange:f,orientation:i,dir:u,activationMode:c,children:h.jsx($e.div,{dir:u,"data-orientation":i,...l,ref:t})})});Y9.displayName=Fj;var J9="TabsList",Q9=g.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,o=Bj(J9,n),i=X9(n);return h.jsx(mu,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:r,children:h.jsx($e.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:t})})});Q9.displayName=J9;var G9="TabsTrigger",eF=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...o}=e,i=Bj(G9,n),s=X9(n),c=rF(i.baseId,r),l=aF(i.baseId,r),u=r===i.value;return h.jsx(yu,{asChild:!0,...s,focusable:!a,active:u,children:h.jsx($e.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":l,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:t,onMouseDown:_e(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?i.onValueChange(r):d.preventDefault()}),onKeyDown:_e(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(r)}),onFocus:_e(e.onFocus,()=>{const d=i.activationMode!=="manual";!u&&!a&&d&&i.onValueChange(r)})})})});eF.displayName=G9;var tF="TabsContent",nF=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:o,...i}=e,s=Bj(tF,n),c=rF(s.baseId,r),l=aF(s.baseId,r),u=r===s.value,d=g.useRef(u);return g.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),h.jsx(Ur,{present:a||u,children:({present:f})=>h.jsx($e.div,{"data-state":u?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:l,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:f&&o})})});nF.displayName=tF;function rF(e,t){return`${e}-trigger-${t}`}function aF(e,t){return`${e}-content-${t}`}var Y0e=Y9,oF=Q9,iF=eF,sF=nF;const zj=Y0e,wy=g.forwardRef(({className:e,...t},n)=>h.jsx(oF,{ref:n,className:G("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));wy.displayName=oF.displayName;const ja=g.forwardRef(({className:e,...t},n)=>h.jsx(iF,{ref:n,className:G("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));ja.displayName=iF.displayName;const Ea=g.forwardRef(({className:e,...t},n)=>h.jsx(sF,{ref:n,className:G("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Ea.displayName=sF.displayName,b0=function(e,[t,n]){return Math.min(n,Math.max(t,e))};function cF(e){const t=g.useRef({value:e,previous:e});return g.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var J0e=[" ","Enter","ArrowUp","ArrowDown"],Q0e=[" ","Enter"],of="Select",[xy,_y,G0e]=mp(of),[sl,W4e]=fr(of,[G0e,uc]),Sy=uc(),[ebe,Pi]=sl(of),[tbe,nbe]=sl(of),lF=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:o,value:i,defaultValue:s,onValueChange:c,dir:l,name:u,autoComplete:d,disabled:f,required:p,form:m}=e,y=Sy(t),[v,b]=g.useState(null),[w,_]=g.useState(null),[x,S]=g.useState(!1),j=si(l),[E=!1,O]=Rn({prop:r,defaultProp:a,onChange:o}),[P,k]=Rn({prop:i,defaultProp:s,onChange:c}),N=g.useRef(null),R=v?m||!!v.closest("form"):!0,[M,C]=g.useState(new Set),T=Array.from(M).map(A=>A.props.value).join(";");return h.jsx(lh,{...y,children:h.jsxs(ebe,{required:p,scope:t,trigger:v,onTriggerChange:b,valueNode:w,onValueNodeChange:_,valueNodeHasChildren:x,onValueNodeHasChildrenChange:S,contentId:zt(),value:P,onValueChange:k,open:E,onOpenChange:O,dir:j,triggerPointerDownPosRef:N,disabled:f,children:[h.jsx(xy.Provider,{scope:t,children:h.jsx(tbe,{scope:e.__scopeSelect,onNativeOptionAdd:g.useCallback(A=>{C(I=>new Set(I).add(A))},[]),onNativeOptionRemove:g.useCallback(A=>{C(I=>{const F=new Set(I);return F.delete(A),F})},[]),children:n})}),R?h.jsxs(RF,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:P,onChange:A=>k(A.target.value),disabled:f,form:m,children:[P===void 0?h.jsx("option",{value:""}):null,Array.from(M)]},T):null]})})};lF.displayName=of;var uF="SelectTrigger",dF=g.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,o=Sy(n),i=Pi(uF,n),s=i.disabled||r,c=kt(t,i.onTriggerChange),l=_y(n),u=g.useRef("touch"),[d,f,p]=IF(y=>{const v=l().filter(_=>!_.disabled),b=v.find(_=>_.value===i.value),w=DF(v,y,b);w!==void 0&&i.onValueChange(w.value)}),m=y=>{s||(i.onOpenChange(!0),p()),y&&(i.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return h.jsx(Pb,{asChild:!0,...o,children:h.jsx($e.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":TF(i.value)?"":void 0,...a,ref:c,onClick:_e(a.onClick,y=>{y.currentTarget.focus(),u.current!=="mouse"&&m(y)}),onPointerDown:_e(a.onPointerDown,y=>{u.current=y.pointerType;const v=y.target;v.hasPointerCapture(y.pointerId)&&v.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(m(y),y.preventDefault())}),onKeyDown:_e(a.onKeyDown,y=>{const v=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&f(y.key),!(v&&y.key===" ")&&J0e.includes(y.key)&&(m(),y.preventDefault())})})})});dF.displayName=uF;var fF="SelectValue",pF=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:o,placeholder:i="",...s}=e,c=Pi(fF,n),{onValueNodeHasChildrenChange:l}=c,u=o!==void 0,d=kt(t,c.onValueNodeChange);return fn(()=>{l(u)},[l,u]),h.jsx($e.span,{...s,ref:d,style:{pointerEvents:"none"},children:TF(c.value)?h.jsx(h.Fragment,{children:i}):o})});pF.displayName=fF;var rbe="SelectIcon",hF=g.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return h.jsx($e.span,{"aria-hidden":!0,...a,ref:t,children:r||"\u25BC"})});hF.displayName=rbe;var abe="SelectPortal",mF=e=>h.jsx(Ev,{asChild:!0,...e});mF.displayName=abe;var xs="SelectContent",yF=g.forwardRef((e,t)=>{const n=Pi(xs,e.__scopeSelect),[r,a]=g.useState();if(fn(()=>{a(new DocumentFragment)},[]),!n.open){const o=r;return o?ru.createPortal(h.jsx(gF,{scope:e.__scopeSelect,children:h.jsx(xy.Slot,{scope:e.__scopeSelect,children:h.jsx("div",{children:e.children})})}),o):null}return h.jsx(vF,{...e,ref:t})});yF.displayName=xs;var Oa=10,[gF,Ni]=sl(xs),obe="SelectContentImpl",vF=g.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:i,side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:y,avoidCollisions:v,...b}=e,w=Pi(xs,n),[_,x]=g.useState(null),[S,j]=g.useState(null),E=kt(t,W=>x(W)),[O,P]=g.useState(null),[k,N]=g.useState(null),R=_y(n),[M,C]=g.useState(!1),T=g.useRef(!1);g.useEffect(()=>{if(_)return vu(_)},[_]),bu();const A=g.useCallback(W=>{const[q,...Z]=R().map(H=>H.ref.current),[ee]=Z.slice(-1),oe=document.activeElement;for(const H of W)if(H===oe||(H==null||H.scrollIntoView({block:"nearest"}),H===q&&S&&(S.scrollTop=0),H===ee&&S&&(S.scrollTop=S.scrollHeight),H==null||H.focus(),document.activeElement!==oe))return},[R,S]),I=g.useCallback(()=>A([O,_]),[A,O,_]);g.useEffect(()=>{M&&I()},[M,I]);const{onOpenChange:F,triggerPointerDownPosRef:D}=w;g.useEffect(()=>{if(_){let W={x:0,y:0};const q=ee=>{var oe,H;W={x:Math.abs(Math.round(ee.pageX)-(((oe=D.current)==null?void 0:oe.x)??0)),y:Math.abs(Math.round(ee.pageY)-(((H=D.current)==null?void 0:H.y)??0))}},Z=ee=>{W.x<=10&&W.y<=10?ee.preventDefault():_.contains(ee.target)||F(!1),document.removeEventListener("pointermove",q),D.current=null};return D.current!==null&&(document.addEventListener("pointermove",q),document.addEventListener("pointerup",Z,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",q),document.removeEventListener("pointerup",Z,{capture:!0})}}},[_,F,D]),g.useEffect(()=>{const W=()=>F(!1);return window.addEventListener("blur",W),window.addEventListener("resize",W),()=>{window.removeEventListener("blur",W),window.removeEventListener("resize",W)}},[F]);const[V,U]=IF(W=>{const q=R().filter(oe=>!oe.disabled),Z=q.find(oe=>oe.ref.current===document.activeElement),ee=DF(q,W,Z);ee&&setTimeout(()=>ee.ref.current.focus())}),B=g.useCallback((W,q,Z)=>{const ee=!T.current&&!Z;(w.value!==void 0&&w.value===q||ee)&&(P(W),ee&&(T.current=!0))},[w.value]),K=g.useCallback(()=>_==null?void 0:_.focus(),[_]),te=g.useCallback((W,q,Z)=>{const ee=!T.current&&!Z;(w.value!==void 0&&w.value===q||ee)&&N(W)},[w.value]),L=r==="popper"?Uj:bF,$=L===Uj?{side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:y,avoidCollisions:v}:{};return h.jsx(gF,{scope:n,content:_,viewport:S,onViewportChange:j,itemRefCallback:B,selectedItem:O,onItemLeave:K,itemTextRefCallback:te,focusSelectedItem:I,selectedItemText:k,position:r,isPositioned:M,searchRef:V,children:h.jsx(Jp,{as:ii,allowPinchZoom:!0,children:h.jsx(Vp,{asChild:!0,trapped:w.open,onMountAutoFocus:W=>{W.preventDefault()},onUnmountAutoFocus:_e(a,W=>{var q;(q=w.trigger)==null||q.focus({preventScroll:!0}),W.preventDefault()}),children:h.jsx(jv,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:W=>W.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:h.jsx(L,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:W=>W.preventDefault(),...b,...$,onPlaced:()=>C(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:_e(b.onKeyDown,W=>{const q=W.ctrlKey||W.altKey||W.metaKey;if(W.key==="Tab"&&W.preventDefault(),!q&&W.key.length===1&&U(W.key),["ArrowUp","ArrowDown","Home","End"].includes(W.key)){let Z=R().filter(ee=>!ee.disabled).map(ee=>ee.ref.current);if(["ArrowUp","End"].includes(W.key)&&(Z=Z.slice().reverse()),["ArrowUp","ArrowDown"].includes(W.key)){const ee=W.target,oe=Z.indexOf(ee);Z=Z.slice(oe+1)}setTimeout(()=>A(Z)),W.preventDefault()}})})})})})})});vF.displayName=obe;var ibe="SelectItemAlignedPosition",bF=g.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,o=Pi(xs,n),i=Ni(xs,n),[s,c]=g.useState(null),[l,u]=g.useState(null),d=kt(t,E=>u(E)),f=_y(n),p=g.useRef(!1),m=g.useRef(!0),{viewport:y,selectedItem:v,selectedItemText:b,focusSelectedItem:w}=i,_=g.useCallback(()=>{if(o.trigger&&o.valueNode&&s&&l&&y&&v&&b){const E=o.trigger.getBoundingClientRect(),O=l.getBoundingClientRect(),P=o.valueNode.getBoundingClientRect(),k=b.getBoundingClientRect();if(o.dir!=="rtl"){const ee=k.left-O.left,oe=P.left-ee,H=E.left-oe,le=E.width+H,ie=Math.max(le,O.width),pe=window.innerWidth-Oa,Oe=b0(oe,[Oa,Math.max(Oa,pe-ie)]);s.style.minWidth=le+"px",s.style.left=Oe+"px"}else{const ee=O.right-k.right,oe=window.innerWidth-P.right-ee,H=window.innerWidth-E.right-oe,le=E.width+H,ie=Math.max(le,O.width),pe=window.innerWidth-Oa,Oe=b0(oe,[Oa,Math.max(Oa,pe-ie)]);s.style.minWidth=le+"px",s.style.right=Oe+"px"}const N=f(),R=window.innerHeight-Oa*2,M=y.scrollHeight,C=window.getComputedStyle(l),T=parseInt(C.borderTopWidth,10),A=parseInt(C.paddingTop,10),I=parseInt(C.borderBottomWidth,10),F=parseInt(C.paddingBottom,10),D=T+A+M+F+I,V=Math.min(v.offsetHeight*5,D),U=window.getComputedStyle(y),B=parseInt(U.paddingTop,10),K=parseInt(U.paddingBottom,10),te=E.top+E.height/2-Oa,L=R-te,$=v.offsetHeight/2,W=v.offsetTop+$,q=T+A+W,Z=D-q;if(q<=te){const ee=N.length>0&&v===N[N.length-1].ref.current;s.style.bottom="0px";const oe=l.clientHeight-y.offsetTop-y.offsetHeight,H=Math.max(L,$+(ee?K:0)+oe+I),le=q+H;s.style.height=le+"px"}else{const ee=N.length>0&&v===N[0].ref.current;s.style.top="0px";const oe=Math.max(te,T+y.offsetTop+(ee?B:0)+$)+Z;s.style.height=oe+"px",y.scrollTop=q-te+y.offsetTop}s.style.margin=`${Oa}px 0`,s.style.minHeight=V+"px",s.style.maxHeight=R+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[f,o.trigger,o.valueNode,s,l,y,v,b,o.dir,r]);fn(()=>_(),[_]);const[x,S]=g.useState();fn(()=>{l&&S(window.getComputedStyle(l).zIndex)},[l]);const j=g.useCallback(E=>{E&&m.current===!0&&(_(),w==null||w(),m.current=!1)},[_,w]);return h.jsx(cbe,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:p,onScrollButtonChange:j,children:h.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:x},children:h.jsx($e.div,{...a,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});bF.displayName=ibe;var sbe="SelectPopperPosition",Uj=g.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=Oa,...o}=e,i=Sy(n);return h.jsx(Nb,{...i,...o,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Uj.displayName=sbe;var[cbe,Vj]=sl(xs,{}),Wj="SelectViewport",wF=g.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,o=Ni(Wj,n),i=Vj(Wj,n),s=kt(t,o.onViewportChange),c=g.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),h.jsx(xy.Slot,{scope:n,children:h.jsx($e.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:_e(a.onScroll,l=>{const u=l.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=i;if(f!=null&&f.current&&d){const p=Math.abs(c.current-u.scrollTop);if(p>0){const m=window.innerHeight-Oa*2,y=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),b=Math.max(y,v);if(b<m){const w=b+p,_=Math.min(m,w),x=w-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=x>0?x:0,d.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});wF.displayName=Wj;var xF="SelectGroup",[lbe,ube]=sl(xF),dbe=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=zt();return h.jsx(lbe,{scope:n,id:a,children:h.jsx($e.div,{role:"group","aria-labelledby":a,...r,ref:t})})});dbe.displayName=xF;var _F="SelectLabel",SF=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=ube(_F,n);return h.jsx($e.div,{id:a.id,...r,ref:t})});SF.displayName=_F;var jy="SelectItem",[fbe,jF]=sl(jy),EF=g.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:o,...i}=e,s=Pi(jy,n),c=Ni(jy,n),l=s.value===r,[u,d]=g.useState(o??""),[f,p]=g.useState(!1),m=kt(t,w=>{var _;return(_=c.itemRefCallback)==null?void 0:_.call(c,w,r,a)}),y=zt(),v=g.useRef("touch"),b=()=>{a||(s.onValueChange(r),s.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(fbe,{scope:n,value:r,disabled:a,textId:y,isSelected:l,onItemTextChange:g.useCallback(w=>{d(_=>_||((w==null?void 0:w.textContent)??"").trim())},[]),children:h.jsx(xy.ItemSlot,{scope:n,value:r,disabled:a,textValue:u,children:h.jsx($e.div,{role:"option","aria-labelledby":y,"data-highlighted":f?"":void 0,"aria-selected":l&&f,"data-state":l?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:m,onFocus:_e(i.onFocus,()=>p(!0)),onBlur:_e(i.onBlur,()=>p(!1)),onClick:_e(i.onClick,()=>{v.current!=="mouse"&&b()}),onPointerUp:_e(i.onPointerUp,()=>{v.current==="mouse"&&b()}),onPointerDown:_e(i.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:_e(i.onPointerMove,w=>{var _;v.current=w.pointerType,a?(_=c.onItemLeave)==null||_.call(c):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:_e(i.onPointerLeave,w=>{var _;w.currentTarget===document.activeElement&&((_=c.onItemLeave)==null||_.call(c))}),onKeyDown:_e(i.onKeyDown,w=>{var _;((_=c.searchRef)==null?void 0:_.current)!==""&&w.key===" "||(Q0e.includes(w.key)&&b(),w.key===" "&&w.preventDefault())})})})})});EF.displayName=jy;var sf="SelectItemText",OF=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...o}=e,i=Pi(sf,n),s=Ni(sf,n),c=jF(sf,n),l=nbe(sf,n),[u,d]=g.useState(null),f=kt(t,b=>d(b),c.onItemTextChange,b=>{var w;return(w=s.itemTextRefCallback)==null?void 0:w.call(s,b,c.value,c.disabled)}),p=u==null?void 0:u.textContent,m=g.useMemo(()=>h.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:y,onNativeOptionRemove:v}=l;return fn(()=>(y(m),()=>v(m)),[y,v,m]),h.jsxs(h.Fragment,{children:[h.jsx($e.span,{id:c.textId,...o,ref:f}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?ru.createPortal(o.children,i.valueNode):null]})});OF.displayName=sf;var CF="SelectItemIndicator",kF=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return jF(CF,n).isSelected?h.jsx($e.span,{"aria-hidden":!0,...r,ref:t}):null});kF.displayName=CF;var Hj="SelectScrollUpButton",PF=g.forwardRef((e,t)=>{const n=Ni(Hj,e.__scopeSelect),r=Vj(Hj,e.__scopeSelect),[a,o]=g.useState(!1),i=kt(t,r.onScrollButtonChange);return fn(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollTop>0;o(l)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(MF,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop-c.offsetHeight)}}):null});PF.displayName=Hj;var qj="SelectScrollDownButton",NF=g.forwardRef((e,t)=>{const n=Ni(qj,e.__scopeSelect),r=Vj(qj,e.__scopeSelect),[a,o]=g.useState(!1),i=kt(t,r.onScrollButtonChange);return fn(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<l;o(u)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(MF,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop+c.offsetHeight)}}):null});NF.displayName=qj;var MF=g.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,o=Ni("SelectScrollButton",n),i=g.useRef(null),s=_y(n),c=g.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return g.useEffect(()=>()=>c(),[c]),fn(()=>{var l,u;(u=(l=s().find(d=>d.ref.current===document.activeElement))==null?void 0:l.ref.current)==null||u.scrollIntoView({block:"nearest"})},[s]),h.jsx($e.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:_e(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:_e(a.onPointerMove,()=>{var l;(l=o.onItemLeave)==null||l.call(o),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:_e(a.onPointerLeave,()=>{c()})})}),pbe="SelectSeparator",AF=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return h.jsx($e.div,{"aria-hidden":!0,...r,ref:t})});AF.displayName=pbe;var Zj="SelectArrow",hbe=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Sy(n),o=Pi(Zj,n),i=Ni(Zj,n);return o.open&&i.position==="popper"?h.jsx(Mb,{...a,...r,ref:t}):null});hbe.displayName=Zj;function TF(e){return e===""||e===void 0}var RF=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=g.useRef(null),o=kt(t,a),i=cF(n);return g.useEffect(()=>{const s=a.current,c=window.HTMLSelectElement.prototype,l=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==n&&l){const u=new Event("change",{bubbles:!0});l.call(s,n),s.dispatchEvent(u)}},[i,n]),h.jsx(w4e,{asChild:!0,children:h.jsx("select",{...r,ref:o,defaultValue:n})})});RF.displayName="BubbleSelect";function IF(e){const t=pr(e),n=g.useRef(""),r=g.useRef(0),a=g.useCallback(i=>{const s=n.current+i;t(s),function c(l){n.current=l,window.clearTimeout(r.current),l!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(s)},[t]),o=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,o]}function DF(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=mbe(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.textValue.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function mbe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var ybe=lF,LF=dF,gbe=pF,vbe=hF,bbe=mF,$F=yF,wbe=wF,FF=SF,BF=EF,xbe=OF,_be=kF,zF=PF,UF=NF,VF=AF;const zo=ybe,Uo=gbe,eo=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(LF,{ref:r,className:G("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,h.jsx(vbe,{asChild:!0,children:h.jsx(me,{name:"chevron-down",className:"h-4 w-4 opacity-50"})})]}));eo.displayName=LF.displayName;const WF=g.forwardRef(({className:e,...t},n)=>h.jsx(zF,{ref:n,className:G("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(me,{name:"chevron-up",className:"h-4 w-4"})}));WF.displayName=zF.displayName;const HF=g.forwardRef(({className:e,...t},n)=>h.jsx(UF,{ref:n,className:G("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(me,{name:"chevron-down",className:"h-4 w-4"})}));HF.displayName=UF.displayName;const to=g.forwardRef(({className:e,children:t,position:n="popper",...r},a)=>h.jsx(bbe,{children:h.jsxs($F,{ref:a,className:G("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[h.jsx(WF,{}),h.jsx(wbe,{className:G("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),h.jsx(HF,{})]})}));to.displayName=$F.displayName;const Sbe=g.forwardRef(({className:e,...t},n)=>h.jsx(FF,{ref:n,className:G("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Sbe.displayName=FF.displayName;const cr=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(BF,{ref:r,className:G("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(_be,{children:h.jsx(me,{name:"check",className:"h-4 w-4"})})}),h.jsx(xbe,{children:t})]}));cr.displayName=BF.displayName;const jbe=g.forwardRef(({className:e,...t},n)=>h.jsx(VF,{ref:n,className:G("-mx-1 my-1 h-px bg-muted",e),...t}));jbe.displayName=VF.displayName;var Vo="Accordion",Ebe=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Kj,Obe,Cbe]=mp(Vo),[Ey,H4e]=fr(Vo,[Cbe,KM]),Xj=KM(),qF=Y.forwardRef((e,t)=>{const{type:n,...r}=e,a=r,o=r;return h.jsx(Kj.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?h.jsx(Mbe,{...o,ref:t}):h.jsx(Nbe,{...a,ref:t})})});qF.displayName=Vo;var[ZF,kbe]=Ey(Vo),[KF,Pbe]=Ey(Vo,{collapsible:!1}),Nbe=Y.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:o=!1,...i}=e,[s,c]=Rn({prop:n,defaultProp:r,onChange:a});return h.jsx(ZF,{scope:e.__scopeAccordion,value:s?[s]:[],onItemOpen:c,onItemClose:Y.useCallback(()=>o&&c(""),[o,c]),children:h.jsx(KF,{scope:e.__scopeAccordion,collapsible:o,children:h.jsx(XF,{...i,ref:t})})})}),Mbe=Y.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Rn({prop:n,defaultProp:r,onChange:a}),c=Y.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=Y.useCallback(u=>s((d=[])=>d.filter(f=>f!==u)),[s]);return h.jsx(ZF,{scope:e.__scopeAccordion,value:i,onItemOpen:c,onItemClose:l,children:h.jsx(KF,{scope:e.__scopeAccordion,collapsible:!0,children:h.jsx(XF,{...o,ref:t})})})}),[Abe,Oy]=Ey(Vo),XF=Y.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:o="vertical",...i}=e,s=Y.useRef(null),c=kt(s,t),l=Obe(n),u=si(a)==="ltr",d=_e(e.onKeyDown,f=>{var E;if(!Ebe.includes(f.key))return;const p=f.target,m=l().filter(O=>{var P;return!((P=O.ref.current)!=null&&P.disabled)}),y=m.findIndex(O=>O.ref.current===p),v=m.length;if(y===-1)return;f.preventDefault();let b=y;const w=0,_=v-1,x=()=>{b=y+1,b>_&&(b=w)},S=()=>{b=y-1,b<w&&(b=_)};switch(f.key){case"Home":b=w;break;case"End":b=_;break;case"ArrowRight":o==="horizontal"&&(u?x():S());break;case"ArrowDown":o==="vertical"&&x();break;case"ArrowLeft":o==="horizontal"&&(u?S():x());break;case"ArrowUp":o==="vertical"&&S();break}const j=b%v;(E=m[j].ref.current)==null||E.focus()});return h.jsx(Abe,{scope:n,disabled:r,direction:a,orientation:o,children:h.jsx(Kj.Slot,{scope:n,children:h.jsx($e.div,{...i,"data-orientation":o,ref:c,onKeyDown:r?void 0:d})})})}),Cy="AccordionItem",[Tbe,Yj]=Ey(Cy),YF=Y.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...a}=e,o=Oy(Cy,n),i=kbe(Cy,n),s=Xj(n),c=zt(),l=r&&i.value.includes(r)||!1,u=o.disabled||e.disabled;return h.jsx(Tbe,{scope:n,open:l,disabled:u,triggerId:c,children:h.jsx(JM,{"data-orientation":o.orientation,"data-state":nB(l),...s,...a,ref:t,disabled:u,open:l,onOpenChange:d=>{d?i.onItemOpen(r):i.onItemClose(r)}})})});YF.displayName=Cy;var JF="AccordionHeader",QF=Y.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Oy(Vo,n),o=Yj(JF,n);return h.jsx($e.h3,{"data-orientation":a.orientation,"data-state":nB(o.open),"data-disabled":o.disabled?"":void 0,...r,ref:t})});QF.displayName=JF;var Jj="AccordionTrigger",GF=Y.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Oy(Vo,n),o=Yj(Jj,n),i=Pbe(Jj,n),s=Xj(n);return h.jsx(Kj.ItemSlot,{scope:n,children:h.jsx(vQ,{"aria-disabled":o.open&&!i.collapsible||void 0,"data-orientation":a.orientation,id:o.triggerId,...s,...r,ref:t})})});GF.displayName=Jj;var eB="AccordionContent",tB=Y.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Oy(Vo,n),o=Yj(eB,n),i=Xj(n);return h.jsx(bQ,{role:"region","aria-labelledby":o.triggerId,"data-orientation":a.orientation,...i,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});tB.displayName=eB;function nB(e){return e?"open":"closed"}let rB;AN=qF,TN=YF,rB=QF,w0=GF,x0=tB;const aB=AN,Qj=g.forwardRef(({className:e,...t},n)=>h.jsx(TN,{ref:n,className:G("border-b",e),...t}));Qj.displayName="AccordionItem";const Gj=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(rB,{className:"flex",children:h.jsxs(w0,{ref:r,className:G("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,h.jsx(me,{name:"chevron-down",className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Gj.displayName=w0.displayName;const eE=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(x0,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:h.jsx("div",{className:G("pb-4 pt-0",e),children:t})}));eE.displayName=x0.displayName;const Rbe=[1,2,3,4,5,6,7,8,9,10],oB=g.memo(e=>{const{t}=Re("flows"),[n,r]=g.useState(""),[a,o]=g.useState([]),[i,s]=g.useState("1"),{loading:c,onSimilaritySearch:l,onCreatePrompt:u,onCreateRetriever:d}=e,f=async()=>{o(await l(n,+i)),r("")},p=async m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),f())};return h.jsxs("div",{className:"mt-4 max-w-full",children:[h.jsx("div",{className:"bg-black/5 dark:bg-white/5 rounded-xl relative",children:h.jsxs("div",{className:"relative px-2 py-1 pb-2",children:[h.jsxs(zo,{value:`${i}`,onValueChange:m=>s(m),children:[h.jsx(eo,{className:"absolute left-0 !w-14 top-[2px] rounded-xl bg-transparent border-none focus:outline-none focus:ring-0 focus:border-opacity-0 focus:ring-transparent",children:h.jsx(Uo,{placeholder:t("vector_database_node.k_select_placeholder")})}),h.jsx(to,{children:Rbe.map(m=>h.jsx(cr,{value:`${m}`,children:m},`${m}`))})]}),h.jsx(Va,{value:n,disabled:c,placeholder:t("vector_database_node.similarity_search_placeholder"),className:G("w-full rounded-xl px-2 pl-11 border-none resize-none bg-transparent","min-h-8 max-h-8"),onKeyDown:p,onChange:m=>{r(m.target.value)}}),h.jsx("button",{type:"button",disabled:c,onClick:f,className:"absolute right-3 top-5 -translate-y-1/2 rounded-xl bg-black/5 dark:bg-white/5 p-1",children:h.jsx(me,{name:c?"loader-circle":"arrow-right",className:G("w-4 h-4 dark:text-white",n?"opacity-100":"opacity-30",c?"animate-spin":"")})})]})}),h.jsx(aB,{type:"single",collapsible:!0,children:a==null?void 0:a.map(([m,y],v)=>h.jsxs(Qj,{value:`${v}`,children:[h.jsxs(Gj,{children:[`[${y.toFixed(2)}] ${m.pageContent}`.substring(0,32),"..."]}),h.jsx(eE,{children:m.pageContent})]},`${v}`))}),h.jsxs("div",{className:"w-full mt-4 flex flex-col gap-1",children:[d?h.jsx(yt,{disabled:c,onClick:d,className:"w-full",children:t("vector_database_node.to_retriever")}):void 0,a!=null&&a.length&&u?h.jsx(yt,{disabled:c,onClick:()=>u(a),className:"w-full",children:t("vector_database_node.create_prompt")}):void 0]})]})}),iB=g.memo(({loading:e,onCreateData:t})=>{const{t:n}=Re("flows"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=async()=>{o&&(await t({id:r,content:o}),a(""),i(""))};return h.jsxs("div",{className:"min-w-80",children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(it,{htmlFor:"name",children:n("vector_database_node.add_text.id")}),h.jsx(In,{value:r,disabled:e,onChange:c=>a(c.target.value||""),placeholder:n("vector_database_node.add_text.id_placeholder"),className:"mb-4"}),h.jsxs(it,{htmlFor:"name",children:[n("vector_database_node.add_text.content")," ",h.jsx("span",{className:"text-red-600",children:"*"})]}),h.jsx(Va,{value:o,disabled:e,onChange:c=>i(c.target.value||""),placeholder:n("vector_database_node.add_text.content_placeholder")})]}),h.jsx("div",{className:"flex justify-between mt-6",children:h.jsx(tr,{loading:e,disabled:!(o!=null&&o.length),onClick:s,className:"w-full",children:n("vector_database_node.add_text.add")})})]})}),tE=({className:e,size:t=200,duration:n=15,anchor:r=90,borderWidth:a=1.5,colorFrom:o="#ffaa40",colorTo:i="#9c40ff",delay:s=0})=>h.jsx("div",{style:{"--size":t,"--duration":n,"--anchor":r,"--border-width":a,"--color-from":o,"--color-to":i,"--delay":`-${s}s`},className:G("pointer-events-none absolute inset-0 rounded-[inherit] [border:calc(var(--border-width)*1px)_solid_transparent]","![mask-clip:padding-box,border-box] ![mask-composite:intersect] [mask:linear-gradient(transparent,transparent),linear-gradient(white,white)]","after:absolute after:aspect-square after:w-[calc(var(--size)*1px)] after:animate-border-beam after:[animation-delay:var(--delay)] after:[background:linear-gradient(to_left,var(--color-from),var(--color-to),transparent)] after:[offset-anchor:calc(var(--anchor)*1%)_50%] after:[offset-path:rect(0_auto_auto_0_round_calc(var(--size)*1px))]",e)});function Ibe({accept:e,maxSize:t}){const{t:n}=Re("atoms"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=g.useRef(null),[c,l]=g.useState(0),u=f=>{var m;const p=(m=f.target.files)==null?void 0:m[0];d(p)},d=f=>{if(i(""),f){if(t&&f.size>t*1024*1024){i(n("file_upload_input.errors.max_size",{maxSize:t,fileSize:(f.size/1024/1024).toFixed(2)}));return}const p=e==null?void 0:e.split(",").map(m=>m.replace(".","").trim());if(e&&!f.type.match(e.replace("/*",""))&&!(p!=null&&p.some(m=>f.type.includes(m)))){i(n("file_upload_input.errors.accept",{accept:e}));return}return l(f.size),a(f.name),f}};return{fileName:r,error:o,fileInputRef:s,handleFileSelect:u,validateAndSetFile:d,clearFile:()=>{a(""),i(""),l(0),s.current&&(s.current.value="")},fileSize:c}}function Dbe({file:e,setFile:t,loading:n,progress:r,fileOptions:a}){const{toast:o}=on(),{t:i}=Re("atoms"),[s,c]=g.useState(!1),{fileName:l,fileInputRef:u,clearFile:d,error:f,validateAndSetFile:p,fileSize:m}=Ibe({accept:(a==null?void 0:a.accept)||"image/*",maxSize:(a==null?void 0:a.maxSize)||3});g.useEffect(()=>{e||d()},[d,e]),g.useEffect(()=>{f&&o({title:f,variant:"destructive"})},[f,o]);function y(x){const S=p(x);S&&t(S)}function v(x){x.preventDefault(),c(!1);const S=x.dataTransfer.files[0];S&&y(S)}function b(x){var j;const S=(j=x.target.files)==null?void 0:j[0];S&&y(S)}function w(){d(),t(void 0)}const _=g.useMemo(()=>{if(!e)return h.jsx("div",{className:"w-16 h-16 rounded-lg bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center",children:h.jsx(me,{name:"file-text",className:"w-8 h-8 text-zinc-400"})});const x=e.type.startsWith("image/");return h.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:x?h.jsx("img",{src:URL.createObjectURL(e),alt:"Preview",className:"w-full h-full object-cover"}):h.jsx(me,{className:"w-14 h-14",name:"file-text"})})},[e]);return h.jsx(h.Fragment,{children:h.jsxs("div",{className:G("relative group cursor-pointer","rounded-lg border-2 border-dashed","transition-colors duration-200",s?"border-indigo-500 bg-indigo-50/50 dark:bg-indigo-500/10":"border-zinc-200 dark:border-zinc-800"),onDragOver:x=>{x.preventDefault(),c(!0)},onDragLeave:()=>c(!1),onDrop:v,onClick:()=>{var x;return(x=u.current)==null?void 0:x.click()},onKeyDown:x=>{var S;(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),(S=u.current)==null||S.click())},"aria-label":"Upload file",children:[h.jsx("input",{ref:u,type:"file",disabled:n||!!(r&&r<1),accept:(a==null?void 0:a.accept)||"image/*",onChange:b,className:"hidden"}),h.jsx("div",{className:"p-8 space-y-4",children:l?h.jsxs("div",{className:"flex items-center gap-4",children:[_,h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("p",{className:"text-sm font-medium truncate",children:[l||"No file selected"," ",h.jsx("span",{className:"text-xs text-zinc-500 leading-5",children:m?`(${(m/1024/1024).toFixed(2)} MB)`:""})]}),r&&r<1?h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsxs("p",{children:[(r*100).toFixed(2)," %"]}),h.jsx("div",{className:"h-1 flex-1 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden items-center flex",children:h.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-200",style:{width:`${r*100}%`}})})]}):void 0]}),h.jsx("button",{type:"button",disabled:n||!!(r&&r<1),onClick:x=>{x.stopPropagation(),w()},className:"p-1 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded",children:h.jsx(me,{name:"x",className:"w-5 h-5 text-zinc-400"})}),r&&r<1?h.jsx(tE,{className:"rounded-lg"}):void 0]}):h.jsxs("div",{className:"flex flex-col items-center gap-2",children:[h.jsx(me,{name:"upload",className:"w-8 h-8 text-zinc-400 dark:text-zinc-500"}),h.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:i("file_upload_input.drop_file")})]})})]})})}function sB({onFileSubmit:e,fileOptions:t,progress:n,loading:r}){const{t:a}=Re("flows"),[o,i]=g.useState(),s=async()=>{o&&(await e(o),i(void 0))};return h.jsxs("div",{className:"w-full max-w-full space-y-2 mt-4",children:[h.jsx("div",{className:"mb-6",children:h.jsx(Dbe,{progress:n,loading:r,fileOptions:t,setFile:i,file:o})}),h.jsx(tr,{loading:r,disabled:!o,onClick:s,className:"w-full mt-4",children:a("vector_database_node.add_file.index")})]})}const ky=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{className:"relative w-full overflow-auto",children:h.jsx("table",{ref:n,className:G("w-full caption-bottom text-sm",e),...t})}));ky.displayName="Table";const Py=g.forwardRef(({className:e,...t},n)=>h.jsx("thead",{ref:n,className:G("[&_tr]:border-b",e),...t}));Py.displayName="TableHeader";const Ny=g.forwardRef(({className:e,...t},n)=>h.jsx("tbody",{ref:n,className:G("[&_tr:last-child]:border-0",e),...t}));Ny.displayName="TableBody";const Lbe=g.forwardRef(({className:e,...t},n)=>h.jsx("tfoot",{ref:n,className:G("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Lbe.displayName="TableFooter";const _s=g.forwardRef(({className:e,...t},n)=>h.jsx("tr",{ref:n,className:G("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));_s.displayName="TableRow";const cl=g.forwardRef(({className:e,...t},n)=>h.jsx("th",{ref:n,className:G("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));cl.displayName="TableHead";const ll=g.forwardRef(({className:e,...t},n)=>h.jsx("td",{ref:n,className:G("align-middle [&:has([role=checkbox])]:pr-0",e),...t}));ll.displayName="TableCell";const $be=g.forwardRef(({className:e,...t},n)=>h.jsx("caption",{ref:n,className:G("mt-4 text-sm text-muted-foreground",e),...t}));$be.displayName="TableCaption";const cB=({className:e,...t})=>h.jsx("nav",{role:"navigation","aria-label":"pagination",className:G("mx-auto flex w-full justify-center",e),...t});cB.displayName="Pagination";const lB=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,className:G("flex flex-row items-center gap-1",e),...t}));lB.displayName="PaginationContent";const ul=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,className:G("",e),...t}));ul.displayName="PaginationItem";const My=({className:e,isActive:t,size:n="icon",...r})=>h.jsx("a",{"aria-current":t?"page":void 0,className:G(Nu({variant:t?"outline":"ghost",size:n}),e),...r});My.displayName="PaginationLink";const uB=({className:e,...t})=>{const{t:n}=Re("atoms");return h.jsxs(My,{"aria-label":"Go to previous page",size:"default",className:G("gap-1 pl-2.5",e),...t,children:[h.jsx(me,{name:"chevron-left",className:"h-4 w-4"}),h.jsx("span",{children:n("pagination.previous")})]})};uB.displayName="PaginationPrevious";const dB=({className:e,...t})=>{const{t:n}=Re("atoms");return h.jsxs(My,{"aria-label":"Go to next page",size:"default",className:G("gap-1 pr-2.5",e),...t,children:[h.jsx("span",{children:n("pagination.next")}),h.jsx(me,{name:"chevron-right",className:"h-4 w-4"})]})};dB.displayName="PaginationNext";const nE=({className:e,...t})=>{const{t:n}=Re("atoms");return h.jsxs("span",{"aria-hidden":!0,className:G("flex h-9 w-9 items-center justify-center",e),...t,children:[h.jsx(me,{name:"ellipsis",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:n("pagination.more_pages")})]})};nE.displayName="PaginationEllipsis";const fB=uo(({title:e,content:t})=>{const n=an();return h.jsx(yi,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(xo,{className:"sm:max-w-2xl",children:[h.jsx(_o,{children:h.jsxs("div",{className:"flex",children:[h.jsx(me,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(So,{children:e})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-96 overflow-hidden",children:h.jsx("div",{className:"relative w-full h-full overflow-hidden rounded-xl p-1 border border-border",children:h.jsx("pre",{className:"break-all h-full overflow-y-auto bg-background font-mono text-xs w-full",children:t})})})]})})}),Ay=g.memo(e=>{const{data:t,headers:n,limitLengthByColumns:r,showPerPage:a=7,paginationShowLimit:o=1,contentLengthLimit:i=64}=e,[s,c]=g.useState({page:1,maxPage:1}),l=an(fB);g.useEffect(()=>{c(p=>({...p,maxPage:Math.ceil(t.length/a)}))},[t.length,a]);const u=g.useMemo(()=>t.slice((s.page-1)*a,s.page*a),[t,s.page,a]),d=g.useMemo(()=>{let p=!1,m=!1;return h.jsx(cB,{className:"mt-4 mb-4 ml-4 mr-4 w-full",children:h.jsxs(lB,{children:[s.page>1?h.jsx(ul,{onClick:()=>c(y=>({...y,page:y.page-1})),children:h.jsx(uB,{})}):null,Array.from({length:s.maxPage},(y,v)=>{const b=v+1,w=v===0||v===s.maxPage-1;return!w&&b>s.page+o&&m?null:!w&&b>s.page+o?(m=!0,h.jsx(ul,{children:h.jsx(nE,{})},v)):!w&&b<s.page-o&&p?null:!w&&b<s.page-o?(p=!0,h.jsx(ul,{children:h.jsx(nE,{})},v)):h.jsx(ul,{onClick:()=>c(_=>({..._,page:b})),children:h.jsx(My,{isActive:v+1===s.page,children:v+1})},v)}),s.page<s.maxPage?h.jsx(ul,{onClick:()=>c(y=>({...y,page:y.page+1})),children:h.jsx(dB,{})}):null]})})},[s.maxPage,s.page,o]),f=(p,m)=>{if(!p)return;const y=Array.isArray(p)?p:n.map(v=>p[v]);return h.jsxs(_s,{children:[h.jsx(ll,{children:h.jsx("div",{className:"font-bold",children:m+1})}),y.map((v,b)=>{const w=typeof v=="string"?v:JSON.stringify(v),_=n[b],x=(r==null?void 0:r[_])||i,S=w.length>x;return h.jsx(ll,{className:"p-4",children:h.jsxs("div",{onClick:S?()=>l.show({title:_,content:w}):void 0,className:"flex gap-4",children:[S?`${w.substring(0,x)}...`:w,S?h.jsx(me,{className:"w-6 mt-[-2px]",name:"chevron-right"}):null]})},`${b}`)})]},`${m}`)};return h.jsxs(h.Fragment,{children:[h.jsxs(ky,{className:"w-full",children:[h.jsx(Py,{children:h.jsxs(_s,{children:[h.jsx(cl,{},"index"),n?n.map(p=>h.jsx(cl,{children:h.jsx("div",{className:"font-bold",children:p})},p)):void 0]})}),h.jsx(Ny,{children:u!=null&&u.length?u==null?void 0:u.map(f):void 0})]}),d]})});var rE,pB;N0=function(){if(pB)return rE;pB=1;function e(t,n,r){var a=-1,o=t.length;n<0&&(n=-n>o?0:o+n),r=r>o?o:r,r<0&&(r+=o),o=n>r?0:r-n>>>0,n>>>=0;for(var i=Array(o);++a<o;)i[a]=t[a+n];return i}return rE=e,rE};var aE,hB;qs=function(){if(hB)return aE;hB=1;var e=fu(),t=Zi(),n=Ih(),r=Xr();function a(o,i,s){if(!r(s))return!1;var c=typeof i;return(c=="number"?t(s)&&n(i,s.length):c=="string"&&i in s)?e(s[i],o):!1}return aE=a,aE};var oE,mB;function Fbe(){if(mB)return oE;mB=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return oE=t,oE}var iE,yB;function Bbe(){if(yB)return iE;yB=1;var e=Fbe(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return iE=n,iE}var sE,gB;function vB(){if(gB)return sE;gB=1;var e=Bbe(),t=Xr(),n=bc(),r=NaN,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=o.test(l);return d||i.test(l)?s(l.slice(2),d?2:8):a.test(l)?r:+l}return sE=c,sE}var cE,bB;function wB(){if(bB)return cE;bB=1;var e=vB(),t=1/0,n=17976931348623157e292;function r(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var o=a<0?-1:1;return o*n}return a===a?a:0}return cE=r,cE}var lE,xB;function _B(){if(xB)return lE;xB=1;var e=wB();function t(n){var r=e(n),a=r%1;return r===r?a?r-a:r:0}return lE=t,lE}var uE,SB;function zbe(){if(SB)return uE;SB=1;var e=N0(),t=qs(),n=_B(),r=Math.ceil,a=Math.max;function o(i,s,c){(c?t(i,s,c):s===void 0)?s=1:s=a(n(s),0);var l=i==null?0:i.length;if(!l||s<1)return[];for(var u=0,d=0,f=Array(r(l/s));u<l;)f[d++]=e(i,u,u+=s);return f}return uE=o,uE}var Ube=zbe();const dE=ft(Ube),Vbe=()=>{const[e,t]=g.useState(!1),{t:n}=Re("flows"),{toast:r}=on(),a=Hs(c=>c.index),o=Hs(c=>c.similaritySearchWithScore),i=g.useCallback(async(c,l)=>{try{if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===Zr.DataNode)throw new Error("DataNode storage is not supported for similarity search");return t(!0),await o({databaseId:l.vectorDatabase.id},c,l==null?void 0:l.k)}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[o,r,n]),s=g.useCallback(async(c,l)=>{var u;try{t(!0);const d=c.content?[new bp({pageContent:c.content,id:c.id,metadata:{id:c.id}})]:c.documents;if(!(d!=null&&d.length)){r({variant:"destructive",title:n("vector_database_node.errors.content_not_found")});return}if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===Zr.DataNode)throw new Error("DataNode storage is not supported for indexing");{const f=dE(d,10);let p=0;for(const m of f)(u=l==null?void 0:l.onProgressReport)==null||u.call(l,{handling:m.length,handled:p,total:d.length}),await a({databaseId:l.vectorDatabase.id},m),p+=m.length}}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[a,r,n]);return{loading:e,indexData:s,similaritySearchWithScore:i}},Wbe=uo(({retriverInfo:e})=>{var y,v,b;const{t}=Re("applications"),{loading:n,similaritySearchWithScore:r,indexData:a}=Vbe(),[o,i]=g.useState("search"),[s,c]=g.useState(0),l=an(),u=g.useMemo(()=>{var x,S;if(!((x=e==null?void 0:e.vectorDatabaseEntity)!=null&&x.raw))return{headers:[],rows:[]};const w=["content","embedding","metadata"],_=kv((S=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:S.raw);return{headers:w,rows:_.map(j=>{try{return JSON.parse(j)}catch{return[]}})}},[(y=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:y.raw]),d=g.useCallback(async(...w)=>{const[_,x]=w;await a(_,{...x,vectorDatabase:e.vectorDatabaseEntity})},[a,e.vectorDatabaseEntity]),f=g.useCallback(async(w,_)=>{const x=w.trim(),S=await r(x,{k:_,vectorDatabase:e.vectorDatabaseEntity});if(S!=null&&S.length)return S},[e.vectorDatabaseEntity,r]),p=g.useCallback(async w=>{if(w.type.includes("text")||w.type.includes("txt")){const _=new FileReader;_.onload=async x=>{var j;const S=(j=x.target)==null?void 0:j.result;await d({content:S},{vectorDatabase:e.vectorDatabaseEntity})},_.readAsText(w)}else if(w.type.endsWith("pdf")){const _=new Blob([w],{type:"application/pdf"}),x=await new K9(_,{pdfjs:async()=>{const S=await Qt(()=>import("./pdf.min-_jKpy57e.js").then(async j=>(await j.__tla,j)),__vite__mapDeps([11,1,2,3,4]));return await Qt(()=>import("./pdf.worker.min-D4zSgXYp.js").then(async j=>(await j.__tla,j)),__vite__mapDeps([12,1,2,3,4])),S.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),S},parsedItemSeparator:" "}).load();await d({documents:x},{vectorDatabase:e.vectorDatabaseEntity,onProgressReport:S=>{c((S.handled+S.handling)/S.total)}})}},[d,e.vectorDatabaseEntity]),m=g.useMemo(()=>{switch(o){case"search":return h.jsx(Ea,{value:"search",children:h.jsx(oB,{loading:n,onSimilaritySearch:f})});case"new":return h.jsx(Ea,{className:"min-w-80",value:"new",children:h.jsx(iB,{loading:n,onCreateData:d})});case"file":return h.jsx(Ea,{value:"file",children:h.jsx(sB,{loading:n,progress:s,onFileSubmit:p,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(Ea,{value:"view",className:"max-h-full overflow-auto",children:h.jsx(Ay,{data:u.rows,headers:u.headers,limitLengthByColumns:{embedding:32}})})}},[d,p,f,n,o,s,u]);return h.jsx(yi,{open:l.visible,onOpenChange:l.hide,children:h.jsxs(xo,{className:"max-w-3xl",children:[h.jsx(_o,{children:h.jsxs("div",{className:"flex",children:[h.jsx(me,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(So,{children:t("chat.vector_database")})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-full overflow-hidden",children:h.jsx("div",{className:"w-full h-full",children:h.jsxs(zj,{value:o,onValueChange:i,defaultValue:"search",className:G("w-full h-full mt-4"),children:[h.jsxs(wy,{className:G("grid w-full grid-cols-3",((v=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:v.storage)===Zr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(ja,{value:"search",children:t("chat.search")}),h.jsx(ja,{value:"new",children:t("chat.text")}),h.jsx(ja,{value:"file",children:t("chat.file")}),((b=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:b.storage)===Zr.DatabaseNode?h.jsx(ja,{value:"view",children:t("chat.view")}):void 0]}),m]})})})]})})});function Hbe({schema:e,mainLLMInfo:t,loadLLM:n,retriverInfo:r,threadNode:a,onSelectThread:o,onAddNewThread:i,currentDataNode:s,...c}){var S;const{t:l}=Re("applications"),[u,d]=g.useState(!1),f=an(C0e),p=an(Wbe),{chatList:m,getChatList:y,deleteChat:v}=H0e(a),b=g.useCallback(async()=>{try{d(!0),await(i==null?void 0:i()),y()}finally{d(!1)}},[y,i]),w=g.useCallback(()=>{p.show({retriverInfo:r[0]})},[r,p]),_=g.useCallback(async(j,E)=>{j.stopPropagation(),f.show({onDelete:()=>v(E)})},[v,f]),x=g.useMemo(()=>{var j;return h.jsx(Lj,{className:G("overflow-hidden break-words whitespace-pre-wrap w-full rounded-lg"),source:(j=e==null?void 0:e.schema_items)!=null&&j.length?`\`\`\`javascript
${q9((e==null?void 0:e.schema_items)||[])}
\`\`\``:""})},[e==null?void 0:e.schema_items]);return h.jsxs(Lb,{variant:"sidebar",side:"right",collapsible:"none",...c,children:[h.jsx("div",{className:"h-1"}),h.jsxs(Bu,{className:"justify-between",children:[h.jsx("div",{className:"text-sm pl-2",children:l("chat.history")}),h.jsx(tr,{loading:u,onClick:b,variant:"link",className:"mr-[-6px]",children:h.jsx(me,{name:"circle-plus"})})]}),h.jsxs(Fb,{children:[h.jsx(Fu,{className:"flex-1",children:h.jsx(fc,{children:m.map(({node:j},E)=>{var O;return h.jsx(bo,{onClick:()=>o(j),children:h.jsx(wo,{className:"cursor-pointer",children:h.jsxs("div",{className:"flex flex-row justify-between items-center w-full",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx(me,{size:16,name:((O=s==null?void 0:s.node)==null?void 0:O.id)===j.id?"check":"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"}),h.jsx("span",{children:`Thread ${E+1}`})]}),h.jsx(me,{onClick:P=>_(P,j),size:16,name:"trash-2"})]})})},j.id)})})}),r!=null&&r.length?h.jsxs(rn,{className:"m-2 p-2 max-w-full",children:[h.jsx("pre",{className:"overflow-auto",children:r.map((j,E)=>{var O;return h.jsx("span",{children:((O=j.promptEntity)==null?void 0:O.content)||""},`${E}`)})}),h.jsx(yt,{onClick:w,className:"w-full mt-4",children:l("chat.vector_database")})]}):void 0,(S=e==null?void 0:e.schema_items)!=null&&S.length?h.jsx("div",{className:"m-2 !mb-0",children:h.jsx(g.Suspense,{fallback:h.jsx(by,{}),children:x})}):void 0,h.jsx(W0e,{llm:t==null?void 0:t.llm,status:t==null?void 0:t.status,progress:t==null?void 0:t.progress,loadLLM:n})]})]})}var fE="Avatar",[qbe,q4e]=fr(fE),[Zbe,jB]=qbe(fE),EB=g.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,o]=g.useState("idle");return h.jsx(Zbe,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:h.jsx($e.span,{...r,ref:t})})});EB.displayName=fE;var OB="AvatarImage",CB=g.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...o}=e,i=jB(OB,n),s=Kbe(r,o.referrerPolicy),c=pr(l=>{a(l),i.onImageLoadingStatusChange(l)});return fn(()=>{s!=="idle"&&c(s)},[s,c]),s==="loaded"?h.jsx($e.img,{...o,ref:t,src:r}):null});CB.displayName=OB;var kB="AvatarFallback",PB=g.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,o=jB(kB,n),[i,s]=g.useState(r===void 0);return g.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(c)}},[r]),i&&o.imageLoadingStatus!=="loaded"?h.jsx($e.span,{...a,ref:t}):null});PB.displayName=kB;function Kbe(e,t){const[n,r]=g.useState("idle");return fn(()=>{if(!e){r("error");return}let a=!0;const o=new window.Image,i=s=>()=>{a&&r(s)};return r("loading"),o.onload=i("loaded"),o.onerror=i("error"),o.src=e,t&&(o.referrerPolicy=t),()=>{a=!1}},[e,t]),n}var NB=EB,MB=CB,AB=PB;const TB=g.forwardRef(({className:e,...t},n)=>h.jsx(NB,{ref:n,className:G("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));TB.displayName=NB.displayName;const RB=g.forwardRef(({className:e,...t},n)=>h.jsx(MB,{ref:n,className:G("aspect-square h-full w-full",e),...t}));RB.displayName=MB.displayName;const IB=g.forwardRef(({className:e,...t},n)=>h.jsx(AB,{ref:n,className:G("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));IB.displayName=AB.displayName;const Xbe=lo("flex gap-2 max-w-[60%] items-end relative group",{variants:{variant:{received:"self-start",sent:"self-end flex-row-reverse"},layout:{default:"",ai:"max-w-full w-full items-center"}},defaultVariants:{variant:"received",layout:"default"}}),DB=g.forwardRef(({className:e,variant:t,layout:n,children:r,...a},o)=>h.jsx("div",{className:G(Xbe({variant:t,layout:n,className:e}),"relative group"),ref:o,...a,children:g.Children.map(r,i=>g.isValidElement(i)&&typeof i.type!="string"?g.cloneElement(i,{variant:t,layout:n,className:a==null?void 0:a.innerclassname}):i)}));DB.displayName="ChatBubble";const Ybe=({src:e,fallback:t,className:n})=>h.jsxs(TB,{className:n,children:[h.jsx(RB,{src:e,alt:"Avatar"}),h.jsx(IB,{children:t})]}),Jbe=lo("p-4",{variants:{variant:{received:"bg-secondary text-secondary-foreground rounded-r-lg rounded-tl-lg",sent:"border border-border rounded-l-lg rounded-tr-lg"},layout:{default:"",ai:"border-t w-full rounded-none bg-transparent"}},defaultVariants:{variant:"received",layout:"default"}}),LB=g.forwardRef(({className:e,variant:t,layout:n,isLoading:r=!1,children:a,...o},i)=>h.jsx("div",{className:G(Jbe({variant:t,layout:n,className:e}),"break-words max-w-full whitespace-pre-wrap"),ref:i,...o,children:r?h.jsx("div",{className:"flex items-center space-x-2",children:h.jsx(by,{})}):a}));LB.displayName="ChatBubbleMessage";const Qbe=({icon:e,onClick:t,className:n,variant:r="ghost",size:a="icon",...o})=>h.jsx(yt,{variant:r,size:a,className:n,onClick:t,...o,children:e}),Gbe=g.forwardRef(({variant:e,className:t,children:n,...r},a)=>h.jsx("div",{ref:a,className:G("absolute top-1/2 -translate-y-1/2 flex opacity-0 group-hover:opacity-100 transition-opacity duration-200",e==="sent"?"-left-1 -translate-x-full flex-row-reverse":"-right-1 translate-x-full",t),...r,children:n}));Gbe.displayName="ChatBubbleActionWrapper";const ewe=[{icon:"copy",label:"Copy"},{icon:"refresh-ccw",label:"Refresh"},{icon:"volume-2",label:"Volume"}],twe=g.memo(({message:e,index:t,isLastMessage:n,isGenerating:r,isSchema:a,onActionClick:o})=>{const i=g.useMemo(()=>h.jsx(Lj,{style:{color:"unset !important"},source:e.content?a?`\`\`\`json
${e.content}
\`\`\``:e.content:""}),[a,e.content]);return h.jsxs(DB,{innerclassname:e.role=="system"?"!bg-transparent font-semibold":void 0,variant:e.role=="user"?"sent":"received",children:[e.role==="system"?h.jsx("div",{className:"w-10 h-10"}):e.role==="assistant"?h.jsx(Ybe,{src:"",fallback:e.data&&typeof e.data=="object"&&"injectedMessage"in e.data?"\u{1F4C2}":"\u{1F916}"}):void 0,h.jsxs(LB,{children:[r&&n&&(!e.content||a)?h.jsx(by,{}):h.jsxs(g.Suspense,{fallback:h.jsx(by,{}),children:[e.role==="system"?h.jsx(Mn,{className:"!text-sm mb-1",children:"System"}):void 0,i]}),e.role==="assistant"&&n&&h.jsx("div",{className:"flex items-center mt-1.5 gap-1",children:!r&&h.jsx(h.Fragment,{children:ewe.map((s,c)=>h.jsx(Qbe,{variant:"ghost",className:"size-5",icon:h.jsx(me,{name:s.icon,className:"size-3"}),onClick:()=>o(s.label,e)},c))})})]})]},t)},()=>!1),nwe=g.memo(()=>{const{t:e}=Re("applications"),t=g.useRef(!1),[n,r]=g.useState(!1),a=g.useCallback(()=>{setTimeout(()=>{P.current&&(P.current.scrollTop=P.current.scrollHeight)},50)},[]),o=Vfe(),{schema:i,threadInfo:s,mainLLMInfo:c,retriverInfo:l,currentDataNode:u,loadLLM:d,addNewDataNode:f,selectDataNode:p,updateMessagesData:m,onThreadMessagesLoaded:y}=o,{sendMessage:v}=O0e(o),{input:b,messages:w,isLoading:_,reload:x,setInput:S,handleSubmit:j,handleInputChange:E,setMessages:O}=gN({fetch:async(C,T)=>{try{r(!0);const A=JSON.parse(T==null?void 0:T.body),I=qi(),F=A.messages[A.messages.length-1];return t.current=!0,O(D=>[...D,{id:qi(),content:F.content,role:"user"}]),await v(F.content,A.messages||[],{retriverInfo:l},{schema:i,onInjectedMessages:D=>{D.length&&O(V=>[...V,...D.map(U=>U._getType()==="system"?{id:qi(),content:`${U.content}`,role:"system",data:{injectedMessage:!0}}:U._getType()==="human"?{id:qi(),content:`${U.content}`,role:"user",data:{injectedMessage:!0}}:{id:qi(),content:`${U.content}`,role:"assistant",data:{injectedMessage:!0}})])},onResponseMessageCreate:D=>{O(V=>[...V,{id:I,content:D||"",role:"assistant"}])},onMessageUpdate:D=>{O(V=>{const U=[...V],B=U.findIndex(K=>K.id===I);return B!==-1&&(U[B]={...U[B],content:D.nodeData.content||""}),U}),t.current&&a()}}),O(D=>(m(D),D)),r(!1),S(""),t.current&&a(),new Response}finally{r(!1)}}}),P=g.useRef(null);g.useEffect(()=>{const C=y(T=>{O(T||[]),a()});return()=>{C()}},[O,y,a]);const k=async(C,T)=>(r(!0),await j(T),!0),N=g.useCallback(async(C,T)=>{if(C==="Refresh"){r(!0);try{await x()}finally{r(!1)}}C==="Copy"&&T&&T.role==="assistant"&&navigator.clipboard.writeText(T.content),C==="Volume"&&(T!=null&&T.content)&&await YP.speak((T==null?void 0:T.content)||"")},[x]),R=g.useCallback(()=>t.current=!1,[]),M=g.useMemo(()=>w&&w.map((C,T)=>h.jsx(twe,{message:C,index:T,isLastMessage:T===w.length-1,isGenerating:n,isSchema:!!i,onActionClick:N},C.id||`${T}`)),[w,n,i,N]);return h.jsxs(Db,{onClick:R,className:"max-h-full !overflow-hidden !min-h-full",style:{minHeight:"unset"},defaultOpen:!0,children:[h.jsx($b,{className:"!max-h-full !overflow-hidden",style:{minHeight:"unset"},children:h.jsxs("main",{className:"flex h-full w-full max-w-2xl flex-col items-center mx-auto overflow-hidden",children:[h.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-w-full max-w-full",children:h.jsx(xR,{className:"!max-h-full",ref:P,children:M})}),h.jsx(g0,{className:"!max-w-2xl px-4",onSubmit:k,disabled:_||n||(c==null?void 0:c.status)!==rt.Loaded,placeholder:e("chat.input_message_placeholder"),maxHeight:72,value:b,onChange:E})]})}),h.jsx(Hbe,{schema:i,currentDataNode:u,threadNode:s==null?void 0:s.threadNode,loadLLM:d,mainLLMInfo:c,retriverInfo:l,onAddNewThread:f,onSelectThread:p})]})}),rwe=()=>{const[e,t]=g.useState(),n=st(u=>u.currentSession),{t:r}=Re("flows"),{toast:a}=on(),{stream:o}=il(),{loadModel:i}=Om(),{modalRef:s}=Lc(Id),c=g.useCallback(async(u,d)=>{if(n!=null&&n.main_node_id){if(!(e!=null&&e.llm))return a({variant:"destructive",description:r("editor_node.errors.llm_not_found")});(e==null?void 0:e.status)!==rt.Loaded&&(await i(e.llm.provider,e.llm.name,f=>{t(p=>p&&{...p,progress:f.text})}),t(f=>f&&{...f,status:rt.Loaded,progress:""}));try{return(await o(e==null?void 0:e.llm.provider,typeof u=="string"?[new Vr(u)]:u,{onMessageUpdate:f=>{d==null||d(f.content)},llm:e==null?void 0:e.llm})).content}catch(f){if(f instanceof Error&&f.message.includes("LLM_NOT_LOADED_YET"))return a({title:r("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:r("editor_node.errors.stream_message_failed")})}}},[n==null?void 0:n.main_node_id,e==null?void 0:e.llm,e==null?void 0:e.status,a,r,i,o]),l=g.useCallback(async()=>{if(!(n!=null&&n.main_node_id))return;const u=await he("FlowEdge").find({where:{target:n.main_node_id}}),d=(await he("FlowNode").find({where:{id:Xa(u.map(p=>p.source))}})).find(p=>p.source_type===ue.LLM);if(!d)return;const f=await he("LLM").findOne({where:{id:d.source_id}});f&&(n.passphrase&&await km(n.passphrase,s.current),await i(f.provider,f.name,p=>{t(m=>m&&{...m,llm:f,progress:p.text})}),t({llm:f,status:rt.Loaded}))},[n==null?void 0:n.main_node_id,n==null?void 0:n.passphrase,i,s]);return g.useEffect(()=>{n!=null&&n.main_node_id&&l()},[n==null?void 0:n.main_node_id,l]),{mainLLMInfo:e,createMessage:c}},awe=()=>{const e=st(o=>o.currentSession),t=g.useRef(null),[n,r]=g.useState(),a=g.useCallback(async o=>{e!=null&&e.main_node_id&&(clearTimeout(t.current),t.current=setTimeout(async()=>{e!=null&&e.main_node_id&&await he("FlowNode").update(e.main_node_id,{data:o})},150))},[e]);return g.useEffect(()=>{e!=null&&e.main_node_id&&he("FlowNode").findOne({where:{id:e.main_node_id}}).then(o=>{r(o)})},[e]),{flowNode:n,updateEditorContent:a}},owe=g.lazy(()=>Qt(()=>import("./index-C42Ik6Ft.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,7,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),iwe=g.memo(()=>{var o,i,s,c,l;const{flowNode:e,updateEditorContent:t}=awe(),{mainLLMInfo:n,createMessage:r}=rwe(),a=g.useCallback(u=>{t(u)},[t]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(Lu,{children:h.jsx(Ba,{children:h.jsxs("div",{className:G("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(n==null?void 0:n.status)===rt.Loaded&&((o=n==null?void 0:n.llm)!=null&&o.name)?h.jsx(Tr,{name:(i=n==null?void 0:n.llm)==null?void 0:i.name,className:"w-5 h-5 mr-1"}):void 0,h.jsx(za,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:n!=null&&n.progress?n==null?void 0:n.progress:(n==null?void 0:n.status)===rt.Loaded?(s=n==null?void 0:n.llm)==null?void 0:s.name:h.jsx(me,{size:16,name:"loader-circle",className:"animate-spin ml-2"})}),h.jsx(na,{children:h.jsx("p",{children:(n==null?void 0:n.progress)||((c=n==null?void 0:n.llm)==null?void 0:c.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(cu,{simple:!0}),children:e?h.jsx(owe,{defaultValue:e==null?void 0:e.data,onValueChange:a,copilotStream:r,hideDragIcon:!0,enableHistoryControl:!0},((l=n==null?void 0:n.llm)==null?void 0:l.name)||"default"):h.jsx(cu,{simple:!0})})]})}),swe=()=>{const[e,t]=g.useState(!1),[n,r]=g.useState(),a=st(p=>p.currentSession),{t:o}=Re("flows"),{toast:i}=on(),{loadModel:s}=Om(),{stream:c}=il(),{modalRef:l}=Lc(Id),u=g.useCallback(async(p,m,y)=>{if(a!=null&&a.main_node_id){if(!(n!=null&&n.llm)){i({variant:"destructive",description:o("editor_node.errors.llm_not_found")});return}(n==null?void 0:n.status)!==rt.Loaded&&(await s(n.llm.provider,n.llm.name,v=>{r(b=>b&&{...b,progress:v.text})}),r(v=>v&&{...v,status:rt.Loaded,progress:""}));try{const v=m.map(w=>w.role==="system"?new Cv(w.content):w.role==="assistant"?new qr(w.content):new Vr(w.content)),{content:b}=await c(n.llm.provider,[...v,new Vr(p)],{onMessageUpdate:({content:w})=>{y==null||y(w)},llm:n.llm});return y==null||y(b),b}catch(v){if(v instanceof Error&&v.message.includes("LLM_NOT_LOADED_YET")){i({title:o("editor_node.errors.llm_not_loaded_yet")});return}i({variant:"destructive",title:o("editor_node.errors.stream_message_failed")})}}},[a==null?void 0:a.main_node_id,n==null?void 0:n.llm,n==null?void 0:n.status,i,o,s,c]),d=g.useCallback(async()=>{try{if(t(!0),!(a!=null&&a.main_node_id))return;const p=await he("FlowEdge").find({where:{target:a.main_node_id}}),m=(await he("FlowNode").find({where:{id:Xa(p.map(v=>v.source))}})).find(v=>v.source_type===ue.LLM);if(!m)return;const y=await he("LLM").findOne({where:{id:m.source_id}});if(!y)return;a.passphrase&&await km(a.passphrase,l.current),await s(y.provider,y.name,v=>{r(b=>b&&{...b,llm:y,progress:v.text})}),r({llm:y,status:rt.Loaded})}finally{t(!1)}},[a==null?void 0:a.main_node_id,a==null?void 0:a.passphrase,s,l]),f=g.useCallback(async()=>{try{if(t(!0),!(n!=null&&n.llm))return;await s(n.llm.provider,n.llm.name,p=>{r(m=>m&&{...m,progress:p.text})}),r(p=>p&&{...p,status:rt.Loaded,progress:""})}finally{t(!1)}},[s,n==null?void 0:n.llm]);return g.useEffect(()=>{a!=null&&a.main_node_id&&d()},[a==null?void 0:a.main_node_id,d]),{loading:e,mainLLMInfo:n,createMessage:u,loadCurrentModel:f}};RN=function(e,t=""){const n=[];for(const[r,a]of Object.entries(e)){const o=qi(),i=[t,r].filter(Boolean).join("/"),s="file"in a&&"contents"in a.file?a.file:void 0,c={id:o,isSelectable:!0,content:typeof(s==null?void 0:s.contents)=="string"?s.contents:void 0,file:i,name:r,children:[]};"directory"in a&&(c.children=RN(a.directory,i)),n.push(c)}return n},_0=function(e){const t=e.trim().split(`
`),n={};return t.forEach(r=>{const{file:a,content:o}=JSON.parse(r),i=a.split("/");let s=n;for(let c=0;c<i.length;c++){const l=i[c];c===i.length-1?s[l]={file:{contents:o}}:(s[l]||(s[l]={directory:{}}),s=s[l].directory)}}),n},v0=function(e){const t=[];function n(r,a=[]){for(const[o,i]of Object.entries(r))if("file"in i){const s=[...a,o].join("/");if("contents"in i.file){const c=i.file.contents;t.push(JSON.stringify({file:s,content:c}))}}else"directory"in i&&n(i.directory,[...a,o])}return n(e),t.join(`
`)},S0=function(e,t){return HX(`[UpdateCodeContainerFile] Changes ${t.map(n=>`${n.type||"create_or_update"}:${n.path}`).join(", ")}`),t.forEach(({path:n,content:r,type:a="create_or_update"})=>{const o=n.replace(/^\.\//,"").split("/");let i=e;for(let s=0;s<o.length;s++){const c=o[s];if(s===o.length-1)a==="delete"?c in i&&"file"in i[c]?delete i[c]:console.warn(`Path "${n}" is not a file or does not exist.`):c in i&&"file"in i[c]?i[c].file.contents=r:i[c]={file:{contents:r}};else if(c in i&&"directory"in i[c])i=i[c].directory;else if(a==="delete"){console.warn(`Path "${n}" does not exist.`);break}else i[c]={directory:{}},i=i[c].directory}}),e};const cwe=()=>{const e=st(i=>i.currentSession),[t,n]=g.useState(),r=g.useCallback(async(i,s)=>{await he("FlowNode").update(i,{raw:v0(s)})},[]),a=g.useCallback(async i=>{e!=null&&e.main_node_id&&n(s=>{if(!(e!=null&&e.main_node_id))return s;const c=S0(s||{},i);return r(e==null?void 0:e.main_node_id,c),c})},[e==null?void 0:e.main_node_id,r]),o=g.useCallback(async()=>{if(!(e!=null&&e.main_node_id))return;const i=await he("FlowNode").findOne({where:{id:e==null?void 0:e.main_node_id}});i&&n(i.raw?_0(i.raw):{})},[e==null?void 0:e.main_node_id]);return g.useEffect(()=>{e!=null&&e.main_node_id&&o()},[e==null?void 0:e.main_node_id,o]),{fileSystemTree:t,updateCodeContainerFile:a,updateCodeContainerData:r}},lwe=g.lazy(()=>Qt(()=>import("./index-BhSMxwf6.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),uwe=g.memo(()=>{var s,c,l,u;const{loading:e,mainLLMInfo:t,loadCurrentModel:n,createMessage:r}=swe(),{fileSystemTree:a,updateCodeContainerFile:o}=cwe(),i=g.useCallback((d,f,p)=>r(d,f,p),[r]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(Lu,{children:h.jsx(Ba,{children:h.jsxs("div",{className:G("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(t==null?void 0:t.status)===rt.Loaded&&((s=t==null?void 0:t.llm)!=null&&s.name)?h.jsx(Tr,{name:(c=t==null?void 0:t.llm)==null?void 0:c.name,className:"w-5 h-5 mr-1"}):void 0,h.jsxs(za,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:[t!=null&&t.progress?t.progress:(t==null?void 0:t.status)===rt.Loaded?((l=t==null?void 0:t.llm)==null?void 0:l.name)||"":e?h.jsx(me,{size:16,name:"loader-circle",className:"animate-spin ml-2"}):void 0,t!=null&&t.llm&&(t==null?void 0:t.status)!==rt.Loaded?h.jsx(me,{size:16,name:"loader-circle",onClick:n,className:"animate-spin ml-2"}):void 0]}),h.jsx(na,{children:h.jsx("p",{children:(t==null?void 0:t.progress)||((u=t==null?void 0:t.llm)==null?void 0:u.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(cu,{simple:!0}),children:a!==void 0?h.jsx(lwe,{autoLoad:!0,hideAppName:!0,llm:t==null?void 0:t.llm,fileSystemTree:a,onUpdateFileContent:o,sendMessage:i}):void 0})]})});function dwe(){var t,n;const e=st(r=>r.currentSession);if(!e)return h.jsx(cu,{simple:!0,className:"w-full h-full"});if(e.main_source_type==="Thread")return h.jsx(nwe,{});if(((t=e.main_node)==null?void 0:t.node_type)==="EDITOR_APP")return h.jsx(iwe,{});if(((n=e.main_node)==null?void 0:n.node_type)==="VSLITE_APP")return h.jsx(uwe,{})}var Ty="Menubar",[pE,fwe,pwe]=mp(Ty),[$B,Z4e]=fr(Ty,[pwe,fo]),Qn=gh(),FB=fo(),[hwe,hE]=$B(Ty),BB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,value:r,onValueChange:a,defaultValue:o,loop:i=!0,dir:s,...c}=e,l=si(s),u=FB(n),[d="",f]=Rn({prop:r,onChange:a,defaultProp:o}),[p,m]=g.useState(null);return h.jsx(hwe,{scope:n,value:d,onMenuOpen:g.useCallback(y=>{f(y),m(y)},[f]),onMenuClose:g.useCallback(()=>f(""),[f]),onMenuToggle:g.useCallback(y=>{f(v=>v?"":y),m(y)},[f]),dir:l,loop:i,children:h.jsx(pE.Provider,{scope:n,children:h.jsx(pE.Slot,{scope:n,children:h.jsx(mu,{asChild:!0,...u,orientation:"horizontal",loop:i,dir:l,currentTabStopId:p,onCurrentTabStopIdChange:m,children:h.jsx($e.div,{role:"menubar",...c,ref:t})})})})})});BB.displayName=Ty;var mE="MenubarMenu",[mwe,zB]=$B(mE),UB=e=>{const{__scopeMenubar:t,value:n,...r}=e,a=zt(),o=n||a||"LEGACY_REACT_AUTO_VALUE",i=hE(mE,t),s=Qn(t),c=g.useRef(null),l=g.useRef(!1),u=i.value===o;return g.useEffect(()=>{u||(l.current=!1)},[u]),h.jsx(mwe,{scope:t,value:o,triggerId:zt(),triggerRef:c,contentId:zt(),wasKeyboardTriggerOpenRef:l,children:h.jsx(BT,{...s,open:u,onOpenChange:d=>{d||i.onMenuClose()},modal:!1,dir:i.dir,...r})})};UB.displayName=mE;var yE="MenubarTrigger",VB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,disabled:r=!1,...a}=e,o=FB(n),i=Qn(n),s=hE(yE,n),c=zB(yE,n),l=g.useRef(null),u=kt(t,l,c.triggerRef),[d,f]=g.useState(!1),p=s.value===c.value;return h.jsx(pE.ItemSlot,{scope:n,value:c.value,disabled:r,children:h.jsx(yu,{asChild:!0,...o,focusable:!r,tabStopId:c.value,children:h.jsx(zT,{asChild:!0,...i,children:h.jsx($e.button,{type:"button",role:"menuitem",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":p,"aria-controls":p?c.contentId:void 0,"data-highlighted":d?"":void 0,"data-state":p?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:u,onPointerDown:_e(e.onPointerDown,m=>{!r&&m.button===0&&m.ctrlKey===!1&&(s.onMenuOpen(c.value),p||m.preventDefault())}),onPointerEnter:_e(e.onPointerEnter,()=>{var m;s.value&&!p&&(s.onMenuOpen(c.value),(m=l.current)==null||m.focus())}),onKeyDown:_e(e.onKeyDown,m=>{r||(["Enter"," "].includes(m.key)&&s.onMenuToggle(c.value),m.key==="ArrowDown"&&s.onMenuOpen(c.value),["Enter"," ","ArrowDown"].includes(m.key)&&(c.wasKeyboardTriggerOpenRef.current=!0,m.preventDefault()))}),onFocus:_e(e.onFocus,()=>f(!0)),onBlur:_e(e.onBlur,()=>f(!1))})})})})});VB.displayName=yE;var ywe="MenubarPortal",WB=e=>{const{__scopeMenubar:t,...n}=e,r=Qn(t);return h.jsx(UT,{...r,...n})};WB.displayName=ywe;var gE="MenubarContent",HB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,align:r="start",...a}=e,o=Qn(n),i=hE(gE,n),s=zB(gE,n),c=fwe(n),l=g.useRef(!1);return h.jsx(VT,{id:s.contentId,"aria-labelledby":s.triggerId,"data-radix-menubar-content":"",...o,...a,ref:t,align:r,onCloseAutoFocus:_e(e.onCloseAutoFocus,u=>{var d;!i.value&&!l.current&&((d=s.triggerRef.current)==null||d.focus()),l.current=!1,u.preventDefault()}),onFocusOutside:_e(e.onFocusOutside,u=>{const d=u.target;c().some(f=>{var p;return(p=f.ref.current)==null?void 0:p.contains(d)})&&u.preventDefault()}),onInteractOutside:_e(e.onInteractOutside,()=>{l.current=!0}),onEntryFocus:u=>{s.wasKeyboardTriggerOpenRef.current||u.preventDefault()},onKeyDown:_e(e.onKeyDown,u=>{if(["ArrowRight","ArrowLeft"].includes(u.key)){const d=u.target,f=d.hasAttribute("data-radix-menubar-subtrigger"),p=d.closest("[data-radix-menubar-content]")!==u.currentTarget,m=(i.dir==="rtl"?"ArrowRight":"ArrowLeft")===u.key;if(!m&&f||p&&m)return;let y=c().filter(w=>!w.disabled).map(w=>w.value);m&&y.reverse();const v=y.indexOf(s.value);y=i.loop?Mwe(y,v+1):y.slice(v+1);const[b]=y;b&&i.onMenuOpen(b)}},{checkForDefaultPrevented:!1}),style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});HB.displayName=gE;var gwe="MenubarGroup",vwe=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(WT,{...a,...r,ref:t})});vwe.displayName=gwe;var bwe="MenubarLabel",qB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(HT,{...a,...r,ref:t})});qB.displayName=bwe;var wwe="MenubarItem",ZB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(qT,{...a,...r,ref:t})});ZB.displayName=wwe;var xwe="MenubarCheckboxItem",KB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(ZT,{...a,...r,ref:t})});KB.displayName=xwe;var _we="MenubarRadioGroup",Swe=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(KT,{...a,...r,ref:t})});Swe.displayName=_we;var jwe="MenubarRadioItem",XB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(XT,{...a,...r,ref:t})});XB.displayName=jwe;var Ewe="MenubarItemIndicator",YB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(YT,{...a,...r,ref:t})});YB.displayName=Ewe;var Owe="MenubarSeparator",JB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(JT,{...a,...r,ref:t})});JB.displayName=Owe;var Cwe="MenubarArrow",kwe=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(QT,{...a,...r,ref:t})});kwe.displayName=Cwe;var Pwe="MenubarSubTrigger",QB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(GT,{"data-radix-menubar-subtrigger":"",...a,...r,ref:t})});QB.displayName=Pwe;var Nwe="MenubarSubContent",GB=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Qn(n);return h.jsx(eR,{...a,"data-radix-menubar-content":"",...r,ref:t,style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});GB.displayName=Nwe;function Mwe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var ez=BB,Awe=UB,tz=VB,Twe=WB,nz=HB,rz=qB,az=ZB,oz=KB,iz=XB,sz=YB,cz=JB,lz=QB,uz=GB;const vE=Awe,dz=g.forwardRef(({className:e,...t},n)=>h.jsx(ez,{ref:n,className:G("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",e),...t}));dz.displayName=ez.displayName;const bE=g.forwardRef(({className:e,...t},n)=>h.jsx(tz,{ref:n,className:G("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",e),...t}));bE.displayName=tz.displayName;const Rwe=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(lz,{ref:a,className:G("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...r,children:[n,h.jsx(me,{name:"chevron-right",className:"ml-auto h-4 w-4"})]}));Rwe.displayName=lz.displayName;const Iwe=g.forwardRef(({className:e,...t},n)=>h.jsx(uz,{ref:n,className:G("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Iwe.displayName=uz.displayName;const fz=g.forwardRef(({className:e,align:t="start",alignOffset:n=-4,sideOffset:r=8,...a},o)=>h.jsx(Twe,{children:h.jsx(nz,{ref:o,align:t,alignOffset:n,sideOffset:r,className:G("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));fz.displayName=nz.displayName;const pz=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(az,{ref:r,className:G("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));pz.displayName=az.displayName;const Dwe=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(oz,{ref:a,className:G("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(sz,{children:h.jsx(me,{name:"check",className:"h-4 w-4"})})}),t]}));Dwe.displayName=oz.displayName;const Lwe=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(iz,{ref:r,className:G("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(sz,{children:h.jsx(me,{name:"circle",className:"h-2 w-2 fill-current"})})}),t]}));Lwe.displayName=iz.displayName;const $we=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(rz,{ref:r,className:G("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));$we.displayName=rz.displayName;const Fwe=g.forwardRef(({className:e,...t},n)=>h.jsx(cz,{ref:n,className:G("-mx-1 my-1 h-px bg-muted",e),...t}));Fwe.displayName=cz.displayName;let hz;ze=x4e()(_4e(S4e((e,t)=>({...h$,...Efe(e,t)})))),hz=()=>{const e=st(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=ze(i=>i.pushSyncNodeQueue),a=ze(i=>i.createOrUpdateFlowNode),o=g.useCallback(async(i,s)=>{try{if(!e)throw new Error("Session not found");if(!s.provider||!s.name)throw new Error("Provider and name are required");n(!0);const c=await he("LLM").findOne({where:{name:s.name,session_id:e}});return c?(r("LLM",{where:{source_type:"LLM",source_id:c.id}}),c):he("LLM").save({name:`${s.name}`,status:s.provider===gt.WebLLM?rt.Started:rt.Loaded,session_id:e,provider:s.provider,metadata:JSON.stringify(s.metadata||{}),model_type:s.model_type||_u.LLM,parameters:s.parameters||void 0,...s}).then(async l=>{var u,d,f;return await a({source_id:l.id,source_type:"LLM",node_type:ue.LLM,x:(u=i.position)==null?void 0:u.x,y:((d=i.position)==null?void 0:d.y)+(((f=i.measured)==null?void 0:f.height)||0)+30}),l})}finally{n(!1)}},[a,r,e]);return{loading:t,createLLM:o}};function Mi(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e==null||e(r),n===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function mz(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function yz(...e){return t=>{let n=!1;const r=e.map(a=>{const o=mz(a,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let a=0;a<r.length;a++){const o=r[a];typeof o=="function"?o():mz(e[a],null)}}}}function Ai(...e){return g.useCallback(yz(...e),e)}var wE=g.forwardRef((e,t)=>{const{children:n,...r}=e,a=g.Children.toArray(n),o=a.find(zwe);if(o){const i=o.props.children,s=a.map(c=>c===o?g.Children.count(i)>1?g.Children.only(null):g.isValidElement(i)?i.props.children:null:c);return h.jsx(xE,{...r,ref:t,children:g.isValidElement(i)?g.cloneElement(i,void 0,s):null})}return h.jsx(xE,{...r,ref:t,children:n})});wE.displayName="Slot";var xE=g.forwardRef((e,t)=>{const{children:n,...r}=e;if(g.isValidElement(n)){const a=Vwe(n);return g.cloneElement(n,{...Uwe(r,n.props),ref:t?yz(t,a):a})}return g.Children.count(n)>1?g.Children.only(null):null});xE.displayName="SlotClone";var Bwe=({children:e})=>h.jsx(h.Fragment,{children:e});function zwe(e){return g.isValidElement(e)&&e.type===Bwe}function Uwe(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...i)=>{o(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function Vwe(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Wwe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Wo=Wwe.reduce((e,t)=>{const n=g.forwardRef((r,a)=>{const{asChild:o,...i}=r,s=o?wE:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(s,{...i,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Hwe(e,t){e&&ru.flushSync(()=>e.dispatchEvent(t))}var qwe="DismissableLayer",_E="dismissableLayer.update",Zwe="dismissableLayer.pointerDownOutside",Kwe="dismissableLayer.focusOutside",gz,vz=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),bz=g.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:i,onDismiss:s,...c}=e,l=g.useContext(vz),[u,d]=g.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=g.useState({}),m=Ai(t,E=>d(E)),y=Array.from(l.layers),[v]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),b=y.indexOf(v),w=u?y.indexOf(u):-1,_=l.layersWithOutsidePointerEventsDisabled.size>0,x=w>=b,S=Jwe(E=>{const O=E.target,P=[...l.branches].some(k=>k.contains(O));!x||P||(a==null||a(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},f),j=Qwe(E=>{const O=E.target;[...l.branches].some(P=>P.contains(O))||(o==null||o(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},f);return j4e(E=>{w===l.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&s&&(E.preventDefault(),s()))},f),g.useEffect(()=>{if(u)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(gz=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(u)),l.layers.add(u),wz(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=gz)}},[u,f,n,l]),g.useEffect(()=>()=>{u&&(l.layers.delete(u),l.layersWithOutsidePointerEventsDisabled.delete(u),wz())},[u,l]),g.useEffect(()=>{const E=()=>p({});return document.addEventListener(_E,E),()=>document.removeEventListener(_E,E)},[]),h.jsx(Wo.div,{...c,ref:m,style:{pointerEvents:_?x?"auto":"none":void 0,...e.style},onFocusCapture:Mi(e.onFocusCapture,j.onFocusCapture),onBlurCapture:Mi(e.onBlurCapture,j.onBlurCapture),onPointerDownCapture:Mi(e.onPointerDownCapture,S.onPointerDownCapture)})});bz.displayName=qwe;var Xwe="DismissableLayerBranch",Ywe=g.forwardRef((e,t)=>{const n=g.useContext(vz),r=g.useRef(null),a=Ai(t,r);return g.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),h.jsx(Wo.div,{...e,ref:a})});Ywe.displayName=Xwe;function Jwe(e,t=globalThis==null?void 0:globalThis.document){const n=pr(e),r=g.useRef(!1),a=g.useRef(()=>{});return g.useEffect(()=>{const o=s=>{if(s.target&&!r.current){let c=function(){xz(Zwe,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Qwe(e,t=globalThis==null?void 0:globalThis.document){const n=pr(e),r=g.useRef(!1);return g.useEffect(()=>{const a=o=>{o.target&&!r.current&&xz(Kwe,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function wz(){const e=new CustomEvent(_E);document.dispatchEvent(e)}function xz(e,t,n,{discrete:r}){const a=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?Hwe(a,o):a.dispatchEvent(o)}var SE="focusScope.autoFocusOnMount",jE="focusScope.autoFocusOnUnmount",_z={bubbles:!1,cancelable:!0},Gwe="FocusScope",Sz=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=pr(a),u=pr(o),d=g.useRef(null),f=Ai(t,y=>c(y)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let y=function(_){if(p.paused||!s)return;const x=_.target;s.contains(x)?d.current=x:Ti(d.current,{select:!0})},v=function(_){if(p.paused||!s)return;const x=_.relatedTarget;x!==null&&(s.contains(x)||Ti(d.current,{select:!0}))},b=function(_){if(document.activeElement===document.body)for(const x of _)x.removedNodes.length>0&&Ti(s)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,p.paused]),g.useEffect(()=>{if(s){Oz.add(p);const y=document.activeElement;if(!s.contains(y)){const v=new CustomEvent(SE,_z);s.addEventListener(SE,l),s.dispatchEvent(v),v.defaultPrevented||(exe(oxe(jz(s)),{select:!0}),document.activeElement===y&&Ti(s))}return()=>{s.removeEventListener(SE,l),setTimeout(()=>{const v=new CustomEvent(jE,_z);s.addEventListener(jE,u),s.dispatchEvent(v),v.defaultPrevented||Ti(y??document.body,{select:!0}),s.removeEventListener(jE,u),Oz.remove(p)},0)}}},[s,l,u,p]);const m=g.useCallback(y=>{if(!n&&!r||p.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,b=document.activeElement;if(v&&b){const w=y.currentTarget,[_,x]=txe(w);_&&x?!y.shiftKey&&b===x?(y.preventDefault(),n&&Ti(_,{select:!0})):y.shiftKey&&b===_&&(y.preventDefault(),n&&Ti(x,{select:!0})):b===w&&y.preventDefault()}},[n,r,p.paused]);return h.jsx(Wo.div,{tabIndex:-1,...i,ref:f,onKeyDown:m})});Sz.displayName=Gwe;function exe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Ti(r,{select:t}),document.activeElement!==n)return}function txe(e){const t=jz(e),n=Ez(t,e),r=Ez(t.reverse(),e);return[n,r]}function jz(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Ez(e,t){for(const n of e)if(!nxe(n,{upTo:t}))return n}function nxe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function rxe(e){return e instanceof HTMLInputElement&&"select"in e}function Ti(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&rxe(e)&&t&&e.select()}}var Oz=axe();function axe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=Cz(e,t),e.unshift(t)},remove(t){var n;e=Cz(e,t),(n=e[0])==null||n.resume()}}}function Cz(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function oxe(e){return e.filter(t=>t.tagName!=="A")}var ixe="Arrow",kz=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Wo.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});kz.displayName=ixe;var sxe=kz,EE="Popper",[Pz,Nz]=fr(EE),[cxe,Mz]=Pz(EE),Az=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(cxe,{scope:t,anchor:r,onAnchorChange:a,children:n})};Az.displayName=EE;var Tz="PopperAnchor",Rz=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=Mz(Tz,n),i=g.useRef(null),s=Ai(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Wo.div,{...a,ref:s})});Rz.displayName=Tz;var OE="PopperContent",[lxe,uxe]=Pz(OE),Iz=g.forwardRef((e,t)=>{var W,q,Z,ee,oe,H;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...y}=e,v=Mz(OE,n),[b,w]=g.useState(null),_=Ai(t,le=>w(le)),[x,S]=g.useState(null),j=Sp(x),E=(j==null?void 0:j.width)??0,O=(j==null?void 0:j.height)??0,P=r+(o!=="center"?"-"+o:""),k=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},N=Array.isArray(l)?l:[l],R=N.length>0,M={padding:k,boundary:N.filter(fxe),altBoundary:R},{refs:C,floatingStyles:T,placement:A,isPositioned:I,middlewareData:F}=Zv({strategy:"fixed",placement:P,whileElementsMounted:(...le)=>Tv(...le,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Kv({mainAxis:a+O,alignmentAxis:i}),c&&Xv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Yv():void 0,...M}),c&&Jv({...M}),Iv({...M,apply:({elements:le,rects:ie,availableWidth:pe,availableHeight:Oe})=>{const{width:Ue,height:Ve}=ie.reference,Ce=le.floating.style;Ce.setProperty("--radix-popper-available-width",`${pe}px`),Ce.setProperty("--radix-popper-available-height",`${Oe}px`),Ce.setProperty("--radix-popper-anchor-width",`${Ue}px`),Ce.setProperty("--radix-popper-anchor-height",`${Ve}px`)}}),x&&u0({element:x,padding:s}),pxe({arrowWidth:E,arrowHeight:O}),f&&d0({strategy:"referenceHidden",...M})]}),[D,V]=$z(A),U=pr(m);fn(()=>{I&&(U==null||U())},[I,U]);const B=(W=F.arrow)==null?void 0:W.x,K=(q=F.arrow)==null?void 0:q.y,te=((Z=F.arrow)==null?void 0:Z.centerOffset)!==0,[L,$]=g.useState();return fn(()=>{b&&$(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:I?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:L,"--radix-popper-transform-origin":[(ee=F.transformOrigin)==null?void 0:ee.x,(oe=F.transformOrigin)==null?void 0:oe.y].join(" "),...((H=F.hide)==null?void 0:H.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(lxe,{scope:n,placedSide:D,onArrowChange:S,arrowX:B,arrowY:K,shouldHideArrow:te,children:h.jsx(Wo.div,{"data-side":D,"data-align":V,...y,ref:_,style:{...y.style,animation:I?void 0:"none"}})})})});Iz.displayName=OE;var Dz="PopperArrow",dxe={top:"bottom",right:"left",bottom:"top",left:"right"},Lz=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=uxe(Dz,n),o=dxe[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(sxe,{...r,ref:t,style:{...r.style,display:"block"}})})});Lz.displayName=Dz;function fxe(e){return e!==null}var pxe=e=>({name:"transformOrigin",options:e,fn(t){var y,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((y=a.arrow)==null?void 0:y.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=$z(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,f=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let p="",m="";return c==="bottom"?(p=o?u:`${d}px`,m=`${-s}px`):c==="top"?(p=o?u:`${d}px`,m=`${r.floating.height+s}px`):c==="right"?(p=`${-s}px`,m=o?u:`${f}px`):c==="left"&&(p=`${r.floating.width+s}px`,m=o?u:`${f}px`),{data:{x:p,y:m}}}});function $z(e){const[t,n="center"]=e.split("-");return[t,n]}var hxe=Az,Fz=Rz,mxe=Iz,yxe=Lz,gxe="Portal",Bz=g.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[a,o]=g.useState(!1);fn(()=>o(!0),[]);const i=n||a&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return i?E4e.createPortal(h.jsx(Wo.div,{...r,ref:t}),i):null});Bz.displayName=gxe;function vxe(e,t){return g.useReducer((n,r)=>t[n][r]??n,e)}var CE=e=>{const{present:t,children:n}=e,r=bxe(t),a=typeof n=="function"?n({present:r.isPresent}):g.Children.only(n),o=Ai(r.ref,wxe(a));return typeof n=="function"||r.isPresent?g.cloneElement(a,{ref:o}):null};CE.displayName="Presence";function bxe(e){const[t,n]=g.useState(),r=g.useRef({}),a=g.useRef(e),o=g.useRef("none"),i=e?"mounted":"unmounted",[s,c]=vxe(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const l=Ry(r.current);o.current=s==="mounted"?l:"none"},[s]),fn(()=>{const l=r.current,u=a.current;if(u!==e){const d=o.current,f=Ry(l);e?c("MOUNT"):f==="none"||(l==null?void 0:l.display)==="none"?c("UNMOUNT"):c(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),fn(()=>{if(t){let l;const u=t.ownerDocument.defaultView??window,d=p=>{const m=Ry(r.current).includes(p.animationName);if(p.target===t&&m&&(c("ANIMATION_END"),!a.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",l=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},f=p=>{p.target===t&&(o.current=Ry(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(l),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:g.useCallback(l=>{l&&(r.current=getComputedStyle(l)),n(l)},[])}}function Ry(e){return(e==null?void 0:e.animationName)||"none"}function wxe(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Iy="right-scroll-bar-position",Dy="width-before-scroll-bar",xxe="with-scroll-bars-hidden",_xe="--removed-body-scroll-bar-size";function kE(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Sxe(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var jxe=typeof window<"u"?g.useLayoutEffect:g.useEffect,zz=new WeakMap;function Exe(e,t){var n=Sxe(null,function(r){return e.forEach(function(a){return kE(a,r)})});return jxe(function(){var r=zz.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||kE(s,null)}),o.forEach(function(s){a.has(s)||kE(s,i)})}zz.set(n,e)},[e]),n}var Uz=f0(),PE=function(){},Ly=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:PE,onWheelCapture:PE,onTouchMoveCapture:PE}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,p=e.noIsolation,m=e.inert,y=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,_=jp(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=f,S=Exe([n,t]),j=Cn(Cn({},_),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:Uz,removeScrollBar:l,shards:d,noIsolation:p,inert:m,setCallbacks:o,allowPinchZoom:!!y,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),Cn(Cn({},j),{ref:S})):g.createElement(b,Cn({},j,{className:c,ref:S}),s))});Ly.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Ly.classNames={fullWidth:Dy,zeroRight:Iy};function Oxe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=p0();return t&&e.setAttribute("nonce",t),e}function Cxe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function kxe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Pxe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Oxe())&&(Cxe(t,n),kxe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Nxe=function(){var e=Pxe();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Mxe=function(){var e=Nxe(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},Axe={left:0,top:0,right:0,gap:0},NE=function(e){return parseInt(e||"",10)||0},Txe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[NE(n),NE(r),NE(a)]},Rxe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Axe;var t=Txe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},Ixe=Mxe(),dl="data-scroll-locked",Dxe=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(xxe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(dl,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Iy,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Dy,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Iy," .").concat(Iy,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Dy," .").concat(Dy,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(dl,`] {
    `).concat(_xe,": ").concat(s,`px;
  }
`)},Vz=function(){var e=parseInt(document.body.getAttribute(dl)||"0",10);return isFinite(e)?e:0},Lxe=function(){g.useEffect(function(){return document.body.setAttribute(dl,(Vz()+1).toString()),function(){var e=Vz()-1;e<=0?document.body.removeAttribute(dl):document.body.setAttribute(dl,e.toString())}},[])},$xe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;Lxe();var o=g.useMemo(function(){return Rxe(a)},[a]);return g.createElement(Ixe,{styles:Dxe(o,!t,a,n?"":"!important")})},ME=!1;if(typeof window<"u")try{var $y=Object.defineProperty({},"passive",{get:function(){return ME=!0,!0}});window.addEventListener("test",$y,$y),window.removeEventListener("test",$y,$y)}catch{ME=!1}var fl=ME?{passive:!1}:!1,Fxe=function(e){return e.tagName==="TEXTAREA"},Wz=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Fxe(e)&&n[t]==="visible")},Bxe=function(e){return Wz(e,"overflowY")},zxe=function(e){return Wz(e,"overflowX")},Hz=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=qz(e,r);if(a){var o=Zz(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Uxe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},Vxe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},qz=function(e,t){return e==="v"?Bxe(t):zxe(t)},Zz=function(e,t){return e==="v"?Uxe(t):Vxe(t)},Wxe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Hxe=function(e,t,n,r,a){var o=Wxe(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,f=0;do{var p=Zz(e,s),m=p[0],y=p[1],v=p[2],b=y-v-o*m;(m||b)&&qz(e,s)&&(d+=b,f+=m),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(f)<1||!a))&&(l=!0),l},Fy=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Kz=function(e){return[e.deltaX,e.deltaY]},Xz=function(e){return e&&"current"in e?e.current:e},qxe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Zxe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Kxe=0,pl=[];function Xxe(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(Kxe++)[0],o=g.useState(Ep)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var y=h0([e.lockRef.current],(e.shards||[]).map(Xz),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!i.current.allowPinchZoom;var b=Fy(y),w=n.current,_="deltaX"in y?y.deltaX:w[0]-b[0],x="deltaY"in y?y.deltaY:w[1]-b[1],S,j=y.target,E=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in y&&E==="h"&&j.type==="range")return!1;var O=Hz(E,j);if(!O)return!0;if(O?S=E:(S=E==="v"?"h":"v",O=Hz(E,j)),!O)return!1;if(!r.current&&"changedTouches"in y&&(_||x)&&(r.current=S),!S)return!0;var P=r.current||S;return Hxe(P,v,y,P==="h"?_:x,!0)},[]),c=g.useCallback(function(y){var v=y;if(!(!pl.length||pl[pl.length-1]!==o)){var b="deltaY"in v?Kz(v):Fy(v),w=t.current.filter(function(S){return S.name===v.type&&(S.target===v.target||v.target===S.shadowParent)&&qxe(S.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(Xz).filter(Boolean).filter(function(S){return S.contains(v.target)}),x=_.length>0?s(v,_[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(y,v,b,w){var _={name:y,delta:v,target:b,should:w,shadowParent:Yxe(b)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(x){return x!==_})},1)},[]),u=g.useCallback(function(y){n.current=Fy(y),r.current=void 0},[]),d=g.useCallback(function(y){l(y.type,Kz(y),y.target,s(y,e.lockRef.current))},[]),f=g.useCallback(function(y){l(y.type,Fy(y),y.target,s(y,e.lockRef.current))},[]);g.useEffect(function(){return pl.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",c,fl),document.addEventListener("touchmove",c,fl),document.addEventListener("touchstart",u,fl),function(){pl=pl.filter(function(y){return y!==o}),document.removeEventListener("wheel",c,fl),document.removeEventListener("touchmove",c,fl),document.removeEventListener("touchstart",u,fl)}},[]);var p=e.removeScrollBar,m=e.inert;return g.createElement(g.Fragment,null,m?g.createElement(o,{styles:Zxe(a)}):null,p?g.createElement($xe,{gapMode:e.gapMode}):null)}function Yxe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Jxe=m0(Uz,Xxe);var Yz=g.forwardRef(function(e,t){return g.createElement(Ly,Cn({},e,{ref:t,sideCar:Jxe}))});Yz.classNames=Ly.classNames;var AE="Popover",[Jz,K4e]=fr(AE,[Nz]),cf=Nz(),[Qxe,Ri]=Jz(AE),Qz=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!1}=e,s=cf(t),c=g.useRef(null),[l,u]=g.useState(!1),[d=!1,f]=Rn({prop:r,defaultProp:a,onChange:o});return h.jsx(hxe,{...s,children:h.jsx(Qxe,{scope:t,contentId:zt(),triggerRef:c,open:d,onOpenChange:f,onOpenToggle:g.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:l,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:i,children:n})})};Qz.displayName=AE;let TE;TE="PopoverAnchor",l0=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Ri(TE,n),o=cf(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:s}=a;return g.useEffect(()=>(i(),()=>s()),[i,s]),h.jsx(Fz,{...o,...r,ref:t})}),l0.displayName=TE;var Gz="PopoverTrigger",RE=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Ri(Gz,n),o=cf(n),i=Ai(t,a.triggerRef),s=h.jsx(Wo.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":a7(a.open),...r,ref:i,onClick:Mi(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?s:h.jsx(Fz,{asChild:!0,...o,children:s})});RE.displayName=Gz;var IE="PopoverPortal",[Gxe,e1e]=Jz(IE,{forceMount:void 0}),e7=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,o=Ri(IE,t);return h.jsx(Gxe,{scope:t,forceMount:n,children:h.jsx(CE,{present:n||o.open,children:h.jsx(Bz,{asChild:!0,container:a,children:r})})})};e7.displayName=IE;var hl="PopoverContent",t7=g.forwardRef((e,t)=>{const n=e1e(hl,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,o=Ri(hl,e.__scopePopover);return h.jsx(CE,{present:r||o.open,children:o.modal?h.jsx(t1e,{...a,ref:t}):h.jsx(n1e,{...a,ref:t})})});t7.displayName=hl;var t1e=g.forwardRef((e,t)=>{const n=Ri(hl,e.__scopePopover),r=g.useRef(null),a=Ai(t,r),o=g.useRef(!1);return g.useEffect(()=>{const i=r.current;if(i)return vu(i)},[]),h.jsx(Yz,{as:wE,allowPinchZoom:!0,children:h.jsx(n7,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Mi(e.onCloseAutoFocus,i=>{var s;i.preventDefault(),o.current||((s=n.triggerRef.current)==null||s.focus())}),onPointerDownOutside:Mi(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,c=s.button===0&&s.ctrlKey===!0,l=s.button===2||c;o.current=l},{checkForDefaultPrevented:!1}),onFocusOutside:Mi(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),n1e=g.forwardRef((e,t)=>{const n=Ri(hl,e.__scopePopover),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(n7,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),n7=g.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onInteractOutside:u,...d}=e,f=Ri(hl,n),p=cf(n);return bu(),h.jsx(Sz,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(bz,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onDismiss:()=>f.onOpenChange(!1),children:h.jsx(mxe,{"data-state":a7(f.open),role:"dialog",id:f.contentId,...p,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),r7="PopoverClose",r1e=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Ri(r7,n);return h.jsx(Wo.button,{type:"button",...r,ref:t,onClick:Mi(e.onClick,()=>a.onOpenChange(!1))})});r1e.displayName=r7;var a1e="PopoverArrow",o1e=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=cf(n);return h.jsx(yxe,{...a,...r,ref:t})});o1e.displayName=a1e;function a7(e){return e?"open":"closed"}mN=Qz,JX=l0,xN=RE,hN=e7,Dv=t7,MN=mN,nY=xN,y0=g.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},a)=>h.jsx(hN,{children:h.jsx(Dv,{ref:a,align:t,sideOffset:n,className:G("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})})),y0.displayName=Dv.displayName;var o7=1,i1e=.9,s1e=.8,c1e=.17,DE=.1,LE=.999,l1e=.9999,u1e=.99,d1e=/[\\\/_+.#"@\[\(\{&]/,f1e=/[\\\/_+.#"@\[\(\{&]/g,p1e=/[\s-]/,i7=/[\s-]/g;function $E(e,t,n,r,a,o,i){if(o===t.length)return a===e.length?o7:u1e;var s=`${a},${o}`;if(i[s]!==void 0)return i[s];for(var c=r.charAt(o),l=n.indexOf(c,a),u=0,d,f,p,m;l>=0;)d=$E(e,t,n,r,l+1,o+1,i),d>u&&(l===a?d*=o7:d1e.test(e.charAt(l-1))?(d*=s1e,p=e.slice(a,l-1).match(f1e),p&&a>0&&(d*=Math.pow(LE,p.length))):p1e.test(e.charAt(l-1))?(d*=i1e,m=e.slice(a,l-1).match(i7),m&&a>0&&(d*=Math.pow(LE,m.length))):(d*=c1e,a>0&&(d*=Math.pow(LE,l-a))),e.charAt(l)!==t.charAt(o)&&(d*=l1e)),(d<DE&&n.charAt(l-1)===r.charAt(o+1)||r.charAt(o+1)===r.charAt(o)&&n.charAt(l-1)!==r.charAt(o))&&(f=$E(e,t,n,r,l+1,o+2,i),f*DE>d&&(d=f*DE)),d>u&&(u=d),l=n.indexOf(c,l+1);return i[s]=u,u}function s7(e){return e.toLowerCase().replace(i7," ")}function h1e(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,$E(e,t,s7(e),s7(t),0,0,{})}var lf='[cmdk-group=""]',FE='[cmdk-group-items=""]',m1e='[cmdk-group-heading=""]',BE='[cmdk-item=""]',c7=`${BE}:not([aria-disabled="true"])`,zE="cmdk-item-select",Ss="data-value",y1e=(e,t,n)=>h1e(e,t,n),l7=g.createContext(void 0),uf=()=>g.useContext(l7),u7=g.createContext(void 0),UE=()=>g.useContext(u7),d7=g.createContext(void 0),f7=g.forwardRef((e,t)=>{let n=ml(()=>{var B,K;return{search:"",value:(K=(B=e.value)!=null?B:e.defaultValue)!=null?K:"",filtered:{count:0,items:new Map,groups:new Set}}}),r=ml(()=>new Set),a=ml(()=>new Map),o=ml(()=>new Map),i=ml(()=>new Set),s=p7(e),{label:c,children:l,value:u,onValueChange:d,filter:f,shouldFilter:p,loop:m,disablePointerSelection:y=!1,vimBindings:v=!0,...b}=e,w=zt(),_=zt(),x=zt(),S=g.useRef(null),j=C1e();js(()=>{if(u!==void 0){let B=u.trim();n.current.value=B,E.emit()}},[u]),js(()=>{j(6,M)},[]);let E=g.useMemo(()=>({subscribe:B=>(i.current.add(B),()=>i.current.delete(B)),snapshot:()=>n.current,setState:(B,K,te)=>{var L,$,W;if(!Object.is(n.current[B],K)){if(n.current[B]=K,B==="search")R(),k(),j(1,N);else if(B==="value"&&(te||j(5,M),((L=s.current)==null?void 0:L.value)!==void 0)){let q=K??"";(W=($=s.current).onValueChange)==null||W.call($,q);return}E.emit()}},emit:()=>{i.current.forEach(B=>B())}}),[]),O=g.useMemo(()=>({value:(B,K,te)=>{var L;K!==((L=o.current.get(B))==null?void 0:L.value)&&(o.current.set(B,{value:K,keywords:te}),n.current.filtered.items.set(B,P(K,te)),j(2,()=>{k(),E.emit()}))},item:(B,K)=>(r.current.add(B),K&&(a.current.has(K)?a.current.get(K).add(B):a.current.set(K,new Set([B]))),j(3,()=>{R(),k(),n.current.value||N(),E.emit()}),()=>{o.current.delete(B),r.current.delete(B),n.current.filtered.items.delete(B);let te=C();j(4,()=>{R(),(te==null?void 0:te.getAttribute("id"))===B&&N(),E.emit()})}),group:B=>(a.current.has(B)||a.current.set(B,new Set),()=>{o.current.delete(B),a.current.delete(B)}),filter:()=>s.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>s.current.disablePointerSelection,listId:w,inputId:x,labelId:_,listInnerRef:S}),[]);function P(B,K){var te,L;let $=(L=(te=s.current)==null?void 0:te.filter)!=null?L:y1e;return B?$(B,n.current.search,K):0}function k(){if(!n.current.search||s.current.shouldFilter===!1)return;let B=n.current.filtered.items,K=[];n.current.filtered.groups.forEach(L=>{let $=a.current.get(L),W=0;$.forEach(q=>{let Z=B.get(q);W=Math.max(Z,W)}),K.push([L,W])});let te=S.current;T().sort((L,$)=>{var W,q;let Z=L.getAttribute("id"),ee=$.getAttribute("id");return((W=B.get(ee))!=null?W:0)-((q=B.get(Z))!=null?q:0)}).forEach(L=>{let $=L.closest(FE);$?$.appendChild(L.parentElement===$?L:L.closest(`${FE} > *`)):te.appendChild(L.parentElement===te?L:L.closest(`${FE} > *`))}),K.sort((L,$)=>$[1]-L[1]).forEach(L=>{var $;let W=($=S.current)==null?void 0:$.querySelector(`${lf}[${Ss}="${encodeURIComponent(L[0])}"]`);W==null||W.parentElement.appendChild(W)})}function N(){let B=T().find(te=>te.getAttribute("aria-disabled")!=="true"),K=B==null?void 0:B.getAttribute(Ss);E.setState("value",K||void 0)}function R(){var B,K,te,L;if(!n.current.search||s.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let $=0;for(let W of r.current){let q=(K=(B=o.current.get(W))==null?void 0:B.value)!=null?K:"",Z=(L=(te=o.current.get(W))==null?void 0:te.keywords)!=null?L:[],ee=P(q,Z);n.current.filtered.items.set(W,ee),ee>0&&$++}for(let[W,q]of a.current)for(let Z of q)if(n.current.filtered.items.get(Z)>0){n.current.filtered.groups.add(W);break}n.current.filtered.count=$}function M(){var B,K,te;let L=C();L&&(((B=L.parentElement)==null?void 0:B.firstChild)===L&&((te=(K=L.closest(lf))==null?void 0:K.querySelector(m1e))==null||te.scrollIntoView({block:"nearest"})),L.scrollIntoView({block:"nearest"}))}function C(){var B;return(B=S.current)==null?void 0:B.querySelector(`${BE}[aria-selected="true"]`)}function T(){var B;return Array.from(((B=S.current)==null?void 0:B.querySelectorAll(c7))||[])}function A(B){let K=T()[B];K&&E.setState("value",K.getAttribute(Ss))}function I(B){var K;let te=C(),L=T(),$=L.findIndex(q=>q===te),W=L[$+B];(K=s.current)!=null&&K.loop&&(W=$+B<0?L[L.length-1]:$+B===L.length?L[0]:L[$+B]),W&&E.setState("value",W.getAttribute(Ss))}function F(B){let K=C(),te=K==null?void 0:K.closest(lf),L;for(;te&&!L;)te=B>0?E1e(te,lf):O1e(te,lf),L=te==null?void 0:te.querySelector(c7);L?E.setState("value",L.getAttribute(Ss)):I(B)}let D=()=>A(T().length-1),V=B=>{B.preventDefault(),B.metaKey?D():B.altKey?F(1):I(1)},U=B=>{B.preventDefault(),B.metaKey?A(0):B.altKey?F(-1):I(-1)};return g.createElement($e.div,{ref:t,tabIndex:-1,...b,"cmdk-root":"",onKeyDown:B=>{var K;if((K=b.onKeyDown)==null||K.call(b,B),!B.defaultPrevented)switch(B.key){case"n":case"j":{v&&B.ctrlKey&&V(B);break}case"ArrowDown":{V(B);break}case"p":case"k":{v&&B.ctrlKey&&U(B);break}case"ArrowUp":{U(B);break}case"Home":{B.preventDefault(),A(0);break}case"End":{B.preventDefault(),D();break}case"Enter":if(!B.nativeEvent.isComposing&&B.keyCode!==229){B.preventDefault();let te=C();if(te){let L=new Event(zE);te.dispatchEvent(L)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:P1e},c),By(e,B=>g.createElement(u7.Provider,{value:E},g.createElement(l7.Provider,{value:O},B))))}),g1e=g.forwardRef((e,t)=>{var n,r;let a=zt(),o=g.useRef(null),i=g.useContext(d7),s=uf(),c=p7(e),l=(r=(n=c.current)==null?void 0:n.forceMount)!=null?r:i==null?void 0:i.forceMount;js(()=>{if(!l)return s.item(a,i==null?void 0:i.id)},[l]);let u=h7(a,o,[e.value,e.children,o],e.keywords),d=UE(),f=Es(j=>j.value&&j.value===u.current),p=Es(j=>l||s.filter()===!1?!0:j.search?j.filtered.items.get(a)>0:!0);g.useEffect(()=>{let j=o.current;if(!(!j||e.disabled))return j.addEventListener(zE,m),()=>j.removeEventListener(zE,m)},[p,e.onSelect,e.disabled]);function m(){var j,E;y(),(E=(j=c.current).onSelect)==null||E.call(j,u.current)}function y(){d.setState("value",u.current,!0)}if(!p)return null;let{disabled:v,value:b,onSelect:w,forceMount:_,keywords:x,...S}=e;return g.createElement($e.div,{ref:df([o,t]),...S,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!f,"data-disabled":!!v,"data-selected":!!f,onPointerMove:v||s.getDisablePointerSelection()?void 0:y,onClick:v?void 0:m},e.children)}),v1e=g.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:a,...o}=e,i=zt(),s=g.useRef(null),c=g.useRef(null),l=zt(),u=uf(),d=Es(p=>a||u.filter()===!1?!0:p.search?p.filtered.groups.has(i):!0);js(()=>u.group(i),[]),h7(i,s,[e.value,e.heading,c]);let f=g.useMemo(()=>({id:i,forceMount:a}),[a]);return g.createElement($e.div,{ref:df([s,t]),...o,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&g.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:l},n),By(e,p=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?l:void 0},g.createElement(d7.Provider,{value:f},p))))}),b1e=g.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,a=g.useRef(null),o=Es(i=>!i.search);return!n&&!o?null:g.createElement($e.div,{ref:df([a,t]),...r,"cmdk-separator":"",role:"separator"})}),w1e=g.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,a=e.value!=null,o=UE(),i=Es(u=>u.search),s=Es(u=>u.value),c=uf(),l=g.useMemo(()=>{var u;let d=(u=c.listInnerRef.current)==null?void 0:u.querySelector(`${BE}[${Ss}="${encodeURIComponent(s)}"]`);return d==null?void 0:d.getAttribute("id")},[]);return g.useEffect(()=>{e.value!=null&&o.setState("search",e.value)},[e.value]),g.createElement($e.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:a?e.value:i,onChange:u=>{a||o.setState("search",u.target.value),n==null||n(u.target.value)}})}),x1e=g.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...a}=e,o=g.useRef(null),i=g.useRef(null),s=uf();return g.useEffect(()=>{if(i.current&&o.current){let c=i.current,l=o.current,u,d=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let f=c.offsetHeight;l.style.setProperty("--cmdk-list-height",f.toFixed(1)+"px")})});return d.observe(c),()=>{cancelAnimationFrame(u),d.unobserve(c)}}},[]),g.createElement($e.div,{ref:df([o,t]),...a,"cmdk-list":"",role:"listbox","aria-label":r,id:s.listId},By(e,c=>g.createElement("div",{ref:df([i,s.listInnerRef]),"cmdk-list-sizer":""},c)))}),_1e=g.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:a,contentClassName:o,container:i,...s}=e;return g.createElement(uu,{open:n,onOpenChange:r},g.createElement(pu,{container:i},g.createElement(Ki,{"cmdk-overlay":"",className:a}),g.createElement(Xi,{"aria-label":e.label,"cmdk-dialog":"",className:o},g.createElement(f7,{ref:t,...s}))))}),S1e=g.forwardRef((e,t)=>Es(n=>n.filtered.count===0)?g.createElement($e.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),j1e=g.forwardRef((e,t)=>{let{progress:n,children:r,label:a="Loading...",...o}=e;return g.createElement($e.div,{ref:t,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},By(e,i=>g.createElement("div",{"aria-hidden":!0},i)))}),lr=Object.assign(f7,{List:x1e,Item:g1e,Input:w1e,Group:v1e,Separator:b1e,Dialog:_1e,Empty:S1e,Loading:j1e});function E1e(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function O1e(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function p7(e){let t=g.useRef(e);return js(()=>{t.current=e}),t}var js=typeof window>"u"?g.useEffect:g.useLayoutEffect;function ml(e){let t=g.useRef();return t.current===void 0&&(t.current=e()),t}function df(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function Es(e){let t=UE(),n=()=>e(t.snapshot());return _p.useSyncExternalStore(t.subscribe,n,n)}function h7(e,t,n,r=[]){let a=g.useRef(),o=uf();return js(()=>{var i;let s=(()=>{var l;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():a.current}})(),c=r.map(l=>l.trim());o.value(e,s,c),(i=t.current)==null||i.setAttribute(Ss,s),a.current=s}),a}var C1e=()=>{let[e,t]=g.useState(),n=ml(()=>new Map);return js(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,a)=>{n.current.set(r,a),t({})}};function k1e(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function By({asChild:e,children:t},n){return e&&g.isValidElement(t)?g.cloneElement(k1e(t),{ref:t.ref},n(t.props.children)):n(t)}var P1e={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const m7=g.forwardRef(({className:e,...t},n)=>h.jsx(lr,{ref:n,className:G("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));m7.displayName=lr.displayName;const y7=g.forwardRef(({className:e,...t},n)=>h.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[h.jsx(me,{name:"search",className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),h.jsx(lr.Input,{ref:n,className:G("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));y7.displayName=lr.Input.displayName;const g7=g.forwardRef(({className:e,...t},n)=>h.jsx(lr.List,{ref:n,className:G("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));g7.displayName=lr.List.displayName;const v7=g.forwardRef((e,t)=>h.jsx(lr.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));v7.displayName=lr.Empty.displayName;const b7=g.forwardRef(({className:e,...t},n)=>h.jsx(lr.Group,{ref:n,className:G("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));b7.displayName=lr.Group.displayName;const N1e=g.forwardRef(({className:e,...t},n)=>h.jsx(lr.Separator,{ref:n,className:G("-mx-1 h-px bg-border",e),...t}));N1e.displayName=lr.Separator.displayName;const ff=g.forwardRef(({className:e,...t},n)=>h.jsx(lr.Item,{ref:n,className:G("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...t}));ff.displayName=lr.Item.displayName;const M1e=lo("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Ca=g.forwardRef(({className:e,variant:t,...n},r)=>h.jsx("div",{ref:r,role:"alert",className:G(M1e({variant:t}),e),...n}));Ca.displayName="Alert";const Ho=g.forwardRef(({className:e,...t},n)=>h.jsx("h5",{ref:n,className:G("mb-1 font-medium leading-none tracking-tight",e),...t}));Ho.displayName="AlertTitle";const yl=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:G("text-sm [&_p]:leading-relaxed",e),...t}));yl.displayName="AlertDescription";const A1e=uo(({onConfirm:e,onCancel:t})=>{const n=an(),{t:r}=Re("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{e(a),o(""),n.resolve(!0)},c=()=>{t(),o(""),n.resolve(!1),n.hide()};return h.jsx(yi,{open:n.visible,onOpenChange:c,children:h.jsxs(xo,{className:"w-[330px]",children:[h.jsxs(_o,{children:[h.jsx(So,{children:r("create_session_passkey.title")}),h.jsx(Uu,{children:r("create_session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(cS,{onChange:i,maxLength:6,children:[h.jsxs(Rd,{children:[h.jsx(_r,{index:0,hidden:!0}),h.jsx(_r,{index:1,hidden:!0}),h.jsx(_r,{index:2,hidden:!0})]}),h.jsx(lS,{}),h.jsxs(Rd,{children:[h.jsx(_r,{index:3,hidden:!0}),h.jsx(_r,{index:4,hidden:!0}),h.jsx(_r,{index:5,hidden:!0})]})]})}),h.jsx(zu,{children:h.jsx(yt,{onClick:s,type:"submit",children:r("create_session_passkey.confirm")})})]})})}),T1e=()=>{const[e,t]=g.useState(!1),n=st(o=>o.currentSession),r=st(o=>o.setCurrentSession),a=g.useCallback(async o=>{if(!(!n||!o))try{t(!0);const i=await Bfe(),s=await S$(i,o);await he("Session").update(n.id,{passphrase:s});const c=await he("Session").findOne({where:{id:n.id}});return c&&r(c),{passphrase:i,encrypted:s}}finally{t(!1)}},[n,r]);return{loading:e,updateSessionPassphrase:a}},R1e=[gt.WebLLM,gt.OpenAI,gt.VertexAI,gt.Groq],I1e=["gpt-4o","gpt-4o-mini","gpt-4-turbo","gpt-4","gpt-3.5-turbo"],D1e=["deepseek-r1-distill-llama-70b","llama-3.2-90b-vision-preview","llama-3.3-70b-versatile","llama-3.3-70b-specdec","llama3-70b-8192","gemma2-9b-it","llama3-8b-8192","mixtral-8x7b-32768"],L1e=["llama-3.2-90b-vision-preview"],$1e=["gemini-2.0-flash-exp","gemini-1.5-pro-002","gemini-1.5-flash-002"];var VE="Checkbox",[F1e,X4e]=fr(VE),[B1e,z1e]=F1e(VE),w7=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:o,required:i,disabled:s,value:c="on",onCheckedChange:l,form:u,...d}=e,[f,p]=g.useState(null),m=kt(t,x=>p(x)),y=g.useRef(!1),v=f?u||!!f.closest("form"):!0,[b=!1,w]=Rn({prop:a,defaultProp:o,onChange:l}),_=g.useRef(b);return g.useEffect(()=>{const x=f==null?void 0:f.form;if(x){const S=()=>w(_.current);return x.addEventListener("reset",S),()=>x.removeEventListener("reset",S)}},[f,w]),h.jsxs(B1e,{scope:n,state:b,disabled:s,children:[h.jsx($e.button,{type:"button",role:"checkbox","aria-checked":Ii(b)?"mixed":b,"aria-required":i,"data-state":S7(b),"data-disabled":s?"":void 0,disabled:s,value:c,...d,ref:m,onKeyDown:_e(e.onKeyDown,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:_e(e.onClick,x=>{w(S=>Ii(S)?!0:!S),v&&(y.current=x.isPropagationStopped(),y.current||x.stopPropagation())})}),v&&h.jsx(U1e,{control:f,bubbles:!y.current,name:r,value:c,checked:b,required:i,disabled:s,form:u,style:{transform:"translateX(-100%)"},defaultChecked:Ii(o)?!1:o})]})});w7.displayName=VE;var x7="CheckboxIndicator",_7=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,o=z1e(x7,n);return h.jsx(Ur,{present:r||Ii(o.state)||o.state===!0,children:h.jsx($e.span,{"data-state":S7(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});_7.displayName=x7;var U1e=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:a,...o}=e,i=g.useRef(null),s=cF(n),c=Sp(t);g.useEffect(()=>{const u=i.current,d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"checked").set;if(s!==n&&f){const p=new Event("click",{bubbles:r});u.indeterminate=Ii(n),f.call(u,Ii(n)?!1:n),u.dispatchEvent(p)}},[s,n,r]);const l=g.useRef(Ii(n)?!1:n);return h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??l.current,...o,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Ii(e){return e==="indeterminate"}function S7(e){return Ii(e)?"indeterminate":e?"checked":"unchecked"}$v=w7,vN=_7;const WE=g.forwardRef(({className:e,...t},n)=>h.jsx($v,{ref:n,className:G("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:h.jsx(vN,{className:G("flex items-center justify-center text-current"),children:h.jsx(me,{name:"check",className:"h-4 w-4"})})}));WE.displayName=$v.displayName;function V1e(e){var te,L;const{id:t,setDialog:n}=e,{t:r}=Re("components"),{toast:a}=on(),o=Hn(t),[i,s]=g.useState(!1),[c,l]=g.useState(""),[u,d]=g.useState(!1),[f,p]=g.useState(""),[m,y]=g.useState(),[v,b]=g.useState(gt.WebLLM),[w,_]=g.useState(!1),[x,S]=g.useState(),{updateSessionPassphrase:j}=T1e(),E=st($=>$.currentSession),O=co($=>$.syncCachedLLMURLs),P=co($=>$.cachedLLMURLs),{loading:k,createLLM:N}=hz(),{modalRef:R}=Lc(A1e),{modalRef:M}=Lc(Id);g.useEffect(()=>{Qt(()=>import("./index-CIMzE0bz.js").then(async $=>(await $.__tla,$)),__vite__mapDeps([9,1,2,3,4])).then(async({functionCallingModelIds:$,prebuiltAppConfig:W})=>{const q=W.model_list;S({modelList:q,functionCallingModelIds:$})})},[]),g.useEffect(()=>{O()},[O]);const C=g.useMemo(()=>c?v!==gt.WebLLM:!1,[c,v]),T=g.useMemo(()=>!(x!=null&&x.functionCallingModelIds)||!(x!=null&&x.modelList)?[]:((f?x==null?void 0:x.modelList.filter($=>$.model_id.toLowerCase().includes(f.toLowerCase())):x==null?void 0:x.modelList)||[]).sort(($,W)=>{const q=P.some(ie=>ie.includes($.model_id)),Z=P.some(ie=>ie.includes(W.model_id));if(q&&!Z)return-1;if(!q&&Z)return 1;const ee=$j.includes($.model_id),oe=$j.includes(W.model_id);if(ee&&!oe)return-1;if(!ee&&oe)return 1;const H=x==null?void 0:x.functionCallingModelIds.includes($.model_id),le=x==null?void 0:x.functionCallingModelIds.includes(W.model_id);return H&&!le?-1:!H&&le?1:$.vram_required_MB&&W.vram_required_MB&&$.vram_required_MB!==W.vram_required_MB?$.vram_required_MB-W.vram_required_MB:$.model_id.localeCompare(W.model_id)}),[x==null?void 0:x.modelList,x==null?void 0:x.functionCallingModelIds,f,P]),A=g.useMemo(()=>{if(c)switch(v){case gt.WebLLM:return(x==null?void 0:x.modelList)&&T.find($=>$.model_id===c);case gt.Groq:return y({}),{model:c,model_id:c,model_type:L1e.includes(c)?2:0,overrides:{}};case gt.OpenAI:return y({}),{model:c,model_id:c,model_type:2,overrides:{}};case gt.VertexAI:return y({}),{model:c,model_id:c,model_type:2,overrides:{}}}},[c,x==null?void 0:x.modelList,T,v]);g.useEffect(()=>{!(A!=null&&A.model_id)||!P||_(P.some($=>$.includes(A.model_id)))},[P,A==null?void 0:A.model_id]),g.useEffect(()=>{E!=null&&E.id&&(b(gt.WebLLM),l(""),p(""),y({}))},[E==null?void 0:E.id]);const I=g.useCallback($=>{l($),d(!1)},[]),F=g.useCallback($=>{p($)},[]),D=g.useCallback($=>{b($),l(""),p(""),y({})},[]),V=async()=>{var $;if(!(!o||!E))try{s(!0);let W="",q;if(C&&!E.passphrase){await R.current.show({onConfirm:ee=>{W=ee,R.current.hide()}});const Z=await j(W);if(!Z||!Object.keys(m||{}).length)throw new Error("Failed to update session passphrase");await yp.set("passphrase",Z.passphrase),q=await j$(m||{},Z.passphrase)}else if(C&&E.passphrase){const Z=await km(E.passphrase,M.current);q=await j$(m||{},Z)}await N(o,{name:c,model_type:U(A==null?void 0:A.model_type),function_calling:A!=null&&A.model_id?($=x==null?void 0:x.functionCallingModelIds)==null?void 0:$.includes(A==null?void 0:A.model_id):!1,parameters:q,provider:v}),n==null||n(!1)}catch(W){Ws(W),a({variant:"destructive",description:r("add_llm_card.errors.failed_to_create")})}finally{s(!1),b(gt.WebLLM),y({}),l(""),p("")}},U=g.useCallback($=>$===1?_u.embedding:$===2?_u.VLM:_u.LLM,[]),B=g.useMemo(()=>{switch(v){case gt.WebLLM:return T.map($=>{var W;return h.jsxs(ff,{value:$.model_id,onSelect:I,children:[c===$.model_id?h.jsx(me,{name:"check",className:"mr-2 h-4 w-4"}):h.jsx("div",{className:"mr-2 h-4 w-4"}),h.jsxs("span",{className:"max-w-md",children:[h.jsxs("div",{className:"flex gap-2 mb-2",children:[h.jsx(Tr,{name:$.model_id}),$.model_id]}),h.jsx("div",{className:"flex max-w-full flex-wrap gap-1",children:h.jsx(af,{model:$,isFunctionCalling:((W=x==null?void 0:x.functionCallingModelIds)==null?void 0:W.includes($.model_id))||!1,name:$.model_id,isCached:P.some(q=>q.includes($.model_id))||!1})})]})]},$.model_id)});case gt.OpenAI:return I1e.map($=>h.jsxs(ff,{value:$,onSelect:I,children:[c===$?h.jsx(me,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Tr,{name:$}),$]})})]},$));case gt.VertexAI:return $1e.map($=>h.jsxs(ff,{value:$,onSelect:I,children:[c===$?h.jsx(me,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Tr,{name:$}),$]})})]},$));case gt.Groq:return D1e.map($=>h.jsxs(ff,{value:$,onSelect:I,children:[c===$?h.jsx(me,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Tr,{name:$}),$]})})]},$))}},[P,I,c,x==null?void 0:x.functionCallingModelIds,T,v]),K=g.useMemo(()=>{if(C)switch(v){case gt.Groq:case gt.OpenAI:return h.jsxs(h.Fragment,{children:[h.jsx(Ca,{variant:"destructive",className:"mt-4",children:r("add_llm_card.alert.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(it,{children:r("add_llm_card.encrypted_fields.api_key")}),h.jsx(In,{type:"password",value:(m==null?void 0:m.key)||"",onChange:$=>y(W=>({...W,key:$.target.value}))})]})]});case gt.VertexAI:return h.jsxs(h.Fragment,{children:[h.jsx(Ca,{variant:"destructive",className:"mt-4",children:r("add_llm_card.alert.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(it,{children:r("add_llm_card.encrypted_fields.credentials")}),h.jsx(Va,{rows:4,value:(m==null?void 0:m.key)||"",onChange:$=>y(W=>({...W,key:$.target.value}))})]}),h.jsxs("div",{className:"mt-4 flex items-center",children:[h.jsx(it,{children:r("add_llm_card.encrypted_fields.enabled_google_search_retreival")}),h.jsx(WE,{checked:!!(m!=null&&m.enabled_google_search_retreival),className:"ml-2",onCheckedChange:$=>{y(W=>({...W,enabled_google_search_retreival:$?"true":""}))}})]})]})}},[C,v,r,m]);return h.jsxs(rn,{className:"max-w-lg",children:[h.jsx(Yn,{children:h.jsx(sr,{children:r("add_llm_card.title")})}),h.jsxs(Jn,{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(it,{children:r("add_llm_card.provider")}),h.jsxs(zo,{value:v,onValueChange:D,children:[h.jsx(eo,{className:"w-full mb-4",children:h.jsx(Uo,{placeholder:r("add_llm_card.provider_select_placeholder")})}),h.jsx(to,{children:Object.values(R1e).map($=>h.jsx(cr,{value:$,children:r(`add_llm_card.providers.${$.toLowerCase()}`)},$))})]}),h.jsx(it,{children:r("add_llm_card.model_name")}),h.jsxs(MN,{open:u,onOpenChange:d,children:[h.jsx(RE,{asChild:!0,children:h.jsxs(yt,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between",children:[c?A==null?void 0:A.model_id:r("add_llm_card.select_model_placeholder"),h.jsx(me,{name:"chevrons-up-down",className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),h.jsx(y0,{className:"w-full p-0",children:h.jsxs(m7,{children:[h.jsx(y7,{onValueChange:F,placeholder:r("add_llm_card.search_placeholder")}),h.jsxs(g7,{children:[h.jsx(v7,{children:r("add_llm_card.no_model")}),h.jsx(b7,{children:B})]})]})})]})]}),A?h.jsxs("div",{className:"mt-4",children:[h.jsxs("div",{className:"mt-4 text-sm text-muted-foreground center flex max-w-full flex-wrap gap-1",children:[h.jsx(Tr,{name:A.model_id,className:"mr-2"}),h.jsx(af,{model:A,isFunctionCalling:((te=x==null?void 0:x.functionCallingModelIds)==null?void 0:te.includes(A.model_id))||!1,name:A.model_id,isCached:P.some($=>$.includes(A.model_id))||!1})]}),h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_url")}),A.model]}),A.model_lib?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_lib_url")}),A.model_lib]}):void 0,A.overrides&&((L=Object.keys(A.overrides))!=null&&L.length)?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.metadata")}),JSON.stringify(A.overrides)]}):void 0]}):null,K]}),h.jsx(ki,{className:"flex justify-between",children:h.jsx(tr,{loading:k||i,disabled:!(c!=null&&c.length),onClick:V,className:"w-full",children:r(w?"add_llm_card.button_add":"add_llm_card.button_download_and_add")})})]})}const j7=()=>{const e=st(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=ze(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i)=>{var s,c,l;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const u=((s=o.position)==null?void 0:s.x)||0,d=(((c=o.position)==null?void 0:c.y)||0)+(((l=o.measured)==null?void 0:l.height)||0),f=await he("Prompt").save({content:i.content,prefix:i.prefix,role:i.role||hr.System,status:Yr.Started,session_id:e,type:i.type||mr.Chat});if(!f)throw new Error("Failed to save prompt");if(!await r({source_id:f.id,source_type:"Prompt",node_type:ue.Prompt,x:u,y:d+20}))throw new Error("Failed to save prompt node")}finally{n(!1)}},[e,r]);return{loading:t,createPrompt:a}},W1e={[mr.Chat]:{label:"add_prompt_card.prompt_types.chat",value:mr.Chat},[mr.FewShotExample]:{label:"add_prompt_card.prompt_types.few_shot_example",value:mr.FewShotExample}},H1e={[hr.System]:{label:"add_prompt_card.prompt_roles.system",value:hr.System},[hr.Human]:{label:"add_prompt_card.prompt_roles.human",value:hr.Human},[hr.AI]:{label:"add_prompt_card.prompt_roles.ai",value:hr.AI}},HE=g.memo(({defaultPromptContent:e,defaultPromptRole:t,defaultPromptType:n,hidePromptRole:r,hidePromptType:a,loading:o,onSubmit:i})=>{const[s,c]=g.useState(e||""),[l,u]=g.useState(n||mr.Chat),[d,f]=g.useState(t),[p,m]=g.useState(""),{t:y}=Re("components"),v=g.useCallback(S=>{c(S.target.value)},[]),b=g.useCallback(S=>{m(S.target.value)},[]),w=g.useCallback(S=>{S===mr.FewShotExample&&c(`Question: {input}
Answer: {output}`),u(S)},[]),_=g.useCallback(S=>{f(S)},[]),x=async()=>{await i({content:s,role:d,prefix:p,type:l})&&(c(""),f(void 0),u("chat"),m(""))};return h.jsxs("div",{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[a?void 0:h.jsxs(h.Fragment,{children:[h.jsx(it,{children:y("add_prompt_card.prompt_type")}),h.jsxs(zo,{value:l,onValueChange:w,children:[h.jsx(eo,{className:"w-full mb-4",children:h.jsx(Uo,{placeholder:y("add_prompt_card.type_select_placeholder")})}),h.jsx(to,{children:Object.values(W1e).map(S=>h.jsx(cr,{value:S.value,children:y(S.label)},S.value))})]})]}),r?void 0:h.jsxs(h.Fragment,{children:[h.jsx(it,{children:y("add_prompt_card.prompt_role")}),h.jsxs(zo,{value:d,onValueChange:_,children:[h.jsx(eo,{className:"w-full mb-4",children:h.jsx(Uo,{placeholder:y("add_prompt_card.role_select_placeholder")})}),h.jsx(to,{children:Object.values(H1e).map(S=>h.jsx(cr,{value:S.value,children:y(S.label)},S.value))})]})]}),l===mr.FewShotExample&&h.jsxs(h.Fragment,{children:[h.jsx(it,{children:y("add_prompt_card.prompt_prefix")}),h.jsx(Va,{value:p,onChange:b,disabled:!1,className:"h-20",placeholder:y("add_prompt_card.placeholder"),id:"message"}),h.jsx(it,{children:y("add_prompt_card.prompt_content")}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm justify-end items-center",children:[h.jsx(me,{name:"info",className:"mr-2",size:14}),y("add_prompt_card.few_shot_example_note")]})]}),h.jsx(Va,{value:s,onChange:v,disabled:!1,placeholder:y("add_prompt_card.placeholder"),id:"message"})]}),h.jsx("div",{children:h.jsx(tr,{loading:o,disabled:!(s!=null&&s.length),onClick:x,className:"w-full mt-4",children:y("add_prompt_card.button")})})]})}),q1e=g.memo(e=>{const{id:t,thread:n,setDialog:r}=e,{t:a}=Re("components"),{toast:o}=on(),i=Hn(t),{createPrompt:s,loading:c}=j7(),l=async u=>{if(i)try{if(!(u!=null&&u.content))throw new Error("Prompt data is missing");await s(i,{...u,content:u.content,thread:n}),r==null||r(!1)}catch(d){o({variant:"destructive",title:`${d}`})}};return h.jsxs(rn,{className:"mw-full",children:[h.jsx(Yn,{children:h.jsx(sr,{children:a("add_prompt_card.title")})}),h.jsx(Jn,{children:h.jsx(HE,{onSubmit:l,loading:c,defaultPromptRole:"system",defaultPromptType:"chat"})})]})}),Z1e=()=>{const e=st(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=ze(i=>i.createOrUpdateFlowNode),a=g.useCallback((i,s,c,l)=>{var u;if(e){for(const d of s)(u=d.data)!=null&&u.length?a(i,d.data,c,d.id):c.push({name:d.name,type:d.type,enum:d.enum?JSON.stringify(d.enum):"",required:d.required,description:d.description,id:d.id||qu(),parent_id:l,schema_id:i,session_id:e});return c}},[e]),o=g.useCallback(async(i,s)=>{var c,l,u;try{if(!i||!e)throw new Error("Source or Session not found");n(!0);const d=((c=i.position)==null?void 0:c.x)||0,f=(((l=i.position)==null?void 0:l.y)||0)+(((u=i.measured)==null?void 0:u.height)||0),p=await he("Schema").save({name:"Untitled Schema",session_id:e});if(!p)throw new Error("Failed to save schema");const m=a(p.id,s,[],void 0);if(!(m!=null&&m.length))throw new Error("Failed to convert schema items");if(await he("SchemaItem").save(m),!await r({source_id:p.id,source_type:"Schema",node_type:ue.Schema,x:d,y:f+20}))throw new Error("Failed to save schema node")}finally{n(!1)}},[e,a,r]);return{loading:t,createSchema:o}},E7=g.memo(({setData:e,data:t,id:n})=>{const{t:r}=Re("components"),[a,o]=g.useState({name:"",description:"",type:"string",required:!1,data:[]}),i=g.useMemo(()=>n&&t.find(y=>y.id===n)||a,[t,a,n]),s=g.useCallback(y=>{y.target.value&&!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(y.target.value)||(n?e(v=>[...v.map(b=>b.id===n?{...b,name:y.target.value||""}:b)]):o(v=>({...v,name:y.target.value||""})))},[n,e]),c=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,description:y.target.value||""}:b)]):o(v=>({...v,description:y.target.value||""}))},[n,e]),l=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,type:y||""}:b)]):o(v=>({...v,type:y||"string"}))},[n,e]),u=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,required:!!y||!1}:b)]):o(v=>({...v,required:!!y||!1}))},[n,e]),d=g.useCallback(y=>{n?e(v=>[...v.map(b=>b.id===n?{...b,enum:y.target.value||""}:b)]):o(v=>({...v,enum:y.target.value||""}))},[n,e]),f=g.useCallback(()=>{if(t.find(y=>y.name===a.name))return lu({variant:"destructive",content:"Name already exists"});a.id=qu(),e(y=>[...y,{...a}]),o({name:"",description:"",type:"string",required:!1,id:qu(),parent:n||void 0,data:[]})},[t,a,e,n]),p=g.useCallback(y=>{e(v=>[...v.map(b=>b.id===n?{...b,data:y(b.data||[])}:b)])},[n,e]),m=["object","array"].includes(i.type);return h.jsxs("div",{className:"w-full p-1",children:[h.jsxs("div",{children:[h.jsx(it,{children:r("add_schema_card.field.name")}),h.jsx(In,{id:"name",onChange:s,placeholder:r("add_schema_card.field.name_placeholder"),value:(i==null?void 0:i.name)||""})]}),h.jsxs("div",{children:[h.jsx(it,{children:r("add_schema_card.field.description")}),h.jsx(In,{id:"description",placeholder:r("add_schema_card.field.description_placeholder"),onChange:c,value:(i==null?void 0:i.description)||""})]}),h.jsxs("div",{children:[h.jsx(it,{children:r("add_schema_card.field.type")}),h.jsxs(zo,{onValueChange:l,value:(i==null?void 0:i.type)||"",children:[h.jsx(eo,{children:h.jsx(Uo,{placeholder:r("add_schema_card.field.type_placeholder")})}),h.jsxs(to,{children:[h.jsx(cr,{value:"string",children:r("add_schema_card.types.string")}),h.jsx(cr,{value:"boolean",children:r("add_schema_card.types.boolean")}),h.jsx(cr,{value:"number",children:r("add_schema_card.types.number")}),h.jsx(cr,{value:"object",children:r("add_schema_card.types.object")}),h.jsx(cr,{value:"array",children:r("add_schema_card.types.array")})]})]})]}),h.jsxs("div",{className:"flex items-center h-10",children:[h.jsx(it,{children:r("add_schema_card.field.required")}),h.jsx(WE,{className:"ml-2","aria-label":"Select row",onCheckedChange:u,checked:i==null?void 0:i.required})]}),m?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(it,{children:r("add_schema_card.children")}),h.jsx(O7,{data:(i==null?void 0:i.data)||[],setData:p})]}):null,(i==null?void 0:i.type)==="enum"?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(it,{children:r("add_schema_card.field.enum")}),h.jsx(In,{id:"enum",onChange:d,placeholder:"Enum"})]}):null,n?null:h.jsx("div",{className:"w-full flex justify-end mt-2",children:h.jsx(yt,{variant:"secondary",disabled:!i.name||!i.description||!i.type,onClick:f,className:"w-full",children:r("add_schema_card.field.add_field")})})]})}),O7=g.memo(({data:e,setData:t})=>h.jsxs(aB,{type:"single",collapsible:!0,children:[e.map(n=>h.jsxs(Qj,{value:`${n.id}`,children:[h.jsx(Gj,{children:n.name}),h.jsx(eE,{children:h.jsx(E7,{setData:t,data:e,id:n.id})})]},n.id||"new")),h.jsx(rn,{className:"p-2 mt-4",children:h.jsx(E7,{setData:t,data:e})})]})),K1e=g.memo(e=>{const{t}=Re("components"),{id:n}=e,r=Hn(n),[a,o]=g.useState([]),{createSchema:i,loading:s}=Z1e(),c=async()=>{if(r&&(a!=null&&a.length))try{await i(r,a),o([])}catch(l){lu({variant:"destructive",title:`${l}`})}};return h.jsxs(rn,{className:"max-w-lg",children:[h.jsx(Yn,{children:h.jsx(sr,{children:t("add_schema_card.title")})}),h.jsx(Jn,{className:"min-w-96",children:h.jsx(O7,{setData:o,data:a})}),h.jsx(ki,{className:"flex justify-between",children:h.jsx(tr,{loading:s,disabled:!(a!=null&&a.length),onClick:c,className:"w-full",children:t("add_schema_card.create")})})]})}),C7=()=>{const e=st(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=ze(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i,s)=>{var c,l,u;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const d=((c=o.position)==null?void 0:c.x)||0,f=(((l=o.position)==null?void 0:l.y)||0)+(((u=o.measured)==null?void 0:u.height)||0),p=O4e(i,s),m=await he("CSVData").save({headers:p.headers,csv:p.data,session_id:e});if(!m)throw new Error("Failed to save");if(!await r({source_id:m.id,source_type:"CSVData",node_type:ue.CSVData,x:d,y:f+20}))throw new Error("Failed to save node")}finally{n(!1)}},[e,r]);return{loading:t,createCSVData:a}};function X1e({data:e}){const{t}=Re("components");return h.jsxs(ky,{className:"w-full",children:[h.jsx(Py,{children:h.jsxs(_s,{children:[h.jsx(cl,{children:t("add_few_shot_example_card.input")}),h.jsx(cl,{children:t("add_few_shot_example_card.output")})]})}),h.jsx(Ny,{children:e==null?void 0:e.map((n,r)=>h.jsxs(_s,{children:[h.jsx(ll,{className:"p-4",children:n.input}),h.jsx(ll,{className:"p-4",children:n.output})]},`${n.input}_${n.output}_${r}`))})]})}const Y1e=g.memo(e=>{const{id:t}=e,{t:n}=Re("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),[s,c]=g.useState(""),l=Hn(t),{createCSVData:u,loading:d}=C7(),f=()=>{a(m=>[...m,{input:o,output:s}]),i(""),c("")},p=async()=>{l&&await u(l,["input","output"],r.map(m=>[m.input,m.output]))};return h.jsxs(rn,{className:"mw-full",children:[h.jsx(Yn,{children:h.jsx(sr,{children:n("add_few_shot_example_card.title")})}),h.jsxs(Jn,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(it,{htmlFor:"name",children:n("add_few_shot_example_card.input")}),h.jsx(In,{value:o,onChange:m=>i(m.target.value||""),id:"name",placeholder:n("add_few_shot_example_card.input_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(it,{htmlFor:"name",children:n("add_few_shot_example_card.output")}),h.jsx(Va,{value:s,onChange:m=>c(m.target.value||""),placeholder:n("add_few_shot_example_card.output_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(yt,{disabled:!o||!s,onClick:f,className:"w-40",children:n("add_few_shot_example_card.add")})}),h.jsx(X1e,{data:r||[]})]}),h.jsx(ki,{className:"flex justify-between",children:h.jsx(tr,{loading:d,disabled:!(r!=null&&r.length),onClick:p,className:"w-full",children:n("add_few_shot_example_card.create")})})]})}),J1e=()=>{const e=st(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=ze(i=>i.createOrUpdateFlowNode),a=ze(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!i||!e)throw new Error("Source or Session not found");if(!s.name||!s.description)throw new Error("Name is required");n(!0);const f=((l=i.position)==null?void 0:l.x)||0,p=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),m=await he("ToolDefinition").save({...s,name:`${s.name}`,description:`${s.description}`,session_id:e});if(!m)throw new Error("Failed create tool.");const y=await r({source_id:m.id,source_type:"ToolDefinition",node_type:ue.ToolDefinition,x:f,y:p+20});if(!y)throw new Error("Failed to save node");c!=null&&c.schemaNode&&await a({source:c.schemaNode.id,target:y.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createTool:o}},Q1e=g.memo(e=>{const{t}=Re("components"),{toast:n}=on(),{id:r}=e,a=Hn(r),[o,i]=g.useState(""),[s,c]=g.useState(""),{createTool:l,loading:u}=J1e(),d=m=>{i(m.target.value)},f=m=>{c(m.target.value)},p=async()=>{if(a&&o&&s)try{await l(a,{name:o,description:s}),i(""),c("")}catch(m){oi(m),n({variant:"destructive",title:t("add_tool_card.errors.create_tool_failed")})}};return h.jsxs(rn,{className:"mw-full",children:[h.jsx(Yn,{children:h.jsx(sr,{children:t("add_tool_card.title")})}),h.jsxs(Jn,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(it,{htmlFor:"name",children:t("add_tool_card.tool_name")}),h.jsx(In,{onChange:d,id:"name",placeholder:t("add_tool_card.name_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(it,{htmlFor:"name",children:t("add_tool_card.tool_description")}),h.jsx(Va,{onChange:f,placeholder:t("add_tool_card.description_placeholder")})]})]}),h.jsx(ki,{className:"flex justify-between",children:h.jsx(tr,{loading:u,onClick:p,className:"w-full",children:t("add_tool_card.create")})})]})}),G1e=()=>{const e=st(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=ze(i=>i.createOrUpdateFlowNode),a=ze(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!(s!=null&&s.name)||!i||!e)throw new Error("Source or Session not found");n(!0);const f=((l=i.position)==null?void 0:l.x)||0,p=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),m=await he("VectorDatabase").save({...s,name:`${s.name}`,type:s.type||C4e.Local,storage:s.storage||Zr.DatabaseNode,raw:"",provider:s.provider||qX.Memory,session_id:e,metadata:c?JSON.stringify({textSplitter:c}):void 0});if(!m)throw new Error("Failed to save vectorDatabase");const y=await r({source_id:m.id,source_type:"VectorDatabase",node_type:ue.VectorDatabase,x:f,y:p+30});if(!y)throw new Error("Failed to save vectorDatabase node");if(s.storage===Zr.DataNode){const v=await he("JSONLData").save({headers:k4e(["content","embedding","metadata"]),jsonl:"",session_id:e});if(!v)throw new Error("Failed to save databaseSource");const b=await r({source_id:v.id,source_type:"JSONLData",node_type:ue.JSONLData,x:f+80,y:p+30});if(!b)throw new Error("Failed to save databaseSource node");await a({source:b.id,target:y.id})}return{vectorDatabase:m,vectorDatabaseNode:y}}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabase:o}},pf=[qX.Memory],hf=[Zr.DatabaseNode],e_e=["TokenTextSplitter","CharacterTextSplitter","RecursiveCharacterTextSplitter"],t_e=g.memo(e=>{const{t}=Re("components"),{id:n}=e,r=Hn(n),{toast:a}=on(),[o,i]=g.useState(""),[s,c]=g.useState(pf[0]),[l,u]=g.useState(hf[0]),[d,f]=g.useState({}),{loading:p,createVectorDatabase:m}=G1e(),y=g.useCallback(j=>{c(j)},[]),v=g.useCallback(j=>{u(j)},[]),b=g.useCallback(j=>{f(E=>({...E,type:j,chunkSize:500,chunkOverlap:40}))},[]),w=g.useCallback(j=>{i(j.target.value||"")},[]),_=g.useCallback(j=>{f(E=>({...E,chunkSize:Number(j.target.value)}))},[]),x=g.useCallback(j=>{f(E=>({...E,chunkOverlap:Number(j.target.value)}))},[]),S=async()=>{try{if(!r)return;await m(r,{name:o,provider:s,storage:l},d!=null&&d.type?{type:d.type,chunkSize:d.chunkSize||500,chunkOverlap:d.chunkOverlap||0}:void 0),i(""),f({})}catch{a({variant:"destructive",description:t("create_vector_database_card.errors.create_failed")})}};return h.jsxs(rn,{className:"mw-full",children:[h.jsx(Yn,{children:h.jsx(sr,{children:t("create_vector_database_card.title")})}),h.jsx(Jn,{children:h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(it,{children:t("create_vector_database_card.name")}),h.jsx(In,{className:"mb-4",value:o,onChange:w}),(hf==null?void 0:hf.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(it,{children:t("create_vector_database_card.storage_type")}),h.jsxs(zo,{value:l,onValueChange:v,children:[h.jsx(eo,{className:"w-full mb-4",children:h.jsx(Uo,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(to,{children:Object.values(hf).map(j=>h.jsx(cr,{value:j,children:t(`create_vector_database_card.storage_types.${j.toLowerCase()}`)},j))})]})]}):void 0,(pf==null?void 0:pf.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(it,{children:t("create_vector_database_card.provider")}),h.jsxs(zo,{value:s,onValueChange:y,children:[h.jsx(eo,{className:"w-full mb-4",children:h.jsx(Uo,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(to,{children:Object.values(pf).map(j=>h.jsx(cr,{value:j,children:t(`create_vector_database_card.providers.${j.toLowerCase()}`)},j))})]})]}):void 0,h.jsx(it,{children:t("create_vector_database_card.text_splitter")}),h.jsxs(zo,{value:d.type,onValueChange:b,children:[h.jsx(eo,{className:"w-full mb-4",children:h.jsx(Uo,{placeholder:t("create_vector_database_card.text_splitter_select_placeholder")})}),h.jsx(to,{children:Object.values(e_e).map(j=>h.jsx(cr,{value:j,children:t(`create_vector_database_card.text_splitters.${j.toLowerCase()}`)},j))})]}),d.type?h.jsxs(rn,{children:[h.jsx(Yn,{children:h.jsx(sr,{children:t("create_vector_database_card.text_splitter_configuration")})}),h.jsxs(Jn,{children:[h.jsx(it,{children:t("create_vector_database_card.text_splitter_chunksize")}),h.jsx(In,{value:d.chunkSize,onChange:_,placeholder:t("create_vector_database_card.text_splitter_chunksize_placeholder")}),h.jsx(it,{children:t("create_vector_database_card.text_splitter_chunkoverlap")}),h.jsx(In,{value:d.chunkOverlap,onChange:x,placeholder:t("create_vector_database_card.text_splitter_chunkoverlap_placeholder")})]})]}):void 0]})}),h.jsx(ki,{className:"flex justify-between",children:h.jsx(tr,{disabled:!d.type||!o,loading:p,onClick:S,className:"w-full",children:t("create_vector_database_card.create")})})]})});function n_e({data:e}){const{t}=Re("components");return h.jsxs(ky,{className:"w-full",children:[h.jsx(Py,{children:h.jsx(_s,{children:h.jsx(cl,{children:t("add_text_data.text")})})}),h.jsx(Ny,{children:e==null?void 0:e.map((n,r)=>h.jsx(_s,{children:h.jsx(ll,{className:"p-4",children:n.text})},`${n.text}_${r}`))})]})}const r_e=g.memo(e=>{const{id:t}=e,{t:n}=Re("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),s=Hn(t),{createCSVData:c,loading:l}=C7(),u=()=>{a(f=>[...f,{text:o}]),i("")},d=async()=>{s&&await c(s,["text"],r.map(f=>[f.text]))};return h.jsxs(rn,{className:"mw-full",children:[h.jsx(Yn,{children:h.jsx(sr,{children:n("add_text_data.title")})}),h.jsxs(Jn,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(it,{htmlFor:"name",children:n("add_text_data.text")}),h.jsx(Va,{value:o,onChange:f=>i(f.target.value||""),placeholder:n("add_text_data.text_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(yt,{disabled:!o,onClick:u,className:"w-40",children:n("add_text_data.add")})}),h.jsx(n_e,{data:r||[]})]}),h.jsx(ki,{className:"flex justify-between",children:h.jsx(tr,{loading:l,disabled:!(r!=null&&r.length),onClick:d,className:"w-full",children:n("add_text_data.create")})})]})});var qo=(e=>(e.ADD_LLM="ADD_LLM",e.ADD_PROMPT="ADD_PROMPT",e.ADD_TOOL_DEFINITION="ADD_TOOL_DEFINITION",e.ADD_SCHEMA="ADD_SCHEMA",e.ADD_FEW_SHOT_EXAMPLE="ADD_FEW_SHOT_EXAMPLE",e.ADD_VECTOR_DATABASE="ADD_VECTOR_DATABASE",e.ADD_TEXT_DATA="ADD_TEXT_DATA",e))(qo||{});const a_e=["ADD_LLM","ADD_PROMPT","ADD_SCHEMA","ADD_VECTOR_DATABASE",{key:"more",label:"more",icon:"ellipsis",children:["ADD_TOOL_DEFINITION","ADD_FEW_SHOT_EXAMPLE"]}],o_e=()=>{const e="_coolMode_effect",t=document.getElementById(e);if(t)return t;const n=document.createElement("div");return n.setAttribute("id",e),n.setAttribute("style","overflow:hidden; position:fixed; height:100%; top:0; left:0; right:0; bottom:0; pointer-events:none; z-index:2147483647"),document.body.appendChild(n),n};let k7=0,P7,N7,M7,A7,T7,R7,Fn,mt,I7,D7,L7,$7,zy,qE,ZE,KE,F7,B7,XE,z7,U7,V7;P7=(e,t)=>{k7++;const n=(t==null?void 0:t.particle)||"circle",r=[15,20,25,35,45],a=45;let o=[],i=!1,s=0,c=0;const l=o_e();function u(){const E=(t==null?void 0:t.size)||r[Math.floor(Math.random()*r.length)],O=(t==null?void 0:t.speedHorz)||Math.random()*10,P=(t==null?void 0:t.speedUp)||Math.random()*25,k=Math.random()*360,N=Math.random()*35*(Math.random()<=.5?-1:1),R=c-E/2,M=s-E/2,C=Math.random()<=.5?-1:1,T=document.createElement("div");if(n==="circle"){const A="http://www.w3.org/2000/svg",I=document.createElementNS(A,"svg"),F=document.createElementNS(A,"circle");F.setAttributeNS(null,"cx",(E/2).toString()),F.setAttributeNS(null,"cy",(E/2).toString()),F.setAttributeNS(null,"r",(E/2).toString()),F.setAttributeNS(null,"fill",`hsl(${Math.random()*360}, 70%, 50%)`),I.appendChild(F),I.setAttribute("width",E.toString()),I.setAttribute("height",E.toString()),T.appendChild(I)}else T.innerHTML=`<img src="${n}" width="${E}" height="${E}" style="border-radius: 50%">`;T.style.position="absolute",T.style.transform=`translate3d(${M}px, ${R}px, 0px) rotate(${k}deg)`,l.appendChild(T),o.push({direction:C,element:T,left:M,size:E,speedHorz:O,speedUp:P,spinSpeed:N,spinVal:k,top:R})}function d(){o.forEach(E=>{E.left=E.left-E.speedHorz*E.direction,E.top=E.top-E.speedUp,E.speedUp=Math.min(E.size,E.speedUp-1),E.spinVal=E.spinVal+E.spinSpeed,E.top>=Math.max(window.innerHeight,document.body.clientHeight)+E.size&&(o=o.filter(O=>O!==E),E.element.remove()),E.element.setAttribute("style",["position:absolute","will-change:transform",`top:${E.top}px`,`left:${E.left}px`,`transform:rotate(${E.spinVal}deg)`].join(";"))})}let f,p=0;const m=30;function y(){const E=performance.now();i&&o.length<a&&E-p>m&&(u(),p=E),d(),f=requestAnimationFrame(y)}y();const v="ontouchstart"in window,b=v?"touchstart":"mousedown",w=v?"touchend":"mouseup",_=v?"touchmove":"mousemove",x=E=>{var O,P;"touches"in E?(s=(O=E.touches)==null?void 0:O[0].clientX,c=(P=E.touches)==null?void 0:P[0].clientY):(s=E.clientX,c=E.clientY)},S=E=>{x(E),i=!0},j=()=>{i=!1};return e.addEventListener(_,x,{passive:!0}),e.addEventListener(b,S,{passive:!0}),e.addEventListener(w,j,{passive:!0}),e.addEventListener("mouseleave",j,{passive:!0}),()=>{e.removeEventListener(_,x),e.removeEventListener(b,S),e.removeEventListener(w,j),e.removeEventListener("mouseleave",j);const E=setInterval(()=>{f&&o.length===0&&(cancelAnimationFrame(f),clearInterval(E),--k7===0&&l.remove())},500)}},N7=({children:e,options:t})=>{const n=g.useRef(null);return g.useEffect(()=>{if(n.current)return P7(n.current,t)},[t]),Y.cloneElement(e,{ref:n})},M7=g.memo(e=>{const{t}=Re("flows"),n=ou(s=>s.theme),[r,a]=g.useState(`${qo.ADD_LLM}`),o=g.useMemo(()=>h.jsxs(dz,{children:[h.jsx(vE,{children:h.jsx(N7,{children:h.jsx(yt,{variant:"link",className:"!p-0 !pl-3",children:h.jsx(P4e,{width:32,height:32,className:G(n==="dark"?"fill-white":"fill-black")})})})}),a_e.map(s=>typeof s=="object"?h.jsxs(vE,{children:[h.jsx(bE,{children:s.icon?h.jsx(me,{name:s.icon}):t(`supported_nodes.${s.label}`)}),h.jsx(fz,{children:s.children.map(c=>h.jsx(pz,{onClick:()=>a(c),children:t(`supported_nodes.${c.toLowerCase()}`)},c))})]},s.key):h.jsx(vE,{children:h.jsx(bE,{value:s,onClick:()=>a(s),children:t(`supported_nodes.${s.toLowerCase()}`)})},s))]}),[t,n]),i=g.useMemo(()=>{switch(r){case qo.ADD_LLM:return h.jsx(V1e,{...e});case qo.ADD_PROMPT:return h.jsx(q1e,{...e});case qo.ADD_SCHEMA:return h.jsx(K1e,{...e});case qo.ADD_FEW_SHOT_EXAMPLE:return h.jsx(Y1e,{...e});case qo.ADD_TOOL_DEFINITION:return h.jsx(Q1e,{...e});case qo.ADD_VECTOR_DATABASE:return h.jsx(t_e,{...e});case qo.ADD_TEXT_DATA:return h.jsx(r_e,{...e})}},[e,r]);return h.jsxs(h.Fragment,{children:[o,h.jsx("div",{className:"mt-4",children:i})]})}),A7=()=>{const[e,t]=g.useState(!1),n=es(),r=st(s=>s.currentSession),a=st(s=>s.getLatestApplications),o=g.useCallback(async(s,c,l,u)=>{var p;const d=(p=c.data)==null?void 0:p.entity;let f=c.type?N4e[c.type]:void 0;if(f&&d&&c&&typeof d=="object"&&"id"in d&&!l.has(`${d.id}`)&&!u.has(`${c.id}`)){f=f;const m=await he(f).save({...d,...d&&typeof d=="object"&&"session_id"in d?{session_id:s.id}:{}});l.set(`${d.id}`,m.id);const y=await he("FlowNode").findOne({where:{id:c.data.flowNode.id}}),v=await he("FlowNode").save({...y||c.data.flowNode,session_id:s.id,id:void 0,source_type:f,source_id:m.id});return u.set(`${c.id}`,v.id),{entityName:f,entity:m,node:v}}else if(!u.has(`${c.id}`)){const m=await he("FlowNode").findOne({where:{id:c.data.flowNode.id}}),y=await he("FlowNode").save({...m||c.data.flowNode,node_type:c.type,session_id:s.id,id:void 0});return u.set(`${c.id}`,y.id),{node:y}}},[]),i=g.useCallback(async(s,c)=>{try{if(!r)throw new Error("No current session");t(!0);const l=await he("Session").save({type:au.StandaloneApp,name:c.name||(r!=null&&r.name?`${r.name}`:"Standalone"),status:M4e.Started,passphrase:r.passphrase});if(!l)throw new Error("Failed create standalone session");const u=new Map,d=new Map,f=await o(l,s,u,d);if(!f)throw new Error("Failed to clone main node");await he("Session").update(l.id,{main_node_id:f.node.id,main_source_id:f!=null&&f.entity?f.entity.id:void 0,main_source_type:f.entityName?f.entityName:void 0});for(const{node:p,connectedNodes:m}of c.connections)if(await o(l,p,u,d),m)for(const y of m)await o(l,y,u,d);for(const{connections:p}of c.connections)for(const m of p){const y=d.get(`${m.source}`),v=d.get(`${m.target}`);if(!y||!v)throw new Error("Failed to get connected flow node id");await he("FlowEdge").save({source:y,target:v,sourceHandle:m.sourceHandle,targetHandle:m.targetHandle,session_id:l.id})}return a(),n(bn("application",{applicationId:l.id})),!0}finally{t(!1)}},[o,r,a,n]);return{loading:e,createStandaloneSession:i}},T7=()=>{const[e,t]=g.useState(!1),n=ze(o=>o.updateNodes),r=ze(o=>o.updateEdges),a=g.useCallback(async o=>{try{t(!0),await he("FlowNode").delete(o);const i=await he("FlowEdge").find({where:[{source:o},{target:o}]});return await Promise.all(i.map(s=>he("FlowEdge").delete(s.id))),await n([{id:o,type:"remove"}]),await r(i.map(s=>({id:s.id,type:"remove"}))),!0}catch{return!1}finally{t(!1)}},[r,n]);return{loading:e,deleteNodeFlow:a}},R7=uo(({cloneStandaloneSession:e})=>{const t=an(),{t:n}=Re("dialogs"),[r,a]=g.useState(""),{toast:o}=on(),i=c=>{a(c.target.value)},s=async()=>{try{t.hide(),await e(r),a("")}catch{o({variant:"destructive",description:n("create_standalone_application.errors.create_failed")})}};return h.jsx(yi,{open:t.visible,onOpenChange:t.hide,children:h.jsxs(xo,{className:"sm:max-w-[425px]",children:[h.jsxs(_o,{children:[h.jsx(So,{children:n("create_session.title")}),h.jsx(Uu,{children:n("create_standalone_application.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(it,{className:"mb-2",htmlFor:"name",children:n("create_standalone_application.name")}),h.jsx(In,{onChange:i,id:"name",value:r,placeholder:n("create_standalone_application.name_placeholder")})]})}),h.jsx(zu,{children:h.jsx(yt,{onClick:s,disabled:!r,type:"submit",children:n("create_standalone_application.create")})})]})})}),Fn=g.memo(({id:e,className:t,enableToStandalone:n,getLinkedConnections:r})=>{const{t:a}=Re("common"),{getNode:o}=xr(),{loading:i,deleteNodeFlow:s}=T7(),{createStandaloneSession:c}=A7(),{toast:l}=on(),u=an(R7),d=g.useCallback(async()=>{try{await s(e),l({description:a("deleted")})}catch{l({description:a("errors.delete_failed"),variant:"destructive"})}},[s,e,l,a]),f=g.useCallback(async m=>{try{const y=o(e);if(!y)throw new Error("No current node");const v=(r==null?void 0:r(e))||[];await c(y,{name:m,connections:v}),l({description:a("standalone_session_created")})}catch(y){Ws(y),l({description:a("errors.create_standalone_session_failed"),variant:"destructive"})}},[o,e,r,c,l,a]),p=g.useCallback(()=>{u.show({cloneStandaloneSession:f})},[f,u]);return h.jsxs("div",{className:G("flex absolute z-[51] right-0 top-0 h-10",t),children:[n?h.jsx(yt,{className:"!rounded-none !px-2",onClick:p,variant:"ghost",children:h.jsx(me,{name:"package-plus",size:16})}):void 0,h.jsx(tr,{loading:i,className:"!rounded-none !px-2",onClick:d,variant:"ghost",children:h.jsx(me,{name:"trash-2",size:16})})]})}),mt=g.memo(e=>{const{className:t,...n}=e;return h.jsx(Pd,{className:G("!w-2 !h-2 !border-none !rounded-full !bg-slate-700",e.position===be.Top?"!top-[-2px]":"",t),...n})}),I7=()=>{const e=st(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=ze(i=>i.createOrUpdateFlowNode),a=ze(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async i=>{var s,c;n(!0);try{const l=(s=i.data)==null?void 0:s.entity;if(!l||!e)throw new Error("LLM or Session not found");const u=i.position.x,d=i.position.y+(((c=i.measured)==null?void 0:c.height)||0),f=await he("Thread").save({initial_llm_id:l.id,title:`New thread with ${l.name}`,status:kp.Started,messages:[],session_id:e}),p=await r({source_id:f.id,source_type:"Thread",node_type:ue.Thread,x:u,y:d+60});if(!p)throw new Error("Failed to create thread node");const m=await a({source:i.id,target:p.id});return{thread:f,flowNode:p,flowEdge:m}}finally{n(!1)}},[a,r,e]);return{loading:t,createThread:o}},D7=(e,t)=>{var w;const{t:n}=Re("flows"),{toast:r}=on(),[a,o]=g.useState(!1),[i,s]=g.useState(!1),c=Hn(e),{loadModel:l}=Om(),{createThread:u,loading:d}=I7(),f=ze(_=>_.updateNodes),p=ze(_=>_.pushSyncNodeQueue),{getNodes:m}=xr(),y=g.useCallback(async()=>{try{if(s(!0),t.entity.id){const _=await he("Thread").find({where:{initial_llm_id:t.entity.id}});p("Thread",{where:{source_type:"Thread",source_id:Xa(_.map(x=>x.id))}})}}finally{s(!1)}},[(w=t==null?void 0:t.entity)==null?void 0:w.id,p]),v=g.useCallback(async()=>{try{if(o(!0),t.entity&&c){await(l==null?void 0:l(t.entity.provider,`${t.entity.name}`,x=>{c.data.status=x.progress===100?rt.Loaded:rt.Loading,c.data.label=x.text,f([{id:e,type:"replace",item:c}])}));const _=m().filter(x=>x.type===ue.LLM?x.data.entity.provider===gt.WebLLM:!1).map(x=>(x.data.status=rt.Started,{id:x.id,type:"replace",item:x}));c.data.label="",c.data.status=rt.Loaded,_.push({id:e,type:"replace",item:c}),f(_),await y()}}catch(_){oi(_),r({variant:"destructive",description:n("llm_node.errors.loading_model")})}finally{o(!1)}},[t.entity,m,e,l,c,y,n,r,f]),b=g.useCallback(async()=>{t.entity&&c&&await(u==null?void 0:u(c))},[t.entity,c,u]);return g.useEffect(()=>{t.entity&&c&&t.entity.status!==t.status&&(c.data.status=t.entity.status,f([{id:e,type:"replace",item:c}]))},[]),{loadingModel:a,creatingThread:d,queringThreads:i,loadModel:v,createThread:b,queryThreads:y}},Wn=(e,t)=>{const[n,r]=g.useState(!1),[a,o]=g.useState([]),{deleteElements:i,getNode:s}=xr();bm({type:"target",nodeId:e,onConnect:l=>{l!=null&&l.length&&o(u=>[...u,...vfe(l)])}});const c=g.useCallback(async(l,u,d,f)=>{try{return await t({id:e,edgeId:l,source:u,target:d,connection:f})}catch{return{deleteEdgeId:l}}},[t,e]);g.useEffect(()=>{!(a!=null&&a.length)||n||(async()=>{try{r(!0);const l=[...a];o([]);const u=[],d=s(e);await Promise.all(l.map(async f=>{const p="edgeId"in f?f.edgeId:void 0,m=s(f.source);if(!m||!d)return;const y=await c(`${p}`,m,d,f);y!=null&&y.deleteEdgeId&&u.push(...Array.isArray(y.deleteEdgeId)?y.deleteEdgeId:[y.deleteEdgeId])})),u!=null&&u.length&&await i({edges:u.map(f=>({id:f}))})}finally{r(!1)}})()},[i,s,e,n,c,a])},L7=e=>{const t=g.useCallback(async()=>{},[]);Wn(e,t)},$7=g.memo(e=>{var y,v,b,w,_;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(),{t:i}=Re("flows"),{createThread:s,loadModel:c,queringThreads:l,queryThreads:u,loadingModel:d}=D7(t,n);L7(t);const f=[rt.Loading,rt.Downloading].includes(n.status);g.useEffect(()=>{var x,S,j,E,O;if(!(a||!((x=n==null?void 0:n.entity)!=null&&x.name))){if(((S=n==null?void 0:n.entity)==null?void 0:S.provider)!==gt.WebLLM){o({hasCache:!0,isFunctionCalling:!0,info:{model_id:(j=n==null?void 0:n.entity)==null?void 0:j.name,model:(E=n==null?void 0:n.entity)==null?void 0:E.name,model_lib:(O=n==null?void 0:n.entity)==null?void 0:O.provider,model_type:2}});return}Qt(()=>import("./index-CIMzE0bz.js").then(async P=>(await P.__tla,P)),__vite__mapDeps([9,1,2,3,4])).then(async({hasModelInCache:P,functionCallingModelIds:k,prebuiltAppConfig:N})=>{var M,C;const R=await P((M=n==null?void 0:n.entity)==null?void 0:M.name);o({hasCache:R,isFunctionCalling:k.includes((C=n==null?void 0:n.entity)==null?void 0:C.name),info:N.model_list.find(T=>{var A;return T.model_id===((A=n==null?void 0:n.entity)==null?void 0:A.name)})})})}},[(y=n==null?void 0:n.entity)==null?void 0:y.name,(v=n==null?void 0:n.entity)==null?void 0:v.provider,a]);const p=g.useMemo(()=>{var x,S;switch(n.status){case rt.Downloading:return h.jsx(me,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case rt.Loaded:return h.jsx(Tr,{name:((x=n.entity)==null?void 0:x.name)||"brain",className:"w-7 h-7"});case rt.Loading:return h.jsx(me,{className:"animate-spin w-7 h-7",name:"loader-circle"});default:return h.jsx(Tr,{name:((S=n.entity)==null?void 0:S.name)||"brain",className:"w-7 h-7"})}},[(b=n.entity)==null?void 0:b.name,n.status]),m=g.useMemo(()=>f?null:d?h.jsx(yt,{disabled:!0,className:"w-full mt-4",children:h.jsx(me,{className:"animate-spin",size:24,name:"loader-circle"})}):n.status===rt.Loaded?h.jsx(yt,{onClick:s,className:"mt-4 w-full",children:i("llm_node.create_thread_button")}):h.jsxs("div",{className:"flex gap-2 mt-4",children:[a!=null&&a.hasCache?h.jsx(tr,{loading:l,onClick:u,children:h.jsx(me,{size:24,name:"message-square-more"})}):null,h.jsx(yt,{disabled:d,onClick:c,className:"w-full",children:i(a!=null&&a.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")})]}),[f,d,n.status,a==null?void 0:a.hasCache,l,u,c,i,s]);return h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Fn,{id:t}),h.jsxs(Ca,{className:"flex justify-center",children:[p,h.jsxs("div",{className:"ml-2 pt-1 max-w-lg",children:[h.jsx(Ho,{className:"flex gap-2 items-center pr-6",children:`${((w=n==null?void 0:n.entity)==null?void 0:w.name)||""}`}),h.jsx(yl,{className:"max-w-full",children:`${n.label||""}`}),h.jsx("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:h.jsx(af,{model:a==null?void 0:a.info,isFunctionCalling:(a==null?void 0:a.isFunctionCalling)||!1,name:(_=n==null?void 0:n.entity)==null?void 0:_.name,isCached:(a==null?void 0:a.hasCache)||!1})}),m]})]}),f?h.jsx(tE,{className:"rounded-lg"}):void 0]}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:r})]})}),zy=g.memo(({tags:e,disabled:t,loading:n,onSubmit:r})=>{const{t:a}=Re("components"),o=async i=>{try{return await r(i),!0}catch{return!1}};return h.jsxs(rn,{className:"min-w-80",children:[h.jsx(Yn,{children:h.jsx(sr,{children:a("add_message_card.title")})}),h.jsxs(Jn,{children:[h.jsx("div",{className:"grid w-full gap-1.5",children:h.jsx(g0,{onSubmit:o,disabled:t||n,placeholder:a("add_message_card.placeholder")})}),e?h.jsx("div",{className:"mt-2 gap-1 flex flex-wrap",children:e}):null]})]})}),qE=(e,t,n,r=[],a)=>{const o=e.map(i=>a.getNode(i));for(const i of o){if(!i)continue;const s=a.getHandleConnections({type:"target",nodeId:i.id});if(n.push(...s),i.type===ue.Thread){r.push(i.id),t.push(i);continue}else if(i.type!==ue.Message){r.push(i.id);continue}else if(r.includes(i.id))continue;r.push(i.id),t.push(i),s.length&&qE(s.map(c=>c.source),t,n,r,a)}return{nodes:t,connections:n}},ZE=(e,t)=>{const n=t.getHandleConnections({nodeId:e.id,type:"target"}),r=n.map(d=>{const f=t.getNode(d.source);return f?{connections:t.getHandleConnections({nodeId:f.id,type:"target"}),node:f}:void 0}),a=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===ue.Prompt}),o=[];a!=null&&a.length&&a.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(m=>t.getNode(m.source)).filter(Boolean);o.push({node:d.node,connections:d.connections,connectedNodes:f})});const i=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===ue.ToolDefinition}),s=[];i!=null&&i.length&&i.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(m=>t.getNode(m.source)).filter(Boolean);f!=null&&f.find(m=>m.type===ue.Schema)&&s.push({node:d.node,connections:d.connections,connectedNodes:f})});const c=r.filter(d=>{var f;return((f=d.node)==null?void 0:f.type)===ue.PlaceHolder}),l=[];c!=null&&c.length&&c.forEach(d=>{var p;const f=(p=d.connections)==null?void 0:p.map(m=>t.getNode(m.source)).filter(Boolean);f&&l.push({node:d.node,connections:d.connections,connectedNodes:f})});const u=r.find(d=>{var f;return((f=d.node)==null?void 0:f.type)===ue.Schema});return{thread:{node:e,connections:n},llm:r.find(d=>{var f;return((f=d.node)==null?void 0:f.type)===ue.LLM}),schemas:u?[u]:[],prompts:o,tools:s,placeholders:l}},KE=e=>{const t=[];return e.forEach(n=>{var o,i,s;const{node:r,connectedNodes:a}=n;if((o=r.data)!=null&&o.entity){if(r.type===ue.Message){const c=r.data.entity;switch(c.role){case"human":t.push(new Vr(c.content));break;case"ai":t.push(new qr(c.content));break}}else if(r.type===ue.Prompt){const c=r.data.entity;let l=`${c.prefix?`${c.prefix}
`:""}`;if(c.type===mr.FewShotExample){const u=(s=(i=a.find(d=>d.type===ue.CSVData))==null?void 0:i.data)==null?void 0:s.entity;if(u){const{rows:d}=ZX(u.headers,u.csv);d.forEach(f=>{l+=`${c.content.replace(/{([^{}]*)}/g,(p,m)=>`${f[m]}`)}
`})}}else l+=c.content;switch(c.suffix&&(l+=`
${c.suffix}`),c.role){case"human":t.push(new Vr(l));break;case"system":t.push(new Cv(l));break;default:t.push(new qr(l));break}}}}),t},F7=(e,t)=>{const n=(e==null?void 0:e.filter(a=>a.type===ue.Message).map(a=>({node:a,connectedNodes:[]})).reverse())||[],r=[];return t.forEach(async a=>{r.unshift({node:a.node,connectedNodes:a.connectedNodes||[]})}),{history:KE(n),systems:KE(r)}},B7=e=>e?e.reduce((t,n)=>{var o,i,s,c,l;const r=(o=n.node.data)==null?void 0:o.entity,a=(c=(s=(i=n==null?void 0:n.connectedNodes)==null?void 0:i.find(u=>u.type===ue.Schema))==null?void 0:s.data)==null?void 0:c.entity;return r&&((l=a==null?void 0:a.schema_items)!=null&&l.length)&&t.push({name:r.name,description:r.description,schemaItems:a.schema_items}),t},[]):[],XE=({getNode:e,getHandleConnections:t})=>{const{t:n}=Re("create_new_message"),[r,a]=g.useState(!1),o=st(m=>m.currentSession),i=ze(m=>m.createOrUpdateFlowNode),s=ze(m=>m.createOrUpdateFlowEdge),c=Hs(m=>m.similaritySearchWithScore),{stream:l}=il(),u=g.useCallback(async({content:m,threadId:y,sourceId:v,initialX:b,initialY:w,initialLLMId:_})=>{if(!o)throw new Error("Session is not found");const x=await he("Message").save({thread_id:y,content:m,role:hr.Human,status:Yr.Started,llm_id:_,session_id:o.id});if(!x)throw new Error("Failed to save message");const S=await i({source_id:x.id,source_type:"Message",node_type:ue.Message,x:b,y:w+80});if(!S)throw new Error("Failed to save human message node");await s({source:v,target:S.id});const j=await he("Message").save({thread_id:y,content:n("initial_ai_message"),role:hr.AI,status:Yr.Inprogress,llm_id:_,parent_message_id:x.id,session_id:o.id});if(!j)throw new Error("Failed to save message");const E=await i({source_id:j.id,source_type:"Message",node_type:ue.Message,x:b,y:w+250});if(!E)throw new Error("Failed to save ai message node");return await s({source:S.id,target:E.id}),{aiMessage:j,humanMessage:x,aiMessageNode:E,humanMessageNode:S}},[s,i,o,n]),d=g.useCallback(async(m,y)=>{const{placeholders:v}=y;if(!(v!=null&&v.length))return[];const b=[];return await Promise.all(v.map(async w=>{var x,S,j,E,O,P,k,N,R,M,C,T;const _=(x=w.node.data)==null?void 0:x.entity;if(_)switch(_.placeholder_type){case ec.VECTOR_DATABASE_RETREIVER:{const A=(S=w.connectedNodes)==null?void 0:S.find(K=>K.type===ue.VectorDatabase),I=(j=A==null?void 0:A.data)==null?void 0:j.entity,F=(P=(O=(E=w.connectedNodes)==null?void 0:E.find(K=>K.type===ue.Prompt))==null?void 0:O.data)==null?void 0:P.entity;if(!F||!I||!A)return;const D=(k=_.metadata)!=null&&k.k?+((N=_.metadata)==null?void 0:N.k):1;let V=(R=_.metadata)!=null&&R.minimalScore?+((M=_.metadata)==null?void 0:M.minimalScore):void 0;V&&V>1&&(V=V/100);const U=[];if(I.storage===Zr.DataNode){const K=(T=(C=t({nodeId:A.id,type:"target"}).map(te=>e(te.source)).find(te=>(te==null?void 0:te.type)&&[ue.JSONLData,ue.CSVData].includes(te==null?void 0:te.type)))==null?void 0:C.data)==null?void 0:T.entity;if(!K)return;U.push(...await c({databaseId:I.id,dataSourceId:K.id,dataSourceType:JP(K)},m.humanMessage.content,D))}else U.push(...await c({databaseId:I.id},m.humanMessage.content,D));if(!U)return[];const B=new ci({template:F.content,inputVariables:["context"]});b.push(new qr(await B.format({context:V?U.filter(([,K])=>K>=V).map(([K])=>K.pageContent).join(`
`):U.map(([K])=>K.pageContent).join(`
`)})))}}})),b},[t,e,c]),f=g.useCallback(async(m,y,v,{onMessageUpdate:b})=>{var T;const{prompts:w,tools:_,schemas:x,placeholders:S,llm:j}=y,E=(T=j==null?void 0:j.node.data)==null?void 0:T.entity;if(!E)throw new Error("LLM is not found");const O=[];S!=null&&S.length&&O.push(...await d(m,y));const{history:P,systems:k}=F7(v,w),N=[...k,...O,...P,new Vr(m.humanMessage.content)],R=x.map(A=>{var I;return(I=A.node.data)==null?void 0:I.entity}).filter(Boolean),{lastChunk:M,content:C}=await l(E.provider,N,{tools:B7(_),schemas:R,llm:E,onMessageUpdate:({content:A})=>{b==null||b({id:m.aiMessageNode.id,nodeData:{loading:!0,content:A}})}});return m.aiMessage.content=C,m.aiMessage.metadata=JSON.stringify({message:M}),b==null||b({id:m.aiMessageNode.id,nodeData:{content:C,loading:!1,entity:m.aiMessage}}),m.aiMessage.id&&await he("Message").update(m.aiMessage.id,{content:C,metadata:JSON.stringify({message:M})}),C},[d,l]),p=g.useCallback(async(m,y,v)=>{var j,E,O;const{nodes:b}=qE([m.id],[],[],[],{getNode:e,getHandleConnections:t}),w=b.find(P=>P.type===ue.Thread),_=w==null?void 0:w.data.entity;if(!m||!_||!w)throw new Error("Source or thread is not found");const x=ZE(w,{getNode:e,getHandleConnections:t});if(!(x!=null&&x.thread))throw new Error("Thread node is not found");let S;try{a(!0);const P=((j=m.position)==null?void 0:j.x)||0,k=(((E=m.position)==null?void 0:E.y)||0)+(((O=m.measured)==null?void 0:O.height)||0);return S=await u({content:y,initialX:P,initialY:k,sourceId:m.id,threadId:_.id,initialLLMId:_.initial_llm_id}),await f(S,x,b,v),await he("Message").update(`${S.aiMessage.id}`,{status:Yr.Success}),S.aiMessage.status=Yr.Success,v.onMessageUpdate({id:S.aiMessageNode.id,nodeData:{entity:S.aiMessage,loading:!1}}),!0}catch(P){Ws(P),S!=null&&S.aiMessage&&await he("Message").update(`${S.aiMessage.id}`,{status:Yr.Failed,content:n("errors.ai_message_content_failed")}),S!=null&&S.aiMessageNode.id&&(v==null||v.onMessageUpdate({id:S.aiMessageNode.id,nodeData:{content:n("errors.ai_message_content_failed"),entity:{...S.aiMessage,status:Yr.Failed,content:n("errors.ai_message_content_failed")},loading:!1}}))}finally{a(!1)}},[t,e,u,f,n]);return{loading:r,createMessage:p}},z7=(e,t)=>{const n=Hn(e),{t:r}=Re("flows"),{getNode:a,getHandleConnections:o}=xr(),i=ze(f=>f.updateNodes),{createMessage:s,loading:c}=XE({getNode:a,getHandleConnections:o}),l=g.useCallback(f=>{if(!f.id)return;const p=a(f.id);!p||!f.nodeData||i([{id:p.id,type:"replace",item:{...p,data:{...p.data,...sd(f.nodeData,cd)}}}])},[a,i]),u=g.useCallback(async f=>{if(n&&t.entity)try{await s(n,f,{onMessageUpdate:l})}catch(p){if(p instanceof Error&&p.message.includes("LLM_NOT_LOADED_YET"))return lu({variant:"destructive",title:r("thread_node.errors.llm_not_loaded_yet")});lu({variant:"destructive",title:`${p}`})}},[n,t.entity,s,l,r]),d=g.useCallback(f=>{const p=a(f);if(!p)return[];const m=[],y=ZE(p,{getNode:a,getHandleConnections:o});return y.thread&&m.push({node:y.thread.node,connectedNodes:[],connections:y.thread.connections}),y.prompts&&m.push(...y.prompts.map(v=>({node:v.node,connectedNodes:v.connectedNodes,connections:v.connections}))),y.schemas&&m.push(...y.schemas.map(v=>({node:v.node,connectedNodes:[],connections:v.connections}))),y.placeholders&&y.placeholders.forEach(v=>{const b=v.connections.map(w=>a(w.source)).filter(Boolean);m.push({node:v.node,connectedNodes:b||[],connections:v.connections})}),y.llm&&m.push(y.llm),m},[o,a]);return{loading:c,createMessage:u,getLinkedConnections:d}},U7=e=>{const t=ze(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ue.Prompt&&(o==null?void 0:o.type)===ue.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ue.LLM&&(o==null?void 0:o.type)===ue.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ue.Schema&&(o==null?void 0:o.type)===ue.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ue.ToolDefinition&&(o==null?void 0:o.type)===ue.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ue.VectorDatabase&&(o==null?void 0:o.type)===ue.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===ue.PlaceHolder&&(o==null?void 0:o.type)===ue.Thread&&a.data.entity.placeholder_type===ec.VECTOR_DATABASE_RETREIVER){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Wn(e,n)},V7=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e,{t:a}=Re("flows"),[o,i]=g.useState(!1),s=bm({type:"source"}),c=bm({type:"target"}),{getNode:l}=xr(),{loading:u,createMessage:d,getLinkedConnections:f}=z7(t,n);U7(t);const p=g.useCallback(async(...b)=>(i(!1),await d(...b)),[d]),m=g.useMemo(()=>s.length>0,[s]),y=g.useCallback(()=>{i(b=>!b)},[]),v=g.useMemo(()=>{var w,_;const b=c.map((x,S)=>{var E;const j=l(x.source);if((j==null?void 0:j.type)===ue.Schema)return h.jsx(Mn,{children:a("thread_node.structured_output")},`${S}`);if((j==null?void 0:j.type)===ue.Prompt){const O=j.data.entity;return h.jsx(Mn,{children:a(O.type===mr.FewShotExample?"thread_node.prompts.few_shot_example":`thread_node.prompts.${O.role.toLowerCase()}`)},`${S}`)}else if((j==null?void 0:j.type)===ue.PlaceHolder&&((E=j.data.entity)==null?void 0:E.placeholder_type)===ec.VECTOR_DATABASE_RETREIVER)return h.jsx(Mn,{children:a("thread_node.vector_database_retriever")},`${S}`)}).filter(Boolean);return e.data.entity&&!((_=(w=e.data.entity)==null?void 0:w.messages)!=null&&_.length)&&!m?h.jsx(zy,{disabled:u,loading:u,onSubmit:p,tags:b}):b!=null&&b.length?h.jsxs(rn,{className:"p-4 pt-2",children:[h.jsx(sr,{className:"mb-2",children:a("thread_node.title")}),h.jsx("div",{className:"flex gap-1.5",children:b}),h.jsx("div",{className:"mt-4 w-full flex justify-end",children:h.jsxs(yt,{onClick:y,variant:"outline",children:[h.jsx(me,{name:o?"copy-minus":"copy-plus"}),a(o?"thread_node.hide":"thread_node.clone")]})})]}):h.jsx("div",{className:"w-12 h-10"})},[m,l,p,y,u,e.data.entity,o,a,c]);return h.jsxs("div",{children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Fn,{id:t,enableToStandalone:!0,getLinkedConnections:f}),v,o?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(zy,{disabled:u,loading:u,onSubmit:p})})})]}):void 0]}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:r})]})});function i_e({data:e,onNewThread:t,loading:n,showThread:r}){var o;const{t:a}=Re("flows");return h.jsxs(Ca,{className:"flex min-w-52",children:[h.jsx(me,{size:24,name:"user"}),h.jsxs("div",{className:"ml-2 max-w-full w-full",children:[h.jsx(Ho,{children:"Human"}),h.jsx(yl,{children:`${e.content||((o=e.entity)==null?void 0:o.content)||""}`}),t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(yt,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(me,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]})]})}function s_e({data:e,onNewThread:t,loading:n,showThread:r}){var c,l,u,d,f,p,m,y,v;const{t:a}=Re("flows"),o=g.useMemo(()=>{var b;try{return JSON.parse(((b=e==null?void 0:e.entity)==null?void 0:b.metadata)||"{}")}catch{return{}}},[(c=e==null?void 0:e.entity)==null?void 0:c.metadata]),i=e.entity.status===Yr.Failed,s=g.useMemo(()=>{var b;return h.jsx(Lj,{source:`${e.content||((b=e.entity)==null?void 0:b.content)||""}`})},[e.content,(l=e.entity)==null?void 0:l.content]);return h.jsxs(Ca,{className:G("flex min-w-52",i?"bg-background":""),variant:i?"destructive":"default",children:[h.jsx(me,{className:G(e.loading?"animate-spin":void 0),size:24,name:e.loading?"loader-circle":"bot"}),h.jsx(me,{name:r?"minus":"plus",size:24}),h.jsxs("div",{className:"ml-2 w-full max-w-full",children:[h.jsx(Ho,{children:a(`message_node.message_roles.${(d=(u=e.entity)==null?void 0:u.role)==null?void 0:d.toLowerCase()}`)}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(me,{name:"loader-circle",className:"animate-spin"})}),children:i?e.content||((f=e.entity)==null?void 0:f.content)||"":s}),Array.isArray((p=o==null?void 0:o.message)==null?void 0:p.tool_calls)&&((y=(m=o==null?void 0:o.message)==null?void 0:m.tool_calls)!=null&&y.length)?(v=o==null?void 0:o.message)==null?void 0:v.tool_calls.map((b,w)=>h.jsx(Mn,{children:a("message_node.tool_call",{name:b.name,args:Object.entries(b.args).map(([_,x])=>`"${_}": "${x}"`).join(", ")})},`${b.name}_${w}`)):null,t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(yt,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(me,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]}),e.loading?h.jsx(tE,{size:350,duration:10}):void 0]})}const c_e=e=>{const{t}=Re("flows"),n=Hn(e),r=ze(u=>u.updateNodes),{getNode:a,getHandleConnections:o}=xr(),{createMessage:i,loading:s}=XE({getNode:a,getHandleConnections:o}),c=g.useCallback(u=>{if(!u.id)return;const d=a(u.id);!d||!u.nodeData||r([{id:d.id,type:"replace",item:{...d,data:{...d.data,...sd(u.nodeData,cd)}}}])},[a,r]),l=g.useCallback(async u=>{if(n)try{await i(n,u,{onMessageUpdate:c})}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return lu({variant:"destructive",title:t("message_node.errors.llm_not_loaded_yet")});lu({variant:"destructive",title:t("message_node.errors.create_message")})}},[n,t,i,c]);return{loading:s,createMessage:l}},W7=()=>{const e=st(r=>r.currentSession),t=ze(r=>r.createOrUpdateFlowNode),n=ze(r=>r.createOrUpdateFlowEdge);return{createIdieMessage:g.useCallback(async(r,a,o,i)=>{var m,y,v,b,w;if(!r||!a||!e)return;const s=(y=(m=i==null?void 0:i.promptNode)==null?void 0:m.data)==null?void 0:y.entity,c=((v=r.position)==null?void 0:v.x)||0,l=(((b=r.position)==null?void 0:b.y)||0)+(((w=r.measured)==null?void 0:w.height)||0),u=await he("Message").save({thread_id:a.id,content:o,role:(s==null?void 0:s.role)||hr.Human,status:Yr.Started,llm_id:a.initial_llm_id,session_id:e.id});if(!u)throw new Error("Failed to save message");const d=await t({source_id:u.id,source_type:"Message",node_type:ue.Message,x:c,y:l});if(!d)throw new Error("Failed to save message node");const f=await n({source:r.id,target:d.id});let p;return i!=null&&i.promptNode&&(p=await n({source:i==null?void 0:i.promptNode.id,target:d.id})),{message:u,edgeToPrompt:p,messageNode:d,messageEdge:f}},[t,n])}},l_e=e=>{const{createIdieMessage:t}=W7(),n=g.useCallback(async({edgeId:r,source:a,target:o})=>{var i,s;try{if((a==null?void 0:a.type)===ue.Prompt&&(o==null?void 0:o.type)===ue.Message){const c=(i=o==null?void 0:o.data)==null?void 0:i.entity,l=(s=a==null?void 0:a.data)==null?void 0:s.entity;if(!l||!c||!o)return{deleteEdgeId:r};await t(o,{id:c==null?void 0:c.thread_id,title:"",status:kp.Started,initial_llm_id:c.llm_id,session_id:l.session_id},l.content,{promptNode:a});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Wn(e,n)},u_e=g.memo(e=>{var _,x,S;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(!1),[i,s]=g.useState(!1),{t:c}=Re("common"),l=bm({type:"source"}),{loading:u,createMessage:d}=c_e(t),{toast:f}=on();l_e(t);const p=g.useCallback(async(...j)=>{const E=await d(...j);return o(!1),E},[d]),m=g.useMemo(()=>l.length===0,[l]),y=g.useCallback(()=>{var j;(j=n.entity)!=null&&j.content&&(navigator.clipboard.writeText(n.entity.content),f({description:c("copied")}))},[f,n,c]),v=g.useCallback(async()=>{var j;try{if(i)return await YP.stop(),s(!1);s(!0),await YP.speak(((j=n.entity)==null?void 0:j.content)||"")}catch{f({variant:"destructive",description:c("errors.speech_is_not_supported")})}finally{s(!1)}},[(_=n.entity)==null?void 0:_.content,i,c,f]),b=g.useCallback(()=>{o(j=>!j)},[]),w=g.useMemo(()=>{var j;if(!(!m&&!a||n.loading||u||((j=n==null?void 0:n.entity)==null?void 0:j.status)==="inprogress"))return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(zy,{disabled:u,loading:u,onSubmit:p})})})]})},[(x=n==null?void 0:n.entity)==null?void 0:x.status,n.loading,p,m,u,a]);return h.jsxs("div",{children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:r}),h.jsxs("div",{className:"max-w-sm min-w-64",children:[h.jsxs("div",{className:"w-auto",children:[h.jsx(Fn,{id:t}),h.jsx("div",{children:((S=n.entity)==null?void 0:S.role)===hr.Human?h.jsx(i_e,{data:n,showThread:a,onNewThread:m?void 0:b}):h.jsx(s_e,{data:n,showThread:a,loading:u,onNewThread:m?void 0:b})}),h.jsx(yt,{onClick:v,className:"absolute top-0 right-[68px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(me,{name:i?"circle-stop":"speech",size:16})}),h.jsx(yt,{onClick:y,className:"absolute top-0 right-[36px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(me,{name:"copy",size:16})})]}),w]}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:r})]})}),d_e=e=>{const t=ze(a=>a.createOrUpdateFlowEdge),{createIdieMessage:n}=W7(),r=g.useCallback(async({edgeId:a,source:o,target:i})=>{var s,c,l,u;try{const d=(s=i==null?void 0:i.data)==null?void 0:s.entity,f=(c=o==null?void 0:o.data)==null?void 0:c.entity;if((o==null?void 0:o.type)===ue.Message&&(i==null?void 0:i.type)===ue.Prompt){const p=(l=o==null?void 0:o.data)==null?void 0:l.entity,m=(u=i==null?void 0:i.data)==null?void 0:u.entity;if(!m||!p||!i)return{deleteEdgeId:a};await n(o,{id:p==null?void 0:p.thread_id,title:"",status:kp.Started,initial_llm_id:p.llm_id,session_id:m.session_id},m.content,{promptNode:i});return}else if((o==null?void 0:o.type)===ue.CSVData&&(i==null?void 0:i.type)===ue.Prompt&&(d==null?void 0:d.type)===mr.FewShotExample&&(f!=null&&f.headers.includes("input"))&&(f!=null&&f.headers.includes("output"))){await t({source:o.id,target:i.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[n,t]);Wn(e,r)},f_e=g.memo(e=>{var l,u,d;const{id:t,data:n,isConnectable:r}=e;d_e(t);const a=an(fB),o=g.useMemo(()=>{var f,p,m;return`${(f=n.entity)!=null&&f.prefix?`${(p=n.entity)==null?void 0:p.prefix}
`:""}${((m=n.entity)==null?void 0:m.content)||""}`},[(l=n.entity)==null?void 0:l.prefix,(u=n.entity)==null?void 0:u.content]),i=g.useMemo(()=>{var p;const f=/{(.*?)}/g;return((p=o.match(f))==null?void 0:p.map(m=>m.replace("{","").replace("}","")))||[]},[o]),s=o.length>990,c=()=>{a.show({title:"Prompt",content:o})};return h.jsxs("div",{className:"min-w-56",children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Fn,{id:t}),h.jsxs(Ca,{className:"flex justify-center max-w-72",variant:"default",children:[h.jsx(me,{size:24,name:"notepad-text"}),h.jsxs("div",{className:"ml-2 max-w-full break-words break-all",children:[h.jsx(Ho,{children:`${((d=n.entity)==null?void 0:d.role)||""}`}),h.jsxs(yl,{onClick:s?c:void 0,children:[s?`${o.slice(0,990)}...`:o,s?h.jsx("span",{className:"float-right",children:h.jsx(me,{name:"chevron-right"})}):void 0]}),i!=null&&i.length?i.map((f,p)=>h.jsx(Mn,{className:"mt-2 mr-1",variant:"default",children:f},p)):void 0]})]})]}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:r})]})});var p_e=v4();const Rr=ft(p_e);var YE,H7;function h_e(){if(H7)return YE;H7=1;function e(t){return t==null}return YE=e,YE}var m_e=h_e();const Ot=ft(m_e);var JE,q7;function y_e(){if(q7)return JE;q7=1;var e=Po(),t=qn(),n=Ia(),r="[object String]";function a(o){return typeof o=="string"||!t(o)&&n(o)&&e(o)==r}return JE=a,JE}var g_e=y_e();const mf=ft(g_e);var v_e=xp();const lt=ft(v_e);var b_e=Xr();const gl=ft(b_e);var Z7={exports:{}},Ct={},K7;function w_e(){if(K7)return Ct;K7=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),i=Symbol.for("react.context"),s=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),m;m=Symbol.for("react.module.reference");function y(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case e:switch(v=v.type,v){case n:case a:case r:case l:case u:return v;default:switch(v=v&&v.$$typeof,v){case s:case i:case c:case f:case d:case o:return v;default:return b}}case t:return b}}}return Ct.ContextConsumer=i,Ct.ContextProvider=o,Ct.Element=e,Ct.ForwardRef=c,Ct.Fragment=n,Ct.Lazy=f,Ct.Memo=d,Ct.Portal=t,Ct.Profiler=a,Ct.StrictMode=r,Ct.Suspense=l,Ct.SuspenseList=u,Ct.isAsyncMode=function(){return!1},Ct.isConcurrentMode=function(){return!1},Ct.isContextConsumer=function(v){return y(v)===i},Ct.isContextProvider=function(v){return y(v)===o},Ct.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===e},Ct.isForwardRef=function(v){return y(v)===c},Ct.isFragment=function(v){return y(v)===n},Ct.isLazy=function(v){return y(v)===f},Ct.isMemo=function(v){return y(v)===d},Ct.isPortal=function(v){return y(v)===t},Ct.isProfiler=function(v){return y(v)===a},Ct.isStrictMode=function(v){return y(v)===r},Ct.isSuspense=function(v){return y(v)===l},Ct.isSuspenseList=function(v){return y(v)===u},Ct.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===n||v===a||v===r||v===l||v===u||v===p||typeof v=="object"&&v!==null&&(v.$$typeof===f||v.$$typeof===d||v.$$typeof===o||v.$$typeof===i||v.$$typeof===c||v.$$typeof===m||v.getModuleId!==void 0)},Ct.typeOf=y,Ct}var X7;function x_e(){return X7||(X7=1,Z7.exports=w_e()),Z7.exports}var __e=x_e(),QE,Y7;function J7(){if(Y7)return QE;Y7=1;var e=Po(),t=Ia(),n="[object Number]";function r(a){return typeof a=="number"||t(a)&&e(a)==n}return QE=r,QE}var GE,Q7;function S_e(){if(Q7)return GE;Q7=1;var e=J7();function t(n){return e(n)&&n!=+n}return GE=t,GE}var j_e=S_e();const yf=ft(j_e);var E_e=J7();const O_e=ft(E_e);var ka=function(e){return e===0?0:e>0?1:-1},Os=function(e){return mf(e)&&e.indexOf("%")===e.length-1},we=function(e){return O_e(e)&&!yf(e)},yn=function(e){return we(e)||mf(e)},C_e=0,Uy=function(e){var t=++C_e;return"".concat(e||"").concat(t)},Cs=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!we(e)&&!mf(e))return n;var a;if(Os(e)){var o=e.indexOf("%");a=t*parseFloat(e.slice(0,o))/100}else a=+e;return yf(a)&&(a=n),r&&a>t&&(a=t),a},Di=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},k_e=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1},vl=function(e,t){return we(e)&&we(t)?function(n){return e+n*(t-e)}:function(){return t}};function eO(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):Rr(r,t))===n})}function bl(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function tO(e){"@babel/helpers - typeof";return tO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tO(e)}var P_e=["viewBox","children"],N_e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],G7=["points","pathLength"],nO={svg:P_e,polygon:G7,polyline:G7},rO=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Vy=function(e,t){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),!gl(n))return null;var r={};return Object.keys(n).forEach(function(a){rO.includes(a)&&(r[a]=t||function(o){return n[a](n,o)})}),r},M_e=function(e,t,n){return function(r){return e(t,n,r),null}},Wy=function(e,t,n){if(!gl(e)||tO(e)!=="object")return null;var r=null;return Object.keys(e).forEach(function(a){var o=e[a];rO.includes(a)&&typeof o=="function"&&(r||(r={}),r[a]=M_e(o,t,n))}),r},A_e=["children"],T_e=["children"];function eU(e,t){if(e==null)return{};var n=R_e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function R_e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var tU={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Zo=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},nU=null,aO=null,oO=function e(t){if(t===nU&&Array.isArray(aO))return aO;var n=[];return g.Children.forEach(t,function(r){Ot(r)||(__e.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),aO=n,nU=t,n};function Pa(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(a){return Zo(a)}):r=[Zo(t)],oO(e).forEach(function(a){var o=Rr(a,"type.displayName")||Rr(a,"type.name");r.indexOf(o)!==-1&&n.push(a)}),n}function Er(e,t){var n=Pa(e,t);return n&&n[0]}var rU=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!we(n)||n<=0||!we(r)||r<=0)},I_e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],D_e=function(e){return e&&e.type&&mf(e.type)&&I_e.indexOf(e.type)>=0},L_e=function(e,t,n,r){var a,o=(a=nO==null?void 0:nO[r])!==null&&a!==void 0?a:[];return!lt(e)&&(r&&o.includes(t)||N_e.includes(t))||n&&rO.includes(t)},Et=function(e,t,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(g.isValidElement(e)&&(r=e.props),!gl(r))return null;var a={};return Object.keys(r).forEach(function(o){var i;L_e((i=r)===null||i===void 0?void 0:i[o],o,t,n)&&(a[o]=r[o])}),a},iO=function e(t,n){if(t===n)return!0;var r=g.Children.count(t);if(r!==g.Children.count(n))return!1;if(r===0)return!0;if(r===1)return aU(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var o=t[a],i=n[a];if(Array.isArray(o)||Array.isArray(i)){if(!e(o,i))return!1}else if(!aU(o,i))return!1}return!0},aU=function(e,t){if(Ot(e)&&Ot(t))return!0;if(!Ot(e)&&!Ot(t)){var n=e.props||{},r=n.children,a=eU(n,A_e),o=t.props||{},i=o.children,s=eU(o,T_e);return r&&i?bl(a,s)&&iO(r,i):!r&&!i?bl(a,s):!1}return!1},oU=function(e,t){var n=[],r={};return oO(e).forEach(function(a,o){if(D_e(a))n.push(a);else if(a){var i=Zo(a.type),s=t[i]||{},c=s.handler,l=s.once;if(c&&(!l||!r[i])){var u=c(a,i,o);n.push(u),r[i]=!0}}}),n},$_e=function(e){var t=e&&e.type;return t&&tU[t]?tU[t]:null},F_e=function(e,t){return oO(t).indexOf(e)},B_e=["children","width","height","viewBox","className","style","title","desc"];function sO(){return sO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sO.apply(this,arguments)}function z_e(e,t){if(e==null)return{};var n=U_e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function U_e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function cO(e){var t=e.children,n=e.width,r=e.height,a=e.viewBox,o=e.className,i=e.style,s=e.title,c=e.desc,l=z_e(e,B_e),u=a||{width:n,height:r,x:0,y:0},d=Pt("recharts-surface",o);return Y.createElement("svg",sO({},Et(l,!0,"svg"),{className:d,width:n,height:r,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),Y.createElement("title",null,s),Y.createElement("desc",null,c),t)}var V_e=["children","className"];function lO(){return lO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lO.apply(this,arguments)}function W_e(e,t){if(e==null)return{};var n=H_e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function H_e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var _n=Y.forwardRef(function(e,t){var n=e.children,r=e.className,a=W_e(e,V_e),o=Pt("recharts-layer",r);return Y.createElement("g",lO({className:o},Et(a,!0),{ref:t}),n)}),Ko=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]},uO,iU;function q_e(){if(iU)return uO;iU=1;var e=N0();function t(n,r,a){var o=n.length;return a=a===void 0?o:a,!r&&a>=o?n:e(n,r,a)}return uO=t,uO}var dO,sU;function cU(){if(sU)return dO;sU=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="\\u200d",s=RegExp("["+i+e+a+o+"]");function c(l){return s.test(l)}return dO=c,dO}var fO,lU;function Z_e(){if(lU)return fO;lU=1;function e(t){return t.split("")}return fO=e,fO}var pO,uU;function K_e(){if(uU)return pO;uU=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="["+e+"]",s="["+a+"]",c="\uD83C[\uDFFB-\uDFFF]",l="(?:"+s+"|"+c+")",u="[^"+e+"]",d="(?:\uD83C[\uDDE6-\uDDFF]){2}",f="[\uD800-\uDBFF][\uDC00-\uDFFF]",p="\\u200d",m=l+"?",y="["+o+"]?",v="(?:"+p+"(?:"+[u,d,f].join("|")+")"+y+m+")*",b=y+m+v,w="(?:"+[u+s+"?",s,d,f,i].join("|")+")",_=RegExp(c+"(?="+c+")|"+w+b,"g");function x(S){return S.match(_)||[]}return pO=x,pO}var hO,dU;function X_e(){if(dU)return hO;dU=1;var e=Z_e(),t=cU(),n=K_e();function r(a){return t(a)?n(a):e(a)}return hO=r,hO}var mO,fU;function Y_e(){if(fU)return mO;fU=1;var e=q_e(),t=cU(),n=X_e(),r=p4();function a(o){return function(i){i=r(i);var s=t(i)?n(i):void 0,c=s?s[0]:i.charAt(0),l=s?e(s,1).join(""):i.slice(1);return c[o]()+l}}return mO=a,mO}var yO,pU;function J_e(){if(pU)return yO;pU=1;var e=Y_e(),t=e("toUpperCase");return yO=t,yO}var Q_e=J_e();const Hy=ft(Q_e);function Wt(e){return function(){return e}}const hU=Math.cos,qy=Math.sin,Na=Math.sqrt,Zy=Math.PI,Ky=2*Zy,gO=Math.PI,vO=2*gO,ks=1e-6,G_e=vO-ks;function mU(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function eSe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return mU;const n=10**t;return function(r){this._+=r[0];for(let a=1,o=r.length;a<o;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class tSe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?mU:eSe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,a){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(t,n,r,a,o,i){this._append`C${+t},${+n},${+r},${+a},${this._x1=+o},${this._y1=+i}`}arcTo(t,n,r,a,o){if(t=+t,n=+n,r=+r,a=+a,o=+o,o<0)throw new Error(`negative radius: ${o}`);let i=this._x1,s=this._y1,c=r-t,l=a-n,u=i-t,d=s-n,f=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>ks)if(!(Math.abs(d*c-l*u)>ks)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let p=r-i,m=a-s,y=c*c+l*l,v=p*p+m*m,b=Math.sqrt(y),w=Math.sqrt(f),_=o*Math.tan((gO-Math.acos((y+f-v)/(2*b*w)))/2),x=_/w,S=_/b;Math.abs(x-1)>ks&&this._append`L${t+x*u},${n+x*d}`,this._append`A${o},${o},0,0,${+(d*p>u*m)},${this._x1=t+S*c},${this._y1=n+S*l}`}}arc(t,n,r,a,o,i){if(t=+t,n=+n,r=+r,i=!!i,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(a),c=r*Math.sin(a),l=t+s,u=n+c,d=1^i,f=i?a-o:o-a;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>ks||Math.abs(this._y1-u)>ks)&&this._append`L${l},${u}`,r&&(f<0&&(f=f%vO+vO),f>G_e?this._append`A${r},${r},0,1,${d},${t-s},${n-c}A${r},${r},0,1,${d},${this._x1=l},${this._y1=u}`:f>ks&&this._append`A${r},${r},0,${+(f>=gO)},${d},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function bO(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new tSe(t)}function wO(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function yU(e){this._context=e}yU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Xy(e){return new yU(e)}function gU(e){return e[0]}function vU(e){return e[1]}function bU(e,t){var n=Wt(!0),r=null,a=Xy,o=null,i=bO(s);e=typeof e=="function"?e:e===void 0?gU:Wt(e),t=typeof t=="function"?t:t===void 0?vU:Wt(t);function s(c){var l,u=(c=wO(c)).length,d,f=!1,p;for(r==null&&(o=a(p=i())),l=0;l<=u;++l)!(l<u&&n(d=c[l],l,c))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(d,l,c),+t(d,l,c));if(p)return o=null,p+""||null}return s.x=function(c){return arguments.length?(e=typeof c=="function"?c:Wt(+c),s):e},s.y=function(c){return arguments.length?(t=typeof c=="function"?c:Wt(+c),s):t},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:Wt(!!c),s):n},s.curve=function(c){return arguments.length?(a=c,r!=null&&(o=a(r)),s):a},s.context=function(c){return arguments.length?(c==null?r=o=null:o=a(r=c),s):r},s}function Yy(e,t,n){var r=null,a=Wt(!0),o=null,i=Xy,s=null,c=bO(l);e=typeof e=="function"?e:e===void 0?gU:Wt(+e),t=typeof t=="function"?t:Wt(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?vU:Wt(+n);function l(d){var f,p,m,y=(d=wO(d)).length,v,b=!1,w,_=new Array(y),x=new Array(y);for(o==null&&(s=i(w=c())),f=0;f<=y;++f){if(!(f<y&&a(v=d[f],f,d))===b)if(b=!b)p=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),m=f-1;m>=p;--m)s.point(_[m],x[m]);s.lineEnd(),s.areaEnd()}b&&(_[f]=+e(v,f,d),x[f]=+t(v,f,d),s.point(r?+r(v,f,d):_[f],n?+n(v,f,d):x[f]))}if(w)return s=null,w+""||null}function u(){return bU().defined(a).curve(i).context(o)}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:Wt(+d),r=null,l):e},l.x0=function(d){return arguments.length?(e=typeof d=="function"?d:Wt(+d),l):e},l.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:Wt(+d),l):r},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:Wt(+d),n=null,l):t},l.y0=function(d){return arguments.length?(t=typeof d=="function"?d:Wt(+d),l):t},l.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:Wt(+d),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(d){return arguments.length?(a=typeof d=="function"?d:Wt(!!d),l):a},l.curve=function(d){return arguments.length?(i=d,o!=null&&(s=i(o)),l):i},l.context=function(d){return arguments.length?(d==null?o=s=null:s=i(o=d),l):o},l}class wU{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function nSe(e){return new wU(e,!0)}function rSe(e){return new wU(e,!1)}const xO={draw(e,t){const n=Na(t/Zy);e.moveTo(n,0),e.arc(0,0,n,0,Ky)}},aSe={draw(e,t){const n=Na(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},xU=Na(1/3),oSe=xU*2,iSe={draw(e,t){const n=Na(t/oSe),r=n*xU;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},sSe={draw(e,t){const n=Na(t),r=-n/2;e.rect(r,r,n,n)}},cSe=.8908130915292852,_U=qy(Zy/10)/qy(7*Zy/10),lSe=qy(Ky/10)*_U,uSe=-hU(Ky/10)*_U,dSe={draw(e,t){const n=Na(t*cSe),r=lSe*n,a=uSe*n;e.moveTo(0,-n),e.lineTo(r,a);for(let o=1;o<5;++o){const i=Ky*o/5,s=hU(i),c=qy(i);e.lineTo(c*n,-s*n),e.lineTo(s*r-c*a,c*r+s*a)}e.closePath()}},_O=Na(3),fSe={draw(e,t){const n=-Na(t/(_O*3));e.moveTo(0,n*2),e.lineTo(-_O*n,-n),e.lineTo(_O*n,-n),e.closePath()}},Ir=-.5,Dr=Na(3)/2,SO=1/Na(12),pSe=(SO/2+1)*3,hSe={draw(e,t){const n=Na(t/pSe),r=n/2,a=n*SO,o=r,i=n*SO+n,s=-o,c=i;e.moveTo(r,a),e.lineTo(o,i),e.lineTo(s,c),e.lineTo(Ir*r-Dr*a,Dr*r+Ir*a),e.lineTo(Ir*o-Dr*i,Dr*o+Ir*i),e.lineTo(Ir*s-Dr*c,Dr*s+Ir*c),e.lineTo(Ir*r+Dr*a,Ir*a-Dr*r),e.lineTo(Ir*o+Dr*i,Ir*i-Dr*o),e.lineTo(Ir*s+Dr*c,Ir*c-Dr*s),e.closePath()}};function mSe(e,t){let n=null,r=bO(a);e=typeof e=="function"?e:Wt(e||xO),t=typeof t=="function"?t:Wt(t===void 0?64:+t);function a(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return a.type=function(o){return arguments.length?(e=typeof o=="function"?o:Wt(o),a):e},a.size=function(o){return arguments.length?(t=typeof o=="function"?o:Wt(+o),a):t},a.context=function(o){return arguments.length?(n=o??null,a):n},a}function Jy(){}function Qy(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function SU(e){this._context=e}SU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Qy(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Qy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ySe(e){return new SU(e)}function jU(e){this._context=e}jU.prototype={areaStart:Jy,areaEnd:Jy,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Qy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function gSe(e){return new jU(e)}function EU(e){this._context=e}EU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Qy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function vSe(e){return new EU(e)}function OU(e){this._context=e}OU.prototype={areaStart:Jy,areaEnd:Jy,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function bSe(e){return new OU(e)}function CU(e){return e<0?-1:1}function kU(e,t,n){var r=e._x1-e._x0,a=t-e._x1,o=(e._y1-e._y0)/(r||a<0&&-0),i=(n-e._y1)/(a||r<0&&-0),s=(o*a+i*r)/(r+a);return(CU(o)+CU(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(s))||0}function PU(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function jO(e,t,n){var r=e._x0,a=e._y0,o=e._x1,i=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,a+s*t,o-s,i-s*n,o,i)}function Gy(e){this._context=e}Gy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:jO(this,this._t0,PU(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,jO(this,PU(this,n=kU(this,e,t)),n);break;default:jO(this,this._t0,n=kU(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function NU(e){this._context=new MU(e)}(NU.prototype=Object.create(Gy.prototype)).point=function(e,t){Gy.prototype.point.call(this,t,e)};function MU(e){this._context=e}MU.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,o){this._context.bezierCurveTo(t,e,r,n,o,a)}};function wSe(e){return new Gy(e)}function xSe(e){return new NU(e)}function AU(e){this._context=e}AU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=TU(e),a=TU(t),o=0,i=1;i<n;++o,++i)this._context.bezierCurveTo(r[0][o],a[0][o],r[1][o],a[1][o],e[i],t[i]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function TU(e){var t,n=e.length-1,r,a=new Array(n),o=new Array(n),i=new Array(n);for(a[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,o[n-1]=7,i[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/o[t-1],o[t]-=r,i[t]-=r*i[t-1];for(a[n-1]=i[n-1]/o[n-1],t=n-2;t>=0;--t)a[t]=(i[t]-a[t+1])/o[t];for(o[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-a[t+1];return[a,o]}function _Se(e){return new AU(e)}function eg(e,t){this._context=e,this._t=t}eg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function SSe(e){return new eg(e,.5)}function jSe(e){return new eg(e,0)}function ESe(e){return new eg(e,1)}function wl(e,t){if((i=e.length)>1)for(var n=1,r,a,o=e[t[0]],i,s=o.length;n<i;++n)for(a=o,o=e[t[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function EO(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function OSe(e,t){return e[t]}function CSe(e){const t=[];return t.key=e,t}function kSe(){var e=Wt([]),t=EO,n=wl,r=OSe;function a(o){var i=Array.from(e.apply(this,arguments),CSe),s,c=i.length,l=-1,u;for(const d of o)for(s=0,++l;s<c;++s)(i[s][l]=[0,+r(d,i[s].key,l,o)]).data=d;for(s=0,u=wO(t(i));s<c;++s)i[u[s]].index=s;return n(i,u),i}return a.keys=function(o){return arguments.length?(e=typeof o=="function"?o:Wt(Array.from(o)),a):e},a.value=function(o){return arguments.length?(r=typeof o=="function"?o:Wt(+o),a):r},a.order=function(o){return arguments.length?(t=o==null?EO:typeof o=="function"?o:Wt(Array.from(o)),a):t},a.offset=function(o){return arguments.length?(n=o??wl,a):n},a}function PSe(e,t){if((r=e.length)>0){for(var n,r,a=0,o=e[0].length,i;a<o;++a){for(i=n=0;n<r;++n)i+=e[n][a][1]||0;if(i)for(n=0;n<r;++n)e[n][a][1]/=i}wl(e,t)}}function NSe(e,t){if((a=e.length)>0){for(var n=0,r=e[t[0]],a,o=r.length;n<o;++n){for(var i=0,s=0;i<a;++i)s+=e[i][n][1]||0;r[n][1]+=r[n][0]=-s/2}wl(e,t)}}function MSe(e,t){if(!(!((i=e.length)>0)||!((o=(a=e[t[0]]).length)>0))){for(var n=0,r=1,a,o,i;r<o;++r){for(var s=0,c=0,l=0;s<i;++s){for(var u=e[t[s]],d=u[r][1]||0,f=u[r-1][1]||0,p=(d-f)/2,m=0;m<s;++m){var y=e[t[m]],v=y[r][1]||0,b=y[r-1][1]||0;p+=v-b}c+=d,l+=p*d}a[r-1][1]+=a[r-1][0]=n,c&&(n-=l/c)}a[r-1][1]+=a[r-1][0]=n,wl(e,t)}}function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}var ASe=["type","size","sizeType"];function OO(){return OO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},OO.apply(this,arguments)}function RU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function IU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RU(Object(n),!0).forEach(function(r){TSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function TSe(e,t,n){return t=RSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RSe(e){var t=ISe(e,"string");return gf(t)=="symbol"?t:t+""}function ISe(e,t){if(gf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(gf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DSe(e,t){if(e==null)return{};var n=LSe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function LSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var DU={symbolCircle:xO,symbolCross:aSe,symbolDiamond:iSe,symbolSquare:sSe,symbolStar:dSe,symbolTriangle:fSe,symbolWye:hSe},$Se=Math.PI/180,FSe=function(e){var t="symbol".concat(Hy(e));return DU[t]||xO},BSe=function(e,t,n){if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*$Se;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.pow(Math.tan(r),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},zSe=function(e,t){DU["symbol".concat(Hy(e))]=t},CO=function(e){var t=e.type,n=t===void 0?"circle":t,r=e.size,a=r===void 0?64:r,o=e.sizeType,i=o===void 0?"area":o,s=DSe(e,ASe),c=IU(IU({},s),{},{type:n,size:a,sizeType:i}),l=function(){var m=FSe(n),y=mSe().type(m).size(BSe(a,i,n));return y()},u=c.className,d=c.cx,f=c.cy,p=Et(c,!0);return d===+d&&f===+f&&a===+a?Y.createElement("path",OO({},p,{className:Pt("recharts-symbols",u),transform:"translate(".concat(d,", ").concat(f,")"),d:l()})):null};CO.registerSymbol=zSe;function xl(e){"@babel/helpers - typeof";return xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xl(e)}function kO(){return kO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kO.apply(this,arguments)}function LU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function USe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?LU(Object(n),!0).forEach(function(r){vf(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function VSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WSe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,FU(r.key),r)}}function HSe(e,t,n){return t&&WSe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qSe(e,t,n){return t=tg(t),ZSe(e,$U()?Reflect.construct(t,n||[],tg(e).constructor):t.apply(e,n))}function ZSe(e,t){if(t&&(xl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KSe(e)}function KSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $U(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($U=function(){return!!e})()}function tg(e){return tg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tg(e)}function XSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PO(e,t)}function PO(e,t){return PO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},PO(e,t)}function vf(e,t,n){return t=FU(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FU(e){var t=YSe(e,"string");return xl(t)=="symbol"?t:t+""}function YSe(e,t){if(xl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lr=32,NO=function(e){function t(){return VSe(this,t),qSe(this,t,arguments)}return XSe(t,e),HSe(t,[{key:"renderIcon",value:function(n){var r=this.props.inactiveColor,a=Lr/2,o=Lr/6,i=Lr/3,s=n.inactive?r:n.color;if(n.type==="plainline")return Y.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:a,x2:Lr,y2:a,className:"recharts-legend-icon"});if(n.type==="line")return Y.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(a,"h").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*i,",").concat(a,`
            H`).concat(Lr,"M").concat(2*i,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(i,",").concat(a),className:"recharts-legend-icon"});if(n.type==="rect")return Y.createElement("path",{stroke:"none",fill:s,d:"M0,".concat(Lr/8,"h").concat(Lr,"v").concat(Lr*3/4,"h").concat(-Lr,"z"),className:"recharts-legend-icon"});if(Y.isValidElement(n.legendIcon)){var c=USe({},n);return delete c.legendIcon,Y.cloneElement(n.legendIcon,c)}return Y.createElement(CO,{fill:s,cx:a,cy:a,size:Lr,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,r=this.props,a=r.payload,o=r.iconSize,i=r.layout,s=r.formatter,c=r.inactiveColor,l={x:0,y:0,width:Lr,height:Lr},u={display:i==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(f,p){var m=f.formatter||s,y=Pt(vf(vf({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",f.inactive));if(f.type==="none")return null;var v=lt(f.value)?null:f.value;Ko(!lt(f.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=f.inactive?c:f.color;return Y.createElement("li",kO({className:y,style:u,key:"legend-item-".concat(p)},Wy(n.props,f,p)),Y.createElement(cO,{width:o,height:o,viewBox:l,style:d},n.renderIcon(f)),Y.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},m?m(v,f,p):v))})}},{key:"render",value:function(){var n=this.props,r=n.payload,a=n.layout,o=n.align;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return Y.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(g.PureComponent);vf(NO,"displayName","Legend"),vf(NO,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var MO,BU;function zU(){if(BU)return MO;BU=1;function e(t,n,r,a){for(var o=t.length,i=r+(a?1:-1);a?i--:++i<o;)if(n(t[i],i,t))return i;return-1}return MO=e,MO}var AO,UU;function JSe(){if(UU)return AO;UU=1;function e(t){return t!==t}return AO=e,AO}var TO,VU;function QSe(){if(VU)return TO;VU=1;function e(t,n,r){for(var a=r-1,o=t.length;++a<o;)if(t[a]===n)return a;return-1}return TO=e,TO}var RO,WU;function GSe(){if(WU)return RO;WU=1;var e=zU(),t=JSe(),n=QSe();function r(a,o,i){return o===o?n(a,o,i):e(a,t,i)}return RO=r,RO}var IO,HU;function eje(){if(HU)return IO;HU=1;var e=GSe();function t(n,r){var a=n==null?0:n.length;return!!a&&e(n,r,0)>-1}return IO=t,IO}var DO,qU;function tje(){if(qU)return DO;qU=1;function e(t,n,r){for(var a=-1,o=t==null?0:t.length;++a<o;)if(r(n,t[a]))return!0;return!1}return DO=e,DO}var LO,ZU;function nje(){if(ZU)return LO;ZU=1;function e(){}return LO=e,LO}var $O,KU;function rje(){if(KU)return $O;KU=1;var e=qD(),t=nje(),n=Sx(),r=1/0,a=e&&1/n(new e([,-0]))[1]==r?function(o){return new e(o)}:t;return $O=a,$O}var FO,XU;function aje(){if(XU)return FO;XU=1;var e=tD(),t=eje(),n=tje(),r=oD(),a=rje(),o=Sx(),i=200;function s(c,l,u){var d=-1,f=t,p=c.length,m=!0,y=[],v=y;if(u)m=!1,f=n;else if(p>=i){var b=l?null:a(c);if(b)return o(b);m=!1,f=r,v=new e}else v=l?[]:y;e:for(;++d<p;){var w=c[d],_=l?l(w):w;if(w=u||w!==0?w:0,m&&_===_){for(var x=v.length;x--;)if(v[x]===_)continue e;l&&v.push(_),y.push(w)}else f(v,_,u)||(v!==y&&v.push(_),y.push(w))}return y}return FO=s,FO}var BO,YU;function oje(){if(YU)return BO;YU=1;var e=Wa(),t=aje();function n(r,a){return r&&r.length?t(r,e(a,2)):[]}return BO=n,BO}var ije=oje();const JU=ft(ije);function QU(e,t,n){return t===!0?JU(e,n):lt(t)?JU(e,t):e}function _l(e){"@babel/helpers - typeof";return _l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_l(e)}var sje=["ref"];function GU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Xo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GU(Object(n),!0).forEach(function(r){rg(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function cje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nV(r.key),r)}}function lje(e,t,n){return t&&eV(e.prototype,t),n&&eV(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function uje(e,t,n){return t=ng(t),dje(e,tV()?Reflect.construct(t,n||[],ng(e).constructor):t.apply(e,n))}function dje(e,t){if(t&&(_l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fje(e)}function fje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tV=function(){return!!e})()}function ng(e){return ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ng(e)}function pje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},zO(e,t)}function rg(e,t,n){return t=nV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nV(e){var t=hje(e,"string");return _l(t)=="symbol"?t:t+""}function hje(e,t){if(_l(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_l(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mje(e,t){if(e==null)return{};var n=yje(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function yje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function gje(e){return e.value}function vje(e,t){if(Y.isValidElement(e))return Y.cloneElement(e,t);if(typeof e=="function")return Y.createElement(e,t);t.ref;var n=mje(t,sje);return Y.createElement(NO,n)}var rV=1,Sl=function(e){function t(){var n;cje(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=uje(this,t,[].concat(a)),rg(n,"lastBoundingBox",{width:-1,height:-1}),n}return pje(t,e),lje(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,r=this.getBBox();r?(Math.abs(r.width-this.lastBoundingBox.width)>rV||Math.abs(r.height-this.lastBoundingBox.height)>rV)&&(this.lastBoundingBox.width=r.width,this.lastBoundingBox.height=r.height,n&&n(r)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Xo({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var r=this.props,a=r.layout,o=r.align,i=r.verticalAlign,s=r.margin,c=r.chartWidth,l=r.chartHeight,u,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&a==="vertical"){var f=this.getBBoxSnapshot();u={left:((c||0)-f.width)/2}}else u=o==="right"?{right:s&&s.right||0}:{left:s&&s.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var p=this.getBBoxSnapshot();d={top:((l||0)-p.height)/2}}else d=i==="bottom"?{bottom:s&&s.bottom||0}:{top:s&&s.top||0};return Xo(Xo({},u),d)}},{key:"render",value:function(){var n=this,r=this.props,a=r.content,o=r.width,i=r.height,s=r.wrapperStyle,c=r.payloadUniqBy,l=r.payload,u=Xo(Xo({position:"absolute",width:o||"auto",height:i||"auto"},this.getDefaultPosition(s)),s);return Y.createElement("div",{className:"recharts-legend-wrapper",style:u,ref:function(d){n.wrapperNode=d}},vje(a,Xo(Xo({},this.props),{},{payload:QU(l,c,gje)})))}}],[{key:"getWithHeight",value:function(n,r){var a=Xo(Xo({},this.defaultProps),n.props),o=a.layout;return o==="vertical"&&we(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||r}:null}}])}(g.PureComponent);rg(Sl,"displayName","Legend"),rg(Sl,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var UO,aV;function bje(){if(aV)return UO;aV=1;var e=Js(),t=wp(),n=qn(),r=e?e.isConcatSpreadable:void 0;function a(o){return n(o)||t(o)||!!(r&&o&&o[r])}return UO=a,UO}var VO,oV;Pv=function(){if(oV)return VO;oV=1;var e=Ox(),t=bje();function n(r,a,o,i,s){var c=-1,l=r.length;for(o||(o=t),s||(s=[]);++c<l;){var u=r[c];a>0&&o(u)?a>1?n(u,a-1,o,i,s):e(s,u):i||(s[s.length]=u)}return s}return VO=n,VO};var WO,iV;function wje(){if(iV)return WO;iV=1;function e(t){return function(n,r,a){for(var o=-1,i=Object(n),s=a(n),c=s.length;c--;){var l=s[t?c:++o];if(r(i[l],l,i)===!1)break}return n}}return WO=e,WO}var HO,sV;nN=function(){if(sV)return HO;sV=1;var e=wje(),t=e();return HO=t,HO};var qO,cV;function lV(){if(cV)return qO;cV=1;var e=nN(),t=gu();function n(r,a){return r&&e(r,a,t)}return qO=n,qO}var ZO,uV;function xje(){if(uV)return ZO;uV=1;var e=Zi();function t(n,r){return function(a,o){if(a==null)return a;if(!e(a))return n(a,o);for(var i=a.length,s=r?i:-1,c=Object(a);(r?s--:++s<i)&&o(c[s],s,c)!==!1;);return a}}return ZO=t,ZO}var KO,dV;function XO(){if(dV)return KO;dV=1;var e=lV(),t=xje(),n=t(e);return KO=n,KO}var YO,fV;function pV(){if(fV)return YO;fV=1;var e=XO(),t=Zi();function n(r,a){var o=-1,i=t(r)?Array(r.length):[];return e(r,function(s,c,l){i[++o]=a(s,c,l)}),i}return YO=n,YO}var JO,hV;function _je(){if(hV)return JO;hV=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return JO=e,JO}var QO,mV;function Sje(){if(mV)return QO;mV=1;var e=bc();function t(n,r){if(n!==r){var a=n!==void 0,o=n===null,i=n===n,s=e(n),c=r!==void 0,l=r===null,u=r===r,d=e(r);if(!l&&!d&&!s&&n>r||s&&c&&u&&!l&&!d||o&&c&&u||!a&&u||!i)return 1;if(!o&&!s&&!d&&n<r||d&&a&&i&&!o&&!s||l&&a&&i||!c&&i||!u)return-1}return 0}return QO=t,QO}var GO,yV;function jje(){if(yV)return GO;yV=1;var e=Sje();function t(n,r,a){for(var o=-1,i=n.criteria,s=r.criteria,c=i.length,l=a.length;++o<c;){var u=e(i[o],s[o]);if(u){if(o>=l)return u;var d=a[o];return u*(d=="desc"?-1:1)}}return n.index-r.index}return GO=t,GO}var eC,gV;function Eje(){if(gV)return eC;gV=1;var e=du(),t=wu(),n=Wa(),r=pV(),a=_je(),o=C0(),i=jje(),s=wc(),c=qn();function l(u,d,f){d.length?d=e(d,function(y){return c(y)?function(v){return t(v,y.length===1?y[0]:y)}:y}):d=[s];var p=-1;d=e(d,o(n));var m=r(u,function(y,v,b){var w=e(d,function(_){return _(y)});return{criteria:w,index:++p,value:y}});return a(m,function(y,v){return i(y,v,f)})}return eC=l,eC}var tC,vV;uN=function(){if(vV)return tC;vV=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return tC=e,tC};var nC,bV;tN=function(){if(bV)return nC;bV=1;var e=uN(),t=Math.max;function n(r,a,o){return a=t(a===void 0?r.length-1:a,0),function(){for(var i=arguments,s=-1,c=t(i.length-a,0),l=Array(c);++s<c;)l[s]=i[a+s];s=-1;for(var u=Array(a+1);++s<a;)u[s]=i[s];return u[a]=o(l),e(r,this,u)}}return nC=n,nC};var rC,wV;function Oje(){if(wV)return rC;wV=1;function e(t){return function(){return t}}return rC=e,rC}var aC,xV;function Cje(){if(xV)return aC;xV=1;var e=Oje(),t=N4(),n=wc(),r=t?function(a,o){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:n;return aC=r,aC}var oC,_V;function kje(){if(_V)return oC;_V=1;var e=800,t=16,n=Date.now;function r(a){var o=0,i=0;return function(){var s=n(),c=t-(s-i);if(i=s,c>0){if(++o>=e)return arguments[0]}else o=0;return a.apply(void 0,arguments)}}return oC=r,oC}var iC,SV;eN=function(){if(SV)return iC;SV=1;var e=Cje(),t=kje(),n=t(e);return iC=n,iC};var sC,jV;rN=function(){if(jV)return sC;jV=1;var e=wc(),t=tN(),n=eN();function r(a,o){return n(t(a,o,e),a+"")}return sC=r,sC};var cC,EV;function Pje(){if(EV)return cC;EV=1;var e=Pv(),t=Eje(),n=rN(),r=qs(),a=n(function(o,i){if(o==null)return[];var s=i.length;return s>1&&r(o,i[0],i[1])?i=[]:s>2&&r(i[0],i[1],i[2])&&(i=[i[0]]),t(o,e(i,1),[])});return cC=a,cC}var Nje=Pje();const lC=ft(Nje);function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function uC(){return uC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uC.apply(this,arguments)}function Mje(e,t){return Ije(e)||Rje(e,t)||Tje(e,t)||Aje()}function Aje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tje(e,t){if(e){if(typeof e=="string")return OV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return OV(e,t)}}function OV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rje(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function Ije(e){if(Array.isArray(e))return e}function CV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function dC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CV(Object(n),!0).forEach(function(r){Dje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Dje(e,t,n){return t=Lje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lje(e){var t=$je(e,"string");return bf(t)=="symbol"?t:t+""}function $je(e,t){if(bf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fje(e){return Array.isArray(e)&&yn(e[0])&&yn(e[1])?e.join(" ~ "):e}var Bje=function(e){var t=e.separator,n=t===void 0?" : ":t,r=e.contentStyle,a=r===void 0?{}:r,o=e.itemStyle,i=o===void 0?{}:o,s=e.labelStyle,c=s===void 0?{}:s,l=e.payload,u=e.formatter,d=e.itemSorter,f=e.wrapperClassName,p=e.labelClassName,m=e.label,y=e.labelFormatter,v=e.accessibilityLayer,b=v===void 0?!1:v,w=function(){if(l&&l.length){var k={padding:0,margin:0},N=(d?lC(l,d):l).map(function(R,M){if(R.type==="none")return null;var C=dC({display:"block",paddingTop:4,paddingBottom:4,color:R.color||"#000"},i),T=R.formatter||u||Fje,A=R.value,I=R.name,F=A,D=I;if(T&&F!=null&&D!=null){var V=T(A,I,R,M,l);if(Array.isArray(V)){var U=Mje(V,2);F=U[0],D=U[1]}else F=V}return Y.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(M),style:C},yn(D)?Y.createElement("span",{className:"recharts-tooltip-item-name"},D):null,yn(D)?Y.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Y.createElement("span",{className:"recharts-tooltip-item-value"},F),Y.createElement("span",{className:"recharts-tooltip-item-unit"},R.unit||""))});return Y.createElement("ul",{className:"recharts-tooltip-item-list",style:k},N)}return null},_=dC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),x=dC({margin:0},c),S=!Ot(m),j=S?m:"",E=Pt("recharts-default-tooltip",f),O=Pt("recharts-tooltip-label",p);S&&y&&l!==void 0&&l!==null&&(j=y(m,l));var P=b?{role:"status","aria-live":"assertive"}:{};return Y.createElement("div",uC({className:E,style:_},P),Y.createElement("p",{className:O,style:x},Y.isValidElement(j)?j:"".concat(j)),w())};function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}function ag(e,t,n){return t=zje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zje(e){var t=Uje(e,"string");return wf(t)=="symbol"?t:t+""}function Uje(e,t){if(wf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xf="recharts-tooltip-wrapper",Vje={visibility:"hidden"};function Wje(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return Pt(xf,ag(ag(ag(ag({},"".concat(xf,"-right"),we(n)&&t&&we(t.x)&&n>=t.x),"".concat(xf,"-left"),we(n)&&t&&we(t.x)&&n<t.x),"".concat(xf,"-bottom"),we(r)&&t&&we(t.y)&&r>=t.y),"".concat(xf,"-top"),we(r)&&t&&we(t.y)&&r<t.y))}function kV(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,a=e.offsetTopLeft,o=e.position,i=e.reverseDirection,s=e.tooltipDimension,c=e.viewBox,l=e.viewBoxDimension;if(o&&we(o[r]))return o[r];var u=n[r]-s-a,d=n[r]+a;if(t[r])return i[r]?u:d;if(i[r]){var f=u,p=c[r];return f<p?Math.max(d,c[r]):Math.max(u,c[r])}var m=d+s,y=c[r]+l;return m>y?Math.max(u,c[r]):Math.max(d,c[r])}function Hje(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function qje(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,a=e.position,o=e.reverseDirection,i=e.tooltipBox,s=e.useTranslate3d,c=e.viewBox,l,u,d;return i.height>0&&i.width>0&&n?(u=kV({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),d=kV({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),l=Hje({translateX:u,translateY:d,useTranslate3d:s})):l=Vje,{cssProperties:l,cssClasses:Wje({translateX:u,translateY:d,coordinate:n})}}function jl(e){"@babel/helpers - typeof";return jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jl(e)}function PV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function NV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?PV(Object(n),!0).forEach(function(r){pC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Zje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kje(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,AV(r.key),r)}}function Xje(e,t,n){return t&&Kje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yje(e,t,n){return t=og(t),Jje(e,MV()?Reflect.construct(t,n||[],og(e).constructor):t.apply(e,n))}function Jje(e,t){if(t&&(jl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qje(e)}function Qje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MV=function(){return!!e})()}function og(e){return og=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},og(e)}function Gje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fC(e,t)}function fC(e,t){return fC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},fC(e,t)}function pC(e,t,n){return t=AV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AV(e){var t=eEe(e,"string");return jl(t)=="symbol"?t:t+""}function eEe(e,t){if(jl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(jl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TV=1,tEe=function(e){function t(){var n;Zje(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=Yje(this,t,[].concat(a)),pC(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),pC(n,"handleKeyDown",function(i){if(i.key==="Escape"){var s,c,l,u;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&s!==void 0?s:0,y:(l=(u=n.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0}})}}),n}return Gje(t,e),Xje(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>TV||Math.abs(n.height-this.state.lastBoundingBox.height)>TV)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,r;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.children,l=r.coordinate,u=r.hasPayload,d=r.isAnimationActive,f=r.offset,p=r.position,m=r.reverseDirection,y=r.useTranslate3d,v=r.viewBox,b=r.wrapperStyle,w=qje({allowEscapeViewBox:o,coordinate:l,offsetTopLeft:f,position:p,reverseDirection:m,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:v}),_=w.cssClasses,x=w.cssProperties,S=NV(NV({transition:d&&a?"transform ".concat(i,"ms ").concat(s):void 0},x),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&u?"visible":"hidden",position:"absolute",top:0,left:0},b);return Y.createElement("div",{tabIndex:-1,className:_,style:S,ref:function(j){n.wrapperNode=j}},c)}}])}(g.PureComponent),nEe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Li={isSsr:nEe(),get:function(e){return Li[e]},set:function(e,t){if(typeof e=="string")Li[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(r){Li[r]=e[r]})}}};function El(e){"@babel/helpers - typeof";return El=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},El(e)}function RV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function IV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RV(Object(n),!0).forEach(function(r){mC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function rEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aEe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,LV(r.key),r)}}function oEe(e,t,n){return t&&aEe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iEe(e,t,n){return t=ig(t),sEe(e,DV()?Reflect.construct(t,n||[],ig(e).constructor):t.apply(e,n))}function sEe(e,t){if(t&&(El(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cEe(e)}function cEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DV=function(){return!!e})()}function ig(e){return ig=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ig(e)}function lEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hC(e,t)}function hC(e,t){return hC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},hC(e,t)}function mC(e,t,n){return t=LV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LV(e){var t=uEe(e,"string");return El(t)=="symbol"?t:t+""}function uEe(e,t){if(El(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(El(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dEe(e){return e.dataKey}function fEe(e,t){return Y.isValidElement(e)?Y.cloneElement(e,t):typeof e=="function"?Y.createElement(e,t):Y.createElement(Bje,t)}var no=function(e){function t(){return rEe(this,t),iEe(this,t,arguments)}return lEe(t,e),oEe(t,[{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.content,l=r.coordinate,u=r.filterNull,d=r.isAnimationActive,f=r.offset,p=r.payload,m=r.payloadUniqBy,y=r.position,v=r.reverseDirection,b=r.useTranslate3d,w=r.viewBox,_=r.wrapperStyle,x=p??[];u&&x.length&&(x=QU(p.filter(function(j){return j.value!=null&&(j.hide!==!0||n.props.includeHidden)}),m,dEe));var S=x.length>0;return Y.createElement(tEe,{allowEscapeViewBox:o,animationDuration:i,animationEasing:s,isAnimationActive:d,active:a,coordinate:l,hasPayload:S,offset:f,position:y,reverseDirection:v,useTranslate3d:b,viewBox:w,wrapperStyle:_},fEe(c,IV(IV({},this.props),{},{payload:x})))}}])}(g.PureComponent);mC(no,"displayName","Tooltip"),mC(no,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Li.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var yC,$V;function pEe(){if($V)return yC;$V=1;var e=Kr(),t=function(){return e.Date.now()};return yC=t,yC}var gC,FV;sN=function(){if(FV)return gC;FV=1;var e=Xr(),t=pEe(),n=vB(),r="Expected a function",a=Math.max,o=Math.min;function i(s,c,l){var u,d,f,p,m,y,v=0,b=!1,w=!1,_=!0;if(typeof s!="function")throw new TypeError(r);c=n(c)||0,e(l)&&(b=!!l.leading,w="maxWait"in l,f=w?a(n(l.maxWait)||0,c):f,_="trailing"in l?!!l.trailing:_);function x(M){var C=u,T=d;return u=d=void 0,v=M,p=s.apply(T,C),p}function S(M){return v=M,m=setTimeout(O,c),b?x(M):p}function j(M){var C=M-y,T=M-v,A=c-C;return w?o(A,f-T):A}function E(M){var C=M-y,T=M-v;return y===void 0||C>=c||C<0||w&&T>=f}function O(){var M=t();if(E(M))return P(M);m=setTimeout(O,j(M))}function P(M){return m=void 0,_&&u?x(M):(u=d=void 0,p)}function k(){m!==void 0&&clearTimeout(m),v=0,u=y=d=m=void 0}function N(){return m===void 0?p:P(t())}function R(){var M=t(),C=E(M);if(u=arguments,d=this,y=M,C){if(m===void 0)return S(y);if(w)return clearTimeout(m),m=setTimeout(O,c),x(y)}return m===void 0&&(m=setTimeout(O,c)),p}return R.cancel=k,R.flush=N,R}return gC=i,gC};var vC,BV;function hEe(){if(BV)return vC;BV=1;var e=sN(),t=Xr(),n="Expected a function";function r(a,o,i){var s=!0,c=!0;if(typeof a!="function")throw new TypeError(n);return t(i)&&(s="leading"in i?!!i.leading:s,c="trailing"in i?!!i.trailing:c),e(a,o,{leading:s,maxWait:o,trailing:c})}return vC=r,vC}var mEe=hEe();Av=ft(mEe);function _f(e){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_f(e)}function zV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function sg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zV(Object(n),!0).forEach(function(r){yEe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yEe(e,t,n){return t=gEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gEe(e){var t=vEe(e,"string");return _f(t)=="symbol"?t:t+""}function vEe(e,t){if(_f(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_f(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bEe(e,t){return SEe(e)||_Ee(e,t)||xEe(e,t)||wEe()}function wEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xEe(e,t){if(e){if(typeof e=="string")return UV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UV(e,t)}}function UV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _Ee(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function SEe(e){if(Array.isArray(e))return e}var jEe=g.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,a=r===void 0?{width:-1,height:-1}:r,o=e.width,i=o===void 0?"100%":o,s=e.height,c=s===void 0?"100%":s,l=e.minWidth,u=l===void 0?0:l,d=e.minHeight,f=e.maxHeight,p=e.children,m=e.debounce,y=m===void 0?0:m,v=e.id,b=e.className,w=e.onResize,_=e.style,x=_===void 0?{}:_,S=g.useRef(null),j=g.useRef();j.current=w,g.useImperativeHandle(t,function(){return Object.defineProperty(S.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),S.current},configurable:!0})});var E=g.useState({containerWidth:a.width,containerHeight:a.height}),O=bEe(E,2),P=O[0],k=O[1],N=g.useCallback(function(M,C){k(function(T){var A=Math.round(M),I=Math.round(C);return T.containerWidth===A&&T.containerHeight===I?T:{containerWidth:A,containerHeight:I}})},[]);g.useEffect(function(){var M=function(F){var D,V=F[0].contentRect,U=V.width,B=V.height;N(U,B),(D=j.current)===null||D===void 0||D.call(j,U,B)};y>0&&(M=Av(M,y,{trailing:!0,leading:!1}));var C=new ResizeObserver(M),T=S.current.getBoundingClientRect(),A=T.width,I=T.height;return N(A,I),C.observe(S.current),function(){C.disconnect()}},[N,y]);var R=g.useMemo(function(){var M=P.containerWidth,C=P.containerHeight;if(M<0||C<0)return null;Ko(Os(i)||Os(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),Ko(!n||n>0,"The aspect(%s) must be greater than zero.",n);var T=Os(i)?M:i,A=Os(c)?C:c;n&&n>0&&(T?A=T/n:A&&(T=A*n),f&&A>f&&(A=f)),Ko(T>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,T,A,i,c,u,d,n);var I=!Array.isArray(p)&&Zo(p.type).endsWith("Chart");return Y.Children.map(p,function(F){return Y.isValidElement(F)?g.cloneElement(F,sg({width:T,height:A},I?{style:sg({height:"100%",width:"100%",maxHeight:A,maxWidth:T},F.props.style)}:{})):F})},[n,p,c,f,d,u,P,i]);return Y.createElement("div",{id:v?"".concat(v):void 0,className:Pt("recharts-responsive-container",b),style:sg(sg({},x),{},{width:i,height:c,minWidth:u,minHeight:d,maxHeight:f}),ref:S},R)}),VV=function(e){return null};VV.displayName="Cell";function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function WV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function bC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WV(Object(n),!0).forEach(function(r){EEe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function EEe(e,t,n){return t=OEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OEe(e){var t=CEe(e,"string");return Sf(t)=="symbol"?t:t+""}function CEe(e,t){if(Sf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Sf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ol={widthCache:{},cacheCount:0},kEe=2e3,PEe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},HV="recharts_measurement_span";function NEe(e){var t=bC({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var jf=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Li.isSsr)return{width:0,height:0};var n=NEe(t),r=JSON.stringify({text:e,copyStyle:n});if(Ol.widthCache[r])return Ol.widthCache[r];try{var a=document.getElementById(HV);a||(a=document.createElement("span"),a.setAttribute("id",HV),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=bC(bC({},PEe),n);Object.assign(a.style,o),a.textContent="".concat(e);var i=a.getBoundingClientRect(),s={width:i.width,height:i.height};return Ol.widthCache[r]=s,++Ol.cacheCount>kEe&&(Ol.cacheCount=0,Ol.widthCache={}),s}catch{return{width:0,height:0}}},MEe=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function Ef(e){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ef(e)}function cg(e,t){return IEe(e)||REe(e,t)||TEe(e,t)||AEe()}function AEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TEe(e,t){if(e){if(typeof e=="string")return qV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qV(e,t)}}function qV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function REe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function IEe(e){if(Array.isArray(e))return e}function DEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$Ee(r.key),r)}}function LEe(e,t,n){return t&&ZV(e.prototype,t),n&&ZV(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ee(e){var t=FEe(e,"string");return Ef(t)=="symbol"?t:t+""}function FEe(e,t){if(Ef(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Ef(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var KV=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,XV=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,BEe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,zEe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,YV={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},UEe=Object.keys(YV),Cl="NaN";function VEe(e,t){return e*YV[t]}var lg=function(){function e(t,n){DEe(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!BEe.test(n)&&(this.num=NaN,this.unit=""),UEe.includes(n)&&(this.num=VEe(t,n),this.unit="px")}return LEe(e,[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(t){var n,r=(n=zEe.exec(t))!==null&&n!==void 0?n:[],a=cg(r,3),o=a[1],i=a[2];return new e(parseFloat(o),i??"")}}])}();function JV(e){if(e.includes(Cl))return Cl;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=KV.exec(t))!==null&&n!==void 0?n:[],a=cg(r,4),o=a[1],i=a[2],s=a[3],c=lg.parse(o??""),l=lg.parse(s??""),u=i==="*"?c.multiply(l):c.divide(l);if(u.isNaN())return Cl;t=t.replace(KV,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,f=(d=XV.exec(t))!==null&&d!==void 0?d:[],p=cg(f,4),m=p[1],y=p[2],v=p[3],b=lg.parse(m??""),w=lg.parse(v??""),_=y==="+"?b.add(w):b.subtract(w);if(_.isNaN())return Cl;t=t.replace(XV,_.toString())}return t}var QV=/\(([^()]*)\)/;function WEe(e){for(var t=e;t.includes("(");){var n=QV.exec(t),r=cg(n,2),a=r[1];t=t.replace(QV,JV(a))}return t}function HEe(e){var t=e.replace(/\s+/g,"");return t=WEe(t),t=JV(t),t}function qEe(e){try{return HEe(e)}catch{return Cl}}function wC(e){var t=qEe(e.slice(5,-1));return t===Cl?"":t}var ZEe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],KEe=["dx","dy","angle","className","breakAll"];function xC(){return xC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xC.apply(this,arguments)}function GV(e,t){if(e==null)return{};var n=XEe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function XEe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function eW(e,t){return GEe(e)||QEe(e,t)||JEe(e,t)||YEe()}function YEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JEe(e,t){if(e){if(typeof e=="string")return tW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tW(e,t)}}function tW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function QEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function GEe(e){if(Array.isArray(e))return e}var nW=/[ \f\n\r\t\v\u2028\u2029]+/,rW=function(e){var t=e.children,n=e.breakAll,r=e.style;try{var a=[];Ot(t)||(n?a=t.toString().split(""):a=t.toString().split(nW));var o=a.map(function(s){return{word:s,width:jf(s,r).width}}),i=n?0:jf("\xA0",r).width;return{wordsWithComputedWidth:o,spaceWidth:i}}catch{return null}},eOe=function(e,t,n,r,a){var o=e.maxLines,i=e.children,s=e.style,c=e.breakAll,l=we(o),u=i,d=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return M.reduce(function(C,T){var A=T.word,I=T.width,F=C[C.length-1];if(F&&(r==null||a||F.width+I+n<Number(r)))F.words.push(A),F.width+=I+n;else{var D={words:[A],width:I};C.push(D)}return C},[])},f=d(t),p=function(M){return M.reduce(function(C,T){return C.width>T.width?C:T})};if(!l)return f;for(var m="\u2026",y=function(M){var C=u.slice(0,M),T=rW({breakAll:c,style:s,children:C+m}).wordsWithComputedWidth,A=d(T),I=A.length>o||p(A).width>Number(r);return[I,A]},v=0,b=u.length-1,w=0,_;v<=b&&w<=u.length-1;){var x=Math.floor((v+b)/2),S=x-1,j=y(S),E=eW(j,2),O=E[0],P=E[1],k=y(x),N=eW(k,1),R=N[0];if(!O&&!R&&(v=x+1),O&&R&&(b=x-1),!O&&R){_=P;break}w++}return _||f},aW=function(e){var t=Ot(e)?[]:e.toString().split(nW);return[{words:t}]},tOe=function(e){var t=e.width,n=e.scaleToFit,r=e.children,a=e.style,o=e.breakAll,i=e.maxLines;if((t||n)&&!Li.isSsr){var s,c,l=rW({breakAll:o,children:r,style:a});if(l){var u=l.wordsWithComputedWidth,d=l.spaceWidth;s=u,c=d}else return aW(r);return eOe({breakAll:o,children:r,maxLines:i,style:a},s,c,t,n)}return aW(r)},oW="#808080",ug=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.lineHeight,i=o===void 0?"1em":o,s=e.capHeight,c=s===void 0?"0.71em":s,l=e.scaleToFit,u=l===void 0?!1:l,d=e.textAnchor,f=d===void 0?"start":d,p=e.verticalAnchor,m=p===void 0?"end":p,y=e.fill,v=y===void 0?oW:y,b=GV(e,ZEe),w=g.useMemo(function(){return tOe({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:u,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,u,b.style,b.width]),_=b.dx,x=b.dy,S=b.angle,j=b.className,E=b.breakAll,O=GV(b,KEe);if(!yn(n)||!yn(a))return null;var P=n+(we(_)?_:0),k=a+(we(x)?x:0),N;switch(m){case"start":N=wC("calc(".concat(c,")"));break;case"middle":N=wC("calc(".concat((w.length-1)/2," * -").concat(i," + (").concat(c," / 2))"));break;default:N=wC("calc(".concat(w.length-1," * -").concat(i,")"));break}var R=[];if(u){var M=w[0].width,C=b.width;R.push("scale(".concat((we(C)?C/M:1)/M,")"))}return S&&R.push("rotate(".concat(S,", ").concat(P,", ").concat(k,")")),R.length&&(O.transform=R.join(" ")),Y.createElement("text",xC({},Et(O,!0),{x:P,y:k,className:Pt("recharts-text",j),textAnchor:f,fill:v.includes("url")?oW:v}),w.map(function(T,A){var I=T.words.join(E?"":" ");return Y.createElement("tspan",{x:P,dy:A===0?N:i,key:"".concat(I,"-").concat(A)},I)}))};function $i(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function nOe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _C(e){let t,n,r;e.length!==2?(t=$i,n=(s,c)=>$i(e(s),c),r=(s,c)=>e(s)-c):(t=e===$i||e===nOe?e:rOe,n=e,r=e);function a(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<0?l=d+1:u=d}while(l<u)}return l}function o(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<=0?l=d+1:u=d}while(l<u)}return l}function i(s,c,l=0,u=s.length){const d=a(s,c,l,u-1);return d>l&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:a,center:i,right:o}}function rOe(){return 0}function iW(e){return e===null?NaN:+e}function*aOe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const oOe=_C($i),Of=oOe.right;_C(iW).center;class sW extends Map{constructor(t,n=cOe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,a]of t)this.set(r,a)}get(t){return super.get(cW(this,t))}has(t){return super.has(cW(this,t))}set(t,n){return super.set(iOe(this,t),n)}delete(t){return super.delete(sOe(this,t))}}function cW({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function iOe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function sOe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function cOe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function lOe(e=$i){if(e===$i)return lW;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function lW(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const uOe=Math.sqrt(50),dOe=Math.sqrt(10),fOe=Math.sqrt(2);function dg(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),o=r/Math.pow(10,a),i=o>=uOe?10:o>=dOe?5:o>=fOe?2:1;let s,c,l;return a<0?(l=Math.pow(10,-a)/i,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=Math.pow(10,a)*i,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?dg(e,t,n*2):[s,c,l]}function SC(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,o,i]=r?dg(t,e,n):dg(e,t,n);if(!(o>=a))return[];const s=o-a+1,c=new Array(s);if(r)if(i<0)for(let l=0;l<s;++l)c[l]=(o-l)/-i;else for(let l=0;l<s;++l)c[l]=(o-l)*i;else if(i<0)for(let l=0;l<s;++l)c[l]=(a+l)/-i;else for(let l=0;l<s;++l)c[l]=(a+l)*i;return c}function jC(e,t,n){return t=+t,e=+e,n=+n,dg(e,t,n)[2]}function EC(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?jC(t,e,n):jC(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function uW(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function dW(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function fW(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=a===void 0?lW:lOe(a);r>n;){if(r-n>600){const c=r-n+1,l=t-n+1,u=Math.log(c),d=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*d*(c-d)/c)*(l-c/2<0?-1:1),p=Math.max(n,Math.floor(t-l*d/c+f)),m=Math.min(r,Math.floor(t+(c-l)*d/c+f));fW(e,t,p,m,a)}const o=e[t];let i=n,s=r;for(Cf(e,n,t),a(e[r],o)>0&&Cf(e,n,r);i<s;){for(Cf(e,i,s),++i,--s;a(e[i],o)<0;)++i;for(;a(e[s],o)>0;)--s}a(e[n],o)===0?Cf(e,n,s):(++s,Cf(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Cf(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function pOe(e,t,n){if(e=Float64Array.from(aOe(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return dW(e);if(t>=1)return uW(e);var r,a=(r-1)*t,o=Math.floor(a),i=uW(fW(e,o).subarray(0,o+1)),s=dW(e.subarray(o+1));return i+(s-i)*(a-o)}}function hOe(e,t,n=iW){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,o=Math.floor(a),i=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return i+(s-i)*(a-o)}}function mOe(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(a);++r<a;)o[r]=e+r*n;return o}function $r(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Yo(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const OC=Symbol("implicit");function CC(){var e=new sW,t=[],n=[],r=OC;function a(o){let i=e.get(o);if(i===void 0){if(r!==OC)return r;e.set(o,i=t.push(o)-1)}return n[i%n.length]}return a.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new sW;for(const i of o)e.has(i)||e.set(i,t.push(i)-1);return a},a.range=function(o){return arguments.length?(n=Array.from(o),a):n.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return CC(t,n).unknown(r)},$r.apply(a,arguments),a}function kf(){var e=CC().unknown(void 0),t=e.domain,n=e.range,r=0,a=1,o,i,s=!1,c=0,l=0,u=.5;delete e.unknown;function d(){var f=t().length,p=a<r,m=p?a:r,y=p?r:a;o=(y-m)/Math.max(1,f-c+l*2),s&&(o=Math.floor(o)),m+=(y-m-o*(f-c))*u,i=o*(1-c),s&&(m=Math.round(m),i=Math.round(i));var v=mOe(f).map(function(b){return m+o*b});return n(p?v.reverse():v)}return e.domain=function(f){return arguments.length?(t(f),d()):t()},e.range=function(f){return arguments.length?([r,a]=f,r=+r,a=+a,d()):[r,a]},e.rangeRound=function(f){return[r,a]=f,r=+r,a=+a,s=!0,d()},e.bandwidth=function(){return i},e.step=function(){return o},e.round=function(f){return arguments.length?(s=!!f,d()):s},e.padding=function(f){return arguments.length?(c=Math.min(1,l=+f),d()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),d()):c},e.paddingOuter=function(f){return arguments.length?(l=+f,d()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),d()):u},e.copy=function(){return kf(t(),[r,a]).round(s).paddingInner(c).paddingOuter(l).align(u)},$r.apply(d(),arguments)}function pW(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return pW(t())},e}function Pf(){return pW(kf.apply(null,arguments).paddingInner(1))}function yOe(e){return function(){return e}}function fg(e){return+e}var hW=[0,1];function Gn(e){return e}function kC(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:yOe(isNaN(t)?NaN:.5)}function gOe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function vOe(e,t,n){var r=e[0],a=e[1],o=t[0],i=t[1];return a<r?(r=kC(a,r),o=n(i,o)):(r=kC(r,a),o=n(o,i)),function(s){return o(r(s))}}function bOe(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),o=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)a[i]=kC(e[i],e[i+1]),o[i]=n(t[i],t[i+1]);return function(s){var c=Of(e,s,1,r)-1;return o[c](a[c](s))}}function Nf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function pg(){var e=hW,t=hW,n=jc,r,a,o,i=Gn,s,c,l;function u(){var f=Math.min(e.length,t.length);return i!==Gn&&(i=gOe(e[0],e[f-1])),s=f>2?bOe:vOe,c=l=null,d}function d(f){return f==null||isNaN(f=+f)?o:(c||(c=s(e.map(r),t,n)))(r(i(f)))}return d.invert=function(f){return i(a((l||(l=s(t,e.map(r),ia)))(f)))},d.domain=function(f){return arguments.length?(e=Array.from(f,fg),u()):e.slice()},d.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},d.rangeRound=function(f){return t=Array.from(f),n=o_,u()},d.clamp=function(f){return arguments.length?(i=f?!0:Gn,u()):i!==Gn},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(o=f,d):o},function(f,p){return r=f,a=p,u()}}function PC(){return pg()(Gn,Gn)}function wOe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function hg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function kl(e){return e=hg(Math.abs(e)),e?e[1]:NaN}function xOe(e,t){return function(n,r){for(var a=n.length,o=[],i=0,s=e[0],c=0;a>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(n.substring(a-=s,a+s)),!((c+=s+1)>r));)s=e[i=(i+1)%e.length];return o.reverse().join(t)}}function _Oe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var SOe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Mf(e){if(!(t=SOe.exec(e)))throw new Error("invalid format: "+e);var t;return new NC({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Mf.prototype=NC.prototype;function NC(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}NC.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function jOe(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var mW;function EOe(e,t){var n=hg(e,t);if(!n)return e+"";var r=n[0],a=n[1],o=a-(mW=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+hg(e,Math.max(0,t+o-1))[0]}function yW(e,t){var n=hg(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const gW={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:wOe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>yW(e*100,t),r:yW,s:EOe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function vW(e){return e}var bW=Array.prototype.map,wW=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function OOe(e){var t=e.grouping===void 0||e.thousands===void 0?vW:xOe(bW.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?vW:_Oe(bW.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(d){d=Mf(d);var f=d.fill,p=d.align,m=d.sign,y=d.symbol,v=d.zero,b=d.width,w=d.comma,_=d.precision,x=d.trim,S=d.type;S==="n"?(w=!0,S="g"):gW[S]||(_===void 0&&(_=12),x=!0,S="g"),(v||f==="0"&&p==="=")&&(v=!0,f="0",p="=");var j=y==="$"?n:y==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",E=y==="$"?r:/[%p]/.test(S)?i:"",O=gW[S],P=/[defgprs%]/.test(S);_=_===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function k(N){var R=j,M=E,C,T,A;if(S==="c")M=O(N)+M,N="";else{N=+N;var I=N<0||1/N<0;if(N=isNaN(N)?c:O(Math.abs(N),_),x&&(N=jOe(N)),I&&+N==0&&m!=="+"&&(I=!1),R=(I?m==="("?m:s:m==="-"||m==="("?"":m)+R,M=(S==="s"?wW[8+mW/3]:"")+M+(I&&m==="("?")":""),P){for(C=-1,T=N.length;++C<T;)if(A=N.charCodeAt(C),48>A||A>57){M=(A===46?a+N.slice(C+1):N.slice(C))+M,N=N.slice(0,C);break}}}w&&!v&&(N=t(N,1/0));var F=R.length+N.length+M.length,D=F<b?new Array(b-F+1).join(f):"";switch(w&&v&&(N=t(D+N,D.length?b-M.length:1/0),D=""),p){case"<":N=R+N+M+D;break;case"=":N=R+D+N+M;break;case"^":N=D.slice(0,F=D.length>>1)+R+N+M+D.slice(F);break;default:N=D+R+N+M;break}return o(N)}return k.toString=function(){return d+""},k}function u(d,f){var p=l((d=Mf(d),d.type="f",d)),m=Math.max(-8,Math.min(8,Math.floor(kl(f)/3)))*3,y=Math.pow(10,-m),v=wW[8+m/3];return function(b){return p(y*b)+v}}return{format:l,formatPrefix:u}}var mg,MC,xW;COe({thousands:",",grouping:[3],currency:["$",""]});function COe(e){return mg=OOe(e),MC=mg.format,xW=mg.formatPrefix,mg}function kOe(e){return Math.max(0,-kl(Math.abs(e)))}function POe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(kl(t)/3)))*3-kl(Math.abs(e)))}function NOe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,kl(t)-kl(e))+1}function _W(e,t,n,r){var a=EC(e,t,n),o;switch(r=Mf(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=POe(a,i))&&(r.precision=o),xW(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=NOe(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=kOe(a))&&(r.precision=o-(r.type==="%")*2);break}}return MC(r)}function Fi(e){var t=e.domain;return e.ticks=function(n){var r=t();return SC(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return _W(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,o=r.length-1,i=r[a],s=r[o],c,l,u=10;for(s<i&&(l=i,i=s,s=l,l=a,a=o,o=l);u-- >0;){if(l=jC(i,s,n),l===c)return r[a]=i,r[o]=s,t(r);if(l>0)i=Math.floor(i/l)*l,s=Math.ceil(s/l)*l;else if(l<0)i=Math.ceil(i*l)/l,s=Math.floor(s*l)/l;else break;c=l}return e},e}function yg(){var e=PC();return e.copy=function(){return Nf(e,yg())},$r.apply(e,arguments),Fi(e)}function SW(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,fg),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return SW(e).unknown(t)},e=arguments.length?Array.from(e,fg):[0,1],Fi(n)}function jW(e,t){e=e.slice();var n=0,r=e.length-1,a=e[n],o=e[r],i;return o<a&&(i=n,n=r,r=i,i=a,a=o,o=i),e[n]=t.floor(a),e[r]=t.ceil(o),e}function EW(e){return Math.log(e)}function OW(e){return Math.exp(e)}function MOe(e){return-Math.log(-e)}function AOe(e){return-Math.exp(-e)}function TOe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ROe(e){return e===10?TOe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function IOe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function CW(e){return(t,n)=>-e(-t,n)}function AC(e){const t=e(EW,OW),n=t.domain;let r=10,a,o;function i(){return a=IOe(r),o=ROe(r),n()[0]<0?(a=CW(a),o=CW(o),e(MOe,AOe)):e(EW,OW),t}return t.base=function(s){return arguments.length?(r=+s,i()):r},t.domain=function(s){return arguments.length?(n(s),i()):n()},t.ticks=s=>{const c=n();let l=c[0],u=c[c.length-1];const d=u<l;d&&([l,u]=[u,l]);let f=a(l),p=a(u),m,y;const v=s==null?10:+s;let b=[];if(!(r%1)&&p-f<v){if(f=Math.floor(f),p=Math.ceil(p),l>0){for(;f<=p;++f)for(m=1;m<r;++m)if(y=f<0?m/o(-f):m*o(f),!(y<l)){if(y>u)break;b.push(y)}}else for(;f<=p;++f)for(m=r-1;m>=1;--m)if(y=f>0?m/o(-f):m*o(f),!(y<l)){if(y>u)break;b.push(y)}b.length*2<v&&(b=SC(l,u,v))}else b=SC(f,p,Math.min(p-f,v)).map(o);return d?b.reverse():b},t.tickFormat=(s,c)=>{if(s==null&&(s=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=Mf(c)).precision==null&&(c.trim=!0),c=MC(c)),s===1/0)return c;const l=Math.max(1,r*s/t.ticks().length);return u=>{let d=u/o(Math.round(a(u)));return d*r<r-.5&&(d*=r),d<=l?c(u):""}},t.nice=()=>n(jW(n(),{floor:s=>o(Math.floor(a(s))),ceil:s=>o(Math.ceil(a(s)))})),t}function kW(){const e=AC(pg()).domain([1,10]);return e.copy=()=>Nf(e,kW()).base(e.base()),$r.apply(e,arguments),e}function PW(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function NW(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function TC(e){var t=1,n=e(PW(t),NW(t));return n.constant=function(r){return arguments.length?e(PW(t=+r),NW(t)):t},Fi(n)}function MW(){var e=TC(pg());return e.copy=function(){return Nf(e,MW()).constant(e.constant())},$r.apply(e,arguments)}function AW(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function DOe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function LOe(e){return e<0?-e*e:e*e}function RC(e){var t=e(Gn,Gn),n=1;function r(){return n===1?e(Gn,Gn):n===.5?e(DOe,LOe):e(AW(n),AW(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,r()):n},Fi(t)}function IC(){var e=RC(pg());return e.copy=function(){return Nf(e,IC()).exponent(e.exponent())},$r.apply(e,arguments),e}function $Oe(){return IC.apply(null,arguments).exponent(.5)}function TW(e){return Math.sign(e)*e*e}function FOe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function RW(){var e=PC(),t=[0,1],n=!1,r;function a(o){var i=FOe(e(o));return isNaN(i)?r:n?Math.round(i):i}return a.invert=function(o){return e.invert(TW(o))},a.domain=function(o){return arguments.length?(e.domain(o),a):e.domain()},a.range=function(o){return arguments.length?(e.range((t=Array.from(o,fg)).map(TW)),a):t.slice()},a.rangeRound=function(o){return a.range(o).round(!0)},a.round=function(o){return arguments.length?(n=!!o,a):n},a.clamp=function(o){return arguments.length?(e.clamp(o),a):e.clamp()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return RW(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},$r.apply(a,arguments),Fi(a)}function IW(){var e=[],t=[],n=[],r;function a(){var i=0,s=Math.max(1,t.length);for(n=new Array(s-1);++i<s;)n[i-1]=hOe(e,i/s);return o}function o(i){return i==null||isNaN(i=+i)?r:t[Of(n,i)]}return o.invertExtent=function(i){var s=t.indexOf(i);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort($i),a()},o.range=function(i){return arguments.length?(t=Array.from(i),a()):t.slice()},o.unknown=function(i){return arguments.length?(r=i,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return IW().domain(e).range(t).unknown(r)},$r.apply(o,arguments)}function DW(){var e=0,t=1,n=1,r=[.5],a=[0,1],o;function i(c){return c!=null&&c<=c?a[Of(r,c,0,n)]:o}function s(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,s()):[e,t]},i.range=function(c){return arguments.length?(n=(a=Array.from(c)).length-1,s()):a.slice()},i.invertExtent=function(c){var l=a.indexOf(c);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},i.unknown=function(c){return arguments.length&&(o=c),i},i.thresholds=function(){return r.slice()},i.copy=function(){return DW().domain([e,t]).range(a).unknown(o)},$r.apply(Fi(i),arguments)}function LW(){var e=[.5],t=[0,1],n,r=1;function a(o){return o!=null&&o<=o?t[Of(e,o,0,r)]:n}return a.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(o){var i=t.indexOf(o);return[e[i-1],e[i]]},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return LW().domain(e).range(t).unknown(n)},$r.apply(a,arguments)}const DC=new Date,LC=new Date;function gn(e,t,n,r){function a(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return a.floor=o=>(e(o=new Date(+o)),o),a.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),a.round=o=>{const i=a(o),s=a.ceil(o);return o-i<s-o?i:s},a.offset=(o,i)=>(t(o=new Date(+o),i==null?1:Math.floor(i)),o),a.range=(o,i,s)=>{const c=[];if(o=a.ceil(o),s=s==null?1:Math.floor(s),!(o<i)||!(s>0))return c;let l;do c.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<i);return c},a.filter=o=>gn(i=>{if(i>=i)for(;e(i),!o(i);)i.setTime(i-1)},(i,s)=>{if(i>=i)if(s<0)for(;++s<=0;)for(;t(i,-1),!o(i););else for(;--s>=0;)for(;t(i,1),!o(i););}),n&&(a.count=(o,i)=>(DC.setTime(+o),LC.setTime(+i),e(DC),e(LC),Math.floor(n(DC,LC))),a.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?a.filter(r?i=>r(i)%o===0:i=>a.count(0,i)%o===0):a)),a}const gg=gn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);gg.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?gn(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):gg),gg.range;const Jo=1e3,Fr=Jo*60,Qo=Fr*60,Go=Qo*24,$C=Go*7,$W=Go*30,FC=Go*365,Ps=gn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Jo)},(e,t)=>(t-e)/Jo,e=>e.getUTCSeconds());Ps.range;const BC=gn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Jo)},(e,t)=>{e.setTime(+e+t*Fr)},(e,t)=>(t-e)/Fr,e=>e.getMinutes());BC.range;const zC=gn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Fr)},(e,t)=>(t-e)/Fr,e=>e.getUTCMinutes());zC.range;const UC=gn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Jo-e.getMinutes()*Fr)},(e,t)=>{e.setTime(+e+t*Qo)},(e,t)=>(t-e)/Qo,e=>e.getHours());UC.range;const VC=gn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Qo)},(e,t)=>(t-e)/Qo,e=>e.getUTCHours());VC.range;const Af=gn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Fr)/Go,e=>e.getDate()-1);Af.range;const vg=gn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Go,e=>e.getUTCDate()-1);vg.range;const FW=gn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Go,e=>Math.floor(e/Go));FW.range;function Ns(e){return gn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Fr)/$C)}const bg=Ns(0),wg=Ns(1),BOe=Ns(2),zOe=Ns(3),Pl=Ns(4),UOe=Ns(5),VOe=Ns(6);bg.range,wg.range,BOe.range,zOe.range,Pl.range,UOe.range,VOe.range;function Ms(e){return gn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/$C)}const xg=Ms(0),_g=Ms(1),WOe=Ms(2),HOe=Ms(3),Nl=Ms(4),qOe=Ms(5),ZOe=Ms(6);xg.range,_g.range,WOe.range,HOe.range,Nl.range,qOe.range,ZOe.range;const WC=gn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());WC.range;const HC=gn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());HC.range;const ei=gn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ei.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:gn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}),ei.range;const ti=gn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ti.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:gn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}),ti.range;function BW(e,t,n,r,a,o){const i=[[Ps,1,Jo],[Ps,5,5*Jo],[Ps,15,15*Jo],[Ps,30,30*Jo],[o,1,Fr],[o,5,5*Fr],[o,15,15*Fr],[o,30,30*Fr],[a,1,Qo],[a,3,3*Qo],[a,6,6*Qo],[a,12,12*Qo],[r,1,Go],[r,2,2*Go],[n,1,$C],[t,1,$W],[t,3,3*$W],[e,1,FC]];function s(l,u,d){const f=u<l;f&&([l,u]=[u,l]);const p=d&&typeof d.range=="function"?d:c(l,u,d),m=p?p.range(l,+u+1):[];return f?m.reverse():m}function c(l,u,d){const f=Math.abs(u-l)/d,p=_C(([,,v])=>v).right(i,f);if(p===i.length)return e.every(EC(l/FC,u/FC,d));if(p===0)return gg.every(Math.max(EC(l,u,d),1));const[m,y]=i[f/i[p-1][2]<i[p][2]/f?p-1:p];return m.every(y)}return[s,c]}const[KOe,XOe]=BW(ti,HC,xg,FW,VC,zC),[YOe,JOe]=BW(ei,WC,bg,Af,UC,BC);function qC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ZC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Tf(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function QOe(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,o=e.days,i=e.shortDays,s=e.months,c=e.shortMonths,l=Rf(a),u=If(a),d=Rf(o),f=If(o),p=Rf(i),m=If(i),y=Rf(s),v=If(s),b=Rf(c),w=If(c),_={a:I,A:F,b:D,B:V,c:null,d:qW,e:qW,f:xCe,g:MCe,G:TCe,H:vCe,I:bCe,j:wCe,L:ZW,m:_Ce,M:SCe,p:U,q:B,Q:GW,s:eH,S:jCe,u:ECe,U:OCe,V:CCe,w:kCe,W:PCe,x:null,X:null,y:NCe,Y:ACe,Z:RCe,"%":QW},x={a:K,A:te,b:L,B:$,c:null,d:XW,e:XW,f:$Ce,g:KCe,G:YCe,H:ICe,I:DCe,j:LCe,L:YW,m:FCe,M:BCe,p:W,q,Q:GW,s:eH,S:zCe,u:UCe,U:VCe,V:WCe,w:HCe,W:qCe,x:null,X:null,y:ZCe,Y:XCe,Z:JCe,"%":QW},S={a:k,A:N,b:R,B:M,c:C,d:WW,e:WW,f:hCe,g:VW,G:UW,H:HW,I:HW,j:uCe,L:pCe,m:lCe,M:dCe,p:P,q:cCe,Q:yCe,s:gCe,S:fCe,u:rCe,U:aCe,V:oCe,w:nCe,W:iCe,x:T,X:A,y:VW,Y:UW,Z:sCe,"%":mCe};_.x=j(n,_),_.X=j(r,_),_.c=j(t,_),x.x=j(n,x),x.X=j(r,x),x.c=j(t,x);function j(Z,ee){return function(oe){var H=[],le=-1,ie=0,pe=Z.length,Oe,Ue,Ve;for(oe instanceof Date||(oe=new Date(+oe));++le<pe;)Z.charCodeAt(le)===37&&(H.push(Z.slice(ie,le)),(Ue=zW[Oe=Z.charAt(++le)])!=null?Oe=Z.charAt(++le):Ue=Oe==="e"?" ":"0",(Ve=ee[Oe])&&(Oe=Ve(oe,Ue)),H.push(Oe),ie=le+1);return H.push(Z.slice(ie,le)),H.join("")}}function E(Z,ee){return function(oe){var H=Tf(1900,void 0,1),le=O(H,Z,oe+="",0),ie,pe;if(le!=oe.length)return null;if("Q"in H)return new Date(H.Q);if("s"in H)return new Date(H.s*1e3+("L"in H?H.L:0));if(ee&&!("Z"in H)&&(H.Z=0),"p"in H&&(H.H=H.H%12+H.p*12),H.m===void 0&&(H.m="q"in H?H.q:0),"V"in H){if(H.V<1||H.V>53)return null;"w"in H||(H.w=1),"Z"in H?(ie=ZC(Tf(H.y,0,1)),pe=ie.getUTCDay(),ie=pe>4||pe===0?_g.ceil(ie):_g(ie),ie=vg.offset(ie,(H.V-1)*7),H.y=ie.getUTCFullYear(),H.m=ie.getUTCMonth(),H.d=ie.getUTCDate()+(H.w+6)%7):(ie=qC(Tf(H.y,0,1)),pe=ie.getDay(),ie=pe>4||pe===0?wg.ceil(ie):wg(ie),ie=Af.offset(ie,(H.V-1)*7),H.y=ie.getFullYear(),H.m=ie.getMonth(),H.d=ie.getDate()+(H.w+6)%7)}else("W"in H||"U"in H)&&("w"in H||(H.w="u"in H?H.u%7:"W"in H?1:0),pe="Z"in H?ZC(Tf(H.y,0,1)).getUTCDay():qC(Tf(H.y,0,1)).getDay(),H.m=0,H.d="W"in H?(H.w+6)%7+H.W*7-(pe+5)%7:H.w+H.U*7-(pe+6)%7);return"Z"in H?(H.H+=H.Z/100|0,H.M+=H.Z%100,ZC(H)):qC(H)}}function O(Z,ee,oe,H){for(var le=0,ie=ee.length,pe=oe.length,Oe,Ue;le<ie;){if(H>=pe)return-1;if(Oe=ee.charCodeAt(le++),Oe===37){if(Oe=ee.charAt(le++),Ue=S[Oe in zW?ee.charAt(le++):Oe],!Ue||(H=Ue(Z,oe,H))<0)return-1}else if(Oe!=oe.charCodeAt(H++))return-1}return H}function P(Z,ee,oe){var H=l.exec(ee.slice(oe));return H?(Z.p=u.get(H[0].toLowerCase()),oe+H[0].length):-1}function k(Z,ee,oe){var H=p.exec(ee.slice(oe));return H?(Z.w=m.get(H[0].toLowerCase()),oe+H[0].length):-1}function N(Z,ee,oe){var H=d.exec(ee.slice(oe));return H?(Z.w=f.get(H[0].toLowerCase()),oe+H[0].length):-1}function R(Z,ee,oe){var H=b.exec(ee.slice(oe));return H?(Z.m=w.get(H[0].toLowerCase()),oe+H[0].length):-1}function M(Z,ee,oe){var H=y.exec(ee.slice(oe));return H?(Z.m=v.get(H[0].toLowerCase()),oe+H[0].length):-1}function C(Z,ee,oe){return O(Z,t,ee,oe)}function T(Z,ee,oe){return O(Z,n,ee,oe)}function A(Z,ee,oe){return O(Z,r,ee,oe)}function I(Z){return i[Z.getDay()]}function F(Z){return o[Z.getDay()]}function D(Z){return c[Z.getMonth()]}function V(Z){return s[Z.getMonth()]}function U(Z){return a[+(Z.getHours()>=12)]}function B(Z){return 1+~~(Z.getMonth()/3)}function K(Z){return i[Z.getUTCDay()]}function te(Z){return o[Z.getUTCDay()]}function L(Z){return c[Z.getUTCMonth()]}function $(Z){return s[Z.getUTCMonth()]}function W(Z){return a[+(Z.getUTCHours()>=12)]}function q(Z){return 1+~~(Z.getUTCMonth()/3)}return{format:function(Z){var ee=j(Z+="",_);return ee.toString=function(){return Z},ee},parse:function(Z){var ee=E(Z+="",!1);return ee.toString=function(){return Z},ee},utcFormat:function(Z){var ee=j(Z+="",x);return ee.toString=function(){return Z},ee},utcParse:function(Z){var ee=E(Z+="",!0);return ee.toString=function(){return Z},ee}}}var zW={"-":"",_:" ",0:"0"},Sn=/^\s*\d+/,GOe=/^%/,eCe=/[\\^$*+?|[\]().{}]/g;function bt(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",o=a.length;return r+(o<n?new Array(n-o+1).join(t)+a:a)}function tCe(e){return e.replace(eCe,"\\$&")}function Rf(e){return new RegExp("^(?:"+e.map(tCe).join("|")+")","i")}function If(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function nCe(e,t,n){var r=Sn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function rCe(e,t,n){var r=Sn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function aCe(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function oCe(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function iCe(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function UW(e,t,n){var r=Sn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function VW(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function sCe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function cCe(e,t,n){var r=Sn.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function lCe(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function WW(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function uCe(e,t,n){var r=Sn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function HW(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function dCe(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function fCe(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function pCe(e,t,n){var r=Sn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function hCe(e,t,n){var r=Sn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function mCe(e,t,n){var r=GOe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function yCe(e,t,n){var r=Sn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function gCe(e,t,n){var r=Sn.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function qW(e,t){return bt(e.getDate(),t,2)}function vCe(e,t){return bt(e.getHours(),t,2)}function bCe(e,t){return bt(e.getHours()%12||12,t,2)}function wCe(e,t){return bt(1+Af.count(ei(e),e),t,3)}function ZW(e,t){return bt(e.getMilliseconds(),t,3)}function xCe(e,t){return ZW(e,t)+"000"}function _Ce(e,t){return bt(e.getMonth()+1,t,2)}function SCe(e,t){return bt(e.getMinutes(),t,2)}function jCe(e,t){return bt(e.getSeconds(),t,2)}function ECe(e){var t=e.getDay();return t===0?7:t}function OCe(e,t){return bt(bg.count(ei(e)-1,e),t,2)}function KW(e){var t=e.getDay();return t>=4||t===0?Pl(e):Pl.ceil(e)}function CCe(e,t){return e=KW(e),bt(Pl.count(ei(e),e)+(ei(e).getDay()===4),t,2)}function kCe(e){return e.getDay()}function PCe(e,t){return bt(wg.count(ei(e)-1,e),t,2)}function NCe(e,t){return bt(e.getFullYear()%100,t,2)}function MCe(e,t){return e=KW(e),bt(e.getFullYear()%100,t,2)}function ACe(e,t){return bt(e.getFullYear()%1e4,t,4)}function TCe(e,t){var n=e.getDay();return e=n>=4||n===0?Pl(e):Pl.ceil(e),bt(e.getFullYear()%1e4,t,4)}function RCe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+bt(t/60|0,"0",2)+bt(t%60,"0",2)}function XW(e,t){return bt(e.getUTCDate(),t,2)}function ICe(e,t){return bt(e.getUTCHours(),t,2)}function DCe(e,t){return bt(e.getUTCHours()%12||12,t,2)}function LCe(e,t){return bt(1+vg.count(ti(e),e),t,3)}function YW(e,t){return bt(e.getUTCMilliseconds(),t,3)}function $Ce(e,t){return YW(e,t)+"000"}function FCe(e,t){return bt(e.getUTCMonth()+1,t,2)}function BCe(e,t){return bt(e.getUTCMinutes(),t,2)}function zCe(e,t){return bt(e.getUTCSeconds(),t,2)}function UCe(e){var t=e.getUTCDay();return t===0?7:t}function VCe(e,t){return bt(xg.count(ti(e)-1,e),t,2)}function JW(e){var t=e.getUTCDay();return t>=4||t===0?Nl(e):Nl.ceil(e)}function WCe(e,t){return e=JW(e),bt(Nl.count(ti(e),e)+(ti(e).getUTCDay()===4),t,2)}function HCe(e){return e.getUTCDay()}function qCe(e,t){return bt(_g.count(ti(e)-1,e),t,2)}function ZCe(e,t){return bt(e.getUTCFullYear()%100,t,2)}function KCe(e,t){return e=JW(e),bt(e.getUTCFullYear()%100,t,2)}function XCe(e,t){return bt(e.getUTCFullYear()%1e4,t,4)}function YCe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Nl(e):Nl.ceil(e),bt(e.getUTCFullYear()%1e4,t,4)}function JCe(){return"+0000"}function QW(){return"%"}function GW(e){return+e}function eH(e){return Math.floor(+e/1e3)}var Ml,tH,nH;QCe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function QCe(e){return Ml=QOe(e),tH=Ml.format,Ml.parse,nH=Ml.utcFormat,Ml.utcParse,Ml}function GCe(e){return new Date(e)}function eke(e){return e instanceof Date?+e:+new Date(+e)}function KC(e,t,n,r,a,o,i,s,c,l){var u=PC(),d=u.invert,f=u.domain,p=l(".%L"),m=l(":%S"),y=l("%I:%M"),v=l("%I %p"),b=l("%a %d"),w=l("%b %d"),_=l("%B"),x=l("%Y");function S(j){return(c(j)<j?p:s(j)<j?m:i(j)<j?y:o(j)<j?v:r(j)<j?a(j)<j?b:w:n(j)<j?_:x)(j)}return u.invert=function(j){return new Date(d(j))},u.domain=function(j){return arguments.length?f(Array.from(j,eke)):f().map(GCe)},u.ticks=function(j){var E=f();return e(E[0],E[E.length-1],j??10)},u.tickFormat=function(j,E){return E==null?S:l(E)},u.nice=function(j){var E=f();return(!j||typeof j.range!="function")&&(j=t(E[0],E[E.length-1],j??10)),j?f(jW(E,j)):u},u.copy=function(){return Nf(u,KC(e,t,n,r,a,o,i,s,c,l))},u}function tke(){return $r.apply(KC(YOe,JOe,ei,WC,bg,Af,UC,BC,Ps,tH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function nke(){return $r.apply(KC(KOe,XOe,ti,HC,xg,vg,VC,zC,Ps,nH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Sg(){var e=0,t=1,n,r,a,o,i=Gn,s=!1,c;function l(d){return d==null||isNaN(d=+d)?c:i(a===0?.5:(d=(o(d)-n)*a,s?Math.max(0,Math.min(1,d)):d))}l.domain=function(d){return arguments.length?([e,t]=d,n=o(e=+e),r=o(t=+t),a=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(d){return arguments.length?(s=!!d,l):s},l.interpolator=function(d){return arguments.length?(i=d,l):i};function u(d){return function(f){var p,m;return arguments.length?([p,m]=f,i=d(p,m),l):[i(0),i(1)]}}return l.range=u(jc),l.rangeRound=u(o_),l.unknown=function(d){return arguments.length?(c=d,l):c},function(d){return o=d,n=d(e),r=d(t),a=n===r?0:1/(r-n),l}}function Bi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function rH(){var e=Fi(Sg()(Gn));return e.copy=function(){return Bi(e,rH())},Yo.apply(e,arguments)}function aH(){var e=AC(Sg()).domain([1,10]);return e.copy=function(){return Bi(e,aH()).base(e.base())},Yo.apply(e,arguments)}function oH(){var e=TC(Sg());return e.copy=function(){return Bi(e,oH()).constant(e.constant())},Yo.apply(e,arguments)}function XC(){var e=RC(Sg());return e.copy=function(){return Bi(e,XC()).exponent(e.exponent())},Yo.apply(e,arguments)}function rke(){return XC.apply(null,arguments).exponent(.5)}function iH(){var e=[],t=Gn;function n(r){if(r!=null&&!isNaN(r=+r))return t((Of(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let a of r)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort($i),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,o)=>pOe(e,o/r))},n.copy=function(){return iH(t).domain(e)},Yo.apply(n,arguments)}function jg(){var e=0,t=.5,n=1,r=1,a,o,i,s,c,l=Gn,u,d=!1,f;function p(y){return isNaN(y=+y)?f:(y=.5+((y=+u(y))-o)*(r*y<r*o?s:c),l(d?Math.max(0,Math.min(1,y)):y))}p.domain=function(y){return arguments.length?([e,t,n]=y,a=u(e=+e),o=u(t=+t),i=u(n=+n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,p):[e,t,n]},p.clamp=function(y){return arguments.length?(d=!!y,p):d},p.interpolator=function(y){return arguments.length?(l=y,p):l};function m(y){return function(v){var b,w,_;return arguments.length?([b,w,_]=v,l=Yie(y,[b,w,_]),p):[l(0),l(.5),l(1)]}}return p.range=m(jc),p.rangeRound=m(o_),p.unknown=function(y){return arguments.length?(f=y,p):f},function(y){return u=y,a=y(e),o=y(t),i=y(n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,p}}function sH(){var e=Fi(jg()(Gn));return e.copy=function(){return Bi(e,sH())},Yo.apply(e,arguments)}function cH(){var e=AC(jg()).domain([.1,1,10]);return e.copy=function(){return Bi(e,cH()).base(e.base())},Yo.apply(e,arguments)}function lH(){var e=TC(jg());return e.copy=function(){return Bi(e,lH()).constant(e.constant())},Yo.apply(e,arguments)}function YC(){var e=RC(jg());return e.copy=function(){return Bi(e,YC()).exponent(e.exponent())},Yo.apply(e,arguments)}function ake(){return YC.apply(null,arguments).exponent(.5)}const uH=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:kf,scaleDiverging:sH,scaleDivergingLog:cH,scaleDivergingPow:YC,scaleDivergingSqrt:ake,scaleDivergingSymlog:lH,scaleIdentity:SW,scaleImplicit:OC,scaleLinear:yg,scaleLog:kW,scaleOrdinal:CC,scalePoint:Pf,scalePow:IC,scaleQuantile:IW,scaleQuantize:DW,scaleRadial:RW,scaleSequential:rH,scaleSequentialLog:aH,scaleSequentialPow:XC,scaleSequentialQuantile:iH,scaleSequentialSqrt:rke,scaleSequentialSymlog:oH,scaleSqrt:$Oe,scaleSymlog:MW,scaleThreshold:LW,scaleTime:tke,scaleUtc:nke,tickFormat:_W},Symbol.toStringTag,{value:"Module"}));var JC,dH;function fH(){if(dH)return JC;dH=1;var e=bc();function t(n,r,a){for(var o=-1,i=n.length;++o<i;){var s=n[o],c=r(s);if(c!=null&&(l===void 0?c===c&&!e(c):a(c,l)))var l=c,u=s}return u}return JC=t,JC}var QC,pH;function oke(){if(pH)return QC;pH=1;function e(t,n){return t>n}return QC=e,QC}var GC,hH;function ike(){if(hH)return GC;hH=1;var e=fH(),t=oke(),n=wc();function r(a){return a&&a.length?e(a,n,t):void 0}return GC=r,GC}var ske=ike();const Eg=ft(ske);var ek,mH;function cke(){if(mH)return ek;mH=1;function e(t,n){return t<n}return ek=e,ek}var tk,yH;function lke(){if(yH)return tk;yH=1;var e=fH(),t=cke(),n=wc();function r(a){return a&&a.length?e(a,n,t):void 0}return tk=r,tk}var uke=lke();const Og=ft(uke);var nk,gH;aN=function(){if(gH)return nk;gH=1;var e=du(),t=Wa(),n=pV(),r=qn();function a(o,i){var s=r(o)?e:n;return s(o,t(i,3))}return nk=a,nk};var rk,vH;function dke(){if(vH)return rk;vH=1;var e=Pv(),t=aN();function n(r,a){return e(t(r,a),1)}return rk=n,rk}var fke=dke();const pke=ft(fke);var ak,bH;function hke(){if(bH)return ak;bH=1;var e=o1();function t(n,r){return e(n,r)}return ak=t,ak}var mke=hke();const ok=ft(mke);var Al=1e9,yke={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},ck,Xt=!0,Br="[DecimalError] ",As=Br+"Invalid argument: ",ik=Br+"Exponent out of range: ",Tl=Math.floor,Ts=Math.pow,gke=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Or,jn=1e7,Ht=7,wH=9007199254740991,Cg=Tl(wH/Ht),Me={};Me.absoluteValue=Me.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},Me.comparedTo=Me.cmp=function(e){var t,n,r,a,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(r=o.d.length,a=e.d.length,t=0,n=r<a?r:a;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===a?0:r>a^o.s<0?1:-1},Me.decimalPlaces=Me.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Ht;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n},Me.dividedBy=Me.div=function(e){return ni(this,new this.constructor(e))},Me.dividedToIntegerBy=Me.idiv=function(e){var t=this,n=t.constructor;return Bt(ni(t,new n(e),0,1),n.precision)},Me.equals=Me.eq=function(e){return!this.cmp(e)},Me.exponent=function(){return un(this)},Me.greaterThan=Me.gt=function(e){return this.cmp(e)>0},Me.greaterThanOrEqualTo=Me.gte=function(e){return this.cmp(e)>=0},Me.isInteger=Me.isint=function(){return this.e>this.d.length-2},Me.isNegative=Me.isneg=function(){return this.s<0},Me.isPositive=Me.ispos=function(){return this.s>0},Me.isZero=function(){return this.s===0},Me.lessThan=Me.lt=function(e){return this.cmp(e)<0},Me.lessThanOrEqualTo=Me.lte=function(e){return this.cmp(e)<1},Me.logarithm=Me.log=function(e){var t,n=this,r=n.constructor,a=r.precision,o=a+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(Or))throw Error(Br+"NaN");if(n.s<1)throw Error(Br+(n.s?"NaN":"-Infinity"));return n.eq(Or)?new r(0):(Xt=!1,t=ni(Df(n,o),Df(e,o),o),Xt=!0,Bt(t,a))},Me.minus=Me.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?jH(t,e):xH(t,(e.s=-e.s,e))},Me.modulo=Me.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(e=new r(e),!e.s)throw Error(Br+"NaN");return n.s?(Xt=!1,t=ni(n,e,0,1).times(e),Xt=!0,n.minus(t)):Bt(new r(n),a)},Me.naturalExponential=Me.exp=function(){return _H(this)},Me.naturalLogarithm=Me.ln=function(){return Df(this)},Me.negated=Me.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},Me.plus=Me.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?xH(t,e):jH(t,(e.s=-e.s,e))},Me.precision=Me.sd=function(e){var t,n,r,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(As+e);if(t=un(a)+1,r=a.d.length-1,n=r*Ht+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},Me.squareRoot=Me.sqrt=function(){var e,t,n,r,a,o,i,s=this,c=s.constructor;if(s.s<1){if(!s.s)return new c(0);throw Error(Br+"NaN")}for(e=un(s),Xt=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=ao(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Tl((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(a.toString()),n=c.precision,a=i=n+3;;)if(o=r,r=o.plus(ni(s,o,i+2)).times(.5),ao(o.d).slice(0,i)===(t=ao(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&t=="4999"){if(Bt(o,n+1,0),o.times(o).eq(s)){r=o;break}}else if(t!="9999")break;i+=4}return Xt=!0,Bt(r,n)},Me.times=Me.mul=function(e){var t,n,r,a,o,i,s,c,l,u=this,d=u.constructor,f=u.d,p=(e=new d(e)).d;if(!u.s||!e.s)return new d(0);for(e.s*=u.s,n=u.e+e.e,c=f.length,l=p.length,c<l&&(o=f,f=p,p=o,i=c,c=l,l=i),o=[],i=c+l,r=i;r--;)o.push(0);for(r=l;--r>=0;){for(t=0,a=c+r;a>r;)s=o[a]+p[r]*f[a-r-1]+t,o[a--]=s%jn|0,t=s/jn|0;o[a]=(o[a]+t)%jn|0}for(;!o[--i];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,Xt?Bt(e,d.precision):e},Me.toDecimalPlaces=Me.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(ro(e,0,Al),t===void 0?t=r.rounding:ro(t,0,8),Bt(n,e+un(n)+1,t))},Me.toExponential=function(e,t){var n,r=this,a=r.constructor;return e===void 0?n=Rs(r,!0):(ro(e,0,Al),t===void 0?t=a.rounding:ro(t,0,8),r=Bt(new a(r),e+1,t),n=Rs(r,!0,e+1)),n},Me.toFixed=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?Rs(a):(ro(e,0,Al),t===void 0?t=o.rounding:ro(t,0,8),r=Bt(new o(a),e+un(a)+1,t),n=Rs(r.abs(),!1,e+un(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},Me.toInteger=Me.toint=function(){var e=this,t=e.constructor;return Bt(new t(e),un(e)+1,t.rounding)},Me.toNumber=function(){return+this},Me.toPower=Me.pow=function(e){var t,n,r,a,o,i,s=this,c=s.constructor,l=12,u=+(e=new c(e));if(!e.s)return new c(Or);if(s=new c(s),!s.s){if(e.s<1)throw Error(Br+"Infinity");return s}if(s.eq(Or))return s;if(r=c.precision,e.eq(Or))return Bt(s,r);if(t=e.e,n=e.d.length-1,i=t>=n,o=s.s,i){if((n=u<0?-u:u)<=wH){for(a=new c(Or),t=Math.ceil(r/Ht+4),Xt=!1;n%2&&(a=a.times(s),EH(a.d,t)),n=Tl(n/2),n!==0;)s=s.times(s),EH(s.d,t);return Xt=!0,e.s<0?new c(Or).div(a):Bt(a,r)}}else if(o<0)throw Error(Br+"NaN");return o=o<0&&e.d[Math.max(t,n)]&1?-1:1,s.s=1,Xt=!1,a=e.times(Df(s,r+l)),Xt=!0,a=_H(a),a.s=o,a},Me.toPrecision=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?(n=un(a),r=Rs(a,n<=o.toExpNeg||n>=o.toExpPos)):(ro(e,1,Al),t===void 0?t=o.rounding:ro(t,0,8),a=Bt(new o(a),e,t),n=un(a),r=Rs(a,e<=n||n<=o.toExpNeg,e)),r},Me.toSignificantDigits=Me.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(ro(e,1,Al),t===void 0?t=r.rounding:ro(t,0,8)),Bt(new r(n),e,t)},Me.toString=Me.valueOf=Me.val=Me.toJSON=Me[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=un(e),n=e.constructor;return Rs(e,t<=n.toExpNeg||t>=n.toExpPos)};function xH(e,t){var n,r,a,o,i,s,c,l,u=e.constructor,d=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Xt?Bt(t,d):t;if(c=e.d,l=t.d,i=e.e,a=t.e,c=c.slice(),o=i-a,o){for(o<0?(r=c,o=-o,s=l.length):(r=l,a=i,s=c.length),i=Math.ceil(d/Ht),s=i>s?i+1:s+1,o>s&&(o=s,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(s=c.length,o=l.length,s-o<0&&(o=s,r=l,l=c,c=r),n=0;o;)n=(c[--o]=c[o]+l[o]+n)/jn|0,c[o]%=jn;for(n&&(c.unshift(n),++a),s=c.length;c[--s]==0;)c.pop();return t.d=c,t.e=a,Xt?Bt(t,d):t}function ro(e,t,n){if(e!==~~e||e<t||e>n)throw Error(As+e)}function ao(e){var t,n,r,a=e.length-1,o="",i=e[0];if(a>0){for(o+=i,t=1;t<a;t++)r=e[t]+"",n=Ht-r.length,n&&(o+=zi(n)),o+=r;i=e[t],r=i+"",n=Ht-r.length,n&&(o+=zi(n))}else if(i===0)return"0";for(;i%10===0;)i/=10;return o+i}var ni=function(){function e(r,a){var o,i=0,s=r.length;for(r=r.slice();s--;)o=r[s]*a+i,r[s]=o%jn|0,i=o/jn|0;return i&&r.unshift(i),r}function t(r,a,o,i){var s,c;if(o!=i)c=o>i?1:-1;else for(s=c=0;s<o;s++)if(r[s]!=a[s]){c=r[s]>a[s]?1:-1;break}return c}function n(r,a,o){for(var i=0;o--;)r[o]-=i,i=r[o]<a[o]?1:0,r[o]=i*jn+r[o]-a[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,o,i){var s,c,l,u,d,f,p,m,y,v,b,w,_,x,S,j,E,O,P=r.constructor,k=r.s==a.s?1:-1,N=r.d,R=a.d;if(!r.s)return new P(r);if(!a.s)throw Error(Br+"Division by zero");for(c=r.e-a.e,E=R.length,S=N.length,p=new P(k),m=p.d=[],l=0;R[l]==(N[l]||0);)++l;if(R[l]>(N[l]||0)&&--c,o==null?w=o=P.precision:i?w=o+(un(r)-un(a))+1:w=o,w<0)return new P(0);if(w=w/Ht+2|0,l=0,E==1)for(u=0,R=R[0],w++;(l<S||u)&&w--;l++)_=u*jn+(N[l]||0),m[l]=_/R|0,u=_%R|0;else{for(u=jn/(R[0]+1)|0,u>1&&(R=e(R,u),N=e(N,u),E=R.length,S=N.length),x=E,y=N.slice(0,E),v=y.length;v<E;)y[v++]=0;O=R.slice(),O.unshift(0),j=R[0],R[1]>=jn/2&&++j;do u=0,s=t(R,y,E,v),s<0?(b=y[0],E!=v&&(b=b*jn+(y[1]||0)),u=b/j|0,u>1?(u>=jn&&(u=jn-1),d=e(R,u),f=d.length,v=y.length,s=t(d,y,f,v),s==1&&(u--,n(d,E<f?O:R,f))):(u==0&&(s=u=1),d=R.slice()),f=d.length,f<v&&d.unshift(0),n(y,d,v),s==-1&&(v=y.length,s=t(R,y,E,v),s<1&&(u++,n(y,E<v?O:R,v))),v=y.length):s===0&&(u++,y=[0]),m[l++]=u,s&&y[0]?y[v++]=N[x]||0:(y=[N[x]],v=1);while((x++<S||y[0]!==void 0)&&w--)}return m[0]||m.shift(),p.e=c,Bt(p,i?o+un(p)+1:o)}}();function _H(e,t){var n,r,a,o,i,s,c=0,l=0,u=e.constructor,d=u.precision;if(un(e)>16)throw Error(ik+un(e));if(!e.s)return new u(Or);for(t==null?(Xt=!1,s=d):s=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),l+=5;for(r=Math.log(Ts(2,l))/Math.LN10*2+5|0,s+=r,n=a=o=new u(Or),u.precision=s;;){if(a=Bt(a.times(e),s),n=n.times(++c),i=o.plus(ni(a,n,s)),ao(i.d).slice(0,s)===ao(o.d).slice(0,s)){for(;l--;)o=Bt(o.times(o),s);return u.precision=d,t==null?(Xt=!0,Bt(o,d)):o}o=i}}function un(e){for(var t=e.e*Ht,n=e.d[0];n>=10;n/=10)t++;return t}function sk(e,t,n){if(t>e.LN10.sd())throw Xt=!0,n&&(e.precision=n),Error(Br+"LN10 precision limit exceeded");return Bt(new e(e.LN10),t)}function zi(e){for(var t="";e--;)t+="0";return t}function Df(e,t){var n,r,a,o,i,s,c,l,u,d=1,f=10,p=e,m=p.d,y=p.constructor,v=y.precision;if(p.s<1)throw Error(Br+(p.s?"NaN":"-Infinity"));if(p.eq(Or))return new y(0);if(t==null?(Xt=!1,l=v):l=t,p.eq(10))return t==null&&(Xt=!0),sk(y,l);if(l+=f,y.precision=l,n=ao(m),r=n.charAt(0),o=un(p),Math.abs(o)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)p=p.times(e),n=ao(p.d),r=n.charAt(0),d++;o=un(p),r>1?(p=new y("0."+n),o++):p=new y(r+"."+n.slice(1))}else return c=sk(y,l+2,v).times(o+""),p=Df(new y(r+"."+n.slice(1)),l-f).plus(c),y.precision=v,t==null?(Xt=!0,Bt(p,v)):p;for(s=i=p=ni(p.minus(Or),p.plus(Or),l),u=Bt(p.times(p),l),a=3;;){if(i=Bt(i.times(u),l),c=s.plus(ni(i,new y(a),l)),ao(c.d).slice(0,l)===ao(s.d).slice(0,l))return s=s.times(2),o!==0&&(s=s.plus(sk(y,l+2,v).times(o+""))),s=ni(s,new y(d),l),y.precision=v,t==null?(Xt=!0,Bt(s,v)):s;s=c,a+=2}}function SH(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=Tl(n/Ht),e.d=[],r=(n+1)%Ht,n<0&&(r+=Ht),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=Ht;r<a;)e.d.push(+t.slice(r,r+=Ht));t=t.slice(r),r=Ht-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),Xt&&(e.e>Cg||e.e<-Cg))throw Error(ik+n)}else e.s=0,e.e=0,e.d=[0];return e}function Bt(e,t,n){var r,a,o,i,s,c,l,u,d=e.d;for(i=1,o=d[0];o>=10;o/=10)i++;if(r=t-i,r<0)r+=Ht,a=t,l=d[u=0];else{if(u=Math.ceil((r+1)/Ht),o=d.length,u>=o)return e;for(l=o=d[u],i=1;o>=10;o/=10)i++;r%=Ht,a=r-Ht+i}if(n!==void 0&&(o=Ts(10,i-a-1),s=l/o%10|0,c=t<0||d[u+1]!==void 0||l%o,c=n<4?(s||c)&&(n==0||n==(e.s<0?3:2)):s>5||s==5&&(n==4||c||n==6&&(r>0?a>0?l/Ts(10,i-a):0:d[u-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return c?(o=un(e),d.length=1,t=t-o-1,d[0]=Ts(10,(Ht-t%Ht)%Ht),e.e=Tl(-t/Ht)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=u,o=1,u--):(d.length=u+1,o=Ts(10,Ht-r),d[u]=a>0?(l/Ts(10,i-a)%Ts(10,a)|0)*o:0),c)for(;;)if(u==0){(d[0]+=o)==jn&&(d[0]=1,++e.e);break}else{if(d[u]+=o,d[u]!=jn)break;d[u--]=0,o=1}for(r=d.length;d[--r]===0;)d.pop();if(Xt&&(e.e>Cg||e.e<-Cg))throw Error(ik+un(e));return e}function jH(e,t){var n,r,a,o,i,s,c,l,u,d,f=e.constructor,p=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),Xt?Bt(t,p):t;if(c=e.d,d=t.d,r=t.e,l=e.e,c=c.slice(),i=l-r,i){for(u=i<0,u?(n=c,i=-i,s=d.length):(n=d,r=l,s=c.length),a=Math.max(Math.ceil(p/Ht),s)+2,i>a&&(i=a,n.length=1),n.reverse(),a=i;a--;)n.push(0);n.reverse()}else{for(a=c.length,s=d.length,u=a<s,u&&(s=a),a=0;a<s;a++)if(c[a]!=d[a]){u=c[a]<d[a];break}i=0}for(u&&(n=c,c=d,d=n,t.s=-t.s),s=c.length,a=d.length-s;a>0;--a)c[s++]=0;for(a=d.length;a>i;){if(c[--a]<d[a]){for(o=a;o&&c[--o]===0;)c[o]=jn-1;--c[o],c[a]+=jn}c[a]-=d[a]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,Xt?Bt(t,p):t):new f(0)}function Rs(e,t,n){var r,a=un(e),o=ao(e.d),i=o.length;return t?(n&&(r=n-i)>0?o=o.charAt(0)+"."+o.slice(1)+zi(r):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(a<0?"e":"e+")+a):a<0?(o="0."+zi(-a-1)+o,n&&(r=n-i)>0&&(o+=zi(r))):a>=i?(o+=zi(a+1-i),n&&(r=n-a-1)>0&&(o=o+"."+zi(r))):((r=a+1)<i&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-i)>0&&(a+1===i&&(o+="."),o+=zi(r))),e.s<0?"-"+o:o}function EH(e,t){if(e.length>t)return e.length=t,!0}function OH(e){var t,n,r;function a(o){var i=this;if(!(i instanceof a))return new a(o);if(i.constructor=a,o instanceof a){i.s=o.s,i.e=o.e,i.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(As+o);if(o>0)i.s=1;else if(o<0)o=-o,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(o===~~o&&o<1e7){i.e=0,i.d=[o];return}return SH(i,o.toString())}else if(typeof o!="string")throw Error(As+o);if(o.charCodeAt(0)===45?(o=o.slice(1),i.s=-1):i.s=1,gke.test(o))SH(i,o);else throw Error(As+o)}if(a.prototype=Me,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=OH,a.config=a.set=vke,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return a.config(e),a}function vke(e){if(!e||typeof e!="object")throw Error(Br+"Object expected");var t,n,r,a=["precision",1,Al,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((r=e[n=a[t]])!==void 0)if(Tl(r)===r&&r>=a[t+1]&&r<=a[t+2])this[n]=r;else throw Error(As+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(As+n+": "+r);return this}var ck=OH(yke);Or=new ck(1);const Lt=ck;function bke(e){return Ske(e)||_ke(e)||xke(e)||wke()}function wke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xke(e,t){if(e){if(typeof e=="string")return lk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lk(e,t)}}function _ke(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Ske(e){if(Array.isArray(e))return lk(e)}function lk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jke=function(e){return e},CH={"@@functional/placeholder":!0},kH=function(e){return e===CH},PH=function(e){return function t(){return arguments.length===0||arguments.length===1&&kH(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},Eke=function e(t,n){return t===1?n:PH(function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var i=a.filter(function(s){return s!==CH}).length;return i>=t?n.apply(void 0,a):e(t-i,PH(function(){for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=a.map(function(d){return kH(d)?c.shift():d});return n.apply(void 0,bke(u).concat(c))}))})},kg=function(e){return Eke(e.length,e)},uk=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},Oke=kg(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),Cke=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return jke;var r=t.reverse(),a=r[0],o=r.slice(1);return function(){return o.reduce(function(i,s){return s(i)},a.apply(void 0,arguments))}},dk=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},NH=function(e){var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t&&a.every(function(i,s){return i===t[s]})||(t=a,n=e.apply(void 0,a)),n}};function kke(e){var t;return e===0?t=1:t=Math.floor(new Lt(e).abs().log(10).toNumber())+1,t}function Pke(e,t,n){for(var r=new Lt(e),a=0,o=[];r.lt(t)&&a<1e5;)o.push(r.toNumber()),r=r.add(n),a++;return o}var Nke=kg(function(e,t,n){var r=+e,a=+t;return r+n*(a-r)}),Mke=kg(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),Ake=kg(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const Pg={rangeStep:Pke,getDigitCount:kke,interpolateNumber:Nke,uninterpolateNumber:Mke,uninterpolateTruncation:Ake};function fk(e){return Ike(e)||Rke(e)||MH(e)||Tke()}function Tke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rke(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Ike(e){if(Array.isArray(e))return pk(e)}function Lf(e,t){return $ke(e)||Lke(e,t)||MH(e,t)||Dke()}function Dke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MH(e,t){if(e){if(typeof e=="string")return pk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pk(e,t)}}function pk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lke(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),s;!(r=(s=i.next()).done)&&(n.push(s.value),!(t&&n.length===t));r=!0);}catch(c){a=!0,o=c}finally{try{!r&&i.return!=null&&i.return()}finally{if(a)throw o}}return n}}function $ke(e){if(Array.isArray(e))return e}function AH(e){var t=Lf(e,2),n=t[0],r=t[1],a=n,o=r;return n>r&&(a=r,o=n),[a,o]}function TH(e,t,n){if(e.lte(0))return new Lt(0);var r=Pg.getDigitCount(e.toNumber()),a=new Lt(10).pow(r),o=e.div(a),i=r!==1?.05:.1,s=new Lt(Math.ceil(o.div(i).toNumber())).add(n).mul(i),c=s.mul(a);return t?c:new Lt(Math.ceil(c))}function Fke(e,t,n){var r=1,a=new Lt(e);if(!a.isint()&&n){var o=Math.abs(e);o<1?(r=new Lt(10).pow(Pg.getDigitCount(e)-1),a=new Lt(Math.floor(a.div(r).toNumber())).mul(r)):o>1&&(a=new Lt(Math.floor(e)))}else e===0?a=new Lt(Math.floor((t-1)/2)):n||(a=new Lt(Math.floor(e)));var i=Math.floor((t-1)/2),s=Cke(Oke(function(c){return a.add(new Lt(c-i).mul(r)).toNumber()}),uk);return s(0,t)}function RH(e,t,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Lt(0),tickMin:new Lt(0),tickMax:new Lt(0)};var o=TH(new Lt(t).sub(e).div(n-1),r,a),i;e<=0&&t>=0?i=new Lt(0):(i=new Lt(e).add(t).div(2),i=i.sub(new Lt(i).mod(o)));var s=Math.ceil(i.sub(e).div(o).toNumber()),c=Math.ceil(new Lt(t).sub(i).div(o).toNumber()),l=s+c+1;return l>n?RH(e,t,n,r,a+1):(l<n&&(c=t>0?c+(n-l):c,s=t>0?s:s+(n-l)),{step:o,tickMin:i.sub(new Lt(s).mul(o)),tickMax:i.add(new Lt(c).mul(o))})}function Bke(e){var t=Lf(e,2),n=t[0],r=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),s=AH([n,r]),c=Lf(s,2),l=c[0],u=c[1];if(l===-1/0||u===1/0){var d=u===1/0?[l].concat(fk(uk(0,a-1).map(function(){return 1/0}))):[].concat(fk(uk(0,a-1).map(function(){return-1/0})),[u]);return n>r?dk(d):d}if(l===u)return Fke(l,a,o);var f=RH(l,u,i,o),p=f.step,m=f.tickMin,y=f.tickMax,v=Pg.rangeStep(m,y.add(new Lt(.1).mul(p)),p);return n>r?dk(v):v}function zke(e,t){var n=Lf(e,2),r=n[0],a=n[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=AH([r,a]),s=Lf(i,2),c=s[0],l=s[1];if(c===-1/0||l===1/0)return[r,a];if(c===l)return[c];var u=Math.max(t,2),d=TH(new Lt(l).sub(c).div(u-1),o,0),f=[].concat(fk(Pg.rangeStep(new Lt(c),new Lt(l).sub(new Lt(.99).mul(d)),d)),[l]);return r>a?dk(f):f}var Uke=NH(Bke),Vke=NH(zke),Wke="Invariant failed";function Is(e,t){throw new Error(Wke)}var Hke=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Rl(e){"@babel/helpers - typeof";return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(e)}function Ng(){return Ng=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ng.apply(this,arguments)}function qke(e,t){return Yke(e)||Xke(e,t)||Kke(e,t)||Zke()}function Zke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kke(e,t){if(e){if(typeof e=="string")return IH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IH(e,t)}}function IH(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xke(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function Yke(e){if(Array.isArray(e))return e}function Jke(e,t){if(e==null)return{};var n=Qke(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Qke(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Gke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ePe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$H(r.key),r)}}function tPe(e,t,n){return t&&ePe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function nPe(e,t,n){return t=Mg(t),rPe(e,DH()?Reflect.construct(t,n||[],Mg(e).constructor):t.apply(e,n))}function rPe(e,t){if(t&&(Rl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aPe(e)}function aPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DH=function(){return!!e})()}function Mg(e){return Mg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mg(e)}function oPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hk(e,t)}function hk(e,t){return hk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},hk(e,t)}function LH(e,t,n){return t=$H(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $H(e){var t=iPe(e,"string");return Rl(t)=="symbol"?t:t+""}function iPe(e,t){if(Rl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Rl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ag=function(e){function t(){return Gke(this,t),nPe(this,t,arguments)}return oPe(t,e),tPe(t,[{key:"render",value:function(){var n=this.props,r=n.offset,a=n.layout,o=n.width,i=n.dataKey,s=n.data,c=n.dataPointFormatter,l=n.xAxis,u=n.yAxis,d=Jke(n,Hke),f=Et(d,!1);this.props.direction==="x"&&l.type!=="number"&&Is();var p=s.map(function(m){var y=c(m,i),v=y.x,b=y.y,w=y.value,_=y.errorVal;if(!_)return null;var x=[],S,j;if(Array.isArray(_)){var E=qke(_,2);S=E[0],j=E[1]}else S=j=_;if(a==="vertical"){var O=l.scale,P=b+r,k=P+o,N=P-o,R=O(w-S),M=O(w+j);x.push({x1:M,y1:k,x2:M,y2:N}),x.push({x1:R,y1:P,x2:M,y2:P}),x.push({x1:R,y1:k,x2:R,y2:N})}else if(a==="horizontal"){var C=u.scale,T=v+r,A=T-o,I=T+o,F=C(w-S),D=C(w+j);x.push({x1:A,y1:D,x2:I,y2:D}),x.push({x1:T,y1:F,x2:T,y2:D}),x.push({x1:A,y1:F,x2:I,y2:F})}return Y.createElement(_n,Ng({className:"recharts-errorBar",key:"bar-".concat(x.map(function(V){return"".concat(V.x1,"-").concat(V.x2,"-").concat(V.y1,"-").concat(V.y2)}))},f),x.map(function(V){return Y.createElement("line",Ng({},V,{key:"line-".concat(V.x1,"-").concat(V.x2,"-").concat(V.y1,"-").concat(V.y2)}))}))});return Y.createElement(_n,{className:"recharts-errorBars"},p)}}])}(Y.Component);LH(Ag,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),LH(Ag,"displayName","ErrorBar");function $f(e){"@babel/helpers - typeof";return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$f(e)}function FH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ds(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FH(Object(n),!0).forEach(function(r){sPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function sPe(e,t,n){return t=cPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cPe(e){var t=lPe(e,"string");return $f(t)=="symbol"?t:t+""}function lPe(e,t){if($f(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($f(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BH=function(e){var t=e.children,n=e.formattedGraphicalItems,r=e.legendWidth,a=e.legendContent,o=Er(t,Sl);if(!o)return null;var i=Sl.defaultProps,s=i!==void 0?Ds(Ds({},i),o.props):{},c;return o.props&&o.props.payload?c=o.props&&o.props.payload:a==="children"?c=(n||[]).reduce(function(l,u){var d=u.item,f=u.props,p=f.sectors||f.data||[];return l.concat(p.map(function(m){return{type:o.props.iconType||d.props.legendType,value:m.name,color:m.fill,payload:m}}))},[]):c=(n||[]).map(function(l){var u=l.item,d=u.type.defaultProps,f=d!==void 0?Ds(Ds({},d),u.props):{},p=f.dataKey,m=f.name,y=f.legendType,v=f.hide;return{inactive:v,dataKey:p,type:s.iconType||y||"square",color:yk(u),value:m||p,payload:f}}),Ds(Ds(Ds({},s),Sl.getWithHeight(o,r)),{},{payload:c,item:o})};function Ff(e){"@babel/helpers - typeof";return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ff(e)}function zH(e){return pPe(e)||fPe(e)||dPe(e)||uPe()}function uPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dPe(e,t){if(e){if(typeof e=="string")return mk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mk(e,t)}}function fPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pPe(e){if(Array.isArray(e))return mk(e)}function mk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function tn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?UH(Object(n),!0).forEach(function(r){Il(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Il(e,t,n){return t=hPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hPe(e){var t=mPe(e,"string");return Ff(t)=="symbol"?t:t+""}function mPe(e,t){if(Ff(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ff(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oo(e,t,n){return Ot(e)||Ot(t)?n:yn(t)?Rr(e,t,n):lt(t)?t(e):n}function Tg(e,t,n,r){var a=pke(e,function(s){return oo(s,t)});if(n==="number"){var o=a.filter(function(s){return we(s)||parseFloat(s)});return o.length?[Og(o),Eg(o)]:[1/0,-1/0]}var i=r?a.filter(function(s){return!Ot(s)}):a;return i.map(function(s){return yn(s)||s instanceof Date?s:""})}var yPe=function(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,i=(t=n==null?void 0:n.length)!==null&&t!==void 0?t:0;if(i<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var s=a.range,c=0;c<i;c++){var l=c>0?r[c-1].coordinate:r[i-1].coordinate,u=r[c].coordinate,d=c>=i-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(ka(u-l)!==ka(d-u)){var p=[];if(ka(d-u)===ka(s[1]-s[0])){f=d;var m=u+s[1]-s[0];p[0]=Math.min(m,(m+l)/2),p[1]=Math.max(m,(m+l)/2)}else{f=l;var y=d+s[1]-s[0];p[0]=Math.min(u,(y+u)/2),p[1]=Math.max(u,(y+u)/2)}var v=[Math.min(u,(f+u)/2),Math.max(u,(f+u)/2)];if(e>v[0]&&e<=v[1]||e>=p[0]&&e<=p[1]){o=r[c].index;break}}else{var b=Math.min(l,d),w=Math.max(l,d);if(e>(b+u)/2&&e<=(w+u)/2){o=r[c].index;break}}}else for(var _=0;_<i;_++)if(_===0&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_>0&&_<i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2&&e<=(n[_].coordinate+n[_+1].coordinate)/2||_===i-1&&e>(n[_].coordinate+n[_-1].coordinate)/2){o=n[_].index;break}return o},yk=function(e){var t,n=e,r=n.type.displayName,a=(t=e.type)!==null&&t!==void 0&&t.defaultProps?tn(tn({},e.type.defaultProps),e.props):e.props,o=a.stroke,i=a.fill,s;switch(r){case"Line":s=o;break;case"Area":case"Radar":s=o&&o!=="none"?o:i;break;default:s=i;break}return s},gPe=function(e){var t=e.barSize,n=e.totalSize,r=e.stackGroups,a=r===void 0?{}:r;if(!a)return{};for(var o={},i=Object.keys(a),s=0,c=i.length;s<c;s++)for(var l=a[i[s]].stackGroups,u=Object.keys(l),d=0,f=u.length;d<f;d++){var p=l[u[d]],m=p.items,y=p.cateAxisId,v=m.filter(function(j){return Zo(j.type).indexOf("Bar")>=0});if(v&&v.length){var b=v[0].type.defaultProps,w=b!==void 0?tn(tn({},b),v[0].props):v[0].props,_=w.barSize,x=w[y];o[x]||(o[x]=[]);var S=Ot(_)?t:_;o[x].push({item:v[0],stackList:v.slice(1),barSize:Ot(S)?void 0:Cs(S,n,0)})}}return o},vPe=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,a=e.sizeList,o=a===void 0?[]:a,i=e.maxBarSize,s=o.length;if(s<1)return null;var c=Cs(t,r,0,!0),l,u=[];if(o[0].barSize===+o[0].barSize){var d=!1,f=r/s,p=o.reduce(function(_,x){return _+x.barSize||0},0);p+=(s-1)*c,p>=r&&(p-=(s-1)*c,c=0),p>=r&&f>0&&(d=!0,f*=.9,p=s*f);var m=(r-p)/2>>0,y={offset:m-c,size:0};l=o.reduce(function(_,x){var S={item:x.item,position:{offset:y.offset+y.size+c,size:d?f:x.barSize}},j=[].concat(zH(_),[S]);return y=j[j.length-1].position,x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){j.push({item:E,position:y})}),j},u)}else{var v=Cs(n,r,0,!0);r-2*v-(s-1)*c<=0&&(c=0);var b=(r-2*v-(s-1)*c)/s;b>1&&(b>>=0);var w=i===+i?Math.min(b,i):b;l=o.reduce(function(_,x,S){var j=[].concat(zH(_),[{item:x.item,position:{offset:v+(b+c)*S+(b-w)/2,size:w}}]);return x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){j.push({item:E,position:j[j.length-1].position})}),j},u)}return l},bPe=function(e,t,n,r){var a=n.children,o=n.width,i=n.margin,s=o-(i.left||0)-(i.right||0),c=BH({children:a,legendWidth:s});if(c){var l=r||{},u=l.width,d=l.height,f=c.align,p=c.verticalAlign,m=c.layout;if((m==="vertical"||m==="horizontal"&&p==="middle")&&f!=="center"&&we(e[f]))return tn(tn({},e),{},Il({},f,e[f]+(u||0)));if((m==="horizontal"||m==="vertical"&&f==="center")&&p!=="middle"&&we(e[p]))return tn(tn({},e),{},Il({},p,e[p]+(d||0)))}return e},wPe=function(e,t,n){return Ot(t)?!0:e==="horizontal"?t==="yAxis":e==="vertical"||n==="x"?t==="xAxis":n==="y"?t==="yAxis":!0},VH=function(e,t,n,r,a){var o=t.props.children,i=Pa(o,Ag).filter(function(c){return wPe(r,a,c.props.direction)});if(i&&i.length){var s=i.map(function(c){return c.props.dataKey});return e.reduce(function(c,l){var u=oo(l,n);if(Ot(u))return c;var d=Array.isArray(u)?[Og(u),Eg(u)]:[u,u],f=s.reduce(function(p,m){var y=oo(l,m,0),v=d[0]-Math.abs(Array.isArray(y)?y[0]:y),b=d[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(v,p[0]),Math.max(b,p[1])]},[1/0,-1/0]);return[Math.min(f[0],c[0]),Math.max(f[1],c[1])]},[1/0,-1/0])}return null},xPe=function(e,t,n,r,a){var o=t.map(function(i){return VH(e,i,n,a,r)}).filter(function(i){return!Ot(i)});return o&&o.length?o.reduce(function(i,s){return[Math.min(i[0],s[0]),Math.max(i[1],s[1])]},[1/0,-1/0]):null},WH=function(e,t,n,r,a){var o=t.map(function(s){var c=s.props.dataKey;return n==="number"&&c&&VH(e,s,c,r)||Tg(e,c,n,a)});if(n==="number")return o.reduce(function(s,c){return[Math.min(s[0],c[0]),Math.max(s[1],c[1])]},[1/0,-1/0]);var i={};return o.reduce(function(s,c){for(var l=0,u=c.length;l<u;l++)i[c[l]]||(i[c[l]]=!0,s.push(c[l]));return s},[])},HH=function(e,t){return e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis"},qH=function(e,t,n,r){if(r)return e.map(function(s){return s.coordinate});var a,o,i=e.map(function(s){return s.coordinate===t&&(a=!0),s.coordinate===n&&(o=!0),s.coordinate});return a||i.push(t),o||i.push(n),i},ri=function(e,t,n){if(!e)return null;var r=e.scale,a=e.duplicateDomain,o=e.type,i=e.range,s=e.realScaleType==="scaleBand"?r.bandwidth()/2:2,c=(t||n)&&o==="category"&&r.bandwidth?r.bandwidth()/s:0;if(c=e.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?ka(i[0]-i[1])*2*c:c,t&&(e.ticks||e.niceTicks)){var l=(e.ticks||e.niceTicks).map(function(u){var d=a?a.indexOf(u):u;return{coordinate:r(d)+c,value:u,offset:c}});return l.filter(function(u){return!yf(u.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(u,d){return{coordinate:r(u)+c,value:u,index:d,offset:c}}):r.ticks&&!n?r.ticks(e.tickCount).map(function(u){return{coordinate:r(u)+c,value:u,offset:c}}):r.domain().map(function(u,d){return{coordinate:r(u)+c,value:a?a[u]:u,index:d,offset:c}})},gk=new WeakMap,Rg=function(e,t){if(typeof t!="function")return e;gk.has(e)||gk.set(e,new WeakMap);var n=gk.get(e);if(n.has(t))return n.get(t);var r=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return n.set(t,r),r},_Pe=function(e,t,n){var r=e.scale,a=e.type,o=e.layout,i=e.axisType;if(r==="auto")return o==="radial"&&i==="radiusAxis"?{scale:kf(),realScaleType:"band"}:o==="radial"&&i==="angleAxis"?{scale:yg(),realScaleType:"linear"}:a==="category"&&t&&(t.indexOf("LineChart")>=0||t.indexOf("AreaChart")>=0||t.indexOf("ComposedChart")>=0&&!n)?{scale:Pf(),realScaleType:"point"}:a==="category"?{scale:kf(),realScaleType:"band"}:{scale:yg(),realScaleType:"linear"};if(mf(r)){var s="scale".concat(Hy(r));return{scale:(uH[s]||Pf)(),realScaleType:uH[s]?s:"point"}}return lt(r)?{scale:r}:{scale:Pf(),realScaleType:"point"}},ZH=1e-4,SPe=function(e){var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-ZH,o=Math.max(r[0],r[1])+ZH,i=e(t[0]),s=e(t[n-1]);(i<a||i>o||s<a||s>o)&&e.domain([t[0],t[n-1]])}},jPe=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null},EPe=function(e,t){if(!t||t.length!==2||!we(t[0])||!we(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!we(e[0])||e[0]<n)&&(a[0]=n),(!we(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a},OPe=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0,i=0;i<t;++i){var s=yf(e[i][n][1])?e[i][n][0]:e[i][n][1];s>=0?(e[i][n][0]=a,e[i][n][1]=a+s,a=e[i][n][1]):(e[i][n][0]=o,e[i][n][1]=o+s,o=e[i][n][1])}},CPe=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0;o<t;++o){var i=yf(e[o][n][1])?e[o][n][0]:e[o][n][1];i>=0?(e[o][n][0]=a,e[o][n][1]=a+i,a=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}},kPe={sign:OPe,expand:PSe,none:wl,silhouette:NSe,wiggle:MSe,positive:CPe},PPe=function(e,t,n){var r=t.map(function(i){return i.props.dataKey}),a=kPe[n],o=kSe().keys(r).value(function(i,s){return+oo(i,s,0)}).order(EO).offset(a);return o(e)},NPe=function(e,t,n,r,a,o){if(!e)return null;var i=o?t.reverse():t,s={},c=i.reduce(function(u,d){var f,p=(f=d.type)!==null&&f!==void 0&&f.defaultProps?tn(tn({},d.type.defaultProps),d.props):d.props,m=p.stackId,y=p.hide;if(y)return u;var v=p[n],b=u[v]||{hasStack:!1,stackGroups:{}};if(yn(m)){var w=b.stackGroups[m]||{numericAxisId:n,cateAxisId:r,items:[]};w.items.push(d),b.hasStack=!0,b.stackGroups[m]=w}else b.stackGroups[Uy("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[d]};return tn(tn({},u),{},Il({},v,b))},s),l={};return Object.keys(c).reduce(function(u,d){var f=c[d];if(f.hasStack){var p={};f.stackGroups=Object.keys(f.stackGroups).reduce(function(m,y){var v=f.stackGroups[y];return tn(tn({},m),{},Il({},y,{numericAxisId:n,cateAxisId:r,items:v.items,stackedData:PPe(e,v.items,a)}))},p)}return tn(tn({},u),{},Il({},d,f))},l)},MPe=function(e,t){var n=t.realScaleType,r=t.type,a=t.tickCount,o=t.originalDomain,i=t.allowDecimals,s=n||t.scale;if(s!=="auto"&&s!=="linear")return null;if(a&&r==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=e.domain();if(!c.length)return null;var l=Uke(c,a,i);return e.domain([Og(l),Eg(l)]),{niceTicks:l}}if(a&&r==="number"){var u=e.domain(),d=Vke(u,a,i);return{niceTicks:d}}return null},KH=function(e){var t=e.axis,n=e.ticks,r=e.offset,a=e.bandSize,o=e.entry,i=e.index;if(t.type==="category")return n[i]?n[i].coordinate+r:null;var s=oo(o,t.dataKey,t.domain[i]);return Ot(s)?null:t.scale(s)-a/2+r},APe=function(e){var t=e.numericAxis,n=t.scale.domain();if(t.type==="number"){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]},TPe=function(e,t){var n,r=(n=e.type)!==null&&n!==void 0&&n.defaultProps?tn(tn({},e.type.defaultProps),e.props):e.props,a=r.stackId;if(yn(a)){var o=t[a];if(o){var i=o.items.indexOf(e);return i>=0?o.stackedData[i]:null}}return null},RPe=function(e){return e.reduce(function(t,n){return[Og(n.concat([t[0]]).filter(we)),Eg(n.concat([t[1]]).filter(we))]},[1/0,-1/0])},XH=function(e,t,n){return Object.keys(e).reduce(function(r,a){var o=e[a],i=o.stackedData,s=i.reduce(function(c,l){var u=RPe(l.slice(t,n+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]).map(function(r){return r===1/0||r===-1/0?0:r})},YH=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,JH=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,vk=function(e,t,n){if(lt(e))return e(t,n);if(!Array.isArray(e))return t;var r=[];if(we(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(YH.test(e[0])){var a=+YH.exec(e[0])[1];r[0]=t[0]-a}else lt(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(we(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(JH.test(e[1])){var o=+JH.exec(e[1])[1];r[1]=t[1]+o}else lt(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},Ig=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=lC(t,function(u){return u.coordinate}),o=1/0,i=1,s=a.length;i<s;i++){var c=a[i],l=a[i-1];o=Math.min((c.coordinate||0)-(l.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},QH=function(e,t,n){return!e||!e.length||ok(e,Rr(n,"type.defaultProps.domain"))?t:e},GH=function(e,t){var n=e.type.defaultProps?tn(tn({},e.type.defaultProps),e.props):e.props,r=n.dataKey,a=n.name,o=n.unit,i=n.formatter,s=n.tooltipType,c=n.chartType,l=n.hide;return tn(tn({},Et(e,!1)),{},{dataKey:r,unit:o,formatter:i,name:a||r,color:yk(e),value:oo(t,r),type:s,payload:t,chartType:c,hide:l})};function Bf(e){"@babel/helpers - typeof";return Bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bf(e)}function eq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function tq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?eq(Object(n),!0).forEach(function(r){IPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function IPe(e,t,n){return t=DPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DPe(e){var t=LPe(e,"string");return Bf(t)=="symbol"?t:t+""}function LPe(e,t){if(Bf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dg=Math.PI/180,$Pe=function(e){return e*180/Math.PI},An=function(e,t,n,r){return{x:e+Math.cos(-Dg*r)*n,y:t+Math.sin(-Dg*r)*n}},FPe=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-o,2))},BPe=function(e,t){var n=e.x,r=e.y,a=t.cx,o=t.cy,i=FPe({x:n,y:r},{x:a,y:o});if(i<=0)return{radius:i};var s=(n-a)/i,c=Math.acos(s);return r>o&&(c=2*Math.PI-c),{radius:i,angle:$Pe(c),angleInRadian:c}},zPe=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),a=Math.floor(n/360),o=Math.min(r,a);return{startAngle:t-o*360,endAngle:n-o*360}},UPe=function(e,t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),o=Math.floor(r/360),i=Math.min(a,o);return e+i*360},nq=function(e,t){var n=e.x,r=e.y,a=BPe({x:n,y:r},t),o=a.radius,i=a.angle,s=t.innerRadius,c=t.outerRadius;if(o<s||o>c)return!1;if(o===0)return!0;var l=zPe(t),u=l.startAngle,d=l.endAngle,f=i,p;if(u<=d){for(;f>d;)f-=360;for(;f<u;)f+=360;p=f>=u&&f<=d}else{for(;f>u;)f-=360;for(;f<d;)f+=360;p=f>=d&&f<=u}return p?tq(tq({},t),{},{radius:o,angle:UPe(f,t)}):null};function zf(e){"@babel/helpers - typeof";return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zf(e)}var VPe=["offset"];function WPe(e){return KPe(e)||ZPe(e)||qPe(e)||HPe()}function HPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qPe(e,t){if(e){if(typeof e=="string")return bk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bk(e,t)}}function ZPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KPe(e){if(Array.isArray(e))return bk(e)}function bk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function XPe(e,t){if(e==null)return{};var n=YPe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YPe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function rq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function vn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rq(Object(n),!0).forEach(function(r){JPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function JPe(e,t,n){return t=QPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QPe(e){var t=GPe(e,"string");return zf(t)=="symbol"?t:t+""}function GPe(e,t){if(zf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(zf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uf(){return Uf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Uf.apply(this,arguments)}var eNe=function(e){var t=e.value,n=e.formatter,r=Ot(e.children)?t:e.children;return lt(n)?n(r):r},tNe=function(e,t){var n=ka(t-e),r=Math.min(Math.abs(t-e),360);return n*r},nNe=function(e,t,n){var r=e.position,a=e.viewBox,o=e.offset,i=e.className,s=a,c=s.cx,l=s.cy,u=s.innerRadius,d=s.outerRadius,f=s.startAngle,p=s.endAngle,m=s.clockWise,y=(u+d)/2,v=tNe(f,p),b=v>=0?1:-1,w,_;r==="insideStart"?(w=f+b*o,_=m):r==="insideEnd"?(w=p-b*o,_=!m):r==="end"&&(w=p+b*o,_=m),_=v<=0?_:!_;var x=An(c,l,y,w),S=An(c,l,y,w+(_?1:-1)*359),j="M".concat(x.x,",").concat(x.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(_?0:1,`,
    `).concat(S.x,",").concat(S.y),E=Ot(e.id)?Uy("recharts-radial-line-"):e.id;return Y.createElement("text",Uf({},n,{dominantBaseline:"central",className:Pt("recharts-radial-bar-label",i)}),Y.createElement("defs",null,Y.createElement("path",{id:E,d:j})),Y.createElement("textPath",{xlinkHref:"#".concat(E)},t))},rNe=function(e){var t=e.viewBox,n=e.offset,r=e.position,a=t,o=a.cx,i=a.cy,s=a.innerRadius,c=a.outerRadius,l=a.startAngle,u=a.endAngle,d=(l+u)/2;if(r==="outside"){var f=An(o,i,c+n,d),p=f.x,m=f.y;return{x:p,y:m,textAnchor:p>=o?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"end"};var y=(s+c)/2,v=An(o,i,y,d),b=v.x,w=v.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},aNe=function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,a=e.position,o=t,i=o.x,s=o.y,c=o.width,l=o.height,u=l>=0?1:-1,d=u*r,f=u>0?"end":"start",p=u>0?"start":"end",m=c>=0?1:-1,y=m*r,v=m>0?"end":"start",b=m>0?"start":"end";if(a==="top"){var w={x:i+c/2,y:s-u*r,textAnchor:"middle",verticalAnchor:f};return vn(vn({},w),n?{height:Math.max(s-n.y,0),width:c}:{})}if(a==="bottom"){var _={x:i+c/2,y:s+l+d,textAnchor:"middle",verticalAnchor:p};return vn(vn({},_),n?{height:Math.max(n.y+n.height-(s+l),0),width:c}:{})}if(a==="left"){var x={x:i-y,y:s+l/2,textAnchor:v,verticalAnchor:"middle"};return vn(vn({},x),n?{width:Math.max(x.x-n.x,0),height:l}:{})}if(a==="right"){var S={x:i+c+y,y:s+l/2,textAnchor:b,verticalAnchor:"middle"};return vn(vn({},S),n?{width:Math.max(n.x+n.width-S.x,0),height:l}:{})}var j=n?{width:c,height:l}:{};return a==="insideLeft"?vn({x:i+y,y:s+l/2,textAnchor:b,verticalAnchor:"middle"},j):a==="insideRight"?vn({x:i+c-y,y:s+l/2,textAnchor:v,verticalAnchor:"middle"},j):a==="insideTop"?vn({x:i+c/2,y:s+d,textAnchor:"middle",verticalAnchor:p},j):a==="insideBottom"?vn({x:i+c/2,y:s+l-d,textAnchor:"middle",verticalAnchor:f},j):a==="insideTopLeft"?vn({x:i+y,y:s+d,textAnchor:b,verticalAnchor:p},j):a==="insideTopRight"?vn({x:i+c-y,y:s+d,textAnchor:v,verticalAnchor:p},j):a==="insideBottomLeft"?vn({x:i+y,y:s+l-d,textAnchor:b,verticalAnchor:f},j):a==="insideBottomRight"?vn({x:i+c-y,y:s+l-d,textAnchor:v,verticalAnchor:f},j):gl(a)&&(we(a.x)||Os(a.x))&&(we(a.y)||Os(a.y))?vn({x:i+Cs(a.x,c),y:s+Cs(a.y,l),textAnchor:"end",verticalAnchor:"end"},j):vn({x:i+c/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},j)},oNe=function(e){return"cx"in e&&we(e.cx)};function Bn(e){var t=e.offset,n=t===void 0?5:t,r=XPe(e,VPe),a=vn({offset:n},r),o=a.viewBox,i=a.position,s=a.value,c=a.children,l=a.content,u=a.className,d=u===void 0?"":u,f=a.textBreakAll;if(!o||Ot(s)&&Ot(c)&&!g.isValidElement(l)&&!lt(l))return null;if(g.isValidElement(l))return g.cloneElement(l,a);var p;if(lt(l)){if(p=g.createElement(l,a),g.isValidElement(p))return p}else p=eNe(a);var m=oNe(o),y=Et(a,!0);if(m&&(i==="insideStart"||i==="insideEnd"||i==="end"))return nNe(a,p,y);var v=m?rNe(a):aNe(a);return Y.createElement(ug,Uf({className:Pt("recharts-label",d)},y,v,{breakAll:f}),p)}Bn.displayName="Label";var aq=function(e){var t=e.cx,n=e.cy,r=e.angle,a=e.startAngle,o=e.endAngle,i=e.r,s=e.radius,c=e.innerRadius,l=e.outerRadius,u=e.x,d=e.y,f=e.top,p=e.left,m=e.width,y=e.height,v=e.clockWise,b=e.labelViewBox;if(b)return b;if(we(m)&&we(y)){if(we(u)&&we(d))return{x:u,y:d,width:m,height:y};if(we(f)&&we(p))return{x:f,y:p,width:m,height:y}}return we(u)&&we(d)?{x:u,y:d,width:0,height:0}:we(t)&&we(n)?{cx:t,cy:n,startAngle:a||r||0,endAngle:o||r||0,innerRadius:c||0,outerRadius:l||s||i||0,clockWise:v}:e.viewBox?e.viewBox:{}},iNe=function(e,t){return e?e===!0?Y.createElement(Bn,{key:"label-implicit",viewBox:t}):yn(e)?Y.createElement(Bn,{key:"label-implicit",viewBox:t,value:e}):g.isValidElement(e)?e.type===Bn?g.cloneElement(e,{key:"label-implicit",viewBox:t}):Y.createElement(Bn,{key:"label-implicit",content:e,viewBox:t}):lt(e)?Y.createElement(Bn,{key:"label-implicit",content:e,viewBox:t}):gl(e)?Y.createElement(Bn,Uf({viewBox:t},e,{key:"label-implicit"})):null:null},sNe=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=aq(e),o=Pa(r,Bn).map(function(s,c){return g.cloneElement(s,{viewBox:t||a,key:"label-".concat(c)})});if(!n)return o;var i=iNe(e.label,t||a);return[i].concat(WPe(o))};Bn.parseViewBox=aq,Bn.renderCallByParent=sNe;var wk,oq;qN=function(){if(oq)return wk;oq=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return wk=e,wk};var cNe=qN();oN=ft(cNe);function Vf(e){"@babel/helpers - typeof";return Vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vf(e)}var lNe=["valueAccessor"],uNe=["data","dataKey","clockWise","id","textBreakAll"];function dNe(e){return mNe(e)||hNe(e)||pNe(e)||fNe()}function fNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pNe(e,t){if(e){if(typeof e=="string")return xk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xk(e,t)}}function hNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mNe(e){if(Array.isArray(e))return xk(e)}function xk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lg(){return Lg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Lg.apply(this,arguments)}function iq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function sq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iq(Object(n),!0).forEach(function(r){yNe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yNe(e,t,n){return t=gNe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gNe(e){var t=vNe(e,"string");return Vf(t)=="symbol"?t:t+""}function vNe(e,t){if(Vf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Vf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cq(e,t){if(e==null)return{};var n=bNe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bNe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var wNe=function(e){return Array.isArray(e.value)?oN(e.value):e.value};function Ls(e){var t=e.valueAccessor,n=t===void 0?wNe:t,r=cq(e,lNe),a=r.data,o=r.dataKey,i=r.clockWise,s=r.id,c=r.textBreakAll,l=cq(r,uNe);return!a||!a.length?null:Y.createElement(_n,{className:"recharts-label-list"},a.map(function(u,d){var f=Ot(o)?n(u,d):oo(u&&u.payload,o),p=Ot(s)?{}:{id:"".concat(s,"-").concat(d)};return Y.createElement(Bn,Lg({},Et(u,!0),l,p,{parentViewBox:u.parentViewBox,value:f,textBreakAll:c,viewBox:Bn.parseViewBox(Ot(i)?u:sq(sq({},u),{},{clockWise:i})),key:"label-".concat(d),index:d}))}))}Ls.displayName="LabelList";function xNe(e,t){return e?e===!0?Y.createElement(Ls,{key:"labelList-implicit",data:t}):Y.isValidElement(e)||lt(e)?Y.createElement(Ls,{key:"labelList-implicit",data:t,content:e}):gl(e)?Y.createElement(Ls,Lg({data:t},e,{key:"labelList-implicit"})):null:null}function _Ne(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=Pa(r,Ls).map(function(i,s){return g.cloneElement(i,{data:t,key:"labelList-".concat(s)})});if(!n)return a;var o=xNe(e.label,t);return[o].concat(dNe(a))}Ls.renderCallByParent=_Ne;function Wf(e){"@babel/helpers - typeof";return Wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wf(e)}function _k(){return _k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_k.apply(this,arguments)}function lq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function uq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lq(Object(n),!0).forEach(function(r){SNe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function SNe(e,t,n){return t=jNe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jNe(e){var t=ENe(e,"string");return Wf(t)=="symbol"?t:t+""}function ENe(e,t){if(Wf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Wf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ONe=function(e,t){var n=ka(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},$g=function(e){var t=e.cx,n=e.cy,r=e.radius,a=e.angle,o=e.sign,i=e.isExternal,s=e.cornerRadius,c=e.cornerIsExternal,l=s*(i?1:-1)+r,u=Math.asin(s/l)/Dg,d=c?a:a+o*u,f=An(t,n,l,d),p=An(t,n,r,d),m=c?a-o*u:a,y=An(t,n,l*Math.cos(u*Dg),m);return{center:f,circleTangency:p,lineTangency:y,theta:u}},dq=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.startAngle,i=e.endAngle,s=ONe(o,i),c=o+s,l=An(t,n,a,o),u=An(t,n,a,c),d="M ".concat(l.x,",").concat(l.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(o>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(r>0){var f=An(t,n,r,o),p=An(t,n,r,c);d+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(o<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},CNe=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.cornerRadius,i=e.forceCornerRadius,s=e.cornerIsExternal,c=e.startAngle,l=e.endAngle,u=ka(l-c),d=$g({cx:t,cy:n,radius:a,angle:c,sign:u,cornerRadius:o,cornerIsExternal:s}),f=d.circleTangency,p=d.lineTangency,m=d.theta,y=$g({cx:t,cy:n,radius:a,angle:l,sign:-u,cornerRadius:o,cornerIsExternal:s}),v=y.circleTangency,b=y.lineTangency,w=y.theta,_=s?Math.abs(c-l):Math.abs(c-l)-m-w;if(_<0)return i?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):dq({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:c,endAngle:l});var x="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(_>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(r>0){var S=$g({cx:t,cy:n,radius:r,angle:c,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),j=S.circleTangency,E=S.lineTangency,O=S.theta,P=$g({cx:t,cy:n,radius:r,angle:l,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),k=P.circleTangency,N=P.lineTangency,R=P.theta,M=s?Math.abs(c-l):Math.abs(c-l)-O-R;if(M<0&&o===0)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(N.x,",").concat(N.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(k.x,",").concat(k.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(M>180),",").concat(+(u>0),",").concat(j.x,",").concat(j.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(E.x,",").concat(E.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x},kNe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},fq=function(e){var t=uq(uq({},kNe),e),n=t.cx,r=t.cy,a=t.innerRadius,o=t.outerRadius,i=t.cornerRadius,s=t.forceCornerRadius,c=t.cornerIsExternal,l=t.startAngle,u=t.endAngle,d=t.className;if(o<a||l===u)return null;var f=Pt("recharts-sector",d),p=o-a,m=Cs(i,p,0,!0),y;return m>0&&Math.abs(l-u)<360?y=CNe({cx:n,cy:r,innerRadius:a,outerRadius:o,cornerRadius:Math.min(m,p/2),forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u}):y=dq({cx:n,cy:r,innerRadius:a,outerRadius:o,startAngle:l,endAngle:u}),Y.createElement("path",_k({},Et(t,!0),{className:f,d:y,role:"img"}))};function Hf(e){"@babel/helpers - typeof";return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hf(e)}function Sk(){return Sk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sk.apply(this,arguments)}function pq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function hq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pq(Object(n),!0).forEach(function(r){PNe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function PNe(e,t,n){return t=NNe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NNe(e){var t=MNe(e,"string");return Hf(t)=="symbol"?t:t+""}function MNe(e,t){if(Hf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Hf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mq={curveBasisClosed:gSe,curveBasisOpen:vSe,curveBasis:ySe,curveBumpX:nSe,curveBumpY:rSe,curveLinearClosed:bSe,curveLinear:Xy,curveMonotoneX:wSe,curveMonotoneY:xSe,curveNatural:_Se,curveStep:SSe,curveStepAfter:ESe,curveStepBefore:jSe},Fg=function(e){return e.x===+e.x&&e.y===+e.y},qf=function(e){return e.x},Zf=function(e){return e.y},ANe=function(e,t){if(lt(e))return e;var n="curve".concat(Hy(e));return(n==="curveMonotone"||n==="curveBump")&&t?mq["".concat(n).concat(t==="vertical"?"Y":"X")]:mq[n]||Xy},TNe=function(e){var t=e.type,n=t===void 0?"linear":t,r=e.points,a=r===void 0?[]:r,o=e.baseLine,i=e.layout,s=e.connectNulls,c=s===void 0?!1:s,l=ANe(n,i),u=c?a.filter(function(m){return Fg(m)}):a,d;if(Array.isArray(o)){var f=c?o.filter(function(m){return Fg(m)}):o,p=u.map(function(m,y){return hq(hq({},m),{},{base:f[y]})});return i==="vertical"?d=Yy().y(Zf).x1(qf).x0(function(m){return m.base.x}):d=Yy().x(qf).y1(Zf).y0(function(m){return m.base.y}),d.defined(Fg).curve(l),d(p)}return i==="vertical"&&we(o)?d=Yy().y(Zf).x1(qf).x0(o):we(o)?d=Yy().x(qf).y1(Zf).y0(o):d=bU().x(qf).y(Zf),d.defined(Fg).curve(l),d(u)},yq=function(e){var t=e.className,n=e.points,r=e.path,a=e.pathRef;if((!n||!n.length)&&!r)return null;var o=n&&n.length?TNe(e):r;return Y.createElement("path",Sk({},Et(e,!1),Vy(e),{className:Pt("recharts-curve",t),d:o,ref:a}))},gq={exports:{}},jk,vq;function RNe(){if(vq)return jk;vq=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return jk=e,jk}var Ek,bq;function INe(){if(bq)return Ek;bq=1;var e=RNe();function t(){}function n(){}return n.resetWarningCache=t,Ek=function(){function r(i,s,c,l,u,d){if(d!==e){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o},Ek}var wq;function DNe(){return wq||(wq=1,gq.exports=INe()()),gq.exports}var LNe=DNe();const et=ft(LNe);var $Ne=Object.getOwnPropertyNames,FNe=Object.getOwnPropertySymbols,BNe=Object.prototype.hasOwnProperty;function xq(e,t){return function(n,r,a){return e(n,r,a)&&t(n,r,a)}}function Bg(e){return function(t,n,r){if(!t||!n||typeof t!="object"||typeof n!="object")return e(t,n,r);var a=r.cache,o=a.get(t),i=a.get(n);if(o&&i)return o===n&&i===t;a.set(t,n),a.set(n,t);var s=e(t,n,r);return a.delete(t),a.delete(n),s}}function _q(e){return $Ne(e).concat(FNe(e))}var Sq=Object.hasOwn||function(e,t){return BNe.call(e,t)};function Dl(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var jq="_owner",Eq=Object.getOwnPropertyDescriptor,Oq=Object.keys;function zNe(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function UNe(e,t){return Dl(e.getTime(),t.getTime())}function Cq(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.entries(),o=0,i,s;(i=a.next())&&!i.done;){for(var c=t.entries(),l=!1,u=0;(s=c.next())&&!s.done;){var d=i.value,f=d[0],p=d[1],m=s.value,y=m[0],v=m[1];!l&&!r[u]&&(l=n.equals(f,y,o,u,e,t,n)&&n.equals(p,v,f,y,e,t,n))&&(r[u]=!0),u++}if(!l)return!1;o++}return!0}function VNe(e,t,n){var r=Oq(e),a=r.length;if(Oq(t).length!==a)return!1;for(var o;a-- >0;)if(o=r[a],o===jq&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Sq(t,o)||!n.equals(e[o],t[o],o,o,e,t,n))return!1;return!0}function Kf(e,t,n){var r=_q(e),a=r.length;if(_q(t).length!==a)return!1;for(var o,i,s;a-- >0;)if(o=r[a],o===jq&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Sq(t,o)||!n.equals(e[o],t[o],o,o,e,t,n)||(i=Eq(e,o),s=Eq(t,o),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return!1;return!0}function WNe(e,t){return Dl(e.valueOf(),t.valueOf())}function HNe(e,t){return e.source===t.source&&e.flags===t.flags}function kq(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.values(),o,i;(o=a.next())&&!o.done;){for(var s=t.values(),c=!1,l=0;(i=s.next())&&!i.done;)!c&&!r[l]&&(c=n.equals(o.value,i.value,o.value,i.value,e,t,n))&&(r[l]=!0),l++;if(!c)return!1}return!0}function qNe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var ZNe="[object Arguments]",KNe="[object Boolean]",XNe="[object Date]",YNe="[object Map]",JNe="[object Number]",QNe="[object Object]",GNe="[object RegExp]",eMe="[object Set]",tMe="[object String]",nMe=Array.isArray,Pq=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Nq=Object.assign,rMe=Object.prototype.toString.call.bind(Object.prototype.toString);function aMe(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,a=e.areObjectsEqual,o=e.arePrimitiveWrappersEqual,i=e.areRegExpsEqual,s=e.areSetsEqual,c=e.areTypedArraysEqual;return function(l,u,d){if(l===u)return!0;if(l==null||u==null||typeof l!="object"||typeof u!="object")return l!==l&&u!==u;var f=l.constructor;if(f!==u.constructor)return!1;if(f===Object)return a(l,u,d);if(nMe(l))return t(l,u,d);if(Pq!=null&&Pq(l))return c(l,u,d);if(f===Date)return n(l,u,d);if(f===RegExp)return i(l,u,d);if(f===Map)return r(l,u,d);if(f===Set)return s(l,u,d);var p=rMe(l);return p===XNe?n(l,u,d):p===GNe?i(l,u,d):p===YNe?r(l,u,d):p===eMe?s(l,u,d):p===QNe?typeof l.then!="function"&&typeof u.then!="function"&&a(l,u,d):p===ZNe?a(l,u,d):p===KNe||p===JNe||p===tMe?o(l,u,d):!1}}function oMe(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,a={areArraysEqual:r?Kf:zNe,areDatesEqual:UNe,areMapsEqual:r?xq(Cq,Kf):Cq,areObjectsEqual:r?Kf:VNe,arePrimitiveWrappersEqual:WNe,areRegExpsEqual:HNe,areSetsEqual:r?xq(kq,Kf):kq,areTypedArraysEqual:r?Kf:qNe};if(n&&(a=Nq({},a,n(a))),t){var o=Bg(a.areArraysEqual),i=Bg(a.areMapsEqual),s=Bg(a.areObjectsEqual),c=Bg(a.areSetsEqual);a=Nq({},a,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c})}return a}function iMe(e){return function(t,n,r,a,o,i,s){return e(t,n,s)}}function sMe(e){var t=e.circular,n=e.comparator,r=e.createState,a=e.equals,o=e.strict;if(r)return function(s,c){var l=r(),u=l.cache,d=u===void 0?t?new WeakMap:void 0:u,f=l.meta;return n(s,c,{cache:d,equals:a,meta:f,strict:o})};if(t)return function(s,c){return n(s,c,{cache:new WeakMap,equals:a,meta:void 0,strict:o})};var i={cache:void 0,equals:a,meta:void 0,strict:o};return function(s,c){return n(s,c,i)}}var cMe=Ui();Ui({strict:!0}),Ui({circular:!0}),Ui({circular:!0,strict:!0}),Ui({createInternalComparator:function(){return Dl}}),Ui({strict:!0,createInternalComparator:function(){return Dl}}),Ui({circular:!0,createInternalComparator:function(){return Dl}}),Ui({circular:!0,createInternalComparator:function(){return Dl},strict:!0});function Ui(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,a=e.createState,o=e.strict,i=o===void 0?!1:o,s=oMe(e),c=aMe(s),l=r?r(c):iMe(c);return sMe({circular:n,comparator:c,createState:a,equals:l,strict:i})}function lMe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Mq(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function a(o){n<0&&(n=o),o-n>t?(e(o),n=-1):lMe(a)};requestAnimationFrame(r)}function Ok(e){"@babel/helpers - typeof";return Ok=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ok(e)}function uMe(e){return hMe(e)||pMe(e)||fMe(e)||dMe()}function dMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fMe(e,t){if(e){if(typeof e=="string")return Aq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Aq(e,t)}}function Aq(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hMe(e){if(Array.isArray(e))return e}function mMe(){var e={},t=function(){return null},n=!1,r=function a(o){if(!n){if(Array.isArray(o)){if(!o.length)return;var i=o,s=uMe(i),c=s[0],l=s.slice(1);if(typeof c=="number"){Mq(a.bind(null,l),c);return}a(c),Mq(a.bind(null,l));return}Ok(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){n=!0},start:function(a){n=!1,r(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function Xf(e){"@babel/helpers - typeof";return Xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xf(e)}function Tq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Rq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Tq(Object(n),!0).forEach(function(r){Iq(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Iq(e,t,n){return t=yMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yMe(e){var t=gMe(e,"string");return Xf(t)==="symbol"?t:String(t)}function gMe(e,t){if(Xf(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Xf(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vMe=function(e,t){return[Object.keys(e),Object.keys(t)].reduce(function(n,r){return n.filter(function(a){return r.includes(a)})})},bMe=function(e){return e},wMe=function(e){return e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})},Yf=function(e,t){return Object.keys(t).reduce(function(n,r){return Rq(Rq({},n),{},Iq({},r,e(r,t[r])))},{})},Dq=function(e,t,n){return e.map(function(r){return"".concat(wMe(r)," ").concat(t,"ms ").concat(n)}).join(",")};function xMe(e,t){return jMe(e)||SMe(e,t)||Lq(e,t)||_Me()}function _Me(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SMe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function jMe(e){if(Array.isArray(e))return e}function EMe(e){return kMe(e)||CMe(e)||Lq(e)||OMe()}function OMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lq(e,t){if(e){if(typeof e=="string")return Ck(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ck(e,t)}}function CMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kMe(e){if(Array.isArray(e))return Ck(e)}function Ck(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var zg=1e-4,$q=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},Fq=function(e,t){return e.map(function(n,r){return n*Math.pow(t,r)}).reduce(function(n,r){return n+r})},Bq=function(e,t){return function(n){var r=$q(e,t);return Fq(r,n)}},PMe=function(e,t){return function(n){var r=$q(e,t),a=[].concat(EMe(r.map(function(o,i){return o*i}).slice(1)),[0]);return Fq(a,n)}},zq=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],o=t[2],i=t[3];if(t.length===1)switch(t[0]){case"linear":r=0,a=0,o=1,i=1;break;case"ease":r=.25,a=.1,o=.25,i=1;break;case"ease-in":r=.42,a=0,o=1,i=1;break;case"ease-out":r=.42,a=0,o=.58,i=1;break;case"ease-in-out":r=0,a=0,o=.58,i=1;break;default:{var s=t[0].split("(");if(s[0]==="cubic-bezier"&&s[1].split(")")[0].split(",").length===4){var c=s[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),l=xMe(c,4);r=l[0],a=l[1],o=l[2],i=l[3]}}}var u=Bq(r,o),d=Bq(a,i),f=PMe(r,o),p=function(y){return y>1?1:y<0?0:y},m=function(y){for(var v=y>1?1:y,b=v,w=0;w<8;++w){var _=u(b)-v,x=f(b);if(Math.abs(_-v)<zg||x<zg)return d(b);b=p(b-_/x)}return d(b)};return m.isStepper=!1,m},NMe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.stiff,n=t===void 0?100:t,r=e.damping,a=r===void 0?8:r,o=e.dt,i=o===void 0?17:o,s=function(c,l,u){var d=-(c-l)*n,f=u*a,p=u+(d-f)*i/1e3,m=u*i/1e3+c;return Math.abs(m-l)<zg&&Math.abs(p)<zg?[l,0]:[m,p]};return s.isStepper=!0,s.dt=i,s},MMe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if(typeof r=="string")switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return zq(r);case"spring":return NMe();default:if(r.split("(")[0]==="cubic-bezier")return zq(r)}return typeof r=="function"?r:null};function Jf(e){"@babel/helpers - typeof";return Jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jf(e)}function Uq(e){return RMe(e)||TMe(e)||Wq(e)||AMe()}function AMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RMe(e){if(Array.isArray(e))return Pk(e)}function Vq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Tn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vq(Object(n),!0).forEach(function(r){kk(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function kk(e,t,n){return t=IMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IMe(e){var t=DMe(e,"string");return Jf(t)==="symbol"?t:String(t)}function DMe(e,t){if(Jf(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Jf(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LMe(e,t){return BMe(e)||FMe(e,t)||Wq(e,t)||$Me()}function $Me(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wq(e,t){if(e){if(typeof e=="string")return Pk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pk(e,t)}}function Pk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function FMe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function BMe(e){if(Array.isArray(e))return e}var Ug=function(e,t,n){return e+(t-e)*n},Nk=function(e){var t=e.from,n=e.to;return t!==n},zMe=function e(t,n,r){var a=Yf(function(o,i){if(Nk(i)){var s=t(i.from,i.to,i.velocity),c=LMe(s,2),l=c[0],u=c[1];return Tn(Tn({},i),{},{from:l,velocity:u})}return i},n);return r<1?Yf(function(o,i){return Nk(i)?Tn(Tn({},i),{},{velocity:Ug(i.velocity,a[o].velocity,r),from:Ug(i.from,a[o].from,r)}):i},n):e(t,a,r-1)};const UMe=function(e,t,n,r,a){var o=vMe(e,t),i=o.reduce(function(v,b){return Tn(Tn({},v),{},kk({},b,[e[b],t[b]]))},{}),s=o.reduce(function(v,b){return Tn(Tn({},v),{},kk({},b,{from:e[b],velocity:0,to:t[b]}))},{}),c=-1,l,u,d=function(){return null},f=function(){return Yf(function(v,b){return b.from},s)},p=function(){return!Object.values(s).filter(Nk).length},m=function(v){l||(l=v);var b=v-l,w=b/n.dt;s=zMe(n,s,w),a(Tn(Tn(Tn({},e),t),f())),l=v,p()||(c=requestAnimationFrame(d))},y=function(v){u||(u=v);var b=(v-u)/r,w=Yf(function(x,S){return Ug.apply(void 0,Uq(S).concat([n(b)]))},i);if(a(Tn(Tn(Tn({},e),t),w)),b<1)c=requestAnimationFrame(d);else{var _=Yf(function(x,S){return Ug.apply(void 0,Uq(S).concat([n(1)]))},i);a(Tn(Tn(Tn({},e),t),_))}};return d=n.isStepper?m:y,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(c)}}};function Ll(e){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ll(e)}var VMe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function WMe(e,t){if(e==null)return{};var n=HMe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function HMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,o;for(o=0;o<r.length;o++)a=r[o],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function Mk(e){return XMe(e)||KMe(e)||ZMe(e)||qMe()}function qMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZMe(e,t){if(e){if(typeof e=="string")return Ak(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ak(e,t)}}function KMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XMe(e){if(Array.isArray(e))return Ak(e)}function Ak(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Hq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Ma(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Hq(Object(n),!0).forEach(function(r){Qf(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Qf(e,t,n){return t=qq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JMe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,qq(r.key),r)}}function QMe(e,t,n){return t&&JMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qq(e){var t=GMe(e,"string");return Ll(t)==="symbol"?t:String(t)}function GMe(e,t){if(Ll(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ll(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tk(e,t)}function Tk(e,t){return Tk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Tk(e,t)}function tAe(e){var t=nAe();return function(){var n=Vg(e),r;if(t){var a=Vg(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Rk(this,r)}}function Rk(e,t){if(t&&(Ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ik(e)}function Ik(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vg(e){return Vg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vg(e)}var Vi=function(e){eAe(n,e);var t=tAe(n);function n(r,a){var o;YMe(this,n),o=t.call(this,r,a);var i=o.props,s=i.isActive,c=i.attributeName,l=i.from,u=i.to,d=i.steps,f=i.children,p=i.duration;if(o.handleStyleChange=o.handleStyleChange.bind(Ik(o)),o.changeStyle=o.changeStyle.bind(Ik(o)),!s||p<=0)return o.state={style:{}},typeof f=="function"&&(o.state={style:u}),Rk(o);if(d&&d.length)o.state={style:d[0].style};else if(l){if(typeof f=="function")return o.state={style:l},Rk(o);o.state={style:c?Qf({},c,l):l}}else o.state={style:{}};return o}return QMe(n,[{key:"componentDidMount",value:function(){var r=this.props,a=r.isActive,o=r.canBegin;this.mounted=!0,!(!a||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(r){var a=this.props,o=a.isActive,i=a.canBegin,s=a.attributeName,c=a.shouldReAnimate,l=a.to,u=a.from,d=this.state.style;if(i){if(!o){var f={style:s?Qf({},s,l):l};this.state&&d&&(s&&d[s]!==l||!s&&d!==l)&&this.setState(f);return}if(!(cMe(r.to,l)&&r.canBegin&&r.isActive)){var p=!r.canBegin||!r.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var m=p||c?u:r.to;if(this.state&&d){var y={style:s?Qf({},s,m):m};(s&&d[s]!==m||!s&&d!==m)&&this.setState(y)}this.runAnimation(Ma(Ma({},this.props),{},{from:m,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var r=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),r&&r()}},{key:"handleStyleChange",value:function(r){this.changeStyle(r)}},{key:"changeStyle",value:function(r){this.mounted&&this.setState({style:r})}},{key:"runJSAnimation",value:function(r){var a=this,o=r.from,i=r.to,s=r.duration,c=r.easing,l=r.begin,u=r.onAnimationEnd,d=r.onAnimationStart,f=UMe(o,i,MMe(c),s,this.changeStyle),p=function(){a.stopJSAnimation=f()};this.manager.start([d,l,p,s,u])}},{key:"runStepAnimation",value:function(r){var a=this,o=r.steps,i=r.begin,s=r.onAnimationStart,c=o[0],l=c.style,u=c.duration,d=u===void 0?0:u,f=function(p,m,y){if(y===0)return p;var v=m.duration,b=m.easing,w=b===void 0?"ease":b,_=m.style,x=m.properties,S=m.onAnimationEnd,j=y>0?o[y-1]:m,E=x||Object.keys(_);if(typeof w=="function"||w==="spring")return[].concat(Mk(p),[a.runJSAnimation.bind(a,{from:j.style,to:_,duration:v,easing:w}),v]);var O=Dq(E,v,w),P=Ma(Ma(Ma({},j.style),_),{},{transition:O});return[].concat(Mk(p),[P,v,S]).filter(bMe)};return this.manager.start([s].concat(Mk(o.reduce(f,[l,Math.max(d,i)])),[r.onAnimationEnd]))}},{key:"runAnimation",value:function(r){this.manager||(this.manager=mMe());var a=r.begin,o=r.duration,i=r.attributeName,s=r.to,c=r.easing,l=r.onAnimationStart,u=r.onAnimationEnd,d=r.steps,f=r.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof c=="function"||typeof f=="function"||c==="spring"){this.runJSAnimation(r);return}if(d.length>1){this.runStepAnimation(r);return}var m=i?Qf({},i,s):s,y=Dq(Object.keys(m),o,c);p.start([l,a,Ma(Ma({},m),{},{transition:y}),o,u])}},{key:"render",value:function(){var r=this.props,a=r.children;r.begin;var o=r.duration;r.attributeName,r.easing;var i=r.isActive;r.steps,r.from,r.to,r.canBegin,r.onAnimationEnd,r.shouldReAnimate,r.onAnimationReStart;var s=WMe(r,VMe),c=g.Children.count(a),l=this.state.style;if(typeof a=="function")return a(l);if(!i||c===0||o<=0)return a;var u=function(d){var f=d.props,p=f.style,m=p===void 0?{}:p,y=f.className,v=g.cloneElement(d,Ma(Ma({},s),{},{style:Ma(Ma({},m),l),className:y}));return v};return c===1?u(g.Children.only(a)):Y.createElement("div",null,g.Children.map(a,function(d){return u(d)}))}}]),n}(g.PureComponent);Vi.displayName="Animate",Vi.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},Vi.propTypes={from:et.oneOfType([et.object,et.string]),to:et.oneOfType([et.object,et.string]),attributeName:et.string,duration:et.number,begin:et.number,easing:et.oneOfType([et.string,et.func]),steps:et.arrayOf(et.shape({duration:et.number.isRequired,style:et.object.isRequired,easing:et.oneOfType([et.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),et.func]),properties:et.arrayOf("string"),onAnimationEnd:et.func})),children:et.oneOfType([et.node,et.func]),isActive:et.bool,canBegin:et.bool,onAnimationEnd:et.func,shouldReAnimate:et.bool,onAnimationStart:et.func,onAnimationReStart:et.func},et.object,et.object,et.object,et.element,et.object,et.object,et.object,et.oneOfType([et.array,et.element]),et.any;function Gf(e){"@babel/helpers - typeof";return Gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gf(e)}function Wg(){return Wg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wg.apply(this,arguments)}function rAe(e,t){return sAe(e)||iAe(e,t)||oAe(e,t)||aAe()}function aAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oAe(e,t){if(e){if(typeof e=="string")return Zq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zq(e,t)}}function Zq(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function sAe(e){if(Array.isArray(e))return e}function Kq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Xq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Kq(Object(n),!0).forEach(function(r){cAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function cAe(e,t,n){return t=lAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lAe(e){var t=uAe(e,"string");return Gf(t)=="symbol"?t:t+""}function uAe(e,t){if(Gf(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Gf(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yq=function(e,t,n,r,a){var o=Math.min(Math.abs(n)/2,Math.abs(r)/2),i=r>=0?1:-1,s=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0,l;if(o>0&&a instanceof Array){for(var u=[0,0,0,0],d=0,f=4;d<f;d++)u[d]=a[d]>o?o:a[d];l="M".concat(e,",").concat(t+i*u[0]),u[0]>0&&(l+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+s*u[0],",").concat(t)),l+="L ".concat(e+n-s*u[1],",").concat(t),u[1]>0&&(l+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+n,",").concat(t+i*u[1])),l+="L ".concat(e+n,",").concat(t+r-i*u[2]),u[2]>0&&(l+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+n-s*u[2],",").concat(t+r)),l+="L ".concat(e+s*u[3],",").concat(t+r),u[3]>0&&(l+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+r-i*u[3])),l+="Z"}else if(o>0&&a===+a&&a>0){var p=Math.min(o,a);l="M ".concat(e,",").concat(t+i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+s*p,",").concat(t,`
            L `).concat(e+n-s*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+n,",").concat(t+i*p,`
            L `).concat(e+n,",").concat(t+r-i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+n-s*p,",").concat(t+r,`
            L `).concat(e+s*p,",").concat(t+r,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(t+r-i*p," Z")}else l="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return l},dAe=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,a=t.x,o=t.y,i=t.width,s=t.height;if(Math.abs(i)>0&&Math.abs(s)>0){var c=Math.min(a,a+i),l=Math.max(a,a+i),u=Math.min(o,o+s),d=Math.max(o,o+s);return n>=c&&n<=l&&r>=u&&r<=d}return!1},fAe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Dk=function(e){var t=Xq(Xq({},fAe),e),n=g.useRef(),r=g.useState(-1),a=rAe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var _=n.current.getTotalLength();_&&i(_)}catch{}},[]);var s=t.x,c=t.y,l=t.width,u=t.height,d=t.radius,f=t.className,p=t.animationEasing,m=t.animationDuration,y=t.animationBegin,v=t.isAnimationActive,b=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||l===0||u===0)return null;var w=Pt("recharts-rectangle",f);return b?Y.createElement(Vi,{canBegin:o>0,from:{width:l,height:u,x:s,y:c},to:{width:l,height:u,x:s,y:c},duration:m,animationEasing:p,isActive:b},function(_){var x=_.width,S=_.height,j=_.x,E=_.y;return Y.createElement(Vi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:m,isActive:v,easing:p},Y.createElement("path",Wg({},Et(t,!0),{className:w,d:Yq(j,E,x,S,d),ref:n})))}):Y.createElement("path",Wg({},Et(t,!0),{className:w,d:Yq(s,c,l,u,d)}))};function Lk(){return Lk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Lk.apply(this,arguments)}var Jq=function(e){var t=e.cx,n=e.cy,r=e.r,a=e.className,o=Pt("recharts-dot",a);return t===+t&&n===+n&&r===+r?Y.createElement("circle",Lk({},Et(e,!1),Vy(e),{className:o,cx:t,cy:n,r})):null};function ep(e){"@babel/helpers - typeof";return ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ep(e)}var pAe=["x","y","top","left","width","height","className"];function $k(){return $k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$k.apply(this,arguments)}function Qq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function hAe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Qq(Object(n),!0).forEach(function(r){mAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function mAe(e,t,n){return t=yAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yAe(e){var t=gAe(e,"string");return ep(t)=="symbol"?t:t+""}function gAe(e,t){if(ep(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ep(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vAe(e,t){if(e==null)return{};var n=bAe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bAe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var wAe=function(e,t,n,r,a,o){return"M".concat(e,",").concat(a,"v").concat(r,"M").concat(o,",").concat(t,"h").concat(n)},xAe=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.top,i=o===void 0?0:o,s=e.left,c=s===void 0?0:s,l=e.width,u=l===void 0?0:l,d=e.height,f=d===void 0?0:d,p=e.className,m=vAe(e,pAe),y=hAe({x:n,y:a,top:i,left:c,width:u,height:f},m);return!we(n)||!we(a)||!we(u)||!we(f)||!we(i)||!we(c)?null:Y.createElement("path",$k({},Et(y,!0),{className:Pt("recharts-cross",p),d:wAe(n,a,u,f,i,c)}))},Fk,Gq;GP=function(){if(Gq)return Fk;Gq=1;var e=Po(),t=E0(),n=Ia(),r="[object Object]",a=Function.prototype,o=Object.prototype,i=a.toString,s=o.hasOwnProperty,c=i.call(Object);function l(u){if(!n(u)||e(u)!=r)return!1;var d=t(u);if(d===null)return!0;var f=s.call(d,"constructor")&&d.constructor;return typeof f=="function"&&f instanceof f&&i.call(f)==c}return Fk=l,Fk};var _Ae=GP();const SAe=ft(_Ae);var Bk,eZ;function jAe(){if(eZ)return Bk;eZ=1;var e=Po(),t=Ia(),n="[object Boolean]";function r(a){return a===!0||a===!1||t(a)&&e(a)==n}return Bk=r,Bk}var EAe=jAe();const OAe=ft(EAe);function tp(e){"@babel/helpers - typeof";return tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tp(e)}function Hg(){return Hg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hg.apply(this,arguments)}function CAe(e,t){return MAe(e)||NAe(e,t)||PAe(e,t)||kAe()}function kAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PAe(e,t){if(e){if(typeof e=="string")return tZ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tZ(e,t)}}function tZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function NAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function MAe(e){if(Array.isArray(e))return e}function nZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function rZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nZ(Object(n),!0).forEach(function(r){AAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function AAe(e,t,n){return t=TAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TAe(e){var t=RAe(e,"string");return tp(t)=="symbol"?t:t+""}function RAe(e,t){if(tp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(tp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aZ=function(e,t,n,r,a){var o=n-r,i;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+n,",").concat(t),i+="L ".concat(e+n-o/2,",").concat(t+a),i+="L ".concat(e+n-o/2-r,",").concat(t+a),i+="L ".concat(e,",").concat(t," Z"),i},IAe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},DAe=function(e){var t=rZ(rZ({},IAe),e),n=g.useRef(),r=g.useState(-1),a=CAe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&i(w)}catch{}},[]);var s=t.x,c=t.y,l=t.upperWidth,u=t.lowerWidth,d=t.height,f=t.className,p=t.animationEasing,m=t.animationDuration,y=t.animationBegin,v=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||d!==+d||l===0&&u===0||d===0)return null;var b=Pt("recharts-trapezoid",f);return v?Y.createElement(Vi,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:d,x:s,y:c},to:{upperWidth:l,lowerWidth:u,height:d,x:s,y:c},duration:m,animationEasing:p,isActive:v},function(w){var _=w.upperWidth,x=w.lowerWidth,S=w.height,j=w.x,E=w.y;return Y.createElement(Vi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:m,easing:p},Y.createElement("path",Hg({},Et(t,!0),{className:b,d:aZ(j,E,_,x,S),ref:n})))}):Y.createElement("g",null,Y.createElement("path",Hg({},Et(t,!0),{className:b,d:aZ(s,c,l,u,d)})))},LAe=["option","shapeType","propTransformer","activeClassName","isActive"];function np(e){"@babel/helpers - typeof";return np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},np(e)}function $Ae(e,t){if(e==null)return{};var n=FAe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function FAe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function oZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oZ(Object(n),!0).forEach(function(r){BAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function BAe(e,t,n){return t=zAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zAe(e){var t=UAe(e,"string");return np(t)=="symbol"?t:t+""}function UAe(e,t){if(np(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(np(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VAe(e,t){return qg(qg({},t),e)}function WAe(e,t){return e==="symbols"}function iZ(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return Y.createElement(Dk,n);case"trapezoid":return Y.createElement(DAe,n);case"sector":return Y.createElement(fq,n);case"symbols":if(WAe(t))return Y.createElement(CO,n);break;default:return null}}function HAe(e){return g.isValidElement(e)?e.props:e}function qAe(e){var t=e.option,n=e.shapeType,r=e.propTransformer,a=r===void 0?VAe:r,o=e.activeClassName,i=o===void 0?"recharts-active-shape":o,s=e.isActive,c=$Ae(e,LAe),l;if(g.isValidElement(t))l=g.cloneElement(t,qg(qg({},c),HAe(t)));else if(lt(t))l=t(c);else if(SAe(t)&&!OAe(t)){var u=a(t,c);l=Y.createElement(iZ,{shapeType:n,elementProps:u})}else{var d=c;l=Y.createElement(iZ,{shapeType:n,elementProps:d})}return s?Y.createElement(_n,{className:i},l):l}function Zg(e,t){return t!=null&&"trapezoids"in e.props}function Kg(e,t){return t!=null&&"sectors"in e.props}function rp(e,t){return t!=null&&"points"in e.props}function ZAe(e,t){var n,r,a=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,o=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return a&&o}function KAe(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function XAe(e,t){var n=e.x===t.x,r=e.y===t.y,a=e.z===t.z;return n&&r&&a}function YAe(e,t){var n;return Zg(e,t)?n=ZAe:Kg(e,t)?n=KAe:rp(e,t)&&(n=XAe),n}function JAe(e,t){var n;return Zg(e,t)?n="trapezoids":Kg(e,t)?n="sectors":rp(e,t)&&(n="points"),n}function QAe(e,t){if(Zg(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(Kg(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return rp(e,t)?t.payload:{}}function GAe(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,a=JAe(n,t),o=QAe(n,t),i=r.filter(function(c,l){var u=ok(o,c),d=n.props[a].filter(function(m){var y=YAe(n,t);return y(m,t)}),f=n.props[a].indexOf(d[d.length-1]),p=l===f;return u&&p}),s=r.indexOf(i[i.length-1]);return s}var zk,sZ;function e2e(){if(sZ)return zk;sZ=1;var e=Math.ceil,t=Math.max;function n(r,a,o,i){for(var s=-1,c=t(e((a-r)/(o||1)),0),l=Array(c);c--;)l[i?c:++s]=r,r+=o;return l}return zk=n,zk}var Uk,cZ;function t2e(){if(cZ)return Uk;cZ=1;var e=e2e(),t=qs(),n=wB();function r(a){return function(o,i,s){return s&&typeof s!="number"&&t(o,i,s)&&(i=s=void 0),o=n(o),i===void 0?(i=o,o=0):i=n(i),s=s===void 0?o<i?1:-1:n(s),e(o,i,s,a)}}return Uk=r,Uk}var Vk,lZ;function n2e(){if(lZ)return Vk;lZ=1;var e=t2e(),t=e();return Vk=t,Vk}var r2e=n2e();const Xg=ft(r2e);function ap(e){"@babel/helpers - typeof";return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function uZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function dZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uZ(Object(n),!0).forEach(function(r){fZ(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function fZ(e,t,n){return t=a2e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a2e(e){var t=o2e(e,"string");return ap(t)=="symbol"?t:t+""}function o2e(e,t){if(ap(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ap(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i2e=["Webkit","Moz","O","ms"],s2e=function(e,t){var n=e.replace(/(\w)/,function(a){return a.toUpperCase()}),r=i2e.reduce(function(a,o){return dZ(dZ({},a),{},fZ({},o+n,t))},{});return r[e]=t,r};function $l(e){"@babel/helpers - typeof";return $l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$l(e)}function Yg(){return Yg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yg.apply(this,arguments)}function pZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Wk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pZ(Object(n),!0).forEach(function(r){Cr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function c2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yZ(r.key),r)}}function l2e(e,t,n){return t&&hZ(e.prototype,t),n&&hZ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u2e(e,t,n){return t=Jg(t),d2e(e,mZ()?Reflect.construct(t,n||[],Jg(e).constructor):t.apply(e,n))}function d2e(e,t){if(t&&($l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f2e(e)}function f2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mZ=function(){return!!e})()}function Jg(e){return Jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jg(e)}function p2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hk(e,t)}function Hk(e,t){return Hk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Hk(e,t)}function Cr(e,t,n){return t=yZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yZ(e){var t=h2e(e,"string");return $l(t)=="symbol"?t:t+""}function h2e(e,t){if($l(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if($l(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var m2e=function(e){var t=e.data,n=e.startIndex,r=e.endIndex,a=e.x,o=e.width,i=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,c=Pf().domain(Xg(0,s)).range([a,a+o-i]),l=c.domain().map(function(u){return c(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(n),endX:c(r),scale:c,scaleValues:l}},gZ=function(e){return e.changedTouches&&!!e.changedTouches.length},Fl=function(e){function t(n){var r;return c2e(this,t),r=u2e(this,t,[n]),Cr(r,"handleDrag",function(a){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(a):r.state.isSlideMoving&&r.handleSlideDrag(a)}),Cr(r,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&r.handleDrag(a.changedTouches[0])}),Cr(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=r.props,o=a.endIndex,i=a.onDragEnd,s=a.startIndex;i==null||i({endIndex:o,startIndex:s})}),r.detachDragEndListener()}),Cr(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),Cr(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),Cr(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),Cr(r,"handleSlideDragStart",function(a){var o=gZ(a)?a.changedTouches[0]:a;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return p2e(t,e),l2e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var r=n.startX,a=n.endX,o=this.state.scaleValues,i=this.props,s=i.gap,c=i.data,l=c.length-1,u=Math.min(r,a),d=Math.max(r,a),f=t.getIndexInRange(o,u),p=t.getIndexInRange(o,d);return{startIndex:f-f%s,endIndex:p===l?l:p-p%s}}},{key:"getTextOfTick",value:function(n){var r=this.props,a=r.data,o=r.tickFormatter,i=r.dataKey,s=oo(a[n],i,n);return lt(o)?o(s,n):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var r=this.state,a=r.slideMoveStartX,o=r.startX,i=r.endX,s=this.props,c=s.x,l=s.width,u=s.travellerWidth,d=s.startIndex,f=s.endIndex,p=s.onChange,m=n.pageX-a;m>0?m=Math.min(m,c+l-u-i,c+l-u-o):m<0&&(m=Math.max(m,c-o,c-i));var y=this.getIndex({startX:o+m,endX:i+m});(y.startIndex!==d||y.endIndex!==f)&&p&&p(y),this.setState({startX:o+m,endX:i+m,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,r){var a=gZ(r)?r.changedTouches[0]:r;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var r=this.state,a=r.brushMoveStartX,o=r.movingTravellerId,i=r.endX,s=r.startX,c=this.state[o],l=this.props,u=l.x,d=l.width,f=l.travellerWidth,p=l.onChange,m=l.gap,y=l.data,v={startX:this.state.startX,endX:this.state.endX},b=n.pageX-a;b>0?b=Math.min(b,u+d-f-c):b<0&&(b=Math.max(b,u-c)),v[o]=c+b;var w=this.getIndex(v),_=w.startIndex,x=w.endIndex,S=function(){var j=y.length-1;return o==="startX"&&(i>s?_%m===0:x%m===0)||i<s&&x===j||o==="endX"&&(i>s?x%m===0:_%m===0)||i>s&&x===j};this.setState(Cr(Cr({},o,c+b),"brushMoveStartX",n.pageX),function(){p&&S()&&p(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,r){var a=this,o=this.state,i=o.scaleValues,s=o.startX,c=o.endX,l=this.state[r],u=i.indexOf(l);if(u!==-1){var d=u+n;if(!(d===-1||d>=i.length)){var f=i[d];r==="startX"&&f>=c||r==="endX"&&f<=s||this.setState(Cr({},r,f),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.fill,c=n.stroke;return Y.createElement("rect",{stroke:c,fill:s,x:r,y:a,width:o,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.data,c=n.children,l=n.padding,u=g.Children.only(c);return u?Y.cloneElement(u,{x:r,y:a,width:o,height:i,margin:l,compact:!0,data:s}):null}},{key:"renderTravellerLayer",value:function(n,r){var a,o,i=this,s=this.props,c=s.y,l=s.travellerWidth,u=s.height,d=s.traveller,f=s.ariaLabel,p=s.data,m=s.startIndex,y=s.endIndex,v=Math.max(n,this.props.x),b=Wk(Wk({},Et(this.props,!1)),{},{x:v,y:c,width:l,height:u}),w=f||"Min value: ".concat((a=p[m])===null||a===void 0?void 0:a.name,", Max value: ").concat((o=p[y])===null||o===void 0?void 0:o.name);return Y.createElement(_n,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),i.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,r))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(d,b))}},{key:"renderSlide",value:function(n,r){var a=this.props,o=a.y,i=a.height,s=a.stroke,c=a.travellerWidth,l=Math.min(n,r)+c,u=Math.max(Math.abs(r-n)-c,0);return Y.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:s,fillOpacity:.2,x:l,y:o,width:u,height:i})}},{key:"renderText",value:function(){var n=this.props,r=n.startIndex,a=n.endIndex,o=n.y,i=n.height,s=n.travellerWidth,c=n.stroke,l=this.state,u=l.startX,d=l.endX,f=5,p={pointerEvents:"none",fill:c};return Y.createElement(_n,{className:"recharts-brush-texts"},Y.createElement(ug,Yg({textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,d)-f,y:o+i/2},p),this.getTextOfTick(r)),Y.createElement(ug,Yg({textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,d)+s+f,y:o+i/2},p),this.getTextOfTick(a)))}},{key:"render",value:function(){var n=this.props,r=n.data,a=n.className,o=n.children,i=n.x,s=n.y,c=n.width,l=n.height,u=n.alwaysShowText,d=this.state,f=d.startX,p=d.endX,m=d.isTextActive,y=d.isSlideMoving,v=d.isTravellerMoving,b=d.isTravellerFocused;if(!r||!r.length||!we(i)||!we(s)||!we(c)||!we(l)||c<=0||l<=0)return null;var w=Pt("recharts-brush",a),_=Y.Children.count(o)===1,x=s2e("userSelect","none");return Y.createElement(_n,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:x},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(f,p),this.renderTravellerLayer(f,"startX"),this.renderTravellerLayer(p,"endX"),(m||y||v||b||u)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var r=n.x,a=n.y,o=n.width,i=n.height,s=n.stroke,c=Math.floor(a+i/2)-1;return Y.createElement(Y.Fragment,null,Y.createElement("rect",{x:r,y:a,width:o,height:i,fill:s,stroke:"none"}),Y.createElement("line",{x1:r+1,y1:c,x2:r+o-1,y2:c,fill:"none",stroke:"#fff"}),Y.createElement("line",{x1:r+1,y1:c+2,x2:r+o-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,r){var a;return Y.isValidElement(n)?a=Y.cloneElement(n,r):lt(n)?a=n(r):a=t.renderDefaultTraveller(r),a}},{key:"getDerivedStateFromProps",value:function(n,r){var a=n.data,o=n.width,i=n.x,s=n.travellerWidth,c=n.updateId,l=n.startIndex,u=n.endIndex;if(a!==r.prevData||c!==r.prevUpdateId)return Wk({prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o},a&&a.length?m2e({data:a,width:o,x:i,travellerWidth:s,startIndex:l,endIndex:u}):{scale:null,scaleValues:null});if(r.scale&&(o!==r.prevWidth||i!==r.prevX||s!==r.prevTravellerWidth)){r.scale.range([i,i+o-s]);var d=r.scale.domain().map(function(f){return r.scale(f)});return{prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o,startX:r.scale(n.startIndex),endX:r.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,r){for(var a=n.length,o=0,i=a-1;i-o>1;){var s=Math.floor((o+i)/2);n[s]>r?i=s:o=s}return r>=n[i]?i:o}}])}(g.PureComponent);Cr(Fl,"displayName","Brush"),Cr(Fl,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var qk,vZ;function y2e(){if(vZ)return qk;vZ=1;var e=XO();function t(n,r){var a;return e(n,function(o,i,s){return a=r(o,i,s),!a}),!!a}return qk=t,qk}var Zk,bZ;function g2e(){if(bZ)return Zk;bZ=1;var e=rD(),t=Wa(),n=y2e(),r=qn(),a=qs();function o(i,s,c){var l=r(i)?e:n;return c&&a(i,s,c)&&(s=void 0),l(i,t(s,3))}return Zk=o,Zk}var v2e=g2e();const b2e=ft(v2e);var io=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},Kk,wZ;function w2e(){if(wZ)return Kk;wZ=1;var e=Rv(),t=lV(),n=Wa();function r(a,o){var i={};return o=n(o,3),t(a,function(s,c,l){e(i,c,o(s,c,l))}),i}return Kk=r,Kk}var x2e=w2e();const _2e=ft(x2e);var Xk,xZ;function S2e(){if(xZ)return Xk;xZ=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(!n(t[r],r,t))return!1;return!0}return Xk=e,Xk}var Yk,_Z;function j2e(){if(_Z)return Yk;_Z=1;var e=XO();function t(n,r){var a=!0;return e(n,function(o,i,s){return a=!!r(o,i,s),a}),a}return Yk=t,Yk}var Jk,SZ;function E2e(){if(SZ)return Jk;SZ=1;var e=S2e(),t=j2e(),n=Wa(),r=qn(),a=qs();function o(i,s,c){var l=r(i)?e:t;return c&&a(i,s,c)&&(s=void 0),l(i,n(s,3))}return Jk=o,Jk}var O2e=E2e();const jZ=ft(O2e);var C2e=["x","y"];function op(e){"@babel/helpers - typeof";return op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},op(e)}function Qk(){return Qk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qk.apply(this,arguments)}function EZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ip(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EZ(Object(n),!0).forEach(function(r){k2e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function k2e(e,t,n){return t=P2e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P2e(e){var t=N2e(e,"string");return op(t)=="symbol"?t:t+""}function N2e(e,t){if(op(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(op(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M2e(e,t){if(e==null)return{};var n=A2e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function A2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function T2e(e,t){var n=e.x,r=e.y,a=M2e(e,C2e),o="".concat(n),i=parseInt(o,10),s="".concat(r),c=parseInt(s,10),l="".concat(t.height||a.height),u=parseInt(l,10),d="".concat(t.width||a.width),f=parseInt(d,10);return ip(ip(ip(ip(ip({},t),a),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function OZ(e){return Y.createElement(qAe,Qk({shapeType:"rectangle",propTransformer:T2e,activeClassName:"recharts-active-bar"},e))}var R2e=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,r){if(typeof e=="number")return e;var a=typeof n=="number";return a?e(n,r):(a||Is(),t)}},I2e=["value","background"],CZ;function Bl(e){"@babel/helpers - typeof";return Bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bl(e)}function D2e(e,t){if(e==null)return{};var n=L2e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function L2e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Qg(){return Qg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qg.apply(this,arguments)}function kZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function dn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kZ(Object(n),!0).forEach(function(r){Wi(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,MZ(r.key),r)}}function F2e(e,t,n){return t&&PZ(e.prototype,t),n&&PZ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function B2e(e,t,n){return t=Gg(t),z2e(e,NZ()?Reflect.construct(t,n||[],Gg(e).constructor):t.apply(e,n))}function z2e(e,t){if(t&&(Bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U2e(e)}function U2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NZ=function(){return!!e})()}function Gg(e){return Gg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gg(e)}function V2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gk(e,t)}function Gk(e,t){return Gk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Gk(e,t)}function Wi(e,t,n){return t=MZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MZ(e){var t=W2e(e,"string");return Bl(t)=="symbol"?t:t+""}function W2e(e,t){if(Bl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $s=function(e){function t(){var n;$2e(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=B2e(this,t,[].concat(a)),Wi(n,"state",{isAnimationFinished:!1}),Wi(n,"id",Uy("recharts-bar-")),Wi(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),i&&i()}),Wi(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),i&&i()}),n}return V2e(t,e),F2e(t,[{key:"renderRectanglesStatically",value:function(n){var r=this,a=this.props,o=a.shape,i=a.dataKey,s=a.activeIndex,c=a.activeBar,l=Et(this.props,!1);return n&&n.map(function(u,d){var f=d===s,p=f?c:o,m=dn(dn(dn({},l),u),{},{isActive:f,option:p,index:d,dataKey:i,onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd});return Y.createElement(_n,Qg({className:"recharts-bar-rectangle"},Wy(r.props,u,d),{key:"rectangle-".concat(u==null?void 0:u.x,"-").concat(u==null?void 0:u.y,"-").concat(u==null?void 0:u.value)}),Y.createElement(OZ,m))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,r=this.props,a=r.data,o=r.layout,i=r.isAnimationActive,s=r.animationBegin,c=r.animationDuration,l=r.animationEasing,u=r.animationId,d=this.state.prevData;return Y.createElement(Vi,{begin:s,duration:c,isActive:i,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(f){var p=f.t,m=a.map(function(y,v){var b=d&&d[v];if(b){var w=vl(b.x,y.x),_=vl(b.y,y.y),x=vl(b.width,y.width),S=vl(b.height,y.height);return dn(dn({},y),{},{x:w(p),y:_(p),width:x(p),height:S(p)})}if(o==="horizontal"){var j=vl(0,y.height),E=j(p);return dn(dn({},y),{},{y:y.y+y.height-E,height:E})}var O=vl(0,y.width),P=O(p);return dn(dn({},y),{},{width:P})});return Y.createElement(_n,null,n.renderRectanglesStatically(m))})}},{key:"renderRectangles",value:function(){var n=this.props,r=n.data,a=n.isAnimationActive,o=this.state.prevData;return a&&r&&r.length&&(!o||!ok(o,r))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(r)}},{key:"renderBackground",value:function(){var n=this,r=this.props,a=r.data,o=r.dataKey,i=r.activeIndex,s=Et(this.props.background,!1);return a.map(function(c,l){c.value;var u=c.background,d=D2e(c,I2e);if(!u)return null;var f=dn(dn(dn(dn(dn({},d),{},{fill:"#eee"},u),s),Wy(n.props,c,l)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:l,className:"recharts-bar-background-rectangle"});return Y.createElement(OZ,Qg({key:"background-bar-".concat(l),option:n.props.background,isActive:l===i},f))})}},{key:"renderErrorBar",value:function(n,r){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.data,i=a.xAxis,s=a.yAxis,c=a.layout,l=a.children,u=Pa(l,Ag);if(!u)return null;var d=c==="vertical"?o[0].height/2:o[0].width/2,f=function(m,y){var v=Array.isArray(m.value)?m.value[1]:m.value;return{x:m.x,y:m.y,value:v,errorVal:oo(m,y)}},p={clipPath:n?"url(#clipPath-".concat(r,")"):null};return Y.createElement(_n,p,u.map(function(m){return Y.cloneElement(m,{key:"error-bar-".concat(r,"-").concat(m.props.dataKey),data:o,xAxis:i,yAxis:s,layout:c,offset:d,dataPointFormatter:f})}))}},{key:"render",value:function(){var n=this.props,r=n.hide,a=n.data,o=n.className,i=n.xAxis,s=n.yAxis,c=n.left,l=n.top,u=n.width,d=n.height,f=n.isAnimationActive,p=n.background,m=n.id;if(r||!a||!a.length)return null;var y=this.state.isAnimationFinished,v=Pt("recharts-bar",o),b=i&&i.allowDataOverflow,w=s&&s.allowDataOverflow,_=b||w,x=Ot(m)?this.id:m;return Y.createElement(_n,{className:v},b||w?Y.createElement("defs",null,Y.createElement("clipPath",{id:"clipPath-".concat(x)},Y.createElement("rect",{x:b?c:c-u/2,y:w?l:l-d/2,width:b?u:u*2,height:w?d:d*2}))):null,Y.createElement(_n,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(x,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,x),(!f||y)&&Ls.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,r){return n.animationId!==r.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:r.curData}:n.data!==r.curData?{curData:n.data}:null}}])}(g.PureComponent);CZ=$s,Wi($s,"displayName","Bar"),Wi($s,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Li.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),Wi($s,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,o=e.xAxis,i=e.yAxis,s=e.xAxisTicks,c=e.yAxisTicks,l=e.stackedData,u=e.dataStartIndex,d=e.displayedData,f=e.offset,p=jPe(r,n);if(!p)return null;var m=t.layout,y=n.type.defaultProps,v=y!==void 0?dn(dn({},y),n.props):n.props,b=v.dataKey,w=v.children,_=v.minPointSize,x=m==="horizontal"?i:o,S=l?x.scale.domain():null,j=APe({numericAxis:x}),E=Pa(w,VV),O=d.map(function(P,k){var N,R,M,C,T,A;l?N=EPe(l[u+k],S):(N=oo(P,b),Array.isArray(N)||(N=[j,N]));var I=R2e(_,CZ.defaultProps.minPointSize)(N[1],k);if(m==="horizontal"){var F,D=[i.scale(N[0]),i.scale(N[1])],V=D[0],U=D[1];R=KH({axis:o,ticks:s,bandSize:a,offset:p.offset,entry:P,index:k}),M=(F=U??V)!==null&&F!==void 0?F:void 0,C=p.size;var B=V-U;if(T=Number.isNaN(B)?0:B,A={x:R,y:i.y,width:C,height:i.height},Math.abs(I)>0&&Math.abs(T)<Math.abs(I)){var K=ka(T||I)*(Math.abs(I)-Math.abs(T));M-=K,T+=K}}else{var te=[o.scale(N[0]),o.scale(N[1])],L=te[0],$=te[1];if(R=L,M=KH({axis:i,ticks:c,bandSize:a,offset:p.offset,entry:P,index:k}),C=$-L,T=p.size,A={x:o.x,y:M,width:o.width,height:T},Math.abs(I)>0&&Math.abs(C)<Math.abs(I)){var W=ka(C||I)*(Math.abs(I)-Math.abs(C));C+=W}}return dn(dn(dn({},P),{},{x:R,y:M,width:C,height:T,value:l?N:N[1],payload:P,background:A},E&&E[k]&&E[k].props),{},{tooltipPayload:[GH(n,P)],tooltipPosition:{x:R+C/2,y:M+T/2}})});return dn({data:O,layout:m},f)});function sp(e){"@babel/helpers - typeof";return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(e)}function H2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,RZ(r.key),r)}}function q2e(e,t,n){return t&&AZ(e.prototype,t),n&&AZ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function TZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Aa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TZ(Object(n),!0).forEach(function(r){ev(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ev(e,t,n){return t=RZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RZ(e){var t=Z2e(e,"string");return sp(t)=="symbol"?t:t+""}function Z2e(e,t){if(sp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(sp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K2e=function(e,t,n,r,a){var o=e.width,i=e.height,s=e.layout,c=e.children,l=Object.keys(t),u={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},d=!!Er(c,$s);return l.reduce(function(f,p){var m=t[p],y=m.orientation,v=m.domain,b=m.padding,w=b===void 0?{}:b,_=m.mirror,x=m.reversed,S="".concat(y).concat(_?"Mirror":""),j,E,O,P,k;if(m.type==="number"&&(m.padding==="gap"||m.padding==="no-gap")){var N=v[1]-v[0],R=1/0,M=m.categoricalDomain.sort();if(M.forEach(function(K,te){te>0&&(R=Math.min((K||0)-(M[te-1]||0),R))}),Number.isFinite(R)){var C=R/N,T=m.layout==="vertical"?n.height:n.width;if(m.padding==="gap"&&(j=C*T/2),m.padding==="no-gap"){var A=Cs(e.barCategoryGap,C*T),I=C*T/2;j=I-A-(I-A)/T*A}}}r==="xAxis"?E=[n.left+(w.left||0)+(j||0),n.left+n.width-(w.right||0)-(j||0)]:r==="yAxis"?E=s==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(j||0),n.top+n.height-(w.bottom||0)-(j||0)]:E=m.range,x&&(E=[E[1],E[0]]);var F=_Pe(m,a,d),D=F.scale,V=F.realScaleType;D.domain(v).range(E),SPe(D);var U=MPe(D,Aa(Aa({},m),{},{realScaleType:V}));r==="xAxis"?(k=y==="top"&&!_||y==="bottom"&&_,O=n.left,P=u[S]-k*m.height):r==="yAxis"&&(k=y==="left"&&!_||y==="right"&&_,O=u[S]-k*m.width,P=n.top);var B=Aa(Aa(Aa({},m),U),{},{realScaleType:V,x:O,y:P,scale:D,width:r==="xAxis"?n.width:m.width,height:r==="yAxis"?n.height:m.height});return B.bandSize=Ig(B,U),!m.hide&&r==="xAxis"?u[S]+=(k?-1:1)*B.height:m.hide||(u[S]+=(k?-1:1)*B.width),Aa(Aa({},f),{},ev({},p,B))},{})},IZ=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return{x:Math.min(n,a),y:Math.min(r,o),width:Math.abs(a-n),height:Math.abs(o-r)}},X2e=function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return IZ({x:t,y:n},{x:r,y:a})},DZ=function(){function e(t){H2e(this,e),this.scale=t}return q2e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.bandAware,a=n.position;if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}},{key:"isInRange",value:function(t){var n=this.range(),r=n[0],a=n[n.length-1];return r<=a?t>=r&&t<=a:t>=a&&t<=r}}],[{key:"create",value:function(t){return new e(t)}}])}();ev(DZ,"EPS",1e-4);var eP=function(e){var t=Object.keys(e).reduce(function(n,r){return Aa(Aa({},n),{},ev({},r,DZ.create(e[r])))},{});return Aa(Aa({},t),{},{apply:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.bandAware,o=r.position;return _2e(n,function(i,s){return t[s].apply(i,{bandAware:a,position:o})})},isInRange:function(n){return jZ(n,function(r,a){return t[a].isInRange(r)})}})};function Y2e(e){return(e%180+180)%180}var J2e=function(e){var t=e.width,n=e.height,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Y2e(r),o=a*Math.PI/180,i=Math.atan(n/t),s=o>i&&o<Math.PI-i?n/Math.sin(o):t/Math.cos(o);return Math.abs(s)},tP,LZ;function Q2e(){if(LZ)return tP;LZ=1;var e=Wa(),t=Zi(),n=gu();function r(a){return function(o,i,s){var c=Object(o);if(!t(o)){var l=e(i,3);o=n(o),i=function(d){return l(c[d],d,c)}}var u=a(o,i,s);return u>-1?c[l?o[u]:u]:void 0}}return tP=r,tP}var nP,$Z;function G2e(){if($Z)return nP;$Z=1;var e=zU(),t=Wa(),n=_B(),r=Math.max;function a(o,i,s){var c=o==null?0:o.length;if(!c)return-1;var l=s==null?0:n(s);return l<0&&(l=r(c+l,0)),e(o,t(i,3),l)}return nP=a,nP}var rP,FZ;function eTe(){if(FZ)return rP;FZ=1;var e=Q2e(),t=G2e(),n=e(t);return rP=n,rP}var tTe=eTe();const nTe=ft(tTe);var rTe=s4(),aTe=ft(rTe)(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),aP=g.createContext(void 0),oP=g.createContext(void 0),BZ=g.createContext(void 0),zZ=g.createContext({}),UZ=g.createContext(void 0),VZ=g.createContext(0),WZ=g.createContext(0),HZ=function(e){var t=e.state,n=t.xAxisMap,r=t.yAxisMap,a=t.offset,o=e.clipPathId,i=e.children,s=e.width,c=e.height,l=aTe(a);return Y.createElement(aP.Provider,{value:n},Y.createElement(oP.Provider,{value:r},Y.createElement(zZ.Provider,{value:a},Y.createElement(BZ.Provider,{value:l},Y.createElement(UZ.Provider,{value:o},Y.createElement(VZ.Provider,{value:c},Y.createElement(WZ.Provider,{value:s},i)))))))},oTe=function(){return g.useContext(UZ)},qZ=function(e){var t=g.useContext(aP);t==null&&Is();var n=t[e];return n==null&&Is(),n},iTe=function(){var e=g.useContext(aP);return Di(e)},sTe=function(){var e=g.useContext(oP),t=nTe(e,function(n){return jZ(n.domain,Number.isFinite)});return t||Di(e)},ZZ=function(e){var t=g.useContext(oP);t==null&&Is();var n=t[e];return n==null&&Is(),n},cTe=function(){var e=g.useContext(BZ);return e},lTe=function(){return g.useContext(zZ)},iP=function(){return g.useContext(WZ)},sP=function(){return g.useContext(VZ)};function zl(e){"@babel/helpers - typeof";return zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zl(e)}function uTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dTe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,JZ(r.key),r)}}function fTe(e,t,n){return t&&dTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pTe(e,t,n){return t=tv(t),hTe(e,KZ()?Reflect.construct(t,n||[],tv(e).constructor):t.apply(e,n))}function hTe(e,t){if(t&&(zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mTe(e)}function mTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KZ=function(){return!!e})()}function tv(e){return tv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tv(e)}function yTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cP(e,t)}function cP(e,t){return cP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},cP(e,t)}function XZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function YZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XZ(Object(n),!0).forEach(function(r){lP(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function lP(e,t,n){return t=JZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JZ(e){var t=gTe(e,"string");return zl(t)=="symbol"?t:t+""}function gTe(e,t){if(zl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(zl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vTe(e,t){return _Te(e)||xTe(e,t)||wTe(e,t)||bTe()}function bTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wTe(e,t){if(e){if(typeof e=="string")return QZ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return QZ(e,t)}}function QZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xTe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function _Te(e){if(Array.isArray(e))return e}function uP(){return uP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uP.apply(this,arguments)}var STe=function(e,t){var n;return Y.isValidElement(e)?n=Y.cloneElement(e,t):lt(e)?n=e(t):n=Y.createElement("line",uP({},t,{className:"recharts-reference-line-line"})),n},jTe=function(e,t,n,r,a,o,i,s,c){var l=a.x,u=a.y,d=a.width,f=a.height;if(n){var p=c.y,m=e.y.apply(p,{position:o});if(io(c,"discard")&&!e.y.isInRange(m))return null;var y=[{x:l+d,y:m},{x:l,y:m}];return s==="left"?y.reverse():y}if(t){var v=c.x,b=e.x.apply(v,{position:o});if(io(c,"discard")&&!e.x.isInRange(b))return null;var w=[{x:b,y:u+f},{x:b,y:u}];return i==="top"?w.reverse():w}if(r){var _=c.segment,x=_.map(function(S){return e.apply(S,{position:o})});return io(c,"discard")&&b2e(x,function(S){return!e.isInRange(S)})?null:x}return null};function ETe(e){var t=e.x,n=e.y,r=e.segment,a=e.xAxisId,o=e.yAxisId,i=e.shape,s=e.className,c=e.alwaysShow,l=oTe(),u=qZ(a),d=ZZ(o),f=cTe();if(!l||!f)return null;Ko(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=eP({x:u.scale,y:d.scale}),m=yn(t),y=yn(n),v=r&&r.length===2,b=jTe(p,m,y,v,f,e.position,u.orientation,d.orientation,e);if(!b)return null;var w=vTe(b,2),_=w[0],x=_.x,S=_.y,j=w[1],E=j.x,O=j.y,P=io(e,"hidden")?"url(#".concat(l,")"):void 0,k=YZ(YZ({clipPath:P},Et(e,!0)),{},{x1:x,y1:S,x2:E,y2:O});return Y.createElement(_n,{className:Pt("recharts-reference-line",s)},STe(i,k),Bn.renderCallByParent(e,X2e({x1:x,y1:S,x2:E,y2:O})))}var dP=function(e){function t(){return uTe(this,t),pTe(this,t,arguments)}return yTe(t,e),fTe(t,[{key:"render",value:function(){return Y.createElement(ETe,this.props)}}])}(Y.Component);lP(dP,"displayName","ReferenceLine"),lP(dP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function fP(){return fP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fP.apply(this,arguments)}function Ul(e){"@babel/helpers - typeof";return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ul(e)}function GZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function eK(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GZ(Object(n),!0).forEach(function(r){rv(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function OTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CTe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nK(r.key),r)}}function kTe(e,t,n){return t&&CTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function PTe(e,t,n){return t=nv(t),NTe(e,tK()?Reflect.construct(t,n||[],nv(e).constructor):t.apply(e,n))}function NTe(e,t){if(t&&(Ul(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MTe(e)}function MTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tK=function(){return!!e})()}function nv(e){return nv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nv(e)}function ATe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pP(e,t)}function pP(e,t){return pP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},pP(e,t)}function rv(e,t,n){return t=nK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nK(e){var t=TTe(e,"string");return Ul(t)=="symbol"?t:t+""}function TTe(e,t){if(Ul(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ul(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RTe=function(e){var t=e.x,n=e.y,r=e.xAxis,a=e.yAxis,o=eP({x:r.scale,y:a.scale}),i=o.apply({x:t,y:n},{bandAware:!0});return io(e,"discard")&&!o.isInRange(i)?null:i},av=function(e){function t(){return OTe(this,t),PTe(this,t,arguments)}return ATe(t,e),kTe(t,[{key:"render",value:function(){var n=this.props,r=n.x,a=n.y,o=n.r,i=n.alwaysShow,s=n.clipPathId,c=yn(r),l=yn(a);if(Ko(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!l)return null;var u=RTe(this.props);if(!u)return null;var d=u.x,f=u.y,p=this.props,m=p.shape,y=p.className,v=io(this.props,"hidden")?"url(#".concat(s,")"):void 0,b=eK(eK({clipPath:v},Et(this.props,!0)),{},{cx:d,cy:f});return Y.createElement(_n,{className:Pt("recharts-reference-dot",y)},t.renderDot(m,b),Bn.renderCallByParent(this.props,{x:d-o,y:f-o,width:2*o,height:2*o}))}}])}(Y.Component);rv(av,"displayName","ReferenceDot"),rv(av,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),rv(av,"renderDot",function(e,t){var n;return Y.isValidElement(e)?n=Y.cloneElement(e,t):lt(e)?n=e(t):n=Y.createElement(Jq,fP({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function hP(){return hP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hP.apply(this,arguments)}function Vl(e){"@babel/helpers - typeof";return Vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vl(e)}function rK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function aK(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rK(Object(n),!0).forEach(function(r){iv(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ITe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DTe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,iK(r.key),r)}}function LTe(e,t,n){return t&&DTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Te(e,t,n){return t=ov(t),FTe(e,oK()?Reflect.construct(t,n||[],ov(e).constructor):t.apply(e,n))}function FTe(e,t){if(t&&(Vl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BTe(e)}function BTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oK=function(){return!!e})()}function ov(e){return ov=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ov(e)}function zTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mP(e,t)}function mP(e,t){return mP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},mP(e,t)}function iv(e,t,n){return t=iK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iK(e){var t=UTe(e,"string");return Vl(t)=="symbol"?t:t+""}function UTe(e,t){if(Vl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Vl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VTe=function(e,t,n,r,a){var o=a.x1,i=a.x2,s=a.y1,c=a.y2,l=a.xAxis,u=a.yAxis;if(!l||!u)return null;var d=eP({x:l.scale,y:u.scale}),f={x:e?d.x.apply(o,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(s,{position:"start"}):d.y.rangeMin},p={x:t?d.x.apply(i,{position:"end"}):d.x.rangeMax,y:r?d.y.apply(c,{position:"end"}):d.y.rangeMax};return io(a,"discard")&&(!d.isInRange(f)||!d.isInRange(p))?null:IZ(f,p)},sv=function(e){function t(){return ITe(this,t),$Te(this,t,arguments)}return zTe(t,e),LTe(t,[{key:"render",value:function(){var n=this.props,r=n.x1,a=n.x2,o=n.y1,i=n.y2,s=n.className,c=n.alwaysShow,l=n.clipPathId;Ko(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=yn(r),d=yn(a),f=yn(o),p=yn(i),m=this.props.shape;if(!u&&!d&&!f&&!p&&!m)return null;var y=VTe(u,d,f,p,this.props);if(!y&&!m)return null;var v=io(this.props,"hidden")?"url(#".concat(l,")"):void 0;return Y.createElement(_n,{className:Pt("recharts-reference-area",s)},t.renderRect(m,aK(aK({clipPath:v},Et(this.props,!0)),y)),Bn.renderCallByParent(this.props,y))}}])}(Y.Component);iv(sv,"displayName","ReferenceArea"),iv(sv,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),iv(sv,"renderRect",function(e,t){var n;return Y.isValidElement(e)?n=Y.cloneElement(e,t):lt(e)?n=e(t):n=Y.createElement(Dk,hP({},t,{className:"recharts-reference-area-rect"})),n});function sK(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function WTe(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return J2e(r,n)}function HTe(e,t,n){var r=n==="width",a=e.x,o=e.y,i=e.width,s=e.height;return t===1?{start:r?a:o,end:r?a+i:o+s}:{start:r?a+i:o+s,end:r?a:o}}function cv(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var o=n();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-a)<=0}function qTe(e,t){return sK(e,t+1)}function ZTe(e,t,n,r,a){for(var o=(r||[]).slice(),i=t.start,s=t.end,c=0,l=1,u=i,d=function(){var p=r==null?void 0:r[c];if(p===void 0)return{v:sK(r,l)};var m=c,y,v=function(){return y===void 0&&(y=n(p,m)),y},b=p.coordinate,w=c===0||cv(e,b,v,u,s);w||(c=0,u=i,l+=1),w&&(u=b+e*(v()/2+a),c+=l)},f;l<=o.length;)if(f=d(),f)return f.v;return[]}function cp(e){"@babel/helpers - typeof";return cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cp(e)}function cK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function zn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cK(Object(n),!0).forEach(function(r){KTe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function KTe(e,t,n){return t=XTe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XTe(e){var t=YTe(e,"string");return cp(t)=="symbol"?t:t+""}function YTe(e,t){if(cp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JTe(e,t,n,r,a){for(var o=(r||[]).slice(),i=o.length,s=t.start,c=t.end,l=function(d){var f=o[d],p,m=function(){return p===void 0&&(p=n(f,d)),p};if(d===i-1){var y=e*(f.coordinate+e*m()/2-c);o[d]=f=zn(zn({},f),{},{tickCoord:y>0?f.coordinate-y*e:f.coordinate})}else o[d]=f=zn(zn({},f),{},{tickCoord:f.coordinate});var v=cv(e,f.tickCoord,m,s,c);v&&(c=f.tickCoord-e*(m()/2+a),o[d]=zn(zn({},f),{},{isShow:!0}))},u=i-1;u>=0;u--)l(u);return o}function QTe(e,t,n,r,a,o){var i=(r||[]).slice(),s=i.length,c=t.start,l=t.end;if(o){var u=r[s-1],d=n(u,s-1),f=e*(u.coordinate+e*d/2-l);i[s-1]=u=zn(zn({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate});var p=cv(e,u.tickCoord,function(){return d},c,l);p&&(l=u.tickCoord-e*(d/2+a),i[s-1]=zn(zn({},u),{},{isShow:!0}))}for(var m=o?s-1:s,y=function(b){var w=i[b],_,x=function(){return _===void 0&&(_=n(w,b)),_};if(b===0){var S=e*(w.coordinate-e*x()/2-c);i[b]=w=zn(zn({},w),{},{tickCoord:S<0?w.coordinate-S*e:w.coordinate})}else i[b]=w=zn(zn({},w),{},{tickCoord:w.coordinate});var j=cv(e,w.tickCoord,x,c,l);j&&(c=w.tickCoord+e*(x()/2+a),i[b]=zn(zn({},w),{},{isShow:!0}))},v=0;v<m;v++)y(v);return i}function yP(e,t,n){var r=e.tick,a=e.ticks,o=e.viewBox,i=e.minTickGap,s=e.orientation,c=e.interval,l=e.tickFormatter,u=e.unit,d=e.angle;if(!a||!a.length||!r)return[];if(we(c)||Li.isSsr)return qTe(a,typeof c=="number"&&we(c)?c:0);var f=[],p=s==="top"||s==="bottom"?"width":"height",m=u&&p==="width"?jf(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},y=function(w,_){var x=lt(l)?l(w.value,_):w.value;return p==="width"?WTe(jf(x,{fontSize:t,letterSpacing:n}),m,d):jf(x,{fontSize:t,letterSpacing:n})[p]},v=a.length>=2?ka(a[1].coordinate-a[0].coordinate):1,b=HTe(o,v,p);return c==="equidistantPreserveStart"?ZTe(v,b,y,a,i):(c==="preserveStart"||c==="preserveStartEnd"?f=QTe(v,b,y,a,i,c==="preserveStartEnd"):f=JTe(v,b,y,a,i),f.filter(function(w){return w.isShow}))}var GTe=["viewBox"],eRe=["viewBox"],tRe=["ticks"];function Wl(e){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(e)}function Hl(){return Hl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hl.apply(this,arguments)}function lK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function er(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lK(Object(n),!0).forEach(function(r){bP(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gP(e,t){if(e==null)return{};var n=nRe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function nRe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function rRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fK(r.key),r)}}function aRe(e,t,n){return t&&uK(e.prototype,t),n&&uK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function oRe(e,t,n){return t=lv(t),iRe(e,dK()?Reflect.construct(t,n||[],lv(e).constructor):t.apply(e,n))}function iRe(e,t){if(t&&(Wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sRe(e)}function sRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dK=function(){return!!e})()}function lv(e){return lv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lv(e)}function cRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vP(e,t)}function vP(e,t){return vP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},vP(e,t)}function bP(e,t,n){return t=fK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fK(e){var t=lRe(e,"string");return Wl(t)=="symbol"?t:t+""}function lRe(e,t){if(Wl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Wl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ql=function(e){function t(n){var r;return rRe(this,t),r=oRe(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return cRe(t,e),aRe(t,[{key:"shouldComponentUpdate",value:function(n,r){var a=n.viewBox,o=gP(n,GTe),i=this.props,s=i.viewBox,c=gP(i,eRe);return!bl(a,s)||!bl(o,c)||!bl(r,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var r=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];r&&this.setState({fontSize:window.getComputedStyle(r).fontSize,letterSpacing:window.getComputedStyle(r).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var r=this.props,a=r.x,o=r.y,i=r.width,s=r.height,c=r.orientation,l=r.tickSize,u=r.mirror,d=r.tickMargin,f,p,m,y,v,b,w=u?-1:1,_=n.tickSize||l,x=we(n.tickCoord)?n.tickCoord:n.coordinate;switch(c){case"top":f=p=n.coordinate,y=o+ +!u*s,m=y-w*_,b=m-w*d,v=x;break;case"left":m=y=n.coordinate,p=a+ +!u*i,f=p-w*_,v=f-w*d,b=x;break;case"right":m=y=n.coordinate,p=a+ +u*i,f=p+w*_,v=f+w*d,b=x;break;default:f=p=n.coordinate,y=o+ +u*s,m=y+w*_,b=m+w*d,v=x;break}return{line:{x1:f,y1:m,x2:p,y2:y},tick:{x:v,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o;switch(r){case"left":o=a?"start":"end";break;case"right":o=a?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o="end";switch(r){case"left":case"right":o="middle";break;case"top":o=a?"start":"end";break;default:o=a?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.orientation,c=n.mirror,l=n.axisLine,u=er(er(er({},Et(this.props,!1)),Et(l,!1)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!c||s==="bottom"&&c);u=er(er({},u),{},{x1:r,y1:a+d*i,x2:r+o,y2:a+d*i})}else{var f=+(s==="left"&&!c||s==="right"&&c);u=er(er({},u),{},{x1:r+f*o,y1:a,x2:r+f*o,y2:a+i})}return Y.createElement("line",Hl({},u,{className:Pt("recharts-cartesian-axis-line",Rr(l,"className"))}))}},{key:"renderTicks",value:function(n,r,a){var o=this,i=this.props,s=i.tickLine,c=i.stroke,l=i.tick,u=i.tickFormatter,d=i.unit,f=yP(er(er({},this.props),{},{ticks:n}),r,a),p=this.getTickTextAnchor(),m=this.getTickVerticalAnchor(),y=Et(this.props,!1),v=Et(l,!1),b=er(er({},y),{},{fill:"none"},Et(s,!1)),w=f.map(function(_,x){var S=o.getTickLineCoord(_),j=S.line,E=S.tick,O=er(er(er(er({textAnchor:p,verticalAnchor:m},y),{},{stroke:"none",fill:c},v),E),{},{index:x,payload:_,visibleTicksCount:f.length,tickFormatter:u});return Y.createElement(_n,Hl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},Wy(o.props,_,x)),s&&Y.createElement("line",Hl({},b,j,{className:Pt("recharts-cartesian-axis-tick-line",Rr(s,"className"))})),l&&t.renderTickItem(l,O,"".concat(lt(u)?u(_.value,x):_.value).concat(d||"")))});return Y.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,r=this.props,a=r.axisLine,o=r.width,i=r.height,s=r.ticksGenerator,c=r.className,l=r.hide;if(l)return null;var u=this.props,d=u.ticks,f=gP(u,tRe),p=d;return lt(s)&&(p=d&&d.length>0?s(this.props):s(f)),o<=0||i<=0||!p||!p.length?null:Y.createElement(_n,{className:Pt("recharts-cartesian-axis",c),ref:function(m){n.layerReference=m}},a&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),Bn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,r,a){var o;return Y.isValidElement(n)?o=Y.cloneElement(n,r):lt(n)?o=n(r):o=Y.createElement(ug,Hl({},r,{className:"recharts-cartesian-axis-tick-value"}),a),o}}])}(g.Component);bP(ql,"displayName","CartesianAxis"),bP(ql,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var uRe=["x1","y1","x2","y2","key"],dRe=["offset"];function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}function pK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Un(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pK(Object(n),!0).forEach(function(r){fRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function fRe(e,t,n){return t=pRe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pRe(e){var t=hRe(e,"string");return Fs(t)=="symbol"?t:t+""}function hRe(e,t){if(Fs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Fs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bs(){return Bs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bs.apply(this,arguments)}function hK(e,t){if(e==null)return{};var n=mRe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mRe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var yRe=function(e){var t=e.fill;if(!t||t==="none")return null;var n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.ry;return Y.createElement("rect",{x:r,y:a,ry:s,width:o,height:i,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function mK(e,t){var n;if(Y.isValidElement(e))n=Y.cloneElement(e,t);else if(lt(e))n=e(t);else{var r=t.x1,a=t.y1,o=t.x2,i=t.y2,s=t.key,c=hK(t,uRe),l=Et(c,!1);l.offset;var u=hK(l,dRe);n=Y.createElement("line",Bs({},u,{x1:r,y1:a,x2:o,y2:i,fill:"none",key:s}))}return n}function gRe(e){var t=e.x,n=e.width,r=e.horizontal,a=r===void 0?!0:r,o=e.horizontalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=Un(Un({},e),{},{x1:t,y1:s,x2:t+n,y2:s,key:"line-".concat(c),index:c});return mK(a,l)});return Y.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function vRe(e){var t=e.y,n=e.height,r=e.vertical,a=r===void 0?!0:r,o=e.verticalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=Un(Un({},e),{},{x1:s,y1:t,x2:s,y2:t+n,key:"line-".concat(c),index:c});return mK(a,l)});return Y.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function bRe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.horizontalPoints,c=e.horizontal,l=c===void 0?!0:c;if(!l||!t||!t.length)return null;var u=s.map(function(f){return Math.round(f+a-a)}).sort(function(f,p){return f-p});a!==u[0]&&u.unshift(0);var d=u.map(function(f,p){var m=!u[p+1],y=m?a+i-f:u[p+1]-f;if(y<=0)return null;var v=p%t.length;return Y.createElement("rect",{key:"react-".concat(p),y:f,x:r,height:y,width:o,stroke:"none",fill:t[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return Y.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function wRe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,a=e.fillOpacity,o=e.x,i=e.y,s=e.width,c=e.height,l=e.verticalPoints;if(!n||!r||!r.length)return null;var u=l.map(function(f){return Math.round(f+o-o)}).sort(function(f,p){return f-p});o!==u[0]&&u.unshift(0);var d=u.map(function(f,p){var m=!u[p+1],y=m?o+s-f:u[p+1]-f;if(y<=0)return null;var v=p%r.length;return Y.createElement("rect",{key:"react-".concat(p),x:f,y:i,width:y,height:c,stroke:"none",fill:r[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Y.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var xRe=function(e,t){var n=e.xAxis,r=e.width,a=e.height,o=e.offset;return qH(yP(Un(Un(Un({},ql.defaultProps),n),{},{ticks:ri(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.left,o.left+o.width,t)},_Re=function(e,t){var n=e.yAxis,r=e.width,a=e.height,o=e.offset;return qH(yP(Un(Un(Un({},ql.defaultProps),n),{},{ticks:ri(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.top,o.top+o.height,t)},Zl={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function yK(e){var t,n,r,a,o,i,s=iP(),c=sP(),l=lTe(),u=Un(Un({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Zl.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Zl.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:Zl.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Zl.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:Zl.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:Zl.verticalFill,x:we(e.x)?e.x:l.left,y:we(e.y)?e.y:l.top,width:we(e.width)?e.width:l.width,height:we(e.height)?e.height:l.height}),d=u.x,f=u.y,p=u.width,m=u.height,y=u.syncWithTicks,v=u.horizontalValues,b=u.verticalValues,w=iTe(),_=sTe();if(!we(p)||p<=0||!we(m)||m<=0||!we(d)||d!==+d||!we(f)||f!==+f)return null;var x=u.verticalCoordinatesGenerator||xRe,S=u.horizontalCoordinatesGenerator||_Re,j=u.horizontalPoints,E=u.verticalPoints;if((!j||!j.length)&&lt(S)){var O=v&&v.length,P=S({yAxis:_?Un(Un({},_),{},{ticks:O?v:_.ticks}):void 0,width:s,height:c,offset:l},O?!0:y);Ko(Array.isArray(P),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Fs(P),"]")),Array.isArray(P)&&(j=P)}if((!E||!E.length)&&lt(x)){var k=b&&b.length,N=x({xAxis:w?Un(Un({},w),{},{ticks:k?b:w.ticks}):void 0,width:s,height:c,offset:l},k?!0:y);Ko(Array.isArray(N),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Fs(N),"]")),Array.isArray(N)&&(E=N)}return Y.createElement("g",{className:"recharts-cartesian-grid"},Y.createElement(yRe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),Y.createElement(gRe,Bs({},u,{offset:l,horizontalPoints:j,xAxis:w,yAxis:_})),Y.createElement(vRe,Bs({},u,{offset:l,verticalPoints:E,xAxis:w,yAxis:_})),Y.createElement(bRe,Bs({},u,{horizontalPoints:j})),Y.createElement(wRe,Bs({},u,{verticalPoints:E})))}yK.displayName="CartesianGrid";function Kl(e){"@babel/helpers - typeof";return Kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kl(e)}function SRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jRe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bK(r.key),r)}}function ERe(e,t,n){return t&&jRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ORe(e,t,n){return t=uv(t),CRe(e,gK()?Reflect.construct(t,n||[],uv(e).constructor):t.apply(e,n))}function CRe(e,t){if(t&&(Kl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kRe(e)}function kRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gK=function(){return!!e})()}function uv(e){return uv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uv(e)}function PRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wP(e,t)}function wP(e,t){return wP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},wP(e,t)}function vK(e,t,n){return t=bK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bK(e){var t=NRe(e,"string");return Kl(t)=="symbol"?t:t+""}function NRe(e,t){if(Kl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Kl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xP(){return xP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xP.apply(this,arguments)}function MRe(e){var t=e.xAxisId,n=iP(),r=sP(),a=qZ(t);return a==null?null:Y.createElement(ql,xP({},a,{className:Pt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return ri(o,!0)}}))}var dv=function(e){function t(){return SRe(this,t),ORe(this,t,arguments)}return PRe(t,e),ERe(t,[{key:"render",value:function(){return Y.createElement(MRe,this.props)}}])}(Y.Component);vK(dv,"displayName","XAxis"),vK(dv,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Xl(e){"@babel/helpers - typeof";return Xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xl(e)}function ARe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TRe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_K(r.key),r)}}function RRe(e,t,n){return t&&TRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function IRe(e,t,n){return t=fv(t),DRe(e,wK()?Reflect.construct(t,n||[],fv(e).constructor):t.apply(e,n))}function DRe(e,t){if(t&&(Xl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LRe(e)}function LRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wK=function(){return!!e})()}function fv(e){return fv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fv(e)}function $Re(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_P(e,t)}function _P(e,t){return _P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},_P(e,t)}function xK(e,t,n){return t=_K(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _K(e){var t=FRe(e,"string");return Xl(t)=="symbol"?t:t+""}function FRe(e,t){if(Xl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Xl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SP(){return SP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},SP.apply(this,arguments)}var BRe=function(e){var t=e.yAxisId,n=iP(),r=sP(),a=ZZ(t);return a==null?null:Y.createElement(ql,SP({},a,{className:Pt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return ri(o,!0)}}))},jP=function(e){function t(){return ARe(this,t),IRe(this,t,arguments)}return $Re(t,e),RRe(t,[{key:"render",value:function(){return Y.createElement(BRe,this.props)}}])}(Y.Component);xK(jP,"displayName","YAxis"),xK(jP,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function SK(e){return WRe(e)||VRe(e)||URe(e)||zRe()}function zRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function URe(e,t){if(e){if(typeof e=="string")return EP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return EP(e,t)}}function VRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WRe(e){if(Array.isArray(e))return EP(e)}function EP(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var OP=function(e,t,n,r,a){var o=Pa(e,dP),i=Pa(e,av),s=[].concat(SK(o),SK(i)),c=Pa(e,sv),l="".concat(r,"Id"),u=r[0],d=t;if(s.length&&(d=s.reduce(function(m,y){if(y.props[l]===n&&io(y.props,"extendDomain")&&we(y.props[u])){var v=y.props[u];return[Math.min(m[0],v),Math.max(m[1],v)]}return m},d)),c.length){var f="".concat(u,"1"),p="".concat(u,"2");d=c.reduce(function(m,y){if(y.props[l]===n&&io(y.props,"extendDomain")&&we(y.props[f])&&we(y.props[p])){var v=y.props[f],b=y.props[p];return[Math.min(m[0],v,b),Math.max(m[1],v,b)]}return m},d)}return a&&a.length&&(d=a.reduce(function(m,y){return we(y)?[Math.min(m[0],y),Math.max(m[1],y)]:m},d)),d},jK={exports:{}},EK;function HRe(){return EK||(EK=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new a(u,d||c,f),m=n?n+l:l;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function i(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)t.call(l,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},s.prototype.listeners=function(c){var l=n?n+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},s.prototype.listenerCount=function(c){var l=n?n+c:c,u=this._events[l];return u?u.fn?1:u.length:0},s.prototype.emit=function(c,l,u,d,f,p){var m=n?n+c:c;if(!this._events[m])return!1;var y=this._events[m],v=arguments.length,b,w;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),v){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,l),!0;case 3:return y.fn.call(y.context,l,u),!0;case 4:return y.fn.call(y.context,l,u,d),!0;case 5:return y.fn.call(y.context,l,u,d,f),!0;case 6:return y.fn.call(y.context,l,u,d,f,p),!0}for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];y.fn.apply(y.context,b)}else{var _=y.length,x;for(w=0;w<_;w++)switch(y[w].once&&this.removeListener(c,y[w].fn,void 0,!0),v){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,l);break;case 3:y[w].fn.call(y[w].context,l,u);break;case 4:y[w].fn.call(y[w].context,l,u,d);break;default:if(!b)for(x=1,b=new Array(v-1);x<v;x++)b[x-1]=arguments[x];y[w].fn.apply(y[w].context,b)}}return!0},s.prototype.on=function(c,l,u){return o(this,c,l,u,!1)},s.prototype.once=function(c,l,u){return o(this,c,l,u,!0)},s.prototype.removeListener=function(c,l,u,d){var f=n?n+c:c;if(!this._events[f])return this;if(!l)return i(this,f),this;var p=this._events[f];if(p.fn)p.fn===l&&(!d||p.once)&&(!u||p.context===u)&&i(this,f);else{for(var m=0,y=[],v=p.length;m<v;m++)(p[m].fn!==l||d&&!p[m].once||u&&p[m].context!==u)&&y.push(p[m]);y.length?this._events[f]=y.length===1?y[0]:y:i(this,f)}return this},s.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&i(this,l)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(jK)),jK.exports}var qRe=HRe();const ZRe=ft(qRe);var CP=new ZRe,kP="recharts.syncMouseEvents";function lp(e){"@babel/helpers - typeof";return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(e)}function KRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XRe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,OK(r.key),r)}}function YRe(e,t,n){return t&&XRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function PP(e,t,n){return t=OK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OK(e){var t=JRe(e,"string");return lp(t)=="symbol"?t:t+""}function JRe(e,t){if(lp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(lp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var QRe=function(){function e(){KRe(this,e),PP(this,"activeIndex",0),PP(this,"coordinateList",[]),PP(this,"layout","horizontal")}return YRe(e,[{key:"setDetails",value:function(t){var n,r=t.coordinateList,a=r===void 0?null:r,o=t.container,i=o===void 0?null:o,s=t.layout,c=s===void 0?null:s,l=t.offset,u=l===void 0?null:l,d=t.mouseHandlerCallback,f=d===void 0?null:d;this.coordinateList=(n=a??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=c??this.layout,this.offset=u??this.offset,this.mouseHandlerCallback=f??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(t){if(this.coordinateList.length!==0)switch(t.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(t){this.activeIndex=t}},{key:"spoofMouse",value:function(){var t,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var r=this.container.getBoundingClientRect(),a=r.x,o=r.y,i=r.height,s=this.coordinateList[this.activeIndex].coordinate,c=((t=window)===null||t===void 0?void 0:t.scrollX)||0,l=((n=window)===null||n===void 0?void 0:n.scrollY)||0,u=a+s+c,d=o+this.offset.top+i/2+l;this.mouseHandlerCallback({pageX:u,pageY:d})}}}])}();function GRe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],a=e==null?void 0:e[1];if(r&&a&&we(r)&&we(a))return!0}return!1}function eIe(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function CK(e){var t=e.cx,n=e.cy,r=e.radius,a=e.startAngle,o=e.endAngle,i=An(t,n,r,a),s=An(t,n,r,o);return{points:[i,s],cx:t,cy:n,radius:r,startAngle:a,endAngle:o}}function tIe(e,t,n){var r,a,o,i;if(e==="horizontal")r=t.x,o=r,a=n.top,i=n.top+n.height;else if(e==="vertical")a=t.y,i=a,r=n.left,o=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,c=t.cy,l=t.innerRadius,u=t.outerRadius,d=t.angle,f=An(s,c,l,d),p=An(s,c,u,d);r=f.x,a=f.y,o=p.x,i=p.y}else return CK(t);return[{x:r,y:a},{x:o,y:i}]}function up(e){"@babel/helpers - typeof";return up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},up(e)}function kK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function pv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kK(Object(n),!0).forEach(function(r){nIe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nIe(e,t,n){return t=rIe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rIe(e){var t=aIe(e,"string");return up(t)=="symbol"?t:t+""}function aIe(e,t){if(up(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(up(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oIe(e){var t,n,r=e.element,a=e.tooltipEventType,o=e.isActive,i=e.activeCoordinate,s=e.activePayload,c=e.offset,l=e.activeTooltipIndex,u=e.tooltipAxisBandSize,d=e.layout,f=e.chartName,p=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!p||!o||!i||f!=="ScatterChart"&&a!=="axis")return null;var m,y=yq;if(f==="ScatterChart")m=i,y=xAe;else if(f==="BarChart")m=eIe(d,i,c,u),y=Dk;else if(d==="radial"){var v=CK(i),b=v.cx,w=v.cy,_=v.radius,x=v.startAngle,S=v.endAngle;m={cx:b,cy:w,startAngle:x,endAngle:S,innerRadius:_,outerRadius:_},y=fq}else m={points:tIe(d,i,c)},y=yq;var j=pv(pv(pv(pv({stroke:"#ccc",pointerEvents:"none"},c),m),Et(p,!1)),{},{payload:s,payloadIndex:l,className:Pt("recharts-tooltip-cursor",p.className)});return g.isValidElement(p)?g.cloneElement(p,j):g.createElement(y,j)}var iIe=["item"],sIe=["children","className","width","height","style","compact","title","desc"];function Yl(e){"@babel/helpers - typeof";return Yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yl(e)}function Jl(){return Jl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jl.apply(this,arguments)}function PK(e,t){return uIe(e)||lIe(e,t)||AK(e,t)||cIe()}function cIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lIe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function uIe(e){if(Array.isArray(e))return e}function NK(e,t){if(e==null)return{};var n=dIe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dIe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function fIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pIe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,RK(r.key),r)}}function hIe(e,t,n){return t&&pIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mIe(e,t,n){return t=hv(t),yIe(e,MK()?Reflect.construct(t,n||[],hv(e).constructor):t.apply(e,n))}function yIe(e,t){if(t&&(Yl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gIe(e)}function gIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MK=function(){return!!e})()}function hv(e){return hv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hv(e)}function vIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NP(e,t)}function NP(e,t){return NP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},NP(e,t)}function Ql(e){return xIe(e)||wIe(e)||AK(e)||bIe()}function bIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AK(e,t){if(e){if(typeof e=="string")return MP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MP(e,t)}}function wIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xIe(e){if(Array.isArray(e))return MP(e)}function MP(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function TK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TK(Object(n),!0).forEach(function(r){He(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function He(e,t,n){return t=RK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RK(e){var t=_Ie(e,"string");return Yl(t)=="symbol"?t:t+""}function _Ie(e,t){if(Yl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Yl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SIe={xAxis:["bottom","top"],yAxis:["left","right"]},jIe={width:"100%",height:"100%"},IK={x:0,y:0};function mv(e){return e}var EIe=function(e,t){return t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius},OIe=function(e,t,n,r){var a=t.find(function(l){return l&&l.index===n});if(a){if(e==="horizontal")return{x:a.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:a.coordinate};if(e==="centric"){var o=a.coordinate,i=r.radius;return de(de(de({},r),An(r.cx,r.cy,i,o)),{},{angle:o,radius:i})}var s=a.coordinate,c=r.angle;return de(de(de({},r),An(r.cx,r.cy,s,c)),{},{angle:c,radius:s})}return IK},yv=function(e,t){var n=t.graphicalItems,r=t.dataStartIndex,a=t.dataEndIndex,o=(n??[]).reduce(function(i,s){var c=s.props.data;return c&&c.length?[].concat(Ql(i),Ql(c)):i},[]);return o.length>0?o:e&&e.length&&we(r)&&we(a)?e.slice(r,a+1):[]};function DK(e){return e==="number"?[0,"auto"]:void 0}var AP=function(e,t,n,r){var a=e.graphicalItems,o=e.tooltipAxis,i=yv(t,e);return n<0||!a||!a.length||n>=i.length?null:a.reduce(function(s,c){var l,u=(l=c.props.data)!==null&&l!==void 0?l:t;u&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(u=u.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(o.dataKey&&!o.allowDuplicatedCategory){var f=u===void 0?i:u;d=eO(f,o.dataKey,r)}else d=u&&u[n]||i[n];return d?[].concat(Ql(s),[GH(c,d)]):s},[])},LK=function(e,t,n,r){var a=r||{x:e.chartX,y:e.chartY},o=EIe(a,n),i=e.orderedTooltipTicks,s=e.tooltipAxis,c=e.tooltipTicks,l=yPe(o,i,c,s);if(l>=0&&c){var u=c[l]&&c[l].value,d=AP(e,t,l,u),f=OIe(n,i,l,a);return{activeTooltipIndex:l,activeLabel:u,activePayload:d,activeCoordinate:f}}return null},CIe=function(e,t){var n=t.axes,r=t.graphicalItems,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=e.stackOffset,f=HH(l,a);return n.reduce(function(p,m){var y,v=m.type.defaultProps!==void 0?de(de({},m.type.defaultProps),m.props):m.props,b=v.type,w=v.dataKey,_=v.allowDataOverflow,x=v.allowDuplicatedCategory,S=v.scale,j=v.ticks,E=v.includeHidden,O=v[o];if(p[O])return p;var P=yv(e.data,{graphicalItems:r.filter(function(U){var B,K=o in U.props?U.props[o]:(B=U.type.defaultProps)===null||B===void 0?void 0:B[o];return K===O}),dataStartIndex:s,dataEndIndex:c}),k=P.length,N,R,M;GRe(v.domain,_,b)&&(N=vk(v.domain,null,_),f&&(b==="number"||S!=="auto")&&(M=Tg(P,w,"category")));var C=DK(b);if(!N||N.length===0){var T,A=(T=v.domain)!==null&&T!==void 0?T:C;if(w){if(N=Tg(P,w,b),b==="category"&&f){var I=k_e(N);x&&I?(R=N,N=Xg(0,k)):x||(N=QH(A,N,m).reduce(function(U,B){return U.indexOf(B)>=0?U:[].concat(Ql(U),[B])},[]))}else if(b==="category")x?N=N.filter(function(U){return U!==""&&!Ot(U)}):N=QH(A,N,m).reduce(function(U,B){return U.indexOf(B)>=0||B===""||Ot(B)?U:[].concat(Ql(U),[B])},[]);else if(b==="number"){var F=xPe(P,r.filter(function(U){var B,K,te=o in U.props?U.props[o]:(B=U.type.defaultProps)===null||B===void 0?void 0:B[o],L="hide"in U.props?U.props.hide:(K=U.type.defaultProps)===null||K===void 0?void 0:K.hide;return te===O&&(E||!L)}),w,a,l);F&&(N=F)}f&&(b==="number"||S!=="auto")&&(M=Tg(P,w,"category"))}else f?N=Xg(0,k):i&&i[O]&&i[O].hasStack&&b==="number"?N=d==="expand"?[0,1]:XH(i[O].stackGroups,s,c):N=WH(P,r.filter(function(U){var B=o in U.props?U.props[o]:U.type.defaultProps[o],K="hide"in U.props?U.props.hide:U.type.defaultProps.hide;return B===O&&(E||!K)}),b,l,!0);if(b==="number")N=OP(u,N,O,a,j),A&&(N=vk(A,N,_));else if(b==="category"&&A){var D=A,V=N.every(function(U){return D.indexOf(U)>=0});V&&(N=D)}}return de(de({},p),{},He({},O,de(de({},v),{},{axisType:a,domain:N,categoricalDomain:M,duplicateDomain:R,originalDomain:(y=v.domain)!==null&&y!==void 0?y:C,isCategorical:f,layout:l})))},{})},kIe=function(e,t){var n=t.graphicalItems,r=t.Axis,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=yv(e.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:c}),f=d.length,p=HH(l,a),m=-1;return n.reduce(function(y,v){var b=v.type.defaultProps!==void 0?de(de({},v.type.defaultProps),v.props):v.props,w=b[o],_=DK("number");if(!y[w]){m++;var x;return p?x=Xg(0,f):i&&i[w]&&i[w].hasStack?(x=XH(i[w].stackGroups,s,c),x=OP(u,x,w,a)):(x=vk(_,WH(d,n.filter(function(S){var j,E,O=o in S.props?S.props[o]:(j=S.type.defaultProps)===null||j===void 0?void 0:j[o],P="hide"in S.props?S.props.hide:(E=S.type.defaultProps)===null||E===void 0?void 0:E.hide;return O===w&&!P}),"number",l),r.defaultProps.allowDataOverflow),x=OP(u,x,w,a)),de(de({},y),{},He({},w,de(de({axisType:a},r.defaultProps),{},{hide:!0,orientation:Rr(SIe,"".concat(a,".").concat(m%2),null),domain:x,originalDomain:_,isCategorical:p,layout:l})))}return y},{})},PIe=function(e,t){var n=t.axisType,r=n===void 0?"xAxis":n,a=t.AxisComp,o=t.graphicalItems,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.children,u="".concat(r,"Id"),d=Pa(l,a),f={};return d&&d.length?f=CIe(e,{axes:d,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c}):o&&o.length&&(f=kIe(e,{Axis:a,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c})),f},NIe=function(e){var t=Di(e),n=ri(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:lC(n,function(r){return r.coordinate}),tooltipAxis:t,tooltipAxisBandSize:Ig(t,n)}},$K=function(e){var t=e.children,n=e.defaultShowTooltip,r=Er(t,Fl),a=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(a=r.props.startIndex),r.props.endIndex>=0&&(o=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},MIe=function(e){return!e||!e.length?!1:e.some(function(t){var n=Zo(t&&t.type);return n&&n.indexOf("Bar")>=0})},FK=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},AIe=function(e,t){var n=e.props,r=e.graphicalItems,a=e.xAxisMap,o=a===void 0?{}:a,i=e.yAxisMap,s=i===void 0?{}:i,c=n.width,l=n.height,u=n.children,d=n.margin||{},f=Er(u,Fl),p=Er(u,Sl),m=Object.keys(s).reduce(function(x,S){var j=s[S],E=j.orientation;return!j.mirror&&!j.hide?de(de({},x),{},He({},E,x[E]+j.width)):x},{left:d.left||0,right:d.right||0}),y=Object.keys(o).reduce(function(x,S){var j=o[S],E=j.orientation;return!j.mirror&&!j.hide?de(de({},x),{},He({},E,Rr(x,"".concat(E))+j.height)):x},{top:d.top||0,bottom:d.bottom||0}),v=de(de({},y),m),b=v.bottom;f&&(v.bottom+=f.props.height||Fl.defaultProps.height),p&&t&&(v=bPe(v,r,n,t));var w=c-v.left-v.right,_=l-v.top-v.bottom;return de(de({brushBottom:b},v),{},{width:Math.max(w,0),height:Math.max(_,0)})},TIe=function(e,t){if(t==="xAxis")return e[t].width;if(t==="yAxis")return e[t].height},RIe=function(e){var t=e.chartName,n=e.GraphicalChild,r=e.defaultTooltipEventType,a=r===void 0?"axis":r,o=e.validateTooltipEventTypes,i=o===void 0?["axis"]:o,s=e.axisComponents,c=e.legendContent,l=e.formatAxisMap,u=e.defaultProps,d=function(y,v){var b=v.graphicalItems,w=v.stackGroups,_=v.offset,x=v.updateId,S=v.dataStartIndex,j=v.dataEndIndex,E=y.barSize,O=y.layout,P=y.barGap,k=y.barCategoryGap,N=y.maxBarSize,R=FK(O),M=R.numericAxisName,C=R.cateAxisName,T=MIe(b),A=[];return b.forEach(function(I,F){var D=yv(y.data,{graphicalItems:[I],dataStartIndex:S,dataEndIndex:j}),V=I.type.defaultProps!==void 0?de(de({},I.type.defaultProps),I.props):I.props,U=V.dataKey,B=V.maxBarSize,K=V["".concat(M,"Id")],te=V["".concat(C,"Id")],L={},$=s.reduce(function(Ce,Ze){var Je=v["".concat(Ze.axisType,"Map")],Qe=V["".concat(Ze.axisType,"Id")];Je&&Je[Qe]||Ze.axisType==="zAxis"||Is();var Rt=Je[Qe];return de(de({},Ce),{},He(He({},Ze.axisType,Rt),"".concat(Ze.axisType,"Ticks"),ri(Rt)))},L),W=$[C],q=$["".concat(C,"Ticks")],Z=w&&w[K]&&w[K].hasStack&&TPe(I,w[K].stackGroups),ee=Zo(I.type).indexOf("Bar")>=0,oe=Ig(W,q),H=[],le=T&&gPe({barSize:E,stackGroups:w,totalSize:TIe($,C)});if(ee){var ie,pe,Oe=Ot(B)?N:B,Ue=(ie=(pe=Ig(W,q,!0))!==null&&pe!==void 0?pe:Oe)!==null&&ie!==void 0?ie:0;H=vPe({barGap:P,barCategoryGap:k,bandSize:Ue!==oe?Ue:oe,sizeList:le[te],maxBarSize:Oe}),Ue!==oe&&(H=H.map(function(Ce){return de(de({},Ce),{},{position:de(de({},Ce.position),{},{offset:Ce.position.offset-Ue/2})})}))}var Ve=I&&I.type&&I.type.getComposedData;Ve&&A.push({props:de(de({},Ve(de(de({},$),{},{displayedData:D,props:y,dataKey:U,item:I,bandSize:oe,barPosition:H,offset:_,stackedData:Z,layout:O,dataStartIndex:S,dataEndIndex:j}))),{},He(He(He({key:I.key||"item-".concat(F)},M,$[M]),C,$[C]),"animationId",x)),childIndex:F_e(I,y.children),item:I})}),A},f=function(y,v){var b=y.props,w=y.dataStartIndex,_=y.dataEndIndex,x=y.updateId;if(!rU({props:b}))return null;var S=b.children,j=b.layout,E=b.stackOffset,O=b.data,P=b.reverseStackOrder,k=FK(j),N=k.numericAxisName,R=k.cateAxisName,M=Pa(S,n),C=NPe(O,M,"".concat(N,"Id"),"".concat(R,"Id"),E,P),T=s.reduce(function(V,U){var B="".concat(U.axisType,"Map");return de(de({},V),{},He({},B,PIe(b,de(de({},U),{},{graphicalItems:M,stackGroups:U.axisType===N&&C,dataStartIndex:w,dataEndIndex:_}))))},{}),A=AIe(de(de({},T),{},{props:b,graphicalItems:M}),v==null?void 0:v.legendBBox);Object.keys(T).forEach(function(V){T[V]=l(b,T[V],A,V.replace("Map",""),t)});var I=T["".concat(R,"Map")],F=NIe(I),D=d(b,de(de({},T),{},{dataStartIndex:w,dataEndIndex:_,updateId:x,graphicalItems:M,stackGroups:C,offset:A}));return de(de({formattedGraphicalItems:D,graphicalItems:M,offset:A,stackGroups:C},F),T)},p=function(y){function v(b){var w,_,x;return fIe(this,v),x=mIe(this,v,[b]),He(x,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),He(x,"accessibilityManager",new QRe),He(x,"handleLegendBBoxUpdate",function(S){if(S){var j=x.state,E=j.dataStartIndex,O=j.dataEndIndex,P=j.updateId;x.setState(de({legendBBox:S},f({props:x.props,dataStartIndex:E,dataEndIndex:O,updateId:P},de(de({},x.state),{},{legendBBox:S}))))}}),He(x,"handleReceiveSyncEvent",function(S,j,E){if(x.props.syncId===S){if(E===x.eventEmitterSymbol&&typeof x.props.syncMethod!="function")return;x.applySyncEvent(j)}}),He(x,"handleBrushChange",function(S){var j=S.startIndex,E=S.endIndex;if(j!==x.state.dataStartIndex||E!==x.state.dataEndIndex){var O=x.state.updateId;x.setState(function(){return de({dataStartIndex:j,dataEndIndex:E},f({props:x.props,dataStartIndex:j,dataEndIndex:E,updateId:O},x.state))}),x.triggerSyncEvent({dataStartIndex:j,dataEndIndex:E})}}),He(x,"handleMouseEnter",function(S){var j=x.getMouseInfo(S);if(j){var E=de(de({},j),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseEnter;lt(O)&&O(E,S)}}),He(x,"triggeredAfterMouseMove",function(S){var j=x.getMouseInfo(S),E=j?de(de({},j),{},{isTooltipActive:!0}):{isTooltipActive:!1};x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseMove;lt(O)&&O(E,S)}),He(x,"handleItemMouseEnter",function(S){x.setState(function(){return{isTooltipActive:!0,activeItem:S,activePayload:S.tooltipPayload,activeCoordinate:S.tooltipPosition||{x:S.cx,y:S.cy}}})}),He(x,"handleItemMouseLeave",function(){x.setState(function(){return{isTooltipActive:!1}})}),He(x,"handleMouseMove",function(S){S.persist(),x.throttleTriggeredAfterMouseMove(S)}),He(x,"handleMouseLeave",function(S){x.throttleTriggeredAfterMouseMove.cancel();var j={isTooltipActive:!1};x.setState(j),x.triggerSyncEvent(j);var E=x.props.onMouseLeave;lt(E)&&E(j,S)}),He(x,"handleOuterEvent",function(S){var j=$_e(S),E=Rr(x.props,"".concat(j));if(j&&lt(E)){var O,P;/.*touch.*/i.test(j)?P=x.getMouseInfo(S.changedTouches[0]):P=x.getMouseInfo(S),E((O=P)!==null&&O!==void 0?O:{},S)}}),He(x,"handleClick",function(S){var j=x.getMouseInfo(S);if(j){var E=de(de({},j),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onClick;lt(O)&&O(E,S)}}),He(x,"handleMouseDown",function(S){var j=x.props.onMouseDown;if(lt(j)){var E=x.getMouseInfo(S);j(E,S)}}),He(x,"handleMouseUp",function(S){var j=x.props.onMouseUp;if(lt(j)){var E=x.getMouseInfo(S);j(E,S)}}),He(x,"handleTouchMove",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&x.throttleTriggeredAfterMouseMove(S.changedTouches[0])}),He(x,"handleTouchStart",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&x.handleMouseDown(S.changedTouches[0])}),He(x,"handleTouchEnd",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&x.handleMouseUp(S.changedTouches[0])}),He(x,"triggerSyncEvent",function(S){x.props.syncId!==void 0&&CP.emit(kP,x.props.syncId,S,x.eventEmitterSymbol)}),He(x,"applySyncEvent",function(S){var j=x.props,E=j.layout,O=j.syncMethod,P=x.state.updateId,k=S.dataStartIndex,N=S.dataEndIndex;if(S.dataStartIndex!==void 0||S.dataEndIndex!==void 0)x.setState(de({dataStartIndex:k,dataEndIndex:N},f({props:x.props,dataStartIndex:k,dataEndIndex:N,updateId:P},x.state)));else if(S.activeTooltipIndex!==void 0){var R=S.chartX,M=S.chartY,C=S.activeTooltipIndex,T=x.state,A=T.offset,I=T.tooltipTicks;if(!A)return;if(typeof O=="function")C=O(I,S);else if(O==="value"){C=-1;for(var F=0;F<I.length;F++)if(I[F].value===S.activeLabel){C=F;break}}var D=de(de({},A),{},{x:A.left,y:A.top}),V=Math.min(R,D.x+D.width),U=Math.min(M,D.y+D.height),B=I[C]&&I[C].value,K=AP(x.state,x.props.data,C),te=I[C]?{x:E==="horizontal"?I[C].coordinate:V,y:E==="horizontal"?U:I[C].coordinate}:IK;x.setState(de(de({},S),{},{activeLabel:B,activeCoordinate:te,activePayload:K,activeTooltipIndex:C}))}else x.setState(S)}),He(x,"renderCursor",function(S){var j,E=x.state,O=E.isTooltipActive,P=E.activeCoordinate,k=E.activePayload,N=E.offset,R=E.activeTooltipIndex,M=E.tooltipAxisBandSize,C=x.getTooltipEventType(),T=(j=S.props.active)!==null&&j!==void 0?j:O,A=x.props.layout,I=S.key||"_recharts-cursor";return Y.createElement(oIe,{key:I,activeCoordinate:P,activePayload:k,activeTooltipIndex:R,chartName:t,element:S,isActive:T,layout:A,offset:N,tooltipAxisBandSize:M,tooltipEventType:C})}),He(x,"renderPolarAxis",function(S,j,E){var O=Rr(S,"type.axisType"),P=Rr(x.state,"".concat(O,"Map")),k=S.type.defaultProps,N=k!==void 0?de(de({},k),S.props):S.props,R=P&&P[N["".concat(O,"Id")]];return g.cloneElement(S,de(de({},R),{},{className:Pt(O,R.className),key:S.key||"".concat(j,"-").concat(E),ticks:ri(R,!0)}))}),He(x,"renderPolarGrid",function(S){var j=S.props,E=j.radialLines,O=j.polarAngles,P=j.polarRadius,k=x.state,N=k.radiusAxisMap,R=k.angleAxisMap,M=Di(N),C=Di(R),T=C.cx,A=C.cy,I=C.innerRadius,F=C.outerRadius;return g.cloneElement(S,{polarAngles:Array.isArray(O)?O:ri(C,!0).map(function(D){return D.coordinate}),polarRadius:Array.isArray(P)?P:ri(M,!0).map(function(D){return D.coordinate}),cx:T,cy:A,innerRadius:I,outerRadius:F,key:S.key||"polar-grid",radialLines:E})}),He(x,"renderLegend",function(){var S=x.state.formattedGraphicalItems,j=x.props,E=j.children,O=j.width,P=j.height,k=x.props.margin||{},N=O-(k.left||0)-(k.right||0),R=BH({children:E,formattedGraphicalItems:S,legendWidth:N,legendContent:c});if(!R)return null;var M=R.item,C=NK(R,iIe);return g.cloneElement(M,de(de({},C),{},{chartWidth:O,chartHeight:P,margin:k,onBBoxUpdate:x.handleLegendBBoxUpdate}))}),He(x,"renderTooltip",function(){var S,j=x.props,E=j.children,O=j.accessibilityLayer,P=Er(E,no);if(!P)return null;var k=x.state,N=k.isTooltipActive,R=k.activeCoordinate,M=k.activePayload,C=k.activeLabel,T=k.offset,A=(S=P.props.active)!==null&&S!==void 0?S:N;return g.cloneElement(P,{viewBox:de(de({},T),{},{x:T.left,y:T.top}),active:A,label:C,payload:A?M:[],coordinate:R,accessibilityLayer:O})}),He(x,"renderBrush",function(S){var j=x.props,E=j.margin,O=j.data,P=x.state,k=P.offset,N=P.dataStartIndex,R=P.dataEndIndex,M=P.updateId;return g.cloneElement(S,{key:S.key||"_recharts-brush",onChange:Rg(x.handleBrushChange,S.props.onChange),data:O,x:we(S.props.x)?S.props.x:k.left,y:we(S.props.y)?S.props.y:k.top+k.height+k.brushBottom-(E.bottom||0),width:we(S.props.width)?S.props.width:k.width,startIndex:N,endIndex:R,updateId:"brush-".concat(M)})}),He(x,"renderReferenceElement",function(S,j,E){if(!S)return null;var O=x,P=O.clipPathId,k=x.state,N=k.xAxisMap,R=k.yAxisMap,M=k.offset,C=S.type.defaultProps||{},T=S.props,A=T.xAxisId,I=A===void 0?C.xAxisId:A,F=T.yAxisId,D=F===void 0?C.yAxisId:F;return g.cloneElement(S,{key:S.key||"".concat(j,"-").concat(E),xAxis:N[I],yAxis:R[D],viewBox:{x:M.left,y:M.top,width:M.width,height:M.height},clipPathId:P})}),He(x,"renderActivePoints",function(S){var j=S.item,E=S.activePoint,O=S.basePoint,P=S.childIndex,k=S.isRange,N=[],R=j.props.key,M=j.item.type.defaultProps!==void 0?de(de({},j.item.type.defaultProps),j.item.props):j.item.props,C=M.activeDot,T=M.dataKey,A=de(de({index:P,dataKey:T,cx:E.x,cy:E.y,r:4,fill:yk(j.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},Et(C,!1)),Vy(C));return N.push(v.renderActiveDot(C,A,"".concat(R,"-activePoint-").concat(P))),O?N.push(v.renderActiveDot(C,de(de({},A),{},{cx:O.x,cy:O.y}),"".concat(R,"-basePoint-").concat(P))):k&&N.push(null),N}),He(x,"renderGraphicChild",function(S,j,E){var O=x.filterFormatItem(S,j,E);if(!O)return null;var P=x.getTooltipEventType(),k=x.state,N=k.isTooltipActive,R=k.tooltipAxis,M=k.activeTooltipIndex,C=k.activeLabel,T=x.props.children,A=Er(T,no),I=O.props,F=I.points,D=I.isRange,V=I.baseLine,U=O.item.type.defaultProps!==void 0?de(de({},O.item.type.defaultProps),O.item.props):O.item.props,B=U.activeDot,K=U.hide,te=U.activeBar,L=U.activeShape,$=!!(!K&&N&&A&&(B||te||L)),W={};P!=="axis"&&A&&A.props.trigger==="click"?W={onClick:Rg(x.handleItemMouseEnter,S.props.onClick)}:P!=="axis"&&(W={onMouseLeave:Rg(x.handleItemMouseLeave,S.props.onMouseLeave),onMouseEnter:Rg(x.handleItemMouseEnter,S.props.onMouseEnter)});var q=g.cloneElement(S,de(de({},O.props),W));function Z(Je){return typeof R.dataKey=="function"?R.dataKey(Je.payload):null}if($)if(M>=0){var ee,oe;if(R.dataKey&&!R.allowDuplicatedCategory){var H=typeof R.dataKey=="function"?Z:"payload.".concat(R.dataKey.toString());ee=eO(F,H,C),oe=D&&V&&eO(V,H,C)}else ee=F==null?void 0:F[M],oe=D&&V&&V[M];if(L||te){var le=S.props.activeIndex!==void 0?S.props.activeIndex:M;return[g.cloneElement(S,de(de(de({},O.props),W),{},{activeIndex:le})),null,null]}if(!Ot(ee))return[q].concat(Ql(x.renderActivePoints({item:O,activePoint:ee,basePoint:oe,childIndex:M,isRange:D})))}else{var ie,pe=(ie=x.getItemByXY(x.state.activeCoordinate))!==null&&ie!==void 0?ie:{graphicalItem:q},Oe=pe.graphicalItem,Ue=Oe.item,Ve=Ue===void 0?S:Ue,Ce=Oe.childIndex,Ze=de(de(de({},O.props),W),{},{activeIndex:Ce});return[g.cloneElement(Ve,Ze),null,null]}return D?[q,null,null]:[q,null]}),He(x,"renderCustomized",function(S,j,E){return g.cloneElement(S,de(de({key:"recharts-customized-".concat(E)},x.props),x.state))}),He(x,"renderMap",{CartesianGrid:{handler:mv,once:!0},ReferenceArea:{handler:x.renderReferenceElement},ReferenceLine:{handler:mv},ReferenceDot:{handler:x.renderReferenceElement},XAxis:{handler:mv},YAxis:{handler:mv},Brush:{handler:x.renderBrush,once:!0},Bar:{handler:x.renderGraphicChild},Line:{handler:x.renderGraphicChild},Area:{handler:x.renderGraphicChild},Radar:{handler:x.renderGraphicChild},RadialBar:{handler:x.renderGraphicChild},Scatter:{handler:x.renderGraphicChild},Pie:{handler:x.renderGraphicChild},Funnel:{handler:x.renderGraphicChild},Tooltip:{handler:x.renderCursor,once:!0},PolarGrid:{handler:x.renderPolarGrid,once:!0},PolarAngleAxis:{handler:x.renderPolarAxis},PolarRadiusAxis:{handler:x.renderPolarAxis},Customized:{handler:x.renderCustomized}}),x.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:Uy("recharts"),"-clip"),x.throttleTriggeredAfterMouseMove=Av(x.triggeredAfterMouseMove,(_=b.throttleDelay)!==null&&_!==void 0?_:1e3/60),x.state={},x}return vIe(v,y),hIe(v,[{key:"componentDidMount",value:function(){var b,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,w=b.children,_=b.data,x=b.height,S=b.layout,j=Er(w,no);if(j){var E=j.props.defaultIndex;if(!(typeof E!="number"||E<0||E>this.state.tooltipTicks.length-1)){var O=this.state.tooltipTicks[E]&&this.state.tooltipTicks[E].value,P=AP(this.state,_,E,O),k=this.state.tooltipTicks[E].coordinate,N=(this.state.offset.top+x)/2,R=S==="horizontal",M=R?{x:k,y:N}:{y:k,x:N},C=this.state.formattedGraphicalItems.find(function(A){var I=A.item;return I.type.name==="Scatter"});C&&(M=de(de({},M),C.props.points[E].tooltipPosition),P=C.props.points[E].tooltipPayload);var T={activeTooltipIndex:E,isTooltipActive:!0,activeLabel:O,activePayload:P,activeCoordinate:M};this.setState(T),this.renderCursor(j),this.accessibilityManager.setIndex(E)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var _,x;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(x=this.props.margin.top)!==null&&x!==void 0?x:0}})}return null}},{key:"componentDidUpdate",value:function(b){iO([Er(b.children,no)],[Er(this.props.children,no)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=Er(this.props.children,no);if(b&&typeof b.props.shared=="boolean"){var w=b.props.shared?"axis":"item";return i.indexOf(w)>=0?w:a}return a}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var w=this.container,_=w.getBoundingClientRect(),x=MEe(_),S={chartX:Math.round(b.pageX-x.left),chartY:Math.round(b.pageY-x.top)},j=_.width/w.offsetWidth||1,E=this.inRange(S.chartX,S.chartY,j);if(!E)return null;var O=this.state,P=O.xAxisMap,k=O.yAxisMap,N=this.getTooltipEventType();if(N!=="axis"&&P&&k){var R=Di(P).scale,M=Di(k).scale,C=R&&R.invert?R.invert(S.chartX):null,T=M&&M.invert?M.invert(S.chartY):null;return de(de({},S),{},{xValue:C,yValue:T})}var A=LK(this.state,this.props.data,this.props.layout,E);return A?de(de({},S),A):null}},{key:"inRange",value:function(b,w){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=this.props.layout,S=b/_,j=w/_;if(x==="horizontal"||x==="vertical"){var E=this.state.offset,O=S>=E.left&&S<=E.left+E.width&&j>=E.top&&j<=E.top+E.height;return O?{x:S,y:j}:null}var P=this.state,k=P.angleAxisMap,N=P.radiusAxisMap;if(k&&N){var R=Di(k);return nq({x:S,y:j},R)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,w=this.getTooltipEventType(),_=Er(b,no),x={};_&&w==="axis"&&(_.props.trigger==="click"?x={onClick:this.handleClick}:x={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var S=Vy(this.props,this.handleOuterEvent);return de(de({},S),x)}},{key:"addListener",value:function(){CP.on(kP,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){CP.removeListener(kP,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,w,_){for(var x=this.state.formattedGraphicalItems,S=0,j=x.length;S<j;S++){var E=x[S];if(E.item===b||E.props.key===b.key||w===Zo(E.item.type)&&_===E.childIndex)return E}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,w=this.state.offset,_=w.left,x=w.top,S=w.height,j=w.width;return Y.createElement("defs",null,Y.createElement("clipPath",{id:b},Y.createElement("rect",{x:_,y:x,height:S,width:j})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(w,_){var x=PK(_,2),S=x[0],j=x[1];return de(de({},w),{},He({},S,j.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(w,_){var x=PK(_,2),S=x[0],j=x[1];return de(de({},w),{},He({},S,j.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(b){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(b){var w=this.state,_=w.formattedGraphicalItems,x=w.activeItem;if(_&&_.length)for(var S=0,j=_.length;S<j;S++){var E=_[S],O=E.props,P=E.item,k=P.type.defaultProps!==void 0?de(de({},P.type.defaultProps),P.props):P.props,N=Zo(P.type);if(N==="Bar"){var R=(O.data||[]).find(function(A){return dAe(b,A)});if(R)return{graphicalItem:E,payload:R}}else if(N==="RadialBar"){var M=(O.data||[]).find(function(A){return nq(b,A)});if(M)return{graphicalItem:E,payload:M}}else if(Zg(E,x)||Kg(E,x)||rp(E,x)){var C=GAe({graphicalItem:E,activeTooltipItem:x,itemData:k.data}),T=k.activeIndex===void 0?C:k.activeIndex;return{graphicalItem:de(de({},E),{},{childIndex:T}),payload:rp(E,x)?k.data[C]:E.props.data[C]}}}return null}},{key:"render",value:function(){var b=this;if(!rU(this))return null;var w=this.props,_=w.children,x=w.className,S=w.width,j=w.height,E=w.style,O=w.compact,P=w.title,k=w.desc,N=NK(w,sIe),R=Et(N,!1);if(O)return Y.createElement(HZ,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Y.createElement(cO,Jl({},R,{width:S,height:j,title:P,desc:k}),this.renderClipPath(),oU(_,this.renderMap)));if(this.props.accessibilityLayer){var M,C;R.tabIndex=(M=this.props.tabIndex)!==null&&M!==void 0?M:0,R.role=(C=this.props.role)!==null&&C!==void 0?C:"application",R.onKeyDown=function(A){b.accessibilityManager.keyboardEvent(A)},R.onFocus=function(){b.accessibilityManager.focus()}}var T=this.parseEventsOfWrapper();return Y.createElement(HZ,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Y.createElement("div",Jl({className:Pt("recharts-wrapper",x),style:de({position:"relative",cursor:"default",width:S,height:j},E)},T,{ref:function(A){b.container=A}}),Y.createElement(cO,Jl({},R,{width:S,height:j,title:P,desc:k,style:jIe}),this.renderClipPath(),oU(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(g.Component);He(p,"displayName",t),He(p,"defaultProps",de({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),He(p,"getDerivedStateFromProps",function(y,v){var b=y.dataKey,w=y.data,_=y.children,x=y.width,S=y.height,j=y.layout,E=y.stackOffset,O=y.margin,P=v.dataStartIndex,k=v.dataEndIndex;if(v.updateId===void 0){var N=$K(y);return de(de(de({},N),{},{updateId:0},f(de(de({props:y},N),{},{updateId:0}),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:S,prevLayout:j,prevStackOffset:E,prevMargin:O,prevChildren:_})}if(b!==v.prevDataKey||w!==v.prevData||x!==v.prevWidth||S!==v.prevHeight||j!==v.prevLayout||E!==v.prevStackOffset||!bl(O,v.prevMargin)){var R=$K(y),M={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},C=de(de({},LK(v,w,j)),{},{updateId:v.updateId+1}),T=de(de(de({},R),M),C);return de(de(de({},T),f(de({props:y},T),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:S,prevLayout:j,prevStackOffset:E,prevMargin:O,prevChildren:_})}if(!iO(_,v.prevChildren)){var A,I,F,D,V=Er(_,Fl),U=V&&(A=(I=V.props)===null||I===void 0?void 0:I.startIndex)!==null&&A!==void 0?A:P,B=V&&(F=(D=V.props)===null||D===void 0?void 0:D.endIndex)!==null&&F!==void 0?F:k,K=U!==P||B!==k,te=!Ot(w),L=te&&!K?v.updateId:v.updateId+1;return de(de({updateId:L},f(de(de({props:y},v),{},{updateId:L,dataStartIndex:U,dataEndIndex:B}),v)),{},{prevChildren:_,dataStartIndex:U,dataEndIndex:B})}return null}),He(p,"renderActiveDot",function(y,v,b){var w;return g.isValidElement(y)?w=g.cloneElement(y,v):lt(y)?w=y(v):w=Y.createElement(Jq,v),Y.createElement(_n,{className:"recharts-active-dot",key:b},w)});var m=g.forwardRef(function(y,v){return Y.createElement(p,Jl({},y,{ref:v}))});return m.displayName=p.displayName,m},IIe=RIe({chartName:"BarChart",GraphicalChild:$s,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:dv},{axisType:"yAxis",AxisComp:jP}],formatAxisMap:K2e});const DIe={light:"",dark:".dark"},BK=g.createContext(null);function zK(){const e=g.useContext(BK);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const UK=g.forwardRef(({id:e,className:t,children:n,config:r,...a},o)=>{const i=g.useId(),s=`chart-${e||i.replace(/:/g,"")}`;return h.jsx(BK.Provider,{value:{config:r},children:h.jsxs("div",{"data-chart":s,ref:o,className:G("flex aspect-video justify-center text-xs",t),...a,children:[h.jsx(LIe,{id:s,config:r}),h.jsx(jEe,{children:n})]})})});UK.displayName="Chart";const LIe=({id:e,config:t})=>{const n=Object.entries(t).filter(([r,a])=>a.theme||a.color);return n.length?h.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(DIe).map(([r,a])=>`
${a} [data-chart=${e}] {
${n.map(([o,i])=>{var c;const s=((c=i.theme)==null?void 0:c[r])||i.color;return s?`  --color-${o}: ${s};`:null}).join(`
`)}
}
`).join(`
`)}}):null},$Ie=no,VK=g.forwardRef(({active:e,payload:t,className:n,indicator:r="dot",hideLabel:a=!1,hideIndicator:o=!1,label:i,labelFormatter:s,labelClassName:c,formatter:l,color:u,nameKey:d,labelKey:f},p)=>{const{config:m}=zK(),y=g.useMemo(()=>{var S;if(a||!(t!=null&&t.length))return null;const[b]=t,w=`${f||b.dataKey||b.name||"value"}`,_=TP(m,b,w),x=!f&&typeof i=="string"?((S=m[i])==null?void 0:S.label)||i:_==null?void 0:_.label;return s?h.jsx("div",{className:G("font-medium",c),children:s(x,t)}):x?h.jsx("div",{className:G("font-medium",c),children:x}):null},[i,s,t,a,c,m,f]);if(!e||!(t!=null&&t.length))return null;const v=t.length===1&&r!=="dot";return h.jsxs("div",{ref:p,className:G("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[v?null:y,h.jsx("div",{className:"grid gap-1.5",children:t.map((b,w)=>{const _=`${d||b.name||b.dataKey||"value"}`,x=TP(m,b,_),S=u||b.payload.fill||b.color;return h.jsx("div",{className:G("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",r==="dot"&&"items-center"),children:l&&(b==null?void 0:b.value)!==void 0&&b.name?l(b.value,b.name,b,w,b.payload):h.jsxs(h.Fragment,{children:[x!=null&&x.icon?h.jsx(x.icon,{}):!o&&h.jsx("div",{className:G("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":v&&r==="dashed"}),style:{"--color-bg":S,"--color-border":S}}),h.jsxs("div",{className:G("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[h.jsxs("div",{className:"grid gap-1.5",children:[v?y:null,h.jsx("span",{className:"text-muted-foreground",children:(x==null?void 0:x.label)||b.name})]}),b.value&&h.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:b.value.toLocaleString()})]})]})},b.dataKey)})})]})});VK.displayName="ChartTooltip";const FIe=g.forwardRef(({className:e,hideIcon:t=!1,payload:n,verticalAlign:r="bottom",nameKey:a},o)=>{const{config:i}=zK();return n!=null&&n.length?h.jsx("div",{ref:o,className:G("flex items-center justify-center gap-4",r==="top"?"pb-3":"pt-3",e),children:n.map(s=>{const c=`${a||s.dataKey||"value"}`,l=TP(i,s,c);return h.jsxs("div",{className:G("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[l!=null&&l.icon&&!t?h.jsx(l.icon,{}):h.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:s.color}}),l==null?void 0:l.label]},s.value)})}):null});FIe.displayName="ChartLegend";function TP(e,t,n){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=n;return n in t&&typeof t[n]=="string"?a=t[n]:r&&n in r&&typeof r[n]=="string"&&(a=r[n]),a in e?e[a]:e[n]}const WK=e=>{const t=["Bytes","KB","MB","GB","TB"];if(e===void 0)return"Unknown size";if(e===0)return"0 Byte";const n=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,n))} ${t[n]}`},BIe=g.memo(()=>{const{t:e}=Re("flows"),[t,n]=g.useState(),r=co(m=>m.cachedLLMURLs),a=st(m=>m.currentSession),[o,i]=g.useState(),[s,c]=g.useState(""),[l,u]=g.useState(),d=g.useMemo(()=>({nodes:{label:e("session_info_node.entities.nodes"),color:"#2563eb"},edges:{label:e("session_info_node.entities.edges"),color:"#34d399"},threads:{label:e("session_info_node.entities.threads"),color:"#fbbf24"},llms:{label:e("session_info_node.entities.llms"),color:"#f87171"},prompts:{label:e("session_info_node.entities.prompts"),color:"#a78bfa"},tools:{label:e("session_info_node.entities.tools"),color:"#ffcccb"},schemas:{label:e("session_info_node.entities.schemas"),color:"#ffb6c1"},vectorDatabases:{label:e("session_info_node.entities.vector_databases"),color:"#ff69b4"},jsonlDatas:{label:e("session_info_node.entities.jsonl_data"),color:"#ff1493"},csvDatas:{label:e("session_info_node.entities.csv_data"),color:"#db7093"}}),[e]);g.useEffect(()=>{Qt(async()=>{const{functionCallingModelIds:m,prebuiltAppConfig:y}=await import("./index-CIMzE0bz.js").then(async v=>(await v.__tla,v));return{functionCallingModelIds:m,prebuiltAppConfig:y}},__vite__mapDeps([9,1,2,3,4])).then(({functionCallingModelIds:m,prebuiltAppConfig:y})=>{n(r==null?void 0:r.map(v=>{const b=y.model_list.find(w=>v.includes(w.model));if(b)return{model_id:(b==null?void 0:b.model_id)||"",info:b,isFunctionCalling:m.includes((b==null?void 0:b.model_id)||"")}}))})},[r,a==null?void 0:a.id]);const f=g.useCallback(async()=>{navigator.storage.estimate().then(m=>{m&&c(e("session_info_node.used_bytes",{used:WK(m.usage),total:WK(m==null?void 0:m.quota)}))}),a!=null&&a.id&&(Promise.all([he("FlowNode").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),he("FlowEdge").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),he("Thread").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),he("Prompt").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),he("LLM").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),he("Schema").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),he("ToolDefinition").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),he("VectorDatabase").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),he("JSONLData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),he("CSVData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}})]).then(m=>{const y=m.reduce((v,b)=>b!=null&&b.updated_at&&(!v||new Date(b.updated_at)>v)?new Date(b.updated_at):v,a.updated_at?new Date(a.updated_at):void 0);i(y)}),Promise.all([he("FlowNode").count({where:{session_id:a==null?void 0:a.id}}),he("FlowEdge").count({where:{session_id:a==null?void 0:a.id}}),he("Thread").count({where:{session_id:a==null?void 0:a.id}}),he("Prompt").count({where:{session_id:a==null?void 0:a.id}}),he("LLM").count({where:{session_id:a==null?void 0:a.id}}),he("ToolDefinition").count({where:{session_id:a==null?void 0:a.id}}),he("Schema").count({where:{session_id:a==null?void 0:a.id}}),he("VectorDatabase").count({where:{session_id:a==null?void 0:a.id}}),he("JSONLData").count({where:{session_id:a==null?void 0:a.id}}),he("CSVData").count({where:{session_id:a==null?void 0:a.id}})]).then(([m,y,v,b,w,_,x,S,j,E])=>{u([{name:e("session_info_node.count_info.title"),nodes:m||0,edges:y||0,threads:v||0,prompts:b||0,llms:w||0,tools:_||0,schemas:x||0,vectorDatabases:S||0,jsonlDatas:j||0,csvDatas:E||0}])}))},[a==null?void 0:a.id,a==null?void 0:a.updated_at,e]),p=g.useCallback(()=>{f()},[f]);return g.useEffect(()=>{f()},[f]),h.jsxs(rn,{className:"w-96",children:[h.jsxs(Yn,{children:[h.jsx(sr,{children:e("session_info_node.title")}),h.jsx(Z9,{children:o||a!=null&&a.updated_at?A4e(o||(a==null?void 0:a.updated_at)).fromNow():""})]}),h.jsxs(Jn,{className:"grid gap-4",children:[h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsx("p",{className:"text-sm font-medium leading-none",children:e("session_info_node.disk_size")}),h.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})}),h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsxs("div",{className:"text-sm font-medium leading-none",children:[e("session_info_node.cached_llms"),h.jsx(Mn,{className:"ml-2",children:(t==null?void 0:t.length)||0})]}),t==null?void 0:t.map(m=>h.jsxs("div",{className:"text-sm text-muted-foreground gap-1",children:[m==null?void 0:m.model_id,h.jsx("div",{className:"max-w-full gap-1 flex flex-wrap mt-1",children:h.jsx(af,{model:m==null?void 0:m.info,isFunctionCalling:(m==null?void 0:m.isFunctionCalling)||!1,isCached:!0})})]},m==null?void 0:m.model_id))]})}),h.jsx("div",{children:h.jsx(UK,{config:d,className:"min-h-28 w-full",children:h.jsxs(IIe,{accessibilityLayer:!0,data:l,children:[h.jsx(yK,{vertical:!1}),h.jsx(dv,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),h.jsx($Ie,{content:h.jsx(VK,{})}),Object.entries(d).map(([m,y])=>h.jsx($s,{dataKey:m,fill:y.color,radius:4},m))]})})})]}),h.jsx(ki,{children:h.jsxs(yt,{className:"w-full",onClick:p,children:[h.jsx(me,{size:24,name:"refresh-ccw"}),e("session_info_node.reload")]})})]})}),zIe=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);Wn(e,t)},UIe=g.memo(e=>{var c,l;const{t}=Re("flows"),{id:n,data:r,isConnectable:a}=e,o=g.useRef(!1),i=Hn(n),s=ze(u=>u.updateNodes);return zIe(n),g.useEffect(()=>{var d;const u=r==null?void 0:r.entity;!u||!i||o.current||(d=u==null?void 0:u.schema_items)!=null&&d.length||r.loaded||(o.current=!0,he("SchemaItem").find({where:{schema_id:u.id}}).then(f=>{s([{id:i.id,type:"replace",item:{...i,data:{...(i==null?void 0:i.data)||{},loaded:!0,entity:{...r.entity,schema_items:f}}}}])}).finally(()=>{o.current=!1}))},[r.entity,r.loaded,i,s]),h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Fn,{id:n}),h.jsxs(zj,{defaultValue:"account",className:"w-[400px]",children:[h.jsxs(wy,{className:"grid w-full grid-cols-2",children:[h.jsx(ja,{value:"account",children:t("schema_node.typescript")}),h.jsx(ja,{value:"password",children:t("schema_node.zod")})]}),h.jsx(Ea,{value:"account",children:h.jsx(rn,{className:"p-4",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:S0e(((c=r==null?void 0:r.entity)==null?void 0:c.schema_items)||[])})})}),h.jsx(Ea,{value:"password",children:h.jsx(rn,{className:"p-4 max-w-full",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:q9(((l=r==null?void 0:r.entity)==null?void 0:l.schema_items)||[])})})})]})]}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:a})]})}),VIe=g.memo(e=>{var o,i;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{if(!(n!=null&&n.entity))return{headers:[],rows:[]};const s=kv(n.entity.csv);return{headers:QP(n.entity.headers),rows:s.map(c=>QP(c))}},[n==null?void 0:n.entity]);return h.jsxs("div",{children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Fn,{id:t}),h.jsxs(rn,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Yn,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(me,{name:"file-spreadsheet",className:"mr-2"}),h.jsxs(it,{className:"!font-medium leading-none tracking-tight pr-8",children:[ue.CSVData," ",(o=a==null?void 0:a.rows)!=null&&o.length?`(${((i=a==null?void 0:a.rows)==null?void 0:i.length)||0})`:""]})]})}),h.jsx(Jn,{className:"pb-0",children:h.jsx(Ay,{data:a.rows,headers:a.headers})})]})]}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:r})]})}),WIe=e=>{const t=ze(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ue.Schema&&(o==null?void 0:o.type)===ue.ToolDefinition){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Wn(e,n)},HIe=g.memo(({id:e,data:t,isConnectable:n})=>{var r,a;return WIe(e),h.jsxs("div",{children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:n}),h.jsx("div",{children:h.jsxs(Ca,{className:"flex justify-center",children:[h.jsx(me,{size:24,name:"wrench"}),h.jsxs("div",{className:"ml-2",children:[h.jsx(Ho,{children:`${((r=t.entity)==null?void 0:r.name)||""}`}),h.jsx(yl,{children:`${((a=t.entity)==null?void 0:a.description)||""}`})]})]})}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:n})]})}),qIe=e=>{const t=g.useCallback(async({edgeId:n})=>({deleteEdgeId:n}),[]);Wn(e,t)},ZIe=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e;return qIe(t),h.jsxs("div",{children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:r}),h.jsx("div",{children:h.jsxs(Ca,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(Tr,{name:n.model||"brain",className:"w-7 h-7"}),h.jsx("div",{className:"ml-2 pr-4 flex items-center",children:h.jsx(Ho,{children:`${n.model||""}`})})]})}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:r})]})}),KIe=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
Use three sentences maximum and keep the answer as concise as possible.

{context}
`,XIe=uo(e=>{const{source:t,documents:n}=e,r=an(),{toast:a}=on(),{t:o}=Re("dialogs"),{loading:i,createPrompt:s}=j7(),c=async l=>{try{if(!l.content||!l.content.includes("{context}")){a({title:o("create_vector_database_prompt.errors.fill_context"),variant:"destructive"});return}const u=l.content.replace("{context}",n.map(d=>`<document>${d.pageContent}</document>`).join(`
`));return await s(t,{...l,content:u}),r.hide(),!0}catch{a({title:o("create_vector_database_prompt.errors.create_failed"),variant:"destructive"})}};return h.jsx(yi,{open:r.visible,onOpenChange:r.hide,children:h.jsxs(xo,{className:"sm:max-w-[425px]",children:[h.jsx(_o,{children:h.jsxs("div",{className:"flex",children:[h.jsx(me,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(So,{children:o("create_vector_database_prompt.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(HE,{onSubmit:c,loading:i,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:KIe}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(me,{name:"info",className:"mr-2",size:14}),o("create_vector_database_prompt.fill_content_note")]})]})]})})}),YIe=()=>{const e=st(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=ze(i=>i.createOrUpdateFlowNode),a=ze(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async({prompt:i,source:s,metadata:c})=>{var l,u,d,f;try{const p=(l=s==null?void 0:s.data)==null?void 0:l.entity;if(!p||!e)throw new Error("Source or Session not found");n(!0);const m=((u=s.position)==null?void 0:u.x)||0,y=(((d=s.position)==null?void 0:d.y)||0)+(((f=s.measured)==null?void 0:f.height)||0),v=await he("Prompt").save({...i,status:(i==null?void 0:i.status)||Yr.Started,role:(i==null?void 0:i.role)||hr.System,type:(i==null?void 0:i.type)||mr.Chat,content:(i==null?void 0:i.content)||"{context}",session_id:e});if(!v)throw new Error("Failed to save prompt");const b=await r({source_id:v.id,source_type:"Prompt",node_type:ue.Prompt,x:m,y:y+20});if(!b)throw new Error("Failed to save prompt node");const w=await he("FlowNodePlaceholder").save({placeholder:`Retriever for ${p.name}`,placeholder_type:ec.VECTOR_DATABASE_RETREIVER,session_id:e,metadata:c});if(!w)throw new Error("Failed to save node placeholder");const _=await r({source_id:w.id,source_type:"FlowNodePlaceholder",node_type:ue.PlaceHolder,x:m,y:y+40});if(!_)throw new Error("Failed to save node placeholder node");await a({source:b.id,target:_.id}),await a({source:s.id,target:_.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabaseRetriever:o}},JIe=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}
`,QIe=uo(e=>{const{source:t}=e,n=an(),{toast:r}=on(),{t:a}=Re("dialogs"),[o,i]=g.useState(1),[s,c]=g.useState(void 0),{loading:l,createVectorDatabaseRetriever:u}=YIe(),d=async m=>{try{const y=m.content;if(!y||!y.includes("{context}")){r({title:a("create_vector_database_retriever.errors.fill_context"),variant:"destructive"});return}return await u({source:t,prompt:{content:y},metadata:{k:o,minimalScore:s}}),i(1),c(void 0),n.hide(),!0}catch{r({title:a("create_vector_database_retriever.errors.create_failed"),variant:"destructive"})}},f=m=>{i(m.target.value?Number(m.target.value):void 0)},p=m=>{c(m.target.value?Number(m.target.value):void 0)};return h.jsx(yi,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(xo,{className:"sm:max-w-[425px]",children:[h.jsx(_o,{children:h.jsxs("div",{className:"flex",children:[h.jsx(me,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(So,{children:a("create_vector_database_retriever.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(HE,{onSubmit:d,loading:l,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:JIe}),h.jsxs(rn,{children:[h.jsx(Yn,{children:h.jsx(sr,{children:a("create_vector_database_retriever.retriever_settings")})}),h.jsxs(Jn,{children:[h.jsx(it,{children:a("create_vector_database_retriever.retriever_k")}),h.jsx(In,{value:o||"",type:"number",onChange:f,placeholder:a("create_vector_database_retriever.retriever_k_placeholder")}),h.jsx(it,{children:a("create_vector_database_retriever.retriever_minimum_score")}),h.jsx(In,{value:s||"",type:"number",onChange:p,placeholder:a("create_vector_database_retriever.retriever_minimum_score_placeholder")})]})]}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(me,{name:"info",className:"mr-2",size:14}),a("create_vector_database_retriever.fill_content_note")]})]})]})})}),GIe=e=>{const t=ze(a=>a.createOrUpdateFlowEdge),n=Hs(a=>a.index),r=g.useCallback(async({edgeId:a,target:o,source:i})=>{var s,c;try{const l=(s=o==null?void 0:o.data)==null?void 0:s.entity;if((i==null?void 0:i.type)===ue.CSVData&&(o==null?void 0:o.type)===ue.VectorDatabase){const u=(c=i==null?void 0:i.data)==null?void 0:c.entity;if(!u||!l)return{deleteEdgeId:a};const{rows:d}=ZX(u.headers,u.csv),f=d.map(p=>new bp({pageContent:`${p.text}`}));await n({databaseId:l.id,dataSourceId:u.id,dataSourceType:"CSVData"},f),await t({source:i.id,target:o.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[t,n]);Wn(e,r)},eDe=e=>{const[t,n]=g.useState(!1),{t:r}=Re("flows"),{toast:a}=on(),{getNode:o,getHandleConnections:i}=xr(),s=ze(f=>f.updateNodes),c=Hs(f=>f.index),l=Hs(f=>f.similaritySearchWithScore),u=g.useCallback(async(f,p)=>{var m,y,v;try{const b=o(e);if(!b)return;const w=(m=b.data)==null?void 0:m.entity;if(!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(w.storage===Zr.DataNode){const _=(v=(y=i({nodeId:e,type:"target"}).map(x=>o(x.source)).find(x=>(x==null?void 0:x.type)&&[ue.JSONLData,ue.CSVData].includes(x==null?void 0:x.type)))==null?void 0:y.data)==null?void 0:v.entity;if(!_){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}return n(!0),await l({databaseId:w.id,dataSourceId:_.id,dataSourceType:JP(_)},f,p==null?void 0:p.k)}else return n(!0),await l({databaseId:w.id},f,p==null?void 0:p.k)}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,l,a,r,o]),d=g.useCallback(async(f,p)=>{var m,y,v,b;try{const w=o(e);if(!w)return;n(!0);const _=f.content?[new bp({pageContent:f.content,id:f.id,metadata:{id:f.id}})]:f.documents;if(!(_!=null&&_.length)){a({variant:"destructive",title:r("vector_database_node.errors.content_not_found")});return}const x=(m=w.data)==null?void 0:m.entity;if(!x||!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(x.storage===Zr.DataNode){const S=i({nodeId:e,type:"target"}).map(k=>o(k.source)).find(k=>(k==null?void 0:k.type)&&[ue.JSONLData,ue.CSVData].includes(k==null?void 0:k.type)),j=(y=S==null?void 0:S.data)==null?void 0:y.entity;if(!j){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}const E=JP(j),O=dE(_,10);let P=0;for(const k of O){if((v=p==null?void 0:p.onProgressReport)==null||v.call(p,{handling:k.length,handled:P,total:_.length}),await c({databaseId:x.id,dataSourceId:j.id,dataSourceType:E},k),E&&S){const N=await he(E).findOne({where:{id:j.id}});s([{type:"replace",id:S.id,item:{...S,data:{...S.data,entity:N}}}])}P+=k.length}}else{const S=dE(_,10);let j=0;for(const E of S){(b=p==null?void 0:p.onProgressReport)==null||b.call(p,{handling:E.length,handled:j,total:_.length}),await c({databaseId:x.id},E);const O=await he("VectorDatabase").findOne({where:{id:`${x.id}`}});s([{type:"replace",id:w.id,item:{...w,data:{...w.data,entity:O}}}]),j+=E.length}}}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,c,a,r,o,s]);return{loading:t,indexData:d,similaritySearchWithScore:u}},tDe=g.memo(e=>{var j,E,O,P;const{t}=Re("flows"),[n,r]=g.useState(0),[a,o]=g.useState("search"),i=Hn(e.id),{id:s,data:c,isConnectable:l}=e,{loading:u,similaritySearchWithScore:d,indexData:f}=eDe(s),p=an(XIe),m=an(QIe);GIe(s);const y=g.useCallback(async(...k)=>{i&&await f(...k)},[f,i]),v=g.useCallback(async(k,N)=>{const R=k.trim(),M=await d(R,{k:N});if(M!=null&&M.length)return M},[d]),b=g.useCallback(k=>{p.show({source:i,documents:k.map(([N])=>N)})},[p,i]),w=g.useCallback(async()=>{m.show({source:i})},[m,i]),_=g.useCallback(async k=>{if(k.type.includes("text")||k.type.includes("txt")){const N=new FileReader;N.onload=async R=>{var C;const M=(C=R.target)==null?void 0:C.result;await y({content:M})},N.readAsText(k)}else if(k.type.endsWith("pdf")){const N=new Blob([k],{type:"application/pdf"}),R=await new K9(N,{pdfjs:async()=>{const M=await Qt(()=>import("./pdf.min-_jKpy57e.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([11,1,2,3,4]));return await Qt(()=>import("./pdf.worker.min-D4zSgXYp.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([12,1,2,3,4])),M.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),M},parsedItemSeparator:" "}).load();await y({documents:R},{onProgressReport:M=>{r((M.handled+M.handling)/M.total)}})}},[y]),x=g.useMemo(()=>{var R,M;if(!((R=c==null?void 0:c.entity)!=null&&R.raw))return{headers:[],rows:[]};const k=["content","embedding","metadata"],N=kv((M=c==null?void 0:c.entity)==null?void 0:M.raw);return{headers:k,rows:N.map(C=>{try{return JSON.parse(C)}catch{return[]}})}},[(j=c==null?void 0:c.entity)==null?void 0:j.raw]),S=g.useMemo(()=>{switch(a){case"search":return h.jsx(Ea,{value:"search",children:h.jsx(oB,{loading:u,onSimilaritySearch:v,onCreatePrompt:b,onCreateRetriever:w})});case"new":return h.jsx(Ea,{className:"min-w-80",value:"new",children:h.jsx(iB,{loading:u,onCreateData:y})});case"file":return h.jsx(Ea,{value:"file",children:h.jsx(sB,{loading:u,progress:n,onFileSubmit:_,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(Ea,{value:"view",children:h.jsx(Ay,{data:x.rows,headers:x.headers,limitLengthByColumns:{embedding:32}})})}},[y,b,w,_,v,u,a,n,x]);return h.jsxs("div",{className:"min-w-72",children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:l}),h.jsxs("div",{className:"max-w-full",children:[h.jsx(Fn,{id:s}),h.jsxs(Ca,{className:"flex justify-center",variant:"default",children:[h.jsx(me,{size:24,name:"database-zap"}),h.jsxs("div",{className:"ml-2 max-w-full",children:[h.jsx(Ho,{children:`${((E=c.entity)==null?void 0:E.name)||""}`}),h.jsxs(zj,{value:a,onValueChange:o,defaultValue:"search",className:G("w-full mt-4"),children:[h.jsxs(wy,{className:G("grid w-full grid-cols-3",((O=c.entity)==null?void 0:O.storage)===Zr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(ja,{value:"search",children:t("vector_database_node.search")}),h.jsx(ja,{value:"new",children:t("vector_database_node.text")}),h.jsx(ja,{value:"file",children:t("vector_database_node.file")}),((P=c.entity)==null?void 0:P.storage)===Zr.DatabaseNode?h.jsx(ja,{value:"view",children:t("vector_database_node.view")}):void 0]}),S]})]})]})]}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:l})]})}),nDe={embedding:32},rDe=g.memo(e=>{var o,i,s;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{var u;if(!((u=n==null?void 0:n.entity)!=null&&u.jsonl))return{headers:[],rows:[]};const c=QP(n.entity.headers||""),l=kv(n.entity.jsonl);return{headers:c,rows:l.map(d=>{try{return JSON.parse(d)}catch{return[]}})}},[(o=n==null?void 0:n.entity)==null?void 0:o.jsonl,n.entity.headers]);return h.jsxs("div",{className:"min-w-80",children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Fn,{id:t}),h.jsxs(rn,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Yn,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(me,{name:"file-json",className:"mr-2"}),h.jsxs(it,{className:"!font-medium leading-none tracking-tight pr-8",children:[ue.JSONLData," ",(i=a==null?void 0:a.rows)!=null&&i.length?`(${((s=a==null?void 0:a.rows)==null?void 0:s.length)||0})`:""]})]})}),h.jsx(Jn,{className:"pb-0",children:h.jsx(Ay,{data:a.rows,headers:a.headers,limitLengthByColumns:nDe})})]})]}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:r})]})}),HK=60,qK=140,aDe=lo("supports-backdrop-blur:bg-white/10 supports-backdrop-blur:dark:bg-black/10 mx-auto flex h-[58px] w-max gap-2 rounded-lg border p-2 backdrop-blur-md"),ZK=Y.forwardRef(({className:e,children:t,magnification:n=HK,distance:r=qK,direction:a="bottom",...o},i)=>{const s=M0(1/0),c=()=>Y.Children.map(t,l=>Y.isValidElement(l)&&l.type===dp?Y.cloneElement(l,{...l.props,mouseX:s,magnification:n,distance:r}):l);return h.jsx(hp.div,{ref:i,onMouseMove:l=>s.set(l.pageX),onMouseLeave:()=>s.set(1/0),...o,className:G(aDe({className:e}),{"items-start":a==="top","items-center":a==="middle","items-end":a==="bottom"}),children:c()})});ZK.displayName="Dock";const dp=({magnification:e=HK,distance:t=qK,mouseX:n,className:r,children:a,...o})=>{const i=g.useRef(null),s=QN(n||new T4e,u=>{var f;const d=((f=i.current)==null?void 0:f.getBoundingClientRect())??{x:0,width:0};return u-d.x-d.width/2}),c=QN(s,[-t,0,t],[40,e,40]),l=dY(c,{mass:.1,stiffness:150,damping:12});return h.jsx(hp.div,{ref:i,style:{width:l},className:G("flex aspect-square cursor-pointer items-center justify-center rounded-full",r),...o,children:a})};dp.displayName="DockIcon";let KK,XK,YK,JK,gv,QK,fp,GK,eX,tX,nX,rX,aX,oX,iX,sX,cX,lX,uX,dX,fX,pX,hX,mX,yX,gX,vX,bX;KK=e=>g.createElement("svg",{viewBox:"0 0 256 254",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:256,height:254,preserveAspectRatio:"xMidYMid",...e},g.createElement("defs",null,g.createElement("linearGradient",{id:"c",x1:"50%",x2:"50%",y1:"0%",y2:"100%"},g.createElement("stop",{offset:"0%",stopColor:"#FFF"}),g.createElement("stop",{offset:"100%",stopColor:"#FFF",stopOpacity:0})),g.createElement("path",{id:"a",d:"M180.828 252.605a15.872 15.872 0 0 0 12.65-.486l52.501-25.262a15.94 15.94 0 0 0 9.025-14.364V41.197a15.939 15.939 0 0 0-9.025-14.363l-52.5-25.263a15.877 15.877 0 0 0-18.115 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.507 91.695a15.853 15.853 0 0 0 5.464 3.571Zm10.464-183.649-76.262 57.889 76.262 57.888V68.956Z"})),g.createElement("mask",{id:"b",fill:"#fff"},g.createElement("use",{xlinkHref:"#a"})),g.createElement("path",{fill:"#0065A9",d:"M246.135 26.873 193.593 1.575a15.885 15.885 0 0 0-18.123 3.08L3.466 161.482c-4.626 4.219-4.62 11.502.012 15.714l14.05 12.772a10.625 10.625 0 0 0 13.569.604L238.229 33.436c6.949-5.271 16.93-.315 16.93 8.407v-.61a15.938 15.938 0 0 0-9.024-14.36Z"}),g.createElement("path",{fill:"#007ACC",d:"m246.135 226.816-52.542 25.298a15.887 15.887 0 0 1-18.123-3.08L3.466 92.207c-4.626-4.218-4.62-11.502.012-15.713l14.05-12.773a10.625 10.625 0 0 1 13.569-.603l207.132 157.135c6.949 5.271 16.93.315 16.93-8.408v.611a15.939 15.939 0 0 1-9.024 14.36Z"}),g.createElement("path",{fill:"#1F9CF0",d:"M193.428 252.134a15.892 15.892 0 0 1-18.125-3.083c5.881 5.88 15.938 1.715 15.938-6.603V11.273c0-8.318-10.057-12.483-15.938-6.602a15.892 15.892 0 0 1 18.125-3.084l52.533 25.263a15.937 15.937 0 0 1 9.03 14.363V212.51c0 6.125-3.51 11.709-9.03 14.363l-52.533 25.262Z"}),g.createElement("path",{fill:"url(#c)",fillOpacity:.25,d:"M180.828 252.605a15.874 15.874 0 0 0 12.65-.486l52.5-25.263a15.938 15.938 0 0 0 9.026-14.363V41.197a15.939 15.939 0 0 0-9.025-14.363L193.477 1.57a15.877 15.877 0 0 0-18.114 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.506 91.695a15.857 15.857 0 0 0 5.465 3.571Zm10.464-183.65-76.262 57.89 76.262 57.888V68.956Z"})),XK="/NoLLMChat/assets/plate-editor-C1jTW62C.png",YK={[ue.Shape]:{width:100,height:100},[ue.CircleShape]:{width:100,height:100},[ue.TriangleShape]:{width:100,height:100},[ue.EditorApp]:{width:1240,height:400}},JK=e=>{const t=Hn(e),n=st(s=>s.currentSession),[r,a]=g.useState(!1),o=ze(s=>s.createOrUpdateFlowNode),i=g.useCallback(async s=>{var c,l,u;try{if(a(!0),t&&(n==null?void 0:n.id)){const d=((c=t.position)==null?void 0:c.x)||0,f=(((l=t.position)==null?void 0:l.y)||0)+(((u=t.measured)==null?void 0:u.height)||0),p=await he("FlowNodeData").save({data:{},session_id:n.id});if(!p)throw new Error("Failed to save node data");if(!await o({node_type:s,data:{},source_id:p.id,source_type:"FlowNodeData",x:d,y:f+20,...YK[s]||{}}))throw new Error("Failed to save node")}}finally{a(!1)}},[o,n==null?void 0:n.id,t]);return{loading:r,createNode:i}},gv={applications:[{key:ue.EditorApp,image:XK,label:"application_bar.editor"},{key:ue.VSLiteApp,icon:KK,label:"application_bar.vslite"}],shapes:[{key:ue.Shape,icon:"square",label:"application_bar.square"},{key:ue.CircleShape,icon:"circle",label:"application_bar.circle"},{key:ue.TriangleShape,icon:"triangle",label:"application_bar.triangle"}],old:[{key:ue.CodeContainerApp,icon:"file-code-2",label:"application_bar.code_editor"}]},QK=g.memo(e=>{const{t}=Re("flows"),{toast:n}=on(),{loading:r,createNode:a}=JK(e.id),o=async i=>{try{if(r)return;await a(i)}catch{n({description:t("application_bar.errors.add_node_failed"),variant:"destructive"})}};return h.jsx(Lu,{children:h.jsxs(ZK,{direction:"middle",children:[gv.applications.map(i=>{const s=i.icon;return h.jsx(dp,{children:h.jsxs(Ba,{children:[h.jsxs(za,{children:[s?h.jsx(s,{width:20,height:20,onClick:()=>o(i.key)}):void 0,i.image?h.jsx("img",{src:i.image,alt:t(i.label),className:"w-8 h-8 rounded-md",onClick:()=>o(i.key)}):void 0]}),h.jsx(na,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)}),h.jsx(Xs,{orientation:"vertical",className:"h-full"}),gv.shapes.map(i=>h.jsx(dp,{children:h.jsxs(Ba,{children:[h.jsx(za,{children:h.jsx(me,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(na,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)),h.jsx(Xs,{orientation:"vertical",className:"h-full"}),gv.old.map(i=>h.jsx(dp,{children:h.jsxs(Ba,{children:[h.jsx(za,{children:h.jsx(me,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(na,{children:h.jsx("p",{children:t(i.label)})})]})},i.label))]})})}),fp=g.memo(e=>{const{lineClassName:t,handleClassName:n,...r}=e;return h.jsx(Ode,{lineClassName:G("!border-1.5",t),handleClassName:G("!w-2 !h-2 !border-2 !rounded-full",n),...r})}),GK=e=>{const t=ze(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([ue.CircleShape,ue.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===ue.Shape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Wn(e,n)},eX=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return GK(t),h.jsxs(h.Fragment,{children:[h.jsx(fp,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(mt,{type:"target",position:be.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border border",children:h.jsx(Fn,{id:t})}),h.jsx(mt,{type:"source",position:be.Bottom,isConnectable:r})]})}),tX=e=>{const t=ze(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([ue.Shape,ue.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===ue.CircleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Wn(e,n)},nX=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return tX(t),h.jsxs(h.Fragment,{children:[h.jsx(fp,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(mt,{type:"target",position:be.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border rounded-full border",children:h.jsx(Fn,{id:t})}),h.jsx(mt,{type:"source",position:be.Bottom,isConnectable:r})]})}),rX=e=>{const t=ze(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([ue.CircleShape,ue.Shape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===ue.TriangleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Wn(e,n)},aX=g.memo(e=>{const{id:t,selected:n,width:r,height:a,isConnectable:o}=e;return rX(t),h.jsxs(h.Fragment,{children:[h.jsx(fp,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(mt,{type:"target",position:be.Top,isConnectable:o}),h.jsx("div",{className:"w-0 h-0 border-l-transparent border-r-transparent border-b-border",style:{borderLeftWidth:(r||0)/2,borderRightWidth:(r||0)/2,borderBottomWidth:a||0}}),h.jsx(Fn,{id:t,className:"absolute top-0 right-0"}),h.jsx(mt,{type:"source",position:be.Bottom,isConnectable:o})]})}),oX=e=>{const t=ze(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ue.LLM&&(o==null?void 0:o.type)===ue.EditorApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Wn(e,n)},iX=e=>{const t=Hn(e),{t:n}=Re("flows"),r=g.useRef(null),{toast:a}=on(),{getNode:o,getHandleConnections:i}=xr(),{stream:s}=il(),c=g.useCallback(async d=>{t&&(clearTimeout(r.current),r.current=setTimeout(async()=>{await he("FlowNode").update(t.id,{data:d})},150))},[t]),l=g.useCallback(async(d,f)=>{var p;if(t){const m=i({nodeId:e,type:"target"}).find(b=>{var w;return((w=o(b.source))==null?void 0:w.type)===ue.LLM}),y=m?o(m==null?void 0:m.source):void 0,v=(p=y==null?void 0:y.data)==null?void 0:p.entity;if(!y||!v)return a({variant:"destructive",description:n("editor_node.errors.llm_not_found")});if(y.data.status!==rt.Loaded)return a({variant:"destructive",description:n("editor_node.errors.llm_not_loaded_yet")});try{return(await s(v.provider,typeof d=="string"?[new Vr(d)]:d,{onMessageUpdate:b=>{f==null||f(b.content)},llm:v})).content}catch(b){if(b instanceof Error&&b.message.includes("LLM_NOT_LOADED_YET"))return a({title:n("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:n("editor_node.errors.stream_message_failed")})}}},[t,i,e,o,a,n,s]),u=g.useCallback(d=>{if(!o(d))return[];const f=[];return i({nodeId:d,type:"target"}).forEach(p=>{const m=o(p.source);!m||m.type!==ue.LLM||f.push({node:m,connections:[p]})}),f},[i,o]);return{createMessage:l,updateEditorContent:c,getLinkedConnections:u}},sX=g.lazy(()=>Qt(()=>import("./index-C42Ik6Ft.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,7,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),cX=g.memo(e=>{var l;const{id:t,data:n,selected:r,isConnectable:a}=e;oX(t);const{createMessage:o,updateEditorContent:i,getLinkedConnections:s}=iX(t),c=g.useCallback(u=>{i(u)},[i]);return h.jsxs("div",{className:"w-full min-w-[1240px] h-full",children:[h.jsx(fp,{isVisible:!!r,minWidth:1240,minHeight:400}),h.jsx(mt,{type:"target",position:be.Top,isConnectable:a}),h.jsxs("div",{className:"min-w-10 min-h-10 w-full h-full rounded-lg border bg-background",children:[h.jsx(Fn,{className:"!z-[100]",id:t,enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(me,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx("div",{className:"h-full w-ful rounded-lg","data-registry":"plate",children:h.jsx(sX,{defaultValue:(l=n==null?void 0:n.flowNode)==null?void 0:l.data,onValueChange:c,copilotStream:o})})})]}),h.jsx(mt,{type:"source",position:be.Bottom,isConnectable:a})]})}),lX=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);Wn(e,t)},uX=g.memo(e=>{var i,s;const{id:t,data:n,isConnectable:r}=e,{t:a}=Re("flows");lX(t);let o="";switch((i=n.entity)==null?void 0:i.placeholder_type){case"VECTOR_DATABASE_RETREIVER":o=a("placeholder_node.vector_database_retriever");break}return h.jsxs("div",{children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:r}),h.jsxs(Ca,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(Fn,{id:t}),h.jsx(me,{name:"land-plot",className:"w-7 h-7"}),h.jsxs("div",{className:"ml-2 pr-4",children:[h.jsx(Ho,{children:`${((s=n.entity)==null?void 0:s.placeholder)||""}`}),h.jsx(yl,{children:o?h.jsx(Mn,{children:o}):void 0})]})]}),h.jsx(mt,{type:"source",position:be.Bottom,id:"a",isConnectable:r})]})}),dX=g.lazy(()=>Qt(()=>import("./CodeContainerApp-DJGvUQCN.js").then(async e=>(await e.__tla,e)).then(e=>e.C),__vite__mapDeps([62,1,2,14,60,6]))),fX=g.memo(e=>{const{id:t,isConnectable:n}=e;return h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Fn,{id:t}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(me,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(dX,{...e})})]}),h.jsx(mt,{type:"source",position:be.Bottom,isConnectable:n})]})}),pX=["empty-source","vite-vue","shadcn-react-vite","todo-app-react-vite","porfolio-nextjs"],hX=async e=>{switch(e){case"empty-source":return Qt(()=>import("./empty-source-Dw1dvL8s.js"),[]).then(t=>t.BASE);case"vite-vue":return Qt(()=>import("./vite-vue-Bmz2z3Fo.js"),[]).then(t=>t.BASE);case"shadcn-react-vite":return Qt(()=>import("./shadcn-react-vite-CDJ9BaE9.js"),[]).then(t=>t.BASE);case"todo-app-react-vite":return Qt(()=>import("./todo-app-react-vite-BBWBkRjR.js"),[]).then(t=>t.BASE);case"porfolio-nextjs":return Qt(()=>import("./porfolio-nextjs-DCkli5iW.js"),[]).then(t=>t.BASE);default:throw new Error(`Unknown source base: ${e}`)}},IN=g.memo(({className:e,onUpdateSourceBase:t})=>{const{t:n}=Re("components"),[r,a]=g.useState();return h.jsxs(rn,{className:G("mw-full",e),children:[h.jsx(Yn,{className:"p-4",children:h.jsx(sr,{children:n("add_source_base.title")})}),h.jsx(Jn,{className:"p-4",children:h.jsxs("div",{className:"flex items-center justify-center w-full h-full flex-col",children:[h.jsxs(zo,{onValueChange:o=>a(o),children:[h.jsx(eo,{className:"w-full mb-4",children:h.jsx(Uo,{placeholder:n("add_source_base.source_base_select_placeholder")})}),h.jsx(to,{children:pX.map(o=>h.jsx(cr,{value:`${o}`,children:n(`add_source_base.sourcebases.${o.toLowerCase()}`)},`${o}`))})]}),h.jsx(yt,{className:"w-full",onClick:async()=>r&&t(await hX(r)),children:n("add_source_base.update_source")})]})})]})}),mX=()=>{const{getNode:e,getHandleConnections:t}=xr(),{stream:n}=il(),r=g.useCallback(async(o,i)=>{await he("FlowNode").update(o,{raw:v0(i)})},[]),a=g.useCallback(o=>{if(!e(o))return[];const i=[];return t({nodeId:o,type:"target"}).forEach(s=>{const c=e(s.source);!c||c.type!==ue.LLM||i.push({node:c,connections:[s]})}),i},[t,e]);return{sendMessage:g.useCallback(async(o,i,{onMessageUpdate:s,onResponseMessageCreate:c}={})=>{const l=i.map(d=>d.role==="system"?new Cv(d.content):d.role==="user"?new Vr(d.content):new qr(d.content));c==null||c();const{content:u}=await n(gt.WebLLM,[...l,new Vr(o)],{onMessageUpdate:({content:d})=>{s==null||s({nodeData:{loading:!0,content:d}})},llm:void 0});return s==null||s({nodeData:{loading:!1,content:u}}),u},[n]),getLinkedConnections:a,updateCodeContainerData:r}},yX=e=>{const t=ze(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===ue.LLM&&(o==null?void 0:o.type)===ue.VSLiteApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);Wn(e,n)},gX=g.lazy(()=>Qt(()=>import("./index-BhSMxwf6.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),vX=g.memo(e=>{var f,p,m,y;const{id:t,isConnectable:n,data:r}=e,[a,o]=g.useState((f=r==null?void 0:r.flowNode)!=null&&f.raw?_0(r.flowNode.raw):void 0),{updateCodeContainerData:i,getLinkedConnections:s,sendMessage:c}=mX();yX(t);const l=g.useCallback(async v=>{var b,w;(b=r==null?void 0:r.flowNode)!=null&&b.id&&(await i((w=r==null?void 0:r.flowNode)==null?void 0:w.id,v),o(v))},[(p=r==null?void 0:r.flowNode)==null?void 0:p.id,i]),u=g.useCallback(async(v,b)=>{var w;return(w=r==null?void 0:r.flowNode)!=null&&w.id?await c(v,b):void 0},[(m=r==null?void 0:r.flowNode)==null?void 0:m.id,c]),d=g.useCallback(async v=>{o(b=>{var _;const w=S0(b||{},v);return i((_=r==null?void 0:r.flowNode)==null?void 0:_.id,w),w})},[(y=r==null?void 0:r.flowNode)==null?void 0:y.id,i]);return a?h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(mt,{type:"target",position:be.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Fn,{id:t,className:"z-50",enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(me,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(gX,{fileSystemTree:a,onUpdateFileContent:d,sendMessage:u})})]}),h.jsx(mt,{type:"source",position:be.Bottom,isConnectable:n})]}):h.jsx("div",{className:"h-full flex justify-center items-center",children:h.jsx(IN,{className:"w-64",onUpdateSourceBase:l})})}),bX={[ue.LLM]:$7,[ue.Toolbox]:M7,[ue.Thread]:V7,[ue.Message]:u_e,[ue.Prompt]:f_e,[ue.SessionInfo]:BIe,[ue.Schema]:UIe,[ue.CSVData]:VIe,[ue.ToolDefinition]:HIe,[ue.DefaultEmbeddingModel]:ZIe,[ue.VectorDatabase]:tDe,[ue.JSONLData]:rDe,[ue.ApplicationBar]:QK,[ue.Shape]:eX,[ue.CircleShape]:nX,[ue.TriangleShape]:aX,[ue.EditorApp]:cX,[ue.PlaceHolder]:uX,[ue.CodeContainerApp]:fX,[ue.VSLiteApp]:vX};function oDe(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:f,children:p,...m}=d,y=(f==null?void 0:f[e][c])||s,v=g.useMemo(()=>m,Object.values(m));return h.jsx(y.Provider,{value:v,children:p})}function u(d,f){const p=(f==null?void 0:f[e][c])||s,m=g.useContext(p);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,iDe(a,...t)]}function iDe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var sDe="Toggle",RP=g.forwardRef((e,t)=>{const{pressed:n,defaultPressed:r=!1,onPressedChange:a,...o}=e,[i=!1,s]=Rn({prop:n,onChange:a,defaultProp:r});return h.jsx($e.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":e.disabled?"":void 0,...o,ref:t,onClick:_e(e.onClick,()=>{e.disabled||s(!i)})})});RP.displayName=sDe;let IP,zs,DP,LP,vv;IP=RP,zs="ToggleGroup",[DP,YX]=oDe(zs,[fo]),LP=fo(),vv=Y.forwardRef((e,t)=>{const{type:n,...r}=e;if(n==="single"){const a=r;return h.jsx(cDe,{...a,ref:t})}if(n==="multiple"){const a=r;return h.jsx(lDe,{...a,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${zs}\``)}),vv.displayName=zs;var[wX,xX]=DP(zs),cDe=Y.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i,s]=Rn({prop:n,defaultProp:r,onChange:a});return h.jsx(wX,{scope:e.__scopeToggleGroup,type:"single",value:i?[i]:[],onItemActivate:s,onItemDeactivate:Y.useCallback(()=>s(""),[s]),children:h.jsx(_X,{...o,ref:t})})}),lDe=Y.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Rn({prop:n,defaultProp:r,onChange:a}),c=Y.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=Y.useCallback(u=>s((d=[])=>d.filter(f=>f!==u)),[s]);return h.jsx(wX,{scope:e.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:c,onItemDeactivate:l,children:h.jsx(_X,{...o,ref:t})})});vv.displayName=zs;var[uDe,dDe]=DP(zs),_X=Y.forwardRef((e,t)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:a=!0,orientation:o,dir:i,loop:s=!0,...c}=e,l=LP(n),u=si(i),d={role:"group",dir:u,...c};return h.jsx(uDe,{scope:n,rovingFocus:a,disabled:r,children:a?h.jsx(mu,{asChild:!0,...l,orientation:o,dir:u,loop:s,children:h.jsx($e.div,{...d,ref:t})}):h.jsx($e.div,{...d,ref:t})})}),bv="ToggleGroupItem",SX=Y.forwardRef((e,t)=>{const n=xX(bv,e.__scopeToggleGroup),r=dDe(bv,e.__scopeToggleGroup),a=LP(e.__scopeToggleGroup),o=n.value.includes(e.value),i=r.disabled||e.disabled,s={...e,pressed:o,disabled:i},c=Y.useRef(null);return r.rovingFocus?h.jsx(yu,{asChild:!0,...a,focusable:!i,active:o,ref:c,children:h.jsx($P,{...s,ref:t})}):h.jsx($P,{...s,ref:t})});SX.displayName=bv;let $P;$P=Y.forwardRef((e,t)=>{const{__scopeToggleGroup:n,value:r,...a}=e,o=xX(bv,n),i={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},s=o.type==="single"?i:void 0;return h.jsx(RP,{...s,...a,ref:t,onPressedChange:c=>{c?o.onItemActivate(r):o.onItemDeactivate(r)}})}),Fv=vv,Bv=SX;const jX=lo("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),fDe=g.forwardRef(({className:e,variant:t,size:n,...r},a)=>h.jsx(IP,{ref:a,className:G(jX({variant:t,size:n,className:e})),...r}));fDe.displayName=IP.displayName;const EX=g.createContext({size:"default",variant:"default"}),OX=g.forwardRef(({className:e,variant:t,size:n,children:r,...a},o)=>h.jsx(Fv,{ref:o,className:G("flex items-center justify-center gap-1",e),...a,children:h.jsx(EX.Provider,{value:{variant:t,size:n},children:r})}));OX.displayName=Fv.displayName;const CX=g.forwardRef(({className:e,children:t,variant:n,size:r,...a},o)=>{const i=g.useContext(EX);return h.jsx(Bv,{ref:o,className:G(jX({variant:i.variant||n,size:i.size||r}),e),...a,children:t})});CX.displayName=Bv.displayName;function pDe(){const e=at(t=>`x: ${t.transform[0].toFixed(2)}, y: ${t.transform[1].toFixed(2)}, zoom: ${t.transform[2].toFixed(2)}`);return h.jsx("div",{children:e})}function hDe({change:e}){var r,a,o,i;const t="id"in e?e.id:"-",{type:n}=e;return h.jsxs("div",{className:"mb-3",children:[h.jsxs("div",{children:["node id: ",t]}),h.jsxs("div",{children:[n==="add"?JSON.stringify(e.item,null,2):null,n==="dimensions"?`dimensions: ${(r=e.dimensions)==null?void 0:r.width} \xD7 ${(a=e.dimensions)==null?void 0:a.height}`:null,n==="position"?`position: ${(o=e.position)==null?void 0:o.x.toFixed(1)}, ${(i=e.position)==null?void 0:i.y.toFixed(1)}`:null,n==="remove"?"remove":null,n==="select"?e.selected?"select":"unselect":null]})]})}function mDe({limit:e=20}){const[t,n]=g.useState([]),r=Vt(),a=g.useCallback(i=>{n(s=>[...i,...s].slice(0,e))},[e]);g.useEffect(()=>(r.setState({onNodesChange:a}),()=>r.setState({onNodesChange:void 0})),[a,r]);const o=()=>h.jsx("div",{children:"No Changes Triggered"});return h.jsx(h.Fragment,{children:t.length===0?h.jsx(o,{}):t.map((i,s)=>h.jsx(hDe,{change:i},s))})}function yDe(){const{getInternalNode:e}=xr(),t=ede();return h.jsx(Que,{children:h.jsx("div",{className:"text-secondary-foreground",children:t.map(n=>{var o,i;const r=e(n.id);if(!r)return null;const a=r==null?void 0:r.internals.positionAbsolute;return h.jsx(gDe,{id:n.id,selected:!!n.selected,type:n.type||"default",position:n.position,absPosition:a,width:((o=n.measured)==null?void 0:o.width)??0,height:((i=n.measured)==null?void 0:i.height)??0,data:n.data},n.id)})})})}function gDe({id:e,type:t,selected:n,position:r,absPosition:a,width:o,height:i,data:s}){if(!o||!i)return null;const c=`translate(${a.x}px, ${a.y+i}px)`,l=`${r.x.toFixed(1)}, ${r.y.toFixed(1)}`,u=`${o} \xD7 ${i}`,d=n?"Selected":"Not Selected";return h.jsxs("div",{style:{position:"absolute",transform:c,width:o*2},className:"text-xs",children:[h.jsxs("div",{children:["id: ",e]}),h.jsxs("div",{children:["type: ",t]}),h.jsxs("div",{children:["selected: ",d]}),h.jsxs("div",{children:["position: ",l]}),h.jsxs("div",{children:["dimensions: ",u]}),h.jsxs("div",{children:["data: ",JSON.stringify(s,null,2)]})]})}function vDe({tools:e}){return h.jsx(Ac,{position:"top-left",className:"bg-card p-1 border rounded shadow-sm",children:h.jsx(OX,{type:"multiple",children:e.map(({active:t,setActive:n,label:r,value:a})=>h.jsx(CX,{value:a,onClick:()=>n(o=>!o),"aria-pressed":t,className:"bg-card text-card-foreground transition-colors duration-300 hover:bg-secondary hover:text-secondary-foreground",children:r},a))})})}function kX(){const[e,t]=g.useState(!1),[n,r]=g.useState(!1),[a,o]=g.useState(!1),i=[{active:e,setActive:t,label:"Node Inspector",value:"node-inspector"},{active:n,setActive:r,label:"Change Logger",value:"change-logger"},{active:a,setActive:o,label:"Viewport Logger",value:"viewport-logger"}];return h.jsxs(h.Fragment,{children:[h.jsx(vDe,{tools:i}),n&&h.jsx(Ac,{className:"text-xs p-5 bg-white rounded shadow-md overflow-y-auto max-h-[50%] mt-20",position:"bottom-right",children:h.jsx(mDe,{})}),e&&h.jsx(yDe,{}),a&&h.jsx(Ac,{position:"bottom-left",className:"text-secondary-foreground",children:h.jsx(pDe,{})})]})}kX.displayName="DevTools";const bDe=()=>{const e=g.useRef({}),t=g.useRef({}),n=ze(k=>k.flowEdges),r=st(k=>k.currentSession),a=ze(k=>k.setNodes),o=ze(k=>k.updateNodes),i=ze(k=>k.updateEdges),s=ze(k=>k.addConnectionToEdges),c=ze(k=>k.reset),l=ze(k=>k.findFlowEdges),u=ze(k=>k.deleteFlowNode),d=ze(k=>k.deleteFlowEdge),f=ze(k=>k.updateFlowNode),p=ze(k=>k.getNodes),m=ze(k=>k.findFlowNodesWithSource),y=g.useRef(n),v=g.useRef(),[b,w]=g.useState({loading:!1});y.current=n;const _=g.useCallback(async(k,N)=>{try{v.current=k,c(),await(N==null?void 0:N())}catch{v.current=void 0}},[c]),x=g.useCallback(async k=>{try{if(!(r!=null&&r.id))return;w(M=>({...M,loading:!0}));const N=await m({...k,where:{...k.where,session_id:r.id}}),R=await l({where:[{source:Xa(N.map(M=>M.id))},{target:Xa(N.map(M=>M.id))}]});return{flowNodes:N,flowEdges:R}}finally{w(N=>({...N,loading:!1}))}},[m,l,r==null?void 0:r.id]),S=g.useCallback(async k=>{var N,R;for(const M of k)if("id"in M&&Object.values(Ad).includes(M.id)&&M.type!=="remove")o([M]);else if(M.type==="position"&&M.position&&!isNaN(M.position.x)&&!isNaN(M.position.y)){o([M]);const C=M.position.x,T=M.position.y;clearTimeout(e.current[M.id]),e.current[M.id]=setTimeout(async()=>{e.current[M.id]=void 0,await f({id:M.id,x:C,y:T},{silent:!0})},200)}else if(M.type==="remove"){const C=(N=p([M.id]))==null?void 0:N[0];if(!(C!=null&&C.type)||jfe.includes(C.type))return;await u({id:M.id})}else if(M.type==="dimensions"&&M.dimensions&&!isNaN(M.dimensions.width)&&!isNaN(M.dimensions.height)){const C=(R=p([M.id]))==null?void 0:R[0];if(!(C!=null&&C.width)&&!(C!=null&&C.height))return;o([M]),clearTimeout(t.current[M.id]);const T=M.dimensions.width,A=M.dimensions.height;t.current[M.id]=setTimeout(async()=>{await f({id:M.id,width:T,height:A},{silent:!0})},200)}else M.type==="select"&&o([M])},[o,f,p,u]),j=g.useCallback(k=>{Promise.all(k.map(async N=>{if(N.type==="remove")return d({id:N.id})})),i(k)},[d,i]),E=g.useCallback(k=>{s(k)},[s]),O=g.useCallback(()=>{var k;(k=y.current)==null||k.length},[]),P=g.useCallback(k=>{a(N=>{var T,A;let R;if(typeof k=="function"?R=k(N):R=k,!R)return N;const M=N==null?void 0:N.find(I=>I.id===R.id),C={id:R.id,item:M?xm(M,R):{...R,position:{x:((T=R.position)==null?void 0:T.x)||0,y:((A=R.position)==null?void 0:A.y)||0}},type:M?"replace":"add"};return fs([C],N)})},[a]);return{syncEdges:O,initialFlow:_,loadingState:b,prepareFlowInfo:x,updateNodeChanges:S,updateEdgeChanges:j,updateOrCreateNode:P,currentSessionIdRef:v,updateEdgeConnection:E}},wDe=e=>{const t=st(u=>{var d;return(d=u.currentSession)==null?void 0:d.id}),{loadingState:n,prepareFlowInfo:r,syncEdges:a,initialFlow:o,currentSessionIdRef:i}=e,s=ze(u=>u.ready),c=ze(u=>u.removeSyncNodeQueue),l=ze(u=>u.removeSyncEdgeQueue);g.useLayoutEffect(()=>{},[t]),g.useEffect(()=>{n.loading||!s||!t||i.current===t||o(t,async()=>{await r({where:{session_id:t}})})},[o,r,n.loading,i,s,t]),g.useEffect(()=>{const u=ze.subscribe(f=>f.syncNodeQueue,async(f,p)=>{const m=p.map(v=>v.timestamp),y=f.filter(v=>!m.includes(v.timestamp));y.length&&c(y.map(v=>v.timestamp))}),d=ze.subscribe(f=>f.syncEdgeQueue,async(f,p)=>{const m=p.map(v=>v.timestamp),y=f.filter(v=>!m.includes(v.timestamp));y.length&&(l(y.map(v=>v.timestamp)),a())});return()=>{u(),d()}},[r,l,c,a])},xDe=()=>{const[e,t]=g.useState(!0),n=bDe(),r=co(u=>u.selectedModel),a=g.useRef(r),o=co(u=>u.setInitProgressCallback),{updateOrCreateNode:i,updateNodeChanges:s,updateEdgeChanges:c,updateEdgeConnection:l}=n;return wDe(n),a.current=r,g.useEffect(()=>{const u=o==null?void 0:o(d=>{if(!a.current)return;const f=`${a.current}`;i(p=>{const m=p==null?void 0:p.find(y=>{var v;return(v=y.data)!=null&&v.entity&&typeof y.data.entity=="object"&&"name"in y.data.entity?y.data.entity.name===f:!1});if(m)return m.data.label=d.text,m.data.status=rt.Loading,d.progress===100&&(m.data.label="",m.data.status=rt.Loaded),m})});return()=>{u==null||u()}},[o,i]),g.useMemo(()=>({updateNodeChanges:s,updateEdgeChanges:c,initializing:e,setInitializing:t,updateEdgeConnection:l}),[s,c,e,t,l])},_De=()=>{const e=ou(l=>l.theme),t=ze(l=>l.nodes),n=ze(l=>l.edges),{updateNodeChanges:r,updateEdgeChanges:a,updateEdgeConnection:o}=xDe(),i=g.useCallback(l=>{r(l)},[r]),s=g.useCallback(l=>{a(l)},[a]),c=g.useCallback(l=>{o(l)},[o]);return h.jsxs(Yue,{nodes:t,edges:n,nodeTypes:bX,onNodesChange:i,onEdgesChange:s,onConnect:c,panOnScroll:!0,panOnScrollMode:vi.Free,colorMode:e,fitView:!0,children:[h.jsx(ode,{variant:Do.Dots,gap:24,size:1}),h.jsx(fde,{}),h.jsx(jde,{}),R4e?h.jsx(kX,{}):void 0]})},SDe=g.memo(_De);function jDe(){return h.jsx(SDe,{})}const EDe=g.lazy(()=>Qt(()=>import("./DocumentViewer-B54eJTT4.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([63,1,2,15]))),ODe=()=>{const{documentId:e}=$p();return h.jsx(g.Suspense,{fallback:h.jsx(cu,{flickeringGrid:!0,className:"w-full h-full"}),children:h.jsx(EDe,{name:e||""})})};function wv(){const e=IM();return Ws(e),h.jsx(I4e,{})}const CDe=MJ(h.jsxs(di,{errorElement:h.jsx(wv,{}),children:[h.jsxs(di,{element:h.jsx(wR,{requiredSession:!0}),children:[h.jsx(di,{path:ph.whiteboard,Component:jDe,errorElement:h.jsx(wv,{})}),h.jsx(di,{path:ph.application,errorElement:h.jsx(wv,{}),Component:dwe}),h.jsx(di,{path:"*",element:h.jsx(kJ,{to:bn("whiteboard")})})]}),h.jsx(di,{element:h.jsx(wR,{}),children:h.jsx(di,{path:ph.document,errorElement:h.jsx(wv,{}),Component:ODe})})]})),kDe=(e,t)=>{switch(Aee){case"browser":return WM(e,t);case"hash":return tQ(e);default:return WM(e,t)}},PDe=kDe(CDe,{basename:"/NoLLMChat/"});HX("[BASE_URL]","/NoLLMChat/");let PX;PX=g.memo(()=>{const e=!window.location.pathname.includes("/NoLLMChat/");return g.useLayoutEffect(()=>{e&&(window.location.href="/NoLLMChat/".replace("//","/"))},[e]),e?h.jsx(cu,{className:"w-screen h-screen",simple:!0}):h.jsx(fQ,{router:PDe})},()=>!0),tY=Object.freeze(Object.defineProperty({__proto__:null,default:PX},Symbol.toStringTag,{value:"Module"}))});export{uu as $,GP as A,Pv as B,eN as C,tN as D,du as E,Nv as F,fu as G,Zi as H,wp as I,xp as J,Mv as K,nN as L,rN as M,qs as N,aN as O,oN as P,iN as Q,sN as R,Av as S,cN as T,lN as U,uN as V,dN as W,fN as X,pN as Y,Tv as Z,zt as _,$4e as __tla,Rv as a,Iv as a$,pu as a0,Ki as a1,Xi as a2,_p as a3,hu as a4,Zs as a5,Ks as a6,hN as a7,Dv as a8,mN as a9,yN as aA,XX as aB,Lv as aC,gN as aD,$v as aE,vN as aF,fo as aG,YX as aH,si as aI,mu as aJ,yu as aK,Fv as aL,Bv as aM,zv as aN,Uv as aO,Vv as aP,Wv as aQ,Hv as aR,qv as aS,bN as aT,wN as aU,Sp as aV,Zv as aW,Kv as aX,Xv as aY,Yv as aZ,Jv as a_,xN as aa,JX as ab,Qv as ac,QX as ad,_N as ae,SN as af,jN as ag,Gv as ah,EN as ai,GX as aj,e0 as ak,t0 as al,n0 as am,ON as an,r0 as ao,a0 as ap,o0 as aq,i0 as ar,s0 as as,c0 as at,CN as au,kN as av,eY as aw,l0 as ax,PN as ay,NN as az,gu as b,u0 as b0,d0 as b1,f0 as b2,jp as b3,Cn as b4,p0 as b5,Ep as b6,h0 as b7,m0 as b8,vu as b9,tY as bA,bu as ba,nY as bb,MN as bc,it as bd,Xs as be,y0 as bf,g0 as bg,tr as bh,ze as bi,Wn as bj,Hn as bk,v0 as bl,b0 as bm,AN as bn,TN as bo,w0 as bp,x0 as bq,yt as br,RN as bs,_0 as bt,S0 as bu,IN as bv,DN as bw,LN as bx,Ys as by,ci as bz,$N as c,Kr as d,j0 as e,FN as f,BN as g,Js as h,Xr as i,E0 as j,O0 as k,zN as l,Ia as m,UN as n,C0 as o,k0 as p,VN as q,WN as r,HN as s,P0 as t,qn as u,wu as v,N0 as w,xu as x,Qs as y,qN as z};
