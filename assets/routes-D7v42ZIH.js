const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/few_shot-CMBL7DSO.js","assets/index-BZZ1Euas.js","assets/index-BqtM78fc.css","assets/dot-D6NQrwhQ.js","assets/createLucideIcon-C8yHq_53.js","assets/index-s4oWTEmo.js","assets/pdf-CLoLwP5W.js","assets/pdf.min-DM_kRsgY.js","assets/pdf.worker.min-BkmVjn3H.js","assets/index-D6F2YTwn.js","assets/objectWithoutPropertiesLoose-BjXSgPXB.js","assets/index-DSqSbAxH.js","assets/index-Cr8Tc6mT.css","assets/index-t_d66ir0.js","assets/use-prevent-pitch-zoom-D5YPGQH_.js","assets/index-JgQ4UsK3.js","assets/link-CRFHi2Za.js","assets/trash-2-4awqM6cq.js","assets/text-BvNjPEIB.js","assets/external-link-B7DZMNKD.js","assets/unlink-BiMzNKQJ.js","assets/index-AZLB1igT.js","assets/list-BkjBWz7d.js","assets/list-ordered-AMwdAYfa.js","assets/list-todo-B6t8ETrO.js","assets/indent-increase-FnPqdJzq.js","assets/pilcrow-CFfmtoZJ.js","assets/heading-1-Btk5XlFi.js","assets/heading-2-CihbG0ef.js","assets/heading-3-B2wVeyAd.js","assets/table-QLNOAzCa.js","assets/file-code-B6zUQf6p.js","assets/quote-C_v6MXc7.js","assets/minus-Cj6-X7wR.js","assets/square-DsNHjTdU.js","assets/chevron-right-BTEFtQ5B.js","assets/image-B9w-VVHw.js","assets/table-of-contents-Bc75Svfh.js","assets/columns-3-W6feLprX.js","assets/link-2-KFTB1VO3.js","assets/calendar-M2AYDcS9.js","assets/plus-BIeQiSlj.js","assets/wrap-text-T5l3Gyf6.js","assets/pen-CpsM6ddn.js","assets/eye-C39ugJyz.js","assets/indent-decrease-Dz3QehbL.js","assets/pointer-3yUaj53f.js","assets/wand-sparkles-D5jQVXF6.js","assets/bold-B6KN-hCp.js","assets/italic-Dwkwf9KF.js","assets/underline-WWsK4lBi.js","assets/strikethrough-DZD7dpDu.js","assets/code-xml-BCaehChp.js","assets/baseline-BjrQboJO.js","assets/paint-bucket-jMWvvR3e.js","assets/arrow-up-to-line-_4BeiWqm.js","assets/index-BCYu3EnN.css","assets/index-BOzrtCLL.js","assets/check-X4lNeOx-.js","assets/circle-GYyu7vO6.js","assets/index-DHQ2XE-u.js","assets/index-HSnfLTSA.css","assets/CodeContainerApp-BMuDbTwO.js","assets/DocumentViewer-BwJfTmW9.js"])))=>i.map(i=>d[i]);
var aAe=Object.defineProperty;var oAe=(ki,Za,As)=>Za in ki?aAe(ki,Za,{enumerable:!0,configurable:!0,writable:!0,value:As}):ki[Za]=As;var Ip=(ki,Za,As)=>oAe(ki,typeof Za!="symbol"?Za+"":Za,As);import{r as g,M as xN,j as h,u as Eg,P as iAe,a as _N,L as sAe,m as cAe,c as lAe,f as nK,i as uAe,b as jN,d as rK,e as dAe,g as pAe,_ as aK,h as oK,k as Cl,l as Og,n as Wa,o as zo,p as Nl,q as tn,R as fAe,s as er,t as Sn,v as Ae,w as ge,x as Mr,y as wt,z as Z,A as Ha,S as Vo,B as tr,D as Cg,C as hAe,E as Ng,F as de,G as iK,H as mAe,I as Pe,J as Rp,K as Je,N as Ml,O as qa,Q as Wt,T as Gt,U as ue,V as Dp,W as sK,X as yAe,Y as gAe,Z as cK,$ as Pl,a0 as kl,a1 as pa,a2 as ot,a3 as lK,a4 as W,a5 as Al,a6 as vAe,a7 as bAe,a8 as Ka,a9 as oe,aa as wAe,ab as Oi,ac as Lp,ad as At,ae as Pr,af as xAe,ag as _Ae,ah as jAe,ai as SAe,aj as $p,ak as uK,al as EAe,am as OAe,an as dK,ao as SN,ap as CAe,aq as NAe,ar as pK,as as EN,at as MAe,au as fK,av as PAe,aw as Mg,ax as kAe,ay as AAe,az as TAe,aA as fa,aB as hK,aC as IAe,aD as ON,aE as me,aF as Ci,aG as mK,aH as Uo,aI as yK,aJ as RAe,aK as gK,aL as DAe,aM as LAe,aN as $Ae,aO as Ss,aP as Pg,aQ as Fp,aR as FAe,aS as kr,aT as kg,aU as BAe,aV as zAe,aW as CN,aX as Tl,aY as vK,aZ as VAe,a_ as UAe,a$ as WAe,b0 as HAe,b1 as qAe,b2 as Il,b3 as KAe,b4 as XAe,b5 as bK,b6 as ZAe,b7 as GAe,b8 as QAe,b9 as YAe,ba as wK,bb as NN,bc as xt,bd as JAe,be as MN,bf as e2e,bg as t2e,bh as n2e,__tla as r2e}from"./index-BZZ1Euas.js";import xK,{__tla as a2e}from"./dot-D6NQrwhQ.js";let Pt,PN,Ag,kN,AN,Rl,Tg,Dl,Ni,Bp,zp,Ig,TN,IN,Es,RN,DN,LN,$N,Rg,FN,BN,Ll,zN,VN,UN,WN,Dg,Lg,$g,$l,Fl,Mi,Pi,Vp,_K,Bl,Os,Cs,jK,SK,Fg,HN,qN,KN,EK,Bg,XN,zg,ZN,Xa,OK,Wo,zl,Vl,Vg,Ug,Wg,Hg,qg,Kg,Xg,Zg,GN,QN,Up,Gg,YN,Qg,JN,eM,CK,tM,Yg,NK,nM,rM,aM,Jg,oM,MK,ev,tv,nv,iM,rv,av,ov,iv,sv,cv,sM,cM,Ul,lv,uv,dv,pv,fv,hv,mv,Wp,yn,yv,lM,uM,Ns,Ho,PK,Hp,gv,vv,Wl,Hl,kK,dM,nt,Ms,bv,wv,Vn,De,An,Tn,xv,_v,pM,fM,jv,Sv,ut,hM,Ev,Ov,mM,yM,Ar,Cv,gM,vM,Ps,Tr,Nv,Mv,bM,ha,wM,Pv,kv,xM,_M,jM,Av,In,ql,Tv,Kl,ks,SM,o2e=Promise.all([(()=>{try{return r2e}catch{}})(),(()=>{try{return a2e}catch{}})()]).then(async()=>{class ki extends g.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Za({children:e,isPresent:t}){const n=g.useId(),r=g.useRef(null),a=g.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=g.useContext(xN);return g.useInsertionEffect(()=>{const{width:i,height:s,top:c,left:l}=a.current;if(t||!r.current||!i||!s)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return o&&(u.nonce=o),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${c}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),h.jsx(ki,{isPresent:t,childRef:r,sizeRef:a,children:g.cloneElement(e,{ref:r})})}const As=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:o,mode:i})=>{const s=Eg(TK),c=g.useId(),l=g.useCallback(d=>{s.set(d,!0);for(const p of s.values())if(!p)return;r&&r()},[s,r]),u=g.useMemo(()=>({id:c,initial:t,isPresent:n,custom:a,onExitComplete:l,register:d=>(s.set(d,!1),()=>s.delete(d))}),o?[Math.random(),l]:[n,l]);return g.useMemo(()=>{s.forEach((d,p)=>s.set(p,!1))},[n]),g.useEffect(()=>{!n&&!s.size&&r&&r()},[n]),i==="popLayout"&&(e=h.jsx(Za,{isPresent:n,children:e})),h.jsx(iAe.Provider,{value:u,children:e})};function TK(){return new Map}const qp=e=>e.key||"";function OM(e){const t=[];return g.Children.forEach(e,n=>{g.isValidElement(n)&&t.push(n)}),t}const IK=({children:e,exitBeforeEnter:t,custom:n,initial:r=!0,onExitComplete:a,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const s=g.useMemo(()=>OM(e),[e]),c=s.map(qp),l=g.useRef(!0),u=g.useRef(s),d=Eg(()=>new Map),[p,f]=g.useState(s),[y,m]=g.useState(s);_N(()=>{l.current=!1,u.current=s;for(let w=0;w<y.length;w++){const j=qp(y[w]);c.includes(j)?d.delete(j):d.get(j)!==!0&&d.set(j,!1)}},[y,c.length,c.join("-")]);const v=[];if(s!==p){let w=[...s];for(let j=0;j<y.length;j++){const x=y[j],_=qp(x);c.includes(_)||(w.splice(j,0,x),v.push(x))}i==="wait"&&v.length&&(w=v),m(OM(w)),f(s);return}const{forceRender:b}=g.useContext(sAe);return h.jsx(h.Fragment,{children:y.map(w=>{const j=qp(w),x=s===y||c.includes(j),_=()=>{if(d.has(j))d.set(j,!0);else return;let S=!0;d.forEach(E=>{E||(S=!1)}),S&&(b==null||b(),m(u.current),a&&a())};return h.jsx(As,{isPresent:x,initial:!l.current||r?void 0:!1,custom:x?void 0:n,presenceAffectsLayout:o,mode:i,onExitComplete:x?void 0:_,children:w},j)})})};function Iv(e){const t=Eg(()=>cAe(e)),{isStatic:n}=g.useContext(xN);if(n){const[,r]=g.useState(e);g.useEffect(()=>t.on("change",r),[])}return t}function CM(e,t){const n=Iv(t()),r=()=>n.set(t());return r(),_N(()=>{const a=()=>nK.preRender(r,!1,!0),o=e.map(i=>i.on("change",a));return()=>{o.forEach(i=>i()),lAe(r)}}),n}const RK=e=>e&&typeof e=="object"&&e.mix,DK=e=>RK(e)?e.mix:void 0;function LK(...e){const t=!Array.isArray(e[0]),n=t?0:-1,r=e[0+n],a=e[1+n],o=e[2+n],i=e[3+n],s=uAe(a,o,{mixer:DK(o[0]),...i});return t?s(r):s}function $K(e){jN.current=[],e();const t=CM(jN.current,e);return jN.current=void 0,t}function NM(e,t,n,r){if(typeof e=="function")return $K(e);const a=typeof t=="function"?t:LK(t,n,r);return Array.isArray(e)?MM(e,a):MM([e],([o])=>a(o))}function MM(e,t){const n=Eg(()=>[]);return CM(e,()=>{n.length=0;const r=e.length;for(let a=0;a<r;a++)n[a]=e[a].get();return t(n)})}function PM(e){return typeof e=="number"?e:parseFloat(e)}function FK(e,t={}){const{isStatic:n}=g.useContext(xN),r=g.useRef(null),a=Iv(rK(e)?PM(e.get()):e),o=g.useRef(a.get()),i=g.useRef(()=>{}),s=()=>{const l=r.current;l&&l.time===0&&l.sample(dAe.delta),c(),r.current=pAe({keyframes:[a.get(),o.current],velocity:a.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:i.current})},c=()=>{r.current&&r.current.stop()};return g.useInsertionEffect(()=>a.attach((l,u)=>n?u(l):(o.current=l,i.current=u,nK.update(s),a.get()),c),[JSON.stringify(t)]),_N(()=>{if(rK(e))return e.on("change",l=>a.set(PM(l)))},[a]),a}var Ge=(e=>(e.Started="started",e.Downloading="downloading",e.Downloaded="downloaded",e.Loading="loading",e.Loaded="loaded",e))(Ge||{}),Xl=(e=>(e.LLM="LLM",e.embedding="embedding",e.VLM="VLM",e))(Xl||{}),nn=(e=>(e.WebLLM="WebLLM",e.OpenAI="OpenAI",e))(nn||{}),Ir=(e=>(e.Started="started",e.Inprogress="inprogress",e.Success="success",e.Failed="failed",e))(Ir||{}),nr=(e=>(e.Human="human",e.User="user",e.AI="ai",e.System="system",e.Assistant="assistant",e.Tool="tool",e.FewShotExample="few_shot_example",e))(nr||{}),Kp=(e=>(e.Started="started",e.Inprogress="inprogress",e.Done="done",e))(Kp||{}),rr=(e=>(e.Chat="chat",e.FewShotExample="few_shot_example",e))(rr||{}),Ts=(e=>(e.VECTOR_DATABASE_RETREIVER="VECTOR_DATABASE_RETREIVER",e))(Ts||{});function kM(e,t,n,r,a){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=aK(t),i=aK(e),s=!1,c=i.length-1;c>=0;c--){var l=i[c],u=e[l];if(oK(t,l)&&!(t[l]===void 0&&u!==void 0&&Array.isArray(t)===!1)){var d=t[l];typeof u=="object"&&u!=null&&typeof d=="object"&&d!=null&&Array.isArray(u)===Array.isArray(d)?kM(u,d,n,r+"/"+Cl(l),a):u!==d&&(a&&n.push({op:"test",path:r+"/"+Cl(l),value:Og(u)}),n.push({op:"replace",path:r+"/"+Cl(l),value:Og(d)}))}else Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+Cl(l),value:Og(u)}),n.push({op:"remove",path:r+"/"+Cl(l)}),s=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&o.length==i.length))for(var c=0;c<o.length;c++){var l=o[c];!oK(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+Cl(l),value:Og(t[l])})}}}function BK(e,t,n=!1){var r=[];return kM(e,t,r,"",n),r}let AM,TM;AM=async(e,t)=>{let n="",r="",a;const o=[];await e;for await(const i of e)i&&(Array.isArray(i)?(o.push(...i.map(s=>s.content)),o!=null&&o.length&&(r=o.join(""),t==null||t({chunk:i,content:r}))):(n=typeof i=="object"&&"content"in i?`${i.content}`:`${i}`,t==null||t({chunk:i,content:n})),a=i);return{lastChunk:a,content:n}},TM=()=>{const e=Wa(a=>a.toolsCallingStream),t=Wa(a=>a.structuredStream),n=Wa(a=>a.stream),r=Wa(a=>a.getCurrentModelInfo);return{stream:g.useCallback(async(a,o)=>{var f;const{tools:i,schemas:s,onMessageUpdate:c,onMessageFinish:l}=o||{};let u;if(!await r())throw new Error("Model is not found");if(s!=null&&s.length?(s&&(s==null?void 0:s.length)>1&&zo("Multiple schemas are not supported. Only the first schema will be used."),u=t(((f=s==null?void 0:s[0])==null?void 0:f.schema_items)||[],a)):i!=null&&i.length?u=e(i,a):u=n(a),!u)throw new Error("Stream is not supported");const{lastChunk:d,content:p}=await AM(u,c);return l==null||l({content:p,lastChunk:d}),{lastChunk:d,content:p}},[r,n,t,e])}},Tg=globalThis||void 0||self;var Zl={},IM;function zK(){if(IM)return Zl;IM=1,Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.parse=i,Zl.serialize=l;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const p=function(){};return p.prototype=Object.create(null),p})();function i(p,f){const y=new o,m=p.length;if(m<2)return y;const v=(f==null?void 0:f.decode)||u;let b=0;do{const w=p.indexOf("=",b);if(w===-1)break;const j=p.indexOf(";",b),x=j===-1?m:j;if(w>x){b=p.lastIndexOf(";",w-1)+1;continue}const _=s(p,b,w),S=c(p,w,_),E=p.slice(_,S);if(y[E]===void 0){let O=s(p,w+1,x),M=c(p,x,O);const N=v(p.slice(O,M));y[E]=N}b=x+1}while(b<m);return y}function s(p,f,y){do{const m=p.charCodeAt(f);if(m!==32&&m!==9)return f}while(++f<y);return y}function c(p,f,y){for(;f>y;){const m=p.charCodeAt(--f);if(m!==32&&m!==9)return f+1}return y}function l(p,f,y){const m=(y==null?void 0:y.encode)||encodeURIComponent;if(!e.test(p))throw new TypeError(`argument name is invalid: ${p}`);const v=m(f);if(!t.test(v))throw new TypeError(`argument val is invalid: ${f}`);let b=p+"="+v;if(!y)return b;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);b+="; Max-Age="+y.maxAge}if(y.domain){if(!n.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);b+="; Domain="+y.domain}if(y.path){if(!r.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);b+="; Path="+y.path}if(y.expires){if(!d(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);b+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(b+="; HttpOnly"),y.secure&&(b+="; Secure"),y.partitioned&&(b+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return b}function u(p){if(p.indexOf("%")===-1)return p;try{return decodeURIComponent(p)}catch{return p}}function d(p){return a.call(p)==="[object Date]"}return Zl}zK();var RM="popstate";function VK(e={}){function t(r,a){let{pathname:o,search:i,hash:s}=r.location;return Is("",{pathname:o,search:i,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Ga(a)}return LM(t,n,null,e)}function UK(e={}){function t(a,o){let{pathname:i="/",search:s="",hash:c=""}=Qa(a.location.hash.substring(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),Is("",{pathname:i,search:s,hash:c},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(a,o){let i=a.document.querySelector("base"),s="";if(i&&i.getAttribute("href")){let c=a.location.href,l=c.indexOf("#");s=l===-1?c:c.slice(0,l)}return s+"#"+(typeof o=="string"?o:Ga(o))}function r(a,o){rn(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return LM(t,n,r,e)}function Ze(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function rn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function WK(){return Math.random().toString(36).substring(2,10)}function DM(e,t){return{usr:e.state,key:e.key,idx:t}}function Is(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Qa(t):t,state:n,key:t&&t.key||r||WK()}}function Ga({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Qa(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function LM(e,t,n,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,i=a.history,s="POP",c=null,l=u();l==null&&(l=0,i.replaceState({...i.state,idx:l},""));function u(){return(i.state||{idx:null}).idx}function d(){s="POP";let v=u(),b=v==null?null:v-l;l=v,c&&c({action:s,location:m.location,delta:b})}function p(v,b){s="PUSH";let w=Is(m.location,v,b);n&&n(w,v),l=u()+1;let j=DM(w,l),x=m.createHref(w);try{i.pushState(j,"",x)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;a.location.assign(x)}o&&c&&c({action:s,location:m.location,delta:1})}function f(v,b){s="REPLACE";let w=Is(m.location,v,b);n&&n(w,v),l=u();let j=DM(w,l),x=m.createHref(w);i.replaceState(j,"",x),o&&c&&c({action:s,location:m.location,delta:0})}function y(v){let b=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof v=="string"?v:Ga(v);return w=w.replace(/ $/,"%20"),Ze(b,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,b)}let m={get action(){return s},get location(){return e(a,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(RM,d),c=v,()=>{a.removeEventListener(RM,d),c=null}},createHref(v){return t(a,v)},createURL:y,encodeLocation(v){let b=y(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:f,go(v){return i.go(v)}};return m}var HK=new Set(["lazy","caseSensitive","path","id","index","children"]);function qK(e){return e.index===!0}function Xp(e,t,n=[],r={}){return e.map((a,o)=>{let i=[...n,String(o)],s=typeof a.id=="string"?a.id:i.join("-");if(Ze(a.index!==!0||!a.children,"Cannot specify children on an index route"),Ze(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),qK(a)){let c={...a,...t(a),id:s};return r[s]=c,c}else{let c={...a,...t(a),id:s,children:void 0};return r[s]=c,a.children&&(c.children=Xp(a.children,t,i,r)),c}})}function qo(e,t,n="/"){return Zp(e,t,n,!1)}function Zp(e,t,n,r){let a=typeof t=="string"?Qa(t):t,o=Rr(a.pathname||"/",n);if(o==null)return null;let i=$M(e);XK(i);let s=null;for(let c=0;s==null&&c<i.length;++c){let l=oX(o);s=rX(i[c],l,r)}return s}function KK(e,t){let{route:n,pathname:r,params:a}=e;return{id:n.id,pathname:r,params:a,data:t[n.id],handle:n.handle}}function $M(e,t=[],n=[],r=""){let a=(o,i,s)=>{let c={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(Ze(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let l=ma([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(Ze(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),$M(o.children,t,u,l)),!(o.path==null&&!o.index)&&t.push({path:l,score:tX(l,o.index),routesMeta:u})};return e.forEach((o,i)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))a(o,i);else for(let c of FM(o.path))a(o,i,c)}),t}function FM(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let i=FM(r.join("/")),s=[];return s.push(...i.map(c=>c===""?o:[o,c].join("/"))),a&&s.push(...i),s.map(c=>e.startsWith("/")&&c===""?"/":c)}function XK(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:nX(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var ZK=/^:[\w-]+$/,GK=3,QK=2,YK=1,JK=10,eX=-2,BM=e=>e==="*";function tX(e,t){let n=e.split("/"),r=n.length;return n.some(BM)&&(r+=eX),t&&(r+=QK),n.filter(a=>!BM(a)).reduce((a,o)=>a+(ZK.test(o)?GK:o===""?YK:JK),r)}function nX(e,t){return e.length===t.length&&e.slice(0,-1).every((n,r)=>n===t[r])?e[e.length-1]-t[t.length-1]:0}function rX(e,t,n=!1){let{routesMeta:r}=e,a={},o="/",i=[];for(let s=0;s<r.length;++s){let c=r[s],l=s===r.length-1,u=o==="/"?t:t.slice(o.length)||"/",d=Gp({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),p=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=Gp({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:ma([o,d.pathname]),pathnameBase:cX(ma([o,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(o=ma([o,d.pathnameBase]))}return i}function Gp(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=aX(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((c,{paramName:l,isOptional:u},d)=>{if(l==="*"){let f=s[d]||"";i=o.slice(0,o.length-f.length).replace(/(.)\/+$/,"$1")}const p=s[d];return u&&!p?c[l]=void 0:c[l]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:o,pathnameBase:i,pattern:e}}function aX(e,t=!1,n=!0){rn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,i,s)=>(r.push({paramName:i,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function oX(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return rn(!1,`The URL path "${e}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Rr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function iX(e,t="/"){let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?Qa(e):e;return{pathname:n?n.startsWith("/")?n:sX(n,t):t,search:lX(r),hash:uX(a)}}function sX(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Rv(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function zM(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Qp(e){let t=zM(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function Yp(e,t,n,r=!1){let a;typeof e=="string"?a=Qa(e):(a={...e},Ze(!a.pathname||!a.pathname.includes("?"),Rv("?","pathname","search",a)),Ze(!a.pathname||!a.pathname.includes("#"),Rv("#","pathname","hash",a)),Ze(!a.search||!a.search.includes("#"),Rv("#","search","hash",a)));let o=e===""||a.pathname==="",i=o?"/":a.pathname,s;if(i==null)s=n;else{let d=t.length-1;if(!r&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),d-=1;a.pathname=p.join("/")}s=d>=0?t[d]:"/"}let c=iX(a,s),l=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}var ma=e=>e.join("/").replace(/\/\/+/g,"/"),cX=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),lX=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,uX=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Jp=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function ef(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var VM=["POST","PUT","PATCH","DELETE"],dX=new Set(VM),pX=["GET",...VM],fX=new Set(pX),hX=new Set([301,302,303,307,308]),mX=new Set([307,308]),Dv={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},yX={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Gl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Lv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gX=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),UM="remix-router-transitions",WM=Symbol("ResetLoaderData");function HM(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";Ze(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.mapRouteProperties||gX,a={},o=Xp(e.routes,r,void 0,a),i,s=e.basename||"/",c=e.dataStrategy||_X,l=e.patchRoutesOnNavigation,u={...e.future},d=null,p=new Set,f=null,y=null,m=null,v=e.hydrationData!=null,b=qo(o,e.history.location,s),w=null;if(b==null&&!l){let U=yr(404,{pathname:e.history.location.pathname}),{matches:ee,route:ae}=rP(o);b=ee,w={[ae.id]:U}}b&&!e.hydrationData&&Oe(b,o,e.history.location.pathname).active&&(b=null);let j;if(b)if(b.some(U=>U.route.lazy))j=!1;else if(!b.some(U=>U.route.loader))j=!0;else{let U=e.hydrationData?e.hydrationData.loaderData:null,ee=e.hydrationData?e.hydrationData.errors:null;if(ee){let ae=b.findIndex(pe=>ee[pe.route.id]!==void 0);j=b.slice(0,ae+1).every(pe=>!Fv(pe.route,U,ee))}else j=b.every(ae=>!Fv(ae.route,U,ee))}else{j=!1,b=[];let U=Oe(null,o,e.history.location.pathname);U.active&&U.matches&&(b=U.matches)}let x,_={historyAction:e.history.action,location:e.history.location,matches:b,initialized:j,navigation:Dv,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||w,fetchers:new Map,blockers:new Map},S="POP",E=!1,O,M=!1,N=new Map,P=null,I=!1,k=!1,C=new Set,T=new Map,A=0,D=-1,L=new Map,R=new Set,B=new Map,z=new Map,$=new Set,V=new Map,Y,G=null;function K(){if(d=e.history.listen(({action:U,location:ee,delta:ae})=>{if(Y){Y(),Y=void 0;return}rn(V.size===0||ae!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let pe=Ut({currentLocation:_.location,nextLocation:ee,historyAction:U});if(pe&&ae!=null){let Ne=new Promise(Re=>{Y=Re});e.history.go(ae*-1),Te(pe,{state:"blocked",location:ee,proceed(){Te(pe,{state:"proceeding",proceed:void 0,reset:void 0,location:ee}),Ne.then(()=>e.history.go(ae))},reset(){let Re=new Map(_.blockers);Re.set(pe,Gl),H({blockers:Re})}});return}return se(U,ee)}),n){TX(t,N);let U=()=>IX(t,N);t.addEventListener("pagehide",U),P=()=>t.removeEventListener("pagehide",U)}return _.initialized||se("POP",_.location,{initialHydration:!0}),x}function Q(){d&&d(),P&&P(),p.clear(),O&&O.abort(),_.fetchers.forEach((U,ee)=>Gn(ee)),_.blockers.forEach((U,ee)=>he(ee))}function q(U){return p.add(U),()=>p.delete(U)}function H(U,ee={}){_={..._,...U};let ae=[],pe=[];_.fetchers.forEach((Ne,Re)=>{Ne.state==="idle"&&($.has(Re)?ae.push(Re):pe.push(Re))}),[...p].forEach(Ne=>Ne(_,{deletedFetchers:ae,viewTransitionOpts:ee.viewTransitionOpts,flushSync:ee.flushSync===!0})),ae.forEach(Ne=>Gn(Ne)),pe.forEach(Ne=>_.fetchers.delete(Ne))}function X(U,ee,{flushSync:ae}={}){var we,ze;let pe=_.actionData!=null&&_.navigation.formMethod!=null&&Dr(_.navigation.formMethod)&&_.navigation.state==="loading"&&((we=U.state)==null?void 0:we._isRedirect)!==!0,Ne;ee.actionData?Object.keys(ee.actionData).length>0?Ne=ee.actionData:Ne=null:pe?Ne=_.actionData:Ne=null;let Re=ee.loaderData?tP(_.loaderData,ee.loaderData,ee.matches||[],ee.errors):_.loaderData,Be=_.blockers;Be.size>0&&(Be=new Map(Be),Be.forEach((Ye,kt)=>Be.set(kt,Gl)));let Me=E===!0||_.navigation.formMethod!=null&&Dr(_.navigation.formMethod)&&((ze=U.state)==null?void 0:ze._isRedirect)!==!0;i&&(o=i,i=void 0),I||S==="POP"||(S==="PUSH"?e.history.push(U,U.state):S==="REPLACE"&&e.history.replace(U,U.state));let ke;if(S==="POP"){let Ye=N.get(_.location.pathname);Ye&&Ye.has(U.pathname)?ke={currentLocation:_.location,nextLocation:U}:N.has(U.pathname)&&(ke={currentLocation:U,nextLocation:_.location})}else if(M){let Ye=N.get(_.location.pathname);Ye?Ye.add(U.pathname):(Ye=new Set([U.pathname]),N.set(_.location.pathname,Ye)),ke={currentLocation:_.location,nextLocation:U}}H({...ee,actionData:Ne,loaderData:Re,historyAction:S,location:U,initialized:!0,navigation:Dv,revalidation:"idle",restoreScrollPosition:Ee(U,ee.matches||_.matches),preventScrollReset:Me,blockers:Be},{viewTransitionOpts:ke,flushSync:ae===!0}),S="POP",E=!1,M=!1,I=!1,k=!1,G==null||G.resolve(),G=null}async function te(U,ee){if(typeof U=="number"){e.history.go(U);return}let ae=$v(_.location,_.matches,s,U,ee==null?void 0:ee.fromRouteId,ee==null?void 0:ee.relative),{path:pe,submission:Ne,error:Re}=qM(!1,ae,ee),Be=_.location,Me=Is(_.location,pe,ee&&ee.state);Me={...Me,...e.history.encodeLocation(Me)};let ke=ee&&ee.replace!=null?ee.replace:void 0,we="PUSH";ke===!0?we="REPLACE":ke===!1||Ne!=null&&Dr(Ne.formMethod)&&Ne.formAction===_.location.pathname+_.location.search&&(we="REPLACE");let ze=ee&&"preventScrollReset"in ee?ee.preventScrollReset===!0:void 0,Ye=(ee&&ee.flushSync)===!0,kt=Ut({currentLocation:Be,nextLocation:Me,historyAction:we});if(kt){Te(kt,{state:"blocked",location:Me,proceed(){Te(kt,{state:"proceeding",proceed:void 0,reset:void 0,location:Me}),te(U,ee)},reset(){let Lt=new Map(_.blockers);Lt.set(kt,Gl),H({blockers:Lt})}});return}await se(we,Me,{submission:Ne,pendingError:Re,preventScrollReset:ze,replace:ee&&ee.replace,enableViewTransition:ee&&ee.viewTransition,flushSync:Ye})}function F(){G||(G=RX()),st(),H({revalidation:"loading"});let U=G.promise;return _.navigation.state==="submitting"?U:_.navigation.state==="idle"?(se(_.historyAction,_.location,{startUninterruptedRevalidation:!0}),U):(se(S||_.historyAction,_.navigation.location,{overrideNavigation:_.navigation,enableViewTransition:M===!0}),U)}async function se(U,ee,ae){O&&O.abort(),O=null,S=U,I=(ae&&ae.startUninterruptedRevalidation)===!0,_e(_.location,_.matches),E=(ae&&ae.preventScrollReset)===!0,M=(ae&&ae.enableViewTransition)===!0;let pe=i||o,Ne=ae&&ae.overrideNavigation,Re=qo(pe,ee,s),Be=(ae&&ae.flushSync)===!0,Me=Oe(Re,pe,ee.pathname);if(Me.active&&Me.matches&&(Re=Me.matches),!Re){let{error:at,notFoundMatches:Yn,route:Xt}=Dt(ee.pathname);X(ee,{matches:Yn,loaderData:{},errors:{[Xt.id]:at}},{flushSync:Be});return}if(_.initialized&&!k&&NX(_.location,ee)&&!(ae&&ae.submission&&Dr(ae.submission.formMethod))){X(ee,{matches:Re},{flushSync:Be});return}O=new AbortController;let ke=Rs(e.history,ee,O.signal,ae&&ae.submission),we;if(ae&&ae.pendingError)we=[Ai(Re).route.id,{type:"error",error:ae.pendingError}];else if(ae&&ae.submission&&Dr(ae.submission.formMethod)){let at=await re(ke,ee,ae.submission,Re,Me.active,{replace:ae.replace,flushSync:Be});if(at.shortCircuited)return;if(at.pendingActionResult){let[Yn,Xt]=at.pendingActionResult;if(ar(Xt)&&ef(Xt.error)&&Xt.error.status===404){O=null,X(ee,{matches:at.matches,loaderData:{},errors:{[Yn]:Xt.error}});return}}Re=at.matches||Re,we=at.pendingActionResult,Ne=Vv(ee,ae.submission),Be=!1,Me.active=!1,ke=Rs(e.history,ke.url,ke.signal)}let{shortCircuited:ze,matches:Ye,loaderData:kt,errors:Lt}=await le(ke,ee,Re,Me.active,Ne,ae&&ae.submission,ae&&ae.fetcherSubmission,ae&&ae.replace,ae&&ae.initialHydration===!0,Be,we);ze||(O=null,X(ee,{matches:Ye||Re,...nP(we),loaderData:kt,errors:Lt}))}async function re(U,ee,ae,pe,Ne,Re={}){st();let Be=kX(ee,ae);if(H({navigation:Be},{flushSync:Re.flushSync===!0}),Ne){let we=await Ue(pe,ee.pathname,U.signal);if(we.type==="aborted")return{shortCircuited:!0};if(we.type==="error"){let ze=Ai(we.partialMatches).route.id;return{matches:we.partialMatches,pendingActionResult:[ze,{type:"error",error:we.error}]}}else if(we.matches)pe=we.matches;else{let{notFoundMatches:ze,error:Ye,route:kt}=Dt(ee.pathname);return{matches:ze,pendingActionResult:[kt.id,{type:"error",error:Ye}]}}}let Me,ke=Ql(pe,ee);if(!ke.route.action&&!ke.route.lazy)Me={type:"error",error:yr(405,{method:U.method,pathname:ee.pathname,routeId:ke.route.id})};else if(Me=(await He("action",_,U,[ke],pe,null))[ke.route.id],U.signal.aborted)return{shortCircuited:!0};if(Ti(Me)){let we;return Re&&Re.replace!=null?we=Re.replace:we=YM(Me.response.headers.get("Location"),new URL(U.url),s)===_.location.pathname+_.location.search,await We(U,Me,!0,{submission:ae,replace:we}),{shortCircuited:!0}}if(ar(Me)){let we=Ai(pe,ke.route.id);return(Re&&Re.replace)!==!0&&(S="PUSH"),{matches:pe,pendingActionResult:[we.route.id,Me]}}return{matches:pe,pendingActionResult:[ke.route.id,Me]}}async function le(U,ee,ae,pe,Ne,Re,Be,Me,ke,we,ze){let Ye=Ne||Vv(ee,Re),kt=Re||Be||sP(Ye),Lt=!I&&!ke;if(pe){if(Lt){let Jn=je(ze);H({navigation:Ye,...Jn!==void 0?{actionData:Jn}:{}},{flushSync:we})}let ft=await Ue(ae,ee.pathname,U.signal);if(ft.type==="aborted")return{shortCircuited:!0};if(ft.type==="error"){let Jn=Ai(ft.partialMatches).route.id;return{matches:ft.partialMatches,loaderData:{},errors:{[Jn]:ft.error}}}else if(ft.matches)ae=ft.matches;else{let{error:Jn,notFoundMatches:js,route:zt}=Dt(ee.pathname);return{matches:js,loaderData:{},errors:{[zt.id]:Jn}}}}let at=i||o,[Yn,Xt]=XM(e.history,_,ae,kt,ee,ke===!0,k,C,$,B,R,at,s,ze);if(D=++A,Yn.length===0&&Xt.length===0){let ft=J();return X(ee,{matches:ae,loaderData:{},errors:ze&&ar(ze[1])?{[ze[0]]:ze[1].error}:null,...nP(ze),...ft?{fetchers:new Map(_.fetchers)}:{}},{flushSync:we}),{shortCircuited:!0}}if(Lt){let ft={};if(!pe){ft.navigation=Ye;let Jn=je(ze);Jn!==void 0&&(ft.actionData=Jn)}Xt.length>0&&(ft.fetchers=Le(Xt)),H(ft,{flushSync:we})}Xt.forEach(ft=>{Qn(ft.key),ft.controller&&T.set(ft.key,ft.controller)});let _s=()=>Xt.forEach(ft=>Qn(ft.key));O&&O.signal.addEventListener("abort",_s);let{loaderResults:da,fetcherResults:Ei}=await Mt(_,ae,Yn,Xt,U);if(U.signal.aborted)return{shortCircuited:!0};O&&O.signal.removeEventListener("abort",_s),Xt.forEach(ft=>T.delete(ft.key));let Ua=tf(da);if(Ua)return await We(U,Ua.result,!0,{replace:Me}),{shortCircuited:!0};if(Ua=tf(Ei),Ua)return R.add(Ua.key),await We(U,Ua.result,!0,{replace:Me}),{shortCircuited:!0};let{loaderData:Tp,errors:Nr}=eP(_,ae,da,ze,Xt,Ei);ke&&_.errors&&(Nr={..._.errors,...Nr});let Sl=J(),El=ne(D),Ol=Sl||El||Xt.length>0;return{matches:ae,loaderData:Tp,errors:Nr,...Ol?{fetchers:new Map(_.fetchers)}:{}}}function je(U){if(U&&!ar(U[1]))return{[U[0]]:U[1].data};if(_.actionData)return Object.keys(_.actionData).length===0?null:_.actionData}function Le(U){return U.forEach(ee=>{let ae=_.fetchers.get(ee.key),pe=Yl(void 0,ae?ae.data:void 0);_.fetchers.set(ee.key,pe)}),new Map(_.fetchers)}async function $e(U,ee,ae,pe){Qn(U);let Ne=(pe&&pe.flushSync)===!0,Re=i||o,Be=$v(_.location,_.matches,s,ae,ee,pe==null?void 0:pe.relative),Me=qo(Re,Be,s),ke=Oe(Me,Re,Be);if(ke.active&&ke.matches&&(Me=ke.matches),!Me){bt(U,ee,yr(404,{pathname:Be}),{flushSync:Ne});return}let{path:we,submission:ze,error:Ye}=qM(!0,Be,pe);if(Ye){bt(U,ee,Ye,{flushSync:Ne});return}let kt=Ql(Me,we),Lt=(pe&&pe.preventScrollReset)===!0;if(ze&&Dr(ze.formMethod)){await Se(U,ee,we,kt,Me,ke.active,Ne,Lt,ze);return}B.set(U,{routeId:ee,path:we}),await Ve(U,ee,we,kt,Me,ke.active,Ne,Lt,ze)}async function Se(U,ee,ae,pe,Ne,Re,Be,Me,ke){st(),B.delete(U);function we(zt){if(!zt.route.action&&!zt.route.lazy){let Bo=yr(405,{method:ke.formMethod,pathname:ae,routeId:ee});return bt(U,ee,Bo,{flushSync:Be}),!0}return!1}if(!Re&&we(pe))return;let ze=_.fetchers.get(U);rt(U,AX(ke,ze),{flushSync:Be});let Ye=new AbortController,kt=Rs(e.history,ae,Ye.signal,ke);if(Re){let zt=await Ue(Ne,ae,kt.signal);if(zt.type==="aborted")return;if(zt.type==="error"){bt(U,ee,zt.error,{flushSync:Be});return}else if(zt.matches){if(Ne=zt.matches,pe=Ql(Ne,ae),we(pe))return}else{bt(U,ee,yr(404,{pathname:ae}),{flushSync:Be});return}}T.set(U,Ye);let Lt=A,at=(await He("action",_,kt,[pe],Ne,U))[pe.route.id];if(kt.signal.aborted){T.get(U)===Ye&&T.delete(U);return}if($.has(U)){if(Ti(at)||ar(at)){rt(U,Ko(void 0));return}}else{if(Ti(at))if(T.delete(U),D>Lt){rt(U,Ko(void 0));return}else return R.add(U),rt(U,Yl(ke)),We(kt,at,!1,{fetcherSubmission:ke,preventScrollReset:Me});if(ar(at)){bt(U,ee,at.error);return}}let Yn=_.navigation.location||_.location,Xt=Rs(e.history,Yn,Ye.signal),_s=i||o,da=_.navigation.state!=="idle"?qo(_s,_.navigation.location,s):_.matches;Ze(da,"Didn't find any matches after fetcher action");let Ei=++A;L.set(U,Ei);let Ua=Yl(ke,at.data);_.fetchers.set(U,Ua);let[Tp,Nr]=XM(e.history,_,da,ke,Yn,!1,k,C,$,B,R,_s,s,[pe.route.id,at]);Nr.filter(zt=>zt.key!==U).forEach(zt=>{let Bo=zt.key,Sg=_.fetchers.get(Bo),bN=Yl(void 0,Sg?Sg.data:void 0);_.fetchers.set(Bo,bN),Qn(Bo),zt.controller&&T.set(Bo,zt.controller)}),H({fetchers:new Map(_.fetchers)});let Sl=()=>Nr.forEach(zt=>Qn(zt.key));Ye.signal.addEventListener("abort",Sl);let{loaderResults:El,fetcherResults:Ol}=await Mt(_,da,Tp,Nr,Xt);if(Ye.signal.aborted)return;Ye.signal.removeEventListener("abort",Sl),L.delete(U),T.delete(U),Nr.forEach(zt=>T.delete(zt.key));let ft=tf(El);if(ft)return We(Xt,ft.result,!1,{preventScrollReset:Me});if(ft=tf(Ol),ft)return R.add(ft.key),We(Xt,ft.result,!1,{preventScrollReset:Me});let{loaderData:Jn,errors:js}=eP(_,da,El,void 0,Nr,Ol);if(_.fetchers.has(U)){let zt=Ko(at.data);_.fetchers.set(U,zt)}ne(Ei),_.navigation.state==="loading"&&Ei>D?(Ze(S,"Expected pending action"),O&&O.abort(),X(_.navigation.location,{matches:da,loaderData:Jn,errors:js,fetchers:new Map(_.fetchers)})):(H({errors:js,loaderData:tP(_.loaderData,Jn,da,js),fetchers:new Map(_.fetchers)}),k=!1)}async function Ve(U,ee,ae,pe,Ne,Re,Be,Me,ke){let we=_.fetchers.get(U);rt(U,Yl(ke,we?we.data:void 0),{flushSync:Be});let ze=new AbortController,Ye=Rs(e.history,ae,ze.signal);if(Re){let at=await Ue(Ne,ae,Ye.signal);if(at.type==="aborted")return;if(at.type==="error"){bt(U,ee,at.error,{flushSync:Be});return}else if(at.matches)Ne=at.matches,pe=Ql(Ne,ae);else{bt(U,ee,yr(404,{pathname:ae}),{flushSync:Be});return}}T.set(U,ze);let kt=A,Lt=(await He("loader",_,Ye,[pe],Ne,U))[pe.route.id];if(T.get(U)===ze&&T.delete(U),!Ye.signal.aborted){if($.has(U)){rt(U,Ko(void 0));return}if(Ti(Lt))if(D>kt){rt(U,Ko(void 0));return}else{R.add(U),await We(Ye,Lt,!1,{preventScrollReset:Me});return}if(ar(Lt)){bt(U,ee,Lt.error);return}rt(U,Ko(Lt.data))}}async function We(U,ee,ae,{submission:pe,fetcherSubmission:Ne,preventScrollReset:Re,replace:Be}={}){ee.response.headers.has("X-Remix-Revalidate")&&(k=!0);let Me=ee.response.headers.get("Location");Ze(Me,"Expected a Location header on the redirect Response"),Me=YM(Me,new URL(U.url),s);let ke=Is(_.location,Me,{_isRedirect:!0});if(n){let at=!1;if(ee.response.headers.has("X-Remix-Reload-Document"))at=!0;else if(Lv.test(Me)){const Yn=e.history.createURL(Me);at=Yn.origin!==t.location.origin||Rr(Yn.pathname,s)==null}if(at){Be?t.location.replace(Me):t.location.assign(Me);return}}O=null;let we=Be===!0||ee.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:ze,formAction:Ye,formEncType:kt}=_.navigation;!pe&&!Ne&&ze&&Ye&&kt&&(pe=sP(_.navigation));let Lt=pe||Ne;if(mX.has(ee.response.status)&&Lt&&Dr(Lt.formMethod))await se(we,ke,{submission:{...Lt,formAction:Me},preventScrollReset:Re||E,enableViewTransition:ae?M:void 0});else{let at=Vv(ke,pe);await se(we,ke,{overrideNavigation:at,fetcherSubmission:Ne,preventScrollReset:Re||E,enableViewTransition:ae?M:void 0})}}async function He(U,ee,ae,pe,Ne,Re){let Be,Me={};try{Be=await jX(c,U,ee,ae,pe,Ne,Re,a,r)}catch(ke){return pe.forEach(we=>{Me[we.route.id]={type:"error",error:ke}}),Me}for(let[ke,we]of Object.entries(Be))if(MX(we)){let ze=we.result;Me[ke]={type:"redirect",response:OX(ze,ae,ke,Ne,s)}}else Me[ke]=await EX(we);return Me}async function Mt(U,ee,ae,pe,Ne){let Re=He("loader",U,Ne,ae,ee,null),Be=Promise.all(pe.map(async we=>{if(we.matches&&we.match&&we.controller){let ze=(await He("loader",U,Rs(e.history,we.path,we.controller.signal),[we.match],we.matches,we.key))[we.match.route.id];return{[we.key]:ze}}else return Promise.resolve({[we.key]:{type:"error",error:yr(404,{pathname:we.path})}})})),Me=await Re,ke=(await Be).reduce((we,ze)=>Object.assign(we,ze),{});return{loaderResults:Me,fetcherResults:ke}}function st(){k=!0,B.forEach((U,ee)=>{T.has(ee)&&C.add(ee),Qn(ee)})}function rt(U,ee,ae={}){_.fetchers.set(U,ee),H({fetchers:new Map(_.fetchers)},{flushSync:(ae&&ae.flushSync)===!0})}function bt(U,ee,ae,pe={}){let Ne=Ai(_.matches,ee);Gn(U),H({errors:{[Ne.route.id]:ae},fetchers:new Map(_.fetchers)},{flushSync:(pe&&pe.flushSync)===!0})}function Kt(U){return z.set(U,(z.get(U)||0)+1),$.has(U)&&$.delete(U),_.fetchers.get(U)||yX}function Gn(U){let ee=_.fetchers.get(U);T.has(U)&&!(ee&&ee.state==="loading"&&L.has(U))&&Qn(U),B.delete(U),L.delete(U),R.delete(U),$.delete(U),C.delete(U),_.fetchers.delete(U)}function za(U){let ee=(z.get(U)||0)-1;ee<=0?(z.delete(U),$.add(U)):z.set(U,ee),H({fetchers:new Map(_.fetchers)})}function Qn(U){let ee=T.get(U);ee&&(ee.abort(),T.delete(U))}function Va(U){for(let ee of U){let ae=Kt(ee),pe=Ko(ae.data);_.fetchers.set(ee,pe)}}function J(){let U=[],ee=!1;for(let ae of R){let pe=_.fetchers.get(ae);Ze(pe,`Expected fetcher: ${ae}`),pe.state==="loading"&&(R.delete(ae),U.push(ae),ee=!0)}return Va(U),ee}function ne(U){let ee=[];for(let[ae,pe]of L)if(pe<U){let Ne=_.fetchers.get(ae);Ze(Ne,`Expected fetcher: ${ae}`),Ne.state==="loading"&&(Qn(ae),L.delete(ae),ee.push(ae))}return Va(ee),ee.length>0}function ce(U,ee){let ae=_.blockers.get(U)||Gl;return V.get(U)!==ee&&V.set(U,ee),ae}function he(U){_.blockers.delete(U),V.delete(U)}function Te(U,ee){let ae=_.blockers.get(U)||Gl;Ze(ae.state==="unblocked"&&ee.state==="blocked"||ae.state==="blocked"&&ee.state==="blocked"||ae.state==="blocked"&&ee.state==="proceeding"||ae.state==="blocked"&&ee.state==="unblocked"||ae.state==="proceeding"&&ee.state==="unblocked",`Invalid blocker state transition: ${ae.state} -> ${ee.state}`);let pe=new Map(_.blockers);pe.set(U,ee),H({blockers:pe})}function Ut({currentLocation:U,nextLocation:ee,historyAction:ae}){if(V.size===0)return;V.size>1&&rn(!1,"A router only supports one blocker at a time");let pe=Array.from(V.entries()),[Ne,Re]=pe[pe.length-1],Be=_.blockers.get(Ne);if(!(Be&&Be.state==="proceeding")&&Re({currentLocation:U,nextLocation:ee,historyAction:ae}))return Ne}function Dt(U){let ee=yr(404,{pathname:U}),ae=i||o,{matches:pe,route:Ne}=rP(ae);return{notFoundMatches:pe,route:Ne,error:ee}}function Ke(U,ee,ae){if(f=U,m=ee,y=ae||null,!v&&_.navigation===Dv){v=!0;let pe=Ee(_.location,_.matches);pe!=null&&H({restoreScrollPosition:pe})}return()=>{f=null,m=null,y=null}}function be(U,ee){return y&&y(U,ee.map(ae=>KK(ae,_.loaderData)))||U.key}function _e(U,ee){if(f&&m){let ae=be(U,ee);f[ae]=m()}}function Ee(U,ee){if(f){let ae=be(U,ee),pe=f[ae];if(typeof pe=="number")return pe}return null}function Oe(U,ee,ae){if(l)if(U){if(Object.keys(U[0].params).length>0)return{active:!0,matches:Zp(ee,ae,s,!0)}}else return{active:!0,matches:Zp(ee,ae,s,!0)||[]};return{active:!1,matches:null}}async function Ue(U,ee,ae){if(!l)return{type:"success",matches:U};let pe=U;for(;;){let Ne=i==null,Re=i||o,Be=a;try{await l({path:ee,matches:pe,patch:(we,ze)=>{ae.aborted||GM(we,ze,Re,Be,r)}})}catch(we){return{type:"error",error:we,partialMatches:pe}}finally{Ne&&!ae.aborted&&(o=[...o])}if(ae.aborted)return{type:"aborted"};let Me=qo(Re,ee,s);if(Me)return{type:"success",matches:Me};let ke=Zp(Re,ee,s,!0);if(!ke||pe.length===ke.length&&pe.every((we,ze)=>we.route.id===ke[ze].route.id))return{type:"success",matches:null};pe=ke}}function St(U){a={},i=Xp(U,r,void 0,a)}function Bt(U,ee){let ae=i==null;GM(U,ee,i||o,a,r),ae&&(o=[...o],H({}))}return x={get basename(){return s},get future(){return u},get state(){return _},get routes(){return o},get window(){return t},initialize:K,subscribe:q,enableScrollRestoration:Ke,navigate:te,fetch:$e,revalidate:F,createHref:U=>e.history.createHref(U),encodeLocation:U=>e.history.encodeLocation(U),getFetcher:Kt,deleteFetcher:za,dispose:Q,getBlocker:ce,deleteBlocker:he,patchRoutes:Bt,_internalFetchControllers:T,_internalSetRoutes:St},x}function vX(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function $v(e,t,n,r,a,o){let i,s;if(a){i=[];for(let l of t)if(i.push(l),l.route.id===a){s=l;break}}else i=t,s=t[t.length-1];let c=Yp(r||".",Qp(i),Rr(e.pathname,n)||e.pathname,o==="path");if(r==null&&(c.search=e.search,c.hash=e.hash),(r==null||r===""||r===".")&&s){let l=zv(c.search);if(s.route.index&&!l)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&l){let u=new URLSearchParams(c.search),d=u.getAll("index");u.delete("index"),d.filter(f=>f).forEach(f=>u.append("index",f));let p=u.toString();c.search=p?`?${p}`:""}}return n!=="/"&&(c.pathname=c.pathname==="/"?n:ma([n,c.pathname])),Ga(c)}function qM(e,t,n){if(!n||!vX(n))return{path:t};if(n.formMethod&&!PX(n.formMethod))return{path:t,error:yr(405,{method:n.formMethod})};let r=()=>({path:t,error:yr(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),o=aP(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Dr(a))return r();let u=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((d,[p,f])=>`${d}${p}=${f}
`,""):String(n.body);return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:u}}}else if(n.formEncType==="application/json"){if(!Dr(a))return r();try{let u=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:u,text:void 0}}}catch{return r()}}}Ze(typeof FormData=="function","FormData is not available in this environment");let i,s;if(n.formData)i=Bv(n.formData),s=n.formData;else if(n.body instanceof FormData)i=Bv(n.body),s=n.body;else if(n.body instanceof URLSearchParams)i=n.body,s=JM(i);else if(n.body==null)i=new URLSearchParams,s=new FormData;else try{i=new URLSearchParams(n.body),s=JM(i)}catch{return r()}let c={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:s,json:void 0,text:void 0};if(Dr(c.formMethod))return{path:t,submission:c};let l=Qa(t);return e&&l.search&&zv(l.search)&&i.append("index",""),l.search=`?${i}`,{path:Ga(l),submission:c}}function KM(e,t,n=!1){let r=e.findIndex(a=>a.route.id===t);return r>=0?e.slice(0,n?r+1:r):e}function XM(e,t,n,r,a,o,i,s,c,l,u,d,p,f){let y=f?ar(f[1])?f[1].error:f[1].data:void 0,m=e.createURL(t.location),v=e.createURL(a),b=n;o&&t.errors?b=KM(n,Object.keys(t.errors)[0],!0):f&&ar(f[1])&&(b=KM(n,f[0]));let w=f?f[1].statusCode:void 0,j=w&&w>=400,x=b.filter((S,E)=>{let{route:O}=S;if(O.lazy)return!0;if(O.loader==null)return!1;if(o)return Fv(O,t.loaderData,t.errors);if(bX(t.loaderData,t.matches[E],S))return!0;let M=t.matches[E],N=S;return ZM(S,{currentUrl:m,currentParams:M.params,nextUrl:v,nextParams:N.params,...r,actionResult:y,actionStatus:w,defaultShouldRevalidate:j?!1:i||m.pathname+m.search===v.pathname+v.search||m.search!==v.search||wX(M,N)})}),_=[];return l.forEach((S,E)=>{if(o||!n.some(I=>I.route.id===S.routeId)||c.has(E))return;let O=qo(d,S.path,p);if(!O){_.push({key:E,routeId:S.routeId,path:S.path,matches:null,match:null,controller:null});return}let M=t.fetchers.get(E),N=Ql(O,S.path),P=!1;u.has(E)?P=!1:s.has(E)?(s.delete(E),P=!0):M&&M.state!=="idle"&&M.data===void 0?P=i:P=ZM(N,{currentUrl:m,currentParams:t.matches[t.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params,...r,actionResult:y,actionStatus:w,defaultShouldRevalidate:j?!1:i}),P&&_.push({key:E,routeId:S.routeId,path:S.path,matches:O,match:N,controller:new AbortController})}),[x,_]}function Fv(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&t[e.id]!==void 0,a=n!=null&&n[e.id]!==void 0;return!r&&a?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!a}function bX(e,t,n){let r=!t||n.route.id!==t.route.id,a=!e.hasOwnProperty(n.route.id);return r||a}function wX(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function ZM(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function GM(e,t,n,r,a){let o;if(e){let c=r[e];Ze(c,`No route found to patch children into: routeId = ${e}`),c.children||(c.children=[]),o=c.children}else o=n;let i=t.filter(c=>!o.some(l=>QM(c,l))),s=Xp(i,a,[e||"_","patch",String((o==null?void 0:o.length)||"0")],r);o.push(...s)}function QM(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var a;return(a=t.children)==null?void 0:a.some(o=>QM(n,o))}):!1}async function xX(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let a=n[e.id];Ze(a,"No route found in manifest");let o={};for(let i in r){let s=a[i]!==void 0&&i!=="hasErrorBoundary";rn(!s,`Route "${a.id}" has a static property "${i}" defined but its lazy function is also returning a value for this property. The lazy route property "${i}" will be ignored.`),!s&&!HK.has(i)&&(o[i]=r[i])}Object.assign(a,o),Object.assign(a,{...t(a),lazy:void 0})}async function _X({matches:e}){let t=e.filter(n=>n.shouldLoad);return(await Promise.all(t.map(n=>n.resolve()))).reduce((n,r,a)=>Object.assign(n,{[t[a].route.id]:r}),{})}async function jX(e,t,n,r,a,o,i,s,c,l){let u=o.map(f=>f.route.lazy?xX(f.route,c,s):void 0),d=o.map((f,y)=>{let m=u[y],v=a.some(b=>b.route.id===f.route.id);return{...f,shouldLoad:v,resolve:async b=>(b&&r.method==="GET"&&(f.route.lazy||f.route.loader)&&(v=!0),v?SX(t,r,f,m,b,l):Promise.resolve({type:"data",result:void 0}))}}),p=await e({matches:d,request:r,params:o[0].params,fetcherKey:i,context:l});try{await Promise.all(u)}catch{}return p}async function SX(e,t,n,r,a,o){let i,s,c=l=>{let u,d=new Promise((y,m)=>u=m);s=()=>u(),t.signal.addEventListener("abort",s);let p=y=>typeof l!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${e}" [routeId: ${n.route.id}]`)):l({request:t,params:n.params,context:o},...y!==void 0?[y]:[]),f=(async()=>{try{return{type:"data",result:await(a?a(y=>p(y)):p())}}catch(y){return{type:"error",result:y}}})();return Promise.race([f,d])};try{let l=n.route[e];if(r)if(l){let u,[d]=await Promise.all([c(l).catch(p=>{u=p}),r]);if(u!==void 0)throw u;i=d}else if(await r,l=n.route[e],l)i=await c(l);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw yr(405,{method:t.method,pathname:d,routeId:n.route.id})}else return{type:"data",result:void 0};else if(l)i=await c(l);else{let u=new URL(t.url),d=u.pathname+u.search;throw yr(404,{pathname:d})}}catch(l){return{type:"error",result:l}}finally{s&&t.signal.removeEventListener("abort",s)}return i}async function EX(e){var r,a,o,i;let{result:t,type:n}=e;if(iP(t)){let s;try{let c=t.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?t.body==null?s=null:s=await t.json():s=await t.text()}catch(c){return{type:"error",error:c}}return n==="error"?{type:"error",error:new Jp(t.status,t.statusText,s),statusCode:t.status,headers:t.headers}:{type:"data",data:s,statusCode:t.status,headers:t.headers}}if(n==="error"){if(oP(t)){if(t.data instanceof Error)return{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status};t=new Jp(((a=t.init)==null?void 0:a.status)||500,void 0,t.data)}return{type:"error",error:t,statusCode:ef(t)?t.status:void 0}}return oP(t)?{type:"data",data:t.data,statusCode:(o=t.init)==null?void 0:o.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function OX(e,t,n,r,a){let o=e.headers.get("Location");if(Ze(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!Lv.test(o)){let i=r.slice(0,r.findIndex(s=>s.route.id===n)+1);o=$v(new URL(t.url),i,a,o),e.headers.set("Location",o)}return e}function YM(e,t,n){if(Lv.test(e)){let r=e,a=r.startsWith("//")?new URL(t.protocol+r):new URL(r),o=Rr(a.pathname,n)!=null;if(a.origin===t.origin&&o)return a.pathname+a.search+a.hash}return e}function Rs(e,t,n,r){let a=e.createURL(aP(t)).toString(),o={signal:n};if(r&&Dr(r.formMethod)){let{formMethod:i,formEncType:s}=r;o.method=i.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=Bv(r.formData):o.body=r.formData}return new Request(a,o)}function Bv(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function JM(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function CX(e,t,n,r=!1,a=!1){let o={},i=null,s,c=!1,l={},u=n&&ar(n[1])?n[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let p=d.route.id,f=t[p];if(Ze(!Ti(f),"Cannot handle redirect results in processLoaderData"),ar(f)){let y=f.error;if(u!==void 0&&(y=u,u=void 0),i=i||{},a)i[p]=y;else{let m=Ai(e,p);i[m.route.id]==null&&(i[m.route.id]=y)}r||(o[p]=WM),c||(c=!0,s=ef(f.error)?f.error.status:500),f.headers&&(l[p]=f.headers)}else o[p]=f.data,f.statusCode&&f.statusCode!==200&&!c&&(s=f.statusCode),f.headers&&(l[p]=f.headers)}),u!==void 0&&n&&(i={[n[0]]:u},o[n[0]]=void 0),{loaderData:o,errors:i,statusCode:s||200,loaderHeaders:l}}function eP(e,t,n,r,a,o){let{loaderData:i,errors:s}=CX(t,n,r);return a.forEach(c=>{let{key:l,match:u,controller:d}=c,p=o[l];if(Ze(p,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(ar(p)){let f=Ai(e.matches,u==null?void 0:u.route.id);s&&s[f.route.id]||(s={...s,[f.route.id]:p.error}),e.fetchers.delete(l)}else if(Ti(p))Ze(!1,"Unhandled fetcher revalidation redirect");else{let f=Ko(p.data);e.fetchers.set(l,f)}}),{loaderData:i,errors:s}}function tP(e,t,n,r){let a=Object.entries(t).filter(([,o])=>o!==WM).reduce((o,[i,s])=>(o[i]=s,o),{});for(let o of n){let i=o.route.id;if(!t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&o.route.loader&&(a[i]=e[i]),r&&r.hasOwnProperty(i))break}return a}function nP(e){return e?ar(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Ai(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function rP(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function yr(e,{pathname:t,routeId:n,method:r,type:a,message:o}={}){let i="Unknown Server Error",s="Unknown @remix-run/router error";return e===400?(i="Bad Request",r&&t&&n?s=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:a==="invalid-body"&&(s="Unable to encode submission body")):e===403?(i="Forbidden",s=`Route "${n}" does not match URL "${t}"`):e===404?(i="Not Found",s=`No route matches URL "${t}"`):e===405&&(i="Method Not Allowed",r&&t&&n?s=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new Jp(e||500,i,new Error(s),!0)}function tf(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,a]=t[n];if(Ti(a))return{key:r,result:a}}}function aP(e){let t=typeof e=="string"?Qa(e):e;return Ga({...t,hash:""})}function NX(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function MX(e){return iP(e.result)&&hX.has(e.result.status)}function ar(e){return e.type==="error"}function Ti(e){return(e&&e.type)==="redirect"}function oP(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function iP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function PX(e){return fX.has(e.toUpperCase())}function Dr(e){return dX.has(e.toUpperCase())}function zv(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function Ql(e,t){let n=typeof t=="string"?Qa(t).search:t.search;if(e[e.length-1].route.index&&zv(n||""))return e[e.length-1];let r=zM(e);return r[r.length-1]}function sP(e){let{formMethod:t,formAction:n,formEncType:r,text:a,formData:o,json:i}=e;if(!(!t||!n||!r)){if(a!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:a};if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:i,text:void 0}}}function Vv(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function kX(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Yl(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function AX(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Ko(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function TX(e,t){try{let n=e.sessionStorage.getItem(UM);if(n){let r=JSON.parse(n);for(let[a,o]of Object.entries(r||{}))o&&Array.isArray(o)&&t.set(a,new Set(o||[]))}}catch{}}function IX(e,t){if(t.size>0){let n={};for(let[r,a]of t)n[r]=[...a];try{e.sessionStorage.setItem(UM,JSON.stringify(n))}catch(r){rn(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function RX(){let e,t,n=new Promise((r,a)=>{e=async o=>{r(o);try{await n}catch{}},t=async o=>{a(o);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var Ii=g.createContext(null);Ii.displayName="DataRouter";var Jl=g.createContext(null);Jl.displayName="DataRouterState";var Uv=g.createContext({isTransitioning:!1});Uv.displayName="ViewTransition";var cP=g.createContext(new Map);cP.displayName="Fetchers";var DX=g.createContext(null);DX.displayName="Await";var Lr=g.createContext(null);Lr.displayName="Navigation";var nf=g.createContext(null);nf.displayName="Location";var gr=g.createContext({outlet:null,matches:[],isDataRoute:!1});gr.displayName="Route";var Wv=g.createContext(null);Wv.displayName="RouteError";function LX(e,{relative:t}={}){Ze(Ds(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=g.useContext(Lr),{hash:a,pathname:o,search:i}=eu(e,{relative:t}),s=o;return n!=="/"&&(s=o==="/"?n:ma([n,o])),r.createHref({pathname:s,search:i,hash:a})}function Ds(){return g.useContext(nf)!=null}function ya(){return Ze(Ds(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(nf).location}var lP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function uP(e){g.useContext(Lr).static||g.useLayoutEffect(e)}function Ri(){let{isDataRoute:e}=g.useContext(gr);return e?QX():$X()}function $X(){Ze(Ds(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(Ii),{basename:t,navigator:n}=g.useContext(Lr),{matches:r}=g.useContext(gr),{pathname:a}=ya(),o=JSON.stringify(Qp(r)),i=g.useRef(!1);return uP(()=>{i.current=!0}),g.useCallback((s,c={})=>{if(rn(i.current,lP),!i.current)return;if(typeof s=="number"){n.go(s);return}let l=Yp(s,JSON.parse(o),a,c.relative==="path");e==null&&t!=="/"&&(l.pathname=l.pathname==="/"?t:ma([t,l.pathname])),(c.replace?n.replace:n.push)(l,c.state,c)},[t,n,o,a,e])}var FX=g.createContext(null);function BX(e){let t=g.useContext(gr).outlet;return t&&g.createElement(FX.Provider,{value:e},t)}function dP(){let{matches:e}=g.useContext(gr),t=e[e.length-1];return t?t.params:{}}function eu(e,{relative:t}={}){let{matches:n}=g.useContext(gr),{pathname:r}=ya(),a=JSON.stringify(Qp(n));return g.useMemo(()=>Yp(e,JSON.parse(a),r,t==="path"),[e,a,r,t])}function zX(e,t,n,r){Ze(Ds(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(Lr),{matches:o}=g.useContext(gr),i=o[o.length-1],s=i?i.params:{},c=i?i.pathname:"/",l=i?i.pathnameBase:"/",u=i&&i.route;{let v=u&&u.path||"";hP(c,!u||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let d=ya(),p;p=d;let f=p.pathname||"/",y=f;if(l!=="/"){let v=l.replace(/^\//,"").split("/");y="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=qo(e,{pathname:y});return rn(u||m!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),rn(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),qX(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},s,v.params),pathname:ma([l,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:ma([l,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r)}function VX(){let e=pP(),t=ef(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=g.createElement(g.Fragment,null,g.createElement("p",null,"\u{1F4BF} Hey developer \u{1F44B}"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:o},"ErrorBoundary")," or"," ",g.createElement("code",{style:o},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),n?g.createElement("pre",{style:a},n):null,i)}var UX=g.createElement(VX,null),WX=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?g.createElement(gr.Provider,{value:this.props.routeContext},g.createElement(Wv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function HX({routeContext:e,match:t,children:n}){let r=g.useContext(Ii);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(gr.Provider,{value:e},n)}function qX(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,o=n==null?void 0:n.errors;if(o!=null){let c=a.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id])!==void 0);Ze(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let i=!1,s=-1;if(n)for(let c=0;c<a.length;c++){let l=a[c];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(s=c),l.route.id){let{loaderData:u,errors:d}=n,p=l.route.loader&&!u.hasOwnProperty(l.route.id)&&(!d||d[l.route.id]===void 0);if(l.route.lazy||p){i=!0,s>=0?a=a.slice(0,s+1):a=[a[0]];break}}}return a.reduceRight((c,l,u)=>{let d,p=!1,f=null,y=null;n&&(d=o&&l.route.id?o[l.route.id]:void 0,f=l.route.errorElement||UX,i&&(s<0&&u===0?(hP("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,y=null):s===u&&(p=!0,y=l.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,u+1)),v=()=>{let b;return d?b=f:p?b=y:l.route.Component?b=g.createElement(l.route.Component,null):l.route.element?b=l.route.element:b=c,g.createElement(HX,{match:l,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:b})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?g.createElement(WX,{location:n.location,revalidation:n.revalidation,component:f,error:d,children:v(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):v()},null)}function Hv(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function KX(e){let t=g.useContext(Ii);return Ze(t,Hv(e)),t}function XX(e){let t=g.useContext(Jl);return Ze(t,Hv(e)),t}function ZX(e){let t=g.useContext(gr);return Ze(t,Hv(e)),t}function qv(e){let t=ZX(e),n=t.matches[t.matches.length-1];return Ze(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function GX(){return qv("useRouteId")}function pP(){var r;let e=g.useContext(Wv),t=XX("useRouteError"),n=qv("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function QX(){let{router:e}=KX("useNavigate"),t=qv("useNavigate"),n=g.useRef(!1);return uP(()=>{n.current=!0}),g.useCallback(async(r,a={})=>{rn(n.current,lP),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...a}))},[e,t])}var fP={};function hP(e,t,n){!t&&!fP[e]&&(fP[e]=!0,rn(!1,n))}var mP={};function yP(e,t){!e&&!mP[t]&&(mP[t]=!0,console.warn(t))}function gP(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&rn(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:g.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&rn(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:g.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&rn(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:g.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var YX=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function JX({router:e,flushSync:t}){let[n,r]=g.useState(e.state),[a,o]=g.useState(),[i,s]=g.useState({isTransitioning:!1}),[c,l]=g.useState(),[u,d]=g.useState(),[p,f]=g.useState(),y=g.useRef(new Map),m=g.useCallback((j,{deletedFetchers:x,flushSync:_,viewTransitionOpts:S})=>{x.forEach(O=>y.current.delete(O)),j.fetchers.forEach((O,M)=>{O.data!==void 0&&y.current.set(M,O.data)}),yP(_===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let E=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(yP(S==null||E,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!S||!E){t&&_?t(()=>r(j)):g.startTransition(()=>r(j));return}if(t&&_){t(()=>{u&&(c&&c.resolve(),u.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:S.currentLocation,nextLocation:S.nextLocation})});let O=e.window.document.startViewTransition(()=>{t(()=>r(j))});O.finished.finally(()=>{t(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})})}),t(()=>d(O));return}u?(c&&c.resolve(),u.skipTransition(),f({state:j,currentLocation:S.currentLocation,nextLocation:S.nextLocation})):(o(j),s({isTransitioning:!0,flushSync:!1,currentLocation:S.currentLocation,nextLocation:S.nextLocation}))},[e.window,t,u,c]);g.useLayoutEffect(()=>e.subscribe(m),[e,m]),g.useEffect(()=>{i.isTransitioning&&!i.flushSync&&l(new YX)},[i]),g.useEffect(()=>{if(c&&a&&e.window){let j=a,x=c.promise,_=e.window.document.startViewTransition(async()=>{g.startTransition(()=>r(j)),await x});_.finished.finally(()=>{l(void 0),d(void 0),o(void 0),s({isTransitioning:!1})}),d(_)}},[a,c,e.window]),g.useEffect(()=>{c&&a&&n.location.key===a.location.key&&c.resolve()},[c,u,n.location,a]),g.useEffect(()=>{!i.isTransitioning&&p&&(o(p.state),s({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),f(void 0))},[i.isTransitioning,p]);let v=g.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:j=>e.navigate(j),push:(j,x,_)=>e.navigate(j,{state:x,preventScrollReset:_==null?void 0:_.preventScrollReset}),replace:(j,x,_)=>e.navigate(j,{replace:!0,state:x,preventScrollReset:_==null?void 0:_.preventScrollReset})}),[e]),b=e.basename||"/",w=g.useMemo(()=>({router:e,navigator:v,static:!1,basename:b}),[e,v,b]);return g.createElement(g.Fragment,null,g.createElement(Ii.Provider,{value:w},g.createElement(Jl.Provider,{value:n},g.createElement(cP.Provider,{value:y.current},g.createElement(Uv.Provider,{value:i},g.createElement(aZ,{basename:b,location:n.location,navigationType:n.historyAction,navigator:v},g.createElement(eZ,{routes:e.routes,future:e.future,state:n})))))),null)}var eZ=g.memo(tZ);function tZ({routes:e,future:t,state:n}){return zX(e,void 0,n,t)}function nZ({to:e,replace:t,state:n,relative:r}){Ze(Ds(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(Lr);rn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=g.useContext(gr),{pathname:i}=ya(),s=Ri(),c=Yp(e,Qp(o),i,r==="path"),l=JSON.stringify(c);return g.useEffect(()=>{s(JSON.parse(l),{replace:t,state:n,relative:r})},[s,l,r,t,n]),null}function rZ(e){return BX(e.context)}function Xo(e){Ze(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function aZ({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:a,static:o=!1}){Ze(!Ds(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),s=g.useMemo(()=>({basename:i,navigator:a,static:o,future:{}}),[i,a,o]);typeof n=="string"&&(n=Qa(n));let{pathname:c="/",search:l="",hash:u="",state:d=null,key:p="default"}=n,f=g.useMemo(()=>{let y=Rr(c,i);return y==null?null:{location:{pathname:y,search:l,hash:u,state:d,key:p},navigationType:r}},[i,c,l,u,d,p,r]);return rn(f!=null,`<Router basename="${i}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:g.createElement(Lr.Provider,{value:s},g.createElement(nf.Provider,{children:t,value:f}))}function Kv(e,t=[]){let n=[];return g.Children.forEach(e,(r,a)=>{if(!g.isValidElement(r))return;let o=[...t,a];if(r.type===g.Fragment){n.push.apply(n,Kv(r.props.children,o));return}Ze(r.type===Xo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ze(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=Kv(r.props.children,o)),n.push(i)}),n}var oZ=Kv,rf="get",af="application/x-www-form-urlencoded";function of(e){return e!=null&&typeof e.tagName=="string"}function iZ(e){return of(e)&&e.tagName.toLowerCase()==="button"}function sZ(e){return of(e)&&e.tagName.toLowerCase()==="form"}function cZ(e){return of(e)&&e.tagName.toLowerCase()==="input"}function lZ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function uZ(e,t){return e.button===0&&(!t||t==="_self")&&!lZ(e)}var sf=null;function dZ(){if(sf===null)try{new FormData(document.createElement("form"),0),sf=!1}catch{sf=!0}return sf}var pZ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Xv(e){return e!=null&&!pZ.has(e)?(rn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${af}"`),null):e}function fZ(e,t){let n,r,a,o,i;if(sZ(e)){let s=e.getAttribute("action");r=s?Rr(s,t):null,n=e.getAttribute("method")||rf,a=Xv(e.getAttribute("enctype"))||af,o=new FormData(e)}else if(iZ(e)||cZ(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||s.getAttribute("action");if(r=c?Rr(c,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||rf,a=Xv(e.getAttribute("formenctype"))||Xv(s.getAttribute("enctype"))||af,o=new FormData(s,e),!dZ()){let{name:l,type:u,value:d}=e;if(u==="image"){let p=l?`${l}.`:"";o.append(`${p}x`,"0"),o.append(`${p}y`,"0")}else l&&o.append(l,d)}}else{if(of(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=rf,r=null,a=af,i=e}return o&&a==="text/plain"&&(i=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:i}}function Zv(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function hZ(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module).then(async r=>(await r.__tla,r));return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function mZ(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function yZ(e,t,n){let r=await Promise.all(e.map(async a=>{let o=t.routes[a.route.id];if(o){let i=await hZ(o,n);return i.links?i.links():[]}return[]}));return wZ(r.flat(1).filter(mZ).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function vP(e,t,n,r,a,o){let i=(c,l)=>n[l]?c.route.id!==n[l].route.id:!0,s=(c,l)=>{var u;return n[l].pathname!==c.pathname||((u=n[l].route.path)==null?void 0:u.endsWith("*"))&&n[l].params["*"]!==c.params["*"]};return o==="assets"?t.filter((c,l)=>i(c,l)||s(c,l)):o==="data"?t.filter((c,l)=>{var d;let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(i(c,l)||s(c,l))return!0;if(c.route.shouldRevalidate){let p=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function gZ(e,t){return vZ(e.map(n=>{let r=t.routes[n.route.id];if(!r)return[];let a=[r.module];return r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function vZ(e){return[...new Set(e)]}function bZ(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function wZ(e,t){let n=new Set;return new Set(t),e.reduce((r,a)=>{let o=JSON.stringify(bZ(a));return n.has(o)||(n.add(o),r.push({key:o,link:a})),r},[])}function xZ(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function _Z(){let e=g.useContext(Ii);return Zv(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function jZ(){let e=g.useContext(Jl);return Zv(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Gv=g.createContext(void 0);Gv.displayName="FrameworkContext";function bP(){let e=g.useContext(Gv);return Zv(e,"You must render this element inside a <HydratedRouter> element"),e}function SZ(e,t){let n=g.useContext(Gv),[r,a]=g.useState(!1),[o,i]=g.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=t,p=g.useRef(null);g.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let m=b=>{b.forEach(w=>{i(w.isIntersecting)})},v=new IntersectionObserver(m,{threshold:.5});return p.current&&v.observe(p.current),()=>{v.disconnect()}}},[e]),g.useEffect(()=>{if(r){let m=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(m)}}},[r]);let f=()=>{a(!0)},y=()=>{a(!1),i(!1)};return n?e!=="intent"?[o,p,{}]:[o,p,{onFocus:tu(s,f),onBlur:tu(c,y),onMouseEnter:tu(l,f),onMouseLeave:tu(u,y),onTouchStart:tu(d,f)}]:[!1,p,{}]}function tu(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function EZ({page:e,...t}){let{router:n}=_Z(),r=g.useMemo(()=>qo(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?g.createElement(CZ,{page:e,matches:r,...t}):(console.warn(`Tried to prefetch ${e} but no routes matched.`),null)}function OZ(e){let{manifest:t,routeModules:n}=bP(),[r,a]=g.useState([]);return g.useEffect(()=>{let o=!1;return yZ(e,t,n).then(i=>{o||a(i)}),()=>{o=!0}},[e,t,n]),r}function CZ({page:e,matches:t,...n}){let r=ya(),{manifest:a,routeModules:o}=bP(),{loaderData:i,matches:s}=jZ(),c=g.useMemo(()=>vP(e,t,s,a,r,"data"),[e,t,s,a,r]),l=g.useMemo(()=>vP(e,t,s,a,r,"assets"),[e,t,s,a,r]),u=g.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let f=new Set,y=!1;if(t.forEach(v=>{var w;let b=a.routes[v.route.id];!b||!b.hasLoader||(!c.some(j=>j.route.id===v.route.id)&&v.route.id in i&&((w=o[v.route.id])!=null&&w.shouldRevalidate)||b.hasClientLoader?y=!0:f.add(v.route.id))}),f.size===0)return[];let m=xZ(e);return y&&f.size>0&&m.searchParams.set("_routes",t.filter(v=>f.has(v.route.id)).map(v=>v.route.id).join(",")),[m.pathname+m.search]},[i,r,a,c,t,e,o]),d=g.useMemo(()=>gZ(l,a),[l,a]),p=OZ(l);return g.createElement(g.Fragment,null,u.map(f=>g.createElement("link",{key:f,rel:"prefetch",as:"fetch",href:f,...n})),d.map(f=>g.createElement("link",{key:f,rel:"modulepreload",href:f,...n})),p.map(({key:f,link:y})=>g.createElement("link",{key:f,...y})))}function NZ(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var wP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{wP&&(window.__reactRouterVersion="7.0.2")}catch{}function xP(e,t){return HM({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:VK({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||_P(),routes:e,mapRouteProperties:gP,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function MZ(e,t){return HM({basename:t==null?void 0:t.basename,future:t==null?void 0:t.future,history:UK({window:t==null?void 0:t.window}),hydrationData:_P(),routes:e,mapRouteProperties:gP,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function _P(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:PZ(e.errors)}),e}function PZ(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,a]of t)if(a&&a.__type==="RouteErrorResponse")n[r]=new Jp(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let o=window[a.__subType];if(typeof o=="function")try{let i=new o(a.message);i.stack="",n[r]=i}catch{}}if(n[r]==null){let o=new Error(a.message);o.stack="",n[r]=o}}else n[r]=a;return n}var jP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Qv=g.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:a,replace:o,state:i,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},p){let{basename:f}=g.useContext(Lr),y=typeof c=="string"&&jP.test(c),m,v=!1;if(typeof c=="string"&&y&&(m=c,wP))try{let O=new URL(window.location.href),M=c.startsWith("//")?new URL(O.protocol+c):new URL(c),N=Rr(M.pathname,f);M.origin===O.origin&&N!=null?c=N+M.search+M.hash:v=!0}catch{rn(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=LX(c,{relative:r}),[w,j,x]=SZ(n,d),_=IZ(c,{replace:o,state:i,target:s,preventScrollReset:l,relative:r,viewTransition:u});function S(O){e&&e(O),O.defaultPrevented||_(O)}let E=g.createElement("a",{...d,...x,href:m||b,onClick:v||a?e:S,ref:NZ(p,j),target:s,"data-discover":!y&&t==="render"?"true":void 0});return w&&!y?g.createElement(g.Fragment,null,E,g.createElement(EZ,{page:b})):E});Qv.displayName="Link";var kZ=g.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:a,to:o,viewTransition:i,children:s,...c},l){let u=eu(o,{relative:c.relative}),d=ya(),p=g.useContext(Jl),{navigator:f,basename:y}=g.useContext(Lr),m=p!=null&&FZ(u)&&i===!0,v=f.encodeLocation?f.encodeLocation(u).pathname:u.pathname,b=d.pathname,w=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&y&&(w=Rr(w,y)||w);const j=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let x=b===v||!r&&b.startsWith(v)&&b.charAt(j)==="/",_=w!=null&&(w===v||!r&&w.startsWith(v)&&w.charAt(v.length)==="/"),S={isActive:x,isPending:_,isTransitioning:m},E=x?e:void 0,O;typeof n=="function"?O=n(S):O=[n,x?"active":null,_?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(S):a;return g.createElement(Qv,{...c,"aria-current":E,className:O,ref:l,style:M,to:o,viewTransition:i},typeof s=="function"?s(S):s)});kZ.displayName="NavLink";var AZ=g.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:a,state:o,method:i=rf,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...p},f)=>{let y=LZ(),m=$Z(s,{relative:l}),v=i.toLowerCase()==="get"?"get":"post",b=typeof s=="string"&&jP.test(s),w=j=>{if(c&&c(j),j.defaultPrevented)return;j.preventDefault();let x=j.nativeEvent.submitter,_=(x==null?void 0:x.getAttribute("formmethod"))||i;y(x||j.currentTarget,{fetcherKey:t,method:_,navigate:n,replace:a,state:o,relative:l,preventScrollReset:u,viewTransition:d})};return g.createElement("form",{ref:f,method:v,action:m,onSubmit:r?c:w,...p,"data-discover":!b&&e==="render"?"true":void 0})});AZ.displayName="Form";function TZ(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function SP(e){let t=g.useContext(Ii);return Ze(t,TZ(e)),t}function IZ(e,{target:t,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:i}={}){let s=Ri(),c=ya(),l=eu(e,{relative:o});return g.useCallback(u=>{if(uZ(u,t)){u.preventDefault();let d=n!==void 0?n:Ga(c)===Ga(l);s(e,{replace:d,state:r,preventScrollReset:a,relative:o,viewTransition:i})}},[c,s,l,n,r,t,e,a,o,i])}var RZ=0,DZ=()=>`__${String(++RZ)}__`;function LZ(){let{router:e}=SP("useSubmit"),{basename:t}=g.useContext(Lr),n=GX();return g.useCallback(async(r,a={})=>{let{action:o,method:i,encType:s,formData:c,body:l}=fZ(r,t);if(a.navigate===!1){let u=a.fetcherKey||DZ();await e.fetch(u,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:c,body:l,formMethod:a.method||i,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}function $Z(e,{relative:t}={}){let{basename:n}=g.useContext(Lr),r=g.useContext(gr);Ze(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...eu(e||".",{relative:t})},i=ya();if(e==null){o.search=i.search;let s=new URLSearchParams(o.search),c=s.getAll("index");if(c.some(l=>l==="")){s.delete("index"),c.filter(u=>u).forEach(u=>s.append("index",u));let l=s.toString();o.search=l?`?${l}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:ma([n,o.pathname])),Ga(o)}function FZ(e,t={}){let n=g.useContext(Uv);Ze(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=SP("useViewTransitionState"),a=eu(e,{relative:t.relative});if(!n.isTransitioning)return!1;let o=Rr(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=Rr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Gp(a.pathname,i)!=null||Gp(a.pathname,o)!=null}new TextEncoder;function BZ(e){return g.createElement(JX,{flushSync:Nl.flushSync,...e})}var zZ=fAe.useId||(()=>{}),VZ=0;Pt=function(e){const[t,n]=g.useState(zZ());return tn(()=>{e||n(r=>r??String(VZ++))},[e]),e||(t?`radix-${t}`:"")};var Yv="Collapsible",[UZ,EP]=er(Yv),[WZ,Jv]=UZ(Yv),OP=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:o,onOpenChange:i,...s}=e,[c=!1,l]=Sn({prop:r,defaultProp:a,onChange:i});return h.jsx(WZ,{scope:n,disabled:o,contentId:Pt(),open:c,onOpenToggle:g.useCallback(()=>l(u=>!u),[l]),children:h.jsx(Ae.div,{"data-state":r0(c),"data-disabled":o?"":void 0,...s,ref:t})})});OP.displayName=Yv;var CP="CollapsibleTrigger",e0=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=Jv(CP,n);return h.jsx(Ae.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":r0(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:ge(e.onClick,a.onOpenToggle)})});e0.displayName=CP;var t0="CollapsibleContent",n0=g.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Jv(t0,e.__scopeCollapsible);return h.jsx(Mr,{present:n||a.open,children:({present:o})=>h.jsx(HZ,{...r,ref:t,present:o})})});n0.displayName=t0;var HZ=g.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...o}=e,i=Jv(t0,n),[s,c]=g.useState(r),l=g.useRef(null),u=wt(t,l),d=g.useRef(0),p=d.current,f=g.useRef(0),y=f.current,m=i.open||s,v=g.useRef(m),b=g.useRef();return g.useEffect(()=>{const w=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(w)},[]),tn(()=>{const w=l.current;if(w){b.current=b.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const j=w.getBoundingClientRect();d.current=j.height,f.current=j.width,v.current||(w.style.transitionDuration=b.current.transitionDuration,w.style.animationName=b.current.animationName),c(r)}},[i.open,r]),h.jsx(Ae.div,{"data-state":r0(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!m,...o,ref:u,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...e.style},children:m&&a})});function r0(e){return e?"open":"closed"}var NP=OP,qZ=e0,KZ=n0;const XZ=NP,ZZ=e0,GZ=n0,a0=768;function QZ(){const[e,t]=g.useState(void 0);return g.useEffect(()=>{const n=window.matchMedia(`(max-width: ${a0-1}px)`),r=()=>{t(window.innerWidth<a0)};return n.addEventListener("change",r),t(window.innerWidth<a0),()=>n.removeEventListener("change",r)},[]),!!e}let nu;nu=Ha("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ut=g.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...a},o)=>{const i=r?Vo:"button";return h.jsx(i,{className:Z(nu({variant:t,size:n,className:e})),ref:o,...a})}),ut.displayName="Button";const En=g.forwardRef(({className:e,type:t,...n},r)=>h.jsx("input",{type:t,className:Z("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));En.displayName="Input";var YZ="Separator",MP="horizontal",JZ=["horizontal","vertical"],PP=g.forwardRef((e,t)=>{const{decorative:n,orientation:r=MP,...a}=e,o=eG(r)?r:MP,i=n?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return h.jsx(Ae.div,{"data-orientation":o,...i,...a,ref:t})});PP.displayName=YZ;function eG(e){return JZ.includes(e)}Yg=PP,Ms=g.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},a)=>h.jsx(Yg,{ref:a,decorative:n,orientation:t,className:Z("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r})),Ms.displayName=Yg.displayName;var o0="focusScope.autoFocusOnMount",i0="focusScope.autoFocusOnUnmount",kP={bubbles:!1,cancelable:!0},tG="FocusScope",cf=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=tr(a),u=tr(o),d=g.useRef(null),p=wt(t,m=>c(m)),f=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let m=function(j){if(f.paused||!s)return;const x=j.target;s.contains(x)?d.current=x:Zo(d.current,{select:!0})},v=function(j){if(f.paused||!s)return;const x=j.relatedTarget;x!==null&&(s.contains(x)||Zo(d.current,{select:!0}))},b=function(j){if(document.activeElement===document.body)for(const x of j)x.removedNodes.length>0&&Zo(s)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,f.paused]),g.useEffect(()=>{if(s){IP.add(f);const m=document.activeElement;if(!s.contains(m)){const v=new CustomEvent(o0,kP);s.addEventListener(o0,l),s.dispatchEvent(v),v.defaultPrevented||(nG(sG(AP(s)),{select:!0}),document.activeElement===m&&Zo(s))}return()=>{s.removeEventListener(o0,l),setTimeout(()=>{const v=new CustomEvent(i0,kP);s.addEventListener(i0,u),s.dispatchEvent(v),v.defaultPrevented||Zo(m??document.body,{select:!0}),s.removeEventListener(i0,u),IP.remove(f)},0)}}},[s,l,u,f]);const y=g.useCallback(m=>{if(!n&&!r||f.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,b=document.activeElement;if(v&&b){const w=m.currentTarget,[j,x]=rG(w);j&&x?!m.shiftKey&&b===x?(m.preventDefault(),n&&Zo(j,{select:!0})):m.shiftKey&&b===j&&(m.preventDefault(),n&&Zo(x,{select:!0})):b===w&&m.preventDefault()}},[n,r,f.paused]);return h.jsx(Ae.div,{tabIndex:-1,...i,ref:p,onKeyDown:y})});cf.displayName=tG;function nG(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Zo(r,{select:t}),document.activeElement!==n)return}function rG(e){const t=AP(e),n=TP(t,e),r=TP(t.reverse(),e);return[n,r]}function AP(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function TP(e,t){for(const n of e)if(!aG(n,{upTo:t}))return n}function aG(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function oG(e){return e instanceof HTMLInputElement&&"select"in e}function Zo(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&oG(e)&&t&&e.select()}}var IP=iG();function iG(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=RP(e,t),e.unshift(t)},remove(t){var n;e=RP(e,t),(n=e[0])==null||n.resume()}}}function RP(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function sG(e){return e.filter(t=>t.tagName!=="A")}var s0=0;Hl=function(){g.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??DP()),document.body.insertAdjacentElement("beforeend",e[1]??DP()),s0++,()=>{s0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),s0--}},[])};function DP(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}yn=function(){return yn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},yn.apply(this,arguments)},Wp=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},gv=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};var lf="right-scroll-bar-position",uf="width-before-scroll-bar",cG="with-scroll-bars-hidden",lG="--removed-body-scroll-bar-size";function c0(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function uG(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var dG=typeof window<"u"?g.useLayoutEffect:g.useEffect,LP=new WeakMap;function pG(e,t){var n=uG(null,function(r){return e.forEach(function(a){return c0(a,r)})});return dG(function(){var r=LP.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||c0(s,null)}),o.forEach(function(s){a.has(s)||c0(s,i)})}LP.set(n,e)},[e]),n}function fG(e){return e}function hG(e,t){t===void 0&&(t=fG);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var i=t(o,r);return n.push(i),function(){n=n.filter(function(s){return s!==i})}},assignSyncMedium:function(o){for(r=!0;n.length;){var i=n;n=[],i.forEach(o)}n={push:function(s){return o(s)},filter:function(){return n}}},assignMedium:function(o){r=!0;var i=[];if(n.length){var s=n;n=[],s.forEach(o),i=n}var c=function(){var u=i;i=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){i.push(u),l()},filter:function(u){return i=i.filter(u),n}}}};return a}mv=function(e){e===void 0&&(e={});var t=hG(null);return t.options=yn({async:!0,ssr:!1},e),t};var $P=function(e){var t=e.sideCar,n=Wp(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,yn({},n))};$P.isSideCarExport=!0,vv=function(e,t){return e.useMedium(t),$P};var FP=mv(),l0=function(){},df=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:l0,onWheelCapture:l0,onTouchMoveCapture:l0}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,p=e.sideCar,f=e.noIsolation,y=e.inert,m=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,j=Wp(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=p,_=pG([n,t]),S=yn(yn({},j),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:FP,removeScrollBar:l,shards:d,noIsolation:f,inert:y,setCallbacks:o,allowPinchZoom:!!m,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),yn(yn({},S),{ref:_})):g.createElement(b,yn({},S,{className:c,ref:_}),s))});df.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},df.classNames={fullWidth:uf,zeroRight:lf},yv=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function mG(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=yv();return t&&e.setAttribute("nonce",t),e}function yG(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function gG(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}let BP,zP,VP,pf,UP,WP,HP,Di,qP,u0,KP,XP,ff;if(BP=function(){var e=0,t=null;return{add:function(n){e==0&&(t=mG())&&(yG(t,n),gG(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},zP=function(){var e=BP();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Hp=function(){var e=zP(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},VP={left:0,top:0,right:0,gap:0},pf=function(e){return parseInt(e||"",10)||0},UP=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[pf(n),pf(r),pf(a)]},WP=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return VP;var t=UP(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},HP=Hp(),Di="data-scroll-locked",qP=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(cG,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Di,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(lf,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(uf,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(lf," .").concat(lf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(uf," .").concat(uf,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Di,`] {
    `).concat(lG,": ").concat(s,`px;
  }
`)},u0=function(){var e=parseInt(document.body.getAttribute(Di)||"0",10);return isFinite(e)?e:0},KP=function(){g.useEffect(function(){return document.body.setAttribute(Di,(u0()+1).toString()),function(){var e=u0()-1;e<=0?document.body.removeAttribute(Di):document.body.setAttribute(Di,e.toString())}},[])},XP=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;KP();var o=g.useMemo(function(){return WP(a)},[a]);return g.createElement(HP,{styles:qP(o,!t,a,n?"":"!important")})},ff=!1,typeof window<"u")try{var hf=Object.defineProperty({},"passive",{get:function(){return ff=!0,!0}});window.addEventListener("test",hf,hf),window.removeEventListener("test",hf,hf)}catch{ff=!1}var Ls=ff?{passive:!1}:!1,vG=function(e){return e.tagName==="TEXTAREA"},ZP=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!vG(e)&&n[t]==="visible")},bG=function(e){return ZP(e,"overflowY")},wG=function(e){return ZP(e,"overflowX")},GP=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=QP(e,r);if(a){var o=YP(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},xG=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},_G=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},QP=function(e,t){return e==="v"?bG(t):wG(t)},YP=function(e,t){return e==="v"?xG(t):_G(t)},jG=function(e,t){return e==="h"&&t==="rtl"?-1:1},SG=function(e,t,n,r,a){var o=jG(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,p=0;do{var f=YP(e,s),y=f[0],m=f[1],v=f[2],b=m-v-o*y;(y||b)&&QP(e,s)&&(d+=b,p+=y),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(p)<1||!a))&&(l=!0),l},mf=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},JP=function(e){return[e.deltaX,e.deltaY]},ek=function(e){return e&&"current"in e?e.current:e},EG=function(e,t){return e[0]===t[0]&&e[1]===t[1]},OG=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},CG=0,$s=[];function NG(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(CG++)[0],o=g.useState(Hp)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=gv([e.lockRef.current],(e.shards||[]).map(ek),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var b=mf(m),w=n.current,j="deltaX"in m?m.deltaX:w[0]-b[0],x="deltaY"in m?m.deltaY:w[1]-b[1],_,S=m.target,E=Math.abs(j)>Math.abs(x)?"h":"v";if("touches"in m&&E==="h"&&S.type==="range")return!1;var O=GP(E,S);if(!O)return!0;if(O?_=E:(_=E==="v"?"h":"v",O=GP(E,S)),!O)return!1;if(!r.current&&"changedTouches"in m&&(j||x)&&(r.current=_),!_)return!0;var M=r.current||_;return SG(M,v,m,M==="h"?j:x,!0)},[]),c=g.useCallback(function(m){var v=m;if(!(!$s.length||$s[$s.length-1]!==o)){var b="deltaY"in v?JP(v):mf(v),w=t.current.filter(function(_){return _.name===v.type&&(_.target===v.target||v.target===_.shadowParent)&&EG(_.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var j=(i.current.shards||[]).map(ek).filter(Boolean).filter(function(_){return _.contains(v.target)}),x=j.length>0?s(v,j[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(m,v,b,w){var j={name:m,delta:v,target:b,should:w,shadowParent:MG(b)};t.current.push(j),setTimeout(function(){t.current=t.current.filter(function(x){return x!==j})},1)},[]),u=g.useCallback(function(m){n.current=mf(m),r.current=void 0},[]),d=g.useCallback(function(m){l(m.type,JP(m),m.target,s(m,e.lockRef.current))},[]),p=g.useCallback(function(m){l(m.type,mf(m),m.target,s(m,e.lockRef.current))},[]);g.useEffect(function(){return $s.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:p}),document.addEventListener("wheel",c,Ls),document.addEventListener("touchmove",c,Ls),document.addEventListener("touchstart",u,Ls),function(){$s=$s.filter(function(m){return m!==o}),document.removeEventListener("wheel",c,Ls),document.removeEventListener("touchmove",c,Ls),document.removeEventListener("touchstart",u,Ls)}},[]);var f=e.removeScrollBar,y=e.inert;return g.createElement(g.Fragment,null,y?g.createElement(o,{styles:OG(a)}):null,f?g.createElement(XP,{gapMode:e.gapMode}):null)}function MG(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const PG=vv(FP,NG);var yf=g.forwardRef(function(e,t){return g.createElement(df,yn({},e,{ref:t,sideCar:PG}))});yf.classNames=df.classNames;let tk,Li,ru,au,gf,d0,nk,rk,vf,p0,f0,ak,vr,h0;tk=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Li=new WeakMap,ru=new WeakMap,au={},gf=0,d0=function(e){return e&&(e.host||d0(e.parentNode))},nk=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=d0(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},rk=function(e,t,n,r){var a=nk(t,Array.isArray(e)?e:[e]);au[n]||(au[n]=new WeakMap);var o=au[n],i=[],s=new Set,c=new Set(a),l=function(d){!d||s.has(d)||(s.add(d),l(d.parentNode))};a.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(p){if(s.has(p))u(p);else try{var f=p.getAttribute(r),y=f!==null&&f!=="false",m=(Li.get(p)||0)+1,v=(o.get(p)||0)+1;Li.set(p,m),o.set(p,v),i.push(p),m===1&&y&&ru.set(p,!0),v===1&&p.setAttribute(n,"true"),y||p.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",p,b)}})};return u(t),s.clear(),gf++,function(){i.forEach(function(d){var p=Li.get(d)-1,f=o.get(d)-1;Li.set(d,p),o.set(d,f),p||(ru.has(d)||d.removeAttribute(r),ru.delete(d)),f||d.removeAttribute(n)}),gf--,gf||(Li=new WeakMap,Li=new WeakMap,ru=new WeakMap,au={})}},Wl=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=tk(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),rk(r,a,n,"aria-hidden")):function(){return null}},vf="Dialog",[p0,f0]=er(vf),[ak,vr]=p0(vf),h0=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!0}=e,s=g.useRef(null),c=g.useRef(null),[l=!1,u]=Sn({prop:r,defaultProp:a,onChange:o});return h.jsx(ak,{scope:t,triggerRef:s,contentRef:c,contentId:Pt(),titleId:Pt(),descriptionId:Pt(),open:l,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(d=>!d),[u]),modal:i,children:n})},h0.displayName=vf;var ok="DialogTrigger",ik=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(ok,n),o=wt(t,a.triggerRef);return h.jsx(Ae.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":g0(a.open),...r,ref:o,onClick:ge(e.onClick,a.onOpenToggle)})});ik.displayName=ok;var m0="DialogPortal",[kG,sk]=p0(m0,{forceMount:void 0}),ck=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,o=vr(m0,t);return h.jsx(kG,{scope:t,forceMount:n,children:g.Children.map(r,i=>h.jsx(Mr,{present:n||o.open,children:h.jsx(Ng,{asChild:!0,container:a,children:i})}))})};ck.displayName=m0;var bf="DialogOverlay",lk=g.forwardRef((e,t)=>{const n=sk(bf,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=vr(bf,e.__scopeDialog);return o.modal?h.jsx(Mr,{present:r||o.open,children:h.jsx(AG,{...a,ref:t})}):null});lk.displayName=bf;var AG=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(bf,n);return h.jsx(yf,{as:Vo,allowPinchZoom:!0,shards:[a.contentRef],children:h.jsx(Ae.div,{"data-state":g0(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),$i="DialogContent",uk=g.forwardRef((e,t)=>{const n=sk($i,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=vr($i,e.__scopeDialog);return h.jsx(Mr,{present:r||o.open,children:o.modal?h.jsx(TG,{...a,ref:t}):h.jsx(IG,{...a,ref:t})})});uk.displayName=$i;var TG=g.forwardRef((e,t)=>{const n=vr($i,e.__scopeDialog),r=g.useRef(null),a=wt(t,n.contentRef,r);return g.useEffect(()=>{const o=r.current;if(o)return Wl(o)},[]),h.jsx(dk,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(e.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ge(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,s=i.button===0&&i.ctrlKey===!0;(i.button===2||s)&&o.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault())})}),IG=g.forwardRef((e,t)=>{const n=vr($i,e.__scopeDialog),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(dk,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),dk=g.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,...i}=e,s=vr($i,n),c=g.useRef(null),l=wt(t,c);return Hl(),h.jsxs(h.Fragment,{children:[h.jsx(cf,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(Cg,{role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":g0(s.open),...i,ref:l,onDismiss:()=>s.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(vk,{titleId:s.titleId}),h.jsx(wk,{contentRef:c,descriptionId:s.descriptionId})]})]})}),y0="DialogTitle",pk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(y0,n);return h.jsx(Ae.h2,{id:a.titleId,...r,ref:t})});pk.displayName=y0;var fk="DialogDescription",hk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(fk,n);return h.jsx(Ae.p,{id:a.descriptionId,...r,ref:t})});hk.displayName=fk;var mk="DialogClose",yk=g.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=vr(mk,n);return h.jsx(Ae.button,{type:"button",...r,ref:t,onClick:ge(e.onClick,()=>a.onOpenChange(!1))})});yk.displayName=mk;function g0(e){return e?"open":"closed"}let v0,gk,b0,vk,bk,wk,xk;v0="DialogTitleWarning",[gk,b0]=hAe(v0,{contentName:$i,titleName:y0,docsSlug:"dialog"}),vk=({titleId:e})=>{const t=b0(v0),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return g.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},bk="DialogDescriptionWarning",wk=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${b0(bk).contentName}}.`;return g.useEffect(()=>{var a;const r=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},$l=h0,xk=ik,Fl=ck,Mi=lk,Pi=uk,Os=pk,Cs=hk,Bl=yk;const RG=$l,DG=Fl,_k=g.forwardRef(({className:e,...t},n)=>h.jsx(Mi,{className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));_k.displayName=Mi.displayName;const LG=Ha("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),jk=g.forwardRef(({side:e="right",className:t,children:n,...r},a)=>h.jsxs(DG,{children:[h.jsx(_k,{}),h.jsxs(Pi,{ref:a,className:Z(LG({side:e}),t),...r,children:[n,h.jsxs(Bl,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[h.jsx(de,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));jk.displayName=Pi.displayName;const $G=g.forwardRef(({className:e,...t},n)=>h.jsx(Os,{ref:n,className:Z("text-lg font-semibold text-foreground",e),...t}));$G.displayName=Os.displayName;const FG=g.forwardRef(({className:e,...t},n)=>h.jsx(Cs,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));FG.displayName=Cs.displayName;function Sk({className:e,...t}){return h.jsx("div",{className:Z("animate-pulse rounded-md bg-muted",e),...t})}const BG=["top","right","bottom","left"],ga=Math.min,or=Math.max,wf=Math.round,xf=Math.floor,Go=e=>({x:e,y:e}),zG={left:"right",right:"left",bottom:"top",top:"bottom"},VG={start:"end",end:"start"};function w0(e,t,n){return or(e,ga(t,n))}function Ya(e,t){return typeof e=="function"?e(t):e}function Ja(e){return e.split("-")[0]}function Fs(e){return e.split("-")[1]}function x0(e){return e==="x"?"y":"x"}function _0(e){return e==="y"?"height":"width"}function Qo(e){return["top","bottom"].includes(Ja(e))?"y":"x"}function j0(e){return x0(Qo(e))}function UG(e,t,n){n===void 0&&(n=!1);const r=Fs(e),a=j0(e),o=_0(a);let i=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=_f(i)),[i,_f(i)]}function WG(e){const t=_f(e);return[S0(e),t,S0(t)]}function S0(e){return e.replace(/start|end/g,t=>VG[t])}function HG(e,t,n){const r=["left","right"],a=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?o:i;default:return[]}}function qG(e,t,n,r){const a=Fs(e);let o=HG(Ja(e),n==="start",r);return a&&(o=o.map(i=>i+"-"+a),t&&(o=o.concat(o.map(S0)))),o}function _f(e){return e.replace(/left|right|bottom|top/g,t=>zG[t])}function KG(e){return{top:0,right:0,bottom:0,left:0,...e}}function Ek(e){return typeof e!="number"?KG(e):{top:e,right:e,bottom:e,left:e}}function jf(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function Ok(e,t,n){let{reference:r,floating:a}=e;const o=Qo(t),i=j0(t),s=_0(i),c=Ja(t),l=o==="y",u=r.x+r.width/2-a.width/2,d=r.y+r.height/2-a.height/2,p=r[s]/2-a[s]/2;let f;switch(c){case"top":f={x:u,y:r.y-a.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-a.width,y:d};break;default:f={x:r.x,y:r.y}}switch(Fs(t)){case"start":f[i]-=p*(n&&l?-1:1);break;case"end":f[i]+=p*(n&&l?-1:1);break}return f}const XG=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:i}=n,s=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let l=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:d}=Ok(l,r,c),p=r,f={},y=0;for(let m=0;m<s.length;m++){const{name:v,fn:b}=s[m],{x:w,y:j,data:x,reset:_}=await b({x:u,y:d,initialPlacement:r,placement:p,strategy:a,middlewareData:f,rects:l,platform:i,elements:{reference:e,floating:t}});u=w??u,d=j??d,f={...f,[v]:{...f[v],...x}},_&&y<=50&&(y++,typeof _=="object"&&(_.placement&&(p=_.placement),_.rects&&(l=_.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):_.rects),{x:u,y:d}=Ok(l,p,c)),m=-1)}return{x:u,y:d,placement:p,strategy:a,middlewareData:f}};async function ou(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:o,rects:i,elements:s,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:f=0}=Ya(t,e),y=Ek(f),m=s[p?d==="floating"?"reference":"floating":d],v=jf(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(m)))==null||n?m:m.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),b=d==="floating"?{x:r,y:a,width:i.floating.width,height:i.floating.height}:i.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),j=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},x=jf(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:b,offsetParent:w,strategy:c}):b);return{top:(v.top-x.top+y.top)/j.y,bottom:(x.bottom-v.bottom+y.bottom)/j.y,left:(v.left-x.left+y.left)/j.x,right:(x.right-v.right+y.right)/j.x}}const ZG=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:o,platform:i,elements:s,middlewareData:c}=t,{element:l,padding:u=0}=Ya(e,t)||{};if(l==null)return{};const d=Ek(u),p={x:n,y:r},f=j0(a),y=_0(f),m=await i.getDimensions(l),v=f==="y",b=v?"top":"left",w=v?"bottom":"right",j=v?"clientHeight":"clientWidth",x=o.reference[y]+o.reference[f]-p[f]-o.floating[y],_=p[f]-o.reference[f],S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l));let E=S?S[j]:0;(!E||!await(i.isElement==null?void 0:i.isElement(S)))&&(E=s.floating[j]||o.floating[y]);const O=x/2-_/2,M=E/2-m[y]/2-1,N=ga(d[b],M),P=ga(d[w],M),I=N,k=E-m[y]-P,C=E/2-m[y]/2+O,T=w0(I,C,k),A=!c.arrow&&Fs(a)!=null&&C!==T&&o.reference[y]/2-(C<I?N:P)-m[y]/2<0,D=A?C<I?C-I:C-k:0;return{[f]:p[f]+D,data:{[f]:T,centerOffset:C-T-D,...A&&{alignmentOffset:D}},reset:A}}}),GG=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:i,initialPlacement:s,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:m=!0,...v}=Ya(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const b=Ja(a),w=Qo(s),j=Ja(s)===s,x=await(c.isRTL==null?void 0:c.isRTL(l.floating)),_=p||(j||!m?[_f(s)]:WG(s)),S=y!=="none";!p&&S&&_.push(...qG(s,m,y,x));const E=[s,..._],O=await ou(t,v),M=[];let N=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&M.push(O[b]),d){const C=UG(a,i,x);M.push(O[C[0]],O[C[1]])}if(N=[...N,{placement:a,overflows:M}],!M.every(C=>C<=0)){var P,I;const C=(((P=o.flip)==null?void 0:P.index)||0)+1,T=E[C];if(T)return{data:{index:C,overflows:N},reset:{placement:T}};let A=(I=N.filter(D=>D.overflows[0]<=0).sort((D,L)=>D.overflows[1]-L.overflows[1])[0])==null?void 0:I.placement;if(!A)switch(f){case"bestFit":{var k;const D=(k=N.filter(L=>{if(S){const R=Qo(L.placement);return R===w||R==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(R=>R>0).reduce((R,B)=>R+B,0)]).sort((L,R)=>L[1]-R[1])[0])==null?void 0:k[0];D&&(A=D);break}case"initialPlacement":A=s;break}if(a!==A)return{reset:{placement:A}}}return{}}}};function Ck(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Nk(e){return BG.some(t=>e[t]>=0)}const QG=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=Ya(e,t);switch(r){case"referenceHidden":{const o=await ou(t,{...a,elementContext:"reference"}),i=Ck(o,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Nk(i)}}}case"escaped":{const o=await ou(t,{...a,altBoundary:!0}),i=Ck(o,n.floating);return{data:{escapedOffsets:i,escaped:Nk(i)}}}default:return{}}}}};async function YG(e,t){const{placement:n,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),i=Ja(n),s=Fs(n),c=Qo(n)==="y",l=["left","top"].includes(i)?-1:1,u=o&&c?-1:1,d=Ya(t,e);let{mainAxis:p,crossAxis:f,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof y=="number"&&(f=s==="end"?y*-1:y),c?{x:f*u,y:p*l}:{x:p*l,y:f*u}}const JG=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:o,placement:i,middlewareData:s}=t,c=await YG(t,e);return i===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:a+c.x,y:o+c.y,data:{...c,placement:i}}}}},eQ=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:s={fn:v=>{let{x:b,y:w}=v;return{x:b,y:w}}},...c}=Ya(e,t),l={x:n,y:r},u=await ou(t,c),d=Qo(Ja(a)),p=x0(d);let f=l[p],y=l[d];if(o){const v=p==="y"?"top":"left",b=p==="y"?"bottom":"right",w=f+u[v],j=f-u[b];f=w0(w,f,j)}if(i){const v=d==="y"?"top":"left",b=d==="y"?"bottom":"right",w=y+u[v],j=y-u[b];y=w0(w,y,j)}const m=s.fn({...t,[p]:f,[d]:y});return{...m,data:{x:m.x-n,y:m.y-r}}}}},tQ=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:o,middlewareData:i}=t,{offset:s=0,mainAxis:c=!0,crossAxis:l=!0}=Ya(e,t),u={x:n,y:r},d=Qo(a),p=x0(d);let f=u[p],y=u[d];const m=Ya(s,t),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(c){const j=p==="y"?"height":"width",x=o.reference[p]-o.floating[j]+v.mainAxis,_=o.reference[p]+o.reference[j]-v.mainAxis;f<x?f=x:f>_&&(f=_)}if(l){var b,w;const j=p==="y"?"width":"height",x=["top","left"].includes(Ja(a)),_=o.reference[d]-o.floating[j]+(x&&((b=i.offset)==null?void 0:b[d])||0)+(x?0:v.crossAxis),S=o.reference[d]+o.reference[j]+(x?0:((w=i.offset)==null?void 0:w[d])||0)-(x?v.crossAxis:0);y<_?y=_:y>S&&(y=S)}return{[p]:f,[d]:y}}}},nQ=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:a,elements:o}=t,{apply:i=()=>{},...s}=Ya(e,t),c=await ou(t,s),l=Ja(n),u=Fs(n),d=Qo(n)==="y",{width:p,height:f}=r.floating;let y,m;l==="top"||l==="bottom"?(y=l,m=u===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(m=l,y=u==="end"?"top":"bottom");const v=f-c.top-c.bottom,b=p-c.left-c.right,w=ga(f-c[y],v),j=ga(p-c[m],b),x=!t.middlewareData.shift;let _=w,S=j;if(d?S=u||x?ga(j,b):b:_=u||x?ga(w,v):v,x&&!u){const O=or(c.left,0),M=or(c.right,0),N=or(c.top,0),P=or(c.bottom,0);d?S=p-2*(O!==0||M!==0?O+M:or(c.left,c.right)):_=f-2*(N!==0||P!==0?N+P:or(c.top,c.bottom))}await i({...t,availableWidth:S,availableHeight:_});const E=await a.getDimensions(o.floating);return p!==E.width||f!==E.height?{reset:{rects:!0}}:{}}}};function Bs(e){return Mk(e)?(e.nodeName||"").toLowerCase():"#document"}function ir(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function eo(e){var t;return(t=(Mk(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Mk(e){return e instanceof Node||e instanceof ir(e).Node}function $r(e){return e instanceof Element||e instanceof ir(e).Element}function va(e){return e instanceof HTMLElement||e instanceof ir(e).HTMLElement}function Pk(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ir(e).ShadowRoot}function iu(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Fr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function rQ(e){return["table","td","th"].includes(Bs(e))}function Sf(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function E0(e){const t=O0(),n=$r(e)?Fr(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function aQ(e){let t=Yo(e);for(;va(t)&&!zs(t);){if(E0(t))return t;if(Sf(t))return null;t=Yo(t)}return null}function O0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function zs(e){return["html","body","#document"].includes(Bs(e))}function Fr(e){return ir(e).getComputedStyle(e)}function Ef(e){return $r(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Yo(e){if(Bs(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Pk(e)&&e.host||eo(e);return Pk(t)?t.host:t}function kk(e){const t=Yo(e);return zs(t)?e.ownerDocument?e.ownerDocument.body:e.body:va(t)&&iu(t)?t:kk(t)}function su(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=kk(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),i=ir(a);if(o){const s=C0(i);return t.concat(i,i.visualViewport||[],iu(a)?a:[],s&&n?su(s):[])}return t.concat(a,su(a,[],n))}function C0(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Ak(e){const t=Fr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=va(e),o=a?e.offsetWidth:n,i=a?e.offsetHeight:r,s=wf(n)!==o||wf(r)!==i;return s&&(n=o,r=i),{width:n,height:r,$:s}}function N0(e){return $r(e)?e:e.contextElement}function Vs(e){const t=N0(e);if(!va(t))return Go(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=Ak(t);let i=(o?wf(n.width):n.width)/r,s=(o?wf(n.height):n.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const oQ=Go(0);function Tk(e){const t=ir(e);return!O0()||!t.visualViewport?oQ:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function iQ(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ir(e)?!1:t}function Fi(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=N0(e);let i=Go(1);t&&(r?$r(r)&&(i=Vs(r)):i=Vs(e));const s=iQ(o,n,r)?Tk(o):Go(0);let c=(a.left+s.x)/i.x,l=(a.top+s.y)/i.y,u=a.width/i.x,d=a.height/i.y;if(o){const p=ir(o),f=r&&$r(r)?ir(r):r;let y=p,m=C0(y);for(;m&&r&&f!==y;){const v=Vs(m),b=m.getBoundingClientRect(),w=Fr(m),j=b.left+(m.clientLeft+parseFloat(w.paddingLeft))*v.x,x=b.top+(m.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,l*=v.y,u*=v.x,d*=v.y,c+=j,l+=x,y=ir(m),m=C0(y)}}return jf({width:u,height:d,x:c,y:l})}function sQ(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const o=a==="fixed",i=eo(r),s=t?Sf(t.floating):!1;if(r===i||s&&o)return n;let c={scrollLeft:0,scrollTop:0},l=Go(1);const u=Go(0),d=va(r);if((d||!d&&!o)&&((Bs(r)!=="body"||iu(i))&&(c=Ef(r)),va(r))){const p=Fi(r);l=Vs(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function cQ(e){return Array.from(e.getClientRects())}function Ik(e){return Fi(eo(e)).left+Ef(e).scrollLeft}function lQ(e){const t=eo(e),n=Ef(e),r=e.ownerDocument.body,a=or(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=or(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+Ik(e);const s=-n.scrollTop;return Fr(r).direction==="rtl"&&(i+=or(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:i,y:s}}function uQ(e,t){const n=ir(e),r=eo(e),a=n.visualViewport;let o=r.clientWidth,i=r.clientHeight,s=0,c=0;if(a){o=a.width,i=a.height;const l=O0();(!l||l&&t==="fixed")&&(s=a.offsetLeft,c=a.offsetTop)}return{width:o,height:i,x:s,y:c}}function dQ(e,t){const n=Fi(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,o=va(e)?Vs(e):Go(1),i=e.clientWidth*o.x,s=e.clientHeight*o.y,c=a*o.x,l=r*o.y;return{width:i,height:s,x:c,y:l}}function Rk(e,t,n){let r;if(t==="viewport")r=uQ(e,n);else if(t==="document")r=lQ(eo(e));else if($r(t))r=dQ(t,n);else{const a=Tk(e);r={...t,x:t.x-a.x,y:t.y-a.y}}return jf(r)}function Dk(e,t){const n=Yo(e);return n===t||!$r(n)||zs(n)?!1:Fr(n).position==="fixed"||Dk(n,t)}function pQ(e,t){const n=t.get(e);if(n)return n;let r=su(e,[],!1).filter(s=>$r(s)&&Bs(s)!=="body"),a=null;const o=Fr(e).position==="fixed";let i=o?Yo(e):e;for(;$r(i)&&!zs(i);){const s=Fr(i),c=E0(i);!c&&s.position==="fixed"&&(a=null),(o?!c&&!a:!c&&s.position==="static"&&a&&["absolute","fixed"].includes(a.position)||iu(i)&&!c&&Dk(e,i))?r=r.filter(l=>l!==i):a=s,i=Yo(i)}return t.set(e,r),r}function fQ(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const o=[...n==="clippingAncestors"?Sf(t)?[]:pQ(t,this._c):[].concat(n),r],i=o[0],s=o.reduce((c,l)=>{const u=Rk(t,l,a);return c.top=or(u.top,c.top),c.right=ga(u.right,c.right),c.bottom=ga(u.bottom,c.bottom),c.left=or(u.left,c.left),c},Rk(t,i,a));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function hQ(e){const{width:t,height:n}=Ak(e);return{width:t,height:n}}function mQ(e,t,n){const r=va(t),a=eo(t),o=n==="fixed",i=Fi(e,!0,o,t);let s={scrollLeft:0,scrollTop:0};const c=Go(0);if(r||!r&&!o)if((Bs(t)!=="body"||iu(a))&&(s=Ef(t)),r){const d=Fi(t,!0,o,t);c.x=d.x+t.clientLeft,c.y=d.y+t.clientTop}else a&&(c.x=Ik(a));const l=i.left+s.scrollLeft-c.x,u=i.top+s.scrollTop-c.y;return{x:l,y:u,width:i.width,height:i.height}}function M0(e){return Fr(e).position==="static"}function Lk(e,t){return!va(e)||Fr(e).position==="fixed"?null:t?t(e):e.offsetParent}function $k(e,t){const n=ir(e);if(Sf(e))return n;if(!va(e)){let a=Yo(e);for(;a&&!zs(a);){if($r(a)&&!M0(a))return a;a=Yo(a)}return n}let r=Lk(e,t);for(;r&&rQ(r)&&M0(r);)r=Lk(r,t);return r&&zs(r)&&M0(r)&&!E0(r)?n:r||aQ(e)||n}const yQ=async function(e){const t=this.getOffsetParent||$k,n=this.getDimensions,r=await n(e.floating);return{reference:mQ(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function gQ(e){return Fr(e).direction==="rtl"}const vQ={convertOffsetParentRelativeRectToViewportRelativeRect:sQ,getDocumentElement:eo,getClippingRect:fQ,getOffsetParent:$k,getElementRects:yQ,getClientRects:cQ,getDimensions:hQ,getScale:Vs,isElement:$r,isRTL:gQ};function bQ(e,t){let n=null,r;const a=eo(e);function o(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),o();const{left:l,top:u,width:d,height:p}=e.getBoundingClientRect();if(s||t(),!d||!p)return;const f=xf(u),y=xf(a.clientWidth-(l+d)),m=xf(a.clientHeight-(u+p)),v=xf(l),b={rootMargin:-f+"px "+-y+"px "+-m+"px "+-v+"px",threshold:or(0,ga(1,c))||1};let w=!0;function j(x){const _=x[0].intersectionRatio;if(_!==c){if(!w)return i();_?i(!1,_):r=setTimeout(()=>{i(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(j,{...b,root:a.ownerDocument})}catch{n=new IntersectionObserver(j,b)}n.observe(e)}return i(!0),o}Dg=function(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=N0(e),u=a||o?[...l?su(l):[],...su(t)]:[];u.forEach(b=>{a&&b.addEventListener("scroll",n,{passive:!0}),o&&b.addEventListener("resize",n)});const d=l&&s?bQ(l,n):null;let p=-1,f=null;i&&(f=new ResizeObserver(b=>{let[w]=b;w&&w.target===l&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var j;(j=f)==null||j.observe(t)})),n()}),l&&!c&&f.observe(l),f.observe(t));let y,m=c?Fi(e):null;c&&v();function v(){const b=Fi(e);m&&(b.x!==m.x||b.y!==m.y||b.width!==m.width||b.height!==m.height)&&n(),m=b,y=requestAnimationFrame(v)}return n(),()=>{var b;u.forEach(w=>{a&&w.removeEventListener("scroll",n),o&&w.removeEventListener("resize",n)}),d==null||d(),(b=f)==null||b.disconnect(),f=null,c&&cancelAnimationFrame(y)}};let Fk;VN=JG,nM=eQ,UN=GG,aM=nQ,Fk=QG,Jg=ZG,rM=tQ,WN=(e,t,n)=>{const r=new Map,a={platform:vQ,...n},o={...a.platform,_c:r};return XG(e,t,{...a,platform:o})};var Of=typeof document<"u"?g.useLayoutEffect:g.useEffect;function Cf(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Cf(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Cf(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function Bk(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function zk(e,t){const n=Bk(e);return Math.round(t*n)/n}function Vk(e){const t=g.useRef(e);return Of(()=>{t.current=e}),t}Gg=function(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:i}={},transform:s=!0,whileElementsMounted:c,open:l}=e,[u,d]=g.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,f]=g.useState(r);Cf(p,r)||f(r);const[y,m]=g.useState(null),[v,b]=g.useState(null),w=g.useCallback(D=>{D!==S.current&&(S.current=D,m(D))},[]),j=g.useCallback(D=>{D!==E.current&&(E.current=D,b(D))},[]),x=o||y,_=i||v,S=g.useRef(null),E=g.useRef(null),O=g.useRef(u),M=c!=null,N=Vk(c),P=Vk(a),I=g.useCallback(()=>{if(!S.current||!E.current)return;const D={placement:t,strategy:n,middleware:p};P.current&&(D.platform=P.current),WN(S.current,E.current,D).then(L=>{const R={...L,isPositioned:!0};k.current&&!Cf(O.current,R)&&(O.current=R,Nl.flushSync(()=>{d(R)}))})},[p,t,n,P]);Of(()=>{l===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,d(D=>({...D,isPositioned:!1})))},[l]);const k=g.useRef(!1);Of(()=>(k.current=!0,()=>{k.current=!1}),[]),Of(()=>{if(x&&(S.current=x),_&&(E.current=_),x&&_){if(N.current)return N.current(x,_,I);I()}},[x,_,I,N,M]);const C=g.useMemo(()=>({reference:S,floating:E,setReference:w,setFloating:j}),[w,j]),T=g.useMemo(()=>({reference:x,floating:_}),[x,_]),A=g.useMemo(()=>{const D={position:n,left:0,top:0};if(!T.floating)return D;const L=zk(T.floating,u.x),R=zk(T.floating,u.y);return s?{...D,transform:"translate("+L+"px, "+R+"px)",...Bk(T.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:L,top:R}},[n,s,T.floating,u.x,u.y]);return g.useMemo(()=>({...u,update:I,refs:C,elements:T,floatingStyles:A}),[u,I,C,T,A])};let Uk;Uk=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Jg({element:r.current,padding:a}).fn(n):{}:r?Jg({element:r,padding:a}).fn(n):{}}}},$g=(e,t)=>({...VN(e),options:[e,t]}),lv=(e,t)=>({...nM(e),options:[e,t]}),uv=(e,t)=>({...rM(e),options:[e,t]}),dv=(e,t)=>({...UN(e),options:[e,t]}),pv=(e,t)=>({...aM(e),options:[e,t]}),hv=(e,t)=>({...Fk(e),options:[e,t]}),fv=(e,t)=>({...Uk(e),options:[e,t]});var wQ="Arrow",Wk=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Ae.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});Wk.displayName=wQ;var xQ=Wk;function _Q(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:p,children:f,...y}=d,m=(p==null?void 0:p[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:f})}function u(d,p){const f=(p==null?void 0:p[e][c])||s,y=g.useContext(f);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,jQ(a,...t)]}function jQ(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}Up=function(e){const[t,n]=g.useState(void 0);return tn(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let i,s;if("borderBoxSize"in o){const c=o.borderBoxSize,l=Array.isArray(c)?c[0]:c;i=l.inlineSize,s=l.blockSize}else i=e.offsetWidth,s=e.offsetHeight;n({width:i,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t};var P0="Popper",[Hk,Us]=_Q(P0),[SQ,qk]=Hk(P0),Kk=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(SQ,{scope:t,anchor:r,onAnchorChange:a,children:n})};Kk.displayName=P0;var Xk="PopperAnchor",Zk=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=qk(Xk,n),i=g.useRef(null),s=wt(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Ae.div,{...a,ref:s})});Zk.displayName=Xk;var k0="PopperContent",[EQ,OQ]=Hk(k0),Gk=g.forwardRef((e,t)=>{var Q,q,H,X,te,F;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:y,...m}=e,v=qk(k0,n),[b,w]=g.useState(null),j=wt(t,se=>w(se)),[x,_]=g.useState(null),S=Up(x),E=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,M=r+(o!=="center"?"-"+o:""),N=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(l)?l:[l],I=P.length>0,k={padding:N,boundary:P.filter(NQ),altBoundary:I},{refs:C,floatingStyles:T,placement:A,isPositioned:D,middlewareData:L}=Gg({strategy:"fixed",placement:M,whileElementsMounted:(...se)=>Dg(...se,{animationFrame:f==="always"}),elements:{reference:v.anchor},middleware:[$g({mainAxis:a+O,alignmentAxis:i}),c&&lv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?uv():void 0,...k}),c&&dv({...k}),pv({...k,apply:({elements:se,rects:re,availableWidth:le,availableHeight:je})=>{const{width:Le,height:$e}=re.reference,Se=se.floating.style;Se.setProperty("--radix-popper-available-width",`${le}px`),Se.setProperty("--radix-popper-available-height",`${je}px`),Se.setProperty("--radix-popper-anchor-width",`${Le}px`),Se.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&fv({element:x,padding:s}),MQ({arrowWidth:E,arrowHeight:O}),p&&hv({strategy:"referenceHidden",...k})]}),[R,B]=Jk(A),z=tr(y);tn(()=>{D&&(z==null||z())},[D,z]);const $=(Q=L.arrow)==null?void 0:Q.x,V=(q=L.arrow)==null?void 0:q.y,Y=((H=L.arrow)==null?void 0:H.centerOffset)!==0,[G,K]=g.useState();return tn(()=>{b&&K(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:D?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:G,"--radix-popper-transform-origin":[(X=L.transformOrigin)==null?void 0:X.x,(te=L.transformOrigin)==null?void 0:te.y].join(" "),...((F=L.hide)==null?void 0:F.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(EQ,{scope:n,placedSide:R,onArrowChange:_,arrowX:$,arrowY:V,shouldHideArrow:Y,children:h.jsx(Ae.div,{"data-side":R,"data-align":B,...m,ref:j,style:{...m.style,animation:D?void 0:"none"}})})})});Gk.displayName=k0;var Qk="PopperArrow",CQ={top:"bottom",right:"left",bottom:"top",left:"right"},Yk=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=OQ(Qk,n),o=CQ[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(xQ,{...r,ref:t,style:{...r.style,display:"block"}})})});Yk.displayName=Qk;function NQ(e){return e!==null}var MQ=e=>({name:"transformOrigin",options:e,fn(t){var m,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((m=a.arrow)==null?void 0:m.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=Jk(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,p=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let f="",y="";return c==="bottom"?(f=o?u:`${d}px`,y=`${-s}px`):c==="top"?(f=o?u:`${d}px`,y=`${r.floating.height+s}px`):c==="right"?(f=`${-s}px`,y=o?u:`${p}px`):c==="left"&&(f=`${r.floating.width+s}px`,y=o?u:`${p}px`),{data:{x:f,y}}}});function Jk(e){const[t,n="center"]=e.split("-");return[t,n]}var Nf=Kk,A0=Zk,T0=Gk,I0=Yk,[Mf,i2e]=er("Tooltip",[Us]),Pf=Us(),eA="TooltipProvider",PQ=700,R0="tooltip.open",[kQ,D0]=Mf(eA),tA=e=>{const{__scopeTooltip:t,delayDuration:n=PQ,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:o}=e,[i,s]=g.useState(!0),c=g.useRef(!1),l=g.useRef(0);return g.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),h.jsx(kQ,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(l.current),s(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:g.useCallback(u=>{c.current=u},[]),disableHoverableContent:a,children:o})};tA.displayName=eA;var kf="Tooltip",[AQ,cu]=Mf(kf),nA=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a=!1,onOpenChange:o,disableHoverableContent:i,delayDuration:s}=e,c=D0(kf,e.__scopeTooltip),l=Pf(t),[u,d]=g.useState(null),p=Pt(),f=g.useRef(0),y=i??c.disableHoverableContent,m=s??c.delayDuration,v=g.useRef(!1),[b=!1,w]=Sn({prop:r,defaultProp:a,onChange:E=>{E?(c.onOpen(),document.dispatchEvent(new CustomEvent(R0))):c.onClose(),o==null||o(E)}}),j=g.useMemo(()=>b?v.current?"delayed-open":"instant-open":"closed",[b]),x=g.useCallback(()=>{window.clearTimeout(f.current),f.current=0,v.current=!1,w(!0)},[w]),_=g.useCallback(()=>{window.clearTimeout(f.current),f.current=0,w(!1)},[w]),S=g.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{v.current=!0,w(!0),f.current=0},m)},[m,w]);return g.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),h.jsx(Nf,{...l,children:h.jsx(AQ,{scope:t,contentId:p,open:b,stateAttribute:j,trigger:u,onTriggerChange:d,onTriggerEnter:g.useCallback(()=>{c.isOpenDelayed?S():x()},[c.isOpenDelayed,S,x]),onTriggerLeave:g.useCallback(()=>{y?_():(window.clearTimeout(f.current),f.current=0)},[_,y]),onOpen:x,onClose:_,disableHoverableContent:y,children:n})})};nA.displayName=kf;var L0="TooltipTrigger",rA=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=cu(L0,n),o=D0(L0,n),i=Pf(n),s=g.useRef(null),c=wt(t,s,a.onTriggerChange),l=g.useRef(!1),u=g.useRef(!1),d=g.useCallback(()=>l.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),h.jsx(A0,{asChild:!0,...i,children:h.jsx(Ae.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:c,onPointerMove:ge(e.onPointerMove,p=>{p.pointerType!=="touch"&&!u.current&&!o.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:ge(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:ge(e.onPointerDown,()=>{l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ge(e.onFocus,()=>{l.current||a.onOpen()}),onBlur:ge(e.onBlur,a.onClose),onClick:ge(e.onClick,a.onClose)})})});rA.displayName=L0;var $0="TooltipPortal",[TQ,IQ]=Mf($0,{forceMount:void 0}),aA=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:a}=e,o=cu($0,t);return h.jsx(TQ,{scope:t,forceMount:n,children:h.jsx(Mr,{present:n||o.open,children:h.jsx(Ng,{asChild:!0,container:a,children:r})})})};aA.displayName=$0;var Ws="TooltipContent",oA=g.forwardRef((e,t)=>{const n=IQ(Ws,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...o}=e,i=cu(Ws,e.__scopeTooltip);return h.jsx(Mr,{present:r||i.open,children:i.disableHoverableContent?h.jsx(iA,{side:a,...o,ref:t}):h.jsx(RQ,{side:a,...o,ref:t})})}),RQ=g.forwardRef((e,t)=>{const n=cu(Ws,e.__scopeTooltip),r=D0(Ws,e.__scopeTooltip),a=g.useRef(null),o=wt(t,a),[i,s]=g.useState(null),{trigger:c,onClose:l}=n,u=a.current,{onPointerInTransitChange:d}=r,p=g.useCallback(()=>{s(null),d(!1)},[d]),f=g.useCallback((y,m)=>{const v=y.currentTarget,b={x:y.clientX,y:y.clientY},w=FQ(b,v.getBoundingClientRect()),j=BQ(b,w),x=zQ(m.getBoundingClientRect()),_=UQ([...j,...x]);s(_),d(!0)},[d]);return g.useEffect(()=>()=>p(),[p]),g.useEffect(()=>{if(c&&u){const y=v=>f(v,u),m=v=>f(v,c);return c.addEventListener("pointerleave",y),u.addEventListener("pointerleave",m),()=>{c.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",m)}}},[c,u,f,p]),g.useEffect(()=>{if(i){const y=m=>{const v=m.target,b={x:m.clientX,y:m.clientY},w=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),j=!VQ(b,i);w?p():j&&(p(),l())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[c,u,i,l,p]),h.jsx(iA,{...e,ref:o})}),[DQ,LQ]=Mf(kf,{isInside:!1}),iA=g.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:o,onPointerDownOutside:i,...s}=e,c=cu(Ws,n),l=Pf(n),{onClose:u}=c;return g.useEffect(()=>(document.addEventListener(R0,u),()=>document.removeEventListener(R0,u)),[u]),g.useEffect(()=>{if(c.trigger){const d=p=>{var f;(f=p.target)!=null&&f.contains(c.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[c.trigger,u]),h.jsx(Cg,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:h.jsxs(T0,{"data-state":c.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[h.jsx(iK,{children:r}),h.jsx(DQ,{scope:n,isInside:!0,children:h.jsx(mAe,{id:c.contentId,role:"tooltip",children:a||r})})]})})});oA.displayName=Ws;var sA="TooltipArrow",$Q=g.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=Pf(n);return LQ(sA,n).isInside?null:h.jsx(I0,{...a,...r,ref:t})});$Q.displayName=sA;function FQ(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(n,r,a,o)){case o:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function BQ(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function zQ(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function VQ(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function UQ(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),WQ(t)}function WQ(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const o=n[n.length-1],i=n[n.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}HN=tA,qN=nA,KN=rA,EK=aA,Bg=oA;const lu=HN,ba=qN,wa=KN,Br=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(Bg,{ref:r,sideOffset:t,className:Z("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));Br.displayName=Bg.displayName;const HQ="sidebar:state",qQ=60*60*24*7,KQ="16rem",XQ="18rem",ZQ="3rem",GQ="b",cA=g.createContext(null);function uu(){const e=g.useContext(cA);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const F0=g.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:a,children:o,...i},s)=>{const c=QZ(),[l,u]=g.useState(!1),[d,p]=g.useState(e),f=t??d,y=g.useCallback(w=>{const j=typeof w=="function"?w(f):w;n?n(j):p(j),document.cookie=`${HQ}=${j}; path=/; max-age=${qQ}`},[n,f]),m=g.useCallback(()=>c?u(w=>!w):y(w=>!w),[c,y,u]);g.useEffect(()=>{const w=j=>{j.key===GQ&&(j.metaKey||j.ctrlKey)&&(j.preventDefault(),m())};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[m]);const v=f?"expanded":"collapsed",b=g.useMemo(()=>({state:v,open:f,setOpen:y,isMobile:c,openMobile:l,setOpenMobile:u,toggleSidebar:m}),[v,f,y,c,l,u,m]);return h.jsx(cA.Provider,{value:b,children:h.jsx(lu,{delayDuration:0,children:h.jsx("div",{style:{"--sidebar-width":KQ,"--sidebar-width-icon":ZQ,...a},className:Z("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:s,...i,children:o})})})});F0.displayName="SidebarProvider";const B0=g.forwardRef(({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:r,children:a,...o},i)=>{const{isMobile:s,state:c,openMobile:l,setOpenMobile:u}=uu();return n==="none"?h.jsx("div",{className:Z("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:i,...o,children:a}):s?h.jsx(RG,{open:l,onOpenChange:u,...o,children:h.jsx(jk,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":XQ},side:e,children:h.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):h.jsxs("div",{ref:i,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?n:"","data-variant":t,"data-side":e,children:[h.jsx("div",{className:Z("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),h.jsx("div",{className:Z("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...o,children:h.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});B0.displayName="Sidebar";const lA=g.forwardRef(({className:e,onClick:t,...n},r)=>{const{toggleSidebar:a}=uu();return h.jsx(ut,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Z("h-7 w-7",e),onClick:o=>{t==null||t(o),a()},...n,children:h.jsx(de,{size:32,name:"panel-left"})})});lA.displayName="SidebarTrigger";const uA=g.forwardRef(({className:e,...t},n)=>{const{toggleSidebar:r}=uu();return h.jsx("button",{ref:n,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:Z("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});uA.displayName="SidebarRail";const z0=g.forwardRef(({className:e,...t},n)=>h.jsx("main",{ref:n,className:Z("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));z0.displayName="SidebarInset";const QQ=g.forwardRef(({className:e,...t},n)=>h.jsx(En,{ref:n,"data-sidebar":"input",className:Z("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));QQ.displayName="SidebarInput";const YQ=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"header",className:Z("flex flex-col gap-2 p-2",e),...t}));YQ.displayName="SidebarHeader";const dA=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"footer",className:Z("flex flex-col gap-2 p-2",e),...t}));dA.displayName="SidebarFooter";const JQ=g.forwardRef(({className:e,...t},n)=>h.jsx(Ms,{ref:n,"data-sidebar":"separator",className:Z("mx-2 w-auto bg-sidebar-border",e),...t}));JQ.displayName="SidebarSeparator";const V0=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"content",className:Z("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));V0.displayName="SidebarContent";const du=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group",className:Z("relative flex w-full min-w-0 flex-col p-2",e),...t}));du.displayName="SidebarGroup";const pu=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?Vo:"div";return h.jsx(a,{ref:r,"data-sidebar":"group-label",className:Z("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...n})});pu.displayName="SidebarGroupLabel";const eY=g.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?Vo:"button";return h.jsx(a,{ref:r,"data-sidebar":"group-action",className:Z("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...n})});eY.displayName="SidebarGroupAction";const tY=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"group-content",className:Z("w-full text-sm",e),...t}));tY.displayName="SidebarGroupContent";const Hs=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu",className:Z("flex w-full min-w-0 flex-col gap-1",e),...t}));Hs.displayName="SidebarMenu";const to=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,"data-sidebar":"menu-item",className:Z("group/menu-item relative",e),...t}));to.displayName="SidebarMenuItem";const nY=Ha("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),no=g.forwardRef(({asChild:e=!1,isActive:t=!1,variant:n="default",size:r="default",tooltip:a,className:o,...i},s)=>{const c=e?Vo:"button",{isMobile:l,state:u}=uu(),d=h.jsx(c,{ref:s,"data-sidebar":"menu-button","data-size":r,"data-active":t,className:Z(nY({variant:n,size:r}),o),...i});return a?(typeof a=="string"&&(a={children:a}),h.jsxs(ba,{children:[h.jsx(wa,{asChild:!0,children:d}),h.jsx(Br,{side:"right",align:"center",hidden:u!=="collapsed"||l,...a})]})):d});no.displayName="SidebarMenuButton";const rY=g.forwardRef(({className:e,asChild:t=!1,showOnHover:n=!1,...r},a)=>{const o=t?Vo:"button";return h.jsx(o,{ref:a,"data-sidebar":"menu-action",className:Z("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})});rY.displayName="SidebarMenuAction";const aY=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,"data-sidebar":"menu-badge",className:Z("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));aY.displayName="SidebarMenuBadge";const oY=g.forwardRef(({className:e,showIcon:t=!1,...n},r)=>{const a=g.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return h.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:Z("rounded-md h-8 flex gap-2 px-2 items-center",e),...n,children:[t&&h.jsx(Sk,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),h.jsx(Sk,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});oY.displayName="SidebarMenuSkeleton";const pA=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,"data-sidebar":"menu-sub",className:Z("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));pA.displayName="SidebarMenuSub";const fA=g.forwardRef(({...e},t)=>h.jsx("li",{ref:t,...e}));fA.displayName="SidebarMenuSubItem";const hA=g.forwardRef(({asChild:e=!1,size:t="md",isActive:n,className:r,...a},o)=>{const i=e?Vo:"a";return h.jsx(i,{ref:o,"data-sidebar":"menu-sub-button","data-size":t,"data-active":n,className:Z("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...a})});hA.displayName="SidebarMenuSubButton";const iY="hash",Af={application:"/application/:applicationId?",whiteboard:"/whiteboard/:sessionId?",document:"/document/:documentId?"},gn=(e,t)=>{let n=Af[e];return t?n=Object.keys(t||{}).reduce((r,a)=>r.replace(`:${a}`,(t==null?void 0:t[a])||""),n):n=n.replace(/\/:[^/]+/g,""),n!=null&&n.endsWith("?")?n.slice(0,-1):n},sY=()=>{{const[,e]=window.location.hash.split("?");return new URLSearchParams(`?${e}`)}};function cY({items:e}){const{t}=Pe("documents");return h.jsxs(du,{children:[h.jsx(pu,{children:h.jsx("div",{className:"text-sm",children:t("title")})}),h.jsx(Hs,{children:e.map(n=>{var r;return h.jsx(XZ,{asChild:!0,defaultOpen:n.isActive,className:"group/collapsible",children:h.jsxs(to,{children:[h.jsx(ZZ,{asChild:!0,children:h.jsxs(no,{className:"cursor-pointer",tooltip:t(n.title),children:[n.icon,h.jsx("span",{children:t(n.title)}),h.jsx(de,{name:"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),h.jsx(GZ,{children:h.jsx(pA,{children:(r=n.items)==null?void 0:r.map(a=>h.jsx(fA,{className:"cursor-pointer",children:h.jsx(hA,{asChild:!0,children:h.jsx(Qv,{to:gn("document",{documentId:a.id}),children:h.jsx("span",{children:t(a.title)})})})},t(a.title)))})})]})},n.title)})})]})}const lY=g.memo(({text:e,colors:t={first:"#9E7AFF",second:"#FE8BBB"},className:n,sparklesCount:r=10,...a})=>{const[o,i]=g.useState([]);return g.useEffect(()=>{const s=()=>{const d=`${Math.random()*100}%`,p=`${Math.random()*100}%`,f=Math.random()>.5?t.first:t.second,y=Math.random()*2,m=Math.random()*1+.3,v=Math.random()*10+5;return{id:`${d}-${p}-${Date.now()}`,x:d,y:p,color:f,delay:y,scale:m,lifespan:v}},c=()=>{const d=Array.from({length:r},s);i(d)},l=()=>{i(d=>d.map(p=>p.lifespan<=0?s():{...p,lifespan:p.lifespan-.1}))};c();const u=setInterval(l,100);return()=>clearInterval(u)},[t.first,t.second]),h.jsx("div",{className:Z("text-6xl font-bold",n),...a,style:{"--sparkles-first-color":`${t.first}`,"--sparkles-second-color":`${t.second}`},children:h.jsxs("span",{className:"relative inline-block",children:[o.map(s=>h.jsx(uY,{...s},s.id)),h.jsx("strong",{children:e})]})})},(e,t)=>e.text===t.text),uY=({id:e,x:t,y:n,color:r,delay:a,scale:o})=>h.jsx(Rp.svg,{className:"pointer-events-none absolute z-20",initial:{opacity:0,left:t,top:n},animate:{opacity:[0,1,0],scale:[0,o,0],rotate:[75,120,150]},transition:{duration:.8,repeat:1/0,delay:a},width:"21",height:"21",viewBox:"0 0 21 21",children:h.jsx("path",{d:"M9.82531 0.843845C10.0553 0.215178 10.9446 0.215178 11.1746 0.843845L11.8618 2.72026C12.4006 4.19229 12.3916 6.39157 13.5 7.5C14.6084 8.60843 16.8077 8.59935 18.2797 9.13822L20.1561 9.82534C20.7858 10.0553 20.7858 10.9447 20.1561 11.1747L18.2797 11.8618C16.8077 12.4007 14.6084 12.3916 13.5 13.5C12.3916 14.6084 12.4006 16.8077 11.8618 18.2798L11.1746 20.1562C10.9446 20.7858 10.0553 20.7858 9.82531 20.1562L9.13819 18.2798C8.59932 16.8077 8.60843 14.6084 7.5 13.5C6.39157 12.3916 4.19225 12.4007 2.72023 11.8618L0.843814 11.1747C0.215148 10.9447 0.215148 10.0553 0.843814 9.82534L2.72023 9.13822C4.19225 8.59935 6.39157 8.60843 7.5 7.5C8.60843 6.39157 8.59932 4.19229 9.13819 2.72026L9.82531 0.843845Z",fill:r})},e);function dY({className:e,onClick:t}){const{t:n}=Pe("sidebar");return h.jsxs(no,{className:Z(e,"tw-w-full"),onClick:t,children:[h.jsx(de,{name:"frame"}),h.jsx(lY,{text:n("new_session"),className:"text-sm",sparklesCount:3})]})}const pY=()=>{const[e,t]=g.useState(!1),n=Je(i=>i.setCurrentSession),r=Je(i=>i.createSession),a=Ml(i=>i.setSelectedSessionId),o=g.useCallback(async i=>{try{t(!0);const s=await r(i);n(s),a(s.id)}finally{t(!1)}},[r,n,a]);return{loading:e,createSession:o}},Jo=$l,fY=Fl,mA=g.forwardRef(({className:e,...t},n)=>h.jsx(Mi,{ref:n,className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));mA.displayName=Mi.displayName;const ro=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(fY,{children:[h.jsx(mA,{}),h.jsxs(Pi,{ref:r,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,h.jsxs(Bl,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(de,{name:"x",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ro.displayName=Pi.displayName;const ao=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});ao.displayName="DialogHeader";const fu=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});fu.displayName="DialogFooter";const oo=g.forwardRef(({className:e,...t},n)=>h.jsx(Os,{ref:n,className:Z("text-lg font-semibold leading-none tracking-tight",e),...t}));oo.displayName=Os.displayName;const hu=g.forwardRef(({className:e,...t},n)=>h.jsx(Cs,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));hu.displayName=Cs.displayName;var hY="Label",yA=g.forwardRef((e,t)=>h.jsx(Ae.label,{...e,ref:t,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=e.onMouseDown)==null||r.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));yA.displayName=hY;var gA=yA;let vA;vA=Ha("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),nt=g.forwardRef(({className:e,...t},n)=>h.jsx(gA,{ref:n,className:Z(vA(),e),...t})),nt.displayName=gA.displayName;const mY=qa(()=>{const e=Wt(),{t}=Pe("dialogs"),[n,r]=g.useState(""),{toast:a}=Gt(),{loading:o,createSession:i}=pY(),s=l=>{r(l.target.value)},c=async()=>{try{await i({name:n}),r(""),e.hide()}catch{a({variant:"destructive",description:t("create_session.errors.create_failed")})}};return h.jsx(Jo,{open:e.visible,onOpenChange:e.hide,children:h.jsxs(ro,{className:"sm:max-w-[425px]",children:[h.jsxs(ao,{children:[h.jsx(oo,{children:t("create_session.title")}),h.jsx(hu,{children:t("create_session.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{className:"mb-2",htmlFor:"name",children:t("create_session.name")}),h.jsx(En,{onChange:s,id:"name",value:n,placeholder:t("create_session.name_placeholder")})]})}),h.jsx(fu,{children:h.jsx(ut,{onClick:c,disabled:o||!n,type:"submit",children:t("create_session.create")})})]})})}),yY=()=>{const[e,t]=g.useState(!1),n=Je(a=>a.deleteSession),r=g.useCallback(async a=>{try{t(!0),await n(a),await Promise.all([ue("FlowEdge").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>ue("FlowEdge").delete(i.id)))),ue("FlowNode").find({select:["id"],where:{session_id:a}}).then(o=>Promise.all(o.map(i=>ue("FlowNode").delete(i.id))))])}finally{t(!1)}},[n]);return{loading:e,deleteSession:r}};var bA="AlertDialog",[gY,s2e]=er(bA,[f0]),io=f0(),wA=e=>{const{__scopeAlertDialog:t,...n}=e,r=io(t);return h.jsx($l,{...r,...n,modal:!0})};wA.displayName=bA;var vY="AlertDialogTrigger",bY=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=io(n);return h.jsx(xk,{...a,...r,ref:t})});bY.displayName=vY;var wY="AlertDialogPortal",xA=e=>{const{__scopeAlertDialog:t,...n}=e,r=io(t);return h.jsx(Fl,{...r,...n})};xA.displayName=wY;var xY="AlertDialogOverlay",_A=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=io(n);return h.jsx(Mi,{...a,...r,ref:t})});_A.displayName=xY;var qs="AlertDialogContent",[_Y,jY]=gY(qs),jA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,o=io(n),i=g.useRef(null),s=wt(t,i),c=g.useRef(null);return h.jsx(gk,{contentName:qs,titleName:SA,docsSlug:"alert-dialog",children:h.jsx(_Y,{scope:n,cancelRef:c,children:h.jsxs(Pi,{role:"alertdialog",...o,...a,ref:s,onOpenAutoFocus:ge(a.onOpenAutoFocus,l=>{var u;l.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[h.jsx(iK,{children:r}),h.jsx(kA,{contentRef:i})]})})})});jA.displayName=qs;var SA="AlertDialogTitle",EA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=io(n);return h.jsx(Os,{...a,...r,ref:t})});EA.displayName=SA;var OA="AlertDialogDescription",CA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=io(n);return h.jsx(Cs,{...a,...r,ref:t})});CA.displayName=OA;var SY="AlertDialogAction",NA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=io(n);return h.jsx(Bl,{...a,...r,ref:t})});NA.displayName=SY;var MA="AlertDialogCancel",PA=g.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=jY(MA,n),o=io(n),i=wt(t,a);return h.jsx(Bl,{...o,...r,ref:i})});PA.displayName=MA;let kA;kA=({contentRef:e})=>{const t=`\`${qs}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${qs}\` by passing a \`${OA}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${qs}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return g.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},QN=wA,GN=xA,Wg=_A,Hg=jA,Xg=NA,Zg=PA,qg=EA,Kg=CA;const AA=QN,EY=GN,TA=g.forwardRef(({className:e,...t},n)=>h.jsx(Wg,{className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));TA.displayName=Wg.displayName;const U0=g.forwardRef(({className:e,...t},n)=>h.jsxs(EY,{children:[h.jsx(TA,{}),h.jsx(Hg,{ref:n,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));U0.displayName=Hg.displayName;const W0=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col space-y-2 text-center sm:text-left",e),...t});W0.displayName="AlertDialogHeader";const H0=({className:e,...t})=>h.jsx("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});H0.displayName="AlertDialogFooter";const q0=g.forwardRef(({className:e,...t},n)=>h.jsx(qg,{ref:n,className:Z("text-lg font-semibold",e),...t}));q0.displayName=qg.displayName;const K0=g.forwardRef(({className:e,...t},n)=>h.jsx(Kg,{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));K0.displayName=Kg.displayName;const X0=g.forwardRef(({className:e,...t},n)=>h.jsx(Xg,{ref:n,className:Z(nu(),e),...t}));X0.displayName=Xg.displayName;const Z0=g.forwardRef(({className:e,...t},n)=>h.jsx(Zg,{ref:n,className:Z(nu({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Z0.displayName=Zg.displayName;const IA=qa(({id:e})=>{const{t}=Pe("dialogs"),n=Wt(),{toast:r}=Gt(),{deleteSession:a,loading:o}=yY(),i=async()=>{try{await a(e),n.hide()}catch{r({variant:"destructive",description:t("delete_session.errors.delete_failed")})}};return h.jsx(AA,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(U0,{children:[h.jsxs(W0,{children:[h.jsx(q0,{children:t("delete_session.title")}),h.jsx(K0,{children:t("delete_session.description")})]}),h.jsxs(H0,{children:[h.jsx(Z0,{onClick:n.hide,children:t("delete_session.cancel")}),h.jsx(X0,{disabled:o,onClick:i,children:t("delete_session.delete")})]})]})})});function OY({sessions:e,currentSession:t,setCurrentSession:n}){const{t:r}=Pe("sidebar"),a=Ri(),o=Wt(mY),i=Wt(IA),s=g.useCallback(()=>{o.show({})},[o]),c=g.useCallback((u,d)=>{u.preventDefault(),u.stopPropagation(),i.show({id:d})},[i]),l=u=>{n(u),a(gn("whiteboard",{sessionId:u.id}))};return h.jsxs(du,{className:"group-data-[collapsible=icon]:hidden",children:[h.jsx(pu,{children:h.jsx("div",{className:"text-sm",children:r("sessions")})}),h.jsxs(Hs,{children:[h.jsx(to,{children:h.jsx(dY,{onClick:s,className:"w-full"})}),e.map(u=>h.jsx(to,{className:"cursor-pointer",children:h.jsx(no,{asChild:!0,onClick:()=>l(u),children:h.jsxs("div",{className:"flex flex-row justify-between items-center",children:[h.jsxs("div",{className:"flex gap-2",children:[(t==null?void 0:t.id)===u.id?h.jsx(de,{size:16,color:"green",name:"check"}):h.jsx(de,{size:16,name:"chevron-right"}),h.jsx("span",{children:u.name})]}),h.jsx(de,{onClick:d=>c(d,u.id),size:16,name:"trash-2",className:"!z-50"})]})})},u.id)),e!=null&&e.length?h.jsx(to,{children:h.jsxs(no,{className:"text-sidebar-foreground/70",children:[h.jsx(de,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}var CY=g.createContext(void 0);Wo=function(e){const t=g.useContext(CY);return e||t||"ltr"};function NY(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:p,children:f,...y}=d,m=(p==null?void 0:p[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:f})}function u(d,p){const f=(p==null?void 0:p[e][c])||s,y=g.useContext(f);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,MY(a,...t)]}function MY(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}let Tf,RA,mu,If,G0,DA,LA,$A,FA,Q0;Tf="rovingFocusGroup.onEntryFocus",RA={bubbles:!1,cancelable:!0},mu="RovingFocusGroup",[If,G0,DA]=Dp(mu),[LA,Xa]=NY(mu,[DA]),[$A,FA]=LA(mu),Q0=g.forwardRef((e,t)=>h.jsx(If.Provider,{scope:e.__scopeRovingFocusGroup,children:h.jsx(If.Slot,{scope:e.__scopeRovingFocusGroup,children:h.jsx(PY,{...e,ref:t})})})),Q0.displayName=mu;var PY=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=e,p=g.useRef(null),f=wt(t,p),y=Wo(o),[m=null,v]=Sn({prop:i,defaultProp:s,onChange:c}),[b,w]=g.useState(!1),j=tr(l),x=G0(n),_=g.useRef(!1),[S,E]=g.useState(0);return g.useEffect(()=>{const O=p.current;if(O)return O.addEventListener(Tf,j),()=>O.removeEventListener(Tf,j)},[j]),h.jsx($A,{scope:n,orientation:r,dir:y,loop:a,currentTabStopId:m,onItemFocus:g.useCallback(O=>v(O),[v]),onItemShiftTab:g.useCallback(()=>w(!0),[]),onFocusableItemAdd:g.useCallback(()=>E(O=>O+1),[]),onFocusableItemRemove:g.useCallback(()=>E(O=>O-1),[]),children:h.jsx(Ae.div,{tabIndex:b||S===0?-1:0,"data-orientation":r,...d,ref:f,style:{outline:"none",...e.style},onMouseDown:ge(e.onMouseDown,()=>{_.current=!0}),onFocus:ge(e.onFocus,O=>{const M=!_.current;if(O.target===O.currentTarget&&M&&!b){const N=new CustomEvent(Tf,RA);if(O.currentTarget.dispatchEvent(N),!N.defaultPrevented){const P=x().filter(T=>T.focusable),I=P.find(T=>T.active),k=P.find(T=>T.id===m),C=[I,k,...P].filter(Boolean).map(T=>T.ref.current);VA(C,u)}}_.current=!1}),onBlur:ge(e.onBlur,()=>w(!1))})})}),BA="RovingFocusGroupItem",zA=g.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,...i}=e,s=Pt(),c=o||s,l=FA(BA,n),u=l.currentTabStopId===c,d=G0(n),{onFocusableItemAdd:p,onFocusableItemRemove:f}=l;return g.useEffect(()=>{if(r)return p(),()=>f()},[r,p,f]),h.jsx(If.ItemSlot,{scope:n,id:c,focusable:r,active:a,children:h.jsx(Ae.span,{tabIndex:u?0:-1,"data-orientation":l.orientation,...i,ref:t,onMouseDown:ge(e.onMouseDown,y=>{r?l.onItemFocus(c):y.preventDefault()}),onFocus:ge(e.onFocus,()=>l.onItemFocus(c)),onKeyDown:ge(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){l.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const m=TY(y,l.orientation,l.dir);if(m!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let v=d().filter(b=>b.focusable).map(b=>b.ref.current);if(m==="last")v.reverse();else if(m==="prev"||m==="next"){m==="prev"&&v.reverse();const b=v.indexOf(y.currentTarget);v=l.loop?IY(v,b+1):v.slice(b+1)}setTimeout(()=>VA(v))}})})})});zA.displayName=BA;var kY={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function AY(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function TY(e,t,n){const r=AY(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return kY[r]}function VA(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function IY(e,t){return e.map((n,r)=>e[(t+r)%e.length])}let Rf,UA,Y0,WA,HA,qA,Ks,Xs,KA,XA,ei,Df,Zs,J0,eb,so,ZA,Gs,tb;zl=Q0,Vl=zA,Rf=["Enter"," "],UA=["ArrowDown","PageUp","Home"],Y0=["ArrowUp","PageDown","End"],WA=[...UA,...Y0],HA={ltr:[...Rf,"ArrowRight"],rtl:[...Rf,"ArrowLeft"]},qA={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ks="Menu",[Xs,KA,XA]=Dp(Ks),[ei,Df]=er(Ks,[XA,Us,Xa]),Zs=Us(),J0=Xa(),[eb,so]=ei(Ks),[ZA,Gs]=ei(Ks),tb=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:o,modal:i=!0}=e,s=Zs(t),[c,l]=g.useState(null),u=g.useRef(!1),d=tr(o),p=Wo(a);return g.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),h.jsx(Nf,{...s,children:h.jsx(eb,{scope:t,open:n,onOpenChange:d,content:c,onContentChange:l,children:h.jsx(ZA,{scope:t,onClose:g.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:p,modal:i,children:r})})})},tb.displayName=Ks;var RY="MenuAnchor",nb=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=Zs(n);return h.jsx(A0,{...a,...r,ref:t})});nb.displayName=RY;var rb="MenuPortal",[DY,GA]=ei(rb,{forceMount:void 0}),QA=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,o=so(rb,t);return h.jsx(DY,{scope:t,forceMount:n,children:h.jsx(Mr,{present:n||o.open,children:h.jsx(Ng,{asChild:!0,container:a,children:r})})})};QA.displayName=rb;var br="MenuContent",[LY,ab]=ei(br),YA=g.forwardRef((e,t)=>{const n=GA(br,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=so(br,e.__scopeMenu),i=Gs(br,e.__scopeMenu);return h.jsx(Xs.Provider,{scope:e.__scopeMenu,children:h.jsx(Mr,{present:r||o.open,children:h.jsx(Xs.Slot,{scope:e.__scopeMenu,children:i.modal?h.jsx($Y,{...a,ref:t}):h.jsx(FY,{...a,ref:t})})})})}),$Y=g.forwardRef((e,t)=>{const n=so(br,e.__scopeMenu),r=g.useRef(null),a=wt(t,r);return g.useEffect(()=>{const o=r.current;if(o)return Wl(o)},[]),h.jsx(ob,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ge(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),FY=g.forwardRef((e,t)=>{const n=so(br,e.__scopeMenu);return h.jsx(ob,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),ob=g.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:p,onDismiss:f,disableOutsideScroll:y,...m}=e,v=so(br,n),b=Gs(br,n),w=Zs(n),j=J0(n),x=KA(n),[_,S]=g.useState(null),E=g.useRef(null),O=wt(t,E,v.onContentChange),M=g.useRef(0),N=g.useRef(""),P=g.useRef(0),I=g.useRef(null),k=g.useRef("right"),C=g.useRef(0),T=y?yf:g.Fragment,A=y?{as:Vo,allowPinchZoom:!0}:void 0,D=R=>{var Q,q;const B=N.current+R,z=x().filter(H=>!H.disabled),$=document.activeElement,V=(Q=z.find(H=>H.ref.current===$))==null?void 0:Q.textValue,Y=z.map(H=>H.textValue),G=QY(Y,B,V),K=(q=z.find(H=>H.textValue===G))==null?void 0:q.ref.current;(function H(X){N.current=X,window.clearTimeout(M.current),X!==""&&(M.current=window.setTimeout(()=>H(""),1e3))})(B),K&&setTimeout(()=>K.focus())};g.useEffect(()=>()=>window.clearTimeout(M.current),[]),Hl();const L=g.useCallback(R=>{var B,z;return k.current===((B=I.current)==null?void 0:B.side)&&JY(R,(z=I.current)==null?void 0:z.area)},[]);return h.jsx(LY,{scope:n,searchRef:N,onItemEnter:g.useCallback(R=>{L(R)&&R.preventDefault()},[L]),onItemLeave:g.useCallback(R=>{var B;L(R)||((B=E.current)==null||B.focus(),S(null))},[L]),onTriggerLeave:g.useCallback(R=>{L(R)&&R.preventDefault()},[L]),pointerGraceTimerRef:P,onPointerGraceIntentChange:g.useCallback(R=>{I.current=R},[]),children:h.jsx(T,{...A,children:h.jsx(cf,{asChild:!0,trapped:a,onMountAutoFocus:ge(o,R=>{var B;R.preventDefault(),(B=E.current)==null||B.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:h.jsx(Cg,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:p,onDismiss:f,children:h.jsx(zl,{asChild:!0,...j,dir:b.dir,orientation:"vertical",loop:r,currentTabStopId:_,onCurrentTabStopIdChange:S,onEntryFocus:ge(c,R=>{b.isUsingKeyboardRef.current||R.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(T0,{role:"menu","aria-orientation":"vertical","data-state":y2(v.open),"data-radix-menu-content":"",dir:b.dir,...w,...m,ref:O,style:{outline:"none",...m.style},onKeyDown:ge(m.onKeyDown,R=>{const B=R.target.closest("[data-radix-menu-content]")===R.currentTarget,z=R.ctrlKey||R.altKey||R.metaKey,$=R.key.length===1;B&&(R.key==="Tab"&&R.preventDefault(),!z&&$&&D(R.key));const V=E.current;if(R.target!==V||!WA.includes(R.key))return;R.preventDefault();const Y=x().filter(G=>!G.disabled).map(G=>G.ref.current);Y0.includes(R.key)&&Y.reverse(),ZY(Y)}),onBlur:ge(e.onBlur,R=>{R.currentTarget.contains(R.target)||(window.clearTimeout(M.current),N.current="")}),onPointerMove:ge(e.onPointerMove,gu(R=>{const B=R.target,z=C.current!==R.clientX;if(R.currentTarget.contains(B)&&z){const $=R.clientX>C.current?"right":"left";k.current=$,C.current=R.clientX}}))})})})})})})});YA.displayName=br;var BY="MenuGroup",ib=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{role:"group",...r,ref:t})});ib.displayName=BY;var zY="MenuLabel",JA=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{...r,ref:t})});JA.displayName=zY;var Lf="MenuItem",e2="menu.itemSelect",$f=g.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,o=g.useRef(null),i=Gs(Lf,e.__scopeMenu),s=ab(Lf,e.__scopeMenu),c=wt(t,o),l=g.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const p=new CustomEvent(e2,{bubbles:!0,cancelable:!0});d.addEventListener(e2,f=>r==null?void 0:r(f),{once:!0}),yAe(d,p),p.defaultPrevented?l.current=!1:i.onClose()}};return h.jsx(t2,{...a,ref:c,disabled:n,onClick:ge(e.onClick,u),onPointerDown:d=>{var p;(p=e.onPointerDown)==null||p.call(e,d),l.current=!0},onPointerUp:ge(e.onPointerUp,d=>{var p;l.current||((p=d.currentTarget)==null||p.click())}),onKeyDown:ge(e.onKeyDown,d=>{const p=s.searchRef.current!=="";n||p&&d.key===" "||Rf.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});$f.displayName=Lf;var t2=g.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...o}=e,i=ab(Lf,n),s=J0(n),c=g.useRef(null),l=wt(t,c),[u,d]=g.useState(!1),[p,f]=g.useState("");return g.useEffect(()=>{const y=c.current;y&&f((y.textContent??"").trim())},[o.children]),h.jsx(Xs.ItemSlot,{scope:n,disabled:r,textValue:a??p,children:h.jsx(Vl,{asChild:!0,...s,focusable:!r,children:h.jsx(Ae.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:l,onPointerMove:ge(e.onPointerMove,gu(y=>{r?i.onItemLeave(y):(i.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ge(e.onPointerLeave,gu(y=>i.onItemLeave(y))),onFocus:ge(e.onFocus,()=>d(!0)),onBlur:ge(e.onBlur,()=>d(!1))})})})}),VY="MenuCheckboxItem",n2=g.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return h.jsx(s2,{scope:e.__scopeMenu,checked:n,children:h.jsx($f,{role:"menuitemcheckbox","aria-checked":Ff(n)?"mixed":n,...a,ref:t,"data-state":lb(n),onSelect:ge(a.onSelect,()=>r==null?void 0:r(Ff(n)?!0:!n),{checkForDefaultPrevented:!1})})})});n2.displayName=VY;var r2="MenuRadioGroup",[UY,WY]=ei(r2,{value:void 0,onValueChange:()=>{}}),a2=g.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,o=tr(r);return h.jsx(UY,{scope:e.__scopeMenu,value:n,onValueChange:o,children:h.jsx(ib,{...a,ref:t})})});a2.displayName=r2;var o2="MenuRadioItem",i2=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=WY(o2,e.__scopeMenu),o=n===a.value;return h.jsx(s2,{scope:e.__scopeMenu,checked:o,children:h.jsx($f,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":lb(o),onSelect:ge(r.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,n)},{checkForDefaultPrevented:!1})})})});i2.displayName=o2;var sb="MenuItemIndicator",[s2,HY]=ei(sb,{checked:!1}),c2=g.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,o=HY(sb,n);return h.jsx(Mr,{present:r||Ff(o.checked)||o.checked===!0,children:h.jsx(Ae.span,{...a,ref:t,"data-state":lb(o.checked)})})});c2.displayName=sb;var qY="MenuSeparator",l2=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return h.jsx(Ae.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});l2.displayName=qY;var KY="MenuArrow",u2=g.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=Zs(n);return h.jsx(I0,{...a,...r,ref:t})});u2.displayName=KY;var cb="MenuSub",[XY,d2]=ei(cb),p2=e=>{const{__scopeMenu:t,children:n,open:r=!1,onOpenChange:a}=e,o=so(cb,t),i=Zs(t),[s,c]=g.useState(null),[l,u]=g.useState(null),d=tr(a);return g.useEffect(()=>(o.open===!1&&d(!1),()=>d(!1)),[o.open,d]),h.jsx(Nf,{...i,children:h.jsx(eb,{scope:t,open:r,onOpenChange:d,content:l,onContentChange:u,children:h.jsx(XY,{scope:t,contentId:Pt(),triggerId:Pt(),trigger:s,onTriggerChange:c,children:n})})})};p2.displayName=cb;var yu="MenuSubTrigger",f2=g.forwardRef((e,t)=>{const n=so(yu,e.__scopeMenu),r=Gs(yu,e.__scopeMenu),a=d2(yu,e.__scopeMenu),o=ab(yu,e.__scopeMenu),i=g.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:c}=o,l={__scopeMenu:e.__scopeMenu},u=g.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return g.useEffect(()=>u,[u]),g.useEffect(()=>{const d=s.current;return()=>{window.clearTimeout(d),c(null)}},[s,c]),h.jsx(nb,{asChild:!0,...l,children:h.jsx(t2,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":y2(n.open),...e,ref:sK(t,a.onTriggerChange),onClick:d=>{var p;(p=e.onClick)==null||p.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ge(e.onPointerMove,gu(d=>{o.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ge(e.onPointerLeave,gu(d=>{var f,y;u();const p=(f=n.content)==null?void 0:f.getBoundingClientRect();if(p){const m=(y=n.content)==null?void 0:y.dataset.side,v=m==="right",b=v?-5:5,w=p[v?"left":"right"],j=p[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+b,y:d.clientY},{x:w,y:p.top},{x:j,y:p.top},{x:j,y:p.bottom},{x:w,y:p.bottom}],side:m}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:ge(e.onKeyDown,d=>{var f;const p=o.searchRef.current!=="";e.disabled||p&&d.key===" "||HA[r.dir].includes(d.key)&&(n.onOpenChange(!0),(f=n.content)==null||f.focus(),d.preventDefault())})})})});f2.displayName=yu;var h2="MenuSubContent",m2=g.forwardRef((e,t)=>{const n=GA(br,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=so(br,e.__scopeMenu),i=Gs(br,e.__scopeMenu),s=d2(h2,e.__scopeMenu),c=g.useRef(null),l=wt(t,c);return h.jsx(Xs.Provider,{scope:e.__scopeMenu,children:h.jsx(Mr,{present:r||o.open,children:h.jsx(Xs.Slot,{scope:e.__scopeMenu,children:h.jsx(ob,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:l,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;i.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ge(e.onFocusOutside,u=>{u.target!==s.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:ge(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:ge(e.onKeyDown,u=>{var f;const d=u.currentTarget.contains(u.target),p=qA[i.dir].includes(u.key);d&&p&&(o.onOpenChange(!1),(f=s.trigger)==null||f.focus(),u.preventDefault())})})})})})});m2.displayName=h2;function y2(e){return e?"open":"closed"}function Ff(e){return e==="indeterminate"}function lb(e){return Ff(e)?"indeterminate":e?"checked":"unchecked"}function ZY(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function GY(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function QY(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=GY(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function YY(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const s=t[o].x,c=t[o].y,l=t[i].x,u=t[i].y;c>r!=u>r&&n<(l-s)*(r-c)/(u-c)+s&&(a=!a)}return a}function JY(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return YY(n,t)}function gu(e){return t=>t.pointerType==="mouse"?e(t):void 0}var g2=tb,v2=nb,b2=QA,w2=YA,x2=ib,_2=JA,j2=$f,S2=n2,E2=a2,O2=i2,C2=c2,N2=l2,M2=u2,eJ=p2,P2=f2,k2=m2,ub="DropdownMenu",[tJ,c2e]=er(ub,[Df]),On=Df(),[nJ,A2]=tJ(ub),T2=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:o,onOpenChange:i,modal:s=!0}=e,c=On(t),l=g.useRef(null),[u=!1,d]=Sn({prop:a,defaultProp:o,onChange:i});return h.jsx(nJ,{scope:t,triggerId:Pt(),triggerRef:l,contentId:Pt(),open:u,onOpenChange:d,onOpenToggle:g.useCallback(()=>d(p=>!p),[d]),modal:s,children:h.jsx(g2,{...c,open:u,onOpenChange:d,dir:r,modal:s,children:n})})};T2.displayName=ub;var I2="DropdownMenuTrigger",R2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,o=A2(I2,n),i=On(n);return h.jsx(v2,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:sK(t,o.triggerRef),onPointerDown:ge(e.onPointerDown,s=>{!r&&s.button===0&&s.ctrlKey===!1&&(o.onOpenToggle(),o.open||s.preventDefault())}),onKeyDown:ge(e.onKeyDown,s=>{r||(["Enter"," "].includes(s.key)&&o.onOpenToggle(),s.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});R2.displayName=I2;var rJ="DropdownMenuPortal",D2=e=>{const{__scopeDropdownMenu:t,...n}=e,r=On(t);return h.jsx(b2,{...r,...n})};D2.displayName=rJ;var L2="DropdownMenuContent",$2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=A2(L2,n),o=On(n),i=g.useRef(!1);return h.jsx(w2,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...r,ref:t,onCloseAutoFocus:ge(e.onCloseAutoFocus,s=>{var c;i.current||((c=a.triggerRef.current)==null||c.focus()),i.current=!1,s.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,s=>{const c=s.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!a.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$2.displayName=L2;var aJ="DropdownMenuGroup",F2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(x2,{...a,...r,ref:t})});F2.displayName=aJ;var oJ="DropdownMenuLabel",B2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(_2,{...a,...r,ref:t})});B2.displayName=oJ;var iJ="DropdownMenuItem",z2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(j2,{...a,...r,ref:t})});z2.displayName=iJ;var sJ="DropdownMenuCheckboxItem",V2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(S2,{...a,...r,ref:t})});V2.displayName=sJ;var cJ="DropdownMenuRadioGroup",U2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(E2,{...a,...r,ref:t})});U2.displayName=cJ;var lJ="DropdownMenuRadioItem",W2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(O2,{...a,...r,ref:t})});W2.displayName=lJ;var uJ="DropdownMenuItemIndicator",H2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(C2,{...a,...r,ref:t})});H2.displayName=uJ;var dJ="DropdownMenuSeparator",q2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(N2,{...a,...r,ref:t})});q2.displayName=dJ;var pJ="DropdownMenuArrow",fJ=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(M2,{...a,...r,ref:t})});fJ.displayName=pJ;var hJ=e=>{const{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:a,defaultOpen:o}=e,i=On(t),[s=!1,c]=Sn({prop:r,defaultProp:o,onChange:a});return h.jsx(eJ,{...i,open:s,onOpenChange:c,children:n})},mJ="DropdownMenuSubTrigger",K2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(P2,{...a,...r,ref:t})});K2.displayName=mJ;var yJ="DropdownMenuSubContent",X2=g.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=On(n);return h.jsx(k2,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});X2.displayName=yJ,sM=T2,cM=R2,iM=D2,ev=$2,oM=F2,sv=B2,rv=z2,av=V2,MK=U2,iv=W2,ov=H2,cv=q2,SK=hJ,tv=K2,nv=X2;const gJ=sM,vJ=cM,bJ=oM,wJ=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(tv,{ref:a,className:Z("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r,children:[n,h.jsx(de,{name:"chevron-right",className:"ml-auto"})]}));wJ.displayName=tv.displayName;const xJ=g.forwardRef(({className:e,...t},n)=>h.jsx(nv,{ref:n,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));xJ.displayName=nv.displayName;const Z2=g.forwardRef(({className:e,sideOffset:t=4,...n},r)=>h.jsx(iM,{children:h.jsx(ev,{ref:r,sideOffset:t,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Z2.displayName=ev.displayName;const G2=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(rv,{ref:r,className:Z("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n}));G2.displayName=rv.displayName;const _J=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(av,{ref:a,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(ov,{children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}),t]}));_J.displayName=av.displayName;const jJ=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(iv,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(ov,{children:h.jsx(de,{name:"circle",className:"h-4 w-4"})})}),t]}));jJ.displayName=iv.displayName;const SJ=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(sv,{ref:r,className:Z("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));SJ.displayName=sv.displayName;const EJ=g.forwardRef(({className:e,...t},n)=>h.jsx(cv,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));EJ.displayName=cv.displayName;function OJ(){const{t:e}=Pe("sidebar"),{isMobile:t}=uu();return h.jsx(Hs,{children:h.jsx(to,{children:h.jsxs(gJ,{children:[h.jsx(vJ,{asChild:!0,children:h.jsxs(no,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[h.jsx("div",{children:h.jsx(de,{name:"settings",size:28,className:"pr-2"})}),h.jsx(de,{name:"chevrons-up-down",className:"ml-auto size-4"})]})}),h.jsx(Z2,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:t?"bottom":"right",align:"end",sideOffset:4,children:h.jsx(bJ,{children:h.jsxs(G2,{children:[h.jsx(de,{name:"sparkles"}),e("contact")]})})})]})})})}const CJ=Ha("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function un({className:e,variant:t,...n}){return h.jsx("div",{className:Z(CJ({variant:t}),e),...n})}function NJ({applications:e,currentSession:t,setCurrentSession:n}){const{t:r}=Pe("sidebar"),a=Ri(),o=Wt(IA),i=g.useCallback((l,u)=>{l.preventDefault(),l.stopPropagation(),o.show({id:u})},[o]),s=l=>{n(l),a(gn("application",{applicationId:l.id}))},c=l=>{switch(l.main_source_type){case"Thread":return h.jsx(un,{className:"ml-1",color:"blue",children:r("application_types.chat")});default:return null}};return h.jsxs(du,{className:"group-data-[collapsible=icon]:hidden pt-0",children:[h.jsx(pu,{children:h.jsx("div",{className:"text-sm",children:r("applications")})}),h.jsxs(Hs,{children:[e==null?void 0:e.map(l=>h.jsx(to,{className:"cursor-pointer",children:h.jsx(no,{asChild:!0,onClick:()=>s(l),children:h.jsxs("div",{className:"flex flex-row justify-between items-center !h-auto",children:[h.jsxs("div",{className:"flex gap-2",children:[(t==null?void 0:t.id)===l.id?h.jsx(de,{size:16,color:"green",name:"check"}):h.jsx(de,{size:16,name:"chevron-right"}),h.jsxs("span",{children:[l.name,c(l)]})]}),h.jsx(de,{onClick:u=>i(u,l.id),size:16,className:"!z-50",name:"trash-2"})]})})},l.id)),e?h.jsx(to,{children:h.jsxs(no,{className:"text-sidebar-foreground/70",children:[h.jsx(de,{name:"ellipsis",className:"text-sidebar-foreground/70"}),h.jsx("span",{children:r("more_session")})]})}):null]})]})}const MJ={navMain:[{title:"playground.title",icon:h.jsx(de,{name:"square-terminal"}),isActive:!0,items:[{title:"playground.nodes",id:"nodes"},{title:"playground.connections",id:"connections"}]},{title:"model.title",url:"#",icon:h.jsx(de,{name:"bot"}),items:[{title:"model.llm",id:"llm"},{title:"model.embedding",id:"embedding"}]},{title:"tutorial.title",icon:h.jsx(de,{name:"book-open"}),items:[{title:"tutorial.get_started",id:"get-started"},{title:"tutorial.simple_workflow",id:"simple-workflow"},{title:"tutorial.ai_structured_output",id:"ai-structured-output"},{title:"tutorial.standalone_chat_application",id:"chat-application"},{title:"tutorial.standalone_editor_application",id:"editor-application"},{title:"tutorial.tool_calling",id:"tool-calling"},{title:"tutorial.vector_database",id:"vector-database"}]},{title:"application.title",icon:h.jsx(de,{name:"settings-2"}),items:[{title:"application.chat",id:"chat"},{title:"application.editor",id:"editor"},{title:"application.vslite",id:"vslite"}]}]};function PJ({sessions:e,applications:t,currentSession:n,setCurrentSession:r,...a}){return h.jsxs(B0,{collapsible:"icon",...a,children:[h.jsx("div",{className:"h-1"}),h.jsxs(V0,{children:[h.jsx(OY,{sessions:e||[],currentSession:n,setCurrentSession:r}),h.jsx(NJ,{applications:t||[],currentSession:n,setCurrentSession:r}),h.jsx(cY,{items:MJ.navMain})]}),h.jsx(dA,{children:h.jsx(OJ,{})}),h.jsx(uA,{})]})}Vn=g.memo(e=>{const{loading:t,...n}=e;return h.jsx(ut,{...n,disabled:e.disabled||t,children:t?h.jsx(de,{name:"loader-circle",className:"animate-spin"}):e.children})});function kJ({className:e,onProcess:t=async()=>(await new Promise(a=>setTimeout(a,2e3)),Math.random()>.5),processDuration:n=2e3,...r}){const[a,o]=g.useState(!1),[i,s]=g.useState(null),[c,l]=g.useState(!1),[,u]=g.useState(0);g.useEffect(()=>{if(a){const p=Date.now(),f=setInterval(()=>{const y=(Date.now()-p)/n*100;y>=100?(clearInterval(f),u(100)):u(y)},10);return()=>clearInterval(f)}},[a,n]);async function d(){if(a)return;o(!0),s(null),u(0),await new Promise(f=>setTimeout(f,n));const p=t?await t():!0;s(p),o(!1),l(!0),setTimeout(()=>{s(null),u(0),l(!1)},2e3)}return h.jsx(ut,{className:Z("relative group","transition-all duration-300",a&&"cursor-wait",e),variant:"ghost",onClick:d,disabled:a,...r,children:h.jsx("div",{className:Z("w-full flex items-center justify-center gap-2",c&&"animate-[scale_300ms_ease-in-out]"),children:i===null?h.jsx(h.Fragment,{children:h.jsx(de,{name:"forward",className:Z("w-4 h-4 transition-transform duration-200","group-hover:scale-110",a&&"animate-bounce")})}):i?h.jsx(h.Fragment,{children:h.jsx(de,{name:"check",className:"w-4 h-4 text-green-500"})}):h.jsx(h.Fragment,{children:h.jsx(de,{name:"x",className:"w-4 h-4 text-red-500"})})})})}const xa="NOLLM",AJ="0123456789abcdef",TJ=[8,4,4,4,12];function vu(){return TJ.map(e=>gAe(AJ,e)()).join("-")}const IJ=()=>{const e=Je(t=>t.currentSession);return{exportSession:g.useCallback(async()=>{if(!(e!=null&&e.id))return;const t={},n={},r=Object.keys(cK).filter(c=>c!=="Session");await Promise.all(r.map(c=>ue(c).find({where:{session_id:e.id}}).then(l=>{l.map(u=>{n[u.id]=u.id}),t[c]=l}))),Object.keys(n).forEach(c=>{n[c]=`[ID_${vu()}]`});let a=JSON.stringify({[xa]:{key:e.id,session:Object.entries(e).reduce((c,[l,u])=>((typeof u!="object"||u===null)&&(c[l]=u),u===void 0&&(c[l]=null),c),{}),ids:Object.keys(n)},...t});Object.keys(n).forEach(c=>{a=a.replace(new RegExp(c,"g"),n[c])}),a=a.replace(new RegExp(e.id,"g"),"[SESSION_ID]");const o=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=`${e.name}_${new Date}.json`,s.click()},[e])}},RJ=()=>{const[e,t]=g.useState(!1),n=Ri(),r=g.useCallback((o,{idMap:i,newSessionId:s,replaceItem:c})=>{const l=o;return{...Object.keys(l).reduce((u,d)=>(l[d]&&typeof l[d]=="string"&&i[l[d]]?u[d]=i[l[d]]:d==="session_id"&&s?u[d]=s:u[d]=l[d],u),{}),...c||{}}},[]),a=g.useCallback(async o=>{try{t(!0);const i=Object.keys(cK).filter(d=>d!==xa);if(!Object.keys(o[xa]).length||typeof o[xa]!="object")throw new Error("Missing Metadata");if(!("session"in o[xa])||!o[xa].session)throw new Error("Missing Session Metadata");const s=o[xa].session;if(!("ids"in o[xa]))throw new Error("Missing Session ID");const c=o[xa].ids.reduce((d,p)=>(d[p]=vu(),d),{}),l=Object.keys(o).filter(d=>d!==xa);if(!l.every(d=>i.includes(d)))throw new Error("Invalid JSON keys");if(!l.every(d=>Array.isArray(o[d])))throw new Error("Invalid JSON values");l.forEach(d=>{o[d].forEach(p=>{if("session_id"in p&&p.session_id!=="[SESSION_ID]")throw new Error("Invalid JSON values")})});const u=await ue("Session").save(r(s,{idMap:c,newSessionId:"",replaceItem:{id:void 0}}));if(!u)throw new Error("Failed to import session");await Promise.all(i.map(d=>{const p=o[d];if(!p||!p.length)return Promise.resolve();const f=p.map(y=>r(y,{idMap:c,newSessionId:u.id}));return ue(d).save(f)})),u.type===Pl.Whiteboard?n(gn("whiteboard",{sessionId:u.id})):u.type===Pl.StandaloneApp&&n(gn("application",{applicationId:u.id}))}finally{t(!1)}},[n,r]);return{loading:e,importSession:a}};function DJ(){const{t:e}=Pe("tooltips"),t=ya(),n=Ml(p=>p.setTheme),r=Ml(p=>p.theme),{exportSession:a}=IJ(),{loading:o,importSession:i}=RJ(),s=g.useRef(null),c=g.useCallback(()=>{n(r==="dark"?"light":"dark")},[r,n]),l=g.useCallback(async()=>{try{return await a(),!0}catch(p){return kl(p),!1}},[a]),u=g.useCallback(async p=>{var f;try{const y=(f=p.target.files)==null?void 0:f[0];if(!y)return;const m=await new Promise((v,b)=>{const w=new FileReader;w.onload=j=>{var x;try{const _=(x=j.target)==null?void 0:x.result;v(JSON.parse(_))}catch(_){b(_)}},w.onerror=j=>{b(j)},w.readAsText(y)});await i(m)}catch(y){return kl(y),!1}},[i]),d=g.useMemo(()=>{if(t.pathname.includes(gn("whiteboard")))return e("whiteboard");if(t.pathname.includes(gn("application")))return e("apllication")},[t.pathname,e]);return h.jsxs("header",{className:"flex h-14 shrink-0 items-center gap-2 transition-[width,height] ease-linear justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2 px-4",children:[h.jsx(lA,{}),h.jsx(nt,{children:d})]}),h.jsx("div",{className:"flex items-center pl-4 pr-2",children:h.jsxs(lu,{children:[h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsxs(Vn,{loading:o,variant:"ghost",onClick:()=>{var p;return(p=s.current)==null?void 0:p.click()},children:[h.jsx(de,{size:18,name:"import"}),h.jsx("input",{ref:s,type:"file",accept:".json",onChange:u,className:"hidden"},`${Date.now()}`)]})}),h.jsx(Br,{children:h.jsx("p",{children:e("import")})})]}),h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(kJ,{onProcess:l})}),h.jsx(Br,{children:h.jsx("p",{children:e("export")})})]}),h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(ut,{disabled:o,onClick:c,variant:"ghost",children:h.jsx(de,{size:18,name:r==="dark"?"moon":"sun"})})}),h.jsx(Br,{children:h.jsx("p",{children:e("theme")})})]}),h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(ut,{variant:"link",children:h.jsx("a",{referrerPolicy:"no-referrer",target:"_blank",href:"https://github.com/zrg-team/NoLLMChat",children:h.jsx(de,{size:18,name:"github"})})})}),h.jsx(Br,{children:h.jsx("p",{children:"https://github.com/zrg-team/NoLLMChat"})})]})]})})]})}function Q2({requiredSession:e}){const t=dP(),n=Ri(),r=ya(),a=g.useRef(r),o=Je(l=>l.currentSession),i=Je(l=>l.sessions),s=Je(l=>l.applications),c=Je(l=>l.setCurrentSession);return a.current=r,g.useEffect(()=>{!(o!=null&&o.id)||!e||(r.pathname.includes(gn("whiteboard"))?t.sessionId?t.sessionId&&t.sessionId!==(o==null?void 0:o.id)&&c(t.sessionId):n(gn("whiteboard",{sessionId:o==null?void 0:o.id})):r.pathname.includes(gn("application"))&&(t.applicationId?t.applicationId&&t.applicationId!==(o==null?void 0:o.id)&&c(t.applicationId):n(gn("application",{applicationId:o==null?void 0:o.id}))))},[o==null?void 0:o.id,r.pathname,n,t.applicationId,t.sessionId,e,c]),g.useEffect(()=>{e&&c(t.sessionId||t.applicationId).then(l=>{sY().has("flow")&&l.type===Pl.StandaloneApp||(l.type===Pl.StandaloneApp&&a.current.pathname.includes(gn("whiteboard").replace("/",""))?n(gn("application",{applicationId:l.id})):l.type===Pl.Whiteboard&&a.current.pathname.includes(gn("application").replace("/",""))&&n(gn("whiteboard",{sessionId:l.id})))})},[n,t.applicationId,t.sessionId,e,c]),h.jsxs(F0,{defaultOpen:!1,children:[h.jsx(PJ,{sessions:i,applications:s,currentSession:o,setCurrentSession:c}),h.jsxs(z0,{className:"max-h-screen overflow-hidden",children:[h.jsx(DJ,{}),h.jsx(Ms,{className:"shrink-0"}),h.jsx("div",{className:"flex flex-1 flex-col p-0 m-0 overflow-y-auto",children:h.jsx(rZ,{})})]})]})}const Y2=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx("div",{className:Z("flex flex-col w-full h-full p-4 gap-6 overflow-y-auto",e),ref:r,...n,children:t}));Y2.displayName="ChatMessageList";var J2="vercel.ai.error",LJ=Symbol.for(J2),eT,$J=class AK extends Error{constructor({name:t,message:n,cause:r}){super(n),this[eT]=!0,this.name=t,this.cause=r}static isInstance(t){return AK.hasMarker(t,J2)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};eT=LJ;var Qs=$J;function tT(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var nT="AI_InvalidArgumentError",rT=`vercel.ai.error.${nT}`,FJ=Symbol.for(rT),aT,BJ=class extends Qs{constructor({message:e,cause:t,argument:n}){super({name:nT,message:e,cause:t}),this[aT]=!0,this.argument=n}static isInstance(e){return Qs.hasMarker(e,rT)}};aT=FJ;var oT="AI_JSONParseError",iT=`vercel.ai.error.${oT}`,zJ=Symbol.for(iT),sT,cT=class extends Qs{constructor({text:e,cause:t}){super({name:oT,message:`JSON parsing failed: Text: ${e}.
Error message: ${tT(t)}`,cause:t}),this[sT]=!0,this.text=e}static isInstance(e){return Qs.hasMarker(e,iT)}};sT=zJ;var lT="AI_TypeValidationError",uT=`vercel.ai.error.${lT}`,VJ=Symbol.for(uT),dT,UJ=class EM extends Qs{constructor({value:t,cause:n}){super({name:lT,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${tT(n)}`,cause:n}),this[dT]=!0,this.value=t}static isInstance(t){return Qs.hasMarker(t,uT)}static wrap({value:t,cause:n}){return EM.isInstance(n)&&n.value===t?n:new EM({value:t,cause:n})}};dT=VJ;var pT=UJ;let WJ=(e,t=21)=>(n=t)=>{let r="",a=n;for(;a--;)r+=e[Math.random()*e.length|0];return r};var Bi={exports:{}},fT;function HJ(){if(fT)return Bi.exports;fT=1;const e=typeof pa<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(s,c,l){l==null&&c!==null&&typeof c=="object"&&(l=c,c=void 0),e&&pa.isBuffer(s)&&(s=s.toString()),s&&s.charCodeAt(0)===65279&&(s=s.slice(1));const u=JSON.parse(s,c);if(u===null||typeof u!="object")return u;const d=l&&l.protoAction||"error",p=l&&l.constructorAction||"error";if(d==="ignore"&&p==="ignore")return u;if(d!=="ignore"&&p!=="ignore"){if(t.test(s)===!1&&n.test(s)===!1)return u}else if(d!=="ignore"&&p==="ignore"){if(t.test(s)===!1)return u}else if(n.test(s)===!1)return u;return a(u,{protoAction:d,constructorAction:p,safe:l&&l.safe})}function a(s,{protoAction:c="error",constructorAction:l="error",safe:u}={}){let d=[s];for(;d.length;){const p=d;d=[];for(const f of p){if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(f,"__proto__")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete f.__proto__}if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(f,"constructor")&&Object.prototype.hasOwnProperty.call(f.constructor,"prototype")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete f.constructor}for(const y in f){const m=f[y];m&&typeof m=="object"&&d.push(m)}}}return s}function o(s,c,l){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,l)}finally{Error.stackTraceLimit=u}}function i(s,c){const l=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(s,c,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=l}}return Bi.exports=o,Bi.exports.default=o,Bi.exports.parse=o,Bi.exports.safeParse=i,Bi.exports.scan=a,Bi.exports}var qJ=HJ();const KJ=ot(qJ);var XJ=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=WJ(n,t);if(e==null)return a;if(n.includes(r))throw new BJ({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return o=>`${e}${r}${a(o)}`},hT=XJ(),db=Symbol.for("vercel.ai.validator");function ZJ(e){return{[db]:!0,validate:e}}function GJ(e){return typeof e=="object"&&e!==null&&db in e&&e[db]===!0&&"validate"in e}function QJ(e){return GJ(e)?e:YJ(e)}function YJ(e){return ZJ(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function JJ({value:e,schema:t}){const n=QJ(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:pT.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:pT.wrap({value:e,cause:r})}}}function mT({text:e,schema:t}){try{const n=KJ.parse(e);return t==null?{success:!0,value:n}:JJ({value:n,schema:t})}catch(n){return{success:!1,error:cT.isInstance(n)?n:new cT({text:e,cause:n})}}}var Bf={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},zf={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Vf={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Uf={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Wf={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},eee=[Bf,zf,Vf,Uf,Wf];Bf.code+"",zf.code+"",Vf.code+"",Uf.code+"",Wf.code+"",Bf.name+"",Bf.code,zf.name+"",zf.code,Vf.name+"",Vf.code,Uf.name+"",Uf.code,Wf.name+"",Wf.code,eee.map(e=>e.code);function tee(e){const t=["ROOT"];let n=-1,r=null;function a(c,l,u){switch(c){case'"':{n=l,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=l,r=l,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=l,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=l,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function o(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=l,t.pop();break}}}function i(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}}}for(let c=0;c<e.length;c++){const l=e[c];switch(t[t.length-1]){case"ROOT":a(l,c,"FINISH");break;case"INSIDE_OBJECT_START":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=c,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(l){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{a(l,c,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{o(l,c);break}case"INSIDE_STRING":{switch(l){case'"':{t.pop(),n=c;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=c}break}case"INSIDE_ARRAY_START":{switch(l){case"]":{n=c,t.pop();break}default:{n=c,a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}default:{n=c;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{a(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=c;break}case"INSIDE_NUMBER":{switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const u=e.substring(r,c+1);!"false".startsWith(u)&&!"true".startsWith(u)&&!"null".startsWith(u)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?o(l,c):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(l,c)):n=c;break}}}let s=e.slice(0,n+1);for(let c=t.length-1;c>=0;c--)switch(t[c]){case"INSIDE_STRING":{s+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{s+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{s+="]";break}case"INSIDE_LITERAL":{const l=e.substring(r,e.length);"true".startsWith(l)?s+="true".slice(l.length):"false".startsWith(l)?s+="false".slice(l.length):"null".startsWith(l)&&(s+="null".slice(l.length))}}return s}function nee(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=mT({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=mT({text:tee(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var bu={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},wu={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},xu={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},_u={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},ju={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},Su={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},Eu={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},Ou={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Cu={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Nu={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},ree=[bu,wu,xu,_u,ju,Su,Eu,Ou,Cu,Nu],aee={[bu.code]:bu,[wu.code]:wu,[xu.code]:xu,[_u.code]:_u,[ju.code]:ju,[Su.code]:Su,[Eu.code]:Eu,[Ou.code]:Ou,[Cu.code]:Cu,[Nu.code]:Nu};bu.name+"",bu.code,wu.name+"",wu.code,xu.name+"",xu.code,_u.name+"",_u.code,ju.name+"",ju.code,Su.name+"",Su.code,Eu.name+"",Eu.code,Ou.name+"",Ou.code,Cu.name+"",Cu.code,Nu.name+"",Nu.code;var oee=ree.map(e=>e.code),iee=e=>{const t=e.indexOf(":");if(t===-1)throw new Error("Failed to parse stream string. No separator found.");const n=e.slice(0,t);if(!oee.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const r=n,a=e.slice(t+1),o=JSON.parse(a);return aee[r].parse(o)},see=10;function cee(e,t){const n=new Uint8Array(t);let r=0;for(const a of e)n.set(a,r),r+=a.length;return e.length=0,n}async function lee({stream:e,onTextPart:t,onDataPart:n,onErrorPart:r,onToolCallStreamingStartPart:a,onToolCallDeltaPart:o,onToolCallPart:i,onToolResultPart:s,onMessageAnnotationsPart:c,onFinishMessagePart:l,onFinishStepPart:u}){const d=e.getReader(),p=new TextDecoder,f=[];let y=0;for(;;){const{value:m}=await d.read();if(m&&(f.push(m),y+=m.length,m[m.length-1]!==see))continue;if(f.length===0)break;const v=cee(f,y);y=0;const b=p.decode(v,{stream:!0}).split(`
`).filter(w=>w!=="").map(iee);for(const{type:w,value:j}of b)switch(w){case"text":await(t==null?void 0:t(j));break;case"data":await(n==null?void 0:n(j));break;case"error":await(r==null?void 0:r(j));break;case"message_annotations":await(c==null?void 0:c(j));break;case"tool_call_streaming_start":await(a==null?void 0:a(j));break;case"tool_call_delta":await(o==null?void 0:o(j));break;case"tool_call":await(i==null?void 0:i(j));break;case"tool_result":await(s==null?void 0:s(j));break;case"finish_message":await(l==null?void 0:l(j));break;case"finish_step":await(u==null?void 0:u(j));break;default:{const x=w;throw new Error(`Unknown stream part type: ${x}`)}}}}function uee({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}async function dee({stream:e,update:t,onToolCall:n,onFinish:r,generateId:a=hT,getCurrentDate:o=()=>new Date}){const i=o();let s,c=!0;const l=[],u=[];let d;const p={};let f={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},y="unknown";function m(){const b=[...u];if(s==null){t(l,b);return}d!=null&&d.length&&(s.annotations=d);const w={...JSON.parse(JSON.stringify(s)),revisionId:a()};t([...l,w],b)}function v(){return(c||s==null)&&(s!=null&&l.push(s),c=!1,s={id:a(),role:"assistant",content:"",createdAt:i}),s}await lee({stream:e,onTextPart(b){const w=v();s={...w,content:w.content+b},m()},onToolCallStreamingStartPart(b){const w=v();w.toolInvocations==null&&(w.toolInvocations=[]),p[b.toolCallId]={text:"",toolName:b.toolName,index:w.toolInvocations.length},w.toolInvocations.push({state:"partial-call",toolCallId:b.toolCallId,toolName:b.toolName,args:void 0}),m()},onToolCallDeltaPart(b){const w=v(),j=p[b.toolCallId];j.text+=b.argsTextDelta;const{value:x}=nee(j.text);w.toolInvocations[j.index]={state:"partial-call",toolCallId:b.toolCallId,toolName:j.toolName,args:x},m()},async onToolCallPart(b){const w=v();if(p[b.toolCallId]!=null?w.toolInvocations[p[b.toolCallId].index]={state:"call",...b}:(w.toolInvocations==null&&(w.toolInvocations=[]),w.toolInvocations.push({state:"call",...b})),n){const j=await n({toolCall:b});j!=null&&(w.toolInvocations[w.toolInvocations.length-1]={state:"result",...b,result:j})}m()},onToolResultPart(b){const w=v().toolInvocations;if(w==null)throw new Error("tool_result must be preceded by a tool_call");const j=w.findIndex(x=>x.toolCallId===b.toolCallId);if(j===-1)throw new Error("tool_result must be preceded by a tool_call with the same toolCallId");w[j]={...w[j],state:"result",...b},m()},onDataPart(b){u.push(...b),m()},onMessageAnnotationsPart(b){d==null?d=[...b]:d.push(...b),m()},onFinishStepPart(b){c=!b.isContinued},onFinishMessagePart(b){y=b.finishReason,b.usage!=null&&(f=uee(b.usage))},onErrorPart(b){throw new Error(b)}}),r==null||r({message:s,finishReason:y,usage:f})}async function pee({stream:e,onTextPart:t}){const n=e.pipeThrough(new TextDecoderStream).getReader();for(;;){const{done:r,value:a}=await n.read();if(r)break;await t(a)}}var fee=()=>fetch;async function hee({api:e,body:t,streamProtocol:n="data",credentials:r,headers:a,abortController:o,restoreMessagesOnFailure:i,onResponse:s,onUpdate:c,onFinish:l,onToolCall:u,generateId:d,fetch:p=fee()}){var f,y;const m=await p(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",...a},signal:(f=o==null?void 0:o())==null?void 0:f.signal,credentials:r}).catch(v=>{throw i(),v});if(s)try{await s(m)}catch(v){throw v}if(!m.ok)throw i(),new Error((y=await m.text())!=null?y:"Failed to fetch the chat response.");if(!m.body)throw new Error("The response body is empty.");switch(n){case"text":{const v={id:d(),createdAt:new Date,role:"assistant",content:""};await pee({stream:m.body,onTextPart:b=>{v.content+=b,c([{...v}],[])}}),l==null||l(v,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"});return}case"data":{await dee({stream:m.body,update:c,onToolCall:u,onFinish({message:v,finishReason:b,usage:w}){l&&v!=null&&l(v,{usage:w,finishReason:b})},generateId:d});return}default:{const v=n;throw new Error(`Unknown stream protocol: ${v}`)}}}var yT={exports:{}},pb={},gT;function mee(){if(gT)return pb;gT=1;var e=lK();function t(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,a=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function s(d,p){var f=p(),y=r({inst:{value:f,getSnapshot:p}}),m=y[0].inst,v=y[1];return o(function(){m.value=f,m.getSnapshot=p,c(m)&&v({inst:m})},[d,f,p]),a(function(){return c(m)&&v({inst:m}),d(function(){c(m)&&v({inst:m})})},[d]),i(f),f}function c(d){var p=d.getSnapshot;d=d.value;try{var f=p();return!n(d,f)}catch{return!0}}function l(d,p){return p()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:s;return pb.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,pb}var vT;function bT(){return vT||(vT=1,yT.exports=mee()),yT.exports}Vp=bT();let co,Rn,Hf,ct,zr,lo,wT,Mu;NK=ot(Vp),co=()=>{},Rn=co(),Hf=Object,ct=e=>e===Rn,zr=e=>typeof e=="function",lo=(e,t)=>({...e,...t}),wT=e=>zr(e.then),Mu=new WeakMap;let yee=0;const Pu=e=>{const t=typeof e,n=e&&e.constructor,r=n==Date;let a,o;if(Hf(e)===e&&!r&&n!=RegExp){if(a=Mu.get(e),a)return a;if(a=++yee+"~",Mu.set(e,a),n==Array){for(a="@",o=0;o<e.length;o++)a+=Pu(e[o])+",";Mu.set(e,a)}if(n==Hf){a="#";const i=Hf.keys(e).sort();for(;!ct(o=i.pop());)ct(e[o])||(a+=o+":"+Pu(e[o])+",");Mu.set(e,a)}}else a=r?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return a},uo=new WeakMap,fb={},qf={},hb="undefined",Kf=typeof window!=hb,mb=typeof document!=hb,gee=()=>Kf&&typeof window.requestAnimationFrame!=hb,xT=(e,t)=>{const n=uo.get(e);return[()=>!ct(t)&&e.get(t)||fb,r=>{if(!ct(t)){const a=e.get(t);t in qf||(qf[t]=a),n[5](t,lo(a,r),a||fb)}},n[6],()=>!ct(t)&&t in qf?qf[t]:!ct(t)&&e.get(t)||fb]};let yb=!0;const vee=()=>yb,[gb,vb]=Kf&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[co,co],bee=()=>{const e=mb&&document.visibilityState;return ct(e)||e!=="hidden"},wee=e=>(mb&&document.addEventListener("visibilitychange",e),gb("focus",e),()=>{mb&&document.removeEventListener("visibilitychange",e),vb("focus",e)}),xee=e=>{const t=()=>{yb=!0,e()},n=()=>{yb=!1};return gb("online",t),gb("offline",n),()=>{vb("online",t),vb("offline",n)}},_ee={isOnline:vee,isVisible:bee},jee={initFocus:wee,initReconnect:xee},_T=!W.useId,ku=!Kf||"Deno"in window,See=e=>gee()?window.requestAnimationFrame(e):setTimeout(e,1),bb=ku?g.useEffect:g.useLayoutEffect,wb=typeof navigator<"u"&&navigator.connection,jT=!ku&&wb&&(["slow-2g","2g"].includes(wb.effectiveType)||wb.saveData),xb=e=>{if(zr(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?Pu(e):"",[e,t]};let Eee=0;const _b=()=>++Eee,ST=0,ET=1,OT=2;var Au={__proto__:null,ERROR_REVALIDATE_EVENT:3,FOCUS_EVENT:ST,MUTATE_EVENT:OT,RECONNECT_EVENT:ET};async function CT(...e){const[t,n,r,a]=e,o=lo({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let i=o.populateCache;const s=o.rollbackOnError;let c=o.optimisticData;const l=p=>typeof s=="function"?s(p):s!==!1,u=o.throwOnError;if(zr(n)){const p=n,f=[],y=t.keys();for(const m of y)!/^\$(inf|sub)\$/.test(m)&&p(t.get(m)._k)&&f.push(m);return Promise.all(f.map(d))}return d(n);async function d(p){const[f]=xb(p);if(!f)return;const[y,m]=xT(t,f),[v,b,w,j]=uo.get(t),x=()=>{const k=v[f];return(zr(o.revalidate)?o.revalidate(y().data,p):o.revalidate!==!1)&&(delete w[f],delete j[f],k&&k[0])?k[0](OT).then(()=>y().data):y().data};if(e.length<3)return x();let _=r,S;const E=_b();b[f]=[E,0];const O=!ct(c),M=y(),N=M.data,P=M._c,I=ct(P)?N:P;if(O&&(c=zr(c)?c(I,N):c,m({data:c,_c:I})),zr(_))try{_=_(I)}catch(k){S=k}if(_&&wT(_))if(_=await _.catch(k=>{S=k}),E!==b[f][0]){if(S)throw S;return _}else S&&O&&l(S)&&(i=!0,m({data:I,_c:Rn}));if(i&&!S)if(zr(i)){const k=i(_,I);m({data:k,error:Rn,_c:Rn})}else m({data:_,error:Rn,_c:Rn});if(b[f][1]=_b(),Promise.resolve(x()).then(()=>{m({_c:Rn})}),S){if(u)throw S;return}return _}}const NT=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},Oee=(e,t)=>{if(!uo.has(e)){const n=lo(jee,t),r={},a=CT.bind(Rn,e);let o=co;const i={},s=(u,d)=>{const p=i[u]||[];return i[u]=p,p.push(d),()=>p.splice(p.indexOf(d),1)},c=(u,d,p)=>{e.set(u,d);const f=i[u];if(f)for(const y of f)y(d,p)},l=()=>{if(!uo.has(e)&&(uo.set(e,[r,{},{},{},a,c,s]),!ku)){const u=n.initFocus(setTimeout.bind(Rn,NT.bind(Rn,r,ST))),d=n.initReconnect(setTimeout.bind(Rn,NT.bind(Rn,r,ET)));o=()=>{u&&u(),d&&d(),uo.delete(e)}}};return l(),[e,a,l,o]}return[e,uo.get(e)[4]]},Cee=(e,t,n,r,a)=>{const o=n.errorRetryCount,i=a.retryCount,s=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!ct(o)&&i>o||setTimeout(r,s,a)},Nee=(e,t)=>Pu(e)==Pu(t),[MT,Mee]=Oee(new Map),Pee=lo({onLoadingSlow:co,onSuccess:co,onError:co,onErrorRetry:Cee,onDiscarded:co,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:jT?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:jT?5e3:3e3,compare:Nee,isPaused:()=>!1,cache:MT,mutate:Mee,fallback:{}},_ee),kee=(e,t)=>{const n=lo(e,t);if(t){const{use:r,fallback:a}=e,{use:o,fallback:i}=t;r&&o&&(n.use=r.concat(o)),a&&i&&(n.fallback=lo(a,i))}return n},Aee=g.createContext({}),Tee="$inf$",PT=Kf&&window.__SWR_DEVTOOLS_USE__,Iee=PT?window.__SWR_DEVTOOLS_USE__:[],Ree=()=>{PT&&(window.__SWR_DEVTOOLS_REACT__=W)},Dee=e=>zr(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(e[1]===null?e[2]:e[1])||{}],Lee=()=>lo(Pee,g.useContext(Aee)),$ee=e=>(t,n,r)=>e(t,n&&((...a)=>{const[o]=xb(t),[,,,i]=uo.get(MT);if(o.startsWith(Tee))return n(...a);const s=i[o];return ct(s)?n(...a):(delete i[o],s)}),r),Fee=Iee.concat($ee),Bee=e=>function(...t){const n=Lee(),[r,a,o]=Dee(t),i=kee(n,o);let s=e;const{use:c}=i,l=(c||[]).concat(Fee);for(let u=l.length;u--;)s=l[u](s);return s(r,a||i.fetcher||null,i)},zee=(e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const a=r.indexOf(n);a>=0&&(r[a]=r[r.length-1],r.pop())}};Ree();const kT=W.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e)}),jb={dedupe:!0},Vee=(e,t,n)=>{const{cache:r,compare:a,suspense:o,fallbackData:i,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:l,refreshWhenHidden:u,refreshWhenOffline:d,keepPreviousData:p}=n,[f,y,m,v]=uo.get(r),[b,w]=xb(e),j=g.useRef(!1),x=g.useRef(!1),_=g.useRef(b),S=g.useRef(t),E=g.useRef(n),O=()=>E.current,M=()=>O().isVisible()&&O().isOnline(),[N,P,I,k]=xT(r,b),C=g.useRef({}).current,T=ct(i)?n.fallback[b]:i,A=(F,se)=>{for(const re in C){const le=re;if(le==="data"){if(!a(F[le],se[le])&&(!ct(F[le])||!a(G,se[le])))return!1}else if(se[le]!==F[le])return!1}return!0},D=g.useMemo(()=>{const F=!b||!t?!1:ct(s)?O().isPaused()||o?!1:ct(c)?!0:c:s,se=Se=>{const Ve=lo(Se);return delete Ve._k,F?{isValidating:!0,isLoading:!0,...Ve}:Ve},re=N(),le=k(),je=se(re),Le=re===le?je:se(le);let $e=je;return[()=>{const Se=se(N());return A(Se,$e)?($e.data=Se.data,$e.isLoading=Se.isLoading,$e.isValidating=Se.isValidating,$e.error=Se.error,$e):($e=Se,Se)},()=>Le]},[r,b]),L=Vp.useSyncExternalStore(g.useCallback(F=>I(b,(se,re)=>{A(re,se)||F()}),[r,b]),D[0],D[1]),R=!j.current,B=f[b]&&f[b].length>0,z=L.data,$=ct(z)?T:z,V=L.error,Y=g.useRef($),G=p?ct(z)?Y.current:z:$,K=B&&!ct(V)?!1:R&&!ct(s)?s:O().isPaused()?!1:o?ct($)?!1:c:ct($)||c,Q=!!(b&&t&&R&&K),q=ct(L.isValidating)?Q:L.isValidating,H=ct(L.isLoading)?Q:L.isLoading,X=g.useCallback(async F=>{const se=S.current;if(!b||!se||x.current||O().isPaused())return!1;let re,le,je=!0;const Le=F||{},$e=!m[b]||!Le.dedupe,Se=()=>_T?!x.current&&b===_.current&&j.current:b===_.current,Ve={isValidating:!1,isLoading:!1},We=()=>{P(Ve)},He=()=>{const st=m[b];st&&st[1]===le&&delete m[b]},Mt={isValidating:!0};ct(N().data)&&(Mt.isLoading=!0);try{if($e&&(P(Mt),n.loadingTimeout&&ct(N().data)&&setTimeout(()=>{je&&Se()&&O().onLoadingSlow(b,n)},n.loadingTimeout),m[b]=[se(w),_b()]),[re,le]=m[b],re=await re,$e&&setTimeout(He,n.dedupingInterval),!m[b]||m[b][1]!==le)return $e&&Se()&&O().onDiscarded(b),!1;Ve.error=Rn;const st=y[b];if(!ct(st)&&(le<=st[0]||le<=st[1]||st[1]===0))return We(),$e&&Se()&&O().onDiscarded(b),!1;const rt=N().data;Ve.data=a(rt,re)?rt:re,$e&&Se()&&O().onSuccess(re,b,n)}catch(st){He();const rt=O(),{shouldRetryOnError:bt}=rt;rt.isPaused()||(Ve.error=st,$e&&Se()&&(rt.onError(st,b,rt),(bt===!0||zr(bt)&&bt(st))&&(!O().revalidateOnFocus||!O().revalidateOnReconnect||M())&&rt.onErrorRetry(st,b,rt,Kt=>{const Gn=f[b];Gn&&Gn[0]&&Gn[0](Au.ERROR_REVALIDATE_EVENT,Kt)},{retryCount:(Le.retryCount||0)+1,dedupe:!0})))}return je=!1,We(),!0},[b,r]),te=g.useCallback((...F)=>CT(r,_.current,...F),[]);if(bb(()=>{S.current=t,E.current=n,ct(z)||(Y.current=z)}),bb(()=>{if(!b)return;const F=X.bind(Rn,jb);let se=0;const re=zee(b,f,(le,je={})=>{if(le==Au.FOCUS_EVENT){const Le=Date.now();O().revalidateOnFocus&&Le>se&&M()&&(se=Le+O().focusThrottleInterval,F())}else if(le==Au.RECONNECT_EVENT)O().revalidateOnReconnect&&M()&&F();else{if(le==Au.MUTATE_EVENT)return X();if(le==Au.ERROR_REVALIDATE_EVENT)return X(je)}});return x.current=!1,_.current=b,j.current=!0,P({_k:w}),K&&(ct($)||ku?F():See(F)),()=>{x.current=!0,re()}},[b]),bb(()=>{let F;function se(){const le=zr(l)?l(N().data):l;le&&F!==-1&&(F=setTimeout(re,le))}function re(){!N().error&&(u||O().isVisible())&&(d||O().isOnline())?X(jb).then(se):se()}return se(),()=>{F&&(clearTimeout(F),F=-1)}},[l,u,d,b]),g.useDebugValue(G),o&&ct($)&&b){if(!_T&&ku)throw new Error("Fallback data is required when using suspense in SSR.");S.current=t,E.current=n,x.current=!1;const F=v[b];if(!ct(F)){const se=te(F);kT(se)}if(ct(V)){const se=X(jb);ct(G)||(se.status="fulfilled",se.value=!0),kT(se)}else throw V}return{mutate:te,get data(){return C.data=!0,G},get error(){return C.error=!0,V},get isValidating(){return C.isValidating=!0,q},get isLoading(){return C.isLoading=!0,H}}},Xf=Bee(Vee);var Sb,AT;function Uee(){if(AT)return Sb;AT=1;function e(t,n){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let r,a=0;return function(...o){clearTimeout(r);const i=Date.now(),s=i-a,c=n-s;c<=0?(a=i,t.apply(this,o)):r=setTimeout(()=>{a=Date.now(),t.apply(this,o)},c)}}return Sb=e,Sb}var Wee=Uee();const Hee=ot(Wee);function TT(e,t){return t!=null?Hee(e,t):e}var qee=async(e,t,n,r,a,o,i,s,c,l,u,d,p,f,y,m,v)=>{var b;const w=i.current;n(t.messages,!1);const j=f?t.messages:t.messages.map(({role:_,content:S,experimental_attachments:E,data:O,annotations:M,toolInvocations:N})=>({role:_,content:S,...E!==void 0&&{experimental_attachments:E},...O!==void 0&&{data:O},...M!==void 0&&{annotations:M},...N!==void 0&&{toolInvocations:N}})),x=a.current;return await hee({api:e,body:(b=y==null?void 0:y({messages:t.messages,requestData:t.data,requestBody:t.body}))!=null?b:{messages:j,data:t.data,...o.current.body,...t.body},streamProtocol:l,credentials:o.current.credentials,headers:{...o.current.headers,...t.headers},abortController:()=>s.current,restoreMessagesOnFailure(){v||n(w,!1)},onResponse:d,onUpdate(_,S){n([...t.messages,..._],!1),S!=null&&S.length&&r([...x??[],...S],!1)},onToolCall:p,onFinish:u,generateId:c,fetch:m})};function Kee({api:e="/api/chat",id:t,initialMessages:n,initialInput:r="",sendExtraMessageFields:a,onToolCall:o,experimental_prepareRequestBody:i,maxSteps:s=1,streamProtocol:c="data",onResponse:l,onFinish:u,onError:d,credentials:p,headers:f,body:y,generateId:m=hT,fetch:v,keepLastMessageOnError:b=!0,experimental_throttle:w}={}){const j=g.useId(),x=t??j,_=typeof e=="string"?[e,x]:x,[S]=g.useState([]),{data:E,mutate:O}=Xf([_,"messages"],null,{fallbackData:n??S}),M=g.useRef(E||[]);g.useEffect(()=>{M.current=E||[]},[E]);const{data:N,mutate:P}=Xf([_,"streamData"],null),I=g.useRef(N);g.useEffect(()=>{I.current=N},[N]);const{data:k=!1,mutate:C}=Xf([_,"loading"],null),{data:T=void 0,mutate:A}=Xf([_,"error"],null),D=g.useRef(null),L=g.useRef({credentials:p,headers:f,body:y});g.useEffect(()=>{L.current={credentials:p,headers:f,body:y}},[p,f,y]);const R=g.useCallback(async q=>{const H=M.current.length;try{C(!0),A(void 0);const F=new AbortController;D.current=F,await qee(e,q,TT(O,w),TT(P,w),I,L,M,D,m,c,u,l,o,a,i,v,b),D.current=null}catch(F){if(F.name==="AbortError")return D.current=null,null;d&&F instanceof Error&&d(F),A(F)}finally{C(!1)}const X=M.current,te=X[X.length-1];X.length>H&&te!=null&&s>1&&IT(te)&&Xee(X)<s&&await R({messages:X})},[O,C,e,L,l,u,d,A,P,I,c,a,i,o,s,M,D,m,v,b,w]),B=g.useCallback(async(q,{data:H,headers:X,body:te,experimental_attachments:F}={})=>{var se,re;q.id||(q.id=m());const le=await RT(F),je=M.current.concat({...q,id:(se=q.id)!=null?se:m(),createdAt:(re=q.createdAt)!=null?re:new Date,experimental_attachments:le.length>0?le:void 0});return R({messages:je,headers:X,body:te,data:H})},[R,m]),z=g.useCallback(async({data:q,headers:H,body:X}={})=>{const te=M.current;if(te.length===0)return null;const F=te[te.length-1];return R({messages:F.role==="assistant"?te.slice(0,-1):te,headers:H,body:X,data:q})},[R]),$=g.useCallback(()=>{D.current&&(D.current.abort(),D.current=null)},[]),V=g.useCallback(q=>{typeof q=="function"&&(q=q(M.current)),O(q,!1),M.current=q},[O]),Y=g.useCallback(q=>{typeof q=="function"&&(q=q(I.current)),P(q,!1),I.current=q},[P]),[G,K]=g.useState(r),Q=g.useCallback(async(q,H={},X)=>{var te;if((te=q==null?void 0:q.preventDefault)==null||te.call(q),!G&&!H.allowEmptySubmit)return;X&&(L.current={...L.current,...X});const F=await RT(H.experimental_attachments),se={messages:!G&&!F.length&&H.allowEmptySubmit?M.current:M.current.concat({id:m(),createdAt:new Date,role:"user",content:G,experimental_attachments:F.length>0?F:void 0}),headers:H.headers,body:H.body,data:H.data};R(se),K("")},[G,m,R]);return{messages:E||[],setMessages:V,data:N,setData:Y,error:T,append:B,reload:z,stop:$,input:G,setInput:K,handleInputChange:q=>{K(q.target.value)},handleSubmit:Q,isLoading:k,addToolResult:({toolCallId:q,result:H})=>{const X=M.current.map((F,se,re)=>se===re.length-1&&F.role==="assistant"&&F.toolInvocations?{...F,toolInvocations:F.toolInvocations.map(le=>le.toolCallId===q?{...le,result:H,state:"result"}:le)}:F);O(X,!1);const te=X[X.length-1];IT(te)&&R({messages:X})}}}function IT(e){return e.role==="assistant"&&e.toolInvocations&&e.toolInvocations.length>0&&e.toolInvocations.every(t=>"result"in t)}function Xee(e){let t=0;for(let n=e.length-1;n>=0&&e[n].role==="assistant";n--)t++;return t}async function RT(e){if(e==null)return[];if(e instanceof FileList)return Promise.all(Array.from(e).map(async t=>{const{name:n,type:r}=t,a=await new Promise((o,i)=>{const s=new FileReader;s.onload=c=>{var l;o((l=c.target)==null?void 0:l.result)},s.onerror=c=>i(c),s.readAsDataURL(t)});return{name:n,contentType:r,url:a}}));if(Array.isArray(e))return e;throw new Error("Invalid attachments type")}XN=Kee;const po=g.forwardRef(({className:e,...t},n)=>h.jsx("textarea",{className:Z("flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));po.displayName="Textarea";function Zee({minHeight:e,maxHeight:t}){const n=g.useRef(null),r=g.useCallback(a=>{const o=n.current;if(!o)return;if(a){o.style.height=`${e}px`;return}o.style.height=`${e}px`;const i=Math.max(e,Math.min(o.scrollHeight,t??Number.POSITIVE_INFINITY));o.style.height=`${i}px`},[e,t]);return g.useEffect(()=>{const a=n.current;a&&(a.style.height=`${e}px`)},[e]),g.useEffect(()=>{const a=()=>r();return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[r]),{textareaRef:n,adjustHeight:r}}const Gee=48,DT=164;wv=function({onSubmit:e,disabled:t,enableTool:n,enableFile:r,placeholder:a,minHeight:o,maxHeight:i,className:s,height:c,onChange:l,value:u}){const[d,p]=g.useState(!1),[f,y]=g.useState(""),{textareaRef:m,adjustHeight:v}=Zee({minHeight:o||Gee,maxHeight:i||DT}),[b,w]=g.useState(!0),j=g.useCallback(async _=>{try{p(!0),await e(f,_)&&y("")}finally{p(!1)}},[f,e]),x=g.useMemo(()=>({maxHeight:`${i||DT}px`,...c?{height:`${c}px`}:{}}),[i,c]);return h.jsx("div",{className:Z("w-full py-4 max-w-xl",s),children:h.jsx("div",{className:"relative w-full mx-auto",children:h.jsxs("div",{className:"relative flex flex-col",children:[h.jsx("div",{className:"overflow-y-auto",style:x,children:h.jsx(po,{id:"ai-input-04",value:(l?u:f)||"",disabled:t||d,placeholder:a,className:"w-full rounded-xl rounded-b-none px-4 py-3 bg-black/5 dark:bg-white/5 border-none dark:text-white placeholder:text-black/70 dark:placeholder:text-white/70 resize-none focus-visible:ring-0 leading-[1.2]",ref:m,onKeyDown:_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),j(_))},onChange:_=>{l||y(_.target.value),v(),l==null||l(_)}})}),h.jsxs("div",{className:"h-12 bg-black/5 dark:bg-white/5 rounded-b-xl",children:[h.jsxs("div",{className:"absolute left-3 bottom-3 flex items-center gap-2",children:[r?h.jsxs("label",{className:"cursor-pointer rounded-lg p-2 bg-black/5 dark:bg-white/5",children:[h.jsx("input",{type:"file",className:"hidden"}),h.jsx(de,{name:"paperclip",className:"w-4 h-4 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white transition-colors"})]}):void 0,n?h.jsxs("button",{type:"button",onClick:()=>{w(!b)},className:Z("rounded-full transition-all flex items-center gap-2 px-1.5 py-1 border h-8",b?"bg-sky-500/15 border-sky-400 text-sky-500":"bg-black/5 dark:bg-white/5 border-transparent text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:[h.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:h.jsx(Rp.div,{animate:{rotate:b?180:0,scale:b?1.1:1},whileHover:{rotate:b?180:15,scale:1.1,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:h.jsx(de,{name:"globe",className:Z("w-4 h-4",b?"text-sky-500":"text-inherit")})})}),h.jsx(IK,{children:b&&h.jsx(Rp.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-sm overflow-hidden whitespace-nowrap text-sky-500 flex-shrink-0",children:"Search"})})]}):void 0]}),h.jsx("div",{className:"absolute right-3 bottom-3",children:h.jsx("button",{type:"button",disabled:t||d,onClick:_=>{j(_)},className:Z("rounded-lg p-2",l&&u||f?"bg-sky-500/15 text-sky-500":"bg-black/5 dark:bg-white/5 text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white"),children:h.jsx(de,{name:"send",className:"w-4 h-4"})})})]})]})})})};var Eb,LT;function Qee(){if(LT)return Eb;LT=1;function e(){this.__data__=[],this.size=0}return Eb=e,Eb}var Ob,$T;Dl=function(){if($T)return Ob;$T=1;function e(t,n){return t===n||t!==t&&n!==n}return Ob=e,Ob};var Cb,FT;function Zf(){if(FT)return Cb;FT=1;var e=Dl();function t(n,r){for(var a=n.length;a--;)if(e(n[a][0],r))return a;return-1}return Cb=t,Cb}var Nb,BT;function Yee(){if(BT)return Nb;BT=1;var e=Zf(),t=Array.prototype,n=t.splice;function r(a){var o=this.__data__,i=e(o,a);if(i<0)return!1;var s=o.length-1;return i==s?o.pop():n.call(o,i,1),--this.size,!0}return Nb=r,Nb}var Mb,zT;function Jee(){if(zT)return Mb;zT=1;var e=Zf();function t(n){var r=this.__data__,a=e(r,n);return a<0?void 0:r[a][1]}return Mb=t,Mb}var Pb,VT;function ete(){if(VT)return Pb;VT=1;var e=Zf();function t(n){return e(this.__data__,n)>-1}return Pb=t,Pb}var kb,UT;function tte(){if(UT)return kb;UT=1;var e=Zf();function t(n,r){var a=this.__data__,o=e(a,n);return o<0?(++this.size,a.push([n,r])):a[o][1]=r,this}return kb=t,kb}var Ab,WT;function Gf(){if(WT)return Ab;WT=1;var e=Qee(),t=Yee(),n=Jee(),r=ete(),a=tte();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,Ab=o,Ab}var Tb,HT;function nte(){if(HT)return Tb;HT=1;var e=Gf();function t(){this.__data__=new e,this.size=0}return Tb=t,Tb}var Ib,qT;function rte(){if(qT)return Ib;qT=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return Ib=e,Ib}var Rb,KT;function ate(){if(KT)return Rb;KT=1;function e(t){return this.__data__.get(t)}return Rb=e,Rb}var Db,XT;function ote(){if(XT)return Db;XT=1;function e(t){return this.__data__.has(t)}return Db=e,Db}var Lb,ZT;function GT(){if(ZT)return Lb;ZT=1;var e=typeof Al=="object"&&Al&&Al.Object===Object&&Al;return Lb=e,Lb}var $b,QT;Ar=function(){if(QT)return $b;QT=1;var e=GT(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return $b=n,$b};var Fb,YT;Ps=function(){if(YT)return Fb;YT=1;var e=Ar(),t=e.Symbol;return Fb=t,Fb};var Bb,JT;function ite(){if(JT)return Bb;JT=1;var e=Ps(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,a=e?e.toStringTag:void 0;function o(i){var s=n.call(i,a),c=i[a];try{i[a]=void 0;var l=!0}catch{}var u=r.call(i);return l&&(s?i[a]=c:delete i[a]),u}return Bb=o,Bb}var zb,eI;function ste(){if(eI)return zb;eI=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return zb=n,zb}var Vb,tI;function fo(){if(tI)return Vb;tI=1;var e=Ps(),t=ite(),n=ste(),r="[object Null]",a="[object Undefined]",o=e?e.toStringTag:void 0;function i(s){return s==null?s===void 0?a:r:o&&o in Object(s)?t(s):n(s)}return Vb=i,Vb}var Ub,nI;Tr=function(){if(nI)return Ub;nI=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Ub=e,Ub};var Wb,rI;zp=function(){if(rI)return Wb;rI=1;var e=fo(),t=Tr(),n="[object AsyncFunction]",r="[object Function]",a="[object GeneratorFunction]",o="[object Proxy]";function i(s){if(!t(s))return!1;var c=e(s);return c==r||c==a||c==n||c==o}return Wb=i,Wb};var Hb,aI;function cte(){if(aI)return Hb;aI=1;var e=Ar(),t=e["__core-js_shared__"];return Hb=t,Hb}var qb,oI;function lte(){if(oI)return qb;oI=1;var e=cte(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return qb=n,qb}var Kb,iI;function sI(){if(iI)return Kb;iI=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return Kb=n,Kb}var Xb,cI;function ute(){if(cI)return Xb;cI=1;var e=zp(),t=lte(),n=Tr(),r=sI(),a=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,i=Function.prototype,s=Object.prototype,c=i.toString,l=s.hasOwnProperty,u=RegExp("^"+c.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(p){if(!n(p)||t(p))return!1;var f=e(p)?u:o;return f.test(r(p))}return Xb=d,Xb}var Zb,lI;function dte(){if(lI)return Zb;lI=1;function e(t,n){return t==null?void 0:t[n]}return Zb=e,Zb}var Gb,uI;function zi(){if(uI)return Gb;uI=1;var e=ute(),t=dte();function n(r,a){var o=t(r,a);return e(o)?o:void 0}return Gb=n,Gb}var Qb,dI;function Yb(){if(dI)return Qb;dI=1;var e=zi(),t=Ar(),n=e(t,"Map");return Qb=n,Qb}var Jb,pI;function Qf(){if(pI)return Jb;pI=1;var e=zi(),t=e(Object,"create");return Jb=t,Jb}var ew,fI;function pte(){if(fI)return ew;fI=1;var e=Qf();function t(){this.__data__=e?e(null):{},this.size=0}return ew=t,ew}var tw,hI;function fte(){if(hI)return tw;hI=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return tw=e,tw}var nw,mI;function hte(){if(mI)return nw;mI=1;var e=Qf(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function a(o){var i=this.__data__;if(e){var s=i[o];return s===t?void 0:s}return r.call(i,o)?i[o]:void 0}return nw=a,nw}var rw,yI;function mte(){if(yI)return rw;yI=1;var e=Qf(),t=Object.prototype,n=t.hasOwnProperty;function r(a){var o=this.__data__;return e?o[a]!==void 0:n.call(o,a)}return rw=r,rw}var aw,gI;function yte(){if(gI)return aw;gI=1;var e=Qf(),t="__lodash_hash_undefined__";function n(r,a){var o=this.__data__;return this.size+=this.has(r)?0:1,o[r]=e&&a===void 0?t:a,this}return aw=n,aw}var ow,vI;function gte(){if(vI)return ow;vI=1;var e=pte(),t=fte(),n=hte(),r=mte(),a=yte();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,ow=o,ow}var iw,bI;function vte(){if(bI)return iw;bI=1;var e=gte(),t=Gf(),n=Yb();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return iw=r,iw}var sw,wI;function bte(){if(wI)return sw;wI=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return sw=e,sw}var cw,xI;function Yf(){if(xI)return cw;xI=1;var e=bte();function t(n,r){var a=n.__data__;return e(r)?a[typeof r=="string"?"string":"hash"]:a.map}return cw=t,cw}var lw,_I;function wte(){if(_I)return lw;_I=1;var e=Yf();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return lw=t,lw}var uw,jI;function xte(){if(jI)return uw;jI=1;var e=Yf();function t(n){return e(this,n).get(n)}return uw=t,uw}var dw,SI;function _te(){if(SI)return dw;SI=1;var e=Yf();function t(n){return e(this,n).has(n)}return dw=t,dw}var pw,EI;function jte(){if(EI)return pw;EI=1;var e=Yf();function t(n,r){var a=e(this,n),o=a.size;return a.set(n,r),this.size+=a.size==o?0:1,this}return pw=t,pw}var fw,OI;function hw(){if(OI)return fw;OI=1;var e=vte(),t=wte(),n=xte(),r=_te(),a=jte();function o(i){var s=-1,c=i==null?0:i.length;for(this.clear();++s<c;){var l=i[s];this.set(l[0],l[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=r,o.prototype.set=a,fw=o,fw}var mw,CI;function Ste(){if(CI)return mw;CI=1;var e=Gf(),t=Yb(),n=hw(),r=200;function a(o,i){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<r-1)return c.push([o,i]),this.size=++s.size,this;s=this.__data__=new n(c)}return s.set(o,i),this.size=s.size,this}return mw=a,mw}var yw,NI;kv=function(){if(NI)return yw;NI=1;var e=Gf(),t=nte(),n=rte(),r=ate(),a=ote(),o=Ste();function i(s){var c=this.__data__=new e(s);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=a,i.prototype.set=o,yw=i,yw};var gw,MI;function Ete(){if(MI)return gw;MI=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return gw=t,gw}var vw,PI;function Ote(){if(PI)return vw;PI=1;function e(t){return this.__data__.has(t)}return vw=e,vw}var bw,kI;function AI(){if(kI)return bw;kI=1;var e=hw(),t=Ete(),n=Ote();function r(a){var o=-1,i=a==null?0:a.length;for(this.__data__=new e;++o<i;)this.add(a[o])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,bw=r,bw}var ww,TI;function II(){if(TI)return ww;TI=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(n(t[r],r,t))return!0;return!1}return ww=e,ww}var xw,RI;function DI(){if(RI)return xw;RI=1;function e(t,n){return t.has(n)}return xw=e,xw}var _w,LI;function $I(){if(LI)return _w;LI=1;var e=AI(),t=II(),n=DI(),r=1,a=2;function o(i,s,c,l,u,d){var p=c&r,f=i.length,y=s.length;if(f!=y&&!(p&&y>f))return!1;var m=d.get(i),v=d.get(s);if(m&&v)return m==s&&v==i;var b=-1,w=!0,j=c&a?new e:void 0;for(d.set(i,s),d.set(s,i);++b<f;){var x=i[b],_=s[b];if(l)var S=p?l(_,x,b,s,i,d):l(x,_,b,i,s,d);if(S!==void 0){if(S)continue;w=!1;break}if(j){if(!t(s,function(E,O){if(!n(j,O)&&(x===E||u(x,E,c,l,d)))return j.push(O)})){w=!1;break}}else if(!(x===_||u(x,_,c,l,d))){w=!1;break}}return d.delete(i),d.delete(s),w}return _w=o,_w}var jw,FI;vM=function(){if(FI)return jw;FI=1;var e=Ar(),t=e.Uint8Array;return jw=t,jw};var Sw,BI;function Cte(){if(BI)return Sw;BI=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a,o){r[++n]=[o,a]}),r}return Sw=e,Sw}var Ew,zI;function Ow(){if(zI)return Ew;zI=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(a){r[++n]=a}),r}return Ew=e,Ew}var Cw,VI;function Nte(){if(VI)return Cw;VI=1;var e=Ps(),t=vM(),n=Dl(),r=$I(),a=Cte(),o=Ow(),i=1,s=2,c="[object Boolean]",l="[object Date]",u="[object Error]",d="[object Map]",p="[object Number]",f="[object RegExp]",y="[object Set]",m="[object String]",v="[object Symbol]",b="[object ArrayBuffer]",w="[object DataView]",j=e?e.prototype:void 0,x=j?j.valueOf:void 0;function _(S,E,O,M,N,P,I){switch(O){case w:if(S.byteLength!=E.byteLength||S.byteOffset!=E.byteOffset)return!1;S=S.buffer,E=E.buffer;case b:return!(S.byteLength!=E.byteLength||!P(new t(S),new t(E)));case c:case l:case p:return n(+S,+E);case u:return S.name==E.name&&S.message==E.message;case f:case m:return S==E+"";case d:var k=a;case y:var C=M&i;if(k||(k=o),S.size!=E.size&&!C)return!1;var T=I.get(S);if(T)return T==E;M|=s,I.set(S,E);var A=r(k(S),k(E),M,N,P,I);return I.delete(S),A;case v:if(x)return x.call(S)==x.call(E)}return!1}return Cw=_,Cw}var Nw,UI;function Mw(){if(UI)return Nw;UI=1;function e(t,n){for(var r=-1,a=n.length,o=t.length;++r<a;)t[o+r]=n[r];return t}return Nw=e,Nw}var Pw,WI;In=function(){if(WI)return Pw;WI=1;var e=Array.isArray;return Pw=e,Pw};var kw,HI;function qI(){if(HI)return kw;HI=1;var e=Mw(),t=In();function n(r,a,o){var i=a(r);return t(r)?i:e(i,o(r))}return kw=n,kw}var Aw,KI;function Mte(){if(KI)return Aw;KI=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=0,i=[];++r<a;){var s=t[r];n(s,r,t)&&(i[o++]=s)}return i}return Aw=e,Aw}var Tw,XI;function ZI(){if(XI)return Tw;XI=1;function e(){return[]}return Tw=e,Tw}var Iw,GI;Cv=function(){if(GI)return Iw;GI=1;var e=Mte(),t=ZI(),n=Object.prototype,r=n.propertyIsEnumerable,a=Object.getOwnPropertySymbols,o=a?function(i){return i==null?[]:(i=Object(i),e(a(i),function(s){return r.call(i,s)}))}:t;return Iw=o,Iw};var Rw,QI;function Pte(){if(QI)return Rw;QI=1;function e(t,n){for(var r=-1,a=Array(t);++r<t;)a[r]=n(r);return a}return Rw=e,Rw}var Dw,YI;ha=function(){if(YI)return Dw;YI=1;function e(t){return t!=null&&typeof t=="object"}return Dw=e,Dw};var Lw,JI;function kte(){if(JI)return Lw;JI=1;var e=fo(),t=ha(),n="[object Arguments]";function r(a){return t(a)&&e(a)==n}return Lw=r,Lw}var $w,eR;Bp=function(){if(eR)return $w;eR=1;var e=kte(),t=ha(),n=Object.prototype,r=n.hasOwnProperty,a=n.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(i){return t(i)&&r.call(i,"callee")&&!a.call(i,"callee")};return $w=o,$w};var Jf={exports:{}},Fw,tR;function Ate(){if(tR)return Fw;tR=1;function e(){return!1}return Fw=e,Fw}Jf.exports;var nR;Av=function(){return nR||(nR=1,function(e,t){var n=Ar(),r=Ate(),a=t&&!t.nodeType&&t,o=a&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===a,s=i?n.Buffer:void 0,c=s?s.isBuffer:void 0,l=c||r;e.exports=l}(Jf,Jf.exports)),Jf.exports};var Bw,rR;function eh(){if(rR)return Bw;rR=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,a){var o=typeof r;return a=a??e,!!a&&(o=="number"||o!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<a}return Bw=n,Bw}var zw,aR;function Vw(){if(aR)return zw;aR=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return zw=t,zw}var Uw,oR;function Tte(){if(oR)return Uw;oR=1;var e=fo(),t=Vw(),n=ha(),r="[object Arguments]",a="[object Array]",o="[object Boolean]",i="[object Date]",s="[object Error]",c="[object Function]",l="[object Map]",u="[object Number]",d="[object Object]",p="[object RegExp]",f="[object Set]",y="[object String]",m="[object WeakMap]",v="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",j="[object Float64Array]",x="[object Int8Array]",_="[object Int16Array]",S="[object Int32Array]",E="[object Uint8Array]",O="[object Uint8ClampedArray]",M="[object Uint16Array]",N="[object Uint32Array]",P={};P[w]=P[j]=P[x]=P[_]=P[S]=P[E]=P[O]=P[M]=P[N]=!0,P[r]=P[a]=P[v]=P[o]=P[b]=P[i]=P[s]=P[c]=P[l]=P[u]=P[d]=P[p]=P[f]=P[y]=P[m]=!1;function I(k){return n(k)&&t(k.length)&&!!P[e(k)]}return Uw=I,Uw}var Ww,iR;Pv=function(){if(iR)return Ww;iR=1;function e(t){return function(n){return t(n)}}return Ww=e,Ww};var th={exports:{}};th.exports;var sR;wM=function(){return sR||(sR=1,function(e,t){var n=GT(),r=t&&!t.nodeType&&t,a=r&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===r,i=o&&n.process,s=function(){try{var c=a&&a.require&&a.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=s}(th,th.exports)),th.exports};var Hw,cR;Ig=function(){if(cR)return Hw;cR=1;var e=Tte(),t=Pv(),n=wM(),r=n&&n.isTypedArray,a=r?t(r):e;return Hw=a,Hw};var qw,lR;function uR(){if(lR)return qw;lR=1;var e=Pte(),t=Bp(),n=In(),r=Av(),a=eh(),o=Ig(),i=Object.prototype,s=i.hasOwnProperty;function c(l,u){var d=n(l),p=!d&&t(l),f=!d&&!p&&r(l),y=!d&&!p&&!f&&o(l),m=d||p||f||y,v=m?e(l.length,String):[],b=v.length;for(var w in l)(u||s.call(l,w))&&!(m&&(w=="length"||f&&(w=="offset"||w=="parent")||y&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||a(w,b)))&&v.push(w);return v}return qw=c,qw}var Kw,dR;Mv=function(){if(dR)return Kw;dR=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,a=typeof r=="function"&&r.prototype||e;return n===a}return Kw=t,Kw};var Xw,pR;function fR(){if(pR)return Xw;pR=1;function e(t,n){return function(r){return t(n(r))}}return Xw=e,Xw}var Zw,hR;function Ite(){if(hR)return Zw;hR=1;var e=fR(),t=e(Object.keys,Object);return Zw=t,Zw}var Gw,mR;function Rte(){if(mR)return Gw;mR=1;var e=Mv(),t=Ite(),n=Object.prototype,r=n.hasOwnProperty;function a(o){if(!e(o))return t(o);var i=[];for(var s in Object(o))r.call(o,s)&&s!="constructor"&&i.push(s);return i}return Gw=a,Gw}var Qw,yR;Ni=function(){if(yR)return Qw;yR=1;var e=zp(),t=Vw();function n(r){return r!=null&&t(r.length)&&!e(r)}return Qw=n,Qw};var Yw,gR;Ul=function(){if(gR)return Yw;gR=1;var e=uR(),t=Rte(),n=Ni();function r(a){return n(a)?e(a):t(a)}return Yw=r,Yw};var Jw,vR;xM=function(){if(vR)return Jw;vR=1;var e=qI(),t=Cv(),n=Ul();function r(a){return e(a,n,t)}return Jw=r,Jw};var ex,bR;function Dte(){if(bR)return ex;bR=1;var e=xM(),t=1,n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s,c,l,u){var d=s&t,p=e(o),f=p.length,y=e(i),m=y.length;if(f!=m&&!d)return!1;for(var v=f;v--;){var b=p[v];if(!(d?b in i:r.call(i,b)))return!1}var w=u.get(o),j=u.get(i);if(w&&j)return w==i&&j==o;var x=!0;u.set(o,i),u.set(i,o);for(var _=d;++v<f;){b=p[v];var S=o[b],E=i[b];if(c)var O=d?c(E,S,b,i,o,u):c(S,E,b,o,i,u);if(!(O===void 0?S===E||l(S,E,s,c,u):O)){x=!1;break}_||(_=b=="constructor")}if(x&&!_){var M=o.constructor,N=i.constructor;M!=N&&"constructor"in o&&"constructor"in i&&!(typeof M=="function"&&M instanceof M&&typeof N=="function"&&N instanceof N)&&(x=!1)}return u.delete(o),u.delete(i),x}return ex=a,ex}var tx,wR;function Lte(){if(wR)return tx;wR=1;var e=zi(),t=Ar(),n=e(t,"DataView");return tx=n,tx}var nx,xR;function $te(){if(xR)return nx;xR=1;var e=zi(),t=Ar(),n=e(t,"Promise");return nx=n,nx}var rx,_R;function jR(){if(_R)return rx;_R=1;var e=zi(),t=Ar(),n=e(t,"Set");return rx=n,rx}var ax,SR;function Fte(){if(SR)return ax;SR=1;var e=zi(),t=Ar(),n=e(t,"WeakMap");return ax=n,ax}var ox,ER;bM=function(){if(ER)return ox;ER=1;var e=Lte(),t=Yb(),n=$te(),r=jR(),a=Fte(),o=fo(),i=sI(),s="[object Map]",c="[object Object]",l="[object Promise]",u="[object Set]",d="[object WeakMap]",p="[object DataView]",f=i(e),y=i(t),m=i(n),v=i(r),b=i(a),w=o;return(e&&w(new e(new ArrayBuffer(1)))!=p||t&&w(new t)!=s||n&&w(n.resolve())!=l||r&&w(new r)!=u||a&&w(new a)!=d)&&(w=function(j){var x=o(j),_=x==c?j.constructor:void 0,S=_?i(_):"";if(S)switch(S){case f:return p;case y:return s;case m:return l;case v:return u;case b:return d}return x}),ox=w,ox};var ix,OR;function Bte(){if(OR)return ix;OR=1;var e=kv(),t=$I(),n=Nte(),r=Dte(),a=bM(),o=In(),i=Av(),s=Ig(),c=1,l="[object Arguments]",u="[object Array]",d="[object Object]",p=Object.prototype,f=p.hasOwnProperty;function y(m,v,b,w,j,x){var _=o(m),S=o(v),E=_?u:a(m),O=S?u:a(v);E=E==l?d:E,O=O==l?d:O;var M=E==d,N=O==d,P=E==O;if(P&&i(m)){if(!i(v))return!1;_=!0,M=!1}if(P&&!M)return x||(x=new e),_||s(m)?t(m,v,b,w,j,x):n(m,v,E,b,w,j,x);if(!(b&c)){var I=M&&f.call(m,"__wrapped__"),k=N&&f.call(v,"__wrapped__");if(I||k){var C=I?m.value():m,T=k?v.value():v;return x||(x=new e),j(C,T,b,w,x)}}return P?(x||(x=new e),r(m,v,b,w,j,x)):!1}return ix=y,ix}var sx,CR;function cx(){if(CR)return sx;CR=1;var e=Bte(),t=ha();function n(r,a,o,i,s){return r===a?!0:r==null||a==null||!t(r)&&!t(a)?r!==r&&a!==a:e(r,a,o,i,n,s)}return sx=n,sx}var lx,NR;function zte(){if(NR)return lx;NR=1;var e=kv(),t=cx(),n=1,r=2;function a(o,i,s,c){var l=s.length,u=l,d=!c;if(o==null)return!u;for(o=Object(o);l--;){var p=s[l];if(d&&p[2]?p[1]!==o[p[0]]:!(p[0]in o))return!1}for(;++l<u;){p=s[l];var f=p[0],y=o[f],m=p[1];if(d&&p[2]){if(y===void 0&&!(f in o))return!1}else{var v=new e;if(c)var b=c(y,m,f,o,i,v);if(!(b===void 0?t(m,y,n|r,c,v):b))return!1}}return!0}return lx=a,lx}var ux,MR;function PR(){if(MR)return ux;MR=1;var e=Tr();function t(n){return n===n&&!e(n)}return ux=t,ux}var dx,kR;function Vte(){if(kR)return dx;kR=1;var e=PR(),t=Ul();function n(r){for(var a=t(r),o=a.length;o--;){var i=a[o],s=r[i];a[o]=[i,s,e(s)]}return a}return dx=n,dx}var px,AR;function TR(){if(AR)return px;AR=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return px=e,px}var fx,IR;function Ute(){if(IR)return fx;IR=1;var e=zte(),t=Vte(),n=TR();function r(a){var o=t(a);return o.length==1&&o[0][2]?n(o[0][0],o[0][1]):function(i){return i===a||e(i,a,o)}}return fx=r,fx}var hx,RR;function Ys(){if(RR)return hx;RR=1;var e=fo(),t=ha(),n="[object Symbol]";function r(a){return typeof a=="symbol"||t(a)&&e(a)==n}return hx=r,hx}var mx,DR;function yx(){if(DR)return mx;DR=1;var e=In(),t=Ys(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function a(o,i){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:r.test(o)||!n.test(o)||i!=null&&o in Object(i)}return mx=a,mx}var gx,LR;function $R(){if(LR)return gx;LR=1;var e=hw(),t="Expected a function";function n(r,a){if(typeof r!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var o=function(){var i=arguments,s=a?a.apply(this,i):i[0],c=o.cache;if(c.has(s))return c.get(s);var l=r.apply(this,i);return o.cache=c.set(s,l)||c,l};return o.cache=new(n.Cache||e),o}return n.Cache=e,gx=n,gx}var vx,FR;function Wte(){if(FR)return vx;FR=1;var e=$R(),t=500;function n(r){var a=e(r,function(i){return o.size===t&&o.clear(),i}),o=a.cache;return a}return vx=n,vx}var bx,BR;function Hte(){if(BR)return bx;BR=1;var e=Wte(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(a){var o=[];return a.charCodeAt(0)===46&&o.push(""),a.replace(t,function(i,s,c,l){o.push(c?l.replace(n,"$1"):s||i)}),o});return bx=r,bx}var wx,zR;Rl=function(){if(zR)return wx;zR=1;function e(t,n){for(var r=-1,a=t==null?0:t.length,o=Array(a);++r<a;)o[r]=n(t[r],r,t);return o}return wx=e,wx};var xx,VR;function qte(){if(VR)return xx;VR=1;var e=Ps(),t=Rl(),n=In(),r=Ys(),a=1/0,o=e?e.prototype:void 0,i=o?o.toString:void 0;function s(c){if(typeof c=="string")return c;if(n(c))return t(c,s)+"";if(r(c))return i?i.call(c):"";var l=c+"";return l=="0"&&1/c==-a?"-0":l}return xx=s,xx}var _x,UR;function WR(){if(UR)return _x;UR=1;var e=qte();function t(n){return n==null?"":e(n)}return _x=t,_x}var jx,HR;Kl=function(){if(HR)return jx;HR=1;var e=In(),t=yx(),n=Hte(),r=WR();function a(o,i){return e(o)?o:t(o,i)?[o]:n(r(o))}return jx=a,jx};var Sx,qR;ks=function(){if(qR)return Sx;qR=1;var e=Ys(),t=1/0;function n(r){if(typeof r=="string"||e(r))return r;var a=r+"";return a=="0"&&1/r==-t?"-0":a}return Sx=n,Sx};var Ex,KR;ql=function(){if(KR)return Ex;KR=1;var e=Kl(),t=ks();function n(r,a){a=e(a,r);for(var o=0,i=a.length;r!=null&&o<i;)r=r[t(a[o++])];return o&&o==i?r:void 0}return Ex=n,Ex};var Ox,XR;function ZR(){if(XR)return Ox;XR=1;var e=ql();function t(n,r,a){var o=n==null?void 0:e(n,r);return o===void 0?a:o}return Ox=t,Ox}var Cx,GR;function Kte(){if(GR)return Cx;GR=1;function e(t,n){return t!=null&&n in Object(t)}return Cx=e,Cx}var Nx,QR;function Xte(){if(QR)return Nx;QR=1;var e=Kl(),t=Bp(),n=In(),r=eh(),a=Vw(),o=ks();function i(s,c,l){c=e(c,s);for(var u=-1,d=c.length,p=!1;++u<d;){var f=o(c[u]);if(!(p=s!=null&&l(s,f)))break;s=s[f]}return p||++u!=d?p:(d=s==null?0:s.length,!!d&&a(d)&&r(f,d)&&(n(s)||t(s)))}return Nx=i,Nx}var Mx,YR;BN=function(){if(YR)return Mx;YR=1;var e=Kte(),t=Xte();function n(r,a){return r!=null&&t(r,a,e)}return Mx=n,Mx};var Px,JR;function Zte(){if(JR)return Px;JR=1;var e=cx(),t=ZR(),n=BN(),r=yx(),a=PR(),o=TR(),i=ks(),s=1,c=2;function l(u,d){return r(u)&&a(d)?o(i(u),d):function(p){var f=t(p,u);return f===void 0&&f===d?n(p,u):e(d,f,s|c)}}return Px=l,Px}var kx,eD;function Js(){if(eD)return kx;eD=1;function e(t){return t}return kx=e,kx}var Ax,tD;function Gte(){if(tD)return Ax;tD=1;function e(t){return function(n){return n==null?void 0:n[t]}}return Ax=e,Ax}var Tx,nD;function Qte(){if(nD)return Tx;nD=1;var e=ql();function t(n){return function(r){return e(r,n)}}return Tx=t,Tx}var Ix,rD;function Yte(){if(rD)return Ix;rD=1;var e=Gte(),t=Qte(),n=yx(),r=ks();function a(o){return n(o)?e(r(o)):t(o)}return Ix=a,Ix}var Rx,aD;function _a(){if(aD)return Rx;aD=1;var e=Ute(),t=Zte(),n=Js(),r=In(),a=Yte();function o(i){return typeof i=="function"?i:i==null?n:typeof i=="object"?r(i)?t(i[0],i[1]):e(i):a(i)}return Rx=o,Rx}var Dx,oD;function Jte(){if(oD)return Dx;oD=1;var e="Expected a function";function t(n){if(typeof n!="function")throw new TypeError(e);return function(){var r=arguments;switch(r.length){case 0:return!n.call(this);case 1:return!n.call(this,r[0]);case 2:return!n.call(this,r[0],r[1]);case 3:return!n.call(this,r[0],r[1],r[2])}return!n.apply(this,r)}}return Dx=t,Dx}var Lx,iD;function sD(){if(iD)return Lx;iD=1;var e=zi(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return Lx=t,Lx}var $x,cD;Lg=function(){if(cD)return $x;cD=1;var e=sD();function t(n,r,a){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[r]=a}return $x=t,$x};var Fx,lD;_M=function(){if(lD)return Fx;lD=1;var e=Lg(),t=Dl(),n=Object.prototype,r=n.hasOwnProperty;function a(o,i,s){var c=o[i];(!(r.call(o,i)&&t(c,s))||s===void 0&&!(i in o))&&e(o,i,s)}return Fx=a,Fx};var Bx,uD;function ene(){if(uD)return Bx;uD=1;var e=_M(),t=Kl(),n=eh(),r=Tr(),a=ks();function o(i,s,c,l){if(!r(i))return i;s=t(s,i);for(var u=-1,d=s.length,p=d-1,f=i;f!=null&&++u<d;){var y=a(s[u]),m=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return i;if(u!=p){var v=f[y];m=l?l(v,y,f):void 0,m===void 0&&(m=r(v)?v:n(s[u+1])?[]:{})}e(f,y,m),f=f[y]}return i}return Bx=o,Bx}var zx,dD;FN=function(){if(dD)return zx;dD=1;var e=ql(),t=ene(),n=Kl();function r(a,o,i){for(var s=-1,c=o.length,l={};++s<c;){var u=o[s],d=e(a,u);i(d,u)&&t(l,n(u,a),d)}return l}return zx=r,zx};var Vx,pD;Nv=function(){if(pD)return Vx;pD=1;var e=fR(),t=e(Object.getPrototypeOf,Object);return Vx=t,Vx};var Ux,fD;gM=function(){if(fD)return Ux;fD=1;var e=Mw(),t=Nv(),n=Cv(),r=ZI(),a=Object.getOwnPropertySymbols,o=a?function(i){for(var s=[];i;)e(s,n(i)),i=t(i);return s}:r;return Ux=o,Ux};var Wx,hD;function tne(){if(hD)return Wx;hD=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return Wx=e,Wx}var Hx,mD;function nne(){if(mD)return Hx;mD=1;var e=Tr(),t=Mv(),n=tne(),r=Object.prototype,a=r.hasOwnProperty;function o(i){if(!e(i))return n(i);var s=t(i),c=[];for(var l in i)l=="constructor"&&(s||!a.call(i,l))||c.push(l);return c}return Hx=o,Hx}var qx,yD;yM=function(){if(yD)return qx;yD=1;var e=uR(),t=nne(),n=Ni();function r(a){return n(a)?e(a,!0):t(a)}return qx=r,qx};var Kx,gD;jM=function(){if(gD)return Kx;gD=1;var e=qI(),t=gM(),n=yM();function r(a){return e(a,n,t)}return Kx=r,Kx};var Xx,vD;function rne(){if(vD)return Xx;vD=1;var e=Rl(),t=_a(),n=FN(),r=jM();function a(o,i){if(o==null)return{};var s=e(r(o),function(c){return[c]});return i=t(i),n(o,s,function(c,l){return i(c,l[0])})}return Xx=a,Xx}var Zx,bD;function ane(){if(bD)return Zx;bD=1;var e=_a(),t=Jte(),n=rne();function r(a,o){return n(a,t(e(o)))}return Zx=r,Zx}var one=ane();const Tu=ot(one);var Gx,wD;function ine(){if(wD)return Gx;wD=1;function e(t){return t===void 0}return Gx=e,Gx}var sne=ine();const Iu=ot(sne);function Qt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=Qt(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var cne={value:()=>{}};function nh(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new rh(n)}function rh(e){this._=e}function lne(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}rh.prototype=nh.prototype={constructor:rh,on:function(e,t){var n=this._,r=lne(e+"",n),a,o=-1,i=r.length;if(arguments.length<2){for(;++o<i;)if((a=(e=r[o]).type)&&(a=une(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<i;)if(a=(e=r[o]).type)n[a]=xD(n[a],e.name,t);else if(t==null)for(a in n)n[a]=xD(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new rh(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,o;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,a=o.length;r<a;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,o=r.length;a<o;++a)r[a].value.apply(t,n)}};function une(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function xD(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=cne,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Qx="http://www.w3.org/1999/xhtml";const _D={svg:"http://www.w3.org/2000/svg",xhtml:Qx,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ah(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),_D.hasOwnProperty(t)?{space:_D[t],local:e}:e}function dne(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Qx&&t.documentElement.namespaceURI===Qx?t.createElement(e):t.createElementNS(n,e)}}function pne(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function jD(e){var t=ah(e);return(t.local?pne:dne)(t)}function fne(){}function Yx(e){return e==null?fne:function(){return this.querySelector(e)}}function hne(e){typeof e!="function"&&(e=Yx(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=new Array(i),c,l,u=0;u<i;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),s[u]=l);return new sr(r,this._parents)}function mne(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function yne(){return[]}function SD(e){return e==null?yne:function(){return this.querySelectorAll(e)}}function gne(e){return function(){return mne(e.apply(this,arguments))}}function vne(e){typeof e=="function"?e=gne(e):e=SD(e);for(var t=this._groups,n=t.length,r=[],a=[],o=0;o<n;++o)for(var i=t[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),a.push(c));return new sr(r,a)}function ED(e){return function(){return this.matches(e)}}function OD(e){return function(t){return t.matches(e)}}var bne=Array.prototype.find;function wne(e){return function(){return bne.call(this.children,e)}}function xne(){return this.firstElementChild}function _ne(e){return this.select(e==null?xne:wne(typeof e=="function"?e:OD(e)))}var jne=Array.prototype.filter;function Sne(){return Array.from(this.children)}function Ene(e){return function(){return jne.call(this.children,e)}}function One(e){return this.selectAll(e==null?Sne:Ene(typeof e=="function"?e:OD(e)))}function Cne(e){typeof e!="function"&&(e=ED(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new sr(r,this._parents)}function CD(e){return new Array(e.length)}function Nne(){return new sr(this._enter||this._groups.map(CD),this._parents)}function oh(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}oh.prototype={constructor:oh,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Mne(e){return function(){return e}}function Pne(e,t,n,r,a,o){for(var i=0,s,c=t.length,l=o.length;i<l;++i)(s=t[i])?(s.__data__=o[i],r[i]=s):n[i]=new oh(e,o[i]);for(;i<c;++i)(s=t[i])&&(a[i]=s)}function kne(e,t,n,r,a,o,i){var s,c,l=new Map,u=t.length,d=o.length,p=new Array(u),f;for(s=0;s<u;++s)(c=t[s])&&(p[s]=f=i.call(c,c.__data__,s,t)+"",l.has(f)?a[s]=c:l.set(f,c));for(s=0;s<d;++s)f=i.call(e,o[s],s,o)+"",(c=l.get(f))?(r[s]=c,c.__data__=o[s],l.delete(f)):n[s]=new oh(e,o[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(p[s])===c&&(a[s]=c)}function Ane(e){return e.__data__}function Tne(e,t){if(!arguments.length)return Array.from(this,Ane);var n=t?kne:Pne,r=this._parents,a=this._groups;typeof e!="function"&&(e=Mne(e));for(var o=a.length,i=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],d=a[l],p=d.length,f=Ine(e.call(u,u&&u.__data__,l,r)),y=f.length,m=s[l]=new Array(y),v=i[l]=new Array(y),b=c[l]=new Array(p);n(u,d,m,v,b,f,t);for(var w=0,j=0,x,_;w<y;++w)if(x=m[w]){for(w>=j&&(j=w+1);!(_=v[j])&&++j<y;);x._next=_||null}}return i=new sr(i,r),i._enter=s,i._exit=c,i}function Ine(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Rne(){return new sr(this._exit||this._groups.map(CD),this._parents)}function Dne(e,t,n){var r=this.enter(),a=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?o.remove():n(o),r&&a?r.merge(a).order():a}function Lne(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,o=r.length,i=Math.min(a,o),s=new Array(a),c=0;c<i;++c)for(var l=n[c],u=r[c],d=l.length,p=s[c]=new Array(d),f,y=0;y<d;++y)(f=l[y]||u[y])&&(p[y]=f);for(;c<a;++c)s[c]=n[c];return new sr(s,this._parents)}function $ne(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,o=r[a],i;--a>=0;)(i=r[a])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function Fne(e){e||(e=Bne);function t(d,p){return d&&p?e(d.__data__,p.__data__):!d-!p}for(var n=this._groups,r=n.length,a=new Array(r),o=0;o<r;++o){for(var i=n[o],s=i.length,c=a[o]=new Array(s),l,u=0;u<s;++u)(l=i[u])&&(c[u]=l);c.sort(t)}return new sr(a,this._parents).order()}function Bne(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function zne(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Vne(){return Array.from(this)}function Une(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length;a<o;++a){var i=r[a];if(i)return i}return null}function Wne(){let e=0;for(const t of this)++e;return e}function Hne(){return!this.node()}function qne(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],o=0,i=a.length,s;o<i;++o)(s=a[o])&&e.call(s,s.__data__,o,a);return this}function Kne(e){return function(){this.removeAttribute(e)}}function Xne(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Zne(e,t){return function(){this.setAttribute(e,t)}}function Gne(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Qne(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Yne(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Jne(e,t){var n=ah(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Xne:Kne:typeof t=="function"?n.local?Yne:Qne:n.local?Gne:Zne)(n,t))}function ND(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ere(e){return function(){this.style.removeProperty(e)}}function tre(e,t,n){return function(){this.style.setProperty(e,t,n)}}function nre(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function rre(e,t,n){return arguments.length>1?this.each((t==null?ere:typeof t=="function"?nre:tre)(e,t,n??"")):ec(this.node(),e)}function ec(e,t){return e.style.getPropertyValue(t)||ND(e).getComputedStyle(e,null).getPropertyValue(t)}function are(e){return function(){delete this[e]}}function ore(e,t){return function(){this[e]=t}}function ire(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function sre(e,t){return arguments.length>1?this.each((t==null?are:typeof t=="function"?ire:ore)(e,t)):this.node()[e]}function MD(e){return e.trim().split(/^|\s+/)}function Jx(e){return e.classList||new PD(e)}function PD(e){this._node=e,this._names=MD(e.getAttribute("class")||"")}PD.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function kD(e,t){for(var n=Jx(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function AD(e,t){for(var n=Jx(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function cre(e){return function(){kD(this,e)}}function lre(e){return function(){AD(this,e)}}function ure(e,t){return function(){(t.apply(this,arguments)?kD:AD)(this,e)}}function dre(e,t){var n=MD(e+"");if(arguments.length<2){for(var r=Jx(this.node()),a=-1,o=n.length;++a<o;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?ure:t?cre:lre)(n,t))}function pre(){this.textContent=""}function fre(e){return function(){this.textContent=e}}function hre(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function mre(e){return arguments.length?this.each(e==null?pre:(typeof e=="function"?hre:fre)(e)):this.node().textContent}function yre(){this.innerHTML=""}function gre(e){return function(){this.innerHTML=e}}function vre(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function bre(e){return arguments.length?this.each(e==null?yre:(typeof e=="function"?vre:gre)(e)):this.node().innerHTML}function wre(){this.nextSibling&&this.parentNode.appendChild(this)}function xre(){return this.each(wre)}function _re(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function jre(){return this.each(_re)}function Sre(e){var t=typeof e=="function"?e:jD(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Ere(){return null}function Ore(e,t){var n=typeof e=="function"?e:jD(e),r=t==null?Ere:typeof t=="function"?t:Yx(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Cre(){var e=this.parentNode;e&&e.removeChild(this)}function Nre(){return this.each(Cre)}function Mre(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Pre(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function kre(e){return this.select(e?Pre:Mre)}function Are(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Tre(e){return function(t){e.call(this,t,this.__data__)}}function Ire(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Rre(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,o;n<a;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function Dre(e,t,n){return function(){var r=this.__on,a,o=Tre(t);if(r){for(var i=0,s=r.length;i<s;++i)if((a=r[i]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=o,a.options=n),a.value=t;return}}this.addEventListener(e.type,o,n),a={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(a):this.__on=[a]}}function Lre(e,t,n){var r=Ire(e+""),a,o=r.length,i;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(a=0,u=s[c];a<o;++a)if((i=r[a]).type===u.type&&i.name===u.name)return u.value}return}for(s=t?Dre:Rre,a=0;a<o;++a)this.each(s(r[a],t,n));return this}function TD(e,t,n){var r=ND(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function $re(e,t){return function(){return TD(this,e,t)}}function Fre(e,t){return function(){return TD(this,e,t.apply(this,arguments))}}function Bre(e,t){return this.each((typeof t=="function"?Fre:$re)(e,t))}function*zre(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length,i;a<o;++a)(i=r[a])&&(yield i)}var ID=[null];function sr(e,t){this._groups=e,this._parents=t}function Ru(){return new sr([[document.documentElement]],ID)}function Vre(){return this}sr.prototype=Ru.prototype={constructor:sr,select:hne,selectAll:vne,selectChild:_ne,selectChildren:One,filter:Cne,data:Tne,enter:Nne,exit:Rne,join:Dne,merge:Lne,selection:Vre,order:$ne,sort:Fne,call:zne,nodes:Vne,node:Une,size:Wne,empty:Hne,each:qne,attr:Jne,style:rre,property:sre,classed:dre,text:mre,html:bre,raise:xre,lower:jre,append:Sre,insert:Ore,remove:Nre,clone:kre,datum:Are,on:Lre,dispatch:Bre,[Symbol.iterator]:zre};function cr(e){return typeof e=="string"?new sr([[document.querySelector(e)]],[document.documentElement]):new sr([[e]],ID)}function Ure(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Vr(e,t){if(e=Ure(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const Wre={passive:!1},Du={capture:!0,passive:!1};function e1(e){e.stopImmediatePropagation()}function tc(e){e.preventDefault(),e.stopImmediatePropagation()}function RD(e){var t=e.document.documentElement,n=cr(e).on("dragstart.drag",tc,Du);"onselectstart"in t?n.on("selectstart.drag",tc,Du):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function DD(e,t){var n=e.document.documentElement,r=cr(e).on("dragstart.drag",null);t&&(r.on("click.drag",tc,Du),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const ih=e=>()=>e;function t1(e,{sourceEvent:t,subject:n,target:r,identifier:a,active:o,x:i,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}t1.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Hre(e){return!e.ctrlKey&&!e.button}function qre(){return this.parentNode}function Kre(e,t){return t??{x:e.x,y:e.y}}function Xre(){return navigator.maxTouchPoints||"ontouchstart"in this}function LD(){var e=Hre,t=qre,n=Kre,r=Xre,a={},o=nh("start","drag","end"),i=0,s,c,l,u,d=0;function p(x){x.on("mousedown.drag",f).filter(r).on("touchstart.drag",v).on("touchmove.drag",b,Wre).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(x,_){if(!(u||!e.call(this,x,_))){var S=j(this,t.call(this,x,_),x,_,"mouse");S&&(cr(x.view).on("mousemove.drag",y,Du).on("mouseup.drag",m,Du),RD(x.view),e1(x),l=!1,s=x.clientX,c=x.clientY,S("start",x))}}function y(x){if(tc(x),!l){var _=x.clientX-s,S=x.clientY-c;l=_*_+S*S>d}a.mouse("drag",x)}function m(x){cr(x.view).on("mousemove.drag mouseup.drag",null),DD(x.view,l),tc(x),a.mouse("end",x)}function v(x,_){if(e.call(this,x,_)){var S=x.changedTouches,E=t.call(this,x,_),O=S.length,M,N;for(M=0;M<O;++M)(N=j(this,E,x,_,S[M].identifier,S[M]))&&(e1(x),N("start",x,S[M]))}}function b(x){var _=x.changedTouches,S=_.length,E,O;for(E=0;E<S;++E)(O=a[_[E].identifier])&&(tc(x),O("drag",x,_[E]))}function w(x){var _=x.changedTouches,S=_.length,E,O;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),E=0;E<S;++E)(O=a[_[E].identifier])&&(e1(x),O("end",x,_[E]))}function j(x,_,S,E,O,M){var N=o.copy(),P=Vr(M||S,_),I,k,C;if((C=n.call(x,new t1("beforestart",{sourceEvent:S,target:p,identifier:O,active:i,x:P[0],y:P[1],dx:0,dy:0,dispatch:N}),E))!=null)return I=C.x-P[0]||0,k=C.y-P[1]||0,function T(A,D,L){var R=P,B;switch(A){case"start":a[O]=T,B=i++;break;case"end":delete a[O],--i;case"drag":P=Vr(L||D,_),B=i;break}N.call(A,x,new t1(A,{sourceEvent:D,subject:C,target:p,identifier:O,active:B,x:P[0]+I,y:P[1]+k,dx:P[0]-R[0],dy:P[1]-R[1],dispatch:N}),E)}}return p.filter=function(x){return arguments.length?(e=typeof x=="function"?x:ih(!!x),p):e},p.container=function(x){return arguments.length?(t=typeof x=="function"?x:ih(x),p):t},p.subject=function(x){return arguments.length?(n=typeof x=="function"?x:ih(x),p):n},p.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:ih(!!x),p):r},p.on=function(){var x=o.on.apply(o,arguments);return x===o?p:x},p.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,p):Math.sqrt(d)},p}function n1(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function $D(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Lu(){}var $u=.7,sh=1/$u,nc="\\s*([+-]?\\d+)\\s*",Fu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ja="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zre=/^#([0-9a-f]{3,8})$/,Gre=new RegExp(`^rgb\\(${nc},${nc},${nc}\\)$`),Qre=new RegExp(`^rgb\\(${ja},${ja},${ja}\\)$`),Yre=new RegExp(`^rgba\\(${nc},${nc},${nc},${Fu}\\)$`),Jre=new RegExp(`^rgba\\(${ja},${ja},${ja},${Fu}\\)$`),eae=new RegExp(`^hsl\\(${Fu},${ja},${ja}\\)$`),tae=new RegExp(`^hsla\\(${Fu},${ja},${ja},${Fu}\\)$`),FD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};n1(Lu,Vi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:BD,formatHex:BD,formatHex8:nae,formatHsl:rae,formatRgb:zD,toString:zD});function BD(){return this.rgb().formatHex()}function nae(){return this.rgb().formatHex8()}function rae(){return qD(this).formatHsl()}function zD(){return this.rgb().formatRgb()}function Vi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Zre.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?VD(t):n===3?new Un(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ch(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ch(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Gre.exec(e))?new Un(t[1],t[2],t[3],1):(t=Qre.exec(e))?new Un(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Yre.exec(e))?ch(t[1],t[2],t[3],t[4]):(t=Jre.exec(e))?ch(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=eae.exec(e))?HD(t[1],t[2]/100,t[3]/100,1):(t=tae.exec(e))?HD(t[1],t[2]/100,t[3]/100,t[4]):FD.hasOwnProperty(e)?VD(FD[e]):e==="transparent"?new Un(NaN,NaN,NaN,0):null}function VD(e){return new Un(e>>16&255,e>>8&255,e&255,1)}function ch(e,t,n,r){return r<=0&&(e=t=n=NaN),new Un(e,t,n,r)}function aae(e){return e instanceof Lu||(e=Vi(e)),e?(e=e.rgb(),new Un(e.r,e.g,e.b,e.opacity)):new Un}function r1(e,t,n,r){return arguments.length===1?aae(e):new Un(e,t,n,r??1)}function Un(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}n1(Un,r1,$D(Lu,{brighter(e){return e=e==null?sh:Math.pow(sh,e),new Un(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?$u:Math.pow($u,e),new Un(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Un(Ui(this.r),Ui(this.g),Ui(this.b),lh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:UD,formatHex:UD,formatHex8:oae,formatRgb:WD,toString:WD}));function UD(){return`#${Wi(this.r)}${Wi(this.g)}${Wi(this.b)}`}function oae(){return`#${Wi(this.r)}${Wi(this.g)}${Wi(this.b)}${Wi((isNaN(this.opacity)?1:this.opacity)*255)}`}function WD(){const e=lh(this.opacity);return`${e===1?"rgb(":"rgba("}${Ui(this.r)}, ${Ui(this.g)}, ${Ui(this.b)}${e===1?")":`, ${e})`}`}function lh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ui(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wi(e){return e=Ui(e),(e<16?"0":"")+e.toString(16)}function HD(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ur(e,t,n,r)}function qD(e){if(e instanceof Ur)return new Ur(e.h,e.s,e.l,e.opacity);if(e instanceof Lu||(e=Vi(e)),!e)return new Ur;if(e instanceof Ur)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,s=o-a,c=(o+a)/2;return s?(t===o?i=(n-r)/s+(n<r)*6:n===o?i=(r-t)/s+2:i=(t-n)/s+4,s/=c<.5?o+a:2-o-a,i*=60):s=c>0&&c<1?0:i,new Ur(i,s,c,e.opacity)}function iae(e,t,n,r){return arguments.length===1?qD(e):new Ur(e,t,n,r??1)}function Ur(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}n1(Ur,iae,$D(Lu,{brighter(e){return e=e==null?sh:Math.pow(sh,e),new Ur(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?$u:Math.pow($u,e),new Ur(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Un(a1(e>=240?e-240:e+120,a,r),a1(e,a,r),a1(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new Ur(KD(this.h),uh(this.s),uh(this.l),lh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=lh(this.opacity);return`${e===1?"hsl(":"hsla("}${KD(this.h)}, ${uh(this.s)*100}%, ${uh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function KD(e){return e=(e||0)%360,e<0?e+360:e}function uh(e){return Math.max(0,Math.min(1,e||0))}function a1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const o1=e=>()=>e;function sae(e,t){return function(n){return e+n*t}}function cae(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function lae(e){return(e=+e)==1?XD:function(t,n){return n-t?cae(t,n,e):o1(isNaN(t)?n:t)}}function XD(e,t){var n=t-e;return n?sae(e,n):o1(isNaN(e)?t:e)}const dh=function e(t){var n=lae(t);function r(a,o){var i=n((a=r1(a)).r,(o=r1(o)).r),s=n(a.g,o.g),c=n(a.b,o.b),l=XD(a.opacity,o.opacity);return function(u){return a.r=i(u),a.g=s(u),a.b=c(u),a.opacity=l(u),a+""}}return r.gamma=e,r}(1);function uae(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(o){for(a=0;a<n;++a)r[a]=e[a]*(1-o)+t[a]*o;return r}}function dae(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function pae(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),o=new Array(n),i;for(i=0;i<r;++i)a[i]=rc(e[i],t[i]);for(;i<n;++i)o[i]=t[i];return function(s){for(i=0;i<r;++i)o[i]=a[i](s);return o}}function fae(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Wr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function hae(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=rc(e[a],t[a]):r[a]=t[a];return function(o){for(a in n)r[a]=n[a](o);return r}}var i1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,s1=new RegExp(i1.source,"g");function mae(e){return function(){return e}}function yae(e){return function(t){return e(t)+""}}function ZD(e,t){var n=i1.lastIndex=s1.lastIndex=0,r,a,o,i=-1,s=[],c=[];for(e=e+"",t=t+"";(r=i1.exec(e))&&(a=s1.exec(t));)(o=a.index)>n&&(o=t.slice(n,o),s[i]?s[i]+=o:s[++i]=o),(r=r[0])===(a=a[0])?s[i]?s[i]+=a:s[++i]=a:(s[++i]=null,c.push({i,x:Wr(r,a)})),n=s1.lastIndex;return n<t.length&&(o=t.slice(n),s[i]?s[i]+=o:s[++i]=o),s.length<2?c[0]?yae(c[0].x):mae(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)s[(d=c[u]).i]=d.x(l);return s.join("")})}function rc(e,t){var n=typeof t,r;return t==null||n==="boolean"?o1(t):(n==="number"?Wr:n==="string"?(r=Vi(t))?(t=r,dh):ZD:t instanceof Vi?dh:t instanceof Date?fae:dae(t)?uae:Array.isArray(t)?pae:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?hae:Wr)(e,t)}function c1(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var GD=180/Math.PI,QD={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function YD(e,t,n,r,a,o){var i,s,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:a,translateY:o,rotate:Math.atan2(t,e)*GD,skewX:Math.atan(c)*GD,scaleX:i,scaleY:s}}var ph;function gae(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?QD:YD(t.a,t.b,t.c,t.d,t.e,t.f)}function vae(e){return e==null||(ph||(ph=document.createElementNS("http://www.w3.org/2000/svg","g")),ph.setAttribute("transform",e),!(e=ph.transform.baseVal.consolidate()))?QD:(e=e.matrix,YD(e.a,e.b,e.c,e.d,e.e,e.f))}function JD(e,t,n,r){function a(l){return l.length?l.pop()+" ":""}function o(l,u,d,p,f,y){if(l!==d||u!==p){var m=f.push("translate(",null,t,null,n);y.push({i:m-4,x:Wr(l,d)},{i:m-2,x:Wr(u,p)})}else(d||p)&&f.push("translate("+d+t+p+n)}function i(l,u,d,p){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),p.push({i:d.push(a(d)+"rotate(",null,r)-2,x:Wr(l,u)})):u&&d.push(a(d)+"rotate("+u+r)}function s(l,u,d,p){l!==u?p.push({i:d.push(a(d)+"skewX(",null,r)-2,x:Wr(l,u)}):u&&d.push(a(d)+"skewX("+u+r)}function c(l,u,d,p,f,y){if(l!==d||u!==p){var m=f.push(a(f)+"scale(",null,",",null,")");y.push({i:m-4,x:Wr(l,d)},{i:m-2,x:Wr(u,p)})}else(d!==1||p!==1)&&f.push(a(f)+"scale("+d+","+p+")")}return function(l,u){var d=[],p=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,d,p),i(l.rotate,u.rotate,d,p),s(l.skewX,u.skewX,d,p),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,p),l=u=null,function(f){for(var y=-1,m=p.length,v;++y<m;)d[(v=p[y]).i]=v.x(f);return d.join("")}}}var bae=JD(gae,"px, ","px)","deg)"),wae=JD(vae,", ",")",")"),xae=1e-12;function e3(e){return((e=Math.exp(e))+1/e)/2}function _ae(e){return((e=Math.exp(e))-1/e)/2}function jae(e){return((e=Math.exp(2*e))-1)/(e+1)}const Sae=function e(t,n,r){function a(o,i){var s=o[0],c=o[1],l=o[2],u=i[0],d=i[1],p=i[2],f=u-s,y=d-c,m=f*f+y*y,v,b;if(m<xae)b=Math.log(p/l)/t,v=function(E){return[s+E*f,c+E*y,l*Math.exp(t*E*b)]};else{var w=Math.sqrt(m),j=(p*p-l*l+r*m)/(2*l*n*w),x=(p*p-l*l-r*m)/(2*p*n*w),_=Math.log(Math.sqrt(j*j+1)-j),S=Math.log(Math.sqrt(x*x+1)-x);b=(S-_)/t,v=function(E){var O=E*b,M=e3(_),N=l/(n*w)*(M*jae(t*O+_)-_ae(_));return[s+N*f,c+N*y,l*M/e3(t*O+_)]}}return v.duration=b*1e3*t/Math.SQRT2,v}return a.rho=function(o){var i=Math.max(.001,+o),s=i*i,c=s*s;return e(i,s,c)},a}(Math.SQRT2,2,4);function Eae(e,t){t===void 0&&(t=e,e=rc);for(var n=0,r=t.length-1,a=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(a,a=t[++n]);return function(i){var s=Math.max(0,Math.min(r-1,Math.floor(i*=r)));return o[s](i-s)}}var ac=0,Bu=0,zu=0,t3=1e3,fh,Vu,hh=0,Hi=0,mh=0,Uu=typeof performance=="object"&&performance.now?performance:Date,n3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function l1(){return Hi||(n3(Oae),Hi=Uu.now()+mh)}function Oae(){Hi=0}function yh(){this._call=this._time=this._next=null}yh.prototype=r3.prototype={constructor:yh,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?l1():+n)+(t==null?0:+t),!this._next&&Vu!==this&&(Vu?Vu._next=this:fh=this,Vu=this),this._call=e,this._time=n,u1()},stop:function(){this._call&&(this._call=null,this._time=1/0,u1())}};function r3(e,t,n){var r=new yh;return r.restart(e,t,n),r}function Cae(){l1(),++ac;for(var e=fh,t;e;)(t=Hi-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ac}function a3(){Hi=(hh=Uu.now())+mh,ac=Bu=0;try{Cae()}finally{ac=0,Mae(),Hi=0}}function Nae(){var e=Uu.now(),t=e-hh;t>t3&&(mh-=t,hh=e)}function Mae(){for(var e,t=fh,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:fh=n);Vu=e,u1(r)}function u1(e){if(!ac){Bu&&(Bu=clearTimeout(Bu));var t=e-Hi;t>24?(e<1/0&&(Bu=setTimeout(a3,e-Uu.now()-mh)),zu&&(zu=clearInterval(zu))):(zu||(hh=Uu.now(),zu=setInterval(Nae,t3)),ac=1,n3(a3))}}function o3(e,t,n){var r=new yh;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var Pae=nh("start","end","cancel","interrupt"),kae=[],i3=0,s3=1,d1=2,gh=3,c3=4,p1=5,vh=6;function bh(e,t,n,r,a,o){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;Aae(e,n,{name:t,index:r,group:a,on:Pae,tween:kae,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:i3})}function f1(e,t){var n=Hr(e,t);if(n.state>i3)throw new Error("too late; already scheduled");return n}function Sa(e,t){var n=Hr(e,t);if(n.state>gh)throw new Error("too late; already running");return n}function Hr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Aae(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=r3(o,0,n.time);function o(l){n.state=s3,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var u,d,p,f;if(n.state!==s3)return c();for(u in r)if(f=r[u],f.name===n.name){if(f.state===gh)return o3(i);f.state===c3?(f.state=vh,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete r[u]):+u<t&&(f.state=vh,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete r[u])}if(o3(function(){n.state===gh&&(n.state=c3,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=d1,n.on.call("start",e,e.__data__,n.index,n.group),n.state===d1){for(n.state=gh,a=new Array(p=n.tween.length),u=0,d=-1;u<p;++u)(f=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(a[++d]=f);a.length=d+1}}function s(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=p1,1),d=-1,p=a.length;++d<p;)a[d].call(e,u);n.state===p1&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=vh,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function wh(e,t){var n=e.__transition,r,a,o=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){o=!1;continue}a=r.state>d1&&r.state<p1,r.state=vh,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}o&&delete e.__transition}}function Tae(e){return this.each(function(){wh(this,e)})}function Iae(e,t){var n,r;return function(){var a=Sa(this,e),o=a.tween;if(o!==n){r=n=o;for(var i=0,s=r.length;i<s;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}a.tween=r}}function Rae(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var o=Sa(this,e),i=o.tween;if(i!==r){a=(r=i).slice();for(var s={name:t,value:n},c=0,l=a.length;c<l;++c)if(a[c].name===t){a[c]=s;break}c===l&&a.push(s)}o.tween=a}}function Dae(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Hr(this.node(),n).tween,a=0,o=r.length,i;a<o;++a)if((i=r[a]).name===e)return i.value;return null}return this.each((t==null?Iae:Rae)(n,e,t))}function h1(e,t,n){var r=e._id;return e.each(function(){var a=Sa(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return Hr(a,r).value[t]}}function l3(e,t){var n;return(typeof t=="number"?Wr:t instanceof Vi?dh:(n=Vi(t))?(t=n,dh):ZD)(e,t)}function Lae(e){return function(){this.removeAttribute(e)}}function $ae(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Fae(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttribute(e);return i===a?null:i===r?o:o=t(r=i,n)}}function Bae(e,t,n){var r,a=n+"",o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===r?o:o=t(r=i,n)}}function zae(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function Vae(e,t,n){var r,a,o;return function(){var i,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=s+"",i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s)))}}function Uae(e,t){var n=ah(e),r=n==="transform"?wae:l3;return this.attrTween(e,typeof t=="function"?(n.local?Vae:zae)(n,r,h1(this,"attr."+e,t)):t==null?(n.local?$ae:Lae)(n):(n.local?Bae:Fae)(n,r,t))}function Wae(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Hae(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function qae(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Hae(e,o)),n}return a._value=t,a}function Kae(e,t){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Wae(e,o)),n}return a._value=t,a}function Xae(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=ah(e);return this.tween(n,(r.local?qae:Kae)(r,t))}function Zae(e,t){return function(){f1(this,e).delay=+t.apply(this,arguments)}}function Gae(e,t){return t=+t,function(){f1(this,e).delay=t}}function Qae(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Zae:Gae)(t,e)):Hr(this.node(),t).delay}function Yae(e,t){return function(){Sa(this,e).duration=+t.apply(this,arguments)}}function Jae(e,t){return t=+t,function(){Sa(this,e).duration=t}}function eoe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Yae:Jae)(t,e)):Hr(this.node(),t).duration}function toe(e,t){if(typeof t!="function")throw new Error;return function(){Sa(this,e).ease=t}}function noe(e){var t=this._id;return arguments.length?this.each(toe(t,e)):Hr(this.node(),t).ease}function roe(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Sa(this,e).ease=n}}function aoe(e){if(typeof e!="function")throw new Error;return this.each(roe(this._id,e))}function ooe(e){typeof e!="function"&&(e=ED(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var o=t[a],i=o.length,s=r[a]=[],c,l=0;l<i;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&s.push(c);return new ho(r,this._parents,this._name,this._id)}function ioe(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,o=Math.min(r,a),i=new Array(r),s=0;s<o;++s)for(var c=t[s],l=n[s],u=c.length,d=i[s]=new Array(u),p,f=0;f<u;++f)(p=c[f]||l[f])&&(d[f]=p);for(;s<r;++s)i[s]=t[s];return new ho(i,this._parents,this._name,this._id)}function soe(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function coe(e,t,n){var r,a,o=soe(t)?f1:Sa;return function(){var i=o(this,e),s=i.on;s!==r&&(a=(r=s).copy()).on(t,n),i.on=a}}function loe(e,t){var n=this._id;return arguments.length<2?Hr(this.node(),n).on.on(e):this.each(coe(n,e,t))}function uoe(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function doe(){return this.on("end.remove",uoe(this._id))}function poe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Yx(e));for(var r=this._groups,a=r.length,o=new Array(a),i=0;i<a;++i)for(var s=r[i],c=s.length,l=o[i]=new Array(c),u,d,p=0;p<c;++p)(u=s[p])&&(d=e.call(u,u.__data__,p,s))&&("__data__"in u&&(d.__data__=u.__data__),l[p]=d,bh(l[p],t,n,p,l,Hr(u,n)));return new ho(o,this._parents,t,n)}function foe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=SD(e));for(var r=this._groups,a=r.length,o=[],i=[],s=0;s<a;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var p=e.call(u,u.__data__,d,c),f,y=Hr(u,n),m=0,v=p.length;m<v;++m)(f=p[m])&&bh(f,t,n,m,p,y);o.push(p),i.push(u)}return new ho(o,i,t,n)}var hoe=Ru.prototype.constructor;function moe(){return new hoe(this._groups,this._parents)}function yoe(e,t){var n,r,a;return function(){var o=ec(this,e),i=(this.style.removeProperty(e),ec(this,e));return o===i?null:o===n&&i===r?a:a=t(n=o,r=i)}}function u3(e){return function(){this.style.removeProperty(e)}}function goe(e,t,n){var r,a=n+"",o;return function(){var i=ec(this,e);return i===a?null:i===r?o:o=t(r=i,n)}}function voe(e,t,n){var r,a,o;return function(){var i=ec(this,e),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),ec(this,e))),i===c?null:i===r&&c===a?o:(a=c,o=t(r=i,s))}}function boe(e,t){var n,r,a,o="style."+t,i="end."+o,s;return function(){var c=Sa(this,e),l=c.on,u=c.value[o]==null?s||(s=u3(t)):void 0;(l!==n||a!==u)&&(r=(n=l).copy()).on(i,a=u),c.on=r}}function woe(e,t,n){var r=(e+="")=="transform"?bae:l3;return t==null?this.styleTween(e,yoe(e,r)).on("end.style."+e,u3(e)):typeof t=="function"?this.styleTween(e,voe(e,r,h1(this,"style."+e,t))).each(boe(this._id,e)):this.styleTween(e,goe(e,r,t),n).on("end.style."+e,null)}function xoe(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function _oe(e,t,n){var r,a;function o(){var i=t.apply(this,arguments);return i!==a&&(r=(a=i)&&xoe(e,i,n)),r}return o._value=t,o}function joe(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,_oe(e,t,n??""))}function Soe(e){return function(){this.textContent=e}}function Eoe(e){return function(){var t=e(this);this.textContent=t??""}}function Ooe(e){return this.tween("text",typeof e=="function"?Eoe(h1(this,"text",e)):Soe(e==null?"":e+""))}function Coe(e){return function(t){this.textContent=e.call(this,t)}}function Noe(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&Coe(a)),t}return r._value=e,r}function Moe(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Noe(e))}function Poe(){for(var e=this._name,t=this._id,n=d3(),r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)if(c=i[l]){var u=Hr(c,t);bh(c,e,n,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ho(r,this._parents,e,n)}function koe(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(o,i){var s={value:i},c={value:function(){--a===0&&o()}};n.each(function(){var l=Sa(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),l.on=t}),a===0&&o()})}var Aoe=0;function ho(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function d3(){return++Aoe}var mo=Ru.prototype;ho.prototype={constructor:ho,select:poe,selectAll:foe,selectChild:mo.selectChild,selectChildren:mo.selectChildren,filter:ooe,merge:ioe,selection:moe,transition:Poe,call:mo.call,nodes:mo.nodes,node:mo.node,size:mo.size,empty:mo.empty,each:mo.each,on:loe,attr:Uae,attrTween:Xae,style:woe,styleTween:joe,text:Ooe,textTween:Moe,remove:doe,tween:Dae,delay:Qae,duration:eoe,ease:noe,easeVarying:aoe,end:koe,[Symbol.iterator]:mo[Symbol.iterator]};function Toe(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Ioe={time:null,delay:0,duration:250,ease:Toe};function Roe(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Doe(e){var t,n;e instanceof ho?(t=e._id,e=e._name):(t=d3(),(n=Ioe).time=l1(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,o=0;o<a;++o)for(var i=r[o],s=i.length,c,l=0;l<s;++l)(c=i[l])&&bh(c,e,t,l,i,n||Roe(c,t));return new ho(r,this._parents,e,t)}Ru.prototype.interrupt=Tae,Ru.prototype.transition=Doe;const xh=e=>()=>e;function Loe(e,{sourceEvent:t,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function yo(e,t,n){this.k=e,this.x=t,this.y=n}yo.prototype={constructor:yo,scale:function(e){return e===1?this:new yo(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new yo(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var _h=new yo(1,0,0);p3.prototype=yo.prototype;function p3(e){for(;!e.__zoom;)if(!(e=e.parentNode))return _h;return e.__zoom}function m1(e){e.stopImmediatePropagation()}function Wu(e){e.preventDefault(),e.stopImmediatePropagation()}function $oe(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Foe(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function f3(){return this.__zoom||_h}function Boe(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function zoe(){return navigator.maxTouchPoints||"ontouchstart"in this}function Voe(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function h3(){var e=$oe,t=Foe,n=Voe,r=Boe,a=zoe,o=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,c=Sae,l=nh("start","zoom","end"),u,d,p,f=500,y=150,m=0,v=10;function b(C){C.property("__zoom",f3).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",N).filter(a).on("touchstart.zoom",P).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(C,T,A,D){var L=C.selection?C.selection():C;L.property("__zoom",f3),C!==L?_(C,T,A,D):L.interrupt().each(function(){S(this,arguments).event(D).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},b.scaleBy=function(C,T,A,D){b.scaleTo(C,function(){var L=this.__zoom.k,R=typeof T=="function"?T.apply(this,arguments):T;return L*R},A,D)},b.scaleTo=function(C,T,A,D){b.transform(C,function(){var L=t.apply(this,arguments),R=this.__zoom,B=A==null?x(L):typeof A=="function"?A.apply(this,arguments):A,z=R.invert(B),$=typeof T=="function"?T.apply(this,arguments):T;return n(j(w(R,$),B,z),L,i)},A,D)},b.translateBy=function(C,T,A,D){b.transform(C,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),i)},null,D)},b.translateTo=function(C,T,A,D,L){b.transform(C,function(){var R=t.apply(this,arguments),B=this.__zoom,z=D==null?x(R):typeof D=="function"?D.apply(this,arguments):D;return n(_h.translate(z[0],z[1]).scale(B.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof A=="function"?-A.apply(this,arguments):-A),R,i)},D,L)};function w(C,T){return T=Math.max(o[0],Math.min(o[1],T)),T===C.k?C:new yo(T,C.x,C.y)}function j(C,T,A){var D=T[0]-A[0]*C.k,L=T[1]-A[1]*C.k;return D===C.x&&L===C.y?C:new yo(C.k,D,L)}function x(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function _(C,T,A,D){C.on("start.zoom",function(){S(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(D).end()}).tween("zoom",function(){var L=this,R=arguments,B=S(L,R).event(D),z=t.apply(L,R),$=A==null?x(z):typeof A=="function"?A.apply(L,R):A,V=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),Y=L.__zoom,G=typeof T=="function"?T.apply(L,R):T,K=c(Y.invert($).concat(V/Y.k),G.invert($).concat(V/G.k));return function(Q){if(Q===1)Q=G;else{var q=K(Q),H=V/q[2];Q=new yo(H,$[0]-q[0]*H,$[1]-q[1]*H)}B.zoom(null,Q)}})}function S(C,T,A){return!A&&C.__zooming||new E(C,T)}function E(C,T){this.that=C,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,T),this.taps=0}E.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,T){return this.mouse&&C!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var T=cr(this.that).datum();l.call(C,this.that,new Loe(C,{sourceEvent:this.sourceEvent,target:b,type:C,transform:this.that.__zoom,dispatch:l}),T)}};function O(C,...T){if(!e.apply(this,arguments))return;var A=S(this,T).event(C),D=this.__zoom,L=Math.max(o[0],Math.min(o[1],D.k*Math.pow(2,r.apply(this,arguments)))),R=Vr(C);if(A.wheel)(A.mouse[0][0]!==R[0]||A.mouse[0][1]!==R[1])&&(A.mouse[1]=D.invert(A.mouse[0]=R)),clearTimeout(A.wheel);else{if(D.k===L)return;A.mouse=[R,D.invert(R)],wh(this),A.start()}Wu(C),A.wheel=setTimeout(B,y),A.zoom("mouse",n(j(w(D,L),A.mouse[0],A.mouse[1]),A.extent,i));function B(){A.wheel=null,A.end()}}function M(C,...T){if(p||!e.apply(this,arguments))return;var A=C.currentTarget,D=S(this,T,!0).event(C),L=cr(C.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",V,!0),R=Vr(C,A),B=C.clientX,z=C.clientY;RD(C.view),m1(C),D.mouse=[R,this.__zoom.invert(R)],wh(this),D.start();function $(Y){if(Wu(Y),!D.moved){var G=Y.clientX-B,K=Y.clientY-z;D.moved=G*G+K*K>m}D.event(Y).zoom("mouse",n(j(D.that.__zoom,D.mouse[0]=Vr(Y,A),D.mouse[1]),D.extent,i))}function V(Y){L.on("mousemove.zoom mouseup.zoom",null),DD(Y.view,D.moved),Wu(Y),D.event(Y).end()}}function N(C,...T){if(e.apply(this,arguments)){var A=this.__zoom,D=Vr(C.changedTouches?C.changedTouches[0]:C,this),L=A.invert(D),R=A.k*(C.shiftKey?.5:2),B=n(j(w(A,R),D,L),t.apply(this,T),i);Wu(C),s>0?cr(this).transition().duration(s).call(_,B,D,C):cr(this).call(b.transform,B,D,C)}}function P(C,...T){if(e.apply(this,arguments)){var A=C.touches,D=A.length,L=S(this,T,C.changedTouches.length===D).event(C),R,B,z,$;for(m1(C),B=0;B<D;++B)z=A[B],$=Vr(z,this),$=[$,this.__zoom.invert($),z.identifier],L.touch0?!L.touch1&&L.touch0[2]!==$[2]&&(L.touch1=$,L.taps=0):(L.touch0=$,R=!0,L.taps=1+!!u);u&&(u=clearTimeout(u)),R&&(L.taps<2&&(d=$[0],u=setTimeout(function(){u=null},f)),wh(this),L.start())}}function I(C,...T){if(this.__zooming){var A=S(this,T).event(C),D=C.changedTouches,L=D.length,R,B,z,$;for(Wu(C),R=0;R<L;++R)B=D[R],z=Vr(B,this),A.touch0&&A.touch0[2]===B.identifier?A.touch0[0]=z:A.touch1&&A.touch1[2]===B.identifier&&(A.touch1[0]=z);if(B=A.that.__zoom,A.touch1){var V=A.touch0[0],Y=A.touch0[1],G=A.touch1[0],K=A.touch1[1],Q=(Q=G[0]-V[0])*Q+(Q=G[1]-V[1])*Q,q=(q=K[0]-Y[0])*q+(q=K[1]-Y[1])*q;B=w(B,Math.sqrt(Q/q)),z=[(V[0]+G[0])/2,(V[1]+G[1])/2],$=[(Y[0]+K[0])/2,(Y[1]+K[1])/2]}else if(A.touch0)z=A.touch0[0],$=A.touch0[1];else return;A.zoom("touch",n(j(B,z,$),A.extent,i))}}function k(C,...T){if(this.__zooming){var A=S(this,T).event(C),D=C.changedTouches,L=D.length,R,B;for(m1(C),p&&clearTimeout(p),p=setTimeout(function(){p=null},f),R=0;R<L;++R)B=D[R],A.touch0&&A.touch0[2]===B.identifier?delete A.touch0:A.touch1&&A.touch1[2]===B.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(B=Vr(B,this),Math.hypot(d[0]-B[0],d[1]-B[1])<v)){var z=cr(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return b.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:xh(+C),b):r},b.filter=function(C){return arguments.length?(e=typeof C=="function"?C:xh(!!C),b):e},b.touchable=function(C){return arguments.length?(a=typeof C=="function"?C:xh(!!C),b):a},b.extent=function(C){return arguments.length?(t=typeof C=="function"?C:xh([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),b):t},b.scaleExtent=function(C){return arguments.length?(o[0]=+C[0],o[1]=+C[1],b):[o[0],o[1]]},b.translateExtent=function(C){return arguments.length?(i[0][0]=+C[0][0],i[1][0]=+C[1][0],i[0][1]=+C[0][1],i[1][1]=+C[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(C){return arguments.length?(n=C,b):n},b.duration=function(C){return arguments.length?(s=+C,b):s},b.interpolate=function(C){return arguments.length?(c=C,b):c},b.on=function(){var C=l.on.apply(l,arguments);return C===l?b:C},b.clickDistance=function(C){return arguments.length?(m=(C=+C)*C,b):Math.sqrt(m)},b.tapDistance=function(C){return arguments.length?(v=+C,b):v},b}const go={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},Hu=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],m3=["Enter"," ","Escape"];var oc;(function(e){e.Strict="strict",e.Loose="loose"})(oc||(oc={}));var ti;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ti||(ti={}));var qu;(function(e){e.Partial="partial",e.Full="full"})(qu||(qu={}));const y3={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var ni;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ni||(ni={}));var jh;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(jh||(jh={}));var fe;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(fe||(fe={}));const g3={[fe.Left]:fe.Right,[fe.Right]:fe.Left,[fe.Top]:fe.Bottom,[fe.Bottom]:fe.Top};function Uoe(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function v3(e,t,n){if(!n)return;const r=[];e.forEach((a,o)=>{t!=null&&t.has(o)||r.push(a)}),r.length&&n(r)}function b3(e){return e===null?null:e?"valid":"invalid"}const w3=e=>"id"in e&&"source"in e&&"target"in e,Woe=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),y1=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Ku=(e,t=[0,0])=>{const{width:n,height:r}=vo(e),a=e.origin??t,o=n*a[0],i=r*a[1];return{x:e.position.x-o,y:e.position.y-i}},Hoe=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,a)=>{const o=typeof a=="string";let i=!t.nodeLookup&&!o?a:void 0;t.nodeLookup&&(i=o?t.nodeLookup.get(a):y1(a)?a:t.nodeLookup.get(a.id));const s=i?Oh(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Sh(r,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Eh(n)},Xu=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const a=Oh(r);n=Sh(n,a)}}),Eh(n)},x3=(e,t,[n,r,a]=[0,0,1],o=!1,i=!1)=>{const s={...Gu(t,[n,r,a]),width:t.width/a,height:t.height/a},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:p=!1}=l;if(i&&!d||p)continue;const f=u.width??l.width??l.initialWidth??null,y=u.height??l.height??l.initialHeight??null,m=Zu(s,sc(l)),v=(f??0)*(y??0),b=o&&m>0;(!l.internals.handleBounds||b||m>=v||l.dragging)&&c.push(l)}return c},qoe=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function g1(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&(t!=null&&t.includeHiddenNodes||!a.hidden)&&(!r||r.has(a.id))&&n.set(a.id,a)}),n}async function v1({nodes:e,width:t,height:n,panZoom:r,minZoom:a,maxZoom:o},i){if(e.size===0)return Promise.resolve(!1);const s=Xu(e),c=w1(s,t,n,(i==null?void 0:i.minZoom)??a,(i==null?void 0:i.maxZoom)??o,(i==null?void 0:i.padding)??.1);return await r.setViewport(c,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function _3({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:a,onError:o}){const i=n.get(e),s=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=s?s.internals.positionAbsolute:{x:0,y:0},u=i.origin??r;let d=a;if(i.extent==="parent"&&!i.expandParent)if(!s)o==null||o("005",go.error005());else{const f=s.measured.width,y=s.measured.height;f&&y&&(d=[[c,l],[c+f,l+y]])}else s&&cc(i.extent)&&(d=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const p=cc(d)?qi(t,d,i.measured):t;return{position:{x:p.x-c+i.measured.width*u[0],y:p.y-l+i.measured.height*u[1]},positionAbsolute:p}}async function Koe({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:a}){const o=new Set(e.map(d=>d.id)),i=[];for(const d of n){if(d.deletable===!1)continue;const p=o.has(d.id),f=!p&&d.parentId&&i.find(y=>y.id===d.parentId);(p||f)&&i.push(d)}const s=new Set(t.map(d=>d.id)),c=r.filter(d=>d.deletable!==!1),l=qoe(i,c);for(const d of c)s.has(d.id)&&!l.find(p=>p.id===d.id)&&l.push(d);if(!a)return{edges:l,nodes:i};const u=await a({nodes:i,edges:l});return typeof u=="boolean"?u?{edges:l,nodes:i}:{edges:[],nodes:[]}:u}const ic=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),qi=(e={x:0,y:0},t,n)=>({x:ic(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:ic(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function j3(e,t,n){const{width:r,height:a}=vo(n),{x:o,y:i}=n.internals.positionAbsolute;return qi(e,[[o,i],[o+r,i+a]],t)}const S3=(e,t,n)=>e<t?ic(Math.abs(e-t),1,t)/t:e>n?-ic(Math.abs(e-n),1,t)/t:0,E3=(e,t,n=15,r=40)=>{const a=S3(e.x,r,t.width-r)*n,o=S3(e.y,r,t.height-r)*n;return[a,o]},Sh=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),b1=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Eh=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),sc=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=y1(e)?e.internals.positionAbsolute:Ku(e,t);return{x:n,y:r,width:((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0,height:((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0}},Oh=(e,t=[0,0])=>{var a,o;const{x:n,y:r}=y1(e)?e.internals.positionAbsolute:Ku(e,t);return{x:n,y:r,x2:n+(((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0),y2:r+(((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0)}},O3=(e,t)=>Eh(Sh(b1(e),b1(t))),Zu=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},C3=e=>qr(e.width)&&qr(e.height)&&qr(e.x)&&qr(e.y),qr=e=>!isNaN(e)&&isFinite(e),Xoe=(e,t)=>{},Ch=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Gu=({x:e,y:t},[n,r,a],o=!1,i=[1,1])=>{const s={x:(e-n)/a,y:(t-r)/a};return o?Ch(s,i):s},N3=({x:e,y:t},[n,r,a])=>({x:e*a+n,y:t*a+r}),w1=(e,t,n,r,a,o)=>{const i=t/(e.width*(1+o)),s=n/(e.height*(1+o)),c=Math.min(i,s),l=ic(c,r,a),u=e.x+e.width/2,d=e.y+e.height/2,p=t/2-u*l,f=n/2-d*l;return{x:p,y:f,zoom:l}},Nh=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function cc(e){return e!==void 0&&e!=="parent"}function vo(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function M3(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function P3(e,t={width:0,height:0},n,r,a){const o={...e},i=r.get(n);if(i){const s=i.origin||a;o.x+=i.internals.positionAbsolute.x-(t.width??0)*s[0],o.y+=i.internals.positionAbsolute.y-(t.height??0)*s[1]}return o}function Qu(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:a}){const{x:o,y:i}=bo(e),s=Gu({x:o-((a==null?void 0:a.left)??0),y:i-((a==null?void 0:a.top)??0)},r),{x:c,y:l}=n?Ch(s,t):s;return{xSnapped:c,ySnapped:l,...s}}const Mh=e=>({width:e.offsetWidth,height:e.offsetHeight}),k3=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Zoe=["INPUT","SELECT","TEXTAREA"];function x1(e){var n,r;const t=((r=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:r[0])||e.target;return Zoe.includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}const A3=e=>"clientX"in e,bo=(e,t)=>{var o,i;const n=A3(e),r=n?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,a=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:a-((t==null?void 0:t.top)??0)}},T3=(e,t,n,r,a)=>{const o=t.querySelectorAll(`.${e}`);return!o||!o.length?null:Array.from(o).map(i=>{const s=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:a,position:i.getAttribute("data-handlepos"),x:(s.left-n.left)/r,y:(s.top-n.top)/r,...Mh(i)}})};function I3({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:a,sourceControlY:o,targetControlX:i,targetControlY:s}){const c=e*.125+a*.375+i*.375+n*.125,l=t*.125+o*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function Ph(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function R3({pos:e,x1:t,y1:n,x2:r,y2:a,c:o}){switch(e){case fe.Left:return[t-Ph(t-r,o),n];case fe.Right:return[t+Ph(r-t,o),n];case fe.Top:return[t,n-Ph(n-a,o)];case fe.Bottom:return[t,n+Ph(a-n,o)]}}function D3({sourceX:e,sourceY:t,sourcePosition:n=fe.Bottom,targetX:r,targetY:a,targetPosition:o=fe.Top,curvature:i=.25}){const[s,c]=R3({pos:n,x1:e,y1:t,x2:r,y2:a,c:i}),[l,u]=R3({pos:o,x1:r,y1:a,x2:e,y2:t,c:i}),[d,p,f,y]=I3({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${a}`,d,p,f,y]}function L3({sourceX:e,sourceY:t,targetX:n,targetY:r}){const a=Math.abs(n-e)/2,o=n<e?n+a:n-a,i=Math.abs(r-t)/2,s=r<t?r+i:r-i;return[o,s,a,i]}function Goe({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:a=!1}){if(!a)return r;const o=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(o?i:0)}function Qoe({sourceNode:e,targetNode:t,width:n,height:r,transform:a}){const o=Sh(Oh(e),Oh(t));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const i={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:r/a[2]};return Zu(i,Eh(o))>0}const Yoe=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Joe=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),$3=(e,t)=>{if(!e.source||!e.target)return t;let n;return w3(e)?n={...e}:n={...e,id:Yoe(e)},Joe(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function F3({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[a,o,i,s]=L3({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,a,o,i,s]}const B3={[fe.Left]:{x:-1,y:0},[fe.Right]:{x:1,y:0},[fe.Top]:{x:0,y:-1},[fe.Bottom]:{x:0,y:1}},eie=({source:e,sourcePosition:t=fe.Bottom,target:n})=>t===fe.Left||t===fe.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},z3=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function tie({source:e,sourcePosition:t=fe.Bottom,target:n,targetPosition:r=fe.Top,center:a,offset:o}){const i=B3[t],s=B3[r],c={x:e.x+i.x*o,y:e.y+i.y*o},l={x:n.x+s.x*o,y:n.y+s.y*o},u=eie({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",p=u[d];let f=[],y,m;const v={x:0,y:0},b={x:0,y:0},[w,j,x,_]=L3({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[d]*s[d]===-1){y=a.x??w,m=a.y??j;const S=[{x:y,y:c.y},{x:y,y:l.y}],E=[{x:c.x,y:m},{x:l.x,y:m}];i[d]===p?f=d==="x"?S:E:f=d==="x"?E:S}else{const S=[{x:c.x,y:l.y}],E=[{x:l.x,y:c.y}];if(d==="x"?f=i.x===p?E:S:f=i.y===p?S:E,t===r){const I=Math.abs(e[d]-n[d]);if(I<=o){const k=Math.min(o-1,o-I);i[d]===p?v[d]=(c[d]>e[d]?-1:1)*k:b[d]=(l[d]>n[d]?-1:1)*k}}if(t!==r){const I=d==="x"?"y":"x",k=i[d]===s[I],C=c[I]>l[I],T=c[I]<l[I];(i[d]===1&&(!k&&C||k&&T)||i[d]!==1&&(!k&&T||k&&C))&&(f=d==="x"?S:E)}const O={x:c.x+v.x,y:c.y+v.y},M={x:l.x+b.x,y:l.y+b.y},N=Math.max(Math.abs(O.x-f[0].x),Math.abs(M.x-f[0].x)),P=Math.max(Math.abs(O.y-f[0].y),Math.abs(M.y-f[0].y));N>=P?(y=(O.x+M.x)/2,m=f[0].y):(y=f[0].x,m=(O.y+M.y)/2)}return[[e,{x:c.x+v.x,y:c.y+v.y},...f,{x:l.x+b.x,y:l.y+b.y},n],y,m,x,_]}function nie(e,t,n,r){const a=Math.min(z3(e,t)/2,z3(t,n)/2,r),{x:o,y:i}=t;if(e.x===o&&o===n.x||e.y===i&&i===n.y)return`L${o} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${o+a*l},${i}Q ${o},${i} ${o},${i+a*u}`}const s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${o},${i+a*c}Q ${o},${i} ${o+a*s},${i}`}function _1({sourceX:e,sourceY:t,sourcePosition:n=fe.Bottom,targetX:r,targetY:a,targetPosition:o=fe.Top,borderRadius:i=5,centerX:s,centerY:c,offset:l=20}){const[u,d,p,f,y]=tie({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:a},targetPosition:o,center:{x:s,y:c},offset:l});return[u.reduce((m,v,b)=>{let w="";return b>0&&b<u.length-1?w=nie(u[b-1],v,u[b+1],i):w=`${b===0?"M":"L"}${v.x} ${v.y}`,m+=w,m},""),d,p,f,y]}function V3(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function rie(e){var d;const{sourceNode:t,targetNode:n}=e;if(!V3(t)||!V3(n))return null;const r=t.internals.handleBounds||U3(t.handles),a=n.internals.handleBounds||U3(n.handles),o=W3((r==null?void 0:r.source)??[],e.sourceHandle),i=W3(e.connectionMode===oc.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),e.targetHandle);if(!o||!i)return(d=e.onError)==null||d.call(e,"008",go.error008(o?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=(o==null?void 0:o.position)||fe.Bottom,c=(i==null?void 0:i.position)||fe.Top,l=Yu(t,o,s),u=Yu(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:s,targetPosition:c}}function U3(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Yu(e,t,n=fe.Left,r=!1){const a=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,o=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:s}=t??vo(e);if(r)return{x:a+i/2,y:o+s/2};switch((t==null?void 0:t.position)??n){case fe.Top:return{x:a+i/2,y:o};case fe.Right:return{x:a+i,y:o+s/2};case fe.Bottom:return{x:a+i/2,y:o+s};case fe.Left:return{x:a,y:o+s/2}}}function W3(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function j1(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function aie(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:a}){const o=new Set;return e.reduce((i,s)=>([s.markerStart||r,s.markerEnd||a].forEach(c=>{if(c&&typeof c=="object"){const l=j1(c,t);o.has(l)||(i.push({id:l,color:c.color||n,...c}),o.add(l))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))}const S1={nodeOrigin:[0,0],nodeExtent:Hu,elevateNodesOnSelect:!0,defaults:{}},oie={...S1,checkEquality:!0};function E1(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function iie(e,t,n){const r=E1(S1,n);for(const a of e.values())if(a.parentId)C1(a,e,t,r);else{const o=Ku(a,r.nodeOrigin),i=cc(a.extent)?a.extent:r.nodeExtent,s=qi(o,i,vo(a));a.internals.positionAbsolute=s}}function O1(e,t,n,r){var s,c;const a=E1(oie,r),o=new Map(t),i=a!=null&&a.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let u=o.get(l.id);if(a.checkEquality&&l===(u==null?void 0:u.internals.userNode))t.set(l.id,u);else{const d=Ku(l,a.nodeOrigin),p=cc(l.extent)?l.extent:a.nodeExtent,f=qi(d,p,vo(l));u={...a.defaults,...l,measured:{width:(s=l.measured)==null?void 0:s.width,height:(c=l.measured)==null?void 0:c.height},internals:{positionAbsolute:f,handleBounds:l.measured?u==null?void 0:u.internals.handleBounds:void 0,z:H3(l,i),userNode:l}},t.set(l.id,u)}l.parentId&&C1(u,t,n,r)}}function sie(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function C1(e,t,n,r){const{elevateNodesOnSelect:a,nodeOrigin:o,nodeExtent:i}=E1(S1,r),s=e.parentId,c=t.get(s);if(!c){console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}sie(e,n);const l=a?1e3:0,{x:u,y:d,z:p}=cie(e,c,o,i,l),{positionAbsolute:f}=e.internals,y=u!==f.x||d!==f.y;(y||p!==e.internals.z)&&(e.internals={...e.internals,positionAbsolute:y?{x:u,y:d}:f,z:p})}function H3(e,t){return(qr(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function cie(e,t,n,r,a){const{x:o,y:i}=t.internals.positionAbsolute,s=vo(e),c=Ku(e,n),l=cc(e.extent)?qi(c,e.extent,s):c;let u=qi({x:o+l.x,y:i+l.y},r,s);e.extent==="parent"&&(u=j3(u,s,t));const d=H3(e,a),p=t.internals.z??0;return{x:u.x,y:u.y,z:p>d?p:d}}function N1(e,t,n,r=[0,0]){var i;const a=[],o=new Map;for(const s of e){const c=t.get(s.parentId);if(!c)continue;const l=((i=o.get(s.parentId))==null?void 0:i.expandedRect)??sc(c),u=O3(l,s.rect);o.set(s.parentId,{expandedRect:u,parent:c})}return o.size>0&&o.forEach(({expandedRect:s,parent:c},l)=>{var j;const u=c.internals.positionAbsolute,d=vo(c),p=c.origin??r,f=s.x<u.x?Math.round(Math.abs(u.x-s.x)):0,y=s.y<u.y?Math.round(Math.abs(u.y-s.y)):0,m=Math.max(d.width,Math.round(s.width)),v=Math.max(d.height,Math.round(s.height)),b=(m-d.width)*p[0],w=(v-d.height)*p[1];(f>0||y>0||b||w)&&(a.push({id:l,type:"position",position:{x:c.position.x-f+b,y:c.position.y-y+w}}),(j=n.get(l))==null||j.forEach(x=>{e.some(_=>_.id===x.id)||a.push({id:x.id,type:"position",position:{x:x.position.x+f,y:x.position.y+y}})})),(d.width<s.width||d.height<s.height||f||y)&&a.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:m+(f?p[0]*f-b:0),height:v+(y?p[1]*y-w:0)}})}),a}function lie(e,t,n,r,a,o){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let s=!1;if(!i)return{changes:[],updatedInternals:s};const c=[],l=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const p of e.values()){const f=t.get(p.id);if(f)if(f.hidden)f.internals={...f.internals,handleBounds:void 0},s=!0;else{const y=Mh(p.nodeElement),m=f.measured.width!==y.width||f.measured.height!==y.height;if(y.width&&y.height&&(m||!f.internals.handleBounds||p.force)){const v=p.nodeElement.getBoundingClientRect(),b=cc(f.extent)?f.extent:o;let{positionAbsolute:w}=f.internals;f.parentId&&f.extent==="parent"?w=j3(w,y,t.get(f.parentId)):b&&(w=qi(w,b,y)),f.measured=y,f.internals={...f.internals,positionAbsolute:w,handleBounds:{source:T3("source",p.nodeElement,v,u,f.id),target:T3("target",p.nodeElement,v,u,f.id)}},f.parentId&&C1(f,t,n,{nodeOrigin:a}),s=!0,m&&(c.push({id:f.id,type:"dimensions",dimensions:y}),f.expandParent&&f.parentId&&d.push({id:f.id,parentId:f.parentId,rect:sc(f,a)}))}}}if(d.length>0){const p=N1(d,t,n,a);c.push(...p)}return{changes:c,updatedInternals:s}}async function uie({delta:e,panZoom:t,transform:n,translateExtent:r,width:a,height:o}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[a,o]],r),s=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(s)}function q3(e,t,n){e.clear(),t.clear();for(const r of n){const{source:a,target:o,sourceHandle:i=null,targetHandle:s=null}=r,c=`${a}-source-${i}`,l=`${o}-target-${s}`,u=e.get(c)||new Map,d=e.get(l)||new Map,p={edgeId:r.id,source:a,target:o,sourceHandle:i,targetHandle:s};t.set(r.id,r),e.set(c,u.set(`${o}-${s}`,p)),e.set(l,d.set(`${a}-${i}`,p))}}function K3(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:K3(n,t):!1}function X3(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n)return!1;r=r.parentElement}while(r);return!1}function die(e,t,n,r){const a=new Map;for(const[o,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!K3(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const s=e.get(o);s&&a.set(o,{id:o,position:s.position||{x:0,y:0},distance:{x:n.x-s.internals.positionAbsolute.x,y:n.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return a}function M1({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,s,c;const a=[];for(const[l,u]of t){const d=(i=n.get(l))==null?void 0:i.internals.userNode;d&&a.push({...d,position:u.position,dragging:r})}if(!e)return[a[0],a];const o=(s=n.get(e))==null?void 0:s.internals.userNode;return[o?{...o,position:((c=t.get(e))==null?void 0:c.position)||o.position,dragging:r}:a[0],a]}function pie({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:a}){let o={x:null,y:null},i=0,s=new Map,c=!1,l={x:0,y:0},u=null,d=!1,p=null,f=!1;function y({noDragClassName:v,handleSelector:b,domNode:w,isSelectable:j,nodeId:x,nodeClickDistance:_=0}){p=cr(w);function S({x:N,y:P},I){const{nodeLookup:k,nodeExtent:C,snapGrid:T,snapToGrid:A,nodeOrigin:D,onNodeDrag:L,onSelectionDrag:R,onError:B,updateNodePositions:z}=t();o={x:N,y:P};let $=!1,V={x:0,y:0,x2:0,y2:0};if(s.size>1&&C){const Y=Xu(s);V=b1(Y)}for(const[Y,G]of s){if(!k.has(Y))continue;let K={x:N-G.distance.x,y:P-G.distance.y};A&&(K=Ch(K,T));let Q=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(s.size>1&&C&&!G.extent){const{positionAbsolute:X}=G.internals,te=X.x-V.x+C[0][0],F=X.x+G.measured.width-V.x2+C[1][0],se=X.y-V.y+C[0][1],re=X.y+G.measured.height-V.y2+C[1][1];Q=[[te,se],[F,re]]}const{position:q,positionAbsolute:H}=_3({nodeId:Y,nextPosition:K,nodeLookup:k,nodeExtent:Q,nodeOrigin:D,onError:B});$=$||G.position.x!==q.x||G.position.y!==q.y,G.position=q,G.internals.positionAbsolute=H}if($&&(z(s,!0),I&&(r||L||!x&&R))){const[Y,G]=M1({nodeId:x,dragItems:s,nodeLookup:k});r==null||r(I,s,Y,G),L==null||L(I,Y,G),x||(R==null||R(I,G))}}async function E(){if(!u)return;const{transform:N,panBy:P,autoPanSpeed:I}=t(),[k,C]=E3(l,u,I);(k!==0||C!==0)&&(o.x=(o.x??0)-k/N[2],o.y=(o.y??0)-C/N[2],await P({x:k,y:C})&&S(o,null)),i=requestAnimationFrame(E)}function O(N){var $;const{nodeLookup:P,multiSelectionActive:I,nodesDraggable:k,transform:C,snapGrid:T,snapToGrid:A,selectNodesOnDrag:D,onNodeDragStart:L,onSelectionDragStart:R,unselectNodesAndEdges:B}=t();d=!0,(!D||!j)&&!I&&x&&(($=P.get(x))!=null&&$.selected||B()),j&&D&&x&&(e==null||e(x));const z=Qu(N.sourceEvent,{transform:C,snapGrid:T,snapToGrid:A,containerBounds:u});if(o=z,s=die(P,k,z,x),s.size>0&&(n||L||!x&&R)){const[V,Y]=M1({nodeId:x,dragItems:s,nodeLookup:P});n==null||n(N.sourceEvent,s,V,Y),L==null||L(N.sourceEvent,V,Y),x||(R==null||R(N.sourceEvent,Y))}}const M=LD().clickDistance(_).on("start",N=>{const{domNode:P,nodeDragThreshold:I,transform:k,snapGrid:C,snapToGrid:T}=t();u=(P==null?void 0:P.getBoundingClientRect())||null,f=!1,I===0&&O(N),o=Qu(N.sourceEvent,{transform:k,snapGrid:C,snapToGrid:T,containerBounds:u}),l=bo(N.sourceEvent,u)}).on("drag",N=>{const{autoPanOnNodeDrag:P,transform:I,snapGrid:k,snapToGrid:C,nodeDragThreshold:T,nodeLookup:A}=t(),D=Qu(N.sourceEvent,{transform:I,snapGrid:k,snapToGrid:C,containerBounds:u});if((N.sourceEvent.type==="touchmove"&&N.sourceEvent.touches.length>1||x&&!A.has(x))&&(f=!0),!f){if(!c&&P&&d&&(c=!0,E()),!d){const L=D.xSnapped-(o.x??0),R=D.ySnapped-(o.y??0);Math.sqrt(L*L+R*R)>T&&O(N)}(o.x!==D.xSnapped||o.y!==D.ySnapped)&&s&&d&&(l=bo(N.sourceEvent,u),S(D,N.sourceEvent))}}).on("end",N=>{if(!(!d||f)&&(c=!1,d=!1,cancelAnimationFrame(i),s.size>0)){const{nodeLookup:P,updateNodePositions:I,onNodeDragStop:k,onSelectionDragStop:C}=t();if(I(s,!1),a||k||!x&&C){const[T,A]=M1({nodeId:x,dragItems:s,nodeLookup:P,dragging:!1});a==null||a(N.sourceEvent,s,T,A),k==null||k(N.sourceEvent,T,A),x||(C==null||C(N.sourceEvent,A))}}}).filter(N=>{const P=N.target;return!N.button&&(!v||!X3(P,`.${v}`,w))&&(!b||X3(P,b,w))});p.call(M)}function m(){p==null||p.on(".drag",null)}return{update:y,destroy:m}}function fie(e,t,n){const r=[],a={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const o of t.values())Zu(a,sc(o))>0&&r.push(o);return r}const hie=250;function mie(e,t,n,r){var s,c;let a=[],o=1/0;const i=fie(e,n,t+hie);for(const l of i){const u=[...((s=l.internals.handleBounds)==null?void 0:s.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:p,y:f}=Yu(l,d,d.position,!0),y=Math.sqrt(Math.pow(p-e.x,2)+Math.pow(f-e.y,2));y>t||(y<o?(a=[{...d,x:p,y:f}],o=y):y===o&&a.push({...d,x:p,y:f}))}}if(!a.length)return null;if(a.length>1){const l=r.type==="source"?"target":"source";return a.find(u=>u.type===l)??a[0]}return a[0]}function Z3(e,t,n,r,a,o=!1){var l,u,d;const i=r.get(e);if(!i)return null;const s=a==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((d=i.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?s==null?void 0:s.find(p=>p.id===n):s==null?void 0:s[0])??null;return c&&o?{...c,...Yu(i,c,c.position,!0)}:c}function G3(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function yie(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Q3=()=>!0;function gie(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:a,edgeUpdaterType:o,isTarget:i,domNode:s,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:p,cancelConnection:f,onConnectStart:y,onConnect:m,onConnectEnd:v,isValidConnection:b=Q3,onReconnectEnd:w,updateConnection:j,getTransform:x,getFromHandle:_,autoPanSpeed:S}){const E=k3(e.target);let O=0,M;const{x:N,y:P}=bo(e),I=E==null?void 0:E.elementFromPoint(N,P),k=G3(o,I),C=s==null?void 0:s.getBoundingClientRect();if(!C||!k)return;const T=Z3(a,k,r,c,t);if(!T)return;let A=bo(e,C),D=!1,L=null,R=!1,B=null;function z(){if(!u||!C)return;const[q,H]=E3(A,C,S);p({x:q,y:H}),O=requestAnimationFrame(z)}const $={...T,nodeId:a,type:k,position:T.position},V=c.get(a),Y={inProgress:!0,isValid:null,from:Yu(V,$,fe.Left,!0),fromHandle:$,fromPosition:$.position,fromNode:V,to:A,toHandle:null,toPosition:g3[$.position],toNode:null};j(Y);let G=Y;y==null||y(e,{nodeId:a,handleId:r,handleType:k});function K(q){if(!_()||!$){Q(q);return}const H=x();A=bo(q,C),M=mie(Gu(A,H,!1,[1,1]),n,c,$),D||(z(),D=!0);const X=Y3(q,{handle:M,connectionMode:t,fromNodeId:a,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:E,lib:l,flowId:d,nodeLookup:c});B=X.handleDomNode,L=X.connection,R=yie(!!M,X.isValid);const te={...G,isValid:R,to:M&&R?N3({x:M.x,y:M.y},H):A,toHandle:X.toHandle,toPosition:R&&X.toHandle?X.toHandle.position:g3[$.position],toNode:X.toHandle?c.get(X.toHandle.nodeId):null};R&&M&&G.toHandle&&te.toHandle&&G.toHandle.type===te.toHandle.type&&G.toHandle.nodeId===te.toHandle.nodeId&&G.toHandle.id===te.toHandle.id&&G.to.x===te.to.x&&G.to.y===te.to.y||(j(te),G=te)}function Q(q){(M||B)&&L&&R&&(m==null||m(L));const{inProgress:H,...X}=G,te={...X,toPosition:G.toHandle?G.toPosition:null};v==null||v(q,te),o&&(w==null||w(q,te)),f(),cancelAnimationFrame(O),D=!1,R=!1,L=null,B=null,E.removeEventListener("mousemove",K),E.removeEventListener("mouseup",Q),E.removeEventListener("touchmove",K),E.removeEventListener("touchend",Q)}E.addEventListener("mousemove",K),E.addEventListener("mouseup",Q),E.addEventListener("touchmove",K),E.addEventListener("touchend",Q)}function Y3(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:a,fromType:o,doc:i,lib:s,flowId:c,isValidConnection:l=Q3,nodeLookup:u}){const d=o==="target",p=t?i.querySelector(`.${s}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:f,y}=bo(e),m=i.elementFromPoint(f,y),v=m!=null&&m.classList.contains(`${s}-flow__handle`)?m:p,b={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=G3(void 0,v),j=v.getAttribute("data-nodeid"),x=v.getAttribute("data-handleid"),_=v.classList.contains("connectable"),S=v.classList.contains("connectableend");if(!j||!w)return b;const E={source:d?j:r,sourceHandle:d?x:a,target:d?r:j,targetHandle:d?a:x};b.connection=E;const O=_&&S&&(n===oc.Strict?d&&w==="source"||!d&&w==="target":j!==r||x!==a);b.isValid=O&&l(E),b.toHandle=Z3(j,w,x,u,n,!1)}return b}const P1={onPointerDown:gie,isValid:Y3};function vie({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const a=cr(e);function o({translateExtent:s,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:p=!0,inversePan:f=!1}){const y=j=>{const x=n();if(j.sourceEvent.type!=="wheel"||!t)return;const _=-j.sourceEvent.deltaY*(j.sourceEvent.deltaMode===1?.05:j.sourceEvent.deltaMode?1:.002)*u,S=x[2]*Math.pow(2,_);t.scaleTo(S)};let m=[0,0];const v=j=>{(j.sourceEvent.type==="mousedown"||j.sourceEvent.type==="touchstart")&&(m=[j.sourceEvent.clientX??j.sourceEvent.touches[0].clientX,j.sourceEvent.clientY??j.sourceEvent.touches[0].clientY])},b=j=>{const x=n();if(j.sourceEvent.type!=="mousemove"&&j.sourceEvent.type!=="touchmove"||!t)return;const _=[j.sourceEvent.clientX??j.sourceEvent.touches[0].clientX,j.sourceEvent.clientY??j.sourceEvent.touches[0].clientY],S=[_[0]-m[0],_[1]-m[1]];m=_;const E=r()*Math.max(x[2],Math.log(x[2]))*(f?-1:1),O={x:x[0]-S[0]*E,y:x[1]-S[1]*E},M=[[0,0],[c,l]];t.setViewportConstrained({x:O.x,y:O.y,zoom:x[2]},M,s)},w=h3().on("start",v).on("zoom",d?b:null).on("zoom.wheel",p?y:null);a.call(w,{})}function i(){a.on("zoom",null)}return{update:o,destroy:i,pointer:Vr}}const bie=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,kh=e=>({x:e.x,y:e.y,zoom:e.k}),k1=({x:e,y:t,zoom:n})=>_h.translate(e,t).scale(n),lc=(e,t)=>e.target.closest(`.${t}`),J3=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),A1=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},e5=e=>{const t=e.ctrlKey&&Nh()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function wie({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:o,zoomOnPinch:i,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(lc(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&i){const v=Vr(u),b=e5(u),w=d*Math.pow(2,b);r.scaleTo(n,w,v,u);return}const p=u.deltaMode===1?20:1;let f=a===ti.Vertical?0:u.deltaX*p,y=a===ti.Horizontal?0:u.deltaY*p;!Nh()&&u.shiftKey&&a!==ti.Vertical&&(f=u.deltaY*p,y=0),r.translateBy(n,-(f/d)*o,-(y/d)*o,{internal:!0});const m=kh(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s==null||s(u,m)),e.isPanScrolling&&(c==null||c(u,m),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,m),e.isPanScrolling=!1},150))}}function xie({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,a){if(!t&&r.type==="wheel"&&!r.ctrlKey||lc(r,e))return null;r.preventDefault(),n.call(this,r,a)}}function _ie({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var o,i,s;if((o=r.sourceEvent)!=null&&o.internal)return;const a=kh(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=a,((s=r.sourceEvent)==null?void 0:s.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,a))}}function jie({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:a}){return o=>{var i,s;e.usedRightMouseButton=!!(n&&J3(t,e.mouseButton??0)),(i=o.sourceEvent)!=null&&i.sync||r([o.transform.x,o.transform.y,o.transform.k]),a&&!((s=o.sourceEvent)!=null&&s.internal)&&(a==null||a(o.sourceEvent,kh(o.transform)))}}function Sie({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:a,onPaneContextMenu:o}){return i=>{var s;if(!((s=i.sourceEvent)!=null&&s.internal)&&(e.isZoomingOrPanning=!1,o&&J3(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&o(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),a&&bie(e.prevViewport,i.transform))){const c=kh(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a==null||a(i.sourceEvent,c)},n?150:0)}}}function Eie({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:a,zoomOnDoubleClick:o,userSelectionActive:i,noWheelClassName:s,noPanClassName:c,lib:l}){return u=>{var y;const d=e||t,p=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(lc(u,`${l}-flow__node`)||lc(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!a&&!o&&!n||i||lc(u,s)&&u.type==="wheel"||lc(u,c)&&(u.type!=="wheel"||a&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((y=u.touches)==null?void 0:y.length)>1)return u.preventDefault(),!1;if(!d&&!a&&!p&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const f=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&f}}function Oie({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:a,viewport:o,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),p=h3().clickDistance(!qr(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(a),f=cr(e).call(p);j({x:o.x,y:o.y,zoom:ic(o.zoom,t,n)},[[0,0],[d.width,d.height]],a);const y=f.on("wheel.zoom"),m=f.on("dblclick.zoom");p.wheelDelta(e5);function v(I,k){return f?new Promise(C=>{p==null||p.transform(A1(f,k==null?void 0:k.duration,()=>C(!0)),I)}):Promise.resolve(!1)}function b({noWheelClassName:I,noPanClassName:k,onPaneContextMenu:C,userSelectionActive:T,panOnScroll:A,panOnDrag:D,panOnScrollMode:L,panOnScrollSpeed:R,preventScrolling:B,zoomOnPinch:z,zoomOnScroll:$,zoomOnDoubleClick:V,zoomActivationKeyPressed:Y,lib:G,onTransformChange:K}){T&&!u.isZoomingOrPanning&&w();const Q=A&&!Y&&!T?wie({zoomPanValues:u,noWheelClassName:I,d3Selection:f,d3Zoom:p,panOnScrollMode:L,panOnScrollSpeed:R,zoomOnPinch:z,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:c}):xie({noWheelClassName:I,preventScrolling:B,d3ZoomHandler:y});if(f.on("wheel.zoom",Q,{passive:!1}),!T){const H=_ie({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:s});p.on("start",H);const X=jie({zoomPanValues:u,panOnDrag:D,onPaneContextMenu:!!C,onPanZoom:i,onTransformChange:K});p.on("zoom",X);const te=Sie({zoomPanValues:u,panOnDrag:D,panOnScroll:A,onPaneContextMenu:C,onPanZoomEnd:c,onDraggingChange:l});p.on("end",te)}const q=Eie({zoomActivationKeyPressed:Y,panOnDrag:D,zoomOnScroll:$,panOnScroll:A,zoomOnDoubleClick:V,zoomOnPinch:z,userSelectionActive:T,noPanClassName:k,noWheelClassName:I,lib:G});p.filter(q),V?f.on("dblclick.zoom",m):f.on("dblclick.zoom",null)}function w(){p.on("zoom",null)}async function j(I,k,C){const T=k1(I),A=p==null?void 0:p.constrain()(T,k,C);return A&&await v(A),new Promise(D=>D(A))}async function x(I,k){const C=k1(I);return await v(C,k),new Promise(T=>T(C))}function _(I){if(f){const k=k1(I),C=f.property("__zoom");(C.k!==I.zoom||C.x!==I.x||C.y!==I.y)&&(p==null||p.transform(f,k,null,{sync:!0}))}}function S(){const I=f?p3(f.node()):{x:0,y:0,k:1};return{x:I.x,y:I.y,zoom:I.k}}function E(I,k){return f?new Promise(C=>{p==null||p.scaleTo(A1(f,k==null?void 0:k.duration,()=>C(!0)),I)}):Promise.resolve(!1)}function O(I,k){return f?new Promise(C=>{p==null||p.scaleBy(A1(f,k==null?void 0:k.duration,()=>C(!0)),I)}):Promise.resolve(!1)}function M(I){p==null||p.scaleExtent(I)}function N(I){p==null||p.translateExtent(I)}function P(I){const k=!qr(I)||I<0?0:I;p==null||p.clickDistance(k)}return{update:b,destroy:w,setViewport:x,setViewportConstrained:j,getViewport:S,scaleTo:E,scaleBy:O,setScaleExtent:M,setTranslateExtent:N,syncViewport:_,setClickDistance:P}}var uc;(function(e){e.Line="line",e.Handle="handle"})(uc||(uc={}));const Cie=["top-left","top-right","bottom-left","bottom-right"],Nie=["top","right","bottom","left"];function Mie({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:a,affectsY:o}){const i=e-t,s=n-r,c=[i>0?1:i<0?-1:0,s>0?1:s<0?-1:0];return i&&a&&(c[0]=c[0]*-1),s&&o&&(c[1]=c[1]*-1),c}function Pie(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:a}}function ri(e,t){return Math.max(0,t-e)}function ai(e,t){return Math.max(0,e-t)}function Ah(e,t,n){return Math.max(0,t-e,e-n)}function t5(e,t){return e?!t:t}function kie(e,t,n,r,a,o,i,s){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,p=u&&d,{xSnapped:f,ySnapped:y}=n,{minWidth:m,maxWidth:v,minHeight:b,maxHeight:w}=r,{x:j,y:x,width:_,height:S,aspectRatio:E}=e;let O=Math.floor(u?f-e.pointerX:0),M=Math.floor(d?y-e.pointerY:0);const N=_+(c?-O:O),P=S+(l?-M:M),I=-o[0]*_,k=-o[1]*S;let C=Ah(N,m,v),T=Ah(P,b,w);if(i){let L=0,R=0;c&&O<0?L=ri(j+O+I,i[0][0]):!c&&O>0&&(L=ai(j+N+I,i[1][0])),l&&M<0?R=ri(x+M+k,i[0][1]):!l&&M>0&&(R=ai(x+P+k,i[1][1])),C=Math.max(C,L),T=Math.max(T,R)}if(s){let L=0,R=0;c&&O>0?L=ai(j+O,s[0][0]):!c&&O<0&&(L=ri(j+N,s[1][0])),l&&M>0?R=ai(x+M,s[0][1]):!l&&M<0&&(R=ri(x+P,s[1][1])),C=Math.max(C,L),T=Math.max(T,R)}if(a){if(u){const L=Ah(N/E,b,w)*E;if(C=Math.max(C,L),i){let R=0;!c&&!l||c&&!l&&p?R=ai(x+k+N/E,i[1][1])*E:R=ri(x+k+(c?O:-O)/E,i[0][1])*E,C=Math.max(C,R)}if(s){let R=0;!c&&!l||c&&!l&&p?R=ri(x+N/E,s[1][1])*E:R=ai(x+(c?O:-O)/E,s[0][1])*E,C=Math.max(C,R)}}if(d){const L=Ah(P*E,m,v)/E;if(T=Math.max(T,L),i){let R=0;!c&&!l||l&&!c&&p?R=ai(j+P*E+I,i[1][0])/E:R=ri(j+(l?M:-M)*E+I,i[0][0])/E,T=Math.max(T,R)}if(s){let R=0;!c&&!l||l&&!c&&p?R=ri(j+P*E,s[1][0])/E:R=ai(j+(l?M:-M)*E,s[0][0])/E,T=Math.max(T,R)}}}M=M+(M<0?T:-T),O=O+(O<0?C:-C),a&&(p?N>P*E?M=(t5(c,l)?-O:O)/E:O=(t5(c,l)?-M:M)*E:u?(M=O/E,l=c):(O=M*E,c=l));const A=c?j+O:j,D=l?x+M:x;return{width:_+(c?-O:O),height:S+(l?-M:M),x:o[0]*O*(c?-1:1)+A,y:o[1]*M*(l?-1:1)+D}}const n5={width:0,height:0,x:0,y:0},Aie={...n5,pointerX:0,pointerY:0,aspectRatio:1};function Tie(e){return[[0,0],[e.measured.width,e.measured.height]]}function Iie(e,t,n){const r=t.position.x+e.position.x,a=t.position.y+e.position.y,o=e.measured.width??0,i=e.measured.height??0,s=n[0]*o,c=n[1]*i;return[[r-s,a-c],[r+o-s,a+i-c]]}function Rie({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:a}){const o=cr(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:u,onResizeStart:d,onResize:p,onResizeEnd:f,shouldResize:y}){let m={...n5},v={...Aie};const b=Pie(c);let w,j=null,x=[],_,S,E;const O=LD().on("start",M=>{const{nodeLookup:N,transform:P,snapGrid:I,snapToGrid:k,nodeOrigin:C,paneDomNode:T}=n();if(w=N.get(t),!w)return;j=(T==null?void 0:T.getBoundingClientRect())??null;const{xSnapped:A,ySnapped:D}=Qu(M.sourceEvent,{transform:P,snapGrid:I,snapToGrid:k,containerBounds:j});m={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},v={...m,pointerX:A,pointerY:D,aspectRatio:m.width/m.height},_=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(_=N.get(w.parentId),S=_&&w.extent==="parent"?Tie(_):void 0),x=[],E=void 0;for(const[L,R]of N)if(R.parentId===t&&(x.push({id:L,position:{...R.position},extent:R.extent}),R.extent==="parent"||R.expandParent)){const B=Iie(R,w,R.origin??C);E?E=[[Math.min(B[0][0],E[0][0]),Math.min(B[0][1],E[0][1])],[Math.max(B[1][0],E[1][0]),Math.max(B[1][1],E[1][1])]]:E=B}d==null||d(M,{...m})}).on("drag",M=>{const{transform:N,snapGrid:P,snapToGrid:I,nodeOrigin:k}=n(),C=Qu(M.sourceEvent,{transform:N,snapGrid:P,snapToGrid:I,containerBounds:j}),T=[];if(!w)return;const{x:A,y:D,width:L,height:R}=m,B={},z=w.origin??k,{width:$,height:V,x:Y,y:G}=kie(v,b,C,l,u,z,S,E),K=$!==L,Q=V!==R,q=Y!==A&&K,H=G!==D&&Q;if(!q&&!H&&!K&&!Q)return;if((q||H||z[0]===1||z[1]===1)&&(B.x=q?Y:m.x,B.y=H?G:m.y,m.x=B.x,m.y=B.y,x.length>0)){const F=Y-A,se=G-D;for(const re of x)re.position={x:re.position.x-F+z[0]*($-L),y:re.position.y-se+z[1]*(V-R)},T.push(re)}if((K||Q)&&(B.width=K?$:m.width,B.height=Q?V:m.height,m.width=B.width,m.height=B.height),_&&w.expandParent){const F=z[0]*(B.width??0);B.x&&B.x<F&&(m.x=F,v.x=v.x-(B.x-F));const se=z[1]*(B.height??0);B.y&&B.y<se&&(m.y=se,v.y=v.y-(B.y-se))}const X=Mie({width:m.width,prevWidth:L,height:m.height,prevHeight:R,affectsX:b.affectsX,affectsY:b.affectsY}),te={...m,direction:X};(y==null?void 0:y(M,te))!==!1&&(p==null||p(M,te),r(B,T))}).on("end",M=>{f==null||f(M,{...m}),a==null||a()});o.call(O)}function s(){o.on(".drag",null)}return{update:i,destroy:s}}var r5={exports:{}},T1={},a5;function Die(){if(a5)return T1;a5=1;var e=lK(),t=bT();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:n,a=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return T1.useSyncExternalStoreWithSelector=function(l,u,d,p,f){var y=o(null);if(y.current===null){var m={hasValue:!1,value:null};y.current=m}else m=y.current;y=s(function(){function b(S){if(!w){if(w=!0,j=S,S=p(S),f!==void 0&&m.hasValue){var E=m.value;if(f(E,S))return x=E}return x=S}if(E=x,r(j,S))return E;var O=p(S);return f!==void 0&&f(E,O)?E:(j=S,x=O)}var w=!1,j,x,_=d===void 0?null:d;return[function(){return b(u())},_===null?void 0:function(){return b(_())}]},[u,d,p,f]);var v=a(l,y[0],y[1]);return i(function(){m.hasValue=!0,m.value=v},[v]),c(v),v},T1}var o5;function Lie(){return o5||(o5=1,r5.exports=Die()),r5.exports}var $ie=Lie();let i5,I1,s5,c5,l5,u5;LN=ot($ie),i5={BASE_URL:"/NoLLMChat/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_URL:"/NoLLMChat/",VITE_ROUTE_MODE:"hash"},I1=e=>{let t;const n=new Set,r=(s,c)=>{const l=typeof s=="function"?s(t):s;if(!Object.is(l,t)){const u=t;t=c??(typeof l!="object"||l===null)?l:Object.assign({},t,l),n.forEach(d=>d(t,u))}},a=()=>t,o={setState:r,getState:a,getInitialState:()=>i,subscribe:s=>(n.add(s),()=>n.delete(s)),destroy:()=>{(i5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},i=t=e(r,a,o);return o},s5=e=>e?I1(e):I1,{useDebugValue:c5}=W,{useSyncExternalStoreWithSelector:l5}=LN,u5=e=>e;function d5(e,t=u5,n){const r=l5(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return c5(r),r}const p5=(e,t)=>{const n=s5(e),r=(a,o=t)=>d5(n,a,o);return Object.assign(r,n),r},Fie=(e,t)=>e?p5(e,t):p5;function $t(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const Th=g.createContext(null),Bie=Th.Provider,f5=go.error001();function Qe(e,t){const n=g.useContext(Th);if(n===null)throw new Error(f5);return d5(n,e,t)}function Tt(){const e=g.useContext(Th);if(e===null)throw new Error(f5);return g.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const h5={display:"none"},zie={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},m5="react-flow__node-desc",y5="react-flow__edge-desc",Vie="react-flow__aria-live",Uie=e=>e.ariaLiveMessage;function Wie({rfId:e}){const t=Qe(Uie);return h.jsx("div",{id:`${Vie}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:zie,children:t})}function Hie({rfId:e,disableKeyboardA11y:t}){return h.jsxs(h.Fragment,{children:[h.jsxs("div",{id:`${m5}-${e}`,style:h5,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),h.jsx("div",{id:`${y5}-${e}`,style:h5,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&h.jsx(Wie,{rfId:e})]})}const qie=e=>e.userSelectionActive?"none":"all";function dc({position:e="top-left",children:t,className:n,style:r,...a}){const o=Qe(qie),i=`${e}`.split("-");return h.jsx("div",{className:Qt(["react-flow__panel",n,...i]),style:{...r,pointerEvents:o},...a,children:t})}function Kie({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:h.jsx(dc,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:h.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Xie=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Ih=e=>e.id;function Zie(e,t){return $t(e.selectedNodes.map(Ih),t.selectedNodes.map(Ih))&&$t(e.selectedEdges.map(Ih),t.selectedEdges.map(Ih))}function Gie({onSelectionChange:e}){const t=Tt(),{selectedNodes:n,selectedEdges:r}=Qe(Xie,Zie);return g.useEffect(()=>{const a={nodes:n,edges:r};e==null||e(a),t.getState().onSelectionChangeHandlers.forEach(o=>o(a))},[n,r,e]),null}const Qie=e=>!!e.onSelectionChangeHandlers;function Yie({onSelectionChange:e}){const t=Qe(Qie);return e||t?h.jsx(Gie,{onSelectionChange:e}):null}const g5=[0,0],Jie={x:0,y:0,zoom:1},ese=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],v5=[...ese,"rfId"],tse=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),b5={translateExtent:Hu,nodeOrigin:g5,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function nse(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:a,setTranslateExtent:o,setNodeExtent:i,reset:s,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=Qe(tse,$t),u=Tt();g.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=b5,s()}),[]);const d=g.useRef(b5);return g.useEffect(()=>{for(const p of v5){const f=e[p],y=d.current[p];f!==y&&(typeof e[p]>"u"||(p==="nodes"?t(f):p==="edges"?n(f):p==="minZoom"?r(f):p==="maxZoom"?a(f):p==="translateExtent"?o(f):p==="nodeExtent"?i(f):p==="paneClickDistance"?l(f):p==="fitView"?u.setState({fitViewOnInit:f}):p==="fitViewOptions"?u.setState({fitViewOnInitOptions:f}):u.setState({[p]:f})))}d.current=e},v5.map(p=>e[p])),null}function w5(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function rse(e){var r;const[t,n]=g.useState(e==="system"?null:e);return g.useEffect(()=>{if(e!=="system"){n(e);return}const a=w5(),o=()=>n(a!=null&&a.matches?"dark":"light");return o(),a==null||a.addEventListener("change",o),()=>{a==null||a.removeEventListener("change",o)}},[e]),t!==null?t:(r=w5())!=null&&r.matches?"dark":"light"}const x5=typeof document<"u"?document:null;function Ju(e=null,t={target:x5,actInsideInputWithModifier:!0}){const[n,r]=g.useState(!1),a=g.useRef(!1),o=g.useRef(new Set([])),[i,s]=g.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),l=c.reduce((u,d)=>u.concat(...d),[]);return[c,l]}return[[],[]]},[e]);return g.useEffect(()=>{const c=(t==null?void 0:t.target)||x5;if(e!==null){const l=p=>{if(a.current=p.ctrlKey||p.metaKey||p.shiftKey,(!a.current||a.current&&!t.actInsideInputWithModifier)&&x1(p))return!1;const f=j5(p.code,s);o.current.add(p[f]),_5(i,o.current,!1)&&(p.preventDefault(),r(!0))},u=p=>{if((!a.current||a.current&&!t.actInsideInputWithModifier)&&x1(p))return!1;const f=j5(p.code,s);_5(i,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(p[f]),p.key==="Meta"&&o.current.clear(),a.current=!1},d=()=>{o.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function _5(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(a=>t.has(a)))}function j5(e,t){return t.includes(e)?"code":"key"}const ase=()=>{const e=Tt();return g.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,a,o],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??a,zoom:t.zoom??o},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:a,panZoom:o,domNode:i}=e.getState();if(!o||!i)return Promise.resolve(!1);const s=g1(n,t),{width:c,height:l}=Mh(i);return v1({nodes:s,width:c,height:l,minZoom:r,maxZoom:a,panZoom:o},t)},setCenter:async(t,n,r)=>{const{width:a,height:o,maxZoom:i,panZoom:s}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,l=a/2-t*c,u=o/2-n*c;return s?(await s.setViewport({x:l,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:a,minZoom:o,maxZoom:i,panZoom:s}=e.getState(),c=w1(t,r,a,o,i,(n==null?void 0:n.padding)??.1);return s?(await s.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:r,snapGrid:a,domNode:o}=e.getState();if(!o)return t;const{x:i,y:s}=o.getBoundingClientRect(),c={x:t.x-i,y:t.y-s};return Gu(c,r,n.snapToGrid,a)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:a,y:o}=r.getBoundingClientRect(),i=N3(t,n);return{x:i.x+a,y:i.y+o}}}),[])};function S5(e,t){const n=[],r=new Map,a=[];for(const o of e)if(o.type==="add"){a.push(o);continue}else if(o.type==="remove"||o.type==="replace")r.set(o.id,[o]);else{const i=r.get(o.id);i?i.push(o):r.set(o.id,[o])}for(const o of t){const i=r.get(o.id);if(!i){n.push(o);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const s={...o};for(const c of i)ose(c,s);n.push(s)}return a.length&&a.forEach(o=>{o.index!==void 0?n.splice(o.index,0,{...o.item}):n.push({...o.item})}),n}function ose(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Ki(e,t){return S5(e,t)}function ed(e,t){return S5(e,t)}function Xi(e,t){return{id:e,type:"select",selected:t}}function pc(e,t=new Set,n=!1){const r=[];for(const[a,o]of e){const i=t.has(a);!(o.selected===void 0&&!i)&&o.selected!==i&&(n&&(o.selected=i),r.push(Xi(o.id,i)))}return r}function E5({items:e=[],lookup:t}){var a;const n=[],r=new Map(e.map(o=>[o.id,o]));for(const[o,i]of e.entries()){const s=t.get(i.id),c=((a=s==null?void 0:s.internals)==null?void 0:a.userNode)??s;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:o})}for(const[o]of t)r.get(o)===void 0&&n.push({id:o,type:"remove"});return n}function O5(e){return{id:e.id,type:"remove"}}const C5=e=>Woe(e),ise=e=>w3(e);function N5(e){return g.forwardRef(e)}const sse=typeof window<"u"?g.useLayoutEffect:g.useEffect;function M5(e){const[t,n]=g.useState(BigInt(0)),[r]=g.useState(()=>cse(()=>n(a=>a+BigInt(1))));return sse(()=>{const a=r.get();a.length&&(e(a),r.reset())},[t]),r}function cse(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const P5=g.createContext(null);function lse({children:e}){const t=Tt(),n=g.useCallback(s=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:p}=t.getState();let f=c;for(const y of s)f=typeof y=="function"?y(f):y;u?l(f):d&&d(E5({items:f,lookup:p}))},[]),r=M5(n),a=g.useCallback(s=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:p}=t.getState();let f=c;for(const y of s)f=typeof y=="function"?y(f):y;u?l(f):d&&d(E5({items:f,lookup:p}))},[]),o=M5(a),i=g.useMemo(()=>({nodeQueue:r,edgeQueue:o}),[]);return h.jsx(P5.Provider,{value:i,children:e})}function use(){const e=g.useContext(P5);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const dse=e=>!!e.panZoom;function lr(){const e=ase(),t=Tt(),n=use(),r=Qe(dse),a=g.useMemo(()=>{const o=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},s=d=>{n.edgeQueue.push(d)},c=d=>{var b,w;const{nodeLookup:p,nodeOrigin:f}=t.getState(),y=C5(d)?d:p.get(d.id),m=y.parentId?P3(y.position,y.measured,y.parentId,p,f):y.position,v={id:y.id,position:m,width:((b=y.measured)==null?void 0:b.width)??y.width,height:((w=y.measured)==null?void 0:w.height)??y.height,data:y.data};return sc(v)},l=(d,p,f={replace:!1})=>{i(y=>y.map(m=>{if(m.id===d){const v=typeof p=="function"?p(m):p;return f.replace&&C5(v)?v:{...m,...v}}return m}))},u=(d,p,f={replace:!1})=>{s(y=>y.map(m=>{if(m.id===d){const v=typeof p=="function"?p(m):p;return f.replace&&ise(v)?v:{...m,...v}}return m}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var p;return(p=o(d))==null?void 0:p.internals.userNode},getInternalNode:o,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(p=>({...p}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:s,addNodes:d=>{const p=Array.isArray(d)?d:[d];n.nodeQueue.push(f=>[...f,...p])},addEdges:d=>{const p=Array.isArray(d)?d:[d];n.edgeQueue.push(f=>[...f,...p])},toObject:()=>{const{nodes:d=[],edges:p=[],transform:f}=t.getState(),[y,m,v]=f;return{nodes:d.map(b=>({...b})),edges:p.map(b=>({...b})),viewport:{x:y,y:m,zoom:v}}},deleteElements:async({nodes:d=[],edges:p=[]})=>{const{nodes:f,edges:y,onNodesDelete:m,onEdgesDelete:v,triggerNodeChanges:b,triggerEdgeChanges:w,onDelete:j,onBeforeDelete:x}=t.getState(),{nodes:_,edges:S}=await Koe({nodesToRemove:d,edgesToRemove:p,nodes:f,edges:y,onBeforeDelete:x}),E=S.length>0,O=_.length>0;if(E){const M=S.map(O5);v==null||v(S),w(M)}if(O){const M=_.map(O5);m==null||m(_),b(M)}return(O||E)&&(j==null||j({nodes:_,edges:S})),{deletedNodes:_,deletedEdges:S}},getIntersectingNodes:(d,p=!0,f)=>{const y=C3(d),m=y?d:c(d),v=f!==void 0;return m?(f||t.getState().nodes).filter(b=>{const w=t.getState().nodeLookup.get(b.id);if(w&&!y&&(b.id===d.id||!w.internals.positionAbsolute))return!1;const j=sc(v?b:w),x=Zu(j,m);return p&&x>0||x>=m.width*m.height}):[]},isNodeIntersecting:(d,p,f=!0)=>{const y=C3(d)?d:c(d);if(!y)return!1;const m=Zu(y,p);return f&&m>0||m>=y.width*y.height},updateNode:l,updateNodeData:(d,p,f={replace:!1})=>{l(d,y=>{const m=typeof p=="function"?p(y):p;return f.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},f)},updateEdge:u,updateEdgeData:(d,p,f={replace:!1})=>{u(d,y=>{const m=typeof p=="function"?p(y):p;return f.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},f)},getNodesBounds:d=>{const{nodeLookup:p,nodeOrigin:f}=t.getState();return Hoe(d,{nodeLookup:p,nodeOrigin:f})},getHandleConnections:({type:d,id:p,nodeId:f})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${f}-${d}-${p??null}`))==null?void 0:y.values())??[])}}},[]);return g.useMemo(()=>({...a,...e,viewportInitialized:r}),[r])}const k5=e=>e.selected,pse={actInsideInputWithModifier:!1},fse=typeof window<"u"?window:void 0;function hse({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=Tt(),{deleteElements:r}=lr(),a=Ju(e,pse),o=Ju(t,{target:fse});g.useEffect(()=>{if(a){const{edges:i,nodes:s}=n.getState();r({nodes:s.filter(k5),edges:i.filter(k5)}),n.setState({nodesSelectionActive:!1})}},[a]),g.useEffect(()=>{n.setState({multiSelectionActive:o})},[o])}function mse(e){const t=Tt();g.useEffect(()=>{const n=()=>{var a,o;if(!e.current)return!1;const r=Mh(e.current);(r.height===0||r.width===0)&&((o=(a=t.getState()).onError)==null||o.call(a,"004",go.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const Rh={position:"absolute",width:"100%",height:"100%",top:0,left:0},yse=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function gse({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:a=.5,panOnScrollMode:o=ti.Free,zoomOnDoubleClick:i=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:p,preventScrolling:f=!0,children:y,noWheelClassName:m,noPanClassName:v,onViewportChange:b,isControlledViewport:w,paneClickDistance:j}){const x=Tt(),_=g.useRef(null),{userSelectionActive:S,lib:E}=Qe(yse,$t),O=Ju(p),M=g.useRef();mse(_);const N=g.useCallback(P=>{b==null||b({x:P[0],y:P[1],zoom:P[2]}),w||x.setState({transform:P})},[b,w]);return g.useEffect(()=>{if(_.current){M.current=Oie({domNode:_.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:j,onDraggingChange:C=>x.setState({paneDragging:C}),onPanZoomStart:(C,T)=>{const{onViewportChangeStart:A,onMoveStart:D}=x.getState();D==null||D(C,T),A==null||A(T)},onPanZoom:(C,T)=>{const{onViewportChange:A,onMove:D}=x.getState();D==null||D(C,T),A==null||A(T)},onPanZoomEnd:(C,T)=>{const{onViewportChangeEnd:A,onMoveEnd:D}=x.getState();D==null||D(C,T),A==null||A(T)}});const{x:P,y:I,zoom:k}=M.current.getViewport();return x.setState({panZoom:M.current,transform:[P,I,k],domNode:_.current.closest(".react-flow")}),()=>{var C;(C=M.current)==null||C.destroy()}}},[]),g.useEffect(()=>{var P;(P=M.current)==null||P.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:a,panOnScrollMode:o,zoomOnDoubleClick:i,panOnDrag:s,zoomActivationKeyPressed:O,preventScrolling:f,noPanClassName:v,userSelectionActive:S,noWheelClassName:m,lib:E,onTransformChange:N})},[e,t,n,r,a,o,i,s,O,f,v,S,m,E,N]),h.jsx("div",{className:"react-flow__renderer",ref:_,style:Rh,children:y})}const vse=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function bse(){const{userSelectionActive:e,userSelectionRect:t}=Qe(vse,$t);return e&&t?h.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const R1=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},wse=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function xse({isSelecting:e,selectionKeyPressed:t,selectionMode:n=qu.Full,panOnDrag:r,selectionOnDrag:a,onSelectionStart:o,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:p,children:f}){const y=g.useRef(null),m=Tt(),v=g.useRef(0),b=g.useRef(0),w=g.useRef(),j=g.useRef(new Map),{userSelectionActive:x,elementsSelectable:_,dragging:S}=Qe(wse,$t),E=_&&(e||x),O=g.useRef(!1),M=g.useRef(!1),N=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,b.current=0},P=L=>{if(O.current){O.current=!1;return}s==null||s(L),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},I=L=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){L.preventDefault();return}c==null||c(L)},k=l?L=>l(L):void 0,C=L=>{var Y,G,K,Q;const{resetSelectedElements:R,domNode:B,edgeLookup:z}=m.getState();if(w.current=B==null?void 0:B.getBoundingClientRect(),!_||!e||L.button!==0||L.target!==y.current||!w.current)return;(G=(Y=L.target)==null?void 0:Y.setPointerCapture)==null||G.call(Y,L.pointerId),M.current=!0,O.current=!1,j.current=new Map;for(const[q,H]of z)j.current.set(H.source,((K=j.current.get(H.source))==null?void 0:K.add(q))||new Set([q])),j.current.set(H.target,((Q=j.current.get(H.target))==null?void 0:Q.add(q))||new Set([q]));const{x:$,y:V}=bo(L.nativeEvent,w.current);R(),m.setState({userSelectionRect:{width:0,height:0,startX:$,startY:V,x:$,y:V}}),o==null||o(L)},T=L=>{const{userSelectionRect:R,edgeLookup:B,transform:z,nodeLookup:$,triggerNodeChanges:V,triggerEdgeChanges:Y}=m.getState();if(!w.current||!R)return;O.current=!0;const{x:G,y:K}=bo(L.nativeEvent,w.current),{startX:Q,startY:q}=R,H={startX:Q,startY:q,x:G<Q?G:Q,y:K<q?K:q,width:Math.abs(G-Q),height:Math.abs(K-q)},X=x3($,H,z,n===qu.Partial,!0),te=new Set,F=new Set;for(const se of X){F.add(se.id);const re=j.current.get(se.id);if(re)for(const le of re)te.add(le)}if(v.current!==F.size){v.current=F.size;const se=pc($,F,!0);V(se)}if(b.current!==te.size){b.current=te.size;const se=pc(B,te);Y(se)}m.setState({userSelectionRect:H,userSelectionActive:!0,nodesSelectionActive:!1})},A=L=>{var B,z;if(L.button!==0||!M.current)return;(z=(B=L.target)==null?void 0:B.releasePointerCapture)==null||z.call(B,L.pointerId);const{userSelectionRect:R}=m.getState();!x&&R&&L.target===y.current&&(P==null||P(L)),v.current>0&&m.setState({nodesSelectionActive:!0}),N(),i==null||i(L),(t||a)&&(O.current=!1),M.current=!1},D=r===!0||Array.isArray(r)&&r.includes(0);return h.jsxs("div",{className:Qt(["react-flow__pane",{draggable:D,dragging:S,selection:e}]),onClick:E?void 0:R1(P,y),onContextMenu:R1(I,y),onWheel:R1(k,y),onPointerEnter:E?void 0:u,onPointerDown:E?C:d,onPointerMove:E?T:d,onPointerUp:E?A:void 0,onPointerLeave:p,ref:y,style:Rh,children:[f,h.jsx(bse,{})]})}function D1({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:a,unselectNodesAndEdges:o,multiSelectionActive:i,nodeLookup:s,onError:c}=t.getState(),l=s.get(e);if(!l){c==null||c("012",go.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(o({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):a([e])}function A5({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:a,isSelectable:o,nodeClickDistance:i}){const s=Tt(),[c,l]=g.useState(!1),u=g.useRef();return g.useEffect(()=>{u.current=pie({getStoreItems:()=>s.getState(),onNodeMouseDown:d=>{D1({id:d,store:s,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),g.useEffect(()=>{var d,p;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(p=u.current)==null||p.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:o,nodeId:a,nodeClickDistance:i}),()=>{var f;(f=u.current)==null||f.destroy()}},[n,r,t,o,e,a]),c}const _se=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function T5(){const e=Tt();return g.useCallback(t=>{const{nodeExtent:n,snapToGrid:r,snapGrid:a,nodesDraggable:o,onError:i,updateNodePositions:s,nodeLookup:c,nodeOrigin:l}=e.getState(),u=new Map,d=_se(o),p=r?a[0]:5,f=r?a[1]:5,y=t.direction.x*p*t.factor,m=t.direction.y*f*t.factor;for(const[,v]of c){if(!d(v))continue;let b={x:v.internals.positionAbsolute.x+y,y:v.internals.positionAbsolute.y+m};r&&(b=Ch(b,a));const{position:w,positionAbsolute:j}=_3({nodeId:v.id,nextPosition:b,nodeLookup:c,nodeExtent:n,nodeOrigin:l,onError:i});v.position=w,v.internals.positionAbsolute=j,u.set(v.id,v)}s(u)},[])}const L1=g.createContext(null),jse=L1.Provider;L1.Consumer;const $1=()=>g.useContext(L1),Sse=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Ese=(e,t,n)=>r=>{const{connectionClickStartHandle:a,connectionMode:o,connection:i}=r,{fromHandle:s,toHandle:c,isValid:l}=i,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,connectingTo:u,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,isPossibleEndHandle:o===oc.Strict?(s==null?void 0:s.type)!==n:e!==(s==null?void 0:s.nodeId)||t!==(s==null?void 0:s.id),connectionInProcess:!!s,valid:u&&l}};function Ose({type:e="source",position:t=fe.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:a=!0,isConnectableEnd:o=!0,id:i,onConnect:s,children:c,className:l,onMouseDown:u,onTouchStart:d,...p},f){var C,T;const y=i||null,m=e==="target",v=Tt(),b=$1(),{connectOnClick:w,noPanClassName:j,rfId:x}=Qe(Sse,$t),{connectingFrom:_,connectingTo:S,clickConnecting:E,isPossibleEndHandle:O,connectionInProcess:M,valid:N}=Qe(Ese(b,y,e),$t);b||((T=(C=v.getState()).onError)==null||T.call(C,"010",go.error010()));const P=A=>{const{defaultEdgeOptions:D,onConnect:L,hasDefaultEdges:R}=v.getState(),B={...D,...A};if(R){const{edges:z,setEdges:$}=v.getState();$($3(B,z))}L==null||L(B),s==null||s(B)},I=A=>{if(!b)return;const D=A3(A.nativeEvent);if(a&&(D&&A.button===0||!D)){const L=v.getState();P1.onPointerDown(A.nativeEvent,{autoPanOnConnect:L.autoPanOnConnect,connectionMode:L.connectionMode,connectionRadius:L.connectionRadius,domNode:L.domNode,nodeLookup:L.nodeLookup,lib:L.lib,isTarget:m,handleId:y,nodeId:b,flowId:L.rfId,panBy:L.panBy,cancelConnection:L.cancelConnection,onConnectStart:L.onConnectStart,onConnectEnd:L.onConnectEnd,updateConnection:L.updateConnection,onConnect:P,isValidConnection:n||L.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:L.autoPanSpeed})}D?u==null||u(A):d==null||d(A)},k=A=>{const{onClickConnectStart:D,onClickConnectEnd:L,connectionClickStartHandle:R,connectionMode:B,isValidConnection:z,lib:$,rfId:V,nodeLookup:Y,connection:G}=v.getState();if(!b||!R&&!a)return;if(!R){D==null||D(A.nativeEvent,{nodeId:b,handleId:y,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:b,type:e,id:y}});return}const K=k3(A.target),Q=n||z,{connection:q,isValid:H}=P1.isValid(A.nativeEvent,{handle:{nodeId:b,id:y,type:e},connectionMode:B,fromNodeId:R.nodeId,fromHandleId:R.id||null,fromType:R.type,isValidConnection:Q,flowId:V,doc:K,lib:$,nodeLookup:Y});H&&q&&P(q);const X=structuredClone(G);delete X.inProgress,X.toPosition=X.toHandle?X.toHandle.position:null,L==null||L(A,X),v.setState({connectionClickStartHandle:null})};return h.jsx("div",{"data-handleid":y,"data-nodeid":b,"data-handlepos":t,"data-id":`${x}-${b}-${y}-${e}`,className:Qt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",j,l,{source:!m,target:m,connectable:r,connectablestart:a,connectableend:o,clickconnecting:E,connectingfrom:_,connectingto:S,valid:N,connectionindicator:r&&(!M||O)&&(M?o:a)}]),onMouseDown:I,onTouchStart:I,onClick:w?k:void 0,ref:f,...p,children:c})}const td=g.memo(N5(Ose));function Cse({data:e,isConnectable:t,sourcePosition:n=fe.Bottom}){return h.jsxs(h.Fragment,{children:[e==null?void 0:e.label,h.jsx(td,{type:"source",position:n,isConnectable:t})]})}function Nse({data:e,isConnectable:t,targetPosition:n=fe.Top,sourcePosition:r=fe.Bottom}){return h.jsxs(h.Fragment,{children:[h.jsx(td,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,h.jsx(td,{type:"source",position:r,isConnectable:t})]})}function Mse(){return null}function Pse({data:e,isConnectable:t,targetPosition:n=fe.Top}){return h.jsxs(h.Fragment,{children:[h.jsx(td,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Dh={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},I5={input:Cse,default:Nse,output:Pse,group:Mse};function kse(e){var t,n,r,a;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((a=e.style)==null?void 0:a.height)}}const Ase=e=>{const{width:t,height:n,x:r,y:a}=Xu(e.nodeLookup,{filter:o=>!!o.selected});return{width:qr(t)?t:null,height:qr(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`}};function Tse({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Tt(),{width:a,height:o,transformString:i,userSelectionActive:s}=Qe(Ase,$t),c=T5(),l=g.useRef(null);if(g.useEffect(()=>{var p;n||((p=l.current)==null||p.focus({preventScroll:!0}))},[n]),A5({nodeRef:l}),s||!a||!o)return null;const u=e?p=>{const f=r.getState().nodes.filter(y=>y.selected);e(p,f)}:void 0,d=p=>{Object.prototype.hasOwnProperty.call(Dh,p.key)&&c({direction:Dh[p.key],factor:p.shiftKey?4:1})};return h.jsx("div",{className:Qt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:h.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:a,height:o}})})}const R5=typeof window<"u"?window:void 0,Ise=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function D5({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:p,onSelectionEnd:f,multiSelectionKeyCode:y,panActivationKeyCode:m,zoomActivationKeyCode:v,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:j,panOnScroll:x,panOnScrollSpeed:_,panOnScrollMode:S,zoomOnDoubleClick:E,panOnDrag:O,defaultViewport:M,translateExtent:N,minZoom:P,maxZoom:I,preventScrolling:k,onSelectionContextMenu:C,noWheelClassName:T,noPanClassName:A,disableKeyboardA11y:D,onViewportChange:L,isControlledViewport:R}){const{nodesSelectionActive:B,userSelectionActive:z}=Qe(Ise),$=Ju(l,{target:R5}),V=Ju(m,{target:R5}),Y=V||O,G=V||x,K=u&&Y!==!0,Q=$||z||K;return hse({deleteKeyCode:c,multiSelectionKeyCode:y}),h.jsx(gse,{onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:j,panOnScroll:G,panOnScrollSpeed:_,panOnScrollMode:S,zoomOnDoubleClick:E,panOnDrag:!$&&Y,defaultViewport:M,translateExtent:N,minZoom:P,maxZoom:I,zoomActivationKeyCode:v,preventScrolling:k,noWheelClassName:T,noPanClassName:A,onViewportChange:L,isControlledViewport:R,paneClickDistance:s,children:h.jsxs(xse,{onSelectionStart:p,onSelectionEnd:f,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:o,onPaneScroll:i,panOnDrag:Y,isSelecting:!!Q,selectionMode:d,selectionKeyPressed:$,selectionOnDrag:K,children:[e,B&&h.jsx(Tse,{onSelectionContextMenu:C,noPanClassName:A,disableKeyboardA11y:D})]})})}D5.displayName="FlowRenderer";const Rse=g.memo(D5),Dse=e=>t=>e?x3(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Lse(e){return Qe(g.useCallback(Dse(e),[e]),$t)}const $se=e=>e.updateNodeInternals;function Fse(){const e=Qe($se),[t]=g.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(a=>{const o=a.target.getAttribute("data-id");r.set(o,{id:o,nodeElement:a.target,force:!0})}),e(r)}));return g.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Bse({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const a=Tt(),o=g.useRef(null),i=g.useRef(null),s=g.useRef(e.sourcePosition),c=g.useRef(e.targetPosition),l=g.useRef(t),u=n&&!!e.internals.handleBounds;return g.useEffect(()=>{o.current&&!e.hidden&&(!u||i.current!==o.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(o.current),i.current=o.current)},[u,e.hidden]),g.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),g.useEffect(()=>{if(o.current){const d=l.current!==t,p=s.current!==e.sourcePosition,f=c.current!==e.targetPosition;(d||p||f)&&(l.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:o.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),o}function zse({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:a,onContextMenu:o,onDoubleClick:i,nodesDraggable:s,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:p,noPanClassName:f,disableKeyboardA11y:y,rfId:m,nodeTypes:v,nodeExtent:b,nodeClickDistance:w,onError:j}){const{node:x,internals:_,isParent:S}=Qe(q=>{const H=q.nodeLookup.get(e),X=q.parentLookup.has(e);return{node:H,internals:H.internals,isParent:X}},$t);let E=x.type||"default",O=(v==null?void 0:v[E])||I5[E];O===void 0&&(j==null||j("003",go.error003(E)),E="default",O=I5.default);const M=!!(x.draggable||s&&typeof x.draggable>"u"),N=!!(x.selectable||c&&typeof x.selectable>"u"),P=!!(x.connectable||l&&typeof x.connectable>"u"),I=!!(x.focusable||u&&typeof x.focusable>"u"),k=Tt(),C=M3(x),T=Bse({node:x,nodeType:E,hasDimensions:C,resizeObserver:d}),A=A5({nodeRef:T,disabled:x.hidden||!M,noDragClassName:p,handleSelector:x.dragHandle,nodeId:e,isSelectable:N,nodeClickDistance:w}),D=T5();if(x.hidden)return null;const L=vo(x),R=kse(x),B=N||M||t||n||r||a,z=n?q=>n(q,{..._.userNode}):void 0,$=r?q=>r(q,{..._.userNode}):void 0,V=a?q=>a(q,{..._.userNode}):void 0,Y=o?q=>o(q,{..._.userNode}):void 0,G=i?q=>i(q,{..._.userNode}):void 0,K=q=>{const{selectNodesOnDrag:H,nodeDragThreshold:X}=k.getState();N&&(!H||!M||X>0)&&D1({id:e,store:k,nodeRef:T}),t&&t(q,{..._.userNode})},Q=q=>{if(!(x1(q.nativeEvent)||y))if(m3.includes(q.key)&&N){const H=q.key==="Escape";D1({id:e,store:k,unselect:H,nodeRef:T})}else M&&x.selected&&Object.prototype.hasOwnProperty.call(Dh,q.key)&&(k.setState({ariaLiveMessage:`Moved selected node ${q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~_.positionAbsolute.x}, y: ${~~_.positionAbsolute.y}`}),D({direction:Dh[q.key],factor:q.shiftKey?4:1}))};return h.jsx("div",{className:Qt(["react-flow__node",`react-flow__node-${E}`,{[f]:M},x.className,{selected:x.selected,selectable:N,parent:S,draggable:M,dragging:A}]),ref:T,style:{zIndex:_.z,transform:`translate(${_.positionAbsolute.x}px,${_.positionAbsolute.y}px)`,pointerEvents:B?"all":"none",visibility:C?"visible":"hidden",...x.style,...R},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:z,onMouseMove:$,onMouseLeave:V,onContextMenu:Y,onClick:K,onDoubleClick:G,onKeyDown:I?Q:void 0,tabIndex:I?0:void 0,role:I?"button":void 0,"aria-describedby":y?void 0:`${m5}-${m}`,"aria-label":x.ariaLabel,children:h.jsx(jse,{value:e,children:h.jsx(O,{id:e,data:x.data,type:E,positionAbsoluteX:_.positionAbsolute.x,positionAbsoluteY:_.positionAbsolute.y,selected:x.selected,selectable:N,draggable:M,deletable:x.deletable??!0,isConnectable:P,sourcePosition:x.sourcePosition,targetPosition:x.targetPosition,dragging:A,dragHandle:x.dragHandle,zIndex:_.z,parentId:x.parentId,...L})})})}const Vse=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function L5(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,onError:o}=Qe(Vse,$t),i=Lse(e.onlyRenderVisibleElements),s=Fse();return h.jsx("div",{className:"react-flow__nodes",style:Rh,children:i.map(c=>h.jsx(zse,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:o},c))})}L5.displayName="NodeRenderer";const Use=g.memo(L5);function Wse(e){return Qe(g.useCallback(t=>{if(!e)return t.edges.map(r=>r.id);const n=[];if(t.width&&t.height)for(const r of t.edges){const a=t.nodeLookup.get(r.source),o=t.nodeLookup.get(r.target);a&&o&&Qoe({sourceNode:a,targetNode:o,width:t.width,height:t.height,transform:t.transform})&&n.push(r.id)}return n},[e]),$t)}const Hse=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),qse=({color:e="none",strokeWidth:t=1})=>h.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),$5={[jh.Arrow]:Hse,[jh.ArrowClosed]:qse};function Kse(e){const t=Tt();return g.useMemo(()=>{var n,r;return Object.prototype.hasOwnProperty.call($5,e)?$5[e]:((r=(n=t.getState()).onError)==null||r.call(n,"009",go.error009(e)),null)},[e])}const Xse=({id:e,type:t,color:n,width:r=12.5,height:a=12.5,markerUnits:o="strokeWidth",strokeWidth:i,orient:s="auto-start-reverse"})=>{const c=Kse(t);return c?h.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:h.jsx(c,{color:n,strokeWidth:i})}):null},F5=({defaultColor:e,rfId:t})=>{const n=Qe(o=>o.edges),r=Qe(o=>o.defaultEdgeOptions),a=g.useMemo(()=>aie(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return a.length?h.jsx("svg",{className:"react-flow__marker",children:h.jsx("defs",{children:a.map(o=>h.jsx(Xse,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})}):null};F5.displayName="MarkerDefinitions";var Zse=g.memo(F5);function B5({x:e,y:t,label:n,labelStyle:r={},labelShowBg:a=!0,labelBgStyle:o={},labelBgPadding:i=[2,4],labelBgBorderRadius:s=2,children:c,className:l,...u}){const[d,p]=g.useState({x:1,y:0,width:0,height:0}),f=Qt(["react-flow__edge-textwrapper",l]),y=g.useRef(null);return g.useEffect(()=>{if(y.current){const m=y.current.getBBox();p({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),typeof n>"u"||!n?null:h.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:f,visibility:d.width?"visible":"hidden",...u,children:[a&&h.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),h.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:y,style:r,children:n}),c]})}B5.displayName="EdgeText";const Gse=g.memo(B5);function Lh({id:e,path:t,labelX:n,labelY:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:p,className:f,interactionWidth:y=20}){return h.jsxs(h.Fragment,{children:[h.jsx("path",{id:e,style:u,d:t,fill:"none",className:Qt(["react-flow__edge-path",f]),markerEnd:d,markerStart:p}),y&&h.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:y,className:"react-flow__edge-interaction"}),a&&qr(n)&&qr(r)?h.jsx(Gse,{x:n,y:r,label:a,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l}):null]})}function z5({pos:e,x1:t,y1:n,x2:r,y2:a}){return e===fe.Left||e===fe.Right?[.5*(t+r),n]:[t,.5*(n+a)]}function V5({sourceX:e,sourceY:t,sourcePosition:n=fe.Bottom,targetX:r,targetY:a,targetPosition:o=fe.Top}){const[i,s]=z5({pos:n,x1:e,y1:t,x2:r,y2:a}),[c,l]=z5({pos:o,x1:r,y1:a,x2:e,y2:t}),[u,d,p,f]=I3({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:i,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${s} ${c},${l} ${r},${a}`,u,d,p,f]}function U5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=fe.Bottom,targetPosition:s=fe.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:v,interactionWidth:b})=>{const[w,j,x]=V5({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s}),_=e.isInternal?void 0:t;return h.jsx(Lh,{id:_,path:w,labelX:j,labelY:x,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:v,interactionWidth:b})})}const Qse=U5({isInternal:!1}),W5=U5({isInternal:!0});Qse.displayName="SimpleBezierEdge",W5.displayName="SimpleBezierEdgeInternal";function H5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,sourcePosition:f=fe.Bottom,targetPosition:y=fe.Top,markerEnd:m,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[j,x,_]=_1({sourceX:n,sourceY:r,sourcePosition:f,targetX:a,targetY:o,targetPosition:y,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset}),S=e.isInternal?void 0:t;return h.jsx(Lh,{id:S,path:j,labelX:x,labelY:_,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:m,markerStart:v,interactionWidth:w})})}const q5=H5({isInternal:!1}),K5=H5({isInternal:!0});q5.displayName="SmoothStepEdge",K5.displayName="SmoothStepEdgeInternal";function X5(e){return g.memo(({id:t,...n})=>{var a;const r=e.isInternal?void 0:t;return h.jsx(q5,{...n,id:r,pathOptions:g.useMemo(()=>{var o;return{borderRadius:0,offset:(o=n.pathOptions)==null?void 0:o.offset}},[(a=n.pathOptions)==null?void 0:a.offset])})})}const Yse=X5({isInternal:!1}),Z5=X5({isInternal:!0});Yse.displayName="StepEdge",Z5.displayName="StepEdgeInternal";function G5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:y,interactionWidth:m})=>{const[v,b,w]=F3({sourceX:n,sourceY:r,targetX:a,targetY:o}),j=e.isInternal?void 0:t;return h.jsx(Lh,{id:j,path:v,labelX:b,labelY:w,label:i,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:y,interactionWidth:m})})}const Jse=G5({isInternal:!1}),Q5=G5({isInternal:!0});Jse.displayName="StraightEdge",Q5.displayName="StraightEdgeInternal";function Y5(e){return g.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:o,sourcePosition:i=fe.Bottom,targetPosition:s=fe.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:v,pathOptions:b,interactionWidth:w})=>{const[j,x,_]=D3({sourceX:n,sourceY:r,sourcePosition:i,targetX:a,targetY:o,targetPosition:s,curvature:b==null?void 0:b.curvature}),S=e.isInternal?void 0:t;return h.jsx(Lh,{id:S,path:j,labelX:x,labelY:_,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:v,interactionWidth:w})})}const ece=Y5({isInternal:!1}),J5=Y5({isInternal:!0});ece.displayName="BezierEdge",J5.displayName="BezierEdgeInternal";const e4={default:J5,straight:Q5,step:Z5,smoothstep:K5,simplebezier:W5},t4={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},tce=(e,t,n)=>n===fe.Left?e-t:n===fe.Right?e+t:e,nce=(e,t,n)=>n===fe.Top?e-t:n===fe.Bottom?e+t:e,n4="react-flow__edgeupdater";function r4({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:a,onMouseEnter:o,onMouseOut:i,type:s}){return h.jsx("circle",{onMouseDown:a,onMouseEnter:o,onMouseOut:i,className:Qt([n4,`${n4}-${s}`]),cx:tce(t,r,e),cy:nce(n,r,e),r,stroke:"transparent",fill:"transparent"})}function rce({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:a,targetX:o,targetY:i,sourcePosition:s,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:p,setUpdateHover:f}){const y=Tt(),m=(x,_)=>{if(x.button!==0)return;const{autoPanOnConnect:S,domNode:E,isValidConnection:O,connectionMode:M,connectionRadius:N,lib:P,onConnectStart:I,onConnectEnd:k,cancelConnection:C,nodeLookup:T,rfId:A,panBy:D,updateConnection:L}=y.getState(),R=_.type==="target";p(!0),u==null||u(x,n,_.type);const B=($,V)=>{p(!1),d==null||d($,n,_.type,V)},z=$=>l==null?void 0:l(n,$);P1.onPointerDown(x.nativeEvent,{autoPanOnConnect:S,connectionMode:M,connectionRadius:N,domNode:E,handleId:_.id,nodeId:_.nodeId,nodeLookup:T,isTarget:R,edgeUpdaterType:_.type,lib:P,flowId:A,cancelConnection:C,panBy:D,isValidConnection:O,onConnect:z,onConnectStart:I,onConnectEnd:k,onReconnectEnd:B,updateConnection:L,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle})},v=x=>m(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=x=>m(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>f(!0),j=()=>f(!1);return h.jsxs(h.Fragment,{children:[(e===!0||e==="source")&&h.jsx(r4,{position:s,centerX:r,centerY:a,radius:t,onMouseDown:v,onMouseEnter:w,onMouseOut:j,type:"source"}),(e===!0||e==="target")&&h.jsx(r4,{position:c,centerX:o,centerY:i,radius:t,onMouseDown:b,onMouseEnter:w,onMouseOut:j,type:"target"})]})}function ace({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:a,onDoubleClick:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:p,onReconnectEnd:f,rfId:y,edgeTypes:m,noPanClassName:v,onError:b,disableKeyboardA11y:w}){let j=Qe(F=>F.edgeLookup.get(e));const x=Qe(F=>F.defaultEdgeOptions);j=x?{...x,...j}:j;let _=j.type||"default",S=(m==null?void 0:m[_])||e4[_];S===void 0&&(b==null||b("011",go.error011(_)),_="default",S=e4.default);const E=!!(j.focusable||t&&typeof j.focusable>"u"),O=typeof d<"u"&&(j.reconnectable||n&&typeof j.reconnectable>"u"),M=!!(j.selectable||r&&typeof j.selectable>"u"),N=g.useRef(null),[P,I]=g.useState(!1),[k,C]=g.useState(!1),T=Tt(),{zIndex:A,sourceX:D,sourceY:L,targetX:R,targetY:B,sourcePosition:z,targetPosition:$}=Qe(g.useCallback(F=>{const se=F.nodeLookup.get(j.source),re=F.nodeLookup.get(j.target);if(!se||!re)return{zIndex:j.zIndex,...t4};const le=rie({id:e,sourceNode:se,targetNode:re,sourceHandle:j.sourceHandle||null,targetHandle:j.targetHandle||null,connectionMode:F.connectionMode,onError:b});return{zIndex:Goe({selected:j.selected,zIndex:j.zIndex,sourceNode:se,targetNode:re,elevateOnSelect:F.elevateEdgesOnSelect}),...le||t4}},[j.source,j.target,j.sourceHandle,j.targetHandle,j.selected,j.zIndex]),$t),V=g.useMemo(()=>j.markerStart?`url('#${j1(j.markerStart,y)}')`:void 0,[j.markerStart,y]),Y=g.useMemo(()=>j.markerEnd?`url('#${j1(j.markerEnd,y)}')`:void 0,[j.markerEnd,y]);if(j.hidden||D===null||L===null||R===null||B===null)return null;const G=F=>{var je;const{addSelectedEdges:se,unselectNodesAndEdges:re,multiSelectionActive:le}=T.getState();M&&(T.setState({nodesSelectionActive:!1}),j.selected&&le?(re({nodes:[],edges:[j]}),(je=N.current)==null||je.blur()):se([e])),a&&a(F,j)},K=o?F=>{o(F,{...j})}:void 0,Q=i?F=>{i(F,{...j})}:void 0,q=s?F=>{s(F,{...j})}:void 0,H=c?F=>{c(F,{...j})}:void 0,X=l?F=>{l(F,{...j})}:void 0,te=F=>{var se;if(!w&&m3.includes(F.key)&&M){const{unselectNodesAndEdges:re,addSelectedEdges:le}=T.getState();F.key==="Escape"?((se=N.current)==null||se.blur(),re({edges:[j]})):le([e])}};return h.jsx("svg",{style:{zIndex:A},children:h.jsxs("g",{className:Qt(["react-flow__edge",`react-flow__edge-${_}`,j.className,v,{selected:j.selected,animated:j.animated,inactive:!M&&!a,updating:P,selectable:M}]),onClick:G,onDoubleClick:K,onContextMenu:Q,onMouseEnter:q,onMouseMove:H,onMouseLeave:X,onKeyDown:E?te:void 0,tabIndex:E?0:void 0,role:E?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":j.ariaLabel===null?void 0:j.ariaLabel||`Edge from ${j.source} to ${j.target}`,"aria-describedby":E?`${y5}-${y}`:void 0,ref:N,children:[!k&&h.jsx(S,{id:e,source:j.source,target:j.target,type:j.type,selected:j.selected,animated:j.animated,selectable:M,deletable:j.deletable??!0,label:j.label,labelStyle:j.labelStyle,labelShowBg:j.labelShowBg,labelBgStyle:j.labelBgStyle,labelBgPadding:j.labelBgPadding,labelBgBorderRadius:j.labelBgBorderRadius,sourceX:D,sourceY:L,targetX:R,targetY:B,sourcePosition:z,targetPosition:$,data:j.data,style:j.style,sourceHandleId:j.sourceHandle,targetHandleId:j.targetHandle,markerStart:V,markerEnd:Y,pathOptions:"pathOptions"in j?j.pathOptions:void 0,interactionWidth:j.interactionWidth}),O&&h.jsx(rce,{edge:j,isReconnectable:O,reconnectRadius:u,onReconnect:d,onReconnectStart:p,onReconnectEnd:f,sourceX:D,sourceY:L,targetX:R,targetY:B,sourcePosition:z,targetPosition:$,setUpdateHover:I,setReconnecting:C})]})})}const oce=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function a4({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:a,onReconnect:o,onEdgeContextMenu:i,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:p,onReconnectStart:f,onReconnectEnd:y,disableKeyboardA11y:m}){const{edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,onError:j}=Qe(oce,$t),x=Wse(t);return h.jsxs("div",{className:"react-flow__edges",children:[h.jsx(Zse,{defaultColor:e,rfId:n}),x.map(_=>h.jsx(ace,{id:_,edgesFocusable:v,edgesReconnectable:b,elementsSelectable:w,noPanClassName:a,onReconnect:o,onContextMenu:i,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:p,onReconnectStart:f,onReconnectEnd:y,rfId:n,onError:j,edgeTypes:r,disableKeyboardA11y:m},_))]})}a4.displayName="EdgeRenderer";const ice=g.memo(a4),sce=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function cce({children:e}){const t=Qe(sce);return h.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function lce(e){const t=lr(),n=g.useRef(!1);g.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const uce=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function dce(e){const t=Qe(uce),n=Tt();return g.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function pce(e){return e.connection.inProgress?{...e.connection,to:Gu(e.connection.to,e.transform)}:{...e.connection}}function fce(e){return pce}function hce(e){const t=fce();return Qe(t,$t)}const mce=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function yce({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:a,width:o,height:i,isValid:s,inProgress:c}=Qe(mce,$t);return o&&a&&c?h.jsx("svg",{style:e,width:o,height:i,className:"react-flow__connectionline react-flow__container",children:h.jsx("g",{className:Qt(["react-flow__connection",b3(s)]),children:h.jsx(o4,{style:t,type:n,CustomComponent:r,isValid:s})})}):null}const o4=({style:e,type:t=ni.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:a,from:o,fromNode:i,fromHandle:s,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:p}=hce();if(!a)return;if(n)return h.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:s,fromX:o.x,fromY:o.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:p,connectionStatus:b3(r),toNode:u,toHandle:d});let f="";const y={sourceX:o.x,sourceY:o.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:p};switch(t){case ni.Bezier:[f]=D3(y);break;case ni.SimpleBezier:[f]=V5(y);break;case ni.Step:[f]=_1({...y,borderRadius:0});break;case ni.SmoothStep:[f]=_1(y);break;default:[f]=F3(y)}return h.jsx("path",{d:f,fill:"none",className:"react-flow__connection-path",style:e})};o4.displayName="ConnectionLine";const gce={};function i4(e=gce){g.useRef(e),Tt(),g.useEffect(()=>{},[e])}function vce(){Tt(),g.useRef(!1),g.useEffect(()=>{},[])}function s4({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:o,onEdgeDoubleClick:i,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:p,onSelectionEnd:f,connectionLineType:y,connectionLineStyle:m,connectionLineComponent:v,connectionLineContainerStyle:b,selectionKeyCode:w,selectionOnDrag:j,selectionMode:x,multiSelectionKeyCode:_,panActivationKeyCode:S,zoomActivationKeyCode:E,deleteKeyCode:O,onlyRenderVisibleElements:M,elementsSelectable:N,defaultViewport:P,translateExtent:I,minZoom:k,maxZoom:C,preventScrolling:T,defaultMarkerColor:A,zoomOnScroll:D,zoomOnPinch:L,panOnScroll:R,panOnScrollSpeed:B,panOnScrollMode:z,zoomOnDoubleClick:$,panOnDrag:V,onPaneClick:Y,onPaneMouseEnter:G,onPaneMouseMove:K,onPaneMouseLeave:Q,onPaneScroll:q,onPaneContextMenu:H,paneClickDistance:X,nodeClickDistance:te,onEdgeContextMenu:F,onEdgeMouseEnter:se,onEdgeMouseMove:re,onEdgeMouseLeave:le,reconnectRadius:je,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Se,noDragClassName:Ve,noWheelClassName:We,noPanClassName:He,disableKeyboardA11y:Mt,nodeExtent:st,rfId:rt,viewport:bt,onViewportChange:Kt}){return i4(e),i4(t),vce(),lce(n),dce(bt),h.jsx(Rse,{onPaneClick:Y,onPaneMouseEnter:G,onPaneMouseMove:K,onPaneMouseLeave:Q,onPaneContextMenu:H,onPaneScroll:q,paneClickDistance:X,deleteKeyCode:O,selectionKeyCode:w,selectionOnDrag:j,selectionMode:x,onSelectionStart:p,onSelectionEnd:f,multiSelectionKeyCode:_,panActivationKeyCode:S,zoomActivationKeyCode:E,elementsSelectable:N,zoomOnScroll:D,zoomOnPinch:L,zoomOnDoubleClick:$,panOnScroll:R,panOnScrollSpeed:B,panOnScrollMode:z,panOnDrag:V,defaultViewport:P,translateExtent:I,minZoom:k,maxZoom:C,onSelectionContextMenu:d,preventScrolling:T,noDragClassName:Ve,noWheelClassName:We,noPanClassName:He,disableKeyboardA11y:Mt,onViewportChange:Kt,isControlledViewport:!!bt,children:h.jsxs(cce,{children:[h.jsx(ice,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:i,onReconnect:Le,onReconnectStart:$e,onReconnectEnd:Se,onlyRenderVisibleElements:M,onEdgeContextMenu:F,onEdgeMouseEnter:se,onEdgeMouseMove:re,onEdgeMouseLeave:le,reconnectRadius:je,defaultMarkerColor:A,noPanClassName:He,disableKeyboardA11y:Mt,rfId:rt}),h.jsx(yce,{style:m,type:y,component:v,containerStyle:b}),h.jsx("div",{className:"react-flow__edgelabel-renderer"}),h.jsx(Use,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:te,onlyRenderVisibleElements:M,noPanClassName:He,noDragClassName:Ve,disableKeyboardA11y:Mt,nodeExtent:st,rfId:rt}),h.jsx("div",{className:"react-flow__viewport-portal"})]})})}s4.displayName="GraphView";const bce=g.memo(s4),c4=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}={})=>{const l=new Map,u=new Map,d=new Map,p=new Map,f=r??t??[],y=n??e??[],m=s??[0,0],v=c??Hu;q3(d,p,f),O1(y,l,u,{nodeOrigin:m,nodeExtent:v,elevateNodesOnSelect:!1});let b=[0,0,1];if(i&&a&&o){const w=Xu(l,{filter:S=>!!((S.width||S.initialWidth)&&(S.height||S.initialHeight))}),{x:j,y:x,zoom:_}=w1(w,a,o,.5,2,.1);b=[j,x,_]}return{rfId:"1",width:0,height:0,transform:b,nodes:y,nodeLookup:l,parentLookup:u,edges:f,edgeLookup:p,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:Hu,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:oc.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:m,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...y3},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Xoe,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},wce=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c})=>Fie((l,u)=>({...c4({nodes:e,edges:t,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:d=>{const{nodeLookup:p,parentLookup:f,nodeOrigin:y,elevateNodesOnSelect:m}=u();O1(d,p,f,{nodeOrigin:y,nodeExtent:c,elevateNodesOnSelect:m,checkEquality:!0}),l({nodes:d})},setEdges:d=>{const{connectionLookup:p,edgeLookup:f}=u();q3(p,f,d),l({edges:d})},setDefaultNodesAndEdges:(d,p)=>{if(d){const{setNodes:f}=u();f(d),l({hasDefaultNodes:!0})}if(p){const{setEdges:f}=u();f(p),l({hasDefaultEdges:!0})}},updateNodeInternals:(d,p={triggerFitView:!0})=>{const{triggerNodeChanges:f,nodeLookup:y,parentLookup:m,fitViewOnInit:v,fitViewDone:b,fitViewOnInitOptions:w,domNode:j,nodeOrigin:x,nodeExtent:_,debug:S,fitViewSync:E}=u(),{changes:O,updatedInternals:M}=lie(d,y,m,j,x,_);if(M){if(iie(y,m,{nodeOrigin:x,nodeExtent:_}),p.triggerFitView){let N=b;!b&&v&&(N=E({...w,nodes:w==null?void 0:w.nodes})),l({fitViewDone:N})}else l({});(O==null?void 0:O.length)>0&&(S&&console.log("React Flow: trigger node changes",O),f==null||f(O))}},updateNodePositions:(d,p=!1)=>{const f=[],y=[];for(const[m,v]of d){const b={id:m,type:"position",position:v.position,dragging:p};v!=null&&v.expandParent&&(v!=null&&v.parentId)&&b.position&&(f.push({id:m,parentId:v.parentId,rect:{...v.internals.positionAbsolute,width:v.measured.width,height:v.measured.height}}),b.position.x=Math.max(0,b.position.x),b.position.y=Math.max(0,b.position.y)),y.push(b)}if(f.length>0){const{nodeLookup:m,parentLookup:v,nodeOrigin:b}=u(),w=N1(f,m,v,b);y.push(...w)}u().triggerNodeChanges(y)},triggerNodeChanges:d=>{const{onNodesChange:p,setNodes:f,nodes:y,hasDefaultNodes:m,debug:v}=u();if(d!=null&&d.length){if(m){const b=Ki(d,y);f(b)}v&&console.log("React Flow: trigger node changes",d),p==null||p(d)}},triggerEdgeChanges:d=>{const{onEdgesChange:p,setEdges:f,edges:y,hasDefaultEdges:m,debug:v}=u();if(d!=null&&d.length){if(m){const b=ed(d,y);f(b)}v&&console.log("React Flow: trigger edge changes",d),p==null||p(d)}},addSelectedNodes:d=>{const{multiSelectionActive:p,edgeLookup:f,nodeLookup:y,triggerNodeChanges:m,triggerEdgeChanges:v}=u();if(p){const b=d.map(w=>Xi(w,!0));m(b);return}m(pc(y,new Set([...d]),!0)),v(pc(f))},addSelectedEdges:d=>{const{multiSelectionActive:p,edgeLookup:f,nodeLookup:y,triggerNodeChanges:m,triggerEdgeChanges:v}=u();if(p){const b=d.map(w=>Xi(w,!0));v(b);return}v(pc(f,new Set([...d]))),m(pc(y,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:p}={})=>{const{edges:f,nodes:y,nodeLookup:m,triggerNodeChanges:v,triggerEdgeChanges:b}=u(),w=d||y,j=p||f,x=w.map(S=>{const E=m.get(S.id);return E&&(E.selected=!1),Xi(S.id,!1)}),_=j.map(S=>Xi(S.id,!1));v(x),b(_)},setMinZoom:d=>{const{panZoom:p,maxZoom:f}=u();p==null||p.setScaleExtent([d,f]),l({minZoom:d})},setMaxZoom:d=>{const{panZoom:p,minZoom:f}=u();p==null||p.setScaleExtent([f,d]),l({maxZoom:d})},setTranslateExtent:d=>{var p;(p=u().panZoom)==null||p.setTranslateExtent(d),l({translateExtent:d})},setPaneClickDistance:d=>{var p;(p=u().panZoom)==null||p.setClickDistance(d)},resetSelectedElements:()=>{const{edges:d,nodes:p,triggerNodeChanges:f,triggerEdgeChanges:y}=u(),m=p.reduce((b,w)=>w.selected?[...b,Xi(w.id,!1)]:b,[]),v=d.reduce((b,w)=>w.selected?[...b,Xi(w.id,!1)]:b,[]);f(m),y(v)},setNodeExtent:d=>{const{nodes:p,nodeLookup:f,parentLookup:y,nodeOrigin:m,elevateNodesOnSelect:v,nodeExtent:b}=u();d[0][0]===b[0][0]&&d[0][1]===b[0][1]&&d[1][0]===b[1][0]&&d[1][1]===b[1][1]||(O1(p,f,y,{nodeOrigin:m,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!1}),l({nodeExtent:d}))},panBy:d=>{const{transform:p,width:f,height:y,panZoom:m,translateExtent:v}=u();return uie({delta:d,panZoom:m,transform:p,translateExtent:v,width:f,height:y})},fitView:d=>{const{panZoom:p,width:f,height:y,minZoom:m,maxZoom:v,nodeLookup:b}=u();if(!p)return Promise.resolve(!1);const w=g1(b,d);return v1({nodes:w,width:f,height:y,panZoom:p,minZoom:m,maxZoom:v},d)},fitViewSync:d=>{const{panZoom:p,width:f,height:y,minZoom:m,maxZoom:v,nodeLookup:b}=u();if(!p)return!1;const w=g1(b,d);return v1({nodes:w,width:f,height:y,panZoom:p,minZoom:m,maxZoom:v},d),w.size>0},cancelConnection:()=>{l({connection:{...y3}})},updateConnection:d=>{l({connection:d})},reset:()=>l({...c4()})}),Object.is);function xce({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:a,initialHeight:o,fitView:i,nodeOrigin:s,nodeExtent:c,children:l}){const[u]=g.useState(()=>wce({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:o,fitView:i,nodeOrigin:s,nodeExtent:c}));return h.jsx(Bie,{value:u,children:h.jsx(lse,{children:l})})}function _ce({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:o,height:i,fitView:s,nodeOrigin:c,nodeExtent:l}){return g.useContext(Th)?h.jsx(h.Fragment,{children:e}):h.jsx(xce,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:o,initialHeight:i,fitView:s,nodeOrigin:c,nodeExtent:l,children:e})}const jce={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Sce({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:a,nodeTypes:o,edgeTypes:i,onNodeClick:s,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:p,onConnect:f,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,onNodeMouseEnter:w,onNodeMouseMove:j,onNodeMouseLeave:x,onNodeContextMenu:_,onNodeDoubleClick:S,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:M,onNodesDelete:N,onEdgesDelete:P,onDelete:I,onSelectionChange:k,onSelectionDragStart:C,onSelectionDrag:T,onSelectionDragStop:A,onSelectionContextMenu:D,onSelectionStart:L,onSelectionEnd:R,onBeforeDelete:B,connectionMode:z,connectionLineType:$=ni.Bezier,connectionLineStyle:V,connectionLineComponent:Y,connectionLineContainerStyle:G,deleteKeyCode:K="Backspace",selectionKeyCode:Q="Shift",selectionOnDrag:q=!1,selectionMode:H=qu.Full,panActivationKeyCode:X="Space",multiSelectionKeyCode:te=Nh()?"Meta":"Control",zoomActivationKeyCode:F=Nh()?"Meta":"Control",snapToGrid:se,snapGrid:re,onlyRenderVisibleElements:le=!1,selectNodesOnDrag:je,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Se,nodeOrigin:Ve=g5,edgesFocusable:We,edgesReconnectable:He,elementsSelectable:Mt=!0,defaultViewport:st=Jie,minZoom:rt=.5,maxZoom:bt=2,translateExtent:Kt=Hu,preventScrolling:Gn=!0,nodeExtent:za,defaultMarkerColor:Qn="#b1b1b7",zoomOnScroll:Va=!0,zoomOnPinch:J=!0,panOnScroll:ne=!1,panOnScrollSpeed:ce=.5,panOnScrollMode:he=ti.Free,zoomOnDoubleClick:Te=!0,panOnDrag:Ut=!0,onPaneClick:Dt,onPaneMouseEnter:Ke,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Ee,onPaneContextMenu:Oe,paneClickDistance:Ue=0,nodeClickDistance:St=0,children:Bt,onReconnect:U,onReconnectStart:ee,onReconnectEnd:ae,onEdgeContextMenu:pe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:Re,onEdgeMouseMove:Be,onEdgeMouseLeave:Me,reconnectRadius:ke=10,onNodesChange:we,onEdgesChange:ze,noDragClassName:Ye="nodrag",noWheelClassName:kt="nowheel",noPanClassName:Lt="nopan",fitView:at,fitViewOptions:Yn,connectOnClick:Xt,attributionPosition:_s,proOptions:da,defaultEdgeOptions:Ei,elevateNodesOnSelect:Ua,elevateEdgesOnSelect:Tp,disableKeyboardA11y:Nr=!1,autoPanOnConnect:Sl,autoPanOnNodeDrag:El,autoPanSpeed:Ol,connectionRadius:ft,isValidConnection:Jn,onError:js,style:zt,id:Bo,nodeDragThreshold:Sg,viewport:bN,onViewportChange:Gke,width:Qke,height:Yke,colorMode:Jke="light",debug:eAe,...tAe},nAe){const wN=Bo||"1",rAe=rse(Jke);return h.jsx("div",{...tAe,style:{...zt,...jce},ref:nAe,className:Qt(["react-flow",a,rAe]),"data-testid":"rf__wrapper",id:Bo,children:h.jsxs(_ce,{nodes:e,edges:t,width:Qke,height:Yke,fitView:at,nodeOrigin:Ve,nodeExtent:za,children:[h.jsx(bce,{onInit:l,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:w,onNodeMouseMove:j,onNodeMouseLeave:x,onNodeContextMenu:_,onNodeDoubleClick:S,nodeTypes:o,edgeTypes:i,connectionLineType:$,connectionLineStyle:V,connectionLineComponent:Y,connectionLineContainerStyle:G,selectionKeyCode:Q,selectionOnDrag:q,selectionMode:H,deleteKeyCode:K,multiSelectionKeyCode:te,panActivationKeyCode:X,zoomActivationKeyCode:F,onlyRenderVisibleElements:le,defaultViewport:st,translateExtent:Kt,minZoom:rt,maxZoom:bt,preventScrolling:Gn,zoomOnScroll:Va,zoomOnPinch:J,zoomOnDoubleClick:Te,panOnScroll:ne,panOnScrollSpeed:ce,panOnScrollMode:he,panOnDrag:Ut,onPaneClick:Dt,onPaneMouseEnter:Ke,onPaneMouseMove:be,onPaneMouseLeave:_e,onPaneScroll:Ee,onPaneContextMenu:Oe,paneClickDistance:Ue,nodeClickDistance:St,onSelectionContextMenu:D,onSelectionStart:L,onSelectionEnd:R,onReconnect:U,onReconnectStart:ee,onReconnectEnd:ae,onEdgeContextMenu:pe,onEdgeDoubleClick:Ne,onEdgeMouseEnter:Re,onEdgeMouseMove:Be,onEdgeMouseLeave:Me,reconnectRadius:ke,defaultMarkerColor:Qn,noDragClassName:Ye,noWheelClassName:kt,noPanClassName:Lt,rfId:wN,disableKeyboardA11y:Nr,nodeExtent:za,viewport:bN,onViewportChange:Gke}),h.jsx(nse,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:f,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:b,nodesDraggable:Le,nodesConnectable:$e,nodesFocusable:Se,edgesFocusable:We,edgesReconnectable:He,elementsSelectable:Mt,elevateNodesOnSelect:Ua,elevateEdgesOnSelect:Tp,minZoom:rt,maxZoom:bt,nodeExtent:za,onNodesChange:we,onEdgesChange:ze,snapToGrid:se,snapGrid:re,connectionMode:z,translateExtent:Kt,connectOnClick:Xt,defaultEdgeOptions:Ei,fitView:at,fitViewOptions:Yn,onNodesDelete:N,onEdgesDelete:P,onDelete:I,onNodeDragStart:E,onNodeDrag:O,onNodeDragStop:M,onSelectionDrag:T,onSelectionDragStart:C,onSelectionDragStop:A,onMove:u,onMoveStart:d,onMoveEnd:p,noPanClassName:Lt,nodeOrigin:Ve,rfId:wN,autoPanOnConnect:Sl,autoPanOnNodeDrag:El,autoPanSpeed:Ol,onError:js,connectionRadius:ft,isValidConnection:Jn,selectNodesOnDrag:je,nodeDragThreshold:Sg,onBeforeDelete:B,paneClickDistance:Ue,debug:eAe}),h.jsx(Yie,{onSelectionChange:k}),Bt,h.jsx(Kie,{proOptions:da,position:_s}),h.jsx(Hie,{rfId:wN,disableKeyboardA11y:Nr})]})})}var Ece=N5(Sce);const Oce=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__viewport-portal")};function Cce({children:e}){const t=Qe(Oce);return t?Nl.createPortal(e,t):null}const Nce=e=>e.nodes;function Mce(){return Qe(Nce,$t)}function $h({type:e,id:t=null,nodeId:n,onConnect:r,onDisconnect:a}){const o=$1(),i=n??o,s=g.useRef(null),c=Qe(l=>l.connectionLookup.get(`${i}-${e}-${t}`),Uoe);return g.useEffect(()=>{if(s.current&&s.current!==c){const l=c??new Map;v3(s.current,l,a),v3(l,s.current,r)}s.current=c??new Map},[c,r,a]),g.useMemo(()=>Array.from((c==null?void 0:c.values())??[]),[c])}Tn=function(e){return Qe(g.useCallback(t=>t.nodeLookup.get(e),[e]),$t)};function Pce({dimensions:e,lineWidth:t,variant:n,className:r}){return h.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:Qt(["react-flow__background-pattern",n,r])})}function kce({radius:e,className:t}){return h.jsx("circle",{cx:e,cy:e,r:e,className:Qt(["react-flow__background-pattern","dots",t])})}var wo;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(wo||(wo={}));const Ace={[wo.Dots]:1,[wo.Lines]:1,[wo.Cross]:6},Tce=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function l4({id:e,variant:t=wo.Dots,gap:n=20,size:r,lineWidth:a=1,offset:o=0,color:i,bgColor:s,style:c,className:l,patternClassName:u}){const d=g.useRef(null),{transform:p,patternId:f}=Qe(Tce,$t),y=r||Ace[t],m=t===wo.Dots,v=t===wo.Cross,b=Array.isArray(n)?n:[n,n],w=[b[0]*p[2]||1,b[1]*p[2]||1],j=y*p[2],x=Array.isArray(o)?o:[o,o],_=v?[j,j]:w,S=[x[0]*p[2]||1+_[0]/2,x[1]*p[2]||1+_[1]/2],E=`${f}${e||""}`;return h.jsxs("svg",{className:Qt(["react-flow__background",l]),style:{...c,...Rh,"--xy-background-color-props":s,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[h.jsx("pattern",{id:E,x:p[0]%w[0],y:p[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`,children:m?h.jsx(kce,{radius:j/2,className:u}):h.jsx(Pce,{dimensions:_,lineWidth:a,variant:t,className:u})}),h.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E})`})]})}l4.displayName="Background";const Ice=g.memo(l4);function Rce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:h.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Dce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:h.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Lce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:h.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function $ce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Fce(){return h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:h.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Fh({children:e,className:t,...n}){return h.jsx("button",{type:"button",className:Qt(["react-flow__controls-button",t]),...n,children:e})}const Bce=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function u4({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:a,onZoomIn:o,onZoomOut:i,onFitView:s,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:p="vertical","aria-label":f="React Flow controls"}){const y=Tt(),{isInteractive:m,minZoomReached:v,maxZoomReached:b}=Qe(Bce,$t),{zoomIn:w,zoomOut:j,fitView:x}=lr(),_=()=>{w(),o==null||o()},S=()=>{j(),i==null||i()},E=()=>{x(a),s==null||s()},O=()=>{y.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c==null||c(!m)},M=p==="horizontal"?"horizontal":"vertical";return h.jsxs(dc,{className:Qt(["react-flow__controls",M,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":f,children:[t&&h.jsxs(h.Fragment,{children:[h.jsx(Fh,{onClick:_,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b,children:h.jsx(Rce,{})}),h.jsx(Fh,{onClick:S,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:h.jsx(Dce,{})})]}),n&&h.jsx(Fh,{className:"react-flow__controls-fitview",onClick:E,title:"fit view","aria-label":"fit view",children:h.jsx(Lce,{})}),r&&h.jsx(Fh,{className:"react-flow__controls-interactive",onClick:O,title:"toggle interactivity","aria-label":"toggle interactivity",children:m?h.jsx(Fce,{}):h.jsx($ce,{})}),u]})}u4.displayName="Controls";const zce=g.memo(u4);function Vce({id:e,x:t,y:n,width:r,height:a,style:o,color:i,strokeColor:s,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:p,onClick:f}){const{background:y,backgroundColor:m}=o||{},v=i||y||m;return h.jsx("rect",{className:Qt(["react-flow__minimap-node",{selected:p},l]),x:t,y:n,rx:u,ry:u,width:r,height:a,style:{fill:v,stroke:s,strokeWidth:c},shapeRendering:d,onClick:f?b=>f(b,e):void 0})}const Uce=g.memo(Vce),Wce=e=>e.nodes.map(t=>t.id),F1=e=>e instanceof Function?e:()=>e;function Hce({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:a,nodeComponent:o=Uce,onClick:i}){const s=Qe(Wce,$t),c=F1(t),l=F1(e),u=F1(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return h.jsx(h.Fragment,{children:s.map(p=>h.jsx(Kce,{id:p,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:a,NodeComponent:o,onClick:i,shapeRendering:d},p))})}function qce({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:a,nodeStrokeWidth:o,shapeRendering:i,NodeComponent:s,onClick:c}){const{node:l,x:u,y:d,width:p,height:f}=Qe(y=>{const m=y.nodeLookup.get(e),{x:v,y:b}=m.internals.positionAbsolute,{width:w,height:j}=vo(m);return{node:m,x:v,y:b,width:w,height:j}},$t);return!l||l.hidden||!M3(l)?null:h.jsx(s,{x:u,y:d,width:p,height:f,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:a,strokeColor:n(l),strokeWidth:o,shapeRendering:i,onClick:c,id:l.id})}const Kce=g.memo(qce);var Xce=g.memo(Hce);const Zce=200,Gce=150,Qce=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?O3(Xu(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Yce="react-flow__minimap-desc";function d4({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:a="",nodeBorderRadius:o=5,nodeStrokeWidth:i,nodeComponent:s,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:p="bottom-right",onClick:f,onNodeClick:y,pannable:m=!1,zoomable:v=!1,ariaLabel:b="React Flow mini map",inversePan:w,zoomStep:j=10,offsetScale:x=5}){const _=Tt(),S=g.useRef(null),{boundingRect:E,viewBB:O,rfId:M,panZoom:N,translateExtent:P,flowWidth:I,flowHeight:k}=Qe(Qce,$t),C=(e==null?void 0:e.width)??Zce,T=(e==null?void 0:e.height)??Gce,A=E.width/C,D=E.height/T,L=Math.max(A,D),R=L*C,B=L*T,z=x*L,$=E.x-(R-E.width)/2-z,V=E.y-(B-E.height)/2-z,Y=R+z*2,G=B+z*2,K=`${Yce}-${M}`,Q=g.useRef(0),q=g.useRef();Q.current=L,g.useEffect(()=>{if(S.current&&N)return q.current=vie({domNode:S.current,panZoom:N,getTransform:()=>_.getState().transform,getViewScale:()=>Q.current}),()=>{var te;(te=q.current)==null||te.destroy()}},[N]),g.useEffect(()=>{var te;(te=q.current)==null||te.update({translateExtent:P,width:I,height:k,inversePan:w,pannable:m,zoomStep:j,zoomable:v})},[m,v,w,j,P,I,k]);const H=f?te=>{var re;const[F,se]=((re=q.current)==null?void 0:re.pointer(te))||[0,0];f(te,{x:F,y:se})}:void 0,X=y?g.useCallback((te,F)=>{const se=_.getState().nodeLookup.get(F);y(te,se)},[]):void 0;return h.jsx(dc,{position:p,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*L:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="string"?i:void 0},className:Qt(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:h.jsxs("svg",{width:C,height:T,viewBox:`${$} ${V} ${Y} ${G}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":K,ref:S,onClick:H,children:[b&&h.jsx("title",{id:K,children:b}),h.jsx(Xce,{onClick:X,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:o,nodeClassName:a,nodeStrokeWidth:i,nodeComponent:s}),h.jsx("path",{className:"react-flow__minimap-mask",d:`M${$-z},${V-z}h${Y+z*2}v${G+z*2}h${-Y-z*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}d4.displayName="MiniMap";const Jce=g.memo(d4);function ele({nodeId:e,position:t,variant:n=uc.Handle,className:r,style:a={},children:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:p,onResizeStart:f,onResize:y,onResizeEnd:m}){const v=$1(),b=typeof e=="string"?e:v,w=Tt(),j=g.useRef(null),x=n===uc.Line?"right":"bottom-right",_=t??x,S=g.useRef(null);g.useEffect(()=>{if(!(!j.current||!b))return S.current||(S.current=Rie({domNode:j.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:N,transform:P,snapGrid:I,snapToGrid:k,nodeOrigin:C,domNode:T}=w.getState();return{nodeLookup:N,transform:P,snapGrid:I,snapToGrid:k,nodeOrigin:C,paneDomNode:T}},onChange:(N,P)=>{const{triggerNodeChanges:I,nodeLookup:k,parentLookup:C,nodeOrigin:T}=w.getState(),A=[],D={x:N.x,y:N.y},L=k.get(b);if(L&&L.expandParent&&L.parentId){const R=L.origin??T,B=N.width??L.measured.width,z=N.height??L.measured.height,$={id:L.id,parentId:L.parentId,rect:{width:B,height:z,...P3({x:N.x??L.position.x,y:N.y??L.position.y},{width:B,height:z},L.parentId,k,R)}},V=N1([$],k,C,T);A.push(...V),D.x=N.x?Math.max(R[0]*B,N.x):void 0,D.y=N.y?Math.max(R[1]*z,N.y):void 0}if(D.x!==void 0&&D.y!==void 0){const R={id:b,type:"position",position:{...D}};A.push(R)}if(N.width!==void 0&&N.height!==void 0){const R={id:b,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:N.width,height:N.height}};A.push(R)}for(const R of P){const B={...R,type:"position"};A.push(B)}I(A)},onEnd:()=>{const N={id:b,type:"dimensions",resizing:!1};w.getState().triggerNodeChanges([N])}})),S.current.update({controlPosition:_,boundaries:{minWidth:s,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,onResizeStart:f,onResize:y,onResizeEnd:m,shouldResize:p}),()=>{var N;(N=S.current)==null||N.destroy()}},[_,s,c,l,u,d,f,y,m,p]);const E=_.split("-"),O=n===uc.Line?"borderColor":"backgroundColor",M=i?{...a,[O]:i}:a;return h.jsx("div",{className:Qt(["react-flow__resize-control","nodrag",...E,n,r]),ref:j,style:M,children:o})}const p4=g.memo(ele);function tle({nodeId:e,isVisible:t=!0,handleClassName:n,handleStyle:r,lineClassName:a,lineStyle:o,color:i,minWidth:s=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:p,onResizeStart:f,onResize:y,onResizeEnd:m}){return t?h.jsxs(h.Fragment,{children:[Nie.map(v=>h.jsx(p4,{className:a,style:o,nodeId:e,position:v,variant:uc.Line,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:f,keepAspectRatio:d,shouldResize:p,onResize:y,onResizeEnd:m},v)),Cie.map(v=>h.jsx(p4,{className:n,style:r,nodeId:e,position:v,color:i,minWidth:s,minHeight:c,maxWidth:l,maxHeight:u,onResizeStart:f,keepAspectRatio:d,shouldResize:p,onResize:y,onResizeEnd:m},v))]}):null}var B1,f4;function nle(){if(f4)return B1;f4=1;var e=function(b){return t(b)&&!n(b)};function t(b){return!!b&&typeof b=="object"}function n(b){var w=Object.prototype.toString.call(b);return w==="[object RegExp]"||w==="[object Date]"||o(b)}var r=typeof Symbol=="function"&&Symbol.for,a=r?Symbol.for("react.element"):60103;function o(b){return b.$$typeof===a}function i(b){return Array.isArray(b)?[]:{}}function s(b,w){return w.clone!==!1&&w.isMergeableObject(b)?m(i(b),b,w):b}function c(b,w,j){return b.concat(w).map(function(x){return s(x,j)})}function l(b,w){if(!w.customMerge)return m;var j=w.customMerge(b);return typeof j=="function"?j:m}function u(b){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(b).filter(function(w){return Object.propertyIsEnumerable.call(b,w)}):[]}function d(b){return Object.keys(b).concat(u(b))}function p(b,w){try{return w in b}catch{return!1}}function f(b,w){return p(b,w)&&!(Object.hasOwnProperty.call(b,w)&&Object.propertyIsEnumerable.call(b,w))}function y(b,w,j){var x={};return j.isMergeableObject(b)&&d(b).forEach(function(_){x[_]=s(b[_],j)}),d(w).forEach(function(_){f(b,_)||(p(b,_)&&j.isMergeableObject(w[_])?x[_]=l(_,j)(b[_],w[_],j):x[_]=s(w[_],j))}),x}function m(b,w,j){j=j||{},j.arrayMerge=j.arrayMerge||c,j.isMergeableObject=j.isMergeableObject||e,j.cloneUnlessOtherwiseSpecified=s;var x=Array.isArray(w),_=Array.isArray(b),S=x===_;return S?x?j.arrayMerge(b,w,j):y(b,w,j):s(w,j)}m.all=function(b,w){if(!Array.isArray(b))throw new Error("first argument should be an array");return b.reduce(function(j,x){return m(j,x,w)},{})};var v=m;return B1=v,B1}var rle=nle();const Bh=ot(rle);var h4={},m4;function ale(){if(m4)return h4;m4=1;var e;return function(t){(function(n){var r=typeof globalThis=="object"?globalThis:typeof Al=="object"?Al:typeof self=="object"?self:typeof this=="object"?this:c(),a=o(t);typeof r.Reflect<"u"&&(a=o(r.Reflect,a)),n(a,r),typeof r.Reflect>"u"&&(r.Reflect=t);function o(l,u){return function(d,p){Object.defineProperty(l,d,{configurable:!0,writable:!0,value:p}),u&&u(d,p)}}function i(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function c(){return i()||s()}})(function(n,r){var a=Object.prototype.hasOwnProperty,o=typeof Symbol=="function",i=o&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=o&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,u=!c&&!l,d={create:c?function(){return Va(Object.create(null))}:l?function(){return Va({__proto__:null})}:function(){return Va({})},has:u?function(J,ne){return a.call(J,ne)}:function(J,ne){return ne in J},get:u?function(J,ne){return a.call(J,ne)?J[ne]:void 0}:function(J,ne){return J[ne]}},p=Object.getPrototypeOf(Function),f=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Gn(),y=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:za(),m=typeof WeakMap=="function"?WeakMap:Qn(),v=o?Symbol.for("@reflect-metadata:registry"):void 0,b=st(),w=rt(b);function j(J,ne,ce,he){if(V(ce)){if(!F(J))throw new TypeError;if(!re(ne))throw new TypeError;return k(J,ne)}else{if(!F(J))throw new TypeError;if(!K(ne))throw new TypeError;if(!K(he)&&!V(he)&&!Y(he))throw new TypeError;return Y(he)&&(he=void 0),ce=te(ce),C(J,ne,ce,he)}}n("decorate",j);function x(J,ne){function ce(he,Te){if(!K(he))throw new TypeError;if(!V(Te)&&!le(Te))throw new TypeError;R(J,ne,he,Te)}return ce}n("metadata",x);function _(J,ne,ce,he){if(!K(ce))throw new TypeError;return V(he)||(he=te(he)),R(J,ne,ce,he)}n("defineMetadata",_);function S(J,ne,ce){if(!K(ne))throw new TypeError;return V(ce)||(ce=te(ce)),T(J,ne,ce)}n("hasMetadata",S);function E(J,ne,ce){if(!K(ne))throw new TypeError;return V(ce)||(ce=te(ce)),A(J,ne,ce)}n("hasOwnMetadata",E);function O(J,ne,ce){if(!K(ne))throw new TypeError;return V(ce)||(ce=te(ce)),D(J,ne,ce)}n("getMetadata",O);function M(J,ne,ce){if(!K(ne))throw new TypeError;return V(ce)||(ce=te(ce)),L(J,ne,ce)}n("getOwnMetadata",M);function N(J,ne){if(!K(J))throw new TypeError;return V(ne)||(ne=te(ne)),B(J,ne)}n("getMetadataKeys",N);function P(J,ne){if(!K(J))throw new TypeError;return V(ne)||(ne=te(ne)),z(J,ne)}n("getOwnMetadataKeys",P);function I(J,ne,ce){if(!K(ne))throw new TypeError;if(V(ce)||(ce=te(ce)),!K(ne))throw new TypeError;V(ce)||(ce=te(ce));var he=Kt(ne,ce,!1);return V(he)?!1:he.OrdinaryDeleteMetadata(J,ne,ce)}n("deleteMetadata",I);function k(J,ne){for(var ce=J.length-1;ce>=0;--ce){var he=J[ce],Te=he(ne);if(!V(Te)&&!Y(Te)){if(!re(Te))throw new TypeError;ne=Te}}return ne}function C(J,ne,ce,he){for(var Te=J.length-1;Te>=0;--Te){var Ut=J[Te],Dt=Ut(ne,ce,he);if(!V(Dt)&&!Y(Dt)){if(!K(Dt))throw new TypeError;he=Dt}}return he}function T(J,ne,ce){var he=A(J,ne,ce);if(he)return!0;var Te=He(ne);return Y(Te)?!1:T(J,Te,ce)}function A(J,ne,ce){var he=Kt(ne,ce,!1);return V(he)?!1:H(he.OrdinaryHasOwnMetadata(J,ne,ce))}function D(J,ne,ce){var he=A(J,ne,ce);if(he)return L(J,ne,ce);var Te=He(ne);if(!Y(Te))return D(J,Te,ce)}function L(J,ne,ce){var he=Kt(ne,ce,!1);if(!V(he))return he.OrdinaryGetOwnMetadata(J,ne,ce)}function R(J,ne,ce,he){var Te=Kt(ce,he,!0);Te.OrdinaryDefineOwnMetadata(J,ne,ce,he)}function B(J,ne){var ce=z(J,ne),he=He(J);if(he===null)return ce;var Te=B(he,ne);if(Te.length<=0)return ce;if(ce.length<=0)return Te;for(var Ut=new y,Dt=[],Ke=0,be=ce;Ke<be.length;Ke++){var _e=be[Ke],Ee=Ut.has(_e);Ee||(Ut.add(_e),Dt.push(_e))}for(var Oe=0,Ue=Te;Oe<Ue.length;Oe++){var _e=Ue[Oe],Ee=Ut.has(_e);Ee||(Ut.add(_e),Dt.push(_e))}return Dt}function z(J,ne){var ce=Kt(J,ne,!1);return ce?ce.OrdinaryOwnMetadataKeys(J,ne):[]}function $(J){if(J===null)return 1;switch(typeof J){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return J===null?1:6;default:return 6}}function V(J){return J===void 0}function Y(J){return J===null}function G(J){return typeof J=="symbol"}function K(J){return typeof J=="object"?J!==null:typeof J=="function"}function Q(J,ne){switch($(J)){case 0:return J;case 1:return J;case 2:return J;case 3:return J;case 4:return J;case 5:return J}var ce="string",he=Le(J,i);if(he!==void 0){var Te=he.call(J,ce);if(K(Te))throw new TypeError;return Te}return q(J)}function q(J,ne){var ce,he;{var Te=J.toString;if(se(Te)){var he=Te.call(J);if(!K(he))return he}var ce=J.valueOf;if(se(ce)){var he=ce.call(J);if(!K(he))return he}}throw new TypeError}function H(J){return!!J}function X(J){return""+J}function te(J){var ne=Q(J);return G(ne)?ne:X(ne)}function F(J){return Array.isArray?Array.isArray(J):J instanceof Object?J instanceof Array:Object.prototype.toString.call(J)==="[object Array]"}function se(J){return typeof J=="function"}function re(J){return typeof J=="function"}function le(J){switch($(J)){case 3:return!0;case 4:return!0;default:return!1}}function je(J,ne){return J===ne||J!==J&&ne!==ne}function Le(J,ne){var ce=J[ne];if(ce!=null){if(!se(ce))throw new TypeError;return ce}}function $e(J){var ne=Le(J,s);if(!se(ne))throw new TypeError;var ce=ne.call(J);if(!K(ce))throw new TypeError;return ce}function Se(J){return J.value}function Ve(J){var ne=J.next();return ne.done?!1:ne}function We(J){var ne=J.return;ne&&ne.call(J)}function He(J){var ne=Object.getPrototypeOf(J);if(typeof J!="function"||J===p||ne!==p)return ne;var ce=J.prototype,he=ce&&Object.getPrototypeOf(ce);if(he==null||he===Object.prototype)return ne;var Te=he.constructor;return typeof Te!="function"||Te===J?ne:Te}function Mt(){var J;!V(v)&&typeof r.Reflect<"u"&&!(v in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(J=bt(r.Reflect));var ne,ce,he,Te=new m,Ut={registerProvider:Dt,getProvider:be,setProvider:Ee};return Ut;function Dt(Oe){if(!Object.isExtensible(Ut))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case J===Oe:break;case V(ne):ne=Oe;break;case ne===Oe:break;case V(ce):ce=Oe;break;case ce===Oe:break;default:he===void 0&&(he=new y),he.add(Oe);break}}function Ke(Oe,Ue){if(!V(ne)){if(ne.isProviderFor(Oe,Ue))return ne;if(!V(ce)){if(ce.isProviderFor(Oe,Ue))return ne;if(!V(he))for(var St=$e(he);;){var Bt=Ve(St);if(!Bt)return;var U=Se(Bt);if(U.isProviderFor(Oe,Ue))return We(St),U}}}if(!V(J)&&J.isProviderFor(Oe,Ue))return J}function be(Oe,Ue){var St=Te.get(Oe),Bt;return V(St)||(Bt=St.get(Ue)),V(Bt)&&(Bt=Ke(Oe,Ue),V(Bt)||(V(St)&&(St=new f,Te.set(Oe,St)),St.set(Ue,Bt))),Bt}function _e(Oe){if(V(Oe))throw new TypeError;return ne===Oe||ce===Oe||!V(he)&&he.has(Oe)}function Ee(Oe,Ue,St){if(!_e(St))throw new Error("Metadata provider not registered.");var Bt=be(Oe,Ue);if(Bt!==St){if(!V(Bt))return!1;var U=Te.get(Oe);V(U)&&(U=new f,Te.set(Oe,U)),U.set(Ue,St)}return!0}}function st(){var J;return!V(v)&&K(r.Reflect)&&Object.isExtensible(r.Reflect)&&(J=r.Reflect[v]),V(J)&&(J=Mt()),!V(v)&&K(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,v,{enumerable:!1,configurable:!1,writable:!1,value:J}),J}function rt(J){var ne=new m,ce={isProviderFor:function(_e,Ee){var Oe=ne.get(_e);return V(Oe)?!1:Oe.has(Ee)},OrdinaryDefineOwnMetadata:Dt,OrdinaryHasOwnMetadata:Te,OrdinaryGetOwnMetadata:Ut,OrdinaryOwnMetadataKeys:Ke,OrdinaryDeleteMetadata:be};return b.registerProvider(ce),ce;function he(_e,Ee,Oe){var Ue=ne.get(_e),St=!1;if(V(Ue)){if(!Oe)return;Ue=new f,ne.set(_e,Ue),St=!0}var Bt=Ue.get(Ee);if(V(Bt)){if(!Oe)return;if(Bt=new f,Ue.set(Ee,Bt),!J.setProvider(_e,Ee,ce))throw Ue.delete(Ee),St&&ne.delete(_e),new Error("Wrong provider for target.")}return Bt}function Te(_e,Ee,Oe){var Ue=he(Ee,Oe,!1);return V(Ue)?!1:H(Ue.has(_e))}function Ut(_e,Ee,Oe){var Ue=he(Ee,Oe,!1);if(!V(Ue))return Ue.get(_e)}function Dt(_e,Ee,Oe,Ue){var St=he(Oe,Ue,!0);St.set(_e,Ee)}function Ke(_e,Ee){var Oe=[],Ue=he(_e,Ee,!1);if(V(Ue))return Oe;for(var St=Ue.keys(),Bt=$e(St),U=0;;){var ee=Ve(Bt);if(!ee)return Oe.length=U,Oe;var ae=Se(ee);try{Oe[U]=ae}catch(pe){try{We(Bt)}finally{throw pe}}U++}}function be(_e,Ee,Oe){var Ue=he(Ee,Oe,!1);if(V(Ue)||!Ue.delete(_e))return!1;if(Ue.size===0){var St=ne.get(Ee);V(St)||(St.delete(Oe),St.size===0&&ne.delete(St))}return!0}}function bt(J){var ne=J.defineMetadata,ce=J.hasOwnMetadata,he=J.getOwnMetadata,Te=J.getOwnMetadataKeys,Ut=J.deleteMetadata,Dt=new m,Ke={isProviderFor:function(be,_e){var Ee=Dt.get(be);return!V(Ee)&&Ee.has(_e)?!0:Te(be,_e).length?(V(Ee)&&(Ee=new y,Dt.set(be,Ee)),Ee.add(_e),!0):!1},OrdinaryDefineOwnMetadata:ne,OrdinaryHasOwnMetadata:ce,OrdinaryGetOwnMetadata:he,OrdinaryOwnMetadataKeys:Te,OrdinaryDeleteMetadata:Ut};return Ke}function Kt(J,ne,ce){var he=b.getProvider(J,ne);if(!V(he))return he;if(ce){if(b.setProvider(J,ne,w))return w;throw new Error("Illegal state.")}}function Gn(){var J={},ne=[],ce=function(){function Ke(be,_e,Ee){this._index=0,this._keys=be,this._values=_e,this._selector=Ee}return Ke.prototype["@@iterator"]=function(){return this},Ke.prototype[s]=function(){return this},Ke.prototype.next=function(){var be=this._index;if(be>=0&&be<this._keys.length){var _e=this._selector(this._keys[be],this._values[be]);return be+1>=this._keys.length?(this._index=-1,this._keys=ne,this._values=ne):this._index++,{value:_e,done:!1}}return{value:void 0,done:!0}},Ke.prototype.throw=function(be){throw this._index>=0&&(this._index=-1,this._keys=ne,this._values=ne),be},Ke.prototype.return=function(be){return this._index>=0&&(this._index=-1,this._keys=ne,this._values=ne),{value:be,done:!0}},Ke}(),he=function(){function Ke(){this._keys=[],this._values=[],this._cacheKey=J,this._cacheIndex=-2}return Object.defineProperty(Ke.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Ke.prototype.has=function(be){return this._find(be,!1)>=0},Ke.prototype.get=function(be){var _e=this._find(be,!1);return _e>=0?this._values[_e]:void 0},Ke.prototype.set=function(be,_e){var Ee=this._find(be,!0);return this._values[Ee]=_e,this},Ke.prototype.delete=function(be){var _e=this._find(be,!1);if(_e>=0){for(var Ee=this._keys.length,Oe=_e+1;Oe<Ee;Oe++)this._keys[Oe-1]=this._keys[Oe],this._values[Oe-1]=this._values[Oe];return this._keys.length--,this._values.length--,je(be,this._cacheKey)&&(this._cacheKey=J,this._cacheIndex=-2),!0}return!1},Ke.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=J,this._cacheIndex=-2},Ke.prototype.keys=function(){return new ce(this._keys,this._values,Te)},Ke.prototype.values=function(){return new ce(this._keys,this._values,Ut)},Ke.prototype.entries=function(){return new ce(this._keys,this._values,Dt)},Ke.prototype["@@iterator"]=function(){return this.entries()},Ke.prototype[s]=function(){return this.entries()},Ke.prototype._find=function(be,_e){if(!je(this._cacheKey,be)){this._cacheIndex=-1;for(var Ee=0;Ee<this._keys.length;Ee++)if(je(this._keys[Ee],be)){this._cacheIndex=Ee;break}}return this._cacheIndex<0&&_e&&(this._cacheIndex=this._keys.length,this._keys.push(be),this._values.push(void 0)),this._cacheIndex},Ke}();return he;function Te(Ke,be){return Ke}function Ut(Ke,be){return be}function Dt(Ke,be){return[Ke,be]}}function za(){var J=function(){function ne(){this._map=new f}return Object.defineProperty(ne.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ne.prototype.has=function(ce){return this._map.has(ce)},ne.prototype.add=function(ce){return this._map.set(ce,ce),this},ne.prototype.delete=function(ce){return this._map.delete(ce)},ne.prototype.clear=function(){this._map.clear()},ne.prototype.keys=function(){return this._map.keys()},ne.prototype.values=function(){return this._map.keys()},ne.prototype.entries=function(){return this._map.entries()},ne.prototype["@@iterator"]=function(){return this.keys()},ne.prototype[s]=function(){return this.keys()},ne}();return J}function Qn(){var J=16,ne=d.create(),ce=he();return function(){function be(){this._key=he()}return be.prototype.has=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?d.has(Ee,this._key):!1},be.prototype.get=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?d.get(Ee,this._key):void 0},be.prototype.set=function(_e,Ee){var Oe=Te(_e,!0);return Oe[this._key]=Ee,this},be.prototype.delete=function(_e){var Ee=Te(_e,!1);return Ee!==void 0?delete Ee[this._key]:!1},be.prototype.clear=function(){this._key=he()},be}();function he(){var be;do be="@@WeakMap@@"+Ke();while(d.has(ne,be));return ne[be]=!0,be}function Te(be,_e){if(!a.call(be,ce)){if(!_e)return;Object.defineProperty(be,ce,{value:d.create()})}return be[ce]}function Ut(be,_e){for(var Ee=0;Ee<_e;++Ee)be[Ee]=Math.random()*255|0;return be}function Dt(be){if(typeof Uint8Array=="function"){var _e=new Uint8Array(be);return typeof crypto<"u"?crypto.getRandomValues(_e):typeof msCrypto<"u"?msCrypto.getRandomValues(_e):Ut(_e,be),_e}return Ut(new Array(be),be)}function Ke(){var be=Dt(J);be[6]=be[6]&79|64,be[8]=be[8]&191|128;for(var _e="",Ee=0;Ee<J;++Ee){var Oe=be[Ee];(Ee===4||Ee===6||Ee===8)&&(_e+="-"),Oe<16&&(_e+="0"),_e+=Oe.toString(16).toLowerCase()}return _e}}function Va(J){return J.__=void 0,delete J.__,J}})}(e||(e={})),h4}ale(),typeof window<"u"&&(window.Buffer=vAe),typeof Tg<"u"&&typeof require<"u"&&(Tg.Buffer=require("buffer/").Buffer);class Yt{static isObject(t){return t!==null&&typeof t=="object"}static isObjectWithName(t){return t!==null&&typeof t=="object"&&t.name!==void 0}static assign(t,...n){for(const r of n)for(const a of Object.getOwnPropertyNames(r))t[a]=r[a]}static mixedListToArray(t){return t!==null&&typeof t=="object"?Object.keys(t).map(n=>t[n]):t}}class xe extends Error{get name(){return this.constructor.name}constructor(t){super(t),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class fc extends xe{constructor(){super("Locking not supported on given driver.")}}class z1 extends xe{constructor(){super('Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')}}class Ct{static isMssqlParameter(t){return this.check(t,"MssqlParameter")}static isEntityMetadata(t){return this.check(t,"EntityMetadata")}static isColumnMetadata(t){return this.check(t,"ColumnMetadata")}static isSelectQueryBuilder(t){return this.check(t,"SelectQueryBuilder")}static isInsertQueryBuilder(t){return this.check(t,"InsertQueryBuilder")}static isDeleteQueryBuilder(t){return this.check(t,"DeleteQueryBuilder")}static isUpdateQueryBuilder(t){return this.check(t,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(t){return this.check(t,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(t){return this.check(t,"RelationQueryBuilder")}static isBrackets(t){return this.check(t,"Brackets")||this.check(t,"NotBrackets")}static isNotBrackets(t){return this.check(t,"NotBrackets")}static isSubject(t){return this.check(t,"Subject")}static isRdbmsSchemaBuilder(t){return this.check(t,"RdbmsSchemaBuilder")}static isMongoEntityManager(t){return this.check(t,"MongoEntityManager")}static isSqljsEntityManager(t){return this.check(t,"SqljsEntityManager")}static isEntitySchema(t){return this.check(t,"EntitySchema")}static isBaseEntityConstructor(t){return typeof t=="function"&&typeof t.hasId=="function"&&typeof t.save=="function"&&typeof t.useDataSource=="function"}static isFindOperator(t){return this.check(t,"FindOperator")||this.check(t,"EqualOperator")}static isEqualOperator(t){return this.check(t,"EqualOperator")}static isQuery(t){return this.check(t,"Query")}static isTable(t){return this.check(t,"Table")}static isTableCheck(t){return this.check(t,"TableCheck")}static isTableColumn(t){return this.check(t,"TableColumn")}static isTableExclusion(t){return this.check(t,"TableExclusion")}static isTableForeignKey(t){return this.check(t,"TableForeignKey")}static isTableIndex(t){return this.check(t,"TableIndex")}static isTableUnique(t){return this.check(t,"TableUnique")}static isView(t){return this.check(t,"View")}static isDataSource(t){return this.check(t,"DataSource")}static check(t,n){return typeof t=="object"&&t!==null&&t["@instanceof"]===Symbol.for(n)}}class ole extends xe{constructor(t,n){super(),this.entityClass=t,this.criteria=n,this.message=`Could not find any entity of type "${this.stringifyTarget(t)}" matching: ${this.stringifyCriteria(n)}`}stringifyTarget(t){return Ct.isEntitySchema(t)?t.options.name:typeof t=="function"||Yt.isObject(t)&&"name"in t?t.name:t}stringifyCriteria(t){try{return JSON.stringify(t,null,4)}catch{}return""+t}}class y4 extends xe{constructor(t,n,r){super(`The optimistic lock on entity ${t} failed, version ${n} was expected, but is actually ${r}.`)}}class g4 extends xe{constructor(){super("Your database does not support LIMIT on UPDATE statements.")}}class ile extends xe{constructor(t){super(`Entity "${t.name}" does not have delete date columns.`)}}class zh extends xe{constructor(){super("OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL or MariaDB databases.")}}class Ea extends xe{constructor(t,n){super(t),Object.setPrototypeOf(this,Ea.prototype),this.message=`Property "${t}" was not found in "${n.targetName}". Make sure your query is correct.`}}class sle extends xe{constructor(t){super(`Entity ${t} does not have version or update date columns.`)}}class cle extends xe{constructor(){super('Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')}}class nd extends xe{constructor(){super("The optimistic lock can be used only with getOne() method.")}}class lle extends xe{constructor(t){super(),t.length===1?this.message=`Relation "${t[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${t.map(n=>`"${n}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class ule extends xe{constructor(){super("An open transaction is required for pessimistic lock.")}}class dle extends xe{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class v4{constructor(t){Yt.assign(this,t||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(t){this._metadata=t}get metadata(){if(!this._metadata)throw new xe(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class Oa{static isAliasProperty(t){if(typeof t!="string"||t.indexOf(".")===-1)return!1;const[n,r]=t.split(".");return!(!n||!r||t.indexOf("(")!==-1||t.indexOf(")")!==-1)}}var V1={exports:{}},U1={exports:{}},b4;function hc(){return b4||(b4=1,typeof Object.create=="function"?U1.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:U1.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),U1.exports}var W1={exports:{}},w4;function Zi(){return w4||(w4=1,function(e,t){var n=bAe(),r=n.Buffer;function a(i,s){for(var c in i)s[c]=i[c]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o);function o(i,s,c){return r(i,s,c)}o.prototype=Object.create(r.prototype),a(r,o),o.from=function(i,s,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return r(i,s,c)},o.alloc=function(i,s,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var l=r(i);return s!==void 0?typeof c=="string"?l.fill(s,c):l.fill(s):l.fill(0),l},o.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r(i)},o.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(i)}}(W1,W1.exports)),W1.exports}var H1,x4;function mc(){if(x4)return H1;x4=1;var e=Zi().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var a=this._block,o=this._blockSize,i=n.length,s=this._len,c=0;c<i;){for(var l=s%o,u=Math.min(i-c,o-l),d=0;d<u;d++)a[l+d]=n[c+d];s+=u,c+=u,s%o===0&&this._update(a)}return this._len+=i,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var o=(a&4294967295)>>>0,i=(a-o)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(o,this._blockSize-4)}this._update(this._block);var s=this._hash();return n?s.toString(n):s},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},H1=t,H1}var q1,_4;function ple(){if(_4)return q1;_4=1;var e=hc(),t=mc(),n=Zi().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(l){return l<<5|l>>>27}function s(l){return l<<30|l>>>2}function c(l,u,d,p){return l===0?u&d|~u&p:l===2?u&d|u&p|d&p:u^d^p}return o.prototype._update=function(l){for(var u=this._w,d=this._a|0,p=this._b|0,f=this._c|0,y=this._d|0,m=this._e|0,v=0;v<16;++v)u[v]=l.readInt32BE(v*4);for(;v<80;++v)u[v]=u[v-3]^u[v-8]^u[v-14]^u[v-16];for(var b=0;b<80;++b){var w=~~(b/20),j=i(d)+c(w,p,f,y)+m+u[b]+r[w]|0;m=y,y=f,f=s(p),p=d,d=j}this._a=d+this._a|0,this._b=p+this._b|0,this._c=f+this._c|0,this._d=y+this._d|0,this._e=m+this._e|0},o.prototype._hash=function(){var l=n.allocUnsafe(20);return l.writeInt32BE(this._a|0,0),l.writeInt32BE(this._b|0,4),l.writeInt32BE(this._c|0,8),l.writeInt32BE(this._d|0,12),l.writeInt32BE(this._e|0,16),l},q1=o,q1}var K1,j4;function fle(){if(j4)return K1;j4=1;var e=hc(),t=mc(),n=Zi().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function i(u){return u<<1|u>>>31}function s(u){return u<<5|u>>>27}function c(u){return u<<30|u>>>2}function l(u,d,p,f){return u===0?d&p|~d&f:u===2?d&p|d&f|p&f:d^p^f}return o.prototype._update=function(u){for(var d=this._w,p=this._a|0,f=this._b|0,y=this._c|0,m=this._d|0,v=this._e|0,b=0;b<16;++b)d[b]=u.readInt32BE(b*4);for(;b<80;++b)d[b]=i(d[b-3]^d[b-8]^d[b-14]^d[b-16]);for(var w=0;w<80;++w){var j=~~(w/20),x=s(p)+l(j,f,y,m)+v+d[w]+r[j]|0;v=m,m=y,y=c(f),f=p,p=x}this._a=p+this._a|0,this._b=f+this._b|0,this._c=y+this._c|0,this._d=m+this._d|0,this._e=v+this._e|0},o.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},K1=o,K1}var X1,S4;function E4(){if(S4)return X1;S4=1;var e=hc(),t=mc(),n=Zi().Buffer,r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function o(){this.init(),this._w=a,t.call(this,64,56)}e(o,t),o.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function i(p,f,y){return y^p&(f^y)}function s(p,f,y){return p&f|y&(p|f)}function c(p){return(p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10)}function l(p){return(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7)}function u(p){return(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3}function d(p){return(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10}return o.prototype._update=function(p){for(var f=this._w,y=this._a|0,m=this._b|0,v=this._c|0,b=this._d|0,w=this._e|0,j=this._f|0,x=this._g|0,_=this._h|0,S=0;S<16;++S)f[S]=p.readInt32BE(S*4);for(;S<64;++S)f[S]=d(f[S-2])+f[S-7]+u(f[S-15])+f[S-16]|0;for(var E=0;E<64;++E){var O=_+l(w)+i(w,j,x)+r[E]+f[E]|0,M=c(y)+s(y,m,v)|0;_=x,x=j,j=w,w=b+O|0,b=v,v=m,m=y,y=O+M|0}this._a=y+this._a|0,this._b=m+this._b|0,this._c=v+this._c|0,this._d=b+this._d|0,this._e=w+this._e|0,this._f=j+this._f|0,this._g=x+this._g|0,this._h=_+this._h|0},o.prototype._hash=function(){var p=n.allocUnsafe(32);return p.writeInt32BE(this._a,0),p.writeInt32BE(this._b,4),p.writeInt32BE(this._c,8),p.writeInt32BE(this._d,12),p.writeInt32BE(this._e,16),p.writeInt32BE(this._f,20),p.writeInt32BE(this._g,24),p.writeInt32BE(this._h,28),p},X1=o,X1}var Z1,O4;function hle(){if(O4)return Z1;O4=1;var e=hc(),t=E4(),n=mc(),r=Zi().Buffer,a=new Array(64);function o(){this.init(),this._w=a,n.call(this,64,56)}return e(o,t),o.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(28);return i.writeInt32BE(this._a,0),i.writeInt32BE(this._b,4),i.writeInt32BE(this._c,8),i.writeInt32BE(this._d,12),i.writeInt32BE(this._e,16),i.writeInt32BE(this._f,20),i.writeInt32BE(this._g,24),i},Z1=o,Z1}var G1,C4;function N4(){if(C4)return G1;C4=1;var e=hc(),t=mc(),n=Zi().Buffer,r=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function o(){this.init(),this._w=a,t.call(this,128,112)}e(o,t),o.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function i(m,v,b){return b^m&(v^b)}function s(m,v,b){return m&v|b&(m|v)}function c(m,v){return(m>>>28|v<<4)^(v>>>2|m<<30)^(v>>>7|m<<25)}function l(m,v){return(m>>>14|v<<18)^(m>>>18|v<<14)^(v>>>9|m<<23)}function u(m,v){return(m>>>1|v<<31)^(m>>>8|v<<24)^m>>>7}function d(m,v){return(m>>>1|v<<31)^(m>>>8|v<<24)^(m>>>7|v<<25)}function p(m,v){return(m>>>19|v<<13)^(v>>>29|m<<3)^m>>>6}function f(m,v){return(m>>>19|v<<13)^(v>>>29|m<<3)^(m>>>6|v<<26)}function y(m,v){return m>>>0<v>>>0?1:0}return o.prototype._update=function(m){for(var v=this._w,b=this._ah|0,w=this._bh|0,j=this._ch|0,x=this._dh|0,_=this._eh|0,S=this._fh|0,E=this._gh|0,O=this._hh|0,M=this._al|0,N=this._bl|0,P=this._cl|0,I=this._dl|0,k=this._el|0,C=this._fl|0,T=this._gl|0,A=this._hl|0,D=0;D<32;D+=2)v[D]=m.readInt32BE(D*4),v[D+1]=m.readInt32BE(D*4+4);for(;D<160;D+=2){var L=v[D-30],R=v[D-15*2+1],B=u(L,R),z=d(R,L);L=v[D-2*2],R=v[D-2*2+1];var $=p(L,R),V=f(R,L),Y=v[D-7*2],G=v[D-7*2+1],K=v[D-16*2],Q=v[D-16*2+1],q=z+G|0,H=B+Y+y(q,z)|0;q=q+V|0,H=H+$+y(q,V)|0,q=q+Q|0,H=H+K+y(q,Q)|0,v[D]=H,v[D+1]=q}for(var X=0;X<160;X+=2){H=v[X],q=v[X+1];var te=s(b,w,j),F=s(M,N,P),se=c(b,M),re=c(M,b),le=l(_,k),je=l(k,_),Le=r[X],$e=r[X+1],Se=i(_,S,E),Ve=i(k,C,T),We=A+je|0,He=O+le+y(We,A)|0;We=We+Ve|0,He=He+Se+y(We,Ve)|0,We=We+$e|0,He=He+Le+y(We,$e)|0,We=We+q|0,He=He+H+y(We,q)|0;var Mt=re+F|0,st=se+te+y(Mt,re)|0;O=E,A=T,E=S,T=C,S=_,C=k,k=I+We|0,_=x+He+y(k,I)|0,x=j,I=P,j=w,P=N,w=b,N=M,M=We+Mt|0,b=He+st+y(M,We)|0}this._al=this._al+M|0,this._bl=this._bl+N|0,this._cl=this._cl+P|0,this._dl=this._dl+I|0,this._el=this._el+k|0,this._fl=this._fl+C|0,this._gl=this._gl+T|0,this._hl=this._hl+A|0,this._ah=this._ah+b+y(this._al,M)|0,this._bh=this._bh+w+y(this._bl,N)|0,this._ch=this._ch+j+y(this._cl,P)|0,this._dh=this._dh+x+y(this._dl,I)|0,this._eh=this._eh+_+y(this._el,k)|0,this._fh=this._fh+S+y(this._fl,C)|0,this._gh=this._gh+E+y(this._gl,T)|0,this._hh=this._hh+O+y(this._hl,A)|0},o.prototype._hash=function(){var m=n.allocUnsafe(64);function v(b,w,j){m.writeInt32BE(b,j),m.writeInt32BE(w,j+4)}return v(this._ah,this._al,0),v(this._bh,this._bl,8),v(this._ch,this._cl,16),v(this._dh,this._dl,24),v(this._eh,this._el,32),v(this._fh,this._fl,40),v(this._gh,this._gl,48),v(this._hh,this._hl,56),m},G1=o,G1}var Q1,M4;function mle(){if(M4)return Q1;M4=1;var e=hc(),t=N4(),n=mc(),r=Zi().Buffer,a=new Array(160);function o(){this.init(),this._w=a,n.call(this,128,112)}return e(o,t),o.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},o.prototype._hash=function(){var i=r.allocUnsafe(48);function s(c,l,u){i.writeInt32BE(c,u),i.writeInt32BE(l,u+4)}return s(this._ah,this._al,0),s(this._bh,this._bl,8),s(this._ch,this._cl,16),s(this._dh,this._dl,24),s(this._eh,this._el,32),s(this._fh,this._fl,40),i},Q1=o,Q1}var P4;function yle(){if(P4)return V1.exports;P4=1;var e=V1.exports=function(t){t=t.toLowerCase();var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n};return e.sha=ple(),e.sha1=fle(),e.sha224=hle(),e.sha256=E4(),e.sha384=mle(),e.sha512=N4(),V1.exports}var gle=yle();const vle=ot(gle);function ble(e,t={}){const{segmentLength:n=4,separator:r="__",termLength:a=2}=t;return e.split(r).reduce((o,i)=>{const s=i.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),c=s.length>1?a:n,l=s.map(u=>u.substr(0,c)).join("");return o.push(l),o},[]).join(r)}function wle(e,t={}){const n=vle("sha1");n.update(e,"utf8");const r=n.digest("hex");return t.length?r.slice(0,t.length):r}class xle{static isGreaterOrEqual(t,n){const r=k4(t),a=k4(n);return r[0]>a[0]||r[0]===a[0]&&r[1]>a[1]||r[0]===a[0]&&r[1]===a[1]&&r[2]>=a[2]}}function k4(e=""){const t=[0,0,0];return e.split(".").forEach((n,r)=>t[r]=parseInt(n,10)),t}class ve{static isSQLiteFamily(t){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(t.options.type)}static isMySQLFamily(t){return["mysql","mariadb"].includes(t.options.type)}static isReleaseVersionOrGreater(t,n){return t.version!=null&&xle.isGreaterOrEqual(t.version,n)}static isPostgresFamily(t){return["postgres","aurora-postgres","cockroachdb"].includes(t.options.type)}static buildDriverOptions(t,n){if(t.url){const r=this.parseConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildMongoDBDriverOptions(t,n){if(t.url){const r=this.parseMongoDBConnectionUrl(t.url);n&&n.useSid&&r.database&&(r.sid=r.database);for(const a of Object.keys(r))typeof r[a]>"u"&&delete r[a];return Object.assign({},t,r)}return Object.assign({},t)}static buildAlias({maxAliasLength:t},n,...r){const a=n&&n.joiner?n.joiner:"_";let o=r.length===1?r[0]:r.join(a);if(t&&t>0&&o.length>t){if(n&&n.shorten===!0){const i=ble(o);if(i.length<t)return i}return wle(o,{length:t})}return o}static buildColumnAlias({maxAliasLength:t},n,...r){return typeof n=="string"?(r.unshift(n),n={shorten:!1,joiner:"_"}):n=Object.assign({shorten:!1,joiner:"_"},n),this.buildAlias({maxAliasLength:t},n,...r)}static parseConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0;s&&s.indexOf("?")!==-1&&(s=s.substr(0,s.indexOf("?")));const c=i.lastIndexOf("@"),l=i.substr(0,c),u=i.substr(c+1);let d=l,p="";const f=l.indexOf(":");f!==-1&&(d=l.substr(0,f),p=l.substr(f+1));const[y,m]=u.split(":");return{type:n,host:y,username:decodeURIComponent(d),password:decodeURIComponent(p),port:m?parseInt(m):void 0,database:s||void 0}}static parseMongoDBConnectionUrl(t){const n=t.split(":")[0],r=t.indexOf("//"),a=t.substr(r+2),o=a.indexOf("/"),i=o!==-1?a.substr(0,o):a;let s=o!==-1?a.substr(o+1):void 0,c="",l,u,d,p,f={};if(s&&s.indexOf("?")!==-1){c=s.substr(s.indexOf("?")+1,s.length);const _=c.split("&");let S,E;_.forEach(O=>{S=O.split("=")[0],E=O.split("=")[1],f[S]=E}),p=f.replicaSet,s=s.substr(0,s.indexOf("?"))}const y=i.lastIndexOf("@"),m=i.substr(0,y),v=i.substr(y+1);let b=m,w="";const j=m.indexOf(":");j!==-1&&(b=m.substr(0,j),w=m.substr(j+1)),p?d=v:[l,u]=v.split(":");let x={type:n,host:l,hostReplicaSet:d,username:decodeURIComponent(b),password:decodeURIComponent(w),port:u?parseInt(u):void 0,database:s||void 0};for(const[_,S]of Object.entries(f))x[_]=S;return x}}class A4{constructor(t,n,r){this.connection=t,this.queryExpressionMap=n,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,r&&Yt.assign(this,r)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){let t=()=>{for(const n of this.queryExpressionMap.selects)if(n.selection===this.alias.name||this.metadata&&this.metadata.columns.find(r=>n.selection===this.alias.name+"."+r.propertyPath))return!0;return!1};this.isSelectedCache=t(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(Oa.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(Oa.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let t=()=>{if(!Oa.isAliasProperty(this.entityOrProperty))return;const n=this.queryExpressionMap.findAliasByName(this.parentAlias);let r=n.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(r||n.metadata.parentEntityMetadata&&(r=n.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),r))return r;throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=t.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new xe("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new xe("Junction property is not defined.");const t=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?ve.buildAlias(this.connection.driver,void 0,t,this.alias.name):ve.buildAlias(this.connection.driver,void 0,this.alias.name,t)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class Y1{constructor(t,n){this.queryExpressionMap=t,this.disableMixedMap=!1,Yt.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");const t=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return t}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class J1{constructor(t,n){this.expressionMap=t,Yt.assign(this,n||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[t,n]=this.relationName.split(".");return t+"_"+n+"_rc"}get relation(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const[t,n]=this.relationName.split("."),r=this.expressionMap.findAliasByName(t).metadata.findRelationWithPropertyPath(n);if(!r)throw new xe(`Relation with property path ${n} in entity was not found.`);return r}get metadata(){if(!Oa.isAliasProperty(this.relationName))throw new xe("Given value is a string representation of alias property");const t=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(t).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}class e_{constructor(t){var n;this.connection=t,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],t.options.relationLoadStrategy&&(this.relationLoadStrategy=t.options.relationLoadStrategy),this.timeTravel=((n=t.options)==null?void 0:n.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const t=this.mainAlias.metadata.orderBy||{};return Object.keys(t).reduce((n,r)=>(n[this.mainAlias.name+"."+r]=t[r],n),{})}return this.orderBys}setMainAlias(t){return this.mainAlias=t,t}createAlias(t){let n=t.name;!n&&t.tablePath&&(n=t.tablePath),!n&&typeof t.target=="function"&&(n=t.target.name),!n&&typeof t.target=="string"&&(n=t.target);const r=new v4;return r.type=t.type,n&&(r.name=n),t.metadata&&(r.metadata=t.metadata),t.target&&!r.hasMetadata&&(r.metadata=this.connection.getMetadata(t.target)),t.tablePath&&(r.tablePath=t.tablePath),t.subQuery&&(r.subQuery=t.subQuery),this.aliases.push(r),r}findAliasByName(t){const n=this.aliases.find(r=>r.name===t);if(!n)throw new xe(`"${t}" alias was not found. Maybe you forgot to join it?`);return n}findColumnByAliasExpression(t){const[n,r]=t.split(".");return this.findAliasByName(n).metadata.findColumnWithPropertyName(r)}get relationMetadata(){if(!this.mainAlias)throw new xe("Entity to work with is not specified!");const t=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new xe(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return t}clone(){const t=new e_(this.connection);return t.queryType=this.queryType,t.selects=this.selects.map(n=>n),t.maxExecutionTime=this.maxExecutionTime,t.selectDistinct=this.selectDistinct,t.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(n=>t.aliases.push(new v4(n))),t.relationLoadStrategy=this.relationLoadStrategy,t.mainAlias=this.mainAlias,t.valuesSet=this.valuesSet,t.returning=this.returning,t.onConflict=this.onConflict,t.onIgnore=this.onIgnore,t.onUpdate=this.onUpdate,t.joinAttributes=this.joinAttributes.map(n=>new A4(this.connection,this,n)),t.relationIdAttributes=this.relationIdAttributes.map(n=>new Y1(this,n)),t.relationCountAttributes=this.relationCountAttributes.map(n=>new J1(this,n)),t.wheres=this.wheres.map(n=>({...n})),t.havings=this.havings.map(n=>({...n})),t.orderBys=Object.assign({},this.orderBys),t.groupBys=this.groupBys.map(n=>n),t.limit=this.limit,t.offset=this.offset,t.skip=this.skip,t.take=this.take,t.lockMode=this.lockMode,t.onLocked=this.onLocked,t.lockVersion=this.lockVersion,t.lockTables=this.lockTables,t.withDeleted=this.withDeleted,t.parameters=Object.assign({},this.parameters),t.disableEscaping=this.disableEscaping,t.enableRelationIdValues=this.enableRelationIdValues,t.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,t.subQuery=this.subQuery,t.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,t.cache=this.cache,t.cacheId=this.cacheId,t.cacheDuration=this.cacheDuration,t.relationPropertyPath=this.relationPropertyPath,t.of=this.of,t.insertColumns=this.insertColumns,t.whereEntities=this.whereEntities,t.updateEntity=this.updateEntity,t.callListeners=this.callListeners,t.useTransaction=this.useTransaction,t.timeTravel=this.timeTravel,t.nativeParameters=Object.assign({},this.nativeParameters),t.comment=this.comment,t.commonTableExpressions=this.commonTableExpressions.map(n=>({alias:n.alias,queryBuilder:typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.clone(),options:n.options})),t}}class T4{constructor(t){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=t}}class t_{static transformFrom(t,n){return Array.isArray(t)?t.slice().reverse().reduce((r,a)=>a.from(r),n):t.from(n)}static transformTo(t,n){return Array.isArray(t)?t.reduce((r,a)=>a.to(r),n):t.to(n)}}class rd{constructor(t,n,r=!0,a=!1,o,i){this["@instanceof"]=Symbol.for("FindOperator"),this._type=t,this._value=n,this._useParameter=r,this._multipleParameters=a,this._getSql=o,this._objectLiteralParameters=i}get useParameter(){return Ct.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return Ct.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return Ct.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return Ct.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(Ct.isFindOperator(this._value))return this._value}get getSql(){return Ct.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(t){this._value instanceof rd?this._value.transformValue(t):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(n=>t&&t_.transformTo(t,n)):t_.transformTo(t,this._value)}}function Ca(e){return new rd("in",e,!0,!0)}const _le=/[.*+\-?^${}()|[\]\\]/g,jle=e=>e.replace(_le,"\\$&");class Ht{constructor(t,n){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,Ct.isDataSource(t)?(this.connection=t,this.queryRunner=n,this.expressionMap=new e_(this.connection)):(this.connection=t.connection,this.queryRunner=t.queryRunner,this.expressionMap=t.expressionMap.clone())}static registerQueryBuilderClass(t,n){Ht.queryBuilderRegistry[t]=n}get alias(){if(!this.expressionMap.mainAlias)throw new xe("Main alias is not set");return this.expressionMap.mainAlias.name}select(t,n){return this.expressionMap.queryType="select",Array.isArray(t)?this.expressionMap.selects=t.map(r=>({selection:r})):t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]),Ct.isSelectQueryBuilder(this)?this:Ht.queryBuilderRegistry.SelectQueryBuilder(this)}insert(){return this.expressionMap.queryType="insert",Ct.isInsertQueryBuilder(this)?this:Ht.queryBuilderRegistry.InsertQueryBuilder(this)}update(t,n){const r=n||t;if(t=Ct.isEntitySchema(t)?t.options.name:t,typeof t=="function"||typeof t=="string"){const a=this.createFromAlias(t);this.expressionMap.setMainAlias(a)}return this.expressionMap.queryType="update",this.expressionMap.valuesSet=r,Ct.isUpdateQueryBuilder(this)?this:Ht.queryBuilderRegistry.UpdateQueryBuilder(this)}delete(){return this.expressionMap.queryType="delete",Ct.isDeleteQueryBuilder(this)?this:Ht.queryBuilderRegistry.DeleteQueryBuilder(this)}softDelete(){return this.expressionMap.queryType="soft-delete",Ct.isSoftDeleteQueryBuilder(this)?this:Ht.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}restore(){return this.expressionMap.queryType="restore",Ct.isSoftDeleteQueryBuilder(this)?this:Ht.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}relation(t,n){const r=arguments.length===2?t:void 0,a=arguments.length===2?n:t;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=a,r){const o=this.createFromAlias(r);this.expressionMap.setMainAlias(o)}return Ct.isRelationQueryBuilder(this)?this:Ht.queryBuilderRegistry.RelationQueryBuilder(this)}hasRelation(t,n){const r=this.connection.getMetadata(t);return(Array.isArray(n)?n:[n]).every(a=>!!r.findRelationWithPropertyPath(a))}hasParameter(t){var n;return((n=this.parentQueryBuilder)==null?void 0:n.hasParameter(t))||t in this.expressionMap.parameters}setParameter(t,n){if(typeof n=="function")throw new xe(`Function parameter isn't supported in the parameters. Please check "${t}" parameter.`);if(!t.match(/^([A-Za-z0-9_.]+)$/))throw new xe("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(t,n),this.expressionMap.parameters[t]=n,this}setParameters(t){for(const[n,r]of Object.entries(t))this.setParameter(n,r);return this}createParameter(t){let n;do n=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(n));return this.setParameter(n,t),`:${n}`}setNativeParameters(t){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(t),Object.keys(t).forEach(n=>{this.expressionMap.nativeParameters[n]=t[n]}),this}getParameters(){const t=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const n=this.expressionMap.mainAlias.metadata;if(n.discriminatorColumn&&n.parentEntityMetadata){const r=n.childEntityMetadatas.filter(a=>a.discriminatorColumn).map(a=>a.discriminatorValue);r.push(n.discriminatorValue),t.discriminatorColumnValues=r}}return t}printSql(){const[t,n]=this.getQueryAndParameters();return this.connection.logger.logQuery(t,n),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const t=this.getQuery(),n=this.getParameters();return this.connection.driver.escapeQueryWithParameters(t,n,this.expressionMap.nativeParameters)}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();try{return await r.query(t,n)}finally{r!==this.queryRunner&&await r.release()}}createQueryBuilder(t){return new this.constructor(this.connection,t??this.queryRunner)}clone(){return new this.constructor(this)}comment(t){return this.expressionMap.comment=t,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(t){return this.expressionMap.disableEscaping?this.connection.driver.escape(t):t}setQueryRunner(t){return this.queryRunner=t,this}callListeners(t){return this.expressionMap.callListeners=t,this}useTransaction(t){return this.expressionMap.useTransaction=t,this}addCommonTableExpression(t,n,r){return this.expressionMap.commonTableExpressions.push({queryBuilder:t,alias:n,options:r||{}}),this}getTableName(t){return t.split(".").map(n=>n===""?n:this.escape(n)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new xe('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(t,n){if(this.connection.hasMetadata(t)){const r=this.connection.getMetadata(t);return this.expressionMap.createAlias({type:"from",name:n,metadata:this.connection.getMetadata(t),tablePath:r.tablePath})}else{if(typeof t=="string"){const o=t.substr(0,1)==="("&&t.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:n,tablePath:o?void 0:t,subQuery:o?t:void 0})}const r=t(this.subQuery());this.setParameters(r.getParameters());const a=r.getQuery();return this.expressionMap.createAlias({type:"from",name:n,subQuery:a})}}replacePropertyNames(t){return t}replacePropertyNamesForTheWholeQuery(t){const n={};for(const o of this.expressionMap.aliases){if(!o.hasMetadata)continue;const i=this.expressionMap.aliasNamePrefixingEnabled&&o.name?`${o.name}.`:"";n[i]||(n[i]={});for(const s of o.metadata.relations)s.joinColumns.length>0&&(n[i][s.propertyPath]=s.joinColumns[0].databaseName);for(const s of o.metadata.relations){const c=[...s.joinColumns,...s.inverseJoinColumns];for(const l of c){const u=`${s.propertyPath}.${l.referencedColumn.propertyPath}`;n[i][u]=l.databaseName}}for(const s of o.metadata.columns)n[i][s.databaseName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyName]=s.databaseName;for(const s of o.metadata.columns)n[i][s.propertyPath]=s.databaseName}const r=Object.keys(n),a=r.map(o=>jle(o)).join("|");return r.length>0&&(t=t.replace(new RegExp(`([ =(]|^.{0})${a?"("+a+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...o)=>{let i,s,c;if(a){if(i=o[0],s=o[1],c=o[3],n[o[2]][c])return`${s}${this.escape(o[2].substring(0,o[2].length-1))}.${this.escape(n[o[2]][c])}`}else if(i=o[0],s=o[1],c=o[2],n[""][c])return`${s}${this.escape(n[""][c])}`;return i})),t}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace(/\*\//g,"")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const t=[],n=this.createWhereClausesExpression(this.expressionMap.wheres);if(n.length>0&&n!=="1=1"&&t.push(this.replacePropertyNames(n)),this.expressionMap.mainAlias.hasMetadata){const a=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&a.deleteDateColumn){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.deleteDateColumn.propertyName:a.deleteDateColumn.propertyName,i=`${this.replacePropertyNames(o)} IS NULL`;t.push(i)}if(a.discriminatorColumn&&a.parentEntityMetadata){const o=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+a.discriminatorColumn.databaseName:a.discriminatorColumn.databaseName,i=`${this.replacePropertyNames(o)} IN (:...discriminatorColumnValues)`;t.push(i)}}if(this.expressionMap.extraAppendedAndWhereCondition){const a=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);t.push(a)}let r="";return r+=this.createTimeTravelQuery(),t.length?t.length===1?r+=` WHERE ${t[0]}`:r+=` WHERE ( ${t.join(" ) AND ( ")} )`:r+="",r}createReturningExpression(t){const n=this.getReturningColumns(),r=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&r.isReturningSqlSupported(t)&&n.push(...this.expressionMap.extraReturningColumns.filter(a=>n.indexOf(a)===-1)),n.length){let a=n.map(o=>{const i=this.escape(o.databaseName);return r.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+i:this.escape(this.getMainTableName())+"."+i:i}).join(", ");return r.options.type==="oracle"&&(a+=" INTO "+n.map(o=>this.createParameter({type:r.columnTypeToNativeParameter(o.type),dir:r.oracle.BIND_OUT})).join(", ")),r.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(a+=" INTO @OutputTable"),a}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const t=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(n=>{this.expressionMap.mainAlias.hasMetadata&&t.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n))}),t}createWhereClausesExpression(t){return t.map((n,r)=>{const a=this.createWhereConditionExpression(n.condition);switch(n.type){case"and":return(r>0?"AND ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`;case"or":return(r>0?"OR ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${a}${this.connection.options.isolateWhereStatements?")":""}`}return a}).join(" ").trim()}createWhereConditionExpression(t,n=!1){if(typeof t=="string")return t;if(Array.isArray(t))return t.length===0?"1=1":t.length===1&&!n?this.createWhereClausesExpression(t):"("+this.createWhereClausesExpression(t)+")";const{driver:r}=this.connection;switch(t.operator){case"lessThan":return`${t.parameters[0]} < ${t.parameters[1]}`;case"lessThanOrEqual":return`${t.parameters[0]} <= ${t.parameters[1]}`;case"arrayContains":return`${t.parameters[0]} @> ${t.parameters[1]}`;case"jsonContains":return`${t.parameters[0]} ::jsonb @> ${t.parameters[1]}`;case"arrayContainedBy":return`${t.parameters[0]} <@ ${t.parameters[1]}`;case"arrayOverlap":return`${t.parameters[0]} && ${t.parameters[1]}`;case"moreThan":return`${t.parameters[0]} > ${t.parameters[1]}`;case"moreThanOrEqual":return`${t.parameters[0]} >= ${t.parameters[1]}`;case"notEqual":return`${t.parameters[0]} != ${t.parameters[1]}`;case"equal":return`${t.parameters[0]} = ${t.parameters[1]}`;case"ilike":return r.options.type==="postgres"||r.options.type==="cockroachdb"?`${t.parameters[0]} ILIKE ${t.parameters[1]}`:`UPPER(${t.parameters[0]}) LIKE UPPER(${t.parameters[1]})`;case"like":return`${t.parameters[0]} LIKE ${t.parameters[1]}`;case"between":return`${t.parameters[0]} BETWEEN ${t.parameters[1]} AND ${t.parameters[2]}`;case"in":return t.parameters.length<=1?"0=1":`${t.parameters[0]} IN (${t.parameters.slice(1).join(", ")})`;case"any":return r.options.type==="cockroachdb"?`${t.parameters[0]}::STRING = ANY(${t.parameters[1]}::STRING[])`:`${t.parameters[0]} = ANY(${t.parameters[1]})`;case"isNull":return`${t.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(t.condition)})`;case"brackets":return`${this.createWhereConditionExpression(t.condition,!0)}`;case"and":return"("+t.parameters.join(" AND ")+")";case"or":return"("+t.parameters.join(" OR ")+")"}throw new TypeError(`Unsupported FindOperator ${rd.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const t=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(n=>{const r=typeof n.queryBuilder=="string"?n.queryBuilder:n.queryBuilder.getQuery();if(typeof n.queryBuilder!="string"){if(n.queryBuilder.hasCommonTableExpressions())throw new xe(`Nested CTEs aren't supported (CTE: ${n.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!Ct.isSelectQueryBuilder(n.queryBuilder))throw new xe(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${n.alias})`);this.setParameters(n.queryBuilder.getParameters())}let a=this.escape(n.alias);if(n.options.columnNames){const s=n.options.columnNames.map(c=>this.escape(c));if(Ct.isSelectQueryBuilder(n.queryBuilder)&&n.queryBuilder.expressionMap.selects.length&&n.options.columnNames.length!==n.queryBuilder.expressionMap.selects.length)throw new xe(`cte.options.columnNames length (${n.options.columnNames.length}) doesn't match subquery select list length ${n.queryBuilder.expressionMap.selects.length} (CTE: ${n.alias})`);a+=`(${s.join(", ")})`}const o=n.options.recursive&&t?"RECURSIVE":"";let i="";return this.connection.driver.cteCapabilities.materializedHint&&n.options.materialized!==void 0&&(i=n.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[o,a,"AS",i,`(${r})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(t){const n=this.expressionMap.mainAlias.metadata,r=(Array.isArray(t)?t:[t]).map(a=>n.ensureEntityIdMap(a));if(!n.hasMultiplePrimaryKeys){const a=n.primaryColumns[0];if(!a.transformer&&!a.relationMetadata&&!a.embeddedMetadata)return{[a.propertyName]:Ca(r.map(o=>a.getEntityValue(o,!1)))}}return new T4(a=>{for(const o of r)a.orWhere(new T4(i=>i.where(o)))})}getExistsCondition(t){const n=t.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${n.getQuery()})`,n.getParameters()]}findColumnsForPropertyPath(t){let n=this.expressionMap.mainAlias;const r=[],a=t.split(".");for(;a.length>1;){const s=a[0];if(!(n!=null&&n.hasMetadata))break;if(n.metadata.hasEmbeddedWithPropertyPath(s)){a.unshift(`${a.shift()}.${a.shift()}`);continue}if(n.metadata.hasRelationWithPropertyPath(s)){const c=this.expressionMap.joinAttributes.find(l=>l.relationPropertyPath===s);if(!(c!=null&&c.alias)){const l=r.length>0?`${r.join(".")}.${s}`:s;throw new Error(`Cannot find alias for relation at ${l}`)}n=c.alias,r.push(...s.split(".")),a.shift();continue}break}if(!n)throw new Error(`Cannot find alias for property ${t}`);const o=a.join("."),i=n.metadata.findColumnsWithPropertyPath(o);if(!i.length)throw new Ea(t,n.metadata);return[n,r,i]}createPropertyPath(t,n,r=""){const a=[];for(const o of Object.keys(n)){const i=r?`${r}.${o}`:o;if(n[o]===null||typeof n[o]!="object"||Ct.isFindOperator(n[o])){a.push(i);continue}if(t.hasEmbeddedWithPropertyPath(i)){const s=this.createPropertyPath(t,n[o],i);a.push(...s);continue}if(t.hasRelationWithPropertyPath(i)){const s=t.findRelationWithPropertyPath(i);if(s.relationType==="one-to-one"||s.relationType==="many-to-one"){const u=s.joinColumns.map(d=>d.referencedColumn).filter(d=>!!d);if(u.length>0&&u.every(d=>d.getEntityValue(n[o],!1))){a.push(i);continue}}if(s.relationType==="one-to-many"||s.relationType==="many-to-many")throw new Error(`Cannot query across ${s.relationType} for property ${i}`);const c=s.inverseEntityMetadata.primaryColumns;if(c.length>0&&c.every(u=>u.getEntityValue(n[o],!1))){const u=c.map(d=>`${i}.${d.propertyPath}`);a.push(...u);continue}const l=this.createPropertyPath(s.inverseEntityMetadata,n[o]).map(u=>`${i}.${u}`);a.push(...l);continue}a.push(i)}return a}*getPredicates(t){if(this.expressionMap.mainAlias.hasMetadata){const n=this.createPropertyPath(this.expressionMap.mainAlias.metadata,t);for(const r of n){const[a,o,i]=this.findColumnsForPropertyPath(r);for(const s of i){let c=t;for(const d of o){if(!c||!(d in c)){c={};break}c=c[d]}const l=this.expressionMap.aliasNamePrefixingEnabled?`${a.name}.${s.propertyPath}`:s.propertyPath,u=s.getEntityValue(c,!0);yield[l,u]}}}else for(const n of Object.keys(t)){const r=t[n];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${n}`:n,r]}}getWherePredicateCondition(t,n){if(Ct.isFindOperator(n)){let r=[];if(n.useParameter)if(n.objectLiteralParameters)this.setParameters(n.objectLiteralParameters);else if(n.multipleParameters)for(const a of n.value)r.push(this.createParameter(a));else r.push(this.createParameter(n.value));if(n.type==="raw")return n.getSql?n.getSql(t):{operator:"equal",parameters:[t,n.value]};if(n.type==="not")return n.child?{operator:n.type,condition:this.getWherePredicateCondition(t,n.child)}:{operator:"notEqual",parameters:[t,...r]};if(n.type==="and"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else if(n.type==="or"){const a=n.value;return{operator:n.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(t,o)))}}else return{operator:n.type,parameters:[t,...r]}}else return{operator:"equal",parameters:[t,this.createParameter(n)]}}getWhereCondition(t){if(typeof t=="string")return t;if(Ct.isBrackets(t)){const a=this.createQueryBuilder();return a.parentQueryBuilder=this,a.expressionMap.mainAlias=this.expressionMap.mainAlias,a.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,a.expressionMap.parameters=this.expressionMap.parameters,a.expressionMap.nativeParameters=this.expressionMap.nativeParameters,a.expressionMap.wheres=[],t.whereFactory(a),{operator:Ct.isNotBrackets(t)?"not":"brackets",condition:a.expressionMap.wheres}}if(typeof t=="function")return t(this);const n=Array.isArray(t)?t:[t],r=[];for(const a of n){const o=[];for(const[i,s]of this.getPredicates(a))o.push({type:"and",condition:this.getWherePredicateCondition(i,s)});r.push({type:"or",condition:o})}return r.length===1?r[0].condition:r}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}Ht.queryBuilderRegistry={};class Sle{static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class Ele extends Ht{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("DeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createDeleteExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("BeforeRemove",this.expressionMap.mainAlias.metadata);const o=await r.query(t,n,!0),i=Sle.from(o);return this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await r.broadcaster.broadcast("AfterRemove",this.expressionMap.mainAlias.metadata),a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}finally{r!==this.queryRunner&&await r.release()}}from(t,n){t=Ct.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("delete"))throw new zh;return this.expressionMap.returning=t,this}createDeleteExpression(){const t=this.getTableName(this.getMainTableName()),n=this.createWhereExpression(),r=this.createReturningExpression("delete");return r===""?`DELETE FROM ${t}${n}`:this.connection.driver.options.type==="mssql"?`DELETE FROM ${t} OUTPUT ${r}${n}`:`DELETE FROM ${t}${n} RETURNING ${r}`}}let Vh;const Ole=new Uint8Array(16);function Cle(){if(!Vh&&(Vh=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Vh))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Vh(Ole)}const vn=[];for(let e=0;e<256;++e)vn.push((e+256).toString(16).slice(1));function Nle(e,t=0){return vn[e[t+0]]+vn[e[t+1]]+vn[e[t+2]]+vn[e[t+3]]+"-"+vn[e[t+4]]+vn[e[t+5]]+"-"+vn[e[t+6]]+vn[e[t+7]]+"-"+vn[e[t+8]]+vn[e[t+9]]+"-"+vn[e[t+10]]+vn[e[t+11]]+vn[e[t+12]]+vn[e[t+13]]+vn[e[t+14]]+vn[e[t+15]]}const Mle=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),I4={randomUUID:Mle};function Ple(e,t,n){if(I4.randomUUID&&!t&&!e)return I4.randomUUID();e=e||{};const r=e.random||(e.rng||Cle)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Nle(r)}class R4{constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}class D4{constructor(){this.identifiers=[],this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.raw,n}}class n_{constructor(t,n){this.queryRunner=t,this.expressionMap=n}async update(t,n){const r=this.expressionMap.mainAlias.metadata;await Promise.all(n.map(async(a,o)=>{if(this.queryRunner.connection.driver.isReturningSqlSupported("update")){this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((c,l,u)=>(c[this.expressionMap.extraReturningColumns[u].databaseName]=l[0],c),{}));const i=Array.isArray(t.raw)?t.raw[o]:t.raw,s=this.queryRunner.connection.driver.createGeneratedMap(r,i);s&&(this.queryRunner.manager.merge(r.target,a,s),t.generatedMaps.push(s))}else{const i=this.expressionMap.extraReturningColumns;if(i.length>0){const s=this.expressionMap.mainAlias.metadata.getEntityIdMap(a);if(!s)throw new xe("Cannot update entity because entity id is not set in the entity.");const c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(i.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).withDeleted().setOption("create-pojo").getOne();c&&(this.queryRunner.manager.merge(r.target,a,c),t.generatedMaps.push(c))}}}))}async insert(t,n){const r=this.expressionMap.mainAlias.metadata;let a=r.getInsertionReturningColumns();const o=this.queryRunner.connection.driver.isReturningSqlSupported("insert");a=a.filter(s=>s.isGenerated?o===!0:!0);const i=n.map((s,c)=>{this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(t.raw)&&this.expressionMap.extraReturningColumns.length>0&&(t.raw=t.raw.reduce((d,p,f)=>(d[this.expressionMap.extraReturningColumns[f].databaseName]=p[0],d),{}));const l=Array.isArray(t.raw)?t.raw[c]:t.raw,u=this.queryRunner.connection.driver.createGeneratedMap(r,l,c,n.length)||{};return c in this.expressionMap.locallyGenerated&&this.queryRunner.manager.merge(r.target,u,this.expressionMap.locallyGenerated[c]),this.queryRunner.manager.merge(r.target,s,u),u});if(a.length>0&&!this.queryRunner.connection.driver.isReturningSqlSupported("insert")){const s=n.map(l=>{const u=r.getEntityIdMap(l);if(!u)throw new xe("Cannot update entity because entity id is not set in the entity.");return u}),c=await this.queryRunner.manager.createQueryBuilder().select(r.primaryColumns.map(l=>r.targetName+"."+l.propertyPath)).addSelect(a.map(l=>r.targetName+"."+l.propertyPath)).from(r.target,r.targetName).where(s).setOption("create-pojo").getMany();n.forEach((l,u)=>{this.queryRunner.manager.merge(r.target,i[u],c[u]),this.queryRunner.manager.merge(r.target,l,c[u])})}n.forEach((s,c)=>{const l=r.getEntityIdMap(s);t.identifiers.push(l),t.generatedMaps.push(i[c])})}getUpdationReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion)}getSoftDeletionReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(t=>t.asExpression!==void 0||t.isUpdateDate||t.isVersion||t.isDeleteDate)}}class kle extends Ht{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("InsertQueryBuilder")}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createInsertExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.getValueSets();if(t.length===0)return new D4;const n=this.obtainQueryRunner();let r=!1;try{if(this.expressionMap.useTransaction===!0&&n.isTransactionActive===!1&&(await n.startTransaction(),r=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const f=new R4;t.forEach(y=>{n.broadcaster.broadcastBeforeInsertEvent(f,this.expressionMap.mainAlias.metadata,y)}),await f.wait()}let a=null,o=null;const i=new n_(n,this.expressionMap),s=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const f of this.expressionMap.returning)s.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(f));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&(t.length>1&&this.connection.driver.options.type==="oracle"||(this.expressionMap.extraReturningColumns=this.expressionMap.mainAlias.metadata.getInsertionReturningColumns()),s.push(...this.expressionMap.extraReturningColumns.filter(f=>!s.includes(f)))),s.length>0&&this.connection.driver.options.type==="mssql"&&(a=this.connection.driver.buildTableVariableDeclaration("@OutputTable",s),o="SELECT * FROM @OutputTable");const[c,l]=this.getQueryAndParameters(),u=[a,c,o].filter(f=>f!=null).join(`;

`),d=await n.query(u,l,!0),p=D4.from(d);if(this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&await i.insert(p,t),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const f=new R4;t.forEach(y=>{n.broadcaster.broadcastAfterInsertEvent(f,this.expressionMap.mainAlias.metadata,y)}),await f.wait()}return r&&await n.commitTransaction(),p}catch(a){if(r)try{await n.rollbackTransaction()}catch{}throw a}finally{n!==this.queryRunner&&await n.release()}}into(t,n){t=Ct.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t);return this.expressionMap.setMainAlias(r),this.expressionMap.insertColumns=n||[],this}values(t){return this.expressionMap.valuesSet=t,this}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("insert"))throw new zh;return this.expressionMap.returning=t,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}onConflict(t){return this.expressionMap.onConflict=t,this}orIgnore(t=!0){return this.expressionMap.onIgnore=!!t,this}orUpdate(t,n,r){return Array.isArray(t)?(this.expressionMap.onUpdate={overwrite:t,conflict:n,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,indexPredicate:r==null?void 0:r.indexPredicate,upsertType:r==null?void 0:r.upsertType},this):(this.expressionMap.onUpdate={conflict:t==null?void 0:t.conflict_target,columns:t==null?void 0:t.columns,overwrite:t==null?void 0:t.overwrite,skipUpdateIfNoValuesChanged:r==null?void 0:r.skipUpdateIfNoValuesChanged,upsertType:r==null?void 0:r.upsertType},this)}createInsertExpression(){var i,s;const t=this.getTableName(this.getMainTableName()),n=this.createValuesExpression(),r=this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1?null:this.createReturningExpression("insert"),a=this.createColumnNamesExpression();let o="INSERT ";if(((i=this.expressionMap.onUpdate)==null?void 0:i.upsertType)==="primary-key"&&(o="UPSERT "),(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+=`${this.expressionMap.onIgnore?" IGNORE ":""}`),o+=`INTO ${t}`,this.alias!==this.getMainTableName()&&ve.isPostgresFamily(this.connection.driver)&&(o+=` AS "${this.alias}"`),a?o+=`(${a})`:!n&&(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(o+="()"),r&&this.connection.driver.options.type==="mssql"&&(o+=` OUTPUT ${r}`),n?(this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="sap")&&this.getValueSets().length>1?o+=` ${n}`:o+=` VALUES ${n}`:ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"?o+=" VALUES ()":o+=" DEFAULT VALUES",((s=this.expressionMap.onUpdate)==null?void 0:s.upsertType)!=="primary-key"){if(this.connection.driver.supportedUpsertTypes.includes("on-conflict-do-update")){if(this.expressionMap.onIgnore)o+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)o+=` ON CONFLICT ${this.expressionMap.onConflict} `;else if(this.expressionMap.onUpdate){const{overwrite:c,columns:l,conflict:u,skipUpdateIfNoValuesChanged:d,indexPredicate:p}=this.expressionMap.onUpdate;let f="ON CONFLICT";if(Array.isArray(u)){if(f+=` ( ${u.map(m=>this.escape(m)).join(", ")} )`,p&&!ve.isPostgresFamily(this.connection.driver))throw new xe("indexPredicate option is not supported by the current database driver");p&&ve.isPostgresFamily(this.connection.driver)&&(f+=` WHERE ( ${p} )`)}else u&&(f+=` ON CONSTRAINT ${this.escape(u)}`);const y=[];Array.isArray(c)?y.push(...c.map(m=>`${this.escape(m)} = EXCLUDED.${this.escape(m)}`)):l&&y.push(...l.map(m=>`${this.escape(m)} = :${m}`)),y.length>0&&(o+=` ${f} DO UPDATE SET `,y.push(...this.expressionMap.mainAlias.metadata.columns.filter(m=>m.isUpdateDate&&!(c!=null&&c.includes(m.databaseName))&&!(this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")).map(m=>`${this.escape(m.databaseName)} = DEFAULT`)),o+=y.join(", "),o+=" "),Array.isArray(c)&&d&&ve.isPostgresFamily(this.connection.driver)&&(o+=" WHERE (",o+=c.map(m=>`${t}.${this.escape(m)} IS DISTINCT FROM EXCLUDED.${this.escape(m)}`).join(" OR "),o+=") ")}}else if(this.connection.driver.supportedUpsertTypes.includes("on-duplicate-key-update")){if(this.expressionMap.onUpdate){const{overwrite:c,columns:l}=this.expressionMap.onUpdate;Array.isArray(c)?(o+=" ON DUPLICATE KEY UPDATE ",o+=c.map(u=>`${this.escape(u)} = VALUES(${this.escape(u)})`).join(", "),o+=" "):Array.isArray(l)&&(o+=" ON DUPLICATE KEY UPDATE ",o+=l.map(u=>`${this.escape(u)} = :${u}`).join(", "),o+=" ")}}else if(this.expressionMap.onUpdate)throw new xe("onUpdate is not supported by the current database driver")}return r&&(ve.isPostgresFamily(this.connection.driver)||this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="cockroachdb"||ve.isMySQLFamily(this.connection.driver))&&(o+=` RETURNING ${r}`),this.connection.driver.options.type==="mssql"&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter(c=>this.expressionMap.insertColumns.length>0?this.expressionMap.insertColumns.indexOf(c.propertyPath)!==-1:c.isInsert).some(c=>this.isOverridingAutoIncrementBehavior(c))&&(o=`SET IDENTITY_INSERT ${t} ON; ${o}; SET IDENTITY_INSERT ${t} OFF`),o}getInsertedColumns(){return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter(t=>this.expressionMap.insertColumns.length?this.expressionMap.insertColumns.indexOf(t.propertyPath)!==-1:!(!t.isInsert||t.isGenerated&&t.generationStrategy==="increment"&&this.connection.driver.options.type!=="spanner"&&this.connection.driver.options.type!=="oracle"&&!ve.isSQLiteFamily(this.connection.driver)&&!ve.isMySQLFamily(this.connection.driver)&&this.connection.driver.options.type!=="aurora-mysql"&&!(this.connection.driver.options.type==="mssql"&&this.isOverridingAutoIncrementBehavior(t)))):[]}createColumnNamesExpression(){const t=this.getInsertedColumns();if(t.length>0)return t.map(n=>this.escape(n.databaseName)).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){const n=this.getValueSets();if(n.length===1)return Object.keys(n[0]).map(r=>this.escape(r)).join(", ")}return this.expressionMap.insertColumns.map(n=>this.escape(n)).join(", ")}createValuesExpression(){const t=this.getValueSets(),n=this.getInsertedColumns();if(n.length>0){let r="";return t.forEach((a,o)=>{n.forEach((i,s)=>{s===0&&(this.connection.driver.options.type==="oracle"&&t.length>1||this.connection.driver.options.type==="sap"&&t.length>1?r+=" SELECT ":r+="(");let c=i.getEntityValue(a);if(typeof c!="function"&&(c=this.connection.driver.preparePersistentValue(c,i)),i.isVersion&&c===void 0)r+="1";else if(i.isDiscriminator)r+=this.createParameter(this.expressionMap.mainAlias.metadata.discriminatorValue);else if(i.isGenerated&&i.generationStrategy==="uuid"&&!this.connection.driver.isUUIDGenerationSupported()&&c===void 0)c=Ple(),r+=this.createParameter(c),o in this.expressionMap.locallyGenerated||(this.expressionMap.locallyGenerated[o]={}),i.setEntityValue(this.expressionMap.locallyGenerated[o],c);else if(c===void 0)this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?i.default!==void 0&&i.default!==null?r+=this.connection.driver.normalizeDefault(i):r+="NULL":r+="DEFAULT";else if(c===null&&this.connection.driver.options.type==="spanner")r+="NULL";else if(typeof c=="function")r+=c();else{this.connection.driver.options.type==="mssql"&&(c=this.connection.driver.parametrizeValue(i,c));const l=this.createParameter(c);if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1){const u=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";i.srid!=null?r+=`${u}(${l}, ${i.srid})`:r+=`${u}(${l})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?i.srid!=null?r+=`ST_SetSRID(ST_GeomFromGeoJSON(${l}), ${i.srid})::${i.type}`:r+=`ST_GeomFromGeoJSON(${l})::${i.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(i.type)!==-1?r+=i.type+"::STGeomFromText("+l+", "+(i.srid||"0")+")":r+=l}s===n.length-1?o===t.length-1?this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy ":r+=")":this.connection.driver.options.type==="oracle"&&t.length>1?r+=" FROM DUAL UNION ALL ":this.connection.driver.options.type==="sap"&&t.length>1?r+=" FROM dummy UNION ALL ":r+="), ":r+=", "})}),r==="()"?"":r}else{let r="";return t.forEach((a,o)=>{Object.keys(a).forEach((i,s)=>{s===0&&(r+="(");const c=a[i];typeof c=="function"?r+=c():c===void 0?this.connection.driver.options.type==="oracle"&&t.length>1||ve.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?r+="NULL":r+="DEFAULT":c===null&&this.connection.driver.options.type==="spanner"||(r+=this.createParameter(c)),s===Object.keys(a).length-1?o===t.length-1?r+=")":r+="), ":r+=", "})}),r==="()"?"":r}}getValueSets(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(Yt.isObject(this.expressionMap.valuesSet))return[this.expressionMap.valuesSet];throw new cle}isOverridingAutoIncrementBehavior(t){return t.isPrimary&&t.isGenerated&&t.generationStrategy==="increment"&&this.getValueSets().some(n=>t.getEntityValue(n)!==void 0&&t.getEntityValue(n)!==null)}}class L4{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async update(t){const n=this.expressionMap.relationMetadata;if(n.isManyToOne||n.isOneToOneOwner){const r=n.joinColumns.reduce((a,o)=>{const i=Yt.isObject(t)?o.referencedColumn.getEntityValue(t):t;return o.setEntityValue(a,i),a},{});if(!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length)return;await this.queryBuilder.createQueryBuilder().update(n.entityMetadata.target).set(r).whereInIds(this.expressionMap.of).execute()}else if((n.isOneToOneNotOwner||n.isOneToMany)&&t===null){const r={};n.inverseRelation.joinColumns.forEach(c=>{r[c.propertyName]=null});const a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o={},i=[];a.forEach((c,l)=>{n.inverseRelation.joinColumns.map((u,d)=>{const p="joinColumn_"+l+"_"+d;o[p]=Yt.isObject(c)?u.referencedColumn.getEntityValue(c):c,i.push(`${u.propertyPath} = :${p}`)})});const s=i.map(c=>"("+c+")").join(" OR ");if(!s)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(r).where(s).setParameters(o).execute()}else if(n.isOneToOneNotOwner||n.isOneToMany){if(Array.isArray(this.expressionMap.of))throw new xe("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");const r=this.expressionMap.of,a=n.inverseRelation.joinColumns.reduce((o,i)=>{const s=Yt.isObject(r)?i.referencedColumn.getEntityValue(r):r;return i.setEntityValue(o,s),o},{});if(!t||Array.isArray(t)&&!t.length)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(a).whereInIds(t).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c=[];if(i.forEach(l=>{s.forEach(u=>{const d={};r.ownerColumns.forEach(p=>{d[p.databaseName]=Yt.isObject(l)?p.referencedColumn.getEntityValue(l):l}),r.inverseColumns.forEach(p=>{d[p.databaseName]=Yt.isObject(u)?p.referencedColumn.getEntityValue(u):u}),c.push(d)})}),!c.length)return;this.queryBuilder.connection.driver.options.type==="oracle"||this.queryBuilder.connection.driver.options.type==="sap"?await Promise.all(c.map(l=>this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(l).execute())):await this.queryBuilder.createQueryBuilder().insert().into(r.tableName).values(c).execute()}}}class Ale{constructor(t,n){this.queryBuilder=t,this.expressionMap=n}async remove(t){const n=this.expressionMap.relationMetadata;if(n.isOneToMany){const r=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],a=Array.isArray(t)?t:[t],o={};n.inverseRelation.joinColumns.forEach(l=>{o[l.propertyName]=null});const i={},s=[];r.forEach((l,u)=>{s.push(...a.map((d,p)=>[...n.inverseRelation.joinColumns.map((f,y)=>{const m="joinColumn_"+u+"_"+p+"_"+y;return i[m]=Yt.isObject(l)?f.referencedColumn.getEntityValue(l):l,`${f.propertyPath} = :${m}`}),...n.inverseRelation.entityMetadata.primaryColumns.map((f,y)=>{const m="primaryColumn_"+p+"_"+p+"_"+y;return i[m]=Yt.isObject(d)?f.getEntityValue(d):d,`${f.propertyPath} = :${m}`})].join(" AND ")))});const c=s.map(l=>"("+l+")").join(" OR ");if(!c)return;await this.queryBuilder.createQueryBuilder().update(n.inverseEntityMetadata.target).set(o).where(c).setParameters(i).execute()}else{const r=n.junctionEntityMetadata,a=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],o=Array.isArray(t)?t:[t],i=n.isManyToManyOwner?a:o,s=n.isManyToManyOwner?o:a,c={},l=[];i.forEach((d,p)=>{l.push(...s.map((f,y)=>[...r.ownerColumns.map((m,v)=>{const b="firstValue_"+p+"_"+y+"_"+v;return c[b]=Yt.isObject(d)?m.referencedColumn.getEntityValue(d):d,`${m.databaseName} = :${b}`}),...r.inverseColumns.map((m,v)=>{const b="secondValue_"+p+"_"+y+"_"+v;return c[b]=Yt.isObject(f)?m.referencedColumn.getEntityValue(f):f,`${m.databaseName} = :${b}`})].join(" AND ")))});const u=l.map(d=>"("+d+")").join(" OR ");await this.queryBuilder.createQueryBuilder().delete().from(r.tableName).where(u).setParameters(c).execute()}}}class Tle extends Ht{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("RelationQueryBuilder")}getQuery(){return""}of(t){return this.expressionMap.of=t,this}async set(t){const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToMany||n.isOneToMany)throw new xe(`Set operation is only supported for many-to-one and one-to-one relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .add() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!Yt.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new L4(this,this.expressionMap).update(t)}async add(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set() method instead.`);if(n.joinColumns&&n.joinColumns.length>1&&(!Yt.isObject(t)||Object.keys(t).length<n.joinColumns.length))throw new xe('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new L4(this,this.expressionMap).update(t)}async remove(t){if(Array.isArray(t)&&t.length===0)return;const n=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new xe("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(n.isManyToOne||n.isOneToOne)throw new xe(`Add operation is only supported for many-to-many and one-to-many relations. However given "${n.propertyPath}" has ${n.relationType} relation. Use .set(null) method instead.`);return new Ale(this,this.expressionMap).remove(t)}async addAndRemove(t,n){await this.remove(n),await this.add(t)}async loadOne(){return this.loadMany().then(t=>t[0])}async loadMany(){let t=this.expressionMap.of;if(!Yt.isObject(t)){const n=this.expressionMap.mainAlias.metadata;if(n.hasMultiplePrimaryKeys)throw new xe("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");t=n.primaryColumns[0].createValueMap(t)}return this.connection.relationLoader.load(this.expressionMap.relationMetadata,t,this.queryRunner)}}class bn{static chunk(t,n){return Array.from(Array(Math.ceil(t.length/n)),(r,a)=>t.slice(a*n,a*n+n))}static splitClassesAndStrings(t){return[t.filter(n=>typeof n!="string"),t.filter(n=>typeof n=="string")]}static groupBy(t,n){return t.reduce((r,a)=>{const o=n(a);let i=r.find(s=>s.id===o);return i||(i={id:o,items:[]},r.push(i)),i.items.push(a),r},[])}static uniq(t,n){return t.reduce((r,a)=>{let o=!1;if(typeof n=="function"){const i=n(a);o=!!r.find(s=>n(s)===i)}else typeof n=="string"?o=!!r.find(i=>i[n]===a[n]):o=r.indexOf(a)!==-1;return o||r.push(a),r},[])}static isPlainObject(t){return t==null?!1:!t.constructor||t.constructor===Object}static mergeArrayKey(t,n,r,a){if(a.has(r)){t[n]=a.get(r);return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){t[n]=r;return}t[n]||(t[n]=Array.isArray(r)?[]:{}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static mergeObjectKey(t,n,r,a){if(a.has(r)){Object.assign(t,{[n]:a.get(r)});return}if(!(r instanceof Promise)){if(!this.isPlainObject(r)&&!Array.isArray(r)){Object.assign(t,{[n]:r});return}t[n]||Object.assign(t,{[n]:Array.isArray(r)?[]:{}}),a.set(r,t[n]),this.merge(t[n],r,a),a.delete(r)}}static merge(t,n,r=new Map){if(this.isPlainObject(t)&&this.isPlainObject(n))for(const a of Object.keys(n))a!=="__proto__"&&this.mergeObjectKey(t,a,n[a],r);if(Array.isArray(t)&&Array.isArray(n))for(let a=0;a<n.length;a++)this.mergeArrayKey(t,a,n[a],r)}static mergeDeep(t,...n){if(!n.length)return t;for(const r of n)bn.merge(t,r);return t}static deepCompare(...t){let n,r,a,o;if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(a=[],o=[],!this.compare2Objects(a,o,arguments[0],arguments[n]))return!1;return!0}static deepValue(t,n){const r=n.split(".");for(let a=0,o=r.length;a<o;a++)t=t[r[a]];return t}static replaceEmptyObjectsWithBooleans(t){for(let n in t)t[n]&&typeof t[n]=="object"&&(Object.keys(t[n]).length===0?t[n]=!0:this.replaceEmptyObjectsWithBooleans(t[n]))}static propertyPathsToTruthyObject(t){let n={};for(let r of t){const a=r.split(".");if(!a.length)continue;(!n[a[0]]||n[a[0]]===!0)&&(n[a[0]]={});let o=n[a[0]];for(let[i,s]of a.entries())i!==0&&(o[s]?o=o[s]:i===a.length-1?(o[s]={},o=null):(o[s]={},o=o[s]))}return this.replaceEmptyObjectsWithBooleans(n),n}static compareIds(t,n){return t==null||n===void 0||n===null?!1:(typeof t.id=="string"&&typeof n.id=="string"||typeof t.id=="number"&&typeof n.id=="number")&&Object.keys(t).length===1&&Object.keys(n).length===1?t.id===n.id:bn.deepCompare(t,n)}static toBoolean(t){return typeof t=="boolean"?t:typeof t=="string"?t==="true"||t==="1":typeof t=="number"?t>0:!1}static zipObject(t,n){return t.reduce((r,a,o)=>(r[a]=n[o],r),{})}static isArraysEqual(t,n){return t.length!==n.length?!1:t.every(r=>n.indexOf(r)!==-1)}static areMutuallyExclusive(...t){return!t.some(n=>{const r=t.filter(a=>a!==n);return n.some(a=>r.some(o=>o.includes(a)))})}static parseSqlCheckExpression(t,n){const r=t.match(new RegExp(`"${n}" varchar CHECK\\s*\\(\\s*"${n}"\\s+IN\\s*`));if(r&&r.index){const a=t.substring(r.index+r[0].length);let o="",i="";const s=[];for(let c=0;c<a.length;c++){const l=a[c];switch(l){case",":o==""?(s.push(i),i=""):i+=l;break;case"'":o==l?a[c+1]===l?(i+=l,c+=1):o="":o=l;break;case")":if(o=="")return s.push(i),s;i+=l;break;default:o!=""&&(i+=l)}}}}static compare2Objects(t,n,r,a){let o;if(Number.isNaN(r)&&Number.isNaN(a)||r===a)return!0;if(r===null||a===null||r===void 0||a===void 0)return!1;if((typeof r.equals=="function"||typeof r.equals=="function")&&r.equals(a))return!0;if(typeof r=="function"&&typeof a=="function"||r instanceof Date&&a instanceof Date||r instanceof RegExp&&a instanceof RegExp||typeof r=="string"&&typeof a=="string"||typeof r=="number"&&typeof a=="number")return r.toString()===a.toString();if(!(typeof r=="object"&&typeof a=="object")||Object.prototype.isPrototypeOf.call(r,a)||Object.prototype.isPrototypeOf.call(a,r)||r.constructor!==a.constructor||r.prototype!==a.prototype||t.indexOf(r)>-1||n.indexOf(a)>-1)return!1;for(o in a)if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;for(o in r){if(a.hasOwnProperty(o)!==r.hasOwnProperty(o)||typeof a[o]!=typeof r[o])return!1;switch(typeof r[o]){case"object":case"function":if(t.push(r),n.push(a),!this.compare2Objects(t,n,r[o],a[o]))return!1;t.pop(),n.pop();break;default:if(r[o]!==a[o])return!1;break}}return!0}}class Ile{constructor(t,n,r,a,o){this.expressionMap=t,this.driver=n,this.rawRelationIdResults=r,this.rawRelationCountResults=a,this.queryRunner=o}transform(t,n){const r=this.group(t,n),a=[];return r.forEach(o=>{const i=this.transformRawResultsGroup(o,n);i!==void 0&&!Object.values(i).every(s=>s===null)&&a.push(i)}),a}group(t,n){const r=new Map,a=[];return n.metadata.tableType==="view"?a.push(...n.metadata.columns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))):a.push(...n.metadata.primaryColumns.map(o=>ve.buildAlias(this.driver,void 0,n.name,o.databaseName))),t.forEach(o=>{const i=a.map(c=>{const l=o[c];return pa.isBuffer(l)?l.toString("hex"):Yt.isObject(l)?JSON.stringify(l):l}).join("_"),s=r.get(i);s?s.push(o):r.set(i,[o])}),r}transformRawResultsGroup(t,n){let r=n.metadata;if(r.discriminatorColumn){const l=t.map(d=>d[ve.buildAlias(this.driver,void 0,n.name,n.metadata.discriminatorColumn.databaseName)]),u=r.childEntityMetadatas.find(d=>typeof l.find(p=>p===d.discriminatorValue)<"u");u&&(r=u)}let a=r.create(this.queryRunner,{fromDeserializer:!0,pojo:this.expressionMap.options.indexOf("create-pojo")!==-1});const o=this.transformColumns(t,n,a,r),i=this.transformJoins(t,a,n,r),s=this.transformRelationIds(t,n,a,r),c=this.transformRelationCounts(t,n,a);if(o||r.primaryColumns.filter(l=>l.isVirtual===!1).length===0&&(i||s||c))return a}transformColumns(t,n,r,a){let o=!1;return a.columns.forEach(i=>{if(a.childEntityMetadatas.length>0&&a.childEntityMetadatas.findIndex(c=>c.target===i.target)!==-1)return;const s=t[0][ve.buildAlias(this.driver,void 0,n.name,i.databaseName)];s===void 0||i.isVirtual||this.expressionMap.selects.find(c=>c.selection===n.name||c.selection===n.name+"."+i.propertyPath)&&(i.setEntityValue(r,this.driver.prepareHydratedValue(s,i)),s!==null&&(o=!0))}),o}transformJoins(t,n,r,a){let o=!1;return this.expressionMap.joinAttributes.forEach(i=>{if(!i.metadata||!i.isSelected||i.relation&&!a.relations.find(c=>c===i.relation))return;if(i.mapToProperty){if(i.mapToPropertyParentAlias!==r.name)return}else if(!i.relation||i.parentAlias!==r.name||i.relationPropertyPath!==i.relation.propertyPath)return;let s=this.transform(t,i.alias);s=i.isMany?s:s[0],s=!i.isMany&&s===void 0?null:s,s!==void 0&&(i.mapToPropertyPropertyName?n[i.mapToPropertyPropertyName]=s:i.relation.setEntityValue(n,s),o=!0)}),o}transformRelationIds(t,n,r,a){let o=!1;return this.rawRelationIdResults.forEach((i,s)=>{if(i.relationIdAttribute.parentAlias!==n.name)return;const c=i.relationIdAttribute.relation,l=this.createValueMapFromJoinColumns(c,i.relationIdAttribute.parentAlias,t);if(l==null)return;this.prepareDataForTransformRelationIds();const u=this.hashEntityIds(c,l),d=this.relationIdMaps[s][u]||[],p=i.relationIdAttribute.mapToPropertyPropertyPath.split("."),f=(y,m,v)=>{const b=y.shift();if(b&&y.length===0)return m[b]=v,m;if(b&&y.length>0)f(y,m[b],v);else return m};c.isOneToOne||c.isManyToOne?d[0]!==void 0&&(f(p,r,d[0]),o=!0):(f(p,r,d),o=o||d.length>0)}),o}transformRelationCounts(t,n,r){let a=!1;return this.rawRelationCountResults.filter(o=>o.relationCountAttribute.parentAlias===n.name).forEach(o=>{const i=o.relationCountAttribute.relation;let s;i.isOneToMany?s=i.inverseRelation.joinColumns[0].referencedColumn.databaseName:s=i.isOwning?i.joinColumns[0].referencedColumn.databaseName:i.inverseRelation.joinColumns[0].referencedColumn.databaseName;const c=t[0][ve.buildAlias(this.driver,void 0,n.name,s)];c!=null&&(r[o.relationCountAttribute.mapToPropertyPropertyName]=0,o.results.filter(l=>l.parentId===c).forEach(l=>{r[o.relationCountAttribute.mapToPropertyPropertyName]=parseInt(l.cnt),a=!0}))}),a}createValueMapFromJoinColumns(t,n,r){let a;return t.isManyToOne||t.isOneToOneOwner?a=t.entityMetadata.primaryColumns.map(o=>o):t.isOneToMany||t.isOneToOneNotOwner?a=t.inverseRelation.joinColumns.map(o=>o):t.isOwning?a=t.joinColumns.map(o=>o):a=t.inverseRelation.inverseJoinColumns.map(o=>o),a.reduce((o,i)=>(r.forEach(s=>{t.isManyToOne||t.isOneToOneOwner?o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.databaseName)],i):o[i.databaseName]=this.driver.prepareHydratedValue(s[ve.buildAlias(this.driver,void 0,n,i.referencedColumn.databaseName)],i.referencedColumn)}),o),{})}extractEntityPrimaryIds(t,n){let r;return t.isManyToOne||t.isOneToOneOwner?r=t.entityMetadata.primaryColumns.map(a=>a):t.isOneToMany||t.isOneToOneNotOwner?r=t.inverseRelation.joinColumns.map(a=>a):t.isOwning?r=t.joinColumns.map(a=>a):r=t.inverseRelation.inverseJoinColumns.map(a=>a),r.reduce((a,o)=>(a[o.databaseName]=n[o.databaseName],a),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(t=>{const n=t.relationIdAttribute.relation;let r;return n.isManyToOne||n.isOneToOneOwner?r=n.joinColumns:n.isOneToMany||n.isOneToOneNotOwner?r=n.inverseEntityMetadata.primaryColumns:n.isOwning?r=n.inverseJoinColumns:r=n.inverseRelation.joinColumns,t.results.reduce((a,o)=>{let i=r.reduce((s,c)=>{let l=o[c.databaseName];return n.isOneToMany||n.isOneToOneNotOwner?(c.isVirtual&&c.referencedColumn&&c.referencedColumn.propertyName!==c.propertyName&&(l=c.referencedColumn.createValueMap(l)),bn.mergeDeep(s,c.createValueMap(l))):(!c.isPrimary&&c.referencedColumn.referencedColumn&&(l=c.referencedColumn.referencedColumn.createValueMap(l)),bn.mergeDeep(s,c.referencedColumn.createValueMap(l)))},{});if(r.length===1&&!t.relationIdAttribute.disableMixedMap&&(n.isOneToMany||n.isOneToOneNotOwner?i=r[0].getEntityValue(i):i=r[0].referencedColumn.getEntityValue(i)),i!==void 0){const s=this.hashEntityIds(n,o);a[s]?a[s].push(i):a[s]=[i]}return a},{})}))}hashEntityIds(t,n){const r=this.extractEntityPrimaryIds(t,n);return JSON.stringify(r)}}let Rle=class{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}async load(e){const t=this.relationIdAttributes.map(async n=>{if(n.relation.isManyToOne||n.relation.isOneToOneOwner){if(n.queryBuilderFactory)throw new xe("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const r={},a=e.map(o=>{const i={},s=[];n.relation.joinColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l.referencedColumn);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),n.relation.entityMetadata.primaryColumns.forEach(l=>{i[l.databaseName]=this.connection.driver.prepareHydratedValue(o[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,l.databaseName)],l);const u=`${l.databaseName}:${i[l.databaseName]}`;s.indexOf(u)===-1&&s.push(u)}),s.sort();const c=s.join("::");return r[c]?null:(r[c]=!0,i)}).filter(o=>o);return{relationIdAttribute:n,results:a}}else if(n.relation.isOneToMany||n.relation.isOneToOneNotOwner){const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.joinColumns,o=r.inverseEntityMetadata.target,i=r.inverseEntityMetadata.tableName,s=n.alias||i,c={},l={},u=e.map((f,y)=>{const m=[],v={},b=a.map(j=>{const x=j.databaseName+y,_=f[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,j.referencedColumn.databaseName)],S=`${s}:${j.propertyPath}:${_}`;return m.indexOf(S)!==-1?"":(m.push(S),v[x]=_,s+"."+j.propertyPath+" = :"+x)}).filter(j=>j).join(" AND ");m.sort();const w=m.join("::");return c[w]?"":(c[w]=!0,Object.assign(l,v),b)}).filter(f=>f).map(f=>"("+f+")").join(" OR ");if(!u)return{relationIdAttribute:n,results:[]};const d=this.connection.createQueryBuilder(this.queryRunner);bn.uniq([...a,...r.inverseRelation.entityMetadata.primaryColumns],f=>f.propertyPath).forEach(f=>{d.addSelect(s+"."+f.propertyPath,f.databaseName)}),d.from(o,s).where("("+u+")").setParameters(l),n.queryBuilderFactory&&n.queryBuilderFactory(d);const p=await d.getRawMany();return p.forEach(f=>{a.forEach(y=>{f[y.databaseName]=this.connection.driver.prepareHydratedValue(f[y.databaseName],y.referencedColumn)}),r.inverseRelation.entityMetadata.primaryColumns.forEach(y=>{f[y.databaseName]=this.connection.driver.prepareHydratedValue(f[y.databaseName],y)})}),{relationIdAttribute:n,results:p}}else{const r=n.relation,a=r.isOwning?r.joinColumns:r.inverseRelation.inverseJoinColumns,o=r.isOwning?r.inverseJoinColumns:r.inverseRelation.joinColumns,i=n.junctionAlias,s=n.joinInverseSideMetadata.tableName,c=n.alias||s,l=r.isOwning?r.junctionEntityMetadata.tableName:r.inverseRelation.junctionEntityMetadata.tableName,u=e.map(w=>a.reduce((j,x)=>(j[x.propertyPath]=w[ve.buildAlias(this.connection.driver,void 0,n.parentAlias,x.referencedColumn.databaseName)],j),{}));if(u.length===0)return{relationIdAttribute:n,results:[]};const d={},p={},f=u.map((w,j)=>{const x=[],_={},S=Object.keys(w).map(O=>{const M=O+j,N=w[O],P=`${i}:${O}:${N}`;return x.indexOf(P)!==-1?"":(x.push(P),_[M]=N,i+"."+O+" = :"+M)}).filter(O=>O).join(" AND ");x.sort();const E=x.join("::");return p[E]?"":(p[E]=!0,Object.assign(d,_),S)}).filter(w=>w),y=o.map(w=>i+"."+w.propertyPath+" = "+c+"."+w.referencedColumn.propertyPath).join(" AND "),m=f.map(w=>"("+w+" AND "+y+")").join(" OR "),v=this.connection.createQueryBuilder(this.queryRunner);o.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),a.forEach(w=>{v.addSelect(i+"."+w.propertyPath,w.databaseName).addOrderBy(i+"."+w.propertyPath)}),v.from(s,c).innerJoin(l,i,m).setParameters(d),n.queryBuilderFactory&&n.queryBuilderFactory(v);const b=await v.getRawMany();return b.forEach(w=>{[...a,...o].forEach(j=>{w[j.databaseName]=this.connection.driver.prepareHydratedValue(w[j.databaseName],j.referencedColumn)})}),{relationIdAttribute:n,results:b}}});return Promise.all(t)}};class Dle{constructor(t,n){this.connection=t,this.queryRunner=n}load(t,n,r){const a=Array.isArray(n)?n:[n],o=Array.isArray(r)?r:r?[r]:void 0;return t.isManyToMany?this.loadForManyToMany(t,a,o):t.isManyToOne||t.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(t,a,o):this.loadForOneToManyAndOneToOneNotOwner(t,a,o)}async loadManyToManyRelationIdsAndGroup(t,n,r,a){const o=t.isManyToMany||t.isOneToMany,i=Array.isArray(n)?n:[n];if(!r&&(r=await this.connection.relationLoader.load(t,n,this.queryRunner,a),!r.length))return i.map(d=>({entity:d,related:o?[]:void 0}));const s=await this.load(t,n,r),c=Array.isArray(r)?r:[r];let l=[],u=[];return t.isManyToManyOwner?(l=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn)):t.isManyToManyNotOwner?(l=t.junctionEntityMetadata.ownerColumns.map(d=>d.referencedColumn),u=t.junctionEntityMetadata.inverseColumns.map(d=>d.referencedColumn)):t.isManyToOne||t.isOneToOneOwner?(l=t.joinColumns.map(d=>d.referencedColumn),u=t.entityMetadata.primaryColumns):(t.isOneToMany||t.isOneToOneNotOwner)&&(l=t.inverseRelation.entityMetadata.primaryColumns,u=t.inverseRelation.joinColumns.map(d=>d.referencedColumn)),i.map(d=>{const p={entity:d,related:o?[]:void 0},f=s.filter(y=>u.every(m=>m.compareEntityValue(d,y[m.entityMetadata.name+"_"+m.propertyAliasName])));return f.length&&c.forEach(y=>{f.forEach(m=>{l.every(v=>v.compareEntityValue(y,m[ve.buildAlias(this.connection.driver,void 0,v.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+v.propertyPath.replace(".","_"))]))&&(o?p.related.push(y):p.related=y)})}),p})}loadForManyToMany(t,n,r){const a=t.junctionEntityMetadata,o=a.name,i=t.isOwning?a.ownerColumns:a.inverseColumns,s=t.isOwning?a.inverseColumns:a.ownerColumns,c=this.connection.createQueryBuilder(this.queryRunner);i.forEach(p=>{const f=ve.buildAlias(this.connection.driver,void 0,p.referencedColumn.entityMetadata.name+"_"+p.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+p.propertyPath,f)}),s.forEach(p=>{const f=ve.buildAlias(this.connection.driver,void 0,p.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+p.referencedColumn.propertyPath.replace(".","_"));c.addSelect(o+"."+p.propertyPath,f)});let l="";if(i.length===1){const p=n.map(f=>i[0].referencedColumn.getEntityValue(f));p.every(f=>typeof f=="number")?l=`${o}.${i[0].propertyPath} IN (${p.join(", ")})`:(c.setParameter("values1",p),l=o+"."+i[0].propertyPath+" IN (:...values1)")}else l="("+n.map((p,f)=>i.map(y=>{const m="entity1_"+f+"_"+y.propertyName;return c.setParameter(m,y.referencedColumn.getEntityValue(p)),o+"."+y.propertyPath+" = :"+m}).join(" AND ")).map(p=>"("+p+")").join(" OR ")+")";let u="";if(r)if(s.length===1){const p=r.map(f=>s[0].referencedColumn.getEntityValue(f));p.every(f=>typeof f=="number")?u=`${o}.${s[0].propertyPath} IN (${p.join(", ")})`:(c.setParameter("values2",p),u=o+"."+s[0].propertyPath+" IN (:...values2)")}else u="("+r.map((p,f)=>s.map(y=>{const m="entity2_"+f+"_"+y.propertyName;return c.setParameter(m,y.referencedColumn.getEntityValue(p)),o+"."+y.propertyPath+" = :"+m}).join(" AND ")).map(p=>"("+p+")").join(" OR ")+")";const d=[l,u].filter(p=>p.length>0).join(" AND ");return c.from(a.target,o).where(d).getRawMany()}loadForManyToOneAndOneToOneOwner(t,n,r){const a=t.entityMetadata.targetName,o=t.joinColumns.every(c=>!!t.entityMetadata.nonVirtualColumns.find(l=>l===c));if(r&&o){let c=[];if(n.forEach(l=>{let u={};t.entityMetadata.primaryColumns.forEach(d=>{const p=d.entityMetadata.name+"_"+d.propertyPath.replace(".","_");u[p]=d.getEntityValue(l)}),r.forEach(d=>{t.joinColumns.forEach(p=>{const f=p.getEntityValue(l),y=p.referencedColumn.getEntityValue(d);if(!(f===void 0||y===void 0)&&f===y){const m=p.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+p.referencedColumn.propertyPath.replace(".","_");u[m]=y}})}),Object.keys(u).length===t.entityMetadata.primaryColumns.length+t.joinColumns.length&&c.push(u)}),c.length===n.length)return Promise.resolve(c)}const i=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.entityMetadata.name+"_"+c.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)}),t.joinColumns.forEach(c=>{const l=ve.buildAlias(this.connection.driver,void 0,c.referencedColumn.entityMetadata.name+"_"+t.propertyPath.replace(".","_")+"_"+c.referencedColumn.propertyPath.replace(".","_"));i.addSelect(a+"."+c.propertyPath,l)});let s="";if(t.entityMetadata.primaryColumns.length===1){const c=n.map(l=>t.entityMetadata.primaryColumns[0].getEntityValue(l));c.every(l=>typeof l=="number")?s=`${a}.${t.entityMetadata.primaryColumns[0].propertyPath} IN (${c.join(", ")})`:(i.setParameter("values",c),s=a+"."+t.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else s=n.map((c,l)=>t.entityMetadata.primaryColumns.map((u,d)=>{const p="entity"+l+"_"+d;return i.setParameter(p,u.getEntityValue(c)),a+"."+u.propertyPath+" = :"+p}).join(" AND ")).map(c=>"("+c+")").join(" OR ");return i.from(t.entityMetadata.target,a).where(s).getRawMany()}loadForOneToManyAndOneToOneNotOwner(t,n,r){if(t=t.inverseRelation,t.entityMetadata.primaryColumns.length===t.joinColumns.length&&t.entityMetadata.primaryColumns.every(s=>t.joinColumns.indexOf(s)!==-1))return Promise.resolve(n.map(s=>{const c={};return t.joinColumns.forEach(function(l){const u=l.referencedColumn.getEntityValue(s),d=l.referencedColumn.entityMetadata.name+"_"+l.referencedColumn.propertyPath.replace(".","_"),p=l.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+l.propertyPath.replace(".","_");c[d]=u,c[p]=u}),c}));const a=t.entityMetadata.targetName,o=this.connection.createQueryBuilder(this.queryRunner);t.entityMetadata.primaryColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.entityMetadata.name+"_"+t.inverseRelation.propertyPath.replace(".","_")+"_"+s.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)}),t.joinColumns.forEach(s=>{const c=ve.buildAlias(this.connection.driver,void 0,s.referencedColumn.entityMetadata.name+"_"+s.referencedColumn.propertyPath.replace(".","_"));o.addSelect(a+"."+s.propertyPath,c)});let i="";if(t.joinColumns.length===1){const s=n.map(c=>t.joinColumns[0].referencedColumn.getEntityValue(c));s.every(c=>typeof c=="number")?i=`${a}.${t.joinColumns[0].propertyPath} IN (${s.join(", ")})`:(o.setParameter("values",s),i=a+"."+t.joinColumns[0].propertyPath+" IN (:...values)")}else i=n.map((s,c)=>t.joinColumns.map((l,u)=>{const d="entity"+c+"_"+u;return o.setParameter(d,l.referencedColumn.getEntityValue(s)),a+"."+l.propertyPath+" = :"+d}).join(" AND ")).map(s=>"("+s+")").join(" OR ");return o.from(t.entityMetadata.target,a).where(i).getRawMany()}}class Lle{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationIdAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationIds.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationIdAttributes.push(r)})})}metadataToAttribute(t,n){return new Y1(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class $le{constructor(t,n,r){this.connection=t,this.queryRunner=n,this.relationCountAttributes=r}async load(t){const n=(a,o,i)=>i.indexOf(a)===o,r=this.relationCountAttributes.map(async a=>{if(a.relation.isOneToMany){const o=a.relation,i=o.inverseRelation,s=i.joinColumns[0].referencedColumn.propertyName,c=o.inverseEntityMetadata.target,l=o.inverseEntityMetadata.tableName,u=a.alias||l,d=i.propertyName;let p=t.map(y=>y[a.parentAlias+"_"+s]).filter(y=>!!y);if(p=p.filter(n),p.length===0)return{relationCountAttribute:a,results:[]};const f=this.connection.createQueryBuilder(this.queryRunner);return f.select(u+"."+d,"parentId").addSelect("COUNT(*)","cnt").from(c,u).where(u+"."+d+" IN (:...ids)").addGroupBy(u+"."+d).setParameter("ids",p),a.queryBuilderFactory&&a.queryBuilderFactory(f),{relationCountAttribute:a,results:await f.getRawMany()}}else{let o,i,s,c;a.relation.isOwning?(o=a.relation.joinColumns[0].referencedColumn.databaseName,i=a.relation.inverseJoinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[0],c=a.relation.junctionEntityMetadata.columns[1]):(o=a.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,i=a.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,s=a.relation.junctionEntityMetadata.columns[1],c=a.relation.junctionEntityMetadata.columns[0]);let l=t.map(v=>v[a.parentAlias+"_"+o]).filter(v=>!!v);if(l=l.filter(n),l.length===0)return{relationCountAttribute:a,results:[]};const u=a.junctionAlias,d=a.joinInverseSideMetadata.tableName,p=a.alias||d,f=a.relation.junctionEntityMetadata.tableName,y=u+"."+s.propertyName+" IN ("+l.map(v=>isNaN(v)?"'"+v+"'":v)+") AND "+u+"."+c.propertyName+" = "+p+"."+i,m=this.connection.createQueryBuilder(this.queryRunner);return m.select(u+"."+s.propertyName,"parentId").addSelect("COUNT("+m.escape(p)+"."+m.escape(i)+")","cnt").from(d,p).innerJoin(f,u,y).addGroupBy(u+"."+s.propertyName),a.queryBuilderFactory&&a.queryBuilderFactory(m),{relationCountAttribute:a,results:await m.getRawMany()}}});return Promise.all(r)}}class Fle{constructor(t){this.expressionMap=t}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(t=>{const n=this.metadataToAttribute(this.expressionMap.mainAlias.name,t);this.expressionMap.relationCountAttributes.push(n)}),this.expressionMap.joinAttributes.forEach(t=>{!t.metadata||t.metadata.isJunction||t.metadata.relationCounts.forEach(n=>{const r=this.metadataToAttribute(t.alias.name,n);this.expressionMap.relationCountAttributes.push(r)})})}metadataToAttribute(t,n){return new J1(this.expressionMap,{relationName:t+"."+n.relation.propertyName,mapToProperty:t+"."+n.propertyName,alias:n.alias,queryBuilderFactory:n.queryBuilderFactory})}}class r_{static isFindOneOptions(t){const n=t;return n&&(Array.isArray(n.select)||Array.isArray(n.relations)||typeof n.select=="object"||typeof n.relations=="object"||typeof n.where=="object"||typeof n.join=="object"||typeof n.order=="object"||typeof n.cache=="object"||typeof n.cache=="boolean"||typeof n.cache=="number"||typeof n.comment=="string"||typeof n.lock=="object"||typeof n.loadRelationIds=="object"||typeof n.loadRelationIds=="boolean"||typeof n.loadEagerRelations=="boolean"||typeof n.withDeleted=="boolean"||typeof n.relationLoadStrategy=="string"||typeof n.transaction=="boolean")}static isFindManyOptions(t){const n=t;return n&&(this.isFindOneOptions(n)||typeof n.skip=="number"||typeof n.take=="number"||typeof n.skip=="string"||typeof n.take=="string")}static extractFindManyOptionsAlias(t){if(this.isFindManyOptions(t)&&t.join)return t.join.alias}static applyOptionsToTreeQueryBuilder(t,n){if(n!=null&&n.relations){const r=[...n.relations];if(r_.applyRelationsRecursively(t,r,t.expressionMap.mainAlias.name,t.expressionMap.mainAlias.metadata,""),r.length>0)throw new lle(r)}return t}static applyRelationsRecursively(t,n,r,a,o){let i=[];if(o){const s=new RegExp("^"+o.replace(".","\\.")+"\\.");i=n.filter(c=>c.match(s)).map(c=>a.findRelationWithPropertyPath(c.replace(s,""))).filter(c=>c)}else i=n.map(s=>a.findRelationWithPropertyPath(s)).filter(s=>s);i.forEach(s=>{let c=ve.buildAlias(t.connection.driver,{joiner:"__"},r,s.propertyPath);const l=r+"."+s.propertyPath;t.expressionMap.relationLoadStrategy==="query"?t.concatRelationMetadata(s):t.leftJoinAndSelect(l,c),n.splice(n.indexOf(o?o+"."+s.propertyPath:s.propertyPath),1);let u,d;if(t.expressionMap.relationLoadStrategy==="query")u=s.inverseEntityMetadata,d=c;else{const p=t.expressionMap.joinAttributes.find(f=>f.entityOrProperty===l);u=p.metadata,d=p.alias.name}if(!d||!u)throw new Ea(s.propertyPath,a);if(this.applyRelationsRecursively(t,n,d,u,o?o+"."+s.propertyPath:s.propertyPath),t.expressionMap.relationLoadStrategy==="join"){const p=a.relations.find(f=>f.propertyName===s.propertyPath);p&&this.joinEagerRelations(t,c,p.inverseEntityMetadata)}})}static joinEagerRelations(t,n,r){r.eagerRelations.forEach(a=>{let o=ve.buildAlias(t.connection.driver,{joiner:"__"},n,a.propertyName),i=!0;for(const l of t.expressionMap.joinAttributes)if(!(l.condition!==void 0||l.mapToProperty!==void 0||l.isMappingMany!==void 0||l.direction!=="LEFT"||l.entityOrProperty!==`${n}.${a.propertyPath}`)){i=!1,o=l.alias.name;break}const s=!!t.expressionMap.joinAttributes.find(l=>l.alias.name===o);i&&!s&&t.leftJoin(n+"."+a.propertyPath,o);let c=!0;for(const l of t.expressionMap.selects)if(!(l.aliasName!==void 0||l.virtual!==void 0||l.selection!==o)){c=!1;break}c&&t.addSelect(o),this.joinEagerRelations(t,o,a.inverseEntityMetadata)})}}class a_ extends Ht{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createSelectExpression(),t+=this.createJoinExpression(),t+=this.createWhereExpression(),t+=this.createGroupByExpression(),t+=this.createHavingExpression(),t+=this.createOrderByExpression(),t+=this.createLimitOffsetExpression(),t+=this.createLockExpression(),t=t.trim(),this.expressionMap.subQuery&&(t="("+t+")"),this.replacePropertyNamesForTheWholeQuery(t)}setFindOptions(t){return this.findOptions=t,this.applyFindOptions(),this}subQuery(){const t=this.createQueryBuilder();return t.expressionMap.subQuery=!0,t.parentQueryBuilder=this,t}select(t,n){if(this.expressionMap.queryType="select",Array.isArray(t))this.expressionMap.selects=t.map(r=>({selection:r}));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&(this.expressionMap.selects=[{selection:t,aliasName:n}]);return this}addSelect(t,n){if(!t)return this;if(Array.isArray(t))this.expressionMap.selects=this.expressionMap.selects.concat(t.map(r=>({selection:r})));else if(typeof t=="function"){const r=t(this.subQuery());this.setParameters(r.getParameters()),this.expressionMap.selects.push({selection:r.getQuery(),aliasName:n})}else t&&this.expressionMap.selects.push({selection:t,aliasName:n});return this}maxExecutionTime(t){return this.expressionMap.maxExecutionTime=t,this}distinct(t=!0){return this.expressionMap.selectDistinct=t,this}distinctOn(t){return this.expressionMap.selectDistinctOn=t,this}fromDummy(){return this.from(this.connection.driver.dummyTableName??"(SELECT 1 AS dummy_column)","dummy_table")}from(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}addFrom(t,n){const r=this.createFromAlias(t,n);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(r),this}innerJoin(t,n,r,a){return this.join("INNER",t,n,r,a),this}leftJoin(t,n,r,a){return this.join("LEFT",t,n,r,a),this}innerJoinAndSelect(t,n,r,a){return this.addSelect(n),this.innerJoin(t,n,r,a),this}leftJoinAndSelect(t,n,r,a){return this.addSelect(n),this.leftJoin(t,n,r,a),this}innerJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!0),this}innerJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("INNER",n,r,a,o,t,!1,i),this}leftJoinAndMapMany(t,n,r,a,o){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!0),this}leftJoinAndMapOne(t,n,r,a,o,i){return this.addSelect(r),this.join("LEFT",n,r,a,o,t,!1,i),this}loadRelationIdAndMap(t,n,r,a){const o=new Y1(this.expressionMap);return o.mapToProperty=t,o.relationName=n,typeof r=="string"&&(o.alias=r),typeof r=="object"&&r.disableMixedMap&&(o.disableMixedMap=!0),o.queryBuilderFactory=a,this.expressionMap.relationIdAttributes.push(o),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(t,n,r,a){const o=new J1(this.expressionMap);return o.mapToProperty=t,o.relationName=n,o.alias=r,o.queryBuilderFactory=a,this.expressionMap.relationCountAttributes.push(o),this.expressionMap.createAlias({type:"other",name:o.junctionAlias}),o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata}),this}loadAllRelationIds(t){return this.expressionMap.mainAlias.metadata.relations.forEach(n=>{t!==void 0&&t.relations!==void 0&&t.relations.indexOf(n.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+n.propertyPath,this.expressionMap.mainAlias.name+"."+n.propertyPath,t)}),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereExists(t){return this.where(...this.getExistsCondition(t))}andWhereExists(t){return this.andWhere(...this.getExistsCondition(t))}orWhereExists(t){return this.orWhere(...this.getExistsCondition(t))}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}having(t,n){return this.expressionMap.havings.push({type:"simple",condition:t}),n&&this.setParameters(n),this}andHaving(t,n){return this.expressionMap.havings.push({type:"and",condition:t}),n&&this.setParameters(n),this}orHaving(t,n){return this.expressionMap.havings.push({type:"or",condition:t}),n&&this.setParameters(n),this}groupBy(t){return t?this.expressionMap.groupBys=[t]:this.expressionMap.groupBys=[],this}addGroupBy(t){return this.expressionMap.groupBys.push(t),this}timeTravelQuery(t){return this.connection.driver.options.type==="cockroachdb"&&(t===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=t),this}orderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){if(n!==void 0&&n!=="ASC"&&n!=="DESC")throw new xe('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(r!==void 0&&r!=="NULLS FIRST"&&r!=="NULLS LAST")throw new xe('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){if(this.expressionMap.limit=this.normalizeNumber(t),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new xe('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(t){if(this.expressionMap.offset=this.normalizeNumber(t),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new xe('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(t){if(this.expressionMap.take=this.normalizeNumber(t),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new xe('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(t){if(this.expressionMap.skip=this.normalizeNumber(t),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new xe('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(t){return this.expressionMap.useIndex=t,this}setLock(t,n,r){return this.expressionMap.lockMode=t,this.expressionMap.lockVersion=n,this.expressionMap.lockTables=r,this}setOnLocked(t){return this.expressionMap.onLocked=t,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if(this.expressionMap.lockMode==="optimistic")throw new nd;this.expressionMap.queryEntity=!1;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0);const r=await this.loadRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getRawAndEntities(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getOne(){const t=(await this.getRawAndEntities()).entities[0];if(t&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const n=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const r=n.updateDateColumn.getEntityValue(t);if(r.getTime()!==this.expressionMap.lockVersion.getTime())throw new y4(n.name,this.expressionMap.lockVersion,r)}else{const r=n.versionColumn.getEntityValue(t);if(r!==this.expressionMap.lockVersion)throw new y4(n.name,this.expressionMap.lockVersion,r)}}return t===void 0?null:t}async getOneOrFail(){const t=await this.getOne();if(!t)throw new ole(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return t}async getMany(){if(this.expressionMap.lockMode==="optimistic")throw new nd;return(await this.getRawAndEntities()).entities}async getCount(){if(this.expressionMap.lockMode==="optimistic")throw new nd;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeCountQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getExists(){if(this.expressionMap.lockMode==="optimistic")throw new nd;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!1;const r=await this.executeExistsQuery(t);return n&&await t.commitTransaction(),r}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async getManyAndCount(){if(this.expressionMap.lockMode==="optimistic")throw new nd;const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.queryEntity=!0;const r=await this.executeEntitiesAndRawResults(t);this.expressionMap.queryEntity=!1;const a=this.expressionMap.cacheId;this.expressionMap.cacheId=a&&`${a}-count`;const o=await this.executeCountQuery(t),i=[r.entities,o];return n&&await t.commitTransaction(),i}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}async stream(){this.expressionMap.queryEntity=!1;const[t,n]=this.getQueryAndParameters(),r=this.obtainQueryRunner();let a=!1;try{this.expressionMap.useTransaction===!0&&r.isTransactionActive===!1&&(await r.startTransaction(),a=!0);const o=()=>{if(r!==this.queryRunner)return r.release()},i=r.stream(t,n,o,o);return a&&await r.commitTransaction(),i}catch(o){if(a)try{await r.rollbackTransaction()}catch{}throw o}}cache(t,n){return typeof t=="boolean"?this.expressionMap.cache=t:typeof t=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=t):(typeof t=="string"||typeof t=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=t),n&&(this.expressionMap.cacheDuration=n),this}setOption(t){return this.expressionMap.options.push(t),this}join(t,n,r,a,o,i,s,c){o&&this.setParameters(o);const l=new A4(this.connection,this.expressionMap);l.direction=t,l.mapAsEntity=c,l.mapToProperty=i,l.isMappingMany=s,l.entityOrProperty=n,l.condition=a,this.expressionMap.joinAttributes.push(l);const u=l.metadata;if(u){if(u.deleteDateColumn&&!this.expressionMap.withDeleted){const d=`${r}.${u.deleteDateColumn.propertyName} IS NULL`;l.condition=l.condition?` ${l.condition} AND ${d}`:`${d}`}l.alias=this.expressionMap.createAlias({type:"join",name:r,metadata:u}),l.relation&&l.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:l.junctionAlias,metadata:l.relation.junctionEntityMetadata})}else{let d="";if(typeof n=="function"){const f=n(this.subQuery());this.setParameters(f.getParameters()),d=f.getQuery()}else d=n;const p=typeof n=="function"||n.substr(0,1)==="("&&n.substr(-1)===")";l.alias=this.expressionMap.createAlias({type:"join",name:r,tablePath:p===!1?n:void 0,subQuery:p===!0?d:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new xe("Cannot build query because main alias is not set (call qb#from method)");const t=[],n=[];if(this.expressionMap.mainAlias.hasMetadata){const s=this.expressionMap.mainAlias.metadata;t.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,s)),n.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,s))}this.expressionMap.joinAttributes.forEach(s=>{if(s.metadata)t.push(...this.buildEscapedEntityColumnSelects(s.alias.name,s.metadata)),n.push(...this.findEntityColumnSelects(s.alias.name,s.metadata));else if(this.expressionMap.selects.some(c=>c.selection===s.alias.name)){t.push({selection:this.escape(s.alias.name)+".*"});const c=this.expressionMap.selects.find(l=>l.selection===s.alias.name);n.push(c)}}),this.expressionMap.selects.filter(s=>n.indexOf(s)===-1).forEach(s=>t.push({selection:this.replacePropertyNames(s.selection),aliasName:s.aliasName})),t.length===0&&t.push({selection:"*"});let r="";this.expressionMap.useIndex&&ve.isMySQLFamily(this.connection.driver)&&(r=` USE INDEX (${this.expressionMap.useIndex})`);const a=this.expressionMap.aliases.filter(s=>s.type==="from"&&(s.tablePath||s.subQuery)).map(s=>s.subQuery?s.subQuery+" "+this.escape(s.name):this.getTableName(s.tablePath)+" "+this.escape(s.name)),o=this.createSelectDistinctExpression(),i=t.map(s=>s.selection+(s.aliasName?" AS "+this.escape(s.aliasName):"")).join(", ");return o+i+" FROM "+a.join(", ")+this.createTableLockExpression()+r}createSelectDistinctExpression(){const{selectDistinct:t,selectDistinctOn:n,maxExecutionTime:r}=this.expressionMap,{driver:a}=this.connection;let o="SELECT ";return r>0&&ve.isMySQLFamily(a)&&(o+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),ve.isPostgresFamily(a)&&n.length>0?o=`SELECT DISTINCT ON (${n.map(i=>this.replacePropertyNames(i)).join(", ")}) `:t&&(o="SELECT DISTINCT "),o}createJoinExpression(){return this.expressionMap.joinAttributes.map(t=>{const n=t.relation,r=t.tablePath,a=t.alias.name;let o=t.condition?" AND ("+t.condition+")":"";const i=t.parentAlias;if(!i||!n){const s=t.alias.subQuery?t.alias.subQuery:this.getTableName(r);return" "+t.direction+" JOIN "+s+" "+this.escape(a)+this.createTableLockExpression()+(t.condition?" ON "+this.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){const s=n.joinColumns.map(c=>a+"."+c.referencedColumn.propertyPath+"="+i+"."+n.propertyPath+"."+c.referencedColumn.propertyPath).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else if(n.isOneToMany||n.isOneToOneNotOwner){const s=n.inverseRelation.joinColumns.map(c=>(n.inverseEntityMetadata.tableType==="entity-child"&&n.inverseEntityMetadata.discriminatorColumn&&(o+=" AND "+a+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),a+"."+n.inverseRelation.propertyPath+"."+c.referencedColumn.propertyPath+"="+i+"."+c.referencedColumn.propertyPath)).join(" AND ");if(!s)throw new xe(`Relation ${n.entityMetadata.name}.${n.propertyName} does not have join columns.`);return" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+o)}else{const s=n.junctionEntityMetadata.tablePath,c=t.junctionAlias;let l="",u="";return n.isOwning?(l=n.joinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseJoinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND ")):(l=n.inverseRelation.inverseJoinColumns.map(d=>c+"."+d.propertyPath+"="+i+"."+d.referencedColumn.propertyPath).join(" AND "),u=n.inverseRelation.joinColumns.map(d=>a+"."+d.referencedColumn.propertyPath+"="+c+"."+d.propertyPath).join(" AND "))," "+t.direction+" JOIN "+this.getTableName(s)+" "+this.escape(c)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l)+" "+t.direction+" JOIN "+this.getTableName(r)+" "+this.escape(a)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(u+o)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const t=this.expressionMap.allOrderBys;return Object.keys(t).length===0?"":" ORDER BY "+Object.keys(t).map(n=>{const r=typeof t[n]=="string"?t[n]:t[n].order+" "+t[n].nulls,a=this.expressionMap.selects.find(o=>o.selection===n);if(a&&!a.aliasName&&n.indexOf(".")!==-1){const o=n.split("."),i=o[0],s=o.slice(1).join("."),c=this.expressionMap.aliases.find(l=>l.name===i);if(c){const l=c.metadata.findColumnWithPropertyPath(s);if(l){const u=ve.buildAlias(this.connection.driver,void 0,i,l.databaseName);return this.escape(u)+" "+r}}}return this.replacePropertyNames(n)+" "+r}).join(", ")}createLimitOffsetExpression(){let t=this.expressionMap.offset,n=this.expressionMap.limit;if(!t&&!n&&this.expressionMap.joinAttributes.length===0&&(t=this.expressionMap.skip,n=this.expressionMap.take),this.connection.driver.options.type==="mssql"){let r="";if((n||t)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(r=" ORDER BY (SELECT NULL)"),n&&t)return r+" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return r+" OFFSET 0 ROWS FETCH NEXT "+n+" ROWS ONLY";if(t)return r+" OFFSET "+t+" ROWS"}else if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)throw new dle}else if(ve.isSQLiteFamily(this.connection.driver)){if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" LIMIT -1 OFFSET "+t}else if(this.connection.driver.options.type==="oracle"){if(n&&t)return" OFFSET "+t+" ROWS FETCH NEXT "+n+" ROWS ONLY";if(n)return" FETCH NEXT "+n+" ROWS ONLY";if(t)return" OFFSET "+t+" ROWS"}else{if(n&&t)return" LIMIT "+n+" OFFSET "+t;if(n)return" LIMIT "+n;if(t)return" OFFSET "+t}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const t=this.connection.driver;let n="";if(this.expressionMap.lockTables){if(!(ve.isPostgresFamily(t)||t.options.type==="cockroachdb"))throw new xe("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new xe("lockTables cannot be an empty array");n=" OF "+this.expressionMap.lockTables.join(", ")}let r="";switch(this.expressionMap.onLocked==="nowait"?r=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(r=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(t.options.type==="mysql"||t.options.type==="aurora-mysql")return ve.isReleaseVersionOrGreater(t,"8.0.0")?" FOR SHARE"+n+r:" LOCK IN SHARE MODE";if(t.options.type==="mariadb")return" LOCK IN SHARE MODE";if(ve.isPostgresFamily(t))return" FOR SHARE"+n+r;if(t.options.type==="oracle")return" FOR UPDATE";if(t.options.type==="mssql")return"";throw new fc;case"pessimistic_write":if(ve.isMySQLFamily(t)||t.options.type==="aurora-mysql"||t.options.type==="oracle")return" FOR UPDATE"+r;if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+r;if(t.options.type==="mssql")return"";throw new fc;case"pessimistic_partial_write":if(ve.isPostgresFamily(t))return" FOR UPDATE"+n+" SKIP LOCKED";if(ve.isMySQLFamily(t))return" FOR UPDATE SKIP LOCKED";throw new fc;case"pessimistic_write_or_fail":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR UPDATE"+n+" NOWAIT";if(ve.isMySQLFamily(t))return" FOR UPDATE NOWAIT";throw new fc;case"for_no_key_update":if(ve.isPostgresFamily(t)||t.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+n+r;throw new fc;case"for_key_share":if(ve.isPostgresFamily(t))return" FOR KEY SHARE"+n+r;throw new fc;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const t=this.expressionMap.havings.map((n,r)=>{switch(n.type){case"and":return(r>0?"AND ":"")+this.replacePropertyNames(n.condition);case"or":return(r>0?"OR ":"")+this.replacePropertyNames(n.condition);default:return this.replacePropertyNames(n.condition)}}).join(" ");return t.length?" HAVING "+t:""}buildEscapedEntityColumnSelects(t,n){const r=this.expressionMap.selects.some(l=>l.selection===t),a=[];if(r&&a.push(...n.columns.filter(l=>l.isSelect===!0)),a.push(...n.columns.filter(l=>this.expressionMap.selects.some(u=>u.selection===t+"."+l.propertyPath))),a.length===0)return[];const o=this.expressionMap.queryEntity?n.primaryColumns.filter(l=>a.indexOf(l)===-1):[],i=[...a,...o],s=[],c=this.escape(t);return i.forEach(l=>{let u=c+"."+this.escape(l.databaseName);l.isVirtualProperty&&l.query&&(u=`(${l.query(c)})`),this.connection.driver.spatialTypes.indexOf(l.type)!==-1&&((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(u=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${u})`),ve.isPostgresFamily(this.connection.driver)&&(l.precision?u=`ST_AsGeoJSON(${u}, ${l.precision})::json`:u=`ST_AsGeoJSON(${u})::json`),this.connection.driver.options.type==="mssql"&&(u=`${u}.ToString()`));const d=this.expressionMap.selects.filter(p=>p.selection===t+"."+l.propertyPath);if(d.length)d.forEach(p=>{s.push({selection:u,aliasName:p.aliasName?p.aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:p.virtual})});else{if(l.isVirtualProperty)return;s.push({selection:u,aliasName:ve.buildAlias(this.connection.driver,void 0,t,l.databaseName),virtual:r})}}),s}findEntityColumnSelects(t,n){const r=this.expressionMap.selects.find(a=>a.selection===t);return r?[r]:this.expressionMap.selects.filter(a=>n.columns.some(o=>a.selection===t+"."+o.propertyPath))}computeCountExpression(){const t=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(t);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||ve.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+"))";if(ve.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const a=n.map(o=>`${r}.${this.escape(o.databaseName)}`).join(", '|;|', ");return n.length===1?`COUNT(DISTINCT(${a}))`:`COUNT(DISTINCT(CONCAT(${a})))`}return this.connection.driver.options.type==="spanner"?n.length===1?`COUNT(DISTINCT(${r}.${this.escape(n[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${n.map(a=>`CAST(${r}.${this.escape(a.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+n.map(a=>`${r}.${this.escape(a.databaseName)}`).join(" || '|;|' || ")+"))"}async executeCountQuery(t){const n=this.computeCountExpression(),r=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(n,"cnt").setOption("disable-global-order").loadRawResults(t);return!r||!r[0]||!r[0].cnt?0:parseInt(r[0].cnt)}async executeExistsQuery(t){return(await this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(t)).length>0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const t=Array.isArray(this.findOptions.select)?bn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(t,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const t=Array.isArray(this.findOptions.relations)?bn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(t,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(t=>{t.select&&!t.selection?t.type==="inner"?this.innerJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoinAndSelect(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):t.type==="inner"?this.innerJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias):this.leftJoin(`${t.parentAlias}.${t.relationMetadata.propertyPath}`,t.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(t=>{this.leftJoin(this.findOptions.join.leftJoin[t],t)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(t=>{this.innerJoin(this.findOptions.join.innerJoin[t],t)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(t=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[t],t)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(t=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[t],t)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const t=this.findOptions.lock.tables?this.findOptions.lock.tables.map(n=>{const r=this.expressionMap.aliases.find(a=>a.metadata.tableNameWithoutPrefix===n);if(!r)throw new xe(`"${n}" is not part of this query`);return this.escape(r.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,t),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&r_.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(t){this.relationMetadatas.push(t)}async executeEntitiesAndRawResults(t){if(!this.expressionMap.mainAlias)throw new xe('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!t.isTransactionActive)throw new ule;if(this.expressionMap.lockMode==="optimistic"){const i=this.expressionMap.mainAlias.metadata;if(!i.versionColumn&&!i.updateDateColumn)throw new sle(i.name)}const n=new Rle(this.connection,t,this.expressionMap.relationIdAttributes),r=new $le(this.connection,t,this.expressionMap.relationCountAttributes);new Lle(this.expressionMap).transform(),new Fle(this.expressionMap).transform();let a=[],o=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[i,s]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),c=this.expressionMap.mainAlias.metadata,l=this.expressionMap.mainAlias.name,u=c.primaryColumns.map(f=>{const y=this.escape("distinctAlias"),m=this.escape(ve.buildAlias(this.connection.driver,void 0,l,f.databaseName));s[m]||(s[m]="ASC");const v=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,f.databaseName);return`${y}.${m} AS ${this.escape(v)}`}),d=this.clone(),p=d.expressionMap.timeTravel;if(a=await new a_(this.connection,t).select(`DISTINCT ${u.join(", ")}`).addSelect(i).from(`(${d.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(p).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(s).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),a.length>0){let f="";const y={};if(c.hasMultiplePrimaryKeys)f=a.map((m,v)=>c.primaryColumns.map(b=>{const w=`orm_distinct_ids_${v}_${b.databaseName}`,j=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,b.databaseName);return y[w]=m[j],`${l}.${b.propertyPath}=:${w}`}).join(" AND ")).join(" OR ");else{const m=ve.buildAlias(this.connection.driver,void 0,"ids_"+l,c.primaryColumns[0].databaseName),v=a.map(b=>b[m]);v.every(b=>typeof b=="number")?f=`${l}.${c.primaryColumns[0].propertyPath} IN (${v.join(", ")})`:(y.orm_distinct_ids=v,f=l+"."+c.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}a=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:f}).setParameters(y).loadRawResults(t)}}else a=await this.loadRawResults(t);if(a.length>0){const i=await n.load(a),s=await r.load(a);o=new Ile(this.expressionMap,this.connection.driver,i,s,this.queryRunner).transform(a,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,o)}if(this.expressionMap.relationLoadStrategy==="query"){const i=new Dle(this.connection,t);await Promise.all(this.relationMetadatas.map(async s=>{const c=s.inverseEntityMetadata.target,l=s.inverseEntityMetadata.targetName,u=Array.isArray(this.findOptions.select)?bn.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,d=Array.isArray(this.findOptions.relations)?bn.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,p=this.createQueryBuilder(t).select(l).from(c,l).setFindOptions({select:u?bn.deepValue(u,s.propertyPath):void 0,order:this.findOptions.order?bn.deepValue(this.findOptions.order,s.propertyPath):void 0,relations:d?bn.deepValue(d,s.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(o.length>0){const f=await i.loadManyToManyRelationIdsAndGroup(s,o,void 0,p);o.forEach(y=>{const m=f.find(v=>v.entity===y);if(m){const v=m.related===void 0?null:m.related;s.setEntityValue(y,v)}})}}))}return{raw:a,entities:o}}createOrderByCombinedWithSelectExpression(t){const n=this.expressionMap.allOrderBys,r=Object.keys(n).map(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);return this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))}else return this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?this.escape(t)+"."+this.escape(o):""}).join(", "),a={};return Object.keys(n).forEach(o=>{if(o.indexOf(".")!==-1){const i=o.split("."),s=i[0],c=i.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(c);a[this.escape(t)+"."+this.escape(ve.buildAlias(this.connection.driver,void 0,s,l.databaseName))]=n[o]}else this.expressionMap.selects.find(i=>i.selection===o||i.aliasName===o)?a[this.escape(t)+"."+this.escape(o)]=n[o]:a[o]=n[o]}),[r,a]}async loadRawResults(t){const[n,r]=this.getQueryAndParameters(),a=n+" -- PARAMETERS: "+JSON.stringify(r,(u,d)=>typeof d=="bigint"?d.toString():d),o=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let i;const s=o.alwaysEnabled&&this.expressionMap.cache!==!1||this.expressionMap.cache===!0;let c=!1;if(this.connection.queryResultCache&&s)try{if(i=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:a,duration:this.expressionMap.cacheDuration||o.duration||1e3},t),i&&!this.connection.queryResultCache.isExpired(i))return JSON.parse(i.result)}catch(u){if(!o.ignoreErrors)throw u;c=!0}const l=await t.query(n,r,!0);if(!c&&this.connection.queryResultCache&&s)try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:a,time:new Date().getTime(),duration:this.expressionMap.cacheDuration||o.duration||1e3,result:JSON.stringify(l.records)},i,t)}catch(u){if(!o.ignoreErrors)throw u}return l.records}mergeExpressionMap(t){return Yt.assign(this.expressionMap,t),this}normalizeNumber(t){return typeof t=="number"||t===void 0||t===null?t:Number(t)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner(this.connection.defaultReplicationModeForReads())}buildSelect(t,n,r,a){for(let o in t){if(t[o]===void 0||t[o]===!1)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Ea(i,n);s?this.selects.push(r+"."+i):c&&this.buildSelect(t[o],n,r,i)}}buildRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Ea(c,r);if(l)this.buildRelations(s,typeof n=="object"?bn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(u):(this.joins.push({type:"left",select:!0,selection:n&&typeof n[i]=="object"?n[i]:void 0,alias:d,parentAlias:a,relationMetadata:u}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d))),typeof s=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(s,typeof n=="object"?bn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildEagerRelations(t,n,r,a,o){t&&Object.keys(t).forEach(i=>{const s=t[i],c=o?o+"."+i:i,l=r.findEmbeddedWithPropertyPath(c),u=r.findRelationWithPropertyPath(c);if(!l&&!u)throw new Ea(c,r);if(l)this.buildEagerRelations(s,typeof n=="object"?bn.deepValue(n,l.propertyPath):void 0,r,a,c);else if(u){let d=a+"_"+c.replace(".","_");d=ve.buildAlias(this.connection.driver,{joiner:"__"},a,d),(s===!0||typeof s=="object")&&u.inverseEntityMetadata.eagerRelations.forEach(p=>{let f=d+"_"+p.propertyPath.replace(".","_");f=ve.buildAlias(this.connection.driver,{joiner:"__"},d,f),this.joins.find(y=>y.alias===f)||this.joins.push({type:"left",select:!0,alias:f,parentAlias:d,selection:void 0,relationMetadata:p}),n&&typeof n[i]=="object"&&this.buildSelect(n[i],u.inverseEntityMetadata,d)}),typeof s=="object"&&this.buildEagerRelations(s,typeof n=="object"?bn.deepValue(n,u.propertyPath):void 0,u.inverseEntityMetadata,d,void 0)}})}buildOrder(t,n,r,a){for(let o in t){if(t[o]===void 0)continue;const i=a?a+"."+o:o,s=n.findColumnWithPropertyPathStrict(i),c=n.findEmbeddedWithPropertyPath(i),l=n.findRelationWithPropertyPath(i);if(!c&&!s&&!l)throw new Ea(i,n);if(s){let u=typeof t[o]=="object"?t[o].direction:t[o];u=u==="DESC"||u==="desc"||u===-1?"DESC":"ASC";let d=typeof t[o]=="object"?t[o].nulls:void 0;d=(d==null?void 0:d.toLowerCase())==="first"?"NULLS FIRST":(d==null?void 0:d.toLowerCase())==="last"?"NULLS LAST":void 0;let p=`${r}.${i}`;this.addOrderBy(p,u,d)}else if(c)this.buildOrder(t[o],n,r,i);else if(l){let u=r+"_"+i.replace(".","_");u=ve.buildAlias(this.connection.driver,{joiner:"__"},r,u),this.joins.find(d=>d.alias===u)||this.joins.push({type:"left",select:!1,alias:u,parentAlias:r,selection:void 0,relationMetadata:l}),this.buildOrder(t[o],l.inverseEntityMetadata,u)}}}buildWhere(t,n,r,a){let o="";if(Array.isArray(t))t.length&&(o=t.map(i=>this.buildWhere(i,n,r,a)).filter(i=>!!i).map(i=>"("+i+")").join(" OR "));else{let i=[];for(let s in t){if(t[s]===void 0||t[s]===null)continue;const c=a?a+"."+s:s,l=n.findColumnWithPropertyPathStrict(c),u=n.findEmbeddedWithPropertyPath(c),d=n.findRelationWithPropertyPath(c);if(!u&&!l&&!d)throw new Ea(c,n);if(l){let p=`${r}.${c}`;l.isVirtualProperty&&l.query&&(p=`(${l.query(r)})`);let f=t[s];Ct.isEqualOperator(t[s])&&(f=t[s].value),l.transformer&&(f instanceof rd?f.transformValue(l.transformer):f=t_.transformTo(l.transformer,f)),i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(p,f)))}else if(u){const p=this.buildWhere(t[s],n,r,c);p&&i.push(p)}else if(d){if(typeof t[s]=="object"&&Object.keys(t[s]).every(p=>t[s][p]===void 0))continue;if(Ct.isFindOperator(t[s]))if(t[s].type==="moreThan"||t[s].type==="lessThan"||t[s].type==="moreThanOrEqual"||t[s].type==="lessThanOrEqual"){let p="";t[s].type==="moreThan"?p=">":t[s].type==="lessThan"?p="<":t[s].type==="moreThanOrEqual"?p=">=":t[s].type==="lessThanOrEqual"&&(p="<=");const f=this.subQuery();if(d.isManyToManyOwner)f.select("COUNT(*)").from(d.joinTableName,d.joinTableName).where(d.joinColumns.map(y=>`${d.joinTableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else if(d.isManyToManyNotOwner)f.select("COUNT(*)").from(d.inverseRelation.joinTableName,d.inverseRelation.joinTableName).where(d.inverseRelation.inverseJoinColumns.map(y=>`${d.inverseRelation.joinTableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else if(d.isOneToMany)f.select("COUNT(*)").from(d.inverseEntityMetadata.target,d.inverseEntityMetadata.tableName).where(d.inverseRelation.joinColumns.map(y=>`${d.inverseEntityMetadata.tableName}.${y.propertyName} = ${r}.${y.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(f.getSql()+" "+p+" "+parseInt(t[s].value))}else if(d.isManyToOne||d.isOneToOne&&d.isOneToOneOwner){const p=`${r}.${c}`;i.push(this.createWhereConditionExpression(this.getWherePredicateCondition(p,t[s])))}else throw new Error("This relation isn't supported by given find operator");else{let p=r+"_"+d.propertyPath.replace(".","_");p=ve.buildAlias(this.connection.driver,{joiner:"__"},r,p),this.joins.find(y=>y.alias===p)||this.joins.push({type:"left",select:!1,selection:void 0,alias:p,parentAlias:r,relationMetadata:d});const f=this.buildWhere(t[s],d.inverseEntityMetadata,p);f&&i.push(f)}}}o=i.length?"("+i.join(") AND (")+")":i.join(" AND ")}return o.length?"("+o+")":o}}class $4{constructor(){this.generatedMaps=[]}static from(t){const n=new this;return n.raw=t.records,n.affected=t.affected,n}}class Ble extends Ht{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("SoftDeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createUpdateExpression();return t+=this.createCteExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("BeforeSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("BeforeRecover",this.expressionMap.mainAlias.metadata));const r=new n_(t,this.expressionMap);this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=r.getSoftDeletionReturningColumns());const[a,o]=this.getQueryAndParameters(),i=await t.query(a,o,!0),s=$4.from(i);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await r.update(s,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?await t.broadcaster.broadcast("AfterSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&await t.broadcaster.broadcast("AfterRecover",this.expressionMap.mainAlias.metadata)),n&&await t.commitTransaction(),s}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}from(t,n){t=Ct.isEntitySchema(t)?t.options.name:t;const r=this.createFromAlias(t,n);return this.expressionMap.setMainAlias(r),this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new zh;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!t)throw new xe(`Cannot get entity metadata for the given alias "${this.expressionMap.mainAlias}"`);if(!t.deleteDateColumn)throw new ile(t);const n=[];switch(this.expressionMap.queryType){case"soft-delete":n.push(this.escape(t.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":n.push(this.escape(t.deleteDateColumn.databaseName)+" = NULL");break;default:throw new xe('The queryType must be "soft-delete" or "restore"')}if(t.versionColumn&&n.push(this.escape(t.versionColumn.databaseName)+" = "+this.escape(t.versionColumn.databaseName)+" + 1"),t.updateDateColumn&&n.push(this.escape(t.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),n.length<=0)throw new z1;const r=this.createWhereExpression(),a=this.createReturningExpression("update");return a===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")} OUTPUT ${a}${r}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${n.join(", ")}${r} RETURNING ${a}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver))return" LIMIT "+t;throw new g4}return""}}class zle extends Ht{constructor(t,n){super(t,n),this["@instanceof"]=Symbol.for("UpdateQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let t=this.createComment();return t+=this.createCteExpression(),t+=this.createUpdateExpression(),t+=this.createOrderByExpression(),t+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(t.trim())}async execute(){const t=this.obtainQueryRunner();let n=!1;try{this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(await t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("BeforeUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet);let r=null,a=null;const o=new n_(t,this.expressionMap),i=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const p of this.expressionMap.returning)i.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(p));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=o.getUpdationReturningColumns(),i.push(...this.expressionMap.extraReturningColumns.filter(p=>!i.includes(p)))),i.length>0&&this.connection.driver.options.type==="mssql"&&(r=this.connection.driver.buildTableVariableDeclaration("@OutputTable",i),a="SELECT * FROM @OutputTable");const[s,c]=this.getQueryAndParameters(),l=[r,s,a],u=await t.query(l.filter(p=>p!=null).join(`;

`),c,!0),d=$4.from(u);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await o.update(d,this.expressionMap.whereEntities),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&await t.broadcaster.broadcast("AfterUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),n&&await t.commitTransaction(),d}catch(r){if(n)try{await t.rollbackTransaction()}catch{}throw r}finally{t!==this.queryRunner&&await t.release()}}set(t){return this.expressionMap.valuesSet=t,this}where(t,n){this.expressionMap.wheres=[];const r=this.getWhereCondition(t);return r&&(this.expressionMap.wheres=[{type:"simple",condition:r}]),n&&this.setParameters(n),this}andWhere(t,n){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}orWhere(t,n){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(t)}),n&&this.setParameters(n),this}whereInIds(t){return this.where(this.getWhereInIdsCondition(t))}andWhereInIds(t){return this.andWhere(this.getWhereInIdsCondition(t))}orWhereInIds(t){return this.orWhere(this.getWhereInIdsCondition(t))}output(t){return this.returning(t)}returning(t){if(!this.connection.driver.isReturningSqlSupported("update"))throw new zh;return this.expressionMap.returning=t,this}orderBy(t,n="ASC",r){return t?typeof t=="object"?this.expressionMap.orderBys=t:r?this.expressionMap.orderBys={[t]:{order:n,nulls:r}}:this.expressionMap.orderBys={[t]:n}:this.expressionMap.orderBys={},this}addOrderBy(t,n="ASC",r){return r?this.expressionMap.orderBys[t]={order:n,nulls:r}:this.expressionMap.orderBys[t]=n,this}limit(t){return this.expressionMap.limit=t,this}whereEntity(t){if(!this.expressionMap.mainAlias.hasMetadata)throw new xe(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const n=Array.isArray(t)?t:[t];return n.forEach(r=>{const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(r);if(!a)throw new xe("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(a)}),this.expressionMap.whereEntities=n,this}updateEntity(t){return this.expressionMap.updateEntity=t,this}createUpdateExpression(){const t=this.getValueSet(),n=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,r={};for(let c in t)t[c]!==void 0&&(r[c]=t[c]);const a=[],o=[];if(n?(this.createPropertyPath(n,r).forEach(c=>{const l=n.findColumnsWithPropertyPath(c);if(l.length<=0)throw new Ea(c,n);l.forEach(u=>{if(!u.isUpdate||o.includes(u))return;o.push(u);let d=u.getEntityValue(r);if(u.referencedColumn&&typeof d=="object"&&!(d instanceof Date)&&d!==null&&!pa.isBuffer(d)?d=u.referencedColumn.getEntityValue(d):typeof d!="function"&&(d=this.connection.driver.preparePersistentValue(d,u)),typeof d=="function")a.push(this.escape(u.databaseName)+" = "+d());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&d===null)a.push(this.escape(u.databaseName)+" = NULL");else{this.connection.driver.options.type==="mssql"&&(d=this.connection.driver.parametrizeValue(u,d));const p=this.createParameter(d);let f=null;if((ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1){const y=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";u.srid!=null?f=`${y}(${p}, ${u.srid})`:f=`${y}(${p})`}else ve.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?u.srid!=null?f=`ST_SetSRID(ST_GeomFromGeoJSON(${p}), ${u.srid})::${u.type}`:f=`ST_GeomFromGeoJSON(${p})::${u.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?f=u.type+"::STGeomFromText("+p+", "+(u.srid||"0")+")":f=p;a.push(this.escape(u.databaseName)+" = "+f)}})}),(a.length>0||Object.keys(r).length===0)&&(n.versionColumn&&o.indexOf(n.versionColumn)===-1&&a.push(this.escape(n.versionColumn.databaseName)+" = "+this.escape(n.versionColumn.databaseName)+" + 1"),n.updateDateColumn&&o.indexOf(n.updateDateColumn)===-1&&a.push(this.escape(n.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"))):Object.keys(r).map(c=>{let l=r[c];if(typeof l=="function")a.push(this.escape(c)+" = "+l());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&l===null)a.push(this.escape(c)+" = NULL");else{const u=this.createParameter(l);a.push(this.escape(c)+" = "+u)}}),a.length<=0)throw new z1;const i=this.createWhereExpression(),s=this.createReturningExpression("update");return s===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")} OUTPUT ${s}${i}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${a.join(", ")}${i} RETURNING ${s}`}createOrderByExpression(){const t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map(n=>typeof t[n]=="string"?this.replacePropertyNames(n)+" "+t[n]:this.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls).join(", "):""}createLimitExpression(){let t=this.expressionMap.limit;if(t){if(ve.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")return" LIMIT "+t;throw new g4}return""}getValueSet(){if(typeof this.expressionMap.valuesSet=="object")return this.expressionMap.valuesSet;throw new z1}}function Vle(){Ht.registerQueryBuilderClass("DeleteQueryBuilder",e=>new Ele(e)),Ht.registerQueryBuilderClass("InsertQueryBuilder",e=>new kle(e)),Ht.registerQueryBuilderClass("RelationQueryBuilder",e=>new Tle(e)),Ht.registerQueryBuilderClass("SelectQueryBuilder",e=>new a_(e)),Ht.registerQueryBuilderClass("SoftDeleteQueryBuilder",e=>new Ble(e)),Ht.registerQueryBuilderClass("UpdateQueryBuilder",e=>new zle(e))}var F4;(function(e){e.VIEW="VIEW",e.MATERIALIZED_VIEW="MATERIALIZED_VIEW",e.GENERATED_COLUMN="GENERATED_COLUMN"})(F4||(F4={}));var o_={exports:{}},i_,B4;function Ule(){if(B4)return i_;B4=1;var e=1e3,t=e*60,n=t*60,r=n*24,a=r*7,o=r*365.25;i_=function(u,d){d=d||{};var p=typeof u;if(p==="string"&&u.length>0)return i(u);if(p==="number"&&isFinite(u))return d.long?c(u):s(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function i(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var p=parseFloat(d[1]),f=(d[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return p*o;case"weeks":case"week":case"w":return p*a;case"days":case"day":case"d":return p*r;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*t;case"seconds":case"second":case"secs":case"sec":case"s":return p*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function s(u){var d=Math.abs(u);return d>=r?Math.round(u/r)+"d":d>=n?Math.round(u/n)+"h":d>=t?Math.round(u/t)+"m":d>=e?Math.round(u/e)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=r?l(u,d,r,"day"):d>=n?l(u,d,n,"hour"):d>=t?l(u,d,t,"minute"):d>=e?l(u,d,e,"second"):u+" ms"}function l(u,d,p,f){var y=d>=p*1.5;return Math.round(u/p)+" "+f+(y?"s":"")}return i_}var s_,z4;function Wle(){if(z4)return s_;z4=1;function e(t){r.debug=r,r.default=r,r.coerce=l,r.disable=i,r.enable=o,r.enabled=s,r.humanize=Ule(),r.destroy=u,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function n(d){let p=0;for(let f=0;f<d.length;f++)p=(p<<5)-p+d.charCodeAt(f),p|=0;return r.colors[Math.abs(p)%r.colors.length]}r.selectColor=n;function r(d){let p,f=null,y,m;function v(...b){if(!v.enabled)return;const w=v,j=Number(new Date),x=j-(p||j);w.diff=x,w.prev=p,w.curr=j,p=j,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let _=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(S,E)=>{if(S==="%%")return"%";_++;const O=r.formatters[E];if(typeof O=="function"){const M=b[_];S=O.call(w,M),b.splice(_,1),_--}return S}),r.formatArgs.call(w,b),(w.log||r.log).apply(w,b)}return v.namespace=d,v.useColors=r.useColors(),v.color=r.selectColor(d),v.extend=a,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(y!==r.namespaces&&(y=r.namespaces,m=r.enabled(d)),m),set:b=>{f=b}}),typeof r.init=="function"&&r.init(v),v}function a(d,p){const f=r(this.namespace+(typeof p>"u"?":":p)+d);return f.log=this.log,f}function o(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let p;const f=(typeof d=="string"?d:"").split(/[\s,]+/),y=f.length;for(p=0;p<y;p++)f[p]&&(d=f[p].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...r.names.map(c),...r.skips.map(c).map(p=>"-"+p)].join(",");return r.enable(""),d}function s(d){if(d[d.length-1]==="*")return!0;let p,f;for(p=0,f=r.skips.length;p<f;p++)if(r.skips[p].test(d))return!1;for(p=0,f=r.names.length;p<f;p++)if(r.names[p].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return s_=e,s_}var V4;function Hle(){return V4||(V4=1,function(e,t){var n={};t.formatArgs=a,t.save=o,t.load=i,t.useColors=r,t.storage=s(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,p=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(d++,f==="%c"&&(p=d))}),l.splice(p,0,u)}t.log=console.debug||console.log||(()=>{});function o(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function i(){let l;try{l=t.storage.getItem("debug")}catch{}return!l&&typeof Ka<"u"&&"env"in Ka&&(l=n.DEBUG),l}function s(){try{return localStorage}catch{}}e.exports=Wle()(t);const{formatters:c}=e.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(o_,o_.exports)),o_.exports}Hle(),Vle();const U4=(e,t)=>({id:e.id,type:e.node_type,position:{x:e.x||0,y:e.y||0},width:e.width||void 0,height:e.height||void 0,data:{loading:!1,flowNode:e,...t}}),qle=e=>({id:e.id,target:e.target,source:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),W4=e=>({id:e.id,source:e.source,target:e.target,targetHandle:e.targetHandle,sourceHandle:e.sourceHandle}),Kle=e=>e.filter(t=>"edgeId"in t?`${t.edgeId}`.startsWith("xy-edge__"):!1),c_=(e,t,n)=>{const r=[];return{changes:e.map(a=>{var c;const o=t.find(l=>a.id===l.id);o||r.push(a.id);const i=(c=n==null?void 0:n[a.source_type])==null?void 0:c.find(l=>(l==null?void 0:l.id)===a.source_id),s=U4(a,{...o==null?void 0:o.data,entity:i});return{type:o?"replace":"add",id:a.id,item:o?Bh({...o||{},data:void 0},Tu(s,Iu)):s}}),newIds:[]}},l_=(e,t)=>{const n=[],r=[],a=e.map(o=>{const i=t.find(s=>o.source===s.source&&o.target===s.target);return!i||i.id!==o.id?(i&&r.push(i.id),{type:"add",item:W4(o)}):(n.push(o.id),{type:"replace",item:W4(o)})});return t.forEach(o=>{n.includes(o.id)||r.push(o.id)}),{changes:a,updatedIds:n,deletedIds:r}},u_={width:440,height:360},Uh={width:380,height:650},ad={[oe.Toolbox]:"toolbox",[oe.SessionInfo]:"session-info",[oe.DefaultEmbeddingModel]:"default-embedding-model",[oe.ApplicationBar]:"application-bar"},Xle={id:ad[oe.Toolbox],type:oe.Toolbox,position:{x:10+Uh.width+20,y:10},measured:u_,data:{}},Zle={id:ad[oe.SessionInfo],type:oe.SessionInfo,position:{x:10,y:10},measured:Uh,data:{}},Gle={id:ad[oe.DefaultEmbeddingModel],type:oe.DefaultEmbeddingModel,position:{x:10+Uh.width+u_.width+40,y:10},data:{model:wAe}},Qle={id:ad[oe.ApplicationBar],type:oe.ApplicationBar,position:{x:10+Uh.width+u_.width+40,y:80},data:{}},Yle=[Xle,Zle,Gle,Qle],Jle=[oe.Toolbox,oe.SessionInfo,oe.ApplicationBar,oe.EditorApp,oe.CodeContainerApp],H4={flowNodes:[],flowEdges:[],ready:!0,flowEdgeLoading:!1,flowNodeLoading:!1,syncedNodes:[],syncedEdges:[],syncNodeQueue:[],syncEdgeQueue:[],edges:[],nodes:Yle},Wh=async e=>{const t=await ue("FlowNode").find(e),n=t.reduce((a,o)=>{var i;return a[o.source_type]||(a[o.source_type]=[]),(i=a[o.source_type])==null||i.push(o),a},{}),r={};return await Promise.all(Object.entries(n).map(async([a,o])=>{const i=a;r[i]=await ue(i).find({where:{id:Ca(o.map(s=>s.source_id))}})})),{flowNodes:t,entityGroups:n,flowNodeDatas:r}},eue=(e,t)=>({reset:()=>{e(H4)},setNodes:n=>{if(typeof n=="function"){e({nodes:n(t().nodes)});return}e({nodes:n})},setEdges:n=>{if(typeof n=="function"){e({edges:n(t().edges)});return}e({edges:n})},updateNodes:n=>{const r=t().nodes;e({nodes:Ki(n,r)})},updateEdges:n=>{const r=t().edges;e({edges:ed(n,r)})},addConnectionToEdges:n=>{const r=t().edges;e({edges:$3(n,r)})},flowNodesToNodes:(n,r={})=>{const a=t().nodes,{changes:o}=c_(n,a,r);e({nodes:Ki(o,a)})},flowEdgesToEdges:n=>{const r=t().edges,{changes:a,updatedIds:o,deletedIds:i}=l_(n,r);r.forEach(s=>{o.includes(s.id)||i.push(s.id)}),i.forEach(s=>{a.push({type:"remove",id:s})}),e({edges:ed(a,r)})},getNodes:n=>t().nodes.filter(r=>n.includes(r.id)),removeSyncNodeQueue:n=>{const{syncNodeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncNodeQueue:r})},removeSyncEdgeQueue:n=>{const{syncEdgeQueue:r}=t();for(const a of n){const o=r.findIndex(i=>i.timestamp===a);o>-1&&r.splice(o,1)}e({syncEdgeQueue:r})},pushSyncNodeQueue:(n,r)=>{const{syncNodeQueue:a}=t();e({syncNodeQueue:[...a,{query:r,timestamp:Date.now(),syncType:n}]})},pushSyncEdgeQueue:()=>{const{syncEdgeQueue:n}=t();e({syncEdgeQueue:[...n,{timestamp:Date.now()}]})},findFlowNodesWithSource:async(n,r)=>{try{e({flowNodeLoading:!0});const{flowNodes:a,flowNodeDatas:o}=await Wh(n);if(r!=null&&r.clean)e({flowNodes:a,nodes:a.map(i=>{var c;const s=(c=o==null?void 0:o[i.source_type])==null?void 0:c.find(l=>l.id===i.source_id);return U4(i,{data:s})})});else{const i=t().flowNodes,s=a.map(u=>u.id),c=t().nodes,{changes:l}=c_(a,c,o);e({flowNodes:[...i.filter(u=>!s.includes(u.id)),...a],nodes:Ki(l,c)})}return a}finally{e({flowNodeLoading:!1})}},findFlowEdges:async(n,r)=>{try{e({flowEdgeLoading:!0});const a=await ue("FlowEdge").find(n),o=t().flowEdges,i=a.map(s=>s.id);if(r!=null&&r.clean)e({flowEdges:a,edges:a.map(s=>qle(s))});else{const s=t().edges,{changes:c}=l_(a,s);e({flowEdges:[...o.filter(l=>!i.includes(l.id)),...a],edges:ed(c,s)})}return a}finally{e({flowEdgeLoading:!1})}},deleteFlowNode:async n=>{try{if(!n.id&&!n.source_type&&!n.source_id)throw new Error("Missing flow node indentify");const r=await ue("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}});if(r){await ue("FlowNode").delete(r.id);const a=t().flowNodes;r.source_type&&r.source_id&&await ue(r.source_type).delete(r.source_id).catch(i=>{zo("Failed to delete source entity",r.source_type,r.source_id,i)});const o=t().nodes;e({flowNodes:a.filter(i=>i.id!==r.id),nodes:Ki([{type:"remove",id:r.id}],o)})}}catch(r){zo("Failed to delete flow node",r)}},deleteFlowEdge:async n=>{try{if(!n.id&&!n.source&&!n.target)throw new Error("Missing flow edge indentify");const r=await ue("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}});if(r){await ue("FlowEdge").delete(r.id);const a=t().flowEdges;e({flowEdges:a.filter(o=>o.id!==r.id)})}}catch(r){zo("Failed to delete flow edge",r)}},updateFlowNode:async(n,r)=>{var a;try{if(!((a=Je.getState().currentSession)!=null&&a.id))throw new Error("Session not found");if(!n.id)throw new Error("Missing flow node indentify");await ue("FlowNode").update(n.id,n);const o=t().flowNodes.map(i=>i.id===n.id?{...i,...n}:i);e({flowNodes:r!=null&&r.silent?o:[...o]})}catch(o){zo("Failed to create or update flow node",o,n)}},createOrUpdateFlowNode:async(n,r)=>{var a;try{const o=Je.getState().currentSession;if(!(o!=null&&o.id))throw new Error("Session not found");if(!n.id&&(!n.source_type||!n.source_id))throw new Error("Missing flow node indentify");let i,s=n!=null&&n.id?t().flowNodes.find(f=>f.id===n.id):void 0;if(!s&&(n.id||n.source_type&&n.source_id)&&(s=await ue("FlowNode").findOne({where:n.id?{id:n.id}:{source_type:n.source_type,source_id:n.source_id}})),s)i=Bh(s,Tu(n,Iu)),r!=null&&r.lazy?ue("FlowNode").update(s.id,i):await ue("FlowNode").update(s.id,i);else if(n.source_id&&n.source_type)i={...n,source_id:`${n.source_id}`,source_type:`${n.source_type}`,node_type:n.node_type||"NEW_MESSAGE",session_id:n.session_id||(o==null?void 0:o.id)},r!=null&&r.lazy?(i.id=Oi(),ue("FlowNode").save(i)):i=await ue("FlowNode").save(i);else throw new Error("Missing source id and type");let c;const l=t().nodes.find(f=>f.id===i.id);i.source_type&&!l?c=await ue(i.source_type).findOne({where:{id:n.source_id}}):i.source_type&&l&&(c=(a=l==null?void 0:l.data)==null?void 0:a.entity);const u=t().flowNodes,d=t().nodes,{changes:p}=c_([i],d,{[i.source_type]:[c]});return e({flowNodes:[...u.filter(f=>f.id!==i.id),i],nodes:Ki(p,d)}),i}catch(o){zo("Failed to create or update flow node",o,n)}},createOrUpdateFlowEdge:async(n,r)=>{try{const a=Je.getState().currentSession;if(!(a!=null&&a.id))throw new Error("Session not found");if(!n.id&&(!n.source||!n.target))throw new Error("Missing flow node indentify");let o,i=n!=null&&n.id?t().flowEdges.find(l=>l.id===n.id):void 0;if(i&&(n.id||n.source&&n.target)&&(i=await ue("FlowEdge").findOne({where:n.id?{id:n.id}:{source:n.source,target:n.target}})),i)o=Bh(i,Tu(n,Iu)),r!=null&&r.lazy?ue("FlowEdge").update(i.id,o):await ue("FlowEdge").update(i.id,o);else if(n.source&&n.target)o={...n,source:`${n.source}`,target:`${n.target}`,session_id:n.session_id||(a==null?void 0:a.id)},r!=null&&r.lazy?(o.id=Oi(),ue("FlowEdge").save(o)):o=await ue("FlowEdge").save(o);else throw new Error("Missing source and target");const s=t().flowEdges,c=t().edges;return e({flowEdges:[...s.filter(l=>l.id!==o.id),o],edges:ed(l_([o],c).changes,c)}),o}catch(a){zo("Failed to create or update flow node",a)}}}),Hh=()=>{const e=Wa(t=>t.loadModel);return{loadModel:async(t,...n)=>{switch(t){case nn.WebLLM:return e(...n);case nn.OpenAI:break;default:throw new Error("Unsupported provider")}}}},tue=()=>{var S,E;const[e,t]=g.useState(),[n,r]=g.useState(),[a,o]=g.useState(),[i,s]=g.useState([]),[c,l]=g.useState(),u=g.useRef(),d=g.useRef({}),p=Je(O=>O.currentSession),{loadModel:f}=Hh(),y=g.useCallback(async O=>{var N;if(!p)return;const M=await ue("JSONData").findOne({where:{id:O.source_id,session_id:p==null?void 0:p.id}});M&&((N=u.current)==null||N.call(u,M.data?M.data:[]),l({node:O,enity:M}))},[p]),m=g.useCallback(async O=>{var T;const M=(O==null?void 0:O.sessionId)||(p==null?void 0:p.id),N=(O==null?void 0:O.threadNode)||(n==null?void 0:n.threadNode),P=(O==null?void 0:O.prompts)||(e==null?void 0:e.prompts);if(!M||!(N!=null&&N.id))return;const I=P==null?void 0:P.map(A=>{if(A.type!=="few_shot_example")switch(A.role){case"ai":case"assistant":case"tool":return{id:A.id,content:A.content,role:"assistant"};case"system":return{id:A.id,content:A.content,role:"system"};default:return{id:A.id,content:A.content,role:"user"}}}).filter(Boolean),k=await ue("JSONData").save({headers:"item",session_id:M,json:"",data:I});if(!k)return;const C=await ue("FlowNode").save({session_id:M,source_id:k.id,source_type:"JSONData",node_type:"JSON_DATA",x:0,y:0});if(C)return await ue("FlowEdge").save({session_id:M,source:N.id,target:C.id}),(T=u.current)==null||T.call(u,I),l({node:C,enity:k}),{jsonData:k,jsonDataNode:C}},[e==null?void 0:e.prompts,p==null?void 0:p.id,n==null?void 0:n.threadNode]),v=g.useCallback(async(O,M)=>{if(!p)return;const N=await ue("FlowEdge").findOne({where:{session_id:p.id,source:O.id},order:{id:"DESC"}});if(N){const P=await ue("FlowNode").findOne({where:{id:N.target,session_id:p.id}});if(!P)return;await y(P)}else if(!await m({sessionId:p.id,threadNode:O,prompts:M||[]}))return},[m,p,y]),b=g.useCallback(async O=>{if(O!=null&&O.length&&(p!=null&&p.id)){const M=(await Promise.all(O.map(async N=>ue("FlowEdge").find({where:{target:N.source.id}}).then(P=>Wh({where:{session_id:p.id,id:Ca(P.map(I=>I.source))}}).then(I=>({...I,...N})))))).map(N=>{var T,A,D,L;const P=N.flowNodes.find(R=>R.source_type==="Prompt"),I=N.flowNodes.find(R=>R.source_type==="VectorDatabase");if(!I||!P)return;const k=(A=(T=N.flowNodeDatas)==null?void 0:T.Prompt)==null?void 0:A.find(R=>R.id===P.source_id),C=(L=(D=N.flowNodeDatas)==null?void 0:D.VectorDatabase)==null?void 0:L.find(R=>R.id===I.source_id);return{promptNode:P,vectorDatabaseNode:I,placeholderNode:N.source,placeholderEntity:N.entity,promptEntity:k,vectorDatabaseEntity:C}}).filter(Boolean);s(M)}},[p==null?void 0:p.id]),w=g.useCallback(async()=>{try{if(d.current.handling=p==null?void 0:p.id,!(p!=null&&p.id)||!(p!=null&&p.main_source_id)||(p==null?void 0:p.main_source_type)!=="Thread")return;const[O,M]=await Promise.all([ue("Thread").findOne({where:{id:p.main_source_id,session_id:p.id}}),ue("FlowNode").findOne({where:{id:p.main_node_id}})]);if(!O||!M)return;const N=await ue("FlowEdge").find({where:{session_id:p.id,target:M.id}}),{flowNodes:P,flowNodeDatas:I}=await Wh({where:{session_id:p.id,id:Ca(N.map(R=>R.source))}}),k=(await ue("FlowEdge").find({where:{session_id:p.id}})).filter(R=>R.target===M.id).map(R=>{var z;const B=P.find($=>$.id===R.source);return{connection:R,source:B,entity:(z=I==null?void 0:I[B.source_type])==null?void 0:z.find($=>$.id===B.source_id)}}),C=k.find(R=>R.source.source_type==="LLM"),T=k.filter(R=>R.source.source_type==="Prompt"),A=k.find(R=>R.source.source_type==="Schema");if(!(C!=null&&C.entity))return;const D=k.filter(R=>R.source.source_type==="FlowNodePlaceholder");await b(D),await v(M,(T==null?void 0:T.map(R=>R.entity))||[]),o({llm:C.entity,status:Ge.Started,progress:""}),r({thread:O,threadNode:M});const L=A==null?void 0:A.entity;if(L){const R=await ue("SchemaItem").find({where:{schema_id:L.id}});L.schema_items=R||[]}t({prompts:(T==null?void 0:T.map(R=>R.entity))||[],schema:L}),d.current.handled=p.id}finally{d.current.handling=void 0}},[p==null?void 0:p.id,p==null?void 0:p.main_node_id,p==null?void 0:p.main_source_id,p==null?void 0:p.main_source_type,b,v]),j=g.useCallback(async()=>{var O;if((O=a==null?void 0:a.llm)!=null&&O.name)try{o(M=>M&&{...M,status:Ge.Loading}),await f(a.llm.provider,a==null?void 0:a.llm.name,M=>{o(N=>N&&{...N,progress:M.text})}),o(M=>M&&{...M,status:Ge.Loaded,progress:""})}catch{o(M=>M&&{...M,status:Ge.Started,progress:""})}},[(S=a==null?void 0:a.llm)==null?void 0:S.name,(E=a==null?void 0:a.llm)==null?void 0:E.provider,f]),x=g.useCallback(O=>(u.current=O,()=>{u.current=void 0}),[]),_=g.useCallback(async O=>{!(c!=null&&c.node)||!(c!=null&&c.enity)||await ue("JSONData").save({...c.enity,data:O})},[c==null?void 0:c.enity,c==null?void 0:c.node]);return g.useEffect(()=>{d.current.handling||(d==null?void 0:d.current.handled)===(p==null?void 0:p.id)||w()},[p==null?void 0:p.id,w]),{...e,loadLLM:j,threadInfo:n,mainLLMInfo:a,retriverInfo:i,currentDataNode:c,updateMessagesData:_,addNewDataNode:m,selectDataNode:y,onThreadMessagesLoaded:x}};class nue extends Lp{get lc_attributes(){return{partialVariables:void 0}}constructor(t){super(t),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:n}=t;if(n.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,t)}async mergePartialAndUserVariables(t){const n=this.partialVariables??{},r={};for(const[a,o]of Object.entries(n))typeof o=="string"?r[a]=o:r[a]=await o();return{...r,...t}}async invoke(t,n){return this._callWithConfig(r=>this.formatPromptValue(r),t,{...n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(t){switch(t._type){case"prompt":{const{PromptTemplate:n}=await At(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>rL);return{PromptTemplate:r}},[]);return n.deserialize(t)}case void 0:{const{PromptTemplate:n}=await At(async()=>{const{PromptTemplate:r}=await Promise.resolve().then(()=>rL);return{PromptTemplate:r}},void 0);return n.deserialize({...t,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:n}=await At(async()=>{const{FewShotPromptTemplate:r}=await import("./few_shot-CMBL7DSO.js").then(async a=>(await a.__tla,a));return{FewShotPromptTemplate:r}},__vite__mapDeps([0,1,2,3,4]));return n.deserialize(t)}default:throw new Error(`Invalid prompt type in config: ${t._type}`)}}}class q4 extends xAe{}class K4 extends q4{static lc_name(){return"StringPromptValue"}constructor(t){super({value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=t}toString(){return this.value}toChatMessages(){return[new Pr(this.value)]}}class rue extends q4{static lc_name(){return"ChatPromptValue"}constructor(t){Array.isArray(t)&&(t={messages:t}),super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=t.messages}toString(){return _Ae(this.messages)}toChatMessages(){return this.messages}}lM=class extends nue{async formatPromptValue(e){const t=await this.format(e);return new K4(t)}};var aue=Object.prototype.toString,yc=Array.isArray||function(e){return aue.call(e)==="[object Array]"};function d_(e){return typeof e=="function"}function oue(e){return yc(e)?"array":typeof e}function p_(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function X4(e,t){return e!=null&&typeof e=="object"&&t in e}function iue(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var sue=RegExp.prototype.test;function cue(e,t){return sue.call(e,t)}var lue=/\S/;function uue(e){return!cue(lue,e)}var due={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function pue(e){return String(e).replace(/[&<>"'`=\/]/g,function(t){return due[t]})}var fue=/\s*/,hue=/\s+/,Z4=/\s*=/,mue=/\s*\}/,yue=/#|\^|\/|>|\{|&|=|!/;function gue(e,t){if(!e)return[];var n=!1,r=[],a=[],o=[],i=!1,s=!1,c="",l=0;function u(){if(i&&!s)for(;o.length;)delete a[o.pop()];else o=[];i=!1,s=!1}var d,p,f;function y(O){if(typeof O=="string"&&(O=O.split(hue,2)),!yc(O)||O.length!==2)throw new Error("Invalid tags: "+O);d=new RegExp(p_(O[0])+"\\s*"),p=new RegExp("\\s*"+p_(O[1])),f=new RegExp("\\s*"+p_("}"+O[1]))}y(t||Wn.tags);for(var m=new od(e),v,b,w,j,x,_;!m.eos();){if(v=m.pos,w=m.scanUntil(d),w)for(var S=0,E=w.length;S<E;++S)j=w.charAt(S),uue(j)?(o.push(a.length),c+=j):(s=!0,n=!0,c+=" "),a.push(["text",j,v,v+1]),v+=1,j===`
`&&(u(),c="",l=0,n=!1);if(!m.scan(d))break;if(i=!0,b=m.scan(yue)||"name",m.scan(fue),b==="="?(w=m.scanUntil(Z4),m.scan(Z4),m.scanUntil(p)):b==="{"?(w=m.scanUntil(f),m.scan(mue),m.scanUntil(p),b="&"):w=m.scanUntil(p),!m.scan(p))throw new Error("Unclosed tag at "+m.pos);if(b==">"?x=[b,w,v,m.pos,c,l,n]:x=[b,w,v,m.pos],l++,a.push(x),b==="#"||b==="^")r.push(x);else if(b==="/"){if(_=r.pop(),!_)throw new Error('Unopened section "'+w+'" at '+v);if(_[1]!==w)throw new Error('Unclosed section "'+_[1]+'" at '+v)}else b==="name"||b==="{"||b==="&"?s=!0:b==="="&&y(w)}if(u(),_=r.pop(),_)throw new Error('Unclosed section "'+_[1]+'" at '+m.pos);return bue(vue(a))}function vue(e){for(var t=[],n,r,a=0,o=e.length;a<o;++a)n=e[a],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function bue(e){for(var t=[],n=t,r=[],a,o,i=0,s=e.length;i<s;++i)switch(a=e[i],a[0]){case"#":case"^":n.push(a),r.push(a),n=a[4]=[];break;case"/":o=r.pop(),o[5]=a[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(a)}return t}function od(e){this.string=e,this.tail=e,this.pos=0}od.prototype.eos=function(){return this.tail===""},od.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},od.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n};function gc(e,t){this.view=e,this.cache={".":this.view},this.parent=t}gc.prototype.push=function(e){return new gc(e,this)},gc.prototype.lookup=function(e){var t=this.cache,n;if(t.hasOwnProperty(e))n=t[e];else{for(var r=this,a,o,i,s=!1;r;){if(e.indexOf(".")>0)for(a=r.view,o=e.split("."),i=0;a!=null&&i<o.length;)i===o.length-1&&(s=X4(a,o[i])||iue(a,o[i])),a=a[o[i++]];else a=r.view[e],s=X4(r.view,e);if(s){n=a;break}r=r.parent}t[e]=n}return d_(n)&&(n=n.call(this.view)),n};function Dn(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Dn.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()},Dn.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||Wn.tags).join(":"),a=typeof n<"u",o=a?n.get(r):void 0;return o==null&&(o=gue(e,t),a&&n.set(r,o)),o},Dn.prototype.render=function(e,t,n,r){var a=this.getConfigTags(r),o=this.parse(e,a),i=t instanceof gc?t:new gc(t,void 0);return this.renderTokens(o,i,n,e,r)},Dn.prototype.renderTokens=function(e,t,n,r,a){for(var o="",i,s,c,l=0,u=e.length;l<u;++l)c=void 0,i=e[l],s=i[0],s==="#"?c=this.renderSection(i,t,n,r,a):s==="^"?c=this.renderInverted(i,t,n,r,a):s===">"?c=this.renderPartial(i,t,n,a):s==="&"?c=this.unescapedValue(i,t):s==="name"?c=this.escapedValue(i,t,a):s==="text"&&(c=this.rawValue(i)),c!==void 0&&(o+=c);return o},Dn.prototype.renderSection=function(e,t,n,r,a){var o=this,i="",s=t.lookup(e[1]);function c(d){return o.render(d,t,n,a)}if(s){if(yc(s))for(var l=0,u=s.length;l<u;++l)i+=this.renderTokens(e[4],t.push(s[l]),n,r,a);else if(typeof s=="object"||typeof s=="string"||typeof s=="number")i+=this.renderTokens(e[4],t.push(s),n,r,a);else if(d_(s)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");s=s.call(t.view,r.slice(e[3],e[5]),c),s!=null&&(i+=s)}else i+=this.renderTokens(e[4],t,n,r,a);return i}},Dn.prototype.renderInverted=function(e,t,n,r,a){var o=t.lookup(e[1]);if(!o||yc(o)&&o.length===0)return this.renderTokens(e[4],t,n,r,a)},Dn.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),a=e.split(`
`),o=0;o<a.length;o++)a[o].length&&(o>0||!n)&&(a[o]=r+a[o]);return a.join(`
`)},Dn.prototype.renderPartial=function(e,t,n,r){if(n){var a=this.getConfigTags(r),o=d_(n)?n(e[1]):n[e[1]];if(o!=null){var i=e[6],s=e[5],c=e[4],l=o;s==0&&c&&(l=this.indentPartial(o,c,i));var u=this.parse(l,a);return this.renderTokens(u,t,n,l,r)}}},Dn.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(n!=null)return n},Dn.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||Wn.escape,a=t.lookup(e[1]);if(a!=null)return typeof a=="number"&&r===Wn.escape?String(a):r(a)},Dn.prototype.rawValue=function(e){return e[1]},Dn.prototype.getConfigTags=function(e){return yc(e)?e:e&&typeof e=="object"?e.tags:void 0},Dn.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!yc(e))return e.escape};var Wn={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){id.templateCache=e},get templateCache(){return id.templateCache}},id=new Dn;Wn.clearCache=function(){return id.clearCache()},Wn.parse=function(e,t){return id.parse(e,t)},Wn.render=function(e,t,n,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+oue(e)+'" was given as the first argument for mustache#render(template, view, partials)');return id.render(e,t,n,r)},Wn.escape=pue,Wn.Scanner=od,Wn.Context=gc,Wn.Writer=Dn;function G4(){Wn.escape=e=>e}let f_,Q4,Y4,J4,eL,qh,tL,nL;f_=e=>{const t=e.split(""),n=[],r=(o,i)=>{for(let s=i;s<t.length;s+=1)if(o.includes(t[s]))return s;return-1};let a=0;for(;a<t.length;)if(t[a]==="{"&&a+1<t.length&&t[a+1]==="{")n.push({type:"literal",text:"{"}),a+=2;else if(t[a]==="}"&&a+1<t.length&&t[a+1]==="}")n.push({type:"literal",text:"}"}),a+=2;else if(t[a]==="{"){const o=r("}",a);if(o<0)throw new Error("Unclosed '{' in template.");n.push({type:"variable",name:t.slice(a+1,o).join("")}),a=o+1}else{if(t[a]==="}")throw new Error("Single '}' in template.");{const o=r("{}",a),i=(o<0?t.slice(a):t.slice(a,o)).join("");n.push({type:"literal",text:i}),a=o<0?t.length:o}}return n},Q4=e=>e.map(t=>t[0]==="name"?{type:"variable",name:t[1].includes(".")?t[1].split(".")[0]:t[1]}:["#","&","^",">"].includes(t[0])?{type:"variable",name:t[1]}:{type:"literal",text:t[1]}),Y4=e=>{G4();const t=Wn.parse(e);return Q4(t)},J4=(e,t)=>f_(e).reduce((n,r)=>{if(r.type==="variable"){if(r.name in t)return n+t[r.name];throw new Error(`(f-string) Missing value for input ${r.name}`)}return n+r.text},""),eL=(e,t)=>(G4(),Wn.render(e,t)),qh={"f-string":J4,mustache:eL},tL={"f-string":f_,mustache:Y4},Ns=(e,t,n)=>qh[t](e,n),nL=(e,t)=>tL[t](e),uM=(e,t,n)=>{if(!(t in qh)){const r=Object.keys(qh);throw new Error(`Invalid template format. Got \`${t}\`;
                         should be one of ${r}`)}try{const r=n.reduce((a,o)=>(a[o]="foo",a),{});Array.isArray(e)?e.forEach(a=>{if(a.type==="text")Ns(a.text,t,r);else if(a.type==="image_url")if(typeof a.image_url=="string")Ns(a.image_url,t,r);else{const o=a.image_url.url;Ns(o,t,r)}else throw new Error(`Invalid message template received. ${JSON.stringify(a,null,2)}`)}):Ns(e,t,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}},Ho=class extends lM{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),uM(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return Ns(this.template,this.templateFormat,t)}static fromExamples(e,t,n,r=`

`,a=""){const o=[a,...e,t].join(r);return new Ho({inputVariables:n,template:o})}static fromTemplate(e,t){const{templateFormat:n="f-string",...r}=t??{},a=new Set;return nL(e,n).forEach(o=>{o.type==="variable"&&a.add(o.name)}),new Ho({inputVariables:[...a],templateFormat:n,template:e,...r})}async partial(e){const t=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new Ho(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new Ho({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}};const rL=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:Ho},Symbol.toStringTag,{value:"Module"})),h_="RFC3986",m_={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},wue="RFC1738",xue=Array.isArray,Na=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),y_=1024,_ue=(e,t,n,r,a)=>{if(e.length===0)return e;let o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(s){return"%26%23"+parseInt(s.slice(2),16)+"%3B"});let i="";for(let s=0;s<o.length;s+=y_){const c=o.length>=y_?o.slice(s,s+y_):o,l=[];for(let u=0;u<c.length;++u){let d=c.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||a===wue&&(d===40||d===41)){l[l.length]=c.charAt(u);continue}if(d<128){l[l.length]=Na[d];continue}if(d<2048){l[l.length]=Na[192|d>>6]+Na[128|d&63];continue}if(d<55296||d>=57344){l[l.length]=Na[224|d>>12]+Na[128|d>>6&63]+Na[128|d&63];continue}u+=1,d=65536+((d&1023)<<10|c.charCodeAt(u)&1023),l[l.length]=Na[240|d>>18]+Na[128|d>>12&63]+Na[128|d>>6&63]+Na[128|d&63]}i+=l.join("")}return i};function jue(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function aL(e,t){if(xue(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const Sue=Object.prototype.hasOwnProperty,oL={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},Ma=Array.isArray,Eue=Array.prototype.push,iL=function(e,t){Eue.apply(e,Ma(t)?t:[t])},Oue=Date.prototype.toISOString,an={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:_ue,encodeValuesOnly:!1,format:h_,formatter:m_[h_],indices:!1,serializeDate(e){return Oue.call(e)},skipNulls:!1,strictNullHandling:!1};function Cue(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const g_={};function sL(e,t,n,r,a,o,i,s,c,l,u,d,p,f,y,m,v,b){let w=e,j=b,x=0,_=!1;for(;(j=j.get(g_))!==void 0&&!_;){const N=j.get(e);if(x+=1,typeof N<"u"){if(N===x)throw new RangeError("Cyclic object value");_=!0}typeof j.get(g_)>"u"&&(x=0)}if(typeof l=="function"?w=l(t,w):w instanceof Date?w=p==null?void 0:p(w):n==="comma"&&Ma(w)&&(w=aL(w,function(N){return N instanceof Date?p==null?void 0:p(N):N})),w===null){if(o)return c&&!m?c(t,an.encoder,v,"key",f):t;w=""}if(Cue(w)||jue(w)){if(c){const N=m?t:c(t,an.encoder,v,"key",f);return[(y==null?void 0:y(N))+"="+(y==null?void 0:y(c(w,an.encoder,v,"value",f)))]}return[(y==null?void 0:y(t))+"="+(y==null?void 0:y(String(w)))]}const S=[];if(typeof w>"u")return S;let E;if(n==="comma"&&Ma(w))m&&c&&(w=aL(w,c)),E=[{value:w.length>0?w.join(",")||null:void 0}];else if(Ma(l))E=l;else{const N=Object.keys(w);E=u?N.sort(u):N}const O=s?String(t).replace(/\./g,"%2E"):String(t),M=r&&Ma(w)&&w.length===1?O+"[]":O;if(a&&Ma(w)&&w.length===0)return M+"[]";for(let N=0;N<E.length;++N){const P=E[N],I=typeof P=="object"&&typeof P.value<"u"?P.value:w[P];if(i&&I===null)continue;const k=d&&s?P.replace(/\./g,"%2E"):P,C=Ma(w)?typeof n=="function"?n(M,k):M:M+(d?"."+k:"["+k+"]");b.set(e,x);const T=new WeakMap;T.set(g_,b),iL(S,sL(I,C,n,r,a,o,i,s,n==="comma"&&m&&Ma(w)?null:c,l,u,d,p,f,y,m,v,T))}return S}function Nue(e=an){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||an.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=h_;if(typeof e.format<"u"){if(!Sue.call(m_,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=m_[n];let a=an.filter;(typeof e.filter=="function"||Ma(e.filter))&&(a=e.filter);let o;if(e.arrayFormat&&e.arrayFormat in oL?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=an.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:an.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:an.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:an.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:an.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?an.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:an.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:an.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:an.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:an.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:an.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:an.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:an.strictNullHandling}}function Mue(e,t={}){let n=e;const r=Nue(t);let a,o;typeof r.filter=="function"?(o=r.filter,n=o("",n)):Ma(r.filter)&&(o=r.filter,a=o);const i=[];if(typeof n!="object"||n===null)return"";const s=oL[r.arrayFormat],c=s==="comma"&&r.commaRoundTrip;a||(a=Object.keys(n)),r.sort&&a.sort(r.sort);const l=new WeakMap;for(let p=0;p<a.length;++p){const f=a[p];r.skipNulls&&n[f]===null||iL(i,sL(n[f],f,s,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const u=i.join(r.delimiter);let d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const vc="4.78.1";let cL=!1,sd,lL,uL,v_,dL,pL,fL,hL,mL;function Pue(e,t={auto:!1}){if(cL)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(sd)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${sd}'\``);cL=t.auto,sd=e.kind,lL=e.fetch,uL=e.FormData,v_=e.File,dL=e.ReadableStream,pL=e.getMultipartRequestOptions,fL=e.getDefaultAgent,hL=e.fileFromPath,mL=e.isFsReadStream}class kue{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function Aue({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,a,o;try{n=fetch,r=Request,a=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,s)=>({...s,body:new kue(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}sd||Pue(Aue(),{auto:!0});class et extends Error{}class wn extends et{constructor(t,n,r,a){super(`${wn.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=n;const o=n;this.code=o==null?void 0:o.code,this.param=o==null?void 0:o.param,this.type=o==null?void 0:o.type}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t||!a)return new Kh({message:r,cause:__(n)});const o=n==null?void 0:n.error;return t===400?new yL(t,o,r,a):t===401?new gL(t,o,r,a):t===403?new vL(t,o,r,a):t===404?new bL(t,o,r,a):t===409?new wL(t,o,r,a):t===422?new xL(t,o,r,a):t===429?new _L(t,o,r,a):t>=500?new jL(t,o,r,a):new wn(t,o,r,a)}}class wr extends wn{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Kh extends wn{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class Xh extends Kh{constructor({message:t}={}){super({message:t??"Request timed out."})}}class yL extends wn{}class gL extends wn{}class vL extends wn{}class bL extends wn{}class wL extends wn{}class xL extends wn{}class _L extends wn{}class jL extends wn{}class SL extends et{constructor(){super("Could not parse response content as the length limit was reached")}}class EL extends et{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Gi{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let n=this.decodeText(t);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=Gi.NEWLINE_CHARS.has(n[n.length-1]||"");let a=n.split(Gi.NEWLINE_REGEXP);return r&&a.pop(),a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof pa<"u"){if(t instanceof pa)return t.toString();if(t instanceof Uint8Array)return pa.from(t).toString();throw new et(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new et(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new et("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}Gi.NEWLINE_CHARS=new Set([`
`,"\r"]),Gi.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Pa{constructor(t,n){this.iterator=t,this.controller=n}static fromSSEResponse(t,n){let r=!1;async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const i of Tue(t,n))if(!o){if(i.data.startsWith("[DONE]")){o=!0;continue}if(i.event===null){let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(s&&s.error)throw new wn(void 0,s.error,void 0,void 0);yield s}else{let s;try{s=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new wn(void 0,s.error,s.message,void 0);yield{event:i.event,data:s}}}o=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{o||n.abort()}}return new Pa(a,n)}static fromReadableStream(t,n){let r=!1;async function*a(){const i=new Gi,s=OL(t);for await(const c of s)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*o(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const s of a())i||s&&(yield JSON.parse(s));i=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{i||n.abort()}}return new Pa(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new Pa(()=>a(t),this.controller),new Pa(()=>a(n),this.controller)]}toReadableStream(){const t=this;let n;const r=new TextEncoder;return new dL({async start(){n=t[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:i}=await n.next();if(i)return a.close();const s=r.encode(JSON.stringify(o)+`
`);a.enqueue(s)}catch(o){a.error(o)}},async cancel(){var a;await((a=n.return)==null?void 0:a.call(n))}})}}async function*Tue(e,t){if(!e.body)throw t.abort(),new et("Attempted to iterate over a response with no body");const n=new Due,r=new Gi,a=OL(e.body);for await(const o of Iue(a))for(const i of r.decode(o)){const s=n.decode(i);s&&(yield s)}for(const o of r.flush()){const i=n.decode(o);i&&(yield i)}}async function*Iue(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let a=new Uint8Array(t.length+r.length);a.set(t),a.set(r,t.length),t=a;let o;for(;(o=Rue(t))!==-1;)yield t.slice(0,o),t=t.slice(o)}t.length>0&&(yield t)}function Rue(e){for(let t=0;t<e.length-2;t++){if(e[t]===10&&e[t+1]===10||e[t]===13&&e[t+1]===13)return t+2;if(e[t]===13&&e[t+1]===10&&t+3<e.length&&e[t+2]===13&&e[t+3]===10)return t+4}return-1}class Due{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,r,a]=Lue(t,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function Lue(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function OL(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const CL=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",NL=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Zh(e),Zh=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",$ue=e=>NL(e)||CL(e)||mL(e);async function ML(e,t,n){var a;if(e=await e,NL(e))return e;if(CL(e)){const o=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=Zh(o)?[await o.arrayBuffer()]:[o];return new v_(i,t,n)}const r=await Fue(e);if(t||(t=zue(e)??"unknown_file"),!(n!=null&&n.type)){const o=(a=r[0])==null?void 0:a.type;typeof o=="string"&&(n={...n,type:o})}return new v_(r,t,n)}async function Fue(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Zh(e))t.push(await e.arrayBuffer());else if(Vue(e))for await(const r of e)t.push(r);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(n=e==null?void 0:e.constructor)==null?void 0:n.name}; props: ${Bue(e)}`);return t}function Bue(e){return`[${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}function zue(e){var t;return b_(e.name)||b_(e.filename)||((t=b_(e.path))==null?void 0:t.split(/[\\/]/).pop())}const b_=e=>{if(typeof e=="string")return e;if(typeof pa<"u"&&e instanceof pa)return String(e)},Vue=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",PL=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",bc=async e=>{const t=await Uue(e.body);return pL(t,e)},Uue=async e=>{const t=new uL;return await Promise.all(Object.entries(e||{}).map(([n,r])=>w_(t,n,r))),t},w_=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if($ue(n)){const r=await ML(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>w_(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>w_(e,`${t}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var wc={},Wue=function(e,t,n,r,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n},Hue=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Gh;async function kL(e){const{response:t}=e;if(e.options.stream)return xc("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Pa.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n!=null&&n.includes("application/json")||n!=null&&n.includes("application/vnd.api+json")){const a=await t.json();return xc("response",t.status,t.url,t.headers,a),AL(a,t)}const r=await t.text();return xc("response",t.status,t.url,t.headers,r),r}function AL(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class Qh extends Promise{constructor(t,n=kL){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n}_thenUnwrap(t){return new Qh(this.responsePromise,async n=>AL(t(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class que{constructor({baseURL:t,maxRetries:n=2,timeout:r=6e5,httpAgent:a,fetch:o}){this.baseURL=t,this.maxRetries=x_("maxRetries",n),this.timeout=x_("timeout",r),this.httpAgent=a,this.fetch=o??lL}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Yue(),...this.authHeaders(t)}}validateHeaders(t,n){}defaultIdempotencyKey(){return`stainless-node-retry-${nde()}`}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,r){return this.request(Promise.resolve(r).then(async a=>{const o=a&&Zh(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:t,path:n,...a,body:o}}))}getAPIList(t,n,r){return this.requestAPIList(n,{method:"get",path:t,...r})}calculateContentLength(t){if(typeof t=="string"){if(typeof pa<"u")return pa.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t,{retryCount:n=0}={}){var y;const{method:r,path:a,query:o,headers:i={}}=t,s=ArrayBuffer.isView(t.body)||t.__binaryRequest&&typeof t.body=="string"?t.body:PL(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,c=this.calculateContentLength(s),l=this.buildURL(a,o);"timeout"in t&&x_("timeout",t.timeout);const u=t.timeout??this.timeout,d=t.httpAgent??this.httpAgent??fL(l),p=u+1e3;typeof((y=d==null?void 0:d.options)==null?void 0:y.timeout)=="number"&&p>(d.options.timeout??0)&&(d.options.timeout=p),this.idempotencyHeader&&r!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=t.idempotencyKey);const f=this.buildHeaders({options:t,headers:i,contentLength:c,retryCount:n});return{req:{method:r,...s&&{body:s},headers:f,...d&&{agent:d},signal:t.signal??null},url:l,timeout:u}}buildHeaders({options:t,headers:n,contentLength:r,retryCount:a}){const o={};r&&(o["content-length"]=r);const i=this.defaultHeaders(t);return FL(o,i),FL(o,n),PL(t.body)&&sd!=="node"&&delete o["content-type"],BL(i,"x-stainless-retry-count")===void 0&&BL(n,"x-stainless-retry-count")===void 0&&(o["x-stainless-retry-count"]=String(a)),this.validateHeaders(o,n),o}async prepareOptions(t){}async prepareRequest(t,{url:n,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(n=>[...n])):{...t}:{}}makeStatusError(t,n,r,a){return wn.generate(t,n,r,a)}request(t,n=null){return new Qh(this.makeRequest(t,n))}async makeRequest(t,n){var d,p;const r=await t,a=r.maxRetries??this.maxRetries;n==null&&(n=a),await this.prepareOptions(r);const{req:o,url:i,timeout:s}=this.buildRequest(r,{retryCount:a-n});if(await this.prepareRequest(o,{url:i,options:r}),xc("request",i,r,o.headers),(d=r.signal)==null?void 0:d.aborted)throw new wr;const c=new AbortController,l=await this.fetchWithTimeout(i,o,s,c).catch(__);if(l instanceof Error){if((p=r.signal)!=null&&p.aborted)throw new wr;if(n)return this.retryRequest(r,n);throw l.name==="AbortError"?new Xh:new Kh({cause:l})}const u=Xue(l.headers);if(!l.ok){if(n&&this.shouldRetry(l)){const v=`retrying, ${n} attempts remaining`;return xc(`response (error; ${v})`,l.status,i,u),this.retryRequest(r,n,u)}const f=await l.text().catch(v=>__(v).message),y=Jue(f),m=y?void 0:f;throw xc(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,u,m),this.makeStatusError(l.status,y,m,u)}return{response:l,options:r,controller:c}}requestAPIList(t,n){const r=this.makeRequest(n,null);return new Kue(this,r,t)}buildURL(t,n){const r=tde(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return LL(a)||(n={...a,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(t){return Object.entries(t).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new et(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,n,r,a){const{signal:o,...i}=n||{};o&&o.addEventListener("abort",()=>a.abort());const s=setTimeout(()=>a.abort(),r),c={signal:a.signal,...i};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,t,c).finally(()=>{clearTimeout(s)})}shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,r){let a;const o=r==null?void 0:r["retry-after-ms"];if(o){const s=parseFloat(o);Number.isNaN(s)||(a=s)}const i=r==null?void 0:r["retry-after"];if(i&&!a){const s=parseFloat(i);Number.isNaN(s)?a=Date.parse(i)-Date.now():a=s*1e3}if(!(a&&0<=a&&a<60*1e3)){const s=t.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,s)}return await cd(a),this.makeRequest(t,n-1)}calculateDefaultRetryTimeoutMillis(t,n){const r=n-t,a=Math.min(.5*Math.pow(2,r),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${vc}`}}class TL{constructor(t,n,r,a){Gh.set(this,void 0),Wue(this,Gh,t),this.options=a,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new et("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in t&&typeof n.query=="object")n.query={...n.query,...t.params};else if("url"in t){const r=[...Object.entries(n.query||{}),...t.url.searchParams.entries()];for(const[a,o]of r)t.url.searchParams.set(a,o);n.query=void 0,n.path=t.url.toString()}return await Hue(this,Gh,"f").requestAPIList(this.constructor,n)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(Gh=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}class Kue extends Qh{constructor(t,n,r){super(n,async a=>new r(t,a.response,await kL(a),a.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}const Xue=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,n){const r=n.toString();return t[r.toLowerCase()]||t[r]}}),Zue={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Hn=e=>typeof e=="object"&&e!==null&&!LL(e)&&Object.keys(e).every(t=>$L(Zue,t)),Gue=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":RL(Deno.build.os),"X-Stainless-Arch":IL(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":Ka.version};if(Object.prototype.toString.call(typeof Ka<"u"?Ka:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":RL(Ka.platform),"X-Stainless-Arch":IL(Ka.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":Ka.version};const e=Que();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":vc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Que(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${a}.${o}.${i}`}}}return null}const IL=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",RL=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let DL;const Yue=()=>DL??(DL=Gue()),Jue=e=>{try{return JSON.parse(e)}catch{return}},ede=/^[a-z][a-z0-9+.-]*:/i,tde=e=>ede.test(e),cd=e=>new Promise(t=>setTimeout(t,e)),x_=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new et(`${e} must be an integer`);if(t<0)throw new et(`${e} must be a positive integer`);return t},__=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},Yh=e=>{var t,n,r,a;if(typeof Ka<"u")return((t=wc==null?void 0:wc[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,e))==null?void 0:a.trim()};function LL(e){if(!e)return!0;for(const t in e)return!1;return!0}function $L(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function FL(e,t){for(const n in t){if(!$L(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];a===null?delete e[r]:a!==void 0&&(e[r]=a)}}function xc(e,...t){typeof Ka<"u"&&(wc==null?void 0:wc.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${e}`,...t)}const nde=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),rde=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",ade=e=>typeof(e==null?void 0:e.get)=="function",BL=(e,t)=>{var r;const n=t.toLowerCase();if(ade(e)){const a=((r=t[0])==null?void 0:r.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(o,i,s)=>i+s.toUpperCase());for(const o of[t,n,t.toUpperCase(),a]){const i=e.get(o);if(i)return i}}for(const[a,o]of Object.entries(e))if(a.toLowerCase()===n)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${t} header, using the first entry.`),o[0]):o};function j_(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class ode extends TL{constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Kr extends TL{constructor(t,n,r,a){super(t,n,r,a),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const n=Object.fromEntries(t.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const t=this.getPaginatedItems();if(!t.length)return null;const n=(r=t[t.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class ht{constructor(t){this._client=t}}let zL=class extends ht{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},S_=class extends ht{constructor(){super(...arguments),this.completions=new zL(this._client)}};S_.Completions=zL;class VL extends ht{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class UL extends ht{create(t,n){return this._client.post("/audio/transcriptions",bc({body:t,...n}))}}class WL extends ht{create(t,n){return this._client.post("/audio/translations",bc({body:t,...n}))}}class ld extends ht{constructor(){super(...arguments),this.transcriptions=new UL(this._client),this.translations=new WL(this._client),this.speech=new VL(this._client)}}ld.Transcriptions=UL,ld.Translations=WL,ld.Speech=VL;class E_ extends ht{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(`/batches/${t}`,n)}list(t={},n){return Hn(t)?this.list({},t):this._client.getAPIList("/batches",O_,{query:t,...n})}cancel(t,n){return this._client.post(`/batches/${t}/cancel`,n)}}class O_ extends Kr{}E_.BatchesPage=O_;class C_ extends ht{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/assistants/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return Hn(t)?this.list({},t):this._client.getAPIList("/assistants",N_,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/assistants/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class N_ extends Kr{}C_.AssistantsPage=N_;function HL(e){return typeof e.parse=="function"}const _c=e=>(e==null?void 0:e.role)==="assistant",qL=e=>(e==null?void 0:e.role)==="function",KL=e=>(e==null?void 0:e.role)==="tool";var Xr=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Vt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},M_,Jh,em,ud,dd,tm,pd,xo,fd,nm,rm,jc,XL;class ZL{constructor(){M_.add(this),this.controller=new AbortController,Jh.set(this,void 0),em.set(this,()=>{}),ud.set(this,()=>{}),dd.set(this,void 0),tm.set(this,()=>{}),pd.set(this,()=>{}),xo.set(this,{}),fd.set(this,!1),nm.set(this,!1),rm.set(this,!1),jc.set(this,!1),Xr(this,Jh,new Promise((t,n)=>{Xr(this,em,t,"f"),Xr(this,ud,n,"f")}),"f"),Xr(this,dd,new Promise((t,n)=>{Xr(this,tm,t,"f"),Xr(this,pd,n,"f")}),"f"),Vt(this,Jh,"f").catch(()=>{}),Vt(this,dd,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},Vt(this,M_,"m",XL).bind(this))},0)}_connected(){this.ended||(Vt(this,em,"f").call(this),this._emit("connect"))}get ended(){return Vt(this,fd,"f")}get errored(){return Vt(this,nm,"f")}get aborted(){return Vt(this,rm,"f")}abort(){this.controller.abort()}on(t,n){return(Vt(this,xo,"f")[t]||(Vt(this,xo,"f")[t]=[])).push({listener:n}),this}off(t,n){const r=Vt(this,xo,"f")[t];if(!r)return this;const a=r.findIndex(o=>o.listener===n);return a>=0&&r.splice(a,1),this}once(t,n){return(Vt(this,xo,"f")[t]||(Vt(this,xo,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,r)=>{Xr(this,jc,!0,"f"),t!=="error"&&this.once("error",r),this.once(t,n)})}async done(){Xr(this,jc,!0,"f"),await Vt(this,dd,"f")}_emit(t,...n){if(Vt(this,fd,"f"))return;t==="end"&&(Xr(this,fd,!0,"f"),Vt(this,tm,"f").call(this));const r=Vt(this,xo,"f")[t];if(r&&(Vt(this,xo,"f")[t]=r.filter(a=>!a.once),r.forEach(({listener:a})=>a(...n))),t==="abort"){const a=n[0];!Vt(this,jc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Vt(this,ud,"f").call(this,a),Vt(this,pd,"f").call(this,a),this._emit("end");return}if(t==="error"){const a=n[0];!Vt(this,jc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),Vt(this,ud,"f").call(this,a),Vt(this,pd,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Jh=new WeakMap,em=new WeakMap,ud=new WeakMap,dd=new WeakMap,tm=new WeakMap,pd=new WeakMap,xo=new WeakMap,fd=new WeakMap,nm=new WeakMap,rm=new WeakMap,jc=new WeakMap,M_=new WeakSet,XL=function(e){if(Xr(this,nm,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new wr),e instanceof wr)return Xr(this,rm,!0,"f"),this._emit("abort",e);if(e instanceof et)return this._emit("error",e);if(e instanceof Error){const t=new et(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new et(String(e)))};function ide(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}function GL(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function sde(e,{parser:t,callback:n}){const r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function hd(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function cde(e,t){return!t||!QL(t)?{...e,choices:e.choices.map(n=>({...n,message:{...n.message,parsed:null,tool_calls:n.message.tool_calls??[]}}))}:P_(e,t)}function P_(e,t){const n=e.choices.map(r=>{var a;if(r.finish_reason==="length")throw new SL;if(r.finish_reason==="content_filter")throw new EL;return{...r,message:{...r.message,tool_calls:((a=r.message.tool_calls)==null?void 0:a.map(o=>ude(t,o)))??[],parsed:r.message.content&&!r.message.refusal?lde(t,r.message.content):null}}});return{...e,choices:n}}function lde(e,t){var n,r;return((n=e.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=e.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function ude(e,t){var r;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:hd(n)?n.$parseRaw(t.function.arguments):n!=null&&n.function.strict?JSON.parse(t.function.arguments):null}}}function dde(e,t){var r;if(!e)return!1;const n=(r=e.tools)==null?void 0:r.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===t.function.name});return hd(n)||(n==null?void 0:n.function.strict)||!1}function QL(e){var t;return GL(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(n=>hd(n)||n.type==="function"&&n.function.strict===!0))??!1}function pde(e){for(const t of e??[]){if(t.type!=="function")throw new et(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new et(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var qn=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Cn,k_,am,A_,T_,I_,YL,R_;const JL=10;class e6 extends ZL{constructor(){super(...arguments),Cn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var r;this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=(r=t.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),(qL(t)||KL(t))&&t.content)this._emit("functionCallResult",t.content);else if(_c(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(_c(t)&&t.tool_calls)for(const r of t.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new et("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),qn(this,Cn,"m",k_).call(this)}async finalMessage(){return await this.done(),qn(this,Cn,"m",am).call(this)}async finalFunctionCall(){return await this.done(),qn(this,Cn,"m",A_).call(this)}async finalFunctionCallResult(){return await this.done(),qn(this,Cn,"m",T_).call(this)}async totalUsage(){return await this.done(),qn(this,Cn,"m",I_).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=qn(this,Cn,"m",am).call(this);n&&this._emit("finalMessage",n);const r=qn(this,Cn,"m",k_).call(this);r&&this._emit("finalContent",r);const a=qn(this,Cn,"m",A_).call(this);a&&this._emit("finalFunctionCall",a);const o=qn(this,Cn,"m",T_).call(this);o!=null&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",qn(this,Cn,"m",I_).call(this))}async _createChatCompletion(t,n,r){const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),qn(this,Cn,"m",YL).call(this,n);const o=await t.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(P_(o,n))}async _runChatCompletion(t,n,r){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(t,n,r)}async _runFunctions(t,n,r){var p;const a="function",{function_call:o="auto",stream:i,...s}=n,c=typeof o!="string"&&(o==null?void 0:o.name),{maxChatCompletions:l=JL}=r||{},u={};for(const f of n.functions)u[f.name||f.function.name]=f;const d=n.functions.map(f=>({name:f.name||f.function.name,parameters:f.parameters,description:f.description}));for(const f of n.messages)this._addMessage(f,!1);for(let f=0;f<l;++f){const y=(p=(await this._createChatCompletion(t,{...s,function_call:o,functions:d,messages:[...this.messages]},r)).choices[0])==null?void 0:p.message;if(!y)throw new et("missing message in ChatCompletion response");if(!y.function_call)return;const{name:m,arguments:v}=y.function_call,b=u[m];if(b){if(c&&c!==m){const _=`Invalid function_call: ${JSON.stringify(m)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,name:m,content:_});continue}}else{const _=`Invalid function_call: ${JSON.stringify(m)}. Available options are: ${d.map(S=>JSON.stringify(S.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:m,content:_});continue}let w;try{w=HL(b)?await b.parse(v):v}catch(_){this._addMessage({role:a,name:m,content:_ instanceof Error?_.message:String(_)});continue}const j=await b.function(w,this),x=qn(this,Cn,"m",R_).call(this,j);if(this._addMessage({role:a,name:m,content:x}),c)return}}async _runTools(t,n,r){var f,y,m;const a="tool",{tool_choice:o="auto",stream:i,...s}=n,c=typeof o!="string"&&((f=o==null?void 0:o.function)==null?void 0:f.name),{maxChatCompletions:l=JL}=r||{},u=n.tools.map(v=>{if(hd(v)){if(!v.$callback)throw new et("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),d={};for(const v of u)v.type==="function"&&(d[v.function.name||v.function.function.name]=v.function);const p="tools"in n?u.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<l;++v){const b=(y=(await this._createChatCompletion(t,{...s,tool_choice:o,tools:p,messages:[...this.messages]},r)).choices[0])==null?void 0:y.message;if(!b)throw new et("missing message in ChatCompletion response");if(!((m=b.tool_calls)!=null&&m.length))return;for(const w of b.tool_calls){if(w.type!=="function")continue;const j=w.id,{name:x,arguments:_}=w.function,S=d[x];if(S){if(c&&c!==x){const N=`Invalid tool_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:j,content:N});continue}}else{const N=`Invalid tool_call: ${JSON.stringify(x)}. Available options are: ${Object.keys(d).map(P=>JSON.stringify(P)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:j,content:N});continue}let E;try{E=HL(S)?await S.parse(_):_}catch(N){const P=N instanceof Error?N.message:String(N);this._addMessage({role:a,tool_call_id:j,content:P});continue}const O=await S.function(E,this),M=qn(this,Cn,"m",R_).call(this,O);if(this._addMessage({role:a,tool_call_id:j,content:M}),c)return}}}}Cn=new WeakSet,k_=function(){return qn(this,Cn,"m",am).call(this).content??null},am=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(_c(t)){const{function_call:n,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new et("stream ended without producing a ChatCompletionMessage with role=assistant")},A_=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(_c(r)&&(r!=null&&r.function_call))return r.function_call;if(_c(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},T_=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(qL(t)&&t.content!=null||KL(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},I_=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},YL=function(e){if(e.n!=null&&e.n>1)throw new et("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},R_=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class md extends e6{static runFunctions(t,n,r){const a=new md,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new md,o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}_addMessage(t,n=!0){super._addMessage(t,n),_c(t)&&t.content&&this._emit("content",t.content)}}const t6=1,n6=2,r6=4,a6=8,o6=16,i6=32,s6=64,c6=128,l6=256,u6=c6|l6,d6=o6|i6|u6|s6,p6=t6|n6|d6,f6=r6|a6,fde=p6|f6,dn={STR:t6,NUM:n6,ARR:r6,OBJ:a6,NULL:o6,BOOL:i6,NAN:s6,INFINITY:c6,MINUS_INFINITY:l6,INF:u6,SPECIAL:d6,ATOM:p6,COLLECTION:f6,ALL:fde};class hde extends Error{}class mde extends Error{}function yde(e,t=dn.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return gde(e.trim(),t)}const gde=(e,t)=>{const n=e.length;let r=0;const a=p=>{throw new hde(`${p} at position ${r}`)},o=p=>{throw new mde(`${p} at position ${r}`)},i=()=>(d(),r>=n&&a("Unexpected end of input"),e[r]==='"'?s():e[r]==="{"?c():e[r]==="["?l():e.substring(r,r+4)==="null"||dn.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):e.substring(r,r+4)==="true"||dn.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):e.substring(r,r+5)==="false"||dn.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):e.substring(r,r+8)==="Infinity"||dn.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):e.substring(r,r+9)==="-Infinity"||dn.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):e.substring(r,r+3)==="NaN"||dn.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),s=()=>{const p=r;let f=!1;for(r++;r<n&&(e[r]!=='"'||f&&e[r-1]==="\\");)f=e[r]==="\\"?!f:!1,r++;if(e.charAt(r)=='"')try{return JSON.parse(e.substring(p,++r-Number(f)))}catch(y){o(String(y))}else if(dn.STR&t)try{return JSON.parse(e.substring(p,r-Number(f))+'"')}catch{return JSON.parse(e.substring(p,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{r++,d();const p={};try{for(;e[r]!=="}";){if(d(),r>=n&&dn.OBJ&t)return p;const f=s();d(),r++;try{const y=i();Object.defineProperty(p,f,{value:y,writable:!0,enumerable:!0,configurable:!0})}catch(y){if(dn.OBJ&t)return p;throw y}d(),e[r]===","&&r++}}catch{if(dn.OBJ&t)return p;a("Expected '}' at end of object")}return r++,p},l=()=>{r++;const p=[];try{for(;e[r]!=="]";)p.push(i()),d(),e[r]===","&&r++}catch{if(dn.ARR&t)return p;a("Expected ']' at end of array")}return r++,p},u=()=>{if(r===0){e==="-"&&dn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(f){if(dn.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}o(String(f))}}const p=r;for(e[r]==="-"&&r++;e[r]&&!",]}".includes(e[r]);)r++;r==n&&!(dn.NUM&t)&&a("Unterminated number literal");try{return JSON.parse(e.substring(p,r))}catch{e.substring(p,r)==="-"&&dn.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e.substring(p,e.lastIndexOf("e")))}catch(f){o(String(f))}}},d=()=>{for(;r<n&&` 
\r	`.includes(e[r]);)r++};return i()},h6=e=>yde(e,dn.ALL^dn.NUM);var Sc=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},Et=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},on,_o,Ec,oi,D_,om,L_,$_,F_,im,B_,m6;class yd extends e6{constructor(t){super(),on.add(this),_o.set(this,void 0),Ec.set(this,void 0),oi.set(this,void 0),Sc(this,_o,t,"f"),Sc(this,Ec,[],"f")}get currentChatCompletionSnapshot(){return Et(this,oi,"f")}static fromReadableStream(t){const n=new yd(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,r){const a=new yd(n);return a._run(()=>a._runChatCompletion(t,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(t,n,r){var i;super._createChatCompletion;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Et(this,on,"m",D_).call(this);const o=await t.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const s of o)Et(this,on,"m",L_).call(this,s);if((i=o.controller.signal)!=null&&i.aborted)throw new wr;return this._addChatCompletion(Et(this,on,"m",im).call(this))}async _fromReadableStream(t,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Et(this,on,"m",D_).call(this),this._connected();const a=Pa.fromReadableStream(t,this.controller);let o;for await(const s of a)o&&o!==s.id&&this._addChatCompletion(Et(this,on,"m",im).call(this)),Et(this,on,"m",L_).call(this,s),o=s.id;if((i=a.controller.signal)!=null&&i.aborted)throw new wr;return this._addChatCompletion(Et(this,on,"m",im).call(this))}[(_o=new WeakMap,Ec=new WeakMap,oi=new WeakMap,on=new WeakSet,D_=function(){this.ended||Sc(this,oi,void 0,"f")},om=function(t){let n=Et(this,Ec,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Et(this,Ec,"f")[t.index]=n,n)},L_=function(t){var r,a,o,i,s,c,l,u,d,p,f,y,m,v,b;if(this.ended)return;const n=Et(this,on,"m",m6).call(this,t);this._emit("chunk",t,n);for(const w of t.choices){const j=n.choices[w.index];w.delta.content!=null&&((r=j.message)==null?void 0:r.role)==="assistant"&&((a=j.message)!=null&&a.content)&&(this._emit("content",w.delta.content,j.message.content),this._emit("content.delta",{delta:w.delta.content,snapshot:j.message.content,parsed:j.message.parsed})),w.delta.refusal!=null&&((o=j.message)==null?void 0:o.role)==="assistant"&&((i=j.message)!=null&&i.refusal)&&this._emit("refusal.delta",{delta:w.delta.refusal,snapshot:j.message.refusal}),((s=w.logprobs)==null?void 0:s.content)!=null&&((c=j.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(l=w.logprobs)==null?void 0:l.content,snapshot:((u=j.logprobs)==null?void 0:u.content)??[]}),((d=w.logprobs)==null?void 0:d.refusal)!=null&&((p=j.message)==null?void 0:p.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(f=w.logprobs)==null?void 0:f.refusal,snapshot:((y=j.logprobs)==null?void 0:y.refusal)??[]});const x=Et(this,on,"m",om).call(this,j);j.finish_reason&&(Et(this,on,"m",F_).call(this,j),x.current_tool_call_index!=null&&Et(this,on,"m",$_).call(this,j,x.current_tool_call_index));for(const _ of w.delta.tool_calls??[])x.current_tool_call_index!==_.index&&(Et(this,on,"m",F_).call(this,j),x.current_tool_call_index!=null&&Et(this,on,"m",$_).call(this,j,x.current_tool_call_index)),x.current_tool_call_index=_.index;for(const _ of w.delta.tool_calls??[]){const S=(m=j.message.tool_calls)==null?void 0:m[_.index];S!=null&&S.type&&((S==null?void 0:S.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=S.function)==null?void 0:v.name,index:_.index,arguments:S.function.arguments,parsed_arguments:S.function.parsed_arguments,arguments_delta:((b=_.function)==null?void 0:b.arguments)??""}):S==null||S.type)}}},$_=function(t,n){var a,o,i;if(Et(this,on,"m",om).call(this,t).done_tool_calls.has(n))return;const r=(a=t.message.tool_calls)==null?void 0:a[n];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const s=(i=(o=Et(this,_o,"f"))==null?void 0:o.tools)==null?void 0:i.find(c=>c.type==="function"&&c.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:n,arguments:r.function.arguments,parsed_arguments:hd(s)?s.$parseRaw(r.function.arguments):s!=null&&s.function.strict?JSON.parse(r.function.arguments):null})}else r.type},F_=function(t){var r,a;const n=Et(this,on,"m",om).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const o=Et(this,on,"m",B_).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},im=function(){if(this.ended)throw new et("stream has ended, this shouldn't happen");const t=Et(this,oi,"f");if(!t)throw new et("request ended without sending any chunks");return Sc(this,oi,void 0,"f"),Sc(this,Ec,[],"f"),vde(t,Et(this,_o,"f"))},B_=function(){var n;const t=(n=Et(this,_o,"f"))==null?void 0:n.response_format;return GL(t)?t:null},m6=function(t){var n,r,a,o;let i=Et(this,oi,"f");const{choices:s,...c}=t;i?Object.assign(i,c):i=Sc(this,oi,{...c,choices:[]},"f");for(const{delta:l,finish_reason:u,index:d,logprobs:p=null,...f}of t.choices){let y=i.choices[d];if(y||(y=i.choices[d]={finish_reason:u,index:d,message:{},logprobs:p,...f}),p)if(!y.logprobs)y.logprobs=Object.assign({},p);else{const{content:_,refusal:S,...E}=p;Object.assign(y.logprobs,E),_&&((n=y.logprobs).content??(n.content=[]),y.logprobs.content.push(..._)),S&&((r=y.logprobs).refusal??(r.refusal=[]),y.logprobs.refusal.push(...S))}if(u&&(y.finish_reason=u,Et(this,_o,"f")&&QL(Et(this,_o,"f")))){if(u==="length")throw new SL;if(u==="content_filter")throw new EL}if(Object.assign(y,f),!l)continue;const{content:m,refusal:v,function_call:b,role:w,tool_calls:j,...x}=l;if(Object.assign(y.message,x),v&&(y.message.refusal=(y.message.refusal||"")+v),w&&(y.message.role=w),b&&(y.message.function_call?(b.name&&(y.message.function_call.name=b.name),b.arguments&&((a=y.message.function_call).arguments??(a.arguments=""),y.message.function_call.arguments+=b.arguments)):y.message.function_call=b),m&&(y.message.content=(y.message.content||"")+m,!y.message.refusal&&Et(this,on,"m",B_).call(this)&&(y.message.parsed=h6(y.message.content))),j){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:_,id:S,type:E,function:O,...M}of j){const N=(o=y.message.tool_calls)[_]??(o[_]={});Object.assign(N,M),S&&(N.id=S),E&&(N.type=E),O&&(N.function??(N.function={name:O.name??"",arguments:""})),O!=null&&O.name&&(N.function.name=O.name),O!=null&&O.arguments&&(N.function.arguments+=O.arguments,dde(Et(this,_o,"f"),N)&&(N.function.parsed_arguments=h6(N.function.arguments)))}}}return i},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("chunk",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Pa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function vde(e,t){const{id:n,choices:r,created:a,model:o,system_fingerprint:i,...s}=e,c={...s,id:n,choices:r.map(({message:l,finish_reason:u,index:d,logprobs:p,...f})=>{if(!u)throw new et(`missing finish_reason for choice ${d}`);const{content:y=null,function_call:m,tool_calls:v,...b}=l,w=l.role;if(!w)throw new et(`missing role for choice ${d}`);if(m){const{arguments:j,name:x}=m;if(j==null)throw new et(`missing function_call.arguments for choice ${d}`);if(!x)throw new et(`missing function_call.name for choice ${d}`);return{...f,message:{content:y,function_call:{arguments:j,name:x},role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:p}}return v?{...f,index:d,finish_reason:u,logprobs:p,message:{...b,role:w,content:y,refusal:l.refusal??null,tool_calls:v.map((j,x)=>{const{function:_,type:S,id:E,...O}=j,{arguments:M,name:N,...P}=_||{};if(E==null)throw new et(`missing choices[${d}].tool_calls[${x}].id
${sm(e)}`);if(S==null)throw new et(`missing choices[${d}].tool_calls[${x}].type
${sm(e)}`);if(N==null)throw new et(`missing choices[${d}].tool_calls[${x}].function.name
${sm(e)}`);if(M==null)throw new et(`missing choices[${d}].tool_calls[${x}].function.arguments
${sm(e)}`);return{...O,id:E,type:S,function:{...P,name:N,arguments:M}}})}}:{...f,message:{...b,content:y,role:w,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:p}}),created:a,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return cde(c,t)}function sm(e){return JSON.stringify(e)}class Oc extends yd{static fromReadableStream(t){const n=new Oc(null);return n._run(()=>n._fromReadableStream(t)),n}static runFunctions(t,n,r){const a=new Oc(null),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(t,n,o)),a}static runTools(t,n,r){const a=new Oc(n),o={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(t,n,o)),a}}let y6=class extends ht{parse(e,t){return pde(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>P_(n,e))}runFunctions(e,t){return e.stream?Oc.runFunctions(this._client,e,t):md.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Oc.runTools(this._client,e,t):md.runTools(this._client,e,t)}stream(e,t){return yd.createChatCompletion(this._client,e,t)}};class z_ extends ht{constructor(){super(...arguments),this.completions=new y6(this._client)}}(function(e){e.Completions=y6})(z_||(z_={}));class g6 extends ht{create(t,n){return this._client.post("/realtime/sessions",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class V_ extends ht{constructor(){super(...arguments),this.sessions=new g6(this._client)}}V_.Sessions=g6;var Ie=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},ur=function(e,t,n,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(e,n):a?a.value=n:t.set(e,n),n},xn,U_,ka,cm,Zr,Qi,Cc,Yi,lm,dr,um,dm,gd,vd,bd,v6,b6,w6,x6,_6,j6,S6;class Gr extends ZL{constructor(){super(...arguments),xn.add(this),U_.set(this,[]),ka.set(this,{}),cm.set(this,{}),Zr.set(this,void 0),Qi.set(this,void 0),Cc.set(this,void 0),Yi.set(this,void 0),lm.set(this,void 0),dr.set(this,void 0),um.set(this,void 0),dm.set(this,void 0),gd.set(this,void 0)}[(U_=new WeakMap,ka=new WeakMap,cm=new WeakMap,Zr=new WeakMap,Qi=new WeakMap,Cc=new WeakMap,Yi=new WeakMap,lm=new WeakMap,dr=new WeakMap,um=new WeakMap,dm=new WeakMap,gd=new WeakMap,xn=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("event",a=>{const o=n.shift();o?o.resolve(a):t.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const o of n)o.reject(a);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>n.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new Gr;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Pa.fromReadableStream(t,this.controller);for await(const i of a)Ie(this,xn,"m",vd).call(this,i);if((o=a.controller.signal)!=null&&o.aborted)throw new wr;return this._addRun(Ie(this,xn,"m",bd).call(this))}toReadableStream(){return new Pa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,r,a,o){const i=new Gr;return i._run(()=>i._runToolAssistantStream(t,n,r,a,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(t,n,r,a,o){var l;const i=o==null?void 0:o.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...a,stream:!0},c=await t.submitToolOutputs(n,r,s,{...o,signal:this.controller.signal});this._connected();for await(const u of c)Ie(this,xn,"m",vd).call(this,u);if((l=c.controller.signal)!=null&&l.aborted)throw new wr;return this._addRun(Ie(this,xn,"m",bd).call(this))}static createThreadAssistantStream(t,n,r){const a=new Gr;return a._run(()=>a._threadAssistantStream(t,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(t,n,r,a){const o=new Gr;return o._run(()=>o._runAssistantStream(t,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return Ie(this,um,"f")}currentRun(){return Ie(this,dm,"f")}currentMessageSnapshot(){return Ie(this,Zr,"f")}currentRunStepSnapshot(){return Ie(this,gd,"f")}async finalRunSteps(){return await this.done(),Object.values(Ie(this,ka,"f"))}async finalMessages(){return await this.done(),Object.values(Ie(this,cm,"f"))}async finalRun(){if(await this.done(),!Ie(this,Qi,"f"))throw Error("Final run was not received.");return Ie(this,Qi,"f")}async _createThreadAssistantStream(t,n,r){var s;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},i=await t.createAndRun(o,{...r,signal:this.controller.signal});this._connected();for await(const c of i)Ie(this,xn,"m",vd).call(this,c);if((s=i.controller.signal)!=null&&s.aborted)throw new wr;return this._addRun(Ie(this,xn,"m",bd).call(this))}async _createAssistantStream(t,n,r,a){var c;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},s=await t.create(n,i,{...a,signal:this.controller.signal});this._connected();for await(const l of s)Ie(this,xn,"m",vd).call(this,l);if((c=s.controller.signal)!=null&&c.aborted)throw new wr;return this._addRun(Ie(this,xn,"m",bd).call(this))}static accumulateDelta(t,n){for(const[r,a]of Object.entries(n)){if(!t.hasOwnProperty(r)){t[r]=a;continue}let o=t[r];if(o==null){t[r]=a;continue}if(r==="index"||r==="type"){t[r]=a;continue}if(typeof o=="string"&&typeof a=="string")o+=a;else if(typeof o=="number"&&typeof a=="number")o+=a;else if(j_(o)&&j_(a))o=this.accumulateDelta(o,a);else if(Array.isArray(o)&&Array.isArray(a)){if(o.every(i=>typeof i=="string"||typeof i=="number")){o.push(...a);continue}for(const i of a){if(!j_(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const s=i.index;if(s==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof s!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const c=o[s];c==null?o.push(i):o[s]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${o}`);t[r]=o}return t}_addRun(t){return t}async _threadAssistantStream(t,n,r){return await this._createThreadAssistantStream(n,t,r)}async _runAssistantStream(t,n,r,a){return await this._createAssistantStream(n,t,r,a)}async _runToolAssistantStream(t,n,r,a,o){return await this._createToolAssistantStream(r,t,n,a,o)}}vd=function(e){if(!this.ended)switch(ur(this,um,e,"f"),Ie(this,xn,"m",w6).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Ie(this,xn,"m",S6).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ie(this,xn,"m",b6).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Ie(this,xn,"m",v6).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},bd=function(){if(this.ended)throw new et("stream has ended, this shouldn't happen");if(!Ie(this,Qi,"f"))throw Error("Final run has not been received");return Ie(this,Qi,"f")},v6=function(e){const[t,n]=Ie(this,xn,"m",_6).call(this,e,Ie(this,Zr,"f"));ur(this,Zr,t,"f"),Ie(this,cm,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,o=t.content[r.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=Ie(this,Cc,"f")){if(Ie(this,Yi,"f"))switch(Ie(this,Yi,"f").type){case"text":this._emit("textDone",Ie(this,Yi,"f").text,Ie(this,Zr,"f"));break;case"image_file":this._emit("imageFileDone",Ie(this,Yi,"f").image_file,Ie(this,Zr,"f"));break}ur(this,Cc,r.index,"f")}ur(this,Yi,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Ie(this,Cc,"f")!==void 0){const r=e.data.content[Ie(this,Cc,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,Ie(this,Zr,"f"));break;case"text":this._emit("textDone",r.text,Ie(this,Zr,"f"));break}}Ie(this,Zr,"f")&&this._emit("messageDone",e.data),ur(this,Zr,void 0,"f")}},b6=function(e){const t=Ie(this,xn,"m",x6).call(this,e);switch(ur(this,gd,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const r of n.step_details.tool_calls)r.index==Ie(this,lm,"f")?this._emit("toolCallDelta",r,t.step_details.tool_calls[r.index]):(Ie(this,dr,"f")&&this._emit("toolCallDone",Ie(this,dr,"f")),ur(this,lm,r.index,"f"),ur(this,dr,t.step_details.tool_calls[r.index],"f"),Ie(this,dr,"f")&&this._emit("toolCallCreated",Ie(this,dr,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ur(this,gd,void 0,"f"),e.data.step_details.type=="tool_calls"&&Ie(this,dr,"f")&&(this._emit("toolCallDone",Ie(this,dr,"f")),ur(this,dr,void 0,"f")),this._emit("runStepDone",e.data,t);break}},w6=function(e){Ie(this,U_,"f").push(e),this._emit("event",e)},x6=function(e){switch(e.event){case"thread.run.step.created":return Ie(this,ka,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Ie(this,ka,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=Gr.accumulateDelta(t,n.delta);Ie(this,ka,"f")[e.data.id]=r}return Ie(this,ka,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Ie(this,ka,"f")[e.data.id]=e.data;break}if(Ie(this,ka,"f")[e.data.id])return Ie(this,ka,"f")[e.data.id];throw new Error("No snapshot available")},_6=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let o=t.content[a.index];t.content[a.index]=Ie(this,xn,"m",j6).call(this,a,o)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},j6=function(e,t){return Gr.accumulateDelta(t,e)},S6=function(e){switch(ur(this,dm,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ur(this,Qi,e.data,"f"),Ie(this,dr,"f")&&(this._emit("toolCallDone",Ie(this,dr,"f")),ur(this,dr,void 0,"f"));break}};class W_ extends ht{create(t,n,r){return this._client.post(`/threads/${t}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/messages/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return Hn(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/messages`,H_,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n,r){return this._client.delete(`/threads/${t}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class H_ extends Kr{}W_.MessagesPage=H_;class q_ extends ht{retrieve(t,n,r,a={},o){return Hn(a)?this.retrieve(t,n,r,{},a):this._client.get(`/threads/${t}/runs/${n}/steps/${r}`,{query:a,...o,headers:{"OpenAI-Beta":"assistants=v2",...o==null?void 0:o.headers}})}list(t,n,r={},a){return Hn(r)?this.list(t,n,{},r):this._client.getAPIList(`/threads/${t}/runs/${n}/steps`,K_,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class K_ extends Kr{}q_.RunStepsPage=K_;class wd extends ht{constructor(){super(...arguments),this.steps=new q_(this._client)}create(t,n,r){const{include:a,...o}=n;return this._client.post(`/threads/${t}/runs`,{query:{include:a},body:o,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(t,n,r){return this._client.get(`/threads/${t}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,n={},r){return Hn(n)?this.list(t,{},n):this._client.getAPIList(`/threads/${t}/runs`,X_,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/threads/${t}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n,r);return await this.poll(t,a.id,r)}createAndStream(t,n,r){return Gr.createAssistantStream(t,this._client.beta.threads.runs,n,r)}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:{...r==null?void 0:r.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await cd(s);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,n,r){return Gr.createAssistantStream(t,this._client.beta.threads.runs,n,r)}submitToolOutputs(t,n,r,a){return this._client.post(`/threads/${t}/runs/${n}/submit_tool_outputs`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(t,n,r,a){const o=await this.submitToolOutputs(t,n,r,a);return await this.poll(t,o.id,a)}submitToolOutputsStream(t,n,r,a){return Gr.createToolAssistantStream(t,n,this._client.beta.threads.runs,r,a)}}class X_ extends Kr{}wd.RunsPage=X_,wd.Steps=q_,wd.RunStepsPage=K_;class Nc extends ht{constructor(){super(...arguments),this.runs=new wd(this._client),this.messages=new W_(this._client)}create(t={},n){return Hn(t)?this.create({},t):this._client.post("/threads",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/threads/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,n){return this._client.delete(`/threads/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}async createAndRunPoll(t,n){const r=await this.createAndRun(t,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(t,n){return Gr.createThreadAssistantStream(t,this._client.beta.threads,n)}}Nc.Runs=wd,Nc.RunsPage=X_,Nc.Messages=W_,Nc.MessagesPage=H_;const bde=async e=>{const t=await Promise.allSettled(e),n=t.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const a of t)a.status==="fulfilled"&&r.push(a.value);return r};let Z_=class extends ht{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return Hn(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,pm,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for((n==null?void 0:n.pollIntervalMs)&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),o=a.data;switch(o.status){case"in_progress":let i=5e3;if(n!=null&&n.pollIntervalMs)i=n.pollIntervalMs;else{const s=a.response.headers.get("openai-poll-after-ms");if(s){const c=parseInt(s);isNaN(c)||(i=c)}}await cd(i);break;case"failed":case"completed":return o}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}};class pm extends Kr{}Z_.VectorStoreFilesPage=pm;class E6 extends ht{create(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,n,r){return this._client.get(`/vector_stores/${t}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(t,n,r){return this._client.post(`/vector_stores/${t}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(t,n,r){const a=await this.create(t,n);return await this.poll(t,a.id,r)}listFiles(t,n,r={},a){return Hn(r)?this.listFiles(t,n,{},r):this._client.getAPIList(`/vector_stores/${t}/file_batches/${n}/files`,pm,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(t,n,r){const a={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for((r==null?void 0:r.pollIntervalMs)&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,n,{...r,headers:a}).withResponse();switch(o.status){case"in_progress":let s=5e3;if(r!=null&&r.pollIntervalMs)s=r.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(s=l)}}await cd(s);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:n,fileIds:r=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=(a==null?void 0:a.maxConcurrency)??5,i=Math.min(o,n.length),s=this._client,c=n.values(),l=[...r];async function u(p){for(let f of p){const y=await s.files.create({file:f,purpose:"assistants"},a);l.push(y.id)}}const d=Array(i).fill(c).map(u);return await bde(d),await this.createAndPoll(t,{file_ids:l})}}class Mc extends ht{constructor(){super(...arguments),this.files=new Z_(this._client),this.fileBatches=new E6(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(t,n){return this._client.get(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(t,n,r){return this._client.post(`/vector_stores/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(t={},n){return Hn(t)?this.list({},t):this._client.getAPIList("/vector_stores",G_,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(t,n){return this._client.delete(`/vector_stores/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class G_ extends Kr{}Mc.VectorStoresPage=G_,Mc.Files=Z_,Mc.VectorStoreFilesPage=pm,Mc.FileBatches=E6;class ii extends ht{constructor(){super(...arguments),this.realtime=new V_(this._client),this.vectorStores=new Mc(this._client),this.chat=new z_(this._client),this.assistants=new C_(this._client),this.threads=new Nc(this._client)}}ii.Realtime=V_,ii.VectorStores=Mc,ii.VectorStoresPage=G_,ii.Assistants=C_,ii.AssistantsPage=N_,ii.Threads=Nc;class O6 extends ht{create(t,n){return this._client.post("/completions",{body:t,...n,stream:t.stream??!1})}}class C6 extends ht{create(t,n){return this._client.post("/embeddings",{body:t,...n})}}class Q_ extends ht{create(t,n){return this._client.post("/files",bc({body:t,...n}))}retrieve(t,n){return this._client.get(`/files/${t}`,n)}list(t={},n){return Hn(t)?this.list({},t):this._client.getAPIList("/files",Y_,{query:t,...n})}del(t,n){return this._client.delete(`/files/${t}`,n)}content(t,n){return this._client.get(`/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(t,n){return this._client.get(`/files/${t}/content`,n)}async waitForProcessing(t,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),o=Date.now();let i=await this.retrieve(t);for(;!i.status||!a.has(i.status);)if(await cd(n),i=await this.retrieve(t),Date.now()-o>r)throw new Xh({message:`Giving up on waiting for file ${t} to finish processing after ${r} milliseconds.`});return i}}class Y_ extends Kr{}Q_.FileObjectsPage=Y_;class J_ extends ht{list(t,n={},r){return Hn(n)?this.list(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,ej,{query:n,...r})}}class ej extends Kr{}J_.FineTuningJobCheckpointsPage=ej;class Pc extends ht{constructor(){super(...arguments),this.checkpoints=new J_(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(`/fine_tuning/jobs/${t}`,n)}list(t={},n){return Hn(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",tj,{query:t,...n})}cancel(t,n){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},r){return Hn(n)?this.listEvents(t,{},n):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,nj,{query:n,...r})}}class tj extends Kr{}class nj extends Kr{}Pc.FineTuningJobsPage=tj,Pc.FineTuningJobEventsPage=nj,Pc.Checkpoints=J_,Pc.FineTuningJobCheckpointsPage=ej;class xd extends ht{constructor(){super(...arguments),this.jobs=new Pc(this._client)}}xd.Jobs=Pc,xd.FineTuningJobsPage=tj,xd.FineTuningJobEventsPage=nj;class N6 extends ht{createVariation(t,n){return this._client.post("/images/variations",bc({body:t,...n}))}edit(t,n){return this._client.post("/images/edits",bc({body:t,...n}))}generate(t,n){return this._client.post("/images/generations",{body:t,...n})}}class rj extends ht{retrieve(t,n){return this._client.get(`/models/${t}`,n)}list(t){return this._client.getAPIList("/models",aj,t)}del(t,n){return this._client.delete(`/models/${t}`,n)}}class aj extends ode{}rj.ModelsPage=aj;class M6 extends ht{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class P6 extends ht{create(t,n,r){return this._client.post(`/uploads/${t}/parts`,bc({body:n,...r}))}}class oj extends ht{constructor(){super(...arguments),this.parts=new P6(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(`/uploads/${t}/cancel`,n)}complete(t,n,r){return this._client.post(`/uploads/${t}/complete`,{body:n,...r})}}oj.Parts=P6;var k6;let it=class extends que{constructor({baseURL:e=Yh("OPENAI_BASE_URL"),apiKey:t=Yh("OPENAI_API_KEY"),organization:n=Yh("OPENAI_ORG_ID")??null,project:r=Yh("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new et("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&rde())throw new et(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new O6(this),this.chat=new S_(this),this.embeddings=new C6(this),this.files=new Q_(this),this.images=new N6(this),this.audio=new ld(this),this.moderations=new M6(this),this.models=new rj(this),this.fineTuning=new xd(this),this.beta=new ii(this),this.batches=new E_(this),this.uploads=new oj(this),this._options=o,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Mue(e,{arrayFormat:"brackets"})}};k6=it,it.OpenAI=k6,it.DEFAULT_TIMEOUT=6e5,it.OpenAIError=et,it.APIError=wn,it.APIConnectionError=Kh,it.APIConnectionTimeoutError=Xh,it.APIUserAbortError=wr,it.NotFoundError=bL,it.ConflictError=wL,it.RateLimitError=_L,it.BadRequestError=yL,it.AuthenticationError=gL,it.InternalServerError=jL,it.PermissionDeniedError=vL,it.UnprocessableEntityError=xL,it.toFile=ML,it.fileFromPath=hL,it.Completions=O6,it.Chat=S_,it.Embeddings=C6,it.Files=Q_,it.FileObjectsPage=Y_,it.Images=N6,it.Audio=ld,it.Moderations=M6,it.Models=rj,it.ModelsPage=aj,it.FineTuning=xd,it.Beta=ii,it.Batches=E_,it.BatchesPage=O_,it.Uploads=oj;var wde=typeof window=="object"?window:{},Xe="0123456789abcdef".split(""),xde=[-2147483648,8388608,32768,128],Qr=[24,16,8,0],pn=[];function Yr(e){e?(pn[0]=pn[16]=pn[1]=pn[2]=pn[3]=pn[4]=pn[5]=pn[6]=pn[7]=pn[8]=pn[9]=pn[10]=pn[11]=pn[12]=pn[13]=pn[14]=pn[15]=0,this.blocks=pn):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Yr.prototype.update=function(e){if(!this.finalized){var t=typeof e!="string";t&&e.constructor===wde.ArrayBuffer&&(e=new Uint8Array(e));for(var n,r=0,a,o=e.length||0,i=this.blocks;r<o;){if(this.hashed&&(this.hashed=!1,i[0]=this.block,i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),t)for(a=this.start;r<o&&a<64;++r)i[a>>2]|=e[r]<<Qr[a++&3];else for(a=this.start;r<o&&a<64;++r)n=e.charCodeAt(r),n<128?i[a>>2]|=n<<Qr[a++&3]:n<2048?(i[a>>2]|=(192|n>>6)<<Qr[a++&3],i[a>>2]|=(128|n&63)<<Qr[a++&3]):n<55296||n>=57344?(i[a>>2]|=(224|n>>12)<<Qr[a++&3],i[a>>2]|=(128|n>>6&63)<<Qr[a++&3],i[a>>2]|=(128|n&63)<<Qr[a++&3]):(n=65536+((n&1023)<<10|e.charCodeAt(++r)&1023),i[a>>2]|=(240|n>>18)<<Qr[a++&3],i[a>>2]|=(128|n>>12&63)<<Qr[a++&3],i[a>>2]|=(128|n>>6&63)<<Qr[a++&3],i[a>>2]|=(128|n&63)<<Qr[a++&3]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=i[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Yr.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=xde[t&3],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Yr.prototype.hash=function(){var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4,o,i,s,c=this.blocks;for(i=16;i<80;++i)s=c[i-3]^c[i-8]^c[i-14]^c[i-16],c[i]=s<<1|s>>>31;for(i=0;i<20;i+=5)o=t&n|~t&r,s=e<<5|e>>>27,a=s+o+a+1518500249+c[i]<<0,t=t<<30|t>>>2,o=e&t|~e&n,s=a<<5|a>>>27,r=s+o+r+1518500249+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|~a&t,s=r<<5|r>>>27,n=s+o+n+1518500249+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|~r&e,s=n<<5|n>>>27,t=s+o+t+1518500249+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|~n&a,s=t<<5|t>>>27,e=s+o+e+1518500249+c[i+4]<<0,n=n<<30|n>>>2;for(;i<40;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a+1859775393+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r+1859775393+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n+1859775393+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t+1859775393+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e+1859775393+c[i+4]<<0,n=n<<30|n>>>2;for(;i<60;i+=5)o=t&n|t&r|n&r,s=e<<5|e>>>27,a=s+o+a-1894007588+c[i]<<0,t=t<<30|t>>>2,o=e&t|e&n|t&n,s=a<<5|a>>>27,r=s+o+r-1894007588+c[i+1]<<0,e=e<<30|e>>>2,o=a&e|a&t|e&t,s=r<<5|r>>>27,n=s+o+n-1894007588+c[i+2]<<0,a=a<<30|a>>>2,o=r&a|r&e|a&e,s=n<<5|n>>>27,t=s+o+t-1894007588+c[i+3]<<0,r=r<<30|r>>>2,o=n&r|n&a|r&a,s=t<<5|t>>>27,e=s+o+e-1894007588+c[i+4]<<0,n=n<<30|n>>>2;for(;i<80;i+=5)o=t^n^r,s=e<<5|e>>>27,a=s+o+a-899497514+c[i]<<0,t=t<<30|t>>>2,o=e^t^n,s=a<<5|a>>>27,r=s+o+r-899497514+c[i+1]<<0,e=e<<30|e>>>2,o=a^e^t,s=r<<5|r>>>27,n=s+o+n-899497514+c[i+2]<<0,a=a<<30|a>>>2,o=r^a^e,s=n<<5|n>>>27,t=s+o+t-899497514+c[i+3]<<0,r=r<<30|r>>>2,o=n^r^a,s=t<<5|t>>>27,e=s+o+e-899497514+c[i+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+a<<0},Yr.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return Xe[e>>28&15]+Xe[e>>24&15]+Xe[e>>20&15]+Xe[e>>16&15]+Xe[e>>12&15]+Xe[e>>8&15]+Xe[e>>4&15]+Xe[e&15]+Xe[t>>28&15]+Xe[t>>24&15]+Xe[t>>20&15]+Xe[t>>16&15]+Xe[t>>12&15]+Xe[t>>8&15]+Xe[t>>4&15]+Xe[t&15]+Xe[n>>28&15]+Xe[n>>24&15]+Xe[n>>20&15]+Xe[n>>16&15]+Xe[n>>12&15]+Xe[n>>8&15]+Xe[n>>4&15]+Xe[n&15]+Xe[r>>28&15]+Xe[r>>24&15]+Xe[r>>20&15]+Xe[r>>16&15]+Xe[r>>12&15]+Xe[r>>8&15]+Xe[r>>4&15]+Xe[r&15]+Xe[a>>28&15]+Xe[a>>24&15]+Xe[a>>20&15]+Xe[a>>16&15]+Xe[a>>12&15]+Xe[a>>8&15]+Xe[a>>4&15]+Xe[a&15]},Yr.prototype.toString=Yr.prototype.hex,Yr.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,a>>24&255,a>>16&255,a>>8&255,a&255]},Yr.prototype.array=Yr.prototype.digest,Yr.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};const _de=e=>new Yr(!0).update(e).hex(),A6=(...e)=>_de(e.join("_"));class jde{}const Sde=new Map;class ij extends jde{constructor(t){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=t??new Map}lookup(t,n){return Promise.resolve(this.cache.get(A6(t,n))??null)}async update(t,n,r){this.cache.set(A6(t,n),r)}static global(){return new ij(Sde)}}const Ede=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e;function Ode(e){return typeof e!="object"||!e?!1:!!("type"in e&&e.type==="function"&&"function"in e&&typeof e.function=="object"&&e.function&&"name"in e.function&&"parameters"in e.function)}const Cde=()=>!1;class Nde extends Lp{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(t){super(t),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=t.verbose??Cde(),this.callbacks=t.callbacks,this.tags=t.tags??[],this.metadata=t.metadata??{}}}class Mde extends Nde{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:t,callbackManager:n,...r}){super({callbacks:t??n,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r.cache=="object"?this.cache=r.cache:r.cache?this.cache=ij.global():this.cache=void 0,this.caller=new jAe(r??{})}async getNumTokens(t){if(typeof t!="string")return 0;let n=Math.ceil(t.length/4);if(!this._encoding)try{this._encoding=await SAe("modelName"in this?Ede(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{n=this._encoding.encode(t).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return n}static _convertInputToPromptValue(t){return typeof t=="string"?new K4(t):Array.isArray(t)?new rue(t.map($p)):t}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:t,...n}){const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([a,o])=>o!==void 0).map(([a,o])=>`${a}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(t){throw new Error("Use .toJSON() instead")}}class fm extends Lp{static lc_name(){return"RunnablePassthrough"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t&&(this.func=t.func)}async invoke(t,n){const r=uK(n);return this.func&&await this.func(t,r),this._callWithConfig(a=>Promise.resolve(a),t,r)}async*transform(t,n){const r=uK(n);let a,o=!0;for await(const i of this._transformStreamWithConfig(t,s=>s,r))if(yield i,o)if(a===void 0)a=i;else try{a=dK(a,i)}catch{a=void 0,o=!1}this.func&&a!==void 0&&await this.func(a,r)}static assign(t){return new EAe(new OAe({steps:t}))}}function T6(e){return typeof(e==null?void 0:e.parse)=="function"}class si extends Mde{constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(t){const[n,r]=super._separateRunnableConfigFromCallOptions(t);return r.signal=n.signal,[n,r]}async invoke(t,n){const r=si._convertInputToPromptValue(t);return(await this.generatePrompt([r],n,n==null?void 0:n.callbacks)).generations[0][0].message}async*_streamResponseChunks(t,n,r){throw new Error("Not implemented.")}async*_streamIterator(t,n){var r;if(this._streamResponseChunks===si.prototype._streamResponseChunks)yield this.invoke(t,n);else{const a=si._convertInputToPromptValue(t).toChatMessages(),[o,i]=this._separateRunnableConfigFromCallOptionsCompat(n),s={...o.metadata,...this.getLsParams(i)},c=await SN.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),[a],o.runId,void 0,l,void 0,void 0,o.runName));let d;try{for await(const p of this._streamResponseChunks(a,i,u==null?void 0:u[0])){if(p.message.id==null){const f=(r=u==null?void 0:u.at(0))==null?void 0:r.runId;f!=null&&p.message._updateId(`run-${f}`)}p.message.response_metadata={...p.generationInfo,...p.message.response_metadata},yield p.message,d?d=d.concat(p):d=p}}catch(p){throw await Promise.all((u??[]).map(f=>f==null?void 0:f.handleLLMError(p))),p}await Promise.all((u??[]).map(p=>p==null?void 0:p.handleLLMEnd({generations:[[d]]})))}}getLsParams(t){return{ls_model_type:"chat",ls_stop:t.stop}}async _generateUncached(t,n,r){var p,f;const a=t.map(y=>y.map($p)),o={...r.metadata,...this.getLsParams(n)},i=await SN.configure(r.callbacks,this.callbacks,r.tags,this.tags,o,this.metadata,{verbose:this.verbose}),s={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:1},c=await(i==null?void 0:i.handleChatModelStart(this.toJSON(),a,r.runId,void 0,s,void 0,void 0,r.runName)),l=[],u=[];if(c!=null&&c[0].handlers.find(y=>CAe(y)||NAe(y))&&a.length===1&&this._streamResponseChunks!==si.prototype._streamResponseChunks)try{const y=await this._streamResponseChunks(a[0],n,c==null?void 0:c[0]);let m;for await(const v of y){if(v.message.id==null){const b=(p=c==null?void 0:c.at(0))==null?void 0:p.runId;b!=null&&v.message._updateId(`run-${b}`)}m===void 0?m=v:m=dK(m,v)}if(m===void 0)throw new Error("Received empty response from chat model call.");l.push([m]),await(c==null?void 0:c[0].handleLLMEnd({generations:l,llmOutput:{}}))}catch(y){throw await(c==null?void 0:c[0].handleLLMError(y)),y}else{const y=await Promise.allSettled(a.map((m,v)=>this._generate(m,{...n,promptIndex:v},c==null?void 0:c[v])));await Promise.all(y.map(async(m,v)=>{var b,w,j;if(m.status==="fulfilled"){const x=m.value;for(const _ of x.generations){if(_.message.id==null){const S=(b=c==null?void 0:c.at(0))==null?void 0:b.runId;S!=null&&_.message._updateId(`run-${S}`)}_.message.response_metadata={..._.generationInfo,..._.message.response_metadata}}return x.generations.length===1&&(x.generations[0].message.response_metadata={...x.llmOutput,...x.generations[0].message.response_metadata}),l[v]=x.generations,u[v]=x.llmOutput,(w=c==null?void 0:c[v])==null?void 0:w.handleLLMEnd({generations:[x.generations],llmOutput:x.llmOutput})}else return await((j=c==null?void 0:c[v])==null?void 0:j.handleLLMError(m.reason)),Promise.reject(m.reason)}))}const d={generations:l,llmOutput:u.length?(f=this._combineLLMOutput)==null?void 0:f.call(this,...u):void 0};return Object.defineProperty(d,pK,{value:c?{runIds:c==null?void 0:c.map(y=>y.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:t,cache:n,llmStringKey:r,parsedOptions:a,handledOptions:o}){const i=t.map(m=>m.map($p)),s={...o.metadata,...this.getLsParams(a)},c=await SN.configure(o.callbacks,this.callbacks,o.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1,cached:!0},u=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),i,o.runId,void 0,l,void 0,void 0,o.runName)),d=[],p=(await Promise.allSettled(i.map(async(m,v)=>{const b=si._convertInputToPromptValue(m).toString(),w=await n.lookup(b,r);return w==null&&d.push(v),w}))).map((m,v)=>({result:m,runManager:u==null?void 0:u[v]})).filter(({result:m})=>m.status==="fulfilled"&&m.value!=null||m.status==="rejected"),f=[];await Promise.all(p.map(async({result:m,runManager:v},b)=>{if(m.status==="fulfilled"){const w=m.value;return f[b]=w,w.length&&await(v==null?void 0:v.handleLLMNewToken(w[0].text)),v==null?void 0:v.handleLLMEnd({generations:[w]})}else return await(v==null?void 0:v.handleLLMError(m.reason)),Promise.reject(m.reason)}));const y={generations:f,missingPromptIndices:d};return Object.defineProperty(y,pK,{value:u?{runIds:u==null?void 0:u.map(m=>m.runId)}:void 0,configurable:!0}),y}async generate(t,n,r){let a;Array.isArray(n)?a={stop:n}:a=n;const o=t.map(f=>f.map($p)),[i,s]=this._separateRunnableConfigFromCallOptionsCompat(a);if(i.callbacks=i.callbacks??r,!this.cache)return this._generateUncached(o,s,i);const{cache:c}=this,l=this._getSerializedCacheKeyParametersForCall(s),{generations:u,missingPromptIndices:d}=await this._generateCached({messages:o,cache:c,llmStringKey:l,parsedOptions:s,handledOptions:i});let p={};if(d.length>0){const f=await this._generateUncached(d.map(y=>o[y]),s,i);await Promise.all(f.generations.map(async(y,m)=>{const v=d[m];u[v]=y;const b=si._convertInputToPromptValue(o[v]).toString();return c.update(b,l,y)})),p=f.llmOutput??{}}return{generations:u,llmOutput:p}}invocationParams(t){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(t,n,r){const a=t.map(o=>o.toChatMessages());return this.generate(a,n,r)}async call(t,n,r){return(await this.generate([t.map($p)],n,r)).generations[0][0].message}async callPrompt(t,n,r){const a=t.toChatMessages();return this.call(a,n,r)}async predictMessages(t,n,r){return this.call(t,n,r)}async predict(t,n,r){const a=new Pr(t),o=await this.call([a],n,r);if(typeof o.content!="string")throw new Error("Cannot use predict when output is not a string.");return o.content}withStructuredOutput(t,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');const r=t,a=n==null?void 0:n.name,o=r.description??"A function available to call.",i=n==null?void 0:n.method,s=n==null?void 0:n.includeRaw;if(i==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let c=a??"extract",l;T6(r)?l=[{type:"function",function:{name:c,description:o,parameters:EN(r)}}]:("name"in r&&(c=r.name),l=[{type:"function",function:{name:c,description:o,parameters:r}}]);const u=this.bindTools(l),d=MAe.from(m=>{if(!m.tool_calls||m.tool_calls.length===0)throw new Error("No tool calls found in the response.");const v=m.tool_calls.find(b=>b.name===c);if(!v)throw new Error(`No tool call found with name ${c}.`);return v.args});if(!s)return u.pipe(d).withConfig({runName:"StructuredOutput"});const p=fm.assign({parsed:(m,v)=>d.invoke(m.raw,v)}),f=fm.assign({parsed:()=>null}),y=p.withFallbacks({fallbacks:[f]});return fK.from([{raw:u},y]).withConfig({runName:"StructuredOutputRunnable"})}}class Pde extends Lp{parseResultWithPrompt(t,n,r){return this.parseResult(t,r)}_baseMessageToString(t){return typeof t.content=="string"?t.content:this._baseMessageContentToString(t.content)}_baseMessageContentToString(t){return JSON.stringify(t)}async invoke(t,n){return typeof t=="string"?this._callWithConfig(async(r,a)=>this.parseResult([{text:r}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"}):this._callWithConfig(async(r,a)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],a==null?void 0:a.callbacks),t,{...n,runType:"parser"})}}class I6 extends Pde{parseResult(t,n){return this.parse(t[0].text,n)}async parseWithPrompt(t,n,r){return this.parse(t,r)}_type(){throw new Error("_type not implemented")}}class sj extends Error{constructor(t,n,r,a=!1){if(super(t),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=r,this.sendToLLM=a,a&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}function cj(e,t){const n=typeof e;if(n!==typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;const r=e.length;if(r!==t.length)return!1;for(let a=0;a<r;a++)if(!cj(e[a],t[a]))return!1;return!0}if(n==="object"){if(!e||!t)return e===t;const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(const o of r)if(!cj(e[o],t[o]))return!1;return!0}return e===t}class kde extends I6{async*_transform(t){for await(const n of t)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:this._baseMessageToString(n)}])}async*transform(t,n){yield*this._transformStreamWithConfig(t,this._transform.bind(this),{...n,runType:"parser"})}}class R6 extends kde{constructor(t){super(t),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(t==null?void 0:t.diff)??this.diff}async*_transform(t){let n,r;for await(const a of t){if(typeof a!="string"&&typeof a.content!="string")throw new Error("Cannot handle non-string output.");let o;if(PAe(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new Mg({message:a,text:a.content})}else if(kAe(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new Mg({message:AAe(a),text:a.content})}else o=new TAe({text:a});r===void 0?r=o:r=r.concat(o);const i=await this.parsePartialResult([r]);i!=null&&!cj(i,n)&&(this.diff?yield this._diff(n,i):yield i,n=i)}}getFormatInstructions(){return""}}class D6 extends I6{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(t){super(t),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(t){return new this(t)}static fromNamesAndDescriptions(t){const n=fa.object(Object.fromEntries(Object.entries(t).map(([r,a])=>[r,fa.string().describe(a)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(EN(this.schema))}
\`\`\`
`}async parse(t){try{const n=(t.includes("```")?t.trim().split(/```(?:json)?/)[1]:t.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(r,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(n){throw new sj(`Failed to parse. Text: "${t}". Error: ${n}`,t)}}}class L6 extends R6{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(t,n){if(n)return t?BK(t,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(t){return hK(t[0].text)}async parse(t){return hK(t,JSON.parse)}getFormatInstructions(){return""}}function $6(e,t){if(e.function===void 0)return;let n;if(t!=null&&t.partial)try{n=IAe(e.function.arguments??"{}")}catch{return}else try{n=JSON.parse(e.function.arguments)}catch(a){throw new sj([`Function "${e.function.name}" arguments:`,"",e.function.arguments,"","are not valid JSON.",`Error: ${a.message}`].join(`
`))}const r={name:e.function.name,args:n,type:"tool_call"};return t!=null&&t.returnId&&(r.id=e.id),r}function Ade(e){if(e.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}}function Tde(e,t){var n,r;return{name:(n=e.function)==null?void 0:n.name,args:(r=e.function)==null?void 0:r.arguments,id:e.id,error:t,type:"invalid_tool_call"}}class Ide extends R6{static lc_name(){return"JsonOutputToolsParser"}constructor(t){super(t),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(t==null?void 0:t.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(t){return await this.parsePartialResult(t,!1)}async parsePartialResult(t,n=!0){var i;const r=t[0].message;let a;if(ON(r)&&((i=r.tool_calls)!=null&&i.length)?a=r.tool_calls.map(s=>{const{id:c,...l}=s;return this.returnId?{id:c,...l}:l}):r.additional_kwargs.tool_calls!==void 0&&(a=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(s=>$6(s,{returnId:this.returnId,partial:n}))),!a)return[];const o=[];for(const s of a)if(s!==void 0){const c={type:s.name,args:s.args,id:s.id};o.push(c)}return o}}class F6 extends Ide{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=t.keyName,this.returnSingle=t.returnSingle??this.returnSingle,this.zodSchema=t.zodSchema}async _validateResult(t){if(this.zodSchema===void 0)return t;const n=await this.zodSchema.safeParseAsync(t);if(n.success)return n.data;throw new sj(`Failed to parse. Text: "${JSON.stringify(t,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(t,null,2))}async parsePartialResult(t){const n=(await super.parsePartialResult(t)).filter(a=>a.type===this.keyName);let r=n;if(n.length)return this.returnId||(r=n.map(a=>a.args)),this.returnSingle?r[0]:r}async parseResult(t){const n=(await super.parsePartialResult(t,!1)).filter(a=>a.type===this.keyName);let r=n;return n.length?(this.returnId||(r=n.map(a=>a.args)),this.returnSingle?this._validateResult(r[0]):await Promise.all(r.map(a=>this._validateResult(a)))):void 0}}const Rde=Symbol("Let zodToJsonSchema decide on which parser to use"),Dde={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Lde=e=>({...Dde,...e}),$de=e=>{const t=Lde(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function B6(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function _t(e,t,n,r,a){e[t]=n,B6(e,t,r,a)}function Fde(){return{}}function Bde(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==me.ZodAny&&(n.items=mt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&_t(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&_t(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(_t(n,"minItems",e.exactLength.value,e.exactLength.message,t),_t(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function zde(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?_t(n,"minimum",r.value,r.message,t):_t(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),_t(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?_t(n,"maximum",r.value,r.message,t):_t(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),_t(n,"maximum",r.value,r.message,t));break;case"multipleOf":_t(n,"multipleOf",r.value,r.message,t);break}return n}function Vde(){return{type:"boolean"}}function Ude(e,t){return mt(e.type._def,t)}const Wde=(e,t)=>mt(e.innerType._def,t);function z6(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>z6(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Hde(e,t)}}const Hde=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":_t(n,"minimum",r.value,r.message,t);break;case"max":_t(n,"maximum",r.value,r.message,t);break}return n};function qde(e,t){return{...mt(e.innerType._def,t),default:e.defaultValue()}}function Kde(e,t){return t.effectStrategy==="input"?mt(e.schema._def,t):{}}function Xde(e){return{type:"string",enum:e.values}}const Zde=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Gde(e,t){const n=[mt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),mt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(Zde(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Qde(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let lj;const Ji={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(lj===void 0&&(lj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),lj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function V6(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?Yde(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":_t(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":_t(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":Jr(n,"email",a.message,t);break;case"format:idn-email":Jr(n,"idn-email",a.message,t);break;case"pattern:zod":ea(n,Ji.email,a.message,t);break}break;case"url":Jr(n,"uri",a.message,t);break;case"uuid":Jr(n,"uuid",a.message,t);break;case"regex":ea(n,a.regex,a.message,t);break;case"cuid":ea(n,Ji.cuid,a.message,t);break;case"cuid2":ea(n,Ji.cuid2,a.message,t);break;case"startsWith":ea(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":ea(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":Jr(n,"date-time",a.message,t);break;case"date":Jr(n,"date",a.message,t);break;case"time":Jr(n,"time",a.message,t);break;case"duration":Jr(n,"duration",a.message,t);break;case"length":_t(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),_t(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{ea(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&Jr(n,"ipv4",a.message,t),a.version!=="v4"&&Jr(n,"ipv6",a.message,t);break}case"emoji":ea(n,Ji.emoji,a.message,t);break;case"ulid":{ea(n,Ji.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{Jr(n,"binary",a.message,t);break}case"contentEncoding:base64":{_t(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{ea(n,Ji.base64,a.message,t);break}}break}case"nanoid":ea(n,Ji.nanoid,a.message,t)}return n}const Yde=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),Jr=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):_t(e,"format",t,n,r)},ea=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:U6(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):_t(e,"pattern",U6(t,r),n,r)},U6=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function W6(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===me.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===me.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(V6(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===me.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Jde(e,t){if(t.mapStrategy==="record")return W6(e,t);const n=mt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function epe(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function tpe(){return{not:{}}}function npe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const hm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function rpe(e,t){if(t.target==="openApi3")return H6(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in hm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=hm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return H6(e,t)}const H6=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>mt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function ape(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:hm[e.innerType._def.typeName],nullable:!0}:{type:[hm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=mt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=mt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function ope(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",B6(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?_t(n,"minimum",r.value,r.message,t):_t(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),_t(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?_t(n,"maximum",r.value,r.message,t):_t(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),_t(n,"maximum",r.value,r.message,t));break;case"multipleOf":_t(n,"multipleOf",r.value,r.message,t);break}return n}function ipe(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":mt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":mt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function spe(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=mt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:ipe(e,t)};return n.required.length||delete n.required,n}const cpe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return mt(e.innerType._def,t);const n=mt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},lpe=(e,t)=>{if(t.pipeStrategy==="input")return mt(e.in._def,t);if(t.pipeStrategy==="output")return mt(e.out._def,t);const n=mt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=mt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function upe(e,t){return mt(e.type._def,t)}function dpe(e,t){const n={type:"array",uniqueItems:!0,items:mt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&_t(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&_t(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function ppe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>mt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:mt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>mt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function fpe(){return{not:{}}}function hpe(){return{}}const mpe=(e,t)=>mt(e.innerType._def,t);function mt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==Rde)return s}if(r&&!n){const s=ype(r,t);if(s!==void 0)return s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=vpe(e,e.typeName,t);return o&&bpe(e,t,o),a.jsonSchema=o,o}const ype=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:gpe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},gpe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},vpe=(e,t,n)=>{switch(t){case me.ZodString:return V6(e,n);case me.ZodNumber:return ope(e,n);case me.ZodObject:return spe(e,n);case me.ZodBigInt:return zde(e,n);case me.ZodBoolean:return Vde();case me.ZodDate:return z6(e,n);case me.ZodUndefined:return fpe();case me.ZodNull:return npe(n);case me.ZodArray:return Bde(e,n);case me.ZodUnion:case me.ZodDiscriminatedUnion:return rpe(e,n);case me.ZodIntersection:return Gde(e,n);case me.ZodTuple:return ppe(e,n);case me.ZodRecord:return W6(e,n);case me.ZodLiteral:return Qde(e,n);case me.ZodEnum:return Xde(e);case me.ZodNativeEnum:return epe(e);case me.ZodNullable:return ape(e,n);case me.ZodOptional:return cpe(e,n);case me.ZodMap:return Jde(e,n);case me.ZodSet:return dpe(e,n);case me.ZodLazy:return mt(e.getter()._def,n);case me.ZodPromise:return upe(e,n);case me.ZodNaN:case me.ZodNever:return tpe();case me.ZodEffects:return Kde(e,n);case me.ZodAny:return Fde();case me.ZodUnknown:return hpe();case me.ZodDefault:return qde(e,n);case me.ZodBranded:return Ude(e,n);case me.ZodReadonly:return mpe(e,n);case me.ZodCatch:return Wde(e,n);case me.ZodPipeline:return lpe(e,n);case me.ZodFunction:case me.ZodVoid:case me.ZodSymbol:return;default:return(r=>{})()}},bpe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),wpe=(e,t)=>{const n=$de(t),r=void 0,a=t==null?void 0:t.name,o=mt(e._def,n,!1)??{},i=a===void 0?r?{...o,[n.definitionPath]:r}:o:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:o}};return n.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),i},xpe=Symbol("Let zodToJsonSchema decide on which parser to use"),q6={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},_pe=e=>typeof e=="string"?{...q6,basePath:["#"],definitions:{},name:e}:{...q6,basePath:["#"],definitions:{},...e},uj=e=>"_def"in e?e._def:e;function jpe(e){if(!e)return!0;for(const t in e)return!1;return!0}const Spe=e=>{const t=_pe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[uj(a),{def:uj(a),path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function K6(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function jt(e,t,n,r,a){e[t]=n,K6(e,t,r,a)}function Epe(){return{}}function Ope(e,t){var r,a;const n={type:"array"};return((a=(r=e.type)==null?void 0:r._def)==null?void 0:a.typeName)!==me.ZodAny&&(n.items=dt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&jt(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&jt(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(jt(n,"minItems",e.exactLength.value,e.exactLength.message,t),jt(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function Cpe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?jt(n,"minimum",r.value,r.message,t):jt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),jt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?jt(n,"maximum",r.value,r.message,t):jt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),jt(n,"maximum",r.value,r.message,t));break;case"multipleOf":jt(n,"multipleOf",r.value,r.message,t);break}return n}function Npe(){return{type:"boolean"}}function Mpe(e,t){return dt(e.type._def,t)}const Ppe=(e,t)=>dt(e.innerType._def,t);function X6(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>X6(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return kpe(e,t)}}const kpe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":jt(n,"minimum",r.value,r.message,t);break;case"max":jt(n,"maximum",r.value,r.message,t);break}return n};function Ape(e,t){return{...dt(e.innerType._def,t),default:e.defaultValue()}}function Tpe(e,t,n){return t.effectStrategy==="input"?dt(e.schema._def,t,n):{}}function Ipe(e){return{type:"string",enum:[...e.values]}}const Rpe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Dpe(e,t){const n=[dt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),dt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(o=>{if(Rpe(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let i=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:s,...c}=o;i=c}else r=void 0;a.push(i)}}),a.length?{allOf:a,...r}:void 0}function Lpe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let dj;const es={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(dj===void 0&&(dj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),dj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function Z6(e,t){const n={type:"string"};function r(a){return t.patternStrategy==="escape"?$pe(a):a}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":jt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":jt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ta(n,"email",a.message,t);break;case"format:idn-email":ta(n,"idn-email",a.message,t);break;case"pattern:zod":na(n,es.email,a.message,t);break}break;case"url":ta(n,"uri",a.message,t);break;case"uuid":ta(n,"uuid",a.message,t);break;case"regex":na(n,a.regex,a.message,t);break;case"cuid":na(n,es.cuid,a.message,t);break;case"cuid2":na(n,es.cuid2,a.message,t);break;case"startsWith":na(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":na(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":ta(n,"date-time",a.message,t);break;case"date":ta(n,"date",a.message,t);break;case"time":ta(n,"time",a.message,t);break;case"duration":ta(n,"duration",a.message,t);break;case"length":jt(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,a.value):a.value,a.message,t),jt(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":{na(n,RegExp(r(a.value)),a.message,t);break}case"ip":{a.version!=="v6"&&ta(n,"ipv4",a.message,t),a.version!=="v4"&&ta(n,"ipv6",a.message,t);break}case"emoji":na(n,es.emoji,a.message,t);break;case"ulid":{na(n,es.ulid,a.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ta(n,"binary",a.message,t);break}case"contentEncoding:base64":{jt(n,"contentEncoding","base64",a.message,t);break}case"pattern:zod":{na(n,es.base64,a.message,t);break}}break}case"nanoid":na(n,es.nanoid,a.message,t)}return n}const $pe=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),ta=(e,t,n,r)=>{var a;e.format||(a=e.anyOf)!=null&&a.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):jt(e,"format",t,n,r)},na=(e,t,n,r)=>{var a;e.pattern||(a=e.allOf)!=null&&a.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:G6(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):jt(e,"pattern",G6(t,r),n,r)},G6=(e,t)=>{var l;const n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source;let o="",i=!1,s=!1,c=!1;for(let u=0;u<a.length;u++){if(i){o+=a[u],i=!1;continue}if(r.i){if(s){if(a[u].match(/[a-z]/)){c?(o+=a[u],o+=`${a[u-2]}-${a[u]}`.toUpperCase(),c=!1):a[u+1]==="-"&&((l=a[u+2])!=null&&l.match(/[a-z]/))?(o+=a[u],c=!0):o+=`${a[u]}${a[u].toUpperCase()}`;continue}}else if(a[u].match(/[a-z]/)){o+=`[${a[u]}${a[u].toUpperCase()}]`;continue}}if(r.m){if(a[u]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[u]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&a[u]==="."){o+=s?`${a[u]}\r
`:`[${a[u]}\r
]`;continue}o+=a[u],a[u]==="\\"?i=!0:s&&a[u]==="]"?s=!1:!s&&a[u]==="["&&(s=!0)}try{const u=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function Q6(e,t){var r,a,o,i;if(t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===me.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((s,c)=>({...s,[c]:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===me.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const s=Object.entries(Z6(e.keyType._def,t)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...n,propertyNames:s}}else if(((i=e.keyType)==null?void 0:i._def.typeName)===me.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};return n}function Fpe(e,t){if(t.mapStrategy==="record")return Q6(e,t);const n=dt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function Bpe(e){const t=e.values,n=Object.keys(e.values).filter(a=>typeof t[t[a]]!="number").map(a=>t[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function zpe(){return{not:{}}}function Vpe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const mm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Upe(e,t){if(t.target==="openApi3")return Y6(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in mm&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,o)=>{const i=mm[o._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,o)=>{const i=typeof o._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((o,i,s)=>s.indexOf(o)===i);return{type:a.length>1?a:a[0],enum:n.reduce((o,i)=>o.includes(i._def.value)?o:[...o,i._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return Y6(e,t)}const Y6=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>dt(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Wpe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"||t.nullableStrategy==="property"?{type:mm[e.innerType._def.typeName],nullable:!0}:{type:[mm[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=dt(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=dt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Hpe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",K6(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?jt(n,"minimum",r.value,r.message,t):jt(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),jt(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?jt(n,"maximum",r.value,r.message,t):jt(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),jt(n,"maximum",r.value,r.message,t));break;case"multipleOf":jt(n,"multipleOf",r.value,r.message,t);break}return n}function qpe(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":dt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":dt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function Kpe(e,t){const n={type:"object",...Object.entries(e.shape()).reduce((r,[a,o])=>{if(o===void 0||o._def===void 0)return r;const i=dt(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return i===void 0?r:{properties:{...r.properties,[a]:i},required:o.isOptional()&&!t.openaiStrictMode?r.required:[...r.required,a]}},{properties:{},required:[]}),additionalProperties:qpe(e,t)};return n.required.length||delete n.required,n}const Xpe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return dt(e.innerType._def,t);const n=dt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Zpe=(e,t)=>{if(t.pipeStrategy==="input")return dt(e.in._def,t);if(t.pipeStrategy==="output")return dt(e.out._def,t);const n=dt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=dt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function Gpe(e,t){return dt(e.type._def,t)}function Qpe(e,t){const n={type:"array",uniqueItems:!0,items:dt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&jt(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&jt(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Ype(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>dt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:dt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>dt(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Jpe(){return{not:{}}}function efe(){return{}}const tfe=(e,t)=>dt(e.innerType._def,t);function dt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const s=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(s!==xpe)return s}if(r&&!n){const s=nfe(r,t);if(s!==void 0)return"$ref"in s&&t.seenRefs.add(s.$ref),s}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const o=afe(e,e.typeName,t,n);return o&&ofe(e,t,o),a.jsonSchema=o,o}const nfe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":const n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&t.nameStrategy==="duplicate-ref"&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:rfe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,a)=>t.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},rfe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},afe=(e,t,n,r)=>{switch(t){case me.ZodString:return Z6(e,n);case me.ZodNumber:return Hpe(e,n);case me.ZodObject:return Kpe(e,n);case me.ZodBigInt:return Cpe(e,n);case me.ZodBoolean:return Npe();case me.ZodDate:return X6(e,n);case me.ZodUndefined:return Jpe();case me.ZodNull:return Vpe(n);case me.ZodArray:return Ope(e,n);case me.ZodUnion:case me.ZodDiscriminatedUnion:return Upe(e,n);case me.ZodIntersection:return Dpe(e,n);case me.ZodTuple:return Ype(e,n);case me.ZodRecord:return Q6(e,n);case me.ZodLiteral:return Lpe(e,n);case me.ZodEnum:return Ipe(e);case me.ZodNativeEnum:return Bpe(e);case me.ZodNullable:return Wpe(e,n);case me.ZodOptional:return Xpe(e,n);case me.ZodMap:return Fpe(e,n);case me.ZodSet:return Qpe(e,n);case me.ZodLazy:return dt(e.getter()._def,n);case me.ZodPromise:return Gpe(e,n);case me.ZodNaN:case me.ZodNever:return zpe();case me.ZodEffects:return Tpe(e,n,r);case me.ZodAny:return Epe();case me.ZodUnknown:return efe();case me.ZodDefault:return Ape(e,n);case me.ZodBranded:return Mpe(e,n);case me.ZodReadonly:return tfe(e,n);case me.ZodCatch:return Ppe(e,n);case me.ZodPipeline:return Zpe(e,n);case me.ZodFunction:case me.ZodVoid:case me.ZodSymbol:return;default:return(a=>{})()}},ofe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),ife=(e,t)=>{const n=Spe(t),r=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,a=dt(e._def,r===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},o=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;o!==void 0&&(a.title=o);const i=(()=>{if(jpe(n.definitions))return;const c={},l=new Set;for(let u=0;u<500;u++){const d=Object.entries(n.definitions).filter(([p])=>!l.has(p));if(d.length===0)break;for(const[p,f]of d)c[p]=dt(uj(f),{...n,currentPath:[...n.basePath,n.definitionPath,p]},!0)??{},l.add(p)}return c})(),s=r===void 0?i?{...a,[n.definitionPath]:i}:a:n.nameStrategy==="duplicate-ref"?{...a,...i||n.seenRefs.size?{[n.definitionPath]:{...i,...n.seenRefs.size?{[r]:a}:void 0}}:void 0}:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...i,[r]:a}};return n.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s};function J6(e,t){return ife(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function sfe(e,t,n){return ide({type:"json_schema",json_schema:{...n,name:t,strict:!0,schema:J6(e,{name:t})}},r=>e.parse(JSON.parse(r)))}function cfe(e){return sde({type:"function",function:{name:e.name,parameters:J6(e.parameters,{name:e.name}),strict:!0,...e.description?{description:e.description}:void 0}},{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})}function lfe(e){const{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:a,baseURL:o,azureADTokenProvider:i,azureOpenAIEndpoint:s}=e;if((r||i)&&a&&t)return`${a}/${t}`;if((r||i)&&s&&t)return`${s}/openai/deployments/${t}`;if(r||i){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${t}`}return o}function ufe(e,t){const n=typeof t=="number"?void 0:t;return{name:e.name,description:e.description,parameters:EN(e.schema),...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}}function dfe(e){return e!==void 0&&Array.isArray(e.lc_namespace)}function pfe(e){return e!==void 0&&Lp.isRunnable(e)&&"lc_name"in e.constructor&&typeof e.constructor.lc_name=="function"&&e.constructor.lc_name()==="RunnableToolLike"}function ffe(e){return!!e&&typeof e=="object"&&"name"in e&&"schema"in e&&T6(e.schema)}function hfe(e){return ffe(e)||pfe(e)||dfe(e)}function ym(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/
`,e}function e8(e){let t;return e.constructor.name===Xh.name?(t=new Error(e.message),t.name="TimeoutError"):e.constructor.name===wr.name?(t=new Error(e.message),t.name="AbortError"):e.status===400&&e.message.includes("tool_calls")?t=ym(e,"INVALID_TOOL_RESULTS"):e.status===401?t=ym(e,"MODEL_AUTHENTICATION"):e.status===429?t=ym(e,"MODEL_RATE_LIMIT"):e.status===404?t=ym(e,"MODEL_NOT_FOUND"):t=e,t}function mfe(e){if(e)return e==="any"||e==="required"?"required":e==="auto"?"auto":e==="none"?"none":typeof e=="string"?{type:"function",function:{name:e}}:e}function yfe(e){return e.anyOf!==void 0&&Array.isArray(e.anyOf)}function gfe(e){const t=["namespace functions {",""];for(const n of e)n.description&&t.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(t.push(`type ${n.name} = (_: {`),t.push(t8(n.parameters,0)),t.push("}) => any;")):t.push(`type ${n.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join(`
`)}function t8(e,t){var r;const n=[];for(const[a,o]of Object.entries(e.properties??{}))o.description&&t<2&&n.push(`// ${o.description}`),(r=e.required)!=null&&r.includes(a)?n.push(`${a}: ${gm(o,t)},`):n.push(`${a}?: ${gm(o,t)},`);return n.map(a=>" ".repeat(t)+a).join(`
`)}function gm(e,t){if(yfe(e))return e.anyOf.map(n=>gm(n,t)).join(" | ");switch(e.type){case"string":return e.enum?e.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return e.enum?e.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",t8(e,t+2),"}"].join(`
`);case"array":return e.items?`${gm(e.items,t)}[]`:"any[]";default:return""}}function vfe(e,t){let n;if(hfe(e)){const r=cfe({name:e.name,parameters:e.schema,description:e.description});r.function.parameters?n={type:r.type,function:{name:r.function.name,description:r.function.description,parameters:r.function.parameters,...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}}:n={type:"function",function:ufe(e,t)}}else n=e;return(t==null?void 0:t.strict)!==void 0&&(n.function.strict=t.strict),n}function bfe(e){return e.role!=="system"&&e.role!=="developer"&&e.role!=="assistant"&&e.role!=="user"&&e.role!=="function"&&e.role!=="tool"&&console.warn(`Unknown message role: ${e.role}`),e.role}function n8(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!yK.isInstance(e))throw new Error("Invalid generic chat message");return bfe(e)}default:throw new Error(`Unknown message type: ${t}`)}}function wfe(e,t,n){const r=e.tool_calls;switch(e.role){case"assistant":{const a=[],o=[];for(const c of r??[])try{a.push($6(c,{returnId:!0}))}catch(l){o.push(Tde(c,l.message))}const i={function_call:e.function_call,tool_calls:r};n!==void 0&&(i.__raw_response=t);const s={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(i.audio=e.audio),new Uo({content:e.content||"",tool_calls:a,invalid_tool_calls:o,additional_kwargs:i,response_metadata:s,id:t.id})}default:return new yK(e.content||"",e.role??"unknown")}}function xfe(e,t,n,r){var c,l;const a=e.role??n,o=e.content??"";let i;e.function_call?i={function_call:e.function_call}:e.tool_calls?i={tool_calls:e.tool_calls}:i={},r&&(i.__raw_response=t),e.audio&&(i.audio={...e.audio,index:t.choices[0].index});const s={usage:{...t.usage}};if(a==="user")return new RAe({content:o,response_metadata:s});if(a==="assistant"){const u=[];if(Array.isArray(e.tool_calls))for(const d of e.tool_calls)u.push({name:(c=d.function)==null?void 0:c.name,args:(l=d.function)==null?void 0:l.arguments,id:d.id,index:d.index,type:"tool_call_chunk"});return new mK({content:o,tool_call_chunks:u,additional_kwargs:i,id:t.id,response_metadata:s})}else return a==="system"?new gK({content:o,response_metadata:s}):a==="developer"?new gK({content:o,response_metadata:s,additional_kwargs:{__openai_role__:"developer"}}):a==="function"?new DAe({content:o,additional_kwargs:i,name:e.name,response_metadata:s}):a==="tool"?new LAe({content:o,additional_kwargs:i,tool_call_id:e.tool_call_id,response_metadata:s}):new $Ae({content:o,role:a,response_metadata:s})}function r8(e,t){return e.flatMap(n=>{var o;let r=n8(n);r==="system"&&(t!=null&&t.startsWith("o1"))&&(r="developer");const a={role:r,content:n.content};if(n.name!=null&&(a.name=n.name),n.additional_kwargs.function_call!=null&&(a.function_call=n.additional_kwargs.function_call,a.content=null),ON(n)&&((o=n.tool_calls)!=null&&o.length)?(a.tool_calls=n.tool_calls.map(Ade),a.content=null):(n.additional_kwargs.tool_calls!=null&&(a.tool_calls=n.additional_kwargs.tool_calls),n.tool_call_id!=null&&(a.tool_call_id=n.tool_call_id)),n.additional_kwargs.audio&&typeof n.additional_kwargs.audio=="object"&&"id"in n.additional_kwargs.audio){const i={role:"assistant",audio:{id:n.additional_kwargs.audio.id}};return[a,i]}return a})}function a8(e,t){return Ode(e)?(t==null?void 0:t.strict)!==void 0?{...e,function:{...e.function,strict:t.strict}}:e:vfe(e,t)}class _fe extends si{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(t,n){var r,a,o,i,s,c,l,u,d;if(super(t??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(t==null?void 0:t.apiKey)??(t==null?void 0:t.openAIApiKey)??((r=t==null?void 0:t.configuration)==null?void 0:r.apiKey)??Ci("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(t==null?void 0:t.azureOpenAIApiKey)??Ci("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(t==null?void 0:t.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(t==null?void 0:t.azureOpenAIApiInstanceName)??Ci("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(t==null?void 0:t.azureOpenAIApiDeploymentName)??Ci("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(t==null?void 0:t.azureOpenAIApiVersion)??Ci("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(t==null?void 0:t.azureOpenAIBasePath)??Ci("AZURE_OPENAI_BASE_PATH"),this.organization=((a=t==null?void 0:t.configuration)==null?void 0:a.organization)??Ci("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=(t==null?void 0:t.azureOpenAIEndpoint)??Ci("AZURE_OPENAI_ENDPOINT"),this.modelName=(t==null?void 0:t.model)??(t==null?void 0:t.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(t==null?void 0:t.modelKwargs)??{},this.timeout=t==null?void 0:t.timeout,this.temperature=(t==null?void 0:t.temperature)??this.temperature,this.topP=(t==null?void 0:t.topP)??this.topP,this.frequencyPenalty=(t==null?void 0:t.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(t==null?void 0:t.presencePenalty)??this.presencePenalty,this.maxTokens=t==null?void 0:t.maxTokens,this.logprobs=t==null?void 0:t.logprobs,this.topLogprobs=t==null?void 0:t.topLogprobs,this.n=(t==null?void 0:t.n)??this.n,this.logitBias=t==null?void 0:t.logitBias,this.stop=(t==null?void 0:t.stopSequences)??(t==null?void 0:t.stop),this.stopSequences=this==null?void 0:this.stop,this.user=t==null?void 0:t.user,this.__includeRawResponse=t==null?void 0:t.__includeRawResponse,this.audio=t==null?void 0:t.audio,this.modalities=t==null?void 0:t.modalities,this.reasoningEffort=t==null?void 0:t.reasoningEffort,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const p=this.azureOpenAIBasePath.split("/openai/deployments/");if(p.length===2){const[,f]=p;this.azureOpenAIApiDeploymentName=f}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.model==="o1"&&(this.disableStreaming=!0),this.streaming=(t==null?void 0:t.streaming)??!1,this.streamUsage=(t==null?void 0:t.streamUsage)??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(n==null?void 0:n.basePath)??((o=t==null?void 0:t.configuration)==null?void 0:o.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((i=n==null?void 0:n.baseOptions)==null?void 0:i.headers)??((c=(s=t==null?void 0:t.configuration)==null?void 0:s.baseOptions)==null?void 0:c.headers),defaultQuery:((l=n==null?void 0:n.baseOptions)==null?void 0:l.params)??((d=(u=t==null?void 0:t.configuration)==null?void 0:u.baseOptions)==null?void 0:d.params),...n,...t==null?void 0:t.configuration},(t==null?void 0:t.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=t.supportsStrictToolCalling)}getLsParams(t){const n=this.invocationParams(t);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.max_tokens??void 0,ls_stop:t.stop}}bindTools(t,n){let r;return(n==null?void 0:n.strict)!==void 0?r=n.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:t.map(a=>a8(a,{strict:r})),...n})}createResponseFormat(t){return t&&t.type==="json_schema"&&t.json_schema.schema&&vm(t.json_schema.schema)?sfe(t.json_schema.schema,t.json_schema.name,{description:t.json_schema.description}):t}invocationParams(t,n){var s;let r;(t==null?void 0:t.strict)!==void 0?r=t.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling);let a={};(t==null?void 0:t.stream_options)!==void 0?a={stream_options:t.stream_options}:this.streamUsage&&(this.streaming||n!=null&&n.streaming)&&(a={stream_options:{include_usage:!0}});const o={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(t==null?void 0:t.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:t==null?void 0:t.functions,function_call:t==null?void 0:t.function_call,tools:(s=t==null?void 0:t.tools)!=null&&s.length?t.tools.map(c=>a8(c,{strict:r})):void 0,tool_choice:mfe(t==null?void 0:t.tool_choice),response_format:this.createResponseFormat(t==null?void 0:t.response_format),seed:t==null?void 0:t.seed,...a,parallel_tool_calls:t==null?void 0:t.parallel_tool_calls,...this.audio||t!=null&&t.audio?{audio:this.audio||(t==null?void 0:t.audio)}:{},...this.modalities||t!=null&&t.modalities?{modalities:this.modalities||(t==null?void 0:t.modalities)}:{},...this.modelKwargs};(t==null?void 0:t.prediction)!==void 0&&(o.prediction=t.prediction);const i=(t==null?void 0:t.reasoning_effort)??this.reasoningEffort;return i!==void 0&&(o.reasoning_effort=i),o}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(t,n,r){var l,u,d,p,f,y,m,v,b,w;const a=r8(t,this.model),o={...this.invocationParams(n,{streaming:!0}),messages:a,stream:!0};let i;const s=await this.completionWithRetry(o,n);let c;for await(const j of s){const x=(l=j==null?void 0:j.choices)==null?void 0:l[0];if(j.usage&&(c=j.usage),!x)continue;const{delta:_}=x;if(!_)continue;const S=xfe(_,j,i,this.__includeRawResponse);i=_.role??i;const E={prompt:n.promptIndex??0,completion:x.index??0};if(typeof S.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const O={...E};x.finish_reason!=null&&(O.finish_reason=x.finish_reason,O.system_fingerprint=j.system_fingerprint,O.model_name=j.model),this.logprobs&&(O.logprobs=x.logprobs);const M=new Mg({message:S,text:S.content,generationInfo:O});yield M,await(r==null?void 0:r.handleLLMNewToken(M.text??"",E,void 0,void 0,void 0,{chunk:M}))}if(c){const j={...((u=c.prompt_tokens_details)==null?void 0:u.audio_tokens)!==null&&{audio:(d=c.prompt_tokens_details)==null?void 0:d.audio_tokens},...((p=c.prompt_tokens_details)==null?void 0:p.cached_tokens)!==null&&{cache_read:(f=c.prompt_tokens_details)==null?void 0:f.cached_tokens}},x={...((y=c.completion_tokens_details)==null?void 0:y.audio_tokens)!==null&&{audio:(m=c.completion_tokens_details)==null?void 0:m.audio_tokens},...((v=c.completion_tokens_details)==null?void 0:v.reasoning_tokens)!==null&&{reasoning:(b=c.completion_tokens_details)==null?void 0:b.reasoning_tokens}};yield new Mg({message:new mK({content:"",response_metadata:{usage:{...c}},usage_metadata:{input_tokens:c.prompt_tokens,output_tokens:c.completion_tokens,total_tokens:c.total_tokens,...Object.keys(j).length>0&&{input_token_details:j},...Object.keys(x).length>0&&{output_token_details:x}}}),text:""})}if((w=n.signal)!=null&&w.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(t,n,r){var s,c;const a={},o=this.invocationParams(n),i=r8(t,this.model);if(o.stream){const l=this._streamResponseChunks(t,n,r),u={};for await(const v of l){v.message.response_metadata={...v.generationInfo,...v.message.response_metadata};const b=((s=v.generationInfo)==null?void 0:s.completion)??0;u[b]===void 0?u[b]=v:u[b]=u[b].concat(v)}const d=Object.entries(u).sort(([v],[b])=>parseInt(v,10)-parseInt(b,10)).map(([v,b])=>b),{functions:p,function_call:f}=this.invocationParams(n),y=await this.getEstimatedTokenCountFromPrompt(t,p,f),m=await this.getNumTokensFromGenerations(d);return a.input_tokens=y,a.output_tokens=m,a.total_tokens=y+m,{generations:d,llmOutput:{estimatedTokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}else{let l;n.response_format&&n.response_format.type==="json_schema"?l=await this.betaParsedCompletionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options}):l=await this.completionWithRetry({...o,stream:!1,messages:i},{signal:n==null?void 0:n.signal,...n==null?void 0:n.options});const{completion_tokens:u,prompt_tokens:d,total_tokens:p,prompt_tokens_details:f,completion_tokens_details:y}=(l==null?void 0:l.usage)??{};u&&(a.output_tokens=(a.output_tokens??0)+u),d&&(a.input_tokens=(a.input_tokens??0)+d),p&&(a.total_tokens=(a.total_tokens??0)+p),((f==null?void 0:f.audio_tokens)!==null||(f==null?void 0:f.cached_tokens)!==null)&&(a.input_token_details={...(f==null?void 0:f.audio_tokens)!==null&&{audio:f==null?void 0:f.audio_tokens},...(f==null?void 0:f.cached_tokens)!==null&&{cache_read:f==null?void 0:f.cached_tokens}}),((y==null?void 0:y.audio_tokens)!==null||(y==null?void 0:y.reasoning_tokens)!==null)&&(a.output_token_details={...(y==null?void 0:y.audio_tokens)!==null&&{audio:y==null?void 0:y.audio_tokens},...(y==null?void 0:y.reasoning_tokens)!==null&&{reasoning:y==null?void 0:y.reasoning_tokens}});const m=[];for(const v of(l==null?void 0:l.choices)??[]){const b={text:((c=v.message)==null?void 0:c.content)??"",message:wfe(v.message??{role:"assistant"},l,this.__includeRawResponse)};b.generationInfo={...v.finish_reason?{finish_reason:v.finish_reason}:{},...v.logprobs?{logprobs:v.logprobs}:{}},ON(b.message)&&(b.message.usage_metadata=a),b.message=new Uo(Object.fromEntries(Object.entries(b.message).filter(([w])=>!w.startsWith("lc_")))),m.push(b)}return{generations:m,llmOutput:{tokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(t,n,r){let a=(await this.getNumTokensFromMessages(t)).totalCount;if(n&&r!=="auto"){const o=gfe(n);a+=await this.getNumTokens(o),a+=9}return n&&t.find(o=>o._getType()==="system")&&(a-=4),r==="none"?a+=1:typeof r=="object"&&(a+=await this.getNumTokens(r.name)+4),a}async getNumTokensFromGenerations(t){return(await Promise.all(t.map(async n=>{var r;return(r=n.message.additional_kwargs)!=null&&r.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)}))).reduce((n,r)=>n+r,0)}async getNumTokensFromMessages(t){let n=0,r=0,a=0;this.model==="gpt-3.5-turbo-0301"?(r=4,a=-1):(r=3,a=1);const o=await Promise.all(t.map(async i=>{var p,f,y,m,v,b;const s=await this.getNumTokens(i.content),c=await this.getNumTokens(n8(i)),l=i.name!==void 0?a+await this.getNumTokens(i.name):0;let u=s+r+c+l;const d=i;if(d._getType()==="function"&&(u-=2),(p=d.additional_kwargs)!=null&&p.function_call&&(u+=3),(f=d==null?void 0:d.additional_kwargs.function_call)!=null&&f.name&&(u+=await this.getNumTokens((y=d.additional_kwargs.function_call)==null?void 0:y.name)),(m=d.additional_kwargs.function_call)==null?void 0:m.arguments)try{u+=await this.getNumTokens(JSON.stringify(JSON.parse((v=d.additional_kwargs.function_call)==null?void 0:v.arguments)))}catch(w){console.error("Error parsing function arguments",w,JSON.stringify(d.additional_kwargs.function_call)),u+=await this.getNumTokens((b=d.additional_kwargs.function_call)==null?void 0:b.arguments)}return n+=u,u}));return n+=3,{totalCount:n,countPerMessage:o}}async completionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(t,r)}catch(a){throw e8(a)}})}async betaParsedCompletionWithRetry(t,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(t,r)}catch(a){throw e8(a)}})}_getClientOptions(t){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},a=lfe(r),o={...this.clientConfig,baseURL:a,timeout:this.timeout,maxRetries:0};o.baseURL||delete o.baseURL,this.client=new it(o)}const n={...this.clientConfig,...t};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),n}_llmType(){return"openai"}_combineLLMOutput(...t){return t.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(t,n){let r,a,o,i;jfe(t)?(r=t.schema,a=t.name,o=t.method,i=t.includeRaw):(r=t,a=n==null?void 0:n.name,o=n==null?void 0:n.method,i=n==null?void 0:n.includeRaw);let s,c;if((n==null?void 0:n.strict)!==void 0&&o==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(o==="jsonMode")s=this.bind({response_format:{type:"json_object"}}),vm(r)?c=D6.fromZodSchema(r):c=new L6;else if(o==="jsonSchema")s=this.bind({response_format:{type:"json_schema",json_schema:{name:a??"extract",description:r.description,schema:r,strict:n==null?void 0:n.strict}}}),vm(r)?c=D6.fromZodSchema(r):c=new L6;else{let p=a??"extract";if(vm(r)){const f=wpe(r);s=this.bind({tools:[{type:"function",function:{name:p,description:f.description,parameters:f}}],tool_choice:{type:"function",function:{name:p}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new F6({returnSingle:!0,keyName:p,zodSchema:r})}else{let f;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(f=r,p=r.name):(p=r.title??p,f={name:p,description:r.description??"",parameters:r}),s=this.bind({tools:[{type:"function",function:f}],tool_choice:{type:"function",function:{name:p}},...(n==null?void 0:n.strict)!==void 0?{strict:n.strict}:{}}),c=new F6({returnSingle:!0,keyName:p})}}if(!i)return s.pipe(c);const l=fm.assign({parsed:(p,f)=>c.invoke(p.raw,f)}),u=fm.assign({parsed:()=>null}),d=l.withFallbacks({fallbacks:[u]});return fK.from([{raw:s},d])}}function vm(e){return typeof(e==null?void 0:e.parse)=="function"}function jfe(e){return e!==void 0&&typeof e.schema=="object"}class Sfe{constructor(){Ip(this,"sessionKeyProcess");Ip(this,"sessionKey");Ip(this,"loadded",!1);Ip(this,"sessionMemory",new Map);this.init()}async init(){if(this.loadded)return;const t={name:"AES-GCM",length:256},n=["encrypt","decrypt"];this.sessionKeyProcess=window.crypto.subtle.generateKey(t,!0,n).then(r=>r),this.sessionKey=await this.sessionKeyProcess,this.loadded=!0,this.sessionKeyProcess=void 0}async set(t,n){this.sessionKeyProcess&&await this.sessionKeyProcess;const r=await crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(12)},this.sessionKey,new TextEncoder().encode(n));this.sessionMemory.set(t,r)}async get(t){const n=this.sessionMemory.get(t);if(!n)return null;this.sessionKeyProcess&&await this.sessionKeyProcess;const r=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(12)},this.sessionKey,n);return new TextDecoder().decode(r)}async exists(t){return this.sessionMemory.has(t)}}const _d=new Sfe;var Efe=Object.defineProperty,Ofe=Object.defineProperties,Cfe=Object.getOwnPropertyDescriptors,bm=Object.getOwnPropertySymbols,o8=Object.prototype.hasOwnProperty,i8=Object.prototype.propertyIsEnumerable,s8=(e,t,n)=>t in e?Efe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Nfe=(e,t)=>{for(var n in t||(t={}))o8.call(t,n)&&s8(e,n,t[n]);if(bm)for(var n of bm(t))i8.call(t,n)&&s8(e,n,t[n]);return e},Mfe=(e,t)=>Ofe(e,Cfe(t)),Pfe=(e,t)=>{var n={};for(var r in e)o8.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&bm)for(var r of bm(e))t.indexOf(r)<0&&i8.call(e,r)&&(n[r]=e[r]);return n};function kfe(e){let t=setTimeout(e,0),n=setTimeout(e,10),r=setTimeout(e,50);return[t,n,r]}function Afe(e){let t=g.useRef();return g.useEffect(()=>{t.current=e}),t.current}var Tfe=18,c8=40,Ife=`${c8}px`,Rfe=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function Dfe({containerRef:e,inputRef:t,pushPasswordManagerStrategy:n,isFocused:r}){let[a,o]=g.useState(!1),[i,s]=g.useState(!1),[c,l]=g.useState(!1),u=g.useMemo(()=>n==="none"?!1:(n==="increase-width"||n==="experimental-no-flickering")&&a&&i,[a,i,n]),d=g.useCallback(()=>{let p=e.current,f=t.current;if(!p||!f||c||n==="none")return;let y=p,m=y.getBoundingClientRect().left+y.offsetWidth,v=y.getBoundingClientRect().top+y.offsetHeight/2,b=m-Tfe,w=v;document.querySelectorAll(Rfe).length===0&&document.elementFromPoint(b,w)===p||(o(!0),l(!0))},[e,t,c,n]);return g.useEffect(()=>{let p=e.current;if(!p||n==="none")return;function f(){let m=window.innerWidth-p.getBoundingClientRect().right;s(m>=c8)}f();let y=setInterval(f,1e3);return()=>{clearInterval(y)}},[e,n]),g.useEffect(()=>{let p=r||document.activeElement===t.current;if(n==="none"||!p)return;let f=setTimeout(d,0),y=setTimeout(d,2e3),m=setTimeout(d,5e3),v=setTimeout(()=>{l(!0)},6e3);return()=>{clearTimeout(f),clearTimeout(y),clearTimeout(m),clearTimeout(v)}},[t,r,n,d]),{hasPWMBadge:a,willPushPWMBadge:u,PWM_BADGE_SPACE_WIDTH:Ife}}var l8=g.createContext({}),u8=g.forwardRef((e,t)=>{var n=e,{value:r,onChange:a,maxLength:o,textAlign:i="left",pattern:s,placeholder:c,inputMode:l="numeric",onComplete:u,pushPasswordManagerStrategy:d="increase-width",pasteTransformer:p,containerClassName:f,noScriptCSSFallback:y=Lfe,render:m,children:v}=n,b=Pfe(n,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),w,j,x,_,S;let[E,O]=g.useState(typeof b.defaultValue=="string"?b.defaultValue:""),M=r??E,N=Afe(M),P=g.useCallback(re=>{a==null||a(re),O(re)},[a]),I=g.useMemo(()=>s?typeof s=="string"?new RegExp(s):s:null,[s]),k=g.useRef(null),C=g.useRef(null),T=g.useRef({value:M,onChange:P,isIOS:typeof window<"u"&&((j=(w=window==null?void 0:window.CSS)==null?void 0:w.supports)==null?void 0:j.call(w,"-webkit-touch-callout","none"))}),A=g.useRef({prev:[(x=k.current)==null?void 0:x.selectionStart,(_=k.current)==null?void 0:_.selectionEnd,(S=k.current)==null?void 0:S.selectionDirection]});g.useImperativeHandle(t,()=>k.current,[]),g.useEffect(()=>{let re=k.current,le=C.current;if(!re||!le)return;T.current.value!==re.value&&T.current.onChange(re.value),A.current.prev=[re.selectionStart,re.selectionEnd,re.selectionDirection];function je(){if(document.activeElement!==re){$(null),Y(null);return}let Se=re.selectionStart,Ve=re.selectionEnd,We=re.selectionDirection,He=re.maxLength,Mt=re.value,st=A.current.prev,rt=-1,bt=-1,Kt;if(Mt.length!==0&&Se!==null&&Ve!==null){let Va=Se===Ve,J=Se===Mt.length&&Mt.length<He;if(Va&&!J){let ne=Se;if(ne===0)rt=0,bt=1,Kt="forward";else if(ne===He)rt=ne-1,bt=ne,Kt="backward";else if(He>1&&Mt.length>1){let ce=0;if(st[0]!==null&&st[1]!==null){Kt=ne<st[1]?"backward":"forward";let he=st[0]===st[1]&&st[0]<He;Kt==="backward"&&!he&&(ce=-1)}rt=ce+ne,bt=ce+ne+1}}rt!==-1&&bt!==-1&&rt!==bt&&k.current.setSelectionRange(rt,bt,Kt)}let Gn=rt!==-1?rt:Se,za=bt!==-1?bt:Ve,Qn=Kt??We;$(Gn),Y(za),A.current.prev=[Gn,za,Qn]}if(document.addEventListener("selectionchange",je,{capture:!0}),je(),document.activeElement===re&&B(!0),!document.getElementById("input-otp-style")){let Se=document.createElement("style");if(Se.id="input-otp-style",document.head.appendChild(Se),Se.sheet){let Ve="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";jd(Se.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),jd(Se.sheet,`[data-input-otp]:autofill { ${Ve} }`),jd(Se.sheet,`[data-input-otp]:-webkit-autofill { ${Ve} }`),jd(Se.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),jd(Se.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let Le=()=>{le&&le.style.setProperty("--root-height",`${re.clientHeight}px`)};Le();let $e=new ResizeObserver(Le);return $e.observe(re),()=>{document.removeEventListener("selectionchange",je,{capture:!0}),$e.disconnect()}},[]);let[D,L]=g.useState(!1),[R,B]=g.useState(!1),[z,$]=g.useState(null),[V,Y]=g.useState(null);g.useEffect(()=>{kfe(()=>{var re,le,je,Le;(re=k.current)==null||re.dispatchEvent(new Event("input"));let $e=(le=k.current)==null?void 0:le.selectionStart,Se=(je=k.current)==null?void 0:je.selectionEnd,Ve=(Le=k.current)==null?void 0:Le.selectionDirection;$e!==null&&Se!==null&&($($e),Y(Se),A.current.prev=[$e,Se,Ve])})},[M,R]),g.useEffect(()=>{N!==void 0&&M!==N&&N.length<o&&M.length===o&&(u==null||u(M))},[o,u,N,M]);let G=Dfe({containerRef:C,inputRef:k,pushPasswordManagerStrategy:d,isFocused:R}),K=g.useCallback(re=>{let le=re.currentTarget.value.slice(0,o);if(le.length>0&&I&&!I.test(le)){re.preventDefault();return}typeof N=="string"&&le.length<N.length&&document.dispatchEvent(new Event("selectionchange")),P(le)},[o,P,N,I]),Q=g.useCallback(()=>{var re;if(k.current){let le=Math.min(k.current.value.length,o-1),je=k.current.value.length;(re=k.current)==null||re.setSelectionRange(le,je),$(le),Y(je)}B(!0)},[o]),q=g.useCallback(re=>{var le,je;let Le=k.current;if(!p&&(!T.current.isIOS||!re.clipboardData||!Le))return;let $e=re.clipboardData.getData("text/plain"),Se=p?p($e):$e;re.preventDefault();let Ve=(le=k.current)==null?void 0:le.selectionStart,We=(je=k.current)==null?void 0:je.selectionEnd,He=(Ve!==We?M.slice(0,Ve)+Se+M.slice(We):M.slice(0,Ve)+Se+M.slice(Ve)).slice(0,o);if(He.length>0&&I&&!I.test(He))return;Le.value=He,P(He);let Mt=Math.min(He.length,o-1),st=He.length;Le.setSelectionRange(Mt,st),$(Mt),Y(st)},[o,P,I,M]),H=g.useMemo(()=>({position:"relative",cursor:b.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[b.disabled]),X=g.useMemo(()=>({position:"absolute",inset:0,width:G.willPushPWMBadge?`calc(100% + ${G.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:G.willPushPWMBadge?`inset(0 ${G.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:i,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[G.PWM_BADGE_SPACE_WIDTH,G.willPushPWMBadge,i]),te=g.useMemo(()=>g.createElement("input",Mfe(Nfe({autoComplete:b.autoComplete||"one-time-code"},b),{"data-input-otp":!0,"data-input-otp-placeholder-shown":M.length===0||void 0,"data-input-otp-mss":z,"data-input-otp-mse":V,inputMode:l,pattern:I==null?void 0:I.source,"aria-placeholder":c,style:X,maxLength:o,value:M,ref:k,onPaste:re=>{var le;q(re),(le=b.onPaste)==null||le.call(b,re)},onChange:K,onMouseOver:re=>{var le;L(!0),(le=b.onMouseOver)==null||le.call(b,re)},onMouseLeave:re=>{var le;L(!1),(le=b.onMouseLeave)==null||le.call(b,re)},onFocus:re=>{var le;Q(),(le=b.onFocus)==null||le.call(b,re)},onBlur:re=>{var le;B(!1),(le=b.onBlur)==null||le.call(b,re)}})),[K,Q,q,l,X,o,V,z,b,I==null?void 0:I.source,M]),F=g.useMemo(()=>({slots:Array.from({length:o}).map((re,le)=>{var je;let Le=R&&z!==null&&V!==null&&(z===V&&le===z||le>=z&&le<V),$e=M[le]!==void 0?M[le]:null,Se=M[0]!==void 0?null:(je=c==null?void 0:c[le])!=null?je:null;return{char:$e,placeholderChar:Se,isActive:Le,hasFakeCaret:Le&&$e===null}}),isFocused:R,isHovering:!b.disabled&&D}),[R,D,o,V,z,b.disabled,M]),se=g.useMemo(()=>m?m(F):g.createElement(l8.Provider,{value:F},v),[v,F,m]);return g.createElement(g.Fragment,null,y!==null&&g.createElement("noscript",null,g.createElement("style",null,y)),g.createElement("div",{ref:C,"data-input-otp-container":!0,style:H,className:f},se,g.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},te)))});u8.displayName="Input";function jd(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var Lfe=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const pj=g.forwardRef(({className:e,containerClassName:t,...n},r)=>h.jsx(u8,{ref:r,containerClassName:Z("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:Z("disabled:cursor-not-allowed",e),...n}));pj.displayName="InputOTP";const Sd=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex items-center",e),...t}));Sd.displayName="InputOTPGroup";const pr=g.forwardRef(({index:e,className:t,hidden:n,...r},a)=>{const o=g.useContext(l8),{char:i,hasFakeCaret:s,isActive:c}=o.slots[e];return h.jsxs("div",{ref:a,className:Z("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",c&&"z-10 ring-2 ring-ring ring-offset-background",t),...r,children:[n&&i?h.jsx(xK,{}):i,s&&h.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});pr.displayName="InputOTPSlot";const fj=g.forwardRef(({...e},t)=>h.jsx("div",{ref:t,role:"separator",...e,children:h.jsx(xK,{})}));fj.displayName="InputOTPSeparator";const d8=qa(({onConfirm:e,onCancel:t})=>{const n=Wt(),{t:r}=Pe("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{e(a),o("")},c=()=>{t(),n.hide(),o("")};return h.jsx(Jo,{open:n.visible,onOpenChange:c,children:h.jsxs(ro,{className:"w-[330px]",children:[h.jsxs(ao,{children:[h.jsx(oo,{children:r("session_passkey.title")}),h.jsx(hu,{children:r("session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(pj,{onChange:i,maxLength:6,children:[h.jsxs(Sd,{children:[h.jsx(pr,{index:0,hidden:!0}),h.jsx(pr,{index:1,hidden:!0}),h.jsx(pr,{index:2,hidden:!0})]}),h.jsx(fj,{}),h.jsxs(Sd,{children:[h.jsx(pr,{index:3,hidden:!0}),h.jsx(pr,{index:4,hidden:!0}),h.jsx(pr,{index:5,hidden:!0})]})]})}),h.jsx(fu,{children:h.jsx(ut,{onClick:s,type:"submit",children:r("session_passkey.confirm")})})]})})}),Ed=e=>{const t=e.match(/.{1,2}/g);if(!t)throw new Error("Invalid hexString");return Uint8Array.from(t.map(n=>parseInt(n,16))).buffer},p8=e=>new TextEncoder().encode(e).buffer,$fe=async e=>{const t=p8(e);return await crypto.subtle.digest("SHA-256",t)},hj=e=>[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join(""),Ffe=async()=>{const e=crypto.getRandomValues(new Uint8Array(32));return hj(e)},mj=async e=>{const t=await $fe(e);return hj(t)},f8=async e=>(await mj(e)).substring(0,32),yj=async(e,t)=>{const n=await mj(t),r=await f8(t),a=p8(e),o=await Bfe(a,n,r);return hj(o)},gj=async(e,t)=>{const n=await mj(t),r=await f8(t),a=Ed(e),o=await zfe(a,n,r);return new TextDecoder().decode(o)},Bfe=async(e,t,n)=>{const r=Ed(n),a=Ed(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.encrypt({name:"AES-CBC",iv:r},o,e)},zfe=async(e,t,n)=>{const r=Ed(n),a=Ed(t),o=await crypto.subtle.importKey("raw",a,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);return await crypto.subtle.decrypt({name:"AES-CBC",iv:r},o,e)},Vfe=e=>{const t=(n,r=null)=>{let a=`{
`;return n.filter(o=>o.parent_id===r).forEach(o=>{if(o.type==="object"){const i=e.filter(c=>c.parent_id===o.id),s=t(i,o.id);a+=`  ${o.name}${o.required?"":"?"}: ${s}
`}else a+=`  // ${o.description||""}
  ${o.name}${o.required?"":"?"}: ${o.type};
`}),a+="}",a};return t(e)},h8=e=>{const t=(r,a=null)=>{let o="";return r.filter(i=>i.parent_id===a).forEach(i=>{if(i.type==="object"){const s=t(r,i.id);o+=`    ${i.name}: z.object({
${s}    })${i.required?"":".optional()"}.describe('${i.description||""}'),
`}else o+=`    ${i.name}: z.${i.type}()${i.required?"":".optional()"}.describe('${i.description||""}'),
`}),o};let n=`const schema = z.object({
`;return n+=t(e),n+="});",n},Ufe=e=>{const t={},n={string:fa.string,number:fa.number,boolean:fa.boolean,enum:()=>fa.enum([""])};return e.forEach(r=>{if(!r.parent_id)if(r.type==="object"){const a=e.filter(i=>i.parent_id===r.id),o={};a.forEach(i=>{i.type==="object"||i.type==="array"||(o[i.name]=n[i.type](),i.required||(o[i.name]=o[i.name].optional()))}),t[r.name]=fa.object(o),r.required||(t[r.name]=t[r.name].optional())}else r.type==="array"?(t[r.name]=fa.array(fa.string()),r.required||(t[r.name]=t[r.name].optional())):r.type==="enum"?(t[r.name]=fa.enum((r.enum||"").split(",")),r.required||(t[r.name]=t[r.name].optional())):(t[r.name]=n[r.type](),r.required||(t[r.name]=t[r.name].optional()))}),fa.object(t)},Wfe=()=>{const{toast:e}=Gt(),{t}=Pe("errors"),n=Je(a=>a.currentSession),r=Wt(d8);return{stream:g.useCallback(async(a,o)=>{var l,u;const{schemas:i,onMessageUpdate:s,onMessageFinish:c}=o||{};if(!(n!=null&&n.passphrase))throw new Error("Session is not found");switch(await _d.exists("passphrase")||await new Promise((d,p)=>{r.show({onConfirm:async f=>{try{const y=await gj(n.passphrase,f);await _d.set("passphrase",y),d()}catch(y){e({content:t("invalid_passphrase"),variant:"destructive"}),p(y)}finally{r.hide()}},onCancel:()=>{p()}})}),o==null?void 0:o.provider){case nn.OpenAI:{const d=(l=o==null?void 0:o.llm)==null?void 0:l.parameters;if(!(d!=null&&d.key)||typeof d.key!="string")throw new Error("API Key is not found");const p=await _d.get("passphrase");if(!p)throw new Error("Passphrase is not found");const f=await gj(d.key,p);if(!f)throw new Error("API Key is not found");const y=new _fe({apiKey:f,model:(u=o==null?void 0:o.llm)==null?void 0:u.name});let m="",v;if(i!=null&&i.length){const b=i.filter(x=>{var _;return(_=x.schema_items)==null?void 0:_.length}).flatMap(x=>x.schema_items),w=Ufe(b),j=await y.withStructuredOutput(w).stream(a);for await(const x of j)m=JSON.stringify(x),s==null||s({content:m})}else{const b=await y.stream(a);for await(const w of b)m+=`${w.content}`,v=w,s==null||s({content:m,chunk:w})}return c==null||c({content:m,lastChunk:v}),{lastChunk:v,content:m}}default:throw new Error("Provider is not supported")}},[n==null?void 0:n.passphrase,r,t,e])}},kc=()=>{const e=TM(),t=Wfe();return{stream:g.useCallback((n,r,a)=>{switch(n){case nn.WebLLM:return e.stream(r,a);case nn.OpenAI:return t.stream(r,{...a,provider:n});default:throw new Error("Provider is not supported")}},[t,e])}},Hfe=e=>{const[t]=g.useState(!1),n=Ss(i=>i.similaritySearchWithScore),{stream:r}=kc(),a=g.useCallback(async(i,s)=>{if(!(s!=null&&s.length))return[];const c=[];return await Promise.all(s.map(async l=>{var d,p,f,y;const u=l.placeholderEntity;if(u)switch(u.placeholder_type){case Ts.VECTOR_DATABASE_RETREIVER:{if(!l.promptNode||!l.promptEntity||!l.vectorDatabaseNode||!l.vectorDatabaseEntity)return;const m=(d=u.metadata)!=null&&d.k?+((p=u.metadata)==null?void 0:p.k):1;let v=(f=u.metadata)!=null&&f.minimalScore?+((y=u.metadata)==null?void 0:y.minimalScore):void 0;v&&v>1&&(v=v/100);const b=await n({databaseId:l.vectorDatabaseEntity.id},i,m);if(!b)return[];const w=new Ho({template:l.promptEntity.content,inputVariables:["context"]});c.push(new Uo(await w.format({context:v?b.filter(([,j])=>j>=v).map(([j])=>j.pageContent).join(`
`):b.map(([j])=>j.pageContent).join(`
`)})))}}})),c},[n]),o=g.useCallback(async(i,s,{retriverInfo:c},{schema:l,onMessageUpdate:u,onResponseMessageCreate:d,onInjectedMessages:p})=>{var v,b;if(!((v=e.mainLLMInfo)!=null&&v.llm)||((b=e.mainLLMInfo)==null?void 0:b.status)!==Ge.Loaded)throw new Error("LLM not found");const f=[];c!=null&&c.length&&(f.push(...await a(i,c)),p==null||p(f));const y=s.map(w=>w.role==="system"?new Pg(w.content):w.role==="user"?new Pr(w.content):new Uo(w.content));d==null||d();const{content:m}=await r(e.mainLLMInfo.llm.provider,y,{schemas:l?[l]:void 0,onMessageUpdate:({content:w})=>{u==null||u({nodeData:{loading:!0,content:w}})},llm:e.mainLLMInfo.llm});return u==null||u({nodeData:{content:m}}),m},[a,r,e.mainLLMInfo]);return{loading:t,sendMessage:o}},qfe=qa(({onDelete:e})=>{const{t}=Pe("dialogs"),[n,r]=g.useState(!1),a=Wt(),{toast:o}=Gt(),i=async()=>{try{r(!0),await e(),a.hide()}catch{o({variant:"destructive",description:t("delete_chat_data_node.errors.delete_failed")})}finally{r(!1)}};return h.jsx(AA,{open:a.visible,onOpenChange:a.hide,children:h.jsxs(U0,{children:[h.jsxs(W0,{children:[h.jsx(q0,{children:t("delete_chat_data_node.title")}),h.jsx(K0,{children:t("delete_chat_data_node.description")})]}),h.jsxs(H0,{children:[h.jsx(Z0,{onClick:a.hide,children:t("delete_chat_data_node.cancel")}),h.jsx(X0,{disabled:n,onClick:i,children:t("delete_chat_data_node.delete")})]})]})})});function wm(){return h.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"text-foreground",children:[h.jsx("circle",{cx:"4",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_qFRN",begin:"0;spinner_OcgL.end+0.25s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{begin:"spinner_qFRN.begin+0.1s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})}),h.jsx("circle",{cx:"20",cy:"12",r:"2",fill:"currentColor",children:h.jsx("animate",{id:"spinner_OcgL",begin:"spinner_qFRN.begin+0.2s",attributeName:"cy",calcMode:"spline",dur:"0.6s",values:"12;6;12",keySplines:".33,.66,.66,1;.33,0,.66,.33"})})]})}const Kfe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",height:192,viewBox:"0 0 150 150",width:192,...e},g.createElement("clipPath",{id:"a"},g.createElement("path",{d:"m0 0h150v150h-150z"})),g.createElement("g",{clipPath:"url(#a)"},g.createElement("path",{d:"m150 0h-150v150h150z",fill:"#29b5e8"}),g.createElement("path",{clipRule:"evenodd",d:"m130.375 67.2532-14.096 8.1221 14.096 8.0536c.843.4872 1.581 1.1357 2.174 1.9084.592.7727 1.026 1.6545 1.278 2.5951.251.9406.315 1.9215.188 2.8867-.128.9652-.444 1.8959-.931 2.7388-.488.843-1.136 1.5817-1.909 2.174s-1.654 1.0267-2.595 1.2782-1.921.3154-2.887.1878c-.965-.1275-1.896-.444-2.739-.9312l-25.2559-14.5496c-1.1575-.6696-2.1128-1.6394-2.765-2.8068-.6523-1.1674-.9773-2.4893-.9408-3.826.0198-.5792.1089-1.1538.2653-1.7117.517-1.8711 1.7458-3.4654 3.4234-4.4419l25.256-14.4983c.847-.4892 1.782-.8067 2.751-.9343.97-.1275 1.955-.0627 2.899.1909.945.2536 1.83.6909 2.605 1.287.775.596 1.425 1.3391 1.913 2.1866.49.8402.808 1.7693.935 2.7334.128.964.063 1.9439-.191 2.8826-.254.9388-.692 1.8177-1.288 2.5859-.597.7681-1.34 1.4101-2.186 1.8887zm-13.343 39.3698-25.2478-14.5243c-1.1296-.6483-2.4091-.9896-3.7115-.9902s-2.5823.3397-3.7124.987c-1.1301.6472-2.0712 1.579-2.7297 2.7026-.6585 1.1237-1.0115 2.4001-1.0239 3.7024v29.0135c.0654 1.928.8772 3.755 2.264 5.095 1.3869 1.341 3.2403 2.09 5.1691 2.09 1.9289 0 3.7823-.749 5.1691-2.09 1.3868-1.34 2.1986-3.167 2.264-5.095v-16.261l14.1301 8.122c.843.488 1.774.805 2.739.933.966.128 1.947.064 2.888-.187s1.823-.685 2.596-1.277c.774-.592 1.423-1.331 1.91-2.174.488-.843.805-1.773.933-2.739.128-.965.065-1.946-.186-2.887s-.685-1.824-1.277-2.597-1.331-1.422-2.174-1.91zm-29.0992-28.3806-10.527 10.3986c-.3601.3349-.8269.5319-1.318.5563h-3.0897c-.49-.0294-.9551-.2257-1.318-.5563l-10.4671-10.4329c-.3274-.3573-.521-.817-.5478-1.3009v-3.081c.0283-.4861.2215-.9481.5478-1.3095l10.4671-10.4329c.3637-.3281.829-.5214 1.318-.5477h3.0897c.4899.0228.9562.2166 1.318.5477l10.4928 10.4329c.3237.3623.514.8243.5392 1.3095v3.081c-.0237.483-.2143.9428-.5392 1.3009zm-8.3874-2.8928c-.0404-.499-.2485-.9696-.5905-1.3352l-3.0383-3.004c-.3641-.3275-.8291-.5207-1.318-.5478h-.1113c-.4867.0255-.9495.2191-1.3094.5478l-3.0383 3.004c-.3262.3676-.5165.8358-.5392 1.3266v.1113c.0215.4834.2124.9439.5392 1.3009l3.0554 2.9955c.3607.3274.823.5208 1.3094.5477h.1113c.4889-.027.9539-.2203 1.318-.5477l3.0383-3.0212c.3282-.3576.5244-.8166.5563-1.3009zm-47.4914-31.2217 25.2563 14.4811c1.1308.648 2.4115.989 3.7149.9889 1.3033 0 2.584-.3409 3.7148-.989 1.1309-.648 2.0725-1.5806 2.7314-2.7051.659-1.1245 1.0123-2.4018 1.0249-3.7051v-28.9879c-.0654-1.9277-.8772-3.7546-2.264-5.0952s-3.2402-2.0899-5.1691-2.0899c-1.9288 0-3.7822.7493-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v16.2613l-14.1473-8.1307c-.8429-.4877-1.7737-.8047-2.7392-.9328-.9654-.1281-1.9466-.0647-2.8876.1864s-1.8232.6852-2.5965 1.2773c-.7732.5921-1.4222 1.3307-1.91 2.1736-.4878.843-.8048 1.7738-.9329 2.7392-.128.9655-.0647 1.9467.1864 2.8876.2512.941.6852 1.8233 1.2773 2.5965.5921.7733 1.3307 1.4223 2.1737 1.9101zm55.4252 15.4739c1.4914.118 2.9836-.2193 4.2793-.9671l25.2475-14.5496c.843-.4877 1.582-1.1368 2.174-1.91s1.026-1.6555 1.277-2.5965.315-1.9222.187-2.8876c-.128-.9655-.445-1.8962-.933-2.7392-.488-.8429-1.137-1.5816-1.91-2.1737-.774-.5921-1.656-1.0261-2.597-1.2772-1.9-.5072-3.924-.2387-5.627.7464l-14.1298 8.1991v-16.2613c-.0654-1.9277-.8772-3.7546-2.264-5.0952-1.3868-1.3405-3.2402-2.0899-5.1691-2.0899-1.9288 0-3.7822.7494-5.169 2.0899-1.3869 1.3406-2.1987 3.1675-2.2641 5.0952v29.0136c-.0023 1.8784.7086 3.6876 1.9892 5.0619 1.2805 1.3743 3.0351 2.2111 4.909 2.3412zm-25.8554 31.5298c-1.4916-.1213-2.9847.2162-4.2793.9671l-25.2905 14.4893c-1.7024.985-2.9438 2.607-3.451 4.507s-.2387 3.924.7465 5.627c.9851 1.702 2.6061 2.943 4.5065 3.451 1.9004.507 3.9244.238 5.6268-.747l14.1473-8.122v16.261c.0654 1.928.8772 3.755 2.2641 5.096 1.3868 1.34 3.2402 2.09 5.169 2.09 1.9289 0 3.7823-.75 5.1691-2.09 1.3868-1.341 2.1986-3.168 2.264-5.096v-29.0645c-.0038-1.869-.7144-3.6673-1.9891-5.0341s-3.0192-2.2009-4.8834-2.3348zm-6.8468-13.5825c.4875-1.6032.414-3.3247-.2083-4.8806-.6224-1.5559-1.7564-2.8532-3.2152-3.6779l-25.2306-14.541c-1.704-.976-3.7248-1.2385-5.6216-.7303-1.8968.5083-3.5155 1.7461-4.5032 3.4433-.4889.84-.8065 1.7686-.9343 2.732-.1278.9635-.0632 1.9428.1899 2.8811.2531.9384.6897 1.8173 1.2846 2.5858.595.7686 1.3364 1.4115 2.1814 1.8917l14.096 8.1221-14.096 8.0536c-.8429.4861-1.5819 1.1334-2.1746 1.9051-.5928.7717-1.0277 1.6526-1.2801 2.5923-.2523.9398-.317 1.9201-.1905 2.8849s.4418 1.8952.9279 2.7382c.4861.8429 1.1335 1.5819 1.9051 2.1746.7717.5928 1.6526 1.0277 2.5924 1.2801.9397.2523 1.92.317 2.8848.1905s1.8952-.4418 2.7382-.9279l25.2306-14.5496c1.6248-.9071 2.8451-2.3965 3.4149-4.168z",fill:"#fff",fillRule:"evenodd"}))),Xfe=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:48,height:48,...e},g.createElement("path",{fill:"#fbc02d",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20 s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),g.createElement("path",{fill:"#e53935",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039 l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),g.createElement("path",{fill:"#4caf50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36 c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),g.createElement("path",{fill:"#1565c0",d:"M43.611,20.083L43.595,20L42,20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571 c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),Zfe=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:1024,height:1024,viewBox:"0 0 1024 1024",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M44.522 44.5217H489.739V489.739H44.522V44.5217Z",fill:"#F35325"}),g.createElement("path",{d:"M534.261 44.5217H979.478V489.739H534.261V44.5217Z",fill:"#81BC06"}),g.createElement("path",{d:"M44.522 534.261H489.739V979.478H44.522V534.261Z",fill:"#05A6F0"}),g.createElement("path",{d:"M534.261 534.261H979.478V979.478H534.261V534.261Z",fill:"#FFBA08"})),Gfe=e=>g.createElement("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 287.56 191",...e},g.createElement("defs",null,g.createElement("style",null,".cls-1{fill:#0081fb;}.cls-2{fill:url(#linear-gradient);}.cls-3{fill:url(#linear-gradient-2);}"),g.createElement("linearGradient",{id:"linear-gradient",x1:62.34,y1:101.45,x2:260.34,y2:91.45,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0064e1"}),g.createElement("stop",{offset:.4,stopColor:"#0064e1"}),g.createElement("stop",{offset:.83,stopColor:"#0073ee"}),g.createElement("stop",{offset:1,stopColor:"#0082fb"})),g.createElement("linearGradient",{id:"linear-gradient-2",x1:41.42,y1:53,x2:41.42,y2:126,gradientTransform:"matrix(1, 0, 0, -1, 0, 192)",gradientUnits:"userSpaceOnUse"},g.createElement("stop",{offset:0,stopColor:"#0082fb"}),g.createElement("stop",{offset:1,stopColor:"#0064e0"}))),g.createElement("title",null,"facebook-meta"),g.createElement("path",{className:"cls-1",d:"M31.06,126c0,11,2.41,19.41,5.56,24.51A19,19,0,0,0,53.19,160c8.1,0,15.51-2,29.79-21.76,11.44-15.83,24.92-38,34-52l15.36-23.6c10.67-16.39,23-34.61,37.18-47C181.07,5.6,193.54,0,206.09,0c21.07,0,41.14,12.21,56.5,35.11,16.81,25.08,25,56.67,25,89.27,0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191V160c17.63,0,22-16.2,22-34.74,0-26.42-6.16-55.74-19.73-76.69-9.63-14.86-22.11-23.94-35.84-23.94-14.85,0-26.8,11.2-40.23,31.17-7.14,10.61-14.47,23.54-22.7,38.13l-9.06,16c-18.2,32.27-22.81,39.62-31.91,51.75C84.74,183,71.12,191,53.19,191c-21.27,0-34.72-9.21-43-23.09C3.34,156.6,0,141.76,0,124.85Z"}),g.createElement("path",{className:"cls-2",d:"M24.49,37.3C38.73,15.35,59.28,0,82.85,0c13.65,0,27.22,4,41.39,15.61,15.5,12.65,32,33.48,52.63,67.81l7.39,12.32c17.84,29.72,28,45,33.93,52.22,7.64,9.26,13,12,19.94,12,17.63,0,22-16.2,22-34.74l27.4-.86c0,19.38-3.82,33.62-10.32,44.87C271,180.13,258.72,191,238.13,191c-12.8,0-24.14-2.78-36.68-14.61-9.64-9.08-20.91-25.21-29.58-39.71L146.08,93.6c-12.94-21.62-24.81-37.74-31.68-45C107,40.71,97.51,31.23,82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78Z"}),g.createElement("path",{className:"cls-3",d:"M82.35,31.23c-12.27,0-22.69,8.61-31.41,21.78C38.61,71.62,31.06,99.34,31.06,126c0,11,2.41,19.41,5.56,24.51L10.14,167.91C3.34,156.6,0,141.76,0,124.85,0,94.1,8.44,62.05,24.49,37.3,38.73,15.35,59.28,0,82.85,0Z"})),Qfe=e=>g.createElement("svg",{className:"mr-2 w-5 h-5",width:256,height:233,viewBox:"0 0 256 233",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M186.182 0h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#f7d046",d:"M209.455 0H256v46.545h-46.545z"}),g.createElement("path",{d:"M0 0h46.545v46.545H0zm0 46.545h46.545V93.09H0zm0 46.546h46.545v46.545H0zm0 46.545h46.545v46.545H0zm0 46.546h46.545v46.545H0z"}),g.createElement("path",{fill:"#f7d046",d:"M23.273 0h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#f2a73b",d:"M209.455 46.545H256V93.09h-46.545zm-186.182 0h46.545V93.09H23.273z"}),g.createElement("path",{d:"M139.636 46.545h46.545V93.09h-46.545z"}),g.createElement("path",{fill:"#f2a73b",d:"M162.909 46.545h46.545V93.09h-46.545zm-93.091 0h46.545V93.09H69.818z"}),g.createElement("path",{fill:"#ee792f",d:"M116.364 93.091h46.545v46.545h-46.545zm46.545 0h46.545v46.545h-46.545zm-93.091 0h46.545v46.545H69.818z"}),g.createElement("path",{d:"M93.091 139.636h46.545v46.545H93.091z"}),g.createElement("path",{fill:"#eb5829",d:"M116.364 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#ee792f",d:"M209.455 93.091H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"}),g.createElement("path",{d:"M186.182 139.636h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M209.455 139.636H256v46.545h-46.545z"}),g.createElement("path",{d:"M186.182 186.182h46.545v46.545h-46.545z"}),g.createElement("path",{fill:"#eb5829",d:"M23.273 139.636h46.545v46.545H23.273z"}),g.createElement("path",{fill:"#ea3326",d:"M209.455 186.182H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z"})),Yfe="/NoLLMChat/assets/qwen-B-gSh3_v.webp",Jfe="/NoLLMChat/assets/smollm-CikBjd4F.png",ehe="/NoLLMChat/assets/stablelm-BquePdQ7.png",the="/NoLLMChat/assets/nomic-BjJqoFji.webp",nhe="/NoLLMChat/assets/joshua-ByaReJuI.webp",rhe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{fill:"#fff",d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),ahe=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:256,height:260,preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 260",...e},g.createElement("path",{d:"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z"})),Aa=g.memo(({name:e,className:t,...n})=>{const r=Ml(a=>a.theme);return e=e.toLowerCase(),e.includes("gpt")?r==="dark"?h.jsx(rhe,{className:Z("w-5 h-5",t),...n}):h.jsx(ahe,{className:Z("w-5 h-5",t),...n}):e.includes("gemma")?h.jsx(Xfe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("qwen")?h.jsx("img",{className:Z("w-5 h-5",t),src:Yfe,alt:"qwen",...n}):e!=null&&e.includes("phi")?h.jsx(Zfe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("llama")?h.jsx(Gfe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("smollm")?h.jsx("img",{className:Z("w-5 h-5",t),src:Jfe,alt:"smollm",...n}):e!=null&&e.includes("mistral")?h.jsx(Qfe,{className:Z("w-5 h-5",t),...n}):e!=null&&e.includes("snowflake")?h.jsx(Kfe,{className:Z("w-5 h-5 rounded-full",t),...n}):e!=null&&e.includes("stablelm")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:ehe,alt:"stablelm",...n}):e!=null&&e.includes("nomic")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:the,alt:"nomic",...n}):e!=null&&e.includes("Xenova")||e!=null&&e.includes("janus")?h.jsx("img",{className:Z("w-5 h-5 rounded-full",t),src:nhe,alt:"Xenova",...n}):h.jsx(de,{className:Z("w-5 h-5",t),name:"brain"})}),vj=["Qwen2.5-1.5B-Instruct-q4f32_1-MLC","Qwen2.5-Coder-1.5B-Instruct-q4f16_1-MLC","stablelm-2-zephyr-1_6b-q4f16_1-MLC-1k","Phi-3.5-mini-instruct-q4f16_1-MLC-1k","Llama-3.2-3B-Instruct-q4f32_1-MLC"],Od=g.memo(e=>{var c;const{name:t,model:n,isCached:r,isFunctionCalling:a}=e,{t:o}=Pe("atoms"),i=g.useCallback(l=>l===1?"llm_info.model_types.embedding":l===2?"llm_info.model_types.vlm":"llm_info.model_types.llm",[]),s=g.useMemo(()=>{if(n)switch(n.model_type){case 0:case 1:return h.jsx(un,{className:"",children:o(i(n.model_type))});case 2:return h.jsxs(h.Fragment,{children:[h.jsx(un,{className:"",children:o(i(0))}),h.jsx(un,{className:"",children:o(i(n.model_type))})]})}},[n,i,o]);if(n)return h.jsxs(h.Fragment,{children:[s,vj.some(l=>t&&l.includes(t))?h.jsx(un,{className:"",variant:"outline",children:o("llm_info.recommended")}):null,r?h.jsx(un,{className:"",variant:"outline",children:o("llm_info.cached")}):null,a?h.jsx(un,{className:"",variant:"outline",children:o("llm_info.function_calling")}):null,n!=null&&n.low_resource_required?h.jsx(un,{className:"",variant:"outline",children:o("llm_info.low_resource_required")}):null,(c=n==null?void 0:n.overrides)!=null&&c.context_window_size?h.jsxs(un,{className:"",variant:"outline",children:[n.overrides.context_window_size.toLocaleString("en-US")," Tokens"]}):null,n!=null&&n.vram_required_MB?h.jsxs(un,{className:"",variant:"outline",children:["VRAM: ",n.vram_required_MB.toLocaleString("en-US")," MB"]}):null]})}),Zt=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Zt.displayName="Card";const Ln=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex flex-col space-y-1.5 p-6",e),...t}));Ln.displayName="CardHeader";const Kn=g.forwardRef(({className:e,...t},n)=>h.jsx("h3",{ref:n,className:Z("text-2xl font-semibold leading-none tracking-tight",e),...t}));Kn.displayName="CardTitle";const m8=g.forwardRef(({className:e,...t},n)=>h.jsx("p",{ref:n,className:Z("text-sm text-muted-foreground",e),...t}));m8.displayName="CardDescription";const $n=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("p-6 pt-0",e),...t}));$n.displayName="CardContent";const ci=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("flex items-center p-6 pt-0",e),...t}));ci.displayName="CardFooter";const ohe=g.memo(({llm:e,status:t,loadLLM:n,progress:r})=>{const{t:a}=Pe("flows"),[o,i]=g.useState();g.useEffect(()=>{o||!(e!=null&&e.name)||At(()=>import("./index-s4oWTEmo.js").then(async l=>(await l.__tla,l)),__vite__mapDeps([5,1,2,3,4])).then(async({hasModelInCache:l,functionCallingModelIds:u,prebuiltAppConfig:d})=>{const p=await l(e==null?void 0:e.name);i({hasCache:p,isFunctionCalling:u.includes(e==null?void 0:e.name),info:d.model_list.find(f=>f.model_id===(e==null?void 0:e.name))})})},[e==null?void 0:e.name,o]);const s=g.useCallback(async()=>{await(n==null?void 0:n())},[n]),c=g.useMemo(()=>{switch(t){case Ge.Downloading:return h.jsx(de,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case Ge.Loaded:return h.jsx(Aa,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"});default:return h.jsx(Aa,{name:(e==null?void 0:e.name)||"brain",className:"w-7 h-7"})}},[e==null?void 0:e.name,t]);return h.jsx(Zt,{className:"flex justify-center !bg-inherit !p-2 max-w-full overflow-y-hidden !mb-2 m-2 !mt-0",children:h.jsxs("div",{className:"ml-2 pt-1 max-w-full",children:[h.jsxs("p",{className:"flex gap-2 items-center pr-6 !text-sm font-semibold",children:[c,`${(e==null?void 0:e.name)||""}`]}),h.jsxs("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:[h.jsx(Od,{model:o==null?void 0:o.info,isFunctionCalling:(o==null?void 0:o.isFunctionCalling)||!1,name:e==null?void 0:e.name,isCached:(o==null?void 0:o.hasCache)||!1}),t!==Ge.Loaded?r?h.jsx("div",{className:"text-sm break-words flex-wrap",children:r}):h.jsx(ut,{disabled:t===Ge.Loading,onClick:s,className:"mt-4 w-full",children:a(o!=null&&o.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")}):void 0]})]})})}),ihe=e=>{const[t,n]=g.useState([]),r=Je(i=>i.currentSession),a=g.useCallback(async()=>{if(!e||!(r!=null&&r.id))return;const i=await ue("FlowEdge").find({where:{session_id:r.id,source:e.id},order:{id:"DESC"}}),{flowNodes:s,flowNodeDatas:c}=await Wh({where:{session_id:r.id,id:Ca(i.map(l=>l.target)),source_type:"JSONData"},order:{updated_at:"DESC"},select:["id","source_id","source_type","updated_at"]});n(s.reduce((l,u)=>{var p;const d=(p=c[u.source_type])==null?void 0:p.find(f=>f.id===u.source_id);return d&&l.push({node:u,entity:d}),l},[]))},[r==null?void 0:r.id,e]),o=g.useCallback(async i=>{await ue("FlowNode").delete(i.id),await ue("JSONData").delete(i.source_id);const s=await ue("FlowEdge").find({where:[{source:i.id},{target:i.id}]});await Promise.all(s.map(c=>ue("FlowEdge").delete(c.id))),a()},[a]);return g.useEffect(()=>{e&&a()},[a,e]),{chatList:t,deleteChat:o,getChatList:a}};class she{async loadAndSplit(t){if(t===void 0)throw new Error("You must pass a text splitter to use this method.");const n=await this.load();return t.invoke(n)}}class y8 extends she{constructor(t,{splitPages:n=!0,pdfjs:r=che,parsedItemSeparator:a=""}={}){super(),Object.defineProperty(this,"blob",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"splitPages",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"pdfjs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parsedItemSeparator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.blob=t,this.splitPages=n??this.splitPages,this.pdfjs=r,this.parsedItemSeparator=a}async load(){const{getDocument:t,version:n}=await this.pdfjs(),r=await t({data:new Uint8Array(await this.blob.arrayBuffer()),useWorkerFetch:!1,isEvalSupported:!1,useSystemFonts:!0}).promise,a=await r.getMetadata().catch(()=>null),o=[];for(let i=1;i<=r.numPages;i+=1){const s=await(await r.getPage(i)).getTextContent();if(s.items.length===0)continue;let c;const l=[];for(const d of s.items)"str"in d&&(c===d.transform[5]||!c?l.push(d.str):l.push(`
${d.str}`),c=d.transform[5]);const u=l.join(this.parsedItemSeparator);o.push(new Fp({pageContent:u,metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages},loc:{pageNumber:i}}}))}return this.splitPages?o:o.length===0?[]:[new Fp({pageContent:o.map(i=>i.pageContent).join(`

`),metadata:{pdf:{version:n,info:a==null?void 0:a.info,metadata:a==null?void 0:a.metadata,totalPages:r.numPages}}})]}}async function che(){try{const{default:e}=await At(async()=>{const{default:r}=await import("./pdf-CLoLwP5W.js").then(async a=>(await a.__tla,a)).then(a=>a.p);return{default:r}},__vite__mapDeps([6,1,2])),{getDocument:t,version:n}=e;return{getDocument:t,version:n}}catch(e){throw console.error(e),new Error("Failed to load pdf-parse. Please install it with eg. `npm install pdf-parse`.")}}var bj="Tabs",[lhe,u2e]=er(bj,[Xa]),g8=Xa(),[uhe,wj]=lhe(bj),v8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:o,orientation:i="horizontal",dir:s,activationMode:c="automatic",...l}=e,u=Wo(s),[d,p]=Sn({prop:r,onChange:a,defaultProp:o});return h.jsx(uhe,{scope:n,baseId:Pt(),value:d,onValueChange:p,orientation:i,dir:u,activationMode:c,children:h.jsx(Ae.div,{dir:u,"data-orientation":i,...l,ref:t})})});v8.displayName=bj;var b8="TabsList",w8=g.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,o=wj(b8,n),i=g8(n);return h.jsx(zl,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:r,children:h.jsx(Ae.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:t})})});w8.displayName=b8;var x8="TabsTrigger",_8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...o}=e,i=wj(x8,n),s=g8(n),c=E8(i.baseId,r),l=O8(i.baseId,r),u=r===i.value;return h.jsx(Vl,{asChild:!0,...s,focusable:!a,active:u,children:h.jsx(Ae.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":l,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:t,onMouseDown:ge(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?i.onValueChange(r):d.preventDefault()}),onKeyDown:ge(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(r)}),onFocus:ge(e.onFocus,()=>{const d=i.activationMode!=="manual";!u&&!a&&d&&i.onValueChange(r)})})})});_8.displayName=x8;var j8="TabsContent",S8=g.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:o,...i}=e,s=wj(j8,n),c=E8(s.baseId,r),l=O8(s.baseId,r),u=r===s.value,d=g.useRef(u);return g.useEffect(()=>{const p=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(p)},[]),h.jsx(Mr,{present:a||u,children:({present:p})=>h.jsx(Ae.div,{"data-state":u?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":c,hidden:!p,id:l,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:p&&o})})});S8.displayName=j8;function E8(e,t){return`${e}-trigger-${t}`}function O8(e,t){return`${e}-content-${t}`}var dhe=v8,C8=w8,N8=_8,M8=S8;const xj=dhe,xm=g.forwardRef(({className:e,...t},n)=>h.jsx(C8,{ref:n,className:Z("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));xm.displayName=C8.displayName;const ra=g.forwardRef(({className:e,...t},n)=>h.jsx(N8,{ref:n,className:Z("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));ra.displayName=N8.displayName;const aa=g.forwardRef(({className:e,...t},n)=>h.jsx(M8,{ref:n,className:Z("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));aa.displayName=M8.displayName,_v=function(e,[t,n]){return Math.min(n,Math.max(t,e))};function P8(e){const t=g.useRef({value:e,previous:e});return g.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var phe=[" ","Enter","ArrowUp","ArrowDown"],fhe=[" ","Enter"],Cd="Select",[_m,jm,hhe]=Dp(Cd),[Ac,d2e]=er(Cd,[hhe,Us]),Sm=Us(),[mhe,li]=Ac(Cd),[yhe,ghe]=Ac(Cd),k8=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:o,value:i,defaultValue:s,onValueChange:c,dir:l,name:u,autoComplete:d,disabled:p,required:f,form:y}=e,m=Sm(t),[v,b]=g.useState(null),[w,j]=g.useState(null),[x,_]=g.useState(!1),S=Wo(l),[E=!1,O]=Sn({prop:r,defaultProp:a,onChange:o}),[M,N]=Sn({prop:i,defaultProp:s,onChange:c}),P=g.useRef(null),I=v?y||!!v.closest("form"):!0,[k,C]=g.useState(new Set),T=Array.from(k).map(A=>A.props.value).join(";");return h.jsx(Nf,{...m,children:h.jsxs(mhe,{required:f,scope:t,trigger:v,onTriggerChange:b,valueNode:w,onValueNodeChange:j,valueNodeHasChildren:x,onValueNodeHasChildrenChange:_,contentId:Pt(),value:M,onValueChange:N,open:E,onOpenChange:O,dir:S,triggerPointerDownPosRef:P,disabled:p,children:[h.jsx(_m.Provider,{scope:t,children:h.jsx(yhe,{scope:e.__scopeSelect,onNativeOptionAdd:g.useCallback(A=>{C(D=>new Set(D).add(A))},[]),onNativeOptionRemove:g.useCallback(A=>{C(D=>{const L=new Set(D);return L.delete(A),L})},[]),children:n})}),I?h.jsxs(n$,{"aria-hidden":!0,required:f,tabIndex:-1,name:u,autoComplete:d,value:M,onChange:A=>N(A.target.value),disabled:p,form:y,children:[M===void 0?h.jsx("option",{value:""}):null,Array.from(k)]},T):null]})})};k8.displayName=Cd;var A8="SelectTrigger",T8=g.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,o=Sm(n),i=li(A8,n),s=i.disabled||r,c=wt(t,i.onTriggerChange),l=jm(n),u=g.useRef("touch"),[d,p,f]=r$(m=>{const v=l().filter(j=>!j.disabled),b=v.find(j=>j.value===i.value),w=a$(v,m,b);w!==void 0&&i.onValueChange(w.value)}),y=m=>{s||(i.onOpenChange(!0),f()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return h.jsx(A0,{asChild:!0,...o,children:h.jsx(Ae.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":t$(i.value)?"":void 0,...a,ref:c,onClick:ge(a.onClick,m=>{m.currentTarget.focus(),u.current!=="mouse"&&y(m)}),onPointerDown:ge(a.onPointerDown,m=>{u.current=m.pointerType;const v=m.target;v.hasPointerCapture(m.pointerId)&&v.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(y(m),m.preventDefault())}),onKeyDown:ge(a.onKeyDown,m=>{const v=d.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&p(m.key),!(v&&m.key===" ")&&phe.includes(m.key)&&(y(),m.preventDefault())})})})});T8.displayName=A8;var I8="SelectValue",R8=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:o,placeholder:i="",...s}=e,c=li(I8,n),{onValueNodeHasChildrenChange:l}=c,u=o!==void 0,d=wt(t,c.onValueNodeChange);return tn(()=>{l(u)},[l,u]),h.jsx(Ae.span,{...s,ref:d,style:{pointerEvents:"none"},children:t$(c.value)?h.jsx(h.Fragment,{children:i}):o})});R8.displayName=I8;var vhe="SelectIcon",D8=g.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return h.jsx(Ae.span,{"aria-hidden":!0,...a,ref:t,children:r||"\u25BC"})});D8.displayName=vhe;var bhe="SelectPortal",L8=e=>h.jsx(Ng,{asChild:!0,...e});L8.displayName=bhe;var ts="SelectContent",$8=g.forwardRef((e,t)=>{const n=li(ts,e.__scopeSelect),[r,a]=g.useState();if(tn(()=>{a(new DocumentFragment)},[]),!n.open){const o=r;return o?Nl.createPortal(h.jsx(F8,{scope:e.__scopeSelect,children:h.jsx(_m.Slot,{scope:e.__scopeSelect,children:h.jsx("div",{children:e.children})})}),o):null}return h.jsx(B8,{...e,ref:t})});$8.displayName=ts;var oa=10,[F8,ui]=Ac(ts),whe="SelectContentImpl",B8=g.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:i,side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:p,collisionPadding:f,sticky:y,hideWhenDetached:m,avoidCollisions:v,...b}=e,w=li(ts,n),[j,x]=g.useState(null),[_,S]=g.useState(null),E=wt(t,Q=>x(Q)),[O,M]=g.useState(null),[N,P]=g.useState(null),I=jm(n),[k,C]=g.useState(!1),T=g.useRef(!1);g.useEffect(()=>{if(j)return Wl(j)},[j]),Hl();const A=g.useCallback(Q=>{const[q,...H]=I().map(F=>F.ref.current),[X]=H.slice(-1),te=document.activeElement;for(const F of Q)if(F===te||(F==null||F.scrollIntoView({block:"nearest"}),F===q&&_&&(_.scrollTop=0),F===X&&_&&(_.scrollTop=_.scrollHeight),F==null||F.focus(),document.activeElement!==te))return},[I,_]),D=g.useCallback(()=>A([O,j]),[A,O,j]);g.useEffect(()=>{k&&D()},[k,D]);const{onOpenChange:L,triggerPointerDownPosRef:R}=w;g.useEffect(()=>{if(j){let Q={x:0,y:0};const q=X=>{var te,F;Q={x:Math.abs(Math.round(X.pageX)-(((te=R.current)==null?void 0:te.x)??0)),y:Math.abs(Math.round(X.pageY)-(((F=R.current)==null?void 0:F.y)??0))}},H=X=>{Q.x<=10&&Q.y<=10?X.preventDefault():j.contains(X.target)||L(!1),document.removeEventListener("pointermove",q),R.current=null};return R.current!==null&&(document.addEventListener("pointermove",q),document.addEventListener("pointerup",H,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",q),document.removeEventListener("pointerup",H,{capture:!0})}}},[j,L,R]),g.useEffect(()=>{const Q=()=>L(!1);return window.addEventListener("blur",Q),window.addEventListener("resize",Q),()=>{window.removeEventListener("blur",Q),window.removeEventListener("resize",Q)}},[L]);const[B,z]=r$(Q=>{const q=I().filter(te=>!te.disabled),H=q.find(te=>te.ref.current===document.activeElement),X=a$(q,Q,H);X&&setTimeout(()=>X.ref.current.focus())}),$=g.useCallback((Q,q,H)=>{const X=!T.current&&!H;(w.value!==void 0&&w.value===q||X)&&(M(Q),X&&(T.current=!0))},[w.value]),V=g.useCallback(()=>j==null?void 0:j.focus(),[j]),Y=g.useCallback((Q,q,H)=>{const X=!T.current&&!H;(w.value!==void 0&&w.value===q||X)&&P(Q)},[w.value]),G=r==="popper"?_j:z8,K=G===_j?{side:s,sideOffset:c,align:l,alignOffset:u,arrowPadding:d,collisionBoundary:p,collisionPadding:f,sticky:y,hideWhenDetached:m,avoidCollisions:v}:{};return h.jsx(F8,{scope:n,content:j,viewport:_,onViewportChange:S,itemRefCallback:$,selectedItem:O,onItemLeave:V,itemTextRefCallback:Y,focusSelectedItem:D,selectedItemText:N,position:r,isPositioned:k,searchRef:B,children:h.jsx(yf,{as:Vo,allowPinchZoom:!0,children:h.jsx(cf,{asChild:!0,trapped:w.open,onMountAutoFocus:Q=>{Q.preventDefault()},onUnmountAutoFocus:ge(a,Q=>{var q;(q=w.trigger)==null||q.focus({preventScroll:!0}),Q.preventDefault()}),children:h.jsx(Cg,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:Q=>Q.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:h.jsx(G,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:Q=>Q.preventDefault(),...b,...K,onPlaced:()=>C(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:ge(b.onKeyDown,Q=>{const q=Q.ctrlKey||Q.altKey||Q.metaKey;if(Q.key==="Tab"&&Q.preventDefault(),!q&&Q.key.length===1&&z(Q.key),["ArrowUp","ArrowDown","Home","End"].includes(Q.key)){let H=I().filter(X=>!X.disabled).map(X=>X.ref.current);if(["ArrowUp","End"].includes(Q.key)&&(H=H.slice().reverse()),["ArrowUp","ArrowDown"].includes(Q.key)){const X=Q.target,te=H.indexOf(X);H=H.slice(te+1)}setTimeout(()=>A(H)),Q.preventDefault()}})})})})})})});B8.displayName=whe;var xhe="SelectItemAlignedPosition",z8=g.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,o=li(ts,n),i=ui(ts,n),[s,c]=g.useState(null),[l,u]=g.useState(null),d=wt(t,E=>u(E)),p=jm(n),f=g.useRef(!1),y=g.useRef(!0),{viewport:m,selectedItem:v,selectedItemText:b,focusSelectedItem:w}=i,j=g.useCallback(()=>{if(o.trigger&&o.valueNode&&s&&l&&m&&v&&b){const E=o.trigger.getBoundingClientRect(),O=l.getBoundingClientRect(),M=o.valueNode.getBoundingClientRect(),N=b.getBoundingClientRect();if(o.dir!=="rtl"){const X=N.left-O.left,te=M.left-X,F=E.left-te,se=E.width+F,re=Math.max(se,O.width),le=window.innerWidth-oa,je=_v(te,[oa,Math.max(oa,le-re)]);s.style.minWidth=se+"px",s.style.left=je+"px"}else{const X=O.right-N.right,te=window.innerWidth-M.right-X,F=window.innerWidth-E.right-te,se=E.width+F,re=Math.max(se,O.width),le=window.innerWidth-oa,je=_v(te,[oa,Math.max(oa,le-re)]);s.style.minWidth=se+"px",s.style.right=je+"px"}const P=p(),I=window.innerHeight-oa*2,k=m.scrollHeight,C=window.getComputedStyle(l),T=parseInt(C.borderTopWidth,10),A=parseInt(C.paddingTop,10),D=parseInt(C.borderBottomWidth,10),L=parseInt(C.paddingBottom,10),R=T+A+k+L+D,B=Math.min(v.offsetHeight*5,R),z=window.getComputedStyle(m),$=parseInt(z.paddingTop,10),V=parseInt(z.paddingBottom,10),Y=E.top+E.height/2-oa,G=I-Y,K=v.offsetHeight/2,Q=v.offsetTop+K,q=T+A+Q,H=R-q;if(q<=Y){const X=P.length>0&&v===P[P.length-1].ref.current;s.style.bottom="0px";const te=l.clientHeight-m.offsetTop-m.offsetHeight,F=Math.max(G,K+(X?V:0)+te+D),se=q+F;s.style.height=se+"px"}else{const X=P.length>0&&v===P[0].ref.current;s.style.top="0px";const te=Math.max(Y,T+m.offsetTop+(X?$:0)+K)+H;s.style.height=te+"px",m.scrollTop=q-Y+m.offsetTop}s.style.margin=`${oa}px 0`,s.style.minHeight=B+"px",s.style.maxHeight=I+"px",r==null||r(),requestAnimationFrame(()=>f.current=!0)}},[p,o.trigger,o.valueNode,s,l,m,v,b,o.dir,r]);tn(()=>j(),[j]);const[x,_]=g.useState();tn(()=>{l&&_(window.getComputedStyle(l).zIndex)},[l]);const S=g.useCallback(E=>{E&&y.current===!0&&(j(),w==null||w(),y.current=!1)},[j,w]);return h.jsx(jhe,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:f,onScrollButtonChange:S,children:h.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:x},children:h.jsx(Ae.div,{...a,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});z8.displayName=xhe;var _he="SelectPopperPosition",_j=g.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=oa,...o}=e,i=Sm(n);return h.jsx(T0,{...i,...o,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});_j.displayName=_he;var[jhe,jj]=Ac(ts,{}),Sj="SelectViewport",V8=g.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,o=ui(Sj,n),i=jj(Sj,n),s=wt(t,o.onViewportChange),c=g.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),h.jsx(_m.Slot,{scope:n,children:h.jsx(Ae.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ge(a.onScroll,l=>{const u=l.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:p}=i;if(p!=null&&p.current&&d){const f=Math.abs(c.current-u.scrollTop);if(f>0){const y=window.innerHeight-oa*2,m=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),b=Math.max(m,v);if(b<y){const w=b+f,j=Math.min(y,w),x=w-j;d.style.height=j+"px",d.style.bottom==="0px"&&(u.scrollTop=x>0?x:0,d.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});V8.displayName=Sj;var U8="SelectGroup",[She,Ehe]=Ac(U8),Ohe=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Pt();return h.jsx(She,{scope:n,id:a,children:h.jsx(Ae.div,{role:"group","aria-labelledby":a,...r,ref:t})})});Ohe.displayName=U8;var W8="SelectLabel",H8=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Ehe(W8,n);return h.jsx(Ae.div,{id:a.id,...r,ref:t})});H8.displayName=W8;var Em="SelectItem",[Che,q8]=Ac(Em),K8=g.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:o,...i}=e,s=li(Em,n),c=ui(Em,n),l=s.value===r,[u,d]=g.useState(o??""),[p,f]=g.useState(!1),y=wt(t,w=>{var j;return(j=c.itemRefCallback)==null?void 0:j.call(c,w,r,a)}),m=Pt(),v=g.useRef("touch"),b=()=>{a||(s.onValueChange(r),s.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(Che,{scope:n,value:r,disabled:a,textId:m,isSelected:l,onItemTextChange:g.useCallback(w=>{d(j=>j||((w==null?void 0:w.textContent)??"").trim())},[]),children:h.jsx(_m.ItemSlot,{scope:n,value:r,disabled:a,textValue:u,children:h.jsx(Ae.div,{role:"option","aria-labelledby":m,"data-highlighted":p?"":void 0,"aria-selected":l&&p,"data-state":l?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:y,onFocus:ge(i.onFocus,()=>f(!0)),onBlur:ge(i.onBlur,()=>f(!1)),onClick:ge(i.onClick,()=>{v.current!=="mouse"&&b()}),onPointerUp:ge(i.onPointerUp,()=>{v.current==="mouse"&&b()}),onPointerDown:ge(i.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:ge(i.onPointerMove,w=>{var j;v.current=w.pointerType,a?(j=c.onItemLeave)==null||j.call(c):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ge(i.onPointerLeave,w=>{var j;w.currentTarget===document.activeElement&&((j=c.onItemLeave)==null||j.call(c))}),onKeyDown:ge(i.onKeyDown,w=>{var j;((j=c.searchRef)==null?void 0:j.current)!==""&&w.key===" "||(fhe.includes(w.key)&&b(),w.key===" "&&w.preventDefault())})})})})});K8.displayName=Em;var Nd="SelectItemText",X8=g.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...o}=e,i=li(Nd,n),s=ui(Nd,n),c=q8(Nd,n),l=ghe(Nd,n),[u,d]=g.useState(null),p=wt(t,b=>d(b),c.onItemTextChange,b=>{var w;return(w=s.itemTextRefCallback)==null?void 0:w.call(s,b,c.value,c.disabled)}),f=u==null?void 0:u.textContent,y=g.useMemo(()=>h.jsx("option",{value:c.value,disabled:c.disabled,children:f},c.value),[c.disabled,c.value,f]),{onNativeOptionAdd:m,onNativeOptionRemove:v}=l;return tn(()=>(m(y),()=>v(y)),[m,v,y]),h.jsxs(h.Fragment,{children:[h.jsx(Ae.span,{id:c.textId,...o,ref:p}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Nl.createPortal(o.children,i.valueNode):null]})});X8.displayName=Nd;var Z8="SelectItemIndicator",G8=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return q8(Z8,n).isSelected?h.jsx(Ae.span,{"aria-hidden":!0,...r,ref:t}):null});G8.displayName=Z8;var Ej="SelectScrollUpButton",Q8=g.forwardRef((e,t)=>{const n=ui(Ej,e.__scopeSelect),r=jj(Ej,e.__scopeSelect),[a,o]=g.useState(!1),i=wt(t,r.onScrollButtonChange);return tn(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollTop>0;o(l)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(J8,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop-c.offsetHeight)}}):null});Q8.displayName=Ej;var Oj="SelectScrollDownButton",Y8=g.forwardRef((e,t)=>{const n=ui(Oj,e.__scopeSelect),r=jj(Oj,e.__scopeSelect),[a,o]=g.useState(!1),i=wt(t,r.onScrollButtonChange);return tn(()=>{if(n.viewport&&n.isPositioned){let s=function(){const l=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<l;o(u)};const c=n.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[n.viewport,n.isPositioned]),a?h.jsx(J8,{...e,ref:i,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=n;s&&c&&(s.scrollTop=s.scrollTop+c.offsetHeight)}}):null});Y8.displayName=Oj;var J8=g.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,o=ui("SelectScrollButton",n),i=g.useRef(null),s=jm(n),c=g.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return g.useEffect(()=>()=>c(),[c]),tn(()=>{var l,u;(u=(l=s().find(d=>d.ref.current===document.activeElement))==null?void 0:l.ref.current)==null||u.scrollIntoView({block:"nearest"})},[s]),h.jsx(Ae.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ge(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:ge(a.onPointerMove,()=>{var l;(l=o.onItemLeave)==null||l.call(o),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:ge(a.onPointerLeave,()=>{c()})})}),Nhe="SelectSeparator",e$=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return h.jsx(Ae.div,{"aria-hidden":!0,...r,ref:t})});e$.displayName=Nhe;var Cj="SelectArrow",Mhe=g.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Sm(n),o=li(Cj,n),i=ui(Cj,n);return o.open&&i.position==="popper"?h.jsx(I0,{...a,...r,ref:t}):null});Mhe.displayName=Cj;function t$(e){return e===""||e===void 0}var n$=g.forwardRef((e,t)=>{const{value:n,...r}=e,a=g.useRef(null),o=wt(t,a),i=P8(n);return g.useEffect(()=>{const s=a.current,c=window.HTMLSelectElement.prototype,l=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==n&&l){const u=new Event("change",{bubbles:!0});l.call(s,n),s.dispatchEvent(u)}},[i,n]),h.jsx(FAe,{asChild:!0,children:h.jsx("select",{...r,ref:o,defaultValue:n})})});n$.displayName="BubbleSelect";function r$(e){const t=tr(e),n=g.useRef(""),r=g.useRef(0),a=g.useCallback(i=>{const s=n.current+i;t(s),function c(l){n.current=l,window.clearTimeout(r.current),l!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(s)},[t]),o=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,o]}function a$(e,t,n){const r=t.length>1&&Array.from(t).every(s=>s===t[0])?t[0]:t,a=n?e.indexOf(n):-1;let o=Phe(e,Math.max(a,0));r.length===1&&(o=o.filter(s=>s!==n));const i=o.find(s=>s.textValue.toLowerCase().startsWith(r.toLowerCase()));return i!==n?i:void 0}function Phe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var khe=k8,o$=T8,Ahe=R8,The=D8,Ihe=L8,i$=$8,Rhe=V8,s$=H8,c$=K8,Dhe=X8,Lhe=G8,l$=Q8,u$=Y8,d$=e$;const jo=khe,So=Ahe,Ta=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(o$,{ref:r,className:Z("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,h.jsx(The,{asChild:!0,children:h.jsx(de,{name:"chevron-down",className:"h-4 w-4 opacity-50"})})]}));Ta.displayName=o$.displayName;const p$=g.forwardRef(({className:e,...t},n)=>h.jsx(l$,{ref:n,className:Z("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(de,{name:"chevron-up",className:"h-4 w-4"})}));p$.displayName=l$.displayName;const f$=g.forwardRef(({className:e,...t},n)=>h.jsx(u$,{ref:n,className:Z("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(de,{name:"chevron-down",className:"h-4 w-4"})}));f$.displayName=u$.displayName;const Ia=g.forwardRef(({className:e,children:t,position:n="popper",...r},a)=>h.jsx(Ihe,{children:h.jsxs(i$,{ref:a,className:Z("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[h.jsx(p$,{}),h.jsx(Rhe,{className:Z("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),h.jsx(f$,{})]})}));Ia.displayName=i$.displayName;const $he=g.forwardRef(({className:e,...t},n)=>h.jsx(s$,{ref:n,className:Z("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));$he.displayName=s$.displayName;const Xn=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(c$,{ref:r,className:Z("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(Lhe,{children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}),h.jsx(Dhe,{children:t})]}));Xn.displayName=c$.displayName;const Fhe=g.forwardRef(({className:e,...t},n)=>h.jsx(d$,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));Fhe.displayName=d$.displayName;var Eo="Accordion",Bhe=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Nj,zhe,Vhe]=Dp(Eo),[Om,p2e]=er(Eo,[Vhe,EP]),Mj=EP(),h$=W.forwardRef((e,t)=>{const{type:n,...r}=e,a=r,o=r;return h.jsx(Nj.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?h.jsx(qhe,{...o,ref:t}):h.jsx(Hhe,{...a,ref:t})})});h$.displayName=Eo;var[m$,Uhe]=Om(Eo),[y$,Whe]=Om(Eo,{collapsible:!1}),Hhe=W.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:o=!1,...i}=e,[s,c]=Sn({prop:n,defaultProp:r,onChange:a});return h.jsx(m$,{scope:e.__scopeAccordion,value:s?[s]:[],onItemOpen:c,onItemClose:W.useCallback(()=>o&&c(""),[o,c]),children:h.jsx(y$,{scope:e.__scopeAccordion,collapsible:o,children:h.jsx(g$,{...i,ref:t})})})}),qhe=W.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Sn({prop:n,defaultProp:r,onChange:a}),c=W.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=W.useCallback(u=>s((d=[])=>d.filter(p=>p!==u)),[s]);return h.jsx(m$,{scope:e.__scopeAccordion,value:i,onItemOpen:c,onItemClose:l,children:h.jsx(y$,{scope:e.__scopeAccordion,collapsible:!0,children:h.jsx(g$,{...o,ref:t})})})}),[Khe,Cm]=Om(Eo),g$=W.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:o="vertical",...i}=e,s=W.useRef(null),c=wt(s,t),l=zhe(n),u=Wo(a)==="ltr",d=ge(e.onKeyDown,p=>{var E;if(!Bhe.includes(p.key))return;const f=p.target,y=l().filter(O=>{var M;return!((M=O.ref.current)!=null&&M.disabled)}),m=y.findIndex(O=>O.ref.current===f),v=y.length;if(m===-1)return;p.preventDefault();let b=m;const w=0,j=v-1,x=()=>{b=m+1,b>j&&(b=w)},_=()=>{b=m-1,b<w&&(b=j)};switch(p.key){case"Home":b=w;break;case"End":b=j;break;case"ArrowRight":o==="horizontal"&&(u?x():_());break;case"ArrowDown":o==="vertical"&&x();break;case"ArrowLeft":o==="horizontal"&&(u?_():x());break;case"ArrowUp":o==="vertical"&&_();break}const S=b%v;(E=y[S].ref.current)==null||E.focus()});return h.jsx(Khe,{scope:n,disabled:r,direction:a,orientation:o,children:h.jsx(Nj.Slot,{scope:n,children:h.jsx(Ae.div,{...i,"data-orientation":o,ref:c,onKeyDown:r?void 0:d})})})}),Nm="AccordionItem",[Xhe,Pj]=Om(Nm),v$=W.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...a}=e,o=Cm(Nm,n),i=Uhe(Nm,n),s=Mj(n),c=Pt(),l=r&&i.value.includes(r)||!1,u=o.disabled||e.disabled;return h.jsx(Xhe,{scope:n,open:l,disabled:u,triggerId:c,children:h.jsx(NP,{"data-orientation":o.orientation,"data-state":S$(l),...s,...a,ref:t,disabled:u,open:l,onOpenChange:d=>{d?i.onItemOpen(r):i.onItemClose(r)}})})});v$.displayName=Nm;var b$="AccordionHeader",w$=W.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Cm(Eo,n),o=Pj(b$,n);return h.jsx(Ae.h3,{"data-orientation":a.orientation,"data-state":S$(o.open),"data-disabled":o.disabled?"":void 0,...r,ref:t})});w$.displayName=b$;var kj="AccordionTrigger",x$=W.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Cm(Eo,n),o=Pj(kj,n),i=Whe(kj,n),s=Mj(n);return h.jsx(Nj.ItemSlot,{scope:n,children:h.jsx(qZ,{"aria-disabled":o.open&&!i.collapsible||void 0,"data-orientation":a.orientation,id:o.triggerId,...s,...r,ref:t})})});x$.displayName=kj;var _$="AccordionContent",j$=W.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Cm(Eo,n),o=Pj(_$,n),i=Mj(n);return h.jsx(KZ,{role:"region","aria-labelledby":o.triggerId,"data-orientation":a.orientation,...i,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});j$.displayName=_$;function S$(e){return e?"open":"closed"}let E$;pM=h$,fM=v$,E$=w$,jv=x$,Sv=j$;const O$=pM,Aj=g.forwardRef(({className:e,...t},n)=>h.jsx(fM,{ref:n,className:Z("border-b",e),...t}));Aj.displayName="AccordionItem";const Tj=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(E$,{className:"flex",children:h.jsxs(jv,{ref:r,className:Z("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,h.jsx(de,{name:"chevron-down",className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Tj.displayName=jv.displayName;const Ij=g.forwardRef(({className:e,children:t,...n},r)=>h.jsx(Sv,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:h.jsx("div",{className:Z("pb-4 pt-0",e),children:t})}));Ij.displayName=Sv.displayName;const Zhe=[1,2,3,4,5,6,7,8,9,10],C$=g.memo(e=>{const{t}=Pe("flows"),[n,r]=g.useState(""),[a,o]=g.useState([]),[i,s]=g.useState("1"),{loading:c,onSimilaritySearch:l,onCreatePrompt:u,onCreateRetriever:d}=e,p=async()=>{o(await l(n,+i)),r("")},f=async y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),p())};return h.jsxs("div",{className:"mt-4 max-w-full",children:[h.jsx("div",{className:"bg-black/5 dark:bg-white/5 rounded-xl relative",children:h.jsxs("div",{className:"relative px-2 py-1 pb-2",children:[h.jsxs(jo,{value:`${i}`,onValueChange:y=>s(y),children:[h.jsx(Ta,{className:"absolute left-0 !w-14 top-[2px] rounded-xl bg-transparent border-none focus:outline-none focus:ring-0 focus:border-opacity-0 focus:ring-transparent",children:h.jsx(So,{placeholder:t("vector_database_node.k_select_placeholder")})}),h.jsx(Ia,{children:Zhe.map(y=>h.jsx(Xn,{value:`${y}`,children:y},`${y}`))})]}),h.jsx(po,{value:n,disabled:c,placeholder:t("vector_database_node.similarity_search_placeholder"),className:Z("w-full rounded-xl px-2 pl-11 border-none resize-none bg-transparent","min-h-8 max-h-8"),onKeyDown:f,onChange:y=>{r(y.target.value)}}),h.jsx("button",{type:"button",disabled:c,onClick:p,className:"absolute right-3 top-5 -translate-y-1/2 rounded-xl bg-black/5 dark:bg-white/5 p-1",children:h.jsx(de,{name:c?"loader-circle":"arrow-right",className:Z("w-4 h-4 dark:text-white",n?"opacity-100":"opacity-30",c?"animate-spin":"")})})]})}),h.jsx(O$,{type:"single",collapsible:!0,children:a==null?void 0:a.map(([y,m],v)=>h.jsxs(Aj,{value:`${v}`,children:[h.jsxs(Tj,{children:[`[${m.toFixed(2)}] ${y.pageContent}`.substring(0,32),"..."]}),h.jsx(Ij,{children:y.pageContent})]},`${v}`))}),h.jsxs("div",{className:"w-full mt-4 flex flex-col gap-1",children:[d?h.jsx(ut,{disabled:c,onClick:d,className:"w-full",children:t("vector_database_node.to_retriever")}):void 0,a!=null&&a.length&&u?h.jsx(ut,{disabled:c,onClick:()=>u(a),className:"w-full",children:t("vector_database_node.create_prompt")}):void 0]})]})}),N$=g.memo(({loading:e,onCreateData:t})=>{const{t:n}=Pe("flows"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=async()=>{o&&(await t({id:r,content:o}),a(""),i(""))};return h.jsxs("div",{className:"min-w-80",children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("vector_database_node.add_text.id")}),h.jsx(En,{value:r,disabled:e,onChange:c=>a(c.target.value||""),placeholder:n("vector_database_node.add_text.id_placeholder"),className:"mb-4"}),h.jsxs(nt,{htmlFor:"name",children:[n("vector_database_node.add_text.content")," ",h.jsx("span",{className:"text-red-600",children:"*"})]}),h.jsx(po,{value:o,disabled:e,onChange:c=>i(c.target.value||""),placeholder:n("vector_database_node.add_text.content_placeholder")})]}),h.jsx("div",{className:"flex justify-between mt-6",children:h.jsx(Vn,{loading:e,disabled:!(o!=null&&o.length),onClick:s,className:"w-full",children:n("vector_database_node.add_text.add")})})]})}),Rj=({className:e,size:t=200,duration:n=15,anchor:r=90,borderWidth:a=1.5,colorFrom:o="#ffaa40",colorTo:i="#9c40ff",delay:s=0})=>h.jsx("div",{style:{"--size":t,"--duration":n,"--anchor":r,"--border-width":a,"--color-from":o,"--color-to":i,"--delay":`-${s}s`},className:Z("pointer-events-none absolute inset-0 rounded-[inherit] [border:calc(var(--border-width)*1px)_solid_transparent]","![mask-clip:padding-box,border-box] ![mask-composite:intersect] [mask:linear-gradient(transparent,transparent),linear-gradient(white,white)]","after:absolute after:aspect-square after:w-[calc(var(--size)*1px)] after:animate-border-beam after:[animation-delay:var(--delay)] after:[background:linear-gradient(to_left,var(--color-from),var(--color-to),transparent)] after:[offset-anchor:calc(var(--anchor)*1%)_50%] after:[offset-path:rect(0_auto_auto_0_round_calc(var(--size)*1px))]",e)});function Ghe({accept:e,maxSize:t}){const{t:n}=Pe("atoms"),[r,a]=g.useState(""),[o,i]=g.useState(""),s=g.useRef(null),[c,l]=g.useState(0),u=p=>{var y;const f=(y=p.target.files)==null?void 0:y[0];d(f)},d=p=>{if(i(""),p){if(t&&p.size>t*1024*1024){i(n("file_upload_input.errors.max_size",{maxSize:t,fileSize:(p.size/1024/1024).toFixed(2)}));return}const f=e==null?void 0:e.split(",").map(y=>y.replace(".","").trim());if(e&&!p.type.match(e.replace("/*",""))&&!(f!=null&&f.some(y=>p.type.includes(y)))){i(n("file_upload_input.errors.accept",{accept:e}));return}return l(p.size),a(p.name),p}};return{fileName:r,error:o,fileInputRef:s,handleFileSelect:u,validateAndSetFile:d,clearFile:()=>{a(""),i(""),l(0),s.current&&(s.current.value="")},fileSize:c}}function Qhe({file:e,setFile:t,loading:n,progress:r,fileOptions:a}){const{toast:o}=Gt(),{t:i}=Pe("atoms"),[s,c]=g.useState(!1),{fileName:l,fileInputRef:u,clearFile:d,error:p,validateAndSetFile:f,fileSize:y}=Ghe({accept:(a==null?void 0:a.accept)||"image/*",maxSize:(a==null?void 0:a.maxSize)||3});g.useEffect(()=>{e||d()},[d,e]),g.useEffect(()=>{p&&o({title:p,variant:"destructive"})},[p,o]);function m(x){const _=f(x);_&&t(_)}function v(x){x.preventDefault(),c(!1);const _=x.dataTransfer.files[0];_&&m(_)}function b(x){var S;const _=(S=x.target.files)==null?void 0:S[0];_&&m(_)}function w(){d(),t(void 0)}const j=g.useMemo(()=>{if(!e)return h.jsx("div",{className:"w-16 h-16 rounded-lg bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center",children:h.jsx(de,{name:"file-text",className:"w-8 h-8 text-zinc-400"})});const x=e.type.startsWith("image/");return h.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden",children:x?h.jsx("img",{src:URL.createObjectURL(e),alt:"Preview",className:"w-full h-full object-cover"}):h.jsx(de,{className:"w-14 h-14",name:"file-text"})})},[e]);return h.jsx(h.Fragment,{children:h.jsxs("div",{className:Z("relative group cursor-pointer","rounded-lg border-2 border-dashed","transition-colors duration-200",s?"border-indigo-500 bg-indigo-50/50 dark:bg-indigo-500/10":"border-zinc-200 dark:border-zinc-800"),onDragOver:x=>{x.preventDefault(),c(!0)},onDragLeave:()=>c(!1),onDrop:v,onClick:()=>{var x;return(x=u.current)==null?void 0:x.click()},onKeyDown:x=>{var _;(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),(_=u.current)==null||_.click())},"aria-label":"Upload file",children:[h.jsx("input",{ref:u,type:"file",disabled:n||!!(r&&r<1),accept:(a==null?void 0:a.accept)||"image/*",onChange:b,className:"hidden"}),h.jsx("div",{className:"p-8 space-y-4",children:l?h.jsxs("div",{className:"flex items-center gap-4",children:[j,h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("p",{className:"text-sm font-medium truncate",children:[l||"No file selected"," ",h.jsx("span",{className:"text-xs text-zinc-500 leading-5",children:y?`(${(y/1024/1024).toFixed(2)} MB)`:""})]}),r&&r<1?h.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[h.jsxs("p",{children:[(r*100).toFixed(2)," %"]}),h.jsx("div",{className:"h-1 flex-1 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden items-center flex",children:h.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-200",style:{width:`${r*100}%`}})})]}):void 0]}),h.jsx("button",{type:"button",disabled:n||!!(r&&r<1),onClick:x=>{x.stopPropagation(),w()},className:"p-1 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded",children:h.jsx(de,{name:"x",className:"w-5 h-5 text-zinc-400"})}),r&&r<1?h.jsx(Rj,{className:"rounded-lg"}):void 0]}):h.jsxs("div",{className:"flex flex-col items-center gap-2",children:[h.jsx(de,{name:"upload",className:"w-8 h-8 text-zinc-400 dark:text-zinc-500"}),h.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:i("file_upload_input.drop_file")})]})})]})})}function M$({onFileSubmit:e,fileOptions:t,progress:n,loading:r}){const{t:a}=Pe("flows"),[o,i]=g.useState(),s=async()=>{o&&(await e(o),i(void 0))};return h.jsxs("div",{className:"w-full max-w-full space-y-2 mt-4",children:[h.jsx("div",{className:"mb-6",children:h.jsx(Qhe,{progress:n,loading:r,fileOptions:t,setFile:i,file:o})}),h.jsx(Vn,{loading:r,disabled:!o,onClick:s,className:"w-full mt-4",children:a("vector_database_node.add_file.index")})]})}const Mm=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{className:"relative w-full overflow-auto",children:h.jsx("table",{ref:n,className:Z("w-full caption-bottom text-sm",e),...t})}));Mm.displayName="Table";const Pm=g.forwardRef(({className:e,...t},n)=>h.jsx("thead",{ref:n,className:Z("[&_tr]:border-b",e),...t}));Pm.displayName="TableHeader";const km=g.forwardRef(({className:e,...t},n)=>h.jsx("tbody",{ref:n,className:Z("[&_tr:last-child]:border-0",e),...t}));km.displayName="TableBody";const Yhe=g.forwardRef(({className:e,...t},n)=>h.jsx("tfoot",{ref:n,className:Z("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Yhe.displayName="TableFooter";const ns=g.forwardRef(({className:e,...t},n)=>h.jsx("tr",{ref:n,className:Z("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ns.displayName="TableRow";const Tc=g.forwardRef(({className:e,...t},n)=>h.jsx("th",{ref:n,className:Z("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Tc.displayName="TableHead";const Ic=g.forwardRef(({className:e,...t},n)=>h.jsx("td",{ref:n,className:Z("align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Ic.displayName="TableCell";const Jhe=g.forwardRef(({className:e,...t},n)=>h.jsx("caption",{ref:n,className:Z("mt-4 text-sm text-muted-foreground",e),...t}));Jhe.displayName="TableCaption";const P$=({className:e,...t})=>h.jsx("nav",{role:"navigation","aria-label":"pagination",className:Z("mx-auto flex w-full justify-center",e),...t});P$.displayName="Pagination";const k$=g.forwardRef(({className:e,...t},n)=>h.jsx("ul",{ref:n,className:Z("flex flex-row items-center gap-1",e),...t}));k$.displayName="PaginationContent";const Rc=g.forwardRef(({className:e,...t},n)=>h.jsx("li",{ref:n,className:Z("",e),...t}));Rc.displayName="PaginationItem";const Am=({className:e,isActive:t,size:n="icon",...r})=>h.jsx("a",{"aria-current":t?"page":void 0,className:Z(nu({variant:t?"outline":"ghost",size:n}),e),...r});Am.displayName="PaginationLink";const A$=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs(Am,{"aria-label":"Go to previous page",size:"default",className:Z("gap-1 pl-2.5",e),...t,children:[h.jsx(de,{name:"chevron-left",className:"h-4 w-4"}),h.jsx("span",{children:n("pagination.previous")})]})};A$.displayName="PaginationPrevious";const T$=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs(Am,{"aria-label":"Go to next page",size:"default",className:Z("gap-1 pr-2.5",e),...t,children:[h.jsx("span",{children:n("pagination.next")}),h.jsx(de,{name:"chevron-right",className:"h-4 w-4"})]})};T$.displayName="PaginationNext";const Dj=({className:e,...t})=>{const{t:n}=Pe("atoms");return h.jsxs("span",{"aria-hidden":!0,className:Z("flex h-9 w-9 items-center justify-center",e),...t,children:[h.jsx(de,{name:"ellipsis",className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:n("pagination.more_pages")})]})};Dj.displayName="PaginationEllipsis";const I$=qa(({title:e,content:t})=>{const n=Wt();return h.jsx(Jo,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(ro,{className:"sm:max-w-2xl",children:[h.jsx(ao,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(oo,{children:e})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-96 overflow-hidden",children:h.jsx("div",{className:"relative w-full h-full overflow-hidden rounded-xl p-1 border border-border",children:h.jsx("pre",{className:"break-all h-full overflow-y-auto bg-background font-mono text-xs w-full",children:t})})})]})})}),Tm=g.memo(e=>{const{data:t,headers:n,limitLengthByColumns:r,showPerPage:a=7,paginationShowLimit:o=1,contentLengthLimit:i=64}=e,[s,c]=g.useState({page:1,maxPage:1}),l=Wt(I$);g.useEffect(()=>{c(f=>({...f,maxPage:Math.ceil(t.length/a)}))},[t.length,a]);const u=g.useMemo(()=>t.slice((s.page-1)*a,s.page*a),[t,s.page,a]),d=g.useMemo(()=>{let f=!1,y=!1;return h.jsx(P$,{className:"mt-4 mb-4 ml-4 mr-4 w-full",children:h.jsxs(k$,{children:[s.page>1?h.jsx(Rc,{onClick:()=>c(m=>({...m,page:m.page-1})),children:h.jsx(A$,{})}):null,Array.from({length:s.maxPage},(m,v)=>{const b=v+1,w=v===0||v===s.maxPage-1;return!w&&b>s.page+o&&y?null:!w&&b>s.page+o?(y=!0,h.jsx(Rc,{children:h.jsx(Dj,{})},v)):!w&&b<s.page-o&&f?null:!w&&b<s.page-o?(f=!0,h.jsx(Rc,{children:h.jsx(Dj,{})},v)):h.jsx(Rc,{onClick:()=>c(j=>({...j,page:b})),children:h.jsx(Am,{isActive:v+1===s.page,children:v+1})},v)}),s.page<s.maxPage?h.jsx(Rc,{onClick:()=>c(m=>({...m,page:m.page+1})),children:h.jsx(T$,{})}):null]})})},[s.maxPage,s.page,o]),p=(f,y)=>{if(!f)return;const m=Array.isArray(f)?f:n.map(v=>f[v]);return h.jsxs(ns,{children:[h.jsx(Ic,{children:h.jsx("div",{className:"font-bold",children:y+1})}),m.map((v,b)=>{const w=typeof v=="string"?v:JSON.stringify(v),j=n[b],x=(r==null?void 0:r[j])||i,_=w.length>x;return h.jsx(Ic,{className:"p-4",children:h.jsxs("div",{onClick:_?()=>l.show({title:j,content:w}):void 0,className:"flex gap-4",children:[_?`${w.substring(0,x)}...`:w,_?h.jsx(de,{className:"w-6 mt-[-2px]",name:"chevron-right"}):null]})},`${b}`)})]},`${y}`)};return h.jsxs(h.Fragment,{children:[h.jsxs(Mm,{className:"w-full",children:[h.jsx(Pm,{children:h.jsxs(ns,{children:[h.jsx(Tc,{},"index"),n?n.map(f=>h.jsx(Tc,{children:h.jsx("div",{className:"font-bold",children:f})},f)):void 0]})}),h.jsx(km,{children:u!=null&&u.length?u==null?void 0:u.map(p):void 0})]}),d]})});var Lj,R$;Tv=function(){if(R$)return Lj;R$=1;function e(t,n,r){var a=-1,o=t.length;n<0&&(n=-n>o?0:o+n),r=r>o?o:r,r<0&&(r+=o),o=n>r?0:r-n>>>0,n>>>=0;for(var i=Array(o);++a<o;)i[a]=t[a+n];return i}return Lj=e,Lj};var $j,D$;Es=function(){if(D$)return $j;D$=1;var e=Dl(),t=Ni(),n=eh(),r=Tr();function a(o,i,s){if(!r(s))return!1;var c=typeof i;return(c=="number"?t(s)&&n(i,s.length):c=="string"&&i in s)?e(s[i],o):!1}return $j=a,$j};var Fj,L$;function eme(){if(L$)return Fj;L$=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return Fj=t,Fj}var Bj,$$;function tme(){if($$)return Bj;$$=1;var e=eme(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return Bj=n,Bj}var zj,F$;function B$(){if(F$)return zj;F$=1;var e=tme(),t=Tr(),n=Ys(),r=NaN,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=o.test(l);return d||i.test(l)?s(l.slice(2),d?2:8):a.test(l)?r:+l}return zj=c,zj}var Vj,z$;function V$(){if(z$)return Vj;z$=1;var e=B$(),t=1/0,n=17976931348623157e292;function r(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var o=a<0?-1:1;return o*n}return a===a?a:0}return Vj=r,Vj}var Uj,U$;function W$(){if(U$)return Uj;U$=1;var e=V$();function t(n){var r=e(n),a=r%1;return r===r?a?r-a:r:0}return Uj=t,Uj}var Wj,H$;function nme(){if(H$)return Wj;H$=1;var e=Tv(),t=Es(),n=W$(),r=Math.ceil,a=Math.max;function o(i,s,c){(c?t(i,s,c):s===void 0)?s=1:s=a(n(s),0);var l=i==null?0:i.length;if(!l||s<1)return[];for(var u=0,d=0,p=Array(r(l/s));u<l;)p[d++]=e(i,u,u+=s);return p}return Wj=o,Wj}var rme=nme();const Hj=ot(rme),ame=()=>{const[e,t]=g.useState(!1),{t:n}=Pe("flows"),{toast:r}=Gt(),a=Ss(c=>c.index),o=Ss(c=>c.similaritySearchWithScore),i=g.useCallback(async(c,l)=>{try{if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===kr.DataNode)throw new Error("DataNode storage is not supported for similarity search");return t(!0),await o({databaseId:l.vectorDatabase.id},c,l==null?void 0:l.k)}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[o,r,n]),s=g.useCallback(async(c,l)=>{var u;try{t(!0);const d=c.content?[new Fp({pageContent:c.content,id:c.id,metadata:{id:c.id}})]:c.documents;if(!(d!=null&&d.length)){r({variant:"destructive",title:n("vector_database_node.errors.content_not_found")});return}if(!(l!=null&&l.vectorDatabase)){r({variant:"destructive",title:n("vector_database_node.errors.vector_database_not_found")});return}if((l==null?void 0:l.vectorDatabase.storage)===kr.DataNode)throw new Error("DataNode storage is not supported for indexing");{const p=Hj(d,10);let f=0;for(const y of p)(u=l==null?void 0:l.onProgressReport)==null||u.call(l,{handling:y.length,handled:f,total:d.length}),await a({databaseId:l.vectorDatabase.id},y),f+=y.length}}catch{r({variant:"destructive",title:n("vector_database_node.errors.similarity_search_failed")})}finally{t(!1)}},[a,r,n]);return{loading:e,indexData:s,similaritySearchWithScore:i}},ome=qa(({retriverInfo:e})=>{var m,v,b;const{t}=Pe("applications"),{loading:n,similaritySearchWithScore:r,indexData:a}=ame(),[o,i]=g.useState("search"),[s,c]=g.useState(0),l=Wt(),u=g.useMemo(()=>{var x,_;if(!((x=e==null?void 0:e.vectorDatabaseEntity)!=null&&x.raw))return{headers:[],rows:[]};const w=["content","embedding","metadata"],j=kg((_=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:_.raw);return{headers:w,rows:j.map(S=>{try{return JSON.parse(S)}catch{return[]}})}},[(m=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:m.raw]),d=g.useCallback(async(...w)=>{const[j,x]=w;await a(j,{...x,vectorDatabase:e.vectorDatabaseEntity})},[a,e.vectorDatabaseEntity]),p=g.useCallback(async(w,j)=>{const x=w.trim(),_=await r(x,{k:j,vectorDatabase:e.vectorDatabaseEntity});if(_!=null&&_.length)return _},[e.vectorDatabaseEntity,r]),f=g.useCallback(async w=>{if(w.type.includes("text")||w.type.includes("txt")){const j=new FileReader;j.onload=async x=>{var S;const _=(S=x.target)==null?void 0:S.result;await d({content:_},{vectorDatabase:e.vectorDatabaseEntity})},j.readAsText(w)}else if(w.type.endsWith("pdf")){const j=new Blob([w],{type:"application/pdf"}),x=await new y8(j,{pdfjs:async()=>{const _=await At(()=>import("./pdf.min-DM_kRsgY.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([7,1,2,3,4]));return await At(()=>import("./pdf.worker.min-BkmVjn3H.js").then(async S=>(await S.__tla,S)),__vite__mapDeps([8,1,2,3,4])),_.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),_},parsedItemSeparator:" "}).load();await d({documents:x},{vectorDatabase:e.vectorDatabaseEntity,onProgressReport:_=>{c((_.handled+_.handling)/_.total)}})}},[d,e.vectorDatabaseEntity]),y=g.useMemo(()=>{switch(o){case"search":return h.jsx(aa,{value:"search",children:h.jsx(C$,{loading:n,onSimilaritySearch:p})});case"new":return h.jsx(aa,{className:"min-w-80",value:"new",children:h.jsx(N$,{loading:n,onCreateData:d})});case"file":return h.jsx(aa,{value:"file",children:h.jsx(M$,{loading:n,progress:s,onFileSubmit:f,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(aa,{value:"view",className:"max-h-full overflow-auto",children:h.jsx(Tm,{data:u.rows,headers:u.headers,limitLengthByColumns:{embedding:32}})})}},[d,f,p,n,o,s,u]);return h.jsx(Jo,{open:l.visible,onOpenChange:l.hide,children:h.jsxs(ro,{className:"max-w-3xl",children:[h.jsx(ao,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(oo,{children:t("chat.vector_database")})]})}),h.jsx("div",{className:"mx-auto w-full min-h-96 max-h-full overflow-hidden",children:h.jsx("div",{className:"w-full h-full",children:h.jsxs(xj,{value:o,onValueChange:i,defaultValue:"search",className:Z("w-full h-full mt-4"),children:[h.jsxs(xm,{className:Z("grid w-full grid-cols-3",((v=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:v.storage)===kr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(ra,{value:"search",children:t("chat.search")}),h.jsx(ra,{value:"new",children:t("chat.text")}),h.jsx(ra,{value:"file",children:t("chat.file")}),((b=e==null?void 0:e.vectorDatabaseEntity)==null?void 0:b.storage)===kr.DatabaseNode?h.jsx(ra,{value:"view",children:t("chat.view")}):void 0]}),y]})})})]})})}),ime=g.lazy(()=>At(()=>import("./index-D6F2YTwn.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([9,10,1,2,11,12])));function sme({schema:e,mainLLMInfo:t,loadLLM:n,retriverInfo:r,threadNode:a,onSelectThread:o,onAddNewThread:i,currentDataNode:s,...c}){var x,_;const{t:l}=Pe("applications"),[u,d]=g.useState(!1),p=Wt(qfe),f=Wt(ome),{chatList:y,getChatList:m,deleteChat:v}=ihe(a),b=g.useCallback(async()=>{try{d(!0),await(i==null?void 0:i()),m()}finally{d(!1)}},[m,i]),w=g.useCallback(()=>{f.show({retriverInfo:r[0]})},[r,f]),j=g.useCallback(async(S,E)=>{S.stopPropagation(),p.show({onDelete:()=>v(E)})},[v,p]);return h.jsxs(B0,{variant:"sidebar",side:"right",collapsible:"none",...c,children:[h.jsx("div",{className:"h-1"}),h.jsxs(pu,{className:"justify-between",children:[h.jsx("div",{className:"text-sm pl-2",children:l("chat.history")}),h.jsx(Vn,{loading:u,onClick:b,variant:"link",className:"mr-[-6px]",children:h.jsx(de,{name:"circle-plus"})})]}),h.jsxs(V0,{children:[h.jsx(du,{className:"flex-1",children:h.jsx(Hs,{children:y.map(({node:S},E)=>{var O;return h.jsx(to,{onClick:()=>o(S),children:h.jsx(no,{className:"cursor-pointer",children:h.jsxs("div",{className:"flex flex-row justify-between items-center w-full",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx(de,{size:16,name:((O=s==null?void 0:s.node)==null?void 0:O.id)===S.id?"check":"chevron-right",className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"}),h.jsx("span",{children:`Thread ${E+1}`})]}),h.jsx(de,{onClick:M=>j(M,S),size:16,name:"trash-2"})]})})},S.id)})})}),r!=null&&r.length?h.jsxs(Zt,{className:"m-2 p-2 max-w-full",children:[h.jsx("pre",{className:"overflow-auto",children:r.map((S,E)=>{var O;return h.jsx("span",{children:((O=S.promptEntity)==null?void 0:O.content)||""},`${E}`)})}),h.jsx(ut,{onClick:w,className:"w-full mt-4",children:l("chat.vector_database")})]}):void 0,(x=e==null?void 0:e.schema_items)!=null&&x.length?h.jsx("div",{className:"m-2 !mb-0",children:h.jsx(g.Suspense,{fallback:h.jsx(wm,{}),children:h.jsx(ime,{className:Z("overflow-hidden break-words whitespace-pre-wrap w-full rounded-lg"),source:(_=e==null?void 0:e.schema_items)!=null&&_.length?`\`\`\`javascript
${h8((e==null?void 0:e.schema_items)||[])}
\`\`\``:""})})}):void 0,h.jsx(ohe,{llm:t==null?void 0:t.llm,status:t==null?void 0:t.status,progress:t==null?void 0:t.progress,loadLLM:n})]})]})}var cme=Object.defineProperty,lme=Object.defineProperties,ume=Object.getOwnPropertyDescriptors,Im=Object.getOwnPropertySymbols,q$=Object.prototype.hasOwnProperty,K$=Object.prototype.propertyIsEnumerable,X$=(e,t,n)=>t in e?cme(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Rm=(e,t)=>{for(var n in t||(t={}))q$.call(t,n)&&X$(e,n,t[n]);if(Im)for(var n of Im(t))K$.call(t,n)&&X$(e,n,t[n]);return e},dme=(e,t)=>lme(e,ume(t)),pme=(e,t)=>{var n={};for(var r in e)q$.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Im)for(var r of Im(e))t.indexOf(r)<0&&K$.call(e,r)&&(n[r]=e[r]);return n};Ll=function(...e){return BAe(zAe(e))},tM=function(e,t){const n=e;return W.forwardRef(function(r,a){return W.createElement(n,dme(Rm(Rm({ref:a},t),r),{className:Ll(t.className,r.className)}))})},_K=function(e,...t){return tM(e,{className:Ll(t)})},jK=function(e,t,n){const r=e;return W.forwardRef(function(a,o){const i=a,{className:s}=i,c=pme(i,["className"]),l=Rm({},c);return n&&n.forEach(u=>{c[u]!==void 0&&delete l[u]}),W.createElement(r,Rm({ref:o,className:Ll(t(c),s)},l))})};var qj="Avatar",[fme,f2e]=er(qj),[hme,Z$]=fme(qj),G$=g.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,o]=g.useState("idle");return h.jsx(hme,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:h.jsx(Ae.span,{...r,ref:t})})});G$.displayName=qj;var Q$="AvatarImage",Y$=g.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...o}=e,i=Z$(Q$,n),s=mme(r,o.referrerPolicy),c=tr(l=>{a(l),i.onImageLoadingStatusChange(l)});return tn(()=>{s!=="idle"&&c(s)},[s,c]),s==="loaded"?h.jsx(Ae.img,{...o,ref:t,src:r}):null});Y$.displayName=Q$;var J$="AvatarFallback",eF=g.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,o=Z$(J$,n),[i,s]=g.useState(r===void 0);return g.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>s(!0),r);return()=>window.clearTimeout(c)}},[r]),i&&o.imageLoadingStatus!=="loaded"?h.jsx(Ae.span,{...a,ref:t}):null});eF.displayName=J$;function mme(e,t){const[n,r]=g.useState("idle");return tn(()=>{if(!e){r("error");return}let a=!0;const o=new window.Image,i=s=>()=>{a&&r(s)};return r("loading"),o.onload=i("loaded"),o.onerror=i("error"),o.src=e,t&&(o.referrerPolicy=t),()=>{a=!1}},[e,t]),n}var tF=G$,nF=Y$,rF=eF;const aF=g.forwardRef(({className:e,...t},n)=>h.jsx(tF,{ref:n,className:Z("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));aF.displayName=tF.displayName;const oF=g.forwardRef(({className:e,...t},n)=>h.jsx(nF,{ref:n,className:Z("aspect-square h-full w-full",e),...t}));oF.displayName=nF.displayName;const iF=g.forwardRef(({className:e,...t},n)=>h.jsx(rF,{ref:n,className:Z("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));iF.displayName=rF.displayName;const yme=Ha("flex gap-2 max-w-[60%] items-end relative group",{variants:{variant:{received:"self-start",sent:"self-end flex-row-reverse"},layout:{default:"",ai:"max-w-full w-full items-center"}},defaultVariants:{variant:"received",layout:"default"}}),sF=g.forwardRef(({className:e,variant:t,layout:n,children:r,...a},o)=>h.jsx("div",{className:Z(yme({variant:t,layout:n,className:e}),"relative group"),ref:o,...a,children:g.Children.map(r,i=>g.isValidElement(i)&&typeof i.type!="string"?g.cloneElement(i,{variant:t,layout:n,className:a==null?void 0:a.innerclassname}):i)}));sF.displayName="ChatBubble";const gme=({src:e,fallback:t,className:n})=>h.jsxs(aF,{className:n,children:[h.jsx(oF,{src:e,alt:"Avatar"}),h.jsx(iF,{children:t})]}),vme=Ha("p-4",{variants:{variant:{received:"bg-secondary text-secondary-foreground rounded-r-lg rounded-tl-lg",sent:"bg-primary text-primary-foreground rounded-l-lg rounded-tr-lg"},layout:{default:"",ai:"border-t w-full rounded-none bg-transparent"}},defaultVariants:{variant:"received",layout:"default"}}),cF=g.forwardRef(({className:e,variant:t,layout:n,isLoading:r=!1,children:a,...o},i)=>h.jsx("div",{className:Z(vme({variant:t,layout:n,className:e}),"break-words max-w-full whitespace-pre-wrap"),ref:i,...o,children:r?h.jsx("div",{className:"flex items-center space-x-2",children:h.jsx(wm,{})}):a}));cF.displayName="ChatBubbleMessage";const bme=({icon:e,onClick:t,className:n,variant:r="ghost",size:a="icon",...o})=>h.jsx(ut,{variant:r,size:a,className:n,onClick:t,...o,children:e}),wme=g.forwardRef(({variant:e,className:t,children:n,...r},a)=>h.jsx("div",{ref:a,className:Z("absolute top-1/2 -translate-y-1/2 flex opacity-0 group-hover:opacity-100 transition-opacity duration-200",e==="sent"?"-left-1 -translate-x-full flex-row-reverse":"-right-1 translate-x-full",t),...r,children:n}));wme.displayName="ChatBubbleActionWrapper";const xme=g.lazy(()=>At(()=>import("./index-D6F2YTwn.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([9,10,1,2,11,12]))),_me=[{icon:"copy",label:"Copy"},{icon:"refresh-ccw",label:"Refresh"},{icon:"volume-2",label:"Volume"}],jme=g.memo(({message:e,index:t,isLastMessage:n,isGenerating:r,isSchema:a,onActionClick:o})=>h.jsxs(sF,{innerclassname:e.role=="system"?"!bg-transparent font-semibold":void 0,variant:e.role=="user"?"sent":"received",children:[e.role==="system"?h.jsx("div",{className:"w-10 h-10"}):e.role==="assistant"?h.jsx(gme,{src:"",fallback:e.data&&typeof e.data=="object"&&"injectedMessage"in e.data?"\u{1F4C2}":"\u{1F916}"}):void 0,h.jsxs(cF,{children:[r&&n&&(!e.content||a)?h.jsx(wm,{}):h.jsxs(g.Suspense,{fallback:h.jsx(wm,{}),children:[e.role==="system"?h.jsx(un,{className:"!text-sm mb-1",children:"System"}):void 0,h.jsx(xme,{className:Ll("[&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans !text-sm"),style:{color:"unset !important"},source:e.content?a?`\`\`\`json
${e.content}
\`\`\``:e.content:""})]}),e.role==="assistant"&&n&&h.jsx("div",{className:"flex items-center mt-1.5 gap-1",children:!r&&h.jsx(h.Fragment,{children:_me.map((i,s)=>h.jsx(bme,{variant:"ghost",className:"size-5",icon:h.jsx(de,{name:i.icon,className:"size-3"}),onClick:()=>o(i.label,e)},s))})})]})]},t),()=>!1),Sme=g.memo(()=>{const{t:e}=Pe("applications"),t=g.useRef(!1),[n,r]=g.useState(!1),a=g.useCallback(()=>{setTimeout(()=>{M.current&&(M.current.scrollTop=M.current.scrollHeight)},50)},[]),o=tue(),{schema:i,threadInfo:s,mainLLMInfo:c,retriverInfo:l,currentDataNode:u,loadLLM:d,addNewDataNode:p,selectDataNode:f,updateMessagesData:y,onThreadMessagesLoaded:m}=o,{sendMessage:v}=Hfe(o),{input:b,messages:w,isLoading:j,reload:x,setInput:_,handleSubmit:S,handleInputChange:E,setMessages:O}=XN({fetch:async(C,T)=>{try{r(!0);const A=JSON.parse(T==null?void 0:T.body),D=Oi(),L=A.messages[A.messages.length-1];return t.current=!0,O(R=>[...R,{id:Oi(),content:L.content,role:"user"}]),await v(L.content,A.messages||[],{retriverInfo:l},{schema:i,onInjectedMessages:R=>{R.length&&O(B=>[...B,...R.map(z=>z._getType()==="system"?{id:Oi(),content:`${z.content}`,role:"system",data:{injectedMessage:!0}}:z._getType()==="human"?{id:Oi(),content:`${z.content}`,role:"user",data:{injectedMessage:!0}}:{id:Oi(),content:`${z.content}`,role:"assistant",data:{injectedMessage:!0}})])},onResponseMessageCreate:R=>{O(B=>[...B,{id:D,content:R||"",role:"assistant"}])},onMessageUpdate:R=>{O(B=>{const z=[...B],$=z.findIndex(V=>V.id===D);return $!==-1&&(z[$]={...z[$],content:R.nodeData.content||""}),z}),t.current&&a()}}),O(R=>(y(R),R)),r(!1),_(""),t.current&&a(),new Response}finally{r(!1)}}}),M=g.useRef(null);g.useEffect(()=>{const C=m(T=>{O(T||[]),a()});return()=>{C()}},[O,m,a]);const N=async(C,T)=>(r(!0),await S(T),!0),P=g.useCallback(async(C,T)=>{if(C==="Refresh"){r(!0);try{await x()}finally{r(!1)}}C==="Copy"&&T&&T.role==="assistant"&&navigator.clipboard.writeText(T.content),C==="Volume"&&(T!=null&&T.content)&&await CN.speak((T==null?void 0:T.content)||"")},[x]),I=g.useCallback(()=>t.current=!1,[]),k=g.useMemo(()=>w&&w.map((C,T)=>h.jsx(jme,{message:C,index:T,isLastMessage:T===w.length-1,isGenerating:n,isSchema:!!i,onActionClick:P},C.id||`${T}`)),[w,n,i,P]);return h.jsxs(F0,{onClick:I,className:"max-h-full !overflow-hidden !min-h-full",style:{minHeight:"unset"},defaultOpen:!0,children:[h.jsx(z0,{className:"!max-h-full !overflow-hidden",style:{minHeight:"unset"},children:h.jsxs("main",{className:"flex h-full w-full max-w-2xl flex-col items-center mx-auto overflow-hidden",children:[h.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-w-full max-w-full",children:h.jsx(Y2,{className:"!max-h-full",ref:M,children:k})}),h.jsx(wv,{className:"!max-w-2xl px-4",onSubmit:N,disabled:j||n||(c==null?void 0:c.status)!==Ge.Loaded,placeholder:e("chat.input_message_placeholder"),maxHeight:72,value:b,onChange:E})]})}),h.jsx(sme,{schema:i,currentDataNode:u,threadNode:s==null?void 0:s.threadNode,loadLLM:d,mainLLMInfo:c,retriverInfo:l,onAddNewThread:p,onSelectThread:f})]})}),Eme=()=>{const[e,t]=g.useState(),n=Je(l=>l.currentSession),{t:r}=Pe("flows"),{toast:a}=Gt(),{stream:o}=kc(),{loadModel:i}=Hh(),s=g.useCallback(async(l,u)=>{if(n!=null&&n.main_node_id){if(!(e!=null&&e.llm))return a({variant:"destructive",description:r("editor_node.errors.llm_not_found")});(e==null?void 0:e.status)!==Ge.Loaded&&(await i(e.llm.provider,e.llm.name,d=>{t(p=>p&&{...p,progress:d.text})}),t(d=>d&&{...d,status:Ge.Loaded,progress:""}));try{return(await o(e==null?void 0:e.llm.provider,typeof l=="string"?[new Pr(l)]:l,{onMessageUpdate:d=>{u==null||u(d.content)},llm:e==null?void 0:e.llm})).content}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return a({title:r("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:r("editor_node.errors.stream_message_failed")})}}},[n==null?void 0:n.main_node_id,e==null?void 0:e.llm,e==null?void 0:e.status,a,r,i,o]),c=g.useCallback(async()=>{if(!(n!=null&&n.main_node_id))return;const l=await ue("FlowEdge").find({where:{target:n.main_node_id}}),u=(await ue("FlowNode").find({where:{id:Ca(l.map(p=>p.source))}})).find(p=>p.source_type===oe.LLM);if(!u)return;const d=await ue("LLM").findOne({where:{id:u.source_id}});d&&(await i(d.provider,d.name,p=>{t(f=>f&&{...f,llm:d,progress:p.text})}),t({llm:d,status:Ge.Loaded}))},[n==null?void 0:n.main_node_id,i]);return g.useEffect(()=>{n!=null&&n.main_node_id&&c()},[n==null?void 0:n.main_node_id,c]),{mainLLMInfo:e,createMessage:s}},Ome=()=>{const e=Je(o=>o.currentSession),t=g.useRef(null),[n,r]=g.useState(),a=g.useCallback(async o=>{e!=null&&e.main_node_id&&(clearTimeout(t.current),t.current=setTimeout(async()=>{e!=null&&e.main_node_id&&await ue("FlowNode").update(e.main_node_id,{data:o})},150))},[e]);return g.useEffect(()=>{e!=null&&e.main_node_id&&ue("FlowNode").findOne({where:{id:e.main_node_id}}).then(o=>{r(o)})},[e]),{flowNode:n,updateEditorContent:a}},Cme=g.lazy(()=>At(()=>import("./index-t_d66ir0.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,11,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),Nme=g.memo(()=>{var o,i,s,c,l;const{flowNode:e,updateEditorContent:t}=Ome(),{mainLLMInfo:n,createMessage:r}=Eme(),a=g.useCallback(u=>{t(u)},[t]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(lu,{children:h.jsx(ba,{children:h.jsxs("div",{className:Z("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(n==null?void 0:n.status)===Ge.Loaded&&((o=n==null?void 0:n.llm)!=null&&o.name)?h.jsx(Aa,{name:(i=n==null?void 0:n.llm)==null?void 0:i.name,className:"w-5 h-5 mr-1"}):void 0,h.jsx(wa,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:n!=null&&n.progress?n==null?void 0:n.progress:(n==null?void 0:n.status)===Ge.Loaded?(s=n==null?void 0:n.llm)==null?void 0:s.name:h.jsx(de,{size:16,name:"loader-circle",className:"animate-spin ml-2"})}),h.jsx(Br,{children:h.jsx("p",{children:(n==null?void 0:n.progress)||((c=n==null?void 0:n.llm)==null?void 0:c.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(Tl,{simple:!0}),children:e?h.jsx(Cme,{defaultValue:e==null?void 0:e.data,onValueChange:a,copilotStream:r,hideDragIcon:!0,enableHistoryControl:!0},((l=n==null?void 0:n.llm)==null?void 0:l.name)||"default"):h.jsx(Tl,{simple:!0})})]})}),Mme=()=>{const[e,t]=g.useState(!1),[n,r]=g.useState(),a=Je(p=>p.currentSession),{t:o}=Pe("flows"),{toast:i}=Gt(),{loadModel:s}=Hh(),{stream:c}=kc(),l=g.useCallback(async(p,f,y)=>{if(a!=null&&a.main_node_id){if(!(n!=null&&n.llm)){i({variant:"destructive",description:o("editor_node.errors.llm_not_found")});return}(n==null?void 0:n.status)!==Ge.Loaded&&(await s(n.llm.provider,n.llm.name,m=>{r(v=>v&&{...v,progress:m.text})}),r(m=>m&&{...m,status:Ge.Loaded,progress:""}));try{const m=f.map(b=>b.role==="system"?new Pg(b.content):b.role==="assistant"?new Uo(b.content):new Pr(b.content)),v=await c(n.llm.provider,[...m,new Pr(p)],{onMessageUpdate:b=>{y==null||y(b.content)},llm:n.llm});return y==null||y(""),v.content}catch(m){if(m instanceof Error&&m.message.includes("LLM_NOT_LOADED_YET")){i({title:o("editor_node.errors.llm_not_loaded_yet")});return}i({variant:"destructive",title:o("editor_node.errors.stream_message_failed")})}}},[a==null?void 0:a.main_node_id,n==null?void 0:n.llm,n==null?void 0:n.status,i,o,s,c]),u=g.useCallback(async()=>{try{if(t(!0),!(a!=null&&a.main_node_id))return;const p=await ue("FlowEdge").find({where:{target:a.main_node_id}}),f=(await ue("FlowNode").find({where:{id:Ca(p.map(m=>m.source))}})).find(m=>m.source_type===oe.LLM);if(!f)return;const y=await ue("LLM").findOne({where:{id:f.source_id}});if(!y)return;await s(y.provider,y.name,m=>{r(v=>v&&{...v,llm:y,progress:m.text})}),r({llm:y,status:Ge.Loaded})}finally{t(!1)}},[a==null?void 0:a.main_node_id,s]),d=g.useCallback(async()=>{try{if(t(!0),!(n!=null&&n.llm))return;await s(n.llm.provider,n.llm.name,p=>{r(f=>f&&{...f,progress:p.text})}),r(p=>p&&{...p,status:Ge.Loaded,progress:""})}finally{t(!1)}},[s,n==null?void 0:n.llm]);return g.useEffect(()=>{a!=null&&a.main_node_id&&u()},[a==null?void 0:a.main_node_id,u]),{loading:e,mainLLMInfo:n,createMessage:l,loadCurrentModel:d}};hM=function(e,t=""){const n=[];for(const[r,a]of Object.entries(e)){const o=Oi(),i=[t,r].filter(Boolean).join("/"),s="file"in a&&"contents"in a.file?a.file:void 0,c={id:o,isSelectable:!0,content:typeof(s==null?void 0:s.contents)=="string"?s.contents:void 0,file:i,name:r,children:[]};"directory"in a&&(c.children=hM(a.directory,i)),n.push(c)}return n},Ev=function(e){const t=e.trim().split(`
`),n={};return t.forEach(r=>{const{file:a,content:o}=JSON.parse(r),i=a.split("/");let s=n;for(let c=0;c<i.length;c++){const l=i[c];c===i.length-1?s[l]={file:{contents:o}}:(s[l]||(s[l]={directory:{}}),s=s[l].directory)}}),n},xv=function(e){const t=[];function n(r,a=[]){for(const[o,i]of Object.entries(r))if("file"in i){const s=[...a,o].join("/");if("contents"in i.file){const c=i.file.contents;t.push(JSON.stringify({file:s,content:c}))}}else"directory"in i&&n(i.directory,[...a,o])}return n(e),t.join(`
`)},Ov=function(e,t){return vK(`[UpdateCodeContainerFile] Changes ${t.map(n=>`${n.type||"create_or_update"}:${n.path}`).join(", ")}`),t.forEach(({path:n,content:r,type:a="create_or_update"})=>{const o=n.replace(/^\.\//,"").split("/");let i=e;for(let s=0;s<o.length;s++){const c=o[s];if(s===o.length-1)a==="delete"?c in i&&"file"in i[c]?delete i[c]:console.warn(`Path "${n}" is not a file or does not exist.`):c in i&&"file"in i[c]?i[c].file.contents=r:i[c]={file:{contents:r}};else if(c in i&&"directory"in i[c])i=i[c].directory;else if(a==="delete"){console.warn(`Path "${n}" does not exist.`);break}else i[c]={directory:{}},i=i[c].directory}}),e};const Pme=()=>{const e=Je(i=>i.currentSession),[t,n]=g.useState(),r=g.useCallback(async(i,s)=>{await ue("FlowNode").update(i,{raw:xv(s)})},[]),a=g.useCallback(async i=>{e!=null&&e.main_node_id&&n(s=>{if(!(e!=null&&e.main_node_id))return s;const c=Ov(s||{},i);return r(e==null?void 0:e.main_node_id,c),c})},[e==null?void 0:e.main_node_id,r]),o=g.useCallback(async()=>{if(!(e!=null&&e.main_node_id))return;const i=await ue("FlowNode").findOne({where:{id:e==null?void 0:e.main_node_id}});i&&n(i.raw?Ev(i.raw):{})},[e==null?void 0:e.main_node_id]);return g.useEffect(()=>{e!=null&&e.main_node_id&&o()},[e==null?void 0:e.main_node_id,o]),{fileSystemTree:t,updateCodeContainerFile:a,updateCodeContainerData:r}},kme=g.lazy(()=>At(()=>import("./index-BOzrtCLL.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),Ame=g.memo(()=>{var s,c,l,u;const{loading:e,mainLLMInfo:t,loadCurrentModel:n,createMessage:r}=Mme(),{fileSystemTree:a,updateCodeContainerFile:o}=Pme(),i=g.useCallback((d,p,f)=>r(d,p,f),[r]);return h.jsxs("div",{className:"h-full w-full relative","data-registry":"plate",children:[h.jsx(lu,{children:h.jsx(ba,{children:h.jsxs("div",{className:Z("flex absolute !z-[51] right-1 top-0 max-w-28 h-9 items-center justify-center flex-row"),children:[(t==null?void 0:t.status)===Ge.Loaded&&((s=t==null?void 0:t.llm)!=null&&s.name)?h.jsx(Aa,{name:(c=t==null?void 0:t.llm)==null?void 0:c.name,className:"w-5 h-5 mr-1"}):void 0,h.jsxs(wa,{className:"overflow-hidden !text-ellipsis w-full max-w-full max-h-full whitespace-nowrap text-sm",children:[t!=null&&t.progress?t.progress:(t==null?void 0:t.status)===Ge.Loaded?((l=t==null?void 0:t.llm)==null?void 0:l.name)||"":e?h.jsx(de,{size:16,name:"loader-circle",className:"animate-spin ml-2"}):void 0,t!=null&&t.llm&&(t==null?void 0:t.status)!==Ge.Loaded?h.jsx(de,{size:16,name:"loader-circle",onClick:n,className:"animate-spin ml-2"}):void 0]}),h.jsx(Br,{children:h.jsx("p",{children:(t==null?void 0:t.progress)||((u=t==null?void 0:t.llm)==null?void 0:u.name)||""})})]})})}),h.jsx(g.Suspense,{fallback:h.jsx(Tl,{simple:!0}),children:a!==void 0?h.jsx(kme,{autoLoad:!0,hideAppName:!0,llm:t==null?void 0:t.llm,fileSystemTree:a,onUpdateFileContent:o,sendMessage:i}):void 0})]})});function Tme(){var t,n;const e=Je(r=>r.currentSession);if(!e)return h.jsx(Tl,{flickeringGrid:!0,className:"w-full h-full"});if(e.main_source_type==="Thread")return h.jsx(Sme,{});if(((t=e.main_node)==null?void 0:t.node_type)==="EDITOR_APP")return h.jsx(Nme,{});if(((n=e.main_node)==null?void 0:n.node_type)==="VSLITE_APP")return h.jsx(Ame,{})}var Dm="Menubar",[Kj,Ime,Rme]=Dp(Dm),[lF,h2e]=er(Dm,[Rme,Xa]),Fn=Df(),uF=Xa(),[Dme,Xj]=lF(Dm),dF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,value:r,onValueChange:a,defaultValue:o,loop:i=!0,dir:s,...c}=e,l=Wo(s),u=uF(n),[d="",p]=Sn({prop:r,onChange:a,defaultProp:o}),[f,y]=g.useState(null);return h.jsx(Dme,{scope:n,value:d,onMenuOpen:g.useCallback(m=>{p(m),y(m)},[p]),onMenuClose:g.useCallback(()=>p(""),[p]),onMenuToggle:g.useCallback(m=>{p(v=>v?"":m),y(m)},[p]),dir:l,loop:i,children:h.jsx(Kj.Provider,{scope:n,children:h.jsx(Kj.Slot,{scope:n,children:h.jsx(zl,{asChild:!0,...u,orientation:"horizontal",loop:i,dir:l,currentTabStopId:f,onCurrentTabStopIdChange:y,children:h.jsx(Ae.div,{role:"menubar",...c,ref:t})})})})})});dF.displayName=Dm;var Zj="MenubarMenu",[Lme,pF]=lF(Zj),fF=e=>{const{__scopeMenubar:t,value:n,...r}=e,a=Pt(),o=n||a||"LEGACY_REACT_AUTO_VALUE",i=Xj(Zj,t),s=Fn(t),c=g.useRef(null),l=g.useRef(!1),u=i.value===o;return g.useEffect(()=>{u||(l.current=!1)},[u]),h.jsx(Lme,{scope:t,value:o,triggerId:Pt(),triggerRef:c,contentId:Pt(),wasKeyboardTriggerOpenRef:l,children:h.jsx(g2,{...s,open:u,onOpenChange:d=>{d||i.onMenuClose()},modal:!1,dir:i.dir,...r})})};fF.displayName=Zj;var Gj="MenubarTrigger",hF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,disabled:r=!1,...a}=e,o=uF(n),i=Fn(n),s=Xj(Gj,n),c=pF(Gj,n),l=g.useRef(null),u=wt(t,l,c.triggerRef),[d,p]=g.useState(!1),f=s.value===c.value;return h.jsx(Kj.ItemSlot,{scope:n,value:c.value,disabled:r,children:h.jsx(Vl,{asChild:!0,...o,focusable:!r,tabStopId:c.value,children:h.jsx(v2,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",role:"menuitem",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":f,"aria-controls":f?c.contentId:void 0,"data-highlighted":d?"":void 0,"data-state":f?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:u,onPointerDown:ge(e.onPointerDown,y=>{!r&&y.button===0&&y.ctrlKey===!1&&(s.onMenuOpen(c.value),f||y.preventDefault())}),onPointerEnter:ge(e.onPointerEnter,()=>{var y;s.value&&!f&&(s.onMenuOpen(c.value),(y=l.current)==null||y.focus())}),onKeyDown:ge(e.onKeyDown,y=>{r||(["Enter"," "].includes(y.key)&&s.onMenuToggle(c.value),y.key==="ArrowDown"&&s.onMenuOpen(c.value),["Enter"," ","ArrowDown"].includes(y.key)&&(c.wasKeyboardTriggerOpenRef.current=!0,y.preventDefault()))}),onFocus:ge(e.onFocus,()=>p(!0)),onBlur:ge(e.onBlur,()=>p(!1))})})})})});hF.displayName=Gj;var $me="MenubarPortal",mF=e=>{const{__scopeMenubar:t,...n}=e,r=Fn(t);return h.jsx(b2,{...r,...n})};mF.displayName=$me;var Qj="MenubarContent",yF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,align:r="start",...a}=e,o=Fn(n),i=Xj(Qj,n),s=pF(Qj,n),c=Ime(n),l=g.useRef(!1);return h.jsx(w2,{id:s.contentId,"aria-labelledby":s.triggerId,"data-radix-menubar-content":"",...o,...a,ref:t,align:r,onCloseAutoFocus:ge(e.onCloseAutoFocus,u=>{var d;!i.value&&!l.current&&((d=s.triggerRef.current)==null||d.focus()),l.current=!1,u.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,u=>{const d=u.target;c().some(p=>{var f;return(f=p.ref.current)==null?void 0:f.contains(d)})&&u.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,()=>{l.current=!0}),onEntryFocus:u=>{s.wasKeyboardTriggerOpenRef.current||u.preventDefault()},onKeyDown:ge(e.onKeyDown,u=>{if(["ArrowRight","ArrowLeft"].includes(u.key)){const d=u.target,p=d.hasAttribute("data-radix-menubar-subtrigger"),f=d.closest("[data-radix-menubar-content]")!==u.currentTarget,y=(i.dir==="rtl"?"ArrowRight":"ArrowLeft")===u.key;if(!y&&p||f&&y)return;let m=c().filter(w=>!w.disabled).map(w=>w.value);y&&m.reverse();const v=m.indexOf(s.value);m=i.loop?Jme(m,v+1):m.slice(v+1);const[b]=m;b&&i.onMenuOpen(b)}},{checkForDefaultPrevented:!1}),style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});yF.displayName=Qj;var Fme="MenubarGroup",Bme=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(x2,{...a,...r,ref:t})});Bme.displayName=Fme;var zme="MenubarLabel",gF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(_2,{...a,...r,ref:t})});gF.displayName=zme;var Vme="MenubarItem",vF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(j2,{...a,...r,ref:t})});vF.displayName=Vme;var Ume="MenubarCheckboxItem",bF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(S2,{...a,...r,ref:t})});bF.displayName=Ume;var Wme="MenubarRadioGroup",Hme=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(E2,{...a,...r,ref:t})});Hme.displayName=Wme;var qme="MenubarRadioItem",wF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(O2,{...a,...r,ref:t})});wF.displayName=qme;var Kme="MenubarItemIndicator",xF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(C2,{...a,...r,ref:t})});xF.displayName=Kme;var Xme="MenubarSeparator",_F=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(N2,{...a,...r,ref:t})});_F.displayName=Xme;var Zme="MenubarArrow",Gme=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(M2,{...a,...r,ref:t})});Gme.displayName=Zme;var Qme="MenubarSubTrigger",jF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(P2,{"data-radix-menubar-subtrigger":"",...a,...r,ref:t})});jF.displayName=Qme;var Yme="MenubarSubContent",SF=g.forwardRef((e,t)=>{const{__scopeMenubar:n,...r}=e,a=Fn(n);return h.jsx(k2,{...a,"data-radix-menubar-content":"",...r,ref:t,style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});SF.displayName=Yme;function Jme(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var EF=dF,eye=fF,OF=hF,tye=mF,CF=yF,NF=gF,MF=vF,PF=bF,kF=wF,AF=xF,TF=_F,IF=jF,RF=SF;const Yj=eye,DF=g.forwardRef(({className:e,...t},n)=>h.jsx(EF,{ref:n,className:Z("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",e),...t}));DF.displayName=EF.displayName;const Jj=g.forwardRef(({className:e,...t},n)=>h.jsx(OF,{ref:n,className:Z("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",e),...t}));Jj.displayName=OF.displayName;const nye=g.forwardRef(({className:e,inset:t,children:n,...r},a)=>h.jsxs(IF,{ref:a,className:Z("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...r,children:[n,h.jsx(de,{name:"chevron-right",className:"ml-auto h-4 w-4"})]}));nye.displayName=IF.displayName;const rye=g.forwardRef(({className:e,...t},n)=>h.jsx(RF,{ref:n,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));rye.displayName=RF.displayName;const LF=g.forwardRef(({className:e,align:t="start",alignOffset:n=-4,sideOffset:r=8,...a},o)=>h.jsx(tye,{children:h.jsx(CF,{ref:o,align:t,alignOffset:n,sideOffset:r,className:Z("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));LF.displayName=CF.displayName;const $F=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(MF,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));$F.displayName=MF.displayName;const aye=g.forwardRef(({className:e,children:t,checked:n,...r},a)=>h.jsxs(PF,{ref:a,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(AF,{children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}),t]}));aye.displayName=PF.displayName;const oye=g.forwardRef(({className:e,children:t,...n},r)=>h.jsxs(kF,{ref:r,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(AF,{children:h.jsx(de,{name:"circle",className:"h-2 w-2 fill-current"})})}),t]}));oye.displayName=kF.displayName;const iye=g.forwardRef(({className:e,inset:t,...n},r)=>h.jsx(NF,{ref:r,className:Z("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));iye.displayName=NF.displayName;const sye=g.forwardRef(({className:e,...t},n)=>h.jsx(TF,{ref:n,className:Z("-mx-1 my-1 h-px bg-muted",e),...t}));sye.displayName=TF.displayName;let FF;De=VAe()(UAe(WAe((e,t)=>({...H4,...eue(e,t)})))),FF=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.pushSyncNodeQueue),a=De(i=>i.createOrUpdateFlowNode),o=g.useCallback(async(i,s)=>{try{if(!e)throw new Error("Session not found");if(!s.provider||!s.name)throw new Error("Provider and name are required");n(!0);const c=await ue("LLM").findOne({where:{name:s.name,session_id:e}});return c?(r("LLM",{where:{source_type:"LLM",source_id:c.id}}),c):ue("LLM").save({name:`${s.name}`,status:s.provider===nn.WebLLM?Ge.Started:Ge.Loaded,session_id:e,provider:s.provider,metadata:JSON.stringify(s.metadata||{}),model_type:s.model_type||Xl.LLM,parameters:s.parameters||void 0,...s}).then(async l=>{var u,d,p;return await a({source_id:l.id,source_type:"LLM",node_type:oe.LLM,x:(u=i.position)==null?void 0:u.x,y:((d=i.position)==null?void 0:d.y)+(((p=i.measured)==null?void 0:p.height)||0)+30}),l})}finally{n(!1)}},[a,r,e]);return{loading:t,createLLM:o}};function di(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e==null||e(r),n===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}function BF(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function zF(...e){return t=>{let n=!1;const r=e.map(a=>{const o=BF(a,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let a=0;a<r.length;a++){const o=r[a];typeof o=="function"?o():BF(e[a],null)}}}}function pi(...e){return g.useCallback(zF(...e),e)}var eS=g.forwardRef((e,t)=>{const{children:n,...r}=e,a=g.Children.toArray(n),o=a.find(lye);if(o){const i=o.props.children,s=a.map(c=>c===o?g.Children.count(i)>1?g.Children.only(null):g.isValidElement(i)?i.props.children:null:c);return h.jsx(tS,{...r,ref:t,children:g.isValidElement(i)?g.cloneElement(i,void 0,s):null})}return h.jsx(tS,{...r,ref:t,children:n})});eS.displayName="Slot";var tS=g.forwardRef((e,t)=>{const{children:n,...r}=e;if(g.isValidElement(n)){const a=dye(n);return g.cloneElement(n,{...uye(r,n.props),ref:t?zF(t,a):a})}return g.Children.count(n)>1?g.Children.only(null):null});tS.displayName="SlotClone";var cye=({children:e})=>h.jsx(h.Fragment,{children:e});function lye(e){return g.isValidElement(e)&&e.type===cye}function uye(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...i)=>{o(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function dye(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var pye=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Oo=pye.reduce((e,t)=>{const n=g.forwardRef((r,a)=>{const{asChild:o,...i}=r,s=o?eS:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(s,{...i,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function fye(e,t){e&&Nl.flushSync(()=>e.dispatchEvent(t))}var hye="DismissableLayer",nS="dismissableLayer.update",mye="dismissableLayer.pointerDownOutside",yye="dismissableLayer.focusOutside",VF,UF=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),WF=g.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:i,onDismiss:s,...c}=e,l=g.useContext(UF),[u,d]=g.useState(null),p=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=g.useState({}),y=pi(t,E=>d(E)),m=Array.from(l.layers),[v]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),b=m.indexOf(v),w=u?m.indexOf(u):-1,j=l.layersWithOutsidePointerEventsDisabled.size>0,x=w>=b,_=bye(E=>{const O=E.target,M=[...l.branches].some(N=>N.contains(O));!x||M||(a==null||a(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},p),S=wye(E=>{const O=E.target;[...l.branches].some(M=>M.contains(O))||(o==null||o(E),i==null||i(E),E.defaultPrevented||(s==null||s()))},p);return HAe(E=>{w===l.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&s&&(E.preventDefault(),s()))},p),g.useEffect(()=>{if(u)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(VF=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(u)),l.layers.add(u),HF(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=VF)}},[u,p,n,l]),g.useEffect(()=>()=>{u&&(l.layers.delete(u),l.layersWithOutsidePointerEventsDisabled.delete(u),HF())},[u,l]),g.useEffect(()=>{const E=()=>f({});return document.addEventListener(nS,E),()=>document.removeEventListener(nS,E)},[]),h.jsx(Oo.div,{...c,ref:y,style:{pointerEvents:j?x?"auto":"none":void 0,...e.style},onFocusCapture:di(e.onFocusCapture,S.onFocusCapture),onBlurCapture:di(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:di(e.onPointerDownCapture,_.onPointerDownCapture)})});WF.displayName=hye;var gye="DismissableLayerBranch",vye=g.forwardRef((e,t)=>{const n=g.useContext(UF),r=g.useRef(null),a=pi(t,r);return g.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),h.jsx(Oo.div,{...e,ref:a})});vye.displayName=gye;function bye(e,t=globalThis==null?void 0:globalThis.document){const n=tr(e),r=g.useRef(!1),a=g.useRef(()=>{});return g.useEffect(()=>{const o=s=>{if(s.target&&!r.current){let c=function(){qF(mye,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function wye(e,t=globalThis==null?void 0:globalThis.document){const n=tr(e),r=g.useRef(!1);return g.useEffect(()=>{const a=o=>{o.target&&!r.current&&qF(yye,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function HF(){const e=new CustomEvent(nS);document.dispatchEvent(e)}function qF(e,t,n,{discrete:r}){const a=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?fye(a,o):a.dispatchEvent(o)}var rS="focusScope.autoFocusOnMount",aS="focusScope.autoFocusOnUnmount",KF={bubbles:!1,cancelable:!0},xye="FocusScope",XF=g.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=e,[s,c]=g.useState(null),l=tr(a),u=tr(o),d=g.useRef(null),p=pi(t,m=>c(m)),f=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let m=function(j){if(f.paused||!s)return;const x=j.target;s.contains(x)?d.current=x:fi(d.current,{select:!0})},v=function(j){if(f.paused||!s)return;const x=j.relatedTarget;x!==null&&(s.contains(x)||fi(d.current,{select:!0}))},b=function(j){if(document.activeElement===document.body)for(const x of j)x.removedNodes.length>0&&fi(s)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const w=new MutationObserver(b);return s&&w.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),w.disconnect()}}},[r,s,f.paused]),g.useEffect(()=>{if(s){QF.add(f);const m=document.activeElement;if(!s.contains(m)){const v=new CustomEvent(rS,KF);s.addEventListener(rS,l),s.dispatchEvent(v),v.defaultPrevented||(_ye(Cye(ZF(s)),{select:!0}),document.activeElement===m&&fi(s))}return()=>{s.removeEventListener(rS,l),setTimeout(()=>{const v=new CustomEvent(aS,KF);s.addEventListener(aS,u),s.dispatchEvent(v),v.defaultPrevented||fi(m??document.body,{select:!0}),s.removeEventListener(aS,u),QF.remove(f)},0)}}},[s,l,u,f]);const y=g.useCallback(m=>{if(!n&&!r||f.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,b=document.activeElement;if(v&&b){const w=m.currentTarget,[j,x]=jye(w);j&&x?!m.shiftKey&&b===x?(m.preventDefault(),n&&fi(j,{select:!0})):m.shiftKey&&b===j&&(m.preventDefault(),n&&fi(x,{select:!0})):b===w&&m.preventDefault()}},[n,r,f.paused]);return h.jsx(Oo.div,{tabIndex:-1,...i,ref:p,onKeyDown:y})});XF.displayName=xye;function _ye(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(fi(r,{select:t}),document.activeElement!==n)return}function jye(e){const t=ZF(e),n=GF(t,e),r=GF(t.reverse(),e);return[n,r]}function ZF(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function GF(e,t){for(const n of e)if(!Sye(n,{upTo:t}))return n}function Sye(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Eye(e){return e instanceof HTMLInputElement&&"select"in e}function fi(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Eye(e)&&t&&e.select()}}var QF=Oye();function Oye(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=YF(e,t),e.unshift(t)},remove(t){var n;e=YF(e,t),(n=e[0])==null||n.resume()}}}function YF(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Cye(e){return e.filter(t=>t.tagName!=="A")}var Nye="Arrow",JF=g.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return h.jsx(Oo.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});JF.displayName=Nye;var Mye=JF,oS="Popper",[e9,t9]=er(oS),[Pye,n9]=e9(oS),r9=e=>{const{__scopePopper:t,children:n}=e,[r,a]=g.useState(null);return h.jsx(Pye,{scope:t,anchor:r,onAnchorChange:a,children:n})};r9.displayName=oS;var a9="PopperAnchor",o9=g.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=n9(a9,n),i=g.useRef(null),s=pi(t,i);return g.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:h.jsx(Oo.div,{...a,ref:s})});o9.displayName=a9;var iS="PopperContent",[kye,Aye]=e9(iS),i9=g.forwardRef((e,t)=>{var Q,q,H,X,te,F;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:s=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:y,...m}=e,v=n9(iS,n),[b,w]=g.useState(null),j=pi(t,se=>w(se)),[x,_]=g.useState(null),S=Up(x),E=(S==null?void 0:S.width)??0,O=(S==null?void 0:S.height)??0,M=r+(o!=="center"?"-"+o:""),N=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(l)?l:[l],I=P.length>0,k={padding:N,boundary:P.filter(Iye),altBoundary:I},{refs:C,floatingStyles:T,placement:A,isPositioned:D,middlewareData:L}=Gg({strategy:"fixed",placement:M,whileElementsMounted:(...se)=>Dg(...se,{animationFrame:f==="always"}),elements:{reference:v.anchor},middleware:[$g({mainAxis:a+O,alignmentAxis:i}),c&&lv({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?uv():void 0,...k}),c&&dv({...k}),pv({...k,apply:({elements:se,rects:re,availableWidth:le,availableHeight:je})=>{const{width:Le,height:$e}=re.reference,Se=se.floating.style;Se.setProperty("--radix-popper-available-width",`${le}px`),Se.setProperty("--radix-popper-available-height",`${je}px`),Se.setProperty("--radix-popper-anchor-width",`${Le}px`),Se.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),x&&fv({element:x,padding:s}),Rye({arrowWidth:E,arrowHeight:O}),p&&hv({strategy:"referenceHidden",...k})]}),[R,B]=l9(A),z=tr(y);tn(()=>{D&&(z==null||z())},[D,z]);const $=(Q=L.arrow)==null?void 0:Q.x,V=(q=L.arrow)==null?void 0:q.y,Y=((H=L.arrow)==null?void 0:H.centerOffset)!==0,[G,K]=g.useState();return tn(()=>{b&&K(window.getComputedStyle(b).zIndex)},[b]),h.jsx("div",{ref:C.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:D?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:G,"--radix-popper-transform-origin":[(X=L.transformOrigin)==null?void 0:X.x,(te=L.transformOrigin)==null?void 0:te.y].join(" "),...((F=L.hide)==null?void 0:F.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(kye,{scope:n,placedSide:R,onArrowChange:_,arrowX:$,arrowY:V,shouldHideArrow:Y,children:h.jsx(Oo.div,{"data-side":R,"data-align":B,...m,ref:j,style:{...m.style,animation:D?void 0:"none"}})})})});i9.displayName=iS;var s9="PopperArrow",Tye={top:"bottom",right:"left",bottom:"top",left:"right"},c9=g.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,a=Aye(s9,n),o=Tye[a.placedSide];return h.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:h.jsx(Mye,{...r,ref:t,style:{...r.style,display:"block"}})})});c9.displayName=s9;function Iye(e){return e!==null}var Rye=e=>({name:"transformOrigin",options:e,fn(t){var m,v,b;const{placement:n,rects:r,middlewareData:a}=t,o=((m=a.arrow)==null?void 0:m.centerOffset)!==0,i=o?0:e.arrowWidth,s=o?0:e.arrowHeight,[c,l]=l9(n),u={start:"0%",center:"50%",end:"100%"}[l],d=(((v=a.arrow)==null?void 0:v.x)??0)+i/2,p=(((b=a.arrow)==null?void 0:b.y)??0)+s/2;let f="",y="";return c==="bottom"?(f=o?u:`${d}px`,y=`${-s}px`):c==="top"?(f=o?u:`${d}px`,y=`${r.floating.height+s}px`):c==="right"?(f=`${-s}px`,y=o?u:`${p}px`):c==="left"&&(f=`${r.floating.width+s}px`,y=o?u:`${p}px`),{data:{x:f,y}}}});function l9(e){const[t,n="center"]=e.split("-");return[t,n]}var Dye=r9,u9=o9,Lye=i9,$ye=c9,Fye="Portal",d9=g.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[a,o]=g.useState(!1);tn(()=>o(!0),[]);const i=n||a&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return i?qAe.createPortal(h.jsx(Oo.div,{...r,ref:t}),i):null});d9.displayName=Fye;function Bye(e,t){return g.useReducer((n,r)=>t[n][r]??n,e)}var sS=e=>{const{present:t,children:n}=e,r=zye(t),a=typeof n=="function"?n({present:r.isPresent}):g.Children.only(n),o=pi(r.ref,Vye(a));return typeof n=="function"||r.isPresent?g.cloneElement(a,{ref:o}):null};sS.displayName="Presence";function zye(e){const[t,n]=g.useState(),r=g.useRef({}),a=g.useRef(e),o=g.useRef("none"),i=e?"mounted":"unmounted",[s,c]=Bye(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const l=Lm(r.current);o.current=s==="mounted"?l:"none"},[s]),tn(()=>{const l=r.current,u=a.current;if(u!==e){const d=o.current,p=Lm(l);e?c("MOUNT"):p==="none"||(l==null?void 0:l.display)==="none"?c("UNMOUNT"):c(u&&d!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),tn(()=>{if(t){let l;const u=t.ownerDocument.defaultView??window,d=f=>{const y=Lm(r.current).includes(f.animationName);if(f.target===t&&y&&(c("ANIMATION_END"),!a.current)){const m=t.style.animationFillMode;t.style.animationFillMode="forwards",l=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=m)})}},p=f=>{f.target===t&&(o.current=Lm(r.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(l),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:g.useCallback(l=>{l&&(r.current=getComputedStyle(l)),n(l)},[])}}function Lm(e){return(e==null?void 0:e.animationName)||"none"}function Vye(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var $m="right-scroll-bar-position",Fm="width-before-scroll-bar",Uye="with-scroll-bars-hidden",Wye="--removed-body-scroll-bar-size";function cS(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Hye(e,t){var n=g.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var qye=typeof window<"u"?g.useLayoutEffect:g.useEffect,p9=new WeakMap;function Kye(e,t){var n=Hye(null,function(r){return e.forEach(function(a){return cS(a,r)})});return qye(function(){var r=p9.get(n);if(r){var a=new Set(r),o=new Set(e),i=n.current;a.forEach(function(s){o.has(s)||cS(s,null)}),o.forEach(function(s){a.has(s)||cS(s,i)})}p9.set(n,e)},[e]),n}var f9=mv(),lS=function(){},Bm=g.forwardRef(function(e,t){var n=g.useRef(null),r=g.useState({onScrollCapture:lS,onWheelCapture:lS,onTouchMoveCapture:lS}),a=r[0],o=r[1],i=e.forwardProps,s=e.children,c=e.className,l=e.removeScrollBar,u=e.enabled,d=e.shards,p=e.sideCar,f=e.noIsolation,y=e.inert,m=e.allowPinchZoom,v=e.as,b=v===void 0?"div":v,w=e.gapMode,j=Wp(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=p,_=Kye([n,t]),S=yn(yn({},j),a);return g.createElement(g.Fragment,null,u&&g.createElement(x,{sideCar:f9,removeScrollBar:l,shards:d,noIsolation:f,inert:y,setCallbacks:o,allowPinchZoom:!!m,lockRef:n,gapMode:w}),i?g.cloneElement(g.Children.only(s),yn(yn({},S),{ref:_})):g.createElement(b,yn({},S,{className:c,ref:_}),s))});Bm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Bm.classNames={fullWidth:Fm,zeroRight:$m};function Xye(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=yv();return t&&e.setAttribute("nonce",t),e}function Zye(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Gye(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Qye=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Xye())&&(Zye(t,n),Gye(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Yye=function(){var e=Qye();return function(t,n){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Jye=function(){var e=Yye(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},ege={left:0,top:0,right:0,gap:0},uS=function(e){return parseInt(e||"",10)||0},tge=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[uS(n),uS(r),uS(a)]},nge=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return ege;var t=tge(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},rge=Jye(),Dc="data-scroll-locked",age=function(e,t,n,r){var a=e.left,o=e.top,i=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Uye,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body[`).concat(Dc,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat($m,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(Fm,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat($m," .").concat($m,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Fm," .").concat(Fm,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Dc,`] {
    `).concat(Wye,": ").concat(s,`px;
  }
`)},h9=function(){var e=parseInt(document.body.getAttribute(Dc)||"0",10);return isFinite(e)?e:0},oge=function(){g.useEffect(function(){return document.body.setAttribute(Dc,(h9()+1).toString()),function(){var e=h9()-1;e<=0?document.body.removeAttribute(Dc):document.body.setAttribute(Dc,e.toString())}},[])},ige=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;oge();var o=g.useMemo(function(){return nge(a)},[a]);return g.createElement(rge,{styles:age(o,!t,a,n?"":"!important")})},dS=!1;if(typeof window<"u")try{var zm=Object.defineProperty({},"passive",{get:function(){return dS=!0,!0}});window.addEventListener("test",zm,zm),window.removeEventListener("test",zm,zm)}catch{dS=!1}var Lc=dS?{passive:!1}:!1,sge=function(e){return e.tagName==="TEXTAREA"},m9=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!sge(e)&&n[t]==="visible")},cge=function(e){return m9(e,"overflowY")},lge=function(e){return m9(e,"overflowX")},y9=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=g9(e,r);if(a){var o=v9(e,r),i=o[1],s=o[2];if(i>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},uge=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},dge=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},g9=function(e,t){return e==="v"?cge(t):lge(t)},v9=function(e,t){return e==="v"?uge(t):dge(t)},pge=function(e,t){return e==="h"&&t==="rtl"?-1:1},fge=function(e,t,n,r,a){var o=pge(e,window.getComputedStyle(t).direction),i=o*r,s=n.target,c=t.contains(s),l=!1,u=i>0,d=0,p=0;do{var f=v9(e,s),y=f[0],m=f[1],v=f[2],b=m-v-o*y;(y||b)&&g9(e,s)&&(d+=b,p+=y),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!c&&s!==document.body||c&&(t.contains(s)||t===s));return(u&&(Math.abs(d)<1||!a)||!u&&(Math.abs(p)<1||!a))&&(l=!0),l},Vm=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},b9=function(e){return[e.deltaX,e.deltaY]},w9=function(e){return e&&"current"in e?e.current:e},hge=function(e,t){return e[0]===t[0]&&e[1]===t[1]},mge=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},yge=0,$c=[];function gge(e){var t=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(yge++)[0],o=g.useState(Hp)[0],i=g.useRef(e);g.useEffect(function(){i.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=gv([e.lockRef.current],(e.shards||[]).map(w9),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=g.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var b=Vm(m),w=n.current,j="deltaX"in m?m.deltaX:w[0]-b[0],x="deltaY"in m?m.deltaY:w[1]-b[1],_,S=m.target,E=Math.abs(j)>Math.abs(x)?"h":"v";if("touches"in m&&E==="h"&&S.type==="range")return!1;var O=y9(E,S);if(!O)return!0;if(O?_=E:(_=E==="v"?"h":"v",O=y9(E,S)),!O)return!1;if(!r.current&&"changedTouches"in m&&(j||x)&&(r.current=_),!_)return!0;var M=r.current||_;return fge(M,v,m,M==="h"?j:x,!0)},[]),c=g.useCallback(function(m){var v=m;if(!(!$c.length||$c[$c.length-1]!==o)){var b="deltaY"in v?b9(v):Vm(v),w=t.current.filter(function(_){return _.name===v.type&&(_.target===v.target||v.target===_.shadowParent)&&hge(_.delta,b)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var j=(i.current.shards||[]).map(w9).filter(Boolean).filter(function(_){return _.contains(v.target)}),x=j.length>0?s(v,j[0]):!i.current.noIsolation;x&&v.cancelable&&v.preventDefault()}}},[]),l=g.useCallback(function(m,v,b,w){var j={name:m,delta:v,target:b,should:w,shadowParent:vge(b)};t.current.push(j),setTimeout(function(){t.current=t.current.filter(function(x){return x!==j})},1)},[]),u=g.useCallback(function(m){n.current=Vm(m),r.current=void 0},[]),d=g.useCallback(function(m){l(m.type,b9(m),m.target,s(m,e.lockRef.current))},[]),p=g.useCallback(function(m){l(m.type,Vm(m),m.target,s(m,e.lockRef.current))},[]);g.useEffect(function(){return $c.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:p}),document.addEventListener("wheel",c,Lc),document.addEventListener("touchmove",c,Lc),document.addEventListener("touchstart",u,Lc),function(){$c=$c.filter(function(m){return m!==o}),document.removeEventListener("wheel",c,Lc),document.removeEventListener("touchmove",c,Lc),document.removeEventListener("touchstart",u,Lc)}},[]);var f=e.removeScrollBar,y=e.inert;return g.createElement(g.Fragment,null,y?g.createElement(o,{styles:mge(a)}):null,f?g.createElement(ige,{gapMode:e.gapMode}):null)}function vge(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const bge=vv(f9,gge);var x9=g.forwardRef(function(e,t){return g.createElement(Bm,yn({},e,{ref:t,sideCar:bge}))});x9.classNames=Bm.classNames;var pS="Popover",[_9,m2e]=er(pS,[t9]),Md=t9(),[wge,hi]=_9(pS),j9=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:i=!1}=e,s=Md(t),c=g.useRef(null),[l,u]=g.useState(!1),[d=!1,p]=Sn({prop:r,defaultProp:a,onChange:o});return h.jsx(Dye,{...s,children:h.jsx(wge,{scope:t,contentId:Pt(),triggerRef:c,open:d,onOpenChange:p,onOpenToggle:g.useCallback(()=>p(f=>!f),[p]),hasCustomAnchor:l,onCustomAnchorAdd:g.useCallback(()=>u(!0),[]),onCustomAnchorRemove:g.useCallback(()=>u(!1),[]),modal:i,children:n})})};j9.displayName=pS;let fS;fS="PopoverAnchor",Fg=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hi(fS,n),o=Md(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:s}=a;return g.useEffect(()=>(i(),()=>s()),[i,s]),h.jsx(u9,{...o,...r,ref:t})}),Fg.displayName=fS;var S9="PopoverTrigger",hS=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hi(S9,n),o=Md(n),i=pi(t,a.triggerRef),s=h.jsx(Oo.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":M9(a.open),...r,ref:i,onClick:di(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?s:h.jsx(u9,{asChild:!0,...o,children:s})});hS.displayName=S9;var mS="PopoverPortal",[xge,_ge]=_9(mS,{forceMount:void 0}),E9=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,o=hi(mS,t);return h.jsx(xge,{scope:t,forceMount:n,children:h.jsx(sS,{present:n||o.open,children:h.jsx(d9,{asChild:!0,container:a,children:r})})})};E9.displayName=mS;var Fc="PopoverContent",O9=g.forwardRef((e,t)=>{const n=_ge(Fc,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,o=hi(Fc,e.__scopePopover);return h.jsx(sS,{present:r||o.open,children:o.modal?h.jsx(jge,{...a,ref:t}):h.jsx(Sge,{...a,ref:t})})});O9.displayName=Fc;var jge=g.forwardRef((e,t)=>{const n=hi(Fc,e.__scopePopover),r=g.useRef(null),a=pi(t,r),o=g.useRef(!1);return g.useEffect(()=>{const i=r.current;if(i)return Wl(i)},[]),h.jsx(x9,{as:eS,allowPinchZoom:!0,children:h.jsx(C9,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:di(e.onCloseAutoFocus,i=>{var s;i.preventDefault(),o.current||((s=n.triggerRef.current)==null||s.focus())}),onPointerDownOutside:di(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,c=s.button===0&&s.ctrlKey===!0,l=s.button===2||c;o.current=l},{checkForDefaultPrevented:!1}),onFocusOutside:di(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Sge=g.forwardRef((e,t)=>{const n=hi(Fc,e.__scopePopover),r=g.useRef(!1),a=g.useRef(!1);return h.jsx(C9,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,s;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||((s=n.triggerRef.current)==null||s.focus()),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var s,c;(s=e.onInteractOutside)==null||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;(c=n.triggerRef.current)!=null&&c.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),C9=g.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onInteractOutside:u,...d}=e,p=hi(Fc,n),f=Md(n);return Hl(),h.jsx(XF,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:h.jsx(WF,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:s,onPointerDownOutside:c,onFocusOutside:l,onDismiss:()=>p.onOpenChange(!1),children:h.jsx(Lye,{"data-state":M9(p.open),role:"dialog",id:p.contentId,...f,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),N9="PopoverClose",Ege=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hi(N9,n);return h.jsx(Oo.button,{type:"button",...r,ref:t,onClick:di(e.onClick,()=>a.onOpenChange(!1))})});Ege.displayName=N9;var Oge="PopoverArrow",Cge=g.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Md(n);return h.jsx($ye,{...a,...r,ref:t})});Cge.displayName=Oge;function M9(e){return e?"open":"closed"}JN=j9,CK=Fg,eM=hS,YN=E9,Qg=O9,dM=JN,kK=eM,bv=g.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},a)=>h.jsx(YN,{children:h.jsx(Qg,{ref:a,align:t,sideOffset:n,className:Z("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})})),bv.displayName=Qg.displayName;var P9=1,Nge=.9,Mge=.8,Pge=.17,yS=.1,gS=.999,kge=.9999,Age=.99,Tge=/[\\\/_+.#"@\[\(\{&]/,Ige=/[\\\/_+.#"@\[\(\{&]/g,Rge=/[\s-]/,k9=/[\s-]/g;function vS(e,t,n,r,a,o,i){if(o===t.length)return a===e.length?P9:Age;var s=`${a},${o}`;if(i[s]!==void 0)return i[s];for(var c=r.charAt(o),l=n.indexOf(c,a),u=0,d,p,f,y;l>=0;)d=vS(e,t,n,r,l+1,o+1,i),d>u&&(l===a?d*=P9:Tge.test(e.charAt(l-1))?(d*=Mge,f=e.slice(a,l-1).match(Ige),f&&a>0&&(d*=Math.pow(gS,f.length))):Rge.test(e.charAt(l-1))?(d*=Nge,y=e.slice(a,l-1).match(k9),y&&a>0&&(d*=Math.pow(gS,y.length))):(d*=Pge,a>0&&(d*=Math.pow(gS,l-a))),e.charAt(l)!==t.charAt(o)&&(d*=kge)),(d<yS&&n.charAt(l-1)===r.charAt(o+1)||r.charAt(o+1)===r.charAt(o)&&n.charAt(l-1)!==r.charAt(o))&&(p=vS(e,t,n,r,l+1,o+2,i),p*yS>d&&(d=p*yS)),d>u&&(u=d),l=n.indexOf(c,l+1);return i[s]=u,u}function A9(e){return e.toLowerCase().replace(k9," ")}function Dge(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,vS(e,t,A9(e),A9(t),0,0,{})}var Pd='[cmdk-group=""]',bS='[cmdk-group-items=""]',Lge='[cmdk-group-heading=""]',wS='[cmdk-item=""]',T9=`${wS}:not([aria-disabled="true"])`,xS="cmdk-item-select",rs="data-value",$ge=(e,t,n)=>Dge(e,t,n),I9=g.createContext(void 0),kd=()=>g.useContext(I9),R9=g.createContext(void 0),_S=()=>g.useContext(R9),D9=g.createContext(void 0),L9=g.forwardRef((e,t)=>{let n=Bc(()=>{var $,V;return{search:"",value:(V=($=e.value)!=null?$:e.defaultValue)!=null?V:"",filtered:{count:0,items:new Map,groups:new Set}}}),r=Bc(()=>new Set),a=Bc(()=>new Map),o=Bc(()=>new Map),i=Bc(()=>new Set),s=$9(e),{label:c,children:l,value:u,onValueChange:d,filter:p,shouldFilter:f,loop:y,disablePointerSelection:m=!1,vimBindings:v=!0,...b}=e,w=Pt(),j=Pt(),x=Pt(),_=g.useRef(null),S=Zge();as(()=>{if(u!==void 0){let $=u.trim();n.current.value=$,E.emit()}},[u]),as(()=>{S(6,k)},[]);let E=g.useMemo(()=>({subscribe:$=>(i.current.add($),()=>i.current.delete($)),snapshot:()=>n.current,setState:($,V,Y)=>{var G,K,Q;if(!Object.is(n.current[$],V)){if(n.current[$]=V,$==="search")I(),N(),S(1,P);else if($==="value"&&(Y||S(5,k),((G=s.current)==null?void 0:G.value)!==void 0)){let q=V??"";(Q=(K=s.current).onValueChange)==null||Q.call(K,q);return}E.emit()}},emit:()=>{i.current.forEach($=>$())}}),[]),O=g.useMemo(()=>({value:($,V,Y)=>{var G;V!==((G=o.current.get($))==null?void 0:G.value)&&(o.current.set($,{value:V,keywords:Y}),n.current.filtered.items.set($,M(V,Y)),S(2,()=>{N(),E.emit()}))},item:($,V)=>(r.current.add($),V&&(a.current.has(V)?a.current.get(V).add($):a.current.set(V,new Set([$]))),S(3,()=>{I(),N(),n.current.value||P(),E.emit()}),()=>{o.current.delete($),r.current.delete($),n.current.filtered.items.delete($);let Y=C();S(4,()=>{I(),(Y==null?void 0:Y.getAttribute("id"))===$&&P(),E.emit()})}),group:$=>(a.current.has($)||a.current.set($,new Set),()=>{o.current.delete($),a.current.delete($)}),filter:()=>s.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>s.current.disablePointerSelection,listId:w,inputId:x,labelId:j,listInnerRef:_}),[]);function M($,V){var Y,G;let K=(G=(Y=s.current)==null?void 0:Y.filter)!=null?G:$ge;return $?K($,n.current.search,V):0}function N(){if(!n.current.search||s.current.shouldFilter===!1)return;let $=n.current.filtered.items,V=[];n.current.filtered.groups.forEach(G=>{let K=a.current.get(G),Q=0;K.forEach(q=>{let H=$.get(q);Q=Math.max(H,Q)}),V.push([G,Q])});let Y=_.current;T().sort((G,K)=>{var Q,q;let H=G.getAttribute("id"),X=K.getAttribute("id");return((Q=$.get(X))!=null?Q:0)-((q=$.get(H))!=null?q:0)}).forEach(G=>{let K=G.closest(bS);K?K.appendChild(G.parentElement===K?G:G.closest(`${bS} > *`)):Y.appendChild(G.parentElement===Y?G:G.closest(`${bS} > *`))}),V.sort((G,K)=>K[1]-G[1]).forEach(G=>{var K;let Q=(K=_.current)==null?void 0:K.querySelector(`${Pd}[${rs}="${encodeURIComponent(G[0])}"]`);Q==null||Q.parentElement.appendChild(Q)})}function P(){let $=T().find(Y=>Y.getAttribute("aria-disabled")!=="true"),V=$==null?void 0:$.getAttribute(rs);E.setState("value",V||void 0)}function I(){var $,V,Y,G;if(!n.current.search||s.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let K=0;for(let Q of r.current){let q=(V=($=o.current.get(Q))==null?void 0:$.value)!=null?V:"",H=(G=(Y=o.current.get(Q))==null?void 0:Y.keywords)!=null?G:[],X=M(q,H);n.current.filtered.items.set(Q,X),X>0&&K++}for(let[Q,q]of a.current)for(let H of q)if(n.current.filtered.items.get(H)>0){n.current.filtered.groups.add(Q);break}n.current.filtered.count=K}function k(){var $,V,Y;let G=C();G&&((($=G.parentElement)==null?void 0:$.firstChild)===G&&((Y=(V=G.closest(Pd))==null?void 0:V.querySelector(Lge))==null||Y.scrollIntoView({block:"nearest"})),G.scrollIntoView({block:"nearest"}))}function C(){var $;return($=_.current)==null?void 0:$.querySelector(`${wS}[aria-selected="true"]`)}function T(){var $;return Array.from((($=_.current)==null?void 0:$.querySelectorAll(T9))||[])}function A($){let V=T()[$];V&&E.setState("value",V.getAttribute(rs))}function D($){var V;let Y=C(),G=T(),K=G.findIndex(q=>q===Y),Q=G[K+$];(V=s.current)!=null&&V.loop&&(Q=K+$<0?G[G.length-1]:K+$===G.length?G[0]:G[K+$]),Q&&E.setState("value",Q.getAttribute(rs))}function L($){let V=C(),Y=V==null?void 0:V.closest(Pd),G;for(;Y&&!G;)Y=$>0?Kge(Y,Pd):Xge(Y,Pd),G=Y==null?void 0:Y.querySelector(T9);G?E.setState("value",G.getAttribute(rs)):D($)}let R=()=>A(T().length-1),B=$=>{$.preventDefault(),$.metaKey?R():$.altKey?L(1):D(1)},z=$=>{$.preventDefault(),$.metaKey?A(0):$.altKey?L(-1):D(-1)};return g.createElement(Ae.div,{ref:t,tabIndex:-1,...b,"cmdk-root":"",onKeyDown:$=>{var V;if((V=b.onKeyDown)==null||V.call(b,$),!$.defaultPrevented)switch($.key){case"n":case"j":{v&&$.ctrlKey&&B($);break}case"ArrowDown":{B($);break}case"p":case"k":{v&&$.ctrlKey&&z($);break}case"ArrowUp":{z($);break}case"Home":{$.preventDefault(),A(0);break}case"End":{$.preventDefault(),R();break}case"Enter":if(!$.nativeEvent.isComposing&&$.keyCode!==229){$.preventDefault();let Y=C();if(Y){let G=new Event(xS);Y.dispatchEvent(G)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:Qge},c),Um(e,$=>g.createElement(R9.Provider,{value:E},g.createElement(I9.Provider,{value:O},$))))}),Fge=g.forwardRef((e,t)=>{var n,r;let a=Pt(),o=g.useRef(null),i=g.useContext(D9),s=kd(),c=$9(e),l=(r=(n=c.current)==null?void 0:n.forceMount)!=null?r:i==null?void 0:i.forceMount;as(()=>{if(!l)return s.item(a,i==null?void 0:i.id)},[l]);let u=F9(a,o,[e.value,e.children,o],e.keywords),d=_S(),p=os(S=>S.value&&S.value===u.current),f=os(S=>l||s.filter()===!1?!0:S.search?S.filtered.items.get(a)>0:!0);g.useEffect(()=>{let S=o.current;if(!(!S||e.disabled))return S.addEventListener(xS,y),()=>S.removeEventListener(xS,y)},[f,e.onSelect,e.disabled]);function y(){var S,E;m(),(E=(S=c.current).onSelect)==null||E.call(S,u.current)}function m(){d.setState("value",u.current,!0)}if(!f)return null;let{disabled:v,value:b,onSelect:w,forceMount:j,keywords:x,..._}=e;return g.createElement(Ae.div,{ref:Ad([o,t]),..._,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!p,"data-disabled":!!v,"data-selected":!!p,onPointerMove:v||s.getDisablePointerSelection()?void 0:m,onClick:v?void 0:y},e.children)}),Bge=g.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:a,...o}=e,i=Pt(),s=g.useRef(null),c=g.useRef(null),l=Pt(),u=kd(),d=os(f=>a||u.filter()===!1?!0:f.search?f.filtered.groups.has(i):!0);as(()=>u.group(i),[]),F9(i,s,[e.value,e.heading,c]);let p=g.useMemo(()=>({id:i,forceMount:a}),[a]);return g.createElement(Ae.div,{ref:Ad([s,t]),...o,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&g.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:l},n),Um(e,f=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?l:void 0},g.createElement(D9.Provider,{value:p},f))))}),zge=g.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,a=g.useRef(null),o=os(i=>!i.search);return!n&&!o?null:g.createElement(Ae.div,{ref:Ad([a,t]),...r,"cmdk-separator":"",role:"separator"})}),Vge=g.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,a=e.value!=null,o=_S(),i=os(u=>u.search),s=os(u=>u.value),c=kd(),l=g.useMemo(()=>{var u;let d=(u=c.listInnerRef.current)==null?void 0:u.querySelector(`${wS}[${rs}="${encodeURIComponent(s)}"]`);return d==null?void 0:d.getAttribute("id")},[]);return g.useEffect(()=>{e.value!=null&&o.setState("search",e.value)},[e.value]),g.createElement(Ae.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:a?e.value:i,onChange:u=>{a||o.setState("search",u.target.value),n==null||n(u.target.value)}})}),Uge=g.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...a}=e,o=g.useRef(null),i=g.useRef(null),s=kd();return g.useEffect(()=>{if(i.current&&o.current){let c=i.current,l=o.current,u,d=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let p=c.offsetHeight;l.style.setProperty("--cmdk-list-height",p.toFixed(1)+"px")})});return d.observe(c),()=>{cancelAnimationFrame(u),d.unobserve(c)}}},[]),g.createElement(Ae.div,{ref:Ad([o,t]),...a,"cmdk-list":"",role:"listbox","aria-label":r,id:s.listId},Um(e,c=>g.createElement("div",{ref:Ad([i,s.listInnerRef]),"cmdk-list-sizer":""},c)))}),Wge=g.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:a,contentClassName:o,container:i,...s}=e;return g.createElement($l,{open:n,onOpenChange:r},g.createElement(Fl,{container:i},g.createElement(Mi,{"cmdk-overlay":"",className:a}),g.createElement(Pi,{"aria-label":e.label,"cmdk-dialog":"",className:o},g.createElement(L9,{ref:t,...s}))))}),Hge=g.forwardRef((e,t)=>os(n=>n.filtered.count===0)?g.createElement(Ae.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),qge=g.forwardRef((e,t)=>{let{progress:n,children:r,label:a="Loading...",...o}=e;return g.createElement(Ae.div,{ref:t,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Um(e,i=>g.createElement("div",{"aria-hidden":!0},i)))}),Zn=Object.assign(L9,{List:Uge,Item:Fge,Input:Vge,Group:Bge,Separator:zge,Dialog:Wge,Empty:Hge,Loading:qge});function Kge(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function Xge(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function $9(e){let t=g.useRef(e);return as(()=>{t.current=e}),t}var as=typeof window>"u"?g.useEffect:g.useLayoutEffect;function Bc(e){let t=g.useRef();return t.current===void 0&&(t.current=e()),t}function Ad(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function os(e){let t=_S(),n=()=>e(t.snapshot());return Vp.useSyncExternalStore(t.subscribe,n,n)}function F9(e,t,n,r=[]){let a=g.useRef(),o=kd();return as(()=>{var i;let s=(()=>{var l;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():a.current}})(),c=r.map(l=>l.trim());o.value(e,s,c),(i=t.current)==null||i.setAttribute(rs,s),a.current=s}),a}var Zge=()=>{let[e,t]=g.useState(),n=Bc(()=>new Map);return as(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,a)=>{n.current.set(r,a),t({})}};function Gge(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function Um({asChild:e,children:t},n){return e&&g.isValidElement(t)?g.cloneElement(Gge(t),{ref:t.ref},n(t.props.children)):n(t)}var Qge={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const B9=g.forwardRef(({className:e,...t},n)=>h.jsx(Zn,{ref:n,className:Z("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));B9.displayName=Zn.displayName;const z9=g.forwardRef(({className:e,...t},n)=>h.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[h.jsx(de,{name:"search",className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),h.jsx(Zn.Input,{ref:n,className:Z("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));z9.displayName=Zn.Input.displayName;const V9=g.forwardRef(({className:e,...t},n)=>h.jsx(Zn.List,{ref:n,className:Z("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));V9.displayName=Zn.List.displayName;const U9=g.forwardRef((e,t)=>h.jsx(Zn.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));U9.displayName=Zn.Empty.displayName;const W9=g.forwardRef(({className:e,...t},n)=>h.jsx(Zn.Group,{ref:n,className:Z("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));W9.displayName=Zn.Group.displayName;const Yge=g.forwardRef(({className:e,...t},n)=>h.jsx(Zn.Separator,{ref:n,className:Z("-mx-1 h-px bg-border",e),...t}));Yge.displayName=Zn.Separator.displayName;const jS=g.forwardRef(({className:e,...t},n)=>h.jsx(Zn.Item,{ref:n,className:Z("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...t}));jS.displayName=Zn.Item.displayName;const Jge=Ha("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Ra=g.forwardRef(({className:e,variant:t,...n},r)=>h.jsx("div",{ref:r,role:"alert",className:Z(Jge({variant:t}),e),...n}));Ra.displayName="Alert";const Co=g.forwardRef(({className:e,...t},n)=>h.jsx("h5",{ref:n,className:Z("mb-1 font-medium leading-none tracking-tight",e),...t}));Co.displayName="AlertTitle";const zc=g.forwardRef(({className:e,...t},n)=>h.jsx("div",{ref:n,className:Z("text-sm [&_p]:leading-relaxed",e),...t}));zc.displayName="AlertDescription";const eve=qa(({onConfirm:e,onCancel:t})=>{const n=Wt(),{t:r}=Pe("dialogs"),[a,o]=g.useState(""),i=l=>{o(l)},s=async()=>{e(a),o("")},c=()=>{t(),n.hide(),o("")};return h.jsx(Jo,{open:n.visible,onOpenChange:c,children:h.jsxs(ro,{className:"w-[330px]",children:[h.jsxs(ao,{children:[h.jsx(oo,{children:r("create_session_passkey.title")}),h.jsx(hu,{children:r("create_session_passkey.description")})]}),h.jsx("div",{className:"py-4",children:h.jsxs(pj,{onChange:i,maxLength:6,children:[h.jsxs(Sd,{children:[h.jsx(pr,{index:0,hidden:!0}),h.jsx(pr,{index:1,hidden:!0}),h.jsx(pr,{index:2,hidden:!0})]}),h.jsx(fj,{}),h.jsxs(Sd,{children:[h.jsx(pr,{index:3,hidden:!0}),h.jsx(pr,{index:4,hidden:!0}),h.jsx(pr,{index:5,hidden:!0})]})]})}),h.jsx(fu,{children:h.jsx(ut,{onClick:s,type:"submit",children:r("create_session_passkey.confirm")})})]})})}),tve=()=>{const[e,t]=g.useState(!1),n=Je(o=>o.currentSession),r=Je(o=>o.setCurrentSession),a=g.useCallback(async o=>{if(!(!n||!o))try{t(!0);const i=await Ffe(),s=await yj(i,o);await ue("Session").update(n.id,{passphrase:s});const c=await ue("Session").findOne({where:{id:n.id}});return c&&r(c),{passphrase:i,encrypted:s}}finally{t(!1)}},[n,r]);return{loading:e,updateSessionPassphrase:a}},nve=[nn.WebLLM,nn.OpenAI],rve=["gpt-4o","gpt-4o-mini","gpt-4-turbo","gpt-4","gpt-3.5-turbo"];function ave(e){var Y,G;const{id:t,setDialog:n}=e,{t:r}=Pe("components"),{toast:a}=Gt(),o=Tn(t),[i,s]=g.useState(!1),[c,l]=g.useState(""),[u,d]=g.useState(!1),[p,f]=g.useState(""),[y,m]=g.useState(),[v,b]=g.useState(nn.WebLLM),[w,j]=g.useState(!1),[x,_]=g.useState(),{updateSessionPassphrase:S}=tve(),E=Je(K=>K.currentSession),O=Wa(K=>K.syncCachedLLMURLs),M=Wa(K=>K.cachedLLMURLs),{loading:N,createLLM:P}=FF(),I=Wt(eve),k=Wt(d8);g.useEffect(()=>{At(()=>import("./index-s4oWTEmo.js").then(async K=>(await K.__tla,K)),__vite__mapDeps([5,1,2,3,4])).then(async({functionCallingModelIds:K,prebuiltAppConfig:Q})=>{const q=Q.model_list;_({modelList:q,functionCallingModelIds:K})})},[]),g.useEffect(()=>{O()},[O]);const C=g.useMemo(()=>c?v!==nn.WebLLM:!1,[c,v]),T=g.useMemo(()=>!(x!=null&&x.functionCallingModelIds)||!(x!=null&&x.modelList)?[]:((p?x==null?void 0:x.modelList.filter(K=>K.model_id.toLowerCase().includes(p.toLowerCase())):x==null?void 0:x.modelList)||[]).sort((K,Q)=>{const q=M.some(re=>re.includes(K.model_id)),H=M.some(re=>re.includes(Q.model_id));if(q&&!H)return-1;if(!q&&H)return 1;const X=vj.includes(K.model_id),te=vj.includes(Q.model_id);if(X&&!te)return-1;if(!X&&te)return 1;const F=x==null?void 0:x.functionCallingModelIds.includes(K.model_id),se=x==null?void 0:x.functionCallingModelIds.includes(Q.model_id);return F&&!se?-1:!F&&se?1:K.vram_required_MB&&Q.vram_required_MB&&K.vram_required_MB!==Q.vram_required_MB?K.vram_required_MB-Q.vram_required_MB:K.model_id.localeCompare(Q.model_id)}),[x==null?void 0:x.modelList,x==null?void 0:x.functionCallingModelIds,p,M]),A=g.useMemo(()=>{if(c)switch(v){case nn.WebLLM:return(x==null?void 0:x.modelList)&&T.find(K=>K.model_id===c);case nn.OpenAI:return m({}),{model:c,model_id:c,model_type:2,overrides:{}}}},[c,x==null?void 0:x.modelList,T,v]);g.useEffect(()=>{!(A!=null&&A.model_id)||!M||j(M.some(K=>K.includes(A.model_id)))},[M,A==null?void 0:A.model_id]);const D=g.useCallback(K=>{l(K),d(!1)},[]),L=g.useCallback(K=>{f(K)},[]),R=g.useCallback(K=>{b(K)},[]),B=async()=>{var K;if(!(!o||!E))try{s(!0);let Q="",q;if(C&&!E.passphrase){await new Promise((X,te)=>{I.show({onConfirm:F=>{Q=F,I.hide(),X(void 0)},onCancel:()=>{te()}})});const H=await S(Q);if(!H||!Object.keys(y||{}).length)throw new Error("Failed to update session passphrase");await _d.set("passphrase",H.passphrase),q={},await Promise.all(Object.entries(y||{}).map(async([X,te])=>{const F=await yj(te,H.passphrase);q||(q={}),q[X]=F}))}else if(C&&E.passphrase){let H;await new Promise((X,te)=>{k.show({onConfirm:async F=>{try{H=await gj(E.passphrase,F),await _d.set("passphrase",H),X(!0)}catch(se){a({content:r("invalid_passphrase"),variant:"destructive"}),te(se)}finally{k.hide()}},onCancel:()=>{te()}})}),q={},await Promise.all(Object.entries(y||{}).map(async([X,te])=>{const F=await yj(te,H);q||(q={}),q[X]=F}))}await P(o,{name:c,model_type:z(A==null?void 0:A.model_type),function_calling:A!=null&&A.model_id?(K=x==null?void 0:x.functionCallingModelIds)==null?void 0:K.includes(A==null?void 0:A.model_id):!1,parameters:q,provider:v}),n==null||n(!1)}catch(Q){kl(Q),a({variant:"destructive",description:r("add_llm_card.errors.failed_to_create")})}finally{s(!1),l("")}},z=g.useCallback(K=>K===1?Xl.embedding:K===2?Xl.VLM:Xl.LLM,[]),$=g.useMemo(()=>{switch(v){case nn.WebLLM:return T.map(K=>{var Q;return h.jsxs(jS,{value:K.model_id,onSelect:D,children:[c===K.model_id?h.jsx(de,{name:"check",className:"mr-2 h-4 w-4"}):h.jsx("div",{className:"mr-2 h-4 w-4"}),h.jsxs("span",{className:"max-w-md",children:[h.jsxs("div",{className:"flex gap-2 mb-2",children:[h.jsx(Aa,{name:K.model_id}),K.model_id]}),h.jsx("div",{className:"flex max-w-full flex-wrap gap-1",children:h.jsx(Od,{model:K,isFunctionCalling:((Q=x==null?void 0:x.functionCallingModelIds)==null?void 0:Q.includes(K.model_id))||!1,name:K.model_id,isCached:M.some(q=>q.includes(K.model_id))||!1})})]})]},K.model_id)});case nn.OpenAI:return rve.map(K=>h.jsxs(jS,{value:K,onSelect:D,children:[c===K?h.jsx(de,{name:"check",className:"h-4 w-4"}):h.jsx("div",{className:"w-4"}),h.jsx("span",{className:"max-w-md",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx(Aa,{name:K}),K]})})]},K))}},[M,D,c,x==null?void 0:x.functionCallingModelIds,T,v]),V=g.useMemo(()=>{if(C)switch(v){case nn.OpenAI:return h.jsxs(h.Fragment,{children:[h.jsx(Ra,{variant:"destructive",className:"mt-4",children:r("add_llm_card.alert.session_passkey")}),h.jsxs("div",{className:"mt-4",children:[h.jsx(nt,{children:r("add_llm_card.encrypted_fields.api_key")}),h.jsx(En,{type:"password",value:(y==null?void 0:y.key)||"",onChange:K=>m(Q=>({...Q,key:K.target.value}))})]})]})}},[C,v,r,y]);return h.jsxs(Zt,{className:"max-w-lg",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:r("add_llm_card.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(nt,{children:r("add_llm_card.provider")}),h.jsxs(jo,{value:v,onValueChange:R,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(So,{placeholder:r("add_llm_card.provider_select_placeholder")})}),h.jsx(Ia,{children:Object.values(nve).map(K=>h.jsx(Xn,{value:K,children:r(`add_llm_card.providers.${K.toLowerCase()}`)},K))})]}),h.jsx(nt,{children:r("add_llm_card.model_name")}),h.jsxs(dM,{open:u,onOpenChange:d,children:[h.jsx(hS,{asChild:!0,children:h.jsxs(ut,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between",children:[c?A==null?void 0:A.model_id:r("add_llm_card.select_model_placeholder"),h.jsx(de,{name:"chevrons-up-down",className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),h.jsx(bv,{className:"w-full p-0",children:h.jsxs(B9,{children:[h.jsx(z9,{onValueChange:L,placeholder:r("add_llm_card.search_placeholder")}),h.jsxs(V9,{children:[h.jsx(U9,{children:r("add_llm_card.no_model")}),h.jsx(W9,{children:$})]})]})})]})]}),A?h.jsxs("div",{className:"mt-4",children:[h.jsxs("div",{className:"mt-4 text-sm text-muted-foreground center flex max-w-full flex-wrap gap-1",children:[h.jsx(Aa,{name:A.model_id,className:"mr-2"}),h.jsx(Od,{model:A,isFunctionCalling:((Y=x==null?void 0:x.functionCallingModelIds)==null?void 0:Y.includes(A.model_id))||!1,name:A.model_id,isCached:M.some(K=>K.includes(A.model_id))||!1})]}),h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_url")}),A.model]}),A.model_lib?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.model_lib_url")}),A.model_lib]}):void 0,A.overrides&&((G=Object.keys(A.overrides))!=null&&G.length)?h.jsxs("div",{className:"mt-2 text-sm text-muted-foreground center flex",children:[h.jsx("span",{className:"font-bold mr-2",children:r("add_llm_card.metadata")}),JSON.stringify(A.overrides)]}):void 0]}):null,V]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:N||i,disabled:!(c!=null&&c.length),onClick:B,className:"w-full",children:r(w?"add_llm_card.button_add":"add_llm_card.button_download_and_add")})})]})}const H9=()=>{const e=Je(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=De(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i)=>{var s,c,l;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const u=((s=o.position)==null?void 0:s.x)||0,d=(((c=o.position)==null?void 0:c.y)||0)+(((l=o.measured)==null?void 0:l.height)||0),p=await ue("Prompt").save({content:i.content,prefix:i.prefix,role:i.role||nr.System,status:Ir.Started,session_id:e,type:i.type||rr.Chat});if(!p)throw new Error("Failed to save prompt");if(!await r({source_id:p.id,source_type:"Prompt",node_type:oe.Prompt,x:u,y:d+20}))throw new Error("Failed to save prompt node")}finally{n(!1)}},[e,r]);return{loading:t,createPrompt:a}},ove={[rr.Chat]:{label:"add_prompt_card.prompt_types.chat",value:rr.Chat},[rr.FewShotExample]:{label:"add_prompt_card.prompt_types.few_shot_example",value:rr.FewShotExample}},ive={[nr.System]:{label:"add_prompt_card.prompt_roles.system",value:nr.System},[nr.Human]:{label:"add_prompt_card.prompt_roles.human",value:nr.Human},[nr.AI]:{label:"add_prompt_card.prompt_roles.ai",value:nr.AI}},SS=g.memo(({defaultPromptContent:e,defaultPromptRole:t,defaultPromptType:n,hidePromptRole:r,hidePromptType:a,loading:o,onSubmit:i})=>{const[s,c]=g.useState(e||""),[l,u]=g.useState(n||rr.Chat),[d,p]=g.useState(t),[f,y]=g.useState(""),{t:m}=Pe("components"),v=g.useCallback(_=>{c(_.target.value)},[]),b=g.useCallback(_=>{y(_.target.value)},[]),w=g.useCallback(_=>{_===rr.FewShotExample&&c(`Question: {input}
Answer: {output}`),u(_)},[]),j=g.useCallback(_=>{p(_)},[]),x=async()=>{await i({content:s,role:d,prefix:f,type:l})&&(c(""),p(void 0),u("chat"),y(""))};return h.jsxs("div",{children:[h.jsxs("div",{className:"grid w-full gap-1.5",children:[a?void 0:h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_type")}),h.jsxs(jo,{value:l,onValueChange:w,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(So,{placeholder:m("add_prompt_card.type_select_placeholder")})}),h.jsx(Ia,{children:Object.values(ove).map(_=>h.jsx(Xn,{value:_.value,children:m(_.label)},_.value))})]})]}),r?void 0:h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_role")}),h.jsxs(jo,{value:d,onValueChange:j,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(So,{placeholder:m("add_prompt_card.role_select_placeholder")})}),h.jsx(Ia,{children:Object.values(ive).map(_=>h.jsx(Xn,{value:_.value,children:m(_.label)},_.value))})]})]}),l===rr.FewShotExample&&h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:m("add_prompt_card.prompt_prefix")}),h.jsx(po,{value:f,onChange:b,disabled:!1,className:"h-20",placeholder:m("add_prompt_card.placeholder"),id:"message"}),h.jsx(nt,{children:m("add_prompt_card.prompt_content")}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm justify-end items-center",children:[h.jsx(de,{name:"info",className:"mr-2",size:14}),m("add_prompt_card.few_shot_example_note")]})]}),h.jsx(po,{value:s,onChange:v,disabled:!1,placeholder:m("add_prompt_card.placeholder"),id:"message"})]}),h.jsx("div",{children:h.jsx(Vn,{loading:o,disabled:!(s!=null&&s.length),onClick:x,className:"w-full mt-4",children:m("add_prompt_card.button")})})]})}),sve=g.memo(e=>{const{id:t,thread:n,setDialog:r}=e,{t:a}=Pe("components"),{toast:o}=Gt(),i=Tn(t),{createPrompt:s,loading:c}=H9(),l=async u=>{if(i)try{if(!(u!=null&&u.content))throw new Error("Prompt data is missing");await s(i,{...u,content:u.content,thread:n}),r==null||r(!1)}catch(d){o({variant:"destructive",title:`${d}`})}};return h.jsxs(Zt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:a("add_prompt_card.title")})}),h.jsx($n,{children:h.jsx(SS,{onSubmit:l,loading:c,defaultPromptRole:"system",defaultPromptType:"chat"})})]})}),cve=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=g.useCallback((i,s,c,l)=>{var u;if(e){for(const d of s)(u=d.data)!=null&&u.length?a(i,d.data,c,d.id):c.push({name:d.name,type:d.type,enum:d.enum?JSON.stringify(d.enum):"",required:d.required,description:d.description,id:d.id||vu(),parent_id:l,schema_id:i,session_id:e});return c}},[e]),o=g.useCallback(async(i,s)=>{var c,l,u;try{if(!i||!e)throw new Error("Source or Session not found");n(!0);const d=((c=i.position)==null?void 0:c.x)||0,p=(((l=i.position)==null?void 0:l.y)||0)+(((u=i.measured)==null?void 0:u.height)||0),f=await ue("Schema").save({name:"Untitled Schema",session_id:e});if(!f)throw new Error("Failed to save schema");const y=a(f.id,s,[],void 0);if(!(y!=null&&y.length))throw new Error("Failed to convert schema items");if(await ue("SchemaItem").save(y),!await r({source_id:f.id,source_type:"Schema",node_type:oe.Schema,x:d,y:p+20}))throw new Error("Failed to save schema node")}finally{n(!1)}},[e,a,r]);return{loading:t,createSchema:o}};var ES="Checkbox",[lve,y2e]=er(ES),[uve,dve]=lve(ES),q9=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:o,required:i,disabled:s,value:c="on",onCheckedChange:l,form:u,...d}=e,[p,f]=g.useState(null),y=wt(t,x=>f(x)),m=g.useRef(!1),v=p?u||!!p.closest("form"):!0,[b=!1,w]=Sn({prop:a,defaultProp:o,onChange:l}),j=g.useRef(b);return g.useEffect(()=>{const x=p==null?void 0:p.form;if(x){const _=()=>w(j.current);return x.addEventListener("reset",_),()=>x.removeEventListener("reset",_)}},[p,w]),h.jsxs(uve,{scope:n,state:b,disabled:s,children:[h.jsx(Ae.button,{type:"button",role:"checkbox","aria-checked":mi(b)?"mixed":b,"aria-required":i,"data-state":Z9(b),"data-disabled":s?"":void 0,disabled:s,value:c,...d,ref:y,onKeyDown:ge(e.onKeyDown,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:ge(e.onClick,x=>{w(_=>mi(_)?!0:!_),v&&(m.current=x.isPropagationStopped(),m.current||x.stopPropagation())})}),v&&h.jsx(pve,{control:p,bubbles:!m.current,name:r,value:c,checked:b,required:i,disabled:s,form:u,style:{transform:"translateX(-100%)"},defaultChecked:mi(o)?!1:o})]})});q9.displayName=ES;var K9="CheckboxIndicator",X9=g.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,o=dve(K9,n);return h.jsx(Mr,{present:r||mi(o.state)||o.state===!0,children:h.jsx(Ae.span,{"data-state":Z9(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});X9.displayName=K9;var pve=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:a,...o}=e,i=g.useRef(null),s=P8(n),c=Up(t);g.useEffect(()=>{const u=i.current,d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(s!==n&&p){const f=new Event("click",{bubbles:r});u.indeterminate=mi(n),p.call(u,mi(n)?!1:n),u.dispatchEvent(f)}},[s,n,r]);const l=g.useRef(mi(n)?!1:n);return h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??l.current,...o,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function mi(e){return e==="indeterminate"}function Z9(e){return mi(e)?"indeterminate":e?"checked":"unchecked"}zg=q9,ZN=X9;const G9=g.forwardRef(({className:e,...t},n)=>h.jsx(zg,{ref:n,className:Z("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:h.jsx(ZN,{className:Z("flex items-center justify-center text-current"),children:h.jsx(de,{name:"check",className:"h-4 w-4"})})}));G9.displayName=zg.displayName;const Q9=g.memo(({setData:e,data:t,id:n})=>{const{t:r}=Pe("components"),[a,o]=g.useState({name:"",description:"",type:"string",required:!1,data:[]}),i=g.useMemo(()=>n&&t.find(m=>m.id===n)||a,[t,a,n]),s=g.useCallback(m=>{m.target.value&&!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(m.target.value)||(n?e(v=>[...v.map(b=>b.id===n?{...b,name:m.target.value||""}:b)]):o(v=>({...v,name:m.target.value||""})))},[n,e]),c=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,description:m.target.value||""}:b)]):o(v=>({...v,description:m.target.value||""}))},[n,e]),l=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,type:m||""}:b)]):o(v=>({...v,type:m||"string"}))},[n,e]),u=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,required:!!m||!1}:b)]):o(v=>({...v,required:!!m||!1}))},[n,e]),d=g.useCallback(m=>{n?e(v=>[...v.map(b=>b.id===n?{...b,enum:m.target.value||""}:b)]):o(v=>({...v,enum:m.target.value||""}))},[n,e]),p=g.useCallback(()=>{if(t.find(m=>m.name===a.name))return Il({variant:"destructive",content:"Name already exists"});a.id=vu(),e(m=>[...m,{...a}]),o({name:"",description:"",type:"string",required:!1,id:vu(),parent:n||void 0,data:[]})},[t,a,e,n]),f=g.useCallback(m=>{e(v=>[...v.map(b=>b.id===n?{...b,data:m(b.data||[])}:b)])},[n,e]),y=["object","array"].includes(i.type);return h.jsxs("div",{className:"w-full p-1",children:[h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.name")}),h.jsx(En,{id:"name",onChange:s,placeholder:r("add_schema_card.field.name_placeholder"),value:(i==null?void 0:i.name)||""})]}),h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.description")}),h.jsx(En,{id:"description",placeholder:r("add_schema_card.field.description_placeholder"),onChange:c,value:(i==null?void 0:i.description)||""})]}),h.jsxs("div",{children:[h.jsx(nt,{children:r("add_schema_card.field.type")}),h.jsxs(jo,{onValueChange:l,value:(i==null?void 0:i.type)||"",children:[h.jsx(Ta,{children:h.jsx(So,{placeholder:r("add_schema_card.field.type_placeholder")})}),h.jsxs(Ia,{children:[h.jsx(Xn,{value:"string",children:r("add_schema_card.types.string")}),h.jsx(Xn,{value:"boolean",children:r("add_schema_card.types.boolean")}),h.jsx(Xn,{value:"number",children:r("add_schema_card.types.number")}),h.jsx(Xn,{value:"object",children:r("add_schema_card.types.object")}),h.jsx(Xn,{value:"array",children:r("add_schema_card.types.array")})]})]})]}),h.jsxs("div",{className:"flex items-center h-10",children:[h.jsx(nt,{children:r("add_schema_card.field.required")}),h.jsx(G9,{className:"ml-2","aria-label":"Select row",onCheckedChange:u,checked:i==null?void 0:i.required})]}),y?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(nt,{children:r("add_schema_card.children")}),h.jsx(Y9,{data:(i==null?void 0:i.data)||[],setData:f})]}):null,(i==null?void 0:i.type)==="enum"?h.jsxs("div",{className:"mt-2 flex flex-col gap-2",children:[h.jsx(nt,{children:r("add_schema_card.field.enum")}),h.jsx(En,{id:"enum",onChange:d,placeholder:"Enum"})]}):null,n?null:h.jsx("div",{className:"w-full flex justify-end mt-2",children:h.jsx(ut,{variant:"secondary",disabled:!i.name||!i.description||!i.type,onClick:p,className:"w-full",children:r("add_schema_card.field.add_field")})})]})}),Y9=g.memo(({data:e,setData:t})=>h.jsxs(O$,{type:"single",collapsible:!0,children:[e.map(n=>h.jsxs(Aj,{value:`${n.id}`,children:[h.jsx(Tj,{children:n.name}),h.jsx(Ij,{children:h.jsx(Q9,{setData:t,data:e,id:n.id})})]},n.id||"new")),h.jsx(Zt,{className:"p-2 mt-4",children:h.jsx(Q9,{setData:t,data:e})})]})),fve=g.memo(e=>{const{t}=Pe("components"),{id:n}=e,r=Tn(n),[a,o]=g.useState([]),{createSchema:i,loading:s}=cve(),c=async()=>{if(r&&(a!=null&&a.length))try{await i(r,a),o([])}catch(l){Il({variant:"destructive",title:`${l}`})}};return h.jsxs(Zt,{className:"max-w-lg",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("add_schema_card.title")})}),h.jsx($n,{className:"min-w-96",children:h.jsx(Y9,{setData:o,data:a})}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:s,disabled:!(a!=null&&a.length),onClick:c,className:"w-full",children:t("add_schema_card.create")})})]})}),J9=()=>{const e=Je(o=>{var i;return(i=o.currentSession)==null?void 0:i.id}),[t,n]=g.useState(!1),r=De(o=>o.createOrUpdateFlowNode),a=g.useCallback(async(o,i,s)=>{var c,l,u;try{if(!o||!e)throw new Error("Source or Session not found");n(!0);const d=((c=o.position)==null?void 0:c.x)||0,p=(((l=o.position)==null?void 0:l.y)||0)+(((u=o.measured)==null?void 0:u.height)||0),f=KAe(i,s),y=await ue("CSVData").save({headers:f.headers,csv:f.data,session_id:e});if(!y)throw new Error("Failed to save");if(!await r({source_id:y.id,source_type:"CSVData",node_type:oe.CSVData,x:d,y:p+20}))throw new Error("Failed to save node")}finally{n(!1)}},[e,r]);return{loading:t,createCSVData:a}};function hve({data:e}){const{t}=Pe("components");return h.jsxs(Mm,{className:"w-full",children:[h.jsx(Pm,{children:h.jsxs(ns,{children:[h.jsx(Tc,{children:t("add_few_shot_example_card.input")}),h.jsx(Tc,{children:t("add_few_shot_example_card.output")})]})}),h.jsx(km,{children:e==null?void 0:e.map((n,r)=>h.jsxs(ns,{children:[h.jsx(Ic,{className:"p-4",children:n.input}),h.jsx(Ic,{className:"p-4",children:n.output})]},`${n.input}_${n.output}_${r}`))})]})}const mve=g.memo(e=>{const{id:t}=e,{t:n}=Pe("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),[s,c]=g.useState(""),l=Tn(t),{createCSVData:u,loading:d}=J9(),p=()=>{a(y=>[...y,{input:o,output:s}]),i(""),c("")},f=async()=>{l&&await u(l,["input","output"],r.map(y=>[y.input,y.output]))};return h.jsxs(Zt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:n("add_few_shot_example_card.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{htmlFor:"name",children:n("add_few_shot_example_card.input")}),h.jsx(En,{value:o,onChange:y=>i(y.target.value||""),id:"name",placeholder:n("add_few_shot_example_card.input_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("add_few_shot_example_card.output")}),h.jsx(po,{value:s,onChange:y=>c(y.target.value||""),placeholder:n("add_few_shot_example_card.output_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(ut,{disabled:!o||!s,onClick:p,className:"w-40",children:n("add_few_shot_example_card.add")})}),h.jsx(hve,{data:r||[]})]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:d,disabled:!(r!=null&&r.length),onClick:f,className:"w-full",children:n("add_few_shot_example_card.create")})})]})}),yve=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!i||!e)throw new Error("Source or Session not found");if(!s.name||!s.description)throw new Error("Name is required");n(!0);const p=((l=i.position)==null?void 0:l.x)||0,f=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),y=await ue("ToolDefinition").save({...s,name:`${s.name}`,description:`${s.description}`,session_id:e});if(!y)throw new Error("Failed create tool.");const m=await r({source_id:y.id,source_type:"ToolDefinition",node_type:oe.ToolDefinition,x:p,y:f+20});if(!m)throw new Error("Failed to save node");c!=null&&c.schemaNode&&await a({source:c.schemaNode.id,target:m.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createTool:o}},gve=g.memo(e=>{const{t}=Pe("components"),{toast:n}=Gt(),{id:r}=e,a=Tn(r),[o,i]=g.useState(""),[s,c]=g.useState(""),{createTool:l,loading:u}=yve(),d=y=>{i(y.target.value)},p=y=>{c(y.target.value)},f=async()=>{if(a&&o&&s)try{await l(a,{name:o,description:s}),i(""),c("")}catch(y){zo(y),n({variant:"destructive",title:t("add_tool_card.errors.create_tool_failed")})}};return h.jsxs(Zt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("add_tool_card.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{htmlFor:"name",children:t("add_tool_card.tool_name")}),h.jsx(En,{onChange:d,id:"name",placeholder:t("add_tool_card.name_placeholder")})]}),h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:t("add_tool_card.tool_description")}),h.jsx(po,{onChange:p,placeholder:t("add_tool_card.description_placeholder")})]})]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:u,onClick:f,className:"w-full",children:t("add_tool_card.create")})})]})}),vve=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async(i,s,c)=>{var l,u,d;try{if(!(s!=null&&s.name)||!i||!e)throw new Error("Source or Session not found");n(!0);const p=((l=i.position)==null?void 0:l.x)||0,f=(((u=i.position)==null?void 0:u.y)||0)+(((d=i.measured)==null?void 0:d.height)||0),y=await ue("VectorDatabase").save({...s,name:`${s.name}`,type:s.type||XAe.Local,storage:s.storage||kr.DatabaseNode,raw:"",provider:s.provider||bK.Memory,session_id:e,metadata:c?JSON.stringify({textSplitter:c}):void 0});if(!y)throw new Error("Failed to save vectorDatabase");const m=await r({source_id:y.id,source_type:"VectorDatabase",node_type:oe.VectorDatabase,x:p,y:f+30});if(!m)throw new Error("Failed to save vectorDatabase node");if(s.storage===kr.DataNode){const v=await ue("JSONLData").save({headers:ZAe(["content","embedding","metadata"]),jsonl:"",session_id:e});if(!v)throw new Error("Failed to save databaseSource");const b=await r({source_id:v.id,source_type:"JSONLData",node_type:oe.JSONLData,x:p+80,y:f+30});if(!b)throw new Error("Failed to save databaseSource node");await a({source:b.id,target:m.id})}return{vectorDatabase:y,vectorDatabaseNode:m}}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabase:o}},Td=[bK.Memory],Id=[kr.DatabaseNode],bve=["TokenTextSplitter","CharacterTextSplitter","RecursiveCharacterTextSplitter"],wve=g.memo(e=>{const{t}=Pe("components"),{id:n}=e,r=Tn(n),{toast:a}=Gt(),[o,i]=g.useState(""),[s,c]=g.useState(Td[0]),[l,u]=g.useState(Id[0]),[d,p]=g.useState({}),{loading:f,createVectorDatabase:y}=vve(),m=g.useCallback(S=>{c(S)},[]),v=g.useCallback(S=>{u(S)},[]),b=g.useCallback(S=>{p(E=>({...E,type:S,chunkSize:500,chunkOverlap:40}))},[]),w=g.useCallback(S=>{i(S.target.value||"")},[]),j=g.useCallback(S=>{p(E=>({...E,chunkSize:Number(S.target.value)}))},[]),x=g.useCallback(S=>{p(E=>({...E,chunkOverlap:Number(S.target.value)}))},[]),_=async()=>{try{if(!r)return;await y(r,{name:o,provider:s,storage:l},d!=null&&d.type?{type:d.type,chunkSize:d.chunkSize||500,chunkOverlap:d.chunkOverlap||0}:void 0),i(""),p({})}catch{a({variant:"destructive",description:t("create_vector_database_card.errors.create_failed")})}};return h.jsxs(Zt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("create_vector_database_card.title")})}),h.jsx($n,{children:h.jsxs("div",{className:"grid w-full gap-1.5",children:[h.jsx(nt,{children:t("create_vector_database_card.name")}),h.jsx(En,{className:"mb-4",value:o,onChange:w}),(Id==null?void 0:Id.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:t("create_vector_database_card.storage_type")}),h.jsxs(jo,{value:l,onValueChange:v,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(So,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(Ia,{children:Object.values(Id).map(S=>h.jsx(Xn,{value:S,children:t(`create_vector_database_card.storage_types.${S.toLowerCase()}`)},S))})]})]}):void 0,(Td==null?void 0:Td.length)>1?h.jsxs(h.Fragment,{children:[h.jsx(nt,{children:t("create_vector_database_card.provider")}),h.jsxs(jo,{value:s,onValueChange:m,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(So,{placeholder:t("create_vector_database_card.provider_select_placeholder")})}),h.jsx(Ia,{children:Object.values(Td).map(S=>h.jsx(Xn,{value:S,children:t(`create_vector_database_card.providers.${S.toLowerCase()}`)},S))})]})]}):void 0,h.jsx(nt,{children:t("create_vector_database_card.text_splitter")}),h.jsxs(jo,{value:d.type,onValueChange:b,children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(So,{placeholder:t("create_vector_database_card.text_splitter_select_placeholder")})}),h.jsx(Ia,{children:Object.values(bve).map(S=>h.jsx(Xn,{value:S,children:t(`create_vector_database_card.text_splitters.${S.toLowerCase()}`)},S))})]}),d.type?h.jsxs(Zt,{children:[h.jsx(Ln,{children:h.jsx(Kn,{children:t("create_vector_database_card.text_splitter_configuration")})}),h.jsxs($n,{children:[h.jsx(nt,{children:t("create_vector_database_card.text_splitter_chunksize")}),h.jsx(En,{value:d.chunkSize,onChange:j,placeholder:t("create_vector_database_card.text_splitter_chunksize_placeholder")}),h.jsx(nt,{children:t("create_vector_database_card.text_splitter_chunkoverlap")}),h.jsx(En,{value:d.chunkOverlap,onChange:x,placeholder:t("create_vector_database_card.text_splitter_chunkoverlap_placeholder")})]})]}):void 0]})}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{disabled:!d.type||!o,loading:f,onClick:_,className:"w-full",children:t("create_vector_database_card.create")})})]})});function xve({data:e}){const{t}=Pe("components");return h.jsxs(Mm,{className:"w-full",children:[h.jsx(Pm,{children:h.jsx(ns,{children:h.jsx(Tc,{children:t("add_text_data.text")})})}),h.jsx(km,{children:e==null?void 0:e.map((n,r)=>h.jsx(ns,{children:h.jsx(Ic,{className:"p-4",children:n.text})},`${n.text}_${r}`))})]})}const _ve=g.memo(e=>{const{id:t}=e,{t:n}=Pe("components"),[r,a]=g.useState([]),[o,i]=g.useState(""),s=Tn(t),{createCSVData:c,loading:l}=J9(),u=()=>{a(p=>[...p,{text:o}]),i("")},d=async()=>{s&&await c(s,["text"],r.map(p=>[p.text]))};return h.jsxs(Zt,{className:"mw-full",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:n("add_text_data.title")})}),h.jsxs($n,{children:[h.jsxs("div",{className:"flex flex-col space-y-1.5 mt-3",children:[h.jsx(nt,{htmlFor:"name",children:n("add_text_data.text")}),h.jsx(po,{value:o,onChange:p=>i(p.target.value||""),placeholder:n("add_text_data.text_placeholder")})]}),h.jsx("div",{className:"w-full flex mt-4 justify-end",children:h.jsx(ut,{disabled:!o,onClick:u,className:"w-40",children:n("add_text_data.add")})}),h.jsx(xve,{data:r||[]})]}),h.jsx(ci,{className:"flex justify-between",children:h.jsx(Vn,{loading:l,disabled:!(r!=null&&r.length),onClick:d,className:"w-full",children:n("add_text_data.create")})})]})});var No=(e=>(e.ADD_LLM="ADD_LLM",e.ADD_PROMPT="ADD_PROMPT",e.ADD_TOOL_DEFINITION="ADD_TOOL_DEFINITION",e.ADD_SCHEMA="ADD_SCHEMA",e.ADD_FEW_SHOT_EXAMPLE="ADD_FEW_SHOT_EXAMPLE",e.ADD_VECTOR_DATABASE="ADD_VECTOR_DATABASE",e.ADD_TEXT_DATA="ADD_TEXT_DATA",e))(No||{});const jve=["ADD_LLM","ADD_PROMPT","ADD_SCHEMA","ADD_VECTOR_DATABASE",{key:"more",label:"more",icon:"ellipsis",children:["ADD_TOOL_DEFINITION","ADD_FEW_SHOT_EXAMPLE"]}],Sve=()=>{const e="_coolMode_effect",t=document.getElementById(e);if(t)return t;const n=document.createElement("div");return n.setAttribute("id",e),n.setAttribute("style","overflow:hidden; position:fixed; height:100%; top:0; left:0; right:0; bottom:0; pointer-events:none; z-index:2147483647"),document.body.appendChild(n),n};let eB=0,tB,nB,rB,aB,oB,iB,Nn,lt,sB,cB,lB,uB,Wm,OS,CS,NS,dB,pB,MS,fB,hB,mB;tB=(e,t)=>{eB++;const n=(t==null?void 0:t.particle)||"circle",r=[15,20,25,35,45],a=45;let o=[],i=!1,s=0,c=0;const l=Sve();function u(){const E=(t==null?void 0:t.size)||r[Math.floor(Math.random()*r.length)],O=(t==null?void 0:t.speedHorz)||Math.random()*10,M=(t==null?void 0:t.speedUp)||Math.random()*25,N=Math.random()*360,P=Math.random()*35*(Math.random()<=.5?-1:1),I=c-E/2,k=s-E/2,C=Math.random()<=.5?-1:1,T=document.createElement("div");if(n==="circle"){const A="http://www.w3.org/2000/svg",D=document.createElementNS(A,"svg"),L=document.createElementNS(A,"circle");L.setAttributeNS(null,"cx",(E/2).toString()),L.setAttributeNS(null,"cy",(E/2).toString()),L.setAttributeNS(null,"r",(E/2).toString()),L.setAttributeNS(null,"fill",`hsl(${Math.random()*360}, 70%, 50%)`),D.appendChild(L),D.setAttribute("width",E.toString()),D.setAttribute("height",E.toString()),T.appendChild(D)}else T.innerHTML=`<img src="${n}" width="${E}" height="${E}" style="border-radius: 50%">`;T.style.position="absolute",T.style.transform=`translate3d(${k}px, ${I}px, 0px) rotate(${N}deg)`,l.appendChild(T),o.push({direction:C,element:T,left:k,size:E,speedHorz:O,speedUp:M,spinSpeed:P,spinVal:N,top:I})}function d(){o.forEach(E=>{E.left=E.left-E.speedHorz*E.direction,E.top=E.top-E.speedUp,E.speedUp=Math.min(E.size,E.speedUp-1),E.spinVal=E.spinVal+E.spinSpeed,E.top>=Math.max(window.innerHeight,document.body.clientHeight)+E.size&&(o=o.filter(O=>O!==E),E.element.remove()),E.element.setAttribute("style",["position:absolute","will-change:transform",`top:${E.top}px`,`left:${E.left}px`,`transform:rotate(${E.spinVal}deg)`].join(";"))})}let p,f=0;const y=30;function m(){const E=performance.now();i&&o.length<a&&E-f>y&&(u(),f=E),d(),p=requestAnimationFrame(m)}m();const v="ontouchstart"in window,b=v?"touchstart":"mousedown",w=v?"touchend":"mouseup",j=v?"touchmove":"mousemove",x=E=>{var O,M;"touches"in E?(s=(O=E.touches)==null?void 0:O[0].clientX,c=(M=E.touches)==null?void 0:M[0].clientY):(s=E.clientX,c=E.clientY)},_=E=>{x(E),i=!0},S=()=>{i=!1};return e.addEventListener(j,x,{passive:!0}),e.addEventListener(b,_,{passive:!0}),e.addEventListener(w,S,{passive:!0}),e.addEventListener("mouseleave",S,{passive:!0}),()=>{e.removeEventListener(j,x),e.removeEventListener(b,_),e.removeEventListener(w,S),e.removeEventListener("mouseleave",S);const E=setInterval(()=>{p&&o.length===0&&(cancelAnimationFrame(p),clearInterval(E),--eB===0&&l.remove())},500)}},nB=({children:e,options:t})=>{const n=g.useRef(null);return g.useEffect(()=>{if(n.current)return tB(n.current,t)},[t]),W.cloneElement(e,{ref:n})},rB=g.memo(e=>{const{t}=Pe("flows"),n=Ml(s=>s.theme),[r,a]=g.useState(`${No.ADD_LLM}`),o=g.useMemo(()=>h.jsxs(DF,{children:[h.jsx(Yj,{children:h.jsx(nB,{children:h.jsx(ut,{variant:"link",className:"!p-0 !pl-3",children:h.jsx(GAe,{width:32,height:32,className:Z(n==="dark"?"fill-white":"fill-black")})})})}),jve.map(s=>typeof s=="object"?h.jsxs(Yj,{children:[h.jsx(Jj,{children:s.icon?h.jsx(de,{name:s.icon}):t(`supported_nodes.${s.label}`)}),h.jsx(LF,{children:s.children.map(c=>h.jsx($F,{onClick:()=>a(c),children:t(`supported_nodes.${c.toLowerCase()}`)},c))})]},s.key):h.jsx(Yj,{children:h.jsx(Jj,{value:s,onClick:()=>a(s),children:t(`supported_nodes.${s.toLowerCase()}`)})},s))]}),[t,n]),i=g.useMemo(()=>{switch(r){case No.ADD_LLM:return h.jsx(ave,{...e});case No.ADD_PROMPT:return h.jsx(sve,{...e});case No.ADD_SCHEMA:return h.jsx(fve,{...e});case No.ADD_FEW_SHOT_EXAMPLE:return h.jsx(mve,{...e});case No.ADD_TOOL_DEFINITION:return h.jsx(gve,{...e});case No.ADD_VECTOR_DATABASE:return h.jsx(wve,{...e});case No.ADD_TEXT_DATA:return h.jsx(_ve,{...e})}},[e,r]);return h.jsxs(h.Fragment,{children:[o,h.jsx("div",{className:"mt-4",children:i})]})}),aB=()=>{const[e,t]=g.useState(!1),n=Ri(),r=Je(s=>s.currentSession),a=Je(s=>s.getLatestApplications),o=g.useCallback(async(s,c,l,u)=>{var f;const d=(f=c.data)==null?void 0:f.entity;let p=c.type?QAe[c.type]:void 0;if(p&&d&&c&&typeof d=="object"&&"id"in d&&!l.has(`${d.id}`)&&!u.has(`${c.id}`)){p=p;const y=await ue(p).save({...d,...d&&typeof d=="object"&&"session_id"in d?{session_id:s.id}:{}});l.set(`${d.id}`,y.id);const m=await ue("FlowNode").findOne({where:{id:c.data.flowNode.id}}),v=await ue("FlowNode").save({...m||c.data.flowNode,session_id:s.id,id:void 0,source_type:p,source_id:y.id});return u.set(`${c.id}`,v.id),{entityName:p,entity:y,node:v}}else if(!u.has(`${c.id}`)){const y=await ue("FlowNode").findOne({where:{id:c.data.flowNode.id}}),m=await ue("FlowNode").save({...y||c.data.flowNode,node_type:c.type,session_id:s.id,id:void 0});return u.set(`${c.id}`,m.id),{node:m}}},[]),i=g.useCallback(async(s,c)=>{try{if(!r)throw new Error("No current session");t(!0);const l=await ue("Session").save({type:Pl.StandaloneApp,name:c.name||(r!=null&&r.name?`${r.name}`:"Standalone"),status:YAe.Started});if(!l)throw new Error("Failed create standalone session");const u=new Map,d=new Map,p=await o(l,s,u,d);if(!p)throw new Error("Failed to clone main node");await ue("Session").update(l.id,{main_node_id:p.node.id,main_source_id:p!=null&&p.entity?p.entity.id:void 0,main_source_type:p.entityName?p.entityName:void 0});for(const{node:f,connectedNodes:y}of c.connections)if(await o(l,f,u,d),y)for(const m of y)await o(l,m,u,d);for(const{connections:f}of c.connections)for(const y of f){const m=d.get(`${y.source}`),v=d.get(`${y.target}`);if(!m||!v)throw new Error("Failed to get connected flow node id");await ue("FlowEdge").save({source:m,target:v,sourceHandle:y.sourceHandle,targetHandle:y.targetHandle,session_id:l.id})}return a(),n(gn("application",{applicationId:l.id})),!0}finally{t(!1)}},[o,r,a,n]);return{loading:e,createStandaloneSession:i}},oB=()=>{const[e,t]=g.useState(!1),n=De(o=>o.updateNodes),r=De(o=>o.updateEdges),a=g.useCallback(async o=>{try{t(!0),await ue("FlowNode").delete(o);const i=await ue("FlowEdge").find({where:[{source:o},{target:o}]});return await Promise.all(i.map(s=>ue("FlowEdge").delete(s.id))),await n([{id:o,type:"remove"}]),await r(i.map(s=>({id:s.id,type:"remove"}))),!0}catch{return!1}finally{t(!1)}},[r,n]);return{loading:e,deleteNodeFlow:a}},iB=qa(({cloneStandaloneSession:e})=>{const t=Wt(),{t:n}=Pe("dialogs"),[r,a]=g.useState(""),{toast:o}=Gt(),i=c=>{a(c.target.value)},s=async()=>{try{t.hide(),await e(r),a("")}catch{o({variant:"destructive",description:n("create_standalone_application.errors.create_failed")})}};return h.jsx(Jo,{open:t.visible,onOpenChange:t.hide,children:h.jsxs(ro,{className:"sm:max-w-[425px]",children:[h.jsxs(ao,{children:[h.jsx(oo,{children:n("create_session.title")}),h.jsx(hu,{children:n("create_standalone_application.description")})]}),h.jsx("div",{className:"grid gap-4 py-4",children:h.jsxs("div",{className:"flex flex-col space-y-1.5",children:[h.jsx(nt,{className:"mb-2",htmlFor:"name",children:n("create_standalone_application.name")}),h.jsx(En,{onChange:i,id:"name",value:r,placeholder:n("create_standalone_application.name_placeholder")})]})}),h.jsx(fu,{children:h.jsx(ut,{onClick:s,disabled:!r,type:"submit",children:n("create_standalone_application.create")})})]})})}),Nn=g.memo(({id:e,className:t,enableToStandalone:n,getLinkedConnections:r})=>{const{t:a}=Pe("common"),{getNode:o}=lr(),{loading:i,deleteNodeFlow:s}=oB(),{createStandaloneSession:c}=aB(),{toast:l}=Gt(),u=Wt(iB),d=g.useCallback(async()=>{try{await s(e),l({description:a("deleted")})}catch{l({description:a("errors.delete_failed"),variant:"destructive"})}},[s,e,l,a]),p=g.useCallback(async y=>{try{const m=o(e);if(!m)throw new Error("No current node");const v=(r==null?void 0:r(e))||[];await c(m,{name:y,connections:v}),l({description:a("standalone_session_created")})}catch(m){kl(m),l({description:a("errors.create_standalone_session_failed"),variant:"destructive"})}},[o,e,r,c,l,a]),f=g.useCallback(()=>{u.show({cloneStandaloneSession:p})},[p,u]);return h.jsxs("div",{className:Z("flex absolute z-[51] right-0 top-0 h-10",t),children:[n?h.jsx(ut,{className:"!rounded-none !px-2",onClick:f,variant:"ghost",children:h.jsx(de,{name:"package-plus",size:16})}):void 0,h.jsx(Vn,{loading:i,className:"!rounded-none !px-2",onClick:d,variant:"ghost",children:h.jsx(de,{name:"trash-2",size:16})})]})}),lt=g.memo(e=>{const{className:t,...n}=e;return h.jsx(td,{className:Z("!w-2 !h-2 !border-none !rounded-full !bg-slate-700",e.position===fe.Top?"!top-[-2px]":"",t),...n})}),sB=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async i=>{var s,c;n(!0);try{const l=(s=i.data)==null?void 0:s.entity;if(!l||!e)throw new Error("LLM or Session not found");const u=i.position.x,d=i.position.y+(((c=i.measured)==null?void 0:c.height)||0),p=await ue("Thread").save({initial_llm_id:l.id,title:`New thread with ${l.name}`,status:Kp.Started,messages:[],session_id:e}),f=await r({source_id:p.id,source_type:"Thread",node_type:oe.Thread,x:u,y:d+60});if(!f)throw new Error("Failed to create thread node");const y=await a({source:i.id,target:f.id});return{thread:p,flowNode:f,flowEdge:y}}finally{n(!1)}},[a,r,e]);return{loading:t,createThread:o}},cB=(e,t)=>{var w;const{t:n}=Pe("flows"),{toast:r}=Gt(),[a,o]=g.useState(!1),[i,s]=g.useState(!1),c=Tn(e),{loadModel:l}=Hh(),{createThread:u,loading:d}=sB(),p=De(j=>j.updateNodes),f=De(j=>j.pushSyncNodeQueue),{getNodes:y}=lr(),m=g.useCallback(async()=>{try{if(s(!0),t.entity.id){const j=await ue("Thread").find({where:{initial_llm_id:t.entity.id}});f("Thread",{where:{source_type:"Thread",source_id:Ca(j.map(x=>x.id))}})}}finally{s(!1)}},[(w=t==null?void 0:t.entity)==null?void 0:w.id,f]),v=g.useCallback(async()=>{try{if(o(!0),t.entity&&c){await(l==null?void 0:l(t.entity.provider,`${t.entity.name}`,x=>{c.data.status=x.progress===100?Ge.Loaded:Ge.Loading,c.data.label=x.text,p([{id:e,type:"replace",item:c}])}));const j=y().filter(x=>x.type===oe.LLM?x.data.entity.provider===nn.WebLLM:!1).map(x=>(x.data.status=Ge.Started,{id:x.id,type:"replace",item:x}));c.data.label="",c.data.status=Ge.Loaded,j.push({id:e,type:"replace",item:c}),p(j),await m()}}catch(j){zo(j),r({variant:"destructive",description:n("llm_node.errors.loading_model")})}finally{o(!1)}},[t.entity,y,e,l,c,m,n,r,p]),b=g.useCallback(async()=>{t.entity&&c&&await(u==null?void 0:u(c))},[t.entity,c,u]);return g.useEffect(()=>{t.entity&&c&&t.entity.status!==t.status&&(c.data.status=t.entity.status,p([{id:e,type:"replace",item:c}]))},[]),{loadingModel:a,creatingThread:d,queringThreads:i,loadModel:v,createThread:b,queryThreads:m}},An=(e,t)=>{const[n,r]=g.useState(!1),[a,o]=g.useState([]),{deleteElements:i,getNode:s}=lr();$h({type:"target",nodeId:e,onConnect:l=>{l!=null&&l.length&&o(u=>[...u,...Kle(l)])}});const c=g.useCallback(async(l,u,d,p)=>{try{return await t({id:e,edgeId:l,source:u,target:d,connection:p})}catch{return{deleteEdgeId:l}}},[t,e]);g.useEffect(()=>{!(a!=null&&a.length)||n||(async()=>{try{r(!0);const l=[...a];o([]);const u=[],d=s(e);await Promise.all(l.map(async p=>{const f="edgeId"in p?p.edgeId:void 0,y=s(p.source);if(!y||!d)return;const m=await c(`${f}`,y,d,p);m!=null&&m.deleteEdgeId&&u.push(...Array.isArray(m.deleteEdgeId)?m.deleteEdgeId:[m.deleteEdgeId])})),u!=null&&u.length&&await i({edges:u.map(p=>({id:p}))})}finally{r(!1)}})()},[i,s,e,n,c,a])},lB=e=>{const t=g.useCallback(async()=>{},[]);An(e,t)},uB=g.memo(e=>{var m,v,b,w,j;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(),{t:i}=Pe("flows"),{createThread:s,loadModel:c,queringThreads:l,queryThreads:u,loadingModel:d}=cB(t,n);lB(t);const p=[Ge.Loading,Ge.Downloading].includes(n.status);g.useEffect(()=>{var x,_,S,E,O;if(!(a||!((x=n==null?void 0:n.entity)!=null&&x.name))){if(((_=n==null?void 0:n.entity)==null?void 0:_.provider)!==nn.WebLLM){o({hasCache:!0,isFunctionCalling:!0,info:{model_id:(S=n==null?void 0:n.entity)==null?void 0:S.name,model:(E=n==null?void 0:n.entity)==null?void 0:E.name,model_lib:(O=n==null?void 0:n.entity)==null?void 0:O.provider,model_type:2}});return}At(()=>import("./index-s4oWTEmo.js").then(async M=>(await M.__tla,M)),__vite__mapDeps([5,1,2,3,4])).then(async({hasModelInCache:M,functionCallingModelIds:N,prebuiltAppConfig:P})=>{var k,C;const I=await M((k=n==null?void 0:n.entity)==null?void 0:k.name);o({hasCache:I,isFunctionCalling:N.includes((C=n==null?void 0:n.entity)==null?void 0:C.name),info:P.model_list.find(T=>{var A;return T.model_id===((A=n==null?void 0:n.entity)==null?void 0:A.name)})})})}},[(m=n==null?void 0:n.entity)==null?void 0:m.name,(v=n==null?void 0:n.entity)==null?void 0:v.provider,a]);const f=g.useMemo(()=>{var x,_;switch(n.status){case Ge.Downloading:return h.jsx(de,{className:"animate-spin w-7 h-7",name:"arrow-big-down-dash"});case Ge.Loaded:return h.jsx(Aa,{name:((x=n.entity)==null?void 0:x.name)||"brain",className:"w-7 h-7"});case Ge.Loading:return h.jsx(de,{className:"animate-spin w-7 h-7",name:"loader-circle"});default:return h.jsx(Aa,{name:((_=n.entity)==null?void 0:_.name)||"brain",className:"w-7 h-7"})}},[(b=n.entity)==null?void 0:b.name,n.status]),y=g.useMemo(()=>p?null:d?h.jsx(ut,{disabled:!0,className:"w-full mt-4",children:h.jsx(de,{className:"animate-spin",size:24,name:"loader-circle"})}):n.status===Ge.Loaded?h.jsx(ut,{onClick:s,className:"mt-4 w-full",children:i("llm_node.create_thread_button")}):h.jsxs("div",{className:"flex gap-2 mt-4",children:[a!=null&&a.hasCache?h.jsx(Vn,{loading:l,onClick:u,children:h.jsx(de,{size:24,name:"message-square-more"})}):null,h.jsx(ut,{disabled:d,onClick:c,className:"w-full",children:i(a!=null&&a.hasCache?"llm_node.load_model_button":"llm_node.download_model_button")})]}),[p,d,n.status,a==null?void 0:a.hasCache,l,u,c,i,s]);return h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Ra,{className:"flex justify-center",children:[f,h.jsxs("div",{className:"ml-2 pt-1 max-w-lg",children:[h.jsx(Co,{className:"flex gap-2 items-center pr-6",children:`${((w=n==null?void 0:n.entity)==null?void 0:w.name)||""}`}),h.jsx(zc,{className:"max-w-full",children:`${n.label||""}`}),h.jsx("div",{className:"max-w-full mt-2 flex-wrap flex gap-1",children:h.jsx(Od,{model:a==null?void 0:a.info,isFunctionCalling:(a==null?void 0:a.isFunctionCalling)||!1,name:(j=n==null?void 0:n.entity)==null?void 0:j.name,isCached:(a==null?void 0:a.hasCache)||!1})}),y]})]}),p?h.jsx(Rj,{className:"rounded-lg"}):void 0]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),Wm=g.memo(({tags:e,disabled:t,loading:n,onSubmit:r})=>{const{t:a}=Pe("components"),o=async i=>{try{return await r(i),!0}catch{return!1}};return h.jsxs(Zt,{className:"min-w-80",children:[h.jsx(Ln,{children:h.jsx(Kn,{children:a("add_message_card.title")})}),h.jsxs($n,{children:[h.jsx("div",{className:"grid w-full gap-1.5",children:h.jsx(wv,{onSubmit:o,disabled:t||n,placeholder:a("add_message_card.placeholder")})}),e?h.jsx("div",{className:"mt-2 gap-1 flex flex-wrap",children:e}):null]})]})}),OS=(e,t,n,r=[],a)=>{const o=e.map(i=>a.getNode(i));for(const i of o){if(!i)continue;const s=a.getHandleConnections({type:"target",nodeId:i.id});if(n.push(...s),i.type===oe.Thread){r.push(i.id),t.push(i);continue}else if(i.type!==oe.Message){r.push(i.id);continue}else if(r.includes(i.id))continue;r.push(i.id),t.push(i),s.length&&OS(s.map(c=>c.source),t,n,r,a)}return{nodes:t,connections:n}},CS=(e,t)=>{const n=t.getHandleConnections({nodeId:e.id,type:"target"}),r=n.map(d=>{const p=t.getNode(d.source);return p?{connections:t.getHandleConnections({nodeId:p.id,type:"target"}),node:p}:void 0}),a=r.filter(d=>{var p;return((p=d.node)==null?void 0:p.type)===oe.Prompt}),o=[];a!=null&&a.length&&a.forEach(d=>{var f;const p=(f=d.connections)==null?void 0:f.map(y=>t.getNode(y.source)).filter(Boolean);o.push({node:d.node,connections:d.connections,connectedNodes:p})});const i=r.filter(d=>{var p;return((p=d.node)==null?void 0:p.type)===oe.ToolDefinition}),s=[];i!=null&&i.length&&i.forEach(d=>{var f;const p=(f=d.connections)==null?void 0:f.map(y=>t.getNode(y.source)).filter(Boolean);p!=null&&p.find(y=>y.type===oe.Schema)&&s.push({node:d.node,connections:d.connections,connectedNodes:p})});const c=r.filter(d=>{var p;return((p=d.node)==null?void 0:p.type)===oe.PlaceHolder}),l=[];c!=null&&c.length&&c.forEach(d=>{var f;const p=(f=d.connections)==null?void 0:f.map(y=>t.getNode(y.source)).filter(Boolean);p&&l.push({node:d.node,connections:d.connections,connectedNodes:p})});const u=r.find(d=>{var p;return((p=d.node)==null?void 0:p.type)===oe.Schema});return{thread:{node:e,connections:n},llm:r.find(d=>{var p;return((p=d.node)==null?void 0:p.type)===oe.LLM}),schemas:u?[u]:[],prompts:o,tools:s,placeholders:l}},NS=e=>{const t=[];return e.forEach(n=>{var o,i,s;const{node:r,connectedNodes:a}=n;if((o=r.data)!=null&&o.entity){if(r.type===oe.Message){const c=r.data.entity;switch(c.role){case"human":t.push(new Pr(c.content));break;case"ai":t.push(new Uo(c.content));break}}else if(r.type===oe.Prompt){const c=r.data.entity;let l=`${c.prefix?`${c.prefix}
`:""}`;if(c.type===rr.FewShotExample){const u=(s=(i=a.find(d=>d.type===oe.CSVData))==null?void 0:i.data)==null?void 0:s.entity;if(u){const{rows:d}=wK(u.headers,u.csv);d.forEach(p=>{l+=`${c.content.replace(/{([^{}]*)}/g,(f,y)=>`${p[y]}`)}
`})}}else l+=c.content;switch(c.suffix&&(l+=`
${c.suffix}`),c.role){case"human":t.push(new Pr(l));break;case"system":t.push(new Pg(l));break;default:t.push(new Uo(l));break}}}}),t},dB=(e,t)=>{const n=(e==null?void 0:e.filter(a=>a.type===oe.Message).map(a=>({node:a,connectedNodes:[]})).reverse())||[],r=[];return t.forEach(async a=>{r.unshift({node:a.node,connectedNodes:a.connectedNodes||[]})}),{history:NS(n),systems:NS(r)}},pB=e=>e?e.reduce((t,n)=>{var o,i,s,c,l;const r=(o=n.node.data)==null?void 0:o.entity,a=(c=(s=(i=n==null?void 0:n.connectedNodes)==null?void 0:i.find(u=>u.type===oe.Schema))==null?void 0:s.data)==null?void 0:c.entity;return r&&((l=a==null?void 0:a.schema_items)!=null&&l.length)&&t.push({name:r.name,description:r.description,schemaItems:a.schema_items}),t},[]):[],MS=({getNode:e,getHandleConnections:t})=>{const{t:n}=Pe("create_new_message"),[r,a]=g.useState(!1),o=Je(y=>y.currentSession),i=De(y=>y.createOrUpdateFlowNode),s=De(y=>y.createOrUpdateFlowEdge),c=Ss(y=>y.similaritySearchWithScore),{stream:l}=kc(),u=g.useCallback(async({content:y,threadId:m,sourceId:v,initialX:b,initialY:w,initialLLMId:j})=>{if(!o)throw new Error("Session is not found");const x=await ue("Message").save({thread_id:m,content:y,role:nr.Human,status:Ir.Started,llm_id:j,session_id:o.id});if(!x)throw new Error("Failed to save message");const _=await i({source_id:x.id,source_type:"Message",node_type:oe.Message,x:b,y:w+80});if(!_)throw new Error("Failed to save human message node");await s({source:v,target:_.id});const S=await ue("Message").save({thread_id:m,content:n("initial_ai_message"),role:nr.AI,status:Ir.Inprogress,llm_id:j,parent_message_id:x.id,session_id:o.id});if(!S)throw new Error("Failed to save message");const E=await i({source_id:S.id,source_type:"Message",node_type:oe.Message,x:b,y:w+250});if(!E)throw new Error("Failed to save ai message node");return await s({source:_.id,target:E.id}),{aiMessage:S,humanMessage:x,aiMessageNode:E,humanMessageNode:_}},[s,i,o,n]),d=g.useCallback(async(y,m)=>{const{placeholders:v}=m;if(!(v!=null&&v.length))return[];const b=[];return await Promise.all(v.map(async w=>{var x,_,S,E,O,M,N,P,I,k,C,T;const j=(x=w.node.data)==null?void 0:x.entity;if(j)switch(j.placeholder_type){case Ts.VECTOR_DATABASE_RETREIVER:{const A=(_=w.connectedNodes)==null?void 0:_.find(V=>V.type===oe.VectorDatabase),D=(S=A==null?void 0:A.data)==null?void 0:S.entity,L=(M=(O=(E=w.connectedNodes)==null?void 0:E.find(V=>V.type===oe.Prompt))==null?void 0:O.data)==null?void 0:M.entity;if(!L||!D||!A)return;const R=(N=j.metadata)!=null&&N.k?+((P=j.metadata)==null?void 0:P.k):1;let B=(I=j.metadata)!=null&&I.minimalScore?+((k=j.metadata)==null?void 0:k.minimalScore):void 0;B&&B>1&&(B=B/100);const z=[];if(D.storage===kr.DataNode){const V=(T=(C=t({nodeId:A.id,type:"target"}).map(Y=>e(Y.source)).find(Y=>(Y==null?void 0:Y.type)&&[oe.JSONLData,oe.CSVData].includes(Y==null?void 0:Y.type)))==null?void 0:C.data)==null?void 0:T.entity;if(!V)return;z.push(...await c({databaseId:D.id,dataSourceId:V.id,dataSourceType:NN(V)},y.humanMessage.content,R))}else z.push(...await c({databaseId:D.id},y.humanMessage.content,R));if(!z)return[];const $=new Ho({template:L.content,inputVariables:["context"]});b.push(new Uo(await $.format({context:B?z.filter(([,V])=>V>=B).map(([V])=>V.pageContent).join(`
`):z.map(([V])=>V.pageContent).join(`
`)})))}}})),b},[t,e,c]),p=g.useCallback(async(y,m,v,{onMessageUpdate:b})=>{var T;const{prompts:w,tools:j,schemas:x,placeholders:_,llm:S}=m,E=(T=S==null?void 0:S.node.data)==null?void 0:T.entity;if(!E)throw new Error("LLM is not found");const O=[];_!=null&&_.length&&O.push(...await d(y,m));const{history:M,systems:N}=dB(v,w),P=[...N,...O,...M,new Pr(y.humanMessage.content)],I=x.map(A=>{var D;return(D=A.node.data)==null?void 0:D.entity}).filter(Boolean),{lastChunk:k,content:C}=await l(E.provider,P,{tools:pB(j),schemas:I,llm:E,onMessageUpdate:({content:A})=>{b==null||b({id:y.aiMessageNode.id,nodeData:{loading:!0,content:A}})}});return y.aiMessage.content=C,y.aiMessage.metadata=JSON.stringify({message:k}),b==null||b({id:y.aiMessageNode.id,nodeData:{content:C,loading:!1,entity:y.aiMessage}}),y.aiMessage.id&&await ue("Message").update(y.aiMessage.id,{content:C,metadata:JSON.stringify({message:k})}),C},[d,l]),f=g.useCallback(async(y,m,v)=>{var S,E,O;const{nodes:b}=OS([y.id],[],[],[],{getNode:e,getHandleConnections:t}),w=b.find(M=>M.type===oe.Thread),j=w==null?void 0:w.data.entity;if(!y||!j||!w)throw new Error("Source or thread is not found");const x=CS(w,{getNode:e,getHandleConnections:t});if(!(x!=null&&x.thread))throw new Error("Thread node is not found");let _;try{a(!0);const M=((S=y.position)==null?void 0:S.x)||0,N=(((E=y.position)==null?void 0:E.y)||0)+(((O=y.measured)==null?void 0:O.height)||0);return _=await u({content:m,initialX:M,initialY:N,sourceId:y.id,threadId:j.id,initialLLMId:j.initial_llm_id}),await p(_,x,b,v),await ue("Message").update(`${_.aiMessage.id}`,{status:Ir.Success}),_.aiMessage.status=Ir.Success,v.onMessageUpdate({id:_.aiMessageNode.id,nodeData:{entity:_.aiMessage,loading:!1}}),!0}catch(M){kl(M),_!=null&&_.aiMessage&&await ue("Message").update(`${_.aiMessage.id}`,{status:Ir.Failed,content:n("errors.ai_message_content_failed")}),_!=null&&_.aiMessageNode.id&&(v==null||v.onMessageUpdate({id:_.aiMessageNode.id,nodeData:{content:n("errors.ai_message_content_failed"),entity:{..._.aiMessage,status:Ir.Failed,content:n("errors.ai_message_content_failed")},loading:!1}}))}finally{a(!1)}},[t,e,u,p,n]);return{loading:r,createMessage:f}},fB=(e,t)=>{const n=Tn(e),{t:r}=Pe("flows"),{getNode:a,getHandleConnections:o}=lr(),i=De(p=>p.updateNodes),{createMessage:s,loading:c}=MS({getNode:a,getHandleConnections:o}),l=g.useCallback(p=>{if(!p.id)return;const f=a(p.id);!f||!p.nodeData||i([{id:f.id,type:"replace",item:{...f,data:{...f.data,...Tu(p.nodeData,Iu)}}}])},[a,i]),u=g.useCallback(async p=>{if(n&&t.entity)try{await s(n,p,{onMessageUpdate:l})}catch(f){if(f instanceof Error&&f.message.includes("LLM_NOT_LOADED_YET"))return Il({variant:"destructive",title:r("thread_node.errors.llm_not_loaded_yet")});Il({variant:"destructive",title:`${f}`})}},[n,t.entity,s,l,r]),d=g.useCallback(p=>{const f=a(p);if(!f)return[];const y=[],m=CS(f,{getNode:a,getHandleConnections:o});return m.thread&&y.push({node:m.thread.node,connectedNodes:[],connections:m.thread.connections}),m.prompts&&y.push(...m.prompts.map(v=>({node:v.node,connectedNodes:v.connectedNodes,connections:v.connections}))),m.schemas&&y.push(...m.schemas.map(v=>({node:v.node,connectedNodes:[],connections:v.connections}))),m.placeholders&&m.placeholders.forEach(v=>{const b=v.connections.map(w=>a(w.source)).filter(Boolean);y.push({node:v.node,connectedNodes:b||[],connections:v.connections})}),m.llm&&y.push(m.llm),y},[o,a]);return{loading:c,createMessage:u,getLinkedConnections:d}},hB=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.Prompt&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.Schema&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.ToolDefinition&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.VectorDatabase&&(o==null?void 0:o.type)===oe.Thread){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}else if((a==null?void 0:a.type)===oe.PlaceHolder&&(o==null?void 0:o.type)===oe.Thread&&a.data.entity.placeholder_type===Ts.VECTOR_DATABASE_RETREIVER){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},mB=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e,{t:a}=Pe("flows"),[o,i]=g.useState(!1),s=$h({type:"source"}),c=$h({type:"target"}),{getNode:l}=lr(),{loading:u,createMessage:d,getLinkedConnections:p}=fB(t,n);hB(t);const f=g.useCallback(async(...b)=>(i(!1),await d(...b)),[d]),y=g.useMemo(()=>s.length>0,[s]),m=g.useCallback(()=>{i(b=>!b)},[]),v=g.useMemo(()=>{var w,j;const b=c.map((x,_)=>{var E;const S=l(x.source);if((S==null?void 0:S.type)===oe.Schema)return h.jsx(un,{children:a("thread_node.structured_output")},`${_}`);if((S==null?void 0:S.type)===oe.Prompt){const O=S.data.entity;return h.jsx(un,{children:a(O.type===rr.FewShotExample?"thread_node.prompts.few_shot_example":`thread_node.prompts.${O.role.toLowerCase()}`)},`${_}`)}else if((S==null?void 0:S.type)===oe.PlaceHolder&&((E=S.data.entity)==null?void 0:E.placeholder_type)===Ts.VECTOR_DATABASE_RETREIVER)return h.jsx(un,{children:a("thread_node.vector_database_retriever")},`${_}`)}).filter(Boolean);return e.data.entity&&!((j=(w=e.data.entity)==null?void 0:w.messages)!=null&&j.length)&&!y?h.jsx(Wm,{disabled:u,loading:u,onSubmit:f,tags:b}):b!=null&&b.length?h.jsxs(Zt,{className:"p-4 pt-2",children:[h.jsx(Kn,{className:"mb-2",children:a("thread_node.title")}),h.jsx("div",{className:"flex gap-1.5",children:b}),h.jsx("div",{className:"mt-4 w-full flex justify-end",children:h.jsxs(ut,{onClick:m,variant:"outline",children:[h.jsx(de,{name:o?"copy-minus":"copy-plus"}),a(o?"thread_node.hide":"thread_node.clone")]})})]}):h.jsx("div",{className:"w-12 h-10"})},[y,l,f,m,u,e.data.entity,o,a,c]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t,enableToStandalone:!0,getLinkedConnections:p}),v,o?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(Wm,{disabled:u,loading:u,onSubmit:f})})})]}):void 0]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})});function Eve({data:e,onNewThread:t,loading:n,showThread:r}){var o;const{t:a}=Pe("flows");return h.jsxs(Ra,{className:"flex min-w-52",children:[h.jsx(de,{size:24,name:"user"}),h.jsxs("div",{className:"ml-2 max-w-full w-full",children:[h.jsx(Co,{children:"Human"}),h.jsx(zc,{children:`${e.content||((o=e.entity)==null?void 0:o.content)||""}`}),t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(ut,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(de,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]})]})}const Ove=g.lazy(()=>At(()=>import("./index-D6F2YTwn.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([9,10,1,2,11,12])));function Cve({data:e,onNewThread:t,loading:n,showThread:r}){var s,c,l,u,d,p,f,y,m;const{t:a}=Pe("flows"),o=g.useMemo(()=>{var v;try{return JSON.parse(((v=e==null?void 0:e.entity)==null?void 0:v.metadata)||"{}")}catch{return{}}},[(s=e==null?void 0:e.entity)==null?void 0:s.metadata]),i=e.entity.status===Ir.Failed;return h.jsxs(Ra,{className:Z("flex min-w-52",i?"bg-background":""),variant:i?"destructive":"default",children:[h.jsx(de,{className:Z(e.loading?"animate-spin":void 0),size:24,name:e.loading?"loader-circle":"bot"}),h.jsx(de,{name:r?"minus":"plus",size:24}),h.jsxs("div",{className:"ml-2 w-full max-w-full",children:[h.jsx(Co,{children:a(`message_node.message_roles.${(l=(c=e.entity)==null?void 0:c.role)==null?void 0:l.toLowerCase()}`)}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:i?e.content||((u=e.entity)==null?void 0:u.content)||"":h.jsx(Ove,{className:"!text-sm [&_p]:leading-relaxed !max-w-full !bg-transparent !font-sans",source:`${e.content||((d=e.entity)==null?void 0:d.content)||""}`,style:{color:"unset !important"}})}),Array.isArray((p=o==null?void 0:o.message)==null?void 0:p.tool_calls)&&((y=(f=o==null?void 0:o.message)==null?void 0:f.tool_calls)!=null&&y.length)?(m=o==null?void 0:o.message)==null?void 0:m.tool_calls.map((v,b)=>h.jsx(un,{children:a("message_node.tool_call",{name:v.name,args:Object.entries(v.args).map(([w,j])=>`"${w}": "${j}"`).join(", ")})},`${v.name}_${b}`)):null,t?h.jsx("div",{className:"w-full mt-2 flex items-center justify-end",children:h.jsxs(ut,{onClick:t,disabled:n,variant:"outline",children:[h.jsx(de,{name:r?"minus":"plus",size:16}),a(r?"message_node.hide_thread":"message_node.new_thread")]})}):void 0]}),e.loading?h.jsx(Rj,{size:350,duration:10}):void 0]})}const Nve=e=>{const{t}=Pe("flows"),n=Tn(e),r=De(u=>u.updateNodes),{getNode:a,getHandleConnections:o}=lr(),{createMessage:i,loading:s}=MS({getNode:a,getHandleConnections:o}),c=g.useCallback(u=>{if(!u.id)return;const d=a(u.id);!d||!u.nodeData||r([{id:d.id,type:"replace",item:{...d,data:{...d.data,...Tu(u.nodeData,Iu)}}}])},[a,r]),l=g.useCallback(async u=>{if(n)try{await i(n,u,{onMessageUpdate:c})}catch(d){if(d instanceof Error&&d.message.includes("LLM_NOT_LOADED_YET"))return Il({variant:"destructive",title:t("message_node.errors.llm_not_loaded_yet")});Il({variant:"destructive",title:t("message_node.errors.create_message")})}},[n,t,i,c]);return{loading:s,createMessage:l}},yB=()=>{const e=Je(r=>r.currentSession),t=De(r=>r.createOrUpdateFlowNode),n=De(r=>r.createOrUpdateFlowEdge);return{createIdieMessage:g.useCallback(async(r,a,o,i)=>{var y,m,v,b,w;if(!r||!a||!e)return;const s=(m=(y=i==null?void 0:i.promptNode)==null?void 0:y.data)==null?void 0:m.entity,c=((v=r.position)==null?void 0:v.x)||0,l=(((b=r.position)==null?void 0:b.y)||0)+(((w=r.measured)==null?void 0:w.height)||0),u=await ue("Message").save({thread_id:a.id,content:o,role:(s==null?void 0:s.role)||nr.Human,status:Ir.Started,llm_id:a.initial_llm_id,session_id:e.id});if(!u)throw new Error("Failed to save message");const d=await t({source_id:u.id,source_type:"Message",node_type:oe.Message,x:c,y:l});if(!d)throw new Error("Failed to save message node");const p=await n({source:r.id,target:d.id});let f;return i!=null&&i.promptNode&&(f=await n({source:i==null?void 0:i.promptNode.id,target:d.id})),{message:u,edgeToPrompt:f,messageNode:d,messageEdge:p}},[t,n])}},Mve=e=>{const{createIdieMessage:t}=yB(),n=g.useCallback(async({edgeId:r,source:a,target:o})=>{var i,s;try{if((a==null?void 0:a.type)===oe.Prompt&&(o==null?void 0:o.type)===oe.Message){const c=(i=o==null?void 0:o.data)==null?void 0:i.entity,l=(s=a==null?void 0:a.data)==null?void 0:s.entity;if(!l||!c||!o)return{deleteEdgeId:r};await t(o,{id:c==null?void 0:c.thread_id,title:"",status:Kp.Started,initial_llm_id:c.llm_id,session_id:l.session_id},l.content,{promptNode:a});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Pve=g.memo(e=>{var j,x,_;const{id:t,data:n,isConnectable:r}=e,[a,o]=g.useState(!1),[i,s]=g.useState(!1),{t:c}=Pe("common"),l=$h({type:"source"}),{loading:u,createMessage:d}=Nve(t),{toast:p}=Gt();Mve(t);const f=g.useCallback(async(...S)=>{const E=await d(...S);return o(!1),E},[d]),y=g.useMemo(()=>l.length===0,[l]),m=g.useCallback(()=>{var S;(S=n.entity)!=null&&S.content&&(navigator.clipboard.writeText(n.entity.content),p({description:c("copied")}))},[p,n,c]),v=g.useCallback(async()=>{var S;try{if(i)return await CN.stop(),s(!1);s(!0),await CN.speak(((S=n.entity)==null?void 0:S.content)||"")}catch{p({variant:"destructive",description:c("errors.speech_is_not_supported")})}finally{s(!1)}},[(j=n.entity)==null?void 0:j.content,i,c,p]),b=g.useCallback(()=>{o(S=>!S)},[]),w=g.useMemo(()=>{var S;if(!(!y&&!a||n.loading||u||((S=n==null?void 0:n.entity)==null?void 0:S.status)==="inprogress"))return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-[1px] absolute ml-[50%] h-[30px] bg-gray-500"}),h.jsx("div",{className:"absolute mt-[30px] w-full",children:h.jsx("div",{className:"ml-[10%] w-80 animate-in slide-in-from-bottom-5",children:h.jsx(Wm,{disabled:u,loading:u,onSubmit:f})})})]})},[(x=n==null?void 0:n.entity)==null?void 0:x.status,n.loading,f,y,u,a]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs("div",{className:"max-w-sm min-w-64",children:[h.jsxs("div",{className:"w-auto",children:[h.jsx(Nn,{id:t}),h.jsx("div",{children:((_=n.entity)==null?void 0:_.role)===nr.Human?h.jsx(Eve,{data:n,showThread:a,onNewThread:y?void 0:b}):h.jsx(Cve,{data:n,showThread:a,loading:u,onNewThread:y?void 0:b})}),h.jsx(ut,{onClick:v,className:"absolute top-0 right-[68px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(de,{name:i?"circle-stop":"speech",size:16})}),h.jsx(ut,{onClick:m,className:"absolute top-0 right-[36px] !px-2 !rounded-none",variant:"ghost",children:h.jsx(de,{name:"copy",size:16})})]}),w]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),kve=e=>{const t=De(a=>a.createOrUpdateFlowEdge),{createIdieMessage:n}=yB(),r=g.useCallback(async({edgeId:a,source:o,target:i})=>{var s,c,l,u;try{const d=(s=i==null?void 0:i.data)==null?void 0:s.entity,p=(c=o==null?void 0:o.data)==null?void 0:c.entity;if((o==null?void 0:o.type)===oe.Message&&(i==null?void 0:i.type)===oe.Prompt){const f=(l=o==null?void 0:o.data)==null?void 0:l.entity,y=(u=i==null?void 0:i.data)==null?void 0:u.entity;if(!y||!f||!i)return{deleteEdgeId:a};await n(o,{id:f==null?void 0:f.thread_id,title:"",status:Kp.Started,initial_llm_id:f.llm_id,session_id:y.session_id},y.content,{promptNode:i});return}else if((o==null?void 0:o.type)===oe.CSVData&&(i==null?void 0:i.type)===oe.Prompt&&(d==null?void 0:d.type)===rr.FewShotExample&&(p!=null&&p.headers.includes("input"))&&(p!=null&&p.headers.includes("output"))){await t({source:o.id,target:i.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[n,t]);An(e,r)},Ave=g.memo(e=>{var l,u,d;const{id:t,data:n,isConnectable:r}=e;kve(t);const a=Wt(I$),o=g.useMemo(()=>{var p,f,y;return`${(p=n.entity)!=null&&p.prefix?`${(f=n.entity)==null?void 0:f.prefix}
`:""}${((y=n.entity)==null?void 0:y.content)||""}`},[(l=n.entity)==null?void 0:l.prefix,(u=n.entity)==null?void 0:u.content]),i=g.useMemo(()=>{var f;const p=/{(.*?)}/g;return((f=o.match(p))==null?void 0:f.map(y=>y.replace("{","").replace("}","")))||[]},[o]),s=o.length>990,c=()=>{a.show({title:"Prompt",content:o})};return h.jsxs("div",{className:"min-w-56",children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Ra,{className:"flex justify-center max-w-72",variant:"default",children:[h.jsx(de,{size:24,name:"notepad-text"}),h.jsxs("div",{className:"ml-2 max-w-full break-words break-all",children:[h.jsx(Co,{children:`${((d=n.entity)==null?void 0:d.role)||""}`}),h.jsxs(zc,{onClick:s?c:void 0,children:[s?`${o.slice(0,990)}...`:o,s?h.jsx("span",{className:"float-right",children:h.jsx(de,{name:"chevron-right"})}):void 0]}),i!=null&&i.length?i.map((p,f)=>h.jsx(un,{className:"mt-2 mr-1",variant:"default",children:p},f)):void 0]})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})});var Tve=ZR();const xr=ot(Tve);var PS,gB;function Ive(){if(gB)return PS;gB=1;function e(t){return t==null}return PS=e,PS}var Rve=Ive();const gt=ot(Rve);var kS,vB;function Dve(){if(vB)return kS;vB=1;var e=fo(),t=In(),n=ha(),r="[object String]";function a(o){return typeof o=="string"||!t(o)&&n(o)&&e(o)==r}return kS=a,kS}var Lve=Dve();const Rd=ot(Lve);var $ve=zp();const tt=ot($ve);var Fve=Tr();const Vc=ot(Fve);var bB={exports:{}},vt={},wB;function Bve(){if(wB)return vt;wB=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),i=Symbol.for("react.context"),s=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.for("react.offscreen"),y;y=Symbol.for("react.module.reference");function m(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case e:switch(v=v.type,v){case n:case a:case r:case l:case u:return v;default:switch(v=v&&v.$$typeof,v){case s:case i:case c:case p:case d:case o:return v;default:return b}}case t:return b}}}return vt.ContextConsumer=i,vt.ContextProvider=o,vt.Element=e,vt.ForwardRef=c,vt.Fragment=n,vt.Lazy=p,vt.Memo=d,vt.Portal=t,vt.Profiler=a,vt.StrictMode=r,vt.Suspense=l,vt.SuspenseList=u,vt.isAsyncMode=function(){return!1},vt.isConcurrentMode=function(){return!1},vt.isContextConsumer=function(v){return m(v)===i},vt.isContextProvider=function(v){return m(v)===o},vt.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===e},vt.isForwardRef=function(v){return m(v)===c},vt.isFragment=function(v){return m(v)===n},vt.isLazy=function(v){return m(v)===p},vt.isMemo=function(v){return m(v)===d},vt.isPortal=function(v){return m(v)===t},vt.isProfiler=function(v){return m(v)===a},vt.isStrictMode=function(v){return m(v)===r},vt.isSuspense=function(v){return m(v)===l},vt.isSuspenseList=function(v){return m(v)===u},vt.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===n||v===a||v===r||v===l||v===u||v===f||typeof v=="object"&&v!==null&&(v.$$typeof===p||v.$$typeof===d||v.$$typeof===o||v.$$typeof===i||v.$$typeof===c||v.$$typeof===y||v.getModuleId!==void 0)},vt.typeOf=m,vt}var xB;function zve(){return xB||(xB=1,bB.exports=Bve()),bB.exports}var Vve=zve(),AS,_B;function jB(){if(_B)return AS;_B=1;var e=fo(),t=ha(),n="[object Number]";function r(a){return typeof a=="number"||t(a)&&e(a)==n}return AS=r,AS}var TS,SB;function Uve(){if(SB)return TS;SB=1;var e=jB();function t(n){return e(n)&&n!=+n}return TS=t,TS}var Wve=Uve();const Dd=ot(Wve);var Hve=jB();const qve=ot(Hve);var ia=function(e){return e===0?0:e>0?1:-1},is=function(e){return Rd(e)&&e.indexOf("%")===e.length-1},ye=function(e){return qve(e)&&!Dd(e)},sn=function(e){return ye(e)||Rd(e)},Kve=0,Hm=function(e){var t=++Kve;return"".concat(e||"").concat(t)},ss=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ye(e)&&!Rd(e))return n;var a;if(is(e)){var o=e.indexOf("%");a=t*parseFloat(e.slice(0,o))/100}else a=+e;return Dd(a)&&(a=n),r&&a>t&&(a=t),a},yi=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},Xve=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1},Uc=function(e,t){return ye(e)&&ye(t)?function(n){return e+n*(t-e)}:function(){return t}};function IS(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):xr(r,t))===n})}function Wc(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function RS(e){"@babel/helpers - typeof";return RS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RS(e)}var Zve=["viewBox","children"],Gve=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],EB=["points","pathLength"],DS={svg:Zve,polygon:EB,polyline:EB},LS=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],qm=function(e,t){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),!Vc(n))return null;var r={};return Object.keys(n).forEach(function(a){LS.includes(a)&&(r[a]=t||function(o){return n[a](n,o)})}),r},Qve=function(e,t,n){return function(r){return e(t,n,r),null}},Km=function(e,t,n){if(!Vc(e)||RS(e)!=="object")return null;var r=null;return Object.keys(e).forEach(function(a){var o=e[a];LS.includes(a)&&typeof o=="function"&&(r||(r={}),r[a]=Qve(o,t,n))}),r},Yve=["children"],Jve=["children"];function OB(e,t){if(e==null)return{};var n=e0e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function e0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var CB={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Mo=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},NB=null,$S=null,FS=function e(t){if(t===NB&&Array.isArray($S))return $S;var n=[];return g.Children.forEach(t,function(r){gt(r)||(Vve.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),$S=n,NB=t,n};function sa(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(a){return Mo(a)}):r=[Mo(t)],FS(e).forEach(function(a){var o=xr(a,"type.displayName")||xr(a,"type.name");r.indexOf(o)!==-1&&n.push(a)}),n}function fr(e,t){var n=sa(e,t);return n&&n[0]}var MB=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!ye(n)||n<=0||!ye(r)||r<=0)},t0e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],n0e=function(e){return e&&e.type&&Rd(e.type)&&t0e.indexOf(e.type)>=0},r0e=function(e,t,n,r){var a,o=(a=DS==null?void 0:DS[r])!==null&&a!==void 0?a:[];return!tt(e)&&(r&&o.includes(t)||Gve.includes(t))||n&&LS.includes(t)},yt=function(e,t,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(g.isValidElement(e)&&(r=e.props),!Vc(r))return null;var a={};return Object.keys(r).forEach(function(o){var i;r0e((i=r)===null||i===void 0?void 0:i[o],o,t,n)&&(a[o]=r[o])}),a},BS=function e(t,n){if(t===n)return!0;var r=g.Children.count(t);if(r!==g.Children.count(n))return!1;if(r===0)return!0;if(r===1)return PB(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var o=t[a],i=n[a];if(Array.isArray(o)||Array.isArray(i)){if(!e(o,i))return!1}else if(!PB(o,i))return!1}return!0},PB=function(e,t){if(gt(e)&&gt(t))return!0;if(!gt(e)&&!gt(t)){var n=e.props||{},r=n.children,a=OB(n,Yve),o=t.props||{},i=o.children,s=OB(o,Jve);return r&&i?Wc(a,s)&&BS(r,i):!r&&!i?Wc(a,s):!1}return!1},kB=function(e,t){var n=[],r={};return FS(e).forEach(function(a,o){if(n0e(a))n.push(a);else if(a){var i=Mo(a.type),s=t[i]||{},c=s.handler,l=s.once;if(c&&(!l||!r[i])){var u=c(a,i,o);n.push(u),r[i]=!0}}}),n},a0e=function(e){var t=e&&e.type;return t&&CB[t]?CB[t]:null},o0e=function(e,t){return FS(t).indexOf(e)},i0e=["children","width","height","viewBox","className","style","title","desc"];function zS(){return zS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zS.apply(this,arguments)}function s0e(e,t){if(e==null)return{};var n=c0e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function c0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function VS(e){var t=e.children,n=e.width,r=e.height,a=e.viewBox,o=e.className,i=e.style,s=e.title,c=e.desc,l=s0e(e,i0e),u=a||{width:n,height:r,x:0,y:0},d=xt("recharts-surface",o);return W.createElement("svg",zS({},yt(l,!0,"svg"),{className:d,width:n,height:r,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),W.createElement("title",null,s),W.createElement("desc",null,c),t)}var l0e=["children","className"];function US(){return US=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},US.apply(this,arguments)}function u0e(e,t){if(e==null)return{};var n=d0e(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function d0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var fn=W.forwardRef(function(e,t){var n=e.children,r=e.className,a=u0e(e,l0e),o=xt("recharts-layer",r);return W.createElement("g",US({className:o},yt(a,!0),{ref:t}),n)}),Po=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]},WS,AB;function p0e(){if(AB)return WS;AB=1;var e=Tv();function t(n,r,a){var o=n.length;return a=a===void 0?o:a,!r&&a>=o?n:e(n,r,a)}return WS=t,WS}var HS,TB;function IB(){if(TB)return HS;TB=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="\\u200d",s=RegExp("["+i+e+a+o+"]");function c(l){return s.test(l)}return HS=c,HS}var qS,RB;function f0e(){if(RB)return qS;RB=1;function e(t){return t.split("")}return qS=e,qS}var KS,DB;function h0e(){if(DB)return KS;DB=1;var e="\uD800-\uDFFF",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",a=t+n+r,o="\\ufe0e\\ufe0f",i="["+e+"]",s="["+a+"]",c="\uD83C[\uDFFB-\uDFFF]",l="(?:"+s+"|"+c+")",u="[^"+e+"]",d="(?:\uD83C[\uDDE6-\uDDFF]){2}",p="[\uD800-\uDBFF][\uDC00-\uDFFF]",f="\\u200d",y=l+"?",m="["+o+"]?",v="(?:"+f+"(?:"+[u,d,p].join("|")+")"+m+y+")*",b=m+y+v,w="(?:"+[u+s+"?",s,d,p,i].join("|")+")",j=RegExp(c+"(?="+c+")|"+w+b,"g");function x(_){return _.match(j)||[]}return KS=x,KS}var XS,LB;function m0e(){if(LB)return XS;LB=1;var e=f0e(),t=IB(),n=h0e();function r(a){return t(a)?n(a):e(a)}return XS=r,XS}var ZS,$B;function y0e(){if($B)return ZS;$B=1;var e=p0e(),t=IB(),n=m0e(),r=WR();function a(o){return function(i){i=r(i);var s=t(i)?n(i):void 0,c=s?s[0]:i.charAt(0),l=s?e(s,1).join(""):i.slice(1);return c[o]()+l}}return ZS=a,ZS}var GS,FB;function g0e(){if(FB)return GS;FB=1;var e=y0e(),t=e("toUpperCase");return GS=t,GS}var v0e=g0e();const Xm=ot(v0e);function It(e){return function(){return e}}const BB=Math.cos,Zm=Math.sin,ca=Math.sqrt,Gm=Math.PI,Qm=2*Gm,QS=Math.PI,YS=2*QS,cs=1e-6,b0e=YS-cs;function zB(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function w0e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return zB;const n=10**t;return function(r){this._+=r[0];for(let a=1,o=r.length;a<o;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class x0e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?zB:w0e(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,a){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(t,n,r,a,o,i){this._append`C${+t},${+n},${+r},${+a},${this._x1=+o},${this._y1=+i}`}arcTo(t,n,r,a,o){if(t=+t,n=+n,r=+r,a=+a,o=+o,o<0)throw new Error(`negative radius: ${o}`);let i=this._x1,s=this._y1,c=r-t,l=a-n,u=i-t,d=s-n,p=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(p>cs)if(!(Math.abs(d*c-l*u)>cs)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let f=r-i,y=a-s,m=c*c+l*l,v=f*f+y*y,b=Math.sqrt(m),w=Math.sqrt(p),j=o*Math.tan((QS-Math.acos((m+p-v)/(2*b*w)))/2),x=j/w,_=j/b;Math.abs(x-1)>cs&&this._append`L${t+x*u},${n+x*d}`,this._append`A${o},${o},0,0,${+(d*f>u*y)},${this._x1=t+_*c},${this._y1=n+_*l}`}}arc(t,n,r,a,o,i){if(t=+t,n=+n,r=+r,i=!!i,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(a),c=r*Math.sin(a),l=t+s,u=n+c,d=1^i,p=i?a-o:o-a;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>cs||Math.abs(this._y1-u)>cs)&&this._append`L${l},${u}`,r&&(p<0&&(p=p%YS+YS),p>b0e?this._append`A${r},${r},0,1,${d},${t-s},${n-c}A${r},${r},0,1,${d},${this._x1=l},${this._y1=u}`:p>cs&&this._append`A${r},${r},0,${+(p>=QS)},${d},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function JS(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new x0e(t)}function eE(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function VB(e){this._context=e}VB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Ym(e){return new VB(e)}function UB(e){return e[0]}function WB(e){return e[1]}function HB(e,t){var n=It(!0),r=null,a=Ym,o=null,i=JS(s);e=typeof e=="function"?e:e===void 0?UB:It(e),t=typeof t=="function"?t:t===void 0?WB:It(t);function s(c){var l,u=(c=eE(c)).length,d,p=!1,f;for(r==null&&(o=a(f=i())),l=0;l<=u;++l)!(l<u&&n(d=c[l],l,c))===p&&((p=!p)?o.lineStart():o.lineEnd()),p&&o.point(+e(d,l,c),+t(d,l,c));if(f)return o=null,f+""||null}return s.x=function(c){return arguments.length?(e=typeof c=="function"?c:It(+c),s):e},s.y=function(c){return arguments.length?(t=typeof c=="function"?c:It(+c),s):t},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:It(!!c),s):n},s.curve=function(c){return arguments.length?(a=c,r!=null&&(o=a(r)),s):a},s.context=function(c){return arguments.length?(c==null?r=o=null:o=a(r=c),s):r},s}function Jm(e,t,n){var r=null,a=It(!0),o=null,i=Ym,s=null,c=JS(l);e=typeof e=="function"?e:e===void 0?UB:It(+e),t=typeof t=="function"?t:It(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?WB:It(+n);function l(d){var p,f,y,m=(d=eE(d)).length,v,b=!1,w,j=new Array(m),x=new Array(m);for(o==null&&(s=i(w=c())),p=0;p<=m;++p){if(!(p<m&&a(v=d[p],p,d))===b)if(b=!b)f=p,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),y=p-1;y>=f;--y)s.point(j[y],x[y]);s.lineEnd(),s.areaEnd()}b&&(j[p]=+e(v,p,d),x[p]=+t(v,p,d),s.point(r?+r(v,p,d):j[p],n?+n(v,p,d):x[p]))}if(w)return s=null,w+""||null}function u(){return HB().defined(a).curve(i).context(o)}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:It(+d),r=null,l):e},l.x0=function(d){return arguments.length?(e=typeof d=="function"?d:It(+d),l):e},l.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:It(+d),l):r},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:It(+d),n=null,l):t},l.y0=function(d){return arguments.length?(t=typeof d=="function"?d:It(+d),l):t},l.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:It(+d),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(d){return arguments.length?(a=typeof d=="function"?d:It(!!d),l):a},l.curve=function(d){return arguments.length?(i=d,o!=null&&(s=i(o)),l):i},l.context=function(d){return arguments.length?(d==null?o=s=null:s=i(o=d),l):o},l}class qB{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function _0e(e){return new qB(e,!0)}function j0e(e){return new qB(e,!1)}const tE={draw(e,t){const n=ca(t/Gm);e.moveTo(n,0),e.arc(0,0,n,0,Qm)}},S0e={draw(e,t){const n=ca(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},KB=ca(1/3),E0e=KB*2,O0e={draw(e,t){const n=ca(t/E0e),r=n*KB;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},C0e={draw(e,t){const n=ca(t),r=-n/2;e.rect(r,r,n,n)}},N0e=.8908130915292852,XB=Zm(Gm/10)/Zm(7*Gm/10),M0e=Zm(Qm/10)*XB,P0e=-BB(Qm/10)*XB,k0e={draw(e,t){const n=ca(t*N0e),r=M0e*n,a=P0e*n;e.moveTo(0,-n),e.lineTo(r,a);for(let o=1;o<5;++o){const i=Qm*o/5,s=BB(i),c=Zm(i);e.lineTo(c*n,-s*n),e.lineTo(s*r-c*a,c*r+s*a)}e.closePath()}},nE=ca(3),A0e={draw(e,t){const n=-ca(t/(nE*3));e.moveTo(0,n*2),e.lineTo(-nE*n,-n),e.lineTo(nE*n,-n),e.closePath()}},_r=-.5,jr=ca(3)/2,rE=1/ca(12),T0e=(rE/2+1)*3,I0e={draw(e,t){const n=ca(t/T0e),r=n/2,a=n*rE,o=r,i=n*rE+n,s=-o,c=i;e.moveTo(r,a),e.lineTo(o,i),e.lineTo(s,c),e.lineTo(_r*r-jr*a,jr*r+_r*a),e.lineTo(_r*o-jr*i,jr*o+_r*i),e.lineTo(_r*s-jr*c,jr*s+_r*c),e.lineTo(_r*r+jr*a,_r*a-jr*r),e.lineTo(_r*o+jr*i,_r*i-jr*o),e.lineTo(_r*s+jr*c,_r*c-jr*s),e.closePath()}};function R0e(e,t){let n=null,r=JS(a);e=typeof e=="function"?e:It(e||tE),t=typeof t=="function"?t:It(t===void 0?64:+t);function a(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return a.type=function(o){return arguments.length?(e=typeof o=="function"?o:It(o),a):e},a.size=function(o){return arguments.length?(t=typeof o=="function"?o:It(+o),a):t},a.context=function(o){return arguments.length?(n=o??null,a):n},a}function ey(){}function ty(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function ZB(e){this._context=e}ZB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ty(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ty(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function D0e(e){return new ZB(e)}function GB(e){this._context=e}GB.prototype={areaStart:ey,areaEnd:ey,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ty(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function L0e(e){return new GB(e)}function QB(e){this._context=e}QB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:ty(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $0e(e){return new QB(e)}function YB(e){this._context=e}YB.prototype={areaStart:ey,areaEnd:ey,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function F0e(e){return new YB(e)}function JB(e){return e<0?-1:1}function ez(e,t,n){var r=e._x1-e._x0,a=t-e._x1,o=(e._y1-e._y0)/(r||a<0&&-0),i=(n-e._y1)/(a||r<0&&-0),s=(o*a+i*r)/(r+a);return(JB(o)+JB(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(s))||0}function tz(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function aE(e,t,n){var r=e._x0,a=e._y0,o=e._x1,i=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,a+s*t,o-s,i-s*n,o,i)}function ny(e){this._context=e}ny.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:aE(this,this._t0,tz(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,aE(this,tz(this,n=ez(this,e,t)),n);break;default:aE(this,this._t0,n=ez(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function nz(e){this._context=new rz(e)}(nz.prototype=Object.create(ny.prototype)).point=function(e,t){ny.prototype.point.call(this,t,e)};function rz(e){this._context=e}rz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,o){this._context.bezierCurveTo(t,e,r,n,o,a)}};function B0e(e){return new ny(e)}function z0e(e){return new nz(e)}function az(e){this._context=e}az.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=oz(e),a=oz(t),o=0,i=1;i<n;++o,++i)this._context.bezierCurveTo(r[0][o],a[0][o],r[1][o],a[1][o],e[i],t[i]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function oz(e){var t,n=e.length-1,r,a=new Array(n),o=new Array(n),i=new Array(n);for(a[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,o[n-1]=7,i[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/o[t-1],o[t]-=r,i[t]-=r*i[t-1];for(a[n-1]=i[n-1]/o[n-1],t=n-2;t>=0;--t)a[t]=(i[t]-a[t+1])/o[t];for(o[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-a[t+1];return[a,o]}function V0e(e){return new az(e)}function ry(e,t){this._context=e,this._t=t}ry.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function U0e(e){return new ry(e,.5)}function W0e(e){return new ry(e,0)}function H0e(e){return new ry(e,1)}function Hc(e,t){if((i=e.length)>1)for(var n=1,r,a,o=e[t[0]],i,s=o.length;n<i;++n)for(a=o,o=e[t[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function oE(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function q0e(e,t){return e[t]}function K0e(e){const t=[];return t.key=e,t}function X0e(){var e=It([]),t=oE,n=Hc,r=q0e;function a(o){var i=Array.from(e.apply(this,arguments),K0e),s,c=i.length,l=-1,u;for(const d of o)for(s=0,++l;s<c;++s)(i[s][l]=[0,+r(d,i[s].key,l,o)]).data=d;for(s=0,u=eE(t(i));s<c;++s)i[u[s]].index=s;return n(i,u),i}return a.keys=function(o){return arguments.length?(e=typeof o=="function"?o:It(Array.from(o)),a):e},a.value=function(o){return arguments.length?(r=typeof o=="function"?o:It(+o),a):r},a.order=function(o){return arguments.length?(t=o==null?oE:typeof o=="function"?o:It(Array.from(o)),a):t},a.offset=function(o){return arguments.length?(n=o??Hc,a):n},a}function Z0e(e,t){if((r=e.length)>0){for(var n,r,a=0,o=e[0].length,i;a<o;++a){for(i=n=0;n<r;++n)i+=e[n][a][1]||0;if(i)for(n=0;n<r;++n)e[n][a][1]/=i}Hc(e,t)}}function G0e(e,t){if((a=e.length)>0){for(var n=0,r=e[t[0]],a,o=r.length;n<o;++n){for(var i=0,s=0;i<a;++i)s+=e[i][n][1]||0;r[n][1]+=r[n][0]=-s/2}Hc(e,t)}}function Q0e(e,t){if(!(!((i=e.length)>0)||!((o=(a=e[t[0]]).length)>0))){for(var n=0,r=1,a,o,i;r<o;++r){for(var s=0,c=0,l=0;s<i;++s){for(var u=e[t[s]],d=u[r][1]||0,p=u[r-1][1]||0,f=(d-p)/2,y=0;y<s;++y){var m=e[t[y]],v=m[r][1]||0,b=m[r-1][1]||0;f+=v-b}c+=d,l+=f*d}a[r-1][1]+=a[r-1][0]=n,c&&(n-=l/c)}a[r-1][1]+=a[r-1][0]=n,Hc(e,t)}}function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}var Y0e=["type","size","sizeType"];function iE(){return iE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iE.apply(this,arguments)}function iz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function sz(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iz(Object(n),!0).forEach(function(r){J0e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function J0e(e,t,n){return t=ebe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ebe(e){var t=tbe(e,"string");return Ld(t)=="symbol"?t:t+""}function tbe(e,t){if(Ld(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ld(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nbe(e,t){if(e==null)return{};var n=rbe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function rbe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var cz={symbolCircle:tE,symbolCross:S0e,symbolDiamond:O0e,symbolSquare:C0e,symbolStar:k0e,symbolTriangle:A0e,symbolWye:I0e},abe=Math.PI/180,obe=function(e){var t="symbol".concat(Xm(e));return cz[t]||tE},ibe=function(e,t,n){if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*abe;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.pow(Math.tan(r),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},sbe=function(e,t){cz["symbol".concat(Xm(e))]=t},sE=function(e){var t=e.type,n=t===void 0?"circle":t,r=e.size,a=r===void 0?64:r,o=e.sizeType,i=o===void 0?"area":o,s=nbe(e,Y0e),c=sz(sz({},s),{},{type:n,size:a,sizeType:i}),l=function(){var y=obe(n),m=R0e().type(y).size(ibe(a,i,n));return m()},u=c.className,d=c.cx,p=c.cy,f=yt(c,!0);return d===+d&&p===+p&&a===+a?W.createElement("path",iE({},f,{className:xt("recharts-symbols",u),transform:"translate(".concat(d,", ").concat(p,")"),d:l()})):null};sE.registerSymbol=sbe;function qc(e){"@babel/helpers - typeof";return qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qc(e)}function cE(){return cE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cE.apply(this,arguments)}function lz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function cbe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lz(Object(n),!0).forEach(function(r){$d(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function lbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ube(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dz(r.key),r)}}function dbe(e,t,n){return t&&ube(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pbe(e,t,n){return t=ay(t),fbe(e,uz()?Reflect.construct(t,n||[],ay(e).constructor):t.apply(e,n))}function fbe(e,t){if(t&&(qc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hbe(e)}function hbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uz(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uz=function(){return!!e})()}function ay(e){return ay=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ay(e)}function mbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lE(e,t)}function lE(e,t){return lE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},lE(e,t)}function $d(e,t,n){return t=dz(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dz(e){var t=ybe(e,"string");return qc(t)=="symbol"?t:t+""}function ybe(e,t){if(qc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(qc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sr=32,uE=function(e){function t(){return lbe(this,t),pbe(this,t,arguments)}return mbe(t,e),dbe(t,[{key:"renderIcon",value:function(n){var r=this.props.inactiveColor,a=Sr/2,o=Sr/6,i=Sr/3,s=n.inactive?r:n.color;if(n.type==="plainline")return W.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:a,x2:Sr,y2:a,className:"recharts-legend-icon"});if(n.type==="line")return W.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(a,"h").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*i,",").concat(a,`
            H`).concat(Sr,"M").concat(2*i,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(i,",").concat(a),className:"recharts-legend-icon"});if(n.type==="rect")return W.createElement("path",{stroke:"none",fill:s,d:"M0,".concat(Sr/8,"h").concat(Sr,"v").concat(Sr*3/4,"h").concat(-Sr,"z"),className:"recharts-legend-icon"});if(W.isValidElement(n.legendIcon)){var c=cbe({},n);return delete c.legendIcon,W.cloneElement(n.legendIcon,c)}return W.createElement(sE,{fill:s,cx:a,cy:a,size:Sr,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,r=this.props,a=r.payload,o=r.iconSize,i=r.layout,s=r.formatter,c=r.inactiveColor,l={x:0,y:0,width:Sr,height:Sr},u={display:i==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(p,f){var y=p.formatter||s,m=xt($d($d({"recharts-legend-item":!0},"legend-item-".concat(f),!0),"inactive",p.inactive));if(p.type==="none")return null;var v=tt(p.value)?null:p.value;Po(!tt(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=p.inactive?c:p.color;return W.createElement("li",cE({className:m,style:u,key:"legend-item-".concat(f)},Km(n.props,p,f)),W.createElement(VS,{width:o,height:o,viewBox:l,style:d},n.renderIcon(p)),W.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},y?y(v,p,f):v))})}},{key:"render",value:function(){var n=this.props,r=n.payload,a=n.layout,o=n.align;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return W.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(g.PureComponent);$d(uE,"displayName","Legend"),$d(uE,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var dE,pz;function fz(){if(pz)return dE;pz=1;function e(t,n,r,a){for(var o=t.length,i=r+(a?1:-1);a?i--:++i<o;)if(n(t[i],i,t))return i;return-1}return dE=e,dE}var pE,hz;function gbe(){if(hz)return pE;hz=1;function e(t){return t!==t}return pE=e,pE}var fE,mz;function vbe(){if(mz)return fE;mz=1;function e(t,n,r){for(var a=r-1,o=t.length;++a<o;)if(t[a]===n)return a;return-1}return fE=e,fE}var hE,yz;function bbe(){if(yz)return hE;yz=1;var e=fz(),t=gbe(),n=vbe();function r(a,o,i){return o===o?n(a,o,i):e(a,t,i)}return hE=r,hE}var mE,gz;function wbe(){if(gz)return mE;gz=1;var e=bbe();function t(n,r){var a=n==null?0:n.length;return!!a&&e(n,r,0)>-1}return mE=t,mE}var yE,vz;function xbe(){if(vz)return yE;vz=1;function e(t,n,r){for(var a=-1,o=t==null?0:t.length;++a<o;)if(r(n,t[a]))return!0;return!1}return yE=e,yE}var gE,bz;function _be(){if(bz)return gE;bz=1;function e(){}return gE=e,gE}var vE,wz;function jbe(){if(wz)return vE;wz=1;var e=jR(),t=_be(),n=Ow(),r=1/0,a=e&&1/n(new e([,-0]))[1]==r?function(o){return new e(o)}:t;return vE=a,vE}var bE,xz;function Sbe(){if(xz)return bE;xz=1;var e=AI(),t=wbe(),n=xbe(),r=DI(),a=jbe(),o=Ow(),i=200;function s(c,l,u){var d=-1,p=t,f=c.length,y=!0,m=[],v=m;if(u)y=!1,p=n;else if(f>=i){var b=l?null:a(c);if(b)return o(b);y=!1,p=r,v=new e}else v=l?[]:m;e:for(;++d<f;){var w=c[d],j=l?l(w):w;if(w=u||w!==0?w:0,y&&j===j){for(var x=v.length;x--;)if(v[x]===j)continue e;l&&v.push(j),m.push(w)}else p(v,j,u)||(v!==m&&v.push(j),m.push(w))}return m}return bE=s,bE}var wE,_z;function Ebe(){if(_z)return wE;_z=1;var e=_a(),t=Sbe();function n(r,a){return r&&r.length?t(r,e(a,2)):[]}return wE=n,wE}var Obe=Ebe();const jz=ot(Obe);function Sz(e,t,n){return t===!0?jz(e,n):tt(t)?jz(e,t):e}function Kc(e){"@babel/helpers - typeof";return Kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kc(e)}var Cbe=["ref"];function Ez(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ko(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ez(Object(n),!0).forEach(function(r){iy(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ez(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Nbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Nz(r.key),r)}}function Mbe(e,t,n){return t&&Oz(e.prototype,t),n&&Oz(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pbe(e,t,n){return t=oy(t),kbe(e,Cz()?Reflect.construct(t,n||[],oy(e).constructor):t.apply(e,n))}function kbe(e,t){if(t&&(Kc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Abe(e)}function Abe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cz(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Cz=function(){return!!e})()}function oy(e){return oy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oy(e)}function Tbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xE(e,t)}function xE(e,t){return xE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},xE(e,t)}function iy(e,t,n){return t=Nz(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nz(e){var t=Ibe(e,"string");return Kc(t)=="symbol"?t:t+""}function Ibe(e,t){if(Kc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Kc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rbe(e,t){if(e==null)return{};var n=Dbe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Dbe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Lbe(e){return e.value}function $be(e,t){if(W.isValidElement(e))return W.cloneElement(e,t);if(typeof e=="function")return W.createElement(e,t);t.ref;var n=Rbe(t,Cbe);return W.createElement(uE,n)}var Mz=1,Xc=function(e){function t(){var n;Nbe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=Pbe(this,t,[].concat(a)),iy(n,"lastBoundingBox",{width:-1,height:-1}),n}return Tbe(t,e),Mbe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,r=this.getBBox();r?(Math.abs(r.width-this.lastBoundingBox.width)>Mz||Math.abs(r.height-this.lastBoundingBox.height)>Mz)&&(this.lastBoundingBox.width=r.width,this.lastBoundingBox.height=r.height,n&&n(r)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?ko({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var r=this.props,a=r.layout,o=r.align,i=r.verticalAlign,s=r.margin,c=r.chartWidth,l=r.chartHeight,u,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&a==="vertical"){var p=this.getBBoxSnapshot();u={left:((c||0)-p.width)/2}}else u=o==="right"?{right:s&&s.right||0}:{left:s&&s.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var f=this.getBBoxSnapshot();d={top:((l||0)-f.height)/2}}else d=i==="bottom"?{bottom:s&&s.bottom||0}:{top:s&&s.top||0};return ko(ko({},u),d)}},{key:"render",value:function(){var n=this,r=this.props,a=r.content,o=r.width,i=r.height,s=r.wrapperStyle,c=r.payloadUniqBy,l=r.payload,u=ko(ko({position:"absolute",width:o||"auto",height:i||"auto"},this.getDefaultPosition(s)),s);return W.createElement("div",{className:"recharts-legend-wrapper",style:u,ref:function(d){n.wrapperNode=d}},$be(a,ko(ko({},this.props),{},{payload:Sz(l,c,Lbe)})))}}],[{key:"getWithHeight",value:function(n,r){var a=ko(ko({},this.defaultProps),n.props),o=a.layout;return o==="vertical"&&ye(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||r}:null}}])}(g.PureComponent);iy(Xc,"displayName","Legend"),iy(Xc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var _E,Pz;function Fbe(){if(Pz)return _E;Pz=1;var e=Ps(),t=Bp(),n=In(),r=e?e.isConcatSpreadable:void 0;function a(o){return n(o)||t(o)||!!(r&&o&&o[r])}return _E=a,_E}var jE,kz;Ag=function(){if(kz)return jE;kz=1;var e=Mw(),t=Fbe();function n(r,a,o,i,s){var c=-1,l=r.length;for(o||(o=t),s||(s=[]);++c<l;){var u=r[c];a>0&&o(u)?a>1?n(u,a-1,o,i,s):e(s,u):i||(s[s.length]=u)}return s}return jE=n,jE};var SE,Az;function Bbe(){if(Az)return SE;Az=1;function e(t){return function(n,r,a){for(var o=-1,i=Object(n),s=a(n),c=s.length;c--;){var l=s[t?c:++o];if(r(i[l],l,i)===!1)break}return n}}return SE=e,SE}var EE,Tz;TN=function(){if(Tz)return EE;Tz=1;var e=Bbe(),t=e();return EE=t,EE};var OE,Iz;function Rz(){if(Iz)return OE;Iz=1;var e=TN(),t=Ul();function n(r,a){return r&&e(r,a,t)}return OE=n,OE}var CE,Dz;function zbe(){if(Dz)return CE;Dz=1;var e=Ni();function t(n,r){return function(a,o){if(a==null)return a;if(!e(a))return n(a,o);for(var i=a.length,s=r?i:-1,c=Object(a);(r?s--:++s<i)&&o(c[s],s,c)!==!1;);return a}}return CE=t,CE}var NE,Lz;function ME(){if(Lz)return NE;Lz=1;var e=Rz(),t=zbe(),n=t(e);return NE=n,NE}var PE,$z;function Fz(){if($z)return PE;$z=1;var e=ME(),t=Ni();function n(r,a){var o=-1,i=t(r)?Array(r.length):[];return e(r,function(s,c,l){i[++o]=a(s,c,l)}),i}return PE=n,PE}var kE,Bz;function Vbe(){if(Bz)return kE;Bz=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return kE=e,kE}var AE,zz;function Ube(){if(zz)return AE;zz=1;var e=Ys();function t(n,r){if(n!==r){var a=n!==void 0,o=n===null,i=n===n,s=e(n),c=r!==void 0,l=r===null,u=r===r,d=e(r);if(!l&&!d&&!s&&n>r||s&&c&&u&&!l&&!d||o&&c&&u||!a&&u||!i)return 1;if(!o&&!s&&!d&&n<r||d&&a&&i&&!o&&!s||l&&a&&i||!c&&i||!u)return-1}return 0}return AE=t,AE}var TE,Vz;function Wbe(){if(Vz)return TE;Vz=1;var e=Ube();function t(n,r,a){for(var o=-1,i=n.criteria,s=r.criteria,c=i.length,l=a.length;++o<c;){var u=e(i[o],s[o]);if(u){if(o>=l)return u;var d=a[o];return u*(d=="desc"?-1:1)}}return n.index-r.index}return TE=t,TE}var IE,Uz;function Hbe(){if(Uz)return IE;Uz=1;var e=Rl(),t=ql(),n=_a(),r=Fz(),a=Vbe(),o=Pv(),i=Wbe(),s=Js(),c=In();function l(u,d,p){d.length?d=e(d,function(m){return c(m)?function(v){return t(v,m.length===1?m[0]:m)}:m}):d=[s];var f=-1;d=e(d,o(n));var y=r(u,function(m,v,b){var w=e(d,function(j){return j(m)});return{criteria:w,index:++f,value:m}});return a(y,function(m,v){return i(m,v,p)})}return IE=l,IE}var RE,Wz;zN=function(){if(Wz)return RE;Wz=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return RE=e,RE};var DE,Hz;AN=function(){if(Hz)return DE;Hz=1;var e=zN(),t=Math.max;function n(r,a,o){return a=t(a===void 0?r.length-1:a,0),function(){for(var i=arguments,s=-1,c=t(i.length-a,0),l=Array(c);++s<c;)l[s]=i[a+s];s=-1;for(var u=Array(a+1);++s<a;)u[s]=i[s];return u[a]=o(l),e(r,this,u)}}return DE=n,DE};var LE,qz;function qbe(){if(qz)return LE;qz=1;function e(t){return function(){return t}}return LE=e,LE}var $E,Kz;function Kbe(){if(Kz)return $E;Kz=1;var e=qbe(),t=sD(),n=Js(),r=t?function(a,o){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:n;return $E=r,$E}var FE,Xz;function Xbe(){if(Xz)return FE;Xz=1;var e=800,t=16,n=Date.now;function r(a){var o=0,i=0;return function(){var s=n(),c=t-(s-i);if(i=s,c>0){if(++o>=e)return arguments[0]}else o=0;return a.apply(void 0,arguments)}}return FE=r,FE}var BE,Zz;kN=function(){if(Zz)return BE;Zz=1;var e=Kbe(),t=Xbe(),n=t(e);return BE=n,BE};var zE,Gz;IN=function(){if(Gz)return zE;Gz=1;var e=Js(),t=AN(),n=kN();function r(a,o){return n(t(a,o,e),a+"")}return zE=r,zE};var VE,Qz;function Zbe(){if(Qz)return VE;Qz=1;var e=Ag(),t=Hbe(),n=IN(),r=Es(),a=n(function(o,i){if(o==null)return[];var s=i.length;return s>1&&r(o,i[0],i[1])?i=[]:s>2&&r(i[0],i[1],i[2])&&(i=[i[0]]),t(o,e(i,1),[])});return VE=a,VE}var Gbe=Zbe();const UE=ot(Gbe);function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}function WE(){return WE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},WE.apply(this,arguments)}function Qbe(e,t){return twe(e)||ewe(e,t)||Jbe(e,t)||Ybe()}function Ybe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jbe(e,t){if(e){if(typeof e=="string")return Yz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yz(e,t)}}function Yz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ewe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function twe(e){if(Array.isArray(e))return e}function Jz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function HE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Jz(Object(n),!0).forEach(function(r){nwe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nwe(e,t,n){return t=rwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rwe(e){var t=awe(e,"string");return Fd(t)=="symbol"?t:t+""}function awe(e,t){if(Fd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Fd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function owe(e){return Array.isArray(e)&&sn(e[0])&&sn(e[1])?e.join(" ~ "):e}var iwe=function(e){var t=e.separator,n=t===void 0?" : ":t,r=e.contentStyle,a=r===void 0?{}:r,o=e.itemStyle,i=o===void 0?{}:o,s=e.labelStyle,c=s===void 0?{}:s,l=e.payload,u=e.formatter,d=e.itemSorter,p=e.wrapperClassName,f=e.labelClassName,y=e.label,m=e.labelFormatter,v=e.accessibilityLayer,b=v===void 0?!1:v,w=function(){if(l&&l.length){var N={padding:0,margin:0},P=(d?UE(l,d):l).map(function(I,k){if(I.type==="none")return null;var C=HE({display:"block",paddingTop:4,paddingBottom:4,color:I.color||"#000"},i),T=I.formatter||u||owe,A=I.value,D=I.name,L=A,R=D;if(T&&L!=null&&R!=null){var B=T(A,D,I,k,l);if(Array.isArray(B)){var z=Qbe(B,2);L=z[0],R=z[1]}else L=B}return W.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(k),style:C},sn(R)?W.createElement("span",{className:"recharts-tooltip-item-name"},R):null,sn(R)?W.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,W.createElement("span",{className:"recharts-tooltip-item-value"},L),W.createElement("span",{className:"recharts-tooltip-item-unit"},I.unit||""))});return W.createElement("ul",{className:"recharts-tooltip-item-list",style:N},P)}return null},j=HE({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),x=HE({margin:0},c),_=!gt(y),S=_?y:"",E=xt("recharts-default-tooltip",p),O=xt("recharts-tooltip-label",f);_&&m&&l!==void 0&&l!==null&&(S=m(y,l));var M=b?{role:"status","aria-live":"assertive"}:{};return W.createElement("div",WE({className:E,style:j},M),W.createElement("p",{className:O,style:x},W.isValidElement(S)?S:"".concat(S)),w())};function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function sy(e,t,n){return t=swe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function swe(e){var t=cwe(e,"string");return Bd(t)=="symbol"?t:t+""}function cwe(e,t){if(Bd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Bd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zd="recharts-tooltip-wrapper",lwe={visibility:"hidden"};function uwe(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return xt(zd,sy(sy(sy(sy({},"".concat(zd,"-right"),ye(n)&&t&&ye(t.x)&&n>=t.x),"".concat(zd,"-left"),ye(n)&&t&&ye(t.x)&&n<t.x),"".concat(zd,"-bottom"),ye(r)&&t&&ye(t.y)&&r>=t.y),"".concat(zd,"-top"),ye(r)&&t&&ye(t.y)&&r<t.y))}function e7(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,a=e.offsetTopLeft,o=e.position,i=e.reverseDirection,s=e.tooltipDimension,c=e.viewBox,l=e.viewBoxDimension;if(o&&ye(o[r]))return o[r];var u=n[r]-s-a,d=n[r]+a;if(t[r])return i[r]?u:d;if(i[r]){var p=u,f=c[r];return p<f?Math.max(d,c[r]):Math.max(u,c[r])}var y=d+s,m=c[r]+l;return y>m?Math.max(u,c[r]):Math.max(d,c[r])}function dwe(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function pwe(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,a=e.position,o=e.reverseDirection,i=e.tooltipBox,s=e.useTranslate3d,c=e.viewBox,l,u,d;return i.height>0&&i.width>0&&n?(u=e7({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),d=e7({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:o,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),l=dwe({translateX:u,translateY:d,useTranslate3d:s})):l=lwe,{cssProperties:l,cssClasses:uwe({translateX:u,translateY:d,coordinate:n})}}function Zc(e){"@babel/helpers - typeof";return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zc(e)}function t7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function n7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?t7(Object(n),!0).forEach(function(r){KE(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function fwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hwe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a7(r.key),r)}}function mwe(e,t,n){return t&&hwe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ywe(e,t,n){return t=cy(t),gwe(e,r7()?Reflect.construct(t,n||[],cy(e).constructor):t.apply(e,n))}function gwe(e,t){if(t&&(Zc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vwe(e)}function vwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(r7=function(){return!!e})()}function cy(e){return cy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cy(e)}function bwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qE(e,t)}function qE(e,t){return qE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},qE(e,t)}function KE(e,t,n){return t=a7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a7(e){var t=wwe(e,"string");return Zc(t)=="symbol"?t:t+""}function wwe(e,t){if(Zc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Zc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o7=1,xwe=function(e){function t(){var n;fwe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=ywe(this,t,[].concat(a)),KE(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),KE(n,"handleKeyDown",function(i){if(i.key==="Escape"){var s,c,l,u;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&s!==void 0?s:0,y:(l=(u=n.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0}})}}),n}return bwe(t,e),mwe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>o7||Math.abs(n.height-this.state.lastBoundingBox.height)>o7)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,r;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.children,l=r.coordinate,u=r.hasPayload,d=r.isAnimationActive,p=r.offset,f=r.position,y=r.reverseDirection,m=r.useTranslate3d,v=r.viewBox,b=r.wrapperStyle,w=pwe({allowEscapeViewBox:o,coordinate:l,offsetTopLeft:p,position:f,reverseDirection:y,tooltipBox:this.state.lastBoundingBox,useTranslate3d:m,viewBox:v}),j=w.cssClasses,x=w.cssProperties,_=n7(n7({transition:d&&a?"transform ".concat(i,"ms ").concat(s):void 0},x),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&u?"visible":"hidden",position:"absolute",top:0,left:0},b);return W.createElement("div",{tabIndex:-1,className:j,style:_,ref:function(S){n.wrapperNode=S}},c)}}])}(g.PureComponent),_we=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},gi={isSsr:_we(),get:function(e){return gi[e]},set:function(e,t){if(typeof e=="string")gi[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(r){gi[r]=e[r]})}}};function Gc(e){"@babel/helpers - typeof";return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gc(e)}function i7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function s7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(n),!0).forEach(function(r){ZE(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function jwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Swe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l7(r.key),r)}}function Ewe(e,t,n){return t&&Swe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Owe(e,t,n){return t=ly(t),Cwe(e,c7()?Reflect.construct(t,n||[],ly(e).constructor):t.apply(e,n))}function Cwe(e,t){if(t&&(Gc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nwe(e)}function Nwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(c7=function(){return!!e})()}function ly(e){return ly=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ly(e)}function Mwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XE(e,t)}function XE(e,t){return XE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},XE(e,t)}function ZE(e,t,n){return t=l7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l7(e){var t=Pwe(e,"string");return Gc(t)=="symbol"?t:t+""}function Pwe(e,t){if(Gc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Gc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kwe(e){return e.dataKey}function Awe(e,t){return W.isValidElement(e)?W.cloneElement(e,t):typeof e=="function"?W.createElement(e,t):W.createElement(iwe,t)}var Da=function(e){function t(){return jwe(this,t),Owe(this,t,arguments)}return Mwe(t,e),Ewe(t,[{key:"render",value:function(){var n=this,r=this.props,a=r.active,o=r.allowEscapeViewBox,i=r.animationDuration,s=r.animationEasing,c=r.content,l=r.coordinate,u=r.filterNull,d=r.isAnimationActive,p=r.offset,f=r.payload,y=r.payloadUniqBy,m=r.position,v=r.reverseDirection,b=r.useTranslate3d,w=r.viewBox,j=r.wrapperStyle,x=f??[];u&&x.length&&(x=Sz(f.filter(function(S){return S.value!=null&&(S.hide!==!0||n.props.includeHidden)}),y,kwe));var _=x.length>0;return W.createElement(xwe,{allowEscapeViewBox:o,animationDuration:i,animationEasing:s,isAnimationActive:d,active:a,coordinate:l,hasPayload:_,offset:p,position:m,reverseDirection:v,useTranslate3d:b,viewBox:w,wrapperStyle:j},Awe(c,s7(s7({},this.props),{},{payload:x})))}}])}(g.PureComponent);ZE(Da,"displayName","Tooltip"),ZE(Da,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!gi.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var GE,u7;function Twe(){if(u7)return GE;u7=1;var e=Ar(),t=function(){return e.Date.now()};return GE=t,GE}var QE,d7;$N=function(){if(d7)return QE;d7=1;var e=Tr(),t=Twe(),n=B$(),r="Expected a function",a=Math.max,o=Math.min;function i(s,c,l){var u,d,p,f,y,m,v=0,b=!1,w=!1,j=!0;if(typeof s!="function")throw new TypeError(r);c=n(c)||0,e(l)&&(b=!!l.leading,w="maxWait"in l,p=w?a(n(l.maxWait)||0,c):p,j="trailing"in l?!!l.trailing:j);function x(k){var C=u,T=d;return u=d=void 0,v=k,f=s.apply(T,C),f}function _(k){return v=k,y=setTimeout(O,c),b?x(k):f}function S(k){var C=k-m,T=k-v,A=c-C;return w?o(A,p-T):A}function E(k){var C=k-m,T=k-v;return m===void 0||C>=c||C<0||w&&T>=p}function O(){var k=t();if(E(k))return M(k);y=setTimeout(O,S(k))}function M(k){return y=void 0,j&&u?x(k):(u=d=void 0,f)}function N(){y!==void 0&&clearTimeout(y),v=0,u=m=d=y=void 0}function P(){return y===void 0?f:M(t())}function I(){var k=t(),C=E(k);if(u=arguments,d=this,m=k,C){if(y===void 0)return _(m);if(w)return clearTimeout(y),y=setTimeout(O,c),x(m)}return y===void 0&&(y=setTimeout(O,c)),f}return I.cancel=N,I.flush=P,I}return QE=i,QE};var YE,p7;function Iwe(){if(p7)return YE;p7=1;var e=$N(),t=Tr(),n="Expected a function";function r(a,o,i){var s=!0,c=!0;if(typeof a!="function")throw new TypeError(n);return t(i)&&(s="leading"in i?!!i.leading:s,c="trailing"in i?!!i.trailing:c),e(a,o,{leading:s,maxWait:o,trailing:c})}return YE=r,YE}var Rwe=Iwe();Rg=ot(Rwe);function Vd(e){"@babel/helpers - typeof";return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vd(e)}function f7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function uy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f7(Object(n),!0).forEach(function(r){Dwe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Dwe(e,t,n){return t=Lwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lwe(e){var t=$we(e,"string");return Vd(t)=="symbol"?t:t+""}function $we(e,t){if(Vd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Vd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fwe(e,t){return Uwe(e)||Vwe(e,t)||zwe(e,t)||Bwe()}function Bwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zwe(e,t){if(e){if(typeof e=="string")return h7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h7(e,t)}}function h7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vwe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function Uwe(e){if(Array.isArray(e))return e}var Wwe=g.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,a=r===void 0?{width:-1,height:-1}:r,o=e.width,i=o===void 0?"100%":o,s=e.height,c=s===void 0?"100%":s,l=e.minWidth,u=l===void 0?0:l,d=e.minHeight,p=e.maxHeight,f=e.children,y=e.debounce,m=y===void 0?0:y,v=e.id,b=e.className,w=e.onResize,j=e.style,x=j===void 0?{}:j,_=g.useRef(null),S=g.useRef();S.current=w,g.useImperativeHandle(t,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var E=g.useState({containerWidth:a.width,containerHeight:a.height}),O=Fwe(E,2),M=O[0],N=O[1],P=g.useCallback(function(k,C){N(function(T){var A=Math.round(k),D=Math.round(C);return T.containerWidth===A&&T.containerHeight===D?T:{containerWidth:A,containerHeight:D}})},[]);g.useEffect(function(){var k=function(L){var R,B=L[0].contentRect,z=B.width,$=B.height;P(z,$),(R=S.current)===null||R===void 0||R.call(S,z,$)};m>0&&(k=Rg(k,m,{trailing:!0,leading:!1}));var C=new ResizeObserver(k),T=_.current.getBoundingClientRect(),A=T.width,D=T.height;return P(A,D),C.observe(_.current),function(){C.disconnect()}},[P,m]);var I=g.useMemo(function(){var k=M.containerWidth,C=M.containerHeight;if(k<0||C<0)return null;Po(is(i)||is(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),Po(!n||n>0,"The aspect(%s) must be greater than zero.",n);var T=is(i)?k:i,A=is(c)?C:c;n&&n>0&&(T?A=T/n:A&&(T=A*n),p&&A>p&&(A=p)),Po(T>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,T,A,i,c,u,d,n);var D=!Array.isArray(f)&&Mo(f.type).endsWith("Chart");return W.Children.map(f,function(L){return W.isValidElement(L)?g.cloneElement(L,uy({width:T,height:A},D?{style:uy({height:"100%",width:"100%",maxHeight:A,maxWidth:T},L.props.style)}:{})):L})},[n,f,c,p,d,u,M,i]);return W.createElement("div",{id:v?"".concat(v):void 0,className:xt("recharts-responsive-container",b),style:uy(uy({},x),{},{width:i,height:c,minWidth:u,minHeight:d,maxHeight:p}),ref:_},I)}),m7=function(e){return null};m7.displayName="Cell";function Ud(e){"@babel/helpers - typeof";return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ud(e)}function y7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function JE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y7(Object(n),!0).forEach(function(r){Hwe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Hwe(e,t,n){return t=qwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qwe(e){var t=Kwe(e,"string");return Ud(t)=="symbol"?t:t+""}function Kwe(e,t){if(Ud(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ud(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qc={widthCache:{},cacheCount:0},Xwe=2e3,Zwe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},g7="recharts_measurement_span";function Gwe(e){var t=JE({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var Wd=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||gi.isSsr)return{width:0,height:0};var n=Gwe(t),r=JSON.stringify({text:e,copyStyle:n});if(Qc.widthCache[r])return Qc.widthCache[r];try{var a=document.getElementById(g7);a||(a=document.createElement("span"),a.setAttribute("id",g7),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=JE(JE({},Zwe),n);Object.assign(a.style,o),a.textContent="".concat(e);var i=a.getBoundingClientRect(),s={width:i.width,height:i.height};return Qc.widthCache[r]=s,++Qc.cacheCount>Xwe&&(Qc.cacheCount=0,Qc.widthCache={}),s}catch{return{width:0,height:0}}},Qwe=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hd(e)}function dy(e,t){return txe(e)||exe(e,t)||Jwe(e,t)||Ywe()}function Ywe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jwe(e,t){if(e){if(typeof e=="string")return v7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v7(e,t)}}function v7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function exe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function txe(e){if(Array.isArray(e))return e}function nxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,axe(r.key),r)}}function rxe(e,t,n){return t&&b7(e.prototype,t),n&&b7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function axe(e){var t=oxe(e,"string");return Hd(t)=="symbol"?t:t+""}function oxe(e,t){if(Hd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Hd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var w7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,x7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ixe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,sxe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,_7={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},cxe=Object.keys(_7),Yc="NaN";function lxe(e,t){return e*_7[t]}var py=function(){function e(t,n){nxe(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!ixe.test(n)&&(this.num=NaN,this.unit=""),cxe.includes(n)&&(this.num=lxe(t,n),this.unit="px")}return rxe(e,[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(t){var n,r=(n=sxe.exec(t))!==null&&n!==void 0?n:[],a=dy(r,3),o=a[1],i=a[2];return new e(parseFloat(o),i??"")}}])}();function j7(e){if(e.includes(Yc))return Yc;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=w7.exec(t))!==null&&n!==void 0?n:[],a=dy(r,4),o=a[1],i=a[2],s=a[3],c=py.parse(o??""),l=py.parse(s??""),u=i==="*"?c.multiply(l):c.divide(l);if(u.isNaN())return Yc;t=t.replace(w7,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,p=(d=x7.exec(t))!==null&&d!==void 0?d:[],f=dy(p,4),y=f[1],m=f[2],v=f[3],b=py.parse(y??""),w=py.parse(v??""),j=m==="+"?b.add(w):b.subtract(w);if(j.isNaN())return Yc;t=t.replace(x7,j.toString())}return t}var S7=/\(([^()]*)\)/;function uxe(e){for(var t=e;t.includes("(");){var n=S7.exec(t),r=dy(n,2),a=r[1];t=t.replace(S7,j7(a))}return t}function dxe(e){var t=e.replace(/\s+/g,"");return t=uxe(t),t=j7(t),t}function pxe(e){try{return dxe(e)}catch{return Yc}}function eO(e){var t=pxe(e.slice(5,-1));return t===Yc?"":t}var fxe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],hxe=["dx","dy","angle","className","breakAll"];function tO(){return tO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tO.apply(this,arguments)}function E7(e,t){if(e==null)return{};var n=mxe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mxe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function O7(e,t){return bxe(e)||vxe(e,t)||gxe(e,t)||yxe()}function yxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gxe(e,t){if(e){if(typeof e=="string")return C7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C7(e,t)}}function C7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vxe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function bxe(e){if(Array.isArray(e))return e}var N7=/[ \f\n\r\t\v\u2028\u2029]+/,M7=function(e){var t=e.children,n=e.breakAll,r=e.style;try{var a=[];gt(t)||(n?a=t.toString().split(""):a=t.toString().split(N7));var o=a.map(function(s){return{word:s,width:Wd(s,r).width}}),i=n?0:Wd("\xA0",r).width;return{wordsWithComputedWidth:o,spaceWidth:i}}catch{return null}},wxe=function(e,t,n,r,a){var o=e.maxLines,i=e.children,s=e.style,c=e.breakAll,l=ye(o),u=i,d=function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return k.reduce(function(C,T){var A=T.word,D=T.width,L=C[C.length-1];if(L&&(r==null||a||L.width+D+n<Number(r)))L.words.push(A),L.width+=D+n;else{var R={words:[A],width:D};C.push(R)}return C},[])},p=d(t),f=function(k){return k.reduce(function(C,T){return C.width>T.width?C:T})};if(!l)return p;for(var y="\u2026",m=function(k){var C=u.slice(0,k),T=M7({breakAll:c,style:s,children:C+y}).wordsWithComputedWidth,A=d(T),D=A.length>o||f(A).width>Number(r);return[D,A]},v=0,b=u.length-1,w=0,j;v<=b&&w<=u.length-1;){var x=Math.floor((v+b)/2),_=x-1,S=m(_),E=O7(S,2),O=E[0],M=E[1],N=m(x),P=O7(N,1),I=P[0];if(!O&&!I&&(v=x+1),O&&I&&(b=x-1),!O&&I){j=M;break}w++}return j||p},P7=function(e){var t=gt(e)?[]:e.toString().split(N7);return[{words:t}]},xxe=function(e){var t=e.width,n=e.scaleToFit,r=e.children,a=e.style,o=e.breakAll,i=e.maxLines;if((t||n)&&!gi.isSsr){var s,c,l=M7({breakAll:o,children:r,style:a});if(l){var u=l.wordsWithComputedWidth,d=l.spaceWidth;s=u,c=d}else return P7(r);return wxe({breakAll:o,children:r,maxLines:i,style:a},s,c,t,n)}return P7(r)},k7="#808080",fy=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.lineHeight,i=o===void 0?"1em":o,s=e.capHeight,c=s===void 0?"0.71em":s,l=e.scaleToFit,u=l===void 0?!1:l,d=e.textAnchor,p=d===void 0?"start":d,f=e.verticalAnchor,y=f===void 0?"end":f,m=e.fill,v=m===void 0?k7:m,b=E7(e,fxe),w=g.useMemo(function(){return xxe({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:u,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,u,b.style,b.width]),j=b.dx,x=b.dy,_=b.angle,S=b.className,E=b.breakAll,O=E7(b,hxe);if(!sn(n)||!sn(a))return null;var M=n+(ye(j)?j:0),N=a+(ye(x)?x:0),P;switch(y){case"start":P=eO("calc(".concat(c,")"));break;case"middle":P=eO("calc(".concat((w.length-1)/2," * -").concat(i," + (").concat(c," / 2))"));break;default:P=eO("calc(".concat(w.length-1," * -").concat(i,")"));break}var I=[];if(u){var k=w[0].width,C=b.width;I.push("scale(".concat((ye(C)?C/k:1)/k,")"))}return _&&I.push("rotate(".concat(_,", ").concat(M,", ").concat(N,")")),I.length&&(O.transform=I.join(" ")),W.createElement("text",tO({},yt(O,!0),{x:M,y:N,className:xt("recharts-text",S),textAnchor:p,fill:v.includes("url")?k7:v}),w.map(function(T,A){var D=T.words.join(E?"":" ");return W.createElement("tspan",{x:M,dy:A===0?P:i,key:"".concat(D,"-").concat(A)},D)}))};function vi(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function _xe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function nO(e){let t,n,r;e.length!==2?(t=vi,n=(s,c)=>vi(e(s),c),r=(s,c)=>e(s)-c):(t=e===vi||e===_xe?e:jxe,n=e,r=e);function a(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<0?l=d+1:u=d}while(l<u)}return l}function o(s,c,l=0,u=s.length){if(l<u){if(t(c,c)!==0)return u;do{const d=l+u>>>1;n(s[d],c)<=0?l=d+1:u=d}while(l<u)}return l}function i(s,c,l=0,u=s.length){const d=a(s,c,l,u-1);return d>l&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:a,center:i,right:o}}function jxe(){return 0}function A7(e){return e===null?NaN:+e}function*Sxe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const Exe=nO(vi),qd=Exe.right;nO(A7).center;class T7 extends Map{constructor(t,n=Nxe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,a]of t)this.set(r,a)}get(t){return super.get(I7(this,t))}has(t){return super.has(I7(this,t))}set(t,n){return super.set(Oxe(this,t),n)}delete(t){return super.delete(Cxe(this,t))}}function I7({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Oxe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Cxe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function Nxe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Mxe(e=vi){if(e===vi)return R7;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function R7(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Pxe=Math.sqrt(50),kxe=Math.sqrt(10),Axe=Math.sqrt(2);function hy(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),o=r/Math.pow(10,a),i=o>=Pxe?10:o>=kxe?5:o>=Axe?2:1;let s,c,l;return a<0?(l=Math.pow(10,-a)/i,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=Math.pow(10,a)*i,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?hy(e,t,n*2):[s,c,l]}function rO(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,o,i]=r?hy(t,e,n):hy(e,t,n);if(!(o>=a))return[];const s=o-a+1,c=new Array(s);if(r)if(i<0)for(let l=0;l<s;++l)c[l]=(o-l)/-i;else for(let l=0;l<s;++l)c[l]=(o-l)*i;else if(i<0)for(let l=0;l<s;++l)c[l]=(a+l)/-i;else for(let l=0;l<s;++l)c[l]=(a+l)*i;return c}function aO(e,t,n){return t=+t,e=+e,n=+n,hy(e,t,n)[2]}function oO(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?aO(t,e,n):aO(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function D7(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function L7(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function $7(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=a===void 0?R7:Mxe(a);r>n;){if(r-n>600){const c=r-n+1,l=t-n+1,u=Math.log(c),d=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*d*(c-d)/c)*(l-c/2<0?-1:1),f=Math.max(n,Math.floor(t-l*d/c+p)),y=Math.min(r,Math.floor(t+(c-l)*d/c+p));$7(e,t,f,y,a)}const o=e[t];let i=n,s=r;for(Kd(e,n,t),a(e[r],o)>0&&Kd(e,n,r);i<s;){for(Kd(e,i,s),++i,--s;a(e[i],o)<0;)++i;for(;a(e[s],o)>0;)--s}a(e[n],o)===0?Kd(e,n,s):(++s,Kd(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Kd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Txe(e,t,n){if(e=Float64Array.from(Sxe(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return L7(e);if(t>=1)return D7(e);var r,a=(r-1)*t,o=Math.floor(a),i=D7($7(e,o).subarray(0,o+1)),s=L7(e.subarray(o+1));return i+(s-i)*(a-o)}}function Ixe(e,t,n=A7){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,o=Math.floor(a),i=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return i+(s-i)*(a-o)}}function Rxe(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(a);++r<a;)o[r]=e+r*n;return o}function Er(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ao(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const iO=Symbol("implicit");function sO(){var e=new T7,t=[],n=[],r=iO;function a(o){let i=e.get(o);if(i===void 0){if(r!==iO)return r;e.set(o,i=t.push(o)-1)}return n[i%n.length]}return a.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new T7;for(const i of o)e.has(i)||e.set(i,t.push(i)-1);return a},a.range=function(o){return arguments.length?(n=Array.from(o),a):n.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return sO(t,n).unknown(r)},Er.apply(a,arguments),a}function Xd(){var e=sO().unknown(void 0),t=e.domain,n=e.range,r=0,a=1,o,i,s=!1,c=0,l=0,u=.5;delete e.unknown;function d(){var p=t().length,f=a<r,y=f?a:r,m=f?r:a;o=(m-y)/Math.max(1,p-c+l*2),s&&(o=Math.floor(o)),y+=(m-y-o*(p-c))*u,i=o*(1-c),s&&(y=Math.round(y),i=Math.round(i));var v=Rxe(p).map(function(b){return y+o*b});return n(f?v.reverse():v)}return e.domain=function(p){return arguments.length?(t(p),d()):t()},e.range=function(p){return arguments.length?([r,a]=p,r=+r,a=+a,d()):[r,a]},e.rangeRound=function(p){return[r,a]=p,r=+r,a=+a,s=!0,d()},e.bandwidth=function(){return i},e.step=function(){return o},e.round=function(p){return arguments.length?(s=!!p,d()):s},e.padding=function(p){return arguments.length?(c=Math.min(1,l=+p),d()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),d()):c},e.paddingOuter=function(p){return arguments.length?(l=+p,d()):l},e.align=function(p){return arguments.length?(u=Math.max(0,Math.min(1,p)),d()):u},e.copy=function(){return Xd(t(),[r,a]).round(s).paddingInner(c).paddingOuter(l).align(u)},Er.apply(d(),arguments)}function F7(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return F7(t())},e}function Zd(){return F7(Xd.apply(null,arguments).paddingInner(1))}function Dxe(e){return function(){return e}}function my(e){return+e}var B7=[0,1];function Bn(e){return e}function cO(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Dxe(isNaN(t)?NaN:.5)}function Lxe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function $xe(e,t,n){var r=e[0],a=e[1],o=t[0],i=t[1];return a<r?(r=cO(a,r),o=n(i,o)):(r=cO(r,a),o=n(o,i)),function(s){return o(r(s))}}function Fxe(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),o=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)a[i]=cO(e[i],e[i+1]),o[i]=n(t[i],t[i+1]);return function(s){var c=qd(e,s,1,r)-1;return o[c](a[c](s))}}function Gd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function yy(){var e=B7,t=B7,n=rc,r,a,o,i=Bn,s,c,l;function u(){var p=Math.min(e.length,t.length);return i!==Bn&&(i=Lxe(e[0],e[p-1])),s=p>2?Fxe:$xe,c=l=null,d}function d(p){return p==null||isNaN(p=+p)?o:(c||(c=s(e.map(r),t,n)))(r(i(p)))}return d.invert=function(p){return i(a((l||(l=s(t,e.map(r),Wr)))(p)))},d.domain=function(p){return arguments.length?(e=Array.from(p,my),u()):e.slice()},d.range=function(p){return arguments.length?(t=Array.from(p),u()):t.slice()},d.rangeRound=function(p){return t=Array.from(p),n=c1,u()},d.clamp=function(p){return arguments.length?(i=p?!0:Bn,u()):i!==Bn},d.interpolate=function(p){return arguments.length?(n=p,u()):n},d.unknown=function(p){return arguments.length?(o=p,d):o},function(p,f){return r=p,a=f,u()}}function lO(){return yy()(Bn,Bn)}function Bxe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function gy(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Jc(e){return e=gy(Math.abs(e)),e?e[1]:NaN}function zxe(e,t){return function(n,r){for(var a=n.length,o=[],i=0,s=e[0],c=0;a>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(n.substring(a-=s,a+s)),!((c+=s+1)>r));)s=e[i=(i+1)%e.length];return o.reverse().join(t)}}function Vxe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Uxe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Qd(e){if(!(t=Uxe.exec(e)))throw new Error("invalid format: "+e);var t;return new uO({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Qd.prototype=uO.prototype;function uO(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}uO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Wxe(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var z7;function Hxe(e,t){var n=gy(e,t);if(!n)return e+"";var r=n[0],a=n[1],o=a-(z7=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+gy(e,Math.max(0,t+o-1))[0]}function V7(e,t){var n=gy(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const U7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Bxe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>V7(e*100,t),r:V7,s:Hxe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function W7(e){return e}var H7=Array.prototype.map,q7=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function qxe(e){var t=e.grouping===void 0||e.thousands===void 0?W7:zxe(H7.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?W7:Vxe(H7.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(d){d=Qd(d);var p=d.fill,f=d.align,y=d.sign,m=d.symbol,v=d.zero,b=d.width,w=d.comma,j=d.precision,x=d.trim,_=d.type;_==="n"?(w=!0,_="g"):U7[_]||(j===void 0&&(j=12),x=!0,_="g"),(v||p==="0"&&f==="=")&&(v=!0,p="0",f="=");var S=m==="$"?n:m==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",E=m==="$"?r:/[%p]/.test(_)?i:"",O=U7[_],M=/[defgprs%]/.test(_);j=j===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,j)):Math.max(0,Math.min(20,j));function N(P){var I=S,k=E,C,T,A;if(_==="c")k=O(P)+k,P="";else{P=+P;var D=P<0||1/P<0;if(P=isNaN(P)?c:O(Math.abs(P),j),x&&(P=Wxe(P)),D&&+P==0&&y!=="+"&&(D=!1),I=(D?y==="("?y:s:y==="-"||y==="("?"":y)+I,k=(_==="s"?q7[8+z7/3]:"")+k+(D&&y==="("?")":""),M){for(C=-1,T=P.length;++C<T;)if(A=P.charCodeAt(C),48>A||A>57){k=(A===46?a+P.slice(C+1):P.slice(C))+k,P=P.slice(0,C);break}}}w&&!v&&(P=t(P,1/0));var L=I.length+P.length+k.length,R=L<b?new Array(b-L+1).join(p):"";switch(w&&v&&(P=t(R+P,R.length?b-k.length:1/0),R=""),f){case"<":P=I+P+k+R;break;case"=":P=I+R+P+k;break;case"^":P=R.slice(0,L=R.length>>1)+I+P+k+R.slice(L);break;default:P=R+I+P+k;break}return o(P)}return N.toString=function(){return d+""},N}function u(d,p){var f=l((d=Qd(d),d.type="f",d)),y=Math.max(-8,Math.min(8,Math.floor(Jc(p)/3)))*3,m=Math.pow(10,-y),v=q7[8+y/3];return function(b){return f(m*b)+v}}return{format:l,formatPrefix:u}}var vy,dO,K7;Kxe({thousands:",",grouping:[3],currency:["$",""]});function Kxe(e){return vy=qxe(e),dO=vy.format,K7=vy.formatPrefix,vy}function Xxe(e){return Math.max(0,-Jc(Math.abs(e)))}function Zxe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Jc(t)/3)))*3-Jc(Math.abs(e)))}function Gxe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Jc(t)-Jc(e))+1}function X7(e,t,n,r){var a=oO(e,t,n),o;switch(r=Qd(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=Zxe(a,i))&&(r.precision=o),K7(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Gxe(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Xxe(a))&&(r.precision=o-(r.type==="%")*2);break}}return dO(r)}function bi(e){var t=e.domain;return e.ticks=function(n){var r=t();return rO(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return X7(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,o=r.length-1,i=r[a],s=r[o],c,l,u=10;for(s<i&&(l=i,i=s,s=l,l=a,a=o,o=l);u-- >0;){if(l=aO(i,s,n),l===c)return r[a]=i,r[o]=s,t(r);if(l>0)i=Math.floor(i/l)*l,s=Math.ceil(s/l)*l;else if(l<0)i=Math.ceil(i*l)/l,s=Math.floor(s*l)/l;else break;c=l}return e},e}function by(){var e=lO();return e.copy=function(){return Gd(e,by())},Er.apply(e,arguments),bi(e)}function Z7(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,my),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Z7(e).unknown(t)},e=arguments.length?Array.from(e,my):[0,1],bi(n)}function G7(e,t){e=e.slice();var n=0,r=e.length-1,a=e[n],o=e[r],i;return o<a&&(i=n,n=r,r=i,i=a,a=o,o=i),e[n]=t.floor(a),e[r]=t.ceil(o),e}function Q7(e){return Math.log(e)}function Y7(e){return Math.exp(e)}function Qxe(e){return-Math.log(-e)}function Yxe(e){return-Math.exp(-e)}function Jxe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function e1e(e){return e===10?Jxe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function t1e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function J7(e){return(t,n)=>-e(-t,n)}function pO(e){const t=e(Q7,Y7),n=t.domain;let r=10,a,o;function i(){return a=t1e(r),o=e1e(r),n()[0]<0?(a=J7(a),o=J7(o),e(Qxe,Yxe)):e(Q7,Y7),t}return t.base=function(s){return arguments.length?(r=+s,i()):r},t.domain=function(s){return arguments.length?(n(s),i()):n()},t.ticks=s=>{const c=n();let l=c[0],u=c[c.length-1];const d=u<l;d&&([l,u]=[u,l]);let p=a(l),f=a(u),y,m;const v=s==null?10:+s;let b=[];if(!(r%1)&&f-p<v){if(p=Math.floor(p),f=Math.ceil(f),l>0){for(;p<=f;++p)for(y=1;y<r;++y)if(m=p<0?y/o(-p):y*o(p),!(m<l)){if(m>u)break;b.push(m)}}else for(;p<=f;++p)for(y=r-1;y>=1;--y)if(m=p>0?y/o(-p):y*o(p),!(m<l)){if(m>u)break;b.push(m)}b.length*2<v&&(b=rO(l,u,v))}else b=rO(p,f,Math.min(f-p,v)).map(o);return d?b.reverse():b},t.tickFormat=(s,c)=>{if(s==null&&(s=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=Qd(c)).precision==null&&(c.trim=!0),c=dO(c)),s===1/0)return c;const l=Math.max(1,r*s/t.ticks().length);return u=>{let d=u/o(Math.round(a(u)));return d*r<r-.5&&(d*=r),d<=l?c(u):""}},t.nice=()=>n(G7(n(),{floor:s=>o(Math.floor(a(s))),ceil:s=>o(Math.ceil(a(s)))})),t}function eV(){const e=pO(yy()).domain([1,10]);return e.copy=()=>Gd(e,eV()).base(e.base()),Er.apply(e,arguments),e}function tV(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function nV(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function fO(e){var t=1,n=e(tV(t),nV(t));return n.constant=function(r){return arguments.length?e(tV(t=+r),nV(t)):t},bi(n)}function rV(){var e=fO(yy());return e.copy=function(){return Gd(e,rV()).constant(e.constant())},Er.apply(e,arguments)}function aV(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function n1e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function r1e(e){return e<0?-e*e:e*e}function hO(e){var t=e(Bn,Bn),n=1;function r(){return n===1?e(Bn,Bn):n===.5?e(n1e,r1e):e(aV(n),aV(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,r()):n},bi(t)}function mO(){var e=hO(yy());return e.copy=function(){return Gd(e,mO()).exponent(e.exponent())},Er.apply(e,arguments),e}function a1e(){return mO.apply(null,arguments).exponent(.5)}function oV(e){return Math.sign(e)*e*e}function o1e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function iV(){var e=lO(),t=[0,1],n=!1,r;function a(o){var i=o1e(e(o));return isNaN(i)?r:n?Math.round(i):i}return a.invert=function(o){return e.invert(oV(o))},a.domain=function(o){return arguments.length?(e.domain(o),a):e.domain()},a.range=function(o){return arguments.length?(e.range((t=Array.from(o,my)).map(oV)),a):t.slice()},a.rangeRound=function(o){return a.range(o).round(!0)},a.round=function(o){return arguments.length?(n=!!o,a):n},a.clamp=function(o){return arguments.length?(e.clamp(o),a):e.clamp()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return iV(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},Er.apply(a,arguments),bi(a)}function sV(){var e=[],t=[],n=[],r;function a(){var i=0,s=Math.max(1,t.length);for(n=new Array(s-1);++i<s;)n[i-1]=Ixe(e,i/s);return o}function o(i){return i==null||isNaN(i=+i)?r:t[qd(n,i)]}return o.invertExtent=function(i){var s=t.indexOf(i);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(vi),a()},o.range=function(i){return arguments.length?(t=Array.from(i),a()):t.slice()},o.unknown=function(i){return arguments.length?(r=i,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return sV().domain(e).range(t).unknown(r)},Er.apply(o,arguments)}function cV(){var e=0,t=1,n=1,r=[.5],a=[0,1],o;function i(c){return c!=null&&c<=c?a[qd(r,c,0,n)]:o}function s(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,s()):[e,t]},i.range=function(c){return arguments.length?(n=(a=Array.from(c)).length-1,s()):a.slice()},i.invertExtent=function(c){var l=a.indexOf(c);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},i.unknown=function(c){return arguments.length&&(o=c),i},i.thresholds=function(){return r.slice()},i.copy=function(){return cV().domain([e,t]).range(a).unknown(o)},Er.apply(bi(i),arguments)}function lV(){var e=[.5],t=[0,1],n,r=1;function a(o){return o!=null&&o<=o?t[qd(e,o,0,r)]:n}return a.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(o){var i=t.indexOf(o);return[e[i-1],e[i]]},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return lV().domain(e).range(t).unknown(n)},Er.apply(a,arguments)}const yO=new Date,gO=new Date;function cn(e,t,n,r){function a(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return a.floor=o=>(e(o=new Date(+o)),o),a.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),a.round=o=>{const i=a(o),s=a.ceil(o);return o-i<s-o?i:s},a.offset=(o,i)=>(t(o=new Date(+o),i==null?1:Math.floor(i)),o),a.range=(o,i,s)=>{const c=[];if(o=a.ceil(o),s=s==null?1:Math.floor(s),!(o<i)||!(s>0))return c;let l;do c.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<i);return c},a.filter=o=>cn(i=>{if(i>=i)for(;e(i),!o(i);)i.setTime(i-1)},(i,s)=>{if(i>=i)if(s<0)for(;++s<=0;)for(;t(i,-1),!o(i););else for(;--s>=0;)for(;t(i,1),!o(i););}),n&&(a.count=(o,i)=>(yO.setTime(+o),gO.setTime(+i),e(yO),e(gO),Math.floor(n(yO,gO))),a.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?a.filter(r?i=>r(i)%o===0:i=>a.count(0,i)%o===0):a)),a}const wy=cn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);wy.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?cn(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):wy),wy.range;const To=1e3,Or=To*60,Io=Or*60,Ro=Io*24,vO=Ro*7,uV=Ro*30,bO=Ro*365,ls=cn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*To)},(e,t)=>(t-e)/To,e=>e.getUTCSeconds());ls.range;const wO=cn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*To)},(e,t)=>{e.setTime(+e+t*Or)},(e,t)=>(t-e)/Or,e=>e.getMinutes());wO.range;const xO=cn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Or)},(e,t)=>(t-e)/Or,e=>e.getUTCMinutes());xO.range;const _O=cn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*To-e.getMinutes()*Or)},(e,t)=>{e.setTime(+e+t*Io)},(e,t)=>(t-e)/Io,e=>e.getHours());_O.range;const jO=cn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Io)},(e,t)=>(t-e)/Io,e=>e.getUTCHours());jO.range;const Yd=cn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Or)/Ro,e=>e.getDate()-1);Yd.range;const xy=cn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ro,e=>e.getUTCDate()-1);xy.range;const dV=cn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ro,e=>Math.floor(e/Ro));dV.range;function us(e){return cn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Or)/vO)}const _y=us(0),jy=us(1),i1e=us(2),s1e=us(3),el=us(4),c1e=us(5),l1e=us(6);_y.range,jy.range,i1e.range,s1e.range,el.range,c1e.range,l1e.range;function ds(e){return cn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/vO)}const Sy=ds(0),Ey=ds(1),u1e=ds(2),d1e=ds(3),tl=ds(4),p1e=ds(5),f1e=ds(6);Sy.range,Ey.range,u1e.range,d1e.range,tl.range,p1e.range,f1e.range;const SO=cn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());SO.range;const EO=cn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());EO.range;const Do=cn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Do.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:cn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}),Do.range;const Lo=cn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Lo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:cn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}),Lo.range;function pV(e,t,n,r,a,o){const i=[[ls,1,To],[ls,5,5*To],[ls,15,15*To],[ls,30,30*To],[o,1,Or],[o,5,5*Or],[o,15,15*Or],[o,30,30*Or],[a,1,Io],[a,3,3*Io],[a,6,6*Io],[a,12,12*Io],[r,1,Ro],[r,2,2*Ro],[n,1,vO],[t,1,uV],[t,3,3*uV],[e,1,bO]];function s(l,u,d){const p=u<l;p&&([l,u]=[u,l]);const f=d&&typeof d.range=="function"?d:c(l,u,d),y=f?f.range(l,+u+1):[];return p?y.reverse():y}function c(l,u,d){const p=Math.abs(u-l)/d,f=nO(([,,v])=>v).right(i,p);if(f===i.length)return e.every(oO(l/bO,u/bO,d));if(f===0)return wy.every(Math.max(oO(l,u,d),1));const[y,m]=i[p/i[f-1][2]<i[f][2]/p?f-1:f];return y.every(m)}return[s,c]}const[h1e,m1e]=pV(Lo,EO,Sy,dV,jO,xO),[y1e,g1e]=pV(Do,SO,_y,Yd,_O,wO);function OO(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function CO(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Jd(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function v1e(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,o=e.days,i=e.shortDays,s=e.months,c=e.shortMonths,l=ep(a),u=tp(a),d=ep(o),p=tp(o),f=ep(i),y=tp(i),m=ep(s),v=tp(s),b=ep(c),w=tp(c),j={a:D,A:L,b:R,B,c:null,d:vV,e:vV,f:z1e,g:Q1e,G:J1e,H:$1e,I:F1e,j:B1e,L:bV,m:V1e,M:U1e,p:z,q:$,Q:EV,s:OV,S:W1e,u:H1e,U:q1e,V:K1e,w:X1e,W:Z1e,x:null,X:null,y:G1e,Y:Y1e,Z:e_e,"%":SV},x={a:V,A:Y,b:G,B:K,c:null,d:xV,e:xV,f:a_e,g:h_e,G:y_e,H:t_e,I:n_e,j:r_e,L:_V,m:o_e,M:i_e,p:Q,q,Q:EV,s:OV,S:s_e,u:c_e,U:l_e,V:u_e,w:d_e,W:p_e,x:null,X:null,y:f_e,Y:m_e,Z:g_e,"%":SV},_={a:N,A:P,b:I,B:k,c:C,d:yV,e:yV,f:I1e,g:mV,G:hV,H:gV,I:gV,j:P1e,L:T1e,m:M1e,M:k1e,p:M,q:N1e,Q:D1e,s:L1e,S:A1e,u:j1e,U:S1e,V:E1e,w:_1e,W:O1e,x:T,X:A,y:mV,Y:hV,Z:C1e,"%":R1e};j.x=S(n,j),j.X=S(r,j),j.c=S(t,j),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(H,X){return function(te){var F=[],se=-1,re=0,le=H.length,je,Le,$e;for(te instanceof Date||(te=new Date(+te));++se<le;)H.charCodeAt(se)===37&&(F.push(H.slice(re,se)),(Le=fV[je=H.charAt(++se)])!=null?je=H.charAt(++se):Le=je==="e"?" ":"0",($e=X[je])&&(je=$e(te,Le)),F.push(je),re=se+1);return F.push(H.slice(re,se)),F.join("")}}function E(H,X){return function(te){var F=Jd(1900,void 0,1),se=O(F,H,te+="",0),re,le;if(se!=te.length)return null;if("Q"in F)return new Date(F.Q);if("s"in F)return new Date(F.s*1e3+("L"in F?F.L:0));if(X&&!("Z"in F)&&(F.Z=0),"p"in F&&(F.H=F.H%12+F.p*12),F.m===void 0&&(F.m="q"in F?F.q:0),"V"in F){if(F.V<1||F.V>53)return null;"w"in F||(F.w=1),"Z"in F?(re=CO(Jd(F.y,0,1)),le=re.getUTCDay(),re=le>4||le===0?Ey.ceil(re):Ey(re),re=xy.offset(re,(F.V-1)*7),F.y=re.getUTCFullYear(),F.m=re.getUTCMonth(),F.d=re.getUTCDate()+(F.w+6)%7):(re=OO(Jd(F.y,0,1)),le=re.getDay(),re=le>4||le===0?jy.ceil(re):jy(re),re=Yd.offset(re,(F.V-1)*7),F.y=re.getFullYear(),F.m=re.getMonth(),F.d=re.getDate()+(F.w+6)%7)}else("W"in F||"U"in F)&&("w"in F||(F.w="u"in F?F.u%7:"W"in F?1:0),le="Z"in F?CO(Jd(F.y,0,1)).getUTCDay():OO(Jd(F.y,0,1)).getDay(),F.m=0,F.d="W"in F?(F.w+6)%7+F.W*7-(le+5)%7:F.w+F.U*7-(le+6)%7);return"Z"in F?(F.H+=F.Z/100|0,F.M+=F.Z%100,CO(F)):OO(F)}}function O(H,X,te,F){for(var se=0,re=X.length,le=te.length,je,Le;se<re;){if(F>=le)return-1;if(je=X.charCodeAt(se++),je===37){if(je=X.charAt(se++),Le=_[je in fV?X.charAt(se++):je],!Le||(F=Le(H,te,F))<0)return-1}else if(je!=te.charCodeAt(F++))return-1}return F}function M(H,X,te){var F=l.exec(X.slice(te));return F?(H.p=u.get(F[0].toLowerCase()),te+F[0].length):-1}function N(H,X,te){var F=f.exec(X.slice(te));return F?(H.w=y.get(F[0].toLowerCase()),te+F[0].length):-1}function P(H,X,te){var F=d.exec(X.slice(te));return F?(H.w=p.get(F[0].toLowerCase()),te+F[0].length):-1}function I(H,X,te){var F=b.exec(X.slice(te));return F?(H.m=w.get(F[0].toLowerCase()),te+F[0].length):-1}function k(H,X,te){var F=m.exec(X.slice(te));return F?(H.m=v.get(F[0].toLowerCase()),te+F[0].length):-1}function C(H,X,te){return O(H,t,X,te)}function T(H,X,te){return O(H,n,X,te)}function A(H,X,te){return O(H,r,X,te)}function D(H){return i[H.getDay()]}function L(H){return o[H.getDay()]}function R(H){return c[H.getMonth()]}function B(H){return s[H.getMonth()]}function z(H){return a[+(H.getHours()>=12)]}function $(H){return 1+~~(H.getMonth()/3)}function V(H){return i[H.getUTCDay()]}function Y(H){return o[H.getUTCDay()]}function G(H){return c[H.getUTCMonth()]}function K(H){return s[H.getUTCMonth()]}function Q(H){return a[+(H.getUTCHours()>=12)]}function q(H){return 1+~~(H.getUTCMonth()/3)}return{format:function(H){var X=S(H+="",j);return X.toString=function(){return H},X},parse:function(H){var X=E(H+="",!1);return X.toString=function(){return H},X},utcFormat:function(H){var X=S(H+="",x);return X.toString=function(){return H},X},utcParse:function(H){var X=E(H+="",!0);return X.toString=function(){return H},X}}}var fV={"-":"",_:" ",0:"0"},hn=/^\s*\d+/,b1e=/^%/,w1e=/[\\^$*+?|[\]().{}]/g;function pt(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",o=a.length;return r+(o<n?new Array(n-o+1).join(t)+a:a)}function x1e(e){return e.replace(w1e,"\\$&")}function ep(e){return new RegExp("^(?:"+e.map(x1e).join("|")+")","i")}function tp(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function _1e(e,t,n){var r=hn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function j1e(e,t,n){var r=hn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function S1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function E1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function O1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function hV(e,t,n){var r=hn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function mV(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function C1e(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function N1e(e,t,n){var r=hn.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function M1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function yV(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function P1e(e,t,n){var r=hn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function gV(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function k1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function A1e(e,t,n){var r=hn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function T1e(e,t,n){var r=hn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function I1e(e,t,n){var r=hn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function R1e(e,t,n){var r=b1e.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function D1e(e,t,n){var r=hn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function L1e(e,t,n){var r=hn.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function vV(e,t){return pt(e.getDate(),t,2)}function $1e(e,t){return pt(e.getHours(),t,2)}function F1e(e,t){return pt(e.getHours()%12||12,t,2)}function B1e(e,t){return pt(1+Yd.count(Do(e),e),t,3)}function bV(e,t){return pt(e.getMilliseconds(),t,3)}function z1e(e,t){return bV(e,t)+"000"}function V1e(e,t){return pt(e.getMonth()+1,t,2)}function U1e(e,t){return pt(e.getMinutes(),t,2)}function W1e(e,t){return pt(e.getSeconds(),t,2)}function H1e(e){var t=e.getDay();return t===0?7:t}function q1e(e,t){return pt(_y.count(Do(e)-1,e),t,2)}function wV(e){var t=e.getDay();return t>=4||t===0?el(e):el.ceil(e)}function K1e(e,t){return e=wV(e),pt(el.count(Do(e),e)+(Do(e).getDay()===4),t,2)}function X1e(e){return e.getDay()}function Z1e(e,t){return pt(jy.count(Do(e)-1,e),t,2)}function G1e(e,t){return pt(e.getFullYear()%100,t,2)}function Q1e(e,t){return e=wV(e),pt(e.getFullYear()%100,t,2)}function Y1e(e,t){return pt(e.getFullYear()%1e4,t,4)}function J1e(e,t){var n=e.getDay();return e=n>=4||n===0?el(e):el.ceil(e),pt(e.getFullYear()%1e4,t,4)}function e_e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+pt(t/60|0,"0",2)+pt(t%60,"0",2)}function xV(e,t){return pt(e.getUTCDate(),t,2)}function t_e(e,t){return pt(e.getUTCHours(),t,2)}function n_e(e,t){return pt(e.getUTCHours()%12||12,t,2)}function r_e(e,t){return pt(1+xy.count(Lo(e),e),t,3)}function _V(e,t){return pt(e.getUTCMilliseconds(),t,3)}function a_e(e,t){return _V(e,t)+"000"}function o_e(e,t){return pt(e.getUTCMonth()+1,t,2)}function i_e(e,t){return pt(e.getUTCMinutes(),t,2)}function s_e(e,t){return pt(e.getUTCSeconds(),t,2)}function c_e(e){var t=e.getUTCDay();return t===0?7:t}function l_e(e,t){return pt(Sy.count(Lo(e)-1,e),t,2)}function jV(e){var t=e.getUTCDay();return t>=4||t===0?tl(e):tl.ceil(e)}function u_e(e,t){return e=jV(e),pt(tl.count(Lo(e),e)+(Lo(e).getUTCDay()===4),t,2)}function d_e(e){return e.getUTCDay()}function p_e(e,t){return pt(Ey.count(Lo(e)-1,e),t,2)}function f_e(e,t){return pt(e.getUTCFullYear()%100,t,2)}function h_e(e,t){return e=jV(e),pt(e.getUTCFullYear()%100,t,2)}function m_e(e,t){return pt(e.getUTCFullYear()%1e4,t,4)}function y_e(e,t){var n=e.getUTCDay();return e=n>=4||n===0?tl(e):tl.ceil(e),pt(e.getUTCFullYear()%1e4,t,4)}function g_e(){return"+0000"}function SV(){return"%"}function EV(e){return+e}function OV(e){return Math.floor(+e/1e3)}var nl,CV,NV;v_e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function v_e(e){return nl=v1e(e),CV=nl.format,nl.parse,NV=nl.utcFormat,nl.utcParse,nl}function b_e(e){return new Date(e)}function w_e(e){return e instanceof Date?+e:+new Date(+e)}function NO(e,t,n,r,a,o,i,s,c,l){var u=lO(),d=u.invert,p=u.domain,f=l(".%L"),y=l(":%S"),m=l("%I:%M"),v=l("%I %p"),b=l("%a %d"),w=l("%b %d"),j=l("%B"),x=l("%Y");function _(S){return(c(S)<S?f:s(S)<S?y:i(S)<S?m:o(S)<S?v:r(S)<S?a(S)<S?b:w:n(S)<S?j:x)(S)}return u.invert=function(S){return new Date(d(S))},u.domain=function(S){return arguments.length?p(Array.from(S,w_e)):p().map(b_e)},u.ticks=function(S){var E=p();return e(E[0],E[E.length-1],S??10)},u.tickFormat=function(S,E){return E==null?_:l(E)},u.nice=function(S){var E=p();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?p(G7(E,S)):u},u.copy=function(){return Gd(u,NO(e,t,n,r,a,o,i,s,c,l))},u}function x_e(){return Er.apply(NO(y1e,g1e,Do,SO,_y,Yd,_O,wO,ls,CV).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function __e(){return Er.apply(NO(h1e,m1e,Lo,EO,Sy,xy,jO,xO,ls,NV).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Oy(){var e=0,t=1,n,r,a,o,i=Bn,s=!1,c;function l(d){return d==null||isNaN(d=+d)?c:i(a===0?.5:(d=(o(d)-n)*a,s?Math.max(0,Math.min(1,d)):d))}l.domain=function(d){return arguments.length?([e,t]=d,n=o(e=+e),r=o(t=+t),a=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(d){return arguments.length?(s=!!d,l):s},l.interpolator=function(d){return arguments.length?(i=d,l):i};function u(d){return function(p){var f,y;return arguments.length?([f,y]=p,i=d(f,y),l):[i(0),i(1)]}}return l.range=u(rc),l.rangeRound=u(c1),l.unknown=function(d){return arguments.length?(c=d,l):c},function(d){return o=d,n=d(e),r=d(t),a=n===r?0:1/(r-n),l}}function wi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function MV(){var e=bi(Oy()(Bn));return e.copy=function(){return wi(e,MV())},Ao.apply(e,arguments)}function PV(){var e=pO(Oy()).domain([1,10]);return e.copy=function(){return wi(e,PV()).base(e.base())},Ao.apply(e,arguments)}function kV(){var e=fO(Oy());return e.copy=function(){return wi(e,kV()).constant(e.constant())},Ao.apply(e,arguments)}function MO(){var e=hO(Oy());return e.copy=function(){return wi(e,MO()).exponent(e.exponent())},Ao.apply(e,arguments)}function j_e(){return MO.apply(null,arguments).exponent(.5)}function AV(){var e=[],t=Bn;function n(r){if(r!=null&&!isNaN(r=+r))return t((qd(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let a of r)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(vi),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,o)=>Txe(e,o/r))},n.copy=function(){return AV(t).domain(e)},Ao.apply(n,arguments)}function Cy(){var e=0,t=.5,n=1,r=1,a,o,i,s,c,l=Bn,u,d=!1,p;function f(m){return isNaN(m=+m)?p:(m=.5+((m=+u(m))-o)*(r*m<r*o?s:c),l(d?Math.max(0,Math.min(1,m)):m))}f.domain=function(m){return arguments.length?([e,t,n]=m,a=u(e=+e),o=u(t=+t),i=u(n=+n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,f):[e,t,n]},f.clamp=function(m){return arguments.length?(d=!!m,f):d},f.interpolator=function(m){return arguments.length?(l=m,f):l};function y(m){return function(v){var b,w,j;return arguments.length?([b,w,j]=v,l=Eae(m,[b,w,j]),f):[l(0),l(.5),l(1)]}}return f.range=y(rc),f.rangeRound=y(c1),f.unknown=function(m){return arguments.length?(p=m,f):p},function(m){return u=m,a=m(e),o=m(t),i=m(n),s=a===o?0:.5/(o-a),c=o===i?0:.5/(i-o),r=o<a?-1:1,f}}function TV(){var e=bi(Cy()(Bn));return e.copy=function(){return wi(e,TV())},Ao.apply(e,arguments)}function IV(){var e=pO(Cy()).domain([.1,1,10]);return e.copy=function(){return wi(e,IV()).base(e.base())},Ao.apply(e,arguments)}function RV(){var e=fO(Cy());return e.copy=function(){return wi(e,RV()).constant(e.constant())},Ao.apply(e,arguments)}function PO(){var e=hO(Cy());return e.copy=function(){return wi(e,PO()).exponent(e.exponent())},Ao.apply(e,arguments)}function S_e(){return PO.apply(null,arguments).exponent(.5)}const DV=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Xd,scaleDiverging:TV,scaleDivergingLog:IV,scaleDivergingPow:PO,scaleDivergingSqrt:S_e,scaleDivergingSymlog:RV,scaleIdentity:Z7,scaleImplicit:iO,scaleLinear:by,scaleLog:eV,scaleOrdinal:sO,scalePoint:Zd,scalePow:mO,scaleQuantile:sV,scaleQuantize:cV,scaleRadial:iV,scaleSequential:MV,scaleSequentialLog:PV,scaleSequentialPow:MO,scaleSequentialQuantile:AV,scaleSequentialSqrt:j_e,scaleSequentialSymlog:kV,scaleSqrt:a1e,scaleSymlog:rV,scaleThreshold:lV,scaleTime:x_e,scaleUtc:__e,tickFormat:X7},Symbol.toStringTag,{value:"Module"}));var kO,LV;function $V(){if(LV)return kO;LV=1;var e=Ys();function t(n,r,a){for(var o=-1,i=n.length;++o<i;){var s=n[o],c=r(s);if(c!=null&&(l===void 0?c===c&&!e(c):a(c,l)))var l=c,u=s}return u}return kO=t,kO}var AO,FV;function E_e(){if(FV)return AO;FV=1;function e(t,n){return t>n}return AO=e,AO}var TO,BV;function O_e(){if(BV)return TO;BV=1;var e=$V(),t=E_e(),n=Js();function r(a){return a&&a.length?e(a,n,t):void 0}return TO=r,TO}var C_e=O_e();const Ny=ot(C_e);var IO,zV;function N_e(){if(zV)return IO;zV=1;function e(t,n){return t<n}return IO=e,IO}var RO,VV;function M_e(){if(VV)return RO;VV=1;var e=$V(),t=N_e(),n=Js();function r(a){return a&&a.length?e(a,n,t):void 0}return RO=r,RO}var P_e=M_e();const My=ot(P_e);var DO,UV;RN=function(){if(UV)return DO;UV=1;var e=Rl(),t=_a(),n=Fz(),r=In();function a(o,i){var s=r(o)?e:n;return s(o,t(i,3))}return DO=a,DO};var LO,WV;function k_e(){if(WV)return LO;WV=1;var e=Ag(),t=RN();function n(r,a){return e(t(r,a),1)}return LO=n,LO}var A_e=k_e();const T_e=ot(A_e);var $O,HV;function I_e(){if(HV)return $O;HV=1;var e=cx();function t(n,r){return e(n,r)}return $O=t,$O}var R_e=I_e();const FO=ot(R_e);var rl=1e9,D_e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},VO,Ft=!0,Cr="[DecimalError] ",ps=Cr+"Invalid argument: ",BO=Cr+"Exponent out of range: ",al=Math.floor,fs=Math.pow,L_e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,hr,mn=1e7,Rt=7,qV=9007199254740991,Py=al(qV/Rt),Ce={};Ce.absoluteValue=Ce.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},Ce.comparedTo=Ce.cmp=function(e){var t,n,r,a,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(r=o.d.length,a=e.d.length,t=0,n=r<a?r:a;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===a?0:r>a^o.s<0?1:-1},Ce.decimalPlaces=Ce.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Rt;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n},Ce.dividedBy=Ce.div=function(e){return $o(this,new this.constructor(e))},Ce.dividedToIntegerBy=Ce.idiv=function(e){var t=this,n=t.constructor;return Nt($o(t,new n(e),0,1),n.precision)},Ce.equals=Ce.eq=function(e){return!this.cmp(e)},Ce.exponent=function(){return Jt(this)},Ce.greaterThan=Ce.gt=function(e){return this.cmp(e)>0},Ce.greaterThanOrEqualTo=Ce.gte=function(e){return this.cmp(e)>=0},Ce.isInteger=Ce.isint=function(){return this.e>this.d.length-2},Ce.isNegative=Ce.isneg=function(){return this.s<0},Ce.isPositive=Ce.ispos=function(){return this.s>0},Ce.isZero=function(){return this.s===0},Ce.lessThan=Ce.lt=function(e){return this.cmp(e)<0},Ce.lessThanOrEqualTo=Ce.lte=function(e){return this.cmp(e)<1},Ce.logarithm=Ce.log=function(e){var t,n=this,r=n.constructor,a=r.precision,o=a+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(hr))throw Error(Cr+"NaN");if(n.s<1)throw Error(Cr+(n.s?"NaN":"-Infinity"));return n.eq(hr)?new r(0):(Ft=!1,t=$o(np(n,o),np(e,o),o),Ft=!0,Nt(t,a))},Ce.minus=Ce.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?GV(t,e):KV(t,(e.s=-e.s,e))},Ce.modulo=Ce.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(e=new r(e),!e.s)throw Error(Cr+"NaN");return n.s?(Ft=!1,t=$o(n,e,0,1).times(e),Ft=!0,n.minus(t)):Nt(new r(n),a)},Ce.naturalExponential=Ce.exp=function(){return XV(this)},Ce.naturalLogarithm=Ce.ln=function(){return np(this)},Ce.negated=Ce.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},Ce.plus=Ce.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?KV(t,e):GV(t,(e.s=-e.s,e))},Ce.precision=Ce.sd=function(e){var t,n,r,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ps+e);if(t=Jt(a)+1,r=a.d.length-1,n=r*Rt+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},Ce.squareRoot=Ce.sqrt=function(){var e,t,n,r,a,o,i,s=this,c=s.constructor;if(s.s<1){if(!s.s)return new c(0);throw Error(Cr+"NaN")}for(e=Jt(s),Ft=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=$a(s.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=al((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(a.toString()),n=c.precision,a=i=n+3;;)if(o=r,r=o.plus($o(s,o,i+2)).times(.5),$a(o.d).slice(0,i)===(t=$a(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&t=="4999"){if(Nt(o,n+1,0),o.times(o).eq(s)){r=o;break}}else if(t!="9999")break;i+=4}return Ft=!0,Nt(r,n)},Ce.times=Ce.mul=function(e){var t,n,r,a,o,i,s,c,l,u=this,d=u.constructor,p=u.d,f=(e=new d(e)).d;if(!u.s||!e.s)return new d(0);for(e.s*=u.s,n=u.e+e.e,c=p.length,l=f.length,c<l&&(o=p,p=f,f=o,i=c,c=l,l=i),o=[],i=c+l,r=i;r--;)o.push(0);for(r=l;--r>=0;){for(t=0,a=c+r;a>r;)s=o[a]+f[r]*p[a-r-1]+t,o[a--]=s%mn|0,t=s/mn|0;o[a]=(o[a]+t)%mn|0}for(;!o[--i];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,Ft?Nt(e,d.precision):e},Ce.toDecimalPlaces=Ce.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(La(e,0,rl),t===void 0?t=r.rounding:La(t,0,8),Nt(n,e+Jt(n)+1,t))},Ce.toExponential=function(e,t){var n,r=this,a=r.constructor;return e===void 0?n=hs(r,!0):(La(e,0,rl),t===void 0?t=a.rounding:La(t,0,8),r=Nt(new a(r),e+1,t),n=hs(r,!0,e+1)),n},Ce.toFixed=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?hs(a):(La(e,0,rl),t===void 0?t=o.rounding:La(t,0,8),r=Nt(new o(a),e+Jt(a)+1,t),n=hs(r.abs(),!1,e+Jt(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},Ce.toInteger=Ce.toint=function(){var e=this,t=e.constructor;return Nt(new t(e),Jt(e)+1,t.rounding)},Ce.toNumber=function(){return+this},Ce.toPower=Ce.pow=function(e){var t,n,r,a,o,i,s=this,c=s.constructor,l=12,u=+(e=new c(e));if(!e.s)return new c(hr);if(s=new c(s),!s.s){if(e.s<1)throw Error(Cr+"Infinity");return s}if(s.eq(hr))return s;if(r=c.precision,e.eq(hr))return Nt(s,r);if(t=e.e,n=e.d.length-1,i=t>=n,o=s.s,i){if((n=u<0?-u:u)<=qV){for(a=new c(hr),t=Math.ceil(r/Rt+4),Ft=!1;n%2&&(a=a.times(s),QV(a.d,t)),n=al(n/2),n!==0;)s=s.times(s),QV(s.d,t);return Ft=!0,e.s<0?new c(hr).div(a):Nt(a,r)}}else if(o<0)throw Error(Cr+"NaN");return o=o<0&&e.d[Math.max(t,n)]&1?-1:1,s.s=1,Ft=!1,a=e.times(np(s,r+l)),Ft=!0,a=XV(a),a.s=o,a},Ce.toPrecision=function(e,t){var n,r,a=this,o=a.constructor;return e===void 0?(n=Jt(a),r=hs(a,n<=o.toExpNeg||n>=o.toExpPos)):(La(e,1,rl),t===void 0?t=o.rounding:La(t,0,8),a=Nt(new o(a),e,t),n=Jt(a),r=hs(a,e<=n||n<=o.toExpNeg,e)),r},Ce.toSignificantDigits=Ce.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(La(e,1,rl),t===void 0?t=r.rounding:La(t,0,8)),Nt(new r(n),e,t)},Ce.toString=Ce.valueOf=Ce.val=Ce.toJSON=Ce[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Jt(e),n=e.constructor;return hs(e,t<=n.toExpNeg||t>=n.toExpPos)};function KV(e,t){var n,r,a,o,i,s,c,l,u=e.constructor,d=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Ft?Nt(t,d):t;if(c=e.d,l=t.d,i=e.e,a=t.e,c=c.slice(),o=i-a,o){for(o<0?(r=c,o=-o,s=l.length):(r=l,a=i,s=c.length),i=Math.ceil(d/Rt),s=i>s?i+1:s+1,o>s&&(o=s,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(s=c.length,o=l.length,s-o<0&&(o=s,r=l,l=c,c=r),n=0;o;)n=(c[--o]=c[o]+l[o]+n)/mn|0,c[o]%=mn;for(n&&(c.unshift(n),++a),s=c.length;c[--s]==0;)c.pop();return t.d=c,t.e=a,Ft?Nt(t,d):t}function La(e,t,n){if(e!==~~e||e<t||e>n)throw Error(ps+e)}function $a(e){var t,n,r,a=e.length-1,o="",i=e[0];if(a>0){for(o+=i,t=1;t<a;t++)r=e[t]+"",n=Rt-r.length,n&&(o+=xi(n)),o+=r;i=e[t],r=i+"",n=Rt-r.length,n&&(o+=xi(n))}else if(i===0)return"0";for(;i%10===0;)i/=10;return o+i}var $o=function(){function e(r,a){var o,i=0,s=r.length;for(r=r.slice();s--;)o=r[s]*a+i,r[s]=o%mn|0,i=o/mn|0;return i&&r.unshift(i),r}function t(r,a,o,i){var s,c;if(o!=i)c=o>i?1:-1;else for(s=c=0;s<o;s++)if(r[s]!=a[s]){c=r[s]>a[s]?1:-1;break}return c}function n(r,a,o){for(var i=0;o--;)r[o]-=i,i=r[o]<a[o]?1:0,r[o]=i*mn+r[o]-a[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,o,i){var s,c,l,u,d,p,f,y,m,v,b,w,j,x,_,S,E,O,M=r.constructor,N=r.s==a.s?1:-1,P=r.d,I=a.d;if(!r.s)return new M(r);if(!a.s)throw Error(Cr+"Division by zero");for(c=r.e-a.e,E=I.length,_=P.length,f=new M(N),y=f.d=[],l=0;I[l]==(P[l]||0);)++l;if(I[l]>(P[l]||0)&&--c,o==null?w=o=M.precision:i?w=o+(Jt(r)-Jt(a))+1:w=o,w<0)return new M(0);if(w=w/Rt+2|0,l=0,E==1)for(u=0,I=I[0],w++;(l<_||u)&&w--;l++)j=u*mn+(P[l]||0),y[l]=j/I|0,u=j%I|0;else{for(u=mn/(I[0]+1)|0,u>1&&(I=e(I,u),P=e(P,u),E=I.length,_=P.length),x=E,m=P.slice(0,E),v=m.length;v<E;)m[v++]=0;O=I.slice(),O.unshift(0),S=I[0],I[1]>=mn/2&&++S;do u=0,s=t(I,m,E,v),s<0?(b=m[0],E!=v&&(b=b*mn+(m[1]||0)),u=b/S|0,u>1?(u>=mn&&(u=mn-1),d=e(I,u),p=d.length,v=m.length,s=t(d,m,p,v),s==1&&(u--,n(d,E<p?O:I,p))):(u==0&&(s=u=1),d=I.slice()),p=d.length,p<v&&d.unshift(0),n(m,d,v),s==-1&&(v=m.length,s=t(I,m,E,v),s<1&&(u++,n(m,E<v?O:I,v))),v=m.length):s===0&&(u++,m=[0]),y[l++]=u,s&&m[0]?m[v++]=P[x]||0:(m=[P[x]],v=1);while((x++<_||m[0]!==void 0)&&w--)}return y[0]||y.shift(),f.e=c,Nt(f,i?o+Jt(f)+1:o)}}();function XV(e,t){var n,r,a,o,i,s,c=0,l=0,u=e.constructor,d=u.precision;if(Jt(e)>16)throw Error(BO+Jt(e));if(!e.s)return new u(hr);for(t==null?(Ft=!1,s=d):s=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),l+=5;for(r=Math.log(fs(2,l))/Math.LN10*2+5|0,s+=r,n=a=o=new u(hr),u.precision=s;;){if(a=Nt(a.times(e),s),n=n.times(++c),i=o.plus($o(a,n,s)),$a(i.d).slice(0,s)===$a(o.d).slice(0,s)){for(;l--;)o=Nt(o.times(o),s);return u.precision=d,t==null?(Ft=!0,Nt(o,d)):o}o=i}}function Jt(e){for(var t=e.e*Rt,n=e.d[0];n>=10;n/=10)t++;return t}function zO(e,t,n){if(t>e.LN10.sd())throw Ft=!0,n&&(e.precision=n),Error(Cr+"LN10 precision limit exceeded");return Nt(new e(e.LN10),t)}function xi(e){for(var t="";e--;)t+="0";return t}function np(e,t){var n,r,a,o,i,s,c,l,u,d=1,p=10,f=e,y=f.d,m=f.constructor,v=m.precision;if(f.s<1)throw Error(Cr+(f.s?"NaN":"-Infinity"));if(f.eq(hr))return new m(0);if(t==null?(Ft=!1,l=v):l=t,f.eq(10))return t==null&&(Ft=!0),zO(m,l);if(l+=p,m.precision=l,n=$a(y),r=n.charAt(0),o=Jt(f),Math.abs(o)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)f=f.times(e),n=$a(f.d),r=n.charAt(0),d++;o=Jt(f),r>1?(f=new m("0."+n),o++):f=new m(r+"."+n.slice(1))}else return c=zO(m,l+2,v).times(o+""),f=np(new m(r+"."+n.slice(1)),l-p).plus(c),m.precision=v,t==null?(Ft=!0,Nt(f,v)):f;for(s=i=f=$o(f.minus(hr),f.plus(hr),l),u=Nt(f.times(f),l),a=3;;){if(i=Nt(i.times(u),l),c=s.plus($o(i,new m(a),l)),$a(c.d).slice(0,l)===$a(s.d).slice(0,l))return s=s.times(2),o!==0&&(s=s.plus(zO(m,l+2,v).times(o+""))),s=$o(s,new m(d),l),m.precision=v,t==null?(Ft=!0,Nt(s,v)):s;s=c,a+=2}}function ZV(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=al(n/Rt),e.d=[],r=(n+1)%Rt,n<0&&(r+=Rt),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=Rt;r<a;)e.d.push(+t.slice(r,r+=Rt));t=t.slice(r),r=Rt-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),Ft&&(e.e>Py||e.e<-Py))throw Error(BO+n)}else e.s=0,e.e=0,e.d=[0];return e}function Nt(e,t,n){var r,a,o,i,s,c,l,u,d=e.d;for(i=1,o=d[0];o>=10;o/=10)i++;if(r=t-i,r<0)r+=Rt,a=t,l=d[u=0];else{if(u=Math.ceil((r+1)/Rt),o=d.length,u>=o)return e;for(l=o=d[u],i=1;o>=10;o/=10)i++;r%=Rt,a=r-Rt+i}if(n!==void 0&&(o=fs(10,i-a-1),s=l/o%10|0,c=t<0||d[u+1]!==void 0||l%o,c=n<4?(s||c)&&(n==0||n==(e.s<0?3:2)):s>5||s==5&&(n==4||c||n==6&&(r>0?a>0?l/fs(10,i-a):0:d[u-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return c?(o=Jt(e),d.length=1,t=t-o-1,d[0]=fs(10,(Rt-t%Rt)%Rt),e.e=al(-t/Rt)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=u,o=1,u--):(d.length=u+1,o=fs(10,Rt-r),d[u]=a>0?(l/fs(10,i-a)%fs(10,a)|0)*o:0),c)for(;;)if(u==0){(d[0]+=o)==mn&&(d[0]=1,++e.e);break}else{if(d[u]+=o,d[u]!=mn)break;d[u--]=0,o=1}for(r=d.length;d[--r]===0;)d.pop();if(Ft&&(e.e>Py||e.e<-Py))throw Error(BO+Jt(e));return e}function GV(e,t){var n,r,a,o,i,s,c,l,u,d,p=e.constructor,f=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),Ft?Nt(t,f):t;if(c=e.d,d=t.d,r=t.e,l=e.e,c=c.slice(),i=l-r,i){for(u=i<0,u?(n=c,i=-i,s=d.length):(n=d,r=l,s=c.length),a=Math.max(Math.ceil(f/Rt),s)+2,i>a&&(i=a,n.length=1),n.reverse(),a=i;a--;)n.push(0);n.reverse()}else{for(a=c.length,s=d.length,u=a<s,u&&(s=a),a=0;a<s;a++)if(c[a]!=d[a]){u=c[a]<d[a];break}i=0}for(u&&(n=c,c=d,d=n,t.s=-t.s),s=c.length,a=d.length-s;a>0;--a)c[s++]=0;for(a=d.length;a>i;){if(c[--a]<d[a]){for(o=a;o&&c[--o]===0;)c[o]=mn-1;--c[o],c[a]+=mn}c[a]-=d[a]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,Ft?Nt(t,f):t):new p(0)}function hs(e,t,n){var r,a=Jt(e),o=$a(e.d),i=o.length;return t?(n&&(r=n-i)>0?o=o.charAt(0)+"."+o.slice(1)+xi(r):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(a<0?"e":"e+")+a):a<0?(o="0."+xi(-a-1)+o,n&&(r=n-i)>0&&(o+=xi(r))):a>=i?(o+=xi(a+1-i),n&&(r=n-a-1)>0&&(o=o+"."+xi(r))):((r=a+1)<i&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-i)>0&&(a+1===i&&(o+="."),o+=xi(r))),e.s<0?"-"+o:o}function QV(e,t){if(e.length>t)return e.length=t,!0}function YV(e){var t,n,r;function a(o){var i=this;if(!(i instanceof a))return new a(o);if(i.constructor=a,o instanceof a){i.s=o.s,i.e=o.e,i.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(ps+o);if(o>0)i.s=1;else if(o<0)o=-o,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(o===~~o&&o<1e7){i.e=0,i.d=[o];return}return ZV(i,o.toString())}else if(typeof o!="string")throw Error(ps+o);if(o.charCodeAt(0)===45?(o=o.slice(1),i.s=-1):i.s=1,L_e.test(o))ZV(i,o);else throw Error(ps+o)}if(a.prototype=Ce,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=YV,a.config=a.set=$_e,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return a.config(e),a}function $_e(e){if(!e||typeof e!="object")throw Error(Cr+"Object expected");var t,n,r,a=["precision",1,rl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((r=e[n=a[t]])!==void 0)if(al(r)===r&&r>=a[t+1]&&r<=a[t+2])this[n]=r;else throw Error(ps+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(ps+n+": "+r);return this}var VO=YV(D_e);hr=new VO(1);const Ot=VO;function F_e(e){return U_e(e)||V_e(e)||z_e(e)||B_e()}function B_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z_e(e,t){if(e){if(typeof e=="string")return UO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UO(e,t)}}function V_e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function U_e(e){if(Array.isArray(e))return UO(e)}function UO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var W_e=function(e){return e},JV={"@@functional/placeholder":!0},eU=function(e){return e===JV},tU=function(e){return function t(){return arguments.length===0||arguments.length===1&&eU(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},H_e=function e(t,n){return t===1?n:tU(function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var i=a.filter(function(s){return s!==JV}).length;return i>=t?n.apply(void 0,a):e(t-i,tU(function(){for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=a.map(function(d){return eU(d)?c.shift():d});return n.apply(void 0,F_e(u).concat(c))}))})},ky=function(e){return H_e(e.length,e)},WO=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},q_e=ky(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),K_e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return W_e;var r=t.reverse(),a=r[0],o=r.slice(1);return function(){return o.reduce(function(i,s){return s(i)},a.apply(void 0,arguments))}},HO=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},nU=function(e){var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t&&a.every(function(i,s){return i===t[s]})||(t=a,n=e.apply(void 0,a)),n}};function X_e(e){var t;return e===0?t=1:t=Math.floor(new Ot(e).abs().log(10).toNumber())+1,t}function Z_e(e,t,n){for(var r=new Ot(e),a=0,o=[];r.lt(t)&&a<1e5;)o.push(r.toNumber()),r=r.add(n),a++;return o}var G_e=ky(function(e,t,n){var r=+e,a=+t;return r+n*(a-r)}),Q_e=ky(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),Y_e=ky(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const Ay={rangeStep:Z_e,getDigitCount:X_e,interpolateNumber:G_e,uninterpolateNumber:Q_e,uninterpolateTruncation:Y_e};function qO(e){return tje(e)||eje(e)||rU(e)||J_e()}function J_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eje(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function tje(e){if(Array.isArray(e))return KO(e)}function rp(e,t){return aje(e)||rje(e,t)||rU(e,t)||nje()}function nje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rU(e,t){if(e){if(typeof e=="string")return KO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return KO(e,t)}}function KO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rje(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,a=!1,o=void 0;try{for(var i=e[Symbol.iterator](),s;!(r=(s=i.next()).done)&&(n.push(s.value),!(t&&n.length===t));r=!0);}catch(c){a=!0,o=c}finally{try{!r&&i.return!=null&&i.return()}finally{if(a)throw o}}return n}}function aje(e){if(Array.isArray(e))return e}function aU(e){var t=rp(e,2),n=t[0],r=t[1],a=n,o=r;return n>r&&(a=r,o=n),[a,o]}function oU(e,t,n){if(e.lte(0))return new Ot(0);var r=Ay.getDigitCount(e.toNumber()),a=new Ot(10).pow(r),o=e.div(a),i=r!==1?.05:.1,s=new Ot(Math.ceil(o.div(i).toNumber())).add(n).mul(i),c=s.mul(a);return t?c:new Ot(Math.ceil(c))}function oje(e,t,n){var r=1,a=new Ot(e);if(!a.isint()&&n){var o=Math.abs(e);o<1?(r=new Ot(10).pow(Ay.getDigitCount(e)-1),a=new Ot(Math.floor(a.div(r).toNumber())).mul(r)):o>1&&(a=new Ot(Math.floor(e)))}else e===0?a=new Ot(Math.floor((t-1)/2)):n||(a=new Ot(Math.floor(e)));var i=Math.floor((t-1)/2),s=K_e(q_e(function(c){return a.add(new Ot(c-i).mul(r)).toNumber()}),WO);return s(0,t)}function iU(e,t,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Ot(0),tickMin:new Ot(0),tickMax:new Ot(0)};var o=oU(new Ot(t).sub(e).div(n-1),r,a),i;e<=0&&t>=0?i=new Ot(0):(i=new Ot(e).add(t).div(2),i=i.sub(new Ot(i).mod(o)));var s=Math.ceil(i.sub(e).div(o).toNumber()),c=Math.ceil(new Ot(t).sub(i).div(o).toNumber()),l=s+c+1;return l>n?iU(e,t,n,r,a+1):(l<n&&(c=t>0?c+(n-l):c,s=t>0?s:s+(n-l)),{step:o,tickMin:i.sub(new Ot(s).mul(o)),tickMax:i.add(new Ot(c).mul(o))})}function ije(e){var t=rp(e,2),n=t[0],r=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),s=aU([n,r]),c=rp(s,2),l=c[0],u=c[1];if(l===-1/0||u===1/0){var d=u===1/0?[l].concat(qO(WO(0,a-1).map(function(){return 1/0}))):[].concat(qO(WO(0,a-1).map(function(){return-1/0})),[u]);return n>r?HO(d):d}if(l===u)return oje(l,a,o);var p=iU(l,u,i,o),f=p.step,y=p.tickMin,m=p.tickMax,v=Ay.rangeStep(y,m.add(new Ot(.1).mul(f)),f);return n>r?HO(v):v}function sje(e,t){var n=rp(e,2),r=n[0],a=n[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=aU([r,a]),s=rp(i,2),c=s[0],l=s[1];if(c===-1/0||l===1/0)return[r,a];if(c===l)return[c];var u=Math.max(t,2),d=oU(new Ot(l).sub(c).div(u-1),o,0),p=[].concat(qO(Ay.rangeStep(new Ot(c),new Ot(l).sub(new Ot(.99).mul(d)),d)),[l]);return r>a?HO(p):p}var cje=nU(ije),lje=nU(sje),uje="Invariant failed";function ms(e,t){throw new Error(uje)}var dje=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function ol(e){"@babel/helpers - typeof";return ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ol(e)}function Ty(){return Ty=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ty.apply(this,arguments)}function pje(e,t){return yje(e)||mje(e,t)||hje(e,t)||fje()}function fje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hje(e,t){if(e){if(typeof e=="string")return sU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sU(e,t)}}function sU(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mje(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function yje(e){if(Array.isArray(e))return e}function gje(e,t){if(e==null)return{};var n=vje(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vje(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function bje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wje(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uU(r.key),r)}}function xje(e,t,n){return t&&wje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _je(e,t,n){return t=Iy(t),jje(e,cU()?Reflect.construct(t,n||[],Iy(e).constructor):t.apply(e,n))}function jje(e,t){if(t&&(ol(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sje(e)}function Sje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cU=function(){return!!e})()}function Iy(e){return Iy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Iy(e)}function Eje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XO(e,t)}function XO(e,t){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},XO(e,t)}function lU(e,t,n){return t=uU(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uU(e){var t=Oje(e,"string");return ol(t)=="symbol"?t:t+""}function Oje(e,t){if(ol(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ol(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ry=function(e){function t(){return bje(this,t),_je(this,t,arguments)}return Eje(t,e),xje(t,[{key:"render",value:function(){var n=this.props,r=n.offset,a=n.layout,o=n.width,i=n.dataKey,s=n.data,c=n.dataPointFormatter,l=n.xAxis,u=n.yAxis,d=gje(n,dje),p=yt(d,!1);this.props.direction==="x"&&l.type!=="number"&&ms();var f=s.map(function(y){var m=c(y,i),v=m.x,b=m.y,w=m.value,j=m.errorVal;if(!j)return null;var x=[],_,S;if(Array.isArray(j)){var E=pje(j,2);_=E[0],S=E[1]}else _=S=j;if(a==="vertical"){var O=l.scale,M=b+r,N=M+o,P=M-o,I=O(w-_),k=O(w+S);x.push({x1:k,y1:N,x2:k,y2:P}),x.push({x1:I,y1:M,x2:k,y2:M}),x.push({x1:I,y1:N,x2:I,y2:P})}else if(a==="horizontal"){var C=u.scale,T=v+r,A=T-o,D=T+o,L=C(w-_),R=C(w+S);x.push({x1:A,y1:R,x2:D,y2:R}),x.push({x1:T,y1:L,x2:T,y2:R}),x.push({x1:A,y1:L,x2:D,y2:L})}return W.createElement(fn,Ty({className:"recharts-errorBar",key:"bar-".concat(x.map(function(B){return"".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)}))},p),x.map(function(B){return W.createElement("line",Ty({},B,{key:"line-".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)}))}))});return W.createElement(fn,{className:"recharts-errorBars"},f)}}])}(W.Component);lU(Ry,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),lU(Ry,"displayName","ErrorBar");function ap(e){"@babel/helpers - typeof";return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function dU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ys(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dU(Object(n),!0).forEach(function(r){Cje(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Cje(e,t,n){return t=Nje(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nje(e){var t=Mje(e,"string");return ap(t)=="symbol"?t:t+""}function Mje(e,t){if(ap(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ap(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pU=function(e){var t=e.children,n=e.formattedGraphicalItems,r=e.legendWidth,a=e.legendContent,o=fr(t,Xc);if(!o)return null;var i=Xc.defaultProps,s=i!==void 0?ys(ys({},i),o.props):{},c;return o.props&&o.props.payload?c=o.props&&o.props.payload:a==="children"?c=(n||[]).reduce(function(l,u){var d=u.item,p=u.props,f=p.sectors||p.data||[];return l.concat(f.map(function(y){return{type:o.props.iconType||d.props.legendType,value:y.name,color:y.fill,payload:y}}))},[]):c=(n||[]).map(function(l){var u=l.item,d=u.type.defaultProps,p=d!==void 0?ys(ys({},d),u.props):{},f=p.dataKey,y=p.name,m=p.legendType,v=p.hide;return{inactive:v,dataKey:f,type:s.iconType||m||"square",color:GO(u),value:y||f,payload:p}}),ys(ys(ys({},s),Xc.getWithHeight(o,r)),{},{payload:c,item:o})};function op(e){"@babel/helpers - typeof";return op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},op(e)}function fU(e){return Tje(e)||Aje(e)||kje(e)||Pje()}function Pje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kje(e,t){if(e){if(typeof e=="string")return ZO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZO(e,t)}}function Aje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tje(e){if(Array.isArray(e))return ZO(e)}function ZO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hU(Object(n),!0).forEach(function(r){il(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function il(e,t,n){return t=Ije(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ije(e){var t=Rje(e,"string");return op(t)=="symbol"?t:t+""}function Rje(e,t){if(op(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(op(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fa(e,t,n){return gt(e)||gt(t)?n:sn(t)?xr(e,t,n):tt(t)?t(e):n}function Dy(e,t,n,r){var a=T_e(e,function(s){return Fa(s,t)});if(n==="number"){var o=a.filter(function(s){return ye(s)||parseFloat(s)});return o.length?[My(o),Ny(o)]:[1/0,-1/0]}var i=r?a.filter(function(s){return!gt(s)}):a;return i.map(function(s){return sn(s)||s instanceof Date?s:""})}var Dje=function(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,i=(t=n==null?void 0:n.length)!==null&&t!==void 0?t:0;if(i<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var s=a.range,c=0;c<i;c++){var l=c>0?r[c-1].coordinate:r[i-1].coordinate,u=r[c].coordinate,d=c>=i-1?r[0].coordinate:r[c+1].coordinate,p=void 0;if(ia(u-l)!==ia(d-u)){var f=[];if(ia(d-u)===ia(s[1]-s[0])){p=d;var y=u+s[1]-s[0];f[0]=Math.min(y,(y+l)/2),f[1]=Math.max(y,(y+l)/2)}else{p=l;var m=d+s[1]-s[0];f[0]=Math.min(u,(m+u)/2),f[1]=Math.max(u,(m+u)/2)}var v=[Math.min(u,(p+u)/2),Math.max(u,(p+u)/2)];if(e>v[0]&&e<=v[1]||e>=f[0]&&e<=f[1]){o=r[c].index;break}}else{var b=Math.min(l,d),w=Math.max(l,d);if(e>(b+u)/2&&e<=(w+u)/2){o=r[c].index;break}}}else for(var j=0;j<i;j++)if(j===0&&e<=(n[j].coordinate+n[j+1].coordinate)/2||j>0&&j<i-1&&e>(n[j].coordinate+n[j-1].coordinate)/2&&e<=(n[j].coordinate+n[j+1].coordinate)/2||j===i-1&&e>(n[j].coordinate+n[j-1].coordinate)/2){o=n[j].index;break}return o},GO=function(e){var t,n=e,r=n.type.displayName,a=(t=e.type)!==null&&t!==void 0&&t.defaultProps?qt(qt({},e.type.defaultProps),e.props):e.props,o=a.stroke,i=a.fill,s;switch(r){case"Line":s=o;break;case"Area":case"Radar":s=o&&o!=="none"?o:i;break;default:s=i;break}return s},Lje=function(e){var t=e.barSize,n=e.totalSize,r=e.stackGroups,a=r===void 0?{}:r;if(!a)return{};for(var o={},i=Object.keys(a),s=0,c=i.length;s<c;s++)for(var l=a[i[s]].stackGroups,u=Object.keys(l),d=0,p=u.length;d<p;d++){var f=l[u[d]],y=f.items,m=f.cateAxisId,v=y.filter(function(S){return Mo(S.type).indexOf("Bar")>=0});if(v&&v.length){var b=v[0].type.defaultProps,w=b!==void 0?qt(qt({},b),v[0].props):v[0].props,j=w.barSize,x=w[m];o[x]||(o[x]=[]);var _=gt(j)?t:j;o[x].push({item:v[0],stackList:v.slice(1),barSize:gt(_)?void 0:ss(_,n,0)})}}return o},$je=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,a=e.sizeList,o=a===void 0?[]:a,i=e.maxBarSize,s=o.length;if(s<1)return null;var c=ss(t,r,0,!0),l,u=[];if(o[0].barSize===+o[0].barSize){var d=!1,p=r/s,f=o.reduce(function(j,x){return j+x.barSize||0},0);f+=(s-1)*c,f>=r&&(f-=(s-1)*c,c=0),f>=r&&p>0&&(d=!0,p*=.9,f=s*p);var y=(r-f)/2>>0,m={offset:y-c,size:0};l=o.reduce(function(j,x){var _={item:x.item,position:{offset:m.offset+m.size+c,size:d?p:x.barSize}},S=[].concat(fU(j),[_]);return m=S[S.length-1].position,x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){S.push({item:E,position:m})}),S},u)}else{var v=ss(n,r,0,!0);r-2*v-(s-1)*c<=0&&(c=0);var b=(r-2*v-(s-1)*c)/s;b>1&&(b>>=0);var w=i===+i?Math.min(b,i):b;l=o.reduce(function(j,x,_){var S=[].concat(fU(j),[{item:x.item,position:{offset:v+(b+c)*_+(b-w)/2,size:w}}]);return x.stackList&&x.stackList.length&&x.stackList.forEach(function(E){S.push({item:E,position:S[S.length-1].position})}),S},u)}return l},Fje=function(e,t,n,r){var a=n.children,o=n.width,i=n.margin,s=o-(i.left||0)-(i.right||0),c=pU({children:a,legendWidth:s});if(c){var l=r||{},u=l.width,d=l.height,p=c.align,f=c.verticalAlign,y=c.layout;if((y==="vertical"||y==="horizontal"&&f==="middle")&&p!=="center"&&ye(e[p]))return qt(qt({},e),{},il({},p,e[p]+(u||0)));if((y==="horizontal"||y==="vertical"&&p==="center")&&f!=="middle"&&ye(e[f]))return qt(qt({},e),{},il({},f,e[f]+(d||0)))}return e},Bje=function(e,t,n){return gt(t)?!0:e==="horizontal"?t==="yAxis":e==="vertical"||n==="x"?t==="xAxis":n==="y"?t==="yAxis":!0},mU=function(e,t,n,r,a){var o=t.props.children,i=sa(o,Ry).filter(function(c){return Bje(r,a,c.props.direction)});if(i&&i.length){var s=i.map(function(c){return c.props.dataKey});return e.reduce(function(c,l){var u=Fa(l,n);if(gt(u))return c;var d=Array.isArray(u)?[My(u),Ny(u)]:[u,u],p=s.reduce(function(f,y){var m=Fa(l,y,0),v=d[0]-Math.abs(Array.isArray(m)?m[0]:m),b=d[1]+Math.abs(Array.isArray(m)?m[1]:m);return[Math.min(v,f[0]),Math.max(b,f[1])]},[1/0,-1/0]);return[Math.min(p[0],c[0]),Math.max(p[1],c[1])]},[1/0,-1/0])}return null},zje=function(e,t,n,r,a){var o=t.map(function(i){return mU(e,i,n,a,r)}).filter(function(i){return!gt(i)});return o&&o.length?o.reduce(function(i,s){return[Math.min(i[0],s[0]),Math.max(i[1],s[1])]},[1/0,-1/0]):null},yU=function(e,t,n,r,a){var o=t.map(function(s){var c=s.props.dataKey;return n==="number"&&c&&mU(e,s,c,r)||Dy(e,c,n,a)});if(n==="number")return o.reduce(function(s,c){return[Math.min(s[0],c[0]),Math.max(s[1],c[1])]},[1/0,-1/0]);var i={};return o.reduce(function(s,c){for(var l=0,u=c.length;l<u;l++)i[c[l]]||(i[c[l]]=!0,s.push(c[l]));return s},[])},gU=function(e,t){return e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis"},vU=function(e,t,n,r){if(r)return e.map(function(s){return s.coordinate});var a,o,i=e.map(function(s){return s.coordinate===t&&(a=!0),s.coordinate===n&&(o=!0),s.coordinate});return a||i.push(t),o||i.push(n),i},Fo=function(e,t,n){if(!e)return null;var r=e.scale,a=e.duplicateDomain,o=e.type,i=e.range,s=e.realScaleType==="scaleBand"?r.bandwidth()/2:2,c=(t||n)&&o==="category"&&r.bandwidth?r.bandwidth()/s:0;if(c=e.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?ia(i[0]-i[1])*2*c:c,t&&(e.ticks||e.niceTicks)){var l=(e.ticks||e.niceTicks).map(function(u){var d=a?a.indexOf(u):u;return{coordinate:r(d)+c,value:u,offset:c}});return l.filter(function(u){return!Dd(u.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(u,d){return{coordinate:r(u)+c,value:u,index:d,offset:c}}):r.ticks&&!n?r.ticks(e.tickCount).map(function(u){return{coordinate:r(u)+c,value:u,offset:c}}):r.domain().map(function(u,d){return{coordinate:r(u)+c,value:a?a[u]:u,index:d,offset:c}})},QO=new WeakMap,Ly=function(e,t){if(typeof t!="function")return e;QO.has(e)||QO.set(e,new WeakMap);var n=QO.get(e);if(n.has(t))return n.get(t);var r=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return n.set(t,r),r},Vje=function(e,t,n){var r=e.scale,a=e.type,o=e.layout,i=e.axisType;if(r==="auto")return o==="radial"&&i==="radiusAxis"?{scale:Xd(),realScaleType:"band"}:o==="radial"&&i==="angleAxis"?{scale:by(),realScaleType:"linear"}:a==="category"&&t&&(t.indexOf("LineChart")>=0||t.indexOf("AreaChart")>=0||t.indexOf("ComposedChart")>=0&&!n)?{scale:Zd(),realScaleType:"point"}:a==="category"?{scale:Xd(),realScaleType:"band"}:{scale:by(),realScaleType:"linear"};if(Rd(r)){var s="scale".concat(Xm(r));return{scale:(DV[s]||Zd)(),realScaleType:DV[s]?s:"point"}}return tt(r)?{scale:r}:{scale:Zd(),realScaleType:"point"}},bU=1e-4,Uje=function(e){var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-bU,o=Math.max(r[0],r[1])+bU,i=e(t[0]),s=e(t[n-1]);(i<a||i>o||s<a||s>o)&&e.domain([t[0],t[n-1]])}},Wje=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null},Hje=function(e,t){if(!t||t.length!==2||!ye(t[0])||!ye(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!ye(e[0])||e[0]<n)&&(a[0]=n),(!ye(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a},qje=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0,i=0;i<t;++i){var s=Dd(e[i][n][1])?e[i][n][0]:e[i][n][1];s>=0?(e[i][n][0]=a,e[i][n][1]=a+s,a=e[i][n][1]):(e[i][n][0]=o,e[i][n][1]=o+s,o=e[i][n][1])}},Kje=function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0;o<t;++o){var i=Dd(e[o][n][1])?e[o][n][0]:e[o][n][1];i>=0?(e[o][n][0]=a,e[o][n][1]=a+i,a=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}},Xje={sign:qje,expand:Z0e,none:Hc,silhouette:G0e,wiggle:Q0e,positive:Kje},Zje=function(e,t,n){var r=t.map(function(i){return i.props.dataKey}),a=Xje[n],o=X0e().keys(r).value(function(i,s){return+Fa(i,s,0)}).order(oE).offset(a);return o(e)},Gje=function(e,t,n,r,a,o){if(!e)return null;var i=o?t.reverse():t,s={},c=i.reduce(function(u,d){var p,f=(p=d.type)!==null&&p!==void 0&&p.defaultProps?qt(qt({},d.type.defaultProps),d.props):d.props,y=f.stackId,m=f.hide;if(m)return u;var v=f[n],b=u[v]||{hasStack:!1,stackGroups:{}};if(sn(y)){var w=b.stackGroups[y]||{numericAxisId:n,cateAxisId:r,items:[]};w.items.push(d),b.hasStack=!0,b.stackGroups[y]=w}else b.stackGroups[Hm("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[d]};return qt(qt({},u),{},il({},v,b))},s),l={};return Object.keys(c).reduce(function(u,d){var p=c[d];if(p.hasStack){var f={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(y,m){var v=p.stackGroups[m];return qt(qt({},y),{},il({},m,{numericAxisId:n,cateAxisId:r,items:v.items,stackedData:Zje(e,v.items,a)}))},f)}return qt(qt({},u),{},il({},d,p))},l)},Qje=function(e,t){var n=t.realScaleType,r=t.type,a=t.tickCount,o=t.originalDomain,i=t.allowDecimals,s=n||t.scale;if(s!=="auto"&&s!=="linear")return null;if(a&&r==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=e.domain();if(!c.length)return null;var l=cje(c,a,i);return e.domain([My(l),Ny(l)]),{niceTicks:l}}if(a&&r==="number"){var u=e.domain(),d=lje(u,a,i);return{niceTicks:d}}return null},wU=function(e){var t=e.axis,n=e.ticks,r=e.offset,a=e.bandSize,o=e.entry,i=e.index;if(t.type==="category")return n[i]?n[i].coordinate+r:null;var s=Fa(o,t.dataKey,t.domain[i]);return gt(s)?null:t.scale(s)-a/2+r},Yje=function(e){var t=e.numericAxis,n=t.scale.domain();if(t.type==="number"){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]},Jje=function(e,t){var n,r=(n=e.type)!==null&&n!==void 0&&n.defaultProps?qt(qt({},e.type.defaultProps),e.props):e.props,a=r.stackId;if(sn(a)){var o=t[a];if(o){var i=o.items.indexOf(e);return i>=0?o.stackedData[i]:null}}return null},eSe=function(e){return e.reduce(function(t,n){return[My(n.concat([t[0]]).filter(ye)),Ny(n.concat([t[1]]).filter(ye))]},[1/0,-1/0])},xU=function(e,t,n){return Object.keys(e).reduce(function(r,a){var o=e[a],i=o.stackedData,s=i.reduce(function(c,l){var u=eSe(l.slice(t,n+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]).map(function(r){return r===1/0||r===-1/0?0:r})},_U=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,jU=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,YO=function(e,t,n){if(tt(e))return e(t,n);if(!Array.isArray(e))return t;var r=[];if(ye(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(_U.test(e[0])){var a=+_U.exec(e[0])[1];r[0]=t[0]-a}else tt(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(ye(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(jU.test(e[1])){var o=+jU.exec(e[1])[1];r[1]=t[1]+o}else tt(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},$y=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=UE(t,function(u){return u.coordinate}),o=1/0,i=1,s=a.length;i<s;i++){var c=a[i],l=a[i-1];o=Math.min((c.coordinate||0)-(l.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},SU=function(e,t,n){return!e||!e.length||FO(e,xr(n,"type.defaultProps.domain"))?t:e},EU=function(e,t){var n=e.type.defaultProps?qt(qt({},e.type.defaultProps),e.props):e.props,r=n.dataKey,a=n.name,o=n.unit,i=n.formatter,s=n.tooltipType,c=n.chartType,l=n.hide;return qt(qt({},yt(e,!1)),{},{dataKey:r,unit:o,formatter:i,name:a||r,color:GO(e),value:Fa(t,r),type:s,payload:t,chartType:c,hide:l})};function ip(e){"@babel/helpers - typeof";return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ip(e)}function OU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function CU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?OU(Object(n),!0).forEach(function(r){tSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function tSe(e,t,n){return t=nSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nSe(e){var t=rSe(e,"string");return ip(t)=="symbol"?t:t+""}function rSe(e,t){if(ip(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ip(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fy=Math.PI/180,aSe=function(e){return e*180/Math.PI},_n=function(e,t,n,r){return{x:e+Math.cos(-Fy*r)*n,y:t+Math.sin(-Fy*r)*n}},oSe=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-o,2))},iSe=function(e,t){var n=e.x,r=e.y,a=t.cx,o=t.cy,i=oSe({x:n,y:r},{x:a,y:o});if(i<=0)return{radius:i};var s=(n-a)/i,c=Math.acos(s);return r>o&&(c=2*Math.PI-c),{radius:i,angle:aSe(c),angleInRadian:c}},sSe=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),a=Math.floor(n/360),o=Math.min(r,a);return{startAngle:t-o*360,endAngle:n-o*360}},cSe=function(e,t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),o=Math.floor(r/360),i=Math.min(a,o);return e+i*360},NU=function(e,t){var n=e.x,r=e.y,a=iSe({x:n,y:r},t),o=a.radius,i=a.angle,s=t.innerRadius,c=t.outerRadius;if(o<s||o>c)return!1;if(o===0)return!0;var l=sSe(t),u=l.startAngle,d=l.endAngle,p=i,f;if(u<=d){for(;p>d;)p-=360;for(;p<u;)p+=360;f=p>=u&&p<=d}else{for(;p>u;)p-=360;for(;p<d;)p+=360;f=p>=d&&p<=u}return f?CU(CU({},t),{},{radius:o,angle:cSe(p,t)}):null};function sp(e){"@babel/helpers - typeof";return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(e)}var lSe=["offset"];function uSe(e){return hSe(e)||fSe(e)||pSe(e)||dSe()}function dSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pSe(e,t){if(e){if(typeof e=="string")return JO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JO(e,t)}}function fSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hSe(e){if(Array.isArray(e))return JO(e)}function JO(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mSe(e,t){if(e==null)return{};var n=ySe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ySe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function MU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ln(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?MU(Object(n),!0).forEach(function(r){gSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):MU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gSe(e,t,n){return t=vSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vSe(e){var t=bSe(e,"string");return sp(t)=="symbol"?t:t+""}function bSe(e,t){if(sp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(sp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cp(){return cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cp.apply(this,arguments)}var wSe=function(e){var t=e.value,n=e.formatter,r=gt(e.children)?t:e.children;return tt(n)?n(r):r},xSe=function(e,t){var n=ia(t-e),r=Math.min(Math.abs(t-e),360);return n*r},_Se=function(e,t,n){var r=e.position,a=e.viewBox,o=e.offset,i=e.className,s=a,c=s.cx,l=s.cy,u=s.innerRadius,d=s.outerRadius,p=s.startAngle,f=s.endAngle,y=s.clockWise,m=(u+d)/2,v=xSe(p,f),b=v>=0?1:-1,w,j;r==="insideStart"?(w=p+b*o,j=y):r==="insideEnd"?(w=f-b*o,j=!y):r==="end"&&(w=f+b*o,j=y),j=v<=0?j:!j;var x=_n(c,l,m,w),_=_n(c,l,m,w+(j?1:-1)*359),S="M".concat(x.x,",").concat(x.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(j?0:1,`,
    `).concat(_.x,",").concat(_.y),E=gt(e.id)?Hm("recharts-radial-line-"):e.id;return W.createElement("text",cp({},n,{dominantBaseline:"central",className:xt("recharts-radial-bar-label",i)}),W.createElement("defs",null,W.createElement("path",{id:E,d:S})),W.createElement("textPath",{xlinkHref:"#".concat(E)},t))},jSe=function(e){var t=e.viewBox,n=e.offset,r=e.position,a=t,o=a.cx,i=a.cy,s=a.innerRadius,c=a.outerRadius,l=a.startAngle,u=a.endAngle,d=(l+u)/2;if(r==="outside"){var p=_n(o,i,c+n,d),f=p.x,y=p.y;return{x:f,y,textAnchor:f>=o?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"end"};var m=(s+c)/2,v=_n(o,i,m,d),b=v.x,w=v.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},SSe=function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,a=e.position,o=t,i=o.x,s=o.y,c=o.width,l=o.height,u=l>=0?1:-1,d=u*r,p=u>0?"end":"start",f=u>0?"start":"end",y=c>=0?1:-1,m=y*r,v=y>0?"end":"start",b=y>0?"start":"end";if(a==="top"){var w={x:i+c/2,y:s-u*r,textAnchor:"middle",verticalAnchor:p};return ln(ln({},w),n?{height:Math.max(s-n.y,0),width:c}:{})}if(a==="bottom"){var j={x:i+c/2,y:s+l+d,textAnchor:"middle",verticalAnchor:f};return ln(ln({},j),n?{height:Math.max(n.y+n.height-(s+l),0),width:c}:{})}if(a==="left"){var x={x:i-m,y:s+l/2,textAnchor:v,verticalAnchor:"middle"};return ln(ln({},x),n?{width:Math.max(x.x-n.x,0),height:l}:{})}if(a==="right"){var _={x:i+c+m,y:s+l/2,textAnchor:b,verticalAnchor:"middle"};return ln(ln({},_),n?{width:Math.max(n.x+n.width-_.x,0),height:l}:{})}var S=n?{width:c,height:l}:{};return a==="insideLeft"?ln({x:i+m,y:s+l/2,textAnchor:b,verticalAnchor:"middle"},S):a==="insideRight"?ln({x:i+c-m,y:s+l/2,textAnchor:v,verticalAnchor:"middle"},S):a==="insideTop"?ln({x:i+c/2,y:s+d,textAnchor:"middle",verticalAnchor:f},S):a==="insideBottom"?ln({x:i+c/2,y:s+l-d,textAnchor:"middle",verticalAnchor:p},S):a==="insideTopLeft"?ln({x:i+m,y:s+d,textAnchor:b,verticalAnchor:f},S):a==="insideTopRight"?ln({x:i+c-m,y:s+d,textAnchor:v,verticalAnchor:f},S):a==="insideBottomLeft"?ln({x:i+m,y:s+l-d,textAnchor:b,verticalAnchor:p},S):a==="insideBottomRight"?ln({x:i+c-m,y:s+l-d,textAnchor:v,verticalAnchor:p},S):Vc(a)&&(ye(a.x)||is(a.x))&&(ye(a.y)||is(a.y))?ln({x:i+ss(a.x,c),y:s+ss(a.y,l),textAnchor:"end",verticalAnchor:"end"},S):ln({x:i+c/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},S)},ESe=function(e){return"cx"in e&&ye(e.cx)};function Mn(e){var t=e.offset,n=t===void 0?5:t,r=mSe(e,lSe),a=ln({offset:n},r),o=a.viewBox,i=a.position,s=a.value,c=a.children,l=a.content,u=a.className,d=u===void 0?"":u,p=a.textBreakAll;if(!o||gt(s)&&gt(c)&&!g.isValidElement(l)&&!tt(l))return null;if(g.isValidElement(l))return g.cloneElement(l,a);var f;if(tt(l)){if(f=g.createElement(l,a),g.isValidElement(f))return f}else f=wSe(a);var y=ESe(o),m=yt(a,!0);if(y&&(i==="insideStart"||i==="insideEnd"||i==="end"))return _Se(a,f,m);var v=y?jSe(a):SSe(a);return W.createElement(fy,cp({className:xt("recharts-label",d)},m,v,{breakAll:p}),f)}Mn.displayName="Label";var PU=function(e){var t=e.cx,n=e.cy,r=e.angle,a=e.startAngle,o=e.endAngle,i=e.r,s=e.radius,c=e.innerRadius,l=e.outerRadius,u=e.x,d=e.y,p=e.top,f=e.left,y=e.width,m=e.height,v=e.clockWise,b=e.labelViewBox;if(b)return b;if(ye(y)&&ye(m)){if(ye(u)&&ye(d))return{x:u,y:d,width:y,height:m};if(ye(p)&&ye(f))return{x:p,y:f,width:y,height:m}}return ye(u)&&ye(d)?{x:u,y:d,width:0,height:0}:ye(t)&&ye(n)?{cx:t,cy:n,startAngle:a||r||0,endAngle:o||r||0,innerRadius:c||0,outerRadius:l||s||i||0,clockWise:v}:e.viewBox?e.viewBox:{}},OSe=function(e,t){return e?e===!0?W.createElement(Mn,{key:"label-implicit",viewBox:t}):sn(e)?W.createElement(Mn,{key:"label-implicit",viewBox:t,value:e}):g.isValidElement(e)?e.type===Mn?g.cloneElement(e,{key:"label-implicit",viewBox:t}):W.createElement(Mn,{key:"label-implicit",content:e,viewBox:t}):tt(e)?W.createElement(Mn,{key:"label-implicit",content:e,viewBox:t}):Vc(e)?W.createElement(Mn,cp({viewBox:t},e,{key:"label-implicit"})):null:null},CSe=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=PU(e),o=sa(r,Mn).map(function(s,c){return g.cloneElement(s,{viewBox:t||a,key:"label-".concat(c)})});if(!n)return o;var i=OSe(e.label,t||a);return[i].concat(uSe(o))};Mn.parseViewBox=PU,Mn.renderCallByParent=CSe;var eC,kU;SM=function(){if(kU)return eC;kU=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return eC=e,eC};var NSe=SM();DN=ot(NSe);function lp(e){"@babel/helpers - typeof";return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(e)}var MSe=["valueAccessor"],PSe=["data","dataKey","clockWise","id","textBreakAll"];function kSe(e){return RSe(e)||ISe(e)||TSe(e)||ASe()}function ASe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TSe(e,t){if(e){if(typeof e=="string")return tC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tC(e,t)}}function ISe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RSe(e){if(Array.isArray(e))return tC(e)}function tC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function By(){return By=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},By.apply(this,arguments)}function AU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function TU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AU(Object(n),!0).forEach(function(r){DSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function DSe(e,t,n){return t=LSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LSe(e){var t=$Se(e,"string");return lp(t)=="symbol"?t:t+""}function $Se(e,t){if(lp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(lp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IU(e,t){if(e==null)return{};var n=FSe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function FSe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var BSe=function(e){return Array.isArray(e.value)?DN(e.value):e.value};function gs(e){var t=e.valueAccessor,n=t===void 0?BSe:t,r=IU(e,MSe),a=r.data,o=r.dataKey,i=r.clockWise,s=r.id,c=r.textBreakAll,l=IU(r,PSe);return!a||!a.length?null:W.createElement(fn,{className:"recharts-label-list"},a.map(function(u,d){var p=gt(o)?n(u,d):Fa(u&&u.payload,o),f=gt(s)?{}:{id:"".concat(s,"-").concat(d)};return W.createElement(Mn,By({},yt(u,!0),l,f,{parentViewBox:u.parentViewBox,value:p,textBreakAll:c,viewBox:Mn.parseViewBox(gt(i)?u:TU(TU({},u),{},{clockWise:i})),key:"label-".concat(d),index:d}))}))}gs.displayName="LabelList";function zSe(e,t){return e?e===!0?W.createElement(gs,{key:"labelList-implicit",data:t}):W.isValidElement(e)||tt(e)?W.createElement(gs,{key:"labelList-implicit",data:t,content:e}):Vc(e)?W.createElement(gs,By({data:t},e,{key:"labelList-implicit"})):null:null}function VSe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,a=sa(r,gs).map(function(i,s){return g.cloneElement(i,{data:t,key:"labelList-".concat(s)})});if(!n)return a;var o=zSe(e.label,t);return[o].concat(kSe(a))}gs.renderCallByParent=VSe;function up(e){"@babel/helpers - typeof";return up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},up(e)}function nC(){return nC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nC.apply(this,arguments)}function RU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function DU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RU(Object(n),!0).forEach(function(r){USe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function USe(e,t,n){return t=WSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WSe(e){var t=HSe(e,"string");return up(t)=="symbol"?t:t+""}function HSe(e,t){if(up(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(up(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qSe=function(e,t){var n=ia(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},zy=function(e){var t=e.cx,n=e.cy,r=e.radius,a=e.angle,o=e.sign,i=e.isExternal,s=e.cornerRadius,c=e.cornerIsExternal,l=s*(i?1:-1)+r,u=Math.asin(s/l)/Fy,d=c?a:a+o*u,p=_n(t,n,l,d),f=_n(t,n,r,d),y=c?a-o*u:a,m=_n(t,n,l*Math.cos(u*Fy),y);return{center:p,circleTangency:f,lineTangency:m,theta:u}},LU=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.startAngle,i=e.endAngle,s=qSe(o,i),c=o+s,l=_n(t,n,a,o),u=_n(t,n,a,c),d="M ".concat(l.x,",").concat(l.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(o>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(r>0){var p=_n(t,n,r,o),f=_n(t,n,r,c);d+="L ".concat(f.x,",").concat(f.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(o<=c),`,
            `).concat(p.x,",").concat(p.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},KSe=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,o=e.cornerRadius,i=e.forceCornerRadius,s=e.cornerIsExternal,c=e.startAngle,l=e.endAngle,u=ia(l-c),d=zy({cx:t,cy:n,radius:a,angle:c,sign:u,cornerRadius:o,cornerIsExternal:s}),p=d.circleTangency,f=d.lineTangency,y=d.theta,m=zy({cx:t,cy:n,radius:a,angle:l,sign:-u,cornerRadius:o,cornerIsExternal:s}),v=m.circleTangency,b=m.lineTangency,w=m.theta,j=s?Math.abs(c-l):Math.abs(c-l)-y-w;if(j<0)return i?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):LU({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:c,endAngle:l});var x="M ".concat(f.x,",").concat(f.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(j>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(r>0){var _=zy({cx:t,cy:n,radius:r,angle:c,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),S=_.circleTangency,E=_.lineTangency,O=_.theta,M=zy({cx:t,cy:n,radius:r,angle:l,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),N=M.circleTangency,P=M.lineTangency,I=M.theta,k=s?Math.abs(c-l):Math.abs(c-l)-O-I;if(k<0&&o===0)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(P.x,",").concat(P.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(N.x,",").concat(N.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(k>180),",").concat(+(u>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(E.x,",").concat(E.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x},XSe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},$U=function(e){var t=DU(DU({},XSe),e),n=t.cx,r=t.cy,a=t.innerRadius,o=t.outerRadius,i=t.cornerRadius,s=t.forceCornerRadius,c=t.cornerIsExternal,l=t.startAngle,u=t.endAngle,d=t.className;if(o<a||l===u)return null;var p=xt("recharts-sector",d),f=o-a,y=ss(i,f,0,!0),m;return y>0&&Math.abs(l-u)<360?m=KSe({cx:n,cy:r,innerRadius:a,outerRadius:o,cornerRadius:Math.min(y,f/2),forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u}):m=LU({cx:n,cy:r,innerRadius:a,outerRadius:o,startAngle:l,endAngle:u}),W.createElement("path",nC({},yt(t,!0),{className:p,d:m,role:"img"}))};function dp(e){"@babel/helpers - typeof";return dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dp(e)}function rC(){return rC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rC.apply(this,arguments)}function FU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function BU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FU(Object(n),!0).forEach(function(r){ZSe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FU(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ZSe(e,t,n){return t=GSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GSe(e){var t=QSe(e,"string");return dp(t)=="symbol"?t:t+""}function QSe(e,t){if(dp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(dp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zU={curveBasisClosed:L0e,curveBasisOpen:$0e,curveBasis:D0e,curveBumpX:_0e,curveBumpY:j0e,curveLinearClosed:F0e,curveLinear:Ym,curveMonotoneX:B0e,curveMonotoneY:z0e,curveNatural:V0e,curveStep:U0e,curveStepAfter:H0e,curveStepBefore:W0e},Vy=function(e){return e.x===+e.x&&e.y===+e.y},pp=function(e){return e.x},fp=function(e){return e.y},YSe=function(e,t){if(tt(e))return e;var n="curve".concat(Xm(e));return(n==="curveMonotone"||n==="curveBump")&&t?zU["".concat(n).concat(t==="vertical"?"Y":"X")]:zU[n]||Ym},JSe=function(e){var t=e.type,n=t===void 0?"linear":t,r=e.points,a=r===void 0?[]:r,o=e.baseLine,i=e.layout,s=e.connectNulls,c=s===void 0?!1:s,l=YSe(n,i),u=c?a.filter(function(y){return Vy(y)}):a,d;if(Array.isArray(o)){var p=c?o.filter(function(y){return Vy(y)}):o,f=u.map(function(y,m){return BU(BU({},y),{},{base:p[m]})});return i==="vertical"?d=Jm().y(fp).x1(pp).x0(function(y){return y.base.x}):d=Jm().x(pp).y1(fp).y0(function(y){return y.base.y}),d.defined(Vy).curve(l),d(f)}return i==="vertical"&&ye(o)?d=Jm().y(fp).x1(pp).x0(o):ye(o)?d=Jm().x(pp).y1(fp).y0(o):d=HB().x(pp).y(fp),d.defined(Vy).curve(l),d(u)},VU=function(e){var t=e.className,n=e.points,r=e.path,a=e.pathRef;if((!n||!n.length)&&!r)return null;var o=n&&n.length?JSe(e):r;return W.createElement("path",rC({},yt(e,!1),qm(e),{className:xt("recharts-curve",t),d:o,ref:a}))},UU={exports:{}},aC,WU;function eEe(){if(WU)return aC;WU=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return aC=e,aC}var oC,HU;function tEe(){if(HU)return oC;HU=1;var e=eEe();function t(){}function n(){}return n.resetWarningCache=t,oC=function(){function r(i,s,c,l,u,d){if(d!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o},oC}var qU;function nEe(){return qU||(qU=1,UU.exports=tEe()()),UU.exports}var rEe=nEe();const qe=ot(rEe);var aEe=Object.getOwnPropertyNames,oEe=Object.getOwnPropertySymbols,iEe=Object.prototype.hasOwnProperty;function KU(e,t){return function(n,r,a){return e(n,r,a)&&t(n,r,a)}}function Uy(e){return function(t,n,r){if(!t||!n||typeof t!="object"||typeof n!="object")return e(t,n,r);var a=r.cache,o=a.get(t),i=a.get(n);if(o&&i)return o===n&&i===t;a.set(t,n),a.set(n,t);var s=e(t,n,r);return a.delete(t),a.delete(n),s}}function XU(e){return aEe(e).concat(oEe(e))}var ZU=Object.hasOwn||function(e,t){return iEe.call(e,t)};function sl(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var GU="_owner",QU=Object.getOwnPropertyDescriptor,YU=Object.keys;function sEe(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function cEe(e,t){return sl(e.getTime(),t.getTime())}function JU(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.entries(),o=0,i,s;(i=a.next())&&!i.done;){for(var c=t.entries(),l=!1,u=0;(s=c.next())&&!s.done;){var d=i.value,p=d[0],f=d[1],y=s.value,m=y[0],v=y[1];!l&&!r[u]&&(l=n.equals(p,m,o,u,e,t,n)&&n.equals(f,v,p,m,e,t,n))&&(r[u]=!0),u++}if(!l)return!1;o++}return!0}function lEe(e,t,n){var r=YU(e),a=r.length;if(YU(t).length!==a)return!1;for(var o;a-- >0;)if(o=r[a],o===GU&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!ZU(t,o)||!n.equals(e[o],t[o],o,o,e,t,n))return!1;return!0}function hp(e,t,n){var r=XU(e),a=r.length;if(XU(t).length!==a)return!1;for(var o,i,s;a-- >0;)if(o=r[a],o===GU&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!ZU(t,o)||!n.equals(e[o],t[o],o,o,e,t,n)||(i=QU(e,o),s=QU(t,o),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return!1;return!0}function uEe(e,t){return sl(e.valueOf(),t.valueOf())}function dEe(e,t){return e.source===t.source&&e.flags===t.flags}function eW(e,t,n){if(e.size!==t.size)return!1;for(var r={},a=e.values(),o,i;(o=a.next())&&!o.done;){for(var s=t.values(),c=!1,l=0;(i=s.next())&&!i.done;)!c&&!r[l]&&(c=n.equals(o.value,i.value,o.value,i.value,e,t,n))&&(r[l]=!0),l++;if(!c)return!1}return!0}function pEe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var fEe="[object Arguments]",hEe="[object Boolean]",mEe="[object Date]",yEe="[object Map]",gEe="[object Number]",vEe="[object Object]",bEe="[object RegExp]",wEe="[object Set]",xEe="[object String]",_Ee=Array.isArray,tW=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,nW=Object.assign,jEe=Object.prototype.toString.call.bind(Object.prototype.toString);function SEe(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,a=e.areObjectsEqual,o=e.arePrimitiveWrappersEqual,i=e.areRegExpsEqual,s=e.areSetsEqual,c=e.areTypedArraysEqual;return function(l,u,d){if(l===u)return!0;if(l==null||u==null||typeof l!="object"||typeof u!="object")return l!==l&&u!==u;var p=l.constructor;if(p!==u.constructor)return!1;if(p===Object)return a(l,u,d);if(_Ee(l))return t(l,u,d);if(tW!=null&&tW(l))return c(l,u,d);if(p===Date)return n(l,u,d);if(p===RegExp)return i(l,u,d);if(p===Map)return r(l,u,d);if(p===Set)return s(l,u,d);var f=jEe(l);return f===mEe?n(l,u,d):f===bEe?i(l,u,d):f===yEe?r(l,u,d):f===wEe?s(l,u,d):f===vEe?typeof l.then!="function"&&typeof u.then!="function"&&a(l,u,d):f===fEe?a(l,u,d):f===hEe||f===gEe||f===xEe?o(l,u,d):!1}}function EEe(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,a={areArraysEqual:r?hp:sEe,areDatesEqual:cEe,areMapsEqual:r?KU(JU,hp):JU,areObjectsEqual:r?hp:lEe,arePrimitiveWrappersEqual:uEe,areRegExpsEqual:dEe,areSetsEqual:r?KU(eW,hp):eW,areTypedArraysEqual:r?hp:pEe};if(n&&(a=nW({},a,n(a))),t){var o=Uy(a.areArraysEqual),i=Uy(a.areMapsEqual),s=Uy(a.areObjectsEqual),c=Uy(a.areSetsEqual);a=nW({},a,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c})}return a}function OEe(e){return function(t,n,r,a,o,i,s){return e(t,n,s)}}function CEe(e){var t=e.circular,n=e.comparator,r=e.createState,a=e.equals,o=e.strict;if(r)return function(s,c){var l=r(),u=l.cache,d=u===void 0?t?new WeakMap:void 0:u,p=l.meta;return n(s,c,{cache:d,equals:a,meta:p,strict:o})};if(t)return function(s,c){return n(s,c,{cache:new WeakMap,equals:a,meta:void 0,strict:o})};var i={cache:void 0,equals:a,meta:void 0,strict:o};return function(s,c){return n(s,c,i)}}var NEe=_i();_i({strict:!0}),_i({circular:!0}),_i({circular:!0,strict:!0}),_i({createInternalComparator:function(){return sl}}),_i({strict:!0,createInternalComparator:function(){return sl}}),_i({circular:!0,createInternalComparator:function(){return sl}}),_i({circular:!0,createInternalComparator:function(){return sl},strict:!0});function _i(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,a=e.createState,o=e.strict,i=o===void 0?!1:o,s=EEe(e),c=SEe(s),l=r?r(c):OEe(c);return CEe({circular:n,comparator:c,createState:a,equals:l,strict:i})}function MEe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function rW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function a(o){n<0&&(n=o),o-n>t?(e(o),n=-1):MEe(a)};requestAnimationFrame(r)}function iC(e){"@babel/helpers - typeof";return iC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iC(e)}function PEe(e){return IEe(e)||TEe(e)||AEe(e)||kEe()}function kEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AEe(e,t){if(e){if(typeof e=="string")return aW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aW(e,t)}}function aW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function TEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IEe(e){if(Array.isArray(e))return e}function REe(){var e={},t=function(){return null},n=!1,r=function a(o){if(!n){if(Array.isArray(o)){if(!o.length)return;var i=o,s=PEe(i),c=s[0],l=s.slice(1);if(typeof c=="number"){rW(a.bind(null,l),c);return}a(c),rW(a.bind(null,l));return}iC(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){n=!0},start:function(a){n=!1,r(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function mp(e){"@babel/helpers - typeof";return mp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mp(e)}function oW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function iW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oW(Object(n),!0).forEach(function(r){sW(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function sW(e,t,n){return t=DEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DEe(e){var t=LEe(e,"string");return mp(t)==="symbol"?t:String(t)}function LEe(e,t){if(mp(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(mp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $Ee=function(e,t){return[Object.keys(e),Object.keys(t)].reduce(function(n,r){return n.filter(function(a){return r.includes(a)})})},FEe=function(e){return e},BEe=function(e){return e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})},yp=function(e,t){return Object.keys(t).reduce(function(n,r){return iW(iW({},n),{},sW({},r,e(r,t[r])))},{})},cW=function(e,t,n){return e.map(function(r){return"".concat(BEe(r)," ").concat(t,"ms ").concat(n)}).join(",")};function zEe(e,t){return WEe(e)||UEe(e,t)||lW(e,t)||VEe()}function VEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function WEe(e){if(Array.isArray(e))return e}function HEe(e){return XEe(e)||KEe(e)||lW(e)||qEe()}function qEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lW(e,t){if(e){if(typeof e=="string")return sC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sC(e,t)}}function KEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XEe(e){if(Array.isArray(e))return sC(e)}function sC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wy=1e-4,uW=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},dW=function(e,t){return e.map(function(n,r){return n*Math.pow(t,r)}).reduce(function(n,r){return n+r})},pW=function(e,t){return function(n){var r=uW(e,t);return dW(r,n)}},ZEe=function(e,t){return function(n){var r=uW(e,t),a=[].concat(HEe(r.map(function(o,i){return o*i}).slice(1)),[0]);return dW(a,n)}},fW=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],o=t[2],i=t[3];if(t.length===1)switch(t[0]){case"linear":r=0,a=0,o=1,i=1;break;case"ease":r=.25,a=.1,o=.25,i=1;break;case"ease-in":r=.42,a=0,o=1,i=1;break;case"ease-out":r=.42,a=0,o=.58,i=1;break;case"ease-in-out":r=0,a=0,o=.58,i=1;break;default:{var s=t[0].split("(");if(s[0]==="cubic-bezier"&&s[1].split(")")[0].split(",").length===4){var c=s[1].split(")")[0].split(",").map(function(m){return parseFloat(m)}),l=zEe(c,4);r=l[0],a=l[1],o=l[2],i=l[3]}}}var u=pW(r,o),d=pW(a,i),p=ZEe(r,o),f=function(m){return m>1?1:m<0?0:m},y=function(m){for(var v=m>1?1:m,b=v,w=0;w<8;++w){var j=u(b)-v,x=p(b);if(Math.abs(j-v)<Wy||x<Wy)return d(b);b=f(b-j/x)}return d(b)};return y.isStepper=!1,y},GEe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.stiff,n=t===void 0?100:t,r=e.damping,a=r===void 0?8:r,o=e.dt,i=o===void 0?17:o,s=function(c,l,u){var d=-(c-l)*n,p=u*a,f=u+(d-p)*i/1e3,y=u*i/1e3+c;return Math.abs(y-l)<Wy&&Math.abs(f)<Wy?[l,0]:[y,f]};return s.isStepper=!0,s.dt=i,s},QEe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if(typeof r=="string")switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return fW(r);case"spring":return GEe();default:if(r.split("(")[0]==="cubic-bezier")return fW(r)}return typeof r=="function"?r:null};function gp(e){"@babel/helpers - typeof";return gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gp(e)}function hW(e){return eOe(e)||JEe(e)||yW(e)||YEe()}function YEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eOe(e){if(Array.isArray(e))return lC(e)}function mW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function jn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mW(Object(n),!0).forEach(function(r){cC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function cC(e,t,n){return t=tOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tOe(e){var t=nOe(e,"string");return gp(t)==="symbol"?t:String(t)}function nOe(e,t){if(gp(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(gp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rOe(e,t){return iOe(e)||oOe(e,t)||yW(e,t)||aOe()}function aOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yW(e,t){if(e){if(typeof e=="string")return lC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lC(e,t)}}function lC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function iOe(e){if(Array.isArray(e))return e}var Hy=function(e,t,n){return e+(t-e)*n},uC=function(e){var t=e.from,n=e.to;return t!==n},sOe=function e(t,n,r){var a=yp(function(o,i){if(uC(i)){var s=t(i.from,i.to,i.velocity),c=rOe(s,2),l=c[0],u=c[1];return jn(jn({},i),{},{from:l,velocity:u})}return i},n);return r<1?yp(function(o,i){return uC(i)?jn(jn({},i),{},{velocity:Hy(i.velocity,a[o].velocity,r),from:Hy(i.from,a[o].from,r)}):i},n):e(t,a,r-1)};const cOe=function(e,t,n,r,a){var o=$Ee(e,t),i=o.reduce(function(v,b){return jn(jn({},v),{},cC({},b,[e[b],t[b]]))},{}),s=o.reduce(function(v,b){return jn(jn({},v),{},cC({},b,{from:e[b],velocity:0,to:t[b]}))},{}),c=-1,l,u,d=function(){return null},p=function(){return yp(function(v,b){return b.from},s)},f=function(){return!Object.values(s).filter(uC).length},y=function(v){l||(l=v);var b=v-l,w=b/n.dt;s=sOe(n,s,w),a(jn(jn(jn({},e),t),p())),l=v,f()||(c=requestAnimationFrame(d))},m=function(v){u||(u=v);var b=(v-u)/r,w=yp(function(x,_){return Hy.apply(void 0,hW(_).concat([n(b)]))},i);if(a(jn(jn(jn({},e),t),w)),b<1)c=requestAnimationFrame(d);else{var j=yp(function(x,_){return Hy.apply(void 0,hW(_).concat([n(1)]))},i);a(jn(jn(jn({},e),t),j))}};return d=n.isStepper?y:m,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(c)}}};function cl(e){"@babel/helpers - typeof";return cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cl(e)}var lOe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function uOe(e,t){if(e==null)return{};var n=dOe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dOe(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,o;for(o=0;o<r.length;o++)a=r[o],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function dC(e){return mOe(e)||hOe(e)||fOe(e)||pOe()}function pOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fOe(e,t){if(e){if(typeof e=="string")return pC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pC(e,t)}}function hOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mOe(e){if(Array.isArray(e))return pC(e)}function pC(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function la(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gW(Object(n),!0).forEach(function(r){vp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function vp(e,t,n){return t=vW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gOe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vW(r.key),r)}}function vOe(e,t,n){return t&&gOe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vW(e){var t=bOe(e,"string");return cl(t)==="symbol"?t:String(t)}function bOe(e,t){if(cl(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cl(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fC(e,t)}function fC(e,t){return fC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},fC(e,t)}function xOe(e){var t=_Oe();return function(){var n=qy(e),r;if(t){var a=qy(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return hC(this,r)}}function hC(e,t){if(t&&(cl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mC(e)}function mC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Oe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qy(e){return qy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qy(e)}var ji=function(e){wOe(n,e);var t=xOe(n);function n(r,a){var o;yOe(this,n),o=t.call(this,r,a);var i=o.props,s=i.isActive,c=i.attributeName,l=i.from,u=i.to,d=i.steps,p=i.children,f=i.duration;if(o.handleStyleChange=o.handleStyleChange.bind(mC(o)),o.changeStyle=o.changeStyle.bind(mC(o)),!s||f<=0)return o.state={style:{}},typeof p=="function"&&(o.state={style:u}),hC(o);if(d&&d.length)o.state={style:d[0].style};else if(l){if(typeof p=="function")return o.state={style:l},hC(o);o.state={style:c?vp({},c,l):l}}else o.state={style:{}};return o}return vOe(n,[{key:"componentDidMount",value:function(){var r=this.props,a=r.isActive,o=r.canBegin;this.mounted=!0,!(!a||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(r){var a=this.props,o=a.isActive,i=a.canBegin,s=a.attributeName,c=a.shouldReAnimate,l=a.to,u=a.from,d=this.state.style;if(i){if(!o){var p={style:s?vp({},s,l):l};this.state&&d&&(s&&d[s]!==l||!s&&d!==l)&&this.setState(p);return}if(!(NEe(r.to,l)&&r.canBegin&&r.isActive)){var f=!r.canBegin||!r.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var y=f||c?u:r.to;if(this.state&&d){var m={style:s?vp({},s,y):y};(s&&d[s]!==y||!s&&d!==y)&&this.setState(m)}this.runAnimation(la(la({},this.props),{},{from:y,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var r=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),r&&r()}},{key:"handleStyleChange",value:function(r){this.changeStyle(r)}},{key:"changeStyle",value:function(r){this.mounted&&this.setState({style:r})}},{key:"runJSAnimation",value:function(r){var a=this,o=r.from,i=r.to,s=r.duration,c=r.easing,l=r.begin,u=r.onAnimationEnd,d=r.onAnimationStart,p=cOe(o,i,QEe(c),s,this.changeStyle),f=function(){a.stopJSAnimation=p()};this.manager.start([d,l,f,s,u])}},{key:"runStepAnimation",value:function(r){var a=this,o=r.steps,i=r.begin,s=r.onAnimationStart,c=o[0],l=c.style,u=c.duration,d=u===void 0?0:u,p=function(f,y,m){if(m===0)return f;var v=y.duration,b=y.easing,w=b===void 0?"ease":b,j=y.style,x=y.properties,_=y.onAnimationEnd,S=m>0?o[m-1]:y,E=x||Object.keys(j);if(typeof w=="function"||w==="spring")return[].concat(dC(f),[a.runJSAnimation.bind(a,{from:S.style,to:j,duration:v,easing:w}),v]);var O=cW(E,v,w),M=la(la(la({},S.style),j),{},{transition:O});return[].concat(dC(f),[M,v,_]).filter(FEe)};return this.manager.start([s].concat(dC(o.reduce(p,[l,Math.max(d,i)])),[r.onAnimationEnd]))}},{key:"runAnimation",value:function(r){this.manager||(this.manager=REe());var a=r.begin,o=r.duration,i=r.attributeName,s=r.to,c=r.easing,l=r.onAnimationStart,u=r.onAnimationEnd,d=r.steps,p=r.children,f=this.manager;if(this.unSubscribe=f.subscribe(this.handleStyleChange),typeof c=="function"||typeof p=="function"||c==="spring"){this.runJSAnimation(r);return}if(d.length>1){this.runStepAnimation(r);return}var y=i?vp({},i,s):s,m=cW(Object.keys(y),o,c);f.start([l,a,la(la({},y),{},{transition:m}),o,u])}},{key:"render",value:function(){var r=this.props,a=r.children;r.begin;var o=r.duration;r.attributeName,r.easing;var i=r.isActive;r.steps,r.from,r.to,r.canBegin,r.onAnimationEnd,r.shouldReAnimate,r.onAnimationReStart;var s=uOe(r,lOe),c=g.Children.count(a),l=this.state.style;if(typeof a=="function")return a(l);if(!i||c===0||o<=0)return a;var u=function(d){var p=d.props,f=p.style,y=f===void 0?{}:f,m=p.className,v=g.cloneElement(d,la(la({},s),{},{style:la(la({},y),l),className:m}));return v};return c===1?u(g.Children.only(a)):W.createElement("div",null,g.Children.map(a,function(d){return u(d)}))}}]),n}(g.PureComponent);ji.displayName="Animate",ji.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},ji.propTypes={from:qe.oneOfType([qe.object,qe.string]),to:qe.oneOfType([qe.object,qe.string]),attributeName:qe.string,duration:qe.number,begin:qe.number,easing:qe.oneOfType([qe.string,qe.func]),steps:qe.arrayOf(qe.shape({duration:qe.number.isRequired,style:qe.object.isRequired,easing:qe.oneOfType([qe.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),qe.func]),properties:qe.arrayOf("string"),onAnimationEnd:qe.func})),children:qe.oneOfType([qe.node,qe.func]),isActive:qe.bool,canBegin:qe.bool,onAnimationEnd:qe.func,shouldReAnimate:qe.bool,onAnimationStart:qe.func,onAnimationReStart:qe.func},qe.object,qe.object,qe.object,qe.element,qe.object,qe.object,qe.object,qe.oneOfType([qe.array,qe.element]),qe.any;function bp(e){"@babel/helpers - typeof";return bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bp(e)}function Ky(){return Ky=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ky.apply(this,arguments)}function jOe(e,t){return COe(e)||OOe(e,t)||EOe(e,t)||SOe()}function SOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EOe(e,t){if(e){if(typeof e=="string")return bW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bW(e,t)}}function bW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function OOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function COe(e){if(Array.isArray(e))return e}function wW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function xW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wW(Object(n),!0).forEach(function(r){NOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function NOe(e,t,n){return t=MOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MOe(e){var t=POe(e,"string");return bp(t)=="symbol"?t:t+""}function POe(e,t){if(bp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _W=function(e,t,n,r,a){var o=Math.min(Math.abs(n)/2,Math.abs(r)/2),i=r>=0?1:-1,s=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0,l;if(o>0&&a instanceof Array){for(var u=[0,0,0,0],d=0,p=4;d<p;d++)u[d]=a[d]>o?o:a[d];l="M".concat(e,",").concat(t+i*u[0]),u[0]>0&&(l+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+s*u[0],",").concat(t)),l+="L ".concat(e+n-s*u[1],",").concat(t),u[1]>0&&(l+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+n,",").concat(t+i*u[1])),l+="L ".concat(e+n,",").concat(t+r-i*u[2]),u[2]>0&&(l+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+n-s*u[2],",").concat(t+r)),l+="L ".concat(e+s*u[3],",").concat(t+r),u[3]>0&&(l+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+r-i*u[3])),l+="Z"}else if(o>0&&a===+a&&a>0){var f=Math.min(o,a);l="M ".concat(e,",").concat(t+i*f,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e+s*f,",").concat(t,`
            L `).concat(e+n-s*f,",").concat(t,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e+n,",").concat(t+i*f,`
            L `).concat(e+n,",").concat(t+r-i*f,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e+n-s*f,",").concat(t+r,`
            L `).concat(e+s*f,",").concat(t+r,`
            A `).concat(f,",").concat(f,",0,0,").concat(c,",").concat(e,",").concat(t+r-i*f," Z")}else l="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return l},kOe=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,a=t.x,o=t.y,i=t.width,s=t.height;if(Math.abs(i)>0&&Math.abs(s)>0){var c=Math.min(a,a+i),l=Math.max(a,a+i),u=Math.min(o,o+s),d=Math.max(o,o+s);return n>=c&&n<=l&&r>=u&&r<=d}return!1},AOe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},yC=function(e){var t=xW(xW({},AOe),e),n=g.useRef(),r=g.useState(-1),a=jOe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var j=n.current.getTotalLength();j&&i(j)}catch{}},[]);var s=t.x,c=t.y,l=t.width,u=t.height,d=t.radius,p=t.className,f=t.animationEasing,y=t.animationDuration,m=t.animationBegin,v=t.isAnimationActive,b=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||l===0||u===0)return null;var w=xt("recharts-rectangle",p);return b?W.createElement(ji,{canBegin:o>0,from:{width:l,height:u,x:s,y:c},to:{width:l,height:u,x:s,y:c},duration:y,animationEasing:f,isActive:b},function(j){var x=j.width,_=j.height,S=j.x,E=j.y;return W.createElement(ji,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:y,isActive:v,easing:f},W.createElement("path",Ky({},yt(t,!0),{className:w,d:_W(S,E,x,_,d),ref:n})))}):W.createElement("path",Ky({},yt(t,!0),{className:w,d:_W(s,c,l,u,d)}))};function gC(){return gC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gC.apply(this,arguments)}var jW=function(e){var t=e.cx,n=e.cy,r=e.r,a=e.className,o=xt("recharts-dot",a);return t===+t&&n===+n&&r===+r?W.createElement("circle",gC({},yt(e,!1),qm(e),{className:o,cx:t,cy:n,r})):null};function wp(e){"@babel/helpers - typeof";return wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wp(e)}var TOe=["x","y","top","left","width","height","className"];function vC(){return vC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vC.apply(this,arguments)}function SW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function IOe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?SW(Object(n),!0).forEach(function(r){ROe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ROe(e,t,n){return t=DOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DOe(e){var t=LOe(e,"string");return wp(t)=="symbol"?t:t+""}function LOe(e,t){if(wp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Oe(e,t){if(e==null)return{};var n=FOe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function FOe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var BOe=function(e,t,n,r,a,o){return"M".concat(e,",").concat(a,"v").concat(r,"M").concat(o,",").concat(t,"h").concat(n)},zOe=function(e){var t=e.x,n=t===void 0?0:t,r=e.y,a=r===void 0?0:r,o=e.top,i=o===void 0?0:o,s=e.left,c=s===void 0?0:s,l=e.width,u=l===void 0?0:l,d=e.height,p=d===void 0?0:d,f=e.className,y=$Oe(e,TOe),m=IOe({x:n,y:a,top:i,left:c,width:u,height:p},y);return!ye(n)||!ye(a)||!ye(u)||!ye(p)||!ye(i)||!ye(c)?null:W.createElement("path",vC({},yt(m,!0),{className:xt("recharts-cross",f),d:BOe(n,a,u,p,i,c)}))},bC,EW;PN=function(){if(EW)return bC;EW=1;var e=fo(),t=Nv(),n=ha(),r="[object Object]",a=Function.prototype,o=Object.prototype,i=a.toString,s=o.hasOwnProperty,c=i.call(Object);function l(u){if(!n(u)||e(u)!=r)return!1;var d=t(u);if(d===null)return!0;var p=s.call(d,"constructor")&&d.constructor;return typeof p=="function"&&p instanceof p&&i.call(p)==c}return bC=l,bC};var VOe=PN();const UOe=ot(VOe);var wC,OW;function WOe(){if(OW)return wC;OW=1;var e=fo(),t=ha(),n="[object Boolean]";function r(a){return a===!0||a===!1||t(a)&&e(a)==n}return wC=r,wC}var HOe=WOe();const qOe=ot(HOe);function xp(e){"@babel/helpers - typeof";return xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xp(e)}function Xy(){return Xy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xy.apply(this,arguments)}function KOe(e,t){return QOe(e)||GOe(e,t)||ZOe(e,t)||XOe()}function XOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZOe(e,t){if(e){if(typeof e=="string")return CW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CW(e,t)}}function CW(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function GOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function QOe(e){if(Array.isArray(e))return e}function NW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function MW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NW(Object(n),!0).forEach(function(r){YOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function YOe(e,t,n){return t=JOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JOe(e){var t=eCe(e,"string");return xp(t)=="symbol"?t:t+""}function eCe(e,t){if(xp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PW=function(e,t,n,r,a){var o=n-r,i;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+n,",").concat(t),i+="L ".concat(e+n-o/2,",").concat(t+a),i+="L ".concat(e+n-o/2-r,",").concat(t+a),i+="L ".concat(e,",").concat(t," Z"),i},tCe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},nCe=function(e){var t=MW(MW({},tCe),e),n=g.useRef(),r=g.useState(-1),a=KOe(r,2),o=a[0],i=a[1];g.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&i(w)}catch{}},[]);var s=t.x,c=t.y,l=t.upperWidth,u=t.lowerWidth,d=t.height,p=t.className,f=t.animationEasing,y=t.animationDuration,m=t.animationBegin,v=t.isUpdateAnimationActive;if(s!==+s||c!==+c||l!==+l||u!==+u||d!==+d||l===0&&u===0||d===0)return null;var b=xt("recharts-trapezoid",p);return v?W.createElement(ji,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:d,x:s,y:c},to:{upperWidth:l,lowerWidth:u,height:d,x:s,y:c},duration:y,animationEasing:f,isActive:v},function(w){var j=w.upperWidth,x=w.lowerWidth,_=w.height,S=w.x,E=w.y;return W.createElement(ji,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:y,easing:f},W.createElement("path",Xy({},yt(t,!0),{className:b,d:PW(S,E,j,x,_),ref:n})))}):W.createElement("g",null,W.createElement("path",Xy({},yt(t,!0),{className:b,d:PW(s,c,l,u,d)})))},rCe=["option","shapeType","propTransformer","activeClassName","isActive"];function _p(e){"@babel/helpers - typeof";return _p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_p(e)}function aCe(e,t){if(e==null)return{};var n=oCe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oCe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function kW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Zy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kW(Object(n),!0).forEach(function(r){iCe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function iCe(e,t,n){return t=sCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sCe(e){var t=cCe(e,"string");return _p(t)=="symbol"?t:t+""}function cCe(e,t){if(_p(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_p(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lCe(e,t){return Zy(Zy({},t),e)}function uCe(e,t){return e==="symbols"}function AW(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return W.createElement(yC,n);case"trapezoid":return W.createElement(nCe,n);case"sector":return W.createElement($U,n);case"symbols":if(uCe(t))return W.createElement(sE,n);break;default:return null}}function dCe(e){return g.isValidElement(e)?e.props:e}function pCe(e){var t=e.option,n=e.shapeType,r=e.propTransformer,a=r===void 0?lCe:r,o=e.activeClassName,i=o===void 0?"recharts-active-shape":o,s=e.isActive,c=aCe(e,rCe),l;if(g.isValidElement(t))l=g.cloneElement(t,Zy(Zy({},c),dCe(t)));else if(tt(t))l=t(c);else if(UOe(t)&&!qOe(t)){var u=a(t,c);l=W.createElement(AW,{shapeType:n,elementProps:u})}else{var d=c;l=W.createElement(AW,{shapeType:n,elementProps:d})}return s?W.createElement(fn,{className:i},l):l}function Gy(e,t){return t!=null&&"trapezoids"in e.props}function Qy(e,t){return t!=null&&"sectors"in e.props}function jp(e,t){return t!=null&&"points"in e.props}function fCe(e,t){var n,r,a=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,o=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return a&&o}function hCe(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function mCe(e,t){var n=e.x===t.x,r=e.y===t.y,a=e.z===t.z;return n&&r&&a}function yCe(e,t){var n;return Gy(e,t)?n=fCe:Qy(e,t)?n=hCe:jp(e,t)&&(n=mCe),n}function gCe(e,t){var n;return Gy(e,t)?n="trapezoids":Qy(e,t)?n="sectors":jp(e,t)&&(n="points"),n}function vCe(e,t){if(Gy(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(Qy(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return jp(e,t)?t.payload:{}}function bCe(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,a=gCe(n,t),o=vCe(n,t),i=r.filter(function(c,l){var u=FO(o,c),d=n.props[a].filter(function(y){var m=yCe(n,t);return m(y,t)}),p=n.props[a].indexOf(d[d.length-1]),f=l===p;return u&&f}),s=r.indexOf(i[i.length-1]);return s}var xC,TW;function wCe(){if(TW)return xC;TW=1;var e=Math.ceil,t=Math.max;function n(r,a,o,i){for(var s=-1,c=t(e((a-r)/(o||1)),0),l=Array(c);c--;)l[i?c:++s]=r,r+=o;return l}return xC=n,xC}var _C,IW;function xCe(){if(IW)return _C;IW=1;var e=wCe(),t=Es(),n=V$();function r(a){return function(o,i,s){return s&&typeof s!="number"&&t(o,i,s)&&(i=s=void 0),o=n(o),i===void 0?(i=o,o=0):i=n(i),s=s===void 0?o<i?1:-1:n(s),e(o,i,s,a)}}return _C=r,_C}var jC,RW;function _Ce(){if(RW)return jC;RW=1;var e=xCe(),t=e();return jC=t,jC}var jCe=_Ce();const Yy=ot(jCe);function Sp(e){"@babel/helpers - typeof";return Sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sp(e)}function DW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function LW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?DW(Object(n),!0).forEach(function(r){$W(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $W(e,t,n){return t=SCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SCe(e){var t=ECe(e,"string");return Sp(t)=="symbol"?t:t+""}function ECe(e,t){if(Sp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Sp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OCe=["Webkit","Moz","O","ms"],CCe=function(e,t){var n=e.replace(/(\w)/,function(a){return a.toUpperCase()}),r=OCe.reduce(function(a,o){return LW(LW({},a),{},$W({},o+n,t))},{});return r[e]=t,r};function ll(e){"@babel/helpers - typeof";return ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ll(e)}function Jy(){return Jy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jy.apply(this,arguments)}function FW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function SC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FW(Object(n),!0).forEach(function(r){mr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function NCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,VW(r.key),r)}}function MCe(e,t,n){return t&&BW(e.prototype,t),n&&BW(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function PCe(e,t,n){return t=eg(t),kCe(e,zW()?Reflect.construct(t,n||[],eg(e).constructor):t.apply(e,n))}function kCe(e,t){if(t&&(ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ACe(e)}function ACe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zW=function(){return!!e})()}function eg(e){return eg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},eg(e)}function TCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EC(e,t)}function EC(e,t){return EC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},EC(e,t)}function mr(e,t,n){return t=VW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VW(e){var t=ICe(e,"string");return ll(t)=="symbol"?t:t+""}function ICe(e,t){if(ll(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ll(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RCe=function(e){var t=e.data,n=e.startIndex,r=e.endIndex,a=e.x,o=e.width,i=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,c=Zd().domain(Yy(0,s)).range([a,a+o-i]),l=c.domain().map(function(u){return c(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(n),endX:c(r),scale:c,scaleValues:l}},UW=function(e){return e.changedTouches&&!!e.changedTouches.length},ul=function(e){function t(n){var r;return NCe(this,t),r=PCe(this,t,[n]),mr(r,"handleDrag",function(a){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(a):r.state.isSlideMoving&&r.handleSlideDrag(a)}),mr(r,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&r.handleDrag(a.changedTouches[0])}),mr(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=r.props,o=a.endIndex,i=a.onDragEnd,s=a.startIndex;i==null||i({endIndex:o,startIndex:s})}),r.detachDragEndListener()}),mr(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),mr(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),mr(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),mr(r,"handleSlideDragStart",function(a){var o=UW(a)?a.changedTouches[0]:a;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return TCe(t,e),MCe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var r=n.startX,a=n.endX,o=this.state.scaleValues,i=this.props,s=i.gap,c=i.data,l=c.length-1,u=Math.min(r,a),d=Math.max(r,a),p=t.getIndexInRange(o,u),f=t.getIndexInRange(o,d);return{startIndex:p-p%s,endIndex:f===l?l:f-f%s}}},{key:"getTextOfTick",value:function(n){var r=this.props,a=r.data,o=r.tickFormatter,i=r.dataKey,s=Fa(a[n],i,n);return tt(o)?o(s,n):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var r=this.state,a=r.slideMoveStartX,o=r.startX,i=r.endX,s=this.props,c=s.x,l=s.width,u=s.travellerWidth,d=s.startIndex,p=s.endIndex,f=s.onChange,y=n.pageX-a;y>0?y=Math.min(y,c+l-u-i,c+l-u-o):y<0&&(y=Math.max(y,c-o,c-i));var m=this.getIndex({startX:o+y,endX:i+y});(m.startIndex!==d||m.endIndex!==p)&&f&&f(m),this.setState({startX:o+y,endX:i+y,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,r){var a=UW(r)?r.changedTouches[0]:r;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var r=this.state,a=r.brushMoveStartX,o=r.movingTravellerId,i=r.endX,s=r.startX,c=this.state[o],l=this.props,u=l.x,d=l.width,p=l.travellerWidth,f=l.onChange,y=l.gap,m=l.data,v={startX:this.state.startX,endX:this.state.endX},b=n.pageX-a;b>0?b=Math.min(b,u+d-p-c):b<0&&(b=Math.max(b,u-c)),v[o]=c+b;var w=this.getIndex(v),j=w.startIndex,x=w.endIndex,_=function(){var S=m.length-1;return o==="startX"&&(i>s?j%y===0:x%y===0)||i<s&&x===S||o==="endX"&&(i>s?x%y===0:j%y===0)||i>s&&x===S};this.setState(mr(mr({},o,c+b),"brushMoveStartX",n.pageX),function(){f&&_()&&f(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,r){var a=this,o=this.state,i=o.scaleValues,s=o.startX,c=o.endX,l=this.state[r],u=i.indexOf(l);if(u!==-1){var d=u+n;if(!(d===-1||d>=i.length)){var p=i[d];r==="startX"&&p>=c||r==="endX"&&p<=s||this.setState(mr({},r,p),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.fill,c=n.stroke;return W.createElement("rect",{stroke:c,fill:s,x:r,y:a,width:o,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.data,c=n.children,l=n.padding,u=g.Children.only(c);return u?W.cloneElement(u,{x:r,y:a,width:o,height:i,margin:l,compact:!0,data:s}):null}},{key:"renderTravellerLayer",value:function(n,r){var a,o,i=this,s=this.props,c=s.y,l=s.travellerWidth,u=s.height,d=s.traveller,p=s.ariaLabel,f=s.data,y=s.startIndex,m=s.endIndex,v=Math.max(n,this.props.x),b=SC(SC({},yt(this.props,!1)),{},{x:v,y:c,width:l,height:u}),w=p||"Min value: ".concat((a=f[y])===null||a===void 0?void 0:a.name,", Max value: ").concat((o=f[m])===null||o===void 0?void 0:o.name);return W.createElement(fn,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(j){["ArrowLeft","ArrowRight"].includes(j.key)&&(j.preventDefault(),j.stopPropagation(),i.handleTravellerMoveKeyboard(j.key==="ArrowRight"?1:-1,r))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(d,b))}},{key:"renderSlide",value:function(n,r){var a=this.props,o=a.y,i=a.height,s=a.stroke,c=a.travellerWidth,l=Math.min(n,r)+c,u=Math.max(Math.abs(r-n)-c,0);return W.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:s,fillOpacity:.2,x:l,y:o,width:u,height:i})}},{key:"renderText",value:function(){var n=this.props,r=n.startIndex,a=n.endIndex,o=n.y,i=n.height,s=n.travellerWidth,c=n.stroke,l=this.state,u=l.startX,d=l.endX,p=5,f={pointerEvents:"none",fill:c};return W.createElement(fn,{className:"recharts-brush-texts"},W.createElement(fy,Jy({textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,d)-p,y:o+i/2},f),this.getTextOfTick(r)),W.createElement(fy,Jy({textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,d)+s+p,y:o+i/2},f),this.getTextOfTick(a)))}},{key:"render",value:function(){var n=this.props,r=n.data,a=n.className,o=n.children,i=n.x,s=n.y,c=n.width,l=n.height,u=n.alwaysShowText,d=this.state,p=d.startX,f=d.endX,y=d.isTextActive,m=d.isSlideMoving,v=d.isTravellerMoving,b=d.isTravellerFocused;if(!r||!r.length||!ye(i)||!ye(s)||!ye(c)||!ye(l)||c<=0||l<=0)return null;var w=xt("recharts-brush",a),j=W.Children.count(o)===1,x=CCe("userSelect","none");return W.createElement(fn,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:x},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(p,f),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(f,"endX"),(y||m||v||b||u)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var r=n.x,a=n.y,o=n.width,i=n.height,s=n.stroke,c=Math.floor(a+i/2)-1;return W.createElement(W.Fragment,null,W.createElement("rect",{x:r,y:a,width:o,height:i,fill:s,stroke:"none"}),W.createElement("line",{x1:r+1,y1:c,x2:r+o-1,y2:c,fill:"none",stroke:"#fff"}),W.createElement("line",{x1:r+1,y1:c+2,x2:r+o-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,r){var a;return W.isValidElement(n)?a=W.cloneElement(n,r):tt(n)?a=n(r):a=t.renderDefaultTraveller(r),a}},{key:"getDerivedStateFromProps",value:function(n,r){var a=n.data,o=n.width,i=n.x,s=n.travellerWidth,c=n.updateId,l=n.startIndex,u=n.endIndex;if(a!==r.prevData||c!==r.prevUpdateId)return SC({prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o},a&&a.length?RCe({data:a,width:o,x:i,travellerWidth:s,startIndex:l,endIndex:u}):{scale:null,scaleValues:null});if(r.scale&&(o!==r.prevWidth||i!==r.prevX||s!==r.prevTravellerWidth)){r.scale.range([i,i+o-s]);var d=r.scale.domain().map(function(p){return r.scale(p)});return{prevData:a,prevTravellerWidth:s,prevUpdateId:c,prevX:i,prevWidth:o,startX:r.scale(n.startIndex),endX:r.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,r){for(var a=n.length,o=0,i=a-1;i-o>1;){var s=Math.floor((o+i)/2);n[s]>r?i=s:o=s}return r>=n[i]?i:o}}])}(g.PureComponent);mr(ul,"displayName","Brush"),mr(ul,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var OC,WW;function DCe(){if(WW)return OC;WW=1;var e=ME();function t(n,r){var a;return e(n,function(o,i,s){return a=r(o,i,s),!a}),!!a}return OC=t,OC}var CC,HW;function LCe(){if(HW)return CC;HW=1;var e=II(),t=_a(),n=DCe(),r=In(),a=Es();function o(i,s,c){var l=r(i)?e:n;return c&&a(i,s,c)&&(s=void 0),l(i,t(s,3))}return CC=o,CC}var $Ce=LCe();const FCe=ot($Ce);var Ba=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},NC,qW;function BCe(){if(qW)return NC;qW=1;var e=Lg(),t=Rz(),n=_a();function r(a,o){var i={};return o=n(o,3),t(a,function(s,c,l){e(i,c,o(s,c,l))}),i}return NC=r,NC}var zCe=BCe();const VCe=ot(zCe);var MC,KW;function UCe(){if(KW)return MC;KW=1;function e(t,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(!n(t[r],r,t))return!1;return!0}return MC=e,MC}var PC,XW;function WCe(){if(XW)return PC;XW=1;var e=ME();function t(n,r){var a=!0;return e(n,function(o,i,s){return a=!!r(o,i,s),a}),a}return PC=t,PC}var kC,ZW;function HCe(){if(ZW)return kC;ZW=1;var e=UCe(),t=WCe(),n=_a(),r=In(),a=Es();function o(i,s,c){var l=r(i)?e:t;return c&&a(i,s,c)&&(s=void 0),l(i,n(s,3))}return kC=o,kC}var qCe=HCe();const GW=ot(qCe);var KCe=["x","y"];function Ep(e){"@babel/helpers - typeof";return Ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ep(e)}function AC(){return AC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},AC.apply(this,arguments)}function QW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Op(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?QW(Object(n),!0).forEach(function(r){XCe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function XCe(e,t,n){return t=ZCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZCe(e){var t=GCe(e,"string");return Ep(t)=="symbol"?t:t+""}function GCe(e,t){if(Ep(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ep(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QCe(e,t){if(e==null)return{};var n=YCe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YCe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function JCe(e,t){var n=e.x,r=e.y,a=QCe(e,KCe),o="".concat(n),i=parseInt(o,10),s="".concat(r),c=parseInt(s,10),l="".concat(t.height||a.height),u=parseInt(l,10),d="".concat(t.width||a.width),p=parseInt(d,10);return Op(Op(Op(Op(Op({},t),a),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:p,name:t.name,radius:t.radius})}function YW(e){return W.createElement(pCe,AC({shapeType:"rectangle",propTransformer:JCe,activeClassName:"recharts-active-bar"},e))}var eNe=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,r){if(typeof e=="number")return e;var a=typeof n=="number";return a?e(n,r):(a||ms(),t)}},tNe=["value","background"],JW;function dl(e){"@babel/helpers - typeof";return dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dl(e)}function nNe(e,t){if(e==null)return{};var n=rNe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function rNe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function tg(){return tg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tg.apply(this,arguments)}function eH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?eH(Object(n),!0).forEach(function(r){Si(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function aNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rH(r.key),r)}}function oNe(e,t,n){return t&&tH(e.prototype,t),n&&tH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function iNe(e,t,n){return t=ng(t),sNe(e,nH()?Reflect.construct(t,n||[],ng(e).constructor):t.apply(e,n))}function sNe(e,t){if(t&&(dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cNe(e)}function cNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nH=function(){return!!e})()}function ng(e){return ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ng(e)}function lNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TC(e,t)}function TC(e,t){return TC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},TC(e,t)}function Si(e,t,n){return t=rH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rH(e){var t=uNe(e,"string");return dl(t)=="symbol"?t:t+""}function uNe(e,t){if(dl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(dl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vs=function(e){function t(){var n;aNe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=iNe(this,t,[].concat(a)),Si(n,"state",{isAnimationFinished:!1}),Si(n,"id",Hm("recharts-bar-")),Si(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),i&&i()}),Si(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),i&&i()}),n}return lNe(t,e),oNe(t,[{key:"renderRectanglesStatically",value:function(n){var r=this,a=this.props,o=a.shape,i=a.dataKey,s=a.activeIndex,c=a.activeBar,l=yt(this.props,!1);return n&&n.map(function(u,d){var p=d===s,f=p?c:o,y=en(en(en({},l),u),{},{isActive:p,option:f,index:d,dataKey:i,onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd});return W.createElement(fn,tg({className:"recharts-bar-rectangle"},Km(r.props,u,d),{key:"rectangle-".concat(u==null?void 0:u.x,"-").concat(u==null?void 0:u.y,"-").concat(u==null?void 0:u.value)}),W.createElement(YW,y))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,r=this.props,a=r.data,o=r.layout,i=r.isAnimationActive,s=r.animationBegin,c=r.animationDuration,l=r.animationEasing,u=r.animationId,d=this.state.prevData;return W.createElement(ji,{begin:s,duration:c,isActive:i,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var f=p.t,y=a.map(function(m,v){var b=d&&d[v];if(b){var w=Uc(b.x,m.x),j=Uc(b.y,m.y),x=Uc(b.width,m.width),_=Uc(b.height,m.height);return en(en({},m),{},{x:w(f),y:j(f),width:x(f),height:_(f)})}if(o==="horizontal"){var S=Uc(0,m.height),E=S(f);return en(en({},m),{},{y:m.y+m.height-E,height:E})}var O=Uc(0,m.width),M=O(f);return en(en({},m),{},{width:M})});return W.createElement(fn,null,n.renderRectanglesStatically(y))})}},{key:"renderRectangles",value:function(){var n=this.props,r=n.data,a=n.isAnimationActive,o=this.state.prevData;return a&&r&&r.length&&(!o||!FO(o,r))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(r)}},{key:"renderBackground",value:function(){var n=this,r=this.props,a=r.data,o=r.dataKey,i=r.activeIndex,s=yt(this.props.background,!1);return a.map(function(c,l){c.value;var u=c.background,d=nNe(c,tNe);if(!u)return null;var p=en(en(en(en(en({},d),{},{fill:"#eee"},u),s),Km(n.props,c,l)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:l,className:"recharts-bar-background-rectangle"});return W.createElement(YW,tg({key:"background-bar-".concat(l),option:n.props.background,isActive:l===i},p))})}},{key:"renderErrorBar",value:function(n,r){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.data,i=a.xAxis,s=a.yAxis,c=a.layout,l=a.children,u=sa(l,Ry);if(!u)return null;var d=c==="vertical"?o[0].height/2:o[0].width/2,p=function(y,m){var v=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:v,errorVal:Fa(y,m)}},f={clipPath:n?"url(#clipPath-".concat(r,")"):null};return W.createElement(fn,f,u.map(function(y){return W.cloneElement(y,{key:"error-bar-".concat(r,"-").concat(y.props.dataKey),data:o,xAxis:i,yAxis:s,layout:c,offset:d,dataPointFormatter:p})}))}},{key:"render",value:function(){var n=this.props,r=n.hide,a=n.data,o=n.className,i=n.xAxis,s=n.yAxis,c=n.left,l=n.top,u=n.width,d=n.height,p=n.isAnimationActive,f=n.background,y=n.id;if(r||!a||!a.length)return null;var m=this.state.isAnimationFinished,v=xt("recharts-bar",o),b=i&&i.allowDataOverflow,w=s&&s.allowDataOverflow,j=b||w,x=gt(y)?this.id:y;return W.createElement(fn,{className:v},b||w?W.createElement("defs",null,W.createElement("clipPath",{id:"clipPath-".concat(x)},W.createElement("rect",{x:b?c:c-u/2,y:w?l:l-d/2,width:b?u:u*2,height:w?d:d*2}))):null,W.createElement(fn,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(x,")"):null},f?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,x),(!p||m)&&gs.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,r){return n.animationId!==r.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:r.curData}:n.data!==r.curData?{curData:n.data}:null}}])}(g.PureComponent);JW=vs,Si(vs,"displayName","Bar"),Si(vs,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!gi.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),Si(vs,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,o=e.xAxis,i=e.yAxis,s=e.xAxisTicks,c=e.yAxisTicks,l=e.stackedData,u=e.dataStartIndex,d=e.displayedData,p=e.offset,f=Wje(r,n);if(!f)return null;var y=t.layout,m=n.type.defaultProps,v=m!==void 0?en(en({},m),n.props):n.props,b=v.dataKey,w=v.children,j=v.minPointSize,x=y==="horizontal"?i:o,_=l?x.scale.domain():null,S=Yje({numericAxis:x}),E=sa(w,m7),O=d.map(function(M,N){var P,I,k,C,T,A;l?P=Hje(l[u+N],_):(P=Fa(M,b),Array.isArray(P)||(P=[S,P]));var D=eNe(j,JW.defaultProps.minPointSize)(P[1],N);if(y==="horizontal"){var L,R=[i.scale(P[0]),i.scale(P[1])],B=R[0],z=R[1];I=wU({axis:o,ticks:s,bandSize:a,offset:f.offset,entry:M,index:N}),k=(L=z??B)!==null&&L!==void 0?L:void 0,C=f.size;var $=B-z;if(T=Number.isNaN($)?0:$,A={x:I,y:i.y,width:C,height:i.height},Math.abs(D)>0&&Math.abs(T)<Math.abs(D)){var V=ia(T||D)*(Math.abs(D)-Math.abs(T));k-=V,T+=V}}else{var Y=[o.scale(P[0]),o.scale(P[1])],G=Y[0],K=Y[1];if(I=G,k=wU({axis:i,ticks:c,bandSize:a,offset:f.offset,entry:M,index:N}),C=K-G,T=f.size,A={x:o.x,y:k,width:o.width,height:T},Math.abs(D)>0&&Math.abs(C)<Math.abs(D)){var Q=ia(C||D)*(Math.abs(D)-Math.abs(C));C+=Q}}return en(en(en({},M),{},{x:I,y:k,width:C,height:T,value:l?P:P[1],payload:M,background:A},E&&E[N]&&E[N].props),{},{tooltipPayload:[EU(n,M)],tooltipPosition:{x:I+C/2,y:k+T/2}})});return en({data:O,layout:y},p)});function Cp(e){"@babel/helpers - typeof";return Cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cp(e)}function dNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,iH(r.key),r)}}function pNe(e,t,n){return t&&aH(e.prototype,t),n&&aH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function oH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ua(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oH(Object(n),!0).forEach(function(r){rg(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function rg(e,t,n){return t=iH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iH(e){var t=fNe(e,"string");return Cp(t)=="symbol"?t:t+""}function fNe(e,t){if(Cp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Cp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hNe=function(e,t,n,r,a){var o=e.width,i=e.height,s=e.layout,c=e.children,l=Object.keys(t),u={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},d=!!fr(c,vs);return l.reduce(function(p,f){var y=t[f],m=y.orientation,v=y.domain,b=y.padding,w=b===void 0?{}:b,j=y.mirror,x=y.reversed,_="".concat(m).concat(j?"Mirror":""),S,E,O,M,N;if(y.type==="number"&&(y.padding==="gap"||y.padding==="no-gap")){var P=v[1]-v[0],I=1/0,k=y.categoricalDomain.sort();if(k.forEach(function(V,Y){Y>0&&(I=Math.min((V||0)-(k[Y-1]||0),I))}),Number.isFinite(I)){var C=I/P,T=y.layout==="vertical"?n.height:n.width;if(y.padding==="gap"&&(S=C*T/2),y.padding==="no-gap"){var A=ss(e.barCategoryGap,C*T),D=C*T/2;S=D-A-(D-A)/T*A}}}r==="xAxis"?E=[n.left+(w.left||0)+(S||0),n.left+n.width-(w.right||0)-(S||0)]:r==="yAxis"?E=s==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(S||0),n.top+n.height-(w.bottom||0)-(S||0)]:E=y.range,x&&(E=[E[1],E[0]]);var L=Vje(y,a,d),R=L.scale,B=L.realScaleType;R.domain(v).range(E),Uje(R);var z=Qje(R,ua(ua({},y),{},{realScaleType:B}));r==="xAxis"?(N=m==="top"&&!j||m==="bottom"&&j,O=n.left,M=u[_]-N*y.height):r==="yAxis"&&(N=m==="left"&&!j||m==="right"&&j,O=u[_]-N*y.width,M=n.top);var $=ua(ua(ua({},y),z),{},{realScaleType:B,x:O,y:M,scale:R,width:r==="xAxis"?n.width:y.width,height:r==="yAxis"?n.height:y.height});return $.bandSize=$y($,z),!y.hide&&r==="xAxis"?u[_]+=(N?-1:1)*$.height:y.hide||(u[_]+=(N?-1:1)*$.width),ua(ua({},p),{},rg({},f,$))},{})},sH=function(e,t){var n=e.x,r=e.y,a=t.x,o=t.y;return{x:Math.min(n,a),y:Math.min(r,o),width:Math.abs(a-n),height:Math.abs(o-r)}},mNe=function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return sH({x:t,y:n},{x:r,y:a})},cH=function(){function e(t){dNe(this,e),this.scale=t}return pNe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.bandAware,a=n.position;if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}},{key:"isInRange",value:function(t){var n=this.range(),r=n[0],a=n[n.length-1];return r<=a?t>=r&&t<=a:t>=a&&t<=r}}],[{key:"create",value:function(t){return new e(t)}}])}();rg(cH,"EPS",1e-4);var IC=function(e){var t=Object.keys(e).reduce(function(n,r){return ua(ua({},n),{},rg({},r,cH.create(e[r])))},{});return ua(ua({},t),{},{apply:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.bandAware,o=r.position;return VCe(n,function(i,s){return t[s].apply(i,{bandAware:a,position:o})})},isInRange:function(n){return GW(n,function(r,a){return t[a].isInRange(r)})}})};function yNe(e){return(e%180+180)%180}var gNe=function(e){var t=e.width,n=e.height,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=yNe(r),o=a*Math.PI/180,i=Math.atan(n/t),s=o>i&&o<Math.PI-i?n/Math.sin(o):t/Math.cos(o);return Math.abs(s)},RC,lH;function vNe(){if(lH)return RC;lH=1;var e=_a(),t=Ni(),n=Ul();function r(a){return function(o,i,s){var c=Object(o);if(!t(o)){var l=e(i,3);o=n(o),i=function(d){return l(c[d],d,c)}}var u=a(o,i,s);return u>-1?c[l?o[u]:u]:void 0}}return RC=r,RC}var DC,uH;function bNe(){if(uH)return DC;uH=1;var e=fz(),t=_a(),n=W$(),r=Math.max;function a(o,i,s){var c=o==null?0:o.length;if(!c)return-1;var l=s==null?0:n(s);return l<0&&(l=r(c+l,0)),e(o,t(i,3),l)}return DC=a,DC}var LC,dH;function wNe(){if(dH)return LC;dH=1;var e=vNe(),t=bNe(),n=e(t);return LC=n,LC}var xNe=wNe();const _Ne=ot(xNe);var jNe=$R(),SNe=ot(jNe)(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),$C=g.createContext(void 0),FC=g.createContext(void 0),pH=g.createContext(void 0),fH=g.createContext({}),hH=g.createContext(void 0),mH=g.createContext(0),yH=g.createContext(0),gH=function(e){var t=e.state,n=t.xAxisMap,r=t.yAxisMap,a=t.offset,o=e.clipPathId,i=e.children,s=e.width,c=e.height,l=SNe(a);return W.createElement($C.Provider,{value:n},W.createElement(FC.Provider,{value:r},W.createElement(fH.Provider,{value:a},W.createElement(pH.Provider,{value:l},W.createElement(hH.Provider,{value:o},W.createElement(mH.Provider,{value:c},W.createElement(yH.Provider,{value:s},i)))))))},ENe=function(){return g.useContext(hH)},vH=function(e){var t=g.useContext($C);t==null&&ms();var n=t[e];return n==null&&ms(),n},ONe=function(){var e=g.useContext($C);return yi(e)},CNe=function(){var e=g.useContext(FC),t=_Ne(e,function(n){return GW(n.domain,Number.isFinite)});return t||yi(e)},bH=function(e){var t=g.useContext(FC);t==null&&ms();var n=t[e];return n==null&&ms(),n},NNe=function(){var e=g.useContext(pH);return e},MNe=function(){return g.useContext(fH)},BC=function(){return g.useContext(yH)},zC=function(){return g.useContext(mH)};function pl(e){"@babel/helpers - typeof";return pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pl(e)}function PNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kNe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jH(r.key),r)}}function ANe(e,t,n){return t&&kNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function TNe(e,t,n){return t=ag(t),INe(e,wH()?Reflect.construct(t,n||[],ag(e).constructor):t.apply(e,n))}function INe(e,t){if(t&&(pl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RNe(e)}function RNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wH=function(){return!!e})()}function ag(e){return ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ag(e)}function DNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VC(e,t)}function VC(e,t){return VC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},VC(e,t)}function xH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function _H(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xH(Object(n),!0).forEach(function(r){UC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function UC(e,t,n){return t=jH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jH(e){var t=LNe(e,"string");return pl(t)=="symbol"?t:t+""}function LNe(e,t){if(pl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(pl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Ne(e,t){return VNe(e)||zNe(e,t)||BNe(e,t)||FNe()}function FNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BNe(e,t){if(e){if(typeof e=="string")return SH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SH(e,t)}}function SH(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zNe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function VNe(e){if(Array.isArray(e))return e}function WC(){return WC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},WC.apply(this,arguments)}var UNe=function(e,t){var n;return W.isValidElement(e)?n=W.cloneElement(e,t):tt(e)?n=e(t):n=W.createElement("line",WC({},t,{className:"recharts-reference-line-line"})),n},WNe=function(e,t,n,r,a,o,i,s,c){var l=a.x,u=a.y,d=a.width,p=a.height;if(n){var f=c.y,y=e.y.apply(f,{position:o});if(Ba(c,"discard")&&!e.y.isInRange(y))return null;var m=[{x:l+d,y},{x:l,y}];return s==="left"?m.reverse():m}if(t){var v=c.x,b=e.x.apply(v,{position:o});if(Ba(c,"discard")&&!e.x.isInRange(b))return null;var w=[{x:b,y:u+p},{x:b,y:u}];return i==="top"?w.reverse():w}if(r){var j=c.segment,x=j.map(function(_){return e.apply(_,{position:o})});return Ba(c,"discard")&&FCe(x,function(_){return!e.isInRange(_)})?null:x}return null};function HNe(e){var t=e.x,n=e.y,r=e.segment,a=e.xAxisId,o=e.yAxisId,i=e.shape,s=e.className,c=e.alwaysShow,l=ENe(),u=vH(a),d=bH(o),p=NNe();if(!l||!p)return null;Po(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=IC({x:u.scale,y:d.scale}),y=sn(t),m=sn(n),v=r&&r.length===2,b=WNe(f,y,m,v,p,e.position,u.orientation,d.orientation,e);if(!b)return null;var w=$Ne(b,2),j=w[0],x=j.x,_=j.y,S=w[1],E=S.x,O=S.y,M=Ba(e,"hidden")?"url(#".concat(l,")"):void 0,N=_H(_H({clipPath:M},yt(e,!0)),{},{x1:x,y1:_,x2:E,y2:O});return W.createElement(fn,{className:xt("recharts-reference-line",s)},UNe(i,N),Mn.renderCallByParent(e,mNe({x1:x,y1:_,x2:E,y2:O})))}var HC=function(e){function t(){return PNe(this,t),TNe(this,t,arguments)}return DNe(t,e),ANe(t,[{key:"render",value:function(){return W.createElement(HNe,this.props)}}])}(W.Component);UC(HC,"displayName","ReferenceLine"),UC(HC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function qC(){return qC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qC.apply(this,arguments)}function fl(e){"@babel/helpers - typeof";return fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fl(e)}function EH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function OH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EH(Object(n),!0).forEach(function(r){ig(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function qNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KNe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,NH(r.key),r)}}function XNe(e,t,n){return t&&KNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZNe(e,t,n){return t=og(t),GNe(e,CH()?Reflect.construct(t,n||[],og(e).constructor):t.apply(e,n))}function GNe(e,t){if(t&&(fl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QNe(e)}function QNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CH=function(){return!!e})()}function og(e){return og=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},og(e)}function YNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KC(e,t)}function KC(e,t){return KC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},KC(e,t)}function ig(e,t,n){return t=NH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NH(e){var t=JNe(e,"string");return fl(t)=="symbol"?t:t+""}function JNe(e,t){if(fl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(fl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eMe=function(e){var t=e.x,n=e.y,r=e.xAxis,a=e.yAxis,o=IC({x:r.scale,y:a.scale}),i=o.apply({x:t,y:n},{bandAware:!0});return Ba(e,"discard")&&!o.isInRange(i)?null:i},sg=function(e){function t(){return qNe(this,t),ZNe(this,t,arguments)}return YNe(t,e),XNe(t,[{key:"render",value:function(){var n=this.props,r=n.x,a=n.y,o=n.r,i=n.alwaysShow,s=n.clipPathId,c=sn(r),l=sn(a);if(Po(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!l)return null;var u=eMe(this.props);if(!u)return null;var d=u.x,p=u.y,f=this.props,y=f.shape,m=f.className,v=Ba(this.props,"hidden")?"url(#".concat(s,")"):void 0,b=OH(OH({clipPath:v},yt(this.props,!0)),{},{cx:d,cy:p});return W.createElement(fn,{className:xt("recharts-reference-dot",m)},t.renderDot(y,b),Mn.renderCallByParent(this.props,{x:d-o,y:p-o,width:2*o,height:2*o}))}}])}(W.Component);ig(sg,"displayName","ReferenceDot"),ig(sg,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),ig(sg,"renderDot",function(e,t){var n;return W.isValidElement(e)?n=W.cloneElement(e,t):tt(e)?n=e(t):n=W.createElement(jW,qC({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function XC(){return XC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},XC.apply(this,arguments)}function hl(e){"@babel/helpers - typeof";return hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hl(e)}function MH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function PH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?MH(Object(n),!0).forEach(function(r){lg(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):MH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function tMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nMe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,AH(r.key),r)}}function rMe(e,t,n){return t&&nMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function aMe(e,t,n){return t=cg(t),oMe(e,kH()?Reflect.construct(t,n||[],cg(e).constructor):t.apply(e,n))}function oMe(e,t){if(t&&(hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iMe(e)}function iMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kH=function(){return!!e})()}function cg(e){return cg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cg(e)}function sMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZC(e,t)}function ZC(e,t){return ZC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},ZC(e,t)}function lg(e,t,n){return t=AH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AH(e){var t=cMe(e,"string");return hl(t)=="symbol"?t:t+""}function cMe(e,t){if(hl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(hl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lMe=function(e,t,n,r,a){var o=a.x1,i=a.x2,s=a.y1,c=a.y2,l=a.xAxis,u=a.yAxis;if(!l||!u)return null;var d=IC({x:l.scale,y:u.scale}),p={x:e?d.x.apply(o,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(s,{position:"start"}):d.y.rangeMin},f={x:t?d.x.apply(i,{position:"end"}):d.x.rangeMax,y:r?d.y.apply(c,{position:"end"}):d.y.rangeMax};return Ba(a,"discard")&&(!d.isInRange(p)||!d.isInRange(f))?null:sH(p,f)},ug=function(e){function t(){return tMe(this,t),aMe(this,t,arguments)}return sMe(t,e),rMe(t,[{key:"render",value:function(){var n=this.props,r=n.x1,a=n.x2,o=n.y1,i=n.y2,s=n.className,c=n.alwaysShow,l=n.clipPathId;Po(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=sn(r),d=sn(a),p=sn(o),f=sn(i),y=this.props.shape;if(!u&&!d&&!p&&!f&&!y)return null;var m=lMe(u,d,p,f,this.props);if(!m&&!y)return null;var v=Ba(this.props,"hidden")?"url(#".concat(l,")"):void 0;return W.createElement(fn,{className:xt("recharts-reference-area",s)},t.renderRect(y,PH(PH({clipPath:v},yt(this.props,!0)),m)),Mn.renderCallByParent(this.props,m))}}])}(W.Component);lg(ug,"displayName","ReferenceArea"),lg(ug,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),lg(ug,"renderRect",function(e,t){var n;return W.isValidElement(e)?n=W.cloneElement(e,t):tt(e)?n=e(t):n=W.createElement(yC,XC({},t,{className:"recharts-reference-area-rect"})),n});function TH(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function uMe(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return gNe(r,n)}function dMe(e,t,n){var r=n==="width",a=e.x,o=e.y,i=e.width,s=e.height;return t===1?{start:r?a:o,end:r?a+i:o+s}:{start:r?a+i:o+s,end:r?a:o}}function dg(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var o=n();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-a)<=0}function pMe(e,t){return TH(e,t+1)}function fMe(e,t,n,r,a){for(var o=(r||[]).slice(),i=t.start,s=t.end,c=0,l=1,u=i,d=function(){var f=r==null?void 0:r[c];if(f===void 0)return{v:TH(r,l)};var y=c,m,v=function(){return m===void 0&&(m=n(f,y)),m},b=f.coordinate,w=c===0||dg(e,b,v,u,s);w||(c=0,u=i,l+=1),w&&(u=b+e*(v()/2+a),c+=l)},p;l<=o.length;)if(p=d(),p)return p.v;return[]}function Np(e){"@babel/helpers - typeof";return Np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Np(e)}function IH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IH(Object(n),!0).forEach(function(r){hMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hMe(e,t,n){return t=mMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mMe(e){var t=yMe(e,"string");return Np(t)=="symbol"?t:t+""}function yMe(e,t){if(Np(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Np(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gMe(e,t,n,r,a){for(var o=(r||[]).slice(),i=o.length,s=t.start,c=t.end,l=function(d){var p=o[d],f,y=function(){return f===void 0&&(f=n(p,d)),f};if(d===i-1){var m=e*(p.coordinate+e*y()/2-c);o[d]=p=Pn(Pn({},p),{},{tickCoord:m>0?p.coordinate-m*e:p.coordinate})}else o[d]=p=Pn(Pn({},p),{},{tickCoord:p.coordinate});var v=dg(e,p.tickCoord,y,s,c);v&&(c=p.tickCoord-e*(y()/2+a),o[d]=Pn(Pn({},p),{},{isShow:!0}))},u=i-1;u>=0;u--)l(u);return o}function vMe(e,t,n,r,a,o){var i=(r||[]).slice(),s=i.length,c=t.start,l=t.end;if(o){var u=r[s-1],d=n(u,s-1),p=e*(u.coordinate+e*d/2-l);i[s-1]=u=Pn(Pn({},u),{},{tickCoord:p>0?u.coordinate-p*e:u.coordinate});var f=dg(e,u.tickCoord,function(){return d},c,l);f&&(l=u.tickCoord-e*(d/2+a),i[s-1]=Pn(Pn({},u),{},{isShow:!0}))}for(var y=o?s-1:s,m=function(b){var w=i[b],j,x=function(){return j===void 0&&(j=n(w,b)),j};if(b===0){var _=e*(w.coordinate-e*x()/2-c);i[b]=w=Pn(Pn({},w),{},{tickCoord:_<0?w.coordinate-_*e:w.coordinate})}else i[b]=w=Pn(Pn({},w),{},{tickCoord:w.coordinate});var S=dg(e,w.tickCoord,x,c,l);S&&(c=w.tickCoord+e*(x()/2+a),i[b]=Pn(Pn({},w),{},{isShow:!0}))},v=0;v<y;v++)m(v);return i}function GC(e,t,n){var r=e.tick,a=e.ticks,o=e.viewBox,i=e.minTickGap,s=e.orientation,c=e.interval,l=e.tickFormatter,u=e.unit,d=e.angle;if(!a||!a.length||!r)return[];if(ye(c)||gi.isSsr)return pMe(a,typeof c=="number"&&ye(c)?c:0);var p=[],f=s==="top"||s==="bottom"?"width":"height",y=u&&f==="width"?Wd(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},m=function(w,j){var x=tt(l)?l(w.value,j):w.value;return f==="width"?uMe(Wd(x,{fontSize:t,letterSpacing:n}),y,d):Wd(x,{fontSize:t,letterSpacing:n})[f]},v=a.length>=2?ia(a[1].coordinate-a[0].coordinate):1,b=dMe(o,v,f);return c==="equidistantPreserveStart"?fMe(v,b,m,a,i):(c==="preserveStart"||c==="preserveStartEnd"?p=vMe(v,b,m,a,i,c==="preserveStartEnd"):p=gMe(v,b,m,a,i),p.filter(function(w){return w.isShow}))}var bMe=["viewBox"],wMe=["viewBox"],xMe=["ticks"];function ml(e){"@babel/helpers - typeof";return ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ml(e)}function yl(){return yl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yl.apply(this,arguments)}function RH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function zn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RH(Object(n),!0).forEach(function(r){JC(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function QC(e,t){if(e==null)return{};var n=_Me(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _Me(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function jMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$H(r.key),r)}}function SMe(e,t,n){return t&&DH(e.prototype,t),n&&DH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function EMe(e,t,n){return t=pg(t),OMe(e,LH()?Reflect.construct(t,n||[],pg(e).constructor):t.apply(e,n))}function OMe(e,t){if(t&&(ml(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CMe(e)}function CMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LH=function(){return!!e})()}function pg(e){return pg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pg(e)}function NMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YC(e,t)}function YC(e,t){return YC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},YC(e,t)}function JC(e,t,n){return t=$H(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $H(e){var t=MMe(e,"string");return ml(t)=="symbol"?t:t+""}function MMe(e,t){if(ml(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ml(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gl=function(e){function t(n){var r;return jMe(this,t),r=EMe(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return NMe(t,e),SMe(t,[{key:"shouldComponentUpdate",value:function(n,r){var a=n.viewBox,o=QC(n,bMe),i=this.props,s=i.viewBox,c=QC(i,wMe);return!Wc(a,s)||!Wc(o,c)||!Wc(r,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var r=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];r&&this.setState({fontSize:window.getComputedStyle(r).fontSize,letterSpacing:window.getComputedStyle(r).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var r=this.props,a=r.x,o=r.y,i=r.width,s=r.height,c=r.orientation,l=r.tickSize,u=r.mirror,d=r.tickMargin,p,f,y,m,v,b,w=u?-1:1,j=n.tickSize||l,x=ye(n.tickCoord)?n.tickCoord:n.coordinate;switch(c){case"top":p=f=n.coordinate,m=o+ +!u*s,y=m-w*j,b=y-w*d,v=x;break;case"left":y=m=n.coordinate,f=a+ +!u*i,p=f-w*j,v=p-w*d,b=x;break;case"right":y=m=n.coordinate,f=a+ +u*i,p=f+w*j,v=p+w*d,b=x;break;default:p=f=n.coordinate,m=o+ +u*s,y=m+w*j,b=y+w*d,v=x;break}return{line:{x1:p,y1:y,x2:f,y2:m},tick:{x:v,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o;switch(r){case"left":o=a?"start":"end";break;case"right":o=a?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,r=n.orientation,a=n.mirror,o="end";switch(r){case"left":case"right":o="middle";break;case"top":o=a?"start":"end";break;default:o=a?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,r=n.x,a=n.y,o=n.width,i=n.height,s=n.orientation,c=n.mirror,l=n.axisLine,u=zn(zn(zn({},yt(this.props,!1)),yt(l,!1)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!c||s==="bottom"&&c);u=zn(zn({},u),{},{x1:r,y1:a+d*i,x2:r+o,y2:a+d*i})}else{var p=+(s==="left"&&!c||s==="right"&&c);u=zn(zn({},u),{},{x1:r+p*o,y1:a,x2:r+p*o,y2:a+i})}return W.createElement("line",yl({},u,{className:xt("recharts-cartesian-axis-line",xr(l,"className"))}))}},{key:"renderTicks",value:function(n,r,a){var o=this,i=this.props,s=i.tickLine,c=i.stroke,l=i.tick,u=i.tickFormatter,d=i.unit,p=GC(zn(zn({},this.props),{},{ticks:n}),r,a),f=this.getTickTextAnchor(),y=this.getTickVerticalAnchor(),m=yt(this.props,!1),v=yt(l,!1),b=zn(zn({},m),{},{fill:"none"},yt(s,!1)),w=p.map(function(j,x){var _=o.getTickLineCoord(j),S=_.line,E=_.tick,O=zn(zn(zn(zn({textAnchor:f,verticalAnchor:y},m),{},{stroke:"none",fill:c},v),E),{},{index:x,payload:j,visibleTicksCount:p.length,tickFormatter:u});return W.createElement(fn,yl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},Km(o.props,j,x)),s&&W.createElement("line",yl({},b,S,{className:xt("recharts-cartesian-axis-tick-line",xr(s,"className"))})),l&&t.renderTickItem(l,O,"".concat(tt(u)?u(j.value,x):j.value).concat(d||"")))});return W.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,r=this.props,a=r.axisLine,o=r.width,i=r.height,s=r.ticksGenerator,c=r.className,l=r.hide;if(l)return null;var u=this.props,d=u.ticks,p=QC(u,xMe),f=d;return tt(s)&&(f=d&&d.length>0?s(this.props):s(p)),o<=0||i<=0||!f||!f.length?null:W.createElement(fn,{className:xt("recharts-cartesian-axis",c),ref:function(y){n.layerReference=y}},a&&this.renderAxisLine(),this.renderTicks(f,this.state.fontSize,this.state.letterSpacing),Mn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,r,a){var o;return W.isValidElement(n)?o=W.cloneElement(n,r):tt(n)?o=n(r):o=W.createElement(fy,yl({},r,{className:"recharts-cartesian-axis-tick-value"}),a),o}}])}(g.Component);JC(gl,"displayName","CartesianAxis"),JC(gl,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var PMe=["x1","y1","x2","y2","key"],kMe=["offset"];function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function FH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FH(Object(n),!0).forEach(function(r){AMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function AMe(e,t,n){return t=TMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TMe(e){var t=IMe(e,"string");return bs(t)=="symbol"?t:t+""}function IMe(e,t){if(bs(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ws(){return ws=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ws.apply(this,arguments)}function BH(e,t){if(e==null)return{};var n=RMe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function RMe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var DMe=function(e){var t=e.fill;if(!t||t==="none")return null;var n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.ry;return W.createElement("rect",{x:r,y:a,ry:s,width:o,height:i,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function zH(e,t){var n;if(W.isValidElement(e))n=W.cloneElement(e,t);else if(tt(e))n=e(t);else{var r=t.x1,a=t.y1,o=t.x2,i=t.y2,s=t.key,c=BH(t,PMe),l=yt(c,!1);l.offset;var u=BH(l,kMe);n=W.createElement("line",ws({},u,{x1:r,y1:a,x2:o,y2:i,fill:"none",key:s}))}return n}function LMe(e){var t=e.x,n=e.width,r=e.horizontal,a=r===void 0?!0:r,o=e.horizontalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=kn(kn({},e),{},{x1:t,y1:s,x2:t+n,y2:s,key:"line-".concat(c),index:c});return zH(a,l)});return W.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function $Me(e){var t=e.y,n=e.height,r=e.vertical,a=r===void 0?!0:r,o=e.verticalPoints;if(!a||!o||!o.length)return null;var i=o.map(function(s,c){var l=kn(kn({},e),{},{x1:s,y1:t,x2:s,y2:t+n,key:"line-".concat(c),index:c});return zH(a,l)});return W.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function FMe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,a=e.y,o=e.width,i=e.height,s=e.horizontalPoints,c=e.horizontal,l=c===void 0?!0:c;if(!l||!t||!t.length)return null;var u=s.map(function(p){return Math.round(p+a-a)}).sort(function(p,f){return p-f});a!==u[0]&&u.unshift(0);var d=u.map(function(p,f){var y=!u[f+1],m=y?a+i-p:u[f+1]-p;if(m<=0)return null;var v=f%t.length;return W.createElement("rect",{key:"react-".concat(f),y:p,x:r,height:m,width:o,stroke:"none",fill:t[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return W.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function BMe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,a=e.fillOpacity,o=e.x,i=e.y,s=e.width,c=e.height,l=e.verticalPoints;if(!n||!r||!r.length)return null;var u=l.map(function(p){return Math.round(p+o-o)}).sort(function(p,f){return p-f});o!==u[0]&&u.unshift(0);var d=u.map(function(p,f){var y=!u[f+1],m=y?o+s-p:u[f+1]-p;if(m<=0)return null;var v=f%r.length;return W.createElement("rect",{key:"react-".concat(f),x:p,y:i,width:m,height:c,stroke:"none",fill:r[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return W.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var zMe=function(e,t){var n=e.xAxis,r=e.width,a=e.height,o=e.offset;return vU(GC(kn(kn(kn({},gl.defaultProps),n),{},{ticks:Fo(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.left,o.left+o.width,t)},VMe=function(e,t){var n=e.yAxis,r=e.width,a=e.height,o=e.offset;return vU(GC(kn(kn(kn({},gl.defaultProps),n),{},{ticks:Fo(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.top,o.top+o.height,t)},vl={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function VH(e){var t,n,r,a,o,i,s=BC(),c=zC(),l=MNe(),u=kn(kn({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:vl.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:vl.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:vl.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:vl.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:vl.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:vl.verticalFill,x:ye(e.x)?e.x:l.left,y:ye(e.y)?e.y:l.top,width:ye(e.width)?e.width:l.width,height:ye(e.height)?e.height:l.height}),d=u.x,p=u.y,f=u.width,y=u.height,m=u.syncWithTicks,v=u.horizontalValues,b=u.verticalValues,w=ONe(),j=CNe();if(!ye(f)||f<=0||!ye(y)||y<=0||!ye(d)||d!==+d||!ye(p)||p!==+p)return null;var x=u.verticalCoordinatesGenerator||zMe,_=u.horizontalCoordinatesGenerator||VMe,S=u.horizontalPoints,E=u.verticalPoints;if((!S||!S.length)&&tt(_)){var O=v&&v.length,M=_({yAxis:j?kn(kn({},j),{},{ticks:O?v:j.ticks}):void 0,width:s,height:c,offset:l},O?!0:m);Po(Array.isArray(M),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(bs(M),"]")),Array.isArray(M)&&(S=M)}if((!E||!E.length)&&tt(x)){var N=b&&b.length,P=x({xAxis:w?kn(kn({},w),{},{ticks:N?b:w.ticks}):void 0,width:s,height:c,offset:l},N?!0:m);Po(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(bs(P),"]")),Array.isArray(P)&&(E=P)}return W.createElement("g",{className:"recharts-cartesian-grid"},W.createElement(DMe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),W.createElement(LMe,ws({},u,{offset:l,horizontalPoints:S,xAxis:w,yAxis:j})),W.createElement($Me,ws({},u,{offset:l,verticalPoints:E,xAxis:w,yAxis:j})),W.createElement(FMe,ws({},u,{horizontalPoints:S})),W.createElement(BMe,ws({},u,{verticalPoints:E})))}VH.displayName="CartesianGrid";function bl(e){"@babel/helpers - typeof";return bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bl(e)}function UMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WMe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,HH(r.key),r)}}function HMe(e,t,n){return t&&WMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qMe(e,t,n){return t=fg(t),KMe(e,UH()?Reflect.construct(t,n||[],fg(e).constructor):t.apply(e,n))}function KMe(e,t){if(t&&(bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XMe(e)}function XMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UH=function(){return!!e})()}function fg(e){return fg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fg(e)}function ZMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eN(e,t)}function eN(e,t){return eN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},eN(e,t)}function WH(e,t,n){return t=HH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HH(e){var t=GMe(e,"string");return bl(t)=="symbol"?t:t+""}function GMe(e,t){if(bl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tN(){return tN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tN.apply(this,arguments)}function QMe(e){var t=e.xAxisId,n=BC(),r=zC(),a=vH(t);return a==null?null:W.createElement(gl,tN({},a,{className:xt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return Fo(o,!0)}}))}var hg=function(e){function t(){return UMe(this,t),qMe(this,t,arguments)}return ZMe(t,e),HMe(t,[{key:"render",value:function(){return W.createElement(QMe,this.props)}}])}(W.Component);WH(hg,"displayName","XAxis"),WH(hg,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function wl(e){"@babel/helpers - typeof";return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wl(e)}function YMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JMe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,XH(r.key),r)}}function ePe(e,t,n){return t&&JMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tPe(e,t,n){return t=mg(t),nPe(e,qH()?Reflect.construct(t,n||[],mg(e).constructor):t.apply(e,n))}function nPe(e,t){if(t&&(wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rPe(e)}function rPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qH=function(){return!!e})()}function mg(e){return mg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mg(e)}function aPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nN(e,t)}function nN(e,t){return nN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},nN(e,t)}function KH(e,t,n){return t=XH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XH(e){var t=oPe(e,"string");return wl(t)=="symbol"?t:t+""}function oPe(e,t){if(wl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rN(){return rN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rN.apply(this,arguments)}var iPe=function(e){var t=e.yAxisId,n=BC(),r=zC(),a=bH(t);return a==null?null:W.createElement(gl,rN({},a,{className:xt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return Fo(o,!0)}}))},aN=function(e){function t(){return YMe(this,t),tPe(this,t,arguments)}return aPe(t,e),ePe(t,[{key:"render",value:function(){return W.createElement(iPe,this.props)}}])}(W.Component);KH(aN,"displayName","YAxis"),KH(aN,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function ZH(e){return uPe(e)||lPe(e)||cPe(e)||sPe()}function sPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cPe(e,t){if(e){if(typeof e=="string")return oN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oN(e,t)}}function lPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uPe(e){if(Array.isArray(e))return oN(e)}function oN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var iN=function(e,t,n,r,a){var o=sa(e,HC),i=sa(e,sg),s=[].concat(ZH(o),ZH(i)),c=sa(e,ug),l="".concat(r,"Id"),u=r[0],d=t;if(s.length&&(d=s.reduce(function(y,m){if(m.props[l]===n&&Ba(m.props,"extendDomain")&&ye(m.props[u])){var v=m.props[u];return[Math.min(y[0],v),Math.max(y[1],v)]}return y},d)),c.length){var p="".concat(u,"1"),f="".concat(u,"2");d=c.reduce(function(y,m){if(m.props[l]===n&&Ba(m.props,"extendDomain")&&ye(m.props[p])&&ye(m.props[f])){var v=m.props[p],b=m.props[f];return[Math.min(y[0],v,b),Math.max(y[1],v,b)]}return y},d)}return a&&a.length&&(d=a.reduce(function(y,m){return ye(m)?[Math.min(y[0],m),Math.max(y[1],m)]:y},d)),d},GH={exports:{}},QH;function dPe(){return QH||(QH=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,p){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new a(u,d||c,p),y=n?n+l:l;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],f]:c._events[y].push(f):(c._events[y]=f,c._eventsCount++),c}function i(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)t.call(l,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},s.prototype.listeners=function(c){var l=n?n+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,p=u.length,f=new Array(p);d<p;d++)f[d]=u[d].fn;return f},s.prototype.listenerCount=function(c){var l=n?n+c:c,u=this._events[l];return u?u.fn?1:u.length:0},s.prototype.emit=function(c,l,u,d,p,f){var y=n?n+c:c;if(!this._events[y])return!1;var m=this._events[y],v=arguments.length,b,w;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,u),!0;case 4:return m.fn.call(m.context,l,u,d),!0;case 5:return m.fn.call(m.context,l,u,d,p),!0;case 6:return m.fn.call(m.context,l,u,d,p,f),!0}for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];m.fn.apply(m.context,b)}else{var j=m.length,x;for(w=0;w<j;w++)switch(m[w].once&&this.removeListener(c,m[w].fn,void 0,!0),v){case 1:m[w].fn.call(m[w].context);break;case 2:m[w].fn.call(m[w].context,l);break;case 3:m[w].fn.call(m[w].context,l,u);break;case 4:m[w].fn.call(m[w].context,l,u,d);break;default:if(!b)for(x=1,b=new Array(v-1);x<v;x++)b[x-1]=arguments[x];m[w].fn.apply(m[w].context,b)}}return!0},s.prototype.on=function(c,l,u){return o(this,c,l,u,!1)},s.prototype.once=function(c,l,u){return o(this,c,l,u,!0)},s.prototype.removeListener=function(c,l,u,d){var p=n?n+c:c;if(!this._events[p])return this;if(!l)return i(this,p),this;var f=this._events[p];if(f.fn)f.fn===l&&(!d||f.once)&&(!u||f.context===u)&&i(this,p);else{for(var y=0,m=[],v=f.length;y<v;y++)(f[y].fn!==l||d&&!f[y].once||u&&f[y].context!==u)&&m.push(f[y]);m.length?this._events[p]=m.length===1?m[0]:m:i(this,p)}return this},s.prototype.removeAllListeners=function(c){var l;return c?(l=n?n+c:c,this._events[l]&&i(this,l)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(GH)),GH.exports}var pPe=dPe();const fPe=ot(pPe);var sN=new fPe,cN="recharts.syncMouseEvents";function Mp(e){"@babel/helpers - typeof";return Mp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mp(e)}function hPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mPe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,YH(r.key),r)}}function yPe(e,t,n){return t&&mPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function lN(e,t,n){return t=YH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YH(e){var t=gPe(e,"string");return Mp(t)=="symbol"?t:t+""}function gPe(e,t){if(Mp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Mp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var vPe=function(){function e(){hPe(this,e),lN(this,"activeIndex",0),lN(this,"coordinateList",[]),lN(this,"layout","horizontal")}return yPe(e,[{key:"setDetails",value:function(t){var n,r=t.coordinateList,a=r===void 0?null:r,o=t.container,i=o===void 0?null:o,s=t.layout,c=s===void 0?null:s,l=t.offset,u=l===void 0?null:l,d=t.mouseHandlerCallback,p=d===void 0?null:d;this.coordinateList=(n=a??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=c??this.layout,this.offset=u??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(t){if(this.coordinateList.length!==0)switch(t.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(t){this.activeIndex=t}},{key:"spoofMouse",value:function(){var t,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var r=this.container.getBoundingClientRect(),a=r.x,o=r.y,i=r.height,s=this.coordinateList[this.activeIndex].coordinate,c=((t=window)===null||t===void 0?void 0:t.scrollX)||0,l=((n=window)===null||n===void 0?void 0:n.scrollY)||0,u=a+s+c,d=o+this.offset.top+i/2+l;this.mouseHandlerCallback({pageX:u,pageY:d})}}}])}();function bPe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],a=e==null?void 0:e[1];if(r&&a&&ye(r)&&ye(a))return!0}return!1}function wPe(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function JH(e){var t=e.cx,n=e.cy,r=e.radius,a=e.startAngle,o=e.endAngle,i=_n(t,n,r,a),s=_n(t,n,r,o);return{points:[i,s],cx:t,cy:n,radius:r,startAngle:a,endAngle:o}}function xPe(e,t,n){var r,a,o,i;if(e==="horizontal")r=t.x,o=r,a=n.top,i=n.top+n.height;else if(e==="vertical")a=t.y,i=a,r=n.left,o=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,c=t.cy,l=t.innerRadius,u=t.outerRadius,d=t.angle,p=_n(s,c,l,d),f=_n(s,c,u,d);r=p.x,a=p.y,o=f.x,i=f.y}else return JH(t);return[{x:r,y:a},{x:o,y:i}]}function Pp(e){"@babel/helpers - typeof";return Pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pp(e)}function eq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function yg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?eq(Object(n),!0).forEach(function(r){_Pe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _Pe(e,t,n){return t=jPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jPe(e){var t=SPe(e,"string");return Pp(t)=="symbol"?t:t+""}function SPe(e,t){if(Pp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Pp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EPe(e){var t,n,r=e.element,a=e.tooltipEventType,o=e.isActive,i=e.activeCoordinate,s=e.activePayload,c=e.offset,l=e.activeTooltipIndex,u=e.tooltipAxisBandSize,d=e.layout,p=e.chartName,f=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!f||!o||!i||p!=="ScatterChart"&&a!=="axis")return null;var y,m=VU;if(p==="ScatterChart")y=i,m=zOe;else if(p==="BarChart")y=wPe(d,i,c,u),m=yC;else if(d==="radial"){var v=JH(i),b=v.cx,w=v.cy,j=v.radius,x=v.startAngle,_=v.endAngle;y={cx:b,cy:w,startAngle:x,endAngle:_,innerRadius:j,outerRadius:j},m=$U}else y={points:xPe(d,i,c)},m=VU;var S=yg(yg(yg(yg({stroke:"#ccc",pointerEvents:"none"},c),y),yt(f,!1)),{},{payload:s,payloadIndex:l,className:xt("recharts-tooltip-cursor",f.className)});return g.isValidElement(f)?g.cloneElement(f,S):g.createElement(m,S)}var OPe=["item"],CPe=["children","className","width","height","style","compact","title","desc"];function xl(e){"@babel/helpers - typeof";return xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xl(e)}function _l(){return _l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_l.apply(this,arguments)}function tq(e,t){return PPe(e)||MPe(e,t)||aq(e,t)||NPe()}function NPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MPe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,t!==0)for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function PPe(e){if(Array.isArray(e))return e}function nq(e,t){if(e==null)return{};var n=kPe(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function kPe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function APe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TPe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,iq(r.key),r)}}function IPe(e,t,n){return t&&TPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function RPe(e,t,n){return t=gg(t),DPe(e,rq()?Reflect.construct(t,n||[],gg(e).constructor):t.apply(e,n))}function DPe(e,t){if(t&&(xl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LPe(e)}function LPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rq=function(){return!!e})()}function gg(e){return gg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gg(e)}function $Pe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uN(e,t)}function uN(e,t){return uN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},uN(e,t)}function jl(e){return zPe(e)||BPe(e)||aq(e)||FPe()}function FPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aq(e,t){if(e){if(typeof e=="string")return dN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dN(e,t)}}function BPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zPe(e){if(Array.isArray(e))return dN(e)}function dN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oq(Object(n),!0).forEach(function(r){Fe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oq(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fe(e,t,n){return t=iq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iq(e){var t=VPe(e,"string");return xl(t)=="symbol"?t:t+""}function VPe(e,t){if(xl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UPe={xAxis:["bottom","top"],yAxis:["left","right"]},WPe={width:"100%",height:"100%"},sq={x:0,y:0};function vg(e){return e}var HPe=function(e,t){return t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius},qPe=function(e,t,n,r){var a=t.find(function(l){return l&&l.index===n});if(a){if(e==="horizontal")return{x:a.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:a.coordinate};if(e==="centric"){var o=a.coordinate,i=r.radius;return ie(ie(ie({},r),_n(r.cx,r.cy,i,o)),{},{angle:o,radius:i})}var s=a.coordinate,c=r.angle;return ie(ie(ie({},r),_n(r.cx,r.cy,s,c)),{},{angle:c,radius:s})}return sq},bg=function(e,t){var n=t.graphicalItems,r=t.dataStartIndex,a=t.dataEndIndex,o=(n??[]).reduce(function(i,s){var c=s.props.data;return c&&c.length?[].concat(jl(i),jl(c)):i},[]);return o.length>0?o:e&&e.length&&ye(r)&&ye(a)?e.slice(r,a+1):[]};function cq(e){return e==="number"?[0,"auto"]:void 0}var pN=function(e,t,n,r){var a=e.graphicalItems,o=e.tooltipAxis,i=bg(t,e);return n<0||!a||!a.length||n>=i.length?null:a.reduce(function(s,c){var l,u=(l=c.props.data)!==null&&l!==void 0?l:t;u&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(u=u.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(o.dataKey&&!o.allowDuplicatedCategory){var p=u===void 0?i:u;d=IS(p,o.dataKey,r)}else d=u&&u[n]||i[n];return d?[].concat(jl(s),[EU(c,d)]):s},[])},lq=function(e,t,n,r){var a=r||{x:e.chartX,y:e.chartY},o=HPe(a,n),i=e.orderedTooltipTicks,s=e.tooltipAxis,c=e.tooltipTicks,l=Dje(o,i,c,s);if(l>=0&&c){var u=c[l]&&c[l].value,d=pN(e,t,l,u),p=qPe(n,i,l,a);return{activeTooltipIndex:l,activeLabel:u,activePayload:d,activeCoordinate:p}}return null},KPe=function(e,t){var n=t.axes,r=t.graphicalItems,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=e.stackOffset,p=gU(l,a);return n.reduce(function(f,y){var m,v=y.type.defaultProps!==void 0?ie(ie({},y.type.defaultProps),y.props):y.props,b=v.type,w=v.dataKey,j=v.allowDataOverflow,x=v.allowDuplicatedCategory,_=v.scale,S=v.ticks,E=v.includeHidden,O=v[o];if(f[O])return f;var M=bg(e.data,{graphicalItems:r.filter(function(z){var $,V=o in z.props?z.props[o]:($=z.type.defaultProps)===null||$===void 0?void 0:$[o];return V===O}),dataStartIndex:s,dataEndIndex:c}),N=M.length,P,I,k;bPe(v.domain,j,b)&&(P=YO(v.domain,null,j),p&&(b==="number"||_!=="auto")&&(k=Dy(M,w,"category")));var C=cq(b);if(!P||P.length===0){var T,A=(T=v.domain)!==null&&T!==void 0?T:C;if(w){if(P=Dy(M,w,b),b==="category"&&p){var D=Xve(P);x&&D?(I=P,P=Yy(0,N)):x||(P=SU(A,P,y).reduce(function(z,$){return z.indexOf($)>=0?z:[].concat(jl(z),[$])},[]))}else if(b==="category")x?P=P.filter(function(z){return z!==""&&!gt(z)}):P=SU(A,P,y).reduce(function(z,$){return z.indexOf($)>=0||$===""||gt($)?z:[].concat(jl(z),[$])},[]);else if(b==="number"){var L=zje(M,r.filter(function(z){var $,V,Y=o in z.props?z.props[o]:($=z.type.defaultProps)===null||$===void 0?void 0:$[o],G="hide"in z.props?z.props.hide:(V=z.type.defaultProps)===null||V===void 0?void 0:V.hide;return Y===O&&(E||!G)}),w,a,l);L&&(P=L)}p&&(b==="number"||_!=="auto")&&(k=Dy(M,w,"category"))}else p?P=Yy(0,N):i&&i[O]&&i[O].hasStack&&b==="number"?P=d==="expand"?[0,1]:xU(i[O].stackGroups,s,c):P=yU(M,r.filter(function(z){var $=o in z.props?z.props[o]:z.type.defaultProps[o],V="hide"in z.props?z.props.hide:z.type.defaultProps.hide;return $===O&&(E||!V)}),b,l,!0);if(b==="number")P=iN(u,P,O,a,S),A&&(P=YO(A,P,j));else if(b==="category"&&A){var R=A,B=P.every(function(z){return R.indexOf(z)>=0});B&&(P=R)}}return ie(ie({},f),{},Fe({},O,ie(ie({},v),{},{axisType:a,domain:P,categoricalDomain:k,duplicateDomain:I,originalDomain:(m=v.domain)!==null&&m!==void 0?m:C,isCategorical:p,layout:l})))},{})},XPe=function(e,t){var n=t.graphicalItems,r=t.Axis,a=t.axisType,o=t.axisIdKey,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.layout,u=e.children,d=bg(e.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:c}),p=d.length,f=gU(l,a),y=-1;return n.reduce(function(m,v){var b=v.type.defaultProps!==void 0?ie(ie({},v.type.defaultProps),v.props):v.props,w=b[o],j=cq("number");if(!m[w]){y++;var x;return f?x=Yy(0,p):i&&i[w]&&i[w].hasStack?(x=xU(i[w].stackGroups,s,c),x=iN(u,x,w,a)):(x=YO(j,yU(d,n.filter(function(_){var S,E,O=o in _.props?_.props[o]:(S=_.type.defaultProps)===null||S===void 0?void 0:S[o],M="hide"in _.props?_.props.hide:(E=_.type.defaultProps)===null||E===void 0?void 0:E.hide;return O===w&&!M}),"number",l),r.defaultProps.allowDataOverflow),x=iN(u,x,w,a)),ie(ie({},m),{},Fe({},w,ie(ie({axisType:a},r.defaultProps),{},{hide:!0,orientation:xr(UPe,"".concat(a,".").concat(y%2),null),domain:x,originalDomain:j,isCategorical:f,layout:l})))}return m},{})},ZPe=function(e,t){var n=t.axisType,r=n===void 0?"xAxis":n,a=t.AxisComp,o=t.graphicalItems,i=t.stackGroups,s=t.dataStartIndex,c=t.dataEndIndex,l=e.children,u="".concat(r,"Id"),d=sa(l,a),p={};return d&&d.length?p=KPe(e,{axes:d,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c}):o&&o.length&&(p=XPe(e,{Axis:a,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:i,dataStartIndex:s,dataEndIndex:c})),p},GPe=function(e){var t=yi(e),n=Fo(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:UE(n,function(r){return r.coordinate}),tooltipAxis:t,tooltipAxisBandSize:$y(t,n)}},uq=function(e){var t=e.children,n=e.defaultShowTooltip,r=fr(t,ul),a=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(a=r.props.startIndex),r.props.endIndex>=0&&(o=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},QPe=function(e){return!e||!e.length?!1:e.some(function(t){var n=Mo(t&&t.type);return n&&n.indexOf("Bar")>=0})},dq=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},YPe=function(e,t){var n=e.props,r=e.graphicalItems,a=e.xAxisMap,o=a===void 0?{}:a,i=e.yAxisMap,s=i===void 0?{}:i,c=n.width,l=n.height,u=n.children,d=n.margin||{},p=fr(u,ul),f=fr(u,Xc),y=Object.keys(s).reduce(function(x,_){var S=s[_],E=S.orientation;return!S.mirror&&!S.hide?ie(ie({},x),{},Fe({},E,x[E]+S.width)):x},{left:d.left||0,right:d.right||0}),m=Object.keys(o).reduce(function(x,_){var S=o[_],E=S.orientation;return!S.mirror&&!S.hide?ie(ie({},x),{},Fe({},E,xr(x,"".concat(E))+S.height)):x},{top:d.top||0,bottom:d.bottom||0}),v=ie(ie({},m),y),b=v.bottom;p&&(v.bottom+=p.props.height||ul.defaultProps.height),f&&t&&(v=Fje(v,r,n,t));var w=c-v.left-v.right,j=l-v.top-v.bottom;return ie(ie({brushBottom:b},v),{},{width:Math.max(w,0),height:Math.max(j,0)})},JPe=function(e,t){if(t==="xAxis")return e[t].width;if(t==="yAxis")return e[t].height},eke=function(e){var t=e.chartName,n=e.GraphicalChild,r=e.defaultTooltipEventType,a=r===void 0?"axis":r,o=e.validateTooltipEventTypes,i=o===void 0?["axis"]:o,s=e.axisComponents,c=e.legendContent,l=e.formatAxisMap,u=e.defaultProps,d=function(m,v){var b=v.graphicalItems,w=v.stackGroups,j=v.offset,x=v.updateId,_=v.dataStartIndex,S=v.dataEndIndex,E=m.barSize,O=m.layout,M=m.barGap,N=m.barCategoryGap,P=m.maxBarSize,I=dq(O),k=I.numericAxisName,C=I.cateAxisName,T=QPe(b),A=[];return b.forEach(function(D,L){var R=bg(m.data,{graphicalItems:[D],dataStartIndex:_,dataEndIndex:S}),B=D.type.defaultProps!==void 0?ie(ie({},D.type.defaultProps),D.props):D.props,z=B.dataKey,$=B.maxBarSize,V=B["".concat(k,"Id")],Y=B["".concat(C,"Id")],G={},K=s.reduce(function(Se,Ve){var We=v["".concat(Ve.axisType,"Map")],He=B["".concat(Ve.axisType,"Id")];We&&We[He]||Ve.axisType==="zAxis"||ms();var Mt=We[He];return ie(ie({},Se),{},Fe(Fe({},Ve.axisType,Mt),"".concat(Ve.axisType,"Ticks"),Fo(Mt)))},G),Q=K[C],q=K["".concat(C,"Ticks")],H=w&&w[V]&&w[V].hasStack&&Jje(D,w[V].stackGroups),X=Mo(D.type).indexOf("Bar")>=0,te=$y(Q,q),F=[],se=T&&Lje({barSize:E,stackGroups:w,totalSize:JPe(K,C)});if(X){var re,le,je=gt($)?P:$,Le=(re=(le=$y(Q,q,!0))!==null&&le!==void 0?le:je)!==null&&re!==void 0?re:0;F=$je({barGap:M,barCategoryGap:N,bandSize:Le!==te?Le:te,sizeList:se[Y],maxBarSize:je}),Le!==te&&(F=F.map(function(Se){return ie(ie({},Se),{},{position:ie(ie({},Se.position),{},{offset:Se.position.offset-Le/2})})}))}var $e=D&&D.type&&D.type.getComposedData;$e&&A.push({props:ie(ie({},$e(ie(ie({},K),{},{displayedData:R,props:m,dataKey:z,item:D,bandSize:te,barPosition:F,offset:j,stackedData:H,layout:O,dataStartIndex:_,dataEndIndex:S}))),{},Fe(Fe(Fe({key:D.key||"item-".concat(L)},k,K[k]),C,K[C]),"animationId",x)),childIndex:o0e(D,m.children),item:D})}),A},p=function(m,v){var b=m.props,w=m.dataStartIndex,j=m.dataEndIndex,x=m.updateId;if(!MB({props:b}))return null;var _=b.children,S=b.layout,E=b.stackOffset,O=b.data,M=b.reverseStackOrder,N=dq(S),P=N.numericAxisName,I=N.cateAxisName,k=sa(_,n),C=Gje(O,k,"".concat(P,"Id"),"".concat(I,"Id"),E,M),T=s.reduce(function(B,z){var $="".concat(z.axisType,"Map");return ie(ie({},B),{},Fe({},$,ZPe(b,ie(ie({},z),{},{graphicalItems:k,stackGroups:z.axisType===P&&C,dataStartIndex:w,dataEndIndex:j}))))},{}),A=YPe(ie(ie({},T),{},{props:b,graphicalItems:k}),v==null?void 0:v.legendBBox);Object.keys(T).forEach(function(B){T[B]=l(b,T[B],A,B.replace("Map",""),t)});var D=T["".concat(I,"Map")],L=GPe(D),R=d(b,ie(ie({},T),{},{dataStartIndex:w,dataEndIndex:j,updateId:x,graphicalItems:k,stackGroups:C,offset:A}));return ie(ie({formattedGraphicalItems:R,graphicalItems:k,offset:A,stackGroups:C},L),T)},f=function(m){function v(b){var w,j,x;return APe(this,v),x=RPe(this,v,[b]),Fe(x,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Fe(x,"accessibilityManager",new vPe),Fe(x,"handleLegendBBoxUpdate",function(_){if(_){var S=x.state,E=S.dataStartIndex,O=S.dataEndIndex,M=S.updateId;x.setState(ie({legendBBox:_},p({props:x.props,dataStartIndex:E,dataEndIndex:O,updateId:M},ie(ie({},x.state),{},{legendBBox:_}))))}}),Fe(x,"handleReceiveSyncEvent",function(_,S,E){if(x.props.syncId===_){if(E===x.eventEmitterSymbol&&typeof x.props.syncMethod!="function")return;x.applySyncEvent(S)}}),Fe(x,"handleBrushChange",function(_){var S=_.startIndex,E=_.endIndex;if(S!==x.state.dataStartIndex||E!==x.state.dataEndIndex){var O=x.state.updateId;x.setState(function(){return ie({dataStartIndex:S,dataEndIndex:E},p({props:x.props,dataStartIndex:S,dataEndIndex:E,updateId:O},x.state))}),x.triggerSyncEvent({dataStartIndex:S,dataEndIndex:E})}}),Fe(x,"handleMouseEnter",function(_){var S=x.getMouseInfo(_);if(S){var E=ie(ie({},S),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseEnter;tt(O)&&O(E,_)}}),Fe(x,"triggeredAfterMouseMove",function(_){var S=x.getMouseInfo(_),E=S?ie(ie({},S),{},{isTooltipActive:!0}):{isTooltipActive:!1};x.setState(E),x.triggerSyncEvent(E);var O=x.props.onMouseMove;tt(O)&&O(E,_)}),Fe(x,"handleItemMouseEnter",function(_){x.setState(function(){return{isTooltipActive:!0,activeItem:_,activePayload:_.tooltipPayload,activeCoordinate:_.tooltipPosition||{x:_.cx,y:_.cy}}})}),Fe(x,"handleItemMouseLeave",function(){x.setState(function(){return{isTooltipActive:!1}})}),Fe(x,"handleMouseMove",function(_){_.persist(),x.throttleTriggeredAfterMouseMove(_)}),Fe(x,"handleMouseLeave",function(_){x.throttleTriggeredAfterMouseMove.cancel();var S={isTooltipActive:!1};x.setState(S),x.triggerSyncEvent(S);var E=x.props.onMouseLeave;tt(E)&&E(S,_)}),Fe(x,"handleOuterEvent",function(_){var S=a0e(_),E=xr(x.props,"".concat(S));if(S&&tt(E)){var O,M;/.*touch.*/i.test(S)?M=x.getMouseInfo(_.changedTouches[0]):M=x.getMouseInfo(_),E((O=M)!==null&&O!==void 0?O:{},_)}}),Fe(x,"handleClick",function(_){var S=x.getMouseInfo(_);if(S){var E=ie(ie({},S),{},{isTooltipActive:!0});x.setState(E),x.triggerSyncEvent(E);var O=x.props.onClick;tt(O)&&O(E,_)}}),Fe(x,"handleMouseDown",function(_){var S=x.props.onMouseDown;if(tt(S)){var E=x.getMouseInfo(_);S(E,_)}}),Fe(x,"handleMouseUp",function(_){var S=x.props.onMouseUp;if(tt(S)){var E=x.getMouseInfo(_);S(E,_)}}),Fe(x,"handleTouchMove",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&x.throttleTriggeredAfterMouseMove(_.changedTouches[0])}),Fe(x,"handleTouchStart",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&x.handleMouseDown(_.changedTouches[0])}),Fe(x,"handleTouchEnd",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&x.handleMouseUp(_.changedTouches[0])}),Fe(x,"triggerSyncEvent",function(_){x.props.syncId!==void 0&&sN.emit(cN,x.props.syncId,_,x.eventEmitterSymbol)}),Fe(x,"applySyncEvent",function(_){var S=x.props,E=S.layout,O=S.syncMethod,M=x.state.updateId,N=_.dataStartIndex,P=_.dataEndIndex;if(_.dataStartIndex!==void 0||_.dataEndIndex!==void 0)x.setState(ie({dataStartIndex:N,dataEndIndex:P},p({props:x.props,dataStartIndex:N,dataEndIndex:P,updateId:M},x.state)));else if(_.activeTooltipIndex!==void 0){var I=_.chartX,k=_.chartY,C=_.activeTooltipIndex,T=x.state,A=T.offset,D=T.tooltipTicks;if(!A)return;if(typeof O=="function")C=O(D,_);else if(O==="value"){C=-1;for(var L=0;L<D.length;L++)if(D[L].value===_.activeLabel){C=L;break}}var R=ie(ie({},A),{},{x:A.left,y:A.top}),B=Math.min(I,R.x+R.width),z=Math.min(k,R.y+R.height),$=D[C]&&D[C].value,V=pN(x.state,x.props.data,C),Y=D[C]?{x:E==="horizontal"?D[C].coordinate:B,y:E==="horizontal"?z:D[C].coordinate}:sq;x.setState(ie(ie({},_),{},{activeLabel:$,activeCoordinate:Y,activePayload:V,activeTooltipIndex:C}))}else x.setState(_)}),Fe(x,"renderCursor",function(_){var S,E=x.state,O=E.isTooltipActive,M=E.activeCoordinate,N=E.activePayload,P=E.offset,I=E.activeTooltipIndex,k=E.tooltipAxisBandSize,C=x.getTooltipEventType(),T=(S=_.props.active)!==null&&S!==void 0?S:O,A=x.props.layout,D=_.key||"_recharts-cursor";return W.createElement(EPe,{key:D,activeCoordinate:M,activePayload:N,activeTooltipIndex:I,chartName:t,element:_,isActive:T,layout:A,offset:P,tooltipAxisBandSize:k,tooltipEventType:C})}),Fe(x,"renderPolarAxis",function(_,S,E){var O=xr(_,"type.axisType"),M=xr(x.state,"".concat(O,"Map")),N=_.type.defaultProps,P=N!==void 0?ie(ie({},N),_.props):_.props,I=M&&M[P["".concat(O,"Id")]];return g.cloneElement(_,ie(ie({},I),{},{className:xt(O,I.className),key:_.key||"".concat(S,"-").concat(E),ticks:Fo(I,!0)}))}),Fe(x,"renderPolarGrid",function(_){var S=_.props,E=S.radialLines,O=S.polarAngles,M=S.polarRadius,N=x.state,P=N.radiusAxisMap,I=N.angleAxisMap,k=yi(P),C=yi(I),T=C.cx,A=C.cy,D=C.innerRadius,L=C.outerRadius;return g.cloneElement(_,{polarAngles:Array.isArray(O)?O:Fo(C,!0).map(function(R){return R.coordinate}),polarRadius:Array.isArray(M)?M:Fo(k,!0).map(function(R){return R.coordinate}),cx:T,cy:A,innerRadius:D,outerRadius:L,key:_.key||"polar-grid",radialLines:E})}),Fe(x,"renderLegend",function(){var _=x.state.formattedGraphicalItems,S=x.props,E=S.children,O=S.width,M=S.height,N=x.props.margin||{},P=O-(N.left||0)-(N.right||0),I=pU({children:E,formattedGraphicalItems:_,legendWidth:P,legendContent:c});if(!I)return null;var k=I.item,C=nq(I,OPe);return g.cloneElement(k,ie(ie({},C),{},{chartWidth:O,chartHeight:M,margin:N,onBBoxUpdate:x.handleLegendBBoxUpdate}))}),Fe(x,"renderTooltip",function(){var _,S=x.props,E=S.children,O=S.accessibilityLayer,M=fr(E,Da);if(!M)return null;var N=x.state,P=N.isTooltipActive,I=N.activeCoordinate,k=N.activePayload,C=N.activeLabel,T=N.offset,A=(_=M.props.active)!==null&&_!==void 0?_:P;return g.cloneElement(M,{viewBox:ie(ie({},T),{},{x:T.left,y:T.top}),active:A,label:C,payload:A?k:[],coordinate:I,accessibilityLayer:O})}),Fe(x,"renderBrush",function(_){var S=x.props,E=S.margin,O=S.data,M=x.state,N=M.offset,P=M.dataStartIndex,I=M.dataEndIndex,k=M.updateId;return g.cloneElement(_,{key:_.key||"_recharts-brush",onChange:Ly(x.handleBrushChange,_.props.onChange),data:O,x:ye(_.props.x)?_.props.x:N.left,y:ye(_.props.y)?_.props.y:N.top+N.height+N.brushBottom-(E.bottom||0),width:ye(_.props.width)?_.props.width:N.width,startIndex:P,endIndex:I,updateId:"brush-".concat(k)})}),Fe(x,"renderReferenceElement",function(_,S,E){if(!_)return null;var O=x,M=O.clipPathId,N=x.state,P=N.xAxisMap,I=N.yAxisMap,k=N.offset,C=_.type.defaultProps||{},T=_.props,A=T.xAxisId,D=A===void 0?C.xAxisId:A,L=T.yAxisId,R=L===void 0?C.yAxisId:L;return g.cloneElement(_,{key:_.key||"".concat(S,"-").concat(E),xAxis:P[D],yAxis:I[R],viewBox:{x:k.left,y:k.top,width:k.width,height:k.height},clipPathId:M})}),Fe(x,"renderActivePoints",function(_){var S=_.item,E=_.activePoint,O=_.basePoint,M=_.childIndex,N=_.isRange,P=[],I=S.props.key,k=S.item.type.defaultProps!==void 0?ie(ie({},S.item.type.defaultProps),S.item.props):S.item.props,C=k.activeDot,T=k.dataKey,A=ie(ie({index:M,dataKey:T,cx:E.x,cy:E.y,r:4,fill:GO(S.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},yt(C,!1)),qm(C));return P.push(v.renderActiveDot(C,A,"".concat(I,"-activePoint-").concat(M))),O?P.push(v.renderActiveDot(C,ie(ie({},A),{},{cx:O.x,cy:O.y}),"".concat(I,"-basePoint-").concat(M))):N&&P.push(null),P}),Fe(x,"renderGraphicChild",function(_,S,E){var O=x.filterFormatItem(_,S,E);if(!O)return null;var M=x.getTooltipEventType(),N=x.state,P=N.isTooltipActive,I=N.tooltipAxis,k=N.activeTooltipIndex,C=N.activeLabel,T=x.props.children,A=fr(T,Da),D=O.props,L=D.points,R=D.isRange,B=D.baseLine,z=O.item.type.defaultProps!==void 0?ie(ie({},O.item.type.defaultProps),O.item.props):O.item.props,$=z.activeDot,V=z.hide,Y=z.activeBar,G=z.activeShape,K=!!(!V&&P&&A&&($||Y||G)),Q={};M!=="axis"&&A&&A.props.trigger==="click"?Q={onClick:Ly(x.handleItemMouseEnter,_.props.onClick)}:M!=="axis"&&(Q={onMouseLeave:Ly(x.handleItemMouseLeave,_.props.onMouseLeave),onMouseEnter:Ly(x.handleItemMouseEnter,_.props.onMouseEnter)});var q=g.cloneElement(_,ie(ie({},O.props),Q));function H(We){return typeof I.dataKey=="function"?I.dataKey(We.payload):null}if(K)if(k>=0){var X,te;if(I.dataKey&&!I.allowDuplicatedCategory){var F=typeof I.dataKey=="function"?H:"payload.".concat(I.dataKey.toString());X=IS(L,F,C),te=R&&B&&IS(B,F,C)}else X=L==null?void 0:L[k],te=R&&B&&B[k];if(G||Y){var se=_.props.activeIndex!==void 0?_.props.activeIndex:k;return[g.cloneElement(_,ie(ie(ie({},O.props),Q),{},{activeIndex:se})),null,null]}if(!gt(X))return[q].concat(jl(x.renderActivePoints({item:O,activePoint:X,basePoint:te,childIndex:k,isRange:R})))}else{var re,le=(re=x.getItemByXY(x.state.activeCoordinate))!==null&&re!==void 0?re:{graphicalItem:q},je=le.graphicalItem,Le=je.item,$e=Le===void 0?_:Le,Se=je.childIndex,Ve=ie(ie(ie({},O.props),Q),{},{activeIndex:Se});return[g.cloneElement($e,Ve),null,null]}return R?[q,null,null]:[q,null]}),Fe(x,"renderCustomized",function(_,S,E){return g.cloneElement(_,ie(ie({key:"recharts-customized-".concat(E)},x.props),x.state))}),Fe(x,"renderMap",{CartesianGrid:{handler:vg,once:!0},ReferenceArea:{handler:x.renderReferenceElement},ReferenceLine:{handler:vg},ReferenceDot:{handler:x.renderReferenceElement},XAxis:{handler:vg},YAxis:{handler:vg},Brush:{handler:x.renderBrush,once:!0},Bar:{handler:x.renderGraphicChild},Line:{handler:x.renderGraphicChild},Area:{handler:x.renderGraphicChild},Radar:{handler:x.renderGraphicChild},RadialBar:{handler:x.renderGraphicChild},Scatter:{handler:x.renderGraphicChild},Pie:{handler:x.renderGraphicChild},Funnel:{handler:x.renderGraphicChild},Tooltip:{handler:x.renderCursor,once:!0},PolarGrid:{handler:x.renderPolarGrid,once:!0},PolarAngleAxis:{handler:x.renderPolarAxis},PolarRadiusAxis:{handler:x.renderPolarAxis},Customized:{handler:x.renderCustomized}}),x.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:Hm("recharts"),"-clip"),x.throttleTriggeredAfterMouseMove=Rg(x.triggeredAfterMouseMove,(j=b.throttleDelay)!==null&&j!==void 0?j:1e3/60),x.state={},x}return $Pe(v,m),IPe(v,[{key:"componentDidMount",value:function(){var b,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,w=b.children,j=b.data,x=b.height,_=b.layout,S=fr(w,Da);if(S){var E=S.props.defaultIndex;if(!(typeof E!="number"||E<0||E>this.state.tooltipTicks.length-1)){var O=this.state.tooltipTicks[E]&&this.state.tooltipTicks[E].value,M=pN(this.state,j,E,O),N=this.state.tooltipTicks[E].coordinate,P=(this.state.offset.top+x)/2,I=_==="horizontal",k=I?{x:N,y:P}:{y:N,x:P},C=this.state.formattedGraphicalItems.find(function(A){var D=A.item;return D.type.name==="Scatter"});C&&(k=ie(ie({},k),C.props.points[E].tooltipPosition),M=C.props.points[E].tooltipPayload);var T={activeTooltipIndex:E,isTooltipActive:!0,activeLabel:O,activePayload:M,activeCoordinate:k};this.setState(T),this.renderCursor(S),this.accessibilityManager.setIndex(E)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var j,x;this.accessibilityManager.setDetails({offset:{left:(j=this.props.margin.left)!==null&&j!==void 0?j:0,top:(x=this.props.margin.top)!==null&&x!==void 0?x:0}})}return null}},{key:"componentDidUpdate",value:function(b){BS([fr(b.children,Da)],[fr(this.props.children,Da)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=fr(this.props.children,Da);if(b&&typeof b.props.shared=="boolean"){var w=b.props.shared?"axis":"item";return i.indexOf(w)>=0?w:a}return a}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var w=this.container,j=w.getBoundingClientRect(),x=Qwe(j),_={chartX:Math.round(b.pageX-x.left),chartY:Math.round(b.pageY-x.top)},S=j.width/w.offsetWidth||1,E=this.inRange(_.chartX,_.chartY,S);if(!E)return null;var O=this.state,M=O.xAxisMap,N=O.yAxisMap,P=this.getTooltipEventType();if(P!=="axis"&&M&&N){var I=yi(M).scale,k=yi(N).scale,C=I&&I.invert?I.invert(_.chartX):null,T=k&&k.invert?k.invert(_.chartY):null;return ie(ie({},_),{},{xValue:C,yValue:T})}var A=lq(this.state,this.props.data,this.props.layout,E);return A?ie(ie({},_),A):null}},{key:"inRange",value:function(b,w){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=this.props.layout,_=b/j,S=w/j;if(x==="horizontal"||x==="vertical"){var E=this.state.offset,O=_>=E.left&&_<=E.left+E.width&&S>=E.top&&S<=E.top+E.height;return O?{x:_,y:S}:null}var M=this.state,N=M.angleAxisMap,P=M.radiusAxisMap;if(N&&P){var I=yi(N);return NU({x:_,y:S},I)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,w=this.getTooltipEventType(),j=fr(b,Da),x={};j&&w==="axis"&&(j.props.trigger==="click"?x={onClick:this.handleClick}:x={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var _=qm(this.props,this.handleOuterEvent);return ie(ie({},_),x)}},{key:"addListener",value:function(){sN.on(cN,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){sN.removeListener(cN,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,w,j){for(var x=this.state.formattedGraphicalItems,_=0,S=x.length;_<S;_++){var E=x[_];if(E.item===b||E.props.key===b.key||w===Mo(E.item.type)&&j===E.childIndex)return E}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,w=this.state.offset,j=w.left,x=w.top,_=w.height,S=w.width;return W.createElement("defs",null,W.createElement("clipPath",{id:b},W.createElement("rect",{x:j,y:x,height:_,width:S})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(w,j){var x=tq(j,2),_=x[0],S=x[1];return ie(ie({},w),{},Fe({},_,S.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(w,j){var x=tq(j,2),_=x[0],S=x[1];return ie(ie({},w),{},Fe({},_,S.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(b){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(b){var w=this.state,j=w.formattedGraphicalItems,x=w.activeItem;if(j&&j.length)for(var _=0,S=j.length;_<S;_++){var E=j[_],O=E.props,M=E.item,N=M.type.defaultProps!==void 0?ie(ie({},M.type.defaultProps),M.props):M.props,P=Mo(M.type);if(P==="Bar"){var I=(O.data||[]).find(function(A){return kOe(b,A)});if(I)return{graphicalItem:E,payload:I}}else if(P==="RadialBar"){var k=(O.data||[]).find(function(A){return NU(b,A)});if(k)return{graphicalItem:E,payload:k}}else if(Gy(E,x)||Qy(E,x)||jp(E,x)){var C=bCe({graphicalItem:E,activeTooltipItem:x,itemData:N.data}),T=N.activeIndex===void 0?C:N.activeIndex;return{graphicalItem:ie(ie({},E),{},{childIndex:T}),payload:jp(E,x)?N.data[C]:E.props.data[C]}}}return null}},{key:"render",value:function(){var b=this;if(!MB(this))return null;var w=this.props,j=w.children,x=w.className,_=w.width,S=w.height,E=w.style,O=w.compact,M=w.title,N=w.desc,P=nq(w,CPe),I=yt(P,!1);if(O)return W.createElement(gH,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},W.createElement(VS,_l({},I,{width:_,height:S,title:M,desc:N}),this.renderClipPath(),kB(j,this.renderMap)));if(this.props.accessibilityLayer){var k,C;I.tabIndex=(k=this.props.tabIndex)!==null&&k!==void 0?k:0,I.role=(C=this.props.role)!==null&&C!==void 0?C:"application",I.onKeyDown=function(A){b.accessibilityManager.keyboardEvent(A)},I.onFocus=function(){b.accessibilityManager.focus()}}var T=this.parseEventsOfWrapper();return W.createElement(gH,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},W.createElement("div",_l({className:xt("recharts-wrapper",x),style:ie({position:"relative",cursor:"default",width:_,height:S},E)},T,{ref:function(A){b.container=A}}),W.createElement(VS,_l({},I,{width:_,height:S,title:M,desc:N,style:WPe}),this.renderClipPath(),kB(j,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(g.Component);Fe(f,"displayName",t),Fe(f,"defaultProps",ie({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),Fe(f,"getDerivedStateFromProps",function(m,v){var b=m.dataKey,w=m.data,j=m.children,x=m.width,_=m.height,S=m.layout,E=m.stackOffset,O=m.margin,M=v.dataStartIndex,N=v.dataEndIndex;if(v.updateId===void 0){var P=uq(m);return ie(ie(ie({},P),{},{updateId:0},p(ie(ie({props:m},P),{},{updateId:0}),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:_,prevLayout:S,prevStackOffset:E,prevMargin:O,prevChildren:j})}if(b!==v.prevDataKey||w!==v.prevData||x!==v.prevWidth||_!==v.prevHeight||S!==v.prevLayout||E!==v.prevStackOffset||!Wc(O,v.prevMargin)){var I=uq(m),k={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},C=ie(ie({},lq(v,w,S)),{},{updateId:v.updateId+1}),T=ie(ie(ie({},I),k),C);return ie(ie(ie({},T),p(ie({props:m},T),v)),{},{prevDataKey:b,prevData:w,prevWidth:x,prevHeight:_,prevLayout:S,prevStackOffset:E,prevMargin:O,prevChildren:j})}if(!BS(j,v.prevChildren)){var A,D,L,R,B=fr(j,ul),z=B&&(A=(D=B.props)===null||D===void 0?void 0:D.startIndex)!==null&&A!==void 0?A:M,$=B&&(L=(R=B.props)===null||R===void 0?void 0:R.endIndex)!==null&&L!==void 0?L:N,V=z!==M||$!==N,Y=!gt(w),G=Y&&!V?v.updateId:v.updateId+1;return ie(ie({updateId:G},p(ie(ie({props:m},v),{},{updateId:G,dataStartIndex:z,dataEndIndex:$}),v)),{},{prevChildren:j,dataStartIndex:z,dataEndIndex:$})}return null}),Fe(f,"renderActiveDot",function(m,v,b){var w;return g.isValidElement(m)?w=g.cloneElement(m,v):tt(m)?w=m(v):w=W.createElement(jW,v),W.createElement(fn,{className:"recharts-active-dot",key:b},w)});var y=g.forwardRef(function(m,v){return W.createElement(f,_l({},m,{ref:v}))});return y.displayName=f.displayName,y},tke=eke({chartName:"BarChart",GraphicalChild:vs,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:hg},{axisType:"yAxis",AxisComp:aN}],formatAxisMap:hNe});const nke={light:"",dark:".dark"},pq=g.createContext(null);function fq(){const e=g.useContext(pq);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const hq=g.forwardRef(({id:e,className:t,children:n,config:r,...a},o)=>{const i=g.useId(),s=`chart-${e||i.replace(/:/g,"")}`;return h.jsx(pq.Provider,{value:{config:r},children:h.jsxs("div",{"data-chart":s,ref:o,className:Z("flex aspect-video justify-center text-xs",t),...a,children:[h.jsx(rke,{id:s,config:r}),h.jsx(Wwe,{children:n})]})})});hq.displayName="Chart";const rke=({id:e,config:t})=>{const n=Object.entries(t).filter(([r,a])=>a.theme||a.color);return n.length?h.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(nke).map(([r,a])=>`
${a} [data-chart=${e}] {
${n.map(([o,i])=>{var c;const s=((c=i.theme)==null?void 0:c[r])||i.color;return s?`  --color-${o}: ${s};`:null}).join(`
`)}
}
`).join(`
`)}}):null},ake=Da,mq=g.forwardRef(({active:e,payload:t,className:n,indicator:r="dot",hideLabel:a=!1,hideIndicator:o=!1,label:i,labelFormatter:s,labelClassName:c,formatter:l,color:u,nameKey:d,labelKey:p},f)=>{const{config:y}=fq(),m=g.useMemo(()=>{var _;if(a||!(t!=null&&t.length))return null;const[b]=t,w=`${p||b.dataKey||b.name||"value"}`,j=fN(y,b,w),x=!p&&typeof i=="string"?((_=y[i])==null?void 0:_.label)||i:j==null?void 0:j.label;return s?h.jsx("div",{className:Z("font-medium",c),children:s(x,t)}):x?h.jsx("div",{className:Z("font-medium",c),children:x}):null},[i,s,t,a,c,y,p]);if(!e||!(t!=null&&t.length))return null;const v=t.length===1&&r!=="dot";return h.jsxs("div",{ref:f,className:Z("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[v?null:m,h.jsx("div",{className:"grid gap-1.5",children:t.map((b,w)=>{const j=`${d||b.name||b.dataKey||"value"}`,x=fN(y,b,j),_=u||b.payload.fill||b.color;return h.jsx("div",{className:Z("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",r==="dot"&&"items-center"),children:l&&(b==null?void 0:b.value)!==void 0&&b.name?l(b.value,b.name,b,w,b.payload):h.jsxs(h.Fragment,{children:[x!=null&&x.icon?h.jsx(x.icon,{}):!o&&h.jsx("div",{className:Z("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":v&&r==="dashed"}),style:{"--color-bg":_,"--color-border":_}}),h.jsxs("div",{className:Z("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[h.jsxs("div",{className:"grid gap-1.5",children:[v?m:null,h.jsx("span",{className:"text-muted-foreground",children:(x==null?void 0:x.label)||b.name})]}),b.value&&h.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:b.value.toLocaleString()})]})]})},b.dataKey)})})]})});mq.displayName="ChartTooltip";const oke=g.forwardRef(({className:e,hideIcon:t=!1,payload:n,verticalAlign:r="bottom",nameKey:a},o)=>{const{config:i}=fq();return n!=null&&n.length?h.jsx("div",{ref:o,className:Z("flex items-center justify-center gap-4",r==="top"?"pb-3":"pt-3",e),children:n.map(s=>{const c=`${a||s.dataKey||"value"}`,l=fN(i,s,c);return h.jsxs("div",{className:Z("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[l!=null&&l.icon&&!t?h.jsx(l.icon,{}):h.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:s.color}}),l==null?void 0:l.label]},s.value)})}):null});oke.displayName="ChartLegend";function fN(e,t,n){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=n;return n in t&&typeof t[n]=="string"?a=t[n]:r&&n in r&&typeof r[n]=="string"&&(a=r[n]),a in e?e[a]:e[n]}const yq=e=>{const t=["Bytes","KB","MB","GB","TB"];if(e===void 0)return"Unknown size";if(e===0)return"0 Byte";const n=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,n))} ${t[n]}`},ike=g.memo(()=>{const{t:e}=Pe("flows"),[t,n]=g.useState(),r=Wa(y=>y.cachedLLMURLs),a=Je(y=>y.currentSession),[o,i]=g.useState(),[s,c]=g.useState(""),[l,u]=g.useState(),d=g.useMemo(()=>({nodes:{label:e("session_info_node.entities.nodes"),color:"#2563eb"},edges:{label:e("session_info_node.entities.edges"),color:"#34d399"},threads:{label:e("session_info_node.entities.threads"),color:"#fbbf24"},llms:{label:e("session_info_node.entities.llms"),color:"#f87171"},prompts:{label:e("session_info_node.entities.prompts"),color:"#a78bfa"},tools:{label:e("session_info_node.entities.tools"),color:"#ffcccb"},schemas:{label:e("session_info_node.entities.schemas"),color:"#ffb6c1"},vectorDatabases:{label:e("session_info_node.entities.vector_databases"),color:"#ff69b4"},jsonlDatas:{label:e("session_info_node.entities.jsonl_data"),color:"#ff1493"},csvDatas:{label:e("session_info_node.entities.csv_data"),color:"#db7093"}}),[e]);g.useEffect(()=>{At(async()=>{const{functionCallingModelIds:y,prebuiltAppConfig:m}=await import("./index-s4oWTEmo.js").then(async v=>(await v.__tla,v));return{functionCallingModelIds:y,prebuiltAppConfig:m}},__vite__mapDeps([5,1,2,3,4])).then(({functionCallingModelIds:y,prebuiltAppConfig:m})=>{n(r==null?void 0:r.map(v=>{const b=m.model_list.find(w=>v.includes(w.model));if(b)return{model_id:(b==null?void 0:b.model_id)||"",info:b,isFunctionCalling:y.includes((b==null?void 0:b.model_id)||"")}}))})},[r,a==null?void 0:a.id]);const p=g.useCallback(async()=>{navigator.storage.estimate().then(y=>{y&&c(e("session_info_node.used_bytes",{used:yq(y.usage),total:yq(y==null?void 0:y.quota)}))}),a!=null&&a.id&&(Promise.all([ue("FlowNode").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("FlowEdge").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("Thread").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("Prompt").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("LLM").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("Schema").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("ToolDefinition").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("VectorDatabase").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("JSONLData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}}),ue("CSVData").findOne({where:{session_id:a==null?void 0:a.id},order:{updated_at:"DESC"}})]).then(y=>{const m=y.reduce((v,b)=>b!=null&&b.updated_at&&(!v||new Date(b.updated_at)>v)?new Date(b.updated_at):v,a.updated_at?new Date(a.updated_at):void 0);i(m)}),Promise.all([ue("FlowNode").count({where:{session_id:a==null?void 0:a.id}}),ue("FlowEdge").count({where:{session_id:a==null?void 0:a.id}}),ue("Thread").count({where:{session_id:a==null?void 0:a.id}}),ue("Prompt").count({where:{session_id:a==null?void 0:a.id}}),ue("LLM").count({where:{session_id:a==null?void 0:a.id}}),ue("ToolDefinition").count({where:{session_id:a==null?void 0:a.id}}),ue("Schema").count({where:{session_id:a==null?void 0:a.id}}),ue("VectorDatabase").count({where:{session_id:a==null?void 0:a.id}}),ue("JSONLData").count({where:{session_id:a==null?void 0:a.id}}),ue("CSVData").count({where:{session_id:a==null?void 0:a.id}})]).then(([y,m,v,b,w,j,x,_,S,E])=>{u([{name:e("session_info_node.count_info.title"),nodes:y||0,edges:m||0,threads:v||0,prompts:b||0,llms:w||0,tools:j||0,schemas:x||0,vectorDatabases:_||0,jsonlDatas:S||0,csvDatas:E||0}])}))},[a==null?void 0:a.id,a==null?void 0:a.updated_at,e]),f=g.useCallback(()=>{p()},[p]);return g.useEffect(()=>{p()},[p]),h.jsxs(Zt,{className:"w-96",children:[h.jsxs(Ln,{children:[h.jsx(Kn,{children:e("session_info_node.title")}),h.jsx(m8,{children:o||a!=null&&a.updated_at?JAe(o||(a==null?void 0:a.updated_at)).fromNow():""})]}),h.jsxs($n,{className:"grid gap-4",children:[h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsx("p",{className:"text-sm font-medium leading-none",children:e("session_info_node.disk_size")}),h.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})}),h.jsx("div",{className:"flex items-center space-x-4 rounded-md border p-4",children:h.jsxs("div",{className:"flex-1 space-y-1",children:[h.jsxs("div",{className:"text-sm font-medium leading-none",children:[e("session_info_node.cached_llms"),h.jsx(un,{className:"ml-2",children:(t==null?void 0:t.length)||0})]}),t==null?void 0:t.map(y=>h.jsxs("div",{className:"text-sm text-muted-foreground gap-1",children:[y==null?void 0:y.model_id,h.jsx("div",{className:"max-w-full gap-1 flex flex-wrap mt-1",children:h.jsx(Od,{model:y==null?void 0:y.info,isFunctionCalling:(y==null?void 0:y.isFunctionCalling)||!1,isCached:!0})})]},y==null?void 0:y.model_id))]})}),h.jsx("div",{children:h.jsx(hq,{config:d,className:"min-h-28 w-full",children:h.jsxs(tke,{accessibilityLayer:!0,data:l,children:[h.jsx(VH,{vertical:!1}),h.jsx(hg,{dataKey:"name",tickLine:!1,tickMargin:10,axisLine:!1}),h.jsx(ake,{content:h.jsx(mq,{})}),Object.entries(d).map(([y,m])=>h.jsx(vs,{dataKey:y,fill:m.color,radius:4},y))]})})})]}),h.jsx(ci,{children:h.jsxs(ut,{className:"w-full",onClick:f,children:[h.jsx(de,{size:24,name:"refresh-ccw"}),e("session_info_node.reload")]})})]})}),ske=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);An(e,t)},cke=g.memo(e=>{var c,l;const{t}=Pe("flows"),{id:n,data:r,isConnectable:a}=e,o=g.useRef(!1),i=Tn(n),s=De(u=>u.updateNodes);return ske(n),g.useEffect(()=>{var d;const u=r==null?void 0:r.entity;!u||!i||o.current||(d=u==null?void 0:u.schema_items)!=null&&d.length||r.loaded||(o.current=!0,ue("SchemaItem").find({where:{schema_id:u.id}}).then(p=>{s([{id:i.id,type:"replace",item:{...i,data:{...(i==null?void 0:i.data)||{},loaded:!0,entity:{...r.entity,schema_items:p}}}}])}).finally(()=>{o.current=!1}))},[r.entity,r.loaded,i,s]),h.jsxs("div",{children:[h.jsxs("div",{children:[h.jsx(Nn,{id:n}),h.jsxs(xj,{defaultValue:"account",className:"w-[400px]",children:[h.jsxs(xm,{className:"grid w-full grid-cols-2",children:[h.jsx(ra,{value:"account",children:t("schema_node.typescript")}),h.jsx(ra,{value:"password",children:t("schema_node.zod")})]}),h.jsx(aa,{value:"account",children:h.jsx(Zt,{className:"p-4",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:Vfe(((c=r==null?void 0:r.entity)==null?void 0:c.schema_items)||[])})})}),h.jsx(aa,{value:"password",children:h.jsx(Zt,{className:"p-4 max-w-full",children:h.jsx("pre",{className:"overflow-hidden break-words whitespace-pre-wrap",children:h8(((l=r==null?void 0:r.entity)==null?void 0:l.schema_items)||[])})})})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:a})]})}),lke=g.memo(e=>{var o,i;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{if(!(n!=null&&n.entity))return{headers:[],rows:[]};const s=kg(n.entity.csv);return{headers:MN(n.entity.headers),rows:s.map(c=>MN(c))}},[n==null?void 0:n.entity]);return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Zt,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Ln,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(de,{name:"file-spreadsheet",className:"mr-2"}),h.jsxs(nt,{className:"!font-medium leading-none tracking-tight pr-8",children:[oe.CSVData," ",(o=a==null?void 0:a.rows)!=null&&o.length?`(${((i=a==null?void 0:a.rows)==null?void 0:i.length)||0})`:""]})]})}),h.jsx($n,{className:"pb-0",children:h.jsx(Tm,{data:a.rows,headers:a.headers})})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),uke=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.Schema&&(o==null?void 0:o.type)===oe.ToolDefinition){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},dke=g.memo(({id:e,data:t,isConnectable:n})=>{var r,a;return uke(e),h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:n}),h.jsx("div",{children:h.jsxs(Ra,{className:"flex justify-center",children:[h.jsx(de,{size:24,name:"wrench"}),h.jsxs("div",{className:"ml-2",children:[h.jsx(Co,{children:`${((r=t.entity)==null?void 0:r.name)||""}`}),h.jsx(zc,{children:`${((a=t.entity)==null?void 0:a.description)||""}`})]})]})}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:n})]})}),pke=e=>{const t=g.useCallback(async({edgeId:n})=>({deleteEdgeId:n}),[]);An(e,t)},fke=g.memo(e=>{const{id:t,data:n,isConnectable:r}=e;return pke(t),h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsx("div",{children:h.jsxs(Ra,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(Aa,{name:n.model||"brain",className:"w-7 h-7"}),h.jsx("div",{className:"ml-2 pr-4 flex items-center",children:h.jsx(Co,{children:`${n.model||""}`})})]})}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),hke=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
Use three sentences maximum and keep the answer as concise as possible.

{context}
`,mke=qa(e=>{const{source:t,documents:n}=e,r=Wt(),{toast:a}=Gt(),{t:o}=Pe("dialogs"),{loading:i,createPrompt:s}=H9(),c=async l=>{try{if(!l.content||!l.content.includes("{context}")){a({title:o("create_vector_database_prompt.errors.fill_context"),variant:"destructive"});return}const u=l.content.replace("{context}",n.map(d=>`<document>${d.pageContent}</document>`).join(`
`));return await s(t,{...l,content:u}),r.hide(),!0}catch{a({title:o("create_vector_database_prompt.errors.create_failed"),variant:"destructive"})}};return h.jsx(Jo,{open:r.visible,onOpenChange:r.hide,children:h.jsxs(ro,{className:"sm:max-w-[425px]",children:[h.jsx(ao,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(oo,{children:o("create_vector_database_prompt.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(SS,{onSubmit:c,loading:i,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:hke}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(de,{name:"info",className:"mr-2",size:14}),o("create_vector_database_prompt.fill_content_note")]})]})]})})}),yke=()=>{const e=Je(i=>{var s;return(s=i.currentSession)==null?void 0:s.id}),[t,n]=g.useState(!1),r=De(i=>i.createOrUpdateFlowNode),a=De(i=>i.createOrUpdateFlowEdge),o=g.useCallback(async({prompt:i,source:s,metadata:c})=>{var l,u,d,p;try{const f=(l=s==null?void 0:s.data)==null?void 0:l.entity;if(!f||!e)throw new Error("Source or Session not found");n(!0);const y=((u=s.position)==null?void 0:u.x)||0,m=(((d=s.position)==null?void 0:d.y)||0)+(((p=s.measured)==null?void 0:p.height)||0),v=await ue("Prompt").save({...i,status:(i==null?void 0:i.status)||Ir.Started,role:(i==null?void 0:i.role)||nr.System,type:(i==null?void 0:i.type)||rr.Chat,content:(i==null?void 0:i.content)||"{context}",session_id:e});if(!v)throw new Error("Failed to save prompt");const b=await r({source_id:v.id,source_type:"Prompt",node_type:oe.Prompt,x:y,y:m+20});if(!b)throw new Error("Failed to save prompt node");const w=await ue("FlowNodePlaceholder").save({placeholder:`Retriever for ${f.name}`,placeholder_type:Ts.VECTOR_DATABASE_RETREIVER,session_id:e,metadata:c});if(!w)throw new Error("Failed to save node placeholder");const j=await r({source_id:w.id,source_type:"FlowNodePlaceholder",node_type:oe.PlaceHolder,x:y,y:m+40});if(!j)throw new Error("Failed to save node placeholder node");await a({source:b.id,target:j.id}),await a({source:s.id,target:j.id})}finally{n(!1)}},[e,r,a]);return{loading:t,createVectorDatabaseRetriever:o}},gke=`Use the following pieces of context to answer the question at the end.
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}
`,vke=qa(e=>{const{source:t}=e,n=Wt(),{toast:r}=Gt(),{t:a}=Pe("dialogs"),[o,i]=g.useState(1),[s,c]=g.useState(void 0),{loading:l,createVectorDatabaseRetriever:u}=yke(),d=async y=>{try{const m=y.content;if(!m||!m.includes("{context}")){r({title:a("create_vector_database_retriever.errors.fill_context"),variant:"destructive"});return}return await u({source:t,prompt:{content:m},metadata:{k:o,minimalScore:s}}),i(1),c(void 0),n.hide(),!0}catch{r({title:a("create_vector_database_retriever.errors.create_failed"),variant:"destructive"})}},p=y=>{i(y.target.value?Number(y.target.value):void 0)},f=y=>{c(y.target.value?Number(y.target.value):void 0)};return h.jsx(Jo,{open:n.visible,onOpenChange:n.hide,children:h.jsxs(ro,{className:"sm:max-w-[425px]",children:[h.jsx(ao,{children:h.jsxs("div",{className:"flex",children:[h.jsx(de,{name:"file",className:"mr-2 h-4 w-4"}),h.jsx(oo,{children:a("create_vector_database_retriever.title")})]})}),h.jsxs("div",{className:"flex gap-4 py-4 flex-col",children:[h.jsx(SS,{onSubmit:d,loading:l,hidePromptType:!0,defaultPromptRole:"system",defaultPromptContent:gke}),h.jsxs(Zt,{children:[h.jsx(Ln,{children:h.jsx(Kn,{children:a("create_vector_database_retriever.retriever_settings")})}),h.jsxs($n,{children:[h.jsx(nt,{children:a("create_vector_database_retriever.retriever_k")}),h.jsx(En,{value:o||"",type:"number",onChange:p,placeholder:a("create_vector_database_retriever.retriever_k_placeholder")}),h.jsx(nt,{children:a("create_vector_database_retriever.retriever_minimum_score")}),h.jsx(En,{value:s||"",type:"number",onChange:f,placeholder:a("create_vector_database_retriever.retriever_minimum_score_placeholder")})]})]}),h.jsxs("div",{className:"w-full border-0 text-gray-700 flex text-sm items-center",children:[h.jsx(de,{name:"info",className:"mr-2",size:14}),a("create_vector_database_retriever.fill_content_note")]})]})]})})}),bke=e=>{const t=De(a=>a.createOrUpdateFlowEdge),n=Ss(a=>a.index),r=g.useCallback(async({edgeId:a,target:o,source:i})=>{var s,c;try{const l=(s=o==null?void 0:o.data)==null?void 0:s.entity;if((i==null?void 0:i.type)===oe.CSVData&&(o==null?void 0:o.type)===oe.VectorDatabase){const u=(c=i==null?void 0:i.data)==null?void 0:c.entity;if(!u||!l)return{deleteEdgeId:a};const{rows:d}=wK(u.headers,u.csv),p=d.map(f=>new Fp({pageContent:`${f.text}`}));await n({databaseId:l.id,dataSourceId:u.id,dataSourceType:"CSVData"},p),await t({source:i.id,target:o.id});return}return{deleteEdgeId:a}}catch{return{deleteEdgeId:a}}},[t,n]);An(e,r)},wke=e=>{const[t,n]=g.useState(!1),{t:r}=Pe("flows"),{toast:a}=Gt(),{getNode:o,getHandleConnections:i}=lr(),s=De(p=>p.updateNodes),c=Ss(p=>p.index),l=Ss(p=>p.similaritySearchWithScore),u=g.useCallback(async(p,f)=>{var y,m,v;try{const b=o(e);if(!b)return;const w=(y=b.data)==null?void 0:y.entity;if(!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(w.storage===kr.DataNode){const j=(v=(m=i({nodeId:e,type:"target"}).map(x=>o(x.source)).find(x=>(x==null?void 0:x.type)&&[oe.JSONLData,oe.CSVData].includes(x==null?void 0:x.type)))==null?void 0:m.data)==null?void 0:v.entity;if(!j){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}return n(!0),await l({databaseId:w.id,dataSourceId:j.id,dataSourceType:NN(j)},p,f==null?void 0:f.k)}else return n(!0),await l({databaseId:w.id},p,f==null?void 0:f.k)}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,l,a,r,o]),d=g.useCallback(async(p,f)=>{var y,m,v,b;try{const w=o(e);if(!w)return;n(!0);const j=p.content?[new Fp({pageContent:p.content,id:p.id,metadata:{id:p.id}})]:p.documents;if(!(j!=null&&j.length)){a({variant:"destructive",title:r("vector_database_node.errors.content_not_found")});return}const x=(y=w.data)==null?void 0:y.entity;if(!x||!w){a({variant:"destructive",title:r("vector_database_node.errors.vector_database_not_found")});return}if(x.storage===kr.DataNode){const _=i({nodeId:e,type:"target"}).map(N=>o(N.source)).find(N=>(N==null?void 0:N.type)&&[oe.JSONLData,oe.CSVData].includes(N==null?void 0:N.type)),S=(m=_==null?void 0:_.data)==null?void 0:m.entity;if(!S){a({variant:"destructive",title:r("vector_database_node.errors.data_node_not_found")});return}const E=NN(S),O=Hj(j,10);let M=0;for(const N of O){if((v=f==null?void 0:f.onProgressReport)==null||v.call(f,{handling:N.length,handled:M,total:j.length}),await c({databaseId:x.id,dataSourceId:S.id,dataSourceType:E},N),E&&_){const P=await ue(E).findOne({where:{id:S.id}});s([{type:"replace",id:_.id,item:{..._,data:{..._.data,entity:P}}}])}M+=N.length}}else{const _=Hj(j,10);let S=0;for(const E of _){(b=f==null?void 0:f.onProgressReport)==null||b.call(f,{handling:E.length,handled:S,total:j.length}),await c({databaseId:x.id},E);const O=await ue("VectorDatabase").findOne({where:{id:`${x.id}`}});s([{type:"replace",id:w.id,item:{...w,data:{...w.data,entity:O}}}]),S+=E.length}}}catch{a({variant:"destructive",title:r("vector_database_node.errors.similarity_search_failed")})}finally{n(!1)}},[i,e,c,a,r,o,s]);return{loading:t,indexData:d,similaritySearchWithScore:u}},xke=g.memo(e=>{var S,E,O,M;const{t}=Pe("flows"),[n,r]=g.useState(0),[a,o]=g.useState("search"),i=Tn(e.id),{id:s,data:c,isConnectable:l}=e,{loading:u,similaritySearchWithScore:d,indexData:p}=wke(s),f=Wt(mke),y=Wt(vke);bke(s);const m=g.useCallback(async(...N)=>{i&&await p(...N)},[p,i]),v=g.useCallback(async(N,P)=>{const I=N.trim(),k=await d(I,{k:P});if(k!=null&&k.length)return k},[d]),b=g.useCallback(N=>{f.show({source:i,documents:N.map(([P])=>P)})},[f,i]),w=g.useCallback(async()=>{y.show({source:i})},[y,i]),j=g.useCallback(async N=>{if(N.type.includes("text")||N.type.includes("txt")){const P=new FileReader;P.onload=async I=>{var C;const k=(C=I.target)==null?void 0:C.result;await m({content:k})},P.readAsText(N)}else if(N.type.endsWith("pdf")){const P=new Blob([N],{type:"application/pdf"}),I=await new y8(P,{pdfjs:async()=>{const k=await At(()=>import("./pdf.min-DM_kRsgY.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([7,1,2,3,4]));return await At(()=>import("./pdf.worker.min-BkmVjn3H.js").then(async C=>(await C.__tla,C)),__vite__mapDeps([8,1,2,3,4])),k.GlobalWorkerOptions.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",import.meta.url).toString(),k},parsedItemSeparator:" "}).load();await m({documents:I},{onProgressReport:k=>{r((k.handled+k.handling)/k.total)}})}},[m]),x=g.useMemo(()=>{var I,k;if(!((I=c==null?void 0:c.entity)!=null&&I.raw))return{headers:[],rows:[]};const N=["content","embedding","metadata"],P=kg((k=c==null?void 0:c.entity)==null?void 0:k.raw);return{headers:N,rows:P.map(C=>{try{return JSON.parse(C)}catch{return[]}})}},[(S=c==null?void 0:c.entity)==null?void 0:S.raw]),_=g.useMemo(()=>{switch(a){case"search":return h.jsx(aa,{value:"search",children:h.jsx(C$,{loading:u,onSimilaritySearch:v,onCreatePrompt:b,onCreateRetriever:w})});case"new":return h.jsx(aa,{className:"min-w-80",value:"new",children:h.jsx(N$,{loading:u,onCreateData:m})});case"file":return h.jsx(aa,{value:"file",children:h.jsx(M$,{loading:u,progress:n,onFileSubmit:j,fileOptions:{accept:".pdf,.txt,.text",maxSize:1}})});case"view":return h.jsx(aa,{value:"view",children:h.jsx(Tm,{data:x.rows,headers:x.headers,limitLengthByColumns:{embedding:32}})})}},[m,b,w,j,v,u,a,n,x]);return h.jsxs("div",{className:"min-w-72",children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:l}),h.jsxs("div",{className:"max-w-full",children:[h.jsx(Nn,{id:s}),h.jsxs(Ra,{className:"flex justify-center",variant:"default",children:[h.jsx(de,{size:24,name:"database-zap"}),h.jsxs("div",{className:"ml-2 max-w-full",children:[h.jsx(Co,{children:`${((E=c.entity)==null?void 0:E.name)||""}`}),h.jsxs(xj,{value:a,onValueChange:o,defaultValue:"search",className:Z("w-full mt-4"),children:[h.jsxs(xm,{className:Z("grid w-full grid-cols-3",((O=c.entity)==null?void 0:O.storage)===kr.DatabaseNode?"grid-cols-4":"grid-cols-3"),children:[h.jsx(ra,{value:"search",children:t("vector_database_node.search")}),h.jsx(ra,{value:"new",children:t("vector_database_node.text")}),h.jsx(ra,{value:"file",children:t("vector_database_node.file")}),((M=c.entity)==null?void 0:M.storage)===kr.DatabaseNode?h.jsx(ra,{value:"view",children:t("vector_database_node.view")}):void 0]}),_]})]})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:l})]})}),_ke={embedding:32},jke=g.memo(e=>{var o,i,s;const{id:t,data:n,isConnectable:r}=e,a=g.useMemo(()=>{var u;if(!((u=n==null?void 0:n.entity)!=null&&u.jsonl))return{headers:[],rows:[]};const c=MN(n.entity.headers||""),l=kg(n.entity.jsonl);return{headers:c,rows:l.map(d=>{try{return JSON.parse(d)}catch{return[]}})}},[(o=n==null?void 0:n.entity)==null?void 0:o.jsonl,n.entity.headers]);return h.jsxs("div",{className:"min-w-80",children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs("div",{children:[h.jsx(Nn,{id:t}),h.jsxs(Zt,{className:"min-w-32 min-h-16 p-4",children:[h.jsx(Ln,{className:"!p-0",children:h.jsxs("div",{className:"pt-2 flex !flex-row",children:[h.jsx(de,{name:"file-json",className:"mr-2"}),h.jsxs(nt,{className:"!font-medium leading-none tracking-tight pr-8",children:[oe.JSONLData," ",(i=a==null?void 0:a.rows)!=null&&i.length?`(${((s=a==null?void 0:a.rows)==null?void 0:s.length)||0})`:""]})]})}),h.jsx($n,{className:"pb-0",children:h.jsx(Tm,{data:a.rows,headers:a.headers,limitLengthByColumns:_ke})})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),gq=60,vq=140,Ske=Ha("supports-backdrop-blur:bg-white/10 supports-backdrop-blur:dark:bg-black/10 mx-auto flex h-[58px] w-max gap-2 rounded-lg border p-2 backdrop-blur-md"),bq=W.forwardRef(({className:e,children:t,magnification:n=gq,distance:r=vq,direction:a="bottom",...o},i)=>{const s=Iv(1/0),c=()=>W.Children.map(t,l=>W.isValidElement(l)&&l.type===kp?W.cloneElement(l,{...l.props,mouseX:s,magnification:n,distance:r}):l);return h.jsx(Rp.div,{ref:i,onMouseMove:l=>s.set(l.pageX),onMouseLeave:()=>s.set(1/0),...o,className:Z(Ske({className:e}),{"items-start":a==="top","items-center":a==="middle","items-end":a==="bottom"}),children:c()})});bq.displayName="Dock";const kp=({magnification:e=gq,distance:t=vq,mouseX:n,className:r,children:a,...o})=>{const i=g.useRef(null),s=NM(n||new e2e,u=>{var p;const d=((p=i.current)==null?void 0:p.getBoundingClientRect())??{x:0,width:0};return u-d.x-d.width/2}),c=NM(s,[-t,0,t],[40,e,40]),l=FK(c,{mass:.1,stiffness:150,damping:12});return h.jsx(Rp.div,{ref:i,style:{width:l},className:Z("flex aspect-square cursor-pointer items-center justify-center rounded-full",r),...o,children:a})};kp.displayName="DockIcon";let wq,xq,_q,jq,wg,Sq,Ap,Eq,Oq,Cq,Nq,Mq,Pq,kq,Aq,Tq,Iq,Rq,Dq,Lq,$q,Fq,Bq,zq,Vq,Uq,Wq,Hq;wq=e=>g.createElement("svg",{viewBox:"0 0 256 254",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:256,height:254,preserveAspectRatio:"xMidYMid",...e},g.createElement("defs",null,g.createElement("linearGradient",{id:"c",x1:"50%",x2:"50%",y1:"0%",y2:"100%"},g.createElement("stop",{offset:"0%",stopColor:"#FFF"}),g.createElement("stop",{offset:"100%",stopColor:"#FFF",stopOpacity:0})),g.createElement("path",{id:"a",d:"M180.828 252.605a15.872 15.872 0 0 0 12.65-.486l52.501-25.262a15.94 15.94 0 0 0 9.025-14.364V41.197a15.939 15.939 0 0 0-9.025-14.363l-52.5-25.263a15.877 15.877 0 0 0-18.115 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.507 91.695a15.853 15.853 0 0 0 5.464 3.571Zm10.464-183.649-76.262 57.889 76.262 57.888V68.956Z"})),g.createElement("mask",{id:"b",fill:"#fff"},g.createElement("use",{xlinkHref:"#a"})),g.createElement("path",{fill:"#0065A9",d:"M246.135 26.873 193.593 1.575a15.885 15.885 0 0 0-18.123 3.08L3.466 161.482c-4.626 4.219-4.62 11.502.012 15.714l14.05 12.772a10.625 10.625 0 0 0 13.569.604L238.229 33.436c6.949-5.271 16.93-.315 16.93 8.407v-.61a15.938 15.938 0 0 0-9.024-14.36Z"}),g.createElement("path",{fill:"#007ACC",d:"m246.135 226.816-52.542 25.298a15.887 15.887 0 0 1-18.123-3.08L3.466 92.207c-4.626-4.218-4.62-11.502.012-15.713l14.05-12.773a10.625 10.625 0 0 1 13.569-.603l207.132 157.135c6.949 5.271 16.93.315 16.93-8.408v.611a15.939 15.939 0 0 1-9.024 14.36Z"}),g.createElement("path",{fill:"#1F9CF0",d:"M193.428 252.134a15.892 15.892 0 0 1-18.125-3.083c5.881 5.88 15.938 1.715 15.938-6.603V11.273c0-8.318-10.057-12.483-15.938-6.602a15.892 15.892 0 0 1 18.125-3.084l52.533 25.263a15.937 15.937 0 0 1 9.03 14.363V212.51c0 6.125-3.51 11.709-9.03 14.363l-52.533 25.262Z"}),g.createElement("path",{fill:"url(#c)",fillOpacity:.25,d:"M180.828 252.605a15.874 15.874 0 0 0 12.65-.486l52.5-25.263a15.938 15.938 0 0 0 9.026-14.363V41.197a15.939 15.939 0 0 0-9.025-14.363L193.477 1.57a15.877 15.877 0 0 0-18.114 3.084L74.857 96.35l-43.78-33.232a10.614 10.614 0 0 0-13.56.603L3.476 76.494c-4.63 4.211-4.635 11.495-.012 15.713l37.967 34.638-37.967 34.637c-4.623 4.219-4.618 11.502.012 15.714l14.041 12.772a10.614 10.614 0 0 0 13.56.604l43.78-33.233 100.506 91.695a15.857 15.857 0 0 0 5.465 3.571Zm10.464-183.65-76.262 57.89 76.262 57.888V68.956Z"})),xq=e=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-minus size-6",...e},g.createElement("path",{d:"M5 12h14"})),_q={[oe.Shape]:{width:100,height:100},[oe.CircleShape]:{width:100,height:100},[oe.TriangleShape]:{width:100,height:100},[oe.EditorApp]:{width:1240,height:400}},jq=e=>{const t=Tn(e),n=Je(s=>s.currentSession),[r,a]=g.useState(!1),o=De(s=>s.createOrUpdateFlowNode),i=g.useCallback(async s=>{var c,l,u;try{if(a(!0),t&&(n==null?void 0:n.id)){const d=((c=t.position)==null?void 0:c.x)||0,p=(((l=t.position)==null?void 0:l.y)||0)+(((u=t.measured)==null?void 0:u.height)||0),f=await ue("FlowNodeData").save({data:{},session_id:n.id});if(!f)throw new Error("Failed to save node data");if(!await o({node_type:s,data:{},source_id:f.id,source_type:"FlowNodeData",x:d,y:p+20,..._q[s]||{}}))throw new Error("Failed to save node")}}finally{a(!1)}},[o,n==null?void 0:n.id,t]);return{loading:r,createNode:i}},wg={applications:[{key:oe.EditorApp,icon:xq,label:"application_bar.editor"},{key:oe.VSLiteApp,icon:wq,label:"application_bar.vslite"}],shapes:[{key:oe.Shape,icon:"square",label:"application_bar.square"},{key:oe.CircleShape,icon:"circle",label:"application_bar.circle"},{key:oe.TriangleShape,icon:"triangle",label:"application_bar.triangle"}],old:[{key:oe.CodeContainerApp,icon:"file-code-2",label:"application_bar.code_editor"}]},Sq=g.memo(e=>{const{t}=Pe("flows"),{toast:n}=Gt(),{loading:r,createNode:a}=jq(e.id),o=async i=>{try{if(r)return;await a(i)}catch{n({description:t("application_bar.errors.add_node_failed"),variant:"destructive"})}};return h.jsx(lu,{children:h.jsxs(bq,{direction:"middle",children:[wg.applications.map(i=>{const s=i.icon;return h.jsx(kp,{children:h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(s,{width:20,height:20,onClick:()=>o(i.key)})}),h.jsx(Br,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)}),h.jsx(Ms,{orientation:"vertical",className:"h-full"}),wg.shapes.map(i=>h.jsx(kp,{children:h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(de,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Br,{children:h.jsx("p",{children:t(i.label)})})]})},i.label)),h.jsx(Ms,{orientation:"vertical",className:"h-full"}),wg.old.map(i=>h.jsx(kp,{children:h.jsxs(ba,{children:[h.jsx(wa,{children:h.jsx(de,{onClick:()=>o(i.key),name:i.icon})}),h.jsx(Br,{children:h.jsx("p",{children:t(i.label)})})]})},i.label))]})})}),Ap=g.memo(e=>{const{lineClassName:t,handleClassName:n,...r}=e;return h.jsx(tle,{lineClassName:Z("!border-1.5",t),handleClassName:Z("!w-2 !h-2 !border-2 !rounded-full",n),...r})}),Eq=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.CircleShape,oe.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.Shape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Oq=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return Eq(t),h.jsxs(h.Fragment,{children:[h.jsx(Ap,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border border",children:h.jsx(Nn,{id:t})}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:r})]})}),Cq=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.Shape,oe.TriangleShape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.CircleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Nq=g.memo(e=>{const{id:t,selected:n,isConnectable:r}=e;return Cq(t),h.jsxs(h.Fragment,{children:[h.jsx(Ap,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsx("div",{className:"min-w-10 min-h-10 w-full h-full bg-border rounded-full border",children:h.jsx(Nn,{id:t})}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:r})]})}),Mq=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if([oe.CircleShape,oe.Shape].includes(a==null?void 0:a.type)&&(o==null?void 0:o.type)===oe.TriangleShape){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Pq=g.memo(e=>{const{id:t,selected:n,width:r,height:a,isConnectable:o}=e;return Mq(t),h.jsxs(h.Fragment,{children:[h.jsx(Ap,{isVisible:!!n,minWidth:40,minHeight:40}),h.jsx(lt,{type:"target",position:fe.Top,isConnectable:o}),h.jsx("div",{className:"w-0 h-0 border-l-transparent border-r-transparent border-b-border",style:{borderLeftWidth:(r||0)/2,borderRightWidth:(r||0)/2,borderBottomWidth:a||0}}),h.jsx(Nn,{id:t,className:"absolute top-0 right-0"}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:o})]})}),kq=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.EditorApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Aq=e=>{const t=Tn(e),{t:n}=Pe("flows"),r=g.useRef(null),{toast:a}=Gt(),{getNode:o,getHandleConnections:i}=lr(),{stream:s}=kc(),c=g.useCallback(async d=>{t&&(clearTimeout(r.current),r.current=setTimeout(async()=>{await ue("FlowNode").update(t.id,{data:d})},150))},[t]),l=g.useCallback(async(d,p)=>{var f;if(t){const y=i({nodeId:e,type:"target"}).find(b=>{var w;return((w=o(b.source))==null?void 0:w.type)===oe.LLM}),m=y?o(y==null?void 0:y.source):void 0,v=(f=m==null?void 0:m.data)==null?void 0:f.entity;if(!m||!v)return a({variant:"destructive",description:n("editor_node.errors.llm_not_found")});if(m.data.status!==Ge.Loaded)return a({variant:"destructive",description:n("editor_node.errors.llm_not_loaded_yet")});try{return(await s(v.provider,typeof d=="string"?[new Pr(d)]:d,{onMessageUpdate:b=>{p==null||p(b.content)},llm:v})).content}catch(b){if(b instanceof Error&&b.message.includes("LLM_NOT_LOADED_YET"))return a({title:n("editor_node.errors.llm_not_loaded_yet")});a({variant:"destructive",title:n("editor_node.errors.stream_message_failed")})}}},[t,i,e,o,a,n,s]),u=g.useCallback(d=>{if(!o(d))return[];const p=[];return i({nodeId:d,type:"target"}).forEach(f=>{const y=o(f.source);!y||y.type!==oe.LLM||p.push({node:y,connections:[f]})}),p},[i,o]);return{createMessage:l,updateEditorContent:c,getLinkedConnections:u}},Tq=g.lazy(()=>At(()=>import("./index-t_d66ir0.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([13,1,2,14,15,11,16,4,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,3,56]))),Iq=g.memo(e=>{var l;const{id:t,data:n,selected:r,isConnectable:a}=e;kq(t);const{createMessage:o,updateEditorContent:i,getLinkedConnections:s}=Aq(t),c=g.useCallback(u=>{i(u)},[i]);return h.jsxs("div",{className:"w-full min-w-[1240px] h-full",children:[h.jsx(Ap,{isVisible:!!r,minWidth:1240,minHeight:400}),h.jsx(lt,{type:"target",position:fe.Top,isConnectable:a}),h.jsxs("div",{className:"min-w-10 min-h-10 w-full h-full rounded-lg border bg-background",children:[h.jsx(Nn,{className:"!z-[100]",id:t,enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-ful rounded-lg flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx("div",{className:"h-full w-ful rounded-lg","data-registry":"plate",children:h.jsx(Tq,{defaultValue:(l=n==null?void 0:n.flowNode)==null?void 0:l.data,onValueChange:c,copilotStream:o})})})]}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:a})]})}),Rq=e=>{const t=g.useCallback(async({edgeId:n})=>{try{return{deleteEdgeId:n}}catch{return{deleteEdgeId:n}}},[]);An(e,t)},Dq=g.memo(e=>{var i,s;const{id:t,data:n,isConnectable:r}=e,{t:a}=Pe("flows");Rq(t);let o="";switch((i=n.entity)==null?void 0:i.placeholder_type){case"VECTOR_DATABASE_RETREIVER":o=a("placeholder_node.vector_database_retriever");break}return h.jsxs("div",{children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:r}),h.jsxs(Ra,{className:"flex justify-center max-w-80",variant:"default",children:[h.jsx(Nn,{id:t}),h.jsx(de,{name:"land-plot",className:"w-7 h-7"}),h.jsxs("div",{className:"ml-2 pr-4",children:[h.jsx(Co,{children:`${((s=n.entity)==null?void 0:s.placeholder)||""}`}),h.jsx(zc,{children:o?h.jsx(un,{children:o}):void 0})]})]}),h.jsx(lt,{type:"source",position:fe.Bottom,id:"a",isConnectable:r})]})}),Lq=g.lazy(()=>At(()=>import("./CodeContainerApp-BMuDbTwO.js").then(async e=>(await e.__tla,e)).then(e=>e.C),__vite__mapDeps([62,1,2,14,60,10]))),$q=g.memo(e=>{const{id:t,isConnectable:n}=e;return h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Nn,{id:t}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(Lq,{...e})})]}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:n})]})}),Fq=["empty-source","vite-vue","shadcn-react-vite","todo-app-react-vite","porfolio-nextjs"],Bq=async e=>{switch(e){case"empty-source":return At(()=>import("./empty-source-Dw1dvL8s.js"),[]).then(t=>t.BASE);case"vite-vue":return At(()=>import("./vite-vue-Bmz2z3Fo.js"),[]).then(t=>t.BASE);case"shadcn-react-vite":return At(()=>import("./shadcn-react-vite-CDJ9BaE9.js"),[]).then(t=>t.BASE);case"todo-app-react-vite":return At(()=>import("./todo-app-react-vite-BBWBkRjR.js"),[]).then(t=>t.BASE);case"porfolio-nextjs":return At(()=>import("./porfolio-nextjs-DCkli5iW.js"),[]).then(t=>t.BASE);default:throw new Error(`Unknown source base: ${e}`)}},mM=g.memo(({className:e,onUpdateSourceBase:t})=>{const{t:n}=Pe("components"),[r,a]=g.useState();return h.jsxs(Zt,{className:Z("mw-full",e),children:[h.jsx(Ln,{className:"p-4",children:h.jsx(Kn,{children:n("add_source_base.title")})}),h.jsx($n,{className:"p-4",children:h.jsxs("div",{className:"flex items-center justify-center w-full h-full flex-col",children:[h.jsxs(jo,{onValueChange:o=>a(o),children:[h.jsx(Ta,{className:"w-full mb-4",children:h.jsx(So,{placeholder:n("add_source_base.source_base_select_placeholder")})}),h.jsx(Ia,{children:Fq.map(o=>h.jsx(Xn,{value:`${o}`,children:n(`add_source_base.sourcebases.${o.toLowerCase()}`)},`${o}`))})]}),h.jsx(ut,{className:"w-full",onClick:async()=>r&&t(await Bq(r)),children:n("add_source_base.update_source")})]})})]})}),zq=()=>{const{getNode:e,getHandleConnections:t}=lr(),{stream:n}=kc(),r=g.useCallback(async(o,i)=>{await ue("FlowNode").update(o,{raw:xv(i)})},[]),a=g.useCallback(o=>{if(!e(o))return[];const i=[];return t({nodeId:o,type:"target"}).forEach(s=>{const c=e(s.source);!c||c.type!==oe.LLM||i.push({node:c,connections:[s]})}),i},[t,e]);return{sendMessage:g.useCallback(async(o,i,{onMessageUpdate:s,onResponseMessageCreate:c}={})=>{const l=i.map(d=>d.role==="system"?new Pg(d.content):d.role==="user"?new Pr(d.content):new Uo(d.content));c==null||c();const{content:u}=await n(nn.WebLLM,[...l,new Pr(o)],{onMessageUpdate:({content:d})=>{s==null||s({nodeData:{loading:!0,content:d}})},llm:void 0});return s==null||s({nodeData:{loading:!1,content:u}}),u},[n]),getLinkedConnections:a,updateCodeContainerData:r}},Vq=e=>{const t=De(r=>r.createOrUpdateFlowEdge),n=g.useCallback(async({edgeId:r,source:a,target:o,connection:i})=>{try{if((a==null?void 0:a.type)===oe.LLM&&(o==null?void 0:o.type)===oe.VSLiteApp){await t({source:i.source,target:i.target,sourceHandle:i.sourceHandle,targetHandle:i.targetHandle});return}return{deleteEdgeId:r}}catch{return{deleteEdgeId:r}}},[t]);An(e,n)},Uq=g.lazy(()=>At(()=>import("./index-BOzrtCLL.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([57,1,2,14,21,35,4,58,59,60,3,61]))),Wq=g.memo(e=>{var p,f,y,m;const{id:t,isConnectable:n,data:r}=e,[a,o]=g.useState((p=r==null?void 0:r.flowNode)!=null&&p.raw?Ev(r.flowNode.raw):void 0),{updateCodeContainerData:i,getLinkedConnections:s,sendMessage:c}=zq();Vq(t);const l=g.useCallback(async v=>{var b,w;(b=r==null?void 0:r.flowNode)!=null&&b.id&&(await i((w=r==null?void 0:r.flowNode)==null?void 0:w.id,v),o(v))},[(f=r==null?void 0:r.flowNode)==null?void 0:f.id,i]),u=g.useCallback(async(v,b)=>{var w;return(w=r==null?void 0:r.flowNode)!=null&&w.id?await c(v,b):void 0},[(y=r==null?void 0:r.flowNode)==null?void 0:y.id,c]),d=g.useCallback(async v=>{o(b=>{var j;const w=Ov(b||{},v);return i((j=r==null?void 0:r.flowNode)==null?void 0:j.id,w),w})},[(m=r==null?void 0:r.flowNode)==null?void 0:m.id,i]);return a?h.jsxs("div",{className:"w-[1380px] h-[600px] rounded-lg border overflow-hidden shadow-sm",children:[h.jsx(lt,{type:"target",position:fe.Top,isConnectable:n}),h.jsxs("div",{className:"w-full h-full rounded-lg border bg-card overflow-hidden",children:[h.jsx(Nn,{id:t,className:"z-50",enableToStandalone:!0,getLinkedConnections:s}),h.jsx(g.Suspense,{fallback:h.jsx("div",{className:"h-full w-full flex justify-center items-center",children:h.jsx(de,{name:"loader-circle",className:"animate-spin"})}),children:h.jsx(Uq,{fileSystemTree:a,onUpdateFileContent:d,sendMessage:u})})]}),h.jsx(lt,{type:"source",position:fe.Bottom,isConnectable:n})]}):h.jsx("div",{className:"h-full flex justify-center items-center",children:h.jsx(mM,{className:"w-64",onUpdateSourceBase:l})})}),Hq={[oe.LLM]:uB,[oe.Toolbox]:rB,[oe.Thread]:mB,[oe.Message]:Pve,[oe.Prompt]:Ave,[oe.SessionInfo]:ike,[oe.Schema]:cke,[oe.CSVData]:lke,[oe.ToolDefinition]:dke,[oe.DefaultEmbeddingModel]:fke,[oe.VectorDatabase]:xke,[oe.JSONLData]:jke,[oe.ApplicationBar]:Sq,[oe.Shape]:Oq,[oe.CircleShape]:Nq,[oe.TriangleShape]:Pq,[oe.EditorApp]:Iq,[oe.PlaceHolder]:Dq,[oe.CodeContainerApp]:$q,[oe.VSLiteApp]:Wq};function Eke(e,t=[]){let n=[];function r(o,i){const s=g.createContext(i),c=n.length;n=[...n,i];function l(d){const{scope:p,children:f,...y}=d,m=(p==null?void 0:p[e][c])||s,v=g.useMemo(()=>y,Object.values(y));return h.jsx(m.Provider,{value:v,children:f})}function u(d,p){const f=(p==null?void 0:p[e][c])||s,y=g.useContext(f);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const a=()=>{const o=n.map(i=>g.createContext(i));return function(i){const s=(i==null?void 0:i[e])||o;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:s}}),[i,s])}};return a.scopeName=e,[r,Oke(a,...t)]}function Oke(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){const o=r.reduce((i,{useScope:s,scopeName:c})=>{const l=s(a)[`__scope${c}`];return{...i,...l}},{});return g.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var Cke="Toggle",hN=g.forwardRef((e,t)=>{const{pressed:n,defaultPressed:r=!1,onPressedChange:a,...o}=e,[i=!1,s]=Sn({prop:n,onChange:a,defaultProp:r});return h.jsx(Ae.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":e.disabled?"":void 0,...o,ref:t,onClick:ge(e.onClick,()=>{e.disabled||s(!i)})})});hN.displayName=Cke;let mN,xs,yN,gN,xg;mN=hN,xs="ToggleGroup",[yN,OK]=Eke(xs,[Xa]),gN=Xa(),xg=W.forwardRef((e,t)=>{const{type:n,...r}=e;if(n==="single"){const a=r;return h.jsx(Nke,{...a,ref:t})}if(n==="multiple"){const a=r;return h.jsx(Mke,{...a,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${xs}\``)}),xg.displayName=xs;var[qq,Kq]=yN(xs),Nke=W.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i,s]=Sn({prop:n,defaultProp:r,onChange:a});return h.jsx(qq,{scope:e.__scopeToggleGroup,type:"single",value:i?[i]:[],onItemActivate:s,onItemDeactivate:W.useCallback(()=>s(""),[s]),children:h.jsx(Xq,{...o,ref:t})})}),Mke=W.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[i=[],s]=Sn({prop:n,defaultProp:r,onChange:a}),c=W.useCallback(u=>s((d=[])=>[...d,u]),[s]),l=W.useCallback(u=>s((d=[])=>d.filter(p=>p!==u)),[s]);return h.jsx(qq,{scope:e.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:c,onItemDeactivate:l,children:h.jsx(Xq,{...o,ref:t})})});xg.displayName=xs;var[Pke,kke]=yN(xs),Xq=W.forwardRef((e,t)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:a=!0,orientation:o,dir:i,loop:s=!0,...c}=e,l=gN(n),u=Wo(i),d={role:"group",dir:u,...c};return h.jsx(Pke,{scope:n,rovingFocus:a,disabled:r,children:a?h.jsx(zl,{asChild:!0,...l,orientation:o,dir:u,loop:s,children:h.jsx(Ae.div,{...d,ref:t})}):h.jsx(Ae.div,{...d,ref:t})})}),_g="ToggleGroupItem",Zq=W.forwardRef((e,t)=>{const n=Kq(_g,e.__scopeToggleGroup),r=kke(_g,e.__scopeToggleGroup),a=gN(e.__scopeToggleGroup),o=n.value.includes(e.value),i=r.disabled||e.disabled,s={...e,pressed:o,disabled:i},c=W.useRef(null);return r.rovingFocus?h.jsx(Vl,{asChild:!0,...a,focusable:!i,active:o,ref:c,children:h.jsx(vN,{...s,ref:t})}):h.jsx(vN,{...s,ref:t})});Zq.displayName=_g;let vN;vN=W.forwardRef((e,t)=>{const{__scopeToggleGroup:n,value:r,...a}=e,o=Kq(_g,n),i={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},s=o.type==="single"?i:void 0;return h.jsx(hN,{...s,...a,ref:t,onPressedChange:c=>{c?o.onItemActivate(r):o.onItemDeactivate(r)}})}),Vg=xg,Ug=Zq;const Gq=Ha("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),Ake=g.forwardRef(({className:e,variant:t,size:n,...r},a)=>h.jsx(mN,{ref:a,className:Z(Gq({variant:t,size:n,className:e})),...r}));Ake.displayName=mN.displayName;const Qq=g.createContext({size:"default",variant:"default"}),Yq=g.forwardRef(({className:e,variant:t,size:n,children:r,...a},o)=>h.jsx(Vg,{ref:o,className:Z("flex items-center justify-center gap-1",e),...a,children:h.jsx(Qq.Provider,{value:{variant:t,size:n},children:r})}));Yq.displayName=Vg.displayName;const Jq=g.forwardRef(({className:e,children:t,variant:n,size:r,...a},o)=>{const i=g.useContext(Qq);return h.jsx(Ug,{ref:o,className:Z(Gq({variant:i.variant||n,size:i.size||r}),e),...a,children:t})});Jq.displayName=Ug.displayName;function Tke(){const e=Qe(t=>`x: ${t.transform[0].toFixed(2)}, y: ${t.transform[1].toFixed(2)}, zoom: ${t.transform[2].toFixed(2)}`);return h.jsx("div",{children:e})}function Ike({change:e}){var r,a,o,i;const t="id"in e?e.id:"-",{type:n}=e;return h.jsxs("div",{className:"mb-3",children:[h.jsxs("div",{children:["node id: ",t]}),h.jsxs("div",{children:[n==="add"?JSON.stringify(e.item,null,2):null,n==="dimensions"?`dimensions: ${(r=e.dimensions)==null?void 0:r.width} \xD7 ${(a=e.dimensions)==null?void 0:a.height}`:null,n==="position"?`position: ${(o=e.position)==null?void 0:o.x.toFixed(1)}, ${(i=e.position)==null?void 0:i.y.toFixed(1)}`:null,n==="remove"?"remove":null,n==="select"?e.selected?"select":"unselect":null]})]})}function Rke({limit:e=20}){const[t,n]=g.useState([]),r=Tt(),a=g.useCallback(i=>{n(s=>[...i,...s].slice(0,e))},[e]);g.useEffect(()=>(r.setState({onNodesChange:a}),()=>r.setState({onNodesChange:void 0})),[a,r]);const o=()=>h.jsx("div",{children:"No Changes Triggered"});return h.jsx(h.Fragment,{children:t.length===0?h.jsx(o,{}):t.map((i,s)=>h.jsx(Ike,{change:i},s))})}function Dke(){const{getInternalNode:e}=lr(),t=Mce();return h.jsx(Cce,{children:h.jsx("div",{className:"text-secondary-foreground",children:t.map(n=>{var o,i;const r=e(n.id);if(!r)return null;const a=r==null?void 0:r.internals.positionAbsolute;return h.jsx(Lke,{id:n.id,selected:!!n.selected,type:n.type||"default",position:n.position,absPosition:a,width:((o=n.measured)==null?void 0:o.width)??0,height:((i=n.measured)==null?void 0:i.height)??0,data:n.data},n.id)})})})}function Lke({id:e,type:t,selected:n,position:r,absPosition:a,width:o,height:i,data:s}){if(!o||!i)return null;const c=`translate(${a.x}px, ${a.y+i}px)`,l=`${r.x.toFixed(1)}, ${r.y.toFixed(1)}`,u=`${o} \xD7 ${i}`,d=n?"Selected":"Not Selected";return h.jsxs("div",{style:{position:"absolute",transform:c,width:o*2},className:"text-xs",children:[h.jsxs("div",{children:["id: ",e]}),h.jsxs("div",{children:["type: ",t]}),h.jsxs("div",{children:["selected: ",d]}),h.jsxs("div",{children:["position: ",l]}),h.jsxs("div",{children:["dimensions: ",u]}),h.jsxs("div",{children:["data: ",JSON.stringify(s,null,2)]})]})}function $ke({tools:e}){return h.jsx(dc,{position:"top-left",className:"bg-card p-1 border rounded shadow-sm",children:h.jsx(Yq,{type:"multiple",children:e.map(({active:t,setActive:n,label:r,value:a})=>h.jsx(Jq,{value:a,onClick:()=>n(o=>!o),"aria-pressed":t,className:"bg-card text-card-foreground transition-colors duration-300 hover:bg-secondary hover:text-secondary-foreground",children:r},a))})})}function eK(){const[e,t]=g.useState(!1),[n,r]=g.useState(!1),[a,o]=g.useState(!1),i=[{active:e,setActive:t,label:"Node Inspector",value:"node-inspector"},{active:n,setActive:r,label:"Change Logger",value:"change-logger"},{active:a,setActive:o,label:"Viewport Logger",value:"viewport-logger"}];return h.jsxs(h.Fragment,{children:[h.jsx($ke,{tools:i}),n&&h.jsx(dc,{className:"text-xs p-5 bg-white rounded shadow-md overflow-y-auto max-h-[50%] mt-20",position:"bottom-right",children:h.jsx(Rke,{})}),e&&h.jsx(Dke,{}),a&&h.jsx(dc,{position:"bottom-left",className:"text-secondary-foreground",children:h.jsx(Tke,{})})]})}eK.displayName="DevTools";const Fke=()=>{const e=g.useRef({}),t=g.useRef({}),n=De(N=>N.flowEdges),r=Je(N=>N.currentSession),a=De(N=>N.setNodes),o=De(N=>N.updateNodes),i=De(N=>N.updateEdges),s=De(N=>N.addConnectionToEdges),c=De(N=>N.reset),l=De(N=>N.findFlowEdges),u=De(N=>N.deleteFlowNode),d=De(N=>N.deleteFlowEdge),p=De(N=>N.updateFlowNode),f=De(N=>N.getNodes),y=De(N=>N.findFlowNodesWithSource),m=g.useRef(n),v=g.useRef(),[b,w]=g.useState({loading:!1});m.current=n;const j=g.useCallback(async(N,P)=>{try{v.current=N,c(),await(P==null?void 0:P())}catch{v.current=void 0}},[c]),x=g.useCallback(async N=>{try{if(!(r!=null&&r.id))return;w(k=>({...k,loading:!0}));const P=await y({...N,where:{...N.where,session_id:r.id}}),I=await l({where:[{source:Ca(P.map(k=>k.id))},{target:Ca(P.map(k=>k.id))}]});return{flowNodes:P,flowEdges:I}}finally{w(P=>({...P,loading:!1}))}},[y,l,r==null?void 0:r.id]),_=g.useCallback(async N=>{var P,I;for(const k of N)if("id"in k&&Object.values(ad).includes(k.id)&&k.type!=="remove")o([k]);else if(k.type==="position"&&k.position&&!isNaN(k.position.x)&&!isNaN(k.position.y)){o([k]);const C=k.position.x,T=k.position.y;clearTimeout(e.current[k.id]),e.current[k.id]=setTimeout(async()=>{e.current[k.id]=void 0,await p({id:k.id,x:C,y:T},{silent:!0})},200)}else if(k.type==="remove"){const C=(P=f([k.id]))==null?void 0:P[0];if(!(C!=null&&C.type)||Jle.includes(C.type))return;await u({id:k.id})}else if(k.type==="dimensions"&&k.dimensions&&!isNaN(k.dimensions.width)&&!isNaN(k.dimensions.height)){const C=(I=f([k.id]))==null?void 0:I[0];if(!(C!=null&&C.width)&&!(C!=null&&C.height))return;o([k]),clearTimeout(t.current[k.id]);const T=k.dimensions.width,A=k.dimensions.height;t.current[k.id]=setTimeout(async()=>{await p({id:k.id,width:T,height:A},{silent:!0})},200)}else k.type==="select"&&o([k])},[o,p,f,u]),S=g.useCallback(N=>{Promise.all(N.map(async P=>{if(P.type==="remove")return d({id:P.id})})),i(N)},[d,i]),E=g.useCallback(N=>{s(N)},[s]),O=g.useCallback(()=>{var N;(N=m.current)==null||N.length},[]),M=g.useCallback(N=>{a(P=>{var T,A;let I;if(typeof N=="function"?I=N(P):I=N,!I)return P;const k=P==null?void 0:P.find(D=>D.id===I.id),C={id:I.id,item:k?Bh(k,I):{...I,position:{x:((T=I.position)==null?void 0:T.x)||0,y:((A=I.position)==null?void 0:A.y)||0}},type:k?"replace":"add"};return Ki([C],P)})},[a]);return{syncEdges:O,initialFlow:j,loadingState:b,prepareFlowInfo:x,updateNodeChanges:_,updateEdgeChanges:S,updateOrCreateNode:M,currentSessionIdRef:v,updateEdgeConnection:E}},Bke=e=>{const t=Je(u=>{var d;return(d=u.currentSession)==null?void 0:d.id}),{loadingState:n,prepareFlowInfo:r,syncEdges:a,initialFlow:o,currentSessionIdRef:i}=e,s=De(u=>u.ready),c=De(u=>u.removeSyncNodeQueue),l=De(u=>u.removeSyncEdgeQueue);g.useLayoutEffect(()=>{},[t]),g.useEffect(()=>{n.loading||!s||!t||i.current===t||o(t,async()=>{await r({where:{session_id:t}})})},[o,r,n.loading,i,s,t]),g.useEffect(()=>{const u=De.subscribe(p=>p.syncNodeQueue,async(p,f)=>{const y=f.map(v=>v.timestamp),m=p.filter(v=>!y.includes(v.timestamp));m.length&&c(m.map(v=>v.timestamp))}),d=De.subscribe(p=>p.syncEdgeQueue,async(p,f)=>{const y=f.map(v=>v.timestamp),m=p.filter(v=>!y.includes(v.timestamp));m.length&&(l(m.map(v=>v.timestamp)),a())});return()=>{u(),d()}},[r,l,c,a])},zke=()=>{const[e,t]=g.useState(!0),n=Fke(),r=Wa(u=>u.selectedModel),a=g.useRef(r),o=Wa(u=>u.setInitProgressCallback),{updateOrCreateNode:i,updateNodeChanges:s,updateEdgeChanges:c,updateEdgeConnection:l}=n;return Bke(n),a.current=r,g.useEffect(()=>{const u=o==null?void 0:o(d=>{if(!a.current)return;const p=`${a.current}`;i(f=>{const y=f==null?void 0:f.find(m=>{var v;return(v=m.data)!=null&&v.entity&&typeof m.data.entity=="object"&&"name"in m.data.entity?m.data.entity.name===p:!1});if(y)return y.data.label=d.text,y.data.status=Ge.Loading,d.progress===100&&(y.data.label="",y.data.status=Ge.Loaded),y})});return()=>{u==null||u()}},[o,i]),g.useMemo(()=>({updateNodeChanges:s,updateEdgeChanges:c,initializing:e,setInitializing:t,updateEdgeConnection:l}),[s,c,e,t,l])},Vke=()=>{const e=Ml(l=>l.theme),t=De(l=>l.nodes),n=De(l=>l.edges),{updateNodeChanges:r,updateEdgeChanges:a,updateEdgeConnection:o}=zke(),i=g.useCallback(l=>{r(l)},[r]),s=g.useCallback(l=>{a(l)},[a]),c=g.useCallback(l=>{o(l)},[o]);return h.jsxs(Ece,{nodes:t,edges:n,nodeTypes:Hq,onNodesChange:i,onEdgesChange:s,onConnect:c,panOnScroll:!0,panOnScrollMode:ti.Free,colorMode:e,fitView:!0,children:[h.jsx(Ice,{variant:wo.Dots,gap:24,size:1}),h.jsx(zce,{}),h.jsx(Jce,{}),t2e?h.jsx(eK,{}):void 0]})},Uke=g.memo(Vke);function Wke(){return h.jsx(Uke,{})}const Hke=g.lazy(()=>At(()=>import("./DocumentViewer-BwJfTmW9.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([63,1,2,15]))),qke=()=>{const{documentId:e}=dP();return h.jsx(g.Suspense,{fallback:h.jsx(Tl,{flickeringGrid:!0,className:"w-full h-full"}),children:h.jsx(Hke,{name:e||""})})};function jg(){const e=pP();return kl(e),h.jsx(n2e,{})}const Kke=oZ(h.jsxs(Xo,{errorElement:h.jsx(jg,{}),children:[h.jsxs(Xo,{element:h.jsx(Q2,{requiredSession:!0}),children:[h.jsx(Xo,{path:Af.whiteboard,Component:Wke,errorElement:h.jsx(jg,{})}),h.jsx(Xo,{path:Af.application,errorElement:h.jsx(jg,{}),Component:Tme}),h.jsx(Xo,{path:"*",element:h.jsx(nZ,{to:gn("whiteboard")})})]}),h.jsx(Xo,{element:h.jsx(Q2,{}),children:h.jsx(Xo,{path:Af.document,errorElement:h.jsx(jg,{}),Component:qke})})]})),Xke=(e,t)=>{switch(iY){case"browser":return xP(e,t);case"hash":return MZ(e);default:return xP(e,t)}},Zke=Xke(Kke,{basename:"/NoLLMChat/"});vK("[BASE_URL]","/NoLLMChat/");let tK;tK=g.memo(()=>{const e=!window.location.pathname.includes("/NoLLMChat/");return g.useLayoutEffect(()=>{e&&(window.location.href="/NoLLMChat/".replace("//","/"))},[e]),e?h.jsx(Tl,{className:"w-screen h-screen",simple:!0}):h.jsx(BZ,{router:Zke})},()=>!0),PK=Object.freeze(Object.defineProperty({__proto__:null,default:tK},Symbol.toStringTag,{value:"Module"}))});export{Pt as $,PN as A,Ag as B,kN as C,AN as D,Rl as E,Tg as F,Dl as G,Ni as H,Bp as I,zp as J,Ig as K,TN as L,IN as M,Es as N,RN as O,DN as P,LN as Q,$N as R,Rg as S,FN as T,BN as U,Ll as V,zN as W,VN as X,UN as Y,WN as Z,Dg as _,o2e as __tla,Lg as a,$g as a$,$l as a0,Fl as a1,Mi as a2,Pi as a3,Vp as a4,_K as a5,Bl as a6,Os as a7,Cs as a8,jK as a9,SK as aA,Fg as aB,HN as aC,qN as aD,KN as aE,EK as aF,Bg as aG,XN as aH,zg as aI,ZN as aJ,Xa as aK,OK as aL,Wo as aM,zl as aN,Vl as aO,Vg as aP,Ug as aQ,Wg as aR,Hg as aS,qg as aT,Kg as aU,Xg as aV,Zg as aW,GN as aX,QN as aY,Up as aZ,Gg as a_,YN as aa,Qg as ab,JN as ac,eM as ad,CK as ae,tM as af,Yg as ag,NK as ah,nM as ai,rM as aj,aM as ak,Jg as al,oM as am,MK as an,ev as ao,tv as ap,nv as aq,iM as ar,rv as as,av as at,ov as au,iv as av,sv as aw,cv as ax,sM as ay,cM as az,Ul as b,lv as b0,uv as b1,dv as b2,pv as b3,fv as b4,hv as b5,mv as b6,Wp as b7,yn as b8,yv as b9,lM as bA,uM as bB,Ns as bC,Ho as bD,PK as bE,Hp as ba,gv as bb,vv as bc,Wl as bd,Hl as be,kK as bf,dM as bg,nt as bh,Ms as bi,bv as bj,wv as bk,Vn as bl,De as bm,An as bn,Tn as bo,xv as bp,_v as bq,pM as br,fM as bs,jv as bt,Sv as bu,ut as bv,hM as bw,Ev as bx,Ov as by,mM as bz,yM as c,Ar as d,Cv as e,gM as f,vM as g,Ps as h,Tr as i,Nv as j,Mv as k,bM as l,ha as m,wM as n,Pv as o,kv as p,xM as q,_M as r,jM as s,Av as t,In as u,ql as v,Tv as w,Kl as x,ks as y,SM as z};
